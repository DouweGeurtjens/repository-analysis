[{"url": "https://api.github.com/repos/optuna/optuna/issues/4594", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4594/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4594/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4594/events", "html_url": "https://github.com/optuna/optuna/pull/4594", "id": 1661673141, "node_id": "PR_kwDOB0okGM5N-0GP", "number": 4594, "title": "Fix `metric_names` on `_log_completed_trial()` function", "user": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/54", "html_url": "https://github.com/optuna/optuna/milestone/54", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/54/labels", "id": 8862825, "node_id": "MI_kwDOB0okGM4Ahzxp", "number": 54, "title": "v3.2.0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 2, "closed_issues": 126, "state": "open", "created_at": "2023-01-17T07:03:31Z", "updated_at": "2023-04-27T06:35:24Z", "due_on": null, "closed_at": null}, "comments": 2, "created_at": "2023-04-11T02:30:38Z", "updated_at": "2023-04-12T05:10:41Z", "closed_at": "2023-04-12T02:04:29Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4594", "html_url": "https://github.com/optuna/optuna/pull/4594", "diff_url": "https://github.com/optuna/optuna/pull/4594.diff", "patch_url": "https://github.com/optuna/optuna/pull/4594.patch", "merged_at": "2023-04-12T02:04:29Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull request after it gets two or more approvals. To proceed to the review process by the maintainers, please make sure that the PR meets the following conditions: (1) it passes all CI checks, and (2) it is neither in the draft nor WIP state. If you wish to discuss the PR in the draft state or need any other help, please mention the Optuna development team in the PR. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nFollow-up #4383 \r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\nAfter merging #4383, I found a bug in `_log_completed_trial()` function. This PR fixes it.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4594/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4594/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4584", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4584/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4584/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4584/events", "html_url": "https://github.com/optuna/optuna/issues/4584", "id": 1656876965, "node_id": "I_kwDOB0okGM5iwe-l", "number": 4584, "title": "Can not save study with sqlite3  but in memory works", "user": {"login": "TTK95", "id": 39856079, "node_id": "MDQ6VXNlcjM5ODU2MDc5", "avatar_url": "https://avatars.githubusercontent.com/u/39856079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TTK95", "html_url": "https://github.com/TTK95", "followers_url": "https://api.github.com/users/TTK95/followers", "following_url": "https://api.github.com/users/TTK95/following{/other_user}", "gists_url": "https://api.github.com/users/TTK95/gists{/gist_id}", "starred_url": "https://api.github.com/users/TTK95/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TTK95/subscriptions", "organizations_url": "https://api.github.com/users/TTK95/orgs", "repos_url": "https://api.github.com/users/TTK95/repos", "events_url": "https://api.github.com/users/TTK95/events{/privacy}", "received_events_url": "https://api.github.com/users/TTK95/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2023-04-06T08:01:56Z", "updated_at": "2023-04-06T14:07:09Z", "closed_at": "2023-04-06T14:07:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nI can't save my study with sqlite3 file path. But with :memroy: it works:\r\n\r\n```\r\nimport logging\r\nimport sys\r\nimport optuna\r\n# Add stream handler of stdout to show the messages\r\noptuna.logging.get_logger(\"optuna\").addHandler(logging.StreamHandler(sys.stdout))\r\nstudy_name = \"example-study\"  # Unique identifier of the study.\r\nstorage_name = \"sqlite:///:memory:\"\r\nstudy = optuna.create_study(study_name=study_name, storage=storage_name)\r\nA new study created in RDB with name: example-study\r\nA new study created in RDB with name: example-study\r\n[I 2023-04-06 10:00:27,398] A new study created in RDB with name: example-study\r\n```\r\n\r\nBut I want to store my study not in memory.\n\n### Environment\n\n- Optuna version: 2.10.1\r\n- Python version: 3.10.4\r\n- OS: Ubuntu 22.04.2 LTS\r\n- (Optional) Other libraries and their versions:\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\nTraceback (most recent call last):\r\n  File \"/snap/pycharm-professional/331/plugins/python/helpers/pydev/pydevconsole.py\", line 364, in runcode\r\n    coro = func()\r\n  File \"<input>\", line 10, in <module>\r\n  File \"/home/tte/anaconda3/envs/ISEAnet/lib/python3.10/site-packages/optuna/study/study.py\", line 1136, in create_study\r\n    storage = storages.get_storage(storage)\r\n  File \"/home/tte/anaconda3/envs/ISEAnet/lib/python3.10/site-packages/optuna/storages/__init__.py\", line 31, in get_storage\r\n    return _CachedStorage(RDBStorage(storage))\r\n  File \"/home/tte/anaconda3/envs/ISEAnet/lib/python3.10/site-packages/optuna/storages/_rdb/storage.py\", line 187, in __init__\r\n    self._version_manager.check_table_schema_compatibility()\r\n  File \"/home/tte/anaconda3/envs/ISEAnet/lib/python3.10/site-packages/optuna/storages/_rdb/storage.py\", line 1310, in check_table_schema_compatibility\r\n    current_version = self.get_current_version()\r\n  File \"/home/tte/anaconda3/envs/ISEAnet/lib/python3.10/site-packages/optuna/storages/_rdb/storage.py\", line 1337, in get_current_version\r\n    assert version is not None\r\nAssertionError\n```\n\n\n### Steps to reproduce\n\n1. try example from doc\r\n2. Error\r\n```python\r\nimport logging\r\nimport sys\r\n\r\nimport optuna\r\n\r\n# Add stream handler of stdout to show the messages\r\noptuna.logging.get_logger(\"optuna\").addHandler(logging.StreamHandler(sys.stdout))\r\nstudy_name = \"example-study\"  # Unique identifier of the study.\r\nstorage_name = \"sqlite:///{}.db\".format(study_name)\r\nstudy = optuna.create_study(study_name=study_name, storage=storage_name)\r\n```\r\n\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4584/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4584/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4583", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4583/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4583/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4583/events", "html_url": "https://github.com/optuna/optuna/issues/4583", "id": 1656867375, "node_id": "I_kwDOB0okGM5iwcov", "number": 4583, "title": "optuna.visualization.plot_param_importances ValueError", "user": {"login": "TTK95", "id": 39856079, "node_id": "MDQ6VXNlcjM5ODU2MDc5", "avatar_url": "https://avatars.githubusercontent.com/u/39856079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TTK95", "html_url": "https://github.com/TTK95", "followers_url": "https://api.github.com/users/TTK95/followers", "following_url": "https://api.github.com/users/TTK95/following{/other_user}", "gists_url": "https://api.github.com/users/TTK95/gists{/gist_id}", "starred_url": "https://api.github.com/users/TTK95/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TTK95/subscriptions", "organizations_url": "https://api.github.com/users/TTK95/orgs", "repos_url": "https://api.github.com/users/TTK95/repos", "events_url": "https://api.github.com/users/TTK95/events{/privacy}", "received_events_url": "https://api.github.com/users/TTK95/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2023-04-06T07:55:41Z", "updated_at": "2023-04-06T14:03:54Z", "closed_at": "2023-04-06T14:03:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nWhen I try the visualization function, it returns a ValueError\r\n\r\n```\r\nimport optuna\r\n\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_int(\"x\", 0, 2)\r\n    y = trial.suggest_float(\"y\", -1.0, 1.0)\r\n    z = trial.suggest_float(\"z\", 0.0, 1.5)\r\n    return x ** 2 + y ** 3 - z ** 4\r\n\r\n\r\nsampler = optuna.samplers.RandomSampler(seed=10)\r\nstudy = optuna.create_study(sampler=sampler)\r\nstudy.optimize(objective, n_trials=100)\r\n\r\nfig = optuna.visualization.plot_param_importances(study)\r\nfig.show()\r\n```\r\n\r\n\n\n### Environment\n\n- Optuna version: 2.10.1\r\n- Python version: 3.10.4\r\n- OS: Ubuntu 22.04.2 LTS\r\n- (Optional) Other libraries and their versions:\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\nValueError: setting an array element with a sequence. The requested array would exceed the maximum number of dimension of 1.\n```\n\n\n### Steps to reproduce\n\n1. try example code from docs\r\n2. Error\r\n```python\r\n```\r\nimport optuna\r\n\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_int(\"x\", 0, 2)\r\n    y = trial.suggest_float(\"y\", -1.0, 1.0)\r\n    z = trial.suggest_float(\"z\", 0.0, 1.5)\r\n    return x ** 2 + y ** 3 - z ** 4\r\n\r\n\r\nsampler = optuna.samplers.RandomSampler(seed=10)\r\nstudy = optuna.create_study(sampler=sampler)\r\nstudy.optimize(objective, n_trials=100)\r\n\r\nfig = optuna.visualization.plot_param_importances(study)\r\nfig.show()\r\n```\r\n```\r\n\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4583/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4583/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4581", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4581/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4581/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4581/events", "html_url": "https://github.com/optuna/optuna/pull/4581", "id": 1655331859, "node_id": "PR_kwDOB0okGM5NqVZa", "number": 4581, "title": "[Backport] Fix CMA-ES Sampler", "user": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/56", "html_url": "https://github.com/optuna/optuna/milestone/56", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/56/labels", "id": 9238147, "node_id": "MI_kwDOB0okGM4AjPaD", "number": 56, "title": "v3.1.1", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 9, "state": "closed", "created_at": "2023-04-03T07:15:25Z", "updated_at": "2023-04-06T07:39:40Z", "due_on": null, "closed_at": "2023-04-06T07:39:40Z"}, "comments": 0, "created_at": "2023-04-05T10:14:18Z", "updated_at": "2023-04-06T07:02:23Z", "closed_at": "2023-04-06T07:02:23Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4581", "html_url": "https://github.com/optuna/optuna/pull/4581", "diff_url": "https://github.com/optuna/optuna/pull/4581.diff", "patch_url": "https://github.com/optuna/optuna/pull/4581.patch", "merged_at": "2023-04-06T07:02:23Z"}, "body": "Backport #4443 for v3.1.1.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4581/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4581/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4574", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4574/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4574/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4574/events", "html_url": "https://github.com/optuna/optuna/pull/4574", "id": 1651526312, "node_id": "PR_kwDOB0okGM5NdiOz", "number": 4574, "title": "[Backport] Fix RDBStorage.get_best_trial when there are `inf`s", "user": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/56", "html_url": "https://github.com/optuna/optuna/milestone/56", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/56/labels", "id": 9238147, "node_id": "MI_kwDOB0okGM4AjPaD", "number": 56, "title": "v3.1.1", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 9, "state": "closed", "created_at": "2023-04-03T07:15:25Z", "updated_at": "2023-04-06T07:39:40Z", "due_on": null, "closed_at": "2023-04-06T07:39:40Z"}, "comments": 0, "created_at": "2023-04-03T07:49:05Z", "updated_at": "2023-04-03T08:26:40Z", "closed_at": "2023-04-03T08:26:39Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4574", "html_url": "https://github.com/optuna/optuna/pull/4574", "diff_url": "https://github.com/optuna/optuna/pull/4574.diff", "patch_url": "https://github.com/optuna/optuna/pull/4574.patch", "merged_at": "2023-04-03T08:26:39Z"}, "body": "Backport #4422 for v3.1.1.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4574/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4574/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4572", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4572/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4572/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4572/events", "html_url": "https://github.com/optuna/optuna/pull/4572", "id": 1651520961, "node_id": "PR_kwDOB0okGM5NdhFT", "number": 4572, "title": "[Backport] Fix bug of CMA-ES with margin on `RDBStorage` or `JournalStorage`", "user": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/56", "html_url": "https://github.com/optuna/optuna/milestone/56", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/56/labels", "id": 9238147, "node_id": "MI_kwDOB0okGM4AjPaD", "number": 56, "title": "v3.1.1", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 9, "state": "closed", "created_at": "2023-04-03T07:15:25Z", "updated_at": "2023-04-06T07:39:40Z", "due_on": null, "closed_at": "2023-04-06T07:39:40Z"}, "comments": 0, "created_at": "2023-04-03T07:45:19Z", "updated_at": "2023-04-05T00:35:50Z", "closed_at": "2023-04-05T00:35:50Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4572", "html_url": "https://github.com/optuna/optuna/pull/4572", "diff_url": "https://github.com/optuna/optuna/pull/4572.diff", "patch_url": "https://github.com/optuna/optuna/pull/4572.patch", "merged_at": "2023-04-05T00:35:50Z"}, "body": "Backport #4434 for v3.1.1.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4572/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4572/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4571", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4571/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4571/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4571/events", "html_url": "https://github.com/optuna/optuna/pull/4571", "id": 1651517787, "node_id": "PR_kwDOB0okGM5Ndgad", "number": 4571, "title": "[Backport] Mitigate a blocking issue while running migrations with SQLAlchemy 2.0", "user": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/56", "html_url": "https://github.com/optuna/optuna/milestone/56", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/56/labels", "id": 9238147, "node_id": "MI_kwDOB0okGM4AjPaD", "number": 56, "title": "v3.1.1", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 9, "state": "closed", "created_at": "2023-04-03T07:15:25Z", "updated_at": "2023-04-06T07:39:40Z", "due_on": null, "closed_at": "2023-04-06T07:39:40Z"}, "comments": 0, "created_at": "2023-04-03T07:42:44Z", "updated_at": "2023-04-03T07:59:34Z", "closed_at": "2023-04-03T07:59:33Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4571", "html_url": "https://github.com/optuna/optuna/pull/4571", "diff_url": "https://github.com/optuna/optuna/pull/4571.diff", "patch_url": "https://github.com/optuna/optuna/pull/4571.patch", "merged_at": "2023-04-03T07:59:33Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull request after it gets two or more approvals. To proceed to the review process by the maintainers, please make sure that the PR meets the following conditions: (1) it passes all CI checks, and (2) it is neither in the draft nor WIP state. If you wish to discuss the PR in the draft state or need any other help, please mention the Optuna development team in the PR. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nBackport for v3.1.1\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4571/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4571/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4570", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4570/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4570/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4570/events", "html_url": "https://github.com/optuna/optuna/pull/4570", "id": 1651511961, "node_id": "PR_kwDOB0okGM5NdfNY", "number": 4570, "title": "[Backport] Fix param_mask for multivariate TPE with constant_liar", "user": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/56", "html_url": "https://github.com/optuna/optuna/milestone/56", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/56/labels", "id": 9238147, "node_id": "MI_kwDOB0okGM4AjPaD", "number": 56, "title": "v3.1.1", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 9, "state": "closed", "created_at": "2023-04-03T07:15:25Z", "updated_at": "2023-04-06T07:39:40Z", "due_on": null, "closed_at": "2023-04-06T07:39:40Z"}, "comments": 0, "created_at": "2023-04-03T07:38:04Z", "updated_at": "2023-04-03T08:18:23Z", "closed_at": "2023-04-03T08:04:34Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4570", "html_url": "https://github.com/optuna/optuna/pull/4570", "diff_url": "https://github.com/optuna/optuna/pull/4570.diff", "patch_url": "https://github.com/optuna/optuna/pull/4570.patch", "merged_at": "2023-04-03T08:04:34Z"}, "body": "Backport #4462 for v3.1.1.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4570/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4570/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4569", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4569/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4569/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4569/events", "html_url": "https://github.com/optuna/optuna/pull/4569", "id": 1651511807, "node_id": "PR_kwDOB0okGM5NdfLT", "number": 4569, "title": "[Backport] Fix botorch dependency", "user": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561256, "node_id": "MDU6TGFiZWwxOTQ3NTYxMjU2", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.integration", "name": "optuna.integration", "color": "1c659e", "default": false, "description": "Related to the `optuna.integration` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/56", "html_url": "https://github.com/optuna/optuna/milestone/56", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/56/labels", "id": 9238147, "node_id": "MI_kwDOB0okGM4AjPaD", "number": 56, "title": "v3.1.1", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 9, "state": "closed", "created_at": "2023-04-03T07:15:25Z", "updated_at": "2023-04-06T07:39:40Z", "due_on": null, "closed_at": "2023-04-06T07:39:40Z"}, "comments": 0, "created_at": "2023-04-03T07:37:56Z", "updated_at": "2023-04-03T08:03:51Z", "closed_at": "2023-04-03T08:03:51Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4569", "html_url": "https://github.com/optuna/optuna/pull/4569", "diff_url": "https://github.com/optuna/optuna/pull/4569.diff", "patch_url": "https://github.com/optuna/optuna/pull/4569.patch", "merged_at": "2023-04-03T08:03:51Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull request after it gets two or more approvals. To proceed to the review process by the maintainers, please make sure that the PR meets the following conditions: (1) it passes all CI checks, and (2) it is neither in the draft nor WIP state. If you wish to discuss the PR in the draft state or need any other help, please mention the Optuna development team in the PR. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nBackport for v3.1.1\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4569/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4569/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4544", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4544/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4544/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4544/events", "html_url": "https://github.com/optuna/optuna/issues/4544", "id": 1640859502, "node_id": "I_kwDOB0okGM5hzYdu", "number": 4544, "title": "setting a user_attr on a study with a cvbooster from lgbm unrolls it to its constituent boosters", "user": {"login": "nitinmnsn", "id": 39696508, "node_id": "MDQ6VXNlcjM5Njk2NTA4", "avatar_url": "https://avatars.githubusercontent.com/u/39696508?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nitinmnsn", "html_url": "https://github.com/nitinmnsn", "followers_url": "https://api.github.com/users/nitinmnsn/followers", "following_url": "https://api.github.com/users/nitinmnsn/following{/other_user}", "gists_url": "https://api.github.com/users/nitinmnsn/gists{/gist_id}", "starred_url": "https://api.github.com/users/nitinmnsn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nitinmnsn/subscriptions", "organizations_url": "https://api.github.com/users/nitinmnsn/orgs", "repos_url": "https://api.github.com/users/nitinmnsn/repos", "events_url": "https://api.github.com/users/nitinmnsn/events{/privacy}", "received_events_url": "https://api.github.com/users/nitinmnsn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2023-03-26T10:48:49Z", "updated_at": "2023-03-29T16:41:29Z", "closed_at": "2023-03-29T16:41:29Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nWhen a ```cvbooster``` which is returned by the ```lightgbm.cv``` in case you set ```return_cvbooster``` to ```True``` is stored as a user attribute of the optuna study then it automagically unrolls to the list of its component booster objects. The ```cvbooster``` lightgbm object should be returned as is when requested back from the ```user_attrs```\n\n### Environment\n\n- Optuna version: 3.1.0\r\n- Python version: 3.10.9\r\n- OS: ubuntu 22.10\r\n- lightgbm: 3.3.5\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\nNA\n```\n\n\n### Steps to reproduce\n\n```\r\nimport pandas as pd\r\nimport numpy as np\r\nimport optuna\r\nimport lightgbm\r\nfrom sklearn.datasets import make_classification\r\n\r\n#creating dummy data\r\ndata = make_classification(n_samples = 12_000, n_features = 100, n_informative = 100, n_redundant = 0, \r\n                           flip_y=0.05,n_clusters_per_class=5,class_sep = 0.5)\r\n\r\n#setting dummy column names\r\ndt = pd.DataFrame(data[0],columns = [str(i) for i in range(data[0].shape[1])])\r\nyt = pd.Series(data[1])\r\n\r\ntrain_data = lightgbm.Dataset(dt,\r\n                              label = yt)\r\n#This is what it is\r\nlgc = lightgbm.cv(params = {'n_estimators': 10, 'verbose':-1},train_set = train_data, return_cvbooster=True)\r\nprint(lgc['cvbooster']) \r\n\r\n#output : <lightgbm.engine.CVBooster object at 0x7f8f1a6bc460>\r\n\r\n\r\n#This is what it becomes\r\n_os = optuna.create_study(study_name = 'sample1')\r\n_os.set_user_attr('cvb', lgc['cvbooster'])\r\nprint(_os.user_attrs) \r\n\r\n#output : {'cvb': [<lightgbm.basic.Booster object at 0x7f8f1a5b5270>, <lightgbm.basic.Booster object at 0x7f8f1a5b59c0>, <lightgbm.basic.Booster object at 0x7f8f1a5b5300>, <lightgbm.basic.Booster object at 0x7f8f1a380610>, <lightgbm.basic.Booster object at 0x7f8f1a3830a0>]}\r\n\r\n```\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4544/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4544/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4535", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4535/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4535/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4535/events", "html_url": "https://github.com/optuna/optuna/issues/4535", "id": 1636734742, "node_id": "I_kwDOB0okGM5hjpcW", "number": 4535, "title": "When use MySQL, the first run *.py will be stuck, terminate and restart will be ok.", "user": {"login": "beta1scat", "id": 48203923, "node_id": "MDQ6VXNlcjQ4MjAzOTIz", "avatar_url": "https://avatars.githubusercontent.com/u/48203923?v=4", "gravatar_id": "", "url": "https://api.github.com/users/beta1scat", "html_url": "https://github.com/beta1scat", "followers_url": "https://api.github.com/users/beta1scat/followers", "following_url": "https://api.github.com/users/beta1scat/following{/other_user}", "gists_url": "https://api.github.com/users/beta1scat/gists{/gist_id}", "starred_url": "https://api.github.com/users/beta1scat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/beta1scat/subscriptions", "organizations_url": "https://api.github.com/users/beta1scat/orgs", "repos_url": "https://api.github.com/users/beta1scat/repos", "events_url": "https://api.github.com/users/beta1scat/events{/privacy}", "received_events_url": "https://api.github.com/users/beta1scat/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2023-03-23T02:07:10Z", "updated_at": "2023-03-23T02:31:14Z", "closed_at": "2023-03-23T02:31:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nLike Title, I use MySQL as database, but when I create a new database and run Optuna create study, program will be stuck, Python API and CLI both the same.\r\nBefore use Optuna, I meet 2 problems of MySQL:\r\n1. modified the `root` `plugin` from `auth_sock` to `mysql_native_password`. \r\n```\r\nmysql>  SELECT User,Host,plugin FROM mysql;\r\nERROR 1046 (3D000): No database selected\r\nmysql>  SELECT User,Host,plugin FROM mysql.user;\r\n+------------------+-----------+-----------------------+\r\n| User             | Host      | plugin                |\r\n+------------------+-----------+-----------------------+\r\n| mysql.infoschema | %         | caching_sha2_password |\r\n| debian-sys-maint | localhost | mysql_native_password |\r\n| mysql.infoschema | localhost | mysql_native_password |\r\n| mysql.session    | localhost | mysql_native_password |\r\n| mysql.sys        | localhost | mysql_native_password |\r\n| root             | localhost | mysql_native_password |\r\n+------------------+-----------+-----------------------+\r\n6 rows in set (0,00 sec)\r\n```\r\n2. And I also meet another problem about `[mysql.infoschema@localhost does not exist]` and fixed by the method mentioned in [mysql.infoschema@localhost does not exist](https://stackoverflow.com/questions/54565615/mysql-infoschemalocalhost-does-not-exist)\n\n### Environment\n\n- Optuna version: 3.1.0\r\n- Python version: 3.10.9\r\n- OS: Ubuntu 20.04\r\n- (Optional) Other libraries and their versions: \\\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\nNo log, but program stuck.\n```\n\n\n### Steps to reproduce\n\n1. Create a new MySQL database;\r\n```\r\nmysql> create database model_3\r\n```\r\n2. Run Create a New study.\r\n```python\r\nstudy = optuna.create_study(\r\n        storage=\"mysql://root@localhost/model_3\",  # Specify the storage URL here.\r\n        study_name=\"model_3_quniform\",\r\n        pruner=optuna.pruners.HyperbandPruner,\r\n        direction=\"maximize\"\r\n    )\r\n```\r\n\n\n### Additional context (optional)\n\nThis is my first time using MySQL and Optuna, I want to konw the right way to use them. Is there a detailed tutorials?\r\nLooking forward to you reply.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4535/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4535/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4529", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4529/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4529/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4529/events", "html_url": "https://github.com/optuna/optuna/issues/4529", "id": 1635092461, "node_id": "I_kwDOB0okGM5hdYft", "number": 4529, "title": "The fitting information was not silenced correctly during parallel processing", "user": {"login": "Loccret", "id": 29334003, "node_id": "MDQ6VXNlcjI5MzM0MDAz", "avatar_url": "https://avatars.githubusercontent.com/u/29334003?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Loccret", "html_url": "https://github.com/Loccret", "followers_url": "https://api.github.com/users/Loccret/followers", "following_url": "https://api.github.com/users/Loccret/following{/other_user}", "gists_url": "https://api.github.com/users/Loccret/gists{/gist_id}", "starred_url": "https://api.github.com/users/Loccret/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Loccret/subscriptions", "organizations_url": "https://api.github.com/users/Loccret/orgs", "repos_url": "https://api.github.com/users/Loccret/repos", "events_url": "https://api.github.com/users/Loccret/events{/privacy}", "received_events_url": "https://api.github.com/users/Loccret/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2023-03-22T05:42:19Z", "updated_at": "2023-03-22T07:43:55Z", "closed_at": "2023-03-22T07:43:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nBased on #2351 and #1789, as well as [this demo](https://gist.github.com/toshihikoyanase/593246a6d00d6e9ec52de7b7c0f346f3), I attempted to silence the fitting information during parallel processing by using ``optuna.logging.set_verbosity(optuna.logging.WARNING)``. \r\n\r\nHowever, messages such as ``[I 2020-07-21 13:41:45,627] Trial 0 finished with value:...`` are still appearing. \r\n\r\nIs this a bug?\n\n### Environment\n\n- Optuna version: 3.1.0\r\n- Python version: 3.10.9\r\n- OS: Linux-5.4.0-100-generic-x86_64-with-glibc2.31\r\n- VSCODE: 1.76.2\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\n[I 2023-03-22 14:30:17,032] Trial 0 finished with value: 5723.52747953425 and parameters: {'x': 75.6606071845465, 'y': -1}. Best is trial 0 with value: 5723.52747953425.\r\n[I 2023-03-22 14:30:17,074] Trial 1 finished with value: 2605.510351636972 and parameters: {'x': -51.05399447288108, 'y': -1}. Best is trial 1 with value: 2605.510351636972.\r\n[I 2023-03-22 14:30:18,571] Trial 2 finished with value: 1940.0358215132312 and parameters: {'x': 44.05718807996297, 'y': -1}. Best is trial 2 with value: 1940.0358215132312.\r\n[I 2023-03-22 14:30:18,763] Trial 3 finished with value: 3517.442686295927 and parameters: {'x': 59.31646218627614, 'y': -1}. Best is trial 2 with value: 1940.0358215132312.\r\n[I 2023-03-22 14:30:19,366] Trial 4 finished with value: 1528.9714666911834 and parameters: {'x': -39.114849695367404, 'y': -1}. Best is trial 4 with value: 1528.9714666911834.\r\n[I 2023-03-22 14:30:19,526] Trial 5 finished with value: 2832.885982524888 and parameters: {'x': 53.23425572434434, 'y': -1}. Best is trial 7 with value: 168.16924829349912.\r\n...\n```\n\n\n### Steps to reproduce\n\n```python\r\nfrom joblib import Parallel, delayed\r\nimport optuna\r\n\r\nSTUDY_JOBS = 1  \r\nPARALLEL_JOBS = -1\r\nDELAYED_NUMBER = 80\r\nTRIALS = 2\r\noptuna.logging.set_verbosity(optuna.logging.WARNING)\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_float('x', -100, 100)\r\n    y = trial.suggest_categorical('y', [-1, 0, 1])\r\n    return x**2 + y\r\n\r\n\r\ndef optimize(n_trials):\r\n    study = optuna.load_study(study_name='joblib-quadratic', storage='sqlite:///example.db')\r\n    study.optimize(objective, n_trials=n_trials, n_jobs=STUDY_JOBS)\r\n\r\nif os.path.exists('example.db'):\r\n    os.remove('example.db')\r\n\r\nstudy = optuna.create_study(study_name='joblib-quadratic', storage='sqlite:///example.db')\r\n\r\nr = Parallel(n_jobs = PARALLEL_JOBS)([delayed(optimize)(TRIALS) for _ in range(DELAYED_NUMBER)])  \r\n\r\n\r\nprint('Number of finished trials: ', len(study.trials))\r\nprint('Best trial:')\r\ntrial = study.best_trial\r\nprint('  Value: ', trial.value)\r\nprint('  Params: ')\r\nfor key, value in trial.params.items():\r\n    print('    {}: {}'.format(key, value))\r\n```\r\n\n\n### Additional context (optional)\n\n![image](https://user-images.githubusercontent.com/29334003/226812311-3c7e5f55-f093-4355-960e-41b99d4b40f2.png)\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4529/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4529/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4512", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4512/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4512/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4512/events", "html_url": "https://github.com/optuna/optuna/pull/4512", "id": 1622909874, "node_id": "PR_kwDOB0okGM5L9_X2", "number": 4512, "title": "Fix noise becoming NaN for the terminator module", "user": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/54", "html_url": "https://github.com/optuna/optuna/milestone/54", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/54/labels", "id": 8862825, "node_id": "MI_kwDOB0okGM4Ahzxp", "number": 54, "title": "v3.2.0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 2, "closed_issues": 126, "state": "open", "created_at": "2023-01-17T07:03:31Z", "updated_at": "2023-04-27T06:35:24Z", "due_on": null, "closed_at": null}, "comments": 0, "created_at": "2023-03-14T07:44:22Z", "updated_at": "2023-04-21T08:58:18Z", "closed_at": "2023-03-14T08:41:57Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4512", "html_url": "https://github.com/optuna/optuna/pull/4512", "diff_url": "https://github.com/optuna/optuna/pull/4512.diff", "patch_url": "https://github.com/optuna/optuna/pull/4512.patch", "merged_at": "2023-03-14T08:41:57Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull request after it gets two or more approvals. To proceed to the review process by the maintainers, please make sure that the PR meets the following conditions: (1) it passes all CI checks, and (2) it is neither in the draft nor WIP state. If you wish to discuss the PR in the draft state or need any other help, please mention the Optuna development team in the PR. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nTo fix the CI. This bug is introduced in #4441 and #4488.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\nSet 0 std for 1 trial.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4512/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4512/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4480", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4480/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4480/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4480/events", "html_url": "https://github.com/optuna/optuna/pull/4480", "id": 1607127554, "node_id": "PR_kwDOB0okGM5LJWSS", "number": 4480, "title": "Make `QMCSampler` samplers reproducible with `seed=0`", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "gen740", "id": 54583542, "node_id": "MDQ6VXNlcjU0NTgzNTQy", "avatar_url": "https://avatars.githubusercontent.com/u/54583542?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gen740", "html_url": "https://github.com/gen740", "followers_url": "https://api.github.com/users/gen740/followers", "following_url": "https://api.github.com/users/gen740/following{/other_user}", "gists_url": "https://api.github.com/users/gen740/gists{/gist_id}", "starred_url": "https://api.github.com/users/gen740/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gen740/subscriptions", "organizations_url": "https://api.github.com/users/gen740/orgs", "repos_url": "https://api.github.com/users/gen740/repos", "events_url": "https://api.github.com/users/gen740/events{/privacy}", "received_events_url": "https://api.github.com/users/gen740/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gen740", "id": 54583542, "node_id": "MDQ6VXNlcjU0NTgzNTQy", "avatar_url": "https://avatars.githubusercontent.com/u/54583542?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gen740", "html_url": "https://github.com/gen740", "followers_url": "https://api.github.com/users/gen740/followers", "following_url": "https://api.github.com/users/gen740/following{/other_user}", "gists_url": "https://api.github.com/users/gen740/gists{/gist_id}", "starred_url": "https://api.github.com/users/gen740/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gen740/subscriptions", "organizations_url": "https://api.github.com/users/gen740/orgs", "repos_url": "https://api.github.com/users/gen740/repos", "events_url": "https://api.github.com/users/gen740/events{/privacy}", "received_events_url": "https://api.github.com/users/gen740/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/54", "html_url": "https://github.com/optuna/optuna/milestone/54", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/54/labels", "id": 8862825, "node_id": "MI_kwDOB0okGM4Ahzxp", "number": 54, "title": "v3.2.0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 2, "closed_issues": 126, "state": "open", "created_at": "2023-01-17T07:03:31Z", "updated_at": "2023-04-27T06:35:24Z", "due_on": null, "closed_at": null}, "comments": 8, "created_at": "2023-03-02T16:33:25Z", "updated_at": "2023-03-13T01:35:44Z", "closed_at": "2023-03-10T05:33:09Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4480", "html_url": "https://github.com/optuna/optuna/pull/4480", "diff_url": "https://github.com/optuna/optuna/pull/4480.diff", "patch_url": "https://github.com/optuna/optuna/pull/4480.patch", "merged_at": "2023-03-10T05:33:09Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull request after it gets two or more approvals. To proceed to the review process by the maintainers, please make sure that the PR meets the following conditions: (1) it passes all CI checks, and (2) it is neither in the draft nor WIP state. If you wish to discuss the PR in the draft state or need any other help, please mention the Optuna development team in the PR. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\nResolve https://github.com/optuna/optuna/issues/4472.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\n- Fix the seeding part as suggested by #4472 (thanks!)\r\n- Fix docs ", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4480/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4480/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4474", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4474/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4474/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4474/events", "html_url": "https://github.com/optuna/optuna/issues/4474", "id": 1602990611, "node_id": "I_kwDOB0okGM5fi7IT", "number": 4474, "title": "`study.enqueue_trial()` is saving the input parameters to the `system_attrs` rather than the `params` field of trial object ", "user": {"login": "yusufguleray", "id": 37416240, "node_id": "MDQ6VXNlcjM3NDE2MjQw", "avatar_url": "https://avatars.githubusercontent.com/u/37416240?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yusufguleray", "html_url": "https://github.com/yusufguleray", "followers_url": "https://api.github.com/users/yusufguleray/followers", "following_url": "https://api.github.com/users/yusufguleray/following{/other_user}", "gists_url": "https://api.github.com/users/yusufguleray/gists{/gist_id}", "starred_url": "https://api.github.com/users/yusufguleray/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yusufguleray/subscriptions", "organizations_url": "https://api.github.com/users/yusufguleray/orgs", "repos_url": "https://api.github.com/users/yusufguleray/repos", "events_url": "https://api.github.com/users/yusufguleray/events{/privacy}", "received_events_url": "https://api.github.com/users/yusufguleray/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2023-02-28T12:35:41Z", "updated_at": "2023-02-28T15:05:24Z", "closed_at": "2023-02-28T14:56:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nExpected behavior was study.enqueue_trial() to enqueue a trial with given parameter values but it saves the input parameters to the `system_attrs` rather than the `params` attribute of the `trial` object. Hence it when the objective function runs, it complains that:\r\n\r\n`The value of the parameter 'x' is not found. Please set it at the construction of the FrozenTrial object.`\r\n\r\n### Environment\r\n\r\n- Optuna version: 3.1.0\r\n- Python version: 3.8.10\r\n- OS: Ubuntu 20.04.5 LTS\r\n\r\n\r\n### Steps to reproduce\r\n\r\n```python\r\nimport optuna\r\n\r\nstudy = optuna.create_study()\r\nstudy.enqueue_trial({\"x\": 3})\r\n```\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\n->study.trials[-1]\r\n->FrozenTrial(number=0, state=TrialState.WAITING, values=None, datetime_start=None, \r\n  datetime_complete=None, params={}, user_attrs={}, system_attrs={'fixed_params': {'x': 3}}, \r\n  intermediate_values={}, distributions={}, trial_id=0, value=None)\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4474/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4474/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4472", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4472/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4472/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4472/events", "html_url": "https://github.com/optuna/optuna/issues/4472", "id": 1601307011, "node_id": "I_kwDOB0okGM5fcgGD", "number": 4472, "title": "QMSSampler incorrectly discards `seed=0`", "user": {"login": "Yura52", "id": 8861742, "node_id": "MDQ6VXNlcjg4NjE3NDI=", "avatar_url": "https://avatars.githubusercontent.com/u/8861742?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Yura52", "html_url": "https://github.com/Yura52", "followers_url": "https://api.github.com/users/Yura52/followers", "following_url": "https://api.github.com/users/Yura52/following{/other_user}", "gists_url": "https://api.github.com/users/Yura52/gists{/gist_id}", "starred_url": "https://api.github.com/users/Yura52/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Yura52/subscriptions", "organizations_url": "https://api.github.com/users/Yura52/orgs", "repos_url": "https://api.github.com/users/Yura52/repos", "events_url": "https://api.github.com/users/Yura52/events{/privacy}", "received_events_url": "https://api.github.com/users/Yura52/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}, {"id": 1846694757, "node_id": "MDU6TGFiZWwxODQ2Njk0NzU3", "url": "https://api.github.com/repos/optuna/optuna/labels/good%20first%20issue", "name": "good first issue", "color": "c2e0c6", "default": true, "description": "Good first issue for contribution."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-02-27T14:31:24Z", "updated_at": "2023-03-10T05:33:10Z", "closed_at": "2023-03-10T05:33:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nI have not used this sampler, but there is a bug which comes into play when `seed=0`\r\nhttps://github.com/optuna/optuna/blob/e774c0be70188ae3e62e9d66ad6949bbccc0e149/optuna/samplers/_qmc.py#L155\r\n\r\nIt should be this instead:\r\n\r\n```\r\nself._seed = np.random.PCG64().random_raw() if seed is None else seed\r\n```\n\n### Environment\n\nN/A\n\n### Error messages, stack traces, or logs\n\n```shell\nN/A\n```\n\n\n### Steps to reproduce\n\nN/A\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4472/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4472/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4465", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4465/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4465/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4465/events", "html_url": "https://github.com/optuna/optuna/issues/4465", "id": 1599887083, "node_id": "I_kwDOB0okGM5fXFbr", "number": 4465, "title": "ValueError: No trials are completed yet.", "user": {"login": "Boonsrp029", "id": 49550816, "node_id": "MDQ6VXNlcjQ5NTUwODE2", "avatar_url": "https://avatars.githubusercontent.com/u/49550816?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Boonsrp029", "html_url": "https://github.com/Boonsrp029", "followers_url": "https://api.github.com/users/Boonsrp029/followers", "following_url": "https://api.github.com/users/Boonsrp029/following{/other_user}", "gists_url": "https://api.github.com/users/Boonsrp029/gists{/gist_id}", "starred_url": "https://api.github.com/users/Boonsrp029/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Boonsrp029/subscriptions", "organizations_url": "https://api.github.com/users/Boonsrp029/orgs", "repos_url": "https://api.github.com/users/Boonsrp029/repos", "events_url": "https://api.github.com/users/Boonsrp029/events{/privacy}", "received_events_url": "https://api.github.com/users/Boonsrp029/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2023-02-26T00:44:50Z", "updated_at": "2023-02-26T10:56:56Z", "closed_at": "2023-02-26T10:56:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nI'm running an Optuna optimization on an automatic stock trading system using RL model SAC and run into this error \"ValueError: No trials are completed yet.\"\r\nHere's my code I'm using\r\n![Screenshot 2023-02-26 074301](https://user-images.githubusercontent.com/49550816/221386251-98013e71-7c2c-409f-a9b1-25778760d7e5.png)\r\n\n\n### Environment\n\n- Optuna version: 3.1.0\r\n- Python version: 3.7.16 (Virtual Environment)\r\n- OS: Windows 11\r\n- (Optional) Other libraries and their versions:\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\n[W 2023-02-26 07:33:10,218] Trial 0 failed with parameters: {'buffer_size': 100000, 'learning_rate': 0.009846738873614562, 'batch_size': 1024} because of the following error: ValueError('Expected parameter loc (Tensor of shape (1, 1)) of distribution Normal(loc: tensor([[nan]]), scale: tensor([[nan]])) to satisfy the constraint Real(), but found invalid values:\\ntensor([[nan]])').\r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\acer\\anaconda3\\envs\\py3716\\lib\\site-packages\\optuna\\study\\_optimize.py\", line 200, in _run_trial\r\n    value_or_values = func(trial)\r\n  File \"C:\\Users\\acer\\AppData\\Local\\Temp\\ipykernel_1212\\824037377.py\", line 14, in objective\r\n    total_timesteps=50000)\r\n  File \"C:\\Users\\acer\\anaconda3\\envs\\py3716\\lib\\site-packages\\finrl\\agents\\stablebaselines3\\models.py\", line 106, in train_model\r\n    callback=TensorboardCallback(),\r\n  File \"C:\\Users\\acer\\anaconda3\\envs\\py3716\\lib\\site-packages\\stable_baselines3\\sac\\sac.py\", line 305, in learn\r\n    progress_bar=progress_bar,\r\n  File \"C:\\Users\\acer\\anaconda3\\envs\\py3716\\lib\\site-packages\\stable_baselines3\\common\\off_policy_algorithm.py\", line 341, in learn\r\n    log_interval=log_interval,\r\n  File \"C:\\Users\\acer\\anaconda3\\envs\\py3716\\lib\\site-packages\\stable_baselines3\\common\\off_policy_algorithm.py\", line 564, in collect_rollouts\r\n    actions, buffer_actions = self._sample_action(learning_starts, action_noise, env.num_envs)\r\n  File \"C:\\Users\\acer\\anaconda3\\envs\\py3716\\lib\\site-packages\\stable_baselines3\\common\\off_policy_algorithm.py\", line 395, in _sample_action\r\n    unscaled_action, _ = self.predict(self._last_obs, deterministic=False)\r\n  File \"C:\\Users\\acer\\anaconda3\\envs\\py3716\\lib\\site-packages\\stable_baselines3\\common\\base_class.py\", line 535, in predict\r\n    return self.policy.predict(observation, state, episode_start, deterministic)\r\n  File \"C:\\Users\\acer\\anaconda3\\envs\\py3716\\lib\\site-packages\\stable_baselines3\\common\\policies.py\", line 343, in predict\r\n    actions = self._predict(observation, deterministic=deterministic)\r\n  File \"C:\\Users\\acer\\anaconda3\\envs\\py3716\\lib\\site-packages\\stable_baselines3\\sac\\policies.py\", line 341, in _predict\r\n    return self.actor(observation, deterministic)\r\n  File \"C:\\Users\\acer\\anaconda3\\envs\\py3716\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 1194, in _call_impl\r\n    return forward_call(*input, **kwargs)\r\n  File \"C:\\Users\\acer\\anaconda3\\envs\\py3716\\lib\\site-packages\\stable_baselines3\\sac\\policies.py\", line 168, in forward\r\n    return self.action_dist.actions_from_params(mean_actions, log_std, deterministic=deterministic, **kwargs)\r\n  File \"C:\\Users\\acer\\anaconda3\\envs\\py3716\\lib\\site-packages\\stable_baselines3\\common\\distributions.py\", line 190, in actions_from_params\r\n    self.proba_distribution(mean_actions, log_std)\r\n  File \"C:\\Users\\acer\\anaconda3\\envs\\py3716\\lib\\site-packages\\stable_baselines3\\common\\distributions.py\", line 224, in proba_distribution\r\n    super().proba_distribution(mean_actions, log_std)\r\n  File \"C:\\Users\\acer\\anaconda3\\envs\\py3716\\lib\\site-packages\\stable_baselines3\\common\\distributions.py\", line 164, in proba_distribution\r\n    self.distribution = Normal(mean_actions, action_std)\r\n  File \"C:\\Users\\acer\\anaconda3\\envs\\py3716\\lib\\site-packages\\torch\\distributions\\normal.py\", line 56, in __init__\r\n    super(Normal, self).__init__(batch_shape, validate_args=validate_args)\r\n  File \"C:\\Users\\acer\\anaconda3\\envs\\py3716\\lib\\site-packages\\torch\\distributions\\distribution.py\", line 57, in __init__\r\n    f\"Expected parameter {param} \"\r\nValueError: Expected parameter loc (Tensor of shape (1, 1)) of distribution Normal(loc: tensor([[nan]]), scale: tensor([[nan]])) to satisfy the constraint Real(), but found invalid values:\r\ntensor([[nan]])\r\n[W 2023-02-26 07:33:10,220] Trial 0 failed with value None.\r\nValueError                                Traceback (most recent call last)\r\n~\\AppData\\Local\\Temp\\ipykernel_1212\\824037377.py in <module>\r\n     30 logging_callback = LoggingCallback(threshold=1e-5,patience=30,trial_number=20)\r\n     31 #You can increase the n_trials for a better search space scanning\r\n---> 32 study.optimize(objective, n_trials=20,catch=(ValueError,),callbacks=[logging_callback])\r\n\r\n~\\anaconda3\\envs\\py3716\\lib\\site-packages\\optuna\\study\\study.py in optimize(self, func, n_trials, timeout, n_jobs, catch, callbacks, gc_after_trial, show_progress_bar)\r\n    432             callbacks=callbacks,\r\n    433             gc_after_trial=gc_after_trial,\r\n--> 434             show_progress_bar=show_progress_bar,\r\n    435         )\r\n    436 \r\n\r\n~\\anaconda3\\envs\\py3716\\lib\\site-packages\\optuna\\study\\_optimize.py in _optimize(study, func, n_trials, timeout, n_jobs, catch, callbacks, gc_after_trial, show_progress_bar)\r\n     74                 reseed_sampler_rng=False,\r\n     75                 time_start=None,\r\n---> 76                 progress_bar=progress_bar,\r\n     77             )\r\n     78         else:\r\n\r\n~\\anaconda3\\envs\\py3716\\lib\\site-packages\\optuna\\study\\_optimize.py in _optimize_sequential(study, func, n_trials, timeout, catch, callbacks, gc_after_trial, reseed_sampler_rng, time_start, progress_bar)\r\n    172         if callbacks is not None:\r\n    173             for callback in callbacks:\r\n--> 174                 callback(study, frozen_trial)\r\n    175 \r\n    176         if progress_bar is not None:\r\n\r\n~\\AppData\\Local\\Temp\\ipykernel_1212\\2132487556.py in __call__(self, study, frozen_trial)\r\n     12     def __call__(self,study:optuna.study, frozen_trial:optuna.Trial):\r\n     13       #Setting the best value in the current trial\r\n---> 14       study.set_user_attr(\"previous_best_value\", study.best_value)\r\n     15 \r\n     16       #Checking if the minimum number of trials have pass\r\n\r\n~\\anaconda3\\envs\\py3716\\lib\\site-packages\\optuna\\study\\study.py in best_value(self)\r\n    128         \"\"\"\r\n    129 \r\n--> 130         best_value = self.best_trial.value\r\n    131         assert best_value is not None\r\n    132 \r\n\r\n~\\anaconda3\\envs\\py3716\\lib\\site-packages\\optuna\\study\\study.py in best_trial(self)\r\n    157             )\r\n    158 \r\n--> 159         return copy.deepcopy(self._storage.get_best_trial(self._study_id))\r\n    160 \r\n    161     @property\r\n\r\n~\\anaconda3\\envs\\py3716\\lib\\site-packages\\optuna\\storages\\_in_memory.py in get_best_trial(self, study_id)\r\n    248 \r\n    249             if best_trial_id is None:\r\n--> 250                 raise ValueError(\"No trials are completed yet.\")\r\n    251             elif len(self._studies[study_id].directions) > 1:\r\n    252                 raise RuntimeError(\r\n\r\nValueError: No trials are completed yet.\n```\n\n\n### Steps to reproduce\n\n1.\r\n2.\r\n3.\r\n```python\r\n# python code\r\n```\r\n\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4465/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4465/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4462", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4462/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4462/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4462/events", "html_url": "https://github.com/optuna/optuna/pull/4462", "id": 1597942222, "node_id": "PR_kwDOB0okGM5Kqc5t", "number": 4462, "title": "Fix `param_mask` for multivariate TPE with `constant_liar`", "user": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "knshnb", "id": 23695091, "node_id": "MDQ6VXNlcjIzNjk1MDkx", "avatar_url": "https://avatars.githubusercontent.com/u/23695091?v=4", "gravatar_id": "", "url": "https://api.github.com/users/knshnb", "html_url": "https://github.com/knshnb", "followers_url": "https://api.github.com/users/knshnb/followers", "following_url": "https://api.github.com/users/knshnb/following{/other_user}", "gists_url": "https://api.github.com/users/knshnb/gists{/gist_id}", "starred_url": "https://api.github.com/users/knshnb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/knshnb/subscriptions", "organizations_url": "https://api.github.com/users/knshnb/orgs", "repos_url": "https://api.github.com/users/knshnb/repos", "events_url": "https://api.github.com/users/knshnb/events{/privacy}", "received_events_url": "https://api.github.com/users/knshnb/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "knshnb", "id": 23695091, "node_id": "MDQ6VXNlcjIzNjk1MDkx", "avatar_url": "https://avatars.githubusercontent.com/u/23695091?v=4", "gravatar_id": "", "url": "https://api.github.com/users/knshnb", "html_url": "https://github.com/knshnb", "followers_url": "https://api.github.com/users/knshnb/followers", "following_url": "https://api.github.com/users/knshnb/following{/other_user}", "gists_url": "https://api.github.com/users/knshnb/gists{/gist_id}", "starred_url": "https://api.github.com/users/knshnb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/knshnb/subscriptions", "organizations_url": "https://api.github.com/users/knshnb/orgs", "repos_url": "https://api.github.com/users/knshnb/repos", "events_url": "https://api.github.com/users/knshnb/events{/privacy}", "received_events_url": "https://api.github.com/users/knshnb/received_events", "type": "User", "site_admin": false}, {"login": "cross32768", "id": 34023087, "node_id": "MDQ6VXNlcjM0MDIzMDg3", "avatar_url": "https://avatars.githubusercontent.com/u/34023087?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cross32768", "html_url": "https://github.com/cross32768", "followers_url": "https://api.github.com/users/cross32768/followers", "following_url": "https://api.github.com/users/cross32768/following{/other_user}", "gists_url": "https://api.github.com/users/cross32768/gists{/gist_id}", "starred_url": "https://api.github.com/users/cross32768/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cross32768/subscriptions", "organizations_url": "https://api.github.com/users/cross32768/orgs", "repos_url": "https://api.github.com/users/cross32768/repos", "events_url": "https://api.github.com/users/cross32768/events{/privacy}", "received_events_url": "https://api.github.com/users/cross32768/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/54", "html_url": "https://github.com/optuna/optuna/milestone/54", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/54/labels", "id": 8862825, "node_id": "MI_kwDOB0okGM4Ahzxp", "number": 54, "title": "v3.2.0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 2, "closed_issues": 126, "state": "open", "created_at": "2023-01-17T07:03:31Z", "updated_at": "2023-04-27T06:35:24Z", "due_on": null, "closed_at": null}, "comments": 2, "created_at": "2023-02-24T05:43:32Z", "updated_at": "2023-04-21T09:00:13Z", "closed_at": "2023-03-02T06:17:03Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4462", "html_url": "https://github.com/optuna/optuna/pull/4462", "diff_url": "https://github.com/optuna/optuna/pull/4462.diff", "patch_url": "https://github.com/optuna/optuna/pull/4462.patch", "merged_at": "2023-03-02T06:17:03Z"}, "body": "## Motivation\r\nFix #4459.\r\n\r\nWhen `multivariate=True` and `constant_liar=True`, running trials may partially sample parameters in a relative search space. In this case, we need to check all parameters to make the mask.\r\n\r\n## Description of the changes\r\nCheck all parameters to make `param_mask`.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4462/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4462/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4459", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4459/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4459/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4459/events", "html_url": "https://github.com/optuna/optuna/issues/4459", "id": 1594723070, "node_id": "I_kwDOB0okGM5fDYr-", "number": 4459, "title": "Index out of bounds error in TpeSampler when multivariate=constant_liar=True and parallel jobs", "user": {"login": "CodeLionX", "id": 10573700, "node_id": "MDQ6VXNlcjEwNTczNzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10573700?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CodeLionX", "html_url": "https://github.com/CodeLionX", "followers_url": "https://api.github.com/users/CodeLionX/followers", "following_url": "https://api.github.com/users/CodeLionX/following{/other_user}", "gists_url": "https://api.github.com/users/CodeLionX/gists{/gist_id}", "starred_url": "https://api.github.com/users/CodeLionX/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CodeLionX/subscriptions", "organizations_url": "https://api.github.com/users/CodeLionX/orgs", "repos_url": "https://api.github.com/users/CodeLionX/repos", "events_url": "https://api.github.com/users/CodeLionX/events{/privacy}", "received_events_url": "https://api.github.com/users/CodeLionX/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2023-02-22T09:05:47Z", "updated_at": "2023-03-02T06:17:04Z", "closed_at": "2023-03-02T06:17:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nUnder a specific configuration using the `TPESampler` (see MWP below), Optuna raises an `IndexError` and stops the study.\r\nI expected Optuna to execute all configured trials without raising an `IndexError`.\n\n### Environment\n\n- Optuna version: 3.1.0\r\n- Python version: 3.8.16\r\n- OS: Linux-5.15.0-60-generic-x86_64-with-glibc2.17\r\n- (Optional) Other libraries and their versions: `conda env export`:\r\n  ```yaml                    \r\n  name: optuna-test\r\n  channels:\r\n    - defaults\r\n  dependencies:\r\n    - _libgcc_mutex=0.1=main\r\n    - _openmp_mutex=5.1=1_gnu\r\n    - ca-certificates=2023.01.10=h06a4308_0\r\n    - certifi=2022.12.7=py38h06a4308_0\r\n    - ld_impl_linux-64=2.38=h1181459_1\r\n    - libffi=3.4.2=h6a678d5_6\r\n    - libgcc-ng=11.2.0=h1234567_1\r\n    - libgomp=11.2.0=h1234567_1\r\n    - libstdcxx-ng=11.2.0=h1234567_1\r\n    - ncurses=6.4=h6a678d5_0\r\n    - openssl=1.1.1t=h7f8727e_0\r\n    - pip=22.3.1=py38h06a4308_0\r\n    - python=3.8.16=h7a1cb2a_2\r\n    - readline=8.2=h5eee18b_0\r\n    - setuptools=65.6.3=py38h06a4308_0\r\n    - sqlite=3.40.1=h5082296_0\r\n    - tk=8.6.12=h1ccaba5_0\r\n    - wheel=0.38.4=py38h06a4308_0\r\n    - xz=5.2.10=h5eee18b_1\r\n    - zlib=1.2.13=h5eee18b_0\r\n    - pip:\r\n        - alembic==1.9.4\r\n        - cmaes==0.9.1\r\n        - colorlog==6.7.0\r\n        - greenlet==2.0.2\r\n        - importlib-metadata==6.0.0\r\n        - importlib-resources==5.12.0\r\n        - mako==1.2.4\r\n        - markupsafe==2.1.2\r\n        - numpy==1.24.2\r\n        - optuna==3.1.0\r\n        - packaging==23.0\r\n        - pyyaml==6.0\r\n        - sqlalchemy==2.0.4\r\n        - tqdm==4.64.1\r\n        - typing-extensions==4.5.0\r\n        - zipp==3.14\r\n  ```\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\nscripts/optuna_tpe_multi_mwp.py:23: ExperimentalWarning: JournalStorage is experimental (supported from v3.1.0). The interface can change in the future.\r\n  storage = JournalStorage(\r\n<truncated>/python3.8/site-packages/optuna/samplers/_tpe/sampler.py:282: ExperimentalWarning: ``multivariate`` option is an experimental feature. The interface can change in the future.\r\n  warnings.warn(\r\n<truncated>/python3.8/site-packages/optuna/samplers/_tpe/sampler.py:301: ExperimentalWarning: ``constant_liar`` option is an experimental feature. The interface can change in the future.\r\n  warnings.warn(\r\n[I 2023-02-21 17:58:55,568] A new study created in Journal with name: TPESampler with multivariate and constant_liar (seed=42)\r\n[I 2023-02-21 17:58:55,604] Trial 1 finished with value: 0.30471707975443135 and parameters: {'int_param': 1, 'categorical_param': 'value2'}. Best is trial 0 with value: -1.0399841062404955.\r\n[I 2023-02-21 17:58:55,604] Trial 0 finished with value: -1.0399841062404955 and parameters: {'int_param': 6, 'categorical_param': 'value1'}. Best is trial 0 with value: -1.0399841062404955.\r\n[I 2023-02-21 17:58:55,638] Trial 3 finished with value: 0.7504511958064572 and parameters: {'int_param': 6, 'categorical_param': 'value1'}. Best is trial 0 with value: -1.0399841062404955.\r\n[I 2023-02-21 17:58:55,641] Trial 2 finished with value: 0.9405647163912139 and parameters: {'int_param': 2, 'categorical_param': 'value2'}. Best is trial 0 with value: -1.0399841062404955.\r\n[I 2023-02-21 17:58:55,683] Trial 4 finished with value: -1.9510351886538364 and parameters: {'int_param': 5, 'categorical_param': 'value2'}. Best is trial 4 with value: -1.9510351886538364.\r\n[I 2023-02-21 17:58:55,696] Trial 5 finished with value: -1.302179506862318 and parameters: {'int_param': 3, 'categorical_param': 'value2'}. Best is trial 4 with value: -1.9510351886538364.\r\n[I 2023-02-21 17:58:55,726] Trial 6 finished with value: 0.12784040316728537 and parameters: {'int_param': 2, 'categorical_param': 'value1'}. Best is trial 4 with value: -1.9510351886538364.\r\n[I 2023-02-21 17:58:55,753] Trial 7 finished with value: -0.3162425923435822 and parameters: {'int_param': 10, 'categorical_param': 'value1'}. Best is trial 4 with value: -1.9510351886538364.\r\n[I 2023-02-21 17:58:55,780] Trial 8 finished with value: -0.016801157504288795 and parameters: {'int_param': 10, 'categorical_param': 'value2'}. Best is trial 4 with value: -1.9510351886538364.\r\n[I 2023-02-21 17:58:55,808] Trial 9 finished with value: -0.85304392757358 and parameters: {'int_param': 9, 'categorical_param': 'value2'}. Best is trial 4 with value: -1.9510351886538364.\r\n[I 2023-02-21 17:58:55,856] Trial 10 finished with value: 0.8793979748628286 and parameters: {'int_param': 5, 'categorical_param': 'value2'}. Best is trial 4 with value: -1.9510351886538364.\r\nTraceback (most recent call last):\r\n  File \"scripts/optuna_tpe_multi_mwp.py\", line 41, in <module>\r\n    mwp(42 + i)\r\n  File \"scripts/optuna_tpe_multi_mwp.py\", line 33, in mwp\r\n    study.optimize(objective, n_trials=100, n_jobs=2)\r\n  File \"<truncated>/python3.8/site-packages/optuna/study/study.py\", line 425, in optimize\r\n    _optimize(\r\n  File \"<truncated>/python3.8/site-packages/optuna/study/_optimize.py\", line 103, in _optimize\r\n    f.result()\r\n  File \"<truncated>/python3.8/concurrent/futures/_base.py\", line 437, in result\r\n    return self.__get_result()\r\n  File \"<truncated>/python3.8/concurrent/futures/_base.py\", line 389, in __get_result\r\n    raise self._exception\r\n  File \"<truncated>/python3.8/concurrent/futures/thread.py\", line 57, in run\r\n    result = self.fn(*self.args, **self.kwargs)\r\n  File \"<truncated>/python3.8/site-packages/optuna/study/_optimize.py\", line 163, in _optimize_sequential\r\n    frozen_trial = _run_trial(study, func, catch)\r\n  File \"<truncated>/python3.8/site-packages/optuna/study/_optimize.py\", line 191, in _run_trial\r\n    trial = study.ask()\r\n  File \"<truncated>/python3.8/site-packages/optuna/study/study.py\", line 519, in ask\r\n    trial = trial_module.Trial(self, trial_id)\r\n  File \"<truncated>/python3.8/site-packages/optuna/trial/_trial.py\", line 56, in __init__\r\n    self._init_relative_params()\r\n  File \"<truncated>/python3.8/site-packages/optuna/trial/_trial.py\", line 66, in _init_relative_params\r\n    self.relative_params = self.study.sampler.sample_relative(\r\n  File \"<truncated>/python3.8/site-packages/optuna/samplers/_tpe/sampler.py\", line 377, in sample_relative\r\n    return self._sample_relative(study, trial, search_space)\r\n  File \"<truncated>/python3.8/site-packages/optuna/samplers/_tpe/sampler.py\", line 421, in _sample_relative\r\n    mpe_above = _ParzenEstimator(above, search_space, self._parzen_estimator_parameters)\r\n  File \"<truncated>/python3.8/site-packages/optuna/samplers/_tpe/parzen_estimator.py\", line 82, in __init__\r\n    categorical_weights = self._calculate_categorical_params(\r\n  File \"<truncated>/python3.8/site-packages/optuna/samplers/_tpe/parzen_estimator.py\", line 379, in _calculate_categorical_params\r\n    weights[np.arange(n_observations), observations] += 1\r\nIndexError: index -9223372036854775808 is out of bounds for axis 1 with size 2\n```\n\n\n### Steps to reproduce\n\n1. Install optuna 3.1.0\r\n2. Create an objective with at least one categorical and one integer parameter; the result is not relevant\r\n3. Use either the new `JournalFileStorage` or the `RDBStorage`. The `InMemoryStorage` does not raise the error.\r\n4. Create a study with the `TpeSampler` and `multivariate=True, constant_liar=True`\r\n5. Start the optimization in parallel using `n_jobs>=2`.\r\n\r\nMWP-code:\r\n\r\n```python\r\nfrom pathlib import Path\r\n\r\nimport numpy as np\r\nimport optuna\r\nfrom optuna import Trial\r\nfrom optuna.samplers import TPESampler\r\nfrom optuna.storages import JournalStorage, JournalFileStorage, JournalFileOpenLock\r\n\r\n\r\ndef mwp(seed: int) -> None:\r\n    rng = np.random.default_rng(seed)\r\n\r\n    def objective(trial: Trial) -> float:\r\n        # we need at least one categorical and one integer parameter:\r\n        int_param = trial.suggest_int(\"int_param\", 1, 10)\r\n        categorical_param = trial.suggest_categorical(\"categorical_param\", [\"value1\", \"value2\"])\r\n\r\n        # result is not relevant:\r\n        return rng.normal()\r\n\r\n    # we need a storage that serializes results; the in-memory-storage does not produce the error:\r\n    journal_file_path = Path.cwd() / \"test-optuna-journal.log\"\r\n    storage = JournalStorage(\r\n        JournalFileStorage(str(journal_file_path), lock_obj=JournalFileOpenLock(str(journal_file_path)))\r\n    )\r\n    study = optuna.create_study(\r\n        study_name=f\"TPESampler with multivariate and constant_liar (seed={seed})\",\r\n        storage=storage,\r\n        # the multivariate and constant_liar parameters must be set to True:\r\n        sampler=TPESampler(multivariate=True, constant_liar=True, warn_independent_sampling=False),\r\n    )\r\n    # optimize function in parallel (n_jobs >= 2):\r\n    study.optimize(objective, n_trials=100, n_jobs=2)\r\n\r\n    print(f\"... done! Best params with value={study.best_value}: {study.best_params}\")\r\n    journal_file_path.unlink(missing_ok=True)\r\n\r\n\r\nif __name__ == '__main__':\r\n    mwp(42)\r\n```\r\n\n\n### Additional context (optional)\n\nI started to look into the error, but couldn't find the source of it yet. This is the current state of my investigation:\r\n\r\nIn the following snippet:\r\n\r\nhttps://github.com/optuna/optuna/blob/6adfe8cd953b3b8d85aad3a6c0b0991cbdc6ad40/optuna/samplers/_tpe/sampler.py#L399-L410\r\n\r\n- `above` still contains `np.nan`s (last entry in array) for the categorical parameter (`categorical_param`)\r\n- when recalculating the weights later on, this `np.nan` is cast to `int` resulting in an underflow (value `-9223372036854775808`)\r\n\r\nBut I couldn't figure out why this `np.nan` is still in `above[\"categorical_param\"]` and it's just happening when I use parallelism and a non-in-memory-storage.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4459/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4459/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4454", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4454/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4454/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4454/events", "html_url": "https://github.com/optuna/optuna/issues/4454", "id": 1593949672, "node_id": "I_kwDOB0okGM5fAb3o", "number": 4454, "title": "How to handle mutually exclusive parameters with Optuna?", "user": {"login": "qzyu999", "id": 34221323, "node_id": "MDQ6VXNlcjM0MjIxMzIz", "avatar_url": "https://avatars.githubusercontent.com/u/34221323?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qzyu999", "html_url": "https://github.com/qzyu999", "followers_url": "https://api.github.com/users/qzyu999/followers", "following_url": "https://api.github.com/users/qzyu999/following{/other_user}", "gists_url": "https://api.github.com/users/qzyu999/gists{/gist_id}", "starred_url": "https://api.github.com/users/qzyu999/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qzyu999/subscriptions", "organizations_url": "https://api.github.com/users/qzyu999/orgs", "repos_url": "https://api.github.com/users/qzyu999/repos", "events_url": "https://api.github.com/users/qzyu999/events{/privacy}", "received_events_url": "https://api.github.com/users/qzyu999/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-02-21T18:45:59Z", "updated_at": "2023-02-22T00:01:15Z", "closed_at": "2023-02-22T00:01:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nI'm using logistic regression from sk-learn, and they have some parameters that are mutually exclusive. For example, if I want to use elasticnet, that requires that I have an l1_ratio argument. However, if I'm using l1 or l2 rather than elasticnet, then the l1_ratio isn't needed. Optuna however seems to not understand this, and keeps searching l1_ratio, while simultaneously searching l1, which gives many errors as it runs through the trials, but it also seems to be wasting the efficiency of the optimizer.\n\n### Environment\n\n- Optuna version: 2.2.0\r\n- Python version: 3.7.13\r\n- OS: Darwin-19.6.0-x86_64-i386-64bit\r\n- (Optional) Other libraries and their versions:\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\n[I 2023-02-21 10:38:18,334] A new study created in memory with name: no-name-1af8603b-c0d8-43f4-b404-a14fdd033588\r\n/Users/jaredyu/Desktop/projects/learn_pytorch/env/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py:1317: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l2)\r\n  \"(penalty={})\".format(self.penalty))\r\n/Users/jaredyu/Desktop/projects/learn_pytorch/env/lib/python3.7/site-packages/sklearn/linear_model/_sag.py:330: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge\r\n  \"the coef_ did not converge\", ConvergenceWarning)\r\n/Users/jaredyu/Desktop/projects/learn_pytorch/env/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py:1317: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l2)\r\n  \"(penalty={})\".format(self.penalty))\r\n/Users/jaredyu/Desktop/projects/learn_pytorch/env/lib/python3.7/site-packages/sklearn/linear_model/_sag.py:330: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge\r\n  \"the coef_ did not converge\", ConvergenceWarning)\r\n/Users/jaredyu/Desktop/projects/learn_pytorch/env/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py:1317: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l2)\r\n  \"(penalty={})\".format(self.penalty))\r\n/Users/jaredyu/Desktop/projects/learn_pytorch/env/lib/python3.7/site-packages/sklearn/linear_model/_sag.py:330: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge\r\n  \"the coef_ did not converge\", ConvergenceWarning)\r\n/Users/jaredyu/Desktop/projects/learn_pytorch/env/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py:1317: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l2)\r\n  \"(penalty={})\".format(self.penalty))\r\n/Users/jaredyu/Desktop/projects/learn_pytorch/env/lib/python3.7/site-packages/sklearn/linear_model/_sag.py:330: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge\r\n  \"the coef_ did not converge\", ConvergenceWarning)\r\n/Users/jaredyu/Desktop/projects/learn_pytorch/env/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py:1317: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l2)\r\n  \"(penalty={})\".format(self.penalty))\r\n/Users/jaredyu/Desktop/projects/learn_pytorch/env/lib/python3.7/site-packages/sklearn/linear_model/_sag.py:330: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge\r\n  \"the coef_ did not converge\", ConvergenceWarning)\r\n[I 2023-02-21 10:38:23,491] Trial 0 finished with value: 0.692613483642535 and parameters: {'penalty': 'l2', 'C': 30.233954930611343, 'l1_ratio': 0.14675589081711304}. Best is trial 0 with value: 0.692613483642535.\r\n/Users/jaredyu/Desktop/projects/learn_pytorch/env/lib/python3.7/site-packages/sklearn/linear_model/_sag.py:330: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge\r\n  \"the coef_ did not converge\", ConvergenceWarning)\r\n/Users/jaredyu/Desktop/projects/learn_pytorch/env/lib/python3.7/site-packages/sklearn/linear_model/_sag.py:330: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge\r\n  \"the coef_ did not converge\", ConvergenceWarning)\r\n/Users/jaredyu/Desktop/projects/learn_pytorch/env/lib/python3.7/site-packages/sklearn/linear_model/_sag.py:330: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge\r\n  \"the coef_ did not converge\", ConvergenceWarning)\r\n/Users/jaredyu/Desktop/projects/learn_pytorch/env/lib/python3.7/site-packages/sklearn/linear_model/_sag.py:330: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge\r\n  \"the coef_ did not converge\", ConvergenceWarning)\r\n/Users/jaredyu/Desktop/projects/learn_pytorch/env/lib/python3.7/site-packages/sklearn/linear_model/_sag.py:330: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge\r\n  \"the coef_ did not converge\", ConvergenceWarning)\r\n[I 2023-02-21 10:38:28,398] Trial 1 finished with value: 0.6926330057125805 and parameters: {'penalty': 'elasticnet', 'C': 39.67735065559276, 'l1_ratio': 0.538816734003357}. Best is trial 1 with value: 0.6926330057125805.\r\n/Users/jaredyu/Desktop/projects/learn_pytorch/env/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py:1317: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l2)\r\n  \"(penalty={})\".format(self.penalty))\r\n/Users/jaredyu/Desktop/projects/learn_pytorch/env/lib/python3.7/site-packages/sklearn/linear_model/_sag.py:330: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge\r\n  \"the coef_ did not converge\", ConvergenceWarning)\r\n/Users/jaredyu/Desktop/projects/learn_pytorch/env/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py:1317: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l2)\r\n  \"(penalty={})\".format(self.penalty))\r\n/Users/jaredyu/Desktop/projects/learn_pytorch/env/lib/python3.7/site-packages/sklearn/linear_model/_sag.py:330: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge\r\n  \"the coef_ did not converge\", ConvergenceWarning)\r\n/Users/jaredyu/Desktop/projects/learn_pytorch/env/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py:1317: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l2)\r\n  \"(penalty={})\".format(self.penalty))\r\n/Users/jaredyu/Desktop/projects/learn_pytorch/env/lib/python3.7/site-packages/sklearn/linear_model/_sag.py:330: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge\r\n  \"the coef_ did not converge\", ConvergenceWarning)\r\n/Users/jaredyu/Desktop/projects/learn_pytorch/env/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py:1317: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l2)\r\n  \"(penalty={})\".format(self.penalty))\r\n/Users/jaredyu/Desktop/projects/learn_pytorch/env/lib/python3.7/site-packages/sklearn/linear_model/_sag.py:330: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge\r\n  \"the coef_ did not converge\", ConvergenceWarning)\r\n/Users/jaredyu/Desktop/projects/learn_pytorch/env/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py:1317: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l2)\r\n  \"(penalty={})\".format(self.penalty))\r\n/Users/jaredyu/Desktop/projects/learn_pytorch/env/lib/python3.7/site-packages/sklearn/linear_model/_sag.py:330: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge\r\n  \"the coef_ did not converge\", ConvergenceWarning)\n```\n\n\n### Steps to reproduce\n\n1. Run Optuna with sklearn's LogisticRegression\r\n2. Include the following params listed below:\r\n3. See errors\r\n```python\r\nmodel_params={\r\n    'suggest_categorical': {\r\n        'penalty': {\r\n            'key_1': 'l1',\r\n            'key_2': 'l2',\r\n            'key_3':'elasticnet'\r\n        },\r\n    },\r\n    'suggest_float': {\r\n        'C': {\r\n            'low': 0.001,\r\n            'high': 100,\r\n        },\r\n        'l1_ratio': {\r\n            'low': 0,\r\n            'high': 1,\r\n        },\r\n    },\r\n    'solver': 'saga'\r\n}\r\n```\r\n\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4454/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4454/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4453", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4453/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4453/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4453/events", "html_url": "https://github.com/optuna/optuna/issues/4453", "id": 1593709824, "node_id": "I_kwDOB0okGM5e_hUA", "number": 4453, "title": "Spurious test failures related to timestamp ordering on s390x", "user": {"login": "gspr", "id": 1938071, "node_id": "MDQ6VXNlcjE5MzgwNzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1938071?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gspr", "html_url": "https://github.com/gspr", "followers_url": "https://api.github.com/users/gspr/followers", "following_url": "https://api.github.com/users/gspr/following{/other_user}", "gists_url": "https://api.github.com/users/gspr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gspr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gspr/subscriptions", "organizations_url": "https://api.github.com/users/gspr/orgs", "repos_url": "https://api.github.com/users/gspr/repos", "events_url": "https://api.github.com/users/gspr/events{/privacy}", "received_events_url": "https://api.github.com/users/gspr/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2023-02-21T15:48:04Z", "updated_at": "2023-04-07T05:43:47Z", "closed_at": "2023-04-07T05:43:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nTests should pass on s390x just as they do on other architectures. On other architectures they pass fine, on s390x they *sometimes* (around 20% of the time by my observation) fail with an error relating to the ordering of time points.\r\n\r\n### Environment\r\n\r\n- Optuna version: 3.1.0\r\n- Python version: 3.11.2\r\n- OS: Linux-5.10.0-21-s390x-s390x-with-glibc2.36\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```\r\n============================================================== test session starts ===============================================================\r\nplatform linux -- Python 3.11.2, pytest-7.2.1, pluggy-1.0.0+repack -- /usr/bin/python3\r\ncachedir: .pytest_cache\r\nrootdir: /home/gspr/tmp/optuna-3.1.0, configfile: pyproject.toml\r\ncollected 212 items                                                                                                                              \r\n\r\ntest_storages.py::test_get_storage PASSED                                                                                                  [  0%]\r\ntest_storages.py::test_create_new_study[inmemory] PASSED                                                                                   [  0%]\r\ntest_storages.py::test_create_new_study[sqlite] PASSED                                                                                     [  1%]\r\ntest_storages.py::test_create_new_study[cached_sqlite] PASSED                                                                              [  1%]\r\ntest_storages.py::test_create_new_study[journal] PASSED                                                                                    [  2%]\r\ntest_storages.py::test_create_new_study[journal_redis] PASSED                                                                              [  2%]\r\ntest_storages.py::test_create_new_study[dask] SKIPPED (distributed doesn't yet support Python 3.11)                                        [  3%]\r\ntest_storages.py::test_create_new_study_unique_id[inmemory] PASSED                                                                         [  3%]\r\ntest_storages.py::test_create_new_study_unique_id[sqlite] PASSED                                                                           [  4%]\r\ntest_storages.py::test_create_new_study_unique_id[cached_sqlite] PASSED                                                                    [  4%]\r\ntest_storages.py::test_create_new_study_unique_id[journal] PASSED                                                                          [  5%]\r\ntest_storages.py::test_create_new_study_unique_id[journal_redis] PASSED                                                                    [  5%]\r\ntest_storages.py::test_create_new_study_unique_id[dask] SKIPPED (distributed doesn't yet support Python 3.11)                              [  6%]\r\ntest_storages.py::test_create_new_study_with_name[inmemory] PASSED                                                                         [  6%]\r\ntest_storages.py::test_create_new_study_with_name[sqlite] PASSED                                                                           [  7%]\r\ntest_storages.py::test_create_new_study_with_name[cached_sqlite] PASSED                                                                    [  7%]\r\ntest_storages.py::test_create_new_study_with_name[journal] PASSED                                                                          [  8%]\r\ntest_storages.py::test_create_new_study_with_name[journal_redis] PASSED                                                                    [  8%]\r\ntest_storages.py::test_create_new_study_with_name[dask] SKIPPED (distributed doesn't yet support Python 3.11)                              [  8%]\r\ntest_storages.py::test_delete_study[inmemory] PASSED                                                                                       [  9%]\r\ntest_storages.py::test_delete_study[sqlite] PASSED                                                                                         [  9%]\r\ntest_storages.py::test_delete_study[cached_sqlite] PASSED                                                                                  [ 10%]\r\ntest_storages.py::test_delete_study[journal] PASSED                                                                                        [ 10%]\r\ntest_storages.py::test_delete_study[journal_redis] PASSED                                                                                  [ 11%]\r\ntest_storages.py::test_delete_study[dask] SKIPPED (distributed doesn't yet support Python 3.11)                                            [ 11%]\r\ntest_storages.py::test_delete_study_after_create_multiple_studies[inmemory] PASSED                                                         [ 12%]\r\ntest_storages.py::test_delete_study_after_create_multiple_studies[sqlite] PASSED                                                           [ 12%]\r\ntest_storages.py::test_delete_study_after_create_multiple_studies[cached_sqlite] PASSED                                                    [ 13%]\r\ntest_storages.py::test_delete_study_after_create_multiple_studies[journal] PASSED                                                          [ 13%]\r\ntest_storages.py::test_delete_study_after_create_multiple_studies[journal_redis] PASSED                                                    [ 14%]\r\ntest_storages.py::test_delete_study_after_create_multiple_studies[dask] SKIPPED (distributed doesn't yet support Python 3.11)              [ 14%]\r\ntest_storages.py::test_get_study_id_from_name_and_get_study_name_from_id[inmemory] PASSED                                                  [ 15%]\r\ntest_storages.py::test_get_study_id_from_name_and_get_study_name_from_id[sqlite] PASSED                                                    [ 15%]\r\ntest_storages.py::test_get_study_id_from_name_and_get_study_name_from_id[cached_sqlite] PASSED                                             [ 16%]\r\ntest_storages.py::test_get_study_id_from_name_and_get_study_name_from_id[journal] PASSED                                                   [ 16%]\r\ntest_storages.py::test_get_study_id_from_name_and_get_study_name_from_id[journal_redis] PASSED                                             [ 16%]\r\ntest_storages.py::test_get_study_id_from_name_and_get_study_name_from_id[dask] SKIPPED (distributed doesn't yet support Python 3.11)       [ 17%]\r\ntest_storages.py::test_set_and_get_study_directions[inmemory] PASSED                                                                       [ 17%]\r\ntest_storages.py::test_set_and_get_study_directions[sqlite] PASSED                                                                         [ 18%]\r\ntest_storages.py::test_set_and_get_study_directions[cached_sqlite] PASSED                                                                  [ 18%]\r\ntest_storages.py::test_set_and_get_study_directions[journal] PASSED                                                                        [ 19%]\r\ntest_storages.py::test_set_and_get_study_directions[journal_redis] PASSED                                                                  [ 19%]\r\ntest_storages.py::test_set_and_get_study_directions[dask] SKIPPED (distributed doesn't yet support Python 3.11)                            [ 20%]\r\ntest_storages.py::test_set_and_get_study_user_attrs[inmemory] PASSED                                                                       [ 20%]\r\ntest_storages.py::test_set_and_get_study_user_attrs[sqlite] PASSED                                                                         [ 21%]\r\ntest_storages.py::test_set_and_get_study_user_attrs[cached_sqlite] PASSED                                                                  [ 21%]\r\ntest_storages.py::test_set_and_get_study_user_attrs[journal] PASSED                                                                        [ 22%]\r\ntest_storages.py::test_set_and_get_study_user_attrs[journal_redis] PASSED                                                                  [ 22%]\r\ntest_storages.py::test_set_and_get_study_user_attrs[dask] SKIPPED (distributed doesn't yet support Python 3.11)                            [ 23%]\r\ntest_storages.py::test_set_and_get_study_system_attrs[inmemory] PASSED                                                                     [ 23%]\r\ntest_storages.py::test_set_and_get_study_system_attrs[sqlite] PASSED                                                                       [ 24%]\r\ntest_storages.py::test_set_and_get_study_system_attrs[cached_sqlite] PASSED                                                                [ 24%]\r\ntest_storages.py::test_set_and_get_study_system_attrs[journal] PASSED                                                                      [ 25%]\r\ntest_storages.py::test_set_and_get_study_system_attrs[journal_redis] PASSED                                                                [ 25%]\r\ntest_storages.py::test_set_and_get_study_system_attrs[dask] SKIPPED (distributed doesn't yet support Python 3.11)                          [ 25%]\r\ntest_storages.py::test_study_user_and_system_attrs_confusion[inmemory] PASSED                                                              [ 26%]\r\ntest_storages.py::test_study_user_and_system_attrs_confusion[sqlite] PASSED                                                                [ 26%]\r\ntest_storages.py::test_study_user_and_system_attrs_confusion[cached_sqlite] PASSED                                                         [ 27%]\r\ntest_storages.py::test_study_user_and_system_attrs_confusion[journal] PASSED                                                               [ 27%]\r\ntest_storages.py::test_study_user_and_system_attrs_confusion[journal_redis] PASSED                                                         [ 28%]\r\ntest_storages.py::test_study_user_and_system_attrs_confusion[dask] SKIPPED (distributed doesn't yet support Python 3.11)                   [ 28%]\r\ntest_storages.py::test_create_new_trial[inmemory] PASSED                                                                                   [ 29%]\r\ntest_storages.py::test_create_new_trial[sqlite] PASSED                                                                                     [ 29%]\r\ntest_storages.py::test_create_new_trial[cached_sqlite] PASSED                                                                              [ 30%]\r\ntest_storages.py::test_create_new_trial[journal] FAILED                                                                                    [ 30%]\r\ntest_storages.py::test_create_new_trial[journal_redis] PASSED                                                                              [ 31%]\r\ntest_storages.py::test_create_new_trial[dask] SKIPPED (distributed doesn't yet support Python 3.11)                                        [ 31%]\r\ntest_storages.py::test_create_new_trial_with_template_trial[start_time0-complete_time0-inmemory] PASSED                                    [ 32%]\r\ntest_storages.py::test_create_new_trial_with_template_trial[start_time0-complete_time0-sqlite] PASSED                                      [ 32%]\r\ntest_storages.py::test_create_new_trial_with_template_trial[start_time0-complete_time0-cached_sqlite] PASSED                               [ 33%]\r\ntest_storages.py::test_create_new_trial_with_template_trial[start_time0-complete_time0-journal] PASSED                                     [ 33%]\r\ntest_storages.py::test_create_new_trial_with_template_trial[start_time0-complete_time0-journal_redis] PASSED                               [ 33%]\r\ntest_storages.py::test_create_new_trial_with_template_trial[start_time0-complete_time0-dask] SKIPPED (distributed doesn't yet support ...) [ 34%]\r\ntest_storages.py::test_create_new_trial_with_template_trial[start_time1-complete_time1-inmemory] PASSED                                    [ 34%]\r\ntest_storages.py::test_create_new_trial_with_template_trial[start_time1-complete_time1-sqlite] PASSED                                      [ 35%]\r\ntest_storages.py::test_create_new_trial_with_template_trial[start_time1-complete_time1-cached_sqlite] PASSED                               [ 35%]\r\ntest_storages.py::test_create_new_trial_with_template_trial[start_time1-complete_time1-journal] PASSED                                     [ 36%]\r\ntest_storages.py::test_create_new_trial_with_template_trial[start_time1-complete_time1-journal_redis] PASSED                               [ 36%]\r\ntest_storages.py::test_create_new_trial_with_template_trial[start_time1-complete_time1-dask] SKIPPED (distributed doesn't yet support ...) [ 37%]\r\ntest_storages.py::test_get_trial_number_from_id[inmemory] PASSED                                                                           [ 37%]\r\ntest_storages.py::test_get_trial_number_from_id[sqlite] PASSED                                                                             [ 38%]\r\ntest_storages.py::test_get_trial_number_from_id[cached_sqlite] PASSED                                                                      [ 38%]\r\ntest_storages.py::test_get_trial_number_from_id[journal] PASSED                                                                            [ 39%]\r\ntest_storages.py::test_get_trial_number_from_id[journal_redis] PASSED                                                                      [ 39%]\r\ntest_storages.py::test_get_trial_number_from_id[dask] SKIPPED (distributed doesn't yet support Python 3.11)                                [ 40%]\r\ntest_storages.py::test_set_trial_state_values_for_state[inmemory] PASSED                                                                   [ 40%]\r\ntest_storages.py::test_set_trial_state_values_for_state[sqlite] PASSED                                                                     [ 41%]\r\ntest_storages.py::test_set_trial_state_values_for_state[cached_sqlite] PASSED                                                              [ 41%]\r\ntest_storages.py::test_set_trial_state_values_for_state[journal] PASSED                                                                    [ 41%]\r\ntest_storages.py::test_set_trial_state_values_for_state[journal_redis] PASSED                                                              [ 42%]\r\ntest_storages.py::test_set_trial_state_values_for_state[dask] SKIPPED (distributed doesn't yet support Python 3.11)                        [ 42%]\r\ntest_storages.py::test_get_trial_param_and_get_trial_params[inmemory] PASSED                                                               [ 43%]\r\ntest_storages.py::test_get_trial_param_and_get_trial_params[sqlite] PASSED                                                                 [ 43%]\r\ntest_storages.py::test_get_trial_param_and_get_trial_params[cached_sqlite] PASSED                                                          [ 44%]\r\ntest_storages.py::test_get_trial_param_and_get_trial_params[journal] PASSED                                                                [ 44%]\r\ntest_storages.py::test_get_trial_param_and_get_trial_params[journal_redis] PASSED                                                          [ 45%]\r\ntest_storages.py::test_get_trial_param_and_get_trial_params[dask] SKIPPED (distributed doesn't yet support Python 3.11)                    [ 45%]\r\ntest_storages.py::test_set_trial_param[inmemory] PASSED                                                                                    [ 46%]\r\ntest_storages.py::test_set_trial_param[sqlite] PASSED                                                                                      [ 46%]\r\ntest_storages.py::test_set_trial_param[cached_sqlite] PASSED                                                                               [ 47%]\r\ntest_storages.py::test_set_trial_param[journal] PASSED                                                                                     [ 47%]\r\ntest_storages.py::test_set_trial_param[journal_redis] PASSED                                                                               [ 48%]\r\ntest_storages.py::test_set_trial_param[dask] SKIPPED (distributed doesn't yet support Python 3.11)                                         [ 48%]\r\ntest_storages.py::test_set_trial_state_values_for_values[inmemory] PASSED                                                                  [ 49%]\r\ntest_storages.py::test_set_trial_state_values_for_values[sqlite] PASSED                                                                    [ 49%]\r\ntest_storages.py::test_set_trial_state_values_for_values[cached_sqlite] PASSED                                                             [ 50%]\r\ntest_storages.py::test_set_trial_state_values_for_values[journal] PASSED                                                                   [ 50%]\r\ntest_storages.py::test_set_trial_state_values_for_values[journal_redis] PASSED                                                             [ 50%]\r\ntest_storages.py::test_set_trial_state_values_for_values[dask] SKIPPED (distributed doesn't yet support Python 3.11)                       [ 51%]\r\ntest_storages.py::test_set_trial_intermediate_value[inmemory] PASSED                                                                       [ 51%]\r\ntest_storages.py::test_set_trial_intermediate_value[sqlite] PASSED                                                                         [ 52%]\r\ntest_storages.py::test_set_trial_intermediate_value[cached_sqlite] PASSED                                                                  [ 52%]\r\ntest_storages.py::test_set_trial_intermediate_value[journal] PASSED                                                                        [ 53%]\r\ntest_storages.py::test_set_trial_intermediate_value[journal_redis] PASSED                                                                  [ 53%]\r\ntest_storages.py::test_set_trial_intermediate_value[dask] SKIPPED (distributed doesn't yet support Python 3.11)                            [ 54%]\r\ntest_storages.py::test_get_trial_user_attrs[inmemory] PASSED                                                                               [ 54%]\r\ntest_storages.py::test_get_trial_user_attrs[sqlite] PASSED                                                                                 [ 55%]\r\ntest_storages.py::test_get_trial_user_attrs[cached_sqlite] PASSED                                                                          [ 55%]\r\ntest_storages.py::test_get_trial_user_attrs[journal] PASSED                                                                                [ 56%]\r\ntest_storages.py::test_get_trial_user_attrs[journal_redis] PASSED                                                                          [ 56%]\r\ntest_storages.py::test_get_trial_user_attrs[dask] SKIPPED (distributed doesn't yet support Python 3.11)                                    [ 57%]\r\ntest_storages.py::test_set_trial_user_attr[inmemory] PASSED                                                                                [ 57%]\r\ntest_storages.py::test_set_trial_user_attr[sqlite] PASSED                                                                                  [ 58%]\r\ntest_storages.py::test_set_trial_user_attr[cached_sqlite] PASSED                                                                           [ 58%]\r\ntest_storages.py::test_set_trial_user_attr[journal] PASSED                                                                                 [ 58%]\r\ntest_storages.py::test_set_trial_user_attr[journal_redis] PASSED                                                                           [ 59%]\r\ntest_storages.py::test_set_trial_user_attr[dask] SKIPPED (distributed doesn't yet support Python 3.11)                                     [ 59%]\r\ntest_storages.py::test_get_trial_system_attrs[inmemory] PASSED                                                                             [ 60%]\r\ntest_storages.py::test_get_trial_system_attrs[sqlite] PASSED                                                                               [ 60%]\r\ntest_storages.py::test_get_trial_system_attrs[cached_sqlite] PASSED                                                                        [ 61%]\r\ntest_storages.py::test_get_trial_system_attrs[journal] PASSED                                                                              [ 61%]\r\ntest_storages.py::test_get_trial_system_attrs[journal_redis] PASSED                                                                        [ 62%]\r\ntest_storages.py::test_get_trial_system_attrs[dask] SKIPPED (distributed doesn't yet support Python 3.11)                                  [ 62%]\r\ntest_storages.py::test_set_trial_system_attr[inmemory] PASSED                                                                              [ 63%]\r\ntest_storages.py::test_set_trial_system_attr[sqlite] PASSED                                                                                [ 63%]\r\ntest_storages.py::test_set_trial_system_attr[cached_sqlite] PASSED                                                                         [ 64%]\r\ntest_storages.py::test_set_trial_system_attr[journal] PASSED                                                                               [ 64%]\r\ntest_storages.py::test_set_trial_system_attr[journal_redis] PASSED                                                                         [ 65%]\r\ntest_storages.py::test_set_trial_system_attr[dask] SKIPPED (distributed doesn't yet support Python 3.11)                                   [ 65%]\r\ntest_storages.py::test_get_all_studies[inmemory] PASSED                                                                                    [ 66%]\r\ntest_storages.py::test_get_all_studies[sqlite] PASSED                                                                                      [ 66%]\r\ntest_storages.py::test_get_all_studies[cached_sqlite] PASSED                                                                               [ 66%]\r\ntest_storages.py::test_get_all_studies[journal] PASSED                                                                                     [ 67%]\r\ntest_storages.py::test_get_all_studies[journal_redis] PASSED                                                                               [ 67%]\r\ntest_storages.py::test_get_all_studies[dask] SKIPPED (distributed doesn't yet support Python 3.11)                                         [ 68%]\r\ntest_storages.py::test_get_trial[inmemory] PASSED                                                                                          [ 68%]\r\ntest_storages.py::test_get_trial[sqlite] PASSED                                                                                            [ 69%]\r\ntest_storages.py::test_get_trial[cached_sqlite] PASSED                                                                                     [ 69%]\r\ntest_storages.py::test_get_trial[journal] PASSED                                                                                           [ 70%]\r\ntest_storages.py::test_get_trial[journal_redis] PASSED                                                                                     [ 70%]\r\ntest_storages.py::test_get_trial[dask] SKIPPED (distributed doesn't yet support Python 3.11)                                               [ 71%]\r\ntest_storages.py::test_get_all_trials[inmemory] PASSED                                                                                     [ 71%]\r\ntest_storages.py::test_get_all_trials[sqlite] PASSED                                                                                       [ 72%]\r\ntest_storages.py::test_get_all_trials[cached_sqlite] PASSED                                                                                [ 72%]\r\ntest_storages.py::test_get_all_trials[journal] PASSED                                                                                      [ 73%]\r\ntest_storages.py::test_get_all_trials[journal_redis] PASSED                                                                                [ 73%]\r\ntest_storages.py::test_get_all_trials[dask] SKIPPED (distributed doesn't yet support Python 3.11)                                          [ 74%]\r\ntest_storages.py::test_get_all_trials_deepcopy_option[inmemory] PASSED                                                                     [ 74%]\r\ntest_storages.py::test_get_all_trials_deepcopy_option[sqlite] PASSED                                                                       [ 75%]\r\ntest_storages.py::test_get_all_trials_deepcopy_option[cached_sqlite] PASSED                                                                [ 75%]\r\ntest_storages.py::test_get_all_trials_deepcopy_option[journal] PASSED                                                                      [ 75%]\r\ntest_storages.py::test_get_all_trials_deepcopy_option[journal_redis] PASSED                                                                [ 76%]\r\ntest_storages.py::test_get_all_trials_deepcopy_option[dask] SKIPPED (distributed doesn't yet support Python 3.11)                          [ 76%]\r\ntest_storages.py::test_get_all_trials_state_option[inmemory] PASSED                                                                        [ 77%]\r\ntest_storages.py::test_get_all_trials_state_option[sqlite] PASSED                                                                          [ 77%]\r\ntest_storages.py::test_get_all_trials_state_option[cached_sqlite] PASSED                                                                   [ 78%]\r\ntest_storages.py::test_get_all_trials_state_option[journal] PASSED                                                                         [ 78%]\r\ntest_storages.py::test_get_all_trials_state_option[journal_redis] PASSED                                                                   [ 79%]\r\ntest_storages.py::test_get_all_trials_state_option[dask] SKIPPED (distributed doesn't yet support Python 3.11)                             [ 79%]\r\ntest_storages.py::test_get_n_trials[inmemory] PASSED                                                                                       [ 80%]\r\ntest_storages.py::test_get_n_trials[sqlite] PASSED                                                                                         [ 80%]\r\ntest_storages.py::test_get_n_trials[cached_sqlite] PASSED                                                                                  [ 81%]\r\ntest_storages.py::test_get_n_trials[journal] PASSED                                                                                        [ 81%]\r\ntest_storages.py::test_get_n_trials[journal_redis] PASSED                                                                                  [ 82%]\r\ntest_storages.py::test_get_n_trials[dask] SKIPPED (distributed doesn't yet support Python 3.11)                                            [ 82%]\r\ntest_storages.py::test_get_n_trials_state_option[inmemory] PASSED                                                                          [ 83%]\r\ntest_storages.py::test_get_n_trials_state_option[sqlite] PASSED                                                                            [ 83%]\r\ntest_storages.py::test_get_n_trials_state_option[cached_sqlite] PASSED                                                                     [ 83%]\r\ntest_storages.py::test_get_n_trials_state_option[journal] PASSED                                                                           [ 84%]\r\ntest_storages.py::test_get_n_trials_state_option[journal_redis] PASSED                                                                     [ 84%]\r\ntest_storages.py::test_get_n_trials_state_option[dask] SKIPPED (distributed doesn't yet support Python 3.11)                               [ 85%]\r\ntest_storages.py::test_get_best_trial[inmemory] PASSED                                                                                     [ 85%]\r\ntest_storages.py::test_get_best_trial[sqlite] PASSED                                                                                       [ 86%]\r\ntest_storages.py::test_get_best_trial[cached_sqlite] PASSED                                                                                [ 86%]\r\ntest_storages.py::test_get_best_trial[journal] PASSED                                                                                      [ 87%]\r\ntest_storages.py::test_get_best_trial[journal_redis] PASSED                                                                                [ 87%]\r\ntest_storages.py::test_get_best_trial[dask] SKIPPED (distributed doesn't yet support Python 3.11)                                          [ 88%]\r\ntest_storages.py::test_get_trials_excluded_trial_ids PASSED                                                                                [ 88%]\r\ntest_storages.py::test_get_best_trial_for_multi_objective_optimization[inmemory] PASSED                                                    [ 89%]\r\ntest_storages.py::test_get_best_trial_for_multi_objective_optimization[sqlite] PASSED                                                      [ 89%]\r\ntest_storages.py::test_get_best_trial_for_multi_objective_optimization[cached_sqlite] PASSED                                               [ 90%]\r\ntest_storages.py::test_get_best_trial_for_multi_objective_optimization[journal] PASSED                                                     [ 90%]\r\ntest_storages.py::test_get_best_trial_for_multi_objective_optimization[journal_redis] PASSED                                               [ 91%]\r\ntest_storages.py::test_get_best_trial_for_multi_objective_optimization[dask] SKIPPED (distributed doesn't yet support Python 3.11)         [ 91%]\r\ntest_storages.py::test_get_trial_id_from_study_id_trial_number[inmemory] PASSED                                                            [ 91%]\r\ntest_storages.py::test_get_trial_id_from_study_id_trial_number[sqlite] PASSED                                                              [ 92%]\r\ntest_storages.py::test_get_trial_id_from_study_id_trial_number[cached_sqlite] PASSED                                                       [ 92%]\r\ntest_storages.py::test_get_trial_id_from_study_id_trial_number[journal] PASSED                                                             [ 93%]\r\ntest_storages.py::test_get_trial_id_from_study_id_trial_number[journal_redis] PASSED                                                       [ 93%]\r\ntest_storages.py::test_get_trial_id_from_study_id_trial_number[dask] SKIPPED (distributed doesn't yet support Python 3.11)                 [ 94%]\r\ntest_storages.py::test_pickle_storage[inmemory] PASSED                                                                                     [ 94%]\r\ntest_storages.py::test_pickle_storage[sqlite] PASSED                                                                                       [ 95%]\r\ntest_storages.py::test_pickle_storage[cached_sqlite] PASSED                                                                                [ 95%]\r\ntest_storages.py::test_pickle_storage[journal] PASSED                                                                                      [ 96%]\r\ntest_storages.py::test_pickle_storage[journal_redis] SKIPPED (The `fakeredis` does not support multi instances.)                           [ 96%]\r\ntest_storages.py::test_pickle_storage[dask] SKIPPED (distributed doesn't yet support Python 3.11)                                          [ 97%]\r\ntest_storages.py::test_check_trial_is_updatable[inmemory] PASSED                                                                           [ 97%]\r\ntest_storages.py::test_check_trial_is_updatable[sqlite] PASSED                                                                             [ 98%]\r\ntest_storages.py::test_check_trial_is_updatable[cached_sqlite] PASSED                                                                      [ 98%]\r\ntest_storages.py::test_check_trial_is_updatable[journal] PASSED                                                                            [ 99%]\r\ntest_storages.py::test_check_trial_is_updatable[journal_redis] PASSED                                                                      [ 99%]\r\ntest_storages.py::test_check_trial_is_updatable[dask] SKIPPED (distributed doesn't yet support Python 3.11)                                [100%]\r\n\r\n==================================================================== FAILURES ====================================================================\r\n_________________________________________________________ test_create_new_trial[journal] _________________________________________________________\r\n\r\nstorage_mode = 'journal'\r\n\r\n    @pytest.mark.parametrize(\"storage_mode\", STORAGE_MODES)\r\n    def test_create_new_trial(storage_mode: str) -> None:\r\n        def _check_trials(\r\n            trials: List[FrozenTrial],\r\n            idx: int,\r\n            trial_id: int,\r\n            time_before_creation: datetime,\r\n            time_after_creation: datetime,\r\n        ) -> None:\r\n            assert len(trials) == idx + 1\r\n            assert len({t._trial_id for t in trials}) == idx + 1\r\n            assert trial_id in {t._trial_id for t in trials}\r\n            assert {t.number for t in trials} == set(range(idx + 1))\r\n            assert all(t.state == TrialState.RUNNING for t in trials)\r\n            assert all(t.params == {} for t in trials)\r\n            assert all(t.intermediate_values == {} for t in trials)\r\n            assert all(t.user_attrs == {} for t in trials)\r\n            assert all(t.system_attrs == {} for t in trials)\r\n            assert all(\r\n                t.datetime_start < time_before_creation\r\n                for t in trials\r\n                if t._trial_id != trial_id and t.datetime_start is not None\r\n            )\r\n            assert all(\r\n                time_before_creation < t.datetime_start < time_after_creation\r\n                for t in trials\r\n                if t._trial_id == trial_id and t.datetime_start is not None\r\n            )\r\n            assert all(t.datetime_complete is None for t in trials)\r\n            assert all(t.value is None for t in trials)\r\n    \r\n        with StorageSupplier(storage_mode) as storage:\r\n    \r\n            study_id = storage.create_new_study(directions=[StudyDirection.MINIMIZE])\r\n            n_trial_in_study = 3\r\n            for i in range(n_trial_in_study):\r\n                time_before_creation = datetime.now()\r\n                trial_id = storage.create_new_trial(study_id)\r\n                time_after_creation = datetime.now()\r\n    \r\n                trials = storage.get_all_trials(study_id)\r\n>               _check_trials(trials, i, trial_id, time_before_creation, time_after_creation)\r\n\r\ntest_storages.py:315: \r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n\r\ntrials = [FrozenTrial(number=0, state=0, values=None, datetime_start=datetime.datetime(2023, 2, 21, 15, 41, 3, 765620), datetim...ete=None, params={}, user_attrs={}, system_attrs={}, intermediate_values={}, distributions={}, trial_id=1, value=None)]\r\nidx = 1, trial_id = 1, time_before_creation = datetime.datetime(2023, 2, 21, 15, 41, 3, 765722)\r\ntime_after_creation = datetime.datetime(2023, 2, 21, 15, 41, 3, 765767)\r\n\r\n    def _check_trials(\r\n        trials: List[FrozenTrial],\r\n        idx: int,\r\n        trial_id: int,\r\n        time_before_creation: datetime,\r\n        time_after_creation: datetime,\r\n    ) -> None:\r\n        assert len(trials) == idx + 1\r\n        assert len({t._trial_id for t in trials}) == idx + 1\r\n        assert trial_id in {t._trial_id for t in trials}\r\n        assert {t.number for t in trials} == set(range(idx + 1))\r\n        assert all(t.state == TrialState.RUNNING for t in trials)\r\n        assert all(t.params == {} for t in trials)\r\n        assert all(t.intermediate_values == {} for t in trials)\r\n        assert all(t.user_attrs == {} for t in trials)\r\n        assert all(t.system_attrs == {} for t in trials)\r\n        assert all(\r\n            t.datetime_start < time_before_creation\r\n            for t in trials\r\n            if t._trial_id != trial_id and t.datetime_start is not None\r\n        )\r\n>       assert all(\r\n            time_before_creation < t.datetime_start < time_after_creation\r\n            for t in trials\r\n            if t._trial_id == trial_id and t.datetime_start is not None\r\n        )\r\nE       assert False\r\nE        +  where False = all(<generator object test_create_new_trial.<locals>._check_trials.<locals>.<genexpr> at 0x3ffb6dff880>)\r\n\r\ntest_storages.py:297: AssertionError\r\n-------------------------------------------------------------- Captured stderr call --------------------------------------------------------------\r\n[I 2023-02-21 15:41:03,765] A new study created in Journal with name: no-name-709f1cda-a544-45f7-a7e3-a6b170171323\r\n============================================================ short test summary info =============================================================\r\nFAILED test_storages.py::test_create_new_trial[journal] - assert False\r\n=================================================== 1 failed, 175 passed, 36 skipped in 9.61s ====================================================\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\nOn an s390x machine:\r\n1. Install Optuna\r\n2. Run `python3 -B -m pytest -v tests/storages_tests/test_storage.py` a few times.\r\n3. Observe that it usually passes, but sometimes fails as in the quoted error message, indicating an incorrect ordering of time points.\r\n\r\n\r\n### Additional context (optional)\r\n\r\nI might be missing something regarding the design of these tests, but they seem to rely on `datetime.now()` being monotonically increasing. If I'm not misremembering, there is no guarantee that the return value of that function is less than the value of an earlier call. This would make the tests fail for no useful reason.\r\n\r\nThis comment is not specific to the tests failing only on s390x, but seems appropriate to make (see also issue #4455). Please let me know if I've misunderstood something about the assumptions in the tests though!", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4453/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4453/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4443", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4443/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4443/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4443/events", "html_url": "https://github.com/optuna/optuna/pull/4443", "id": 1591231577, "node_id": "PR_kwDOB0okGM5KT_3l", "number": 4443, "title": "Fix CMA-ES Sampler", "user": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, {"login": "cross32768", "id": 34023087, "node_id": "MDQ6VXNlcjM0MDIzMDg3", "avatar_url": "https://avatars.githubusercontent.com/u/34023087?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cross32768", "html_url": "https://github.com/cross32768", "followers_url": "https://api.github.com/users/cross32768/followers", "following_url": "https://api.github.com/users/cross32768/following{/other_user}", "gists_url": "https://api.github.com/users/cross32768/gists{/gist_id}", "starred_url": "https://api.github.com/users/cross32768/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cross32768/subscriptions", "organizations_url": "https://api.github.com/users/cross32768/orgs", "repos_url": "https://api.github.com/users/cross32768/repos", "events_url": "https://api.github.com/users/cross32768/events{/privacy}", "received_events_url": "https://api.github.com/users/cross32768/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/54", "html_url": "https://github.com/optuna/optuna/milestone/54", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/54/labels", "id": 8862825, "node_id": "MI_kwDOB0okGM4Ahzxp", "number": 54, "title": "v3.2.0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 2, "closed_issues": 126, "state": "open", "created_at": "2023-01-17T07:03:31Z", "updated_at": "2023-04-27T06:35:24Z", "due_on": null, "closed_at": null}, "comments": 4, "created_at": "2023-02-20T06:31:16Z", "updated_at": "2023-03-17T06:17:30Z", "closed_at": "2023-03-17T06:17:30Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4443", "html_url": "https://github.com/optuna/optuna/pull/4443", "diff_url": "https://github.com/optuna/optuna/pull/4443.diff", "patch_url": "https://github.com/optuna/optuna/pull/4443.patch", "merged_at": "2023-03-17T06:17:29Z"}, "body": "\r\n## Motivation\r\nCurrently, `sigma0` of `CmaEsSampler` is determined by the minimum width of search space. (https://github.com/optuna/optuna/blob/master/optuna/samplers/_cmaes.py#L516)\r\n\r\nThis becomes a problem when there are two variables with very different scales. \r\n\r\n## Description of the changes\r\nWe rescale all variables to [0, 1]. To do this, we add an option `transform_0_1` to `_SearchSpaceTransform`.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4443/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4443/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4434", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4434/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4434/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4434/events", "html_url": "https://github.com/optuna/optuna/pull/4434", "id": 1588774177, "node_id": "PR_kwDOB0okGM5KMApO", "number": 4434, "title": "Fix bug of CMA-ES with margin on `RDBStorage` or `JournalStorage`", "user": {"login": "knshnb", "id": 23695091, "node_id": "MDQ6VXNlcjIzNjk1MDkx", "avatar_url": "https://avatars.githubusercontent.com/u/23695091?v=4", "gravatar_id": "", "url": "https://api.github.com/users/knshnb", "html_url": "https://github.com/knshnb", "followers_url": "https://api.github.com/users/knshnb/followers", "following_url": "https://api.github.com/users/knshnb/following{/other_user}", "gists_url": "https://api.github.com/users/knshnb/gists{/gist_id}", "starred_url": "https://api.github.com/users/knshnb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/knshnb/subscriptions", "organizations_url": "https://api.github.com/users/knshnb/orgs", "repos_url": "https://api.github.com/users/knshnb/repos", "events_url": "https://api.github.com/users/knshnb/events{/privacy}", "received_events_url": "https://api.github.com/users/knshnb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, {"login": "gen740", "id": 54583542, "node_id": "MDQ6VXNlcjU0NTgzNTQy", "avatar_url": "https://avatars.githubusercontent.com/u/54583542?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gen740", "html_url": "https://github.com/gen740", "followers_url": "https://api.github.com/users/gen740/followers", "following_url": "https://api.github.com/users/gen740/following{/other_user}", "gists_url": "https://api.github.com/users/gen740/gists{/gist_id}", "starred_url": "https://api.github.com/users/gen740/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gen740/subscriptions", "organizations_url": "https://api.github.com/users/gen740/orgs", "repos_url": "https://api.github.com/users/gen740/repos", "events_url": "https://api.github.com/users/gen740/events{/privacy}", "received_events_url": "https://api.github.com/users/gen740/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/54", "html_url": "https://github.com/optuna/optuna/milestone/54", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/54/labels", "id": 8862825, "node_id": "MI_kwDOB0okGM4Ahzxp", "number": 54, "title": "v3.2.0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 2, "closed_issues": 126, "state": "open", "created_at": "2023-01-17T07:03:31Z", "updated_at": "2023-04-27T06:35:24Z", "due_on": null, "closed_at": null}, "comments": 2, "created_at": "2023-02-17T05:24:43Z", "updated_at": "2023-02-20T06:56:59Z", "closed_at": "2023-02-20T06:56:59Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4434", "html_url": "https://github.com/optuna/optuna/pull/4434", "diff_url": "https://github.com/optuna/optuna/pull/4434.diff", "patch_url": "https://github.com/optuna/optuna/pull/4434.patch", "merged_at": "2023-02-20T06:56:58Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull request after it gets two or more approvals. To proceed to the review process by the maintainers, please make sure that the PR meets the following conditions: (1) it passes all CI checks, and (2) it is neither in the draft nor WIP state. If you wish to discuss the PR in the draft state or need any other help, please mention the Optuna development team in the PR. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nFix https://github.com/optuna/optuna/issues/4430.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\nConvert `numpy.ndarray` to `list` before saving to `trial.system_attrs` because `numpy.ndarray` is not JSON-serializable.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4434/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4434/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4430", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4430/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4430/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4430/events", "html_url": "https://github.com/optuna/optuna/issues/4430", "id": 1588650723, "node_id": "I_kwDOB0okGM5esOLj", "number": 4430, "title": "`TypeError: Object of type ndarray is not JSON serializable` when `CmaEsSampler(with_margin=True)` is used with `RDBStorage` or `JournalStorage`", "user": {"login": "cross32768", "id": 34023087, "node_id": "MDQ6VXNlcjM0MDIzMDg3", "avatar_url": "https://avatars.githubusercontent.com/u/34023087?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cross32768", "html_url": "https://github.com/cross32768", "followers_url": "https://api.github.com/users/cross32768/followers", "following_url": "https://api.github.com/users/cross32768/following{/other_user}", "gists_url": "https://api.github.com/users/cross32768/gists{/gist_id}", "starred_url": "https://api.github.com/users/cross32768/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cross32768/subscriptions", "organizations_url": "https://api.github.com/users/cross32768/orgs", "repos_url": "https://api.github.com/users/cross32768/repos", "events_url": "https://api.github.com/users/cross32768/events{/privacy}", "received_events_url": "https://api.github.com/users/cross32768/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2023-02-17T02:15:49Z", "updated_at": "2023-02-20T06:57:00Z", "closed_at": "2023-02-20T06:57:00Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nWhen I use `CmaEsSampler(with_margin=True)`  with `RDBStorage` or `JournalStorage`, `study.optimize(objective)` raises `TypeError: Object of type ndarray is not JSON serializable`.\r\n\r\nThis error does not occur when `with_margin=False`.\r\nAlso, this error does not occur when `InMemoryStorage` is used even if `with_margin=True`.\r\n\r\n\r\n\r\n\r\n### Environment\r\n\r\n- Optuna version: `3.2.0.dev`\r\n- Python version: `Python 3.9.12`\r\n- OS: Ubuntu `22.04.1 LTS`\r\n- (Optional) Other libraries and their versions:\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\n[I 2023-02-17 11:06:33,093] A new study created in RDB with name: no-name-eb813ee4-6aab-43f1-8184-74f48f917a0a\r\n[I 2023-02-17 11:06:33,154] Trial 0 finished with value: 1.3806145644151036 and parameters: {'x': 0.38061456441510355, 'y': 1}. Best is trial 0 with value: 1.3806145644151036.\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\nCell In[38], line 13\r\n     10 storage = optuna.storages.RDBStorage(url=\"sqlite:///:memory:\",)\r\n     12 study = optuna.create_study(sampler=sampler, storage=storage)\r\n---> 13 study.optimize(objective, n_trials=10)\r\n\r\nFile /optuna/optuna/study/study.py:422, in Study.optimize(self, func, n_trials, timeout, n_jobs, catch, callbacks, gc_after_trial, show_progress_bar)\r\n    318 def optimize(\r\n    319     self,\r\n    320     func: ObjectiveFuncType,\r\n   (...)\r\n    327     show_progress_bar: bool = False,\r\n    328 ) -> None:\r\n    329     \"\"\"Optimize an objective function.\r\n    330 \r\n    331     Optimization is done by choosing a suitable set of hyperparameter values from a given\r\n   (...)\r\n    419             If nested invocation of this method occurs.\r\n    420     \"\"\"\r\n--> 422     _optimize(\r\n    423         study=self,\r\n    424         func=func,\r\n    425         n_trials=n_trials,\r\n    426         timeout=timeout,\r\n    427         n_jobs=n_jobs,\r\n    428         catch=tuple(catch) if isinstance(catch, Iterable) else (catch,),\r\n    429         callbacks=callbacks,\r\n    430         gc_after_trial=gc_after_trial,\r\n    431         show_progress_bar=show_progress_bar,\r\n    432     )\r\n\r\nFile /optuna/optuna/study/_optimize.py:66, in _optimize(study, func, n_trials, timeout, n_jobs, catch, callbacks, gc_after_trial, show_progress_bar)\r\n     64 try:\r\n     65     if n_jobs == 1:\r\n---> 66         _optimize_sequential(\r\n     67             study,\r\n     68             func,\r\n     69             n_trials,\r\n     70             timeout,\r\n     71             catch,\r\n     72             callbacks,\r\n     73             gc_after_trial,\r\n     74             reseed_sampler_rng=False,\r\n     75             time_start=None,\r\n     76             progress_bar=progress_bar,\r\n     77         )\r\n     78     else:\r\n     79         if n_jobs == -1:\r\n\r\nFile /optuna/optuna/study/_optimize.py:163, in _optimize_sequential(study, func, n_trials, timeout, catch, callbacks, gc_after_trial, reseed_sampler_rng, time_start, progress_bar)\r\n    160         break\r\n    162 try:\r\n--> 163     frozen_trial = _run_trial(study, func, catch)\r\n    164 finally:\r\n    165     # The following line mitigates memory problems that can be occurred in some\r\n    166     # environments (e.g., services that use computing containers such as GitHub Actions).\r\n    167     # Please refer to the following PR for further details:\r\n    168     # https://github.com/optuna/optuna/pull/325.\r\n    169     if gc_after_trial:\r\n\r\nFile /optuna/optuna/study/_optimize.py:191, in _run_trial(study, func, catch)\r\n    188 if is_heartbeat_enabled(study._storage):\r\n    189     optuna.storages.fail_stale_trials(study)\r\n--> 191 trial = study.ask()\r\n    193 state: Optional[TrialState] = None\r\n    194 value_or_values: Optional[Union[float, Sequence[float]]] = None\r\n\r\nFile /optuna/optuna/study/study.py:516, in Study.ask(self, fixed_distributions)\r\n    514 if trial_id is None:\r\n    515     trial_id = self._storage.create_new_trial(self._study_id)\r\n--> 516 trial = trial_module.Trial(self, trial_id)\r\n    518 for name, param in fixed_distributions.items():\r\n    519     trial._suggest(name, param)\r\n\r\nFile /optuna/optuna/trial/_trial.py:55, in Trial.__init__(self, study, trial_id)\r\n     52 self._study_id = self.study._study_id\r\n     53 self.storage = self.study._storage\r\n---> 55 self._init_relative_params()\r\n\r\nFile /optuna/optuna/trial/_trial.py:64, in Trial._init_relative_params(self)\r\n     59 study = pruners._filter_study(self.study, self._cached_frozen_trial)\r\n     61 self.relative_search_space = self.study.sampler.infer_relative_search_space(\r\n     62     study, self._cached_frozen_trial\r\n     63 )\r\n---> 64 self.relative_params = self.study.sampler.sample_relative(\r\n     65     study, self._cached_frozen_trial, self.relative_search_space\r\n     66 )\r\n\r\nFile /optuna/optuna/samplers/_cmaes.py:418, in CmaEsSampler.sample_relative(self, study, trial, search_space)\r\n    416 if isinstance(optimizer, CMAwM):\r\n    417     params, x_for_tell = optimizer.ask()\r\n--> 418     study._storage.set_trial_system_attr(trial._trial_id, \"x_for_tell\", x_for_tell)\r\n    419 else:\r\n    420     params = optimizer.ask()\r\n\r\nFile /optuna/optuna/storages/_cached_storage.py:307, in _CachedStorage.set_trial_system_attr(self, trial_id, key, value)\r\n    305         attrs[key] = value\r\n    306         cached_trial.system_attrs = attrs\r\n--> 307 self._backend.set_trial_system_attr(trial_id, key=key, value=value)\r\n\r\nFile /optuna/optuna/storages/_rdb/storage.py:732, in RDBStorage.set_trial_system_attr(self, trial_id, key, value)\r\n    730 def set_trial_system_attr(self, trial_id: int, key: str, value: Any) -> None:\r\n    731     with _create_scoped_session(self.scoped_session, True) as session:\r\n--> 732         self._set_trial_system_attr_without_commit(session, trial_id, key, value)\r\n\r\nFile /optuna/optuna/storages/_rdb/storage.py:743, in RDBStorage._set_trial_system_attr_without_commit(self, session, trial_id, key, value)\r\n    740 attribute = models.TrialSystemAttributeModel.find_by_trial_and_key(trial, key, session)\r\n    741 if attribute is None:\r\n    742     attribute = models.TrialSystemAttributeModel(\r\n--> 743         trial_id=trial_id, key=key, value_json=json.dumps(value)\r\n    744     )\r\n    745     session.add(attribute)\r\n    746 else:\r\n\r\nFile /usr/local/lib/python3.9/json/__init__.py:231, in dumps(obj, skipkeys, ensure_ascii, check_circular, allow_nan, cls, indent, separators, default, sort_keys, **kw)\r\n    226 # cached encoder\r\n    227 if (not skipkeys and ensure_ascii and\r\n    228     check_circular and allow_nan and\r\n    229     cls is None and indent is None and separators is None and\r\n    230     default is None and not sort_keys and not kw):\r\n--> 231     return _default_encoder.encode(obj)\r\n    232 if cls is None:\r\n    233     cls = JSONEncoder\r\n\r\nFile /usr/local/lib/python3.9/json/encoder.py:199, in JSONEncoder.encode(self, o)\r\n    195         return encode_basestring(o)\r\n    196 # This doesn't pass the iterator directly to ''.join() because the\r\n    197 # exceptions aren't as detailed.  The list call should be roughly\r\n    198 # equivalent to the PySequence_Fast that ''.join() would do.\r\n--> 199 chunks = self.iterencode(o, _one_shot=True)\r\n    200 if not isinstance(chunks, (list, tuple)):\r\n    201     chunks = list(chunks)\r\n\r\nFile /usr/local/lib/python3.9/json/encoder.py:257, in JSONEncoder.iterencode(self, o, _one_shot)\r\n    252 else:\r\n    253     _iterencode = _make_iterencode(\r\n    254         markers, self.default, _encoder, self.indent, floatstr,\r\n    255         self.key_separator, self.item_separator, self.sort_keys,\r\n    256         self.skipkeys, _one_shot)\r\n--> 257 return _iterencode(o, 0)\r\n\r\nFile /usr/local/lib/python3.9/json/encoder.py:179, in JSONEncoder.default(self, o)\r\n    160 def default(self, o):\r\n    161     \"\"\"Implement this method in a subclass such that it returns\r\n    162     a serializable object for ``o``, or calls the base implementation\r\n    163     (to raise a ``TypeError``).\r\n   (...)\r\n    177 \r\n    178     \"\"\"\r\n--> 179     raise TypeError(f'Object of type {o.__class__.__name__} '\r\n    180                     f'is not JSON serializable')\r\n\r\nTypeError: Object of type ndarray is not JSON serializable\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\nMy minimum reproduction code is below.\r\n\r\n```\r\nimport optuna\r\nfrom optuna.samplers import CmaEsSampler\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_float(\"x\", -1, 1)\r\n    y = trial.suggest_float(\"y\", -1, 1)\r\n    return x + y\r\n\r\nsampler = CmaEsSampler(with_margin=True)\r\nstorage = optuna.storages.RDBStorage(url=\"sqlite:///:memory:\",)\r\n\r\nstudy = optuna.create_study(sampler=sampler, storage=storage)\r\nstudy.optimize(objective, n_trials=10)\r\n```\r\n\r\nThis raises `TypeError: Object of type ndarray is not JSON serializable`. The full stack trace is above.\r\n\r\n### Additional context (optional)\r\n\r\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4430/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4430/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4422", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4422/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4422/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4422/events", "html_url": "https://github.com/optuna/optuna/pull/4422", "id": 1585322918, "node_id": "PR_kwDOB0okGM5KAYY5", "number": 4422, "title": "Fix RDBStorage.get_best_trial when there are `inf`s", "user": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "amylase", "id": 967121, "node_id": "MDQ6VXNlcjk2NzEyMQ==", "avatar_url": "https://avatars.githubusercontent.com/u/967121?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amylase", "html_url": "https://github.com/amylase", "followers_url": "https://api.github.com/users/amylase/followers", "following_url": "https://api.github.com/users/amylase/following{/other_user}", "gists_url": "https://api.github.com/users/amylase/gists{/gist_id}", "starred_url": "https://api.github.com/users/amylase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amylase/subscriptions", "organizations_url": "https://api.github.com/users/amylase/orgs", "repos_url": "https://api.github.com/users/amylase/repos", "events_url": "https://api.github.com/users/amylase/events{/privacy}", "received_events_url": "https://api.github.com/users/amylase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "amylase", "id": 967121, "node_id": "MDQ6VXNlcjk2NzEyMQ==", "avatar_url": "https://avatars.githubusercontent.com/u/967121?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amylase", "html_url": "https://github.com/amylase", "followers_url": "https://api.github.com/users/amylase/followers", "following_url": "https://api.github.com/users/amylase/following{/other_user}", "gists_url": "https://api.github.com/users/amylase/gists{/gist_id}", "starred_url": "https://api.github.com/users/amylase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amylase/subscriptions", "organizations_url": "https://api.github.com/users/amylase/orgs", "repos_url": "https://api.github.com/users/amylase/repos", "events_url": "https://api.github.com/users/amylase/events{/privacy}", "received_events_url": "https://api.github.com/users/amylase/received_events", "type": "User", "site_admin": false}, {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/54", "html_url": "https://github.com/optuna/optuna/milestone/54", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/54/labels", "id": 8862825, "node_id": "MI_kwDOB0okGM4Ahzxp", "number": 54, "title": "v3.2.0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 2, "closed_issues": 126, "state": "open", "created_at": "2023-01-17T07:03:31Z", "updated_at": "2023-04-27T06:35:24Z", "due_on": null, "closed_at": null}, "comments": 9, "created_at": "2023-02-15T06:57:55Z", "updated_at": "2023-03-02T09:35:59Z", "closed_at": "2023-03-02T09:35:58Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4422", "html_url": "https://github.com/optuna/optuna/pull/4422", "diff_url": "https://github.com/optuna/optuna/pull/4422.diff", "patch_url": "https://github.com/optuna/optuna/pull/4422.patch", "merged_at": "2023-03-02T09:35:58Z"}, "body": "\r\n## Motivation\r\nFix #4420.\r\n\r\n## Description of the changes\r\nAdd `ORDER BY` clause based on the value of `value_type`.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4422/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4422/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4421", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4421/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4421/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4421/events", "html_url": "https://github.com/optuna/optuna/issues/4421", "id": 1585122883, "node_id": "I_kwDOB0okGM5eew5D", "number": 4421, "title": "PytorchLightning RuntimeError", "user": {"login": "kongqi404", "id": 32472226, "node_id": "MDQ6VXNlcjMyNDcyMjI2", "avatar_url": "https://avatars.githubusercontent.com/u/32472226?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kongqi404", "html_url": "https://github.com/kongqi404", "followers_url": "https://api.github.com/users/kongqi404/followers", "following_url": "https://api.github.com/users/kongqi404/following{/other_user}", "gists_url": "https://api.github.com/users/kongqi404/gists{/gist_id}", "starred_url": "https://api.github.com/users/kongqi404/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kongqi404/subscriptions", "organizations_url": "https://api.github.com/users/kongqi404/orgs", "repos_url": "https://api.github.com/users/kongqi404/repos", "events_url": "https://api.github.com/users/kongqi404/events{/privacy}", "received_events_url": "https://api.github.com/users/kongqi404/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2023-02-15T02:51:07Z", "updated_at": "2023-02-15T05:51:57Z", "closed_at": "2023-02-15T03:55:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nwhen try run pytorchlightning example.py,i get an error:\r\nRuntimeError: The `on_init_start` callback hook was deprecated in v1.6 and is no longer supported as of v1.8.\n\n### Environment\n\n- Optuna version:3.0.5\r\n- Python version:Python version:3.10.8\r\n- OS:Linux-5.4.0-100-generic-x86_64-with-glibc2.35\r\n- (Optional) Other libraries and their versions:\r\n- pytorch lightning version:1.8.3.post1\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\nTrial 0 failed because of the following error: RuntimeError('The `on_init_start` callback hook was deprecated in v1.6 and is no longer supported as of v1.8.')\r\nTraceback (most recent call last):\r\n  File \"/root/miniconda3/lib/python3.10/site-packages/optuna/study/_optimize.py\", line 196, in _run_trial\r\n    value_or_values = func(trial)\r\n  File \"/root/autodl-tmp/example.py\", line 138, in objective\r\n    trainer.fit(model, datamodule=datamodule)\r\n  File \"/root/miniconda3/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py\", line 582, in fit\r\n    call._call_and_handle_interrupt(\r\n  File \"/root/miniconda3/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py\", line 38, in _call_and_handle_interrupt\r\n    return trainer_fn(*args, **kwargs)\r\n  File \"/root/miniconda3/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py\", line 624, in _fit_impl\r\n    self._run(model, ckpt_path=self.ckpt_path)\r\n  File \"/root/miniconda3/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py\", line 987, in _run\r\n    verify_loop_configurations(self)\r\n  File \"/root/miniconda3/lib/python3.10/site-packages/pytorch_lightning/trainer/configuration_validator.py\", line 53, in verify_loop_configurations\r\n    _check_deprecated_callback_hooks(trainer)\r\n  File \"/root/miniconda3/lib/python3.10/site-packages/pytorch_lightning/trainer/configuration_validator.py\", line 221, in _check_deprecated_callback_hooks\r\n    raise RuntimeError(\r\nRuntimeError: The `on_init_start` callback hook was deprecated in v1.6 and is no longer supported as of v1.8.\r\nTraceback (most recent call last):\r\n  File \"/root/autodl-tmp/example.py\", line 157, in <module>\r\n    study.optimize(objective, n_trials=100, timeout=600)\r\n  File \"/root/miniconda3/lib/python3.10/site-packages/optuna/study/study.py\", line 419, in optimize\r\n    _optimize(\r\n  File \"/root/miniconda3/lib/python3.10/site-packages/optuna/study/_optimize.py\", line 66, in _optimize\r\n    _optimize_sequential(\r\n  File \"/root/miniconda3/lib/python3.10/site-packages/optuna/study/_optimize.py\", line 160, in _optimize_sequential\r\n    frozen_trial = _run_trial(study, func, catch)\r\n  File \"/root/miniconda3/lib/python3.10/site-packages/optuna/study/_optimize.py\", line 234, in _run_trial\r\n    raise func_err\r\n  File \"/root/miniconda3/lib/python3.10/site-packages/optuna/study/_optimize.py\", line 196, in _run_trial\r\n    value_or_values = func(trial)\r\n  File \"/root/autodl-tmp/example.py\", line 138, in objective\r\n    trainer.fit(model, datamodule=datamodule)\r\n  File \"/root/miniconda3/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py\", line 582, in fit\r\n    call._call_and_handle_interrupt(\r\n  File \"/root/miniconda3/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py\", line 38, in _call_and_handle_interrupt\r\n    return trainer_fn(*args, **kwargs)\r\n  File \"/root/miniconda3/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py\", line 624, in _fit_impl\r\n    self._run(model, ckpt_path=self.ckpt_path)\r\n  File \"/root/miniconda3/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py\", line 987, in _run\r\n    verify_loop_configurations(self)\r\n  File \"/root/miniconda3/lib/python3.10/site-packages/pytorch_lightning/trainer/configuration_validator.py\", line 53, in verify_loop_configurations\r\n    _check_deprecated_callback_hooks(trainer)\r\n  File \"/root/miniconda3/lib/python3.10/site-packages/pytorch_lightning/trainer/configuration_validator.py\", line 221, in _check_deprecated_callback_hooks\r\n    raise RuntimeError(\r\nRuntimeError: The `on_init_start` callback hook was deprecated in v1.6 and is no longer supported as of v1.8.\n```\n\n\n### Steps to reproduce\n\n1.run example.py\r\n```python\r\npython example.py\r\n```\r\n\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4421/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4421/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4420", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4420/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4420/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4420/events", "html_url": "https://github.com/optuna/optuna/issues/4420", "id": 1584495800, "node_id": "I_kwDOB0okGM5ecXy4", "number": 4420, "title": "Objective values of +/-inf not handled correctly with PostgreSQL", "user": {"login": "chrisk314", "id": 2366658, "node_id": "MDQ6VXNlcjIzNjY2NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/2366658?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chrisk314", "html_url": "https://github.com/chrisk314", "followers_url": "https://api.github.com/users/chrisk314/followers", "following_url": "https://api.github.com/users/chrisk314/following{/other_user}", "gists_url": "https://api.github.com/users/chrisk314/gists{/gist_id}", "starred_url": "https://api.github.com/users/chrisk314/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chrisk314/subscriptions", "organizations_url": "https://api.github.com/users/chrisk314/orgs", "repos_url": "https://api.github.com/users/chrisk314/repos", "events_url": "https://api.github.com/users/chrisk314/events{/privacy}", "received_events_url": "https://api.github.com/users/chrisk314/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-02-14T16:46:21Z", "updated_at": "2023-03-02T09:36:00Z", "closed_at": "2023-03-02T09:36:00Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nHi Optuna devs, thanks for all the hardwork on an amazing library! We're trying to put Optuna to good use at a big corp to optimise our industrial processes. Recently we've hit an issue with distributed optimisation jobs.\r\n\r\nWhen performing an optimisation which attempts to maximise/minimise an objective function which returns -/+inf in some cases, I expect the optimisation process to be robust against the presence of possible inf values. In the case that I choose to maximise and some trials return -inf whilst others return finite values, I expect the optimum trial to be that which returned the largest finite value; instead, the first trial returning -inf is found to be the optimum. The same occurs when minimising and the objective sometimes returns +inf.\r\n\r\n### Environment\r\n\r\n- Optuna version: 3.1.0\r\n- Python version: 3.9.16\r\n- OS: Ubuntu 20.04\r\n- (Optional) Other libraries and their versions:\r\n  - PostgreSQL 11\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\n[I 2023-02-14 16:20:48,737] A new study created in RDB with name: optuna-inf-bug-87376ba1-5ca6-4da4-bf7f-7050ea2d6df6\r\n[I 2023-02-14 16:20:51,302] Trial 0 finished with value: 1.0 and parameters: {}. Best is trial 0 with value: 1.0.\r\n[I 2023-02-14 16:20:53,541] Trial 1 finished with value: 2.0 and parameters: {}. Best is trial 1 with value: 2.0.\r\n[I 2023-02-14 16:20:56,011] Trial 2 finished with value: 3.0 and parameters: {}. Best is trial 2 with value: 3.0.\r\n[I 2023-02-14 16:20:58,538] Trial 3 finished with value: -inf and parameters: {}. Best is trial 3 with value: -inf.\r\n[I 2023-02-14 16:21:00,780] Trial 4 finished with value: 5.0 and parameters: {}. Best is trial 3 with value: -inf.\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\n1. Set `DATABASE_URL` in the environment to securely connect to a PostgreSQL database configured for use with Optuna.\r\n2. Run the below script.\r\n3. Observe spurious reported best trial info in the Optuna output.\r\n```python\r\n#!/usr/bin/env python3\r\n\"\"\"Minimal reproducible example for Optuna PostgreSQL storage inf values bug.\"\"\"\r\n\r\nfrom collections import deque\r\nimport os\r\nimport typing as _t\r\nfrom uuid import uuid4\r\n\r\nimport numpy as np\r\nimport optuna\r\n\r\n\r\n# Values of np.inf are stored with TrialValueModel.value=null and value_type=INF_NEG causing incorrect min/max values.\r\nDATA: _t.Deque[float] = deque([1.0, 2.0, 3.0, -np.inf, 5.0])\r\n# Using largest system float instead is a workaround.\r\n# DATA: _t.Deque[float] = deque([1.0, 2.0, 3.0, np.finfo(np.float64).min, 5.0])\r\n\r\n\r\ndef objective(trial: optuna.Trial) -> float:\r\n    return DATA.popleft()\r\n\r\n\r\ndef main() -> None:\r\n    study: optuna.Study = optuna.create_study(\r\n        study_name=f\"optuna-inf-bug-{uuid4()}\",\r\n        sampler=optuna.samplers.TPESampler(),\r\n        storage=os.getenv(\"DATABASE_URL\"),\r\n        direction=\"maximize\",\r\n    )\r\n    study.optimize(objective, n_trials=len(DATA), n_jobs=1)\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    main()\r\n```\r\n\r\n\r\n### Additional context (optional)\r\n\r\nFrom poking around in the debugger and looking at the data in my PostgreSQL instance I have found the root cause. When attempting to retrieve the best trial from the database in [`optuna.storages._rdb.models.TrialModel.find_max_value_trial`](https://github.com/optuna/optuna/blob/master/optuna/storages/_rdb/models.py#L182), there is an ORDER BY DESC TrialValueModel.value followed by LIMIT 1. This query does not account for TrialValueModel.value being stored as null in the database as it is for +/-inf. These null values appear at the top in the ordered query results and so get returned as optimal by the LIMIT statement.\r\n\r\nSome thoughts... `order_by(nullslast(desc(TrialValueModel.value)))` could be used but this would preclude the possibility that +/-inf values constitute part of an optimal group. Results could be loaded into local memory without the LIMIT statement, converted to their python value with `TrialValueModel.stored_repr_to_value`, then passed to `max/min`; however, this could involve very large query sets being transferred to the host which is not desireable. I'd be happy to put in a PR for a fix but I'm not sure what the best approach would be here..", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4420/reactions", "total_count": 2, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 2}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4420/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4416", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4416/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4416/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4416/events", "html_url": "https://github.com/optuna/optuna/pull/4416", "id": 1579301646, "node_id": "PR_kwDOB0okGM5JsT_x", "number": 4416, "title": "Validate length of values in `add_trial`", "user": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/54", "html_url": "https://github.com/optuna/optuna/milestone/54", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/54/labels", "id": 8862825, "node_id": "MI_kwDOB0okGM4Ahzxp", "number": 54, "title": "v3.2.0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 2, "closed_issues": 126, "state": "open", "created_at": "2023-01-17T07:03:31Z", "updated_at": "2023-04-27T06:35:24Z", "due_on": null, "closed_at": null}, "comments": 0, "created_at": "2023-02-10T09:07:59Z", "updated_at": "2023-04-21T09:01:41Z", "closed_at": "2023-02-17T07:44:53Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4416", "html_url": "https://github.com/optuna/optuna/pull/4416", "diff_url": "https://github.com/optuna/optuna/pull/4416.diff", "patch_url": "https://github.com/optuna/optuna/pull/4416.patch", "merged_at": "2023-02-17T07:44:53Z"}, "body": "## Motivation\r\nCurrently, `add_trial` does not check the length of trial's `values`. So, the study accepts an invalid trial.\r\n\r\n```python\r\nimport optuna\r\nstudy = optuna.create_study()\r\nstudy.add_trial(optuna.create_trial(values=[0, 1]))  # No error!\r\n```\r\n\r\n## Description of the changes\r\n- Raise `ValueError` if the length of `values` is invalid", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4416/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4416/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4406", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4406/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4406/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4406/events", "html_url": "https://github.com/optuna/optuna/pull/4406", "id": 1575475051, "node_id": "PR_kwDOB0okGM5Jfdkf", "number": 4406, "title": "fix colorlog compatibility problem", "user": {"login": "gen740", "id": 54583542, "node_id": "MDQ6VXNlcjU0NTgzNTQy", "avatar_url": "https://avatars.githubusercontent.com/u/54583542?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gen740", "html_url": "https://github.com/gen740", "followers_url": "https://api.github.com/users/gen740/followers", "following_url": "https://api.github.com/users/gen740/following{/other_user}", "gists_url": "https://api.github.com/users/gen740/gists{/gist_id}", "starred_url": "https://api.github.com/users/gen740/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gen740/subscriptions", "organizations_url": "https://api.github.com/users/gen740/orgs", "repos_url": "https://api.github.com/users/gen740/repos", "events_url": "https://api.github.com/users/gen740/events{/privacy}", "received_events_url": "https://api.github.com/users/gen740/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "keisuke-umezawa", "id": 1277089, "node_id": "MDQ6VXNlcjEyNzcwODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1277089?v=4", "gravatar_id": "", "url": "https://api.github.com/users/keisuke-umezawa", "html_url": "https://github.com/keisuke-umezawa", "followers_url": "https://api.github.com/users/keisuke-umezawa/followers", "following_url": "https://api.github.com/users/keisuke-umezawa/following{/other_user}", "gists_url": "https://api.github.com/users/keisuke-umezawa/gists{/gist_id}", "starred_url": "https://api.github.com/users/keisuke-umezawa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/keisuke-umezawa/subscriptions", "organizations_url": "https://api.github.com/users/keisuke-umezawa/orgs", "repos_url": "https://api.github.com/users/keisuke-umezawa/repos", "events_url": "https://api.github.com/users/keisuke-umezawa/events{/privacy}", "received_events_url": "https://api.github.com/users/keisuke-umezawa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "keisuke-umezawa", "id": 1277089, "node_id": "MDQ6VXNlcjEyNzcwODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1277089?v=4", "gravatar_id": "", "url": "https://api.github.com/users/keisuke-umezawa", "html_url": "https://github.com/keisuke-umezawa", "followers_url": "https://api.github.com/users/keisuke-umezawa/followers", "following_url": "https://api.github.com/users/keisuke-umezawa/following{/other_user}", "gists_url": "https://api.github.com/users/keisuke-umezawa/gists{/gist_id}", "starred_url": "https://api.github.com/users/keisuke-umezawa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/keisuke-umezawa/subscriptions", "organizations_url": "https://api.github.com/users/keisuke-umezawa/orgs", "repos_url": "https://api.github.com/users/keisuke-umezawa/repos", "events_url": "https://api.github.com/users/keisuke-umezawa/events{/privacy}", "received_events_url": "https://api.github.com/users/keisuke-umezawa/received_events", "type": "User", "site_admin": false}, {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/54", "html_url": "https://github.com/optuna/optuna/milestone/54", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/54/labels", "id": 8862825, "node_id": "MI_kwDOB0okGM4Ahzxp", "number": 54, "title": "v3.2.0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 2, "closed_issues": 126, "state": "open", "created_at": "2023-01-17T07:03:31Z", "updated_at": "2023-04-27T06:35:24Z", "due_on": null, "closed_at": null}, "comments": 4, "created_at": "2023-02-08T04:56:15Z", "updated_at": "2023-02-21T02:37:47Z", "closed_at": "2023-02-14T10:22:59Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4406", "html_url": "https://github.com/optuna/optuna/pull/4406", "diff_url": "https://github.com/optuna/optuna/pull/4406.diff", "patch_url": "https://github.com/optuna/optuna/pull/4406.patch", "merged_at": "2023-02-14T10:22:58Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull request after it gets two or more approvals. To proceed to the review process by the maintainers, please make sure that the PR meets the following conditions: (1) it passes all CI checks, and (2) it is neither in the draft nor WIP state. If you wish to discuss the PR in the draft state or need any other help, please mention the Optuna development team in the PR. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nFix #4403.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\nUse logging.Formatter if `_color_supported` returns True.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4406/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4406/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4404", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4404/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4404/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4404/events", "html_url": "https://github.com/optuna/optuna/issues/4404", "id": 1574549761, "node_id": "I_kwDOB0okGM5d2bkB", "number": 4404, "title": "Mypy stuck on TPE sampler ", "user": {"login": "nielsuit227", "id": 34714661, "node_id": "MDQ6VXNlcjM0NzE0NjYx", "avatar_url": "https://avatars.githubusercontent.com/u/34714661?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nielsuit227", "html_url": "https://github.com/nielsuit227", "followers_url": "https://api.github.com/users/nielsuit227/followers", "following_url": "https://api.github.com/users/nielsuit227/following{/other_user}", "gists_url": "https://api.github.com/users/nielsuit227/gists{/gist_id}", "starred_url": "https://api.github.com/users/nielsuit227/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nielsuit227/subscriptions", "organizations_url": "https://api.github.com/users/nielsuit227/orgs", "repos_url": "https://api.github.com/users/nielsuit227/repos", "events_url": "https://api.github.com/users/nielsuit227/events{/privacy}", "received_events_url": "https://api.github.com/users/nielsuit227/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2023-02-07T15:34:19Z", "updated_at": "2023-03-30T11:58:07Z", "closed_at": "2023-02-14T04:03:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nWhen running mypy on any script that imports optuna, mypy gets stuck (see logs below).\r\n\r\nTo reproduce:\r\n```python\r\nimport optuna\r\n```\r\n\r\nEnvironment\r\nMacOS Ventura 13.0.1\r\nPython 3.10.8\r\nOptuna 3.1.0\r\nMypy 0.991\r\n\n\n### Environment\n\nMacOS Ventura 13.0.1\r\nPython 3.10.8\r\nOptuna 3.1.0\r\nMypy 0.991\n\n### Error messages, stack traces, or logs\n\n```shell\nLOG:  Metadata fresh for psycopg2._psycopg: file /opt/homebrew/Caskroom/miniforge/base/envs/amplo/lib/python3.10/site-packages/psycopg2-stubs/_psycopg.pyi\r\nLOG:  Metadata fresh for psycopg2._ipaddress: file /opt/homebrew/Caskroom/miniforge/base/envs/amplo/lib/python3.10/site-packages/psycopg2-stubs/_ipaddress.pyi\r\nLOG:  Metadata fresh for psycopg2._json: file /opt/homebrew/Caskroom/miniforge/base/envs/amplo/lib/python3.10/site-packages/psycopg2-stubs/_json.pyi\r\nLOG:  Metadata fresh for psycopg2._range: file /opt/homebrew/Caskroom/miniforge/base/envs/amplo/lib/python3.10/site-packages/psycopg2-stubs/_range.pyi\r\nLOG:  Could not load cache for sqlalchemy.connectors: sqlalchemy/connectors/__init__.meta.json\r\nLOG:  Metadata not found for sqlalchemy.connectors\r\nLOG:  Parsing /opt/homebrew/Caskroom/miniforge/base/envs/amplo/lib/python3.10/site-packages/sqlalchemy/connectors/__init__.py (sqlalchemy.connectors)\r\nLOG:  Metadata fresh for psycopg2.sql: file /opt/homebrew/Caskroom/miniforge/base/envs/amplo/lib/python3.10/site-packages/psycopg2-stubs/sql.pyi\r\nLOG:  Loaded graph with 673 nodes (1.277 sec)\r\nLOG:  Found 228 SCCs; largest has 121 nodes\r\nLOG:  Processing 168 queued fresh SCCs\r\nLOG:  Processing SCC singleton (optuna.samplers._tpe._erf) as inherently stale\n```\n\n\n### Steps to reproduce\n\n1. Install python, mypy, optuna\r\n2. Run following code\r\n```python\r\nimport optuna\r\n```\r\n3. Run mypy `mypy script.py -v`\r\n\n\n### Additional context (optional)\n\nNot sure if this belongs here or over at mypy, happy to close if you feel it belongs at mypy. ", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4404/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4404/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4403", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4403/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4403/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4403/events", "html_url": "https://github.com/optuna/optuna/issues/4403", "id": 1574194305, "node_id": "I_kwDOB0okGM5d1EyB", "number": 4403, "title": "#4376 breaks compatibility with old `colorlog`", "user": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2023-02-07T11:56:05Z", "updated_at": "2023-02-14T10:23:00Z", "closed_at": "2023-02-14T10:23:00Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\n`import optuna` should not fail.\r\n\r\n\r\n### Environment\r\n\r\n- Optuna version:\r\n- Python version:\r\n- OS:\r\n- (Optional) Other libraries and their versions: **colorlog v4.8**\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\nFile ~/optuna/optuna/logging.py:36, in create_default_formatter()\r\n     31 def create_default_formatter() -> colorlog.ColoredFormatter:\r\n     32     \"\"\"Create a default formatter of log messages.\r\n     33 \r\n     34     This function is not supposed to be directly accessed by library users.\r\n     35     \"\"\"\r\n---> 36     return colorlog.ColoredFormatter(\r\n     37         \"%(log_color)s[%(levelname)1.1s %(asctime)s]%(reset)s %(message)s\",\r\n     38         no_color=False if _color_supported() else True,\r\n     39     )\r\n\r\nTypeError: ColoredFormatter.__init__() got an unexpected keyword argument 'no_color'\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\n1.\r\n```\r\n$ pip install colorlog==4.8.0\r\n```\r\n2.\r\n```\r\nimport optuna\r\n```\r\n\r\n\r\n### Additional context (optional)\r\nUpdating to the latest `colorlog` fixes this.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4403/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4403/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4399", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4399/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4399/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4399/events", "html_url": "https://github.com/optuna/optuna/issues/4399", "id": 1573653802, "node_id": "I_kwDOB0okGM5dzA0q", "number": 4399, "title": "pip cannot recognize package name when installing from local folder, ", "user": {"login": "wen-zheng", "id": 33896328, "node_id": "MDQ6VXNlcjMzODk2MzI4", "avatar_url": "https://avatars.githubusercontent.com/u/33896328?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wen-zheng", "html_url": "https://github.com/wen-zheng", "followers_url": "https://api.github.com/users/wen-zheng/followers", "following_url": "https://api.github.com/users/wen-zheng/following{/other_user}", "gists_url": "https://api.github.com/users/wen-zheng/gists{/gist_id}", "starred_url": "https://api.github.com/users/wen-zheng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wen-zheng/subscriptions", "organizations_url": "https://api.github.com/users/wen-zheng/orgs", "repos_url": "https://api.github.com/users/wen-zheng/repos", "events_url": "https://api.github.com/users/wen-zheng/events{/privacy}", "received_events_url": "https://api.github.com/users/wen-zheng/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2023-02-07T04:11:38Z", "updated_at": "2023-02-07T06:12:02Z", "closed_at": "2023-02-07T06:12:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\ncorectlly recognize package name \n\n### Environment\n\n- Optuna version:3.1.0\r\n- Python version:3.10.6\r\n- OS:Linux-5.15.0-57-generic-x86_64-with-glibc2.35\n\n### Error messages, stack traces, or logs\n\n```shell\nProcessing /home/ross/Downloads/work/auto-para-tune-optimizer/optimizer/backend/optuna\r\n  Installing build dependencies ... -\r\ndone\r\n  Getting requirements to build wheel ... done\r\n  Preparing metadata (pyproject.toml) ... done\r\nBuilding wheels for collected packages: UNKNOWN\r\n  Building wheel for UNKNOWN (pyproject.toml) ... done\r\n  Created wheel for UNKNOWN: filename=UNKNOWN-0.0.0-py3-none-any.whl size=2562 sha256=b9518253529718abe21e01bc0dad652b917f94a26a92d9473acbfaa78bef7df6\r\n  Stored in directory: /tmp/pip-ephem-wheel-cache-ad11zuh6/wheels/8c/4b/4a/58c67e43d09dee93a3929dc2964463292688680711fa25b359\r\nSuccessfully built UNKNOWN\r\nInstalling collected packages: UNKNOWN\r\n  Attempting uninstall: UNKNOWN\r\n    Found existing installation: UNKNOWN 0.0.0\r\n    Uninstalling UNKNOWN-0.0.0:\r\n      Successfully uninstalled UNKNOWN-0.0.0\r\nSuccessfully installed UNKNOWN-0.0.0\n```\n\n\n### Steps to reproduce\n\n1. clone optuna repository\r\n2. cd optuna folder\r\n3. pip install .\r\n\r\n\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4399/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4399/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4392", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4392/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4392/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4392/events", "html_url": "https://github.com/optuna/optuna/issues/4392", "id": 1571773889, "node_id": "I_kwDOB0okGM5dr13B", "number": 4392, "title": "AssertionError thrown when creating study, but only on some machines", "user": {"login": "AHolliday", "id": 5325747, "node_id": "MDQ6VXNlcjUzMjU3NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/5325747?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AHolliday", "html_url": "https://github.com/AHolliday", "followers_url": "https://api.github.com/users/AHolliday/followers", "following_url": "https://api.github.com/users/AHolliday/following{/other_user}", "gists_url": "https://api.github.com/users/AHolliday/gists{/gist_id}", "starred_url": "https://api.github.com/users/AHolliday/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AHolliday/subscriptions", "organizations_url": "https://api.github.com/users/AHolliday/orgs", "repos_url": "https://api.github.com/users/AHolliday/repos", "events_url": "https://api.github.com/users/AHolliday/events{/privacy}", "received_events_url": "https://api.github.com/users/AHolliday/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-02-06T02:15:53Z", "updated_at": "2023-02-06T02:28:37Z", "closed_at": "2023-02-06T02:28:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nWhen creating a new study with a sqlite database using `optuna.create_study`, the function call should succeed and a new study should be created.\r\n\r\n### Environment\r\n\r\n- Optuna version: 3.0.5\r\n- Python version: 3.8.15\r\n- OS: Linux-5.15.0-58-generic-x86_64-with-glibc2.10\r\n- (Optional) Other libraries and their versions:\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\n>>> import optuna\r\n>>> ss = optuna.create_study(study_name='foo', storage='sqlite:///foo.db')\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/usr/local/data/ahollid/mambaforge/envs/ptlearn/lib/python3.8/site-packages/optuna/_convert_positional_args.py\", line 63, in converter_wrapper\r\n    return func(**kwargs)\r\n  File \"/usr/local/data/ahollid/mambaforge/envs/ptlearn/lib/python3.8/site-packages/optuna/study/study.py\", line 1147, in create_study\r\n    storage = storages.get_storage(storage)\r\n  File \"/usr/local/data/ahollid/mambaforge/envs/ptlearn/lib/python3.8/site-packages/optuna/storages/__init__.py\", line 32, in get_storage\r\n    return _CachedStorage(RDBStorage(storage))\r\n  File \"/usr/local/data/ahollid/mambaforge/envs/ptlearn/lib/python3.8/site-packages/optuna/storages/_rdb/storage.py\", line 225, in __init__\r\n    self._version_manager.check_table_schema_compatibility()\r\n  File \"/usr/local/data/ahollid/mambaforge/envs/ptlearn/lib/python3.8/site-packages/optuna/storages/_rdb/storage.py\", line 1134, in check_table_schema_compatibility\r\n    current_version = self.get_current_version()\r\n  File \"/usr/local/data/ahollid/mambaforge/envs/ptlearn/lib/python3.8/site-packages/optuna/storages/_rdb/storage.py\", line 1161, in get_current_version\r\n    assert version is not None\r\nAssertionError\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\n```python\r\n# python code\r\nimport optuna\r\nss = optuna.create_study(study_name='foo', storage='sqlite:///foo.db')\r\n```\r\n\r\n\r\n### Additional context (optional)\r\n\r\nThis is something I've observed happen on two different machines now.  Any time I try to create a study in a sqlite database by passing a url of the form `sqlite:///my_study_name.db', the above error is thrown, but only on certain machines where I've tried to run it, despite the fact that I'm running off the same conda environment with the same software versions in each case.  On machines where it doesn't work, the two-line minimal example I gave is enough, but on other machines I can run the same code with no problem, so I can't really give instructions to reproduce the issue.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4392/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4392/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4391", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4391/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4391/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4391/events", "html_url": "https://github.com/optuna/optuna/issues/4391", "id": 1569977208, "node_id": "I_kwDOB0okGM5dk_N4", "number": 4391, "title": "Using the MLFlow Callback error 'Connection' object has no attribute 'connect' in Google Colab", "user": {"login": "FranLucchini", "id": 11548573, "node_id": "MDQ6VXNlcjExNTQ4NTcz", "avatar_url": "https://avatars.githubusercontent.com/u/11548573?v=4", "gravatar_id": "", "url": "https://api.github.com/users/FranLucchini", "html_url": "https://github.com/FranLucchini", "followers_url": "https://api.github.com/users/FranLucchini/followers", "following_url": "https://api.github.com/users/FranLucchini/following{/other_user}", "gists_url": "https://api.github.com/users/FranLucchini/gists{/gist_id}", "starred_url": "https://api.github.com/users/FranLucchini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/FranLucchini/subscriptions", "organizations_url": "https://api.github.com/users/FranLucchini/orgs", "repos_url": "https://api.github.com/users/FranLucchini/repos", "events_url": "https://api.github.com/users/FranLucchini/events{/privacy}", "received_events_url": "https://api.github.com/users/FranLucchini/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2023-02-03T15:01:29Z", "updated_at": "2023-02-06T10:58:25Z", "closed_at": "2023-02-06T10:58:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nI expected the `optuna.integration.MLflowCallback` example shown in the docs to work correctly and not trigger an error.\n\n### Environment\n\n- Optuna version: 3.1.0 (but happened with 3.0.4 and 3.0.5)\r\n- Python version: 3.8.10\r\n- OS: Linux in Google Colaboratory\r\n- (Optional) Other libraries and their versions:\r\n    - MLFlow: 1.27.0\n\n### Error messages, stack traces, or logs\n\n```shell\nThis is the error I get:\r\n\r\n[I 2023-02-03 14:14:41,177] A new study created in memory with name: my_study\r\n[I 2023-02-03 14:14:41,182] Trial 0 finished with value: 21.34372313649446 and parameters: {'x': -2.619926745793104}. Best is trial 0 with value: 21.34372313649446.\r\n2023/02/03 14:14:41 INFO mlflow.store.db.utils: Creating initial MLflow database tables...\r\n2023/02/03 14:14:41 INFO mlflow.store.db.utils: Updating database tables\r\n---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-4-4ed093efaa9c> in <module>\r\n     15 \r\n     16 study = optuna.create_study(study_name=\"my_study\")\r\n---> 17 study.optimize(objective, n_trials=10, callbacks=[mlflc])\r\n\r\n23 frames\r\n/usr/local/lib/python3.8/dist-packages/optuna/study/study.py in optimize(self, func, n_trials, timeout, n_jobs, catch, callbacks, gc_after_trial, show_progress_bar)\r\n    423         \"\"\"\r\n    424 \r\n--> 425         _optimize(\r\n    426             study=self,\r\n    427             func=func,\r\n\r\n/usr/local/lib/python3.8/dist-packages/optuna/study/_optimize.py in _optimize(study, func, n_trials, timeout, n_jobs, catch, callbacks, gc_after_trial, show_progress_bar)\r\n     64     try:\r\n     65         if n_jobs == 1:\r\n---> 66             _optimize_sequential(\r\n     67                 study,\r\n     68                 func,\r\n\r\n/usr/local/lib/python3.8/dist-packages/optuna/study/_optimize.py in _optimize_sequential(study, func, n_trials, timeout, catch, callbacks, gc_after_trial, reseed_sampler_rng, time_start, progress_bar)\r\n    172         if callbacks is not None:\r\n    173             for callback in callbacks:\r\n--> 174                 callback(study, frozen_trial)\r\n    175 \r\n    176         if progress_bar is not None:\r\n\r\n/usr/local/lib/python3.8/dist-packages/optuna/integration/mlflow.py in __call__(self, study, trial)\r\n    146 \r\n    147         with self._lock:\r\n--> 148             self._initialize_experiment(study)\r\n    149 \r\n    150             with mlflow.start_run(\r\n\r\n/usr/local/lib/python3.8/dist-packages/optuna/integration/mlflow.py in _initialize_experiment(self, study)\r\n    239 \r\n    240         if self._create_experiment:\r\n--> 241             mlflow.set_experiment(study.study_name)\r\n    242 \r\n    243     def _set_tags(self, trial: optuna.trial.FrozenTrial, study: optuna.study.Study) -> None:\r\n\r\n/usr/local/lib/python3.8/dist-packages/mlflow/tracking/fluent.py in set_experiment(experiment_name, experiment_id)\r\n    108         )\r\n    109 \r\n--> 110     client = MlflowClient()\r\n    111     if experiment_id is None:\r\n    112         experiment = client.get_experiment_by_name(experiment_name)\r\n\r\n/usr/local/lib/python3.8/dist-packages/mlflow/tracking/client.py in __init__(self, tracking_uri, registry_uri)\r\n     68         final_tracking_uri = utils._resolve_tracking_uri(tracking_uri)\r\n     69         self._registry_uri = registry_utils._resolve_registry_uri(registry_uri, tracking_uri)\r\n---> 70         self._tracking_client = TrackingServiceClient(final_tracking_uri)\r\n     71         # `MlflowClient` also references a `ModelRegistryClient` instance that is provided by the\r\n     72         # `MlflowClient._get_registry_client()` method. This `ModelRegistryClient` is not explicitly\r\n\r\n/usr/local/lib/python3.8/dist-packages/mlflow/tracking/_tracking_service/client.py in __init__(self, tracking_uri)\r\n     49         # property method to ensure that the client is serializable, even if the store is not\r\n     50         # self.store  # pylint: disable=pointless-statement\r\n---> 51         self.store\r\n     52 \r\n     53     @property\r\n\r\n/usr/local/lib/python3.8/dist-packages/mlflow/tracking/_tracking_service/client.py in store(self)\r\n     53     @property\r\n     54     def store(self):\r\n---> 55         return utils._get_store(self.tracking_uri)\r\n     56 \r\n     57     def get_run(self, run_id):\r\n\r\n/usr/local/lib/python3.8/dist-packages/mlflow/tracking/_tracking_service/utils.py in _get_store(store_uri, artifact_uri)\r\n    184 \r\n    185 def _get_store(store_uri=None, artifact_uri=None):\r\n--> 186     return _tracking_store_registry.get_store(store_uri, artifact_uri)\r\n    187 \r\n    188 \r\n\r\n/usr/local/lib/python3.8/dist-packages/mlflow/tracking/_tracking_service/registry.py in get_store(self, store_uri, artifact_uri)\r\n     37 \r\n     38         resolved_store_uri = utils._resolve_tracking_uri(store_uri)\r\n---> 39         return self._get_store_with_resolved_uri(resolved_store_uri, artifact_uri)\r\n     40 \r\n     41     @lru_cache(maxsize=100)\r\n\r\n/usr/local/lib/python3.8/dist-packages/mlflow/tracking/_tracking_service/registry.py in _get_store_with_resolved_uri(self, resolved_store_uri, artifact_uri)\r\n     47         \"\"\"\r\n     48         builder = self.get_store_builder(resolved_store_uri)\r\n---> 49         return builder(store_uri=resolved_store_uri, artifact_uri=artifact_uri)\r\n\r\n/usr/local/lib/python3.8/dist-packages/mlflow/tracking/_tracking_service/utils.py in _get_sqlalchemy_store(store_uri, artifact_uri)\r\n    146     if artifact_uri is None:\r\n    147         artifact_uri = DEFAULT_LOCAL_FILE_AND_ARTIFACT_PATH\r\n--> 148     return SqlAlchemyStore(store_uri, artifact_uri)\r\n    149 \r\n    150 \r\n\r\n/usr/local/lib/python3.8/dist-packages/mlflow/store/tracking/sqlalchemy_store.py in __init__(self, db_uri, default_artifact_root)\r\n    137         inspected_tables = set(sqlalchemy.inspect(self.engine).get_table_names())\r\n    138         if any(table not in inspected_tables for table in expected_tables):\r\n--> 139             mlflow.store.db.utils._initialize_tables(self.engine)\r\n    140         Base.metadata.bind = self.engine\r\n    141         SessionMaker = sqlalchemy.orm.sessionmaker(bind=self.engine)\r\n\r\n/usr/local/lib/python3.8/dist-packages/mlflow/store/db/utils.py in _initialize_tables(engine)\r\n     30     _logger.info(\"Creating initial MLflow database tables...\")\r\n     31     InitialBase.metadata.create_all(engine)\r\n---> 32     _upgrade_db(engine)\r\n     33 \r\n     34 \r\n\r\n/usr/local/lib/python3.8/dist-packages/mlflow/store/db/utils.py in _upgrade_db(engine)\r\n    146     with engine.begin() as connection:\r\n    147         config.attributes[\"connection\"] = connection  # pylint: disable=E1137\r\n--> 148         command.upgrade(config, \"heads\")\r\n    149 \r\n    150 \r\n\r\n/usr/local/lib/python3.8/dist-packages/alembic/command.py in upgrade(config, revision, sql, tag)\r\n    376         tag=tag,\r\n    377     ):\r\n--> 378         script.run_env()\r\n    379 \r\n    380 \r\n\r\n/usr/local/lib/python3.8/dist-packages/alembic/script/base.py in run_env(self)\r\n    567 \r\n    568         \"\"\"\r\n--> 569         util.load_python_file(self.dir, \"env.py\")\r\n    570 \r\n    571     @property\r\n\r\n/usr/local/lib/python3.8/dist-packages/alembic/util/pyfiles.py in load_python_file(dir_, filename)\r\n     92     if ext == \".py\":\r\n     93         if os.path.exists(path):\r\n---> 94             module = load_module_py(module_id, path)\r\n     95         else:\r\n     96             pyc_path = pyc_file_from_path(path)\r\n\r\n/usr/local/lib/python3.8/dist-packages/alembic/util/pyfiles.py in load_module_py(module_id, path)\r\n    108     assert spec\r\n    109     module = importlib.util.module_from_spec(spec)\r\n--> 110     spec.loader.exec_module(module)  # type: ignore\r\n    111     return module\r\n\r\n/usr/lib/python3.8/importlib/_bootstrap_external.py in exec_module(self, module)\r\n\r\n/usr/lib/python3.8/importlib/_bootstrap.py in _call_with_frames_removed(f, *args, **kwds)\r\n\r\n/usr/local/lib/python3.8/dist-packages/mlflow/store/db_migrations/env.py in <module>\r\n     82     run_migrations_offline()\r\n     83 else:\r\n---> 84     run_migrations_online()\r\n\r\n/usr/local/lib/python3.8/dist-packages/mlflow/store/db_migrations/env.py in run_migrations_online()\r\n     70         )\r\n     71 \r\n---> 72     with connectable.connect() as connection:\r\n     73         context.configure(\r\n     74             connection=connection, target_metadata=target_metadata, render_as_batch=True\r\n\r\nAttributeError: 'Connection' object has no attribute 'connect'\r\n```\n```\n\n\n### Steps to reproduce\n\n1. Open new Notebook in Google Colab.\r\n2. Install Optuna and MLFlow in one block of code.\r\n```python\r\n!pip install -q optuna==3.1.0 \r\n!pip install -q mlflow==1.27.0\r\n```\r\n3. Run the example found in [`optuna.integration.MLflowCallback`](https://optuna.readthedocs.io/en/stable/reference/generated/optuna.integration.MLflowCallback.html)\r\n```python\r\nimport mlflow\r\nimport optuna\r\nfrom optuna.integration.mlflow import MLflowCallback\r\n\r\nmlflow.set_tracking_uri(\"sqlite:///mydb1.sqlite\")\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_float(\"x\", -10, 10)\r\n    return (x - 2) ** 2\r\n\r\nmlflc = MLflowCallback(\r\n    tracking_uri=mlflow.get_tracking_uri(),\r\n    metric_name=\"my metric score\",\r\n)\r\n\r\nstudy = optuna.create_study(study_name=\"my_study\")\r\nstudy.optimize(objective, n_trials=10, callbacks=[mlflc])\r\n```\r\n4. Then I get the error message.\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4391/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4391/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4386", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4386/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4386/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4386/events", "html_url": "https://github.com/optuna/optuna/pull/4386", "id": 1567343086, "node_id": "PR_kwDOB0okGM5JEp2I", "number": 4386, "title": "Mitigate a blocking issue while running migrations with SQLAlchemy 2.0", "user": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/54", "html_url": "https://github.com/optuna/optuna/milestone/54", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/54/labels", "id": 8862825, "node_id": "MI_kwDOB0okGM4Ahzxp", "number": 54, "title": "v3.2.0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 2, "closed_issues": 126, "state": "open", "created_at": "2023-01-17T07:03:31Z", "updated_at": "2023-04-27T06:35:24Z", "due_on": null, "closed_at": null}, "comments": 4, "created_at": "2023-02-02T05:22:59Z", "updated_at": "2023-02-16T01:09:36Z", "closed_at": "2023-02-15T08:34:20Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4386", "html_url": "https://github.com/optuna/optuna/pull/4386", "diff_url": "https://github.com/optuna/optuna/pull/4386.diff", "patch_url": "https://github.com/optuna/optuna/pull/4386.patch", "merged_at": "2023-02-15T08:34:20Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull request after it gets two or more approvals. To proceed to the review process by the maintainers, please make sure that the PR meets the following conditions: (1) it passes all CI checks, and (2) it is neither in the draft nor WIP state. If you wish to discuss the PR in the draft state or need any other help, please mention the Optuna development team in the PR. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nRefs #4371 \r\n\r\n## Summary\r\n\r\nThe cause is a \"Waiting for metadata lock\" in MySQL when creating the *alembic_version` table and inserting the revision, so MySQL driver keeps waiting to read the query result from the socket.\r\n\r\n```\r\nmysql> show full processlist;\r\n+----+--------+------------------+--------+---------+------+---------------------------------+--------------------------------------------------------------------------------------------------------------------------------+\r\n| Id | User   | Host             | db     | Command | Time | State                           | Info                                                                                                                           |\r\n+----+--------+------------------+--------+---------+------+---------------------------------+--------------------------------------------------------------------------------------------------------------------------------+\r\n|  8 | optuna | 172.17.0.1:35254 | optuna | Query   |    0 | init                            | show full processlist                                                                                                          |\r\n|  9 | optuna | 172.17.0.1:50758 | optuna | Sleep   |   64 |                                 | NULL                                                                                                                           |\r\n| 10 | optuna | 172.17.0.1:50760 | optuna | Query   |   64 | Waiting for table metadata lock | CREATE TABLE alembic_version (\r\n\tversion_num VARCHAR(32) NOT NULL,\r\n\tCONSTRAINT alembic_version_pkc PRIMARY KEY (version_num)\r\n) |\r\n+----+--------+------------------+--------+---------+------+---------------------------------+--------------------------------------------------------------------------------------------------------------------------------+\r\n3 rows in set (0.00 sec)\r\n```\r\n\r\nBy applying this patch, the frequency of the problem was mitigated to 2 out of 11 attempts. There still seems to be another problem, but that is currently being investigated and will be addressed in a following PR.\r\n\r\nhttps://github.com/optuna/optuna/actions/runs/4071530931/jobs/7013678631\r\n\r\n## Compare SQL queries\r\n\r\n### SQLAlchemy v1.4.46 (master)\r\n\r\n```\r\nINFO:sqlalchemy.engine.Engine:SELECT COUNT(*) FROM information_schema.tables WHERE table_schema = %(table_schema)s AND table_name = %(table_name)s\r\nINFO:sqlalchemy.engine.Engine:[cached since 43.12s ago] {'table_schema': 'optuna', 'table_name': 'alembic_version'}\r\nINFO:sqlalchemy.engine.Engine:SELECT COUNT(*) FROM information_schema.tables WHERE table_schema = %(table_schema)s AND table_name = %(table_name)s\r\nINFO:sqlalchemy.engine.Engine:[cached since 43.13s ago] {'table_schema': 'optuna', 'table_name': 'alembic_version'}\r\nINFO:sqlalchemy.engine.Engine:\r\nCREATE TABLE alembic_version (\r\n\tversion_num VARCHAR(32) NOT NULL,\r\n\tCONSTRAINT alembic_version_pkc PRIMARY KEY (version_num)\r\n)\r\n\r\nINFO:sqlalchemy.engine.Engine:[no key 0.00037s] {}\r\nINFO:sqlalchemy.engine.Engine:INSERT INTO alembic_version (version_num) VALUES ('v3.0.0.d')\r\nINFO:sqlalchemy.engine.Engine:[generated in 0.00020s] {}\r\nINFO:sqlalchemy.engine.Engine:COMMIT\r\n--Return--\r\n> /Users/c-bata/go/src/github.com/optuna/optuna/optuna/storages/_rdb/storage.py(1063)_set_alembic_revision()->None\r\n-> context.stamp(script, revision)\r\n```\r\n\r\n### SQLAlchemy v2.0.1 (master)\r\n\r\n```\r\nINFO:sqlalchemy.engine.Engine:DESCRIBE `optuna`.`alembic_version`\r\nINFO:sqlalchemy.engine.Engine:[raw sql] {}\r\nINFO:sqlalchemy.engine.Engine:DESCRIBE `optuna`.`alembic_version`\r\nINFO:sqlalchemy.engine.Engine:[raw sql] {}\r\nINFO:sqlalchemy.engine.Engine:\r\nCREATE TABLE alembic_version (\r\n\tversion_num VARCHAR(32) NOT NULL,\r\n\tCONSTRAINT alembic_version_pkc PRIMARY KEY (version_num)\r\n)\r\n\r\nINFO:sqlalchemy.engine.Engine:[no key 0.00033s] {}\r\n```\r\n\r\n### SQLAlchemy v2.0.1 (this PR)\r\n\r\n```\r\nINFO:sqlalchemy.engine.Engine:DESCRIBE `optuna`.`alembic_version`\r\nINFO:sqlalchemy.engine.Engine:[raw sql] {}\r\nINFO:sqlalchemy.engine.Engine:DESCRIBE `optuna`.`alembic_version`\r\nINFO:sqlalchemy.engine.Engine:[raw sql] {}\r\nINFO:sqlalchemy.engine.Engine:\r\nCREATE TABLE alembic_version (\r\n\tversion_num VARCHAR(32) NOT NULL,\r\n\tCONSTRAINT alembic_version_pkc PRIMARY KEY (version_num)\r\n)\r\n\r\n\r\nINFO:sqlalchemy.engine.Engine:[no key 0.00039s] {}\r\nINFO:sqlalchemy.engine.Engine:INSERT INTO alembic_version (version_num) VALUES ('v3.0.0.d')\r\nINFO:sqlalchemy.engine.Engine:[generated in 0.00023s] {}\r\nINFO:sqlalchemy.engine.Engine:COMMIT\r\n--Return--\r\n> /Users/c-bata/go/src/github.com/optuna/optuna/optuna/storages/_rdb/storage.py(1064)_set_alembic_revision()->None\r\n-> context.stamp(script, revision)\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4386/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4386/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4375", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4375/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4375/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4375/events", "html_url": "https://github.com/optuna/optuna/issues/4375", "id": 1562915338, "node_id": "I_kwDOB0okGM5dKDIK", "number": 4375, "title": "Uniformative assertion error when connecting SQLite database", "user": {"login": "Markus28", "id": 15806078, "node_id": "MDQ6VXNlcjE1ODA2MDc4", "avatar_url": "https://avatars.githubusercontent.com/u/15806078?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Markus28", "html_url": "https://github.com/Markus28", "followers_url": "https://api.github.com/users/Markus28/followers", "following_url": "https://api.github.com/users/Markus28/following{/other_user}", "gists_url": "https://api.github.com/users/Markus28/gists{/gist_id}", "starred_url": "https://api.github.com/users/Markus28/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Markus28/subscriptions", "organizations_url": "https://api.github.com/users/Markus28/orgs", "repos_url": "https://api.github.com/users/Markus28/repos", "events_url": "https://api.github.com/users/Markus28/events{/privacy}", "received_events_url": "https://api.github.com/users/Markus28/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2023-01-30T18:00:13Z", "updated_at": "2023-02-01T05:15:27Z", "closed_at": "2023-01-31T02:04:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nI tried creating a study with SQLite storage, as described here: https://optuna.readthedocs.io/en/stable/tutorial/20_recipes/001_rdb.html\r\n\r\nI get the error message below, which seems to originates from Optuna, directly after a call to Alembic. The following lines are relevant:\r\nhttps://github.com/optuna/optuna/blob/ead2e13953915bf4ebb50d5880f069a29bb34ffb/optuna/storages/_rdb/storage.py#L1143\r\nhttps://github.com/sqlalchemy/alembic/blob/08266a49db1ce69224e62fa89f34f03a2f0f9529/alembic/runtime/migration.py#L489\r\n\r\nUnfortunately, the message is very uniformative, so I have so far not managed to solve the problem.\n\n### Environment\n\n- Optuna version:3.0.5\r\n- Python version:3.8.14\r\n- OS:Linux-5.15.0-48-generic-x86_64-with-glibc2.35\r\n- Alembic version: 1.9.0\n\n### Error messages, stack traces, or logs\n\n```shell\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/is/sg2/mkrimmel/experiment-management/.venv/lib/python3.8/site-packages/optuna/_convert_positional_args.py\", line 63, in converter_wrapper\r\n    return func(**kwargs)\r\n  File \"/is/sg2/mkrimmel/experiment-management/.venv/lib/python3.8/site-packages/optuna/study/study.py\", line 1147, in create_study\r\n    storage = storages.get_storage(storage)\r\n  File \"/is/sg2/mkrimmel/experiment-management/.venv/lib/python3.8/site-packages/optuna/storages/__init__.py\", line 32, in get_storage\r\n    return _CachedStorage(RDBStorage(storage))\r\n  File \"/is/sg2/mkrimmel/experiment-management/.venv/lib/python3.8/site-packages/optuna/storages/_rdb/storage.py\", line 225, in __init__\r\n    self._version_manager.check_table_schema_compatibility()\r\n  File \"/is/sg2/mkrimmel/experiment-management/.venv/lib/python3.8/site-packages/optuna/storages/_rdb/storage.py\", line 1134, in check_table_schema_compatibility\r\n    current_version = self.get_current_version()\r\n  File \"/is/sg2/mkrimmel/experiment-management/.venv/lib/python3.8/site-packages/optuna/storages/_rdb/storage.py\", line 1161, in get_current_version\r\n    assert version is not None\r\nAssertionError\n```\n\n\n### Steps to reproduce\n\n\r\n```python\r\n>>> import optuna\r\n>>> optuna.create_study(study_name=\"foo\", storage=\"sqlite:///foo.db\")\r\n\r\n```\r\n\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4375/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4375/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4371", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4371/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4371/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4371/events", "html_url": "https://github.com/optuna/optuna/issues/4371", "id": 1561607161, "node_id": "I_kwDOB0okGM5dFDv5", "number": 4371, "title": "Long time running test of MySQL storage with server", "user": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2023-01-30T02:03:53Z", "updated_at": "2023-02-17T01:14:56Z", "closed_at": "2023-02-17T01:14:55Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "### Expected behavior\n\nFinish the test of `Tests (Storage with server)` with MySQL in several minutes. \n\n### Environment\n\n- Optuna version: 22e57eba9cf1f352800b99d8d6c8a23c47bad239\r\n- Python version: 3.9, 3.11 (as long as I see)\r\n- OS: Ubuntu 22.0.4 in GitHub Actions\r\n- (Optional) Other libraries and their versions:\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\nhttps://github.com/optuna/optuna/actions/runs/4039069661\n```\n\n\n### Steps to reproduce\n\nRun a CI job `Test (Storage with server)`\r\n\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4371/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4371/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4369", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4369/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4369/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4369/events", "html_url": "https://github.com/optuna/optuna/issues/4369", "id": 1560615093, "node_id": "I_kwDOB0okGM5dBRi1", "number": 4369, "title": "The suggest_uniform function may return -inf.", "user": {"login": "take0212", "id": 43694878, "node_id": "MDQ6VXNlcjQzNjk0ODc4", "avatar_url": "https://avatars.githubusercontent.com/u/43694878?v=4", "gravatar_id": "", "url": "https://api.github.com/users/take0212", "html_url": "https://github.com/take0212", "followers_url": "https://api.github.com/users/take0212/followers", "following_url": "https://api.github.com/users/take0212/following{/other_user}", "gists_url": "https://api.github.com/users/take0212/gists{/gist_id}", "starred_url": "https://api.github.com/users/take0212/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/take0212/subscriptions", "organizations_url": "https://api.github.com/users/take0212/orgs", "repos_url": "https://api.github.com/users/take0212/repos", "events_url": "https://api.github.com/users/take0212/events{/privacy}", "received_events_url": "https://api.github.com/users/take0212/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2023-01-28T01:06:49Z", "updated_at": "2023-02-03T11:37:08Z", "closed_at": "2023-01-28T01:45:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nThe suggest_uniform function may return -inf.\r\n\r\n\r\n### Environment\r\n\r\n- Optuna version: 2.10.0\r\n- Python version: 3.7\r\n- OS: Windows 10\r\n- (Optional) Other libraries and their versions:\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\nMy code outputs [debug] or [error] lines.\r\nsample1)\r\n\r\n```shell\r\n[debug]val1 : -27.920559913837096\r\n[debug]val2 : range : -30.0 - -27.920559913837096\r\nD:\\****\\lib\\site-packages\\optuna\\samplers\\_tpe\\parzen_estimator.py:189: RuntimeWarning: invalid value encountered in add\r\n  log_pdf = -0.5 * mahalanobis ** 2 + np.log(coefficient)\r\nD:\\****\\lib\\site-packages\\optuna\\samplers\\_tpe\\sampler.py:459: RuntimeWarning: invalid value encountered in subtract\r\n  score = log_l - log_g\r\n[error]val2 : -inf\r\n```\r\n\r\nsample2)\r\n\r\n```shell\r\n[debug]val1 : -29.24202198902026\r\n[debug]val2 : range : -30.0 - -29.24202198902026\r\nD:\\****\\lib\\site-packages\\optuna\\samplers\\_tpe\\parzen_estimator.py:189: RuntimeWarning:\r\n\r\ninvalid value encountered in add\r\n\r\nD:\\****\\lib\\site-packages\\optuna\\samplers\\_tpe\\sampler.py:459: RuntimeWarning:\r\n\r\ninvalid value encountered in subtract\r\n\r\n[error]val2 : -inf\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\nSearch two variables val1 and val2.\r\n\r\nval1 is searched in the range from -30.0 to 30.0.\r\nval2 is searched in the range from -30.0 to val1.\r\n\r\n```python\r\nval1 = trial.suggest_uniform('val1', -30.0, 30.0)\r\nval2 = trial.suggest_uniform('val2', -30.0, val1)\r\n```\r\n\r\nIf the suggestion of val1 is close to -30, val2 will be searched in the range from -30 to -30+delta.\r\nIn this case, optuna may suggest -inf.\r\n\r\n\r\n### Additional context (optional)\r\n\r\nHas the following problem already been known and fixed in the latest version?\r\nI searched through the posts and found many posts about inf or -inf.\r\nBut I didn't find the problem.\r\n\r\nEven if it has already been fixed in the latest version, is there any way to resolve it in version 2?\r\n\r\nSince -inf is not expected for the value of val2, I replaced it with val1 and continued to execute.\r\n\r\nBut -inf was stored in the database (sqlite).\r\nSubsequent trials may terminate with the error.\r\n\r\n**error message**\r\n```\r\nTraceback (most recent call last):\r\n\r\n...\r\n\r\n  File \"D:\\****\\lib\\site-packages\\optuna\\study\\study.py\", line 409, in optimize\r\n    show_progress_bar=show_progress_bar,\r\n  File \"D:\\****\\lib\\site-packages\\optuna\\study\\_optimize.py\", line 76, in _optimize\r\n    progress_bar=progress_bar,\r\n  File \"D:\\****\\lib\\site-packages\\optuna\\study\\_optimize.py\", line 163, in _optimize_sequential\r\n    trial = _run_trial(study, func, catch)\r\n  File \"D:\\****\\lib\\site-packages\\optuna\\study\\_optimize.py\", line 264, in _run_trial\r\n    raise func_err\r\n  File \"D:\\****\\lib\\site-packages\\optuna\\study\\_optimize.py\", line 213, in _run_trial\r\n    value_or_values = func(trial)\r\n\r\n...\r\n\r\n    val = trial.suggest_uniform(key, range[0], range[1])\r\n  File \"D:\\****\\lib\\site-packages\\optuna\\trial\\_trial.py\", line 237, in suggest_uniform\r\n    return self._suggest(name, distribution)\r\n  File \"D:\\****\\lib\\site-packages\\optuna\\trial\\_trial.py\", line 720, in _suggest\r\n    study, trial, name, distribution\r\n  File \"D:\\****\\lib\\site-packages\\optuna\\samplers\\_tpe\\sampler.py\", line 442, in sample_independent\r\n    samples_below = mpe_below.sample(self._rng, self._n_ei_candidates)\r\n  File \"D:\\****\\lib\\site-packages\\optuna\\samplers\\_tpe\\parzen_estimator.py\", line 134, in sample\r\n    random_state=rng,\r\n  File \"D:\\****\\lib\\site-packages\\scipy\\stats\\_distn_infrastructure.py\", line 962, in rvs\r\n    raise ValueError(\"Domain error in arguments.\")\r\nValueError: Domain error in arguments.\r\n```\r\n\r\nI implemented the following codes, but it failed to update the database.\r\n\r\n**code**\r\n```Python\r\nif val2 is float('-inf'):\r\n    trial.params['val2'] = val1 # val2 cannot be updated.\r\n    trial.storage._studies[next(iter(trial.storage._studies))].trials[trial.number].params['val2'] = val1 # val2 was updated. but actually database wasn't updated.\r\n```\r\n\r\n**log**\r\n\r\nMy code outputs [debug] or [error] lines.\r\nsample1)\r\n\r\n```\r\n[debug]val1 : -27.920559913837096\r\n[debug]val2 : range : -30.0 - -27.920559913837096\r\nD:\\****\\lib\\site-packages\\optuna\\samplers\\_tpe\\parzen_estimator.py:189: RuntimeWarning: invalid value encountered in add\r\n  log_pdf = -0.5 * mahalanobis ** 2 + np.log(coefficient)\r\nD:\\****\\lib\\site-packages\\optuna\\samplers\\_tpe\\sampler.py:459: RuntimeWarning: invalid value encountered in subtract\r\n  score = log_l - log_g\r\n[error]val2 : -inf\r\n[error]fixed val2 : -inf -> -27.920559913837096\r\n[debug]trial.storage._studies[1].trials[264].params['val2'] : -27.920559913837096\r\n[debug]trial.params['val2'] : -27.920559913837096\r\n[debug]val2 : -27.920559913837096\r\n```\r\n\r\nsample2)\r\n\r\n```\r\n[debug]val1 : -29.24202198902026\r\n[debug]val2 : range : -30.0 - -29.24202198902026\r\nD:\\****\\lib\\site-packages\\optuna\\samplers\\_tpe\\parzen_estimator.py:189: RuntimeWarning:\r\n\r\ninvalid value encountered in add\r\n\r\nD:\\****\\lib\\site-packages\\optuna\\samplers\\_tpe\\sampler.py:459: RuntimeWarning:\r\n\r\ninvalid value encountered in subtract\r\n\r\n[error]val2 : -inf\r\n[error]fixed val2 : -inf -> -29.24202198902026\r\n[debug]trial.storage._studies[1].trials[277].params['val2'] : -29.24202198902026\r\n[debug]trial.params['val2'] : -29.24202198902026\r\n[debug]val2 : -29.24202198902026\r\n```\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4369/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4369/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4368", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4368/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4368/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4368/events", "html_url": "https://github.com/optuna/optuna/pull/4368", "id": 1560464619, "node_id": "PR_kwDOB0okGM5Ituj1", "number": 4368, "title": "Fix botorch dependency", "user": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561256, "node_id": "MDU6TGFiZWwxOTQ3NTYxMjU2", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.integration", "name": "optuna.integration", "color": "1c659e", "default": false, "description": "Related to the `optuna.integration` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/54", "html_url": "https://github.com/optuna/optuna/milestone/54", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/54/labels", "id": 8862825, "node_id": "MI_kwDOB0okGM4Ahzxp", "number": 54, "title": "v3.2.0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 2, "closed_issues": 126, "state": "open", "created_at": "2023-01-17T07:03:31Z", "updated_at": "2023-04-27T06:35:24Z", "due_on": null, "closed_at": null}, "comments": 4, "created_at": "2023-01-27T21:40:25Z", "updated_at": "2023-02-06T00:55:07Z", "closed_at": "2023-02-06T00:55:06Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4368", "html_url": "https://github.com/optuna/optuna/pull/4368", "diff_url": "https://github.com/optuna/optuna/pull/4368.diff", "patch_url": "https://github.com/optuna/optuna/pull/4368.patch", "merged_at": "2023-02-06T00:55:06Z"}, "body": "\r\n## Motivation\r\nFix #4367.\r\n\r\n`BoTorchSampler` fails with latest `botorch` due to a breaking change in API. We fix that.\r\n\r\n## Description of the changes\r\n`from botorch.sampling.normal import SobolQMCNormalSampler` -> `from botorch.sampling.samplers import SobolQMCNormalSampler`\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4368/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4368/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4367", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4367/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4367/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4367/events", "html_url": "https://github.com/optuna/optuna/issues/4367", "id": 1560442503, "node_id": "I_kwDOB0okGM5dAnaH", "number": 4367, "title": "Broken dependency for `BoTorchSampler`", "user": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2023-01-27T21:16:27Z", "updated_at": "2023-02-06T00:55:08Z", "closed_at": "2023-02-06T00:55:08Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nNo error when using `BoTorchSampler` with latest `botorch`.\r\n\r\n### Environment\r\n\r\n- Optuna version: v3.1.0\r\n- Python version: 3.9\r\n- OS: linux\r\n- (Optional) Other libraries and their versions: botorch 0.8.1\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\n/tmp/ipykernel_105635/1131768219.py:1: ExperimentalWarning: BoTorchSampler is experimental (supported from v2.4.0). The interface can change in the future.\r\n  study = optuna.create_study(sampler=BoTorchSampler())\r\n---------------------------------------------------------------------------\r\nModuleNotFoundError                       Traceback (most recent call last)\r\nFile /usr/local/lib/python3.9/site-packages/optuna/integration/botorch.py:39\r\n     38 from botorch.optim import optimize_acqf\r\n---> 39 from botorch.sampling.samplers import SobolQMCNormalSampler\r\n     40 from botorch.utils.multi_objective.box_decompositions import NondominatedPartitioning\r\n\r\nModuleNotFoundError: No module named 'botorch.sampling.samplers'\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nImportError                               Traceback (most recent call last)\r\nCell In[3], line 1\r\n----> 1 study = optuna.create_study(sampler=BoTorchSampler())\r\n\r\nFile /usr/local/lib/python3.9/site-packages/optuna/_experimental.py:115, in experimental_class.<locals>.decorator.<locals>.wrapper.<locals>.wrapped_init(self, *args, **kwargs)\r\n    104 @functools.wraps(_original_init)\r\n    105 def wrapped_init(self: Any, *args: Any, **kwargs: Any) -> None:\r\n    106     warnings.warn(\r\n    107         \"{} is experimental (supported from v{}). \"\r\n    108         \"The interface can change in the future.\".format(\r\n   (...)\r\n    112         stacklevel=2,\r\n    113     )\r\n--> 115     _original_init(self, *args, **kwargs)\r\n\r\nFile /usr/local/lib/python3.9/site-packages/optuna/integration/botorch.py:410, in BoTorchSampler.__init__(self, candidates_func, constraints_func, n_startup_trials, independent_sampler, seed)\r\n    391 def __init__(\r\n    392     self,\r\n    393     *,\r\n   (...)\r\n    408     seed: Optional[int] = None,\r\n    409 ):\r\n--> 410     _imports.check()\r\n    412     self._candidates_func = candidates_func\r\n    413     self._constraints_func = constraints_func\r\n\r\nFile /usr/local/lib/python3.9/site-packages/optuna/_imports.py:89, in _DeferredImportExceptionContextManager.check(self)\r\n     87 if self._deferred is not None:\r\n     88     exc_value, message = self._deferred\r\n---> 89     raise ImportError(message) from exc_value\r\n\r\nImportError: Tried to import 'botorch.sampling.samplers' but failed. Please make sure that the package is installed correctly to use this feature. Actual error: No module named 'botorch.sampling.samplers'.\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\n1. `pip3 install optuna botorch`\r\n2. \r\n```python\r\nimport optuna\r\nfrom optuna.integration.botorch import BoTorchSampler\r\nstudy = optuna.create_study(sampler=BoTorchSampler())\r\n```\r\n\r\n\r\n### Additional context (optional)\r\n\r\nNot sure why CI doesn't fail.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4367/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4367/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4362", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4362/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4362/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4362/events", "html_url": "https://github.com/optuna/optuna/issues/4362", "id": 1558055486, "node_id": "I_kwDOB0okGM5c3go-", "number": 4362, "title": "Prophet search trial freezes with optuna ", "user": {"login": "dariusmargineansrx", "id": 118744966, "node_id": "U_kgDOBxPnhg", "avatar_url": "https://avatars.githubusercontent.com/u/118744966?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dariusmargineansrx", "html_url": "https://github.com/dariusmargineansrx", "followers_url": "https://api.github.com/users/dariusmargineansrx/followers", "following_url": "https://api.github.com/users/dariusmargineansrx/following{/other_user}", "gists_url": "https://api.github.com/users/dariusmargineansrx/gists{/gist_id}", "starred_url": "https://api.github.com/users/dariusmargineansrx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dariusmargineansrx/subscriptions", "organizations_url": "https://api.github.com/users/dariusmargineansrx/orgs", "repos_url": "https://api.github.com/users/dariusmargineansrx/repos", "events_url": "https://api.github.com/users/dariusmargineansrx/events{/privacy}", "received_events_url": "https://api.github.com/users/dariusmargineansrx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-01-26T12:19:19Z", "updated_at": "2023-01-26T12:42:37Z", "closed_at": "2023-01-26T12:42:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nHello! \r\n\r\nI am currently using Prophet for a forecasting prototype, and I've done the search for the hyperparameters using optuna TPESampler. I have around 300 dataframes on which I have to compute the hyperparameter optimizations for. After completing a couple of dataframes the search suddenly freezes without any warning message and without exiting the proccess. It just gets blocked at a certain nr of trial (for the current search it has stopped, after completing 130 dataframes hyperparameter optimization at trial 786 out of 1000). I've tried to increase and decrease the number of trials per dataframe & (as expected) I've seen that as long as the number of trials goes down,  more dataframes gets to be computed & the more the number of trials goes up (like 2000)  less dataframes gets to be computed. Has everyone encountered this before? It really gets annoying because I have to restart the search because it can never get to an end. I am not quite sure if this is a problem with optuna or Prophet so I will post this on their github issue too.\r\n\r\nIt gets stucked inside the search function I've created, in the cross_validation() method from Prophet (I can tell that because in here it creates parallel processes  = how many folds we want to test the subset of hyperparameters, in my code are defined as cutoffs) \r\n\r\n### Environment\r\n\r\n- Optuna version: 3.0.3\r\n- Python version: 3.9.13\r\n- OS: Linux-5.15.0-56-generic-x86_64-with-glibc2.31\r\n- (Optional) Other libraries and their versions:\r\n- numpy: 1.23.5\r\n- pandas: 1.5.2\r\n- prophet: 1.1.1\r\n- scikit_learn: 1.2.0\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\nThere are no error messages displayed. It just freezes.\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\nHere is the code I am using:\r\n\r\n```python\r\ndef generate_cutoffs(df, weeks_to_forecast):\r\n    cutoffs = pd.to_datetime(\r\n            [\r\n                df.at[len(df) - (weeks_to_forecast*9+1), \"ds\"],\r\n                df.at[len(df) - (weeks_to_forecast*8+1), \"ds\"],\r\n                df.at[len(df) - (weeks_to_forecast*7+1), \"ds\"],\r\n                df.at[len(df) - (weeks_to_forecast*6+1), \"ds\"],\r\n                df.at[len(df) - (weeks_to_forecast*5+1), \"ds\"],\r\n                df.at[len(df) - (weeks_to_forecast*4+1), \"ds\"],\r\n                df.at[len(df) - (weeks_to_forecast*3+1), \"ds\"],\r\n                df.at[len(df) - (weeks_to_forecast*2+1), \"ds\"],\r\n                df.at[len(df) - (weeks_to_forecast+1), \"ds\"],\r\n            ]\r\n        )\r\n    return cutoffs\r\n\r\n\r\ndef get_best_hp_prophet_cv(df_for_cv, weeks_to_forecast, holidays_df):\r\n    logging.getLogger('prophet').setLevel(logging.ERROR)\r\n    logging.getLogger('fbprophet').setLevel(logging.ERROR)\r\n\r\n    # print('DF entered for search: ', df_for_cv)\r\n    cutoffs = generate_cutoffs(df_for_cv, weeks_to_forecast)\r\n\r\n    def objective(trial):\r\n\r\n        # print(cutoffs)\r\n\r\n        # print(df.tail(30))\r\n        param_grid = {\r\n        \"changepoint_prior_scale\": trial.suggest_categorical(\r\n            \"changepoint_prior_scale\", [0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.09, 0.1, 0.2, 0.5, 0.7, 0.8, 0.9, 1.0, 2.0, 3.0, 5.0, 9.0, 10.0]\r\n        ),\r\n        \"seasonality_prior_scale\": trial.suggest_categorical(\r\n            \"seasonality_prior_scale\", [0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.09, 0.1, 0.2, 0.5, 0.7, 0.8, 0.9, 1.0, 2.0, 3.0, 5.0, 9.0, 10.0]\r\n\r\n        ),\r\n        \"seasonality_mode\": trial.suggest_categorical(\r\n            \"seasonality_mode\", [\"multiplicative\", \"additive\"]\r\n        ),\r\n        \"growth\": trial.suggest_categorical(\"growth\", [\"linear\"]),\r\n        \"yearly_seasonality\": trial.suggest_categorical(\r\n            \"yearly_seasonality\", [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17]\r\n        ),\r\n        \"daily_seasonality\": trial.suggest_categorical(\"daily_seasonality\",[False]),\r\n        \"weekly_seasonality\": trial.suggest_categorical(\"weekly_seasonality\",[False]),\r\n        \"uncertainty_samples\": trial.suggest_categorical(\"uncertainty_samples\",[0]),\r\n    }\r\n    \r\n        prior_scale_month = trial.suggest_categorical('prior_scale_month', [0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.09, 0.1, 0.2, 0.5, 0.7, 0.8, 0.9, 1.0, 2.0, 3.0, 5.0, 9.0, 10.0])\r\n        prior_scale_week_num = trial.suggest_categorical('prior_scale_week_num', [0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.09, 0.1, 0.2, 0.5, 0.7, 0.8, 0.9, 1.0, 2.0, 3.0, 5.0, 9.0, 10.0])\r\n        prior_scale_avg_month_qty_over_df = trial.suggest_categorical('prior_scale_avg_month_qty_over_df', [0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.09, 0.1, 0.2, 0.5, 0.7, 0.8, 0.9, 1.0, 2.0, 3.0, 5.0, 9.0, 10.0])\r\n        prior_scale_avg_week_nr_qty_over_df = trial.suggest_categorical('prior_scale_avg_week_nr_qty_over_df', [0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.09, 0.1, 0.2, 0.5, 0.7, 0.8, 0.9, 1.0, 2.0, 3.0, 5.0, 9.0, 10.0])        \r\n        \r\n        prior_scale_avg_solar_rad_of_month = trial.suggest_categorical('prior_scale_avg_solar_rad_of_month', [0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.09, 0.1, 0.2, 0.5, 0.7, 0.8, 0.9, 1.0, 2.0, 3.0, 5.0, 9.0, 10.0])\r\n        prior_scale_avg_solar_rad_of_week_nr = trial.suggest_categorical('prior_scale_avg_solar_rad_of_week_nr', [0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.09, 0.1, 0.2, 0.5, 0.7, 0.8, 0.9, 1.0, 2.0, 3.0, 5.0, 9.0, 10.0])\r\n        prior_scale_avg_temp_of_month = trial.suggest_categorical('prior_scale_avg_temp_of_month', [0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.09, 0.1, 0.2, 0.5, 0.7, 0.8, 0.9, 1.0, 2.0, 3.0, 5.0, 9.0, 10.0])\r\n        prior_scale_avg_temp_of_week_nr = trial.suggest_categorical('prior_scale_avg_temp_of_week_nr', [0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.09, 0.1, 0.2, 0.5, 0.7, 0.8, 0.9, 1.0, 2.0, 3.0, 5.0, 9.0, 10.0])\r\n        prior_scale_avg_pres_of_month = trial.suggest_categorical('prior_scale_avg_pres_of_month', [0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.09, 0.1, 0.2, 0.5, 0.7, 0.8, 0.9, 1.0, 2.0, 3.0, 5.0, 9.0, 10.0])\r\n        prior_scale_avg_pres_of_week_nr = trial.suggest_categorical('prior_scale_avg_pres_of_week_nr', [0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.09, 0.1, 0.2, 0.5, 0.7, 0.8, 0.9, 1.0, 2.0, 3.0, 5.0, 9.0, 10.0])\r\n        \r\n        prior_scale_avg_solar_rad_last_week_week_nr = trial.suggest_categorical('prior_scale_avg_solar_rad_last_week_week_nr', [0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.09, 0.1, 0.2, 0.5, 0.7, 0.8, 0.9, 1.0, 2.0, 3.0, 5.0, 9.0, 10.0])\r\n        prior_scale_avg_temp_last_week_week_nr = trial.suggest_categorical('prior_scale_avg_temp_last_week_week_nr', [0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.09, 0.1, 0.2, 0.5, 0.7, 0.8, 0.9, 1.0, 2.0, 3.0, 5.0, 9.0, 10.0])\r\n        prior_scale_avg_pres_last_week_week_nr = trial.suggest_categorical('prior_scale_avg_pres_last_week_week_nr', [0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.09, 0.1, 0.2, 0.5, 0.7, 0.8, 0.9, 1.0, 2.0, 3.0, 5.0, 9.0, 10.0])\r\n        \r\n        prior_scale_avg_solar_rad_last_2weeks_week_nr = trial.suggest_categorical('prior_scale_avg_solar_rad_last_2weeks_week_nr', [0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.09, 0.1, 0.2, 0.5, 0.7, 0.8, 0.9, 1.0, 2.0, 3.0, 5.0, 9.0, 10.0])\r\n        prior_scale_avg_temp_last_2weeks_week_nr = trial.suggest_categorical('prior_scale_avg_temp_last_2weeks_week_nr', [0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.09, 0.1, 0.2, 0.5, 0.7, 0.8, 0.9, 1.0, 2.0, 3.0, 5.0, 9.0, 10.0])\r\n        prior_scale_avg_pres_last_2weeks_week_nr = trial.suggest_categorical('prior_scale_avg_pres_last_2weeks_week_nr', [0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.09, 0.1, 0.2, 0.5, 0.7, 0.8, 0.9, 1.0, 2.0, 3.0, 5.0, 9.0, 10.0])\r\n\r\n        prior_scale_avg_solar_rad_next_week_week_nr = trial.suggest_categorical('prior_scale_avg_solar_rad_next_week_week_nr', [0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.09, 0.1, 0.2, 0.5, 0.7, 0.8, 0.9, 1.0, 2.0, 3.0, 5.0, 9.0, 10.0])\r\n        prior_scale_avg_temp_next_week_week_nr = trial.suggest_categorical('prior_scale_avg_temp_next_week_week_nr', [0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.09, 0.1, 0.2, 0.5, 0.7, 0.8, 0.9, 1.0, 2.0, 3.0, 5.0, 9.0, 10.0])\r\n        prior_scale_avg_pres_next_week_week_nr = trial.suggest_categorical('prior_scale_avg_pres_next_week_week_nr', [0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.09, 0.1, 0.2, 0.5, 0.7, 0.8, 0.9, 1.0, 2.0, 3.0, 5.0, 9.0, 10.0])\r\n\r\n        prior_scale_avg_solar_rad_of_last_month = trial.suggest_categorical('prior_scale_avg_solar_rad_of_last_month', [0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.09, 0.1, 0.2, 0.5, 0.7, 0.8, 0.9, 1.0, 2.0, 3.0, 5.0, 9.0, 10.0])\r\n        prior_scale_avg_temp_of_last_month = trial.suggest_categorical('prior_scale_avg_temp_of_last_month', [0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.09, 0.1, 0.2, 0.5, 0.7, 0.8, 0.9, 1.0, 2.0, 3.0, 5.0, 9.0, 10.0])\r\n        prior_scale_avg_pres_of_last_month = trial.suggest_categorical('prior_scale_avg_pres_of_last_month', [0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.09, 0.1, 0.2, 0.5, 0.7, 0.8, 0.9, 1.0, 2.0, 3.0, 5.0, 9.0, 10.0])\r\n\r\n        prior_scale_avg_qty_last_2weeks_week_nr = trial.suggest_categorical('prior_scale_avg_qty_last_2weeks_week_nr', [0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.09, 0.1, 0.2, 0.5, 0.7, 0.8, 0.9, 1.0, 2.0, 3.0, 5.0, 9.0, 10.0])\r\n        prior_scale_avg_qty_next_week_week_nr = trial.suggest_categorical('prior_scale_avg_qty_next_week_week_nr', [0.001, 0.002, 0.005, 0.01, 0.02, 0.05, 0.09, 0.1, 0.2, 0.5, 0.7, 0.8, 0.9, 1.0, 2.0, 3.0, 5.0, 9.0, 10.0])\r\n        \r\n        # I ve used this only for testing to see if everything works fine\r\n        # param_grid = {\r\n        # 'changepoint_prior_scale': trial.suggest_categorical('changepoint_prior_scale', [0.001]),\r\n        # 'seasonality_prior_scale': trial.suggest_categorical('seasonality_prior_scale',[0.01, 0.1]),\r\n        # 'seasonality_mode' : trial.suggest_categorical('seasonality_mode',['additive']),\r\n        # 'growth': trial.suggest_categorical('growth',['linear']),\r\n        # 'yearly_seasonality': trial.suggest_categorical('yearly_seasonality',[14,15]),\r\n        # 'holidays_prior_scale' : trial.suggest_categorical('holidays_prior_scale',[10])\r\n        # }\r\n\r\n        # all_params = [dict(zip(param_grid.keys(), v)) for v in itertools.product(*param_grid.values())]\r\n        # mses = []  # Store the MSEs for each params here\r\n\r\n        # Use cross validation to evaluate all parameters\r\n        # for params in all_params:\r\n        m = Prophet(**param_grid, holidays = holidays_df)\r\n        m.add_regressor('month', prior_scale = prior_scale_month)\r\n        m.add_regressor('week_num', prior_scale = prior_scale_week_num)\r\n        m.add_regressor('avg_month_qty_over_df', prior_scale = prior_scale_avg_month_qty_over_df)\r\n        m.add_regressor('avg_week_nr_qty_over_df', prior_scale = prior_scale_avg_week_nr_qty_over_df)\r\n        \r\n        m.add_regressor('avg_solar_rad_of_month', prior_scale = prior_scale_avg_solar_rad_of_month)\r\n        m.add_regressor('avg_solar_rad_of_week_nr', prior_scale = prior_scale_avg_solar_rad_of_week_nr)\r\n        m.add_regressor('avg_pres_of_month', prior_scale = prior_scale_avg_pres_of_month)\r\n        m.add_regressor('avg_pres_of_week_nr', prior_scale = prior_scale_avg_pres_of_week_nr)\r\n        m.add_regressor('avg_temp_of_month', prior_scale = prior_scale_avg_temp_of_month)\r\n        m.add_regressor('avg_temp_of_week_nr', prior_scale = prior_scale_avg_temp_of_week_nr)\r\n        \r\n        m.add_regressor('avg_solar_rad_last_week_week_nr', prior_scale = prior_scale_avg_solar_rad_last_week_week_nr)\r\n        m.add_regressor('avg_temp_last_week_week_nr', prior_scale = prior_scale_avg_temp_last_week_week_nr)\r\n        m.add_regressor('avg_pres_last_week_week_nr', prior_scale = prior_scale_avg_pres_last_week_week_nr)\r\n        \r\n        m.add_regressor('avg_solar_rad_last_2weeks_week_nr', prior_scale = prior_scale_avg_solar_rad_last_2weeks_week_nr)\r\n        m.add_regressor('avg_temp_last_2weeks_week_nr', prior_scale = prior_scale_avg_temp_last_2weeks_week_nr)\r\n        m.add_regressor('avg_pres_last_2weeks_week_nr', prior_scale = prior_scale_avg_pres_last_2weeks_week_nr)\r\n\r\n        m.add_regressor('avg_solar_rad_next_week_week_nr', prior_scale = prior_scale_avg_solar_rad_next_week_week_nr)\r\n        m.add_regressor('avg_temp_next_week_week_nr', prior_scale = prior_scale_avg_temp_next_week_week_nr)\r\n        m.add_regressor('avg_pres_next_week_week_nr', prior_scale = prior_scale_avg_pres_next_week_week_nr)\r\n        \r\n        m.add_regressor('avg_solar_rad_of_last_month', prior_scale = prior_scale_avg_solar_rad_of_last_month)\r\n        m.add_regressor('avg_temp_of_last_month', prior_scale = prior_scale_avg_temp_of_last_month)\r\n        m.add_regressor('avg_pres_of_last_month', prior_scale = prior_scale_avg_pres_of_last_month)\r\n        \r\n        m.add_regressor('avg_qty_last_2weeks_week_nr', prior_scale = prior_scale_avg_qty_last_2weeks_week_nr)\r\n        m.add_regressor('avg_qty_next_week_week_nr', prior_scale = prior_scale_avg_qty_next_week_week_nr)\r\n\r\n        print(\"Model_params currently are: \", param_grid)\r\n        dict_with_non_model_params_to_print = {\r\n            'month': prior_scale_month,\r\n            'week_num': prior_scale_week_num,\r\n            'avg_month_qty_over_df': prior_scale_avg_month_qty_over_df,\r\n            'avg_week_nr_qty_over_df': prior_scale_avg_week_nr_qty_over_df,\r\n            \r\n            'avg_solar_rad_of_month': prior_scale_avg_solar_rad_of_month,\r\n            'avg_solar_rad_of_week_nr': prior_scale_avg_solar_rad_of_week_nr,\r\n            'avg_pres_of_month': prior_scale_avg_pres_of_month,\r\n            'avg_pres_of_week_nr': prior_scale_avg_pres_of_week_nr,\r\n            'avg_temp_of_month': prior_scale_avg_temp_of_month,\r\n            'avg_temp_of_week_nr': prior_scale_avg_temp_of_week_nr,\r\n            \r\n            'avg_solar_rad_last_week_week_nr': prior_scale_avg_solar_rad_last_week_week_nr,\r\n            'avg_temp_last_week_week_nr': prior_scale_avg_temp_last_week_week_nr,\r\n            'avg_pres_last_week_week_nr': prior_scale_avg_pres_last_week_week_nr,\r\n            \r\n            'avg_solar_rad_last_2weeks_week_nr':prior_scale_avg_solar_rad_last_2weeks_week_nr,\r\n            'avg_temp_last_2weeks_week_nr': prior_scale_avg_temp_last_2weeks_week_nr,\r\n            'avg_pres_last_2weeks_week_nr': prior_scale_avg_pres_last_2weeks_week_nr,\r\n            \r\n            'avg_solar_rad_next_week_week_nr': prior_scale_avg_solar_rad_next_week_week_nr,\r\n            'avg_temp_next_week_week_nr': prior_scale_avg_temp_next_week_week_nr,\r\n            'avg_pres_next_week_week_nr': prior_scale_avg_pres_next_week_week_nr,\r\n            \r\n            'avg_solar_rad_of_last_month': prior_scale_avg_solar_rad_of_last_month,\r\n            'avg_temp_of_last_month': prior_scale_avg_temp_of_last_month,\r\n            'avg_pres_of_last_month': prior_scale_avg_pres_of_last_month,\r\n            \r\n            'avg_qty_last_2weeks_week_nr': prior_scale_avg_qty_last_2weeks_week_nr,\r\n            'avg_qty_next_week_week_nr': prior_scale_avg_qty_next_week_week_nr\r\n        }\r\n        print(\"Non_model_params_currently are: \", dict_with_non_model_params_to_print)\r\n        \r\n        # m.add_country_holidays(country_name='UK')\r\n        # m.add_regressor('month')\r\n        # m.add_regressor('week_num')\r\n        # m.add_regressor('avg_month_qty_over_df')\r\n        # m.add_regressor('avg_week_nr_qty_over_df')\r\n        # m.add_regressor('BH_Minus_1_Week')\r\n        # m.add_regressor('BH_Minus_4_Weekday')\r\n        # m.add_regressor('BH_Minus_3_Weekday')\r\n        # m.add_regressor('BH_Minus_2_Weekday')\r\n        # m.add_regressor('BH_Minus_1_Weekday')\r\n        # m.add_regressor('BH_Nearest_Sat')\r\n        # m.add_regressor('Between_Xmas_NY')\r\n        # m.add_regressor('Xmas_NY')\r\n        # m.add_regressor('BH')\r\n        # m.add_regressor('BH_Plus_1_Weekday')\r\n        # m.add_regressor('BH_Plus_2_Weekday')\r\n        # m.add_regressor('BH_Plus_3_Weekday')\r\n        # m.add_regressor('BH_Plus_4_Weekday')\r\n        # m.add_regressor('BH_Plus_1_Week')\r\n        # m.add_regressor('Holiday_Xmas_Before_After')\r\n        # m.add_regressor('Holiday_Xmas')\r\n        # m.add_regressor('Holiday_Easter_Before_After')\r\n        # m.add_regressor('Holiday_Easter')\r\n        # m.add_regressor('Holiday_Summer_Before_After')\r\n        # m.add_regressor('Holiday_Summer')\r\n        # m.add_regressor('Half_Term')\r\n        \r\n        m.fit(df_for_cv)\r\n        df_cv = cross_validation(\r\n            m, cutoffs=cutoffs, horizon=\"{} days\".format(weeks_to_forecast*7), parallel=\"processes\"\r\n        )\r\n        df_p = performance_metrics(df_cv, rolling_window=1)\r\n        return df_p[\"mse\"].values[0]\r\n\r\n    # Find the best parameters\r\n    optuna_prophet = optuna.create_study(\r\n        direction=\"minimize\", sampler=TPESampler(seed=321)\r\n    )\r\n\r\n    # * n_trials optuna hyperparameter.\r\n    # optuna_prophet.optimize(objective, n_trials=5000)\r\n    optuna_prophet.optimize(objective, n_trials=1000)\r\n\r\n    prophet_trial = optuna_prophet.best_trial\r\n    prophet_trial_params = prophet_trial.params\r\n    \r\n    list_of_variables_outside_the_param_grid = ['prior_scale_month',\r\n                                                'prior_scale_week_num',\r\n                                                'prior_scale_avg_month_qty_over_df',\r\n                                                'prior_scale_avg_week_nr_qty_over_df', \r\n                                                \r\n                                                'prior_scale_avg_solar_rad_of_month', \r\n                                                'prior_scale_avg_solar_rad_of_week_nr', \r\n                                                'prior_scale_avg_temp_of_month', \r\n                                                'prior_scale_avg_temp_of_week_nr', \r\n                                                'prior_scale_avg_pres_of_month', \r\n                                                'prior_scale_avg_pres_of_week_nr',\r\n                                                \r\n                                                'prior_scale_avg_solar_rad_last_week_week_nr',\r\n                                                'prior_scale_avg_temp_last_week_week_nr', \r\n                                                'prior_scale_avg_pres_last_week_week_nr',\r\n                                                \r\n                                                'prior_scale_avg_solar_rad_last_2weeks_week_nr',\r\n                                                'prior_scale_avg_temp_last_2weeks_week_nr',\r\n                                                'prior_scale_avg_pres_last_2weeks_week_nr',\r\n                                                \r\n                                                'prior_scale_avg_solar_rad_next_week_week_nr',\r\n                                                'prior_scale_avg_temp_next_week_week_nr',\r\n                                                'prior_scale_avg_pres_next_week_week_nr',\r\n                                                \r\n                                                'prior_scale_avg_solar_rad_of_last_month',\r\n                                                'prior_scale_avg_temp_of_last_month',\r\n                                                'prior_scale_avg_pres_of_last_month',\r\n                                                \r\n                                                'prior_scale_avg_qty_last_2weeks_week_nr',\r\n                                                'prior_scale_avg_qty_next_week_week_nr']\r\n\r\n    params_outside_the_param_grid={}\r\n    param_grid = {}\r\n    for param_name in prophet_trial_params.keys():\r\n        if param_name in list_of_variables_outside_the_param_grid:\r\n            params_outside_the_param_grid.update({param_name : prophet_trial_params[param_name]})\r\n        else:\r\n            param_grid.update({param_name : prophet_trial_params[param_name]})\r\n\r\n    return param_grid, params_outside_the_param_grid```\r\n\r\n\r\n### Additional context (optional)\r\n\r\nThe 300 dataframes on which I tried to optimize the Prophet model for, are about >280 rows & < 290 rows  each. I do a 9 fold cross_validation using cuttofs (a list datetime objects, they are created using the generate_cutoffs() where df is the dataframe I want to compute the hyperparameter optimization, and weeks_to_forecast is always 12)", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4362/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4362/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4344", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4344/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4344/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4344/events", "html_url": "https://github.com/optuna/optuna/pull/4344", "id": 1534490010, "node_id": "PR_kwDOB0okGM5HcW0H", "number": 4344, "title": "Fix import of `ProcessGroup` from `torch.distributed`", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561256, "node_id": "MDU6TGFiZWwxOTQ3NTYxMjU2", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.integration", "name": "optuna.integration", "color": "1c659e", "default": false, "description": "Related to the `optuna.integration` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/53", "html_url": "https://github.com/optuna/optuna/milestone/53", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/53/labels", "id": 8783913, "node_id": "MI_kwDOB0okGM4Ahggp", "number": 53, "title": "v3.1.0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 47, "state": "closed", "created_at": "2022-12-21T05:05:02Z", "updated_at": "2023-01-18T05:40:42Z", "due_on": null, "closed_at": "2023-01-18T05:40:42Z"}, "comments": 0, "created_at": "2023-01-16T08:17:53Z", "updated_at": "2023-01-18T02:03:17Z", "closed_at": "2023-01-16T09:04:06Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4344", "html_url": "https://github.com/optuna/optuna/pull/4344", "diff_url": "https://github.com/optuna/optuna/pull/4344.diff", "patch_url": "https://github.com/optuna/optuna/pull/4344.patch", "merged_at": "2023-01-16T09:04:06Z"}, "body": "## Motivation\r\n\r\n- When I checked #4281, the test cases for pytorch distributed integration were deactivated\r\n- #4301 enabled unit tests of pytorch distributed integration, and the error occurred due to the change in #4281.\r\n  - `ModuleNotFoundError: No module named 'torch.distributed.ProcessGroup'`\r\n- I'm very sorry, but this is my fault when reviewing #4281, and I created this follow-up PR.\r\n\r\n## Description of the changes\r\n\r\n- import `ProcessGroup` from `torch.distributed` instead of importing `torch.distributed.ProcessGroup`", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4344/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4344/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4338", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4338/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4338/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4338/events", "html_url": "https://github.com/optuna/optuna/issues/4338", "id": 1533692935, "node_id": "I_kwDOB0okGM5bakwH", "number": 4338, "title": "Running multiple optuna python scripts using `&` in CLI does not work", "user": {"login": "dyhan316", "id": 34816251, "node_id": "MDQ6VXNlcjM0ODE2MjUx", "avatar_url": "https://avatars.githubusercontent.com/u/34816251?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dyhan316", "html_url": "https://github.com/dyhan316", "followers_url": "https://api.github.com/users/dyhan316/followers", "following_url": "https://api.github.com/users/dyhan316/following{/other_user}", "gists_url": "https://api.github.com/users/dyhan316/gists{/gist_id}", "starred_url": "https://api.github.com/users/dyhan316/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dyhan316/subscriptions", "organizations_url": "https://api.github.com/users/dyhan316/orgs", "repos_url": "https://api.github.com/users/dyhan316/repos", "events_url": "https://api.github.com/users/dyhan316/events{/privacy}", "received_events_url": "https://api.github.com/users/dyhan316/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2023-01-15T07:06:23Z", "updated_at": "2023-01-15T10:31:10Z", "closed_at": "2023-01-15T10:31:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\n```\r\npython3 main_optuna.py & python3 main_optuna.py & python3 main_optuna.py\r\n```\r\n\r\nI expect this to be equivalent to running `python3 main_optuna.py` on three different command line interfaces, and hence expect three trials to be run on parallel. \r\n\r\n\n\n### Environment\n\n- Optuna version: Optuna version:2.10.1\r\n- Python version: Python version:3.8.0\r\n- OS: Linux-3.10.0-1160.71.1.el7.x86_64-x86_64-with-glibc2.10\r\n- (Optional) Other libraries and their versions: if requested, I can provide the whole packages installed \r\n\n\n### Error messages, stack traces, or logs\n\n```shell\nHowever, when I do this only one program is run (which is visible through `nvidia-smi`, and looking at the study shows that only one instance is running.\n```\n\n\n### Steps to reproduce\n\n1. run multiple python scripts with optuna on a single command line prompt using the `&` method\n\n### Additional context (optional)\n\nIs there another way to run multiple optuna python scripts on a single command line prompt? (I am using slurm and want to run multiple instances of the program on one gpu at the same time, and since slurm does not support multiple job arrays on a single GPU, I had to run multiple programs on a single command line prompt, which is why I used `&`. However, now it seems that with optuna this does not work?)\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4338/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4338/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4325", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4325/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4325/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4325/events", "html_url": "https://github.com/optuna/optuna/pull/4325", "id": 1531716684, "node_id": "PR_kwDOB0okGM5HTJm2", "number": 4325, "title": "Fix constrained optimization with `TPESampler`'s `constant_liar`", "user": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/53", "html_url": "https://github.com/optuna/optuna/milestone/53", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/53/labels", "id": 8783913, "node_id": "MI_kwDOB0okGM4Ahggp", "number": 53, "title": "v3.1.0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 47, "state": "closed", "created_at": "2022-12-21T05:05:02Z", "updated_at": "2023-01-18T05:40:42Z", "due_on": null, "closed_at": "2023-01-18T05:40:42Z"}, "comments": 1, "created_at": "2023-01-13T05:09:14Z", "updated_at": "2023-02-07T05:41:16Z", "closed_at": "2023-01-16T05:15:28Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4325", "html_url": "https://github.com/optuna/optuna/pull/4325", "diff_url": "https://github.com/optuna/optuna/pull/4325.diff", "patch_url": "https://github.com/optuna/optuna/pull/4325.patch", "merged_at": "2023-01-16T05:15:28Z"}, "body": "## Motivation\r\nUsing `constraints_enabled=True` and `constant_liar=True` may cause `scores` and `violations` to have different lengths.\r\n\r\n## Description of the changes\r\n- Fix `_get_observation_pairs`\r\n- Add a test for correctly splitting trials", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4325/reactions", "total_count": 5, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 4, "rocket": 1, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4325/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4297", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4297/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4297/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4297/events", "html_url": "https://github.com/optuna/optuna/issues/4297", "id": 1517528069, "node_id": "I_kwDOB0okGM5ac6QF", "number": 4297, "title": "The `on_init_start` callback hook was deprecated in v1.6 and is no longer supported as of v1.8", "user": {"login": "OrfeasBourchas", "id": 50681848, "node_id": "MDQ6VXNlcjUwNjgxODQ4", "avatar_url": "https://avatars.githubusercontent.com/u/50681848?v=4", "gravatar_id": "", "url": "https://api.github.com/users/OrfeasBourchas", "html_url": "https://github.com/OrfeasBourchas", "followers_url": "https://api.github.com/users/OrfeasBourchas/followers", "following_url": "https://api.github.com/users/OrfeasBourchas/following{/other_user}", "gists_url": "https://api.github.com/users/OrfeasBourchas/gists{/gist_id}", "starred_url": "https://api.github.com/users/OrfeasBourchas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/OrfeasBourchas/subscriptions", "organizations_url": "https://api.github.com/users/OrfeasBourchas/orgs", "repos_url": "https://api.github.com/users/OrfeasBourchas/repos", "events_url": "https://api.github.com/users/OrfeasBourchas/events{/privacy}", "received_events_url": "https://api.github.com/users/OrfeasBourchas/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-01-03T15:12:56Z", "updated_at": "2023-01-08T07:16:20Z", "closed_at": "2023-01-08T07:16:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nI tried to implement a modified version of the code from the [example ](https://optuna.readthedocs.io/en/stable/reference/generated/optuna.integration.PyTorchLightningPruningCallback.html#optuna.integration.PyTorchLightningPruningCallback)in your docs.\n\n### Environment\n\n- Optuna version:3.0.5\r\n- Python version:3.10 \r\n- pytorch-lightning: 1.8.1\r\n- OS: Windows\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\nI am using \r\n\r\n- Optuna version:3.0.5\r\n- pytorch-lightning: 1.8.1\r\n- python 3.10\r\n\r\nI tried to implement a modified version of the code from the [example ](https://optuna.readthedocs.io/en/stable/reference/generated/optuna.integration.PyTorchLightningPruningCallback.html#optuna.integration.PyTorchLightningPruningCallback)in your docs, changed  and run it to the following error. \r\n\r\nThe following lines of code are from the \\pytorch_lightning\\trainer\\configuration_validator.py (218-233)\r\n\r\n\r\ndef _check_deprecated_callback_hooks(trainer: \"pl.Trainer\") -> None:\r\n    for callback in trainer.callbacks:\r\n        if callable(getattr(callback, \"on_init_start\", None)):\r\n            raise RuntimeError(\r\n                \"The `on_init_start` callback hook was deprecated in v1.6 and is no longer supported as of v1.8.\"\r\n            )\r\n\r\n\r\nAnd the error it the \"RuntimeError: The `on_init_start` callback hook was deprecated in v1.6 and is no longer supported as of v1.8.\"\r\n\r\nthe ```trainer.callbacks``` are \r\n```python\r\n[<optuna.integration.pytorch_lightning.PyTorchLightningPruningCallback at 0x19fa7fd50c0>,\r\n <pytorch_lightning.callbacks.progress.tqdm_progress.TQDMProgressBar at 0x19fa80dcd90>,\r\n <pytorch_lightning.callbacks.model_summary.ModelSummary at 0x19fa80dcbe0>,\r\n <pytorch_lightning.callbacks.gradient_accumulation_scheduler.GradientAccumulationScheduler at 0x19fa80dc910>]\r\n```\r\n\r\nand the error was caused during the\r\n ``` python <optuna.integration.pytorch_lightning.PyTorchLightningPruningCallback at 0x19fa7fd50c0>```\r\n\r\nAfter searching the docs I noticed that the \r\n```python \r\nclass PyTorchLightningPruningCallback(Callback): \r\n```\r\nhas a \r\n```python \r\ndef on_init_start(self, trainer: Trainer)\r\n ``` \r\nmethod\r\n\r\nAm I understanding something wrong? If not, is there any solution to this problem or some other issue where I could seek help\ud83d\ude05?\r\nThank you for your time,\r\nOrfeas\n```\n\n\n### Steps to reproduce\n\n1.\r\n2.\r\n3.\r\n```python\r\n# Due to confidentiality  I am able to only provide the following\r\npruner: optuna.pruners.BasePruner = (optuna.pruners.MedianPruner())\r\nstudy = optuna.create_study(direction= \"minimize\", pruner=pruner)\r\nstudy.optimize(objective, n_trials=500)\r\n```\r\n\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4297/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4297/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4275", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4275/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4275/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4275/events", "html_url": "https://github.com/optuna/optuna/pull/4275", "id": 1508742481, "node_id": "PR_kwDOB0okGM5GFp4P", "number": 4275, "title": "Skip constraint check for running trial", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "knshnb", "id": 23695091, "node_id": "MDQ6VXNlcjIzNjk1MDkx", "avatar_url": "https://avatars.githubusercontent.com/u/23695091?v=4", "gravatar_id": "", "url": "https://api.github.com/users/knshnb", "html_url": "https://github.com/knshnb", "followers_url": "https://api.github.com/users/knshnb/followers", "following_url": "https://api.github.com/users/knshnb/following{/other_user}", "gists_url": "https://api.github.com/users/knshnb/gists{/gist_id}", "starred_url": "https://api.github.com/users/knshnb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/knshnb/subscriptions", "organizations_url": "https://api.github.com/users/knshnb/orgs", "repos_url": "https://api.github.com/users/knshnb/repos", "events_url": "https://api.github.com/users/knshnb/events{/privacy}", "received_events_url": "https://api.github.com/users/knshnb/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "knshnb", "id": 23695091, "node_id": "MDQ6VXNlcjIzNjk1MDkx", "avatar_url": "https://avatars.githubusercontent.com/u/23695091?v=4", "gravatar_id": "", "url": "https://api.github.com/users/knshnb", "html_url": "https://github.com/knshnb", "followers_url": "https://api.github.com/users/knshnb/followers", "following_url": "https://api.github.com/users/knshnb/following{/other_user}", "gists_url": "https://api.github.com/users/knshnb/gists{/gist_id}", "starred_url": "https://api.github.com/users/knshnb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/knshnb/subscriptions", "organizations_url": "https://api.github.com/users/knshnb/orgs", "repos_url": "https://api.github.com/users/knshnb/repos", "events_url": "https://api.github.com/users/knshnb/events{/privacy}", "received_events_url": "https://api.github.com/users/knshnb/received_events", "type": "User", "site_admin": false}, {"login": "gen740", "id": 54583542, "node_id": "MDQ6VXNlcjU0NTgzNTQy", "avatar_url": "https://avatars.githubusercontent.com/u/54583542?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gen740", "html_url": "https://github.com/gen740", "followers_url": "https://api.github.com/users/gen740/followers", "following_url": "https://api.github.com/users/gen740/following{/other_user}", "gists_url": "https://api.github.com/users/gen740/gists{/gist_id}", "starred_url": "https://api.github.com/users/gen740/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gen740/subscriptions", "organizations_url": "https://api.github.com/users/gen740/orgs", "repos_url": "https://api.github.com/users/gen740/repos", "events_url": "https://api.github.com/users/gen740/events{/privacy}", "received_events_url": "https://api.github.com/users/gen740/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/53", "html_url": "https://github.com/optuna/optuna/milestone/53", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/53/labels", "id": 8783913, "node_id": "MI_kwDOB0okGM4Ahggp", "number": 53, "title": "v3.1.0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 47, "state": "closed", "created_at": "2022-12-21T05:05:02Z", "updated_at": "2023-01-18T05:40:42Z", "due_on": null, "closed_at": "2023-01-18T05:40:42Z"}, "comments": 3, "created_at": "2022-12-23T01:16:10Z", "updated_at": "2023-01-17T07:06:01Z", "closed_at": "2023-01-05T03:05:41Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4275", "html_url": "https://github.com/optuna/optuna/pull/4275", "diff_url": "https://github.com/optuna/optuna/pull/4275.diff", "patch_url": "https://github.com/optuna/optuna/pull/4275.patch", "merged_at": "2023-01-05T03:05:41Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull request after it gets two or more approvals. To proceed to the review process by the maintainers, please make sure that the PR meets the following conditions: (1) it passes all CI checks, and (2) it is neither in the draft nor WIP state. If you wish to discuss the PR in the draft state or need any other help, please mention the Optuna development team in the PR. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\nResolve #4221\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\nAs described in #4221, skip checking the constraint of trials when their states are `RUNNING` not to show the unnecessary warning.\r\n\r\n---\r\n\r\nI've checked the warning doesn't appear anymore with the slightly modified reproducible code provided in #4221.\r\n\r\n```python\r\nimport optuna\r\n\r\n\r\ndef objective(trial):\r\n\r\n    x = trial.suggest_float(\"x\", -1, 1)\r\n    trial.set_user_attr(\"constraint\", (-x,))\r\n\r\n    if trial.number == 2:\r\n        raise optuna.exceptions.TrialPruned()\r\n    return x\r\n\r\n\r\ndef constraints_func(trial):\r\n    return trial.user_attrs[\"constraint\"]\r\n\r\n\r\nsampler = optuna.samplers.TPESampler(constraints_func=constraints_func, constant_liar=True)\r\nstudy = optuna.create_study(sampler=sampler)\r\nstudy.optimize(objective, n_trials=4)\r\n\r\n```\r\n\r\n```bash\r\n/Users/nzw/Documents/optuna/optuna/samplers/_tpe/sampler.py:301: ExperimentalWarning: ``constant_liar`` option is an experimental feature. The interface can change in the future.\r\n  warnings.warn(\r\n/Users/nzw/Documents/optuna/optuna/samplers/_tpe/sampler.py:308: ExperimentalWarning: The ``constraints_func`` option is an experimental feature. The interface can change in the future.\r\n  warnings.warn(\r\n[I 2022-12-23 10:16:25,444] A new study created in memory with name: no-name-97edb984-06f2-465b-9ed7-510ee93213b7\r\n[I 2022-12-23 10:16:25,445] Trial 0 finished with value: 0.6581330973294237 and parameters: {'x': 0.6581330973294237}. Best is trial 0 with value: 0.6581330973294237.\r\n[I 2022-12-23 10:16:25,445] Trial 1 finished with value: -0.7749583637360082 and parameters: {'x': -0.7749583637360082}. Best is trial 1 with value: -0.7749583637360082.\r\n[I 2022-12-23 10:16:25,446] Trial 2 pruned.\r\n[I 2022-12-23 10:16:25,446] Trial 3 finished with value: 0.743792292814812 and parameters: {'x': 0.743792292814812}. Best is trial 1 with value: -0.7749583637360082.\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4275/reactions", "total_count": 2, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 2, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4275/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4261", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4261/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4261/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4261/events", "html_url": "https://github.com/optuna/optuna/issues/4261", "id": 1505424563, "node_id": "I_kwDOB0okGM5ZuvSz", "number": 4261, "title": "Tried to import 'botorch.sampling.samplers' but failed", "user": {"login": "deadsoul44", "id": 31016182, "node_id": "MDQ6VXNlcjMxMDE2MTgy", "avatar_url": "https://avatars.githubusercontent.com/u/31016182?v=4", "gravatar_id": "", "url": "https://api.github.com/users/deadsoul44", "html_url": "https://github.com/deadsoul44", "followers_url": "https://api.github.com/users/deadsoul44/followers", "following_url": "https://api.github.com/users/deadsoul44/following{/other_user}", "gists_url": "https://api.github.com/users/deadsoul44/gists{/gist_id}", "starred_url": "https://api.github.com/users/deadsoul44/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/deadsoul44/subscriptions", "organizations_url": "https://api.github.com/users/deadsoul44/orgs", "repos_url": "https://api.github.com/users/deadsoul44/repos", "events_url": "https://api.github.com/users/deadsoul44/events{/privacy}", "received_events_url": "https://api.github.com/users/deadsoul44/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-12-20T23:04:29Z", "updated_at": "2022-12-21T07:25:26Z", "closed_at": "2022-12-21T02:56:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nsampler = optuna.integration.BoTorchSampler()\r\nshould work\r\n\r\n### Environment\r\n\r\n- Optuna version: 3.0.5\r\n- Python version: 3.9.15\r\n- OS: MacOS\r\n- (Optional) Other libraries and their versions:\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\nModuleNotFoundError                       Traceback (most recent call last)\r\n~/opt/anaconda3/lib/python3.9/site-packages/optuna/integration/botorch.py in <module>\r\n     38     from botorch.optim import optimize_acqf\r\n---> 39     from botorch.sampling.samplers import SobolQMCNormalSampler\r\n     40     from botorch.utils.multi_objective.box_decompositions import NondominatedPartitioning\r\n\r\nModuleNotFoundError: No module named 'botorch.sampling.samplers'\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nImportError                               Traceback (most recent call last)\r\n/var/folders/hc/zm866qqn3w16w7d6zvvg14481lyj0r/T/ipykernel_6888/2874224597.py in <cell line: 2>()\r\n      1 directions = [\"minimize\"]\r\n----> 2 sampler = optuna.integration.BoTorchSampler()\r\n      3 study = optuna.create_study(directions=directions, sampler=sampler)\r\n      4 study.optimize(objective, n_trials=1000)\r\n\r\n~/opt/anaconda3/lib/python3.9/site-packages/optuna/_experimental.py in wrapped_init(self, *args, **kwargs)\r\n    113                 )\r\n    114 \r\n--> 115                 _original_init(self, *args, **kwargs)\r\n    116 \r\n    117             setattr(cls, \"__init__\", wrapped_init)\r\n...\r\n---> 89             raise ImportError(message) from exc_value\r\n     90 \r\n     91 \r\n\r\nImportError: Tried to import 'botorch.sampling.samplers' but failed. Please make sure that the package is installed correctly to use this feature. Actual error: No module named 'botorch.sampling.samplers'.\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\n```python\r\ndirections = [\"minimize\"]\r\nsampler = optuna.integration.BoTorchSampler()\r\nstudy = optuna.create_study(directions=directions, sampler=sampler)\r\nstudy.optimize(objective, n_trials=1000)\r\n```\r\n\r\n\r\n### Additional context (optional)\r\n\r\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4261/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4261/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4257", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4257/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4257/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4257/events", "html_url": "https://github.com/optuna/optuna/pull/4257", "id": 1502432626, "node_id": "PR_kwDOB0okGM5FwW6C", "number": 4257, "title": "[Backport] Fix bugs in `constant_liar` option", "user": {"login": "eukaryo", "id": 22315555, "node_id": "MDQ6VXNlcjIyMzE1NTU1", "avatar_url": "https://avatars.githubusercontent.com/u/22315555?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eukaryo", "html_url": "https://github.com/eukaryo", "followers_url": "https://api.github.com/users/eukaryo/followers", "following_url": "https://api.github.com/users/eukaryo/following{/other_user}", "gists_url": "https://api.github.com/users/eukaryo/gists{/gist_id}", "starred_url": "https://api.github.com/users/eukaryo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eukaryo/subscriptions", "organizations_url": "https://api.github.com/users/eukaryo/orgs", "repos_url": "https://api.github.com/users/eukaryo/repos", "events_url": "https://api.github.com/users/eukaryo/events{/privacy}", "received_events_url": "https://api.github.com/users/eukaryo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/52", "html_url": "https://github.com/optuna/optuna/milestone/52", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/52/labels", "id": 8776592, "node_id": "MI_kwDOB0okGM4AheuQ", "number": 52, "title": "v3.0.5", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 2, "state": "closed", "created_at": "2022-12-19T06:44:26Z", "updated_at": "2022-12-19T08:04:47Z", "due_on": null, "closed_at": "2022-12-19T08:04:47Z"}, "comments": 0, "created_at": "2022-12-19T07:13:13Z", "updated_at": "2022-12-19T07:35:13Z", "closed_at": "2022-12-19T07:35:02Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4257", "html_url": "https://github.com/optuna/optuna/pull/4257", "diff_url": "https://github.com/optuna/optuna/pull/4257.diff", "patch_url": "https://github.com/optuna/optuna/pull/4257.patch", "merged_at": "2022-12-19T07:35:02Z"}, "body": "Fix bugs in `constant_liar` option https://github.com/optuna/optuna/pull/4073\r\n\r\n<!-- Thank you for creating a pull request! In general, we merge your pull request after it gets two or more approvals. To proceed to the review process by the maintainers, please make sure that the PR meets the following conditions: (1) it passes all CI checks, and (2) it is neither in the draft nor WIP state. If you wish to discuss the PR in the draft state or need any other help, please mention the Optuna development team in the PR. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4257/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4257/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4234", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4234/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4234/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4234/events", "html_url": "https://github.com/optuna/optuna/issues/4234", "id": 1487010221, "node_id": "I_kwDOB0okGM5Yofmt", "number": 4234, "title": "Run wrongly marked as failed while still running", "user": {"login": "raphaelavalos", "id": 28591322, "node_id": "MDQ6VXNlcjI4NTkxMzIy", "avatar_url": "https://avatars.githubusercontent.com/u/28591322?v=4", "gravatar_id": "", "url": "https://api.github.com/users/raphaelavalos", "html_url": "https://github.com/raphaelavalos", "followers_url": "https://api.github.com/users/raphaelavalos/followers", "following_url": "https://api.github.com/users/raphaelavalos/following{/other_user}", "gists_url": "https://api.github.com/users/raphaelavalos/gists{/gist_id}", "starred_url": "https://api.github.com/users/raphaelavalos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/raphaelavalos/subscriptions", "organizations_url": "https://api.github.com/users/raphaelavalos/orgs", "repos_url": "https://api.github.com/users/raphaelavalos/repos", "events_url": "https://api.github.com/users/raphaelavalos/events{/privacy}", "received_events_url": "https://api.github.com/users/raphaelavalos/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-12-09T16:09:41Z", "updated_at": "2022-12-16T08:58:30Z", "closed_at": "2022-12-14T08:59:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nHello,\r\n\r\nI am using optuna on a cluster. In my (pretty standard) setting, each job connects to a remote database with optuna to get one set of hyper-parameters, run the experiment and report the result to optuna. The results are also tracked by Weight&Biases.\r\n\r\nFor some unknown reason **optuna falsely detects some jobs as failed** (as reported by `optuna-dashboard`), while they are still running. Usually this happens at the beginning. Once the job finishes correctly, it tries to report the result to optuna which raises an exception as a failed job can't be updated.\r\n\r\nI have tried the following versions of optuna: 3.0.0a2, 3.0.3, 3.0.4.\r\n\r\nThe error message, which is the consequence of updating a failed run, corresponds to optuna 3.0.0a2, but I am seeing the same behavior of runs wrongly marked as failed on the new version.\n\n### Environment\n\n- Optuna version: 3.0.4\r\n- Python version: 3.9\r\n- OS: Linux\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\nTraceback (most recent call last):\r\n  File \"/path_to_code/code.py\", line 346, in <module>\r\n    search(parameters, parameters.get('study_name', 'study'), parameters.get('n_trials', 1))\r\n  File \"/path_to_code/code.py\", line 324, in search\r\n    return optimize_hyperparameters(study_name, parameters['env_name'], optimize_trial, n_trials=n_trials)\r\n  File \"/path_to_code/code.py\", line 61, in optimize_hyperparameters\r\n    return study.optimize(optimize_trial, n_trials=n_trials)\r\n  File \"/venv_path/lib/python3.9/site-packages/optuna/study/study.py\", line 387, in optimize\r\n    _optimize(\r\n  File \"/venv_path/lib/python3.9/site-packages/optuna/study/_optimize.py\", line 68, in _optimize\r\n    _optimize_sequential(\r\n  File \"/venv_path/lib/python3.9/site-packages/optuna/study/_optimize.py\", line 162, in _optimize_sequential\r\n    trial = _run_trial(study, func, catch)\r\n  File \"/venv_path/lib/python3.9/site-packages/optuna/study/_optimize.py\", line 238, in _run_trial\r\n    study.tell(trial, values=values, state=state)\r\n  File \"/venv_path/lib/python3.9/site-packages/optuna/study/study.py\", line 662, in tell\r\n    self._storage.set_trial_values(trial_id, values)\r\n  File \"/venv_path/lib/python3.9/site-packages/optuna/storages/_cached_storage.py\", line 283, in set_trial_values\r\n    self._backend.set_trial_values(trial_id, values=values)\r\n  File \"/venv_path/lib/python3.9/site-packages/optuna/storages/_rdb/storage.py\", line 765, in set_trial_values\r\n    self.check_trial_is_updatable(trial_id, trial.state)\r\n  File \"/venv_path/lib/python3.9/site-packages/optuna/storages/_base.py\", line 722, in check_trial_is_updatable\r\n    raise RuntimeError(\r\nRuntimeError: Trial#750 has already finished and can not be updated.\n```\n\n\n### Steps to reproduce\n\n1.\r\n2.\r\n3.\r\n```python\r\n# python code\r\n```\r\n\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4234/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4234/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4221", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4221/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4221/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4221/events", "html_url": "https://github.com/optuna/optuna/issues/4221", "id": 1471101001, "node_id": "I_kwDOB0okGM5XrzhJ", "number": 4221, "title": "Constrained single-objective TPE always throws unnecessary warnings when `constant_liar=True`", "user": {"login": "knshnb", "id": 23695091, "node_id": "MDQ6VXNlcjIzNjk1MDkx", "avatar_url": "https://avatars.githubusercontent.com/u/23695091?v=4", "gravatar_id": "", "url": "https://api.github.com/users/knshnb", "html_url": "https://github.com/knshnb", "followers_url": "https://api.github.com/users/knshnb/followers", "following_url": "https://api.github.com/users/knshnb/following{/other_user}", "gists_url": "https://api.github.com/users/knshnb/gists{/gist_id}", "starred_url": "https://api.github.com/users/knshnb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/knshnb/subscriptions", "organizations_url": "https://api.github.com/users/knshnb/orgs", "repos_url": "https://api.github.com/users/knshnb/repos", "events_url": "https://api.github.com/users/knshnb/events{/privacy}", "received_events_url": "https://api.github.com/users/knshnb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-12-01T10:56:38Z", "updated_at": "2023-01-05T03:05:42Z", "closed_at": "2023-01-05T03:05:42Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nIt should not throw warnings.\r\n\r\n### Environment\r\n\r\n- Optuna version: v3.0.2\r\n- Python version: any\r\n- OS: any\r\n- (Optional) Other libraries and their versions:\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\noptuna/samplers/_tpe/sampler.py:679: UserWarning: Trial 0 does not have constraint values. It will be treated as a lower priority than other trials.\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\n```python\r\nimport optuna\r\n\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_float(\"x\", -1, 1)\r\n    trial.set_user_attr(\"constraint\", (-x,))\r\n    return x\r\n\r\n\r\ndef constraints_func(trial):\r\n    return trial.user_attrs[\"constraint\"]\r\n\r\n\r\nsampler = optuna.samplers.TPESampler(constraints_func=constraints_func, constant_liar=True)\r\nstudy = optuna.create_study(sampler=sampler)\r\nstudy.optimize(objective, n_trials=3)\r\n```\r\n\r\n\r\n### Additional context (optional)\r\n\r\nReported [here](https://github.com/optuna/optuna/pull/3506#issuecomment-1333389460).\r\nWe can skip this warning when the trial is running.\r\n~It seems we can fix this problem by skipping a trial that is the same as the current one. https://github.com/optuna/optuna/blob/2419e616e536e456867c9425e1e8db7af0da0d35/optuna/samplers/_tpe/sampler.py#L652-L657~", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4221/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4221/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4218", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4218/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4218/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4218/events", "html_url": "https://github.com/optuna/optuna/pull/4218", "id": 1470731299, "node_id": "PR_kwDOB0okGM5EB2Il", "number": 4218, "title": "[Backport] Specify object type to numpy array init to avoid unintended str cast", "user": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561256, "node_id": "MDU6TGFiZWwxOTQ3NTYxMjU2", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.integration", "name": "optuna.integration", "color": "1c659e", "default": false, "description": "Related to the `optuna.integration` submodule. This is automatically labeled by github-actions."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/51", "html_url": "https://github.com/optuna/optuna/milestone/51", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/51/labels", "id": 8709035, "node_id": "MI_kwDOB0okGM4AhOOr", "number": 51, "title": "v3.0.4", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 2, "state": "closed", "created_at": "2022-12-01T06:07:25Z", "updated_at": "2022-12-01T06:16:59Z", "due_on": null, "closed_at": "2022-12-01T06:16:59Z"}, "comments": 1, "created_at": "2022-12-01T06:02:00Z", "updated_at": "2022-12-01T06:09:09Z", "closed_at": "2022-12-01T06:05:22Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4218", "html_url": "https://github.com/optuna/optuna/pull/4218", "diff_url": "https://github.com/optuna/optuna/pull/4218.diff", "patch_url": "https://github.com/optuna/optuna/pull/4218.patch", "merged_at": "2022-12-01T06:05:22Z"}, "body": "Backport #4035 for v3.0.4.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4218/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4218/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4216", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4216/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4216/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4216/events", "html_url": "https://github.com/optuna/optuna/issues/4216", "id": 1470235419, "node_id": "I_kwDOB0okGM5XogMb", "number": 4216, "title": "ZeroDivisionError: when migrating schema from v2.6.0.a to v3.0.0.a", "user": {"login": "jaak-s", "id": 1640456, "node_id": "MDQ6VXNlcjE2NDA0NTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1640456?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaak-s", "html_url": "https://github.com/jaak-s", "followers_url": "https://api.github.com/users/jaak-s/followers", "following_url": "https://api.github.com/users/jaak-s/following{/other_user}", "gists_url": "https://api.github.com/users/jaak-s/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaak-s/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaak-s/subscriptions", "organizations_url": "https://api.github.com/users/jaak-s/orgs", "repos_url": "https://api.github.com/users/jaak-s/repos", "events_url": "https://api.github.com/users/jaak-s/events{/privacy}", "received_events_url": "https://api.github.com/users/jaak-s/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-11-30T21:25:14Z", "updated_at": "2023-01-31T16:57:27Z", "closed_at": "2023-01-31T16:57:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nUpgrade to complete.\n\n### Environment\n\n- Optuna version: 3.0.3\r\n- Python version: 3.8.7\r\n- OS: Windows (also similar error in Linux)\r\n- (Optional) Other libraries and their versions:\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\nFile \"...\\lib\\site-packages\\optuna\\distributions.py\", line 680, in _adjust_int_uniform_high\r\n  if r % step != 0:\r\nZeroDivisionError: integer division or modulo by zero\r\n```\n```\n\n\n### Steps to reproduce\n\n1. Install old optuna\r\n2. Run studies with PostgreSQL backend with step=0 (somehow, not clear how I got these runs)\r\n3. Install optuna 3.0.3\r\n4. Upgrade schema.\r\n\n\n### Additional context (optional)\n\nI have a lot of Optuna studies in psql created by old Optuna versions. Some probably have step==0 (not sure how) and when upgrading we get division by zero error. Maybe the step is 0 when low and high are set to equal.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4216/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4216/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4209", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4209/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4209/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4209/events", "html_url": "https://github.com/optuna/optuna/issues/4209", "id": 1464604642, "node_id": "I_kwDOB0okGM5XTBfi", "number": 4209, "title": "\"TypeError: Object of type int64 is not JSON serializable\" in LightGBMTunerCV", "user": {"login": "yyoshiaki", "id": 19543497, "node_id": "MDQ6VXNlcjE5NTQzNDk3", "avatar_url": "https://avatars.githubusercontent.com/u/19543497?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yyoshiaki", "html_url": "https://github.com/yyoshiaki", "followers_url": "https://api.github.com/users/yyoshiaki/followers", "following_url": "https://api.github.com/users/yyoshiaki/following{/other_user}", "gists_url": "https://api.github.com/users/yyoshiaki/gists{/gist_id}", "starred_url": "https://api.github.com/users/yyoshiaki/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yyoshiaki/subscriptions", "organizations_url": "https://api.github.com/users/yyoshiaki/orgs", "repos_url": "https://api.github.com/users/yyoshiaki/repos", "events_url": "https://api.github.com/users/yyoshiaki/events{/privacy}", "received_events_url": "https://api.github.com/users/yyoshiaki/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2022-11-25T14:13:05Z", "updated_at": "2022-11-28T06:54:05Z", "closed_at": "2022-11-27T04:57:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nLightGBMTunerCV raised an error in JSON dump.the \n\n### Environment\n\n- Optuna version:2.10.1\r\n- Python version:3.9.2\r\n- OS:Linux-3.10.0-957.5.1.el7.x86_64-x86_64-with-glibc2.17\r\n- (Optional) Other libraries and their versions:\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\n[W 2022-11-24 11:01:53,972] Trial 0 failed because of the following error: TypeError('Object of type int64 is not JSON serializable')\r\nTraceback (most recent call last):\r\n  File \"/home/yyasumizu/anaconda3/envs/tcrbert/lib/python3.9/site-packages/optuna/study/_optimize.py\", line 213, in _run_trial\r\n    value_or_values = func(trial)\r\n  File \"/home/yyasumizu/anaconda3/envs/tcrbert/lib/python3.9/site-packages/optuna/integration/_lightgbm_tuner/optimize.py\", line 341, in __call__\r\n    self._postprocess(trial, elapsed_secs, average_iteration_time)\r\n  File \"/home/yyasumizu/anaconda3/envs/tcrbert/lib/python3.9/site-packages/optuna/integration/_lightgbm_tuner/optimize.py\", line 279, in _postprocess\r\n    trial.set_system_attr(_LGBM_PARAMS_KEY, json.dumps(self.lgbm_params))\r\n  File \"/home/yyasumizu/anaconda3/envs/tcrbert/lib/python3.9/json/__init__.py\", line 231, in dumps\r\n    return _default_encoder.encode(obj)\r\n  File \"/home/yyasumizu/anaconda3/envs/tcrbert/lib/python3.9/json/encoder.py\", line 199, in encode\r\n    chunks = self.iterencode(o, _one_shot=True)\r\n  File \"/home/yyasumizu/anaconda3/envs/tcrbert/lib/python3.9/json/encoder.py\", line 257, in iterencode\r\n    return _iterencode(o, 0)\r\n  File \"/home/yyasumizu/anaconda3/envs/tcrbert/lib/python3.9/json/encoder.py\", line 179, in default\r\n    raise TypeError(f'Object of type {o.__class__.__name__} '\r\nTypeError: Object of type int64 is not JSON serializable\r\nTraceback (most recent call last):\r\n  File \"/home/yyasumizu/TCRBERT/src/tcr-bert/221108_pretrained_lgbm_subsample_optuna.py\", line 215, in <module>\r\n    tuner.run()\r\n  File \"/home/yyasumizu/anaconda3/envs/tcrbert/lib/python3.9/site-packages/optuna/integration/_lightgbm_tuner/optimize.py\", line 546, in run\r\n    self.tune_feature_fraction()\r\n  File \"/home/yyasumizu/anaconda3/envs/tcrbert/lib/python3.9/site-packages/optuna/integration/_lightgbm_tuner/optimize.py\", line 571, in tune_feature_fraction\r\n    self._tune_params([param_name], len(param_values), sampler, \"feature_fraction\")\r\n  File \"/home/yyasumizu/anaconda3/envs/tcrbert/lib/python3.9/site-packages/optuna/integration/_lightgbm_tuner/optimize.py\", line 654, in _tune_params\r\n    study.optimize(\r\n  File \"/home/yyasumizu/anaconda3/envs/tcrbert/lib/python3.9/site-packages/optuna/study/study.py\", line 400, in optimize\r\n    _optimize(\r\n  File \"/home/yyasumizu/anaconda3/envs/tcrbert/lib/python3.9/site-packages/optuna/study/_optimize.py\", line 66, in _optimize\r\n    _optimize_sequential(\r\n  File \"/home/yyasumizu/anaconda3/envs/tcrbert/lib/python3.9/site-packages/optuna/study/_optimize.py\", line 163, in _optimize_sequential\r\n    trial = _run_trial(study, func, catch)\r\n  File \"/home/yyasumizu/anaconda3/envs/tcrbert/lib/python3.9/site-packages/optuna/study/_optimize.py\", line 264, in _run_trial\r\n    raise func_err\r\n  File \"/home/yyasumizu/anaconda3/envs/tcrbert/lib/python3.9/site-packages/optuna/study/_optimize.py\", line 213, in _run_trial\r\n    value_or_values = func(trial)\r\n  File \"/home/yyasumizu/anaconda3/envs/tcrbert/lib/python3.9/site-packages/optuna/integration/_lightgbm_tuner/optimize.py\", line 341, in __call__\r\n    self._postprocess(trial, elapsed_secs, average_iteration_time)\r\n  File \"/home/yyasumizu/anaconda3/envs/tcrbert/lib/python3.9/site-packages/optuna/integration/_lightgbm_tuner/optimize.py\", line 279, in _postprocess\r\n    trial.set_system_attr(_LGBM_PARAMS_KEY, json.dumps(self.lgbm_params))\r\n  File \"/home/yyasumizu/anaconda3/envs/tcrbert/lib/python3.9/json/__init__.py\", line 231, in dumps\r\n    return _default_encoder.encode(obj)\r\n  File \"/home/yyasumizu/anaconda3/envs/tcrbert/lib/python3.9/json/encoder.py\", line 199, in encode\r\n    chunks = self.iterencode(o, _one_shot=True)\r\n  File \"/home/yyasumizu/anaconda3/envs/tcrbert/lib/python3.9/json/encoder.py\", line 257, in iterencode\r\n    return _iterencode(o, 0)\r\n  File \"/home/yyasumizu/anaconda3/envs/tcrbert/lib/python3.9/json/encoder.py\", line 179, in default\r\n    raise TypeError(f'Object of type {o.__class__.__name__} '\r\nTypeError: Object of type int64 is not JSON serializable\r\nfeature_fraction, val_score: 0.671225:  14%|##############                                                                                    | 1/7 [13:52:37<83:15:45, 49957.55s/it]\n```\n\n\n### Steps to reproduce\n\n```python\r\nFOLD = 5\r\nNUM_ROUND = 10000\r\nVERBOSE_EVAL = 1\r\nNUM_CLASS = 10\r\n\r\nfolds = StratifiedKFold(n_splits=FOLD, shuffle=True, random_state=42)\r\n\r\nlgb_train = lgb.Dataset(X_train, y_train)\r\n\r\nparams = {'objective': 'multiclass',\r\n        'metric': 'multi_logloss',\r\n        'num_class': NUM_CLASS,\r\n        'boosting_type': 'gbdt',\r\n        'deterministic':True, \r\n        'force_row_wise':True\r\n        } \r\n        \r\ntuner = lgb.LightGBMTunerCV(params, lgb_train, \r\n    verbose_eval=100, num_boost_round=NUM_ROUND, early_stopping_rounds=100, \r\n    folds=folds)\r\n    \r\ntuner.run()\r\n```\r\n\n\n### Additional context (optional)\n\n I could solve the error by adding an encoder in `optuna/integration/_lightgbm_tuner/optimize.py` .\r\n\r\n```\r\nclass MyEncoder(json.JSONEncoder):\r\n    def default(self, obj):\r\n        if isinstance(obj, np.integer):\r\n            return int(obj)\r\n        elif isinstance(obj, np.floating):\r\n            return float(obj)\r\n        elif isinstance(obj, np.ndarray):\r\n            return obj.tolist()\r\n        else:\r\n            return super(MyEncoder, self).default(obj)\r\n\r\n...\r\n\r\ntrial.set_system_attr(_LGBM_PARAMS_KEY, json.dumps(self.lgbm_params, cls=MyEncoder))\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4209/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4209/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4192", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4192/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4192/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4192/events", "html_url": "https://github.com/optuna/optuna/issues/4192", "id": 1454946930, "node_id": "I_kwDOB0okGM5WuLpy", "number": 4192, "title": "Failed to run perform_crossover: convert the type of params for categorical suggestions", "user": {"login": "trajepl", "id": 13343117, "node_id": "MDQ6VXNlcjEzMzQzMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/13343117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/trajepl", "html_url": "https://github.com/trajepl", "followers_url": "https://api.github.com/users/trajepl/followers", "following_url": "https://api.github.com/users/trajepl/following{/other_user}", "gists_url": "https://api.github.com/users/trajepl/gists{/gist_id}", "starred_url": "https://api.github.com/users/trajepl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/trajepl/subscriptions", "organizations_url": "https://api.github.com/users/trajepl/orgs", "repos_url": "https://api.github.com/users/trajepl/repos", "events_url": "https://api.github.com/users/trajepl/events{/privacy}", "received_events_url": "https://api.github.com/users/trajepl/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-11-18T11:29:14Z", "updated_at": "2022-11-24T10:06:37Z", "closed_at": "2022-11-24T10:06:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\n![image](https://user-images.githubusercontent.com/13343117/202695100-f5e0953e-56e2-4178-b7e8-47b9843f7448.png)\r\nHere are my search spaces where I set all the bool parameter as categorical suggestions. Just observed that it will crash in **trial 49**  both for single objective optimization or multi objectives optimization.\r\n\r\n\r\n\r\nLooks that when it run into perform_crossover, **the date type of bool will be converted to string.**, then the processing failed at _is_contained checking.  The sampler is **\"NSGAIISampler\"**\r\n![image](https://user-images.githubusercontent.com/13343117/202694596-57dbf97c-6960-4a98-bc2d-8d9eabae25e6.png)\r\n\r\n\r\n### Environment\r\n\r\n- Optuna version: 3.0.2\r\n- Python version: 3.8.14\r\n- OS: Ubunti 18.04\r\n- (Optional) Other libraries and their versions:\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\nbest id: 31 best_accuracy: -inf, best_latency: inf\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.8/runpy.py\", line 194, in _run_module_as_main\r\n    return _run_code(code, main_globals, None,\r\n  File \"/usr/lib/python3.8/runpy.py\", line 87, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/home/jiapli/.vscode-server/extensions/ms-python.python-2022.18.2/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher/../../debugpy/__main__.py\", line 39, in <module>\r\n    cli.main()\r\n  File \"/home/jiapli/.vscode-server/extensions/ms-python.python-2022.18.2/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher/../../debugpy/../debugpy/server/cli.py\", line 430, in main\r\n    run()\r\n  File \"/home/jiapli/.vscode-server/extensions/ms-python.python-2022.18.2/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher/../../debugpy/../debugpy/server/cli.py\", line 284, in run_file\r\n    runpy.run_path(target, run_name=\"__main__\")\r\n  File \"/home/jiapli/.vscode-server/extensions/ms-python.python-2022.18.2/pythonFiles/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py\", line 321, in run_path\r\n    return _run_module_code(code, init_globals, run_name,\r\n  File \"/home/jiapli/.vscode-server/extensions/ms-python.python-2022.18.2/pythonFiles/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py\", line 135, in _run_module_code\r\n    _run_code(code, mod_globals, init_globals,\r\n  File \"/home/jiapli/.vscode-server/extensions/ms-python.python-2022.18.2/pythonFiles/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py\", line 124, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/home/jiapli/workspace/olive2/examples/auto_tuner/optuna experiments.py\", line 214, in <module>\r\n    dump_experiments(item[0], exp_times=5, n_trials=100, exp=eval_sampler_for_single_objective, static=item[1])\r\n  File \"/home/jiapli/workspace/olive2/examples/auto_tuner/optuna experiments.py\", line 207, in dump_experiments\r\n    rls.append(exp(samplers, json_fn=fn, static=static, n_trials=n_trials))\r\n  File \"/home/jiapli/workspace/olive2/examples/auto_tuner/optuna experiments.py\", line 170, in eval_sampler_for_single_objective\r\n    study.optimize(objective, n_trials=n_trials, callbacks=[_callback])\r\n  File \"/home/jiapli/venv/lib/python3.8/site-packages/optuna/study/study.py\", line 419, in optimize\r\n    _optimize(\r\n  File \"/home/jiapli/venv/lib/python3.8/site-packages/optuna/study/_optimize.py\", line 66, in _optimize\r\n    _optimize_sequential(\r\n  File \"/home/jiapli/venv/lib/python3.8/site-packages/optuna/study/_optimize.py\", line 160, in _optimize_sequential\r\n    frozen_trial = _run_trial(study, func, catch)\r\n  File \"/home/jiapli/venv/lib/python3.8/site-packages/optuna/study/_optimize.py\", line 187, in _run_trial\r\n    trial = study.ask()\r\n  File \"/home/jiapli/venv/lib/python3.8/site-packages/optuna/study/study.py\", line 514, in ask\r\n    trial = trial_module.Trial(self, trial_id)\r\n  File \"/home/jiapli/venv/lib/python3.8/site-packages/optuna/trial/_trial.py\", line 54, in __init__\r\n    self._init_relative_params()\r\n  File \"/home/jiapli/venv/lib/python3.8/site-packages/optuna/trial/_trial.py\", line 63, in _init_relative_params\r\n    self.relative_params = self.study.sampler.sample_relative(\r\n  File \"/home/jiapli/venv/lib/python3.8/site-packages/optuna/samplers/nsgaii/_sampler.py\", line 211, in sample_relative\r\n    child_params = perform_crossover(\r\n  File \"/home/jiapli/venv/lib/python3.8/site-packages/optuna/samplers/nsgaii/_crossover.py\", line 115, in perform_crossover\r\n    if _is_contained(image.png, search_space):\r\n  File \"/home/jiapli/venv/lib/python3.8/site-packages/optuna/samplers/nsgaii/_crossover.py\", line 160, in _is_contained\r\n    if not param_distribution._contains(param_distribution.to_internal_repr(param)):\r\n  File \"/home/jiapli/venv/lib/python3.8/site-packages/optuna/distributions.py\", line 516, in to_internal_repr\r\n    raise ValueError(f\"'{param_value_in_external_repr}' not in {self.choices}.\")\r\nValueError: 'True' not in (False, True).\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\n1.\r\n2.\r\n3.\r\n```python\r\n# python code\r\n```\r\n\r\n\r\n### Additional context (optional)\r\n\r\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4192/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4192/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4184", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4184/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4184/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4184/events", "html_url": "https://github.com/optuna/optuna/pull/4184", "id": 1452931468, "node_id": "PR_kwDOB0okGM5DF9TT", "number": 4184, "title": "Fix CmaEs system attribution key", "user": {"login": "gen740", "id": 54583542, "node_id": "MDQ6VXNlcjU0NTgzNTQy", "avatar_url": "https://avatars.githubusercontent.com/u/54583542?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gen740", "html_url": "https://github.com/gen740", "followers_url": "https://api.github.com/users/gen740/followers", "following_url": "https://api.github.com/users/gen740/following{/other_user}", "gists_url": "https://api.github.com/users/gen740/gists{/gist_id}", "starred_url": "https://api.github.com/users/gen740/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gen740/subscriptions", "organizations_url": "https://api.github.com/users/gen740/orgs", "repos_url": "https://api.github.com/users/gen740/repos", "events_url": "https://api.github.com/users/gen740/events{/privacy}", "received_events_url": "https://api.github.com/users/gen740/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, {"login": "eukaryo", "id": 22315555, "node_id": "MDQ6VXNlcjIyMzE1NTU1", "avatar_url": "https://avatars.githubusercontent.com/u/22315555?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eukaryo", "html_url": "https://github.com/eukaryo", "followers_url": "https://api.github.com/users/eukaryo/followers", "following_url": "https://api.github.com/users/eukaryo/following{/other_user}", "gists_url": "https://api.github.com/users/eukaryo/gists{/gist_id}", "starred_url": "https://api.github.com/users/eukaryo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eukaryo/subscriptions", "organizations_url": "https://api.github.com/users/eukaryo/orgs", "repos_url": "https://api.github.com/users/eukaryo/repos", "events_url": "https://api.github.com/users/eukaryo/events{/privacy}", "received_events_url": "https://api.github.com/users/eukaryo/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/47", "html_url": "https://github.com/optuna/optuna/milestone/47", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/47/labels", "id": 8352105, "node_id": "MI_kwDOB0okGM4Af3Fp", "number": 47, "title": "v3.1.0-b0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 149, "state": "closed", "created_at": "2022-08-26T05:11:03Z", "updated_at": "2022-12-22T07:11:04Z", "due_on": null, "closed_at": "2022-12-22T07:11:04Z"}, "comments": 5, "created_at": "2022-11-17T08:35:22Z", "updated_at": "2023-02-21T02:37:33Z", "closed_at": "2022-12-12T03:27:17Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4184", "html_url": "https://github.com/optuna/optuna/pull/4184", "diff_url": "https://github.com/optuna/optuna/pull/4184.diff", "patch_url": "https://github.com/optuna/optuna/pull/4184.patch", "merged_at": "2022-12-12T03:27:17Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull request after it gets two or more approvals. To proceed to the review process by the maintainers, please make sure that the PR meets the following conditions: (1) it passes all CI checks, and (2) it is neither in the draft nor WIP state. If you wish to discuss the PR in the draft state or need any other help, please mention the Optuna development team in the PR. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nRelated to #4016 and #4142.\r\n\r\nAs noted in #4142, CmaEs's trial attribution is not properly working. Keys are different in Setting and Getting. This PR will fix this issue.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n- Add a new private property method `_attr_keys` to `CmaEsSampler`\r\n- Using `NamedTuple` to confirm the `_attr_keys`'s key\r\n- Let `CmaEsSampler`'s `_concat_optimizer_attrs` and `_split_optimizer_str` member function, since it require `use_separable_cma` and `with_margin` information.\r\n- Rewrite cmaes_test. (This is WIP)\r\n\r\nCould anyone explain what [backward compatibility](https://github.com/gen740/optuna/blob/master/optuna/samplers/_cmaes.py#L452-L456) means?\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4184/reactions", "total_count": 2, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 2, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4184/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4172", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4172/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4172/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4172/events", "html_url": "https://github.com/optuna/optuna/issues/4172", "id": 1449406231, "node_id": "I_kwDOB0okGM5WZC8X", "number": 4172, "title": "NSGAII errors with combinations of numerical and non-numerical categorical suggestions", "user": {"login": "tvdboom", "id": 32366550, "node_id": "MDQ6VXNlcjMyMzY2NTUw", "avatar_url": "https://avatars.githubusercontent.com/u/32366550?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tvdboom", "html_url": "https://github.com/tvdboom", "followers_url": "https://api.github.com/users/tvdboom/followers", "following_url": "https://api.github.com/users/tvdboom/following{/other_user}", "gists_url": "https://api.github.com/users/tvdboom/gists{/gist_id}", "starred_url": "https://api.github.com/users/tvdboom/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tvdboom/subscriptions", "organizations_url": "https://api.github.com/users/tvdboom/orgs", "repos_url": "https://api.github.com/users/tvdboom/repos", "events_url": "https://api.github.com/users/tvdboom/events{/privacy}", "received_events_url": "https://api.github.com/users/tvdboom/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-11-15T08:55:16Z", "updated_at": "2022-11-15T09:58:37Z", "closed_at": "2022-11-15T09:58:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nWhen combining str categorical hyperparameters with numerical, the sampler converts the numerical suggestion to string, which makes the study fail. The issue happens here\r\n\r\nhttps://github.com/optuna/optuna/blob/016795d9b81f860a065688818908d187120e29ad/optuna/samplers/nsgaii/_crossover.py#L40-L46\r\n\r\nbecause a  numpy array can't have mixed types and therefore forces the numerical value to a string.\n\n### Environment\n\n- Optuna version:3.0.3\r\n- Python version:3.10.2\r\n- OS:Windows-10-10.0.19044-SP0\r\n- Sklearn version:1.1.3\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\nTraceback (most recent call last):\r\n  File \"C:\\Users\\Mavs\\Documents\\Python\\ATOM\\venv310\\lib\\site-packages\\IPython\\core\\interactiveshell.py\", line 3378, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-2-df714957fb70>\", line 1, in <module>\r\n    runfile('C:\\\\Users\\\\Mavs\\\\Documents\\\\Python\\\\ATOM\\\\test.py', wdir='C:\\\\Users\\\\Mavs\\\\Documents\\\\Python\\\\ATOM')\r\n  File \"C:\\Program Files\\JetBrains\\PyCharm 2022.1.3\\plugins\\python\\helpers\\pydev\\_pydev_bundle\\pydev_umd.py\", line 198, in runfile\r\n    pydev_imports.execfile(filename, global_vars, local_vars)  # execute the script\r\n  File \"C:\\Program Files\\JetBrains\\PyCharm 2022.1.3\\plugins\\python\\helpers\\pydev\\_pydev_imps\\_pydev_execfile.py\", line 18, in execfile\r\n    exec(compile(contents+\"\\n\", file, 'exec'), glob, loc)\r\n  File \"C:\\Users\\Mavs\\Documents\\Python\\ATOM\\test.py\", line 188, in <module>\r\n  File \"C:\\Users\\Mavs\\Documents\\Python\\ATOM\\venv310\\lib\\site-packages\\optuna\\study\\study.py\", line 419, in optimize\r\n    _optimize(\r\n  File \"C:\\Users\\Mavs\\Documents\\Python\\ATOM\\venv310\\lib\\site-packages\\optuna\\study\\_optimize.py\", line 66, in _optimize\r\n    _optimize_sequential(\r\n  File \"C:\\Users\\Mavs\\Documents\\Python\\ATOM\\venv310\\lib\\site-packages\\optuna\\study\\_optimize.py\", line 160, in _optimize_sequential\r\n    frozen_trial = _run_trial(study, func, catch)\r\n  File \"C:\\Users\\Mavs\\Documents\\Python\\ATOM\\venv310\\lib\\site-packages\\optuna\\study\\_optimize.py\", line 187, in _run_trial\r\n    trial = study.ask()\r\n  File \"C:\\Users\\Mavs\\Documents\\Python\\ATOM\\venv310\\lib\\site-packages\\optuna\\study\\study.py\", line 514, in ask\r\n    trial = trial_module.Trial(self, trial_id)\r\n  File \"C:\\Users\\Mavs\\Documents\\Python\\ATOM\\venv310\\lib\\site-packages\\optuna\\trial\\_trial.py\", line 54, in __init__\r\n    self._init_relative_params()\r\n  File \"C:\\Users\\Mavs\\Documents\\Python\\ATOM\\venv310\\lib\\site-packages\\optuna\\trial\\_trial.py\", line 63, in _init_relative_params\r\n    self.relative_params = self.study.sampler.sample_relative(\r\n  File \"C:\\Users\\Mavs\\Documents\\Python\\ATOM\\venv310\\lib\\site-packages\\optuna\\samplers\\nsgaii\\_sampler.py\", line 211, in sample_relative\r\n    child_params = perform_crossover(\r\n  File \"C:\\Users\\Mavs\\Documents\\Python\\ATOM\\venv310\\lib\\site-packages\\optuna\\samplers\\nsgaii\\_crossover.py\", line 115, in perform_crossover\r\n    if _is_contained(child_params, search_space):\r\n  File \"C:\\Users\\Mavs\\Documents\\Python\\ATOM\\venv310\\lib\\site-packages\\optuna\\samplers\\nsgaii\\_crossover.py\", line 160, in _is_contained\r\n    if not param_distribution._contains(param_distribution.to_internal_repr(param)):\r\n  File \"C:\\Users\\Mavs\\Documents\\Python\\ATOM\\venv310\\lib\\site-packages\\optuna\\distributions.py\", line 516, in to_internal_repr\r\n    raise ValueError(f\"'{param_value_in_external_repr}' not in {self.choices}.\")\r\nValueError: '2' not in (None, 2, 3).\n```\n\n\n### Steps to reproduce\n\n```python\r\nimport optuna\r\nfrom sklearn.tree import DecisionTreeClassifier\r\nfrom sklearn.model_selection import train_test_split\r\nfrom sklearn.datasets import load_breast_cancer\r\n\r\nX, y = load_breast_cancer(return_X_y=True)\r\n\r\nX_train, X_test, y_train, y_test = train_test_split(X, y)\r\n\r\ndef objective(trial):\r\n    criterion = trial.suggest_categorical(\"criterion\", [\"gini\", \"entropy\"])\r\n    max_depth = trial.suggest_categorical(\"max_depth\", [None, 2, 3])\r\n\r\n    return DecisionTreeClassifier(criterion=criterion, max_depth=max_depth).fit(X_train, y_train).score(X_test, y_test)\r\n\r\n\r\nstudy = optuna.create_study(sampler=optuna.samplers.NSGAIISampler())\r\nstudy.optimize(objective, n_trials=100)\r\n```\r\n\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4172/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4172/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4151", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4151/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4151/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4151/events", "html_url": "https://github.com/optuna/optuna/pull/4151", "id": 1441206574, "node_id": "PR_kwDOB0okGM5Cejbf", "number": 4151, "title": "Fix the bug of JournalFileStorage on Windows", "user": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/47", "html_url": "https://github.com/optuna/optuna/milestone/47", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/47/labels", "id": 8352105, "node_id": "MI_kwDOB0okGM4Af3Fp", "number": 47, "title": "v3.1.0-b0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 149, "state": "closed", "created_at": "2022-08-26T05:11:03Z", "updated_at": "2022-12-22T07:11:04Z", "due_on": null, "closed_at": "2022-12-22T07:11:04Z"}, "comments": 12, "created_at": "2022-11-09T01:46:55Z", "updated_at": "2022-11-29T06:52:03Z", "closed_at": "2022-11-29T05:39:14Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4151", "html_url": "https://github.com/optuna/optuna/pull/4151", "diff_url": "https://github.com/optuna/optuna/pull/4151.diff", "patch_url": "https://github.com/optuna/optuna/pull/4151.patch", "merged_at": "2022-11-29T05:39:14Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull request after it gets two or more approvals. To proceed to the review process by the maintainers, please make sure that the PR meets the following conditions: (1) it passes all CI checks, and (2) it is neither in the draft nor WIP state. If you wish to discuss the PR in the draft state or need any other help, please mention the Optuna development team in the PR. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nTo close #4148 \r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\nThe bug is probably caused by JournalStorage using \"\\n\" (LF) as a newline character in the following line. But it should be \"\\r\\n\" (CRLF) on Windows platforms. This PR replaces \"\\n\" with `os.linesep`, but I don't have a Windows machine so not yet tested.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4151/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4151/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4148", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4148/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4148/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4148/events", "html_url": "https://github.com/optuna/optuna/issues/4148", "id": 1438919233, "node_id": "I_kwDOB0okGM5VxCpB", "number": 4148, "title": "JournalStorage not working on Windows10", "user": {"login": "sophisticus7", "id": 17837817, "node_id": "MDQ6VXNlcjE3ODM3ODE3", "avatar_url": "https://avatars.githubusercontent.com/u/17837817?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sophisticus7", "html_url": "https://github.com/sophisticus7", "followers_url": "https://api.github.com/users/sophisticus7/followers", "following_url": "https://api.github.com/users/sophisticus7/following{/other_user}", "gists_url": "https://api.github.com/users/sophisticus7/gists{/gist_id}", "starred_url": "https://api.github.com/users/sophisticus7/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sophisticus7/subscriptions", "organizations_url": "https://api.github.com/users/sophisticus7/orgs", "repos_url": "https://api.github.com/users/sophisticus7/repos", "events_url": "https://api.github.com/users/sophisticus7/events{/privacy}", "received_events_url": "https://api.github.com/users/sophisticus7/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-11-07T20:15:42Z", "updated_at": "2022-11-09T21:12:34Z", "closed_at": "2022-11-09T21:12:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nI was using the minimal JournalStorage example from the optuna documentation on my Windows10 PC. \r\nHowever the script is not able to run and throws every time json decoding errors.\r\n\r\nAccording to the latest documentation I didn\u00b4t see any limitations regarding the OS on which JournalStorage can be used. But maybe I was missing something.\r\n\r\n\r\n### Environment\r\n\r\n- Optuna version:3.1.0.dev\r\n- Python version:3.10.6\r\n- OS:Windows-10-10.0.19044-SP0\r\n- (Optional) Other libraries and their versions:\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\nC:\\1_Files\\M\\optuna_trial.py:9: ExperimentalWarning: JournalStorage is experimental (supported from v3.1.0). The interface can change in the future.\r\n  storage = optuna.storages.JournalStorage(\r\nTraceback (most recent call last):\r\n  File \"C:\\1_Files\\M\\optuna_trial.py\", line 12, in <module>\r\n    study = optuna.create_study(storage=storage)\r\n  File \"C:\\Users\\Prometheus\\miniconda3\\envs\\py310\\lib\\site-packages\\optuna\\_convert_positional_args.py\", line 63, in converter_wrapper\r\n    return func(**kwargs)\r\n  File \"C:\\Users\\Prometheus\\miniconda3\\envs\\py310\\lib\\site-packages\\optuna\\study\\study.py\", line 1155, in create_study\r\n    study_id = storage.create_new_study(study_name)\r\n  File \"C:\\Users\\Prometheus\\miniconda3\\envs\\py310\\lib\\site-packages\\optuna\\storages\\_journal\\storage.py\", line 111, in create_new_study\r\n    self._sync_with_backend()\r\n  File \"C:\\Users\\Prometheus\\miniconda3\\envs\\py310\\lib\\site-packages\\optuna\\storages\\_journal\\storage.py\", line 103, in _sync_with_backend\r\n    logs = self._backend.read_logs(self._replay_result.log_number_read)\r\n  File \"C:\\Users\\Prometheus\\miniconda3\\envs\\py310\\lib\\site-packages\\optuna\\storages\\_journal\\file.py\", line 174, in read_logs\r\n    raise last_decode_error\r\n  File \"C:\\Users\\Prometheus\\miniconda3\\envs\\py310\\lib\\site-packages\\optuna\\storages\\_journal\\file.py\", line 184, in read_logs\r\n    logs.append(json.loads(line))\r\n  File \"C:\\Users\\Prometheus\\miniconda3\\envs\\py310\\lib\\json\\__init__.py\", line 346, in loads\r\n    return _default_decoder.decode(s)\r\n  File \"C:\\Users\\Prometheus\\miniconda3\\envs\\py310\\lib\\json\\decoder.py\", line 337, in decode\r\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\r\n  File \"C:\\Users\\Prometheus\\miniconda3\\envs\\py310\\lib\\json\\decoder.py\", line 353, in raw_decode\r\n    obj, end = self.scan_once(s, idx)\r\njson.decoder.JSONDecodeError: Invalid control character at: line 1 column 3 (char 2)\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\n1. Run any JournalStorage example on a Windows10 PC\r\n2. Python finishes with error\r\n3.\r\n```python\r\nimport optuna\r\n\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_float(\"x\", -10, 10)\r\n    return (x - 2) ** 2\r\n\r\n\r\nstorage = optuna.storages.JournalStorage(\r\n    optuna.storages.JournalFileStorage(\"./log_file\"))\r\n\r\nstudy = optuna.create_study(storage=storage)\r\nstudy.optimize(objective)\r\n```\r\n\r\n\r\n### Additional context (optional)\r\n\r\nrunning the script as an admin yields a slightly different error\r\n\r\n```\r\n  File \"C:\\Users\\Prometheus\\miniconda3\\envs\\py310\\lib\\json\\decoder.py\", line 355, in raw_decode\r\n    raise JSONDecodeError(\"Expecting value\", s, err.value) from None\r\njson.decoder.JSONDecodeError: Expecting value: line 2 column 1 (char 1)\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4148/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4148/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4147", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4147/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4147/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4147/events", "html_url": "https://github.com/optuna/optuna/pull/4147", "id": 1438492460, "node_id": "PR_kwDOB0okGM5CVUzJ", "number": 4147, "title": "FIX `PartialFixedSampler` to handle `None` correctly", "user": {"login": "halucinor", "id": 10546369, "node_id": "MDQ6VXNlcjEwNTQ2MzY5", "avatar_url": "https://avatars.githubusercontent.com/u/10546369?v=4", "gravatar_id": "", "url": "https://api.github.com/users/halucinor", "html_url": "https://github.com/halucinor", "followers_url": "https://api.github.com/users/halucinor/followers", "following_url": "https://api.github.com/users/halucinor/following{/other_user}", "gists_url": "https://api.github.com/users/halucinor/gists{/gist_id}", "starred_url": "https://api.github.com/users/halucinor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/halucinor/subscriptions", "organizations_url": "https://api.github.com/users/halucinor/orgs", "repos_url": "https://api.github.com/users/halucinor/repos", "events_url": "https://api.github.com/users/halucinor/events{/privacy}", "received_events_url": "https://api.github.com/users/halucinor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/47", "html_url": "https://github.com/optuna/optuna/milestone/47", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/47/labels", "id": 8352105, "node_id": "MI_kwDOB0okGM4Af3Fp", "number": 47, "title": "v3.1.0-b0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 149, "state": "closed", "created_at": "2022-08-26T05:11:03Z", "updated_at": "2022-12-22T07:11:04Z", "due_on": null, "closed_at": "2022-12-22T07:11:04Z"}, "comments": 1, "created_at": "2022-11-07T14:51:22Z", "updated_at": "2022-11-09T09:54:47Z", "closed_at": "2022-11-09T08:05:48Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4147", "html_url": "https://github.com/optuna/optuna/pull/4147", "diff_url": "https://github.com/optuna/optuna/pull/4147.diff", "patch_url": "https://github.com/optuna/optuna/pull/4147.patch", "merged_at": "2022-11-09T08:05:48Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull request after it gets two or more approvals. To proceed to the review process by the maintainers, please make sure that the PR meets the following conditions: (1) it passes all CI checks, and (2) it is neither in the draft nor WIP state. If you wish to discuss the PR in the draft state or need any other help, please mention the Optuna development team in the PR. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nFix #4136\r\n\r\n`PartialFixedSampler` dose not sample `None` as fixed parameter when it passed as `fixed_params`\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\nWhen dictionary has item that has `None` value, it works same as key doesn't exists.\r\n(Because `dict.get(key)` method return `None` when dictionary key doesn't exists.)\r\nSo I changed it from `if param_value is None:` to `if param_name not in self._fixed_params.keys():`\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4147/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4147/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4137", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4137/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4137/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4137/events", "html_url": "https://github.com/optuna/optuna/pull/4137", "id": 1437299663, "node_id": "PR_kwDOB0okGM5CRdzn", "number": 4137, "title": "Validation for the parameter enqueued in `to_internal_repr` of `FloatDistribution` and `IntDistribution`", "user": {"login": "cross32768", "id": 34023087, "node_id": "MDQ6VXNlcjM0MDIzMDg3", "avatar_url": "https://avatars.githubusercontent.com/u/34023087?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cross32768", "html_url": "https://github.com/cross32768", "followers_url": "https://api.github.com/users/cross32768/followers", "following_url": "https://api.github.com/users/cross32768/following{/other_user}", "gists_url": "https://api.github.com/users/cross32768/gists{/gist_id}", "starred_url": "https://api.github.com/users/cross32768/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cross32768/subscriptions", "organizations_url": "https://api.github.com/users/cross32768/orgs", "repos_url": "https://api.github.com/users/cross32768/repos", "events_url": "https://api.github.com/users/cross32768/events{/privacy}", "received_events_url": "https://api.github.com/users/cross32768/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562070, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDcw", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.testing", "name": "optuna.testing", "color": "1c659e", "default": false, "description": "Related to the `optuna.testing` submodule. This is automatically labeled by github-actions."}, {"id": 4759714097, "node_id": "LA_kwDOB0okGM8AAAABG7N5MQ", "url": "https://api.github.com/repos/optuna/optuna/labels/sprint-20221106", "name": "sprint-20221106", "color": "93a8d8", "default": false, "description": "PR from the online/offline hybrid sprint event Nov 06, 2022"}], "state": "closed", "locked": false, "assignee": {"login": "knshnb", "id": 23695091, "node_id": "MDQ6VXNlcjIzNjk1MDkx", "avatar_url": "https://avatars.githubusercontent.com/u/23695091?v=4", "gravatar_id": "", "url": "https://api.github.com/users/knshnb", "html_url": "https://github.com/knshnb", "followers_url": "https://api.github.com/users/knshnb/followers", "following_url": "https://api.github.com/users/knshnb/following{/other_user}", "gists_url": "https://api.github.com/users/knshnb/gists{/gist_id}", "starred_url": "https://api.github.com/users/knshnb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/knshnb/subscriptions", "organizations_url": "https://api.github.com/users/knshnb/orgs", "repos_url": "https://api.github.com/users/knshnb/repos", "events_url": "https://api.github.com/users/knshnb/events{/privacy}", "received_events_url": "https://api.github.com/users/knshnb/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "knshnb", "id": 23695091, "node_id": "MDQ6VXNlcjIzNjk1MDkx", "avatar_url": "https://avatars.githubusercontent.com/u/23695091?v=4", "gravatar_id": "", "url": "https://api.github.com/users/knshnb", "html_url": "https://github.com/knshnb", "followers_url": "https://api.github.com/users/knshnb/followers", "following_url": "https://api.github.com/users/knshnb/following{/other_user}", "gists_url": "https://api.github.com/users/knshnb/gists{/gist_id}", "starred_url": "https://api.github.com/users/knshnb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/knshnb/subscriptions", "organizations_url": "https://api.github.com/users/knshnb/orgs", "repos_url": "https://api.github.com/users/knshnb/repos", "events_url": "https://api.github.com/users/knshnb/events{/privacy}", "received_events_url": "https://api.github.com/users/knshnb/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/47", "html_url": "https://github.com/optuna/optuna/milestone/47", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/47/labels", "id": 8352105, "node_id": "MI_kwDOB0okGM4Af3Fp", "number": 47, "title": "v3.1.0-b0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 149, "state": "closed", "created_at": "2022-08-26T05:11:03Z", "updated_at": "2022-12-22T07:11:04Z", "due_on": null, "closed_at": "2022-12-22T07:11:04Z"}, "comments": 3, "created_at": "2022-11-06T06:09:42Z", "updated_at": "2022-11-09T09:55:36Z", "closed_at": "2022-11-09T08:28:34Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4137", "html_url": "https://github.com/optuna/optuna/pull/4137", "diff_url": "https://github.com/optuna/optuna/pull/4137.diff", "patch_url": "https://github.com/optuna/optuna/pull/4137.patch", "merged_at": "2022-11-09T08:28:34Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull request after it gets two or more approvals. To proceed to the review process by the maintainers, please make sure that the PR meets the following conditions: (1) it passes all CI checks, and (2) it is neither in the draft nor WIP state. If you wish to discuss the PR in the draft state or need any other help, please mention the Optuna development team in the PR. -->\r\nNote: this PR depends on PR https://github.com/optuna/optuna/pull/4126. Please review and merge it first.\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nResolve https://github.com/optuna/optuna/issues/4070\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\nAdd validation to raise error when value <= 0.0 is enqueued with log=True.\r\nIn addition, I add to error handling when not a number is enqueued.\r\nI also added test cases to validate this change.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4137/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4137/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4136", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4136/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4136/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4136/events", "html_url": "https://github.com/optuna/optuna/issues/4136", "id": 1437297554, "node_id": "I_kwDOB0okGM5Vq2uS", "number": 4136, "title": "`PartialFixedSampler` does not handle `None` correctly", "user": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1846694757, "node_id": "MDU6TGFiZWwxODQ2Njk0NzU3", "url": "https://api.github.com/repos/optuna/optuna/labels/good%20first%20issue", "name": "good first issue", "color": "c2e0c6", "default": true, "description": "Good first issue for contribution."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-11-06T06:00:11Z", "updated_at": "2022-11-09T08:05:49Z", "closed_at": "2022-11-09T08:05:49Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nIn the following codes, \"x\" should be `None`. But sometimes 0 is sampled.\r\n\r\n```python\r\nimport optuna\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_categorical(\"x\", (None, 0))\r\n    return 0\r\n\r\ntpe = optuna.samplers.TPESampler()\r\nsampler = optuna.samplers.PartialFixedSampler({\"x\": None}, tpe)\r\nstudy = optuna.create_study(sampler=sampler)\r\nstudy.optimize(objective, n_trials=10)\r\n```\r\n\r\n```\r\n[I 2022-11-06 14:47:19,010] A new study created in memory with name: no-name-4c144572-cd3b-442a-99d8-962f8401367a\r\n[I 2022-11-06 14:47:19,013] Trial 0 finished with value: 0.0 and parameters: {'x': None}. Best is trial 0 with value: 0.0.\r\n[I 2022-11-06 14:47:19,013] Trial 1 finished with value: 0.0 and parameters: {'x': 0}. Best is trial 0 with value: 0.0.\r\n[I 2022-11-06 14:47:19,014] Trial 2 finished with value: 0.0 and parameters: {'x': None}. Best is trial 0 with value: 0.0.\r\n[I 2022-11-06 14:47:19,014] Trial 3 finished with value: 0.0 and parameters: {'x': 0}. Best is trial 0 with value: 0.0.\r\n[I 2022-11-06 14:47:19,014] Trial 4 finished with value: 0.0 and parameters: {'x': None}. Best is trial 0 with value: 0.0.\r\n[I 2022-11-06 14:47:19,015] Trial 5 finished with value: 0.0 and parameters: {'x': 0}. Best is trial 0 with value: 0.0.\r\n[I 2022-11-06 14:47:19,015] Trial 6 finished with value: 0.0 and parameters: {'x': None}. Best is trial 0 with value: 0.0.\r\n[I 2022-11-06 14:47:19,015] Trial 7 finished with value: 0.0 and parameters: {'x': 0}. Best is trial 0 with value: 0.0.\r\n[I 2022-11-06 14:47:19,016] Trial 8 finished with value: 0.0 and parameters: {'x': 0}. Best is trial 0 with value: 0.0.\r\n[I 2022-11-06 14:47:19,016] Trial 9 finished with value: 0.0 and parameters: {'x': 0}. Best is trial 0 with value: 0.0.\r\n```\r\n\r\n### Environment\r\n\r\n- Optuna version:3.1.0.dev\r\n- Python version:3.8.6\r\n- OS:macOS-10.16-x86_64-i386-64bit\r\n- (Optional) Other libraries and their versions:\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\nSee `Expected behavior`\r\n\r\n\r\n### Steps to reproduce\r\n\r\nSee `Expected behavior`\r\n\r\n### Additional context (optional)\r\n\r\nThis code is buggy when param_value is `None`.\r\n\r\nhttps://github.com/optuna/optuna/blob/c155cea56c9fb0f4752a9838e2518d416719f949/optuna/samplers/_partial_fixed.py#L94-L113", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4136/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4136/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4131", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4131/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4131/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4131/events", "html_url": "https://github.com/optuna/optuna/pull/4131", "id": 1437264172, "node_id": "PR_kwDOB0okGM5CRXQ6", "number": 4131, "title": "Stop using hash function in `_get_bracket_id` in `HyperbandPruner`", "user": {"login": "zaburo-ch", "id": 8179588, "node_id": "MDQ6VXNlcjgxNzk1ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/8179588?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zaburo-ch", "html_url": "https://github.com/zaburo-ch", "followers_url": "https://api.github.com/users/zaburo-ch/followers", "following_url": "https://api.github.com/users/zaburo-ch/following{/other_user}", "gists_url": "https://api.github.com/users/zaburo-ch/gists{/gist_id}", "starred_url": "https://api.github.com/users/zaburo-ch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zaburo-ch/subscriptions", "organizations_url": "https://api.github.com/users/zaburo-ch/orgs", "repos_url": "https://api.github.com/users/zaburo-ch/repos", "events_url": "https://api.github.com/users/zaburo-ch/events{/privacy}", "received_events_url": "https://api.github.com/users/zaburo-ch/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561539, "node_id": "MDU6TGFiZWwxOTQ3NTYxNTM5", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.pruners", "name": "optuna.pruners", "color": "1c659e", "default": false, "description": "Related to the `optuna.pruners` submodule. This is automatically labeled by github-actions."}, {"id": 4759714097, "node_id": "LA_kwDOB0okGM8AAAABG7N5MQ", "url": "https://api.github.com/repos/optuna/optuna/labels/sprint-20221106", "name": "sprint-20221106", "color": "93a8d8", "default": false, "description": "PR from the online/offline hybrid sprint event Nov 06, 2022"}], "state": "closed", "locked": false, "assignee": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/47", "html_url": "https://github.com/optuna/optuna/milestone/47", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/47/labels", "id": 8352105, "node_id": "MI_kwDOB0okGM4Af3Fp", "number": 47, "title": "v3.1.0-b0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 149, "state": "closed", "created_at": "2022-08-26T05:11:03Z", "updated_at": "2022-12-22T07:11:04Z", "due_on": null, "closed_at": "2022-12-22T07:11:04Z"}, "comments": 4, "created_at": "2022-11-06T02:47:49Z", "updated_at": "2022-11-06T09:01:11Z", "closed_at": "2022-11-06T09:01:11Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4131", "html_url": "https://github.com/optuna/optuna/pull/4131", "diff_url": "https://github.com/optuna/optuna/pull/4131.diff", "patch_url": "https://github.com/optuna/optuna/pull/4131.patch", "merged_at": "2022-11-06T09:01:11Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull request after it gets two or more approvals. To proceed to the review process by the maintainers, please make sure that the PR meets the following conditions: (1) it passes all CI checks, and (2) it is neither in the draft nor WIP state. If you wish to discuss the PR in the draft state or need any other help, please mention the Optuna development team in the PR. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\nFix the bug reported in https://github.com/optuna/optuna/issues/3083  that _get_bracket_id of Hyperband returns different results depending on the process.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\nSimply stopped using `hash` as suggested in https://github.com/optuna/optuna/pull/809#discussion_r361076742.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4131/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4131/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4121", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4121/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4121/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4121/events", "html_url": "https://github.com/optuna/optuna/issues/4121", "id": 1435990606, "node_id": "I_kwDOB0okGM5Vl3pO", "number": 4121, "title": "RuntimeError: `Study.stop` is supposed to be invoked inside an objective function or a callback", "user": {"login": "canshiwei", "id": 21691467, "node_id": "MDQ6VXNlcjIxNjkxNDY3", "avatar_url": "https://avatars.githubusercontent.com/u/21691467?v=4", "gravatar_id": "", "url": "https://api.github.com/users/canshiwei", "html_url": "https://github.com/canshiwei", "followers_url": "https://api.github.com/users/canshiwei/followers", "following_url": "https://api.github.com/users/canshiwei/following{/other_user}", "gists_url": "https://api.github.com/users/canshiwei/gists{/gist_id}", "starred_url": "https://api.github.com/users/canshiwei/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/canshiwei/subscriptions", "organizations_url": "https://api.github.com/users/canshiwei/orgs", "repos_url": "https://api.github.com/users/canshiwei/repos", "events_url": "https://api.github.com/users/canshiwei/events{/privacy}", "received_events_url": "https://api.github.com/users/canshiwei/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-11-04T12:17:47Z", "updated_at": "2022-11-08T02:10:38Z", "closed_at": "2022-11-08T02:10:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\noptuna: 3.0.3 python: 3.8\r\n\r\nwhen I try the example below, runtimeError is occured. But if I change the line while i < 9 to while i < 8 or a number less than 9 it works fine. It does not make sense, because there does have 9 permutations.\r\n\r\n### Environment\r\n\r\n- Optuna version: 3.0.3\r\n- Python version: 3.8\r\n- OS: MacOS\r\n\r\n\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\nTraceback (most recent call last):\r\n  File \"xxx\", line 13, in <module>\r\n    study.tell(trail, x + y)\r\n  File \"xxx/venv/lib/python3.8/site-packages/optuna/study/study.py\", line 605, in tell\r\n    return _tell_with_warning(\r\n  File \"xxx/venv/lib/python3.8/site-packages/optuna/study/_tell.py\", line 195, in _tell_with_warning\r\n    study.sampler.after_trial(study, frozen_trial, state, values)\r\n  File \"xxx/venv/lib/python3.8/site-packages/optuna/samplers/_grid.py\", line 211, in after_trial\r\n    study.stop()\r\n  File \"xxx/venv/lib/python3.8/site-packages/optuna/study/study.py\", line 761, in stop\r\n    raise RuntimeError(\r\nRuntimeError: `Study.stop` is supposed to be invoked inside an objective function or a callback.\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\n```python\r\n# python code\r\n\r\nimport optuna\r\n\r\nif __name__ == \"__main__\":\r\n    search_space = {\"x\": [-50, 0, 50], \"y\": [-99, 0, 99]}\r\n    study = optuna.create_study(sampler=optuna.samplers.GridSampler(search_space))\r\n\r\n    i = 0\r\n    while i < 9:\r\n        trail = study.ask()\r\n        x = trail.suggest_int('x', -1000, 1000)\r\n        y = trail.suggest_int('y', -1000, 1000)\r\n        study.tell(trail, x + y)\r\n        \r\n        i += 1\r\n```\r\n\r\n\r\n### Additional context (optional)\r\n\r\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4121/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4121/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4120", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4120/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4120/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4120/events", "html_url": "https://github.com/optuna/optuna/pull/4120", "id": 1435819420, "node_id": "PR_kwDOB0okGM5CMnZf", "number": 4120, "title": "Reject deprecated distributions in `OptunaSearchCV`", "user": {"login": "amylase", "id": 967121, "node_id": "MDQ6VXNlcjk2NzEyMQ==", "avatar_url": "https://avatars.githubusercontent.com/u/967121?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amylase", "html_url": "https://github.com/amylase", "followers_url": "https://api.github.com/users/amylase/followers", "following_url": "https://api.github.com/users/amylase/following{/other_user}", "gists_url": "https://api.github.com/users/amylase/gists{/gist_id}", "starred_url": "https://api.github.com/users/amylase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amylase/subscriptions", "organizations_url": "https://api.github.com/users/amylase/orgs", "repos_url": "https://api.github.com/users/amylase/repos", "events_url": "https://api.github.com/users/amylase/events{/privacy}", "received_events_url": "https://api.github.com/users/amylase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561256, "node_id": "MDU6TGFiZWwxOTQ3NTYxMjU2", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.integration", "name": "optuna.integration", "color": "1c659e", "default": false, "description": "Related to the `optuna.integration` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/47", "html_url": "https://github.com/optuna/optuna/milestone/47", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/47/labels", "id": 8352105, "node_id": "MI_kwDOB0okGM4Af3Fp", "number": 47, "title": "v3.1.0-b0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 149, "state": "closed", "created_at": "2022-08-26T05:11:03Z", "updated_at": "2022-12-22T07:11:04Z", "due_on": null, "closed_at": "2022-12-22T07:11:04Z"}, "comments": 0, "created_at": "2022-11-04T09:56:43Z", "updated_at": "2022-11-07T00:57:05Z", "closed_at": "2022-11-07T00:55:27Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4120", "html_url": "https://github.com/optuna/optuna/pull/4120", "diff_url": "https://github.com/optuna/optuna/pull/4120.diff", "patch_url": "https://github.com/optuna/optuna/pull/4120.patch", "merged_at": "2022-11-07T00:55:27Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull request after it gets two or more approvals. To proceed to the review process by the maintainers, please make sure that the PR meets the following conditions: (1) it passes all CI checks, and (2) it is neither in the draft nor WIP state. If you wish to discuss the PR in the draft state or need any other help, please mention the Optuna development team in the PR. -->\r\n\r\n## Motivation\r\nOptunaSearchCV constructed with deprecated distributions in param_distributions throws an exception when it is cloned. [issue](https://github.com/optuna/optuna/issues/4084)\r\n\r\nThis change is to reject the deprecated distributions in OptunaSearchCV to prevent from this error.\r\n\r\n## Description of the changes\r\n\r\nThe cause of the issue is that sklearn's `clone` method runs sanity check to ensure that the estimator's constructor argument is not edited. OptunaSearchCV's implementation [violates this sanity check](https://github.com/optuna/optuna/issues/4084#issuecomment-1283320431).\r\n\r\nI compared several options that solve this issue\r\n- Reject deprecated distributions (selected)\r\n  - (+) Users will know how to fix their code because they will get better error messages.\r\n  - (-) some of existing code will not work after this change. I guess it is okay because `OptunaSearchCV` is marked as experimental and deprecated distributions are marked as deprecated.\r\n- Only edit values of dict object passed to `param_distributions` argument\r\n  - (+) The reported issue will be fixed and the there is no backward incompatibility.\r\n  - (-) it is weird if the estimator tweaks the parameter given to its constructor.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4120/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4120/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4108", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4108/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4108/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4108/events", "html_url": "https://github.com/optuna/optuna/issues/4108", "id": 1431046281, "node_id": "I_kwDOB0okGM5VTAiJ", "number": 4108, "title": "`None` categorical not visible on Slice plot", "user": {"login": "PhilipMay", "id": 229382, "node_id": "MDQ6VXNlcjIyOTM4Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/229382?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PhilipMay", "html_url": "https://github.com/PhilipMay", "followers_url": "https://api.github.com/users/PhilipMay/followers", "following_url": "https://api.github.com/users/PhilipMay/following{/other_user}", "gists_url": "https://api.github.com/users/PhilipMay/gists{/gist_id}", "starred_url": "https://api.github.com/users/PhilipMay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PhilipMay/subscriptions", "organizations_url": "https://api.github.com/users/PhilipMay/orgs", "repos_url": "https://api.github.com/users/PhilipMay/repos", "events_url": "https://api.github.com/users/PhilipMay/events{/privacy}", "received_events_url": "https://api.github.com/users/PhilipMay/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-11-01T08:12:47Z", "updated_at": "2022-11-06T06:58:41Z", "closed_at": "2022-11-06T06:58:41Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nI have a categorical like this: `trial.suggest_categorical(\"class_weight\", [\"balanced\", None])`\r\n\r\nThe slice plot shows the \"balanced\" value but not the `None` value.\r\nI could write a workaround by using `\"None\"` as a string and then convert it to `None`\r\nbut I thing it could be nice if the real `None` is ploted.\r\n\r\nSee sceenshot:\r\n\r\n<img width=\"234\" alt=\"image\" src=\"https://user-images.githubusercontent.com/229382/199188383-981f256d-0b66-4a1c-be40-68ecd6ae4528.png\">\r\n\r\n\r\n### Environment\r\n\r\n- Optuna version:3.0.3\r\n- Python version:3.9.13\r\n- OS:Linux-5.10.0-17-amd64-x86_64-with-glibc2.31\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\nsee screenshot\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\nsee description above\r\n\r\n### Additional context (optional)\r\n\r\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4108/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4108/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4097", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4097/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4097/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4097/events", "html_url": "https://github.com/optuna/optuna/pull/4097", "id": 1423642976, "node_id": "PR_kwDOB0okGM5Bj75s", "number": 4097, "title": "Add a lock to `MLflowCallback`.", "user": {"login": "gen740", "id": 54583542, "node_id": "MDQ6VXNlcjU0NTgzNTQy", "avatar_url": "https://avatars.githubusercontent.com/u/54583542?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gen740", "html_url": "https://github.com/gen740", "followers_url": "https://api.github.com/users/gen740/followers", "following_url": "https://api.github.com/users/gen740/following{/other_user}", "gists_url": "https://api.github.com/users/gen740/gists{/gist_id}", "starred_url": "https://api.github.com/users/gen740/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gen740/subscriptions", "organizations_url": "https://api.github.com/users/gen740/orgs", "repos_url": "https://api.github.com/users/gen740/repos", "events_url": "https://api.github.com/users/gen740/events{/privacy}", "received_events_url": "https://api.github.com/users/gen740/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561256, "node_id": "MDU6TGFiZWwxOTQ3NTYxMjU2", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.integration", "name": "optuna.integration", "color": "1c659e", "default": false, "description": "Related to the `optuna.integration` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/47", "html_url": "https://github.com/optuna/optuna/milestone/47", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/47/labels", "id": 8352105, "node_id": "MI_kwDOB0okGM4Af3Fp", "number": 47, "title": "v3.1.0-b0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 149, "state": "closed", "created_at": "2022-08-26T05:11:03Z", "updated_at": "2022-12-22T07:11:04Z", "due_on": null, "closed_at": "2022-12-22T07:11:04Z"}, "comments": 10, "created_at": "2022-10-26T08:34:56Z", "updated_at": "2023-02-21T02:37:22Z", "closed_at": "2022-11-16T07:35:28Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4097", "html_url": "https://github.com/optuna/optuna/pull/4097", "diff_url": "https://github.com/optuna/optuna/pull/4097.diff", "patch_url": "https://github.com/optuna/optuna/pull/4097.patch", "merged_at": "2022-11-16T07:35:28Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull request after it gets two or more approvals. To proceed to the review process by the maintainers, please make sure that the PR meets the following conditions: (1) it passes all CI checks, and (2) it is neither in the draft nor WIP state. If you wish to discuss the PR in the draft state or need any other help, please mention the Optuna development team in the PR. -->\r\n\r\n## Motivation\r\nFix #4088.\r\n\r\nOptuna uses mlflow fluent API which is not threadsafe.\r\nThere is a way to use [Tracking API](https://mlflow.org/docs/latest/python_api/mlflow.client.html#module-mlflow.client) as mentioned in [this issue](https://github.com/mlflow/mlflow/issues/3592).\r\nInstead of using Tracking API, I choose `threading.Lock()` to lock entire mlflow functions in order to avoid race-condition for simplicity.\r\n\r\n\r\n## Description of the changes\r\nAdd a lock to `MLflowCallback` not to race-condition.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4097/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4097/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4094", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4094/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4094/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4094/events", "html_url": "https://github.com/optuna/optuna/issues/4094", "id": 1418725974, "node_id": "I_kwDOB0okGM5UkApW", "number": 4094, "title": "Distribution.single() error when using Optuna with ray tune", "user": {"login": "DushyantSahoo", "id": 6754679, "node_id": "MDQ6VXNlcjY3NTQ2Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/6754679?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DushyantSahoo", "html_url": "https://github.com/DushyantSahoo", "followers_url": "https://api.github.com/users/DushyantSahoo/followers", "following_url": "https://api.github.com/users/DushyantSahoo/following{/other_user}", "gists_url": "https://api.github.com/users/DushyantSahoo/gists{/gist_id}", "starred_url": "https://api.github.com/users/DushyantSahoo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DushyantSahoo/subscriptions", "organizations_url": "https://api.github.com/users/DushyantSahoo/orgs", "repos_url": "https://api.github.com/users/DushyantSahoo/repos", "events_url": "https://api.github.com/users/DushyantSahoo/events{/privacy}", "received_events_url": "https://api.github.com/users/DushyantSahoo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-10-21T18:42:39Z", "updated_at": "2022-10-22T14:57:42Z", "closed_at": "2022-10-22T14:16:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nI am running Optuna with ray tune for HPO of random forest, I expected to run without issues and perform HPO.\n\n### Environment\n\n- Optuna version: 3.0.3\r\n- Python version: 3.8.11\r\n- OS: Linux-5.10.112-108.499.amzn2.x86_64-x86_64-with-glibc2.17\r\n- Ray tune version: 2.0.0\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\nTraceback (most recent call last)\r\nFile /opt/omniai/software/Miniconda/envs/mypy/lib/python3.8/site-packages/ray/tune/tuner.py:234, in Tuner.fit(self)\r\n    233 try:\r\n--> 234     return self._local_tuner.fit()\r\n    235 except Exception as e:\r\n\r\nFile /opt/omniai/software/Miniconda/envs/mypy/lib/python3.8/site-packages/ray/tune/impl/tuner_internal.py:283, in TunerInternal.fit(self)\r\n    282     param_space = copy.deepcopy(self._param_space)\r\n--> 283     analysis = self._fit_internal(trainable, param_space)\r\n    284 else:\r\n\r\nFile /opt/omniai/software/Miniconda/envs/mypy/lib/python3.8/site-packages/ray/tune/impl/tuner_internal.py:380, in TunerInternal._fit_internal(self, trainable, param_space)\r\n    367 args = {\r\n    368     **self._get_tune_run_arguments(trainable),\r\n    369     **dict(\r\n   (...)\r\n    378     **self._tuner_kwargs,\r\n    379 }\r\n--> 380 analysis = run(\r\n    381     **args,\r\n    382 )\r\n    383 return analysis\r\n\r\nFile /opt/omniai/software/Miniconda/envs/mypy/lib/python3.8/site-packages/ray/tune/tune.py:722, in run(run_or_experiment, name, metric, mode, stop, time_budget_s, config, resources_per_trial, num_samples, local_dir, search_alg, scheduler, keep_checkpoints_num, checkpoint_score_attr, checkpoint_freq, checkpoint_at_end, verbose, progress_reporter, log_to_file, trial_name_creator, trial_dirname_creator, sync_config, export_formats, max_failures, fail_fast, restore, server_port, resume, reuse_actors, trial_executor, raise_on_failed_trial, callbacks, max_concurrent_trials, _experiment_checkpoint_dir, _remote)\r\n    721 while not runner.is_finished() and not state[\"signal\"]:\r\n--> 722     runner.step()\r\n    723     if has_verbosity(Verbosity.V1_EXPERIMENT):\r\n\r\nFile /opt/omniai/software/Miniconda/envs/mypy/lib/python3.8/site-packages/ray/tune/execution/trial_runner.py:868, in TrialRunner.step(self)\r\n    864     self._callbacks.on_step_begin(\r\n    865         iteration=self._iteration, trials=self._trials\r\n    866     )\r\n--> 868 next_trial = self._update_trial_queue_and_get_next_trial()\r\n    869 if next_trial:\r\n\r\nFile /opt/omniai/software/Miniconda/envs/mypy/lib/python3.8/site-packages/ray/tune/execution/trial_runner.py:804, in TrialRunner._update_trial_queue_and_get_next_trial(self)\r\n    803 while num_pending_trials < self._max_pending_trials:\r\n--> 804     if not self._update_trial_queue(blocking=wait_for_trial):\r\n    805         break\r\n\r\nFile /opt/omniai/software/Miniconda/envs/mypy/lib/python3.8/site-packages/ray/tune/execution/trial_runner.py:1389, in TrialRunner._update_trial_queue(self, blocking, timeout)\r\n   1377 \"\"\"Adds next trials to queue if possible.\r\n   1378 \r\n   1379 Note that the timeout is currently unexposed to the user.\r\n   (...)\r\n   1387     Boolean indicating if a new trial was created or not.\r\n   1388 \"\"\"\r\n-> 1389 trial = self._search_alg.next_trial()\r\n   1390 if blocking and not trial:\r\n\r\nFile /opt/omniai/software/Miniconda/envs/mypy/lib/python3.8/site-packages/ray/tune/search/search_generator.py:100, in SearchGenerator.next_trial(self)\r\n     99 if not self.is_finished():\r\n--> 100     return self.create_trial_if_possible(\r\n    101         self._experiment.spec, self._experiment.dir_name\r\n    102     )\r\n    103 return None\r\n\r\nFile /opt/omniai/software/Miniconda/envs/mypy/lib/python3.8/site-packages/ray/tune/search/search_generator.py:110, in SearchGenerator.create_trial_if_possible(self, experiment_spec, output_path)\r\n    109 trial_id = Trial.generate_id()\r\n--> 110 suggested_config = self.searcher.suggest(trial_id)\r\n    111 if suggested_config == Searcher.FINISHED:\r\n\r\nFile /opt/omniai/software/Miniconda/envs/mypy/lib/python3.8/site-packages/ray/tune/search/optuna/optuna_search.py:497, in OptunaSearch.suggest(self, trial_id)\r\n    496 if trial_id not in self._ot_trials:\r\n--> 497     self._ot_trials[trial_id] = self._ot_study.ask(\r\n    498         fixed_distributions=self._space\r\n    499     )\r\n    500 ot_trial = self._ot_trials[trial_id]\r\n\r\nFile /opt/omniai/software/Miniconda/envs/mypy/lib/python3.8/site-packages/optuna/study/study.py:517, in Study.ask(self, fixed_distributions)\r\n    516 for name, param in fixed_distributions.items():\r\n--> 517     trial._suggest(name, param)\r\n    519 return trial\r\n\r\nFile /opt/omniai/software/Miniconda/envs/mypy/lib/python3.8/site-packages/optuna/trial/_trial.py:589, in Trial._suggest(self, name, distribution)\r\n    588     param_value = storage.get_trial_system_attrs(trial_id)[\"fixed_params\"][name]\r\n--> 589 elif distribution.single():\r\n    590     param_value = distributions._get_single_value(distribution)\r\n\r\nAttributeError: 'tuple' object has no attribute 'single'\n```\n\n\n### Steps to reproduce\n\n```python\r\nimport torch\r\nimport torch.optim as optim\r\nfrom ray.tune.search import ConcurrencyLimiter\r\nfrom ray.tune.search.optuna import OptunaSearch\r\nfrom sklearn.datasets import fetch_openml\r\nfrom sklearn.model_selection import train_test_split\r\nfrom ray import tune\r\nfrom sklearn.ensemble import RandomForestClassifier\r\nfrom sklearn.datasets import make_classification\r\nfrom sklearn.metrics import precision_score\r\n    \r\nX, y = fetch_openml(data_id=42437, return_X_y=True, as_frame=False)\r\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)\r\n\r\ndef objective(config, reporter):\r\n    model = RandomForestClassifier(random_state=0, n_jobs=-1, max_depth=None, n_estimators= int(config['n_estimators']), min_samples_split=int(config['min_samples_split']), min_samples_leaf=int(config['min_samples_leaf']))\r\n    model.fit(X_train, y_train)\r\n    y_pred = model.predict(X_test)\r\n    # Feed the score back to tune\r\n    reporter(precision=precision_score(y_test, y_pred, average='macro'))\r\n\r\nspace = {'n_estimators': (100,200),\r\n        'min_samples_split': (2, 10),\r\n        'min_samples_leaf': (1, 5)}\r\n\r\n   \r\nalgo = OptunaSearch(\r\n    space,\r\n    metric=\"precision\",\r\n    mode=\"max\",\r\n    )\r\n\r\n\r\ntuner = tune.Tuner(\r\n    objective,\r\n    tune_config=tune.TuneConfig(\r\n        metric=\"precision\",\r\n        mode=\"max\",\r\n        search_alg=algo,\r\n        num_samples= 10,\r\n    ),\r\n)\r\nresults = tuner.fit()\r\n```\r\n\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4094/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4094/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4088", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4088/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4088/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4088/events", "html_url": "https://github.com/optuna/optuna/issues/4088", "id": 1414932767, "node_id": "I_kwDOB0okGM5UVikf", "number": 4088, "title": "MLflowCallback error when using n_jobs > 1", "user": {"login": "raulcarlomagno", "id": 2282315, "node_id": "MDQ6VXNlcjIyODIzMTU=", "avatar_url": "https://avatars.githubusercontent.com/u/2282315?v=4", "gravatar_id": "", "url": "https://api.github.com/users/raulcarlomagno", "html_url": "https://github.com/raulcarlomagno", "followers_url": "https://api.github.com/users/raulcarlomagno/followers", "following_url": "https://api.github.com/users/raulcarlomagno/following{/other_user}", "gists_url": "https://api.github.com/users/raulcarlomagno/gists{/gist_id}", "starred_url": "https://api.github.com/users/raulcarlomagno/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/raulcarlomagno/subscriptions", "organizations_url": "https://api.github.com/users/raulcarlomagno/orgs", "repos_url": "https://api.github.com/users/raulcarlomagno/repos", "events_url": "https://api.github.com/users/raulcarlomagno/events{/privacy}", "received_events_url": "https://api.github.com/users/raulcarlomagno/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2022-10-19T13:00:17Z", "updated_at": "2022-11-16T07:35:29Z", "closed_at": "2022-11-16T07:35:29Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nbe able to use more than one job and at the same time log it in mlflow\r\n\r\n### Environment\r\n\r\n- Optuna version: 3.0.3\r\n- Python version: 3.9.7\r\n- OS: Linux-4.14.35-1902.8.4.el7uek.x86_64-x86_64-with-glibc2.31\r\n- MLFlow version:  1.29.0\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\nException: Run with UUID 13a5f691281742d1a9d6b6f98c43203a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\ntrying to use multiprocessing i get \r\n\r\ni know it is an mlflow issue, but there are some fixes to do when interacting with the mlflow api to support multiprocessing\r\nso, some changes to MLflowCallback should be done\r\n\r\npotential fixes\r\nhttps://github.com/mlflow/mlflow/issues/3592\r\nhttps://github.com/mlflow/mlflow/issues/1420\r\n\r\ni tried even using:\r\n`\r\n    mlflow_kwargs={\r\n        'nested': False\r\n    }\r\n`\r\nbut this raises duplication data and errors in mlflow\r\n\r\ni also tried with\r\n`\r\nfrom joblib import parallel_backend\r\nwith parallel_backend('multiprocessing'):`\r\nduring study.optimize()\r\n\r\n### Additional context (optional)\r\n\r\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4088/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4088/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4084", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4084/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4084/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4084/events", "html_url": "https://github.com/optuna/optuna/issues/4084", "id": 1413690080, "node_id": "I_kwDOB0okGM5UQzLg", "number": 4084, "title": "RuntimeError: Cannot clone object OptunaSearchCV, as the constructor either does not set or modifies parameter param_distributions", "user": {"login": "RNarayan73", "id": 82275999, "node_id": "MDQ6VXNlcjgyMjc1OTk5", "avatar_url": "https://avatars.githubusercontent.com/u/82275999?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RNarayan73", "html_url": "https://github.com/RNarayan73", "followers_url": "https://api.github.com/users/RNarayan73/followers", "following_url": "https://api.github.com/users/RNarayan73/following{/other_user}", "gists_url": "https://api.github.com/users/RNarayan73/gists{/gist_id}", "starred_url": "https://api.github.com/users/RNarayan73/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RNarayan73/subscriptions", "organizations_url": "https://api.github.com/users/RNarayan73/orgs", "repos_url": "https://api.github.com/users/RNarayan73/repos", "events_url": "https://api.github.com/users/RNarayan73/events{/privacy}", "received_events_url": "https://api.github.com/users/RNarayan73/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2022-10-18T18:49:17Z", "updated_at": "2022-11-07T11:21:08Z", "closed_at": "2022-11-07T00:55:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nHello,\r\nI recently upgraded from Optuna 2.10.1 to 3.0.3 and am using OptunaSearchCV to optimise a Scikit-Learn pipeline as follows.\r\n![image](https://user-images.githubusercontent.com/82275999/196514857-a3612ef9-2544-4d8e-82c1-4bdb681f67db.png)\r\n\r\nusing an amended version of cross_validate(). However, I get the error above when it tries to clone the estimator.\r\n\r\nHas anyone come across this and is there a resolution?\r\n\r\nThanks in advance,\r\nNarayan\n\n### Environment\n\n- Optuna version: 3.0.3\r\n- Python version: 3.8.13\r\n- OS: Windows 11 Home\r\n- Scikit-Learn: 1.1.2\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\nOptunaSearchCV is experimental (supported from v0.17.0). The interface can change in the future.\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\nInput In [77], in <cell line: 2>()\r\n      1 start = time()\r\n----> 2 sv_results_opt = cross_val_thresh(opt_pipe, X, y, cv_val[VAL], result_metrics, #scoring=score_metrics, \r\n      3                                   return_estimator=True, return_train_score=True, \r\n      4                                   thresh_split=SPLIT, \r\n      5                                  )\r\n      6 end = time()\r\n\r\nInput In [46], in cross_val_thresh(estimator, X, y, cv, result_metrics, return_estimator, return_train_score, thresh_split, *args, **kwargs)\r\n     12 estimator_list = []\r\n     14 for i, (train_idx, test_idx) in enumerate(cv.split(X, y)):\r\n---> 16     est_i = clone(estimator)\r\n     18     test_idx_test = test_idx[0::2] if thresh_split else test_idx\r\n     19     #test_idx_thresh = test_idx[1::2]\r\n     20     \r\n     21     #X_train, X_test = X[train_idx, :], X[test_idx, :]    # more versatile than .loc, works with df and np\r\n\r\nFile C:\\Anaconda3\\envs\\skl_py38\\lib\\site-packages\\sklearn\\base.py:96, in clone(estimator, safe)\r\n     94     param2 = params_set[name]\r\n     95     if param1 is not param2:\r\n---> 96         raise RuntimeError(\r\n     97             \"Cannot clone object %s, as the constructor \"\r\n     98             \"either does not set or modifies parameter %s\" % (estimator, name)\r\n     99         )\r\n    100 return new_object\r\n\r\nRuntimeError: Cannot clone object OptunaSearchCV(cv=StratifiedKFold(n_splits=5, random_state=0, shuffle=True),\r\n               estimator=Pipeline(memory=Memory(location=C:\\Users\\naray/_jupyter/_cachedir/joblib),\r\n                                  steps=[('enc',\r\n                                          ColumnTransformer(n_jobs=1,\r\n                                                            sparse_threshold=0,\r\n                                                            transformers=[('numeric',\r\n                                                                           'passthrough',\r\n                                                                           ['RSI',\r\n                                                                            'h1RSI',\r\n                                                                            'h2RSI']),\r\n                                                                          ('target',\r\n                                                                           OneHotEncoder(categories=[array(['AUDJPY.pro', 'AUDUSD.pro'...\r\n       'StrongC'], dtype=object)]), MeanEncoder(ignore_format=True), TargetEncoder(), MEstimateEncoder(), WoEEncoder(ignore_format=True), BayesianTargetEncoder(columns=['Symbol', 'CandleType', 'h1CandleType1',\r\n                               'h2CandleType1'],\r\n                      prior_weight=3, suffix=''))),\r\n                                    'enc__time__cyclicity': CategoricalDistribution(choices=(CyclicalFeatures(drop_original=True), CycleTransformer(), RepeatingBasisFunction(n_periods=96)))},\r\n               random_state=0,\r\n               scoring=make_scorer(average_precision_score, needs_proba=True, pos_label=1)), as the constructor either does not set or modifies parameter param_distributions\n```\n\n\n### Steps to reproduce\n\n1. Create an estimator with OptunaSearchCV incorporating an arbitrary classifier\r\n2. Clone the estimator\r\n```\r\nfrom sklearn.linear_model import SGDClassifier\r\nfrom optuna.integration import OptunaSearchCV\r\nfrom optuna.distributions import LogUniformDistribution\r\n\r\nhpt_pipe = OptunaSearchCV(SGDClassifier(warm_start=True, max_iter=1000, loss='log', random_state=SEED, n_jobs=1), \r\n                          param_distributions={'clf__alpha': LogUniformDistribution(high=1.0, low=0.0001)}, \r\n                          cv=5)\r\n\r\nclone(hpt_pipe)\r\n```\n\n### Additional context (optional)\n\n1. The error doesn't occur in v2.10.1 and I get the expected results\r\n2. When running the pipeline and the same param_distributions through alternative hyperparameter tuning algorithms like BayesSearchCV or RandomizedSearchCV or TuneSearchCV etc., there are no issues and I get a set of best_params_ and other expected outputs.\r\n3. Note that my approach involves packaging all transformers and classifier within the pipeline and running hyperparameter tuning upon all elements of the pipeline rather than on the classifier only. This allows me to select from many different transformers for the same purpose e.g. target encoding, dimension reduction etc., instead of limiting myself to just one.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4084/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4084/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4080", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4080/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4080/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4080/events", "html_url": "https://github.com/optuna/optuna/issues/4080", "id": 1410439138, "node_id": "I_kwDOB0okGM5UEZfi", "number": 4080, "title": "IndexError : error from using suggest_categorical", "user": {"login": "yknoww", "id": 115923781, "node_id": "U_kgDOBujbRQ", "avatar_url": "https://avatars.githubusercontent.com/u/115923781?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yknoww", "html_url": "https://github.com/yknoww", "followers_url": "https://api.github.com/users/yknoww/followers", "following_url": "https://api.github.com/users/yknoww/following{/other_user}", "gists_url": "https://api.github.com/users/yknoww/gists{/gist_id}", "starred_url": "https://api.github.com/users/yknoww/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yknoww/subscriptions", "organizations_url": "https://api.github.com/users/yknoww/orgs", "repos_url": "https://api.github.com/users/yknoww/repos", "events_url": "https://api.github.com/users/yknoww/events{/privacy}", "received_events_url": "https://api.github.com/users/yknoww/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-10-16T10:05:58Z", "updated_at": "2022-10-17T04:01:30Z", "closed_at": "2022-10-17T04:01:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\ngetting a suggested parameter for categorical variables\n\n### Environment\n\n- Optuna version:3.0.2\r\n- Python version:3.7.4\r\n- OS:Windows-10-10.0.19041-SP0\r\n- (Optional) Other libraries and their versions:\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\nIndexError                                Traceback (most recent call last)\r\n<ipython-input-15-e7813b6edbff> in <module>\r\n      2 \r\n      3 new_params = {}\r\n----> 4 new_params[\"x\"] = trial.suggest_categorical(name=\"x\", choices=['a', 'b'])\r\n      5 \r\n      6 print('x:', new_params[\"x\"])\r\n\r\n~\\Anaconda3\\lib\\site-packages\\optuna\\trial\\_trial.py in suggest_categorical(self, name, choices)\r\n    503         # CategoricalDistribution does not support dynamic value space.\r\n    504 \r\n--> 505         return self._suggest(name, CategoricalDistribution(choices=choices))\r\n    506 \r\n    507     def report(self, value: float, step: int) -> None:\r\n\r\n~\\Anaconda3\\lib\\site-packages\\optuna\\trial\\_trial.py in _suggest(self, name, distribution)\r\n    718                 study = pruners._filter_study(self.study, trial)\r\n    719                 param_value = self.study.sampler.sample_independent(\r\n--> 720                     study, trial, name, distribution\r\n    721                 )\r\n    722 \r\n\r\n~\\Anaconda3\\lib\\site-packages\\optuna\\samplers\\_tpe\\sampler.py in sample_independent(self, study, trial, param_name, param_distribution)\r\n    435         else:\r\n    436             mpe_below = _ParzenEstimator(\r\n--> 437                 below, {param_name: param_distribution}, self._parzen_estimator_parameters\r\n    438             )\r\n    439         mpe_above = _ParzenEstimator(\r\n\r\n~\\Anaconda3\\lib\\site-packages\\optuna\\samplers\\_tpe\\parzen_estimator.py in __init__(self, observations, search_space, parameters, predetermined_weights)\r\n     85                 mus = sigmas = None\r\n     86                 categorical_weights = self._calculate_categorical_params(\r\n---> 87                     param_observations, param_name\r\n     88                 )\r\n     89             else:\r\n\r\n~\\Anaconda3\\lib\\site-packages\\optuna\\samplers\\_tpe\\parzen_estimator.py in _calculate_categorical_params(self, observations, param_name)\r\n    364             value = prior_weight / n_observations\r\n    365         weights = np.full(shape, fill_value=value)\r\n--> 366         weights[np.arange(n_observations), observations] += 1\r\n    367         weights /= weights.sum(axis=1, keepdims=True)\r\n    368         return weights\r\n\r\nIndexError: index 3 is out of bounds for axis 1 with size 2\n```\n\n\n### Steps to reproduce\n\n```python\r\n# python code\r\ncat_list = ['a', 'b', 'c', 'd', 'b', 'd', 'c', 'a', 'b', 'c']\r\ny_list = [2, 4, 3, 7, 5, 1, 2, 5, 9, 4]\r\n\r\nstudy = optuna.create_study(direction='minimize')\r\nfor i in range(10):\r\n    trial = optuna.trial.create_trial(\r\n        params = {\"x\": cat_list[i]},\r\n        distributions = {\"x\": CategoricalDistribution(['a', 'b', 'c', 'd'])},\r\n        value = y_list[i])\r\n    study.add_trial(trial)\r\n\r\ntrial = study.ask()\r\nnew_param = trial.suggest_categorical(name=\"x\", choices=['a', 'b'])\r\nprint('x:', new_param)\r\n```\r\n\n\n### Additional context (optional)\n\nError doesn't occur when length of study.trials is less than 10 (not including 10).", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4080/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4080/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4076", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4076/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4076/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4076/events", "html_url": "https://github.com/optuna/optuna/pull/4076", "id": 1407432218, "node_id": "PR_kwDOB0okGM5At2kx", "number": 4076, "title": "Add a flush to `JournalFileStorage.append_logs`", "user": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, {"login": "wattlebirdaz", "id": 36123078, "node_id": "MDQ6VXNlcjM2MTIzMDc4", "avatar_url": "https://avatars.githubusercontent.com/u/36123078?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wattlebirdaz", "html_url": "https://github.com/wattlebirdaz", "followers_url": "https://api.github.com/users/wattlebirdaz/followers", "following_url": "https://api.github.com/users/wattlebirdaz/following{/other_user}", "gists_url": "https://api.github.com/users/wattlebirdaz/gists{/gist_id}", "starred_url": "https://api.github.com/users/wattlebirdaz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wattlebirdaz/subscriptions", "organizations_url": "https://api.github.com/users/wattlebirdaz/orgs", "repos_url": "https://api.github.com/users/wattlebirdaz/repos", "events_url": "https://api.github.com/users/wattlebirdaz/events{/privacy}", "received_events_url": "https://api.github.com/users/wattlebirdaz/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/47", "html_url": "https://github.com/optuna/optuna/milestone/47", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/47/labels", "id": 8352105, "node_id": "MI_kwDOB0okGM4Af3Fp", "number": 47, "title": "v3.1.0-b0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 149, "state": "closed", "created_at": "2022-08-26T05:11:03Z", "updated_at": "2022-12-22T07:11:04Z", "due_on": null, "closed_at": "2022-12-22T07:11:04Z"}, "comments": 1, "created_at": "2022-10-13T09:11:05Z", "updated_at": "2022-10-17T05:08:12Z", "closed_at": "2022-10-17T05:08:12Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4076", "html_url": "https://github.com/optuna/optuna/pull/4076", "diff_url": "https://github.com/optuna/optuna/pull/4076.diff", "patch_url": "https://github.com/optuna/optuna/pull/4076.patch", "merged_at": "2022-10-17T05:08:12Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull request after it gets two or more approvals. To proceed to the review process by the maintainers, please make sure that the PR meets the following conditions: (1) it passes all CI checks, and (2) it is neither in the draft nor WIP state. If you wish to discuss the PR in the draft state or need any other help, please mention the Optuna development team in the PR. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nAccording to the [reference](https://docs.python.org/3.10/library/os.html#os.fsync), if we want to write all internal buffers associated with `f` to disk, we should do `f.flush()` and then do `os.fsync(f.fileno())`. I suggest to add `f.flush()` before `os.fsync(f.fileno())`.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\nAdd `f.flush()` before `os.fsync(f.fileno())`.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4076/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4076/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4073", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4073/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4073/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4073/events", "html_url": "https://github.com/optuna/optuna/pull/4073", "id": 1407241951, "node_id": "PR_kwDOB0okGM5AtOys", "number": 4073, "title": "Fix bugs in `constant_liar` option", "user": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/47", "html_url": "https://github.com/optuna/optuna/milestone/47", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/47/labels", "id": 8352105, "node_id": "MI_kwDOB0okGM4Af3Fp", "number": 47, "title": "v3.1.0-b0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 149, "state": "closed", "created_at": "2022-08-26T05:11:03Z", "updated_at": "2022-12-22T07:11:04Z", "due_on": null, "closed_at": "2022-12-22T07:11:04Z"}, "comments": 3, "created_at": "2022-10-13T06:46:05Z", "updated_at": "2022-10-25T03:02:24Z", "closed_at": "2022-10-25T03:02:17Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4073", "html_url": "https://github.com/optuna/optuna/pull/4073", "diff_url": "https://github.com/optuna/optuna/pull/4073.diff", "patch_url": "https://github.com/optuna/optuna/pull/4073.patch", "merged_at": "2022-10-25T03:02:17Z"}, "body": "## Motivation\r\nCurrently, `constant_liar` option first fills `inf` in the values of running trials and splits them into \"below\" and \"above\". An example of 5-concurrent case (with `n_startup_trials = 3`) is given below:\r\n\r\n|Event|`constant_liar=False`|`constant_liar=True`|\r\n|------|------|------|\r\n|ask 0|RandomSampler|RandomSampler|\r\n|ask 1|RandomSampler|RandomSampler|\r\n|ask 2|RandomSampler|`B, A = split({0\u20261}, \u03b3(3))`|\r\n|ask 3|RandomSampler|`B, A = split({0\u20262}, \u03b3(4))`|\r\n|ask 4|RandomSampler|`B, A = split({0\u20263}, \u03b3(5))`|\r\n|tell 0, ask 5|RandomSampler|`B, A = split({0\u20264}, \u03b3(6))`|\r\n|tell 1, ask 6|RandomSampler|`B, A = split({0\u20265}, \u03b3(7))`|\r\n|tell 2, ask 7|`B, A = split({0\u20262}, \u03b3(3))`|`B, A = split({0\u20266}, \u03b3(8))`|\r\n|tell 3, ask 8|`B, A = split({0\u20263}, \u03b3(4))`|`B, A = split({0\u20267}, \u03b3(9))`|\r\n|tell 4, ask 9|`B, A = split({0\u20264}, \u03b3(5))`|`B, A = split({0\u20268}, \u03b3(10))`|\r\n\r\nHere, `B` stands for \"below\" and `A` stands for \"above\".\r\n\r\nThis behavior has the following problems:\r\n* In \"ask 2...4\" step, no trials have generated results yet. However, if `\u03b3(3)`...`\u03b3(5)` is nonzero, some running trials are randomly chosen to be \"below\", and subsequent trials will be wrongly attracted toward that trial.\r\n* In \"ask 5...6\" step, there are only 1 or 2 finished trials, but we choose `\u03b3(6)` or `\u03b3(7)` \"below\" trials. Since all running trials have value `inf`, the early trials are unconditionally chosen to be \"below\", no matter how good or bad their actual values are. Again, subsequent trials will be wrongly attracted toward early trials.\r\n\r\nIn practice, this causes performance deterioration when the number of concurrency is large, such as 50. One example of benchmark is given below, where `HPOBench` is used. (In the below image, \"cl\" stands for `constant_liar=True`.)\r\n\r\n![constant_liar1](https://user-images.githubusercontent.com/24619922/195519525-dd1684d6-235b-44d2-94a3-1c5a40ea75dc.png)\r\n\r\nAs can be seen from the image, `constant_liar=True` performs worse than `constant_liar=False` until the budget reaches around 150.\r\n\r\n## Description of the changes\r\nWe change the behavior to be following:\r\n\r\n|Event|`constant_liar=False`|`constant_liar=True`|\r\n|------|------|------|\r\n|ask 0|RandomSampler|RandomSampler|\r\n|ask 1|RandomSampler|RandomSampler|\r\n|ask 2|RandomSampler|RandomSampler|\r\n|ask 3|RandomSampler|RandomSampler|\r\n|ask 4|RandomSampler|RandomSampler|\r\n|tell 0, ask 5|RandomSampler|RandomSampler|\r\n|tell 1, ask 6|RandomSampler|RandomSampler|\r\n|tell 2, ask 7|`B, A = split({0\u20262}, \u03b3(3))`|`B, A = split({0\u20266}, \u03b3(3))`|\r\n|tell 3, ask 8|`B, A = split({0\u20263}, \u03b3(4))`|`B, A = split({0\u20267}, \u03b3(4))`|\r\n|tell 4, ask 9|`B, A = split({0\u20264}, \u03b3(5))`|`B, A = split({0\u20268}, \u03b3(5))`|\r\n\r\nNote that `B, A = split({0\u20266}, \u03b3(3))` is equivalent to \r\n```\r\nB, A' = split({0\u20262}, \u03b3(3))\r\nA = A' + {3...6}\r\n```\r\nwhere we first split all finished trials, and then append all running trials to \"above\".\r\n\r\nThis improves the performance of HPOBench:\r\n![constant_liar2](https://user-images.githubusercontent.com/24619922/195521193-4a6971c7-d09d-4741-8762-59648e4149f6.png)\r\n\r\nOne side effect of this change is that running trials will be ranked after pruned trials. (Note that currently running trials are ranked before pruned trials.) \r\nAnother side effect is that it will now be trivial to support `constant_liar` in multi-objective settings.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4073/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4073/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4070", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4070/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4070/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4070/events", "html_url": "https://github.com/optuna/optuna/issues/4070", "id": 1406400230, "node_id": "I_kwDOB0okGM5T0_bm", "number": 4070, "title": "ValueError: math domain error", "user": {"login": "jmrichardson", "id": 6565528, "node_id": "MDQ6VXNlcjY1NjU1Mjg=", "avatar_url": "https://avatars.githubusercontent.com/u/6565528?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jmrichardson", "html_url": "https://github.com/jmrichardson", "followers_url": "https://api.github.com/users/jmrichardson/followers", "following_url": "https://api.github.com/users/jmrichardson/following{/other_user}", "gists_url": "https://api.github.com/users/jmrichardson/gists{/gist_id}", "starred_url": "https://api.github.com/users/jmrichardson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jmrichardson/subscriptions", "organizations_url": "https://api.github.com/users/jmrichardson/orgs", "repos_url": "https://api.github.com/users/jmrichardson/repos", "events_url": "https://api.github.com/users/jmrichardson/events{/privacy}", "received_events_url": "https://api.github.com/users/jmrichardson/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2022-10-12T15:21:55Z", "updated_at": "2022-11-09T08:28:35Z", "closed_at": "2022-11-09T08:28:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nGetting a math domain error on what appears to be valid parameter suggestions (ie no 0 or negative log)\r\n\n\n### Environment\n\n- Python version:3.8.13\r\n- Optuna version:3.0.2\r\n- OS:Linux-3.10.0-1127.el7.x86_64-x86_64-with-glibc2.17\n\n### Error messages, stack traces, or logs\n\n```shell\nError Message:\r\n\r\nTraceback (most recent call last):\r\n  File \"eras.py\", line 47, in <module>\r\n    pipeline = pipeline.fit(X_train, y_train, x_test=X_test, y_test=y_test)\r\n  File \"/home/jmrichardson/fml/fml/pipelines/standard.py\", line 236, in fit\r\n    model.optimize(features, test=test_features)\r\n  File \"/home/jmrichardson/fml/fml/models/lgbm.py\", line 92, in optimize\r\n    study.optimize(partial(objective, train, test), n_trials=self.n_trials, timeout=self.timeout, show_progress_bar=True)\r\n  File \"/home/jmrichardson/anaconda3/envs/fml/lib/python3.8/site-packages/optuna/study/study.py\", line 419, in optimize\r\n    _optimize(\r\n  File \"/home/jmrichardson/anaconda3/envs/fml/lib/python3.8/site-packages/optuna/study/_optimize.py\", line 66, in _optimize\r\n    _optimize_sequential(\r\n  File \"/home/jmrichardson/anaconda3/envs/fml/lib/python3.8/site-packages/optuna/study/_optimize.py\", line 160, in _optimize_sequential\r\n    frozen_trial = _run_trial(study, func, catch)\r\n  File \"/home/jmrichardson/anaconda3/envs/fml/lib/python3.8/site-packages/optuna/study/_optimize.py\", line 187, in _run_trial\r\n    trial = study.ask()\r\n  File \"/home/jmrichardson/anaconda3/envs/fml/lib/python3.8/site-packages/optuna/study/study.py\", line 514, in ask\r\n    trial = trial_module.Trial(self, trial_id)\r\n  File \"/home/jmrichardson/anaconda3/envs/fml/lib/python3.8/site-packages/optuna/trial/_trial.py\", line 54, in __init__\r\n    self._init_relative_params()\r\n  File \"/home/jmrichardson/anaconda3/envs/fml/lib/python3.8/site-packages/optuna/trial/_trial.py\", line 63, in _init_relative_params\r\n    self.relative_params = self.study.sampler.sample_relative(\r\n  File \"/home/jmrichardson/anaconda3/envs/fml/lib/python3.8/site-packages/optuna/samplers/nsgaii/_sampler.py\", line 211, in sample_relative\r\n    child_params = perform_crossover(\r\n  File \"/home/jmrichardson/anaconda3/envs/fml/lib/python3.8/site-packages/optuna/samplers/nsgaii/_crossover.py\", line 104, in perform_crossover\r\n    child_params = _try_crossover(\r\n  File \"/home/jmrichardson/anaconda3/envs/fml/lib/python3.8/site-packages/optuna/samplers/nsgaii/_crossover.py\", line 60, in _try_crossover\r\n    [\r\n  File \"/home/jmrichardson/anaconda3/envs/fml/lib/python3.8/site-packages/optuna/samplers/nsgaii/_crossover.py\", line 61, in <listcomp>\r\n    numerical_transform.transform(\r\n  File \"/home/jmrichardson/anaconda3/envs/fml/lib/python3.8/site-packages/optuna/_transform.py\", line 117, in transform\r\n    trans_params[bound_idx] = _transform_numerical_param(\r\n  File \"/home/jmrichardson/anaconda3/envs/fml/lib/python3.8/site-packages/optuna/_transform.py\", line 239, in _transform_numerical_param\r\n    trans_param = math.log(param) if transform_log else float(param)\r\nValueError: math domain error\n```\n\n\n### Steps to reproduce\n\nParameter suggest in objective function:\r\n\r\n```\r\nparams = {'n_estimators': trial.suggest_int(\"n_estimators\", 2000, 6000),\r\n              'num_leaves': trial.suggest_int(\"num_leaves\", 12, 256),\r\n              'min_child_weight': trial.suggest_float('min_child_weight', 1e-5, 1024.0, log=True),\r\n              'learning_rate': trial.suggest_float(\"learning_rate\", .0001, 0.02, step=.001),\r\n              'colsample_bytree': trial.suggest_float(\"colsample_bytree\", 0.01, 1.0),\r\n              'subsample': trial.suggest_float(\"subsample\", 0.01, 1.0),\r\n              'reg_alpha': trial.suggest_float(\"reg_alpha\", 1e-5, 1024, log=True),\r\n              'reg_lambda': trial.suggest_float(\"reg_lambda\", 1e-5, 1024, log=True),\r\n              'max_depth': trial.suggest_int(\"max_depth\", 3, 32),\r\n              \"seed\": 123,\r\n              \"objective\": \"regression\",\r\n              \"verbose\": -1,\r\n              \"force_row_wise\": True,\r\n              \"metric\": \"None\"}\r\n```\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4070/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4070/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4066", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4066/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4066/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4066/events", "html_url": "https://github.com/optuna/optuna/issues/4066", "id": 1404327771, "node_id": "I_kwDOB0okGM5TtFdb", "number": 4066, "title": "The plot and report of Bayesmark scripts are inconsistent", "user": {"login": "knshnb", "id": 23695091, "node_id": "MDQ6VXNlcjIzNjk1MDkx", "avatar_url": "https://avatars.githubusercontent.com/u/23695091?v=4", "gravatar_id": "", "url": "https://api.github.com/users/knshnb", "html_url": "https://github.com/knshnb", "followers_url": "https://api.github.com/users/knshnb/followers", "following_url": "https://api.github.com/users/knshnb/following{/other_user}", "gists_url": "https://api.github.com/users/knshnb/gists{/gist_id}", "starred_url": "https://api.github.com/users/knshnb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/knshnb/subscriptions", "organizations_url": "https://api.github.com/users/knshnb/orgs", "repos_url": "https://api.github.com/users/knshnb/repos", "events_url": "https://api.github.com/users/knshnb/events{/privacy}", "received_events_url": "https://api.github.com/users/knshnb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-10-11T09:36:40Z", "updated_at": "2022-10-17T08:25:13Z", "closed_at": "2022-10-17T08:25:13Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nConsistent results in the plots and `report.md`.\r\n\r\n### Environment\r\n\r\nGitHub Actions: https://github.com/optuna/optuna/blob/1a520bd5daa9ff0af09fb060464bb157f8af891b/.github/workflows/performance-benchmarks-bayesmark.yml\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\nhttps://github.com/optuna/optuna/actions/runs/3143078497\r\n\r\n(See Additional context)\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\nRun `Actions -> Performance benchmarks with bayesmark` with the default arguments.\r\n\r\n### Additional context (optional)\r\n\r\nThe values in the plots and `report.md` seem to be inconsistent.\r\nExample:\r\n![image](https://user-images.githubusercontent.com/23695091/195053993-9fa16f86-25d8-4252-ad53-bc2f7ddff925.png)\r\n![image](https://user-images.githubusercontent.com/23695091/195054314-8daf8e63-94bf-4615-a6f9-6221b5b59dbe.png)", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4066/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4066/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4056", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4056/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4056/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4056/events", "html_url": "https://github.com/optuna/optuna/pull/4056", "id": 1400932584, "node_id": "PR_kwDOB0okGM5AYb8U", "number": 4056, "title": "Make `TPESampler` reproducible", "user": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/47", "html_url": "https://github.com/optuna/optuna/milestone/47", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/47/labels", "id": 8352105, "node_id": "MI_kwDOB0okGM4Af3Fp", "number": 47, "title": "v3.1.0-b0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 149, "state": "closed", "created_at": "2022-08-26T05:11:03Z", "updated_at": "2022-12-22T07:11:04Z", "due_on": null, "closed_at": "2022-12-22T07:11:04Z"}, "comments": 5, "created_at": "2022-10-07T10:04:36Z", "updated_at": "2022-10-31T00:18:52Z", "closed_at": "2022-10-31T00:18:38Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4056", "html_url": "https://github.com/optuna/optuna/pull/4056", "diff_url": "https://github.com/optuna/optuna/pull/4056.diff", "patch_url": "https://github.com/optuna/optuna/pull/4056.patch", "merged_at": "2022-10-31T00:18:38Z"}, "body": "## Motivation\r\nIt seems that currently `TPESampler` is not strictly reproducible because the results of `np.argsort` have randomness by default when there are multiple equal objective values. To make it reproducible, we need to specify `kind=\"stable\"`. \r\n\r\n## Description of the changes\r\nSpecify `kind=\"stable\"` to `np.argsort` in `split_observation_pairs`.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4056/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4056/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4052", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4052/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4052/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4052/events", "html_url": "https://github.com/optuna/optuna/pull/4052", "id": 1400552178, "node_id": "PR_kwDOB0okGM5AXLkq", "number": 4052, "title": "[Backport] Skip to add `intermediate_value_type` and `value_type` columns if exists", "user": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/50", "html_url": "https://github.com/optuna/optuna/milestone/50", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/50/labels", "id": 8507060, "node_id": "MI_kwDOB0okGM4Agc60", "number": 50, "title": "v3.0.3", "description": "", "creator": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 4, "state": "closed", "created_at": "2022-10-05T05:46:06Z", "updated_at": "2022-10-11T07:16:55Z", "due_on": null, "closed_at": "2022-10-11T07:16:55Z"}, "comments": 0, "created_at": "2022-10-07T02:55:54Z", "updated_at": "2022-10-11T04:08:43Z", "closed_at": "2022-10-11T04:08:43Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4052", "html_url": "https://github.com/optuna/optuna/pull/4052", "diff_url": "https://github.com/optuna/optuna/pull/4052.diff", "patch_url": "https://github.com/optuna/optuna/pull/4052.patch", "merged_at": "2022-10-11T04:08:43Z"}, "body": "Skip to add `intermediate_value_type` and `value_type` columns if exists\r\n\r\n<!-- Thank you for creating a pull request! In general, we merge your pull request after it gets two or more approvals. To proceed to the review process by the maintainers, please make sure that the PR meets the following conditions: (1) it passes all CI checks, and (2) it is neither in the draft nor WIP state. If you wish to discuss the PR in the draft state or need any other help, please mention the Optuna development team in the PR. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nBackport https://github.com/optuna/optuna/pull/4015 for v3.0.3 release.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4052/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4052/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4035", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4035/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4035/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4035/events", "html_url": "https://github.com/optuna/optuna/pull/4035", "id": 1391973792, "node_id": "PR_kwDOB0okGM4_6f0S", "number": 4035, "title": "Specify object type to numpy array init to avoid unintended str cast ", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/47", "html_url": "https://github.com/optuna/optuna/milestone/47", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/47/labels", "id": 8352105, "node_id": "MI_kwDOB0okGM4Af3Fp", "number": 47, "title": "v3.1.0-b0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 149, "state": "closed", "created_at": "2022-08-26T05:11:03Z", "updated_at": "2022-12-22T07:11:04Z", "due_on": null, "closed_at": "2022-12-22T07:11:04Z"}, "comments": 2, "created_at": "2022-09-30T07:27:03Z", "updated_at": "2022-11-20T00:35:52Z", "closed_at": "2022-10-07T08:31:51Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4035", "html_url": "https://github.com/optuna/optuna/pull/4035", "diff_url": "https://github.com/optuna/optuna/pull/4035.diff", "patch_url": "https://github.com/optuna/optuna/pull/4035.patch", "merged_at": "2022-10-07T08:31:51Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull request after it gets two or more approvals. To proceed to the review process by the maintainers, please make sure that the PR meets the following conditions: (1) it passes all CI checks, and (2) it is neither in the draft nor WIP state. If you wish to discuss the PR in the draft state or need any other help, please mention the Optuna development team in the PR. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\nFix the bug reported in #3982, specifically, the code shared in https://github.com/optuna/optuna/issues/3982#issuecomment-1263163810.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\nAs mentioned by https://github.com/optuna/optuna/issues/3982#issuecomment-1263194047, current code casts the categorical values to `str` even elements in `choice` are not str type when values contain a str element. Such a minimal case is as follows:\r\n\r\n```python\r\nimport numpy as np\r\n\r\nprint(np.array([\"hoge\", True]))\r\n# array(['hoge', 'True'], dtype='<U5')\r\n\r\nprint(np.array([\"hoge\", 1]))\r\n# array(['hoge', '1'], dtype='<U21')\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4035/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4035/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4033", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4033/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4033/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4033/events", "html_url": "https://github.com/optuna/optuna/pull/4033", "id": 1391727852, "node_id": "PR_kwDOB0okGM4_5rOY", "number": 4033, "title": "Fix a concurrency bug of JournalStorage `set_trial_state_values`.", "user": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "wattlebirdaz", "id": 36123078, "node_id": "MDQ6VXNlcjM2MTIzMDc4", "avatar_url": "https://avatars.githubusercontent.com/u/36123078?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wattlebirdaz", "html_url": "https://github.com/wattlebirdaz", "followers_url": "https://api.github.com/users/wattlebirdaz/followers", "following_url": "https://api.github.com/users/wattlebirdaz/following{/other_user}", "gists_url": "https://api.github.com/users/wattlebirdaz/gists{/gist_id}", "starred_url": "https://api.github.com/users/wattlebirdaz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wattlebirdaz/subscriptions", "organizations_url": "https://api.github.com/users/wattlebirdaz/orgs", "repos_url": "https://api.github.com/users/wattlebirdaz/repos", "events_url": "https://api.github.com/users/wattlebirdaz/events{/privacy}", "received_events_url": "https://api.github.com/users/wattlebirdaz/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "wattlebirdaz", "id": 36123078, "node_id": "MDQ6VXNlcjM2MTIzMDc4", "avatar_url": "https://avatars.githubusercontent.com/u/36123078?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wattlebirdaz", "html_url": "https://github.com/wattlebirdaz", "followers_url": "https://api.github.com/users/wattlebirdaz/followers", "following_url": "https://api.github.com/users/wattlebirdaz/following{/other_user}", "gists_url": "https://api.github.com/users/wattlebirdaz/gists{/gist_id}", "starred_url": "https://api.github.com/users/wattlebirdaz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wattlebirdaz/subscriptions", "organizations_url": "https://api.github.com/users/wattlebirdaz/orgs", "repos_url": "https://api.github.com/users/wattlebirdaz/repos", "events_url": "https://api.github.com/users/wattlebirdaz/events{/privacy}", "received_events_url": "https://api.github.com/users/wattlebirdaz/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/47", "html_url": "https://github.com/optuna/optuna/milestone/47", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/47/labels", "id": 8352105, "node_id": "MI_kwDOB0okGM4Af3Fp", "number": 47, "title": "v3.1.0-b0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 149, "state": "closed", "created_at": "2022-08-26T05:11:03Z", "updated_at": "2022-12-22T07:11:04Z", "due_on": null, "closed_at": "2022-12-22T07:11:04Z"}, "comments": 11, "created_at": "2022-09-30T02:28:54Z", "updated_at": "2022-10-24T00:11:06Z", "closed_at": "2022-10-24T00:02:13Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4033", "html_url": "https://github.com/optuna/optuna/pull/4033", "diff_url": "https://github.com/optuna/optuna/pull/4033.diff", "patch_url": "https://github.com/optuna/optuna/pull/4033.patch", "merged_at": "2022-10-24T00:02:13Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull request after it gets two or more approvals. To proceed to the review process by the maintainers, please make sure that the PR meets the following conditions: (1) it passes all CI checks, and (2) it is neither in the draft nor WIP state. If you wish to discuss the PR in the draft state or need any other help, please mention the Optuna development team in the PR. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nRefs https://github.com/optuna/optuna/issues/4002#issuecomment-1260466576\r\n\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\nMake `set_trial_state_values` thread safe.\r\n\r\n```python\r\nimport optuna\r\n\r\n\r\noptuna.logging.set_verbosity(optuna.logging.DEBUG)\r\n\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_float(\"x\", -100, 100)\r\n    return x ** 2\r\n\r\n\r\nif __name__ == '__main__':\r\n    try_these_parameters_first = [{\"x\": -15}, {\"x\": 0.2}, {\"x\": 30}, {\"x\": 20}]\r\n    file_storage = optuna.storages.JournalFileStorage(\"optuna-journal.log\")\r\n    storage = optuna.storages.JournalStorage(file_storage)\r\n    study = optuna.create_study(storage=storage)\r\n    study.enqueue_trial(try_these_parameters_first[0])\r\n    study.enqueue_trial(try_these_parameters_first[1])\r\n    study.enqueue_trial(try_these_parameters_first[2])\r\n    study.enqueue_trial(try_these_parameters_first[3])\r\n    study.optimize(objective, n_trials=20, n_jobs=5)\r\n```\r\n\r\n```\r\n$ python example.py\r\n/Users/c-bata/go/src/github.com/optuna/optuna/example.py:15: ExperimentalWarning: JournalStorage is experimental (supported from v3.1.0). The interface can change in the future.\r\n  storage = optuna.storages.JournalStorage(file_storage)\r\n[I 2022-09-30 11:27:49,663] A new study created in Journal with name: no-name-d61fe716-0401-4662-998d-0399d194c424\r\n[D 2022-09-30 11:27:49,669] Trial 0 popped from the trial queue.\r\n[D 2022-09-30 11:27:49,669] Trial 1 popped from the trial queue.\r\n[D 2022-09-30 11:27:49,671] Trial 2 popped from the trial queue.\r\n[D 2022-09-30 11:27:49,672] Trial 3 popped from the trial queue.\r\n[I 2022-09-30 11:27:49,678] Trial 2 finished with value: 900.0 and parameters: {'x': 30}. Best is trial 0 with value: 225.0.\r\n[I 2022-09-30 11:27:49,680] Trial 0 finished with value: 225.0 and parameters: {'x': -15}. Best is trial 1 with value: 0.04000000000000001.\r\n[I 2022-09-30 11:27:49,682] Trial 1 finished with value: 0.04000000000000001 and parameters: {'x': 0.2}. Best is trial 1 with value: 0.04000000000000001.\r\n[I 2022-09-30 11:27:49,684] Trial 3 finished with value: 400.0 and parameters: {'x': 20}. Best is trial 1 with value: 0.04000000000000001.\r\n[I 2022-09-30 11:27:49,792] Trial 4 finished with value: 6600.0333114589475 and parameters: {'x': 81.24058906395834}. Best is trial 1 with value: 0.04000000000000001.\r\n[I 2022-09-30 11:27:49,798] Trial 5 finished with value: 5529.278900689064 and parameters: {'x': -74.35912116673424}. Best is trial 1 with value: 0.04000000000000001.\r\n[I 2022-09-30 11:27:49,799] Trial 7 finished with value: 893.070613535204 and parameters: {'x': 29.884287067541095}. Best is trial 1 with value: 0.04000000000000001.\r\n[I 2022-09-30 11:27:49,802] Trial 6 finished with value: 6957.099989732264 and parameters: {'x': -83.40923204137695}. Best is trial 1 with value: 0.04000000000000001.\r\n[I 2022-09-30 11:27:49,803] Trial 9 finished with value: 6718.015050720809 and parameters: {'x': 81.96349828259412}. Best is trial 1 with value: 0.04000000000000001.\r\n[I 2022-09-30 11:27:49,811] Trial 8 finished with value: 970.8555796564026 and parameters: {'x': 31.15855548090127}. Best is trial 1 with value: 0.04000000000000001.\r\n[I 2022-09-30 11:27:49,812] Trial 11 finished with value: 1681.4636828254615 and parameters: {'x': 41.00565427871456}. Best is trial 1 with value: 0.04000000000000001.\r\n[I 2022-09-30 11:27:49,813] Trial 12 finished with value: 6.700583914136698 and parameters: {'x': 2.5885486115073633}. Best is trial 1 with value: 0.04000000000000001.\r\n[I 2022-09-30 11:27:49,813] Trial 13 finished with value: 774.7264078163153 and parameters: {'x': 27.833907519719816}. Best is trial 1 with value: 0.04000000000000001.\r\n[I 2022-09-30 11:27:49,819] Trial 10 finished with value: 263.83437431410476 and parameters: {'x': -16.24297923147428}. Best is trial 1 with value: 0.04000000000000001.\r\n[I 2022-09-30 11:27:50,384] Trial 15 finished with value: 784.3986584673387 and parameters: {'x': -28.007117996454735}. Best is trial 1 with value: 0.04000000000000001.\r\n[I 2022-09-30 11:27:50,387] Trial 14 finished with value: 833.8785841982007 and parameters: {'x': -28.876955937186327}. Best is trial 1 with value: 0.04000000000000001.\r\n[I 2022-09-30 11:27:50,387] Trial 17 finished with value: 1937.9235357536486 and parameters: {'x': -44.02185293412408}. Best is trial 1 with value: 0.04000000000000001.\r\n[I 2022-09-30 11:27:50,388] Trial 18 finished with value: 2151.3886284339164 and parameters: {'x': -46.38306402593425}. Best is trial 1 with value: 0.04000000000000001.\r\n[I 2022-09-30 11:27:50,388] Trial 16 finished with value: 2332.4531020099207 and parameters: {'x': -48.2954770347071}. Best is trial 1 with value: 0.04000000000000001.\r\n[I 2022-09-30 11:27:50,393] Trial 19 finished with value: 52.91460788648185 and parameters: {'x': 7.274242770658803}. Best is trial 1 with value: 0.04000000000000001.\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4033/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4033/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4025", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4025/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4025/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4025/events", "html_url": "https://github.com/optuna/optuna/pull/4025", "id": 1390129574, "node_id": "PR_kwDOB0okGM4_0aYS", "number": 4025, "title": "Avoid parse errors of `datetime.isoformat` strings", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, {"login": "wattlebirdaz", "id": 36123078, "node_id": "MDQ6VXNlcjM2MTIzMDc4", "avatar_url": "https://avatars.githubusercontent.com/u/36123078?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wattlebirdaz", "html_url": "https://github.com/wattlebirdaz", "followers_url": "https://api.github.com/users/wattlebirdaz/followers", "following_url": "https://api.github.com/users/wattlebirdaz/following{/other_user}", "gists_url": "https://api.github.com/users/wattlebirdaz/gists{/gist_id}", "starred_url": "https://api.github.com/users/wattlebirdaz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wattlebirdaz/subscriptions", "organizations_url": "https://api.github.com/users/wattlebirdaz/orgs", "repos_url": "https://api.github.com/users/wattlebirdaz/repos", "events_url": "https://api.github.com/users/wattlebirdaz/events{/privacy}", "received_events_url": "https://api.github.com/users/wattlebirdaz/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/47", "html_url": "https://github.com/optuna/optuna/milestone/47", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/47/labels", "id": 8352105, "node_id": "MI_kwDOB0okGM4Af3Fp", "number": 47, "title": "v3.1.0-b0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 149, "state": "closed", "created_at": "2022-08-26T05:11:03Z", "updated_at": "2022-12-22T07:11:04Z", "due_on": null, "closed_at": "2022-12-22T07:11:04Z"}, "comments": 3, "created_at": "2022-09-29T01:37:33Z", "updated_at": "2022-09-29T03:40:03Z", "closed_at": "2022-09-29T03:40:02Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4025", "html_url": "https://github.com/optuna/optuna/pull/4025", "diff_url": "https://github.com/optuna/optuna/pull/4025.diff", "patch_url": "https://github.com/optuna/optuna/pull/4025.patch", "merged_at": "2022-09-29T03:40:02Z"}, "body": "## Motivation\r\n@nzw0301 found that [CI failed](https://github.com/optuna/optuna/actions/runs/3135276095/jobs/5090771082) due to the error of `JournalStorage`. They said the dumped strings of `datetime_start` (or `datetime_complete`) could lack microseconds but `datetime_from_isoformat` function always expects them.\r\n\r\n```python\r\nimport datetime\r\ndatetime.datetime(2022, 9, 29, 2, 27, 32, 0).isoformat()\r\n# '2022-09-29T02:27:32'\r\n```\r\n\r\nhttps://github.com/optuna/optuna/blob/31da4d00e8f96ae2a8f7fc211ab77449b16e415b/optuna/storages/_journal/storage.py#L48-L50\r\n\r\n@hvy suggested workarounds in https://bugs.python.org/issue40076, and this PR employs the `timespec` argument of `datetime.isoformat` to always show microseconds.\r\n\r\n## Description of the changes\r\n\r\n- Specify `timespec=\"microseconds\"` to `datetime.isoformat()`\r\n- Add test case to handle template trials with `datetime_start`/`datetime_complete` whose `microseconds` values are zero.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4025/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4025/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4023", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4023/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4023/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4023/events", "html_url": "https://github.com/optuna/optuna/pull/4023", "id": 1388620224, "node_id": "PR_kwDOB0okGM4_vXew", "number": 4023, "title": "Fix duplicated sampling of `SkoptSampler`", "user": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561256, "node_id": "MDU6TGFiZWwxOTQ3NTYxMjU2", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.integration", "name": "optuna.integration", "color": "1c659e", "default": false, "description": "Related to the `optuna.integration` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/47", "html_url": "https://github.com/optuna/optuna/milestone/47", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/47/labels", "id": 8352105, "node_id": "MI_kwDOB0okGM4Af3Fp", "number": 47, "title": "v3.1.0-b0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 149, "state": "closed", "created_at": "2022-08-26T05:11:03Z", "updated_at": "2022-12-22T07:11:04Z", "due_on": null, "closed_at": "2022-12-22T07:11:04Z"}, "comments": 2, "created_at": "2022-09-28T02:19:08Z", "updated_at": "2022-10-20T03:40:15Z", "closed_at": "2022-10-04T05:13:02Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4023", "html_url": "https://github.com/optuna/optuna/pull/4023", "diff_url": "https://github.com/optuna/optuna/pull/4023.diff", "patch_url": "https://github.com/optuna/optuna/pull/4023.patch", "merged_at": "2022-10-04T05:13:01Z"}, "body": "## Motivation\r\nFix #4022.\r\n`SkoptSampler` samples duplicated parameters because `_Optimizer` is created using the same random seed.\r\n\r\n## Description of the changes\r\nUpdate `random_state` after creating `_Optimizer`.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4023/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4023/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4022", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4022/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4022/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4022/events", "html_url": "https://github.com/optuna/optuna/issues/4022", "id": 1387945443, "node_id": "I_kwDOB0okGM5Sul3j", "number": 4022, "title": "If seed is fixed, SkoptSampler suggests exactly the same parameter sets during startup trials", "user": {"login": "rene-rex", "id": 7721866, "node_id": "MDQ6VXNlcjc3MjE4NjY=", "avatar_url": "https://avatars.githubusercontent.com/u/7721866?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rene-rex", "html_url": "https://github.com/rene-rex", "followers_url": "https://api.github.com/users/rene-rex/followers", "following_url": "https://api.github.com/users/rene-rex/following{/other_user}", "gists_url": "https://api.github.com/users/rene-rex/gists{/gist_id}", "starred_url": "https://api.github.com/users/rene-rex/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rene-rex/subscriptions", "organizations_url": "https://api.github.com/users/rene-rex/orgs", "repos_url": "https://api.github.com/users/rene-rex/repos", "events_url": "https://api.github.com/users/rene-rex/events{/privacy}", "received_events_url": "https://api.github.com/users/rene-rex/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2022-09-27T15:19:39Z", "updated_at": "2022-10-04T05:13:03Z", "closed_at": "2022-10-04T05:13:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nThe suggested parameters should be reproducible but not all trials should use exactly the same values.\r\n\r\n### Environment\r\n\r\n- Optuna version:3.0.2\r\n- Python version:3.8.5\r\n- OS:Windows-10-10.0.19041-SP0\r\n- skopt version: 0.9.0\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\nparams_x\r\n0    0.976270\r\n1    1.856892\r\n2    1.856892\r\n3    1.856892\r\n4    1.856892\r\n5    1.856892\r\n6    1.856892\r\n7    1.856892\r\n8    1.856892\r\n9    1.856892\r\n10   2.326864\r\n11  -9.084558\r\n12  10.000000\r\n13   2.173857\r\n14   2.111044\r\n15   2.090603\r\n16   2.069437\r\n17   2.061775\r\n18   2.032221\r\n19   2.018462\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\nRun the minimal example. Trials 1 (not 0) to 9 have identical x.\r\n\r\n```python\r\nimport optuna\r\n\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_float(\"x\", -10, 10)\r\n    return (x - 2) ** 2\r\n\r\nsampler = optuna.integration.SkoptSampler(seed=0)\r\nstudy = optuna.create_study(sampler=sampler)\r\n\r\nstudy.optimize(objective,  n_trials=20)\r\n\r\nprint(study.trials_dataframe()[['params_x']])\r\n```\r\n\r\n![image](https://user-images.githubusercontent.com/7721866/192567723-5362ec5e-26d7-47cc-a236-93971c54ae23.png)\r\n\r\n\r\n### Additional context (optional)\r\n\r\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4022/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4022/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4015", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4015/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4015/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4015/events", "html_url": "https://github.com/optuna/optuna/pull/4015", "id": 1385332985, "node_id": "PR_kwDOB0okGM4_kcX4", "number": 4015, "title": "Skip to add `intermediate_value_type` and `value_type` columns if exists", "user": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/47", "html_url": "https://github.com/optuna/optuna/milestone/47", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/47/labels", "id": 8352105, "node_id": "MI_kwDOB0okGM4Af3Fp", "number": 47, "title": "v3.1.0-b0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 149, "state": "closed", "created_at": "2022-08-26T05:11:03Z", "updated_at": "2022-12-22T07:11:04Z", "due_on": null, "closed_at": "2022-12-22T07:11:04Z"}, "comments": 10, "created_at": "2022-09-26T02:54:58Z", "updated_at": "2022-10-04T07:39:09Z", "closed_at": "2022-10-04T04:38:22Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4015", "html_url": "https://github.com/optuna/optuna/pull/4015", "diff_url": "https://github.com/optuna/optuna/pull/4015.diff", "patch_url": "https://github.com/optuna/optuna/pull/4015.patch", "merged_at": "2022-10-04T04:38:22Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull request after it gets two or more approvals. To proceed to the review process by the maintainers, please make sure that the PR meets the following conditions: (1) it passes all CI checks, and (2) it is neither in the draft nor WIP state. If you wish to discuss the PR in the draft state or need any other help, please mention the Optuna development team in the PR. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nThe data migration written in `v3.0.0.c.py` is sometimes failed if there are a lot of `trial_intermediate_values` records since  it takes long time. At that time, users cannot resume the database migration.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\nSkip to add `intermediate_value_type` and `value_type` columns if exists to make the migration idempotent.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4015/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4015/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4004", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4004/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4004/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4004/events", "html_url": "https://github.com/optuna/optuna/pull/4004", "id": 1373976476, "node_id": "PR_kwDOB0okGM4-_zTT", "number": 4004, "title": "[Backport] Merge pull request #3967 from c-bata/fix-issue-3966", "user": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/49", "html_url": "https://github.com/optuna/optuna/milestone/49", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/49/labels", "id": 8411817, "node_id": "MI_kwDOB0okGM4AgFqp", "number": 49, "title": "v3.0.2", "description": "", "creator": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 3, "state": "closed", "created_at": "2022-09-12T07:37:58Z", "updated_at": "2022-09-15T06:57:26Z", "due_on": null, "closed_at": "2022-09-15T06:57:26Z"}, "comments": 1, "created_at": "2022-09-15T06:06:55Z", "updated_at": "2022-09-15T06:51:42Z", "closed_at": "2022-09-15T06:51:35Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/4004", "html_url": "https://github.com/optuna/optuna/pull/4004", "diff_url": "https://github.com/optuna/optuna/pull/4004.diff", "patch_url": "https://github.com/optuna/optuna/pull/4004.patch", "merged_at": "2022-09-15T06:51:35Z"}, "body": "Fix an import error of `sqlalchemy.orm.declarative_base`\r\n\r\n<!-- Thank you for creating a pull request! In general, we merge your pull request after it gets two or more approvals. To proceed to the review process by the maintainers, please make sure that the PR meets the following conditions: (1) it passes all CI checks, and (2) it is neither in the draft nor WIP state. If you wish to discuss the PR in the draft state or need any other help, please mention the Optuna development team in the PR. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nBackporting #3967 changes for v3.0.2 release.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\nExecute `$ git cherry-pick -m 1 9176db9fee5401515e41f50f1476791994f22f77`", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4004/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4004/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/4002", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/4002/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/4002/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/4002/events", "html_url": "https://github.com/optuna/optuna/issues/4002", "id": 1373608351, "node_id": "I_kwDOB0okGM5R35mf", "number": 4002, "title": "enqueue, storage & parallelization ", "user": {"login": "cuismabc", "id": 113012194, "node_id": "U_kgDOBrxt4g", "avatar_url": "https://avatars.githubusercontent.com/u/113012194?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cuismabc", "html_url": "https://github.com/cuismabc", "followers_url": "https://api.github.com/users/cuismabc/followers", "following_url": "https://api.github.com/users/cuismabc/following{/other_user}", "gists_url": "https://api.github.com/users/cuismabc/gists{/gist_id}", "starred_url": "https://api.github.com/users/cuismabc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cuismabc/subscriptions", "organizations_url": "https://api.github.com/users/cuismabc/orgs", "repos_url": "https://api.github.com/users/cuismabc/repos", "events_url": "https://api.github.com/users/cuismabc/events{/privacy}", "received_events_url": "https://api.github.com/users/cuismabc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2022-09-14T21:30:36Z", "updated_at": "2022-10-07T00:08:22Z", "closed_at": "2022-10-07T00:08:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nrun the attached code, you will see the problem. this issue does not always happen, but often.\r\n\r\n\r\n\r\n### Environment\r\n\r\n- Optuna version: 3.9\r\n- Python version:3.0\r\n- OS: windows X64\r\n- (Optional) Other libraries and their versions:\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\n[I 2022-09-14 14:22:16,229] A new study created in RDB with name: C:/Users/cuism/Desktop/ex_DOEs/study\r\nA new study created in RDB with name: C:/Users/cuism/Desktop/ex_DOEs/study\r\ntrial index istrial index is  00\r\n\r\n[I 2022-09-14 14:22:17,167] Trial 0 finished with value: 450.0 and parameters: {'x': -15, 'y': -15}. Best is trial 0 with value: 450.0.\r\nTrial 0 finished with value: 450.0 and parameters: {'x': -15, 'y': -15}. Best is trial 0 with value: 450.0.\r\n[I 2022-09-14 14:22:17,182] Trial 0 finished with value: 450.0 and parameters: {'x': -15, 'y': -15}. Best is trial 0 with value: 450.0.\r\nTrial 0 finished with value: 450.0 and parameters: {'x': -15, 'y': -15}. Best is trial 0 with value: 450.0.\r\ntrial index is 1\r\n[I 2022-09-14 14:22:17,604] Trial 1 finished with value: 0.04000000000000001 and parameters: {'x': 0.2, 'y': 0}. Best is trial 1 with value: 0.04000000000000001.\r\nTrial 1 finished with value: 0.04000000000000001 and parameters: {'x': 0.2, 'y': 0}. Best is trial 1 with value: 0.04000000000000001.\r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\cuism\\Desktop\\ex_DOEs\\HF2_code_DOE_enqueue.py\", line 42, in <module>\r\n    study.optimize(objective, n_trials=10, n_jobs=2)\r\n  File \"C:\\Python\\Python39\\lib\\site-packages\\optuna\\study\\study.py\", line 419, in optimize\r\n    _optimize(\r\n  File \"C:\\Python\\Python39\\lib\\site-packages\\optuna\\study\\_optimize.py\", line 103, in _optimize\r\n    f.result()\r\n  File \"C:\\Python\\Python39\\lib\\concurrent\\futures\\_base.py\", line 438, in result\r\n    return self.__get_result()\r\n  File \"C:\\Python\\Python39\\lib\\concurrent\\futures\\_base.py\", line 390, in __get_result\r\n    raise self._exception\r\n  File \"C:\\Python\\Python39\\lib\\concurrent\\futures\\thread.py\", line 52, in run\r\n    result = self.fn(*self.args, **self.kwargs)\r\n  File \"C:\\Python\\Python39\\lib\\site-packages\\optuna\\study\\_optimize.py\", line 160, in _optimize_sequential\r\n    frozen_trial = _run_trial(study, func, catch)\r\n  File \"C:\\Python\\Python39\\lib\\site-packages\\optuna\\study\\_optimize.py\", line 208, in _run_trial\r\n    frozen_trial = _tell_with_warning(\r\n  File \"C:\\Python\\Python39\\lib\\site-packages\\optuna\\study\\_tell.py\", line 197, in _tell_with_warning\r\n    study._storage.set_trial_state_values(trial_id, state, values)\r\n  File \"C:\\Python\\Python39\\lib\\site-packages\\optuna\\storages\\_cached_storage.py\", line 261, in set_trial_state_values\r\n    self._check_trial_is_updatable(cached_trial)\r\n  File \"C:\\Python\\Python39\\lib\\site-packages\\optuna\\storages\\_cached_storage.py\", line 386, in _check_trial_is_updatable\r\n    raise RuntimeError(\r\nRuntimeError: Trial#0 has already finished and can not be updated.\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\n1. run the attached codes several times, the issue will come\r\n2.\r\n3.\r\n```python\r\nimport optuna\r\nimport time\r\nimport random\r\nimport logging\r\nimport sys\r\nimport os\r\n\r\ndef objective(trial):\r\n    print(\"trial index is\", trial.number)\r\n   \r\n    x = trial.suggest_float(\"x\", -100, 100)\r\n    y = trial.suggest_float(\"y\", -15, 30)\r\n    obj=x ** 2 + y ** 2\r\n    #time.sleep(random.uniform(1,5))\r\n    return obj\r\n    \r\n\r\nfile_path = \"C:/Users/cuism/Desktop/ex_DOEs/study.db\"\r\nif os.path.isfile(file_path):\r\n  os.remove(file_path)\r\n  print(\"File has been deleted\")\r\nelse:\r\n  print(\"File does not exist\")\r\n  \r\noptuna.logging.get_logger(\"optuna\").addHandler(logging.StreamHandler(sys.stdout))\r\nstudy_name = \"C:/Users/cuism/Desktop/ex_DOEs/study\"  # Unique identifier of the study.\r\nstorage_name = \"sqlite:///{}.db\".format(study_name)  \r\n\r\n\r\ntry_these_parameters_first=[{\"x\": -15, \"y\":-15},{\"x\": 0.2, \"y\":0},{\"x\": 30, \"y\":30},{\"x\": 20, \"y\":20}]\r\n\r\nsampler = optuna.integration.BoTorchSampler( n_startup_trials=5)\r\nstudy = optuna.create_study(sampler=sampler,study_name=study_name, storage=storage_name)\r\n\r\nstudy.enqueue_trial(try_these_parameters_first[0])\r\nstudy.enqueue_trial(try_these_parameters_first[1])\r\nstudy.enqueue_trial(try_these_parameters_first[2])\r\nstudy.enqueue_trial(try_these_parameters_first[3])\r\n\r\n\r\nstudy.optimize(objective, n_trials=10, n_jobs=2)\r\n```\r\n\r\n\r\n### Additional context (optional)\r\n\r\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/4002/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/4002/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3995", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3995/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3995/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3995/events", "html_url": "https://github.com/optuna/optuna/issues/3995", "id": 1370662750, "node_id": "I_kwDOB0okGM5Rsqde", "number": 3995, "title": "External DOE + Optimization:  Optuna does not work", "user": {"login": "cuismabc", "id": 113012194, "node_id": "U_kgDOBrxt4g", "avatar_url": "https://avatars.githubusercontent.com/u/113012194?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cuismabc", "html_url": "https://github.com/cuismabc", "followers_url": "https://api.github.com/users/cuismabc/followers", "following_url": "https://api.github.com/users/cuismabc/following{/other_user}", "gists_url": "https://api.github.com/users/cuismabc/gists{/gist_id}", "starred_url": "https://api.github.com/users/cuismabc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cuismabc/subscriptions", "organizations_url": "https://api.github.com/users/cuismabc/orgs", "repos_url": "https://api.github.com/users/cuismabc/repos", "events_url": "https://api.github.com/users/cuismabc/events{/privacy}", "received_events_url": "https://api.github.com/users/cuismabc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-09-12T23:51:25Z", "updated_at": "2022-09-13T01:54:45Z", "closed_at": "2022-09-13T01:54:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nI tried to import existing experimental results into Optuna's storage by following the suggestions at the following links. I attached two ways..\r\nhttps://gist.github.com/toshihikoyanase/99f4119f226da4ad227cd6f381136c72\r\nboth ways do not work.\r\n\r\n1) when I use enqueue, storage and parallelization together, the external samples are not used correctly.\r\n2) when I use alternative way,  \r\n    2.1) I run one optimization directly, good results are obtained.\r\n    2.2) I exported the initial samples out\r\n    2.3) I imported the initial samples into Optuna by using the recommended way,  the optimization results always are not good.\r\n\r\n\r\n\n\n### Environment\n\n- Optuna version: 2.10.0\r\n- Python version: 3.9.6\r\n- OS: Windows X64\r\n- (Optional) Other libraries and their versions:\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\nfor the attached python code,  param_value_pairs includes the first 10 initial samples for one optimization run whose objective function value is 5e-5 (pretty good).\r\n\r\nafter I used the 10 initial samples as external DOE, the code does not work always..\r\n\r\nyou can change n_startup_trials=10 or 0 or 1.\n```\n\n\n### Steps to reproduce\n\nimport optuna\r\nimport random\r\n#https://gist.github.com/toshihikoyanase/99f4119f226da4ad227cd6f381136c72\r\ndef suggest_all(trial):\r\n    x = trial.suggest_uniform('x', -10, 10)\r\n    y = trial.suggest_int('y', -2, 2)\r\n    return x, y\r\n\r\n\r\ndef suggest_existing_value(trial, x, y):\r\n    _x = trial.suggest_uniform('x', x, x)\r\n    _y = trial.suggest_int('y', y, y)\r\n    return _x, _y\r\n\r\n\r\n# Define a simple 2-dimensional quadratic function whose minimum value is -1 when (x, y) = (0, -1).\r\ndef quadratic(x, y):\r\n    return x ** 2 + y ** 2\r\n\r\n\r\ndef objective(trial):\r\n    x, y = suggest_all(trial)\r\n    return quadratic(x, y)\r\n\r\n\r\ndef objective_existing_value1(trial, x, y):\r\n    _x, _y = suggest_existing_value(trial, x, y)\r\n    return quadratic(x, y)\r\n\r\n\r\ndef objective_existing_value2(trial, x, y, obj):\r\n    _x, _y = suggest_existing_value(trial, x, y)\r\n    return obj\r\n\r\n\r\ndb_dir = \"C:/Users/cuism/Desktop/ex_DOEs/test.db\"\r\n# os.remove(db_dir)\r\nstorage = ''.join(['sqlite:///', str(db_dir)])\r\n\r\nif __name__ == '__main__':\r\n    # Let us minimize the objective function above.\r\n    # Caveat 1: use RandomSampler to avoid issue #318.\r\n    study = optuna.create_study(sampler=optuna.integration.BoTorchSampler( n_startup_trials=10), storage=storage)\r\n\r\n    #1. Run grid search.\r\n    param_value_pairs = [{'x': -0.22492644981214127, 'y': 1},\r\n                          {'x': 5.991795279912903, 'y': -1},\r\n                          {'x': 8.060776786638474, 'y': -1},\r\n                          {'x': -4.88345511892585, 'y': -1},\r\n                          {'x': 6.221828475591668, 'y': 1},\r\n                          {'x': -8.787236580946693, 'y': -1},\r\n                          {'x': 5.429724312942881, 'y': 2},\r\n                          {'x': 6.555750112224704, 'y': -1},\r\n                          {'x': 4.287032519784351, 'y': 0},\r\n                          {'x': -4.35059865673667, 'y': -1}]\r\n                        \r\n    for params in param_value_pairs: # can parallel\r\n        obj=quadratic(params['x'],params['y'])\r\n        params['obj']=obj\r\n\r\n    for params in param_value_pairs:\r\n        study.optimize(lambda trial: objective_existing_value2(trial, params['x'], params['y'], params['obj']), n_trials=1)\r\n\r\n    # print(study.trials_dataframe())\r\n    # print('Best value: {} (params: {})\\n'.format(study.best_value, study.best_params))\r\n\r\n    # 2. Continue optimization with Optuna.\r\n     \r\n    #study.sampler = optuna.integration.BoTorchSampler( n_startup_trials=10)\r\n    study.optimize(objective, n_trials=30, n_jobs=1)\r\n\r\n    print(study.trials_dataframe())\r\n    print('Best value: {} (params: {})\\n'.format(study.best_value, study.best_params))\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3995/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3995/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3982", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3982/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3982/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3982/events", "html_url": "https://github.com/optuna/optuna/issues/3982", "id": 1368375198, "node_id": "I_kwDOB0okGM5Rj7-e", "number": 3982, "title": "unrobust optuna sampling behaviour", "user": {"login": "HarveyYan", "id": 7417817, "node_id": "MDQ6VXNlcjc0MTc4MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/7417817?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HarveyYan", "html_url": "https://github.com/HarveyYan", "followers_url": "https://api.github.com/users/HarveyYan/followers", "following_url": "https://api.github.com/users/HarveyYan/following{/other_user}", "gists_url": "https://api.github.com/users/HarveyYan/gists{/gist_id}", "starred_url": "https://api.github.com/users/HarveyYan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HarveyYan/subscriptions", "organizations_url": "https://api.github.com/users/HarveyYan/orgs", "repos_url": "https://api.github.com/users/HarveyYan/repos", "events_url": "https://api.github.com/users/HarveyYan/events{/privacy}", "received_events_url": "https://api.github.com/users/HarveyYan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2022-09-09T22:15:32Z", "updated_at": "2023-03-13T06:18:23Z", "closed_at": "2023-03-13T06:18:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nI have something like this in the code: `trial.suggest_categorical('somename', [False, True])`\r\n\r\nand when it is running sometimes it gives an error like `ValueError: 'True' not in (False, True).`, but sometimes it samples just fine without this kind of error.\r\n\r\nI looked into issue with pdb and at `optuna/samplers/nsgaii/_crossover.py(115)` you actually have a `child_params` dictionary which contains  sampled parameters and there is `{..., 'somename': \"False\"}`, although it would make much better sense to have that parameter sampled in `boolean` values.\r\n\r\nAny ideas why that would be happening? Thank you in advance.\n\n### Environment\n\n- Optuna version: 3.0.1\r\n- Python version: 3.8.13\r\n- OS:Linux-4.15.0-1051-aws-x86_64-with-glibc2.17\r\n- (Optional) Other libraries and their versions:\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\nFile \"/lib/python3.8/site-packages/optuna/study/study.py\", line 419, in optimize\r\n    _optimize(\r\n  File \"/lib/python3.8/site-packages/optuna/study/_optimize.py\", line 66, in _optimize\r\n    _optimize_sequential(\r\n  File \"/lib/python3.8/site-packages/optuna/study/_optimize.py\", line 160, in _optimize_sequential\r\n    frozen_trial = _run_trial(study, func, catch)\r\n  File \"/lib/python3.8/site-packages/optuna/study/_optimize.py\", line 187, in _run_trial\r\n    trial = study.ask()\r\n  File \"/lib/python3.8/site-packages/optuna/study/study.py\", line 514, in ask\r\n    trial = trial_module.Trial(self, trial_id)\r\n  File \"/lib/python3.8/site-packages/optuna/trial/_trial.py\", line 54, in __init__\r\n    self._init_relative_params()\r\n  File \"/lib/python3.8/site-packages/optuna/trial/_trial.py\", line 63, in _init_relative_params\r\n    self.relative_params = self.study.sampler.sample_relative(\r\n  File \"/lib/python3.8/site-packages/optuna/samplers/nsgaii/_sampler.py\", line 211, in sample_relative\r\n    child_params = perform_crossover(\r\n  File \"/lib/python3.8/site-packages/optuna/samplers/nsgaii/_crossover.py\", line 115, in perform_crossover\r\n    if _is_contained(child_params, search_space):\r\n  File \"/lib/python3.8/site-packages/optuna/samplers/nsgaii/_crossover.py\", line 160, in _is_contained\r\n    if not param_distribution._contains(param_distribution.to_internal_repr(param)):\r\n  File \"/lib/python3.8/site-packages/optuna/distributions.py\", line 516, in to_internal_repr\r\n    raise ValueError(f\"'{param_value_in_external_repr}' not in {self.choices}.\")\r\nValueError: 'True' not in (False, True).\n```\n\n\n### Steps to reproduce\n\n1.\r\n2.\r\n3.\r\n```python\r\n# python code\r\n```\r\n\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3982/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3982/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3978", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3978/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3978/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3978/events", "html_url": "https://github.com/optuna/optuna/issues/3978", "id": 1367220862, "node_id": "I_kwDOB0okGM5RfiJ-", "number": 3978, "title": "Optuna Pytorch-Lightning integration reports AttributeError", "user": {"login": "RegiusQuant", "id": 36260888, "node_id": "MDQ6VXNlcjM2MjYwODg4", "avatar_url": "https://avatars.githubusercontent.com/u/36260888?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RegiusQuant", "html_url": "https://github.com/RegiusQuant", "followers_url": "https://api.github.com/users/RegiusQuant/followers", "following_url": "https://api.github.com/users/RegiusQuant/following{/other_user}", "gists_url": "https://api.github.com/users/RegiusQuant/gists{/gist_id}", "starred_url": "https://api.github.com/users/RegiusQuant/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RegiusQuant/subscriptions", "organizations_url": "https://api.github.com/users/RegiusQuant/orgs", "repos_url": "https://api.github.com/users/RegiusQuant/repos", "events_url": "https://api.github.com/users/RegiusQuant/events{/privacy}", "received_events_url": "https://api.github.com/users/RegiusQuant/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-09-09T03:07:37Z", "updated_at": "2022-10-03T00:01:31Z", "closed_at": "2022-10-03T00:01:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nShould not report any errors.\n\n### Environment\n\n- Optuna version: 3.0.0\r\n- Python version: 3.8.13\r\n- OS: Linux\r\n- PyTorch version: 1.12.1\r\n- PyTorch Lightning version: 1.7.5\r\n- CUDA version: 11.3.1\n\n### Error messages, stack traces, or logs\n\n```shell\n[I 2022-09-09 09:06:32,860] A new study created in memory with name: no-name-79038e94-b9b7-4b1a-9755-303d527867b7\r\n[W 2022-09-09 09:06:33,014] Trial 0 failed because of the following error: AttributeError(\"'AcceleratorConnector' object has no attribute 'distributed_backend'\")\r\nTraceback (most recent call last):\r\n  File \"/home/wyn/miniconda3/envs/wyn/lib/python3.8/site-packages/optuna/study/_optimize.py\", line 196, in _run_trial\r\n    value_or_values = func(trial)\r\n  File \"optuna_examples/optuna_lightning_example.py\", line 89, in objective\r\n    trainer = pl.Trainer(\r\n  File \"/home/wyn/miniconda3/envs/wyn/lib/python3.8/site-packages/pytorch_lightning/utilities/argparse.py\", line 345, in insert_env_defaults\r\n    return fn(self, **kwargs)\r\n  File \"/home/wyn/miniconda3/envs/wyn/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py\", line 497, in __init__\r\n    self._call_callback_hooks(\"on_init_start\")\r\n  File \"/home/wyn/miniconda3/envs/wyn/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py\", line 1585, in _call_callback_hooks\r\n    fn(self, *args, **kwargs)\r\n  File \"/home/wyn/miniconda3/envs/wyn/lib/python3.8/site-packages/optuna/integration/pytorch_lightning.py\", line 61, in on_init_start\r\n    trainer._accelerator_connector.distributed_backend is not None  # type: ignore\r\nAttributeError: 'AcceleratorConnector' object has no attribute 'distributed_backend'\r\nTraceback (most recent call last):\r\n  File \"optuna_examples/optuna_lightning_example.py\", line 108, in <module>\r\n    study.optimize(objective, n_trials=100, timeout=1000)\r\n  File \"/home/wyn/miniconda3/envs/wyn/lib/python3.8/site-packages/optuna/study/study.py\", line 419, in optimize\r\n    _optimize(\r\n  File \"/home/wyn/miniconda3/envs/wyn/lib/python3.8/site-packages/optuna/study/_optimize.py\", line 66, in _optimize\r\n    _optimize_sequential(\r\n  File \"/home/wyn/miniconda3/envs/wyn/lib/python3.8/site-packages/optuna/study/_optimize.py\", line 160, in _optimize_sequential\r\n    frozen_trial = _run_trial(study, func, catch)\r\n  File \"/home/wyn/miniconda3/envs/wyn/lib/python3.8/site-packages/optuna/study/_optimize.py\", line 234, in _run_trial\r\n    raise func_err\r\n  File \"/home/wyn/miniconda3/envs/wyn/lib/python3.8/site-packages/optuna/study/_optimize.py\", line 196, in _run_trial\r\n    value_or_values = func(trial)\r\n  File \"optuna_examples/optuna_lightning_example.py\", line 89, in objective\r\n    trainer = pl.Trainer(\r\n  File \"/home/wyn/miniconda3/envs/wyn/lib/python3.8/site-packages/pytorch_lightning/utilities/argparse.py\", line 345, in insert_env_defaults\r\n    return fn(self, **kwargs)\r\n  File \"/home/wyn/miniconda3/envs/wyn/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py\", line 497, in __init__\r\n    self._call_callback_hooks(\"on_init_start\")\r\n  File \"/home/wyn/miniconda3/envs/wyn/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py\", line 1585, in _call_callback_hooks\r\n    fn(self, *args, **kwargs)\r\n  File \"/home/wyn/miniconda3/envs/wyn/lib/python3.8/site-packages/optuna/integration/pytorch_lightning.py\", line 61, in on_init_start\r\n    trainer._accelerator_connector.distributed_backend is not None  # type: ignore\r\nAttributeError: 'AcceleratorConnector' object has no attribute 'distributed_backend'\n```\n\n\n### Steps to reproduce\n\n```python\r\nfrom typing import List, Optional\r\n\r\nimport optuna\r\nimport pytorch_lightning as pl\r\nimport torch\r\nimport torch.nn as nn\r\nimport torchmetrics\r\nimport torchvision\r\nfrom optuna.integration.pytorch_lightning import PyTorchLightningPruningCallback\r\nfrom torch.utils.data import random_split, DataLoader\r\n\r\n\r\nclass FashionDataModule(pl.LightningDataModule):\r\n    def __init__(self, data_dir: str, batch_size: int):\r\n        super().__init__()\r\n        self.data_dir = data_dir\r\n        self.batch_size = batch_size\r\n\r\n    def setup(self, stage: Optional[str] = None):\r\n        self.train_set = torchvision.datasets.FashionMNIST(\r\n            self.data_dir, train=True, download=True, transform=torchvision.transforms.ToTensor()\r\n        )\r\n        self.test_set = torchvision.datasets.FashionMNIST(\r\n            self.data_dir, train=False, download=True, transform=torchvision.transforms.ToTensor()\r\n        )\r\n        self.train_set, self.valid_set = random_split(self.train_set, [55000, 5000])\r\n\r\n    def train_dataloader(self) -> DataLoader:\r\n        return DataLoader(self.train_set, batch_size=self.batch_size, shuffle=True, num_workers=4)\r\n\r\n    def val_dataloader(self) -> DataLoader:\r\n        return DataLoader(self.valid_set, batch_size=self.batch_size, shuffle=False, num_workers=4)\r\n\r\n    def test_dataloader(self) -> DataLoader:\r\n        return DataLoader(self.test_set, batch_size=self.batch_size, shuffle=False, num_workers=4)\r\n\r\n\r\nclass SimpleNet(nn.Module):\r\n    def __init__(self, d_hids: List[int], p_drop: float):\r\n        super(SimpleNet, self).__init__()\r\n\r\n        hidden_layers = []\r\n        d_inp = 28 * 28\r\n        for d_hid in d_hids:\r\n            hidden_layers.append(nn.Linear(d_inp, d_hid))\r\n            hidden_layers.append(nn.ReLU())\r\n            hidden_layers.append(nn.Dropout(p_drop))\r\n            d_inp = d_hid\r\n        hidden_layers.append(nn.Linear(d_inp, 10))\r\n\r\n        self.layers = nn.Sequential(*hidden_layers)\r\n\r\n    def forward(self, inputs: torch.Tensor) -> torch.Tensor:\r\n        return self.layers(inputs)\r\n\r\n\r\nclass LitSimpleNet(pl.LightningModule):\r\n    def __init__(self, d_hids: List[int], p_drop: float):\r\n        super().__init__()\r\n        self.model = SimpleNet(d_hids, p_drop)\r\n        self.criterion = nn.CrossEntropyLoss()\r\n        self.accuracy = torchmetrics.Accuracy()\r\n\r\n    def forward(self, inputs: torch.Tensor) -> torch.Tensor:\r\n        return self.model(inputs.view(-1, 28 * 28))\r\n\r\n    def training_step(self, batch, batch_idx) -> torch.Tensor:\r\n        inputs, targets = batch\r\n        outputs = self(inputs)\r\n        return self.criterion(outputs, targets)\r\n\r\n    def validation_step(self, batch, batch_idx):\r\n        inputs, targets = batch\r\n        outputs = self(inputs)\r\n        self.accuracy(outputs, targets)\r\n        self.log(\"valid_acc\", self.accuracy, on_step=False, on_epoch=True, prog_bar=True)\r\n\r\n    def configure_optimizers(self):\r\n        return torch.optim.Adam(self.parameters(), lr=3e-4, weight_decay=1e-5)\r\n\r\n\r\ndef objective(trial: optuna.trial.Trial) -> float:\r\n    n_layers = trial.suggest_int(\"n_layers\", 1, 3)\r\n    p_drop = trial.suggest_float(\"p_drop\", 0.1, 0.5)\r\n    d_hids = [trial.suggest_int(f\"d_hid_{i}\", 16, 128, log=True) for i in range(n_layers)]\r\n\r\n    datamodule = FashionDataModule(\".\", 128)\r\n    model = LitSimpleNet(d_hids, p_drop)\r\n    trainer = pl.Trainer(\r\n        max_epochs=20,\r\n        accelerator=\"gpu\",\r\n        devices=1,\r\n        enable_checkpointing=False,\r\n        logger=True,\r\n        default_root_dir=\".\",\r\n        callbacks=[PyTorchLightningPruningCallback(trial, monitor=\"valid_acc\")]\r\n    )\r\n\r\n    hparams = dict(n_layers=n_layers, d_hids=d_hids, p_drop=p_drop)\r\n    trainer.logger.log_hyperparams(hparams)\r\n    trainer.fit(model, datamodule=datamodule)\r\n    return trainer.callback_metrics[\"valid_acc\"].item()\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    pruner = optuna.pruners.MedianPruner()\r\n    study = optuna.create_study(direction=\"maximize\", pruner=pruner)\r\n    study.optimize(objective, n_trials=100, timeout=1000)\r\n\r\n    print(\"Number of Finished Trials:\", len(study.trials))\r\n\r\n    trial = study.best_trial\r\n    print(\"Best Trial:\")\r\n    print(\"\\tValue:\", trial.value)\r\n    print(\"\\tParams:\")\r\n    for key, value in trial.params.items():\r\n        print(f\"\\t\\t{key}: {value}\")\r\n```\r\n\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3978/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3978/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3976", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3976/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3976/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3976/events", "html_url": "https://github.com/optuna/optuna/issues/3976", "id": 1366732421, "node_id": "I_kwDOB0okGM5Rdq6F", "number": 3976, "title": "optuna.create_study.optimize execution slowly on latest versions", "user": {"login": "Piecer-plc", "id": 109329809, "node_id": "U_kgDOBoQ9kQ", "avatar_url": "https://avatars.githubusercontent.com/u/109329809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Piecer-plc", "html_url": "https://github.com/Piecer-plc", "followers_url": "https://api.github.com/users/Piecer-plc/followers", "following_url": "https://api.github.com/users/Piecer-plc/following{/other_user}", "gists_url": "https://api.github.com/users/Piecer-plc/gists{/gist_id}", "starred_url": "https://api.github.com/users/Piecer-plc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Piecer-plc/subscriptions", "organizations_url": "https://api.github.com/users/Piecer-plc/orgs", "repos_url": "https://api.github.com/users/Piecer-plc/repos", "events_url": "https://api.github.com/users/Piecer-plc/events{/privacy}", "received_events_url": "https://api.github.com/users/Piecer-plc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-09-08T17:29:33Z", "updated_at": "2022-09-09T14:46:53Z", "closed_at": "2022-09-09T14:46:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nHi, I test my program on different optuna versions.  I noticed that its execution time increased when adopting higher versions of optuna.\r\nAs shown in the following experiment results, my program performs best if we use optuna==3.0.1.\r\n\r\n**My question is that why does such a library version perform better? Are there any issues in newer versions?**\r\n\r\n\r\n\r\n### Environment\r\n\r\n- Optuna version: 3.0.1, 2.10.0, 2.3.0\r\n- Python version: 3.7.10\r\n- OS:\r\nOperating System: Linux Ubuntu 16.04\r\nCPU: Intel(R) Core(TM) i9-9900K CPU\r\nGPU: TITAN V\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\nThe detailed information is as follows:\r\n|Optuna Version|Execution Time|\r\n|--|--|\r\n|3.0.1|4110s|\r\n|2.10.0|4774s|\r\n|2.3.0|3737s|\r\n\r\n\r\n\r\n### Steps to reproduce\r\n\r\n1. Dataset\r\nThis dataset size>25MB, so i upload the dataset to Google Drive.\r\n[download dataset](https://drive.google.com/file/d/1hVFrsMgnyKNFvufCLryufkc7mmc-iv7k/view?usp=sharing)\r\n2. Code\r\n```python\r\nimport pandas as pd\r\nimport numpy as np\r\nimport optuna\r\nfrom lightgbm import LGBMRegressor\r\n\r\nfrom sklearn.metrics import mean_squared_error\r\nfrom sklearn.model_selection import train_test_split,KFold\r\nfrom sklearn.preprocessing import LabelEncoder\r\n\r\ntrain=pd.read_csv('train.csv')\r\ntest=pd.read_csv('test.csv')\r\ncat_var=[f'cat{i}' for i in range(10)]\r\ncont_var=[f'cont{i}' for i in range(14)]\r\ncolumns=[ col for col in train.columns.tolist() if col not in ['id','target']]\r\n\r\nfor cat in cat_var:\r\n    le = LabelEncoder()\r\n    train[cat]=le.fit_transform(train[cat])\r\n    test[cat]=le.transform(test[cat])\r\nX=train[columns]\r\ny=train.target\r\ndef objective(trial,train=train,target=y):\r\n    X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.2,random_state=42)\r\n    param={\r\n        'num_leaves':trial.suggest_int('num_leaves',100,1000),\r\n        'max_depth':trial.suggest_categorical('max_depth',[7,10,20,50]),\r\n        'min_child_samples':trial.suggest_int('min_child_samples',100,500),\r\n        'max_bin':trial.suggest_categorical('max_bin',[255,350,512,1024]),\r\n        'learning_rate':trial.suggest_categorical('learning_rate',[0.006,0.008,0.01,0.014,0.017,0.02]),\r\n        'colsample_bytree': trial.suggest_categorical('colsample_bytree', [0.3,0.4,0.5,0.6,0.7,0.8,0.9, 1.0]),\r\n        'subsample': trial.suggest_categorical('subsample', [0.4,0.5,0.6,0.7,0.8,1.0]),\r\n        'metric': 'rmse', \r\n        'random_state': 48,\r\n        'n_estimators': 30000\r\n\r\n    }\r\n    model=LGBMRegressor(**param)\r\n    model.fit(X_train,y_train,eval_set=[(X_test,y_test)],early_stopping_rounds=100,verbose=False)\r\n    predictions=model.predict(X_test)\r\n    rmse=mean_squared_error(y_test,predictions,squared=False)\r\n    return rmse\r\nimport time\r\nstart_time = time.time()\r\nstudy = optuna.create_study(direction='minimize') \r\nstudy.optimize(objective, n_trials=200)\r\nover_time = time.time()\r\ntotal_time = over_time - start_time\r\nprint(\"Time: %s s\" % total_time)\r\n```\r\n\r\n\r\n### Additional context (optional)\r\n\r\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3976/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3976/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3972", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3972/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3972/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3972/events", "html_url": "https://github.com/optuna/optuna/pull/3972", "id": 1365656995, "node_id": "PR_kwDOB0okGM4-kBmw", "number": 3972, "title": "Backport #3957", "user": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/48", "html_url": "https://github.com/optuna/optuna/milestone/48", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/48/labels", "id": 8400326, "node_id": "MI_kwDOB0okGM4AgC3G", "number": 48, "title": "v3.0.1", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 2, "state": "closed", "created_at": "2022-09-08T07:11:00Z", "updated_at": "2022-09-08T09:15:09Z", "due_on": null, "closed_at": "2022-09-08T09:15:09Z"}, "comments": 0, "created_at": "2022-09-08T07:08:12Z", "updated_at": "2022-09-08T07:52:12Z", "closed_at": "2022-09-08T07:52:12Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3972", "html_url": "https://github.com/optuna/optuna/pull/3972", "diff_url": "https://github.com/optuna/optuna/pull/3972.diff", "patch_url": "https://github.com/optuna/optuna/pull/3972.patch", "merged_at": "2022-09-08T07:52:12Z"}, "body": "Backport #3957 for patch release.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3972/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3972/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3967", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3967/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3967/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3967/events", "html_url": "https://github.com/optuna/optuna/pull/3967", "id": 1364326203, "node_id": "PR_kwDOB0okGM4-flCR", "number": 3967, "title": "Fix an import error of `sqlalchemy.orm.declarative_base`", "user": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/47", "html_url": "https://github.com/optuna/optuna/milestone/47", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/47/labels", "id": 8352105, "node_id": "MI_kwDOB0okGM4Af3Fp", "number": 47, "title": "v3.1.0-b0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 149, "state": "closed", "created_at": "2022-08-26T05:11:03Z", "updated_at": "2022-12-22T07:11:04Z", "due_on": null, "closed_at": "2022-12-22T07:11:04Z"}, "comments": 3, "created_at": "2022-09-07T08:55:32Z", "updated_at": "2022-09-13T02:47:13Z", "closed_at": "2022-09-13T02:45:47Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3967", "html_url": "https://github.com/optuna/optuna/pull/3967", "diff_url": "https://github.com/optuna/optuna/pull/3967.diff", "patch_url": "https://github.com/optuna/optuna/pull/3967.patch", "merged_at": "2022-09-13T02:45:47Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull request after it gets two or more approvals. To proceed to the review process by the maintainers, please make sure that the PR meets the following conditions: (1) it passes all CI checks, and (2) it is neither in the draft nor WIP state. If you wish to discuss the PR in the draft state or need any other help, please mention the Optuna development team in the PR. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nFix #3966 \r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\n`sqlalchemy.orm.declarative_base` is only available at SQLAlchemy v14 or later.\r\n\r\n> The ORM Declarative system is now unified into the ORM itself, with new import spaces under sqlalchemy.orm and new kinds of mappings.\r\n> https://docs.sqlalchemy.org/en/14/changelog/changelog_14.html#change-1383b8655e1f94451338941a393cdca6\r\n\r\n\r\n## Steps to Reproduce\r\n\r\n### Setup the test environment using optuna-e2e.\r\n\r\nI prepared the fork of himkt/optuna-e2e to setup the test environment for this PR.\r\nhttps://github.com/c-bata/optuna-e2e/tree/optuna-3967\r\n\r\n```\r\n$ git clone -b optuna-3967 git@github.com:c-bata/optuna-e2e.git\r\n$ cd optuna-e2e\r\n$ docker compose up -d --build  # please wait until databases are ready to listen\r\n$ docker compose run --rm optuna-210 python src/init.py\r\n```\r\n\r\n* Python 3.9.10\r\n* Alembic 1.5.1 (which is released at Jan 20, 2021)\r\n     * Please note that v1.5.1 is the first version that drops sqlalchemy 1.2.0 or before.\r\n     * https://pypi.org/project/alembic/#history\r\n* SQLAlchemy 1.3.0 (which is released at Mar 5, 2019)\r\n     * https://pypi.org/project/SQLAlchemy/#history\r\n\r\n### Before (Optuna v3.0.0)\r\n\r\n```\r\n$ docker compose run --rm optuna-300 bash src/upgrade.sh\r\nmysql\r\n[E 2022-09-08 02:32:04,252] cannot import name 'declarative_base' from 'sqlalchemy.orm' (/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/__init__.py)\r\npostgresql\r\n[E 2022-09-08 02:32:07,168] cannot import name 'declarative_base' from 'sqlalchemy.orm' (/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/__init__.py)\r\nsqlite\r\n[E 2022-09-08 02:32:09,985] cannot import name 'declarative_base' from 'sqlalchemy.orm' (/usr/local/lib/python3.9/site-packages/sqlalchemy/orm/__init__.py)\r\n2022-09-08T11:32:10+09:00 ERR root.go:128] pf failed: exit status 1\r\n```\r\n\r\n### After (this PR)\r\n\r\n```\r\n$ docker compose run --rm optuna-301 bash src/upgrade.sh\r\nmysql\r\n[I 2022-09-08 02:38:34,555] Upgrading the storage schema to the latest version.\r\n/usr/local/lib/python3.9/site-packages/optuna/distributions.py:581: FutureWarning: UniformDistribution has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :class:`~optuna.distributions.FloatDistribution` instead.\r\n  return cls(**json_dict[\"attributes\"])\r\n/usr/local/lib/python3.9/site-packages/optuna/distributions.py:581: FutureWarning: LogUniformDistribution has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :class:`~optuna.distributions.FloatDistribution` instead.\r\n  return cls(**json_dict[\"attributes\"])\r\n/usr/local/lib/python3.9/site-packages/optuna/distributions.py:581: FutureWarning: DiscreteUniformDistribution has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :class:`~optuna.distributions.FloatDistribution` instead.\r\n  return cls(**json_dict[\"attributes\"])\r\n/usr/local/lib/python3.9/site-packages/optuna/distributions.py:581: FutureWarning: IntUniformDistribution has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :class:`~optuna.distributions.IntDistribution` instead.\r\n  return cls(**json_dict[\"attributes\"])\r\n/usr/local/lib/python3.9/site-packages/optuna/distributions.py:581: FutureWarning: IntLogUniformDistribution has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :class:`~optuna.distributions.IntDistribution` instead.\r\n  return cls(**json_dict[\"attributes\"])\r\n[I 2022-09-08 02:38:35,413] Completed to upgrade the storage.\r\npostgresql\r\n[I 2022-09-08 02:38:38,611] Upgrading the storage schema to the latest version.\r\n/usr/local/lib/python3.9/site-packages/optuna/distributions.py:581: FutureWarning: UniformDistribution has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :class:`~optuna.distributions.FloatDistribution` instead.\r\n  return cls(**json_dict[\"attributes\"])\r\n/usr/local/lib/python3.9/site-packages/optuna/distributions.py:581: FutureWarning: LogUniformDistribution has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :class:`~optuna.distributions.FloatDistribution` instead.\r\n  return cls(**json_dict[\"attributes\"])\r\n/usr/local/lib/python3.9/site-packages/optuna/distributions.py:581: FutureWarning: DiscreteUniformDistribution has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :class:`~optuna.distributions.FloatDistribution` instead.\r\n  return cls(**json_dict[\"attributes\"])\r\n/usr/local/lib/python3.9/site-packages/optuna/distributions.py:581: FutureWarning: IntUniformDistribution has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :class:`~optuna.distributions.IntDistribution` instead.\r\n  return cls(**json_dict[\"attributes\"])\r\n/usr/local/lib/python3.9/site-packages/optuna/distributions.py:581: FutureWarning: IntLogUniformDistribution has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :class:`~optuna.distributions.IntDistribution` instead.\r\n  return cls(**json_dict[\"attributes\"])\r\n[I 2022-09-08 02:38:39,158] Completed to upgrade the storage.\r\nsqlite\r\n[I 2022-09-08 02:38:42,224] Upgrading the storage schema to the latest version.\r\n/usr/local/lib/python3.9/site-packages/optuna/distributions.py:581: FutureWarning: UniformDistribution has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :class:`~optuna.distributions.FloatDistribution` instead.\r\n  return cls(**json_dict[\"attributes\"])\r\n/usr/local/lib/python3.9/site-packages/optuna/distributions.py:581: FutureWarning: LogUniformDistribution has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :class:`~optuna.distributions.FloatDistribution` instead.\r\n  return cls(**json_dict[\"attributes\"])\r\n/usr/local/lib/python3.9/site-packages/optuna/distributions.py:581: FutureWarning: DiscreteUniformDistribution has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :class:`~optuna.distributions.FloatDistribution` instead.\r\n  return cls(**json_dict[\"attributes\"])\r\n/usr/local/lib/python3.9/site-packages/optuna/distributions.py:581: FutureWarning: IntUniformDistribution has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :class:`~optuna.distributions.IntDistribution` instead.\r\n  return cls(**json_dict[\"attributes\"])\r\n/usr/local/lib/python3.9/site-packages/optuna/distributions.py:581: FutureWarning: IntLogUniformDistribution has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :class:`~optuna.distributions.IntDistribution` instead.\r\n  return cls(**json_dict[\"attributes\"])\r\n[I 2022-09-08 02:38:43,322] Completed to upgrade the storage.\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3967/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3967/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3966", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3966/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3966/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3966/events", "html_url": "https://github.com/optuna/optuna/issues/3966", "id": 1364317805, "node_id": "I_kwDOB0okGM5RUdZt", "number": 3966, "title": "ImportError: cannot import name 'declarative_base' from 'sqlalchemy.orm' (/usr/local/lib/python3.7/dist-packages/sqlalchemy/orm/__init__.py)", "user": {"login": "shu65", "id": 261656, "node_id": "MDQ6VXNlcjI2MTY1Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/261656?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shu65", "html_url": "https://github.com/shu65", "followers_url": "https://api.github.com/users/shu65/followers", "following_url": "https://api.github.com/users/shu65/following{/other_user}", "gists_url": "https://api.github.com/users/shu65/gists{/gist_id}", "starred_url": "https://api.github.com/users/shu65/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shu65/subscriptions", "organizations_url": "https://api.github.com/users/shu65/orgs", "repos_url": "https://api.github.com/users/shu65/repos", "events_url": "https://api.github.com/users/shu65/events{/privacy}", "received_events_url": "https://api.github.com/users/shu65/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-09-07T08:49:49Z", "updated_at": "2022-09-13T02:45:48Z", "closed_at": "2022-09-13T02:45:48Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Expected behavior\n\nI got the following error message when using a old vesion of SQLAlchemy (the version is 1.3.8)\r\n\r\n```\r\nImportError: cannot import name 'declarative_base' from 'sqlalchemy.orm' (/usr/local/lib/python3.7/dist-packages/sqlalchemy/orm/__init__.py)\r\n```\r\n\n\n### Environment\n\n- Optuna version: 3.0.0\r\n- Python version: 3.7.13\r\n- OS: ?\r\n- (Optional) Other libraries and their versions:\r\nI used Google Colab to reproduce the error.\r\nthe version of SQLAlchemy is 1.3.8\n\n### Error messages, stack traces, or logs\n\n```shell\n---------------------------------------------------------------------------\r\nImportError                               Traceback (most recent call last)\r\n[<ipython-input-4-004b4427a179>](https://localhost:8080/#) in <module>\r\n      2 \r\n      3 storage = \"sqlite:///example.db\"\r\n----> 4 study = optuna.create_study(storage=storage)\r\n\r\n19 frames\r\n[/usr/local/lib/python3.7/dist-packages/optuna/_convert_positional_args.py](https://localhost:8080/#) in converter_wrapper(*args, **kwargs)\r\n     59                 kwargs[arg_name] = val\r\n     60 \r\n---> 61             return func(**kwargs)\r\n     62 \r\n     63         return converter_wrapper\r\n\r\n[/usr/local/lib/python3.7/dist-packages/optuna/study/study.py](https://localhost:8080/#) in create_study(storage, sampler, pruner, study_name, direction, load_if_exists, directions)\r\n   1145     ]\r\n   1146 \r\n-> 1147     storage = storages.get_storage(storage)\r\n   1148     try:\r\n   1149         study_id = storage.create_new_study(study_name)\r\n\r\n[/usr/local/lib/python3.7/dist-packages/optuna/storages/__init__.py](https://localhost:8080/#) in get_storage(storage)\r\n     30             return _CachedStorage(RedisStorage(storage))\r\n     31         else:\r\n---> 32             return _CachedStorage(RDBStorage(storage))\r\n     33     elif isinstance(storage, (RDBStorage, RedisStorage)):\r\n     34         return _CachedStorage(storage)\r\n\r\n[/usr/local/lib/python3.7/dist-packages/optuna/storages/_rdb/storage.py](https://localhost:8080/#) in __init__(self, url, engine_kwargs, skip_compatibility_check, heartbeat_interval, grace_period, failed_trial_callback, skip_table_creation)\r\n    221             models.BaseModel.metadata.create_all(self.engine)\r\n    222 \r\n--> 223         self._version_manager = _VersionManager(self.url, self.engine, self.scoped_session)\r\n    224         if not skip_compatibility_check:\r\n    225             self._version_manager.check_table_schema_compatibility()\r\n\r\n[/usr/local/lib/python3.7/dist-packages/optuna/storages/_rdb/storage.py](https://localhost:8080/#) in __init__(self, url, engine, scoped_session)\r\n   1083         self.scoped_session = scoped_session\r\n   1084         self._init_version_info_model()\r\n-> 1085         self._init_alembic()\r\n   1086 \r\n   1087     def _init_version_info_model(self) -> None:\r\n\r\n[/usr/local/lib/python3.7/dist-packages/optuna/storages/_rdb/storage.py](https://localhost:8080/#) in _init_alembic(self)\r\n   1110 \r\n   1111         if self._is_alembic_supported():\r\n-> 1112             revision = self.get_head_version()\r\n   1113         else:\r\n   1114             # The storage has been created before alembic is introduced.\r\n\r\n[/usr/local/lib/python3.7/dist-packages/optuna/storages/_rdb/storage.py](https://localhost:8080/#) in get_head_version(self)\r\n   1166 \r\n   1167         script = self._create_alembic_script()\r\n-> 1168         current_head = script.get_current_head()\r\n   1169         assert current_head is not None\r\n   1170         return current_head\r\n\r\n[/usr/local/lib/python3.7/dist-packages/alembic/script/base.py](https://localhost:8080/#) in get_current_head(self)\r\n    380             )\r\n    381         ):\r\n--> 382             return self.revision_map.get_current_head()\r\n    383 \r\n    384     def get_heads(self) -> List[str]:\r\n\r\n[/usr/local/lib/python3.7/dist-packages/alembic/script/revision.py](https://localhost:8080/#) in get_current_head(self, branch_label)\r\n    485 \r\n    486         \"\"\"\r\n--> 487         current_heads: Sequence[str] = self.heads\r\n    488         if branch_label:\r\n    489             current_heads = self.filter_for_lineage(\r\n\r\n[/usr/local/lib/python3.7/dist-packages/sqlalchemy/util/langhelpers.py](https://localhost:8080/#) in __get__(self, obj, cls)\r\n    853         if obj is None:\r\n    854             return self\r\n--> 855         obj.__dict__[self.__name__] = result = self.fget(obj)\r\n    856         return result\r\n    857 \r\n\r\n[/usr/local/lib/python3.7/dist-packages/alembic/script/revision.py](https://localhost:8080/#) in heads(self)\r\n    135 \r\n    136         \"\"\"\r\n--> 137         self._revision_map\r\n    138         return self.heads\r\n    139 \r\n\r\n[/usr/local/lib/python3.7/dist-packages/sqlalchemy/util/langhelpers.py](https://localhost:8080/#) in __get__(self, obj, cls)\r\n    853         if obj is None:\r\n    854             return self\r\n--> 855         obj.__dict__[self.__name__] = result = self.fget(obj)\r\n    856         return result\r\n    857 \r\n\r\n[/usr/local/lib/python3.7/dist-packages/alembic/script/revision.py](https://localhost:8080/#) in _revision_map(self)\r\n    189         all_revisions = set()\r\n    190 \r\n--> 191         for revision in self._generator():\r\n    192             all_revisions.add(revision)\r\n    193 \r\n\r\n[/usr/local/lib/python3.7/dist-packages/alembic/script/base.py](https://localhost:8080/#) in _load_revisions(self)\r\n    138                     continue\r\n    139                 dupes.add(path)\r\n--> 140                 script = Script._from_filename(self, vers, file_)\r\n    141                 if script is None:\r\n    142                     continue\r\n\r\n[/usr/local/lib/python3.7/dist-packages/alembic/script/base.py](https://localhost:8080/#) in _from_filename(cls, scriptdir, dir_, filename)\r\n   1011                 return None\r\n   1012 \r\n-> 1013         module = util.load_python_file(dir_, filename)\r\n   1014 \r\n   1015         if not hasattr(module, \"revision\"):\r\n\r\n[/usr/local/lib/python3.7/dist-packages/alembic/util/pyfiles.py](https://localhost:8080/#) in load_python_file(dir_, filename)\r\n     92     if ext == \".py\":\r\n     93         if os.path.exists(path):\r\n---> 94             module = load_module_py(module_id, path)\r\n     95         else:\r\n     96             pyc_path = pyc_file_from_path(path)\r\n\r\n[/usr/local/lib/python3.7/dist-packages/alembic/util/pyfiles.py](https://localhost:8080/#) in load_module_py(module_id, path)\r\n    108     assert spec\r\n    109     module = importlib.util.module_from_spec(spec)\r\n--> 110     spec.loader.exec_module(module)  # type: ignore\r\n    111     return module\r\n\r\n/usr/lib/python3.7/importlib/_bootstrap_external.py in exec_module(self, module)\r\n\r\n/usr/lib/python3.7/importlib/_bootstrap.py in _call_with_frames_removed(f, *args, **kwds)\r\n\r\n[/usr/local/lib/python3.7/dist-packages/optuna/storages/_rdb/alembic/versions/v3.0.0.b.py](https://localhost:8080/#) in <module>\r\n     15 from sqlalchemy import ForeignKey\r\n     16 from sqlalchemy import Integer\r\n---> 17 from sqlalchemy.orm import declarative_base\r\n     18 from sqlalchemy.orm import Session\r\n     19 \r\n\r\nImportError: cannot import name 'declarative_base' from 'sqlalchemy.orm' (/usr/local/lib/python3.7/dist-packages/sqlalchemy/orm/__init__.py)\r\n```\n```\n\n\n### Steps to reproduce\n\n1. create new Google Colab notebook\r\n2. install packages optuna and sqlalchemy like this:\r\n```\r\n!pip install -U optuna==v3.0.0 SQLAlchemy==1.3.8\r\n```\r\n4. create study with sqlite\r\n```python\r\nimport optuna\r\n\r\nstorage = \"sqlite:///example.db\"\r\nstudy = optuna.create_study(storage=storage)\r\n```\r\n\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3966/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3966/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3961", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3961/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3961/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3961/events", "html_url": "https://github.com/optuna/optuna/issues/3961", "id": 1360637346, "node_id": "I_kwDOB0okGM5RGa2i", "number": 3961, "title": "record_evaluation callback with LightGBMTunerCV fails on trial 0", "user": {"login": "rabyj", "id": 46824766, "node_id": "MDQ6VXNlcjQ2ODI0NzY2", "avatar_url": "https://avatars.githubusercontent.com/u/46824766?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rabyj", "html_url": "https://github.com/rabyj", "followers_url": "https://api.github.com/users/rabyj/followers", "following_url": "https://api.github.com/users/rabyj/following{/other_user}", "gists_url": "https://api.github.com/users/rabyj/gists{/gist_id}", "starred_url": "https://api.github.com/users/rabyj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rabyj/subscriptions", "organizations_url": "https://api.github.com/users/rabyj/orgs", "repos_url": "https://api.github.com/users/rabyj/repos", "events_url": "https://api.github.com/users/rabyj/events{/privacy}", "received_events_url": "https://api.github.com/users/rabyj/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-09-02T21:51:30Z", "updated_at": "2022-09-06T15:07:55Z", "closed_at": "2022-09-03T06:02:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nExpected behavior: At least one trial finishes during LightGBMTunerCV.\r\n\r\nObserved behavior: Trial 0 fails on record_evaluation callback.\r\n\r\n### Environment\r\n\r\n- Optuna version: 3.0.0\r\n- Python version: 3.8.10\r\n- OS: Linux-5.15.0-46-generic-x86_64-with-glibc2.29 (Ubuntu 20.04.5 LTS)\r\n- lightgbm : 3.3.2\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.8/runpy.py\", line 194, in _run_module_as_main\r\n    return _run_code(code, main_globals, None,\r\n  File \"/usr/lib/python3.8/runpy.py\", line 87, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/home/local/USHERBROOKE/rabj2301/.vscode/extensions/ms-python.python-2022.12.1/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher/../../debugpy/__main__.py\", line 39, in <module>\r\n    cli.main()\r\n  File \"/home/local/USHERBROOKE/rabj2301/.vscode/extensions/ms-python.python-2022.12.1/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher/../../debugpy/../debugpy/server/cli.py\", line 430, in main\r\n    run()\r\n  File \"/home/local/USHERBROOKE/rabj2301/.vscode/extensions/ms-python.python-2022.12.1/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher/../../debugpy/../debugpy/server/cli.py\", line 284, in run_file\r\n    runpy.run_path(target, run_name=\"__main__\")\r\n  File \"/home/local/USHERBROOKE/rabj2301/.vscode/extensions/ms-python.python-2022.12.1/pythonFiles/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py\", line 321, in run_path\r\n    return _run_module_code(code, init_globals, run_name,\r\n  File \"/home/local/USHERBROOKE/rabj2301/.vscode/extensions/ms-python.python-2022.12.1/pythonFiles/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py\", line 135, in _run_module_code\r\n    _run_code(code, mod_globals, init_globals,\r\n  File \"/home/local/USHERBROOKE/rabj2301/.vscode/extensions/ms-python.python-2022.12.1/pythonFiles/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py\", line 124, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/home/local/USHERBROOKE/rabj2301/Projects/sources/epi_ml/epi_ml/python/test/lgbm_test.py\", line 36, in <module>\r\n    tuner.run()\r\n  File \"/home/local/USHERBROOKE/rabj2301/Projects/epilap/venv-epilap-pytorch/lib/python3.8/site-packages/optuna/integration/_lightgbm_tuner/optimize.py\", line 545, in run\r\n    self.tune_feature_fraction()\r\n  File \"/home/local/USHERBROOKE/rabj2301/Projects/epilap/venv-epilap-pytorch/lib/python3.8/site-packages/optuna/integration/_lightgbm_tuner/optimize.py\", line 570, in tune_feature_fraction\r\n    self._tune_params([param_name], len(param_values), sampler, \"feature_fraction\")\r\n  File \"/home/local/USHERBROOKE/rabj2301/Projects/epilap/venv-epilap-pytorch/lib/python3.8/site-packages/optuna/integration/_lightgbm_tuner/optimize.py\", line 653, in _tune_params\r\n    study.optimize(\r\n  File \"/home/local/USHERBROOKE/rabj2301/Projects/epilap/venv-epilap-pytorch/lib/python3.8/site-packages/optuna/study/study.py\", line 419, in optimize\r\n    _optimize(\r\n  File \"/home/local/USHERBROOKE/rabj2301/Projects/epilap/venv-epilap-pytorch/lib/python3.8/site-packages/optuna/study/_optimize.py\", line 66, in _optimize\r\n    _optimize_sequential(\r\n  File \"/home/local/USHERBROOKE/rabj2301/Projects/epilap/venv-epilap-pytorch/lib/python3.8/site-packages/optuna/study/_optimize.py\", line 160, in _optimize_sequential\r\n    frozen_trial = _run_trial(study, func, catch)\r\n  File \"/home/local/USHERBROOKE/rabj2301/Projects/epilap/venv-epilap-pytorch/lib/python3.8/site-packages/optuna/study/_optimize.py\", line 234, in _run_trial\r\n    raise func_err\r\n  File \"/home/local/USHERBROOKE/rabj2301/Projects/epilap/venv-epilap-pytorch/lib/python3.8/site-packages/optuna/study/_optimize.py\", line 196, in _run_trial\r\n    value_or_values = func(trial)\r\n  File \"/home/local/USHERBROOKE/rabj2301/Projects/epilap/venv-epilap-pytorch/lib/python3.8/site-packages/optuna/integration/_lightgbm_tuner/optimize.py\", line 319, in __call__\r\n    cv_results = lgb.cv(self.lgbm_params, train_set, **self.lgbm_kwargs)\r\n  File \"/home/local/USHERBROOKE/rabj2301/Projects/epilap/venv-epilap-pytorch/lib/python3.8/site-packages/lightgbm/engine.py\", line 647, in cv\r\n    cb(callback.CallbackEnv(model=cvfolds,\r\n  File \"/home/local/USHERBROOKE/rabj2301/Projects/epilap/venv-epilap-pytorch/lib/python3.8/site-packages/lightgbm/callback.py\", line 137, in _callback\r\n    _init(env)\r\n  File \"/home/local/USHERBROOKE/rabj2301/Projects/epilap/venv-epilap-pytorch/lib/python3.8/site-packages/lightgbm/callback.py\", line 131, in _init\r\n    for data_name, eval_name, _, _ in env.evaluation_result_list:\r\nValueError: too many values to unpack (expected 4)\r\n```\r\nAn example of `env.evaluation_result_list` is `[('cv_agg', 'multi_logloss', 1.4147074045922856, False, 0.006446780822586096)]`\r\n\r\n### Steps to reproduce\r\n\r\nI pickled the data to create something reproducible that stays close to my code. The input data needs to be in the same folder.\r\n\r\n```python\r\nimport gzip\r\nimport pathlib\r\nimport pickle\r\n\r\nimport optuna.integration.lightgbm as lgb\r\n[input-n40.pickle.gz](https://github.com/optuna/optuna/files/9481202/input-n40.pickle.gz)\r\n\r\nparams = {\r\n    \"objective\": \"multiclass\",\r\n    \"num_class\": 4,\r\n    \"metric\": \"multi_logloss\",\r\n    \"boosting_type\": \"dart\",\r\n    \"seed\": 42,\r\n    \"verbosity\": 4,\r\n}\r\n\r\nwith gzip.open(\r\n    pathlib.Path(__file__).parent.resolve() / \"input-n40.pickle.gz\", \"rb\"\r\n) as f:\r\n    input_data = pickle.load(f)\r\n\r\ndtrain = input_data[\"dtrain\"]\r\nfolds = input_data[\"folds\"]\r\n\r\neval_results = {}\r\n\r\ntuner = lgb.LightGBMTunerCV(\r\n    params,\r\n    dtrain,\r\n    folds=folds,\r\n    callbacks=[lgb.record_evaluation(eval_results)],\r\n    show_progress_bar=False,\r\n)\r\n\r\ntuner.run()\r\n```\r\n\r\n### Additional context (optional)\r\n\r\nA more full picture context for my code, which is not that far from [lightgbm_tuner_cv.py example](https://github.com/optuna/optuna-examples/blob/main/lightgbm/lightgbm_tuner_cv.py):\r\n```python\r\n    params = {\r\n        \"objective\": \"multiclass\",\r\n        \"num_class\": len(ea_handler.classes),\r\n        \"metric\": \"multi_logloss\",\r\n        \"boosting_type\": \"dart\",\r\n        \"seed\": 42,\r\n        \"verbosity\": 4,\r\n    }\r\n\r\n    total_data = ea_handler.create_total_data()\r\n    folds = list(ea_handler.split(total_data))\r\n    dtrain = lgb.Dataset(  # type: ignore\r\n        total_data.signals, label=total_data.encoded_labels, free_raw_data=True\r\n    )\r\n\r\n    eval_results = {}\r\n\r\n    tuner = lgb.LightGBMTunerCV(  # type: ignore\r\n        params,\r\n        dtrain,\r\n        folds=folds,  # type: ignore\r\n        callbacks=[\r\n            lgb.record_evaluation(eval_results),  # type: ignore\r\n            lgb.log_evaluation,  # type: ignore\r\n        ],\r\n        show_progress_bar=False,\r\n    )\r\n\r\n    tuner.run()\r\n```\r\n\r\n- Data is multiclass\r\n- `folds` is a list of the modified output of StratifiedKFold (repeated values for oversampling, but still same domain and format), so train and test idx. k=2 in kfold.\r\n- `free_raw_data=False` changes nothing\r\n\r\n([github](https://github.com/rabyj/epi_ml/commit/8960351c37e5fde20735f840413f899201d9b24f#diff-e370a91fe6e07469d65071226d2066a1c8b3883f87f7c534876d9fecd8429b01R137))\r\n\r\nAn example of `env.evaluation_result_list` is `[('cv_agg', 'multi_logloss', 1.4147074045922856, False, 0.006446780822586096)]`\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3961/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3961/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3960", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3960/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3960/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3960/events", "html_url": "https://github.com/optuna/optuna/issues/3960", "id": 1360619556, "node_id": "I_kwDOB0okGM5RGWgk", "number": 3960, "title": "LightGBMTunerCV never begins trials", "user": {"login": "rabyj", "id": 46824766, "node_id": "MDQ6VXNlcjQ2ODI0NzY2", "avatar_url": "https://avatars.githubusercontent.com/u/46824766?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rabyj", "html_url": "https://github.com/rabyj", "followers_url": "https://api.github.com/users/rabyj/followers", "following_url": "https://api.github.com/users/rabyj/following{/other_user}", "gists_url": "https://api.github.com/users/rabyj/gists{/gist_id}", "starred_url": "https://api.github.com/users/rabyj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rabyj/subscriptions", "organizations_url": "https://api.github.com/users/rabyj/orgs", "repos_url": "https://api.github.com/users/rabyj/repos", "events_url": "https://api.github.com/users/rabyj/events{/privacy}", "received_events_url": "https://api.github.com/users/rabyj/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2022-09-02T21:18:22Z", "updated_at": "2023-01-14T09:40:26Z", "closed_at": "2022-09-07T18:37:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nI'm putting two problems together because they have the same input, just one version has a smaller input. I imagine they are related. This might be a LightGBM problem, and not optuna. The issue can be closed if that is the case.\r\n\r\nExpected behavior : [ LightGBMTunerCV](https://github.com/optuna/optuna-examples/blob/main/lightgbm/lightgbm_tuner_cv.py) begins trials after LightGBM prints total bin number.\r\n\r\nObserved behaviour:  LightGBMTunerCV.run() ends and exits the program without any trials or errors. Last prints are related to total bin size. Internal Training dataset not constructed.\r\n\r\nAfter reducing the total data from 1096 samples (~130 mb) to 542 samples, the problem **slightly** changes. (same data source/classes, still same number of samples for each class). I get a bit more prints indicating the training set was constructed, but then it stops similarly.\r\n\r\nIf the dataset is reduced even further, trials seem to start.\r\n\r\n### Environment\r\n\r\n- Optuna version: 3.0.0\r\n- Python version: 3.8.10\r\n- OS: Linux-5.15.0-46-generic-x86_64-with-glibc2.29 (Ubuntu 20.04.5 LTS)\r\n- lightgbm : 3.3.2\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\nSITUATION 1\r\nLogs with verbosity 4:\r\n```\r\n[I 2022-09-01 17:18:25,811] A new study created in memory with name: no-name-f7558179-1685-4799-a668-4d05bb21188a\r\n[LightGBM] [Debug] Dataset::GetMultiBinFromAllFeatures: sparse rate 0.000000\r\n[LightGBM] [Debug] init for col-wise cost 0.026579 seconds, init for row-wise cost 2.166356 seconds\r\n[LightGBM] [Warning] Auto-choosing col-wise multi-threading, the overhead of testing was 4.252611 seconds.\r\nYou can set `force_col_wise=true` to remove the overhead.\r\n[LightGBM] [Info] Total Bins 7731833\r\n```\r\n\r\nFull stack context before end.\r\n```\r\n__init__ (/home/local/USHERBROOKE/<user>/Projects/epilap/venv-epilap-pytorch/lib/python3.8/site-packages/lightgbm/basic.py:2610)\r\n_make_n_folds (/home/local/USHERBROOKE/<user>/Projects/epilap/venv-epilap-pytorch/lib/python3.8/site-packages/lightgbm/engine.py:410)\r\ncv (/home/local/USHERBROOKE/<user>/Projects/epilap/venv-epilap-pytorch/lib/python3.8/site-packages/lightgbm/engine.py:605)\r\n__call__ (/home/local/USHERBROOKE/<user>/Projects/epilap/venv-epilap-pytorch/lib/python3.8/site-packages/optuna/integration/_lightgbm_tuner/optimize.py:319)\r\n_run_trial (/home/local/USHERBROOKE/<user>/Projects/epilap/venv-epilap-pytorch/lib/python3.8/site-packages/optuna/study/_optimize.py:196)\r\n_optimize_sequential (/home/local/USHERBROOKE/<user>/Projects/epilap/venv-epilap-pytorch/lib/python3.8/site-packages/optuna/study/_optimize.py:160)\r\n_optimize (/home/local/USHERBROOKE/<user>/Projects/epilap/venv-epilap-pytorch/lib/python3.8/site-packages/optuna/study/_optimize.py:66)\r\noptimize (/home/local/USHERBROOKE/<user>/Projects/epilap/venv-epilap-pytorch/lib/python3.8/site-packages/optuna/study/study.py:419)\r\n_tune_params (/home/local/USHERBROOKE/<user>/Projects/epilap/venv-epilap-pytorch/lib/python3.8/site-packages/optuna/integration/_lightgbm_tuner/optimize.py:653)\r\ntune_feature_fraction (/home/local/USHERBROOKE/<user>/Projects/epilap/venv-epilap-pytorch/lib/python3.8/site-packages/optuna/integration/_lightgbm_tuner/optimize.py:570)\r\nrun (/home/local/USHERBROOKE/<user>/Projects/epilap/venv-epilap-pytorch/lib/python3.8/site-packages/optuna/integration/_lightgbm_tuner/optimize.py:545)\r\ntune_lbgm (/home/local/USHERBROOKE/<user>/Projects/sources/epi_ml/epi_ml/python/core/estimators.py:179)\r\nmain (/home/local/USHERBROOKE/<user>/Projects/sources/epi_ml/epi_ml/python/other_estimators.py:132)\r\n<module> (/home/local/USHERBROOKE/<user>/Projects/sources/epi_ml/epi_ml/python/other_estimators.py:170)\r\n_run_code (/usr/lib/python3.8/runpy.py:87)\r\n_run_module_as_main (/usr/lib/python3.8/runpy.py:194)\r\n```\r\n\r\nSITUATION 2\r\n\r\nLogs\r\n```\r\n[I 2022-09-02 16:09:15,257] A new study created in memory with name: no-name-73c934d6-7610-4800-bb86-995160cc7deb\r\n[LightGBM] [Debug] Dataset::GetMultiBinFromAllFeatures: sparse rate 0.000000\r\n[LightGBM] [Debug] init for col-wise cost 0.001908 seconds, init for row-wise cost 0.575387 seconds\r\n[LightGBM] [Warning] Auto-choosing col-wise multi-threading, the overhead of testing was 1.194562 seconds.\r\nYou can set `force_col_wise=true` to remove the overhead.\r\n[LightGBM] [Info] Total Bins 5493186\r\n[LightGBM] [Info] Number of data points in the train set: 274, number of used features: 30321\r\n[LightGBM] [Debug] Dataset::GetMultiBinFromAllFeatures: sparse rate 0.000000\r\n[LightGBM] [Debug] init for col-wise cost 0.001943 seconds, init for row-wise cost 0.570320 seconds\r\n[LightGBM] [Warning] Auto-choosing col-wise multi-threading, the overhead of testing was 1.317071 seconds.\r\nYou can set `force_col_wise=true` to remove the overhead.\r\n[LightGBM] [Info] Total Bins 5493186\r\n```\r\n\r\nThe full stack context before the end is the same in this case, no error traceback.\r\n\r\n### Steps to reproduce\r\n\r\nI was not able to create a minimal working example, since reducing the dataset size even more makes the problem disappear. \r\n\r\nNonetheless, I pickled my input data (542 samples) to permit reproducing the problem with the following code (when the input is in the same folder):\r\n\r\n```python\r\nimport lzma\r\nimport pathlib\r\nimport pickle\r\n\r\nimport optuna.integration.lightgbm as lgb\r\n\r\nparams = {\r\n    \"objective\": \"multiclass\",\r\n    \"num_class\": 4,\r\n    \"metric\": \"multi_logloss\",\r\n    \"boosting_type\": \"dart\",\r\n    \"seed\": 42,\r\n    \"verbosity\": 4,\r\n}\r\n\r\nwith lzma.open(pathlib.Path(__file__).parent.resolve() / \"input.pickle.xz\", \"rb\") as f:\r\n    input_data = pickle.load(f)\r\n\r\ndtrain = input_data[\"dtrain\"]\r\nfolds = input_data[\"folds\"]\r\n\r\ntuner = lgb.LightGBMTunerCV(\r\n    params,\r\n    dtrain,\r\n    folds=folds,\r\n    show_progress_bar=False,\r\n)\r\n\r\n\r\ntuner.run()\r\n```\r\n[Link to data](https://filedropper.com/d/s/tPWm52taJw0PYDnMvtIJ1sGeocJeaL)\r\n\r\n### Additional context (optional)\r\n\r\nessential part of my own code, which is not that far from [lightgbm_tuner_cv.py example](https://github.com/optuna/optuna-examples/blob/main/lightgbm/lightgbm_tuner_cv.py):\r\n```python\r\n    params = {\r\n        \"objective\": \"multiclass\",\r\n        \"num_class\": len(ea_handler.classes),\r\n        \"metric\": \"multi_logloss\",\r\n        \"boosting_type\": \"dart\",\r\n        \"seed\": 42,\r\n        \"verbosity\": 4,\r\n    }\r\n\r\n    total_data = ea_handler.create_total_data()\r\n    folds = list(ea_handler.split(total_data))\r\n    dtrain = lgb.Dataset(total_data.signals, label=total_data.encoded_label)\r\n\r\n    tuner = lgb.LightGBMTunerCV(\r\n        params,\r\n        dtrain,\r\n        folds=folds,\r\n        show_progress_bar=False,\r\n    )\r\n\r\n    tuner.run()\r\n```\r\n\r\n- Data is multiclass\r\n- lgbm dataset was created with:\r\n  - `total_data.signals`: `ndarray[num_features, n_samples] (dtype=float32)`\r\n  - `total_data.encoded_label`: `ndarray[n_samples] (dtype=int64)`\r\n- `folds` is a list of the modified output of StratifiedKFold (repeated values for oversampling, but still same domain and format), so train and test idx. k=2 in kfold.\r\n- `free_raw_data=False` changes nothing\r\n\r\n([github](https://github.com/rabyj/epi_ml/commit/8960351c37e5fde20735f840413f899201d9b24f#diff-e370a91fe6e07469d65071226d2066a1c8b3883f87f7c534876d9fecd8429b01R137))\r\n\r\nCodes goes up to [`_LIB.LGBM_BoosterCreate`](https://github.com/microsoft/LightGBM/blob/d78b6bc2fdf96c87e3cb61f2d497a962e3270c91/python-package/lightgbm/basic.py#L2730) through [`cvbooster = Booster(tparam, train_set)`](https://github.com/microsoft/LightGBM/blob/master/python-package/lightgbm/engine.py#L485) with what seems to be the correct training data. It just stops after printing some LightGBM info messages.\r\n\r\nWith reduced dataset (542 samples), code goes past `cvbooster = Booster(tparam, train_set)`) the first time, but it stops the second time it gets to `_LIB.LGBM_BoosterCreate` (creation of internal training set).", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3960/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3960/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3957", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3957/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3957/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3957/events", "html_url": "https://github.com/optuna/optuna/pull/3957", "id": 1359729104, "node_id": "PR_kwDOB0okGM4-QgJW", "number": 3957, "title": "Fix `GridSampler`", "user": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/47", "html_url": "https://github.com/optuna/optuna/milestone/47", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/47/labels", "id": 8352105, "node_id": "MI_kwDOB0okGM4Af3Fp", "number": 47, "title": "v3.1.0-b0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 149, "state": "closed", "created_at": "2022-08-26T05:11:03Z", "updated_at": "2022-12-22T07:11:04Z", "due_on": null, "closed_at": "2022-12-22T07:11:04Z"}, "comments": 1, "created_at": "2022-09-02T05:42:19Z", "updated_at": "2022-09-05T00:07:26Z", "closed_at": "2022-09-05T00:03:00Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3957", "html_url": "https://github.com/optuna/optuna/pull/3957", "diff_url": "https://github.com/optuna/optuna/pull/3957.diff", "patch_url": "https://github.com/optuna/optuna/pull/3957.patch", "merged_at": "2022-09-05T00:03:00Z"}, "body": "## Motivation\r\nFix #3955.\r\n\r\n## Description of the changes\r\n`np.random.RandomState.choice` now returns `np.int64` instead of `int`, and `np.int64` is not json serializable. We add a conversion.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3957/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3957/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3955", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3955/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3955/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3955/events", "html_url": "https://github.com/optuna/optuna/issues/3955", "id": 1359135152, "node_id": "I_kwDOB0okGM5RAsGw", "number": 3955, "title": "GridSampler raises TypeError when used with PostgreSQL", "user": {"login": "ilenoa", "id": 5930253, "node_id": "MDQ6VXNlcjU5MzAyNTM=", "avatar_url": "https://avatars.githubusercontent.com/u/5930253?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ilenoa", "html_url": "https://github.com/ilenoa", "followers_url": "https://api.github.com/users/ilenoa/followers", "following_url": "https://api.github.com/users/ilenoa/following{/other_user}", "gists_url": "https://api.github.com/users/ilenoa/gists{/gist_id}", "starred_url": "https://api.github.com/users/ilenoa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ilenoa/subscriptions", "organizations_url": "https://api.github.com/users/ilenoa/orgs", "repos_url": "https://api.github.com/users/ilenoa/repos", "events_url": "https://api.github.com/users/ilenoa/events{/privacy}", "received_events_url": "https://api.github.com/users/ilenoa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-09-01T16:49:05Z", "updated_at": "2022-09-05T11:25:34Z", "closed_at": "2022-09-05T00:03:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nThe example from the documentation for [GridSampler](https://optuna.readthedocs.io/en/stable/reference/samplers/generated/optuna.samplers.GridSampler.html#optuna.samplers.GridSampler) should work just the same when adding a PostgreSQL storage to optuna.create_study. Instead, it raises \"TypeError: Object of type int64 is not JSON serializable\"\r\n\n\n### Environment\n\n- Optuna version: 3.0.0\r\n- Python version: 3.9.2\r\n- OS: Linux-5.10.102.1-microsoft-standard-WSL2-x86_64-with-glibc2.28'\r\n- (Optional) Other libraries and their versions:\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\nA new study created in RDB with name: no-name-2f43ea9c-821e-4731-9b57-741cc4bb831f\r\nTraceback (most recent call last):\r\n  File \"/optuna_test.py\", line 17, in <module>\r\n    study.optimize(objective)\r\n  File \"/usr/local/lib/python3.9/site-packages/optuna/study/study.py\", line 419, in optimize\r\n    _optimize(\r\n  File \"/usr/local/lib/python3.9/site-packages/optuna/study/_optimize.py\", line 66, in _optimize\r\n    _optimize_sequential(\r\n  File \"/usr/local/lib/python3.9/site-packages/optuna/study/_optimize.py\", line 160, in _optimize_sequential\r\n    frozen_trial = _run_trial(study, func, catch)\r\n  File \"/usr/local/lib/python3.9/site-packages/optuna/study/_optimize.py\", line 187, in _run_trial\r\n    trial = study.ask()\r\n  File \"/usr/local/lib/python3.9/site-packages/optuna/study/study.py\", line 514, in ask\r\n    trial = trial_module.Trial(self, trial_id)\r\n  File \"/usr/local/lib/python3.9/site-packages/optuna/trial/_trial.py\", line 54, in __init__\r\n    self._init_relative_params()\r\n  File \"/usr/local/lib/python3.9/site-packages/optuna/trial/_trial.py\", line 63, in _init_relative_params\r\n    self.relative_params = self.study.sampler.sample_relative(\r\n  File \"/usr/local/lib/python3.9/site-packages/optuna/samplers/_grid.py\", line 163, in sample_relative\r\n    study._storage.set_trial_system_attr(trial._trial_id, \"grid_id\", grid_id)\r\n  File \"/usr/local/lib/python3.9/site-packages/optuna/storages/_cached_storage.py\", line 318, in set_trial_system_attr\r\n    self._backend.set_trial_system_attr(trial_id, key=key, value=value)\r\n  File \"/usr/local/lib/python3.9/site-packages/optuna/storages/_rdb/storage.py\", line 782, in set_trial_system_attr\r\n    self._set_trial_system_attr_without_commit(session, trial_id, key, value)\r\n  File \"/usr/local/lib/python3.9/site-packages/optuna/storages/_rdb/storage.py\", line 794, in _set_trial_system_attr_without_commit\r\n    trial_id=trial_id, key=key, value_json=json.dumps(value)\r\n  File \"/usr/local/lib/python3.9/json/__init__.py\", line 231, in dumps\r\n    return _default_encoder.encode(obj)\r\n  File \"/usr/local/lib/python3.9/json/encoder.py\", line 199, in encode\r\n    chunks = self.iterencode(o, _one_shot=True)\r\n  File \"/usr/local/lib/python3.9/json/encoder.py\", line 257, in iterencode\r\n    return _iterencode(o, 0)\r\n  File \"/usr/local/lib/python3.9/json/encoder.py\", line 179, in default\r\n    raise TypeError(f'Object of type {o.__class__.__name__} '\r\nTypeError: Object of type int64 is not JSON serializable\n```\n\n\n### Steps to reproduce\n\n1. Run the example from [GridSampler](https://optuna.readthedocs.io/en/stable/reference/samplers/generated/optuna.samplers.GridSampler.html#optuna.samplers.GridSampler) documentation, it works perfectly.\r\n```python\r\nimport optuna\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_float(\"x\", -100, 100)\r\n    y = trial.suggest_int(\"y\", -100, 100)\r\n    return x**2 + y**2\r\n\r\nsearch_space = {\"x\": [-50, 0, 50], \"y\": [-99, 0, 99]}\r\nstudy = optuna.create_study(sampler=optuna.samplers.GridSampler(search_space))\r\nstudy.optimize(objective)\r\n```\r\n2. Add a PostgreSQL storage, and it fails:\r\n```python\r\nimport optuna\r\n\r\npostgres_url = f\"postgresql://{usr}:{pwd}@{host}:{port}/{name}?options=--search_path%3Doptuna\"\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_float(\"x\", -100, 100)\r\n    y = trial.suggest_int(\"y\", -100, 100)\r\n    return x**2 + y**2\r\n\r\nsearch_space = {\"x\": [-50, 0, 50], \"y\": [-99, 0, 99]}\r\nstudy = optuna.create_study(sampler=optuna.samplers.GridSampler(search_space), storage=postgres_url)\r\nstudy.optimize(objective)\r\n```\r\n3. Use PostgreSQL with TPE Sampler, and it works:\r\n```python\r\nimport optuna\r\n\r\npostgres_url = f\"postgresql://{usr}:{pwd}@{host}:{port}/{name}?options=--search_path%3Doptuna\"\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_float(\"x\", -100, 100)\r\n    y = trial.suggest_int(\"y\", -100, 100)\r\n    return x**2 + y**2\r\n\r\nstudy = optuna.create_study(storage=postgres_url)\r\nstudy.optimize(objective)\r\n```\r\n\r\n\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3955/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3955/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3953", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3953/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3953/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3953/events", "html_url": "https://github.com/optuna/optuna/pull/3953", "id": 1358825852, "node_id": "PR_kwDOB0okGM4-NcvI", "number": 3953, "title": "Fix infinite loop bug in `TPESampler`", "user": {"login": "gasin", "id": 7404299, "node_id": "MDQ6VXNlcjc0MDQyOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/7404299?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gasin", "html_url": "https://github.com/gasin", "followers_url": "https://api.github.com/users/gasin/followers", "following_url": "https://api.github.com/users/gasin/following{/other_user}", "gists_url": "https://api.github.com/users/gasin/gists{/gist_id}", "starred_url": "https://api.github.com/users/gasin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gasin/subscriptions", "organizations_url": "https://api.github.com/users/gasin/orgs", "repos_url": "https://api.github.com/users/gasin/repos", "events_url": "https://api.github.com/users/gasin/events{/privacy}", "received_events_url": "https://api.github.com/users/gasin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/47", "html_url": "https://github.com/optuna/optuna/milestone/47", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/47/labels", "id": 8352105, "node_id": "MI_kwDOB0okGM4Af3Fp", "number": 47, "title": "v3.1.0-b0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 149, "state": "closed", "created_at": "2022-08-26T05:11:03Z", "updated_at": "2022-12-22T07:11:04Z", "due_on": null, "closed_at": "2022-12-22T07:11:04Z"}, "comments": 4, "created_at": "2022-09-01T13:10:25Z", "updated_at": "2022-09-05T00:00:34Z", "closed_at": "2022-09-05T00:00:22Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3953", "html_url": "https://github.com/optuna/optuna/pull/3953", "diff_url": "https://github.com/optuna/optuna/pull/3953.diff", "patch_url": "https://github.com/optuna/optuna/pull/3953.patch", "merged_at": "2022-09-05T00:00:22Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull request after it gets two or more approvals. To proceed to the review process by the maintainers, please make sure that the PR meets the following conditions: (1) it passes all CI checks, and (2) it is neither in the draft nor WIP state. If you wish to discuss the PR in the draft state or need any other help, please mention the Optuna development team in the PR. -->\r\n\r\n## Motivation\r\nIn some special cases, `TPESampler` did not halt.\r\nhttps://github.com/optuna/optuna/issues/3670\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\n## Description of the changes\r\n- Fix the flaw of the logic\r\n    - See https://github.com/optuna/optuna/issues/3670#issuecomment-1232963093\r\n    - The behavior changes only when `last_idx == n_below && n_below == len(indices)`\r\n        - the case which caused an infinite loop \r\n- Add tests for multi-objective cases of `_split_observation_pairs`\r\n    -  One is a base case, and the other is a corner case that had caused an infinite loop.\r\n\r\n## Check\r\nIn https://github.com/optuna/optuna/issues/3670, it is mentioned that the bug occurs when `n_startup_trials=0` or `n_startup_trials=1`.\r\nI checked the code below works successfully.\r\n```python\r\nimport optuna\r\n\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_float(\"x\", -10, 10)\r\n    y = trial.suggest_float(\"y\", -10, 10)\r\n    return x, y\r\n\r\nstudy_0 = optuna.create_study(\r\n    directions=[\"maximize\", \"maximize\"],\r\n    sampler=optuna.samplers.TPESampler(n_startup_trials=0),\r\n)\r\n    \r\nstudy_1 = optuna.create_study(\r\n    directions=[\"maximize\", \"maximize\"],\r\n    sampler=optuna.samplers.TPESampler(n_startup_trials=1),\r\n)\r\n\r\nstudy_0.optimize(objective, n_trials=10)\r\nfor trial_0 in study_0.best_trials:\r\n    print(trial_0.values)\r\n\r\nstudy_1.optimize(objective, n_trials=10)\r\nfor trial_1 in study_1.best_trials:\r\n    print(trial_1.values)\r\n```\r\n<!-- Describe the changes in this PR. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3953/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3953/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3898", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3898/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3898/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3898/events", "html_url": "https://github.com/optuna/optuna/issues/3898", "id": 1340912861, "node_id": "I_kwDOB0okGM5P7LTd", "number": 3898, "title": "trial.set_user_attr not working in callback", "user": {"login": "blazespinnaker", "id": 2188809, "node_id": "MDQ6VXNlcjIxODg4MDk=", "avatar_url": "https://avatars.githubusercontent.com/u/2188809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/blazespinnaker", "html_url": "https://github.com/blazespinnaker", "followers_url": "https://api.github.com/users/blazespinnaker/followers", "following_url": "https://api.github.com/users/blazespinnaker/following{/other_user}", "gists_url": "https://api.github.com/users/blazespinnaker/gists{/gist_id}", "starred_url": "https://api.github.com/users/blazespinnaker/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/blazespinnaker/subscriptions", "organizations_url": "https://api.github.com/users/blazespinnaker/orgs", "repos_url": "https://api.github.com/users/blazespinnaker/repos", "events_url": "https://api.github.com/users/blazespinnaker/events{/privacy}", "received_events_url": "https://api.github.com/users/blazespinnaker/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-08-16T21:43:30Z", "updated_at": "2022-08-17T15:05:07Z", "closed_at": "2022-08-17T15:05:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nWhen I call trial.set_user_attr was expecting it to set the value for the trial passed to the callback\r\n\r\n### Environment\r\n\r\n- Optuna version:2.10.1\r\n Python version:3.8.10\r\n- OS:Linux-5.4.0-122-generic-x86_64-with-glibc2.29\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\n[I 2022-08-16 21:38:02,207] Using an existing study with name 'callback_bug' instead of creating a new one.\r\n[I 2022-08-16 21:38:02,333] Trial 1 finished with value: 0.99 and parameters: {}. Best is trial 1 with value: 0.99.\r\n[I 2022-08-16 21:38:02,407] Trial 2 finished with value: 0.98 and parameters: {}. Best is trial 2 with value: 0.98.\r\n[I 2022-08-16 21:38:02,474] Trial 3 finished with value: 0.97 and parameters: {}. Best is trial 3 with value: 0.97.\r\ncallback entered\r\ncallback entered\r\ncallback entered\r\n[I 2022-08-16 21:38:02,540] Trial 4 finished with value: 0.96 and parameters: {}. Best is trial 4 with value: 0.96.\r\n[I 2022-08-16 21:38:02,603] Trial 5 finished with value: 0.95 and parameters: {}. Best is trial 5 with value: 0.95.\r\ncallback entered\r\ncallback entered\r\n\r\n```\r\n\r\n```shell\r\noptuna best-trial --storage mysql://u:p@192.168.1.86/optuna --study-name callback_bug -f yaml\r\n\r\ndatetime_complete: '2022-08-16 21:38:03'\r\ndatetime_start: '2022-08-16 21:38:03'\r\nduration: 0:00:00\r\nnumber: 5\r\nstate: COMPLETE\r\nuser_attrs:\r\n  test: val1\r\nvalue: 0.95\r\n```\r\n\r\nrepro\r\n\r\n```python\r\nstorage = optuna.storages.RDBStorage(\r\n            url='mysql://u:p@192.168.1.86/optuna',\r\n            heartbeat_interval = 360,\r\n        )\r\n\r\ndef callback_bug(study, trial):\r\n    print(\"callback entered\")\r\n    trial.set_user_attr(\"callback\", \"val1\")\r\n    \r\nbest = 1\r\ndef objective(trial):\r\n    global best\r\n    trial.set_user_attr(\"test\", \"val1\")\r\n    best = best - 0.01\r\n    return best\r\n\r\nstudy = optuna.create_study(study_name = \"callback_bug\", storage = storage, load_if_exists=True)\r\nstudy.optimize(objective, n_trials=5, callbacks=[callback_bug])\r\n```\r\n\r\n\r\n\r\n\r\n### Additional context (optional)\r\n\r\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3898/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3898/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3893", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3893/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3893/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3893/events", "html_url": "https://github.com/optuna/optuna/issues/3893", "id": 1339021931, "node_id": "I_kwDOB0okGM5Pz9pr", "number": 3893, "title": "`HyperbandPruner` might make optimisation irreproducible", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-08-15T13:41:49Z", "updated_at": "2022-08-15T18:20:48Z", "closed_at": "2022-08-15T18:20:48Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nI'm unfamiliar with `HyperbandPruner`, so I might misunderstand the behaviour. When we run the following code in `Steps to reproduce` section, we expect the optimisation results including each trial value and trial state are the same because the pruner does not have any random seed-related argument. However, I could not get the same result sometimes.\r\n\r\n\r\n### One example of output\r\n\r\n```[I 2022-08-15 22:40:29,518] A new study created in memory with name: no-name-1e2bc5cd-e7ef-4abb-880a-0f7683fb2cb5\r\n[I 2022-08-15 22:40:29,622] Trial 0 finished with value: 0.5789473684210527 and parameters: {'alpha': 0.417022004702574}. Best is trial 0 with value: 0.5789473684210527.\r\n[I 2022-08-15 22:40:29,726] Trial 1 finished with value: 0.5789473684210527 and parameters: {'alpha': 0.7203244934421581}. Best is trial 0 with value: 0.5789473684210527.\r\n[I 2022-08-15 22:40:29,857] Trial 2 finished with value: 0.7105263157894737 and parameters: {'alpha': 0.00011437481734488664}. Best is trial 2 with value: 0.7105263157894737.\r\n[I 2022-08-15 22:40:29,964] Trial 3 finished with value: 0.5789473684210527 and parameters: {'alpha': 0.30233257263183977}. Best is trial 2 with value: 0.7105263157894737.\r\n[I 2022-08-15 22:40:29,994] Trial 4 pruned.\r\n[I 2022-08-15 22:40:30,078] Trial 5 pruned.\r\n[I 2022-08-15 22:40:30,107] Trial 6 pruned.\r\n[I 2022-08-15 22:40:30,137] Trial 7 pruned.\r\n[I 2022-08-15 22:40:30,166] Trial 8 pruned.\r\n[I 2022-08-15 22:40:30,250] Trial 9 pruned.\r\n[I 2022-08-15 22:40:30,353] Trial 10 finished with value: 0.5789473684210527 and parameters: {'alpha': 0.4191945144032948}. Best is trial 2 with value: 0.7105263157894737.\r\n[I 2022-08-15 22:40:30,455] Trial 11 finished with value: 0.5789473684210527 and parameters: {'alpha': 0.6852195003967595}. Best is trial 2 with value: 0.7105263157894737.\r\n[I 2022-08-15 22:40:30,560] Trial 12 finished with value: 0.5789473684210527 and parameters: {'alpha': 0.9549862165766468}. Best is trial 2 with value: 0.7105263157894737.\r\n[I 2022-08-15 22:40:30,664] Trial 13 finished with value: 0.5789473684210527 and parameters: {'alpha': 0.6502581893618595}. Best is trial 2 with value: 0.7105263157894737.\r\n[I 2022-08-15 22:40:30,769] Trial 14 finished with value: 0.5789473684210527 and parameters: {'alpha': 0.20445224973151743}. Best is trial 2 with value: 0.7105263157894737.\r\n[I 2022-08-15 22:40:30,874] Trial 15 finished with value: 0.7105263157894737 and parameters: {'alpha': 0.013475387948539988}. Best is trial 2 with value: 0.7105263157894737.\r\n[I 2022-08-15 22:40:30,978] Trial 16 finished with value: 0.6842105263157895 and parameters: {'alpha': 0.02081449313817708}. Best is trial 2 with value: 0.7105263157894737.\r\n[I 2022-08-15 22:40:31,081] Trial 17 finished with value: 0.5789473684210527 and parameters: {'alpha': 0.8781174363909454}. Best is trial 2 with value: 0.7105263157894737.\r\n[I 2022-08-15 22:40:31,183] Trial 18 finished with value: 0.7105263157894737 and parameters: {'alpha': 0.027387593197926163}. Best is trial 2 with value: 0.7105263157894737.\r\n[I 2022-08-15 22:40:31,188] Trial 19 pruned.\r\n```\r\n\r\n### Another example\r\n\r\n```\r\n[I 2022-08-15 22:40:58,608] A new study created in memory with name: no-name-e9a15ed3-ae83-4ff8-ab70-36b7b2a23b01\r\n[I 2022-08-15 22:40:58,712] Trial 0 finished with value: 0.5789473684210527 and parameters: {'alpha': 0.417022004702574}. Best is trial 0 with value: 0.5789473684210527.\r\n[I 2022-08-15 22:40:58,814] Trial 1 finished with value: 0.5789473684210527 and parameters: {'alpha': 0.7203244934421581}. Best is trial 0 with value: 0.5789473684210527.\r\n[I 2022-08-15 22:40:58,916] Trial 2 finished with value: 0.7105263157894737 and parameters: {'alpha': 0.00011437481734488664}. Best is trial 2 with value: 0.7105263157894737.\r\n[I 2022-08-15 22:40:58,944] Trial 3 pruned.\r\n[I 2022-08-15 22:40:59,046] Trial 4 finished with value: 0.5789473684210527 and parameters: {'alpha': 0.14675589081711304}. Best is trial 2 with value: 0.7105263157894737.\r\n[I 2022-08-15 22:40:59,131] Trial 5 pruned.\r\n[I 2022-08-15 22:40:59,232] Trial 6 finished with value: 0.5789473684210527 and parameters: {'alpha': 0.1862602113776709}. Best is trial 2 with value: 0.7105263157894737.\r\n[I 2022-08-15 22:40:59,235] Trial 7 pruned.\r\n[I 2022-08-15 22:40:59,237] Trial 8 pruned.\r\n[I 2022-08-15 22:40:59,339] Trial 9 finished with value: 0.5789473684210527 and parameters: {'alpha': 0.538816734003357}. Best is trial 2 with value: 0.7105263157894737.\r\n[I 2022-08-15 22:40:59,350] Trial 10 pruned.\r\n[I 2022-08-15 22:40:59,451] Trial 11 finished with value: 0.5789473684210527 and parameters: {'alpha': 0.6852195003967595}. Best is trial 2 with value: 0.7105263157894737.\r\n[I 2022-08-15 22:40:59,462] Trial 12 pruned.\r\n[I 2022-08-15 22:40:59,564] Trial 13 finished with value: 0.5789473684210527 and parameters: {'alpha': 0.8781174363909454}. Best is trial 2 with value: 0.7105263157894737.\r\n[I 2022-08-15 22:40:59,665] Trial 14 finished with value: 0.7105263157894737 and parameters: {'alpha': 0.027387593197926163}. Best is trial 2 with value: 0.7105263157894737.\r\n[I 2022-08-15 22:40:59,694] Trial 15 pruned.\r\n[I 2022-08-15 22:40:59,723] Trial 16 pruned.\r\n[I 2022-08-15 22:40:59,753] Trial 17 pruned.\r\n[I 2022-08-15 22:40:59,839] Trial 18 pruned.\r\n[I 2022-08-15 22:40:59,941] Trial 19 finished with value: 0.5789473684210527 and parameters: {'alpha': 0.5586898284457517}. Best is trial 2 with value: 0.7105263157894737.\r\n```\r\n\r\n### Environment\r\n\r\n- Optuna version:3.0.0.dev # https://github.com/optuna/optuna/commit/75b01898376afaaac1d4d819726cad219d99f58c\r\n- Python version:3.9.12\r\n- OS:macOS-10.16-x86_64-i386-64bit\r\n- (Optional) Other libraries and their versions:\r\n  - scikit-learn: 1.1.2\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\nNA\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\n1. Run the following code multiple times with `export PYTHONHASHSEED=7; python FOLLOWING_SCRIPT.py`.\r\n\r\n```python\r\nimport numpy as np\r\nfrom sklearn.datasets import load_iris\r\nfrom sklearn.linear_model import SGDClassifier\r\nfrom sklearn.model_selection import train_test_split\r\n\r\nimport optuna\r\n\r\nX, y = load_iris(return_X_y=True)\r\nX_train, X_valid, y_train, y_valid = train_test_split(X, y, random_state=1)\r\nclasses = np.unique(y)\r\nn_train_iter = 100\r\n\r\n\r\ndef objective(trial):\r\n    alpha = trial.suggest_float(\"alpha\", 0.0, 1.0)\r\n    clf = SGDClassifier(alpha=alpha, random_state=1)\r\n\r\n    for step in range(n_train_iter):\r\n        clf.partial_fit(X_train, y_train, classes=classes)\r\n\r\n        intermediate_value = clf.score(X_valid, y_valid)\r\n        trial.report(intermediate_value, step)\r\n\r\n        if trial.should_prune():\r\n            raise optuna.TrialPruned()\r\n\r\n    return clf.score(X_valid, y_valid)\r\n\r\nstudy = optuna.create_study(\r\n    direction=\"maximize\",\r\n    pruner=optuna.pruners.HyperbandPruner(\r\n        min_resource=1, max_resource=n_train_iter, reduction_factor=3\r\n    ),\r\n    sampler=optuna.samplers.TPESampler(seed=1)\r\n)\r\nstudy.optimize(objective, n_trials=20)\r\n```\r\n\r\nThe example code is mainly based on https://optuna.readthedocs.io/en/stable/reference/generated/optuna.pruners.HyperbandPruner.html. \r\n\r\n### Additional context (optional)\r\n\r\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3893/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3893/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3889", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3889/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3889/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3889/events", "html_url": "https://github.com/optuna/optuna/issues/3889", "id": 1338013790, "node_id": "I_kwDOB0okGM5PwHhe", "number": 3889, "title": "Dynamic parameter range changes break visualizations", "user": {"login": "leo-hstone", "id": 62036826, "node_id": "MDQ6VXNlcjYyMDM2ODI2", "avatar_url": "https://avatars.githubusercontent.com/u/62036826?v=4", "gravatar_id": "", "url": "https://api.github.com/users/leo-hstone", "html_url": "https://github.com/leo-hstone", "followers_url": "https://api.github.com/users/leo-hstone/followers", "following_url": "https://api.github.com/users/leo-hstone/following{/other_user}", "gists_url": "https://api.github.com/users/leo-hstone/gists{/gist_id}", "starred_url": "https://api.github.com/users/leo-hstone/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/leo-hstone/subscriptions", "organizations_url": "https://api.github.com/users/leo-hstone/orgs", "repos_url": "https://api.github.com/users/leo-hstone/repos", "events_url": "https://api.github.com/users/leo-hstone/events{/privacy}", "received_events_url": "https://api.github.com/users/leo-hstone/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-08-13T17:23:36Z", "updated_at": "2022-08-14T14:53:38Z", "closed_at": "2022-08-14T14:53:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nI use optuna to optimize filter time constants `s` for a data preprocessing pipeline.\r\n```python\r\ns0 = trial.suggest_int(\"s0\", 1, 40000)\r\ns1 = trial.suggest_int(\"s1\", s0, 40000)\r\ns2 = trial.suggest_int(\"s2\", s1, 40000)\r\n```\r\nI know, that the optimal parameters for my sample dataset are somehow distributed like this: `[600, 7000, 20000]`. The order of the values does not matter (`[600, 7000, 20000]` produces the same score as `[7000, 600, 20000]`). Therefore I limited the search space for s1 and s2. \r\n\r\nThis does break the visualizations e.g. `plot_param_importance` shows only s0. The optuna dashboard shows a single dropdown item for every trial in the slice plot parameters. \r\n\r\nI am also wondering how the optimizer handles the dynamic distribution changes? Is it a good idea to limit the search space like this? \r\n\r\n\r\n### Environment\r\n\r\n- Optuna version: 2.10.1\r\n- Python version: 3.8.10\r\n- OS: Linux-5.4.0-122-generic-x86_64-with-glibc2.29\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n![image](https://user-images.githubusercontent.com/62036826/184504426-76f36dfe-3e94-4325-b6b0-bcb8634ff0c3.png)\r\n\r\n### Steps to reproduce\r\n\r\n1. Copy above code snippet.\r\n2. Run simple optimization on dummy function.\r\n3. Plot visualizatins / open dashboard.\r\n\r\n\r\n### Additional context (optional)\r\n\r\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3889/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3889/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3839", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3839/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3839/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3839/events", "html_url": "https://github.com/optuna/optuna/pull/3839", "id": 1323735104, "node_id": "PR_kwDOB0okGM48ZRE_", "number": 3839, "title": "Fix infeasible case in NSGAII test", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/44", "html_url": "https://github.com/optuna/optuna/milestone/44", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/44/labels", "id": 8044945, "node_id": "MI_kwDOB0okGM4AesGR", "number": 44, "title": "v3.0.0-rc0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 129, "state": "closed", "created_at": "2022-06-03T05:14:22Z", "updated_at": "2022-08-08T06:16:39Z", "due_on": null, "closed_at": "2022-08-08T06:16:39Z"}, "comments": 0, "created_at": "2022-08-01T03:03:35Z", "updated_at": "2022-08-01T04:48:15Z", "closed_at": "2022-08-01T04:42:33Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3839", "html_url": "https://github.com/optuna/optuna/pull/3839", "diff_url": "https://github.com/optuna/optuna/pull/3839.diff", "patch_url": "https://github.com/optuna/optuna/pull/3839.patch", "merged_at": "2022-08-01T04:42:33Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull request after it gets two or more approvals. To proceed to the review process by the maintainers, please make sure that the PR meets the following conditions: (1) it passes all CI checks, and (2) it is neither in the draft nor WIP state. If you wish to discuss the PR in the draft state or need any other help, please mention the Optuna development team in the PR. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\nFix CI.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\nRemove `nan` as infeasible case since nsgaii raises value error when constraint contains nan value by https://github.com/optuna/optuna/pull/3740.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3839/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3839/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3826", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3826/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3826/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3826/events", "html_url": "https://github.com/optuna/optuna/issues/3826", "id": 1321437744, "node_id": "I_kwDOB0okGM5Ow4ow", "number": 3826, "title": "TPE behaves poorly with unimportant parameters", "user": {"login": "JRice15", "id": 44716551, "node_id": "MDQ6VXNlcjQ0NzE2NTUx", "avatar_url": "https://avatars.githubusercontent.com/u/44716551?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JRice15", "html_url": "https://github.com/JRice15", "followers_url": "https://api.github.com/users/JRice15/followers", "following_url": "https://api.github.com/users/JRice15/following{/other_user}", "gists_url": "https://api.github.com/users/JRice15/gists{/gist_id}", "starred_url": "https://api.github.com/users/JRice15/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JRice15/subscriptions", "organizations_url": "https://api.github.com/users/JRice15/orgs", "repos_url": "https://api.github.com/users/JRice15/repos", "events_url": "https://api.github.com/users/JRice15/events{/privacy}", "received_events_url": "https://api.github.com/users/JRice15/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2022-07-28T20:23:33Z", "updated_at": "2022-08-04T13:18:41Z", "closed_at": "2022-08-04T13:18:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nSometimes, we users include parameters that end up not having much of an effect, either because of a bug or otherwise just an imperfect understanding of which parameters influence the optimization outcomes. I haven't diagnosed exactly why, but it seems like when a parameter results in almost zero variance in the optimization value, and that value is close to but not the best found, TPE hammers that parameter trying to better understand it, when the exact opposite should be done. \r\n\r\nI'm not sure if this is a flaw with the TPE algorithm as originally formulated, or an error in implementation.\r\n\r\n### Environment\r\n\r\n- Optuna version: 2.10.0\r\n- Python version: 3.7\r\n- OS: OS X\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\nsee steps to reproduce\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\nWe have the following program, where the output is determined by a categorical variable. If the categorical variable is 'a', the result is always 1.0. If the categorical is 'b', the result is determined by another variable, which is capable of going as low as zero. Strangely however, the TPE sampler almost exclusively tries option 'a', trying to understand the effect of the literally meaningless variable, even when a better value has already been found with option 'b'.\r\n\r\n```python\r\nimport optuna\r\n\r\ndef objective(trial):\r\n    categorical = trial.suggest_categorical(\"categorical\", [\"a\", \"b\"])\r\n    if categorical == \"a\":\r\n        trial.suggest_float(\"meaningless\", 0, 10)\r\n        return 1.0\r\n    else:\r\n        return trial.suggest_float(\"meaningful\", 0, 10)\r\n\r\nsampler = optuna.samplers.TPESampler(\r\n            # all the bells and whistles\r\n            multivariate=True,\r\n            group=True,\r\n            constant_liar=True,\r\n            warn_independent_sampling=True,\r\n            n_startup_trials=25,\r\n            seed=0) # works with other seeds as well\r\nstudy = optuna.create_study(\r\n            study_name=\"test\", \r\n            sampler=sampler,\r\n            direction=\"minimize\")\r\n\r\nstudy.optimize(objective, n_trials=80)\r\n```\r\n\r\nOutput:\r\n```\r\n/Users/user1/anaconda3/envs/tf2.2.2/lib/python3.7/site-packages/optuna/samplers/_tpe/sampler.py:266: ExperimentalWarning: ``multivariate`` option is an experimental feature. The interface can change in the future.\r\n  ExperimentalWarning,\r\n/Users/user1/anaconda3/envs/tf2.2.2/lib/python3.7/site-packages/optuna/samplers/_tpe/sampler.py:277: ExperimentalWarning: ``group`` option is an experimental feature. The interface can change in the future.\r\n  ExperimentalWarning,\r\n/Users/user1/anaconda3/envs/tf2.2.2/lib/python3.7/site-packages/optuna/samplers/_tpe/sampler.py:285: ExperimentalWarning: ``constant_liar`` option is an experimental feature. The interface can change in the future.\r\n  ExperimentalWarning,\r\n[I 2022-07-28 13:14:39,591] A new study created in memory with name: test\r\n[I 2022-07-28 13:14:39,593] Trial 0 finished with value: 6.027633760716439 and parameters: {'categorical': 'b', 'meaningful': 6.027633760716439}. Best is trial 0 with value: 6.027633760716439.\r\n[I 2022-07-28 13:14:39,593] Trial 1 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 6.458941130666561}. Best is trial 1 with value: 1.0.\r\n[I 2022-07-28 13:14:39,594] Trial 2 finished with value: 9.636627605010293 and parameters: {'categorical': 'b', 'meaningful': 9.636627605010293}. Best is trial 1 with value: 1.0.\r\n[I 2022-07-28 13:14:39,595] Trial 3 finished with value: 5.288949197529044 and parameters: {'categorical': 'b', 'meaningful': 5.288949197529044}. Best is trial 1 with value: 1.0.\r\n[I 2022-07-28 13:14:39,596] Trial 4 finished with value: 0.7103605819788694 and parameters: {'categorical': 'b', 'meaningful': 0.7103605819788694}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,596] Trial 5 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 8.32619845547938}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,597] Trial 6 finished with value: 9.78618342232764 and parameters: {'categorical': 'b', 'meaningful': 9.78618342232764}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,598] Trial 7 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 7.805291762864554}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,599] Trial 8 finished with value: 1.433532874090464 and parameters: {'categorical': 'b', 'meaningful': 1.433532874090464}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,599] Trial 9 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 4.146619399905235}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,600] Trial 10 finished with value: 4.5615033221654855 and parameters: {'categorical': 'b', 'meaningful': 4.5615033221654855}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,601] Trial 11 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 6.176354970758771}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,602] Trial 12 finished with value: 9.437480785146242 and parameters: {'categorical': 'b', 'meaningful': 9.437480785146242}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,603] Trial 13 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 4.3703195379934145}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,604] Trial 14 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 6.667667154456677}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,605] Trial 15 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 1.289262976548533}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,606] Trial 16 finished with value: 5.701967704178797 and parameters: {'categorical': 'b', 'meaningful': 5.701967704178797}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,607] Trial 17 finished with value: 1.0204481074802807 and parameters: {'categorical': 'b', 'meaningful': 1.0204481074802807}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,608] Trial 18 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 6.531083254653984}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,609] Trial 19 finished with value: 2.4442559200160274 and parameters: {'categorical': 'b', 'meaningful': 2.4442559200160274}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,610] Trial 20 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 6.563295894652734}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,611] Trial 21 finished with value: 3.687251706609641 and parameters: {'categorical': 'b', 'meaningful': 3.687251706609641}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,612] Trial 22 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 8.379449074988038}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,613] Trial 23 finished with value: 4.686512016477016 and parameters: {'categorical': 'b', 'meaningful': 4.686512016477016}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,614] Trial 24 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 7.3926357939830165}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,616] Trial 25 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 0.39187792254320675}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,617] Trial 26 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 2.828069625764096}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,619] Trial 27 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 1.201965612131689}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,620] Trial 28 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 2.9614019752214493}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,622] Trial 29 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 1.1872771895424405}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,623] Trial 30 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 3.1798317939397602}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,625] Trial 31 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 4.1426299451467}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,626] Trial 32 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 0.6414749634878436}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,628] Trial 33 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 6.924721193700199}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,630] Trial 34 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 5.666014542065751}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,631] Trial 35 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 2.653894909394454}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,633] Trial 36 finished with value: 5.232480534666997 and parameters: {'categorical': 'b', 'meaningful': 5.232480534666997}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,635] Trial 37 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 0.9394051075844168}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,636] Trial 38 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 5.759464955561793}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,641] Trial 39 finished with value: 9.292961975762141 and parameters: {'categorical': 'b', 'meaningful': 9.292961975762141}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,645] Trial 40 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 4.922549503338771}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,649] Trial 41 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 2.7300104566734174}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,655] Trial 42 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 9.667779463359969}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,659] Trial 43 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 4.85837228775922}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,664] Trial 44 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 4.497293547877376}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,668] Trial 45 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 9.80995550504452}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,673] Trial 46 finished with value: 3.1856895245132364 and parameters: {'categorical': 'b', 'meaningful': 3.1856895245132364}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,677] Trial 47 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 9.957107806571543}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,682] Trial 48 finished with value: 6.674103799636817 and parameters: {'categorical': 'b', 'meaningful': 6.674103799636817}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,686] Trial 49 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 9.866284828463154}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,691] Trial 50 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 5.024086481093759}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,695] Trial 51 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 9.353411469672436}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,700] Trial 52 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 7.025558455910295}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,704] Trial 53 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 6.983568953259951}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,710] Trial 54 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 6.269484112376494}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,715] Trial 55 finished with value: 1.3179786240439217 and parameters: {'categorical': 'b', 'meaningful': 1.3179786240439217}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,720] Trial 56 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 1.8041486909115858}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,725] Trial 57 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 0.08481192453090824}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,730] Trial 58 finished with value: 7.163272041185655 and parameters: {'categorical': 'b', 'meaningful': 7.163272041185655}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,734] Trial 59 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 2.4357345035596545}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,740] Trial 60 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 5.285850226834317}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,745] Trial 61 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 5.126006649457351}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,750] Trial 62 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 5.202695974218527}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,754] Trial 63 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 8.379042154276384}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,759] Trial 64 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 7.854596872852464}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,764] Trial 65 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 4.070626541647012}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,769] Trial 66 finished with value: 2.894060929472011 and parameters: {'categorical': 'b', 'meaningful': 2.894060929472011}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,774] Trial 67 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 4.168172027317949}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,778] Trial 68 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 4.008800085777913}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,783] Trial 69 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 3.658289674872498}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,788] Trial 70 finished with value: 1.8319136200711683 and parameters: {'categorical': 'b', 'meaningful': 1.8319136200711683}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,792] Trial 71 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 9.883078207631003}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,797] Trial 72 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 9.470723833706442}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,802] Trial 73 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 9.97473957415694}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,807] Trial 74 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 9.682456846802829}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,812] Trial 75 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 9.916316991271628}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,817] Trial 76 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 9.967274514112146}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,824] Trial 77 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 8.3469524087717}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,830] Trial 78 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 8.559788211263891}. Best is trial 4 with value: 0.7103605819788694.\r\n[I 2022-07-28 13:14:39,835] Trial 79 finished with value: 1.0 and parameters: {'categorical': 'a', 'meaningless': 7.496424499017911}. Best is trial 4 with value: 0.7103605819788694.\r\n```\r\n\r\n### Additional context (optional)\r\n\r\nI have tried a couple variations on the above example. Adding slight random noise to the 1.0 result, to give it a bit of variance, doesn't change much. Even if you remove the meaningless variable, it still tries 'a' much more than 'b', which could be a related issue or its own issue.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3826/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3826/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3819", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3819/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3819/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3819/events", "html_url": "https://github.com/optuna/optuna/pull/3819", "id": 1319378153, "node_id": "PR_kwDOB0okGM48K9VH", "number": 3819, "title": "Fix `Study.tell` with invalid values", "user": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, {"login": "knshnb", "id": 23695091, "node_id": "MDQ6VXNlcjIzNjk1MDkx", "avatar_url": "https://avatars.githubusercontent.com/u/23695091?v=4", "gravatar_id": "", "url": "https://api.github.com/users/knshnb", "html_url": "https://github.com/knshnb", "followers_url": "https://api.github.com/users/knshnb/followers", "following_url": "https://api.github.com/users/knshnb/following{/other_user}", "gists_url": "https://api.github.com/users/knshnb/gists{/gist_id}", "starred_url": "https://api.github.com/users/knshnb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/knshnb/subscriptions", "organizations_url": "https://api.github.com/users/knshnb/orgs", "repos_url": "https://api.github.com/users/knshnb/repos", "events_url": "https://api.github.com/users/knshnb/events{/privacy}", "received_events_url": "https://api.github.com/users/knshnb/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/44", "html_url": "https://github.com/optuna/optuna/milestone/44", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/44/labels", "id": 8044945, "node_id": "MI_kwDOB0okGM4AesGR", "number": 44, "title": "v3.0.0-rc0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 129, "state": "closed", "created_at": "2022-06-03T05:14:22Z", "updated_at": "2022-08-08T06:16:39Z", "due_on": null, "closed_at": "2022-08-08T06:16:39Z"}, "comments": 2, "created_at": "2022-07-27T10:52:14Z", "updated_at": "2022-07-29T04:13:29Z", "closed_at": "2022-07-29T04:13:18Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3819", "html_url": "https://github.com/optuna/optuna/pull/3819", "diff_url": "https://github.com/optuna/optuna/pull/3819.diff", "patch_url": "https://github.com/optuna/optuna/pull/3819.patch", "merged_at": "2022-07-29T04:13:18Z"}, "body": "## Motivation\r\nFix unexpected behavior of `Study.tell` with invalid values and `state=TrialState.COMPLETE`.\r\n\r\n```python\r\nimport optuna\r\nfrom optuna.trial import TrialState\r\n\r\nstudy = optuna.create_study()\r\n\r\ntrial = study.ask()\r\nstudy.tell(trial, values=\"invalid\", state=TrialState.COMPLETE)\r\nprint(study.trials[-1].state, study.trials[-1].value)\r\n```\r\n\r\n* master\r\n```\r\nTrialState.COMPLETE None\r\n```\r\n\r\n* PR\r\n```\r\nValueError: The number of the values 7 did not match the number of the objectives 1.\r\n```\r\n\r\n## Description of the changes\r\nFix `Study.tell` and add tests.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3819/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3819/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3814", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3814/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3814/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3814/events", "html_url": "https://github.com/optuna/optuna/pull/3814", "id": 1318899352, "node_id": "PR_kwDOB0okGM48JYHB", "number": 3814, "title": "Raise `ValueError` when waiting trial is told", "user": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "knshnb", "id": 23695091, "node_id": "MDQ6VXNlcjIzNjk1MDkx", "avatar_url": "https://avatars.githubusercontent.com/u/23695091?v=4", "gravatar_id": "", "url": "https://api.github.com/users/knshnb", "html_url": "https://github.com/knshnb", "followers_url": "https://api.github.com/users/knshnb/followers", "following_url": "https://api.github.com/users/knshnb/following{/other_user}", "gists_url": "https://api.github.com/users/knshnb/gists{/gist_id}", "starred_url": "https://api.github.com/users/knshnb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/knshnb/subscriptions", "organizations_url": "https://api.github.com/users/knshnb/orgs", "repos_url": "https://api.github.com/users/knshnb/repos", "events_url": "https://api.github.com/users/knshnb/events{/privacy}", "received_events_url": "https://api.github.com/users/knshnb/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "knshnb", "id": 23695091, "node_id": "MDQ6VXNlcjIzNjk1MDkx", "avatar_url": "https://avatars.githubusercontent.com/u/23695091?v=4", "gravatar_id": "", "url": "https://api.github.com/users/knshnb", "html_url": "https://github.com/knshnb", "followers_url": "https://api.github.com/users/knshnb/followers", "following_url": "https://api.github.com/users/knshnb/following{/other_user}", "gists_url": "https://api.github.com/users/knshnb/gists{/gist_id}", "starred_url": "https://api.github.com/users/knshnb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/knshnb/subscriptions", "organizations_url": "https://api.github.com/users/knshnb/orgs", "repos_url": "https://api.github.com/users/knshnb/repos", "events_url": "https://api.github.com/users/knshnb/events{/privacy}", "received_events_url": "https://api.github.com/users/knshnb/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/44", "html_url": "https://github.com/optuna/optuna/milestone/44", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/44/labels", "id": 8044945, "node_id": "MI_kwDOB0okGM4AesGR", "number": 44, "title": "v3.0.0-rc0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 129, "state": "closed", "created_at": "2022-06-03T05:14:22Z", "updated_at": "2022-08-08T06:16:39Z", "due_on": null, "closed_at": "2022-08-08T06:16:39Z"}, "comments": 3, "created_at": "2022-07-27T01:02:21Z", "updated_at": "2022-07-29T06:34:56Z", "closed_at": "2022-07-29T06:32:22Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3814", "html_url": "https://github.com/optuna/optuna/pull/3814", "diff_url": "https://github.com/optuna/optuna/pull/3814.diff", "patch_url": "https://github.com/optuna/optuna/pull/3814.patch", "merged_at": "2022-07-29T06:32:22Z"}, "body": "## Motivation\r\nThe told trial should be `RUNNING`, not `WAITING`.\r\n\r\n## Description of the changes\r\nFix `_tell_with_warning` and add a test.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3814/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3814/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3808", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3808/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3808/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3808/events", "html_url": "https://github.com/optuna/optuna/pull/3808", "id": 1317697229, "node_id": "PR_kwDOB0okGM48FZ9v", "number": 3808, "title": "Fix check for number of objective values", "user": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "keisuke-umezawa", "id": 1277089, "node_id": "MDQ6VXNlcjEyNzcwODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1277089?v=4", "gravatar_id": "", "url": "https://api.github.com/users/keisuke-umezawa", "html_url": "https://github.com/keisuke-umezawa", "followers_url": "https://api.github.com/users/keisuke-umezawa/followers", "following_url": "https://api.github.com/users/keisuke-umezawa/following{/other_user}", "gists_url": "https://api.github.com/users/keisuke-umezawa/gists{/gist_id}", "starred_url": "https://api.github.com/users/keisuke-umezawa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/keisuke-umezawa/subscriptions", "organizations_url": "https://api.github.com/users/keisuke-umezawa/orgs", "repos_url": "https://api.github.com/users/keisuke-umezawa/repos", "events_url": "https://api.github.com/users/keisuke-umezawa/events{/privacy}", "received_events_url": "https://api.github.com/users/keisuke-umezawa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "keisuke-umezawa", "id": 1277089, "node_id": "MDQ6VXNlcjEyNzcwODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1277089?v=4", "gravatar_id": "", "url": "https://api.github.com/users/keisuke-umezawa", "html_url": "https://github.com/keisuke-umezawa", "followers_url": "https://api.github.com/users/keisuke-umezawa/followers", "following_url": "https://api.github.com/users/keisuke-umezawa/following{/other_user}", "gists_url": "https://api.github.com/users/keisuke-umezawa/gists{/gist_id}", "starred_url": "https://api.github.com/users/keisuke-umezawa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/keisuke-umezawa/subscriptions", "organizations_url": "https://api.github.com/users/keisuke-umezawa/orgs", "repos_url": "https://api.github.com/users/keisuke-umezawa/repos", "events_url": "https://api.github.com/users/keisuke-umezawa/events{/privacy}", "received_events_url": "https://api.github.com/users/keisuke-umezawa/received_events", "type": "User", "site_admin": false}, {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/44", "html_url": "https://github.com/optuna/optuna/milestone/44", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/44/labels", "id": 8044945, "node_id": "MI_kwDOB0okGM4AesGR", "number": 44, "title": "v3.0.0-rc0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 129, "state": "closed", "created_at": "2022-06-03T05:14:22Z", "updated_at": "2022-08-08T06:16:39Z", "due_on": null, "closed_at": "2022-08-08T06:16:39Z"}, "comments": 1, "created_at": "2022-07-26T04:56:58Z", "updated_at": "2022-08-02T02:09:16Z", "closed_at": "2022-08-01T02:08:01Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3808", "html_url": "https://github.com/optuna/optuna/pull/3808", "diff_url": "https://github.com/optuna/optuna/pull/3808.diff", "patch_url": "https://github.com/optuna/optuna/pull/3808.patch", "merged_at": "2022-08-01T02:08:01Z"}, "body": "## Motivation\r\nThe master's implementation incorrectly accepts single objective value for multi-objective optimization.\r\n\r\n## Description of the changes\r\nFix `_check_and_convert_to_values` and add a test.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3808/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3808/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3802", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3802/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3802/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3802/events", "html_url": "https://github.com/optuna/optuna/pull/3802", "id": 1312214287, "node_id": "PR_kwDOB0okGM47zCeP", "number": 3802, "title": "Change warning for `axis_order` of `plot_pareto_front`", "user": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/44", "html_url": "https://github.com/optuna/optuna/milestone/44", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/44/labels", "id": 8044945, "node_id": "MI_kwDOB0okGM4AesGR", "number": 44, "title": "v3.0.0-rc0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 129, "state": "closed", "created_at": "2022-06-03T05:14:22Z", "updated_at": "2022-08-08T06:16:39Z", "due_on": null, "closed_at": "2022-08-08T06:16:39Z"}, "comments": 2, "created_at": "2022-07-21T00:47:34Z", "updated_at": "2022-07-21T22:36:14Z", "closed_at": "2022-07-21T03:39:38Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3802", "html_url": "https://github.com/optuna/optuna/pull/3802", "diff_url": "https://github.com/optuna/optuna/pull/3802.diff", "patch_url": "https://github.com/optuna/optuna/pull/3802.patch", "merged_at": "2022-07-21T03:39:38Z"}, "body": "## Motivation\r\n`axis_order` of `plot_pareto_front` raises `DeprecationWarning`, but it is for developers and not for users. For example, the following code does not show any warnings.\r\n\r\n```python\r\nimport optuna\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_float(\"x\", 0, 5)\r\n    y = trial.suggest_float(\"y\", 0, 3)\r\n\r\n    v0 = 4 * x ** 2 + 4 * y ** 2\r\n    v1 = (x - 5) ** 2 + (y - 5) ** 2\r\n    return v0, v1\r\n\r\nstudy = optuna.create_study(directions=[\"minimize\", \"minimize\"])\r\nstudy.optimize(objective, n_trials=50)\r\n\r\nfig = optuna.visualization.plot_pareto_front(study, axis_order=[0, 1])\r\nfig.show()\r\n```\r\n\r\n## Description of the changes\r\nUse `FutureWarning` instead of `DeprecationWarning`.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3802/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3802/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3790", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3790/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3790/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3790/events", "html_url": "https://github.com/optuna/optuna/issues/3790", "id": 1305136180, "node_id": "I_kwDOB0okGM5Nysw0", "number": 3790, "title": "Same result in parallel nodes", "user": {"login": "ooghry", "id": 200244, "node_id": "MDQ6VXNlcjIwMDI0NA==", "avatar_url": "https://avatars.githubusercontent.com/u/200244?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ooghry", "html_url": "https://github.com/ooghry", "followers_url": "https://api.github.com/users/ooghry/followers", "following_url": "https://api.github.com/users/ooghry/following{/other_user}", "gists_url": "https://api.github.com/users/ooghry/gists{/gist_id}", "starred_url": "https://api.github.com/users/ooghry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ooghry/subscriptions", "organizations_url": "https://api.github.com/users/ooghry/orgs", "repos_url": "https://api.github.com/users/ooghry/repos", "events_url": "https://api.github.com/users/ooghry/events{/privacy}", "received_events_url": "https://api.github.com/users/ooghry/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-07-14T18:15:08Z", "updated_at": "2022-07-16T14:48:51Z", "closed_at": "2022-07-16T14:48:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nI'm using optuna with XGBoost on two different Google Colab that connect to the same MySql server, and I expect every node to calculate different trail steps. But they show the same result. I mean, I'm using `early_stopping_rounds=50`, two nodes show the same result for the 50 calculations.\r\n\r\n### Environment\r\n\r\n- Optuna version: 2.10.1\r\n- Python version: 3.7\r\n- OS: Google Colab\r\n- (Optional) Other libraries and their versions: XGBoost: 1.6.1", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3790/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3790/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3783", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3783/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3783/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3783/events", "html_url": "https://github.com/optuna/optuna/issues/3783", "id": 1301878412, "node_id": "I_kwDOB0okGM5NmRaM", "number": 3783, "title": "PyTorchLightningPruningCallback: the stopping method crashes the training.", "user": {"login": "FrankwaP", "id": 45900621, "node_id": "MDQ6VXNlcjQ1OTAwNjIx", "avatar_url": "https://avatars.githubusercontent.com/u/45900621?v=4", "gravatar_id": "", "url": "https://api.github.com/users/FrankwaP", "html_url": "https://github.com/FrankwaP", "followers_url": "https://api.github.com/users/FrankwaP/followers", "following_url": "https://api.github.com/users/FrankwaP/following{/other_user}", "gists_url": "https://api.github.com/users/FrankwaP/gists{/gist_id}", "starred_url": "https://api.github.com/users/FrankwaP/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/FrankwaP/subscriptions", "organizations_url": "https://api.github.com/users/FrankwaP/orgs", "repos_url": "https://api.github.com/users/FrankwaP/repos", "events_url": "https://api.github.com/users/FrankwaP/events{/privacy}", "received_events_url": "https://api.github.com/users/FrankwaP/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-07-12T10:44:33Z", "updated_at": "2022-07-13T08:16:46Z", "closed_at": "2022-07-13T08:16:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nNote that I'm working with version 2.10.1, but a quick copy/paste from the present version shows that it behaves the same.   \r\nIn each version PyTorchLightningPruningCallback stops the trial by calling `raise optuna.TrialPruned(message)`.   \r\nThis abrupt way of closing causes problem with (Pytorch) multiprocessing dataloader as well as the progress bars.   \r\n\r\n\r\nThe following is the log of a test script that I did. I have posted it in the \"step to reproduce\" filed, but just know that the \"THIS PRINT COMMAND\" message is written in the objective function, after the `trainer.fit`.\r\nWe  can see that:  \r\n1. the pruning crashes the objective function, since we do not see the print message for the pruned trial  \r\n2. that an \"AssertionError: can only test a child process\" error (ignored) is raised by Pytorch's dataloader.py calling   multiprocessing.py  \r\n3. the progress bars from old trials last epochs keep printing in newer trial (v_num=1 and v_num=2 printed within v_num=3)  \r\n\r\n>  \r\n> [I 2022-07-12 12:05:23,993] A new study created in RDB with name: test\r\n> GPU available: True, used: True\r\n> TPU available: False, using: 0 TPU cores\r\n> IPU available: False, using: 0 IPUs\r\n> HPU available: False, using: 0 HPUs\r\n> `Trainer(limit_train_batches=1)` was configured so 1 batch per epoch will be used.\r\n> `Trainer(limit_val_batches=1)` was configured so 1 batch will be used.\r\n> `Trainer(limit_test_batches=1)` was configured so 1 batch will be used.\r\n> Missing logger folder: /home/francois/Documents/dev-mediamap/semi_supervision_training/sewerml/lightning_logs\r\n> LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]\r\n> Epoch 4: 100%|\u2588\u2588\u2588\u2588\u2588| 2/2 [00:00<00:00,  7.49it/s, loss=-48.4, v_num=0]\r\n> ********************                                                                                                                                                                                                                  \r\n> ********************\r\n> THIS PRINT COMMAND WILL WORK ONLY WHEN NOT PRUNED!\r\n> \u2026 AND IT'S THE SAME FOR THE FOLLOWING RETURN COMMAND!\r\n> ********************\r\n> ********************\r\n> [I 2022-07-12 12:05:29,564] Trial 0 finished with value: 5.491324424743652 and parameters: {'test': 0.7352707958289257}. Best is trial 0 with value: 5.491324424743652.\r\n> GPU available: True, used: True\r\n> TPU available: False, using: 0 TPU cores\r\n> IPU available: False, using: 0 IPUs\r\n> HPU available: False, using: 0 HPUs\r\n> `Trainer(limit_train_batches=1)` was configured so 1 batch per epoch will be used.\r\n> `Trainer(limit_val_batches=1)` was configured so 1 batch will be used.\r\n> `Trainer(limit_test_batches=1)` was configured so 1 batch will be used.\r\n> LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]\r\n> Epoch 0: 100%|\u2588\u2588\u2588\u2588\u2588| 2/2 [00:00<00:00,  8.94it/s, loss=-0.715, v_num=1][I 2022-07-12 12:05:31,888] Trial 1 pruned. Trial was pruned at epoch 0.\u2588\u2588\u2588\u2588\u2588| 1/1 [00:00<00:00, 441.65it/s]\r\n> GPU available: True, used: True\r\n> TPU available: False, using: 0 TPU cores\r\n> IPU available: False, using: 0 IPUs\r\n> HPU available: False, using: 0 HPUs\r\n> `Trainer(limit_train_batches=1)` was configured so 1 batch per epoch will be used.\r\n> `Trainer(limit_val_batches=1)` was configured so 1 batch will be used.\r\n> `Trainer(limit_test_batches=1)` was configured so 1 batch will be used.\r\n> LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]\r\n> Epoch 0: 100%|\u2588\u2588\u2588\u2588\u2588| 2/2 [00:00<00:00, 10.95it/s, loss=0.221, v_num=2][I 2022-07-12 12:05:34,164] Trial 2 pruned. Trial was pruned at epoch 0.\u2588\u2588\u2588\u2588\u2588| 1/1 [00:00<00:00, 384.20it/s]\r\n> GPU available: True, used: True\r\n> TPU available: False, using: 0 TPU cores\r\n> IPU available: False, using: 0 IPUs\r\n> HPU available: False, using: 0 HPUs\r\n> `Trainer(limit_train_batches=1)` was configured so 1 batch per epoch will be used.\r\n> `Trainer(limit_val_batches=1)` was configured so 1 batch will be used.\r\n> `Trainer(limit_test_batches=1)` was configured so 1 batch will be used.\r\n> LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]\r\n> Epoch 0: 100%|\u2588\u2588\u2588\u2588\u2588| 2/2 [00:00<00:00, 10.11it/s, loss=-0.291, v_num=3][I 2022-07-12 12:05:36,490] Trial 3 pruned. Trial was pruned at epoch 0.\u2588\u2588\u2588\u2588\u2588| 1/1 [00:00<00:00, 440.25it/s]\r\n> GPU available: True, used: True\r\n> TPU available: False, using: 0 TPU cores\r\n> IPU available: False, using: 0 IPUs\r\n> HPU available: False, using: 0 HPUs\r\n> `Trainer(limit_train_batches=1)` was configured so 1 batch per epoch will be used.\r\n> `Trainer(limit_val_batches=1)` was configured so 1 batch will be used.\r\n> `Trainer(limit_test_batches=1)` was configured so 1 batch will be used.\r\n> LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]\r\n> Epoch 0:   0%|                                                                                                                                                                                                         | 0/2 [00:00<?, ?it/s]Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x7f186e3a3e50>\r\n> Traceback (most recent call last):\r\n>   File \"/home/francois/mambaforge/envs/pytorch/lib/python3.9/site-packages/torch/utils/data/dataloader.py\", line 1358, in __del__\r\n>     self._shutdown_workers()\r\n>   File \"/home/francois/mambaforge/envs/pytorch/lib/python3.9/site-packages/torch/utils/data/dataloader.py\", line 1341, in _shutdown_workers\r\n>     if w.is_alive():\r\n>   File \"/home/francois/mambaforge/envs/pytorch/lib/python3.9/multiprocessing/process.py\", line 160, in is_alive\r\n>     assert self._parent_pid == os.getpid(), 'can only test a child process'\r\n> **AssertionError: can only test a child process**\r\n> Epoch 0: 100%|\u2588\u2588\u2588\u2588\u2588| 2/2 [00:07<00:00,  3.53s/it, loss=-0.715, v_num=1]\r\n>                                                                                                                                                                                                                                             Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x7f186e3a3e50>                                                                                                                                                     \r\n> Traceback (most recent call last):\r\n>   File \"/home/francois/mambaforge/envs/pytorch/lib/python3.9/site-packages/torch/utils/data/dataloader.py\", line 1358, in __del__\r\n>     self._shutdown_workers()\r\n>   File \"/home/francois/mambaforge/envs/pytorch/lib/python3.9/site-packages/torch/utils/data/dataloader.py\", line 1341, in _shutdown_workers\r\n>     if w.is_alive():\r\n>   File \"/home/francois/mambaforge/envs/pytorch/lib/python3.9/multiprocessing/process.py\", line 160, in is_alive\r\n>     assert self._parent_pid == os.getpid(), 'can only test a child process'\r\n> **AssertionError: can only test a child process**\r\n> Epoch 0: 100%|\u2588\u2588\u2588\u2588\u2588| 2/2 [00:04<00:00,  2.38s/it, loss=0.221, v_num=2]\r\n>                                                                                                                                                                                                                                             Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x7f186e3a3e50>                                                                                                                                                     \r\n> Traceback (most recent call last):\r\n>   File \"/home/francois/mambaforge/envs/pytorch/lib/python3.9/site-packages/torch/utils/data/dataloader.py\", line 1358, in __del__\r\n>     self._shutdown_workers()\r\n>   File \"/home/francois/mambaforge/envs/pytorch/lib/python3.9/site-packages/torch/utils/data/dataloader.py\", line 1341, in _shutdown_workers\r\n>     if w.is_alive():\r\n>   File \"/home/francois/mambaforge/envs/pytorch/lib/python3.9/multiprocessing/process.py\", line 160, in is_alive\r\n>     assert self._parent_pid == os.getpid(), 'can only test a child process'\r\n> **AssertionError: can only test a child process**\r\n> Epoch 0: 100%|\u2588\u2588\u2588\u2588\u2588| 2/2 [00:02<00:00,  1.23s/it, loss=-0.291, v_num=3]\r\n> Epoch 0: 100%|\u2588\u2588\u2588\u2588\u2588| 2/2 [00:07<00:00,  3.57s/it, loss=-0.715, v_num=1]\r\n> Epoch 0: 100%|\u2588\u2588\u2588\u2588\u2588| 2/2 [00:04<00:00,  2.42s/it, loss=0.221, v_num=2]\r\n> Epoch 0: 100%|\u2588\u2588\u2588\u2588\u2588| 2/2 [00:02<00:00,  1.26s/it, loss=-0.291, v_num=3]\r\n>                                                                                                                                                                                                                                             Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x7f186e3a3e50>                                                                                                                                                     \r\n> Traceback (most recent call last):\r\n>   File \"/home/francois/mambaforge/envs/pytorch/lib/python3.9/site-packages/torch/utils/data/dataloader.py\", line 1358, in __del__\r\n>     self._shutdown_workers()\r\n>   File \"/home/francois/mambaforge/envs/pytorch/lib/python3.9/site-packages/torch/utils/data/dataloader.py\", line 1341, in _shutdown_workers\r\n>     if w.is_alive():\r\n>   File \"/home/francois/mambaforge/envs/pytorch/lib/python3.9/multiprocessing/process.py\", line 160, in is_alive\r\n>     assert self._parent_pid == os.getpid(), 'can only test a child process'\r\n> **AssertionError: can only test a child process**\r\n> Epoch 0: 100%|\u2588\u2588\u2588\u2588\u2588| 2/2 [00:07<00:00,  3.58s/it, loss=-0.715, v_num=1]\r\n>                                                                                                                                                                                                                                             Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x7f186e3a3e50>                                                                                                                                                     \r\n> Traceback (most recent call last):\r\n>   File \"/home/francois/mambaforge/envs/pytorch/lib/python3.9/site-packages/torch/utils/data/dataloader.py\", line 1358, in __del__\r\n>     self._shutdown_workers()\r\n>   File \"/home/francois/mambaforge/envs/pytorch/lib/python3.9/site-packages/torch/utils/data/dataloader.py\", line 1341, in _shutdown_workers\r\n>     if w.is_alive():\r\n>   File \"/home/francois/mambaforge/envs/pytorch/lib/python3.9/multiprocessing/process.py\", line 160, in is_alive\r\n>     assert self._parent_pid == os.getpid(), 'can only test a child process'\r\n> **AssertionError: can only test a child process**\r\n> Epoch 0: 100%|\u2588\u2588\u2588\u2588\u2588| 2/2 [00:04<00:00,  2.42s/it, loss=0.221, v_num=2]\r\n> Epoch 0:  50%|\u2588\u2588\u2588\u2588\u2588\u258c                                                                                     | 1/2 [00:00<00:00,  5.03it/s, loss=-0.911, v_num=4]Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x7f186e3a3e50>                                                                                                                                                    \r\n> Traceback (most recent call last):\r\n>   File \"/home/francois/mambaforge/envs/pytorch/lib/python3.9/site-packages/torch/utils/data/dataloader.py\", line 1358, in __del__\r\n>     self._shutdown_workers()\r\n>   File \"/home/francois/mambaforge/envs/pytorch/lib/python3.9/site-packages/torch/utils/data/dataloader.py\", line 1341, in _shutdown_workers\r\n>     if w.is_alive():\r\n>   File \"/home/francois/mambaforge/envs/pytorch/lib/python3.9/multiprocessing/process.py\", line 160, in is_alive\r\n>     assert self._parent_pid == os.getpid(), 'can only test a child process'\r\n> **AssertionError: can only test a child process**\r\n> Epoch 0: 100%|\u2588\u2588\u2588\u2588\u2588| 2/2 [00:02<00:00,  1.27s/it, loss=-0.291, v_num=3]\r\n> Epoch 0: 100%|\u2588\u2588\u2588\u2588\u2588| 2/2 [00:00<00:00,  6.87it/s, loss=-0.911, v_num=4][I 2022-07-12 12:05:38,931] Trial 4 pruned. Trial was pruned at epoch 0.\u2588\u2588\u2588\u2588\u2588| 1/1 [00:00<00:00, 358.52it/s]\r\n> Epoch 0: 100%|\u2588\u2588\u2588\u2588\u2588| 2/2 [00:00<00:00,  4.48it/s, loss=-0.911, v_num=4]\r\n\r\n\r\nI found the `trainer.should_stop = True` command by looking at the code of Pytorch Lightning's EarlyStopping (which I also use).  \r\nI noticed you've introduced it in the last version of PyTorchLightningPruningCallback\u2026 but somehow there's still a `raise optuna.TrialPruned(message)`.   \r\nSimply replacing the `raise optuna.TrialPruned(message)` by `trainer.should_stop = True` seems to work but I have not figured out how to print `message` to the log.\n\n### Environment\n\n- Optuna version:2.10.1\r\n- Python version:3.9.13\r\n- OS:Linux-5.15.0-40-generic-x86_64-with-glibc2.35\r\n- (Optional) Other libraries and their versions:\r\n - Pytorch version: 1.11.0\r\n - Pytorch Lightning version: 1.6.4\n\n### Error messages, stack traces, or logs\n\n```shell\n> Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x7f186e3a3e50>                                                                                                                                                     \r\n> Traceback (most recent call last):\r\n>   File \"/home/francois/mambaforge/envs/pytorch/lib/python3.9/site-packages/torch/utils/data/dataloader.py\", line 1358, in __del__\r\n>     self._shutdown_workers()\r\n>   File \"/home/francois/mambaforge/envs/pytorch/lib/python3.9/site-packages/torch/utils/data/dataloader.py\", line 1341, in _shutdown_workers\r\n>     if w.is_alive():\r\n>   File \"/home/francois/mambaforge/envs/pytorch/lib/python3.9/multiprocessing/process.py\", line 160, in is_alive\r\n>     assert self._parent_pid == os.getpid(), 'can only test a child process'\r\n> AssertionError: can only test a child process\r\n\r\n\r\nBonus (for people using the search function): there's also a multiprocessing error on Windows but the log is different:\r\n> [W 2022-07-12 12:11:35,705] Trial 0 failed because of the following error: RuntimeError('DataLoader worker (pid(s) 2204) exited unexpectedly')\r\n> Traceback (most recent call last):\r\n>   File \"C:\\Users\\Nathan\\miniconda3\\envs\\rust_sementic_seg\\lib\\site-packages\\torch\\utils\\data\\dataloader.py\", line 1134, in _try_get_data\r\n>     data = self._data_queue.get(timeout=timeout)\r\n>   File \"C:\\Users\\Nathan\\miniconda3\\envs\\rust_sementic_seg\\lib\\multiprocessing\\queues.py\", line 114, in get\r\n>     raise Empty\r\n> _queue.Empty\n```\n\n\n### Steps to reproduce\n\nHere's the test code I wrote using Lightning's \"boring model\".\r\n\r\n\r\n```python\r\nimport os\r\nfrom pathlib import Path\r\nfrom time import time, sleep\r\nimport shutil\r\n\r\nimport torch\r\nfrom torch.utils.data import DataLoader, Dataset\r\n\r\nfrom pytorch_lightning import LightningModule, Trainer\r\n\r\nfrom optuna import create_study\r\nfrom optuna.pruners import MedianPruner\r\nfrom optuna.integration import PyTorchLightningPruningCallback\r\n\r\nt0 = time()\r\n\r\n\r\nclass RandomDataset(Dataset):\r\n    def __init__(self, size, length):\r\n        self.len = length\r\n        self.data = torch.randn(length, size)\r\n\r\n    def __getitem__(self, index):\r\n        return self.data[index]\r\n\r\n    def __len__(self):\r\n        return self.len\r\n\r\n\r\nclass BoringModel(LightningModule):\r\n    def __init__(self):\r\n        super().__init__()\r\n        self.layer = torch.nn.Linear(32, 2)\r\n\r\n    def forward(self, x):\r\n        return self.layer(x)\r\n\r\n    def training_step(self, batch, batch_idx):\r\n        loss = self(batch).sum()\r\n        self.log(\"train_loss\", loss)\r\n        return {\"loss\": loss}\r\n\r\n    def validation_step(self, batch, batch_idx):\r\n        # loss = self(batch).sum()\r\n        loss = time() - t0\r\n        self.log(\"valid_loss\", loss)\r\n\r\n    # def test_step(self, batch, batch_idx):\r\n    #     loss = self(batch).sum()\r\n    #     self.log(\"test_loss\", loss)\r\n\r\n    def configure_optimizers(self):\r\n        return torch.optim.SGD(self.layer.parameters(), lr=0.1)\r\n\r\n\r\ndef get_objective(train_data, val_data):\r\n    def objective(trial):\r\n        sleep(2)\r\n        _ = trial.suggest_uniform(\"test\", 0.0, 1.0)\r\n        model = BoringModel()\r\n        trainer = Trainer(\r\n            default_root_dir=os.getcwd(),\r\n            limit_train_batches=1,\r\n            limit_val_batches=1,\r\n            limit_test_batches=1,\r\n            num_sanity_val_steps=0,\r\n            max_epochs=5,\r\n            enable_model_summary=False,\r\n            callbacks=[\r\n                PyTorchLightningPruningCallback(\r\n                    trial=trial, monitor=\"valid_loss\"\r\n                )\r\n            ],\r\n            log_every_n_steps=1,\r\n            accelerator=\"gpu\",\r\n            devices=1,\r\n        )\r\n        trainer.fit(\r\n            model, train_dataloaders=train_data, val_dataloaders=val_data\r\n        )\r\n        # trainer.test(model, dataloaders=test_data)\r\n        print(\"*\" * 20)\r\n        print(\"*\" * 20)\r\n        print(\"THIS PRINT COMMAND WILL WORK ONLY WHEN NOT PRUNED!\")\r\n        print(\"\u2026 AND IT'S THE SAME FOR THE FOLLOWING RETURN COMMAND!\")\r\n        print(\"*\" * 20)\r\n        print(\"*\" * 20)\r\n        return trainer.logged_metrics[\"valid_loss\"]\r\n\r\n    return objective\r\n\r\n\r\nif __name__ == \"__main__\":\r\n\r\n    train_data = DataLoader(RandomDataset(32, 64), batch_size=4, num_workers=4)\r\n    val_data = DataLoader(RandomDataset(32, 64), batch_size=4, num_workers=4)\r\n\r\n    objective = get_objective(train_data, val_data)\r\n    if Path(\"test.db\").exists():\r\n        Path(\"test.db\").unlink()\r\n    if Path(\"lightning_logs\").exists():\r\n        shutil.rmtree(Path(\"lightning_logs\"))\r\n\r\n    study = create_study(\r\n        study_name=\"test\",\r\n        storage=\"sqlite:///test.db\",\r\n        direction=\"minimize\",\r\n        load_if_exists=False,\r\n        pruner=MedianPruner(n_startup_trials=1),\r\n    )\r\n\r\n    study.optimize(objective, n_trials=5)\r\n\r\n```\r\n\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3783/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3783/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3762", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3762/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3762/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3762/events", "html_url": "https://github.com/optuna/optuna/issues/3762", "id": 1296678571, "node_id": "I_kwDOB0okGM5NSb6r", "number": 3762, "title": "FanovaImportanceEvaluator raises ValueError when given `float('inf')` as an objective value.", "user": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-07-07T01:38:48Z", "updated_at": "2022-07-07T04:22:02Z", "closed_at": "2022-07-07T04:22:02Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nAvoid to raise `ValueError` when given `float('inf')` as an objective value.\r\n\r\n### Environment\r\n\r\n- Optuna version:3.0.0b0\r\n- Python version:3.9.12\r\n- OS:Linux-5.4.0-100-generic-x86_64-with-glibc2.31\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\nInput In [19], in <cell line: 21>()\r\n     18 study_contains_inf = optuna.create_study()\r\n     19 study_contains_inf.optimize(objective, n_trials=200)\r\n---> 21 importance = optuna.importance.get_param_importances(study_contains_inf, evaluator=FanovaImportanceEvaluator())\r\n\r\nFile ~/.local/lib/python3.9/site-packages/optuna/importance/__init__.py:93, in get_param_importances(study, evaluator, params, target)\r\n     90 if not isinstance(evaluator, BaseImportanceEvaluator):\r\n     91     raise TypeError(\"Evaluator must be a subclass of BaseImportanceEvaluator.\")\r\n---> 93 return evaluator.evaluate(study, params=params, target=target)\r\n\r\nFile ~/.local/lib/python3.9/site-packages/optuna/importance/_fanova/_evaluator.py:128, in FanovaImportanceEvaluator.evaluate(self, study, params, target)\r\n    121 # Many (deep) copies of the search spaces are required during the tree traversal and using\r\n    122 # Optuna distributions will create a bottleneck.\r\n    123 # Therefore, search spaces (parameter distributions) are represented by a single\r\n    124 # `numpy.ndarray`, coupled with a list of flags that indicate whether they are categorical\r\n    125 # or not.\r\n    127 evaluator = self._evaluator\r\n--> 128 evaluator.fit(\r\n    129     X=trans_params,\r\n    130     y=trans_values,\r\n    131     search_spaces=trans_bounds,\r\n    132     column_to_encoded_columns=column_to_encoded_columns,\r\n    133 )\r\n    135 importances = {}\r\n    136 for i, name in enumerate(distributions.keys()):\r\n\r\nFile ~/.local/lib/python3.9/site-packages/optuna/importance/_fanova/_fanova.py:72, in _Fanova.fit(self, X, y, search_spaces, column_to_encoded_columns)\r\n     69 assert X.shape[1] == search_spaces.shape[0]\r\n     70 assert search_spaces.shape[1] == 2\r\n---> 72 self._forest.fit(X, y)\r\n     74 self._trees = [_FanovaTree(e.tree_, search_spaces) for e in self._forest.estimators_]\r\n     75 self._column_to_encoded_columns = column_to_encoded_columns\r\n\r\nFile /usr/local/lib/python3.9/site-packages/sklearn/ensemble/_forest.py:331, in BaseForest.fit(self, X, y, sample_weight)\r\n    329 if issparse(y):\r\n    330     raise ValueError(\"sparse multilabel-indicator for y is not supported.\")\r\n--> 331 X, y = self._validate_data(\r\n    332     X, y, multi_output=True, accept_sparse=\"csc\", dtype=DTYPE\r\n    333 )\r\n    334 if sample_weight is not None:\r\n    335     sample_weight = _check_sample_weight(sample_weight, X)\r\n\r\nFile /usr/local/lib/python3.9/site-packages/sklearn/base.py:596, in BaseEstimator._validate_data(self, X, y, reset, validate_separately, **check_params)\r\n    594         y = check_array(y, input_name=\"y\", **check_y_params)\r\n    595     else:\r\n--> 596         X, y = check_X_y(X, y, **check_params)\r\n    597     out = X, y\r\n    599 if not no_val_X and check_params.get(\"ensure_2d\", True):\r\n\r\nFile /usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py:1090, in check_X_y(X, y, accept_sparse, accept_large_sparse, dtype, order, copy, force_all_finite, ensure_2d, allow_nd, multi_output, ensure_min_samples, ensure_min_features, y_numeric, estimator)\r\n   1070     raise ValueError(\r\n   1071         f\"{estimator_name} requires y to be passed, but the target y is None\"\r\n   1072     )\r\n   1074 X = check_array(\r\n   1075     X,\r\n   1076     accept_sparse=accept_sparse,\r\n   (...)\r\n   1087     input_name=\"X\",\r\n   1088 )\r\n-> 1090 y = _check_y(y, multi_output=multi_output, y_numeric=y_numeric, estimator=estimator)\r\n   1092 check_consistent_length(X, y)\r\n   1094 return X, y\r\n\r\nFile /usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py:1100, in _check_y(y, multi_output, y_numeric, estimator)\r\n   1098 \"\"\"Isolated part of check_X_y dedicated to y validation\"\"\"\r\n   1099 if multi_output:\r\n-> 1100     y = check_array(\r\n   1101         y,\r\n   1102         accept_sparse=\"csr\",\r\n   1103         force_all_finite=True,\r\n   1104         ensure_2d=False,\r\n   1105         dtype=None,\r\n   1106         input_name=\"y\",\r\n   1107         estimator=estimator,\r\n   1108     )\r\n   1109 else:\r\n   1110     estimator_name = _check_estimator_name(estimator)\r\n\r\nFile /usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py:899, in check_array(array, accept_sparse, accept_large_sparse, dtype, order, copy, force_all_finite, ensure_2d, allow_nd, ensure_min_samples, ensure_min_features, estimator, input_name)\r\n    893         raise ValueError(\r\n    894             \"Found array with dim %d. %s expected <= 2.\"\r\n    895             % (array.ndim, estimator_name)\r\n    896         )\r\n    898     if force_all_finite:\r\n--> 899         _assert_all_finite(\r\n    900             array,\r\n    901             input_name=input_name,\r\n    902             estimator_name=estimator_name,\r\n    903             allow_nan=force_all_finite == \"allow-nan\",\r\n    904         )\r\n    906 if ensure_min_samples > 0:\r\n    907     n_samples = _num_samples(array)\r\n\r\nFile /usr/local/lib/python3.9/site-packages/sklearn/utils/validation.py:146, in _assert_all_finite(X, allow_nan, msg_dtype, estimator_name, input_name)\r\n    124         if (\r\n    125             not allow_nan\r\n    126             and estimator_name\r\n   (...)\r\n    130             # Improve the error message on how to handle missing values in\r\n    131             # scikit-learn.\r\n    132             msg_err += (\r\n    133                 f\"\\n{estimator_name} does not accept missing values\"\r\n    134                 \" encoded as NaN natively. For supervised learning, you might want\"\r\n   (...)\r\n    144                 \"#estimators-that-handle-nan-values\"\r\n    145             )\r\n--> 146         raise ValueError(msg_err)\r\n    148 # for object dtype data, we only check for NaNs (GH-13254)\r\n    149 elif X.dtype == np.dtype(\"object\") and not allow_nan:\r\n\r\nValueError: Input y contains infinity or a value too large for dtype('float64').\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\nExecute the below code:\r\n\r\n```python\r\nimport numpy as np\r\nimport optuna\r\nfrom optuna.importance import FanovaImportanceEvaluator\r\n\r\noptuna.logging.set_verbosity(optuna.logging.ERROR)\r\nrnd = np.random.RandomState(0)\r\n\r\n\r\ndef objective(trial):\r\n    for i in range(64):\r\n        trial.suggest_float(f\"x-{i}\", -100, 100)\r\n    if trial.number % 10 == 0:\r\n        return float('inf')\r\n    return rnd.random()\r\n\r\n\r\nstudy_contains_inf = optuna.create_study()\r\nstudy_contains_inf.optimize(objective, n_trials=100)\r\n\r\nimportance = optuna.importance.get_param_importances(study_contains_inf, evaluator=FanovaImportanceEvaluator())\r\nprint(importance)\r\n```\r\n\r\n\r\n### Additional context (optional)\r\n\r\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3762/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3762/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3746", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3746/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3746/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3746/events", "html_url": "https://github.com/optuna/optuna/issues/3746", "id": 1291009922, "node_id": "I_kwDOB0okGM5M8z-C", "number": 3746, "title": "Raise `ValueError` on `nan` values in constraints", "user": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-07-01T07:12:30Z", "updated_at": "2022-08-04T13:15:25Z", "closed_at": "2022-08-04T13:15:24Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nWe should raise `ValueError` in samplers whenever `nan` is found in constraints.\r\nWe could check for `nan` in `after_trial` function.\r\n\r\n* [x] NSGA-II #3740 \r\n* [ ] TPE\r\n* [ ] botorch\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3746/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3746/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3742", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3742/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3742/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3742/events", "html_url": "https://github.com/optuna/optuna/pull/3742", "id": 1289777952, "node_id": "PR_kwDOB0okGM46n2wx", "number": 3742, "title": "Fix `_calculate_weights` such that it throws `ValueError` on invalid weights", "user": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/44", "html_url": "https://github.com/optuna/optuna/milestone/44", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/44/labels", "id": 8044945, "node_id": "MI_kwDOB0okGM4AesGR", "number": 44, "title": "v3.0.0-rc0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 129, "state": "closed", "created_at": "2022-06-03T05:14:22Z", "updated_at": "2022-08-08T06:16:39Z", "due_on": null, "closed_at": "2022-08-08T06:16:39Z"}, "comments": 8, "created_at": "2022-06-30T08:25:04Z", "updated_at": "2022-07-08T07:51:50Z", "closed_at": "2022-07-08T07:51:43Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3742", "html_url": "https://github.com/optuna/optuna/pull/3742", "diff_url": "https://github.com/optuna/optuna/pull/3742.diff", "patch_url": "https://github.com/optuna/optuna/pull/3742.patch", "merged_at": "2022-07-08T07:51:42Z"}, "body": "\r\n## Motivation\r\nResolve #3687.\r\n\r\n## Description of the changes\r\nAdd checks for invalid weights in `_calculate_weights`.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3742/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3742/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3740", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3740/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3740/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3740/events", "html_url": "https://github.com/optuna/optuna/pull/3740", "id": 1289725693, "node_id": "PR_kwDOB0okGM46nrvH", "number": 3740, "title": "Raise errors for NaN in constraint values", "user": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/44", "html_url": "https://github.com/optuna/optuna/milestone/44", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/44/labels", "id": 8044945, "node_id": "MI_kwDOB0okGM4AesGR", "number": 44, "title": "v3.0.0-rc0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 129, "state": "closed", "created_at": "2022-06-03T05:14:22Z", "updated_at": "2022-08-08T06:16:39Z", "due_on": null, "closed_at": "2022-08-08T06:16:39Z"}, "comments": 7, "created_at": "2022-06-30T07:37:41Z", "updated_at": "2022-08-05T05:09:40Z", "closed_at": "2022-08-01T01:30:46Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3740", "html_url": "https://github.com/optuna/optuna/pull/3740", "diff_url": "https://github.com/optuna/optuna/pull/3740.diff", "patch_url": "https://github.com/optuna/optuna/pull/3740.patch", "merged_at": "2022-08-01T01:30:46Z"}, "body": "## Motivation\r\nRelated to #3738, we should raise `ValueError` as early as possible when `nan` is detected in constraint values. We check that in `after_trial`.\r\n\r\n## Description of the changes\r\nCheck for `nan` constraint values in `after_trial`.\r\n\r\nNote that #3738 is still necessary because we cannot detect `nan` constraints in `add_trial`ed trials.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3740/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3740/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3739", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3739/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3739/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3739/events", "html_url": "https://github.com/optuna/optuna/pull/3739", "id": 1289701275, "node_id": "PR_kwDOB0okGM46nmpP", "number": 3739, "title": "Fix `inf`-related issue on implementation of `_calculate_nondomination_rank`", "user": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}, {"id": 3264287142, "node_id": "MDU6TGFiZWwzMjY0Mjg3MTQy", "url": "https://api.github.com/repos/optuna/optuna/labels/v3", "name": "v3", "color": "339FD7", "default": false, "description": "Issue/PR for Optuna version 3."}], "state": "closed", "locked": false, "assignee": {"login": "knshnb", "id": 23695091, "node_id": "MDQ6VXNlcjIzNjk1MDkx", "avatar_url": "https://avatars.githubusercontent.com/u/23695091?v=4", "gravatar_id": "", "url": "https://api.github.com/users/knshnb", "html_url": "https://github.com/knshnb", "followers_url": "https://api.github.com/users/knshnb/followers", "following_url": "https://api.github.com/users/knshnb/following{/other_user}", "gists_url": "https://api.github.com/users/knshnb/gists{/gist_id}", "starred_url": "https://api.github.com/users/knshnb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/knshnb/subscriptions", "organizations_url": "https://api.github.com/users/knshnb/orgs", "repos_url": "https://api.github.com/users/knshnb/repos", "events_url": "https://api.github.com/users/knshnb/events{/privacy}", "received_events_url": "https://api.github.com/users/knshnb/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "knshnb", "id": 23695091, "node_id": "MDQ6VXNlcjIzNjk1MDkx", "avatar_url": "https://avatars.githubusercontent.com/u/23695091?v=4", "gravatar_id": "", "url": "https://api.github.com/users/knshnb", "html_url": "https://github.com/knshnb", "followers_url": "https://api.github.com/users/knshnb/followers", "following_url": "https://api.github.com/users/knshnb/following{/other_user}", "gists_url": "https://api.github.com/users/knshnb/gists{/gist_id}", "starred_url": "https://api.github.com/users/knshnb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/knshnb/subscriptions", "organizations_url": "https://api.github.com/users/knshnb/orgs", "repos_url": "https://api.github.com/users/knshnb/repos", "events_url": "https://api.github.com/users/knshnb/events{/privacy}", "received_events_url": "https://api.github.com/users/knshnb/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/44", "html_url": "https://github.com/optuna/optuna/milestone/44", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/44/labels", "id": 8044945, "node_id": "MI_kwDOB0okGM4AesGR", "number": 44, "title": "v3.0.0-rc0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 129, "state": "closed", "created_at": "2022-06-03T05:14:22Z", "updated_at": "2022-08-08T06:16:39Z", "due_on": null, "closed_at": "2022-08-08T06:16:39Z"}, "comments": 3, "created_at": "2022-06-30T07:13:56Z", "updated_at": "2022-07-05T07:46:37Z", "closed_at": "2022-07-05T07:46:37Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3739", "html_url": "https://github.com/optuna/optuna/pull/3739", "diff_url": "https://github.com/optuna/optuna/pull/3739.diff", "patch_url": "https://github.com/optuna/optuna/pull/3739.patch", "merged_at": "2022-07-05T07:46:37Z"}, "body": "## Motivation\r\nResolve #3674.\r\n\r\n## Description of the changes\r\nFix implementation of `_calculate_nondomination_rank` such that it returns correct values even when there are `inf` values.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3739/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3739/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3738", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3738/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3738/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3738/events", "html_url": "https://github.com/optuna/optuna/pull/3738", "id": 1289658182, "node_id": "PR_kwDOB0okGM46ndga", "number": 3738, "title": "Raise error on `nan` in `_constrained_dominates`", "user": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}, {"id": 3264287142, "node_id": "MDU6TGFiZWwzMjY0Mjg3MTQy", "url": "https://api.github.com/repos/optuna/optuna/labels/v3", "name": "v3", "color": "339FD7", "default": false, "description": "Issue/PR for Optuna version 3."}], "state": "closed", "locked": false, "assignee": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/44", "html_url": "https://github.com/optuna/optuna/milestone/44", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/44/labels", "id": 8044945, "node_id": "MI_kwDOB0okGM4AesGR", "number": 44, "title": "v3.0.0-rc0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 129, "state": "closed", "created_at": "2022-06-03T05:14:22Z", "updated_at": "2022-08-08T06:16:39Z", "due_on": null, "closed_at": "2022-08-08T06:16:39Z"}, "comments": 6, "created_at": "2022-06-30T06:26:13Z", "updated_at": "2022-09-02T16:54:03Z", "closed_at": "2022-07-31T15:11:37Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3738", "html_url": "https://github.com/optuna/optuna/pull/3738", "diff_url": "https://github.com/optuna/optuna/pull/3738.diff", "patch_url": "https://github.com/optuna/optuna/pull/3738.patch", "merged_at": "2022-07-31T15:11:37Z"}, "body": "\r\n## Motivation\r\nCurrently, NSGA-II behaves very counterintuitively when `nan` is given as constraint values. `nan` values are treated as infeasible, but it is currently treated as zero violation.\r\n\r\nWe resolve this issue by simply raising `ValueError` when a `nan` is found.\r\n\r\n## Description of the changes\r\nRaise `ValueError` in `_constrained_dominates` function when a `nan` constraint is encountered.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3738/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3738/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3715", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3715/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3715/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3715/events", "html_url": "https://github.com/optuna/optuna/issues/3715", "id": 1282116870, "node_id": "I_kwDOB0okGM5Ma40G", "number": 3715, "title": "Trial 2 failed, because the value None could not be cast to float.", "user": {"login": "manza-ari", "id": 33715985, "node_id": "MDQ6VXNlcjMzNzE1OTg1", "avatar_url": "https://avatars.githubusercontent.com/u/33715985?v=4", "gravatar_id": "", "url": "https://api.github.com/users/manza-ari", "html_url": "https://github.com/manza-ari", "followers_url": "https://api.github.com/users/manza-ari/followers", "following_url": "https://api.github.com/users/manza-ari/following{/other_user}", "gists_url": "https://api.github.com/users/manza-ari/gists{/gist_id}", "starred_url": "https://api.github.com/users/manza-ari/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/manza-ari/subscriptions", "organizations_url": "https://api.github.com/users/manza-ari/orgs", "repos_url": "https://api.github.com/users/manza-ari/repos", "events_url": "https://api.github.com/users/manza-ari/events{/privacy}", "received_events_url": "https://api.github.com/users/manza-ari/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-06-23T09:41:52Z", "updated_at": "2022-06-24T05:30:17Z", "closed_at": "2022-06-23T14:38:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nI want to find optimal milestones (SGD optimizer) for my model but facing above error \r\n\r\n`\r\n# OPTUNA Learning Rate and Optimizer \r\n\r\n                optuna_milestone_min =  optuna_trial.suggest_int('milestones' , 1, 30, step = 5)\r\n                optuna_milestone_max =  optuna_trial.suggest_int('milestones' , 1, 30, step = 5 )\r\n                \r\n                \r\n                # Loss, criterion and scheduler (re)initialization\r\n                criterion      = nn.CrossEntropyLoss(reduction='none')\r\n                optim_backbone = optim.SGD(models.parameters(), lr=LR, \r\n                    momentum=MOMENTUM, weight_decay=WDECAY)                             #OPTUNA Learning Rate suggestions \r\n    \r\n                sched_backbone = lr_scheduler.MultiStepLR(optim_backbone, milestones=[optuna_milestone_min, optuna_milestone_max])\r\n                optimizers =  optim_backbone\r\n                schedulers = sched_backbone\r\n`\n\n### Environment\n\n- Optuna version:  2.10.0\r\n- Python version: 3.8\r\n- OS: Ubuntu \r\n- (Optional) Other libraries and their versions:\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\nTrial 2 failed, because the value None could not be cast to float.\n```\n\n\n### Steps to reproduce\n\n1.\r\n2.\r\n3.\r\n```pmodels      = resnet18\r\n                \r\n                torch.backends.cudnn.benchmark = True\r\n                models = torch.nn.DataParallel(models, device_ids=[0])\r\n                \r\n                # OPTUNA Learning Rate and Optimizer \r\n\r\n                optuna_milestone_min =  optuna_trial.suggest_int('milestones' , 1, 30, step = 5)\r\n                optuna_milestone_max =  optuna_trial.suggest_int('milestones' , 1, 30, step = 5 )\r\n                \r\n                \r\n                # Loss, criterion and scheduler (re)initialization\r\n                criterion      = nn.CrossEntropyLoss(reduction='none')\r\n                optim_backbone = optim.SGD(models.parameters(), lr=LR, \r\n                    momentum=MOMENTUM, weight_decay=WDECAY)                             #OPTUNA Learning Rate suggestions \r\n    \r\n                sched_backbone = lr_scheduler.MultiStepLR(optim_backbone, milestones=[optuna_milestone_min, optuna_milestone_max])\r\n                optimizers =  optim_backbone\r\n                schedulers = sched_backbone\r\n                \r\n```\r\n\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3715/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3715/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3702", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3702/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3702/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3702/events", "html_url": "https://github.com/optuna/optuna/pull/3702", "id": 1277965250, "node_id": "PR_kwDOB0okGM46ATJR", "number": 3702, "title": "Fix postgres primarykey unsorted problem", "user": {"login": "wattlebirdaz", "id": 36123078, "node_id": "MDQ6VXNlcjM2MTIzMDc4", "avatar_url": "https://avatars.githubusercontent.com/u/36123078?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wattlebirdaz", "html_url": "https://github.com/wattlebirdaz", "followers_url": "https://api.github.com/users/wattlebirdaz/followers", "following_url": "https://api.github.com/users/wattlebirdaz/following{/other_user}", "gists_url": "https://api.github.com/users/wattlebirdaz/gists{/gist_id}", "starred_url": "https://api.github.com/users/wattlebirdaz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wattlebirdaz/subscriptions", "organizations_url": "https://api.github.com/users/wattlebirdaz/orgs", "repos_url": "https://api.github.com/users/wattlebirdaz/repos", "events_url": "https://api.github.com/users/wattlebirdaz/events{/privacy}", "received_events_url": "https://api.github.com/users/wattlebirdaz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/44", "html_url": "https://github.com/optuna/optuna/milestone/44", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/44/labels", "id": 8044945, "node_id": "MI_kwDOB0okGM4AesGR", "number": 44, "title": "v3.0.0-rc0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 129, "state": "closed", "created_at": "2022-06-03T05:14:22Z", "updated_at": "2022-08-08T06:16:39Z", "due_on": null, "closed_at": "2022-08-08T06:16:39Z"}, "comments": 3, "created_at": "2022-06-21T06:41:03Z", "updated_at": "2022-06-23T09:54:21Z", "closed_at": "2022-06-23T09:54:21Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3702", "html_url": "https://github.com/optuna/optuna/pull/3702", "diff_url": "https://github.com/optuna/optuna/pull/3702.diff", "patch_url": "https://github.com/optuna/optuna/pull/3702.patch", "merged_at": "2022-06-23T09:54:21Z"}, "body": "## Motivation\r\nfix #3605 \r\n\r\n## Description of the changes\r\nadded `order_by(trial_id)` to the query getting the list of trial_id from the backend. \r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3702/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3702/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3692", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3692/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3692/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3692/events", "html_url": "https://github.com/optuna/optuna/issues/3692", "id": 1275209060, "node_id": "I_kwDOB0okGM5MAiVk", "number": 3692, "title": "Contour plot color scale different from other visualizations", "user": {"login": "connorbrinton", "id": 1848731, "node_id": "MDQ6VXNlcjE4NDg3MzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1848731?v=4", "gravatar_id": "", "url": "https://api.github.com/users/connorbrinton", "html_url": "https://github.com/connorbrinton", "followers_url": "https://api.github.com/users/connorbrinton/followers", "following_url": "https://api.github.com/users/connorbrinton/following{/other_user}", "gists_url": "https://api.github.com/users/connorbrinton/gists{/gist_id}", "starred_url": "https://api.github.com/users/connorbrinton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/connorbrinton/subscriptions", "organizations_url": "https://api.github.com/users/connorbrinton/orgs", "repos_url": "https://api.github.com/users/connorbrinton/repos", "events_url": "https://api.github.com/users/connorbrinton/events{/privacy}", "received_events_url": "https://api.github.com/users/connorbrinton/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-06-17T15:56:39Z", "updated_at": "2022-06-17T18:24:00Z", "closed_at": "2022-06-17T18:01:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nOptuna's [parallel coordinate](https://optuna.readthedocs.io/en/stable/reference/visualization/generated/optuna.visualization.plot_parallel_coordinate.html), [slice](https://optuna.readthedocs.io/en/stable/reference/visualization/generated/optuna.visualization.plot_slice.html) and [pareto front visualizations](https://optuna.readthedocs.io/en/stable/reference/visualization/generated/optuna.visualization.plot_pareto_front.html) all use Plotly's `plotly.colors.sequential.Blues` color scale, which looks like this:\r\n![Screen Shot 2022-06-17 at 11 44 33 AM](https://user-images.githubusercontent.com/1848731/174332200-f06d70b2-2db5-4545-9d64-2ee3b59ac6ee.png)\r\n\r\nOptuna's [contour plot visualization](https://optuna.readthedocs.io/en/stable/reference/visualization/generated/optuna.visualization.plot_contour.html) attempts to use this same color scale in the code, but the actual produced result does not seem to use the same color scale:\r\n![Screen Shot 2022-06-17 at 11 46 08 AM](https://user-images.githubusercontent.com/1848731/174332432-639b43aa-c3ad-4bb9-b42d-bc810a5e31cd.png)\r\n\r\nThe rendered color scale is reversed compared to the standard color scale, and has a much more saturated blue tone. This makes it a bit difficult to understand the contour plot, since the meaning of the colors is the opposite as in the parallel coordinate plot.\r\n\r\n### Environment\r\n\r\n- Optuna version: 2.10.1\r\n- Python version: 3.8.12\r\n- OS: macOS 12.4\r\n- (Optional) Other libraries and their versions:\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\nN/A\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\nI was able to reproduce the issue using the code snippets in Optuna's documentation here:\r\nhttps://optuna.readthedocs.io/en/stable/reference/visualization/generated/optuna.visualization.plot_contour.html\r\n\r\nI've also reproduced this using some other code that I haven't cleaned up enough to share here. My code uses around 7 parameters, and still results in the same problem, so [both branches of this `if/else` block seem to have the same issue](https://github.com/optuna/optuna/blob/946437a099db6fcad30ba738a82030c3b3d685e7/optuna/visualization/_contour.py#L151-L218)\r\n\r\n### Additional context (optional)\r\n\r\nCurrently Optuna seems to [correctly set the color scale on individual contour plots](https://github.com/optuna/optuna/blob/946437a099db6fcad30ba738a82030c3b3d685e7/optuna/visualization/_contour.py#L285-L296), then [attempts to use the color scale of the first rendered contour plot for the entire figure](https://github.com/optuna/optuna/blob/946437a099db6fcad30ba738a82030c3b3d685e7/optuna/visualization/_contour.py#L194-L196). [This Plotly issue](https://github.com/plotly/plotly.py/issues/1858) seems to indicate that it might be possible to set the color scale layout/figure-wide [using `layout.coloraxis`](https://github.com/plotly/plotly.py/issues/1858#issuecomment-549050530) or [`fig.update_coloraxes(...)`](https://github.com/plotly/plotly.py/issues/1858#issuecomment-888626427). I'm sure there's a reason Optuna does things the way it does currently though, so there's probably an unusual interaction with Plotly that I'm not aware of \ud83d\ude05\r\n\r\nBy the way, this is actually my first time using Optuna and it's been a fantastic experience! Thanks for maintaining it! \ud83d\ude04", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3692/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3692/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3687", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3687/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3687/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3687/events", "html_url": "https://github.com/optuna/optuna/issues/3687", "id": 1274649533, "node_id": "I_kwDOB0okGM5L-Zu9", "number": 3687, "title": "An invalid `weights` argument of `TPESamper` does not raise any error", "user": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}, {"id": 1846694757, "node_id": "MDU6TGFiZWwxODQ2Njk0NzU3", "url": "https://api.github.com/repos/optuna/optuna/labels/good%20first%20issue", "name": "good first issue", "color": "c2e0c6", "default": true, "description": "Good first issue for contribution."}, {"id": 3264287142, "node_id": "MDU6TGFiZWwzMjY0Mjg3MTQy", "url": "https://api.github.com/repos/optuna/optuna/labels/v3", "name": "v3", "color": "339FD7", "default": false, "description": "Issue/PR for Optuna version 3."}, {"id": 4157952017, "node_id": "LA_kwDOB0okGM731VAR", "url": "https://api.github.com/repos/optuna/optuna/labels/description-checked", "name": "description-checked", "color": "0E8A16", "default": false, "description": "The issue description is checked and confirmed by committers."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-06-17T06:59:37Z", "updated_at": "2022-07-08T07:51:42Z", "closed_at": "2022-07-08T07:51:42Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "### Expected behavior\n\nIf we pass an invalid `weights` to `TPESamper`, it does not raise any error. We should raise an `ValueError` for those ivalid `weight`s. Examples of invalid `weight`s are as follows.\r\n\r\n```python\r\nlambda x: np.zeros(x),\r\nlambda x: -np.ones(x),\r\nlambda x: float(\"inf\") * np.ones(x),\r\nlambda x: -float(\"inf\") * np.ones(x),\r\nlambda x: np.asarray([float(\"nan\") for _ in range(x)])\r\n```\n\n### Environment\n\n- Optuna version: current master https://github.com/optuna/optuna/commit/b213753a816689a97b6433e1e780ca32c4293e07\r\n- Python version: 3.9\r\n- OS: mac\r\n- (Optional) Other libraries and their versions:\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\n(venv) mamu@HideakinoMacBook-puro code_snippets_for_optuna % python tpe-tests/hoge.py \r\n/Users/mamu/Dev/pfn/optuna/optuna/samplers/_tpe/parzen_estimator.py:230: RuntimeWarning: invalid value encountered in true_divide\r\n  weights /= weights.sum()\r\n[nan]\r\n[1.]\r\n[nan]\r\n[nan]\r\n[nan]\n```\n\n\n### Steps to reproduce\n\n```python\r\nimport optuna\r\nfrom optuna import distributions\r\nfrom optuna.samplers._tpe.parzen_estimator import _ParzenEstimator\r\nfrom optuna.samplers._tpe.parzen_estimator import _ParzenEstimatorParameters\r\n\r\nimport numpy as np\r\n\r\ndef test_invalid_weights(weights):\r\n    parameters = _ParzenEstimatorParameters(\r\n        prior_weight=1.0,\r\n        consider_prior=False,\r\n        consider_magic_clip=False,\r\n        consider_endpoints=False,\r\n        weights=weights,\r\n        multivariate=False,\r\n    )\r\n    mpe = _ParzenEstimator(\r\n        {\"a\": np.asarray([0.0])}, {\"a\": distributions.FloatDistribution(-1.0, 1.0)}, parameters\r\n    )\r\n\r\n    print(mpe._weights)\r\n\r\nweights_funcs = [\r\n\tlambda x: np.zeros(x),\r\n\tlambda x: -np.ones(x),\r\n\tlambda x: float(\"inf\") * np.ones(x),\r\n\tlambda x: -float(\"inf\") * np.ones(x),\r\n\tlambda x: np.asarray([float(\"nan\") for _ in range(x)]),\r\n]\r\n\r\nfor weights in weights_funcs:\r\n\ttest_invalid_weights(weights)\r\n\r\n```\r\n\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3687/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3687/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3681", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3681/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3681/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3681/events", "html_url": "https://github.com/optuna/optuna/issues/3681", "id": 1272975548, "node_id": "I_kwDOB0okGM5L4BC8", "number": 3681, "title": "matplotlib's plot_contour() method raise an error when given dynamic search space.", "user": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}, {"id": 4157952017, "node_id": "LA_kwDOB0okGM731VAR", "url": "https://api.github.com/repos/optuna/optuna/labels/description-checked", "name": "description-checked", "color": "0E8A16", "default": false, "description": "The issue description is checked and confirmed by committers."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-06-16T02:48:55Z", "updated_at": "2022-07-15T00:12:07Z", "closed_at": "2022-07-15T00:12:06Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nAs plotly's plot_contour() can handle dynamic search spaces properly, matplotlib's plot_contour() method should be able to accept dynamic search space.\r\n\r\n### Environment\r\n\r\n- Optuna version:3.0.0rc0.dev\r\n- Python version:3.9.11\r\n- OS:macOS-12.3.1-x86_64-i386-64bit\r\n- (Optional) Other libraries and their versions:\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\n$ python bug_matplotlib_plot_contour.py\r\n[I 2022-06-16 11:43:25,236] A new study created in memory with name: A single-objective study with 3-dimensional dynamic search space\r\n[I 2022-06-16 11:43:25,238] Trial 0 finished with value: -0.9723216524479252 and parameters: {'category': 'bar', 'x2': -5.986063716221181}. Best is trial 0 with value: -0.9723216524479252.\r\n[I 2022-06-16 11:43:25,239] Trial 1 finished with value: 1.760435351638048 and parameters: {'category': 'foo', 'x1': 3.326813985318985}. Best is trial 1 with value: 1.760435351638048.\r\n[I 2022-06-16 11:43:25,239] Trial 2 finished with value: -7.583657590003812 and parameters: {'category': 'bar', 'x2': -2.246155852266906}. Best is trial 1 with value: 1.760435351638048.\r\n[I 2022-06-16 11:43:25,239] Trial 3 finished with value: 18.474087129547364 and parameters: {'category': 'foo', 'x1': 6.298149267946306}. Best is trial 3 with value: 18.474087129547364.\r\n[I 2022-06-16 11:43:25,240] Trial 4 finished with value: -9.428683789636048 and parameters: {'category': 'bar', 'x2': -1.9293838094551692}. Best is trial 3 with value: 18.474087129547364.\r\n[I 2022-06-16 11:43:25,240] Trial 5 finished with value: -15.02901036791338 and parameters: {'category': 'bar', 'x2': -8.876726759511609}. Best is trial 3 with value: 18.474087129547364.\r\n[I 2022-06-16 11:43:25,240] Trial 6 finished with value: 35.83677106510998 and parameters: {'category': 'foo', 'x1': 7.9863821349050195}. Best is trial 6 with value: 35.83677106510998.\r\n[I 2022-06-16 11:43:25,241] Trial 7 finished with value: 38.300159300048314 and parameters: {'category': 'foo', 'x1': 8.188712248929361}. Best is trial 7 with value: 38.300159300048314.\r\n[I 2022-06-16 11:43:25,241] Trial 8 finished with value: 36.79416883099965 and parameters: {'category': 'foo', 'x1': 8.065819716328507}. Best is trial 7 with value: 38.300159300048314.\r\n[I 2022-06-16 11:43:25,241] Trial 9 finished with value: 41.966519235944105 and parameters: {'category': 'foo', 'x1': 8.478157086389933}. Best is trial 9 with value: 41.966519235944105.\r\n[I 2022-06-16 11:43:25,251] Trial 10 finished with value: 2.9905738109692943 and parameters: {'category': 'foo', 'x1': 0.2706724396548541}. Best is trial 9 with value: 41.966519235944105.\r\n[I 2022-06-16 11:43:25,253] Trial 11 finished with value: 63.81133568419859 and parameters: {'category': 'foo', 'x1': 9.988199777434124}. Best is trial 11 with value: 63.81133568419859.\r\n[I 2022-06-16 11:43:25,256] Trial 12 finished with value: 59.22688123709178 and parameters: {'category': 'foo', 'x1': 9.695900287626639}. Best is trial 11 with value: 63.81133568419859.\r\n[I 2022-06-16 11:43:25,258] Trial 13 finished with value: 61.576558077718104 and parameters: {'category': 'foo', 'x1': 9.847073217303258}. Best is trial 11 with value: 63.81133568419859.\r\n[I 2022-06-16 11:43:25,260] Trial 14 finished with value: 61.105536719061355 and parameters: {'category': 'foo', 'x1': 9.817003052261228}. Best is trial 11 with value: 63.81133568419859.\r\n[I 2022-06-16 11:43:25,263] Trial 15 finished with value: 11.129176866576213 and parameters: {'category': 'foo', 'x1': 5.336042096043785}. Best is trial 11 with value: 63.81133568419859.\r\n[I 2022-06-16 11:43:25,266] Trial 16 finished with value: 20.299871591942505 and parameters: {'category': 'foo', 'x1': 6.505537880424767}. Best is trial 11 with value: 63.81133568419859.\r\n[I 2022-06-16 11:43:25,268] Trial 17 finished with value: 2.3066620688215416 and parameters: {'category': 'foo', 'x1': 3.518769919646008}. Best is trial 11 with value: 63.81133568419859.\r\n[I 2022-06-16 11:43:25,270] Trial 18 finished with value: -23.647267561545284 and parameters: {'category': 'bar', 'x2': -9.862845623865237}. Best is trial 11 with value: 63.81133568419859.\r\n[I 2022-06-16 11:43:25,273] Trial 19 finished with value: 59.04950003263621 and parameters: {'category': 'foo', 'x1': 9.684367249984621}. Best is trial 11 with value: 63.81133568419859.\r\n[I 2022-06-16 11:43:25,275] Trial 20 finished with value: 1.9472463883739826 and parameters: {'category': 'foo', 'x1': 0.6045622950579332}. Best is trial 11 with value: 63.81133568419859.\r\n[I 2022-06-16 11:43:25,277] Trial 21 finished with value: 63.86901591705744 and parameters: {'category': 'foo', 'x1': 9.991809301845073}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,280] Trial 22 finished with value: 47.970539401366366 and parameters: {'category': 'foo', 'x1': 8.926076768370848}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,282] Trial 23 finished with value: 25.446496546728522 and parameters: {'category': 'foo', 'x1': 7.0444520561433155}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,284] Trial 24 finished with value: 63.65625553605348 and parameters: {'category': 'foo', 'x1': 9.978487045552777}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,287] Trial 25 finished with value: 27.202169723029566 and parameters: {'category': 'foo', 'x1': 7.215569932713928}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,289] Trial 26 finished with value: -0.31831227354973746 and parameters: {'category': 'bar', 'x2': -5.564191699291772}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,291] Trial 27 finished with value: 48.49249048129746 and parameters: {'category': 'foo', 'x1': 8.963654965698506}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,294] Trial 28 finished with value: 48.22747947576172 and parameters: {'category': 'foo', 'x1': 8.944600742718167}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,297] Trial 29 finished with value: -24.584445666830728 and parameters: {'category': 'bar', 'x2': -0.041729569009902434}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,299] Trial 30 finished with value: 0.19249940833440185 and parameters: {'category': 'foo', 'x1': 1.5612524548964384}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,302] Trial 31 finished with value: 63.736800148253934 and parameters: {'category': 'foo', 'x1': 9.983533061762438}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,304] Trial 32 finished with value: 62.43550399886475 and parameters: {'category': 'foo', 'x1': 9.901614012267668}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,307] Trial 33 finished with value: 49.20440007171121 and parameters: {'category': 'foo', 'x1': 9.01458481107123}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,310] Trial 34 finished with value: 30.598330349863218 and parameters: {'category': 'foo', 'x1': 7.531575756496807}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,312] Trial 35 finished with value: 52.31168547494971 and parameters: {'category': 'foo', 'x1': 9.232681762316776}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,315] Trial 36 finished with value: -7.3249841467316985 and parameters: {'category': 'bar', 'x2': -7.706470791775093}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,317] Trial 37 finished with value: 63.45722838945394 and parameters: {'category': 'foo', 'x1': 9.966004543650094}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,320] Trial 38 finished with value: -2.2662175132514135 and parameters: {'category': 'bar', 'x2': -3.494603868328534}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,322] Trial 39 finished with value: 1.0788073758518255 and parameters: {'category': 'foo', 'x1': 3.038656524483347}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,325] Trial 40 finished with value: 41.965785770735714 and parameters: {'category': 'foo', 'x1': 8.478100475504815}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,327] Trial 41 finished with value: 54.91065619744565 and parameters: {'category': 'foo', 'x1': 9.410172480951145}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,330] Trial 42 finished with value: 62.360322919664895 and parameters: {'category': 'foo', 'x1': 9.896855255078751}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,333] Trial 43 finished with value: 46.45605217871198 and parameters: {'category': 'foo', 'x1': 8.81586767614454}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,335] Trial 44 finished with value: 63.506839532449206 and parameters: {'category': 'foo', 'x1': 9.969117864133345}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,338] Trial 45 finished with value: 34.351727969581155 and parameters: {'category': 'foo', 'x1': 7.861034718339515}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,341] Trial 46 finished with value: 40.662885003741636 and parameters: {'category': 'foo', 'x1': 8.376745643644698}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,343] Trial 47 finished with value: 10.495243549606926 and parameters: {'category': 'foo', 'x1': 5.239636329838108}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,346] Trial 48 finished with value: 53.76780332344284 and parameters: {'category': 'foo', 'x1': 9.33265322536412}. Best is trial 21 with value: 63.86901591705744.\r\n[I 2022-06-16 11:43:25,348] Trial 49 finished with value: -3.405327722423339 and parameters: {'category': 'bar', 'x2': -6.845353007536319}. Best is trial 21 with value: 63.86901591705744.\r\n/Users/c-bata/go/src/github.com/c-bata/optuna-visualization-regression-tests/bug_matplotlib_plot_contour.py:28: ExperimentalWarning:\r\n\r\nplot_contour is experimental (supported from v2.2.0). The interface can change in the future.\r\n\r\n[W 2022-06-16 11:43:27,726] Output figures of this Matplotlib-based `plot_contour` function would be different from those of the Plotly-based `plot_contour`.\r\nTraceback (most recent call last):\r\n  File \"/Users/c-bata/go/src/github.com/c-bata/optuna-visualization-regression-tests/bug_matplotlib_plot_contour.py\", line 33, in <module>\r\n    main()\r\n  File \"/Users/c-bata/go/src/github.com/c-bata/optuna-visualization-regression-tests/bug_matplotlib_plot_contour.py\", line 28, in main\r\n    matplotlib_visualization.plot_contour(study)\r\n  File \"/Users/c-bata/go/src/github.com/c-bata/optuna-visualization-regression-tests/venv/lib/python3.9/site-packages/optuna/_experimental.py\", line 72, in wrapper\r\n    return func(*args, **kwargs)\r\n  File \"/Users/c-bata/go/src/github.com/c-bata/optuna-visualization-regression-tests/venv/lib/python3.9/site-packages/optuna/visualization/matplotlib/_contour.py\", line 102, in plot_contour\r\n    return _get_contour_plot(study, params, target, target_name)\r\n  File \"/Users/c-bata/go/src/github.com/c-bata/optuna-visualization-regression-tests/venv/lib/python3.9/site-packages/optuna/visualization/matplotlib/_contour.py\", line 170, in _get_contour_plot\r\n    cs = _generate_contour_subplot(\r\n  File \"/Users/c-bata/go/src/github.com/c-bata/optuna-visualization-regression-tests/venv/lib/python3.9/site-packages/optuna/visualization/matplotlib/_contour.py\", line 412, in _generate_contour_subplot\r\n    ax.set_xlim(x_values_range[0], x_values_range[1])\r\nIndexError: list index out of range\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\n1. Execute following Python script\r\n\r\n```python\r\nimport optuna\r\nimport optuna.visualization as plotly_visualization\r\nimport optuna.visualization.matplotlib as matplotlib_visualization\r\nimport matplotlib.pylab as plt\r\n\r\n\r\ndef objective_single_dynamic(trial: optuna.Trial) -> float:\r\n    category = trial.suggest_categorical(\"category\", [\"foo\", \"bar\"])\r\n    if category == \"foo\":\r\n        return (trial.suggest_float(\"x1\", 0, 10) - 2) ** 2\r\n    else:\r\n        return -((trial.suggest_float(\"x2\", -10, 0) + 5) ** 2)\r\n\r\n\r\ndef main():\r\n    study = optuna.create_study(\r\n        study_name=\"A single-objective study with 3-dimensional dynamic search space\",\r\n        direction=\"maximize\",\r\n    )\r\n\r\n    study.optimize(objective_single_dynamic, n_trials=50)\r\n\r\n    # Plotly\r\n    plotly_fig = plotly_visualization.plot_contour(study)\r\n    plotly_fig.write_image(\"plotly.png\")\r\n\r\n    # Matplotlib\r\n    matplotlib_visualization.plot_contour(study). # an exception is raised here!\r\n    plt.savefig(\"matplotlib.png\", bbox_inches=\"tight\")\r\n\r\n\r\nif __name__ == '__main__':\r\n    main()\r\n```\r\n\r\n\r\n### Additional context (optional)\r\n\r\nI detected this bug by https://github.com/c-bata/optuna-visualization-regression-tests.\r\n\r\nHere is an output.\r\nhttps://c-bata.link/optuna-visualization-regression-tests/plot_contour.html\r\n\r\n<img width=\"1346\" alt=\"Screenshot 2022-06-16 11 50 15\" src=\"https://user-images.githubusercontent.com/5564044/173980609-8f2de5f1-f3df-4186-8bb4-bdc9ccbb60a7.png\">\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3681/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3681/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3675", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3675/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3675/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3675/events", "html_url": "https://github.com/optuna/optuna/issues/3675", "id": 1271622254, "node_id": "I_kwDOB0okGM5Ly2pu", "number": 3675, "title": "The `optuna.samplers._tpe.sampler._calculate_weights_below_for_multi_objective` should return `[]` when `indices=[]`", "user": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}, {"id": 3264287142, "node_id": "MDU6TGFiZWwzMjY0Mjg3MTQy", "url": "https://api.github.com/repos/optuna/optuna/labels/v3", "name": "v3", "color": "339FD7", "default": false, "description": "Issue/PR for Optuna version 3."}, {"id": 4157952017, "node_id": "LA_kwDOB0okGM731VAR", "url": "https://api.github.com/repos/optuna/optuna/labels/description-checked", "name": "description-checked", "color": "0E8A16", "default": false, "description": "The issue description is checked and confirmed by committers."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-06-15T03:33:24Z", "updated_at": "2022-07-08T05:02:59Z", "closed_at": "2022-07-08T05:02:59Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "### Expected behavior\n\nThe `optuna.samplers._tpe.sampler._calculate_weights_below_for_multi_objective` should return `[]` when `indices=[]`, but it raises an `IndexError`. \n\n### Environment\n\n- Optuna version: current master https://github.com/optuna/optuna/commit/d3c53e053a18341405cdfc9587d4525fdce7494d\r\n- Python version: 3.9\r\n- OS: mac, linux\r\n- (Optional) Other libraries and their versions:\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\n(venv) mamu@HideakinoMacBook-puro 3662 % python hoge.py\r\nTraceback (most recent call last):\r\n  File \"/Users/mamu/Dev/pfn/code_snippets_for_optuna/3662/hoge.py\", line 5, in <module>\r\n    optuna.samplers._tpe.sampler._calculate_weights_below_for_multi_objective(\r\n  File \"/Users/mamu/Dev/pfn/optuna/optuna/samplers/_tpe/sampler.py\", line 764, in _calculate_weights_below_for_multi_objective\r\n    cvals = list(config_values.values())[0][indices]\r\nIndexError: arrays used as indices must be of integer (or boolean) type\n```\n\n\n### Steps to reproduce\n\n```python\r\nimport optuna\r\nimport numpy as np\r\n\r\n\r\noptuna.samplers._tpe.sampler._calculate_weights_below_for_multi_objective(\r\n    {\"x\": np.array([1.0, 2.0, 3.0], dtype=float)},\r\n    [(0, [0.2, 0.5]), (0, [0.9, 0.4]), (0, [1, 1])],\r\n    np.array([]),\r\n)\r\n```\r\n\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3675/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3675/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3674", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3674/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3674/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3674/events", "html_url": "https://github.com/optuna/optuna/issues/3674", "id": 1271616573, "node_id": "I_kwDOB0okGM5Ly1Q9", "number": 3674, "title": "The `optuna.samplers._tpe.sampler._calculate_nondomination_rank` should consider `+/-inf`", "user": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 3264287142, "node_id": "MDU6TGFiZWwzMjY0Mjg3MTQy", "url": "https://api.github.com/repos/optuna/optuna/labels/v3", "name": "v3", "color": "339FD7", "default": false, "description": "Issue/PR for Optuna version 3."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-06-15T03:23:48Z", "updated_at": "2022-07-05T07:46:37Z", "closed_at": "2022-07-05T07:46:37Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nThe `optuna.samplers._tpe.sampler._calculate_nondomination_rank` should consider `+/-inf`.\r\n\r\nAs shown in [here](https://github.com/optuna/optuna/pull/3662#discussion_r895497654), the current `optuna.samplers._tpe.sampler._calculate_nondomination_rank` returns `[0., 0., ... 0.]` if the trials include `+/-inf` as objective values. I think it should be as follows.\r\n\r\nLet the number of objectives `m = 2`. \r\n- `[0, 0]` should dominate `[1, 1]`.\r\n- `[-inf, -inf]` should dominate `[0, 0]`.\r\n- `[-inf, 0]` should dominate `[0, 0]`.\r\n- `[0, -inf]` should dominate `[0, 0]`.\r\n- `[-inf, -inf]` should dominate `[-inf, 0]` and `[0, -inf]`.\r\n- `[-inf, 0]` and `[0, -inf]` should be incomparable.\r\n- `[1, 1]` should dominate `[inf, inf]`.\r\n- `[1, 1]` should dominate `[inf, 1]`.\r\n- `[1, 1]` should dominate `[1, inf]`.\r\n- `[inf, 1]` and `[1, inf]` should dominate `[inf, inf]`.\r\n- `[inf, `]` and `[, inf]` should be incomparable.\r\n\r\nTherefore, the non-domination ranks of `[-inf, -inf], [-inf, 0], [0, -inf], [0, 0], [1, 1], [1, inf], [inf, 1], [inf. inf]` should be `[0, 1, 1, 2, 3, 4, 4, 5]`.\r\n\r\n### Environment\r\n\r\n- Optuna version: PR #3662\r\n- Python version: 3.9\r\n- OS: mac, linux\r\n- (Optional) Other libraries and their versions:\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\n(venv) mamu@HideakinoMacBook-puro optuna % pytest tests/samplers_tests/tpe_tests/test_multi_objective_sampler.py -k test_calculate_nondomination_rank\r\n========================================================================================================================== test session starts ==========================================================================================================================\r\nplatform darwin -- Python 3.9.9, pytest-6.2.4, py-1.11.0, pluggy-0.13.1\r\nrootdir: /Users/mamu/Dev/pfn/optuna, configfile: pyproject.toml\r\nplugins: cov-2.12.1\r\ncollected 441 items / 440 deselected / 1 selected                                                                                                                                                                                                                       \r\n\r\ntests/samplers_tests/tpe_tests/test_multi_objective_sampler.py .                                                                                                                                                                                                  [100%]\r\n\r\n=========================================================================================================================== warnings summary ============================================================================================================================\r\ntests/samplers_tests/tpe_tests/test_multi_objective_sampler.py::test_calculate_nondomination_rank\r\n  /Users/mamu/Dev/pfn/optuna/optuna/samplers/_tpe/sampler.py:529: RuntimeWarning: invalid value encountered in true_divide\r\n    vecs = (vecs - lb) / (ub - lb)\r\n\r\ntests/samplers_tests/tpe_tests/test_multi_objective_sampler.py::test_calculate_nondomination_rank\r\n  /Users/mamu/Dev/pfn/optuna/optuna/samplers/_tpe/sampler.py:529: RuntimeWarning: invalid value encountered in subtract\r\n    vecs = (vecs - lb) / (ub - lb)\r\n\r\n-- Docs: https://docs.pytest.org/en/stable/warnings.html\r\n============================================================================================================= 1 passed, 440 deselected, 2 warnings in 6.67s =============================================================================================================\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\n```sh\r\n$ pytest tests/samplers_tests/tpe_tests/test_multi_objective_sampler.py -k test_calculate_nondomination_rank\r\n```\r\nSee `test_calculate_nondomination_rank` in `tests/samplers_tests/tpe_tests/test_multi_objective_sampler.py` for more details.\r\n\r\n### Additional context (optional)\r\n\r\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3674/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3674/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3670", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3670/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3670/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3670/events", "html_url": "https://github.com/optuna/optuna/issues/3670", "id": 1270798465, "node_id": "I_kwDOB0okGM5LvtiB", "number": 3670, "title": "Infinite loop in `TPESampler`", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}, {"id": 2107128673, "node_id": "MDU6TGFiZWwyMTA3MTI4Njcz", "url": "https://api.github.com/repos/optuna/optuna/labels/no-stale", "name": "no-stale", "color": "BBBBBB", "default": false, "description": "Exempt from stale bot"}, {"id": 4157952017, "node_id": "LA_kwDOB0okGM731VAR", "url": "https://api.github.com/repos/optuna/optuna/labels/description-checked", "name": "description-checked", "color": "0E8A16", "default": false, "description": "The issue description is checked and confirmed by committers."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2022-06-14T13:19:14Z", "updated_at": "2022-09-05T00:00:23Z", "closed_at": "2022-09-05T00:00:23Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\n`TPESampler` should work with `n_startup_trials=1` when we apply it to multi-objective optimization problem.\r\n\r\n### Environment\r\n\r\n- Optuna version: 3.0.0rc0.dev\r\n- Python version: 3.8.10\r\n- OS: ubuntu 20.04 (on WSL2)\r\n- (Optional) Other libraries and their versions: N/A\r\n\r\n\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\nThe optimization stalled during the second trial of a study as follows:\r\n\r\n\r\n[I 2022-06-14 22:05:14,674] A new study created in memory with name: no-name-b71eae7e-a922-42bf-a232-e096a8dbdeb7\r\n[I 2022-06-14 22:05:14,675] Trial 0 finished with values: [-0.2716466405358364, -1.5373243468897773] and parameters: {'x': -0.2716466405358364, 'y': -1.5373243468897773}. \r\n/home/yanase/pfn/code/optuna-review/optuna/samplers/_tpe/sampler.py:585: RuntimeWarning: invalid value encountered in true_divide\r\n  vecs = (vecs - lb) / (ub - lb)\r\n\r\n\r\nWhen I hit `Ctrl + C`, the script stopped at the nondomination rank-based selection of the TPESampler.\r\n\r\n```console\r\nTraceback (most recent call last):\r\n  File \"/home/yanase/pfn/code/optuna-review/optuna/study/_optimize.py\", line 196, in _run_trial\r\n    value_or_values = func(trial)\r\n...\r\n  File \"/home/yanase/pfn/code/optuna-review/optuna/samplers/_tpe/sampler.py\", line 447, in sample_independent\r\n    indices_below, indices_above = _split_observation_pairs(scores, self._gamma(n), violations)\r\n  File \"/home/yanase/pfn/code/optuna-review/optuna/samplers/_tpe/sampler.py\", line 778, in _split_observation_pairs\r\n    length = indices[nondomination_ranks == i].shape[0]\r\n```\r\n\r\nThe corresponding code is shown below:\r\nhttps://github.com/optuna/optuna/blob/d3c53e053a18341405cdfc9587d4525fdce7494d/optuna/samplers/_tpe/sampler.py#L774-L781\r\n\r\nWhen the study has only a single trial, the default gamma function returns `1`, and the `n_below=1`. So the condition of the while loop at L777 is always `True`. So, the optimization process was trapped in the while loop.\r\n\r\nOn the other hand, the single objective TPE can select `below` even if we set `n_startup_trials=1`. I'm not sure, but we can fix the multi-objective logic by referring to the single objective one.\r\n\r\n\r\n### Steps to reproduce\r\n\r\n1. Execute the following python script.\r\n\r\n```python\r\nimport optuna\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_float(\"x\", -10, 10)\r\n    y = trial.suggest_float(\"y\", -10, 10)\r\n    return x, y\r\n\r\nstudy = optuna.create_study(\r\n    directions=[\"maximize\", \"maximize\"],\r\n    sampler=optuna.samplers.TPESampler(n_startup_trials=1),\r\n)\r\nstudy.optimize(objective, n_trials=10)\r\nfor trial in study.best_trials:\r\n    print(trial.values)\r\n```\r\n\r\n\r\n### Additional context (optional)\r\n\r\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3670/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3670/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3668", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3668/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3668/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3668/events", "html_url": "https://github.com/optuna/optuna/pull/3668", "id": 1270568669, "node_id": "PR_kwDOB0okGM45nwYZ", "number": 3668, "title": "Remove `trial_values` records whose values are `None`", "user": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/44", "html_url": "https://github.com/optuna/optuna/milestone/44", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/44/labels", "id": 8044945, "node_id": "MI_kwDOB0okGM4AesGR", "number": 44, "title": "v3.0.0-rc0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 129, "state": "closed", "created_at": "2022-06-03T05:14:22Z", "updated_at": "2022-08-08T06:16:39Z", "due_on": null, "closed_at": "2022-08-08T06:16:39Z"}, "comments": 3, "created_at": "2022-06-14T10:07:36Z", "updated_at": "2022-06-27T00:47:53Z", "closed_at": "2022-06-23T10:03:28Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3668", "html_url": "https://github.com/optuna/optuna/pull/3668", "diff_url": "https://github.com/optuna/optuna/pull/3668.diff", "patch_url": "https://github.com/optuna/optuna/pull/3668.patch", "merged_at": "2022-06-23T10:03:28Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull request after it gets two or more approvals. To proceed to the review process by the maintainers, please make sure that the PR meets the following conditions: (1) it passes all CI checks, and (2) it is neither in the draft nor WIP state. If you wish to discuss the PR in the draft state or need any other help, please mention the Optuna development team in the PR. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nI found an Optuna DB that contains `trial_values` records which `value` column is `NULL` although the `value` column of `trial_values` table is defined as `nullable=False`. It causes a migration error while executing a migration script `v3.0.0.b.py`.\r\nhttps://github.com/optuna/optuna/blob/master/optuna/storages/_rdb/alembic/versions/v3.0.0.b.py#L34-L39\r\n\r\nThe `value` column was supposed to changed `nullable=False` at #2030. However, the schema migration to make the column nullable is not added in `v2.4.0.a.py` script. Furthermore, it inserts trial_values records for RUNNING, WAITING, and PRUNED trials here:\r\nhttps://github.com/optuna/optuna/blob/c51af67bde7f67daf9a19227400bc80a51a47ab2/optuna/storages/_rdb/alembic/versions/v2.4.0.a.py#L149-L154\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\nThe cause of the problem is actually located in `v2.4.0.a.py`. However, about 2.5 years have passed since we released [Optuna v2.4.0](https://github.com/optuna/optuna/releases/tag/v2.4.0). In this PR, I made changes to `v3.0.0.b.py` to fix this issue in the migration script that will be run on the next release of Optuna..\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3668/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3668/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3666", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3666/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3666/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3666/events", "html_url": "https://github.com/optuna/optuna/pull/3666", "id": 1270185731, "node_id": "PR_kwDOB0okGM45mfB7", "number": 3666, "title": "Fix bug in `IntersectionSearchSpace`", "user": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "keisuke-umezawa", "id": 1277089, "node_id": "MDQ6VXNlcjEyNzcwODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1277089?v=4", "gravatar_id": "", "url": "https://api.github.com/users/keisuke-umezawa", "html_url": "https://github.com/keisuke-umezawa", "followers_url": "https://api.github.com/users/keisuke-umezawa/followers", "following_url": "https://api.github.com/users/keisuke-umezawa/following{/other_user}", "gists_url": "https://api.github.com/users/keisuke-umezawa/gists{/gist_id}", "starred_url": "https://api.github.com/users/keisuke-umezawa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/keisuke-umezawa/subscriptions", "organizations_url": "https://api.github.com/users/keisuke-umezawa/orgs", "repos_url": "https://api.github.com/users/keisuke-umezawa/repos", "events_url": "https://api.github.com/users/keisuke-umezawa/events{/privacy}", "received_events_url": "https://api.github.com/users/keisuke-umezawa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "keisuke-umezawa", "id": 1277089, "node_id": "MDQ6VXNlcjEyNzcwODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1277089?v=4", "gravatar_id": "", "url": "https://api.github.com/users/keisuke-umezawa", "html_url": "https://github.com/keisuke-umezawa", "followers_url": "https://api.github.com/users/keisuke-umezawa/followers", "following_url": "https://api.github.com/users/keisuke-umezawa/following{/other_user}", "gists_url": "https://api.github.com/users/keisuke-umezawa/gists{/gist_id}", "starred_url": "https://api.github.com/users/keisuke-umezawa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/keisuke-umezawa/subscriptions", "organizations_url": "https://api.github.com/users/keisuke-umezawa/orgs", "repos_url": "https://api.github.com/users/keisuke-umezawa/repos", "events_url": "https://api.github.com/users/keisuke-umezawa/events{/privacy}", "received_events_url": "https://api.github.com/users/keisuke-umezawa/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/44", "html_url": "https://github.com/optuna/optuna/milestone/44", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/44/labels", "id": 8044945, "node_id": "MI_kwDOB0okGM4AesGR", "number": 44, "title": "v3.0.0-rc0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 129, "state": "closed", "created_at": "2022-06-03T05:14:22Z", "updated_at": "2022-08-08T06:16:39Z", "due_on": null, "closed_at": "2022-08-08T06:16:39Z"}, "comments": 4, "created_at": "2022-06-14T03:01:50Z", "updated_at": "2022-06-25T07:00:54Z", "closed_at": "2022-06-25T07:00:35Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3666", "html_url": "https://github.com/optuna/optuna/pull/3666", "diff_url": "https://github.com/optuna/optuna/pull/3666.diff", "patch_url": "https://github.com/optuna/optuna/pull/3666.patch", "merged_at": "2022-06-25T07:00:35Z"}, "body": "## Motivation\r\n`IntersectionSearchSpace` has a bug that `self._cursor` is not updated when there are no running trials. We fix this bug.\r\n\r\n## Description of the changes\r\nFix `self._cursor` such that it is updated to the last trial when there are no running trials.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3666/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3666/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3631", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3631/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3631/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3631/events", "html_url": "https://github.com/optuna/optuna/issues/3631", "id": 1260895620, "node_id": "I_kwDOB0okGM5LJ72E", "number": 3631, "title": "LightGBMTunerCV doing wrong early stopping and gives wrong model at end", "user": {"login": "pseudotensor", "id": 2249614, "node_id": "MDQ6VXNlcjIyNDk2MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/2249614?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pseudotensor", "html_url": "https://github.com/pseudotensor", "followers_url": "https://api.github.com/users/pseudotensor/followers", "following_url": "https://api.github.com/users/pseudotensor/following{/other_user}", "gists_url": "https://api.github.com/users/pseudotensor/gists{/gist_id}", "starred_url": "https://api.github.com/users/pseudotensor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pseudotensor/subscriptions", "organizations_url": "https://api.github.com/users/pseudotensor/orgs", "repos_url": "https://api.github.com/users/pseudotensor/repos", "events_url": "https://api.github.com/users/pseudotensor/events{/privacy}", "received_events_url": "https://api.github.com/users/pseudotensor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2022-06-04T21:28:09Z", "updated_at": "2022-06-08T05:52:14Z", "closed_at": "2022-06-08T05:52:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nUsing https://github.com/optuna/optuna-examples/blob/main/lightgbm/lightgbm_tuner_cv.py\r\nand following this:\r\nhttps://optuna.readthedocs.io/en/stable/reference/generated/optuna.integration.lightgbm.LightGBMTunerCV.html\r\n\r\nThree (related?) problems:\r\n\r\n1) A single training period does not do reasonable early stopping.  Instead, of 100 early stopping rounds, training continues after the best score for another 500 etc. iterations consuming all boosting rounds.  Optuna seems to see the final score as the best one for that trial, or just bad reporting.  But this is definitely a waste.  I understand optuna pruner can terminate things even earlier than early stopping, but why are things so delayed beyond the early stopping rounds period beyond the best score?\r\n\r\ni.e. one will see:\r\n```\r\n[899]   cv_agg's multi_logloss: 8.88302 + 12.3886\r\n[900]   cv_agg's multi_logloss: 8.88302 + 12.3886\r\n[900]   cv_agg's multi_logloss: 8.88302 + 12.3886\r\n[901]   cv_agg's multi_logloss: 8.88304 + 12.3886\r\n[902]   cv_agg's multi_logloss: 8.88304 + 12.3886\r\n[903]   cv_agg's multi_logloss: 8.88304 + 12.3886\r\n[904]   cv_agg's multi_logloss: 8.88303 + 12.3886\r\n[905]   cv_agg's multi_logloss: 8.88304 + 12.3886\r\n[906]   cv_agg's multi_logloss: 8.88304 + 12.3886\r\n/home/jon/minicondadai_py38/lib/python3.8/site-packages/lightgbm/basic.py:2065: UserWarning: Using categorical_feature in Dataset.\r\n  _log_warning('Using categorical_feature in Dataset.')\r\n/home/jon/minicondadai_py38/lib/python3.8/site-packages/lightgbm/engine.py:620: UserWarning: 'verbose_eval' argument is deprecated and will be removed in a future release of LightGBM. Pass 'log_evaluation()' callback via 'callbacks' argument instead.\r\n  _log_warning(\"'verbose_eval' argument is deprecated and will be removed in a future release of LightGBM. \"\r\n[I 2022-06-04 14:53:16,558] The booster of trial#24 was saved as ./models2/24.pkl.\r\n^Mnum_leaves, val_score: 0.122860:  85%|########5 | 17/20 [36:17<06:11, 123.89s/it]^Mnum_leaves, val_score: 0.122860:  90%|######### | 18/20 [36:17<04:15, 127.56s/it][I 2022-06-04 14:53:16,626] Trial 24 finished with value: 8.882802609368346\r\n```\r\n\r\ni.e. `Trial 24 finished with value: 8.882802609368346` but the last trial going to 906 iterations actually had a best score at a much earlier iteration\r\n```\r\n[80]    cv_agg's multi_logloss: 0.237891 + 0.00906186\r\n```\r\n\r\nWhy is it saying trial finished with very last value instead of best in the trial?  Not sure this is bug, but the excessive iterations seems to be a bug.\r\n\r\n2) The \r\n```\r\nDid not meet early stopping. Best iteration is:\r\n[998]   cv_agg's multi_logloss: 0.180995 + 0.0117511\r\n```\r\n\r\ntype report always refers to (seemingly) the global best, not the last training round.  This is confusing, or may be a bug of some kind.  Or it may be intentional, but it may be related to the other problems here.\r\n\r\n3) The final manifestation of the above or yet another bug is that at the end the the report might look  like:\r\n\r\n```\r\n[834]   cv_agg's multi_logloss: 8.7975 + 6.13048\r\n[835]   cv_agg's multi_logloss: 8.77788 + 6.11675\r\n[836]   cv_agg's multi_logloss: 8.7437 + 6.09312\r\n[837]   cv_agg's multi_logloss: 8.72923 + 6.08319\r\n[838]   cv_agg's multi_logloss: 8.77614 + 6.11553\r\n[839]   cv_agg's multi_logloss: 8.83346 + 6.1558\r\n[840]   cv_agg's multi_logloss: 8.82765 + 6.15171\r\n[841]   cv_agg's multi_logloss: 8.79684 + 6.12999\r\n[842]   cv_agg's multi_logloss: 8.79434 + 6.12822\r\n[843]   cv_agg's multi_logloss: 8.75756 + 6.10263\r\n[844]   cv_agg's multi_logloss: 8.75599 + 6.10153\r\nEarly stopping, best iteration is:\r\n[744]   cv_agg's multi_logloss: 0.122506 + 0.00420387\r\nBest score: 0.12250622939778731\r\nBest params: {'verbosity': -1, 'boosting_type': 'gbdt', 'n_jobs': 10, 'device_type': 'cpu', 'objective': 'multiclass', 'metric': 'multi_logloss', 'num_classes': 7, 'feature_pre_filter': False, 'lambda_l1': 0.0, 'lambda_l2': 0.0, 'num_leaves': \r\n  Params: \r\n    verbosity: -1\r\n    boosting_type: gbdt\r\n    n_jobs: 10\r\n    device_type: cpu\r\n    objective: multiclass\r\n    metric: multi_logloss\r\n    num_classes: 7\r\n    feature_pre_filter: False\r\n    lambda_l1: 0.0\r\n    lambda_l2: 0.0\r\n    num_leaves: 149\r\n    feature_fraction: 0.7\r\n    bagging_fraction: 1.0\r\n    bagging_freq: 0\r\n    min_child_samples: 20\r\nbest_iteration: 744\r\n```\r\n\r\nHowever, if one takes those best parameters and builds a new model for those best iterations, the score is very poor of 8.7908 logloss, which is quite close to the very last round.  Something seems messed up with the best parameters.\r\n\r\nIt's like every training round is replacing the best even if not, which may be related to issue 1 and 2.\r\n\r\nSo overall both major accuracy (totally wrong or bad model) and performance (wasted time) issues.\r\n\r\n\r\n\r\n\r\n### Environment\r\n\r\n```\r\n- Optuna version:2.10.0\r\n- Python version:3.8.12\r\n- OS:Linux-5.4.0-74-generic-x86_64-with-glibc2.10\r\n```\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\nNo errors, logs could be included but there is no way to attach a file here.\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\n```python\r\nimport os\r\n\r\nimport numpy as np\r\n\r\nimport sklearn\r\nfrom sklearn.base import BaseEstimator, ClassifierMixin\r\nfrom sklearn.preprocessing import LabelEncoder\r\nfrom sklearn.utils.multiclass import unique_labels\r\n\r\n\r\ndef get_data(task_id):\r\n    import openml\r\n    cache_dir = \"openml_benchmark\"\r\n    openml.config.cache_directory = os.path.expanduser(cache_dir)\r\n\r\n    task = openml.tasks.get_task(task_id)  # download the OpenML task\r\n    labels = task.class_labels\r\n\r\n    train_indices, test_indices = task.get_train_test_split_indices()\r\n    X, y = task.get_X_and_y(dataset_format=\"dataframe\")\r\n    X_train = X.iloc[train_indices]\r\n    y_train = y.iloc[train_indices]\r\n    X_test = X.iloc[test_indices]\r\n    y_test = y.iloc[test_indices]\r\n\r\n    return X_train, y_train, X_test, y_test, labels\r\n\r\n\r\ndef go():\r\n    X_train, y_train, X_test, y_test, labels = get_data(75193)\r\n\r\n    model = OptunaLightGBMClassifier()\r\n    model.fit(X_train, y_train)\r\n\r\n    preds = model.predict_proba(X_test)\r\n    score = sklearn.metrics.log_loss(y_test, preds, labels=labels)\r\n    print(score)\r\n\r\n\r\nclass OptunaLightGBMClassifier(BaseEstimator, ClassifierMixin):\r\n    def fit(self, X, y):\r\n        X_numeric = X.select_dtypes(include=np.number)\r\n        num_cols = sorted(X_numeric.columns)\r\n        cat_cols = sorted(set(X.columns).difference(num_cols))\r\n        from sklearn.preprocessing import OrdinalEncoder\r\n        self._cat_encs = {}\r\n        for col in cat_cols:\r\n            self._cat_encs[col] = OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1,\r\n                                                 encoded_missing_value=-1)\r\n            X.loc[:, col] = self._cat_encs[col].fit_transform(X[[col]])\r\n\r\n        self.classes_ = unique_labels(y)\r\n        self._le = LabelEncoder()\r\n        y = self._le.fit_transform(y)\r\n        self.n_features_in_ = X.shape[1]\r\n\r\n        import optuna.integration.lightgbm as lgboptuna\r\n        from lightgbm import early_stopping\r\n        from lightgbm import log_evaluation\r\n        from sklearn.model_selection import KFold\r\n\r\n        data, target = X, y\r\n\r\n        dtrain = lgboptuna.Dataset(data, label=target, categorical_feature=cat_cols)\r\n\r\n        n_jobs = 10\r\n        params = {\r\n            \"verbosity\": -1,\r\n            \"boosting_type\": \"gbdt\",\r\n            \"n_jobs\": n_jobs,\r\n            'device_type': 'cpu',\r\n            'deterministic': True,\r\n            \"objective\": \"multiclass\",\r\n            \"metric\": \"multiclass\",\r\n            'num_classes': len(self.classes_)\r\n        }\r\n\r\n        seed = 2\r\n        model_dir = \"./models%s/\" % seed\r\n        os.makedirs(model_dir)\r\n        tuner = lgboptuna.LightGBMTunerCV(\r\n            params,\r\n            dtrain,\r\n            folds=KFold(n_splits=3),\r\n            seed=seed,\r\n            num_boost_round=1000,\r\n            callbacks=[early_stopping(100), log_evaluation(100)],\r\n            time_budget=60 * 60,\r\n            return_cvbooster=seed != 0,\r\n            optuna_seed=seed,\r\n            model_dir=model_dir,\r\n        )\r\n\r\n        tuner.run()\r\n\r\n        print(\"Best score:\", tuner.best_score)\r\n        best_params = tuner.best_params\r\n        print(\"Best params:\", best_params)\r\n        print(\"  Params: \")\r\n        for key, value in best_params.items():\r\n            print(\"    {}: {}\".format(key, value))\r\n\r\n        # fit final sklearn model with no early stopping and no CV so sees all data\r\n        import lightgbm as lgborig\r\n        best_iteration = tuner.get_best_booster().best_iteration\r\n        print(\"best_iteration: %s\" % best_iteration)\r\n        best_params.update(n_estimators=best_iteration + 1, n_jobs=n_jobs)\r\n        best_params.update(seed=seed, random_state=seed)\r\n\r\n        self._model = lgborig.LGBMClassifier(**best_params)\r\n        self._model.fit(X, y, categorical_feature=cat_cols)\r\n\r\n    def predict_proba(self, X):\r\n        for col, enc in self._cat_encs.items():\r\n            X.loc[:, col] = self._cat_encs[col].transform(X[[col]])\r\n\r\n        preds = self._model.predict_proba(X)\r\n        return preds\r\n\r\n    def get_params(self, deep=True):\r\n        return {}\r\n\r\n    def set_params(self, **params):\r\n        for k, v in params.items():\r\n            setattr(self, k, v)\r\n        return self\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    go()\r\n\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3631/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3631/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3630", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3630/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3630/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3630/events", "html_url": "https://github.com/optuna/optuna/issues/3630", "id": 1260882080, "node_id": "I_kwDOB0okGM5LJ4ig", "number": 3630, "title": "No input sanitization in `enqueue_trial`", "user": {"login": "xadrianzetx", "id": 37713008, "node_id": "MDQ6VXNlcjM3NzEzMDA4", "avatar_url": "https://avatars.githubusercontent.com/u/37713008?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xadrianzetx", "html_url": "https://github.com/xadrianzetx", "followers_url": "https://api.github.com/users/xadrianzetx/followers", "following_url": "https://api.github.com/users/xadrianzetx/following{/other_user}", "gists_url": "https://api.github.com/users/xadrianzetx/gists{/gist_id}", "starred_url": "https://api.github.com/users/xadrianzetx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xadrianzetx/subscriptions", "organizations_url": "https://api.github.com/users/xadrianzetx/orgs", "repos_url": "https://api.github.com/users/xadrianzetx/repos", "events_url": "https://api.github.com/users/xadrianzetx/events{/privacy}", "received_events_url": "https://api.github.com/users/xadrianzetx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2022-06-04T20:10:23Z", "updated_at": "2022-11-06T07:24:17Z", "closed_at": "2022-11-06T07:24:17Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nWhile working on #3629 I found that passing param value of different type than suggested in objective function to `enqueue_trial` causes undefined behavior, depending on type of value passed and expected distribution. So for example:\r\n\r\n* Enqueuing `{\"x\": \"foo\"}` but using `FloatDistribution` or `IntDistribution` for `x` in objective function causes optimization to crash with cryptic tracebacks.\r\n* Enqueuing `{\"x\": 1}` but using `FloatDistribution` for `x` results in silent cast to float.\r\n* Enqueuing `{\"x\": 1.1}` but using `IntDistribution` for `x` results in warning message and cast to int.\r\n\r\nI'd expect either one of following behaviors:\r\n1. Optimization fails with nice message informing user that incorrect param values were enqueued (including expected and actual distributions). \r\n2. Optimization continues, but trial with incorrect params is marked as failed with warning message.\r\n\r\nThis might be a bit nit-picky, but `enqueue_trial` allows user to fix suggestions to just about anything, and in large enough codebase I'd say its fairly easy to mistakenly switch two differently typed parameters, in which case current tracebacks (if any) are a bit confusing.\r\n\r\n### Environment\r\n\r\n- Optuna version: 3.0.0b1.dev\r\n- Python version: 3.8.10\r\n- OS: Ubuntu 20.04.4 LTS\r\n- (Optional) Other libraries and their versions:\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\nTraceback (most recent call last):\r\n  File \"uhoh.py\", line 7, in <module>\r\n    trial.suggest_float(\"x\", 1, 10)  # uh-oh!\r\n  File \"/home/adrian/code/optuna/env/lib/python3.8/site-packages/optuna/trial/_trial.py\", line 156, in suggest_float\r\n    return self._suggest(name, distribution)\r\n  File \"/home/adrian/code/optuna/env/lib/python3.8/site-packages/optuna/trial/_trial.py\", line 587, in _suggest\r\n    if self._is_fixed_param(name, distribution):\r\n  File \"/home/adrian/code/optuna/env/lib/python3.8/site-packages/optuna/trial/_trial.py\", line 616, in _is_fixed_param\r\n    contained = distribution._contains(param_value_in_internal_repr)\r\n  File \"/home/adrian/code/optuna/env/lib/python3.8/site-packages/optuna/distributions.py\", line 183, in _contains\r\n    return self.low <= value <= self.high\r\nTypeError: '<=' not supported between instances of 'float' and 'str'\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\n```python\r\nimport optuna\r\nstudy = optuna.create_study()\r\nstudy.enqueue_trial({\"x\": \"foo\"})\r\n# Some time later in objective function...\r\ntrial = study.ask()\r\ntrial.suggest_float(\"x\", 1, 10)  # uh-oh!\r\n```\r\n\r\n\r\n### Additional context (optional)\r\n\r\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3630/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3630/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3625", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3625/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3625/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3625/events", "html_url": "https://github.com/optuna/optuna/issues/3625", "id": 1260160584, "node_id": "I_kwDOB0okGM5LHIZI", "number": 3625, "title": "early stopping with custom metric uses metric from previous optuna study trials ", "user": {"login": "PhillipMaire", "id": 19584564, "node_id": "MDQ6VXNlcjE5NTg0NTY0", "avatar_url": "https://avatars.githubusercontent.com/u/19584564?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PhillipMaire", "html_url": "https://github.com/PhillipMaire", "followers_url": "https://api.github.com/users/PhillipMaire/followers", "following_url": "https://api.github.com/users/PhillipMaire/following{/other_user}", "gists_url": "https://api.github.com/users/PhillipMaire/gists{/gist_id}", "starred_url": "https://api.github.com/users/PhillipMaire/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PhillipMaire/subscriptions", "organizations_url": "https://api.github.com/users/PhillipMaire/orgs", "repos_url": "https://api.github.com/users/PhillipMaire/repos", "events_url": "https://api.github.com/users/PhillipMaire/events{/privacy}", "received_events_url": "https://api.github.com/users/PhillipMaire/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2022-06-03T17:16:17Z", "updated_at": "2022-06-09T08:36:59Z", "closed_at": "2022-06-09T08:36:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nI expect it to early stop for each optuna trial based on only that trial \r\n### Issue\r\n\r\nfor each OPTUNA trial, using a custom metric. if for example early stopping is triggered in trial 1, all subsequent trials will use that metric for stopping even though the metric was not achieved in that trial. I know this is a poor explanation but see the colab note book and the following examples. \r\nfrom the nootbook \r\ntouch_count_errors is my custom metric programed to return set numbers here to show the issue, where higher is better\r\nI selected early stopping of 2, again to show the issue \r\ni set the metric to saturate at 1 for trial 2, and never go above this\r\n\r\nYay the following works as expected!!\r\n    [1]\tvalid_0's auc: 0.955269\tvalid_0's touch_count_errors: 0.999\r\n    _Training until validation scores don't improve for 2 rounds_\r\n    **[2]\tvalid_0's auc: 0.954545\tvalid_0's touch_count_errors: 1**\r\n    [3]\tvalid_0's auc: 0.961054\tvalid_0's touch_count_errors: 0.002\r\n    [4]\tvalid_0's auc: 0.979132\tvalid_0's touch_count_errors: 0.003\r\n    _Early stopping, best iteration is:_\r\n    **[2]\tvalid_0's auc: 0.954545\tvalid_0's touch_count_errors: 1**\r\n\r\nBut this one uses the previous **valid_0's touch_count_errors: 1** to early stop even though it was not saturated here for AUC or touch_count_errors\r\n    [1]\tvalid_0's auc: 0.956921\tvalid_0's touch_count_errors: 0.004\r\n    [2]\tvalid_0's auc: 0.964566\tvalid_0's touch_count_errors: 0.005\r\n    [3]\tvalid_0's auc: 0.977583\tvalid_0's touch_count_errors: 0.006\r\n    [4]\tvalid_0's auc: 0.976343\tvalid_0's touch_count_errors: 0.007\r\n    _Early stopping, best iteration is:_\r\n    [2]\tvalid_0's auc: 0.954545\tvalid_0's touch_count_errors: 1\r\n\r\nsame for this one and all following\r\n    [1]\tvalid_0's auc: 0.958368\tvalid_0's touch_count_errors: 0.008\r\n    [2]\tvalid_0's auc: 0.971384\tvalid_0's touch_count_errors: 0.009\r\n    [3]\tvalid_0's auc: 0.973967\tvalid_0's touch_count_errors: 0.01\r\n    [4]\tvalid_0's auc: 0.980888\tvalid_0's touch_count_errors: 0.011\r\n    _Early stopping, best iteration is:_\r\n    [2]\tvalid_0's auc: 0.954545\tvalid_0's touch_count_errors: 1\r\n\r\n \r\n![image](https://user-images.githubusercontent.com/19584564/171913747-8c052585-7042-4506-828a-e0db73c9fe38.png)\r\n\r\n\r\n### Environment\r\n\r\ngoogle colab (and for my data using on a windows machine but issue occurs in both so troubleshooting in colab for consistency) \r\n\r\n- Optuna version:2.10.0\r\n- Python version:3.7.13\r\n- OS:Linux-5.4.188+-x86_64-with-Ubuntu-18.04-bionic\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\nNone, it's a bug not an error\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\nhere is a link to a fully contained example on colab \r\nhttps://colab.research.google.com/drive/1LigmaNSoK_FFi1BYTwhaDHZEBiLZskz0#scrollTo=0wP3rzPiYr0t\r\n\r\n\r\n### Additional context (optional)\r\nedit: I am not sure if this is the case for other metrics, it may actually have nothing to do with the custom metric and does this for all metrics, although to test this I would be harder because we would have to design our data in a certain way to test it. \r\n\r\nthank you all for your help!! ", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3625/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3625/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3605", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3605/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3605/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3605/events", "html_url": "https://github.com/optuna/optuna/issues/3605", "id": 1253803123, "node_id": "I_kwDOB0okGM5Ku4Rz", "number": 3605, "title": "`RDBStorage` does not sort trails with postgres", "user": {"login": "pnkov", "id": 10485212, "node_id": "MDQ6VXNlcjEwNDg1MjEy", "avatar_url": "https://avatars.githubusercontent.com/u/10485212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkov", "html_url": "https://github.com/pnkov", "followers_url": "https://api.github.com/users/pnkov/followers", "following_url": "https://api.github.com/users/pnkov/following{/other_user}", "gists_url": "https://api.github.com/users/pnkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkov/subscriptions", "organizations_url": "https://api.github.com/users/pnkov/orgs", "repos_url": "https://api.github.com/users/pnkov/repos", "events_url": "https://api.github.com/users/pnkov/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkov/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-05-31T12:34:36Z", "updated_at": "2022-06-23T09:54:21Z", "closed_at": "2022-06-23T09:54:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\n`RDBStorage.get_all_trials()` should sort trials like `CachedStorage` do when using postgres.\r\nAlso, it would be great if `intermediate_values` were sorted too.\n\n### Environment\n\n- Optuna version: 2.10.0\r\n- Python version: 3.8.13\r\n- OS: Linux-3.10.0-1160.62.1.el7.x86_64-x86_64-with-glibc2.2.5\n\n### Error messages, stack traces, or logs\n\n```shell\nSee steps to reproduce.\n```\n\n\n### Steps to reproduce\n\n1. Perform a study with `postgresql+psycopg2://...` storage.\r\n2. Get trails from `CachedStorage` and `RDBStorage` by your study id.\r\n\r\n```python\r\n>>> import optuna\r\n\r\n>>> storage = optuna.storages.get_storage('postgresql+psycopg2://...')\r\n>>> [t.number for t in storage.get_all_trials(study_id=...)]\r\n[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, ...]\r\n>>> storage.__class__\r\n<class 'optuna.storages._cached_storage._CachedStorage'>\r\n\r\n>>> storage = optuna.storages.RDBStorage('postgresql+psycopg2://...')\r\n>>> [t.number for t in storage.get_all_trials(study_id=...)]\r\n[33, 34, 28, 38, 5, 36, 1, 11, 10, 9, 8, 7, 14, 24, 42, 32, 17, 40, 43, 41, 49, 25, 54, 58, 48, ...]\r\n>>> storage.__class__\r\n<class 'optuna.storages._rdb.storage.RDBStorage'>\r\n```\r\n\n\n### Additional context (optional)\n\nFound this while fixing plots https://github.com/optuna/optuna-dashboard/pull/235\r\n\r\nhttps://www.postgresql.org/docs/current/sql-select.html says:\r\n> If `ORDER BY` is not given, the rows are returned in whatever order the system finds fastest to produce.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3605/reactions", "total_count": 4, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 1, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3605/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3592", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3592/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3592/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3592/events", "html_url": "https://github.com/optuna/optuna/pull/3592", "id": 1249407827, "node_id": "PR_kwDOB0okGM44g0na", "number": 3592, "title": "Fix nan comparison in grid sampler", "user": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, {"login": "knshnb", "id": 23695091, "node_id": "MDQ6VXNlcjIzNjk1MDkx", "avatar_url": "https://avatars.githubusercontent.com/u/23695091?v=4", "gravatar_id": "", "url": "https://api.github.com/users/knshnb", "html_url": "https://github.com/knshnb", "followers_url": "https://api.github.com/users/knshnb/followers", "following_url": "https://api.github.com/users/knshnb/following{/other_user}", "gists_url": "https://api.github.com/users/knshnb/gists{/gist_id}", "starred_url": "https://api.github.com/users/knshnb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/knshnb/subscriptions", "organizations_url": "https://api.github.com/users/knshnb/orgs", "repos_url": "https://api.github.com/users/knshnb/repos", "events_url": "https://api.github.com/users/knshnb/events{/privacy}", "received_events_url": "https://api.github.com/users/knshnb/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/44", "html_url": "https://github.com/optuna/optuna/milestone/44", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/44/labels", "id": 8044945, "node_id": "MI_kwDOB0okGM4AesGR", "number": 44, "title": "v3.0.0-rc0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 129, "state": "closed", "created_at": "2022-06-03T05:14:22Z", "updated_at": "2022-08-08T06:16:39Z", "due_on": null, "closed_at": "2022-08-08T06:16:39Z"}, "comments": 6, "created_at": "2022-05-26T10:46:26Z", "updated_at": "2022-06-09T11:45:53Z", "closed_at": "2022-06-09T11:45:53Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3592", "html_url": "https://github.com/optuna/optuna/pull/3592", "diff_url": "https://github.com/optuna/optuna/pull/3592.diff", "patch_url": "https://github.com/optuna/optuna/pull/3592.patch", "merged_at": "2022-06-09T11:45:53Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\nFix #3556 \r\n\r\n## Description of the changes\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3592/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3592/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3567", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3567/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3567/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3567/events", "html_url": "https://github.com/optuna/optuna/pull/3567", "id": 1238164994, "node_id": "PR_kwDOB0okGM437sef", "number": 3567, "title": "Fix `CategoricalDistribution` with NaN", "user": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "knshnb", "id": 23695091, "node_id": "MDQ6VXNlcjIzNjk1MDkx", "avatar_url": "https://avatars.githubusercontent.com/u/23695091?v=4", "gravatar_id": "", "url": "https://api.github.com/users/knshnb", "html_url": "https://github.com/knshnb", "followers_url": "https://api.github.com/users/knshnb/followers", "following_url": "https://api.github.com/users/knshnb/following{/other_user}", "gists_url": "https://api.github.com/users/knshnb/gists{/gist_id}", "starred_url": "https://api.github.com/users/knshnb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/knshnb/subscriptions", "organizations_url": "https://api.github.com/users/knshnb/orgs", "repos_url": "https://api.github.com/users/knshnb/repos", "events_url": "https://api.github.com/users/knshnb/events{/privacy}", "received_events_url": "https://api.github.com/users/knshnb/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "knshnb", "id": 23695091, "node_id": "MDQ6VXNlcjIzNjk1MDkx", "avatar_url": "https://avatars.githubusercontent.com/u/23695091?v=4", "gravatar_id": "", "url": "https://api.github.com/users/knshnb", "html_url": "https://github.com/knshnb", "followers_url": "https://api.github.com/users/knshnb/followers", "following_url": "https://api.github.com/users/knshnb/following{/other_user}", "gists_url": "https://api.github.com/users/knshnb/gists{/gist_id}", "starred_url": "https://api.github.com/users/knshnb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/knshnb/subscriptions", "organizations_url": "https://api.github.com/users/knshnb/orgs", "repos_url": "https://api.github.com/users/knshnb/repos", "events_url": "https://api.github.com/users/knshnb/events{/privacy}", "received_events_url": "https://api.github.com/users/knshnb/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/44", "html_url": "https://github.com/optuna/optuna/milestone/44", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/44/labels", "id": 8044945, "node_id": "MI_kwDOB0okGM4AesGR", "number": 44, "title": "v3.0.0-rc0", "description": "", "creator": {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 129, "state": "closed", "created_at": "2022-06-03T05:14:22Z", "updated_at": "2022-08-08T06:16:39Z", "due_on": null, "closed_at": "2022-08-08T06:16:39Z"}, "comments": 9, "created_at": "2022-05-17T06:58:55Z", "updated_at": "2022-07-06T04:58:32Z", "closed_at": "2022-06-06T10:02:39Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3567", "html_url": "https://github.com/optuna/optuna/pull/3567", "diff_url": "https://github.com/optuna/optuna/pull/3567.diff", "patch_url": "https://github.com/optuna/optuna/pull/3567.patch", "merged_at": "2022-06-06T10:02:39Z"}, "body": "## Motivation\r\nThanks to @contramundum53's investigation, I found that `CategoricalDistribution` is buggy with NaN.  https://github.com/optuna/optuna/issues/3556#issuecomment-1128247623\r\n\r\n## Description of the changes\r\nFix `CategoricalDistribution`'s `__eq__` and `check_distribution_compatibility` to handle NaN.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3567/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3567/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3563", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3563/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3563/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3563/events", "html_url": "https://github.com/optuna/optuna/issues/3563", "id": 1236781241, "node_id": "I_kwDOB0okGM5Jt8i5", "number": 3563, "title": "Fix random seed related tests", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1157559138, "node_id": "MDU6TGFiZWwxMTU3NTU5MTM4", "url": "https://api.github.com/repos/optuna/optuna/labels/test", "name": "test", "color": "ffcce1", "default": false, "description": "Unit test."}, {"id": 3264287142, "node_id": "MDU6TGFiZWwzMjY0Mjg3MTQy", "url": "https://api.github.com/repos/optuna/optuna/labels/v3", "name": "v3", "color": "339FD7", "default": false, "description": "Issue/PR for Optuna version 3."}], "state": "closed", "locked": false, "assignee": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-05-16T08:07:28Z", "updated_at": "2022-05-31T07:54:00Z", "closed_at": "2022-05-31T07:54:00Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "In these files (under `/tests`), the `seed` method is used as a seed value:\r\n`integration_tests/test_botorch.py`, `multi_objective_tests/samplers_tests/test_motpe.py`, `multi_objective_tests/samplers_tests/test_nsga2.py`, `multi_objective_tests/samplers_tests/test_samplers.py`, `samplers_tests/test_nsgaii.py`, `samplers_tests/test_partial_fixed.py`, `samplers_tests/test_samplers.py`, `samplers_tests/tpe_tests/test_sampler.py`\r\n\r\nIn these files (under `/optuna`), the `RandomState` object is overwritten instead of calling the `seed` method:\r\n`multi_objective/samplers/_nsga2.py`, `samplers/_random.py`, `samplers/_tpe/sampler.py`, `samplers/nsgaii/_sampler.py`\r\n\r\nI might overlook some files.\r\n\r\n_Originally posted by @gasin in https://github.com/optuna/optuna/issues/3527#issuecomment-1120919233_\r\n\r\n---\r\nWe can find detailed discussion: https://github.com/optuna/optuna/pull/3527#discussion_r867450297", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3563/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3563/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3556", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3556/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3556/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3556/events", "html_url": "https://github.com/optuna/optuna/issues/3556", "id": 1234790534, "node_id": "I_kwDOB0okGM5JmWiG", "number": 3556, "title": "`GridSampler` does not stop the optimization when NaN in the `search_space`", "user": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}, {"id": 1846694757, "node_id": "MDU6TGFiZWwxODQ2Njk0NzU3", "url": "https://api.github.com/repos/optuna/optuna/labels/good%20first%20issue", "name": "good first issue", "color": "c2e0c6", "default": true, "description": "Good first issue for contribution."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2022-05-13T06:21:20Z", "updated_at": "2022-06-09T11:45:53Z", "closed_at": "2022-06-09T11:45:53Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "### Expected behavior\n\n`GridSampler` should stop the optimization when all grids are evaluated.\n\n### Environment\n\n- Optuna version: 3.0.0b1.dev\r\n- Python version: 3.8.6\r\n- OS: macOS-10.16-x86_64-i386-64bit\r\n- (Optional) Other libraries and their versions:\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\nSee steps to reproduce.\n```\n\n\n### Steps to reproduce\n\nIn the following code, `optimize` should stop with 2 trials, but it infinitely creates trials.\r\n\r\n```python\r\nimport optuna\r\nsampler = optuna.samplers.GridSampler({\"x\": [0, float(\"nan\")]})\r\nstudy = optuna.create_study(sampler=sampler)\r\nstudy.optimize(lambda _: 0)\r\n```\n\n### Additional context (optional)\n\nThe bug is coded here.\r\n\r\nhttps://github.com/optuna/optuna/blob/c23e17c70bd77489e223f3d4c322d86ec5a6ec66/optuna/samplers/_grid.py#L270\r\n\r\nIf the `param_value` is NaN, this condition is wrong.\r\n\r\n```python\r\nfloat(\"nan\") != float(\"nan\")  # True\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3556/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3556/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3544", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3544/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3544/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3544/events", "html_url": "https://github.com/optuna/optuna/pull/3544", "id": 1228548509, "node_id": "PR_kwDOB0okGM43chSH", "number": 3544, "title": "Take the same search space as in `CategoricalDistribution` by `GridSampler`", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, {"login": "contramundum53", "id": 24619922, "node_id": "MDQ6VXNlcjI0NjE5OTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24619922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/contramundum53", "html_url": "https://github.com/contramundum53", "followers_url": "https://api.github.com/users/contramundum53/followers", "following_url": "https://api.github.com/users/contramundum53/following{/other_user}", "gists_url": "https://api.github.com/users/contramundum53/gists{/gist_id}", "starred_url": "https://api.github.com/users/contramundum53/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/contramundum53/subscriptions", "organizations_url": "https://api.github.com/users/contramundum53/orgs", "repos_url": "https://api.github.com/users/contramundum53/repos", "events_url": "https://api.github.com/users/contramundum53/events{/privacy}", "received_events_url": "https://api.github.com/users/contramundum53/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/43", "html_url": "https://github.com/optuna/optuna/milestone/43", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/43/labels", "id": 7856382, "node_id": "MI_kwDOB0okGM4Ad-D-", "number": 43, "title": "v3.0.0-b1", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 99, "state": "closed", "created_at": "2022-04-08T05:07:30Z", "updated_at": "2022-06-06T07:09:50Z", "due_on": null, "closed_at": "2022-06-06T07:09:50Z"}, "comments": 2, "created_at": "2022-05-07T06:56:17Z", "updated_at": "2022-05-18T06:29:13Z", "closed_at": "2022-05-16T07:56:35Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3544", "html_url": "https://github.com/optuna/optuna/pull/3544", "diff_url": "https://github.com/optuna/optuna/pull/3544.diff", "patch_url": "https://github.com/optuna/optuna/pull/3544.patch", "merged_at": "2022-05-16T07:56:35Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\nFix #3535.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\nRemove `sorted` part.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3544/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3544/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3541", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3541/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3541/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3541/events", "html_url": "https://github.com/optuna/optuna/pull/3541", "id": 1227786826, "node_id": "PR_kwDOB0okGM43aUxR", "number": 3541, "title": "Replace `ValueError` with `RuntimeError` in `get_best_trial`", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/43", "html_url": "https://github.com/optuna/optuna/milestone/43", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/43/labels", "id": 7856382, "node_id": "MI_kwDOB0okGM4Ad-D-", "number": 43, "title": "v3.0.0-b1", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 99, "state": "closed", "created_at": "2022-04-08T05:07:30Z", "updated_at": "2022-06-06T07:09:50Z", "due_on": null, "closed_at": "2022-06-06T07:09:50Z"}, "comments": 1, "created_at": "2022-05-06T12:12:43Z", "updated_at": "2022-05-12T07:22:37Z", "closed_at": "2022-05-12T05:46:09Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3541", "html_url": "https://github.com/optuna/optuna/pull/3541", "diff_url": "https://github.com/optuna/optuna/pull/3541.diff", "patch_url": "https://github.com/optuna/optuna/pull/3541.patch", "merged_at": "2022-05-12T05:46:09Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\nResolve #3491.\r\n\r\n[`optuna.storages.RDBStorage.get_best_trial`](\r\nhttps://optuna.readthedocs.io/en/latest/reference/generated/optuna.storages.RDBStorage.html#optuna.storages.RDBStorage.get_best_trial) says \r\n>[RuntimeError](https://docs.python.org/3/library/exceptions.html#RuntimeError) \u2013 If the study has more than one direction.\r\n\r\nHowever, the implementations raise `ValueError` except for [`BaseStorage`](https://github.com/optuna/optuna/blob/f00abac7d53bb29e53e7c8bd13e9b4be9e0f9d44/optuna/storages/_base.py#L619-L623). \r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\nReplace `ValueError` with `RuntimeError` in `get_best_trial` when a study has multiple objective values.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3541/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3541/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3535", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3535/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3535/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3535/events", "html_url": "https://github.com/optuna/optuna/issues/3535", "id": 1225718956, "node_id": "I_kwDOB0okGM5JDvys", "number": 3535, "title": "`GridSearchSampler` raises `TypeError` when `choices` of `CategoricalDistribution` are not comparable", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-05-04T18:17:26Z", "updated_at": "2022-05-16T07:56:35Z", "closed_at": "2022-05-16T07:56:35Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nThe folliwing grid search based optimisation works without any error because default sampler works fine.\r\n```python\r\nimport optuna\r\n\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_float(\"x\", -100, 100)\r\n    y = trial.suggest_categorical(\"y\", [None, 1])\r\n    if y is None:\r\n        y = -1\r\n    return x ** 2 + y\r\n\r\n# Grid search.\r\nsearch_space = {\"x\": [-50, 0, 50], \"y\": [None, 1]}\r\nstudy = optuna.create_study(sampler=optuna.samplers.GridSampler(search_space))\r\nstudy.optimize(objective, n_trials=20)\r\n\r\n\r\n# Note Random search + TPE works well.\r\n# study.optimize(objective, n_trials=20)\r\n```\r\n\r\n### Environment\r\n\r\n- Optuna version: 3.0.0b1.dev\r\n- Python version: 3.9.12\r\n- OS: macOS-10.16-x86_64-i386-64bit\r\n- (Optional) Other libraries and their versions:\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\nTypeError                                 Traceback (most recent call last)\r\nInput In [15], in <cell line: 17>()\r\n     14 study.optimize(objective, n_trials=20)\r\n     16 # Grid search\r\n---> 17 study = optuna.create_study(sampler=optuna.samplers.GridSampler(search_space))\r\n     18 study.optimize(objective, n_trials=20)\r\n\r\nFile ~/Documents/optuna/optuna/samplers/_grid.py:112, in GridSampler.__init__(self, search_space)\r\n    109 for param_name, param_values in sorted(search_space.items(), key=lambda x: x[0]):\r\n    110     param_values = cast(SortableParamValueSequenceType, param_values)\r\n--> 112     self._search_space[param_name] = sorted(param_values)\r\n    114 self._all_grids = list(itertools.product(*self._search_space.values()))\r\n    115 self._param_names = sorted(search_space.keys())\r\n\r\nTypeError: '<' not supported between instances of 'int' and 'NoneType'\r\n```\r\n\r\n\r\n\r\n### Steps to reproduce\r\n\r\n1. Run the code above\r\n2.\r\n3.\r\n```python\r\n# python code\r\n```\r\n\r\n\r\n### Additional context (optional)\r\n\r\nSince grid search sampler implementation sorts `choices`, the current implementation assumes the choices are sortable. ", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3535/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3535/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3532", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3532/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3532/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3532/events", "html_url": "https://github.com/optuna/optuna/pull/3532", "id": 1225040614, "node_id": "PR_kwDOB0okGM43RhOy", "number": 3532, "title": "Fix `--verbose` and `--quiet` options in CLI", "user": {"login": "nyanhi", "id": 63458275, "node_id": "MDQ6VXNlcjYzNDU4Mjc1", "avatar_url": "https://avatars.githubusercontent.com/u/63458275?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nyanhi", "html_url": "https://github.com/nyanhi", "followers_url": "https://api.github.com/users/nyanhi/followers", "following_url": "https://api.github.com/users/nyanhi/following{/other_user}", "gists_url": "https://api.github.com/users/nyanhi/gists{/gist_id}", "starred_url": "https://api.github.com/users/nyanhi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nyanhi/subscriptions", "organizations_url": "https://api.github.com/users/nyanhi/orgs", "repos_url": "https://api.github.com/users/nyanhi/repos", "events_url": "https://api.github.com/users/nyanhi/events{/privacy}", "received_events_url": "https://api.github.com/users/nyanhi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/43", "html_url": "https://github.com/optuna/optuna/milestone/43", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/43/labels", "id": 7856382, "node_id": "MI_kwDOB0okGM4Ad-D-", "number": 43, "title": "v3.0.0-b1", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 99, "state": "closed", "created_at": "2022-04-08T05:07:30Z", "updated_at": "2022-06-06T07:09:50Z", "due_on": null, "closed_at": "2022-06-06T07:09:50Z"}, "comments": 3, "created_at": "2022-05-04T08:02:00Z", "updated_at": "2022-05-12T06:20:49Z", "closed_at": "2022-05-12T06:20:43Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3532", "html_url": "https://github.com/optuna/optuna/pull/3532", "diff_url": "https://github.com/optuna/optuna/pull/3532.diff", "patch_url": "https://github.com/optuna/optuna/pull/3532.patch", "merged_at": "2022-05-12T06:20:43Z"}, "body": "## Motivation\r\nTo address the issue #3485.\r\n\r\n## Description of the changes\r\n`_OptunaApp` will set verbosity with the same value specified by its super `App` in `cliff.app`. Also test code is added.\r\nRef. https://github.com/openstack/cliff/blob/master/cliff/app.py#L211-L219", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3532/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3532/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3516", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3516/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3516/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3516/events", "html_url": "https://github.com/optuna/optuna/issues/3516", "id": 1216754724, "node_id": "I_kwDOB0okGM5IhjQk", "number": 3516, "title": "`GridSampler` is not reproducible", "user": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}, {"id": 1846694757, "node_id": "MDU6TGFiZWwxODQ2Njk0NzU3", "url": "https://api.github.com/repos/optuna/optuna/labels/good%20first%20issue", "name": "good first issue", "color": "c2e0c6", "default": true, "description": "Good first issue for contribution."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-04-27T04:03:20Z", "updated_at": "2022-05-10T01:08:29Z", "closed_at": "2022-05-10T01:08:29Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "### Expected behavior\n\n`GridSampler` does not have a `seed` argument, but it randomly shuffles an evaluation order of trials. It makes optimization results unreproducible if objective functions depend on previous trials, e.g., pruning. We should add a `seed` argument like `TPESampler` and `RandomSampler`.\n\n### Environment\n\n- Optuna version: 3.0.0b1.dev\r\n- Python version: 3.8.6\r\n- OS: macOS-10.16-x86_64-i386-64bit\r\n- (Optional) Other libraries and their versions:\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\nSee steps to reproduce.\n```\n\n\n### Steps to reproduce\n\n```python\r\nimport optuna\r\n\r\ndef objective(trial):\r\n    a = trial.suggest_int(\"a\", 0, 2)\r\n    return a + trial.number\r\n\r\nsampler = optuna.samplers.GridSampler({\"a\": [0, 1, 2]})\r\nstudy = optuna.create_study(sampler=sampler)\r\nstudy.optimize(objective)\r\n```\r\n\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3516/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3516/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3511", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3511/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3511/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3511/events", "html_url": "https://github.com/optuna/optuna/issues/3511", "id": 1214440659, "node_id": "I_kwDOB0okGM5IYuTT", "number": 3511, "title": "Fix test error in `tests/integration_tests/test_catboost.py::test_catboost_pruning_callback_errors`", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1846694757, "node_id": "MDU6TGFiZWwxODQ2Njk0NzU3", "url": "https://api.github.com/repos/optuna/optuna/labels/good%20first%20issue", "name": "good first issue", "color": "c2e0c6", "default": true, "description": "Good first issue for contribution."}, {"id": 1947561256, "node_id": "MDU6TGFiZWwxOTQ3NTYxMjU2", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.integration", "name": "optuna.integration", "color": "1c659e", "default": false, "description": "Related to the `optuna.integration` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2022-04-25T12:33:00Z", "updated_at": "2022-12-16T04:59:30Z", "closed_at": "2022-12-16T04:59:30Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nNo error when running pytest:\r\n\r\n```sh\r\npytest tests/integration_tests/test_catboost.py::test_catboost_pruning_callback_errors\r\n```\r\n\r\n### Environment\r\n\r\n- Optuna version:3.0.0b1.dev\r\n- Python version: 3.8.13\r\n- OS:macOS-10.16-x86_64-i386-64bit\r\n- (Optional) Other libraries and their versions:\r\n    - catboost: 1.0.5\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\nopt/homebrew/Caskroom/miniconda/base/envs/py38/lib/python3.8/traceback.py:481: in __init__\r\n    cause = TracebackException(\r\n/opt/homebrew/Caskroom/miniconda/base/envs/py38/lib/python3.8/traceback.py:481: in __init__\r\n    cause = TracebackException(\r\n/opt/homebrew/Caskroom/miniconda/base/envs/py38/lib/python3.8/traceback.py:481: in __init__\r\n    cause = TracebackException(\r\n/opt/homebrew/Caskroom/miniconda/base/envs/py38/lib/python3.8/traceback.py:481: in __init__\r\n    cause = TracebackException(\r\n/opt/homebrew/Caskroom/miniconda/base/envs/py38/lib/python3.8/traceback.py:481: in __init__\r\n    cause = TracebackException(\r\n/opt/homebrew/Caskroom/miniconda/base/envs/py38/lib/python3.8/traceback.py:481: in __init__\r\n    cause = TracebackException(\r\n/opt/homebrew/Caskroom/miniconda/base/envs/py38/lib/python3.8/traceback.py:481: in __init__\r\n    cause = TracebackException(\r\n/opt/homebrew/Caskroom/miniconda/base/envs/py38/lib/python3.8/traceback.py:481: in __init__\r\n    cause = TracebackException(\r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\r\n\r\nself = <traceback.TracebackException object at 0x7fdb61bd5e80>, exc_type = <class 'SystemError'>\r\nexc_value = SystemError(\"<class 'types.SimpleNamespace'> returned a result with an error set\")\r\nexc_traceback = <traceback object at 0x7fdb61cb6c00>\r\n\r\n    def __init__(self, exc_type, exc_value, exc_traceback, *, limit=None,\r\n            lookup_lines=True, capture_locals=False, _seen=None):\r\n        # NB: we need to accept exc_traceback, exc_value, exc_traceback to\r\n        # permit backwards compat with the existing API, otherwise we\r\n        # need stub thunk objects just to glue it together.\r\n        # Handle loops in __cause__ or __context__.\r\n        if _seen is None:\r\n            _seen = set()\r\n>       _seen.add(id(exc_value))\r\nE       RecursionError: maximum recursion depth exceeded while calling a Python object\r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/py38/lib/python3.8/traceback.py:476: RecursionError\r\n------------------------------------------------------------ Captured stderr call -------------------------------------------------------------\r\n[I 2022-04-25 21:28:29,880] A new study created in memory with name: no-name-992ca1b6-c9fd-4191-b672-cdb9677f327e\r\n============================================================== warnings summary ===============================================================\r\ntests/integration_tests/test_catboost.py::test_catboost_pruning_callback_errors[foo_metric-None]\r\ntests/integration_tests/test_catboost.py::test_catboost_pruning_callback_errors[AUC-100]\r\n  /Users/nzw/Documents/optuna/tests/integration_tests/test_catboost.py:98: ExperimentalWarning: CatBoostPruningCallback is experimental (supported from v3.0.0). The interface can change in the future.\r\n    pruning_callback = CatBoostPruningCallback(trial, metric, eval_set_index)\r\n\r\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\r\n=========================================================== short test summary info ===========================================================\r\nFAILED tests/integration_tests/test_catboost.py::test_catboost_pruning_callback_errors[foo_metric-None] - RecursionError: maximum recursion ...\r\nFAILED tests/integration_tests/test_catboost.py::test_catboost_pruning_callback_errors[AUC-100] - RecursionError: maximum recursion depth ex...\r\n\r\n\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\n```python\r\npytest tests/integration_tests/test_catboost.py::test_catboost_pruning_callback_errors\r\n```\r\n\r\n\r\n### Additional context (optional)\r\n\r\nOptuna's Linux CI also faced the same error when I sent https://github.com/optuna/optuna/pull/3510. The failed CI result is [here](https://github.com/optuna/optuna/runs/6156882373?check_suite_focus=true).\r\n\r\n\r\nMinimal reproducible code is \r\n\r\n```python\r\nimport catboost as cb\r\nimport numpy as np\r\n\u200b\r\nimport optuna\r\nfrom optuna.integration.catboost import CatBoostPruningCallback\r\n\u200b\r\n\u200b\r\ndef objective(trial: optuna.trial.Trial) -> float:\r\n    metric, eval_set_index = \"AUC\", 100\r\n\u200b\r\n    train_x = np.asarray([[1.0], [2.0]])\r\n    train_y = np.asarray([[1.0], [0.0]])\r\n    valid_x = np.asarray([[1.0], [2.0]])\r\n    valid_y = np.asarray([[1.0], [0.0]])\r\n\u200b\r\n    pruning_callback = CatBoostPruningCallback(trial, metric, eval_set_index)\r\n    param = {\"objective\": \"Logloss\", \"eval_metric\": \"AUC\",}\r\n\u200b\r\n    gbm = cb.CatBoostClassifier(**param)\r\n    gbm.fit(train_x, train_y, eval_set=[(valid_x, valid_y)],\r\n        callbacks=[pruning_callback]\r\n    )\r\n\u200b\r\n    return 1.0\r\n\u200b\r\nstudy = optuna.create_study()\r\n\u200b\r\nstudy.optimize(objective, n_trials=1)\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3511/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3511/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3500", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3500/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3500/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3500/events", "html_url": "https://github.com/optuna/optuna/pull/3500", "id": 1213573064, "node_id": "PR_kwDOB0okGM42rglD", "number": 3500, "title": "Filter trials with nonfinite value in `optuna.visualization.plot_param_importances` and `optuna.visualization.matplotlib.plot_param_importance` ", "user": {"login": "takoika", "id": 16839037, "node_id": "MDQ6VXNlcjE2ODM5MDM3", "avatar_url": "https://avatars.githubusercontent.com/u/16839037?v=4", "gravatar_id": "", "url": "https://api.github.com/users/takoika", "html_url": "https://github.com/takoika", "followers_url": "https://api.github.com/users/takoika/followers", "following_url": "https://api.github.com/users/takoika/following{/other_user}", "gists_url": "https://api.github.com/users/takoika/gists{/gist_id}", "starred_url": "https://api.github.com/users/takoika/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/takoika/subscriptions", "organizations_url": "https://api.github.com/users/takoika/orgs", "repos_url": "https://api.github.com/users/takoika/repos", "events_url": "https://api.github.com/users/takoika/events{/privacy}", "received_events_url": "https://api.github.com/users/takoika/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1964887919, "node_id": "MDU6TGFiZWwxOTY0ODg3OTE5", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.importance", "name": "optuna.importance", "color": "1c659e", "default": false, "description": "Related to the `optuna.importance` submodule. This is automatically labeled by github-actions."}, {"id": 3264287142, "node_id": "MDU6TGFiZWwzMjY0Mjg3MTQy", "url": "https://api.github.com/repos/optuna/optuna/labels/v3", "name": "v3", "color": "339FD7", "default": false, "description": "Issue/PR for Optuna version 3."}, {"id": 4064443658, "node_id": "LA_kwDOB0okGM7yQn0K", "url": "https://api.github.com/repos/optuna/optuna/labels/sprint-20220424", "name": "sprint-20220424", "color": "93a8d8", "default": false, "description": "PR from the online sprint event Apr 24, 2022."}], "state": "closed", "locked": false, "assignee": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, {"login": "xadrianzetx", "id": 37713008, "node_id": "MDQ6VXNlcjM3NzEzMDA4", "avatar_url": "https://avatars.githubusercontent.com/u/37713008?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xadrianzetx", "html_url": "https://github.com/xadrianzetx", "followers_url": "https://api.github.com/users/xadrianzetx/followers", "following_url": "https://api.github.com/users/xadrianzetx/following{/other_user}", "gists_url": "https://api.github.com/users/xadrianzetx/gists{/gist_id}", "starred_url": "https://api.github.com/users/xadrianzetx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xadrianzetx/subscriptions", "organizations_url": "https://api.github.com/users/xadrianzetx/orgs", "repos_url": "https://api.github.com/users/xadrianzetx/repos", "events_url": "https://api.github.com/users/xadrianzetx/events{/privacy}", "received_events_url": "https://api.github.com/users/xadrianzetx/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/43", "html_url": "https://github.com/optuna/optuna/milestone/43", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/43/labels", "id": 7856382, "node_id": "MI_kwDOB0okGM4Ad-D-", "number": 43, "title": "v3.0.0-b1", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 99, "state": "closed", "created_at": "2022-04-08T05:07:30Z", "updated_at": "2022-06-06T07:09:50Z", "due_on": null, "closed_at": "2022-06-06T07:09:50Z"}, "comments": 6, "created_at": "2022-04-24T07:27:29Z", "updated_at": "2022-05-01T08:35:53Z", "closed_at": "2022-05-01T08:35:45Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3500", "html_url": "https://github.com/optuna/optuna/pull/3500", "diff_url": "https://github.com/optuna/optuna/pull/3500.diff", "patch_url": "https://github.com/optuna/optuna/pull/3500.patch", "merged_at": "2022-05-01T08:35:45Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nThis PR is a part of #3382. `optuna.visualization.plot_param_importances` and `optuna.visualization.matplotlib.plot_param_importance` will come to handle non-finite value properly.\r\n\r\n## Description of the changes\r\nCurrently `plot_param_importances` accepts two evaluators: `MeanDecreaseImpurityImportanceEvaluator` and `MeanDecreaseImpurityImportanceEvaluator`. So this PR changes two evaluator to filter trials with an infinite value.\r\n<!-- Describe the changes in this PR. -->\r\n- [x] Filter trials with non-finite value\r\n- [x] Add unit tests\r\n- [x] Verify obtained graphs\r\n\r\nObtained graphs are below by using https://gist.github.com/HideakiImamura/67a150dec5774a18732527875774a9fe .\r\n\r\n* wtih `FanovaImportanceEvaluator` with `Plotly`\r\n![plt_fnova](https://user-images.githubusercontent.com/16839037/165527517-5616ff07-7e59-4f08-a95d-432b75d29bc4.png)\r\n\r\n* with `FnovaImportanceEvaluator` with `Matplotlib`\r\n![mpl_fnova](https://user-images.githubusercontent.com/16839037/165527598-554a1979-1723-4ae5-884b-e3c21991fbd7.png)\r\n\r\n* wtih `MeanDecreaseImpurityImportanceEvaluator` with `Plotly`\r\n![plt_mean](https://user-images.githubusercontent.com/16839037/165527640-74c2dd51-5410-4dca-ac04-ed89bbbeb701.png)\r\n\r\n* wtih `MeanDecreaseImpurityImportanceEvaluator` with `Matplotlib`\r\n\r\n![mpl_mean](https://user-images.githubusercontent.com/16839037/165527666-57c539e2-cbaf-472d-8b4f-91dd736e339c.png)\r\n\r\n\r\nNote that I am not sure how filtering nonfinite values affect obtained importance scores.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3500/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3500/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3499", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3499/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3499/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3499/events", "html_url": "https://github.com/optuna/optuna/pull/3499", "id": 1213556375, "node_id": "PR_kwDOB0okGM42rdXs", "number": 3499, "title": "Remove `-v` option of `optuna study set-user-attr` command", "user": {"login": "nyanhi", "id": 63458275, "node_id": "MDQ6VXNlcjYzNDU4Mjc1", "avatar_url": "https://avatars.githubusercontent.com/u/63458275?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nyanhi", "html_url": "https://github.com/nyanhi", "followers_url": "https://api.github.com/users/nyanhi/followers", "following_url": "https://api.github.com/users/nyanhi/following{/other_user}", "gists_url": "https://api.github.com/users/nyanhi/gists{/gist_id}", "starred_url": "https://api.github.com/users/nyanhi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nyanhi/subscriptions", "organizations_url": "https://api.github.com/users/nyanhi/orgs", "repos_url": "https://api.github.com/users/nyanhi/repos", "events_url": "https://api.github.com/users/nyanhi/events{/privacy}", "received_events_url": "https://api.github.com/users/nyanhi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 4064443658, "node_id": "LA_kwDOB0okGM7yQn0K", "url": "https://api.github.com/repos/optuna/optuna/labels/sprint-20220424", "name": "sprint-20220424", "color": "93a8d8", "default": false, "description": "PR from the online sprint event Apr 24, 2022."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/43", "html_url": "https://github.com/optuna/optuna/milestone/43", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/43/labels", "id": 7856382, "node_id": "MI_kwDOB0okGM4Ad-D-", "number": 43, "title": "v3.0.0-b1", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 99, "state": "closed", "created_at": "2022-04-08T05:07:30Z", "updated_at": "2022-06-06T07:09:50Z", "due_on": null, "closed_at": "2022-06-06T07:09:50Z"}, "comments": 1, "created_at": "2022-04-24T06:01:27Z", "updated_at": "2022-04-24T07:34:41Z", "closed_at": "2022-04-24T07:34:36Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3499", "html_url": "https://github.com/optuna/optuna/pull/3499", "diff_url": "https://github.com/optuna/optuna/pull/3499.diff", "patch_url": "https://github.com/optuna/optuna/pull/3499.patch", "merged_at": "2022-04-24T07:34:36Z"}, "body": "## Motivation\r\nTo address the issue #3483.\r\n\r\n## Description of the changes\r\nRemoved `-v` option of `optuna study set-user-attr` in `_StudySetUserAttr()` because it conflicts with `--verbose` while it was intended for `--value`.\r\n\r\nPlease kindly let me know if I missed any point, sorry I'm still new with CLI.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3499/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3499/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3492", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3492/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3492/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3492/events", "html_url": "https://github.com/optuna/optuna/pull/3492", "id": 1213506461, "node_id": "PR_kwDOB0okGM42rXC3", "number": 3492, "title": "Import `COLOR_SCALE` inside import util context", "user": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/43", "html_url": "https://github.com/optuna/optuna/milestone/43", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/43/labels", "id": 7856382, "node_id": "MI_kwDOB0okGM4Ad-D-", "number": 43, "title": "v3.0.0-b1", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 99, "state": "closed", "created_at": "2022-04-08T05:07:30Z", "updated_at": "2022-06-06T07:09:50Z", "due_on": null, "closed_at": "2022-06-06T07:09:50Z"}, "comments": 1, "created_at": "2022-04-24T02:30:08Z", "updated_at": "2022-04-24T04:54:38Z", "closed_at": "2022-04-24T03:10:10Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3492", "html_url": "https://github.com/optuna/optuna/pull/3492", "diff_url": "https://github.com/optuna/optuna/pull/3492.diff", "patch_url": "https://github.com/optuna/optuna/pull/3492.patch", "merged_at": "2022-04-24T03:10:09Z"}, "body": "The error message when `plotly` is not available was unintentionally changed in https://github.com/optuna/optuna/pull/3376. This PR makes the behavior consistent with the current stable release of Optuna (Thank you for reporting @fukatani!).\r\n\r\n\r\n### master\r\n\r\n```sh\r\nTraceback (most recent call last):\r\n  File \"/Users/himkt/work/github.com/himkt/optuna/main.py\", line 12, in <module>\r\n    optuna.visualization.plot_pareto_front(study)\r\n  File \"/Users/himkt/work/github.com/himkt/optuna/optuna/_imports.py\", line 125, in __getattr__\r\n    return getattr(self._load(), item)\r\n  File \"/Users/himkt/work/github.com/himkt/optuna/optuna/_imports.py\", line 120, in _load\r\n    module = importlib.import_module(self._name)\r\n  File \"/opt/homebrew-x86_64/Cellar/python@3.9/3.9.10/Frameworks/Python.framework/Versions/3.9/lib/python3.9/importlib/__init__.py\", line 127, in import_module\r\n    return _bootstrap._gcd_import(name[level:], package, level)\r\n  File \"<frozen importlib._bootstrap>\", line 1030, in _gcd_import\r\n  File \"<frozen importlib._bootstrap>\", line 1007, in _find_and_load\r\n  File \"<frozen importlib._bootstrap>\", line 986, in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 680, in _load_unlocked\r\n  File \"<frozen importlib._bootstrap_external>\", line 850, in exec_module\r\n  File \"<frozen importlib._bootstrap>\", line 228, in _call_with_frames_removed\r\n  File \"/Users/himkt/work/github.com/himkt/optuna/optuna/visualization/__init__.py\", line 2, in <module>\r\n    from optuna.visualization._contour import plot_contour\r\n  File \"/Users/himkt/work/github.com/himkt/optuna/optuna/visualization/_contour.py\", line 21, in <module>\r\n    from optuna.visualization._utils import COLOR_SCALE\r\nImportError: cannot import name 'COLOR_SCALE' from 'optuna.visualization._utils' (/Users/himkt/work/github.com/himkt/optuna/optuna/visualization/_utils.py)\r\n```\r\n\r\n### This PR (v2.10.0)\r\n\r\n```sh\r\n/Users/himkt/work/github.com/himkt/optuna/main.py:12: ExperimentalWarning: plot_pareto_front is experimental (supported from v2.4.0). The interface can change in the future.\r\n  optuna.visualization.plot_pareto_front(study)\r\nTraceback (most recent call last):\r\n  File \"/Users/himkt/work/github.com/himkt/optuna/optuna/visualization/_plotly_imports.py\", line 7, in <module>\r\n    import plotly  # NOQA\r\nModuleNotFoundError: No module named 'plotly'\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/Users/himkt/work/github.com/himkt/optuna/main.py\", line 12, in <module>\r\n    optuna.visualization.plot_pareto_front(study)\r\n  File \"/Users/himkt/work/github.com/himkt/optuna/optuna/_experimental.py\", line 68, in new_func\r\n    return func(*args, **kwargs)  # type: ignore\r\n  File \"/Users/himkt/work/github.com/himkt/optuna/optuna/visualization/_pareto_front.py\", line 108, in plot_pareto_front\r\n    _imports.check()\r\n  File \"/Users/himkt/work/github.com/himkt/optuna/optuna/_imports.py\", line 89, in check\r\n    raise ImportError(message) from exc_value\r\nImportError: Tried to import 'plotly' but failed. Please make sure that the package is installed correctly to use this feature. Actual error: No module named 'plotly'.\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3492/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3492/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3485", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3485/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3485/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3485/events", "html_url": "https://github.com/optuna/optuna/issues/3485", "id": 1212254933, "node_id": "I_kwDOB0okGM5IQYrV", "number": 3485, "title": "`--verbose` and `--quiet` option in CLI is not working", "user": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-04-22T11:40:48Z", "updated_at": "2022-05-12T06:20:43Z", "closed_at": "2022-05-12T06:20:43Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "### Expected behavior\n\n`--verbose` and `--quiet` options in CLI should change the logging level of the Optuna's logger.\n\n### Environment\n\n- Optuna version: 3.0.0b1.dev\r\n- Python version: 3.8.2\r\n- OS: macOS-10.16-x86_64-i386-64bit\r\n- (Optional) Other libraries and their versions:\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\nSee steps to reproduce.\n```\n\n\n### Steps to reproduce\n\n```sh\r\n~/optuna$ optuna create-study --storage sqlite:///test.db --study-name test-study -q\r\n[I 2022-04-22 20:36:11,192] A new study created in RDB with name: test-study\r\ntest-study\r\n```\r\n\r\nThe INFO level logging message should be suppressed by `-q`.\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3485/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3485/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3483", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3483/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3483/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3483/events", "html_url": "https://github.com/optuna/optuna/issues/3483", "id": 1212012296, "node_id": "I_kwDOB0okGM5IPdcI", "number": 3483, "title": "`-v` option of `optuna study set-user-attr` command is not working", "user": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}, {"id": 1846694757, "node_id": "MDU6TGFiZWwxODQ2Njk0NzU3", "url": "https://api.github.com/repos/optuna/optuna/labels/good%20first%20issue", "name": "good first issue", "color": "c2e0c6", "default": true, "description": "Good first issue for contribution."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-04-22T08:28:54Z", "updated_at": "2022-04-24T07:35:42Z", "closed_at": "2022-04-24T07:35:42Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "### Expected behavior\n\n`-v` option as the abbreviation of `--value` is not working. `-v` option conflicts `--verbose` and `--value` in `optuna study set-user-attr`. We should remove `-v` for the abbreviation of `--value` and use it as the abbreviation of `--verbose` because it is `cliff`'s default option.\n\n### Environment\n\n- Optuna version: 3.0.0b1.dev\r\n- Python version: 3.8.2\r\n- OS: macOS-10.16-x86_64-i386-64bit\r\n- (Optional) Other libraries and their versions:\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\nusage: optuna study set-user-attr [-h] [--study STUDY] [--study-name STUDY_NAME] --key KEY --value VALUE\r\noptuna study set-user-attr: error: the following arguments are required: --value/-v\n```\n\n\n### Steps to reproduce\n\n```sh\r\noptuna create-study --storage sqlite:///test.db --study-name test-study\r\noptuna study set-user-attr --storage sqlite:///test.db --study-name test-study --key test-key -v test\r\n```\r\n\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3483/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3483/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3452", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3452/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3452/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3452/events", "html_url": "https://github.com/optuna/optuna/issues/3452", "id": 1194728078, "node_id": "I_kwDOB0okGM5HNhqO", "number": 3452, "title": "module 'optuna.distributions' has no attribute 'FloatDistribution'", "user": {"login": "DRJYYDS", "id": 102657334, "node_id": "U_kgDOBh5tNg", "avatar_url": "https://avatars.githubusercontent.com/u/102657334?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DRJYYDS", "html_url": "https://github.com/DRJYYDS", "followers_url": "https://api.github.com/users/DRJYYDS/followers", "following_url": "https://api.github.com/users/DRJYYDS/following{/other_user}", "gists_url": "https://api.github.com/users/DRJYYDS/gists{/gist_id}", "starred_url": "https://api.github.com/users/DRJYYDS/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DRJYYDS/subscriptions", "organizations_url": "https://api.github.com/users/DRJYYDS/orgs", "repos_url": "https://api.github.com/users/DRJYYDS/repos", "events_url": "https://api.github.com/users/DRJYYDS/events{/privacy}", "received_events_url": "https://api.github.com/users/DRJYYDS/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-04-06T14:52:22Z", "updated_at": "2022-04-07T11:52:56Z", "closed_at": "2022-04-07T11:52:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nCannot import optuna\n\n### Environment\n\n- Optuna version:optuna-3.0.0b0.dev0\r\n- Python version:3.6.9\r\n- OS:Linux-4.15.0-122-generic-x86_64-with-Ubuntu-18.04-bionic\r\n- (Optional) Other libraries and their versions:\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-15-d058bd6e1fdc> in <module>\r\n     14 import pickle\r\n     15 import os\r\n---> 16 import optuna\r\n     17 \r\n     18 # # Training settings\r\n\r\n/usr/local/lib/python3.6/dist-packages/optuna/__init__.py in <module>\r\n      5 from optuna import integration\r\n      6 from optuna import logging\r\n----> 7 from optuna import multi_objective\r\n      8 from optuna import pruners\r\n      9 from optuna import samplers\r\n\r\n/usr/local/lib/python3.6/dist-packages/optuna/multi_objective/__init__.py in <module>\r\n      1 from optuna._imports import _LazyImport\r\n----> 2 from optuna.multi_objective import samplers  # NOQA\r\n      3 from optuna.multi_objective import study  # NOQA\r\n      4 from optuna.multi_objective import trial  # NOQA\r\n      5 from optuna.multi_objective.study import create_study  # NOQA\r\n\r\n/usr/local/lib/python3.6/dist-packages/optuna/multi_objective/samplers/__init__.py in <module>\r\n----> 1 from optuna.multi_objective.samplers._adapter import _MultiObjectiveSamplerAdapter  # NOQA\r\n      2 from optuna.multi_objective.samplers._base import BaseMultiObjectiveSampler  # NOQA\r\n      3 from optuna.multi_objective.samplers._motpe import MOTPEMultiObjectiveSampler  # NOQA\r\n      4 from optuna.multi_objective.samplers._nsga2 import NSGAIIMultiObjectiveSampler  # NOQA\r\n      5 from optuna.multi_objective.samplers._random import RandomMultiObjectiveSampler  # NOQA\r\n\r\n/usr/local/lib/python3.6/dist-packages/optuna/multi_objective/samplers/_adapter.py in <module>\r\n      4 from optuna import multi_objective\r\n      5 from optuna.distributions import BaseDistribution\r\n----> 6 from optuna.samplers import BaseSampler\r\n      7 from optuna.study import Study\r\n      8 from optuna.trial import FrozenTrial\r\n\r\n/usr/local/lib/python3.6/dist-packages/optuna/samplers/__init__.py in <module>\r\n      8 from optuna.samplers._search_space import intersection_search_space\r\n      9 from optuna.samplers._search_space import IntersectionSearchSpace\r\n---> 10 from optuna.samplers._tpe.multi_objective_sampler import MOTPESampler\r\n     11 from optuna.samplers._tpe.sampler import TPESampler\r\n     12 from optuna.samplers.nsgaii._sampler import NSGAIISampler\r\n\r\n/usr/local/lib/python3.6/dist-packages/optuna/samplers/_tpe/multi_objective_sampler.py in <module>\r\n      5 \r\n      6 from optuna._deprecated import deprecated\r\n----> 7 from optuna.samplers._tpe.sampler import TPESampler\r\n      8 \r\n      9 \r\n\r\n/usr/local/lib/python3.6/dist-packages/optuna/samplers/_tpe/sampler.py in <module>\r\n     22 from optuna.samplers._search_space.group_decomposed import _GroupDecomposedSearchSpace\r\n     23 from optuna.samplers._search_space.group_decomposed import _SearchSpaceGroup\r\n---> 24 from optuna.samplers._tpe.parzen_estimator import _ParzenEstimator\r\n     25 from optuna.samplers._tpe.parzen_estimator import _ParzenEstimatorParameters\r\n     26 from optuna.study import Study\r\n\r\n/usr/local/lib/python3.6/dist-packages/optuna/samplers/_tpe/parzen_estimator.py in <module>\r\n     23     distributions.IntLogUniformDistribution,\r\n     24     distributions.CategoricalDistribution,\r\n---> 25     distributions.FloatDistribution,\r\n     26     distributions.IntDistribution,\r\n     27 )\r\n\r\nAttributeError: module 'optuna.distributions' has no attribute 'FloatDistribution'\n```\n\n\n### Steps to reproduce\n\n\r\n```python\r\n# python code\r\n```\r\nimport optuna\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3452/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3452/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3424", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3424/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3424/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3424/events", "html_url": "https://github.com/optuna/optuna/pull/3424", "id": 1188177142, "node_id": "PR_kwDOB0okGM41Z1NH", "number": 3424, "title": "Fix `_is_reverse_scale`", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, {"login": "xadrianzetx", "id": 37713008, "node_id": "MDQ6VXNlcjM3NzEzMDA4", "avatar_url": "https://avatars.githubusercontent.com/u/37713008?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xadrianzetx", "html_url": "https://github.com/xadrianzetx", "followers_url": "https://api.github.com/users/xadrianzetx/followers", "following_url": "https://api.github.com/users/xadrianzetx/following{/other_user}", "gists_url": "https://api.github.com/users/xadrianzetx/gists{/gist_id}", "starred_url": "https://api.github.com/users/xadrianzetx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xadrianzetx/subscriptions", "organizations_url": "https://api.github.com/users/xadrianzetx/orgs", "repos_url": "https://api.github.com/users/xadrianzetx/repos", "events_url": "https://api.github.com/users/xadrianzetx/events{/privacy}", "received_events_url": "https://api.github.com/users/xadrianzetx/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/41", "html_url": "https://github.com/optuna/optuna/milestone/41", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/41/labels", "id": 7640188, "node_id": "MI_kwDOB0okGM4AdJR8", "number": 41, "title": "v3.0.0-b0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 85, "state": "closed", "created_at": "2022-02-04T05:12:58Z", "updated_at": "2022-04-12T04:16:51Z", "due_on": null, "closed_at": "2022-04-12T04:16:51Z"}, "comments": 5, "created_at": "2022-03-31T14:29:26Z", "updated_at": "2022-04-01T18:04:14Z", "closed_at": "2022-04-01T18:04:05Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3424", "html_url": "https://github.com/optuna/optuna/pull/3424", "diff_url": "https://github.com/optuna/optuna/pull/3424.diff", "patch_url": "https://github.com/optuna/optuna/pull/3424.patch", "merged_at": "2022-04-01T18:04:05Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\nThe current implementation of `optuna.visualization.plot_parallel_coordinate` raises an error as reported in https://github.com/optuna/optuna/issues/3423#issuecomment-1084602443. This bug has been introduced by https://github.com/optuna/optuna/pull/3376 (me!).\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\n- Add tests to cover the case raising an error in https://github.com/optuna/optuna/issues/3423#issuecomment-1084602443\r\n- Update the definition of `_is_reverse_scale`\r\n- Fix typos", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3424/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3424/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3422", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3422/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3422/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3422/events", "html_url": "https://github.com/optuna/optuna/pull/3422", "id": 1187294512, "node_id": "PR_kwDOB0okGM41W3cH", "number": 3422, "title": "Avoid using `px.colors.sequential.Blues` that introduces `pandas` dependency", "user": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/41", "html_url": "https://github.com/optuna/optuna/milestone/41", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/41/labels", "id": 7640188, "node_id": "MI_kwDOB0okGM4AdJR8", "number": 41, "title": "v3.0.0-b0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 85, "state": "closed", "created_at": "2022-02-04T05:12:58Z", "updated_at": "2022-04-12T04:16:51Z", "due_on": null, "closed_at": "2022-04-12T04:16:51Z"}, "comments": 6, "created_at": "2022-03-31T01:01:31Z", "updated_at": "2022-03-31T12:00:41Z", "closed_at": "2022-03-31T08:42:34Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3422", "html_url": "https://github.com/optuna/optuna/pull/3422", "diff_url": "https://github.com/optuna/optuna/pull/3422.diff", "patch_url": "https://github.com/optuna/optuna/pull/3422.patch", "merged_at": "2022-03-31T08:42:34Z"}, "body": "https://github.com/optuna/optuna/pull/3376 unifies our color scale in plotly visualization. This change is really awesome but it introduces (might unintentionally) `pandas` dependency. This PR uses `plotly.colors.sequential.Blues` instead of `px.colors.sequential.Blues` to remove the importing of `plotly.express` from Optuna.\r\n\r\n## Motivation\r\nRemove `plotly.express` dependency. It also depends on `pandas`: https://github.com/plotly/plotly.py/issues/2279\r\n\r\n---\r\n\r\nIt confirms on my environment that the colormap of contour visualization is the same as other visualizations.\r\n\r\nv2.10.0 | This PR\r\n-- | --\r\n![_Users_himkt_Downloads_Untitled%20(1) html](https://user-images.githubusercontent.com/5164000/160955248-5c84ad19-788d-436b-b72e-f43809be8b02.png) | ![_Users_himkt_Downloads_Untitled html](https://user-images.githubusercontent.com/5164000/160955229-227e87a4-9cac-4f49-abe6-8cd82cfa6b92.png)\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3422/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3422/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3416", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3416/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3416/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3416/events", "html_url": "https://github.com/optuna/optuna/issues/3416", "id": 1185121195, "node_id": "I_kwDOB0okGM5Go4Or", "number": 3416, "title": "Can't run `create_trial` more than once when reporting multiple objective values", "user": {"login": "xadrianzetx", "id": 37713008, "node_id": "MDQ6VXNlcjM3NzEzMDA4", "avatar_url": "https://avatars.githubusercontent.com/u/37713008?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xadrianzetx", "html_url": "https://github.com/xadrianzetx", "followers_url": "https://api.github.com/users/xadrianzetx/followers", "following_url": "https://api.github.com/users/xadrianzetx/following{/other_user}", "gists_url": "https://api.github.com/users/xadrianzetx/gists{/gist_id}", "starred_url": "https://api.github.com/users/xadrianzetx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xadrianzetx/subscriptions", "organizations_url": "https://api.github.com/users/xadrianzetx/orgs", "repos_url": "https://api.github.com/users/xadrianzetx/repos", "events_url": "https://api.github.com/users/xadrianzetx/events{/privacy}", "received_events_url": "https://api.github.com/users/xadrianzetx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-03-29T16:27:09Z", "updated_at": "2022-03-29T16:39:21Z", "closed_at": "2022-03-29T16:39:21Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "### Expected behavior\n\nI should be able to  manually create arbitrary number of trials with sequence of objective values, same as with single objective value.\n\n### Environment\n\n- Optuna version: 3.0.0b0.dev\r\n- Python version: 3.8.10\r\n- OS: Ubuntu 20.04.4\r\n- (Optional) Other libraries and their versions:\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\nTraceback (most recent call last):\r\n  File \"buggy.py\", line 6, in <module>\r\n    study.add_trial(create_trial(values=[0.0, 0.1]))\r\n  File \"/home/adrian/code/optuna/env/lib/python3.8/site-packages/optuna/study/study.py\", line 955, in add_trial\r\n    self._storage.create_new_trial(self._study_id, template_trial=trial)\r\n  File \"/home/adrian/code/optuna/env/lib/python3.8/site-packages/optuna/storages/_in_memory.py\", line 203, in create_new_trial\r\n    self._update_cache(trial_id, study_id)\r\n  File \"/home/adrian/code/optuna/env/lib/python3.8/site-packages/optuna/storages/_in_memory.py\", line 361, in _update_cache\r\n    if best_trial.value is None:\r\n  File \"/home/adrian/code/optuna/env/lib/python3.8/site-packages/optuna/trial/_frozen.py\", line 395, in value\r\n    raise RuntimeError(\r\nRuntimeError: This attribute is not available during multi-objective optimization.\n```\n\n\n### Steps to reproduce\n\nMinimal reproducible code\r\n```python\r\nfrom optuna.study import create_study\r\nfrom optuna.trial import create_trial\r\n\r\nstudy = create_study()\r\nstudy.add_trial(create_trial(values=[0.0, 0.1]))  # :^)\r\nstudy.add_trial(create_trial(values=[0.0, 0.1]))  # :^(\r\n```\r\n\n\n### Additional context (optional)\n\nSeems like it's raised from [`_update_cache`](https://github.com/optuna/optuna/blob/d529ffe58810c2d4ac1439d98049b175e93122f7/optuna/storages/_in_memory.py#L331-L363) which does not handle trials with multiple objective values. I suspect the same error exists in redis storage. Just had a quick look, but happy to come back and fix it later.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3416/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3416/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3411", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3411/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3411/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3411/events", "html_url": "https://github.com/optuna/optuna/issues/3411", "id": 1181611362, "node_id": "I_kwDOB0okGM5GbfVi", "number": 3411, "title": "IndexError: shape mismatch: indexing arrays could not be broadcast together with shapes (9,) (7,) ", "user": {"login": "davidbbaumann", "id": 60887501, "node_id": "MDQ6VXNlcjYwODg3NTAx", "avatar_url": "https://avatars.githubusercontent.com/u/60887501?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidbbaumann", "html_url": "https://github.com/davidbbaumann", "followers_url": "https://api.github.com/users/davidbbaumann/followers", "following_url": "https://api.github.com/users/davidbbaumann/following{/other_user}", "gists_url": "https://api.github.com/users/davidbbaumann/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidbbaumann/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidbbaumann/subscriptions", "organizations_url": "https://api.github.com/users/davidbbaumann/orgs", "repos_url": "https://api.github.com/users/davidbbaumann/repos", "events_url": "https://api.github.com/users/davidbbaumann/events{/privacy}", "received_events_url": "https://api.github.com/users/davidbbaumann/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2022-03-26T09:14:34Z", "updated_at": "2022-03-27T07:01:07Z", "closed_at": "2022-03-26T15:55:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nI create a the following objective function for a TF-IDF vectorizer in combination with a Decision Tree from sklearn:\r\n\r\n```\r\ndef dt_objective(trial):\r\n  \r\n  cv_inputs, test_inputs, cv_labels, test_labels, cv_df, test_df = train_test_split(STUDY_INPUTS, label_array, job_ad_df,\r\n                                                                                    train_size = 0.7,\r\n                                                                                    stratify = label_array, #ensure that all labels are present in train test\r\n                                                                                    shuffle = True, \r\n                                                                                    random_state=42)\r\n\r\n  #Which parameters to tune?\r\n\r\n  ngram_range = trial.suggest_categorical('tfidf ngram range', [(1,1), (2,2), (1,2), (1,3)])\r\n  max_df = trial.suggest_float('tfidf max df', 0.80, 1.0)                                                                     \r\n  min_df = trial.suggest_int('tfidf min df', 2, 100) #wenn 1 dann soll es in 100% der documente vorkommen // es soll mindestens in einem doc vorkommen \r\n  max_features = trial.suggest_int('tfidf max features', 2, 100_000)\r\n  \r\n\r\n  vectorizer = TfidfVectorizer(input = 'content',\r\n                               encoding = 'utf-8',\r\n                               lowercase = True,\r\n                               tokenizer = tokenize,\r\n                               ngram_range = ngram_range,\r\n                               max_df = max_df,\r\n                               min_df = min_df,\r\n                               max_features = max_features)\r\n  \r\n  cv_matrix = vectorizer.fit_transform(cv_inputs)\r\n\r\n  # https://towardsdatascience.com/how-to-tune-a-decision-tree-f03721801680\r\n  # https://medium.com/@mohtedibf/indepth-parameter-tuning-for-decision-tree-6753118a03c3\r\n  # https://stats.stackexchange.com/questions/65893/maximal-depth-of-a-decision-tree\r\n\r\n  criterion = trial.suggest_categorical('criterion', ['gini', 'entropy'])\r\n  splitter = trial.suggest_categorical('splitter',  ['best', 'random'])\r\n  #max_depth = trial.suggest_int('max depth', 1, cv_matrix.shape[0]-1)\r\n  #min_samples_split = trial.suggest_float('min samples split', 0.01, 1.0)\r\n  #min_samples_leaf = trial.suggest_int('min samples leaf', 1, cv_matrix.shape[0])\r\n  max_features = trial.suggest_categorical('max features', ['auto', 'sqrt', 'log2', None])\r\n  \r\n  dt = DecisionTreeClassifier(criterion = criterion,\r\n                              splitter = splitter,\r\n                              #max_depth = max_depth,\r\n                              #min_samples_split = min_samples_split,\r\n                              #min_samples_leaf = min_samples_leaf,\r\n                              max_features = max_features,\r\n                              random_state = 42)\r\n\r\n\r\n  return cross_val_score(dt, cv_matrix, cv_labels, scoring= 'f1_macro', cv = 5, n_jobs=-1).mean()\r\n```\r\n\r\nWhen I execute the study over 20 trials the first trials work as expected but then I get a sudden Indexing Error I can not relate:\r\n\r\n```\r\nstudy = optuna.create_study(study_name = f'{MODEL_NAME} {approach} Study {N_TRIALS} Trails', sampler = SAMPLER, direction='maximize')\r\nstudy.optimize(dt_objective, n_trials = N_TRIALS, show_progress_bar = True)\r\n```\r\n\r\n\r\n```\r\n[I 2022-03-26 09:04:26,256] Trial 8 finished with value: 0.4777081336796484 and parameters: {'tfidf ngram range': (1, 1), 'tfidf max df': 0.8849587686384248, 'tfidf min df': 21, 'tfidf max features': 33862, 'criterion': 'gini', 'splitter': 'random', 'max features': None}. Best is trial 2 with value: 0.48253011811114294.\r\n/usr/local/lib/python3.7/dist-packages/optuna/distributions.py:427: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains (1, 1) which is of type tuple.\r\n  warnings.warn(message)\r\n/usr/local/lib/python3.7/dist-packages/optuna/distributions.py:427: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains (2, 2) which is of type tuple.\r\n  warnings.warn(message)\r\n/usr/local/lib/python3.7/dist-packages/optuna/distributions.py:427: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains (1, 2) which is of type tuple.\r\n  warnings.warn(message)\r\n/usr/local/lib/python3.7/dist-packages/optuna/distributions.py:427: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains (1, 3) which is of type tuple.\r\n  warnings.warn(message)\r\n[I 2022-03-26 09:04:29,995] Trial 9 finished with value: 0.3722128805977377 and parameters: {'tfidf ngram range': (1, 2), 'tfidf max df': 0.9520693534583604, 'tfidf min df': 59, 'tfidf max features': 91996, 'criterion': 'gini', 'splitter': 'best', 'max features': None}. Best is trial 2 with value: 0.48253011811114294.\r\n---------------------------------------------------------------------------\r\nIndexError                                Traceback (most recent call last)\r\n[<ipython-input-19-4f9d7fce66b8>](https://localhost:8080/#) in <module>()\r\n     13 \r\n     14 study = optuna.create_study(study_name = f'{MODEL_NAME} {approach} Study {N_TRIALS} Trails', sampler = SAMPLER, direction='maximize')\r\n---> 15 study.optimize(dt_objective, n_trials = N_TRIALS, show_progress_bar = True)\r\n     16 \r\n     17 print(f'Best Trial No.: {study.best_trial.number} // Mean F1 Score: {study.best_trial.value}')\r\n\r\n10 frames\r\n[/usr/local/lib/python3.7/dist-packages/optuna/samplers/_tpe/parzen_estimator.py](https://localhost:8080/#) in _calculate_categorical_params(self, observations, param_name)\r\n    364             value = prior_weight / n_observations\r\n    365         weights = np.full(shape, fill_value=value)\r\n--> 366         weights[np.arange(n_observations), observations] += 1\r\n    367         weights /= weights.sum(axis=1, keepdims=True)\r\n    368         return weights\r\n\r\nIndexError: shape mismatch: indexing arrays could not be broadcast together with shapes (9,) (6,)\r\n```\n\n### Environment\n\n- Optuna version: 2.10.0\r\n- Python version:  3.10.3\r\n- OS: Linux-5.4.0-100-generic-x86_64-with-glibc2.31\r\n- (Optional) Other libraries and their versions: Sklearn 1.0.2\n\n### Error messages, stack traces, or logs\n\n```shell\n[I 2022-03-26 09:04:26,256] Trial 8 finished with value: 0.4777081336796484 and parameters: {'tfidf ngram range': (1, 1), 'tfidf max df': 0.8849587686384248, 'tfidf min df': 21, 'tfidf max features': 33862, 'criterion': 'gini', 'splitter': 'random', 'max features': None}. Best is trial 2 with value: 0.48253011811114294.\r\n/usr/local/lib/python3.7/dist-packages/optuna/distributions.py:427: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains (1, 1) which is of type tuple.\r\n  warnings.warn(message)\r\n/usr/local/lib/python3.7/dist-packages/optuna/distributions.py:427: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains (2, 2) which is of type tuple.\r\n  warnings.warn(message)\r\n/usr/local/lib/python3.7/dist-packages/optuna/distributions.py:427: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains (1, 2) which is of type tuple.\r\n  warnings.warn(message)\r\n/usr/local/lib/python3.7/dist-packages/optuna/distributions.py:427: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains (1, 3) which is of type tuple.\r\n  warnings.warn(message)\r\n[I 2022-03-26 09:04:29,995] Trial 9 finished with value: 0.3722128805977377 and parameters: {'tfidf ngram range': (1, 2), 'tfidf max df': 0.9520693534583604, 'tfidf min df': 59, 'tfidf max features': 91996, 'criterion': 'gini', 'splitter': 'best', 'max features': None}. Best is trial 2 with value: 0.48253011811114294.\r\n---------------------------------------------------------------------------\r\nIndexError                                Traceback (most recent call last)\r\n<ipython-input-19-4f9d7fce66b8> in <module>()\r\n     13 \r\n     14 study = optuna.create_study(study_name = f'{MODEL_NAME} {approach} Study {N_TRIALS} Trails', sampler = SAMPLER, direction='maximize')\r\n---> 15 study.optimize(dt_objective, n_trials = N_TRIALS, show_progress_bar = True)\r\n     16 \r\n     17 print(f'Best Trial No.: {study.best_trial.number} // Mean F1 Score: {study.best_trial.value}')\r\n\r\n10 frames\r\n/usr/local/lib/python3.7/dist-packages/optuna/samplers/_tpe/parzen_estimator.py in _calculate_categorical_params(self, observations, param_name)\r\n    364             value = prior_weight / n_observations\r\n    365         weights = np.full(shape, fill_value=value)\r\n--> 366         weights[np.arange(n_observations), observations] += 1\r\n    367         weights /= weights.sum(axis=1, keepdims=True)\r\n    368         return weights\r\n\r\nIndexError: shape mismatch: indexing arrays could not be broadcast together with shapes (9,) (6,)\n```\n\n\n### Steps to reproduce\n\nSee above\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3411/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3411/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3410", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3410/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3410/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3410/events", "html_url": "https://github.com/optuna/optuna/pull/3410", "id": 1180514727, "node_id": "PR_kwDOB0okGM41ANCx", "number": 3410, "title": "Return the best trial number, not worst trial number by `best_index_`", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561256, "node_id": "MDU6TGFiZWwxOTQ3NTYxMjU2", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.integration", "name": "optuna.integration", "color": "1c659e", "default": false, "description": "Related to the `optuna.integration` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/41", "html_url": "https://github.com/optuna/optuna/milestone/41", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/41/labels", "id": 7640188, "node_id": "MI_kwDOB0okGM4AdJR8", "number": 41, "title": "v3.0.0-b0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 85, "state": "closed", "created_at": "2022-02-04T05:12:58Z", "updated_at": "2022-04-12T04:16:51Z", "due_on": null, "closed_at": "2022-04-12T04:16:51Z"}, "comments": 1, "created_at": "2022-03-25T08:55:44Z", "updated_at": "2022-03-30T10:33:28Z", "closed_at": "2022-03-30T10:33:22Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3410", "html_url": "https://github.com/optuna/optuna/pull/3410", "diff_url": "https://github.com/optuna/optuna/pull/3410.diff", "patch_url": "https://github.com/optuna/optuna/pull/3410.patch", "merged_at": "2022-03-30T10:33:22Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\nFix #3409.\r\n\r\nThe `OptunaSearchCV` supports only maximisation problem by following the convention of sklearn's scoring as described in [a note section](https://optuna.readthedocs.io/en/latest/reference/generated/optuna.integration.OptunaSearchCV.html). However the current implementation returns a trial index whose objective value is the lowest in the study; it returns the worst trial number.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\n- Return the best trial number\r\n- Update docstring to clarify the behaviour of `best_index_`.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3410/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3410/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3409", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3409/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3409/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3409/events", "html_url": "https://github.com/optuna/optuna/issues/3409", "id": 1180346833, "node_id": "I_kwDOB0okGM5GWqnR", "number": 3409, "title": "The values of best_index_ and trial number do not match ", "user": {"login": "jckkvs", "id": 32125829, "node_id": "MDQ6VXNlcjMyMTI1ODI5", "avatar_url": "https://avatars.githubusercontent.com/u/32125829?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jckkvs", "html_url": "https://github.com/jckkvs", "followers_url": "https://api.github.com/users/jckkvs/followers", "following_url": "https://api.github.com/users/jckkvs/following{/other_user}", "gists_url": "https://api.github.com/users/jckkvs/gists{/gist_id}", "starred_url": "https://api.github.com/users/jckkvs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jckkvs/subscriptions", "organizations_url": "https://api.github.com/users/jckkvs/orgs", "repos_url": "https://api.github.com/users/jckkvs/repos", "events_url": "https://api.github.com/users/jckkvs/events{/privacy}", "received_events_url": "https://api.github.com/users/jckkvs/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-03-25T05:00:14Z", "updated_at": "2022-03-30T10:33:22Z", "closed_at": "2022-03-30T10:33:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nI thought I could use best_index_ to find out which Trial reached the optimal solution. However, in reality, the value of best_index_ and the Trial number do not match.\r\n\r\nI think it's because I got the idxmin of trials_dataframe, but is this behavior as the developer expected?\r\n\r\nAlso, what code should I write to know how many times it takes to reach the optimal solution? \r\n\r\n### Environment\r\n\r\n- Optuna version:2.10.0\r\n- Python version:3.7.11\r\n- OS:windows10\r\n- (Optional) Other libraries and their versions:\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\nTrial 59 finished with value: 0.07631298446927186 and parameters: {'min_child_weight': 9.419714797838857, 'subsample': 0.03818720585744753, 'learning_rate': 0.039630972438226164, 'max_depth': 8}. Best is trial 55 with value: 0.46498958997038853.\r\n\r\nprint(searchcv.best_index_)\r\n> best_index_ 46\r\n\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\n```python\r\n    X, y  = load_diabetes(return_X_y=True)\r\n    estimator = xgb.XGBRegressor()\r\n    param_distribution = {\r\n        \"min_child_weight\": UniformDistribution(0.1, 10),\r\n        \"subsample\": UniformDistribution(0, 1.0),\r\n        \"learning_rate\": LogUniformDistribution(1e-3, 5e-1),\r\n        \"max_depth\": IntUniformDistribution(3, 15),\r\n    }\r\n    OpSearchCV = OptunaSearchCV(estimator, param_distribution ,n_trials=60)\r\n    OpSearchCV.fit(X,y)\r\n    print('best_index_', OpSearchCV.best_index_)\r\n```\r\n\r\n\r\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3409/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3409/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3395", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3395/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3395/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3395/events", "html_url": "https://github.com/optuna/optuna/pull/3395", "id": 1175363055, "node_id": "PR_kwDOB0okGM40vSsA", "number": 3395, "title": "Add utility to filter trials with `inf` values from visualizations", "user": {"login": "xadrianzetx", "id": 37713008, "node_id": "MDQ6VXNlcjM3NzEzMDA4", "avatar_url": "https://avatars.githubusercontent.com/u/37713008?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xadrianzetx", "html_url": "https://github.com/xadrianzetx", "followers_url": "https://api.github.com/users/xadrianzetx/followers", "following_url": "https://api.github.com/users/xadrianzetx/following{/other_user}", "gists_url": "https://api.github.com/users/xadrianzetx/gists{/gist_id}", "starred_url": "https://api.github.com/users/xadrianzetx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xadrianzetx/subscriptions", "organizations_url": "https://api.github.com/users/xadrianzetx/orgs", "repos_url": "https://api.github.com/users/xadrianzetx/repos", "events_url": "https://api.github.com/users/xadrianzetx/events{/privacy}", "received_events_url": "https://api.github.com/users/xadrianzetx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}, {"id": 3264287142, "node_id": "MDU6TGFiZWwzMjY0Mjg3MTQy", "url": "https://api.github.com/repos/optuna/optuna/labels/v3", "name": "v3", "color": "339FD7", "default": false, "description": "Issue/PR for Optuna version 3."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/41", "html_url": "https://github.com/optuna/optuna/milestone/41", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/41/labels", "id": 7640188, "node_id": "MI_kwDOB0okGM4AdJR8", "number": 41, "title": "v3.0.0-b0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 85, "state": "closed", "created_at": "2022-02-04T05:12:58Z", "updated_at": "2022-04-12T04:16:51Z", "due_on": null, "closed_at": "2022-04-12T04:16:51Z"}, "comments": 6, "created_at": "2022-03-21T13:08:44Z", "updated_at": "2022-03-31T07:40:38Z", "closed_at": "2022-03-31T07:25:12Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3395", "html_url": "https://github.com/optuna/optuna/pull/3395", "diff_url": "https://github.com/optuna/optuna/pull/3395.diff", "patch_url": "https://github.com/optuna/optuna/pull/3395.patch", "merged_at": "2022-03-31T07:25:12Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nA neat utility function which should help us skip trials with `inf` values/intermediate values when making visualizations. Part of #3382.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n* Implemented `_filter_inf_trials`\r\n* Test new function", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3395/reactions", "total_count": 3, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 3, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3395/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3379", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3379/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3379/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3379/events", "html_url": "https://github.com/optuna/optuna/issues/3379", "id": 1167477681, "node_id": "I_kwDOB0okGM5Flkux", "number": 3379, "title": "The optuna process seems stuck, the terminal does not print any information.", "user": {"login": "pengzhangzhi", "id": 59241275, "node_id": "MDQ6VXNlcjU5MjQxMjc1", "avatar_url": "https://avatars.githubusercontent.com/u/59241275?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pengzhangzhi", "html_url": "https://github.com/pengzhangzhi", "followers_url": "https://api.github.com/users/pengzhangzhi/followers", "following_url": "https://api.github.com/users/pengzhangzhi/following{/other_user}", "gists_url": "https://api.github.com/users/pengzhangzhi/gists{/gist_id}", "starred_url": "https://api.github.com/users/pengzhangzhi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pengzhangzhi/subscriptions", "organizations_url": "https://api.github.com/users/pengzhangzhi/orgs", "repos_url": "https://api.github.com/users/pengzhangzhi/repos", "events_url": "https://api.github.com/users/pengzhangzhi/events{/privacy}", "received_events_url": "https://api.github.com/users/pengzhangzhi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2022-03-13T04:34:10Z", "updated_at": "2023-01-05T10:36:21Z", "closed_at": "2022-03-31T23:52:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nI follow your official doc to start a distributed hyper-param search program as shown in the code. \r\n\r\n```python\r\nreproducibility()\r\n    # Add stream handler of stdout to show the messages\r\n    optuna.logging.get_logger(\"optuna\").addHandler(logging.StreamHandler(sys.stdout))\r\n\r\n    study = optuna.create_study(direction=\"minimize\",\r\n                                sampler=optuna.samplers.TPESampler(),\r\n                                pruner=optuna.pruners.MedianPruner(),\r\n                                study_name='distributed-example', \r\n                                storage='sqlite:///example.db', \r\n                                load_if_exists=True)\r\n    study.optimize(objective, n_trials=200,n_jobs=-1)\r\n\r\n    pruned_trials = study.get_trials(deepcopy=False, states=[TrialState.PRUNED])\r\n    complete_trials = study.get_trials(deepcopy=False, states=[TrialState.COMPLETE])\r\n\r\n    print(\"Study statistics: \")\r\n    print(\"  Number of finished trials: \", len(study.trials))\r\n    print(\"  Number of pruned trials: \", len(pruned_trials))\r\n    print(\"  Number of complete trials: \", len(complete_trials))\r\n\r\n    print(\"Best trial:\")\r\n    trial = study.best_trial\r\n\r\n    print(\"  Value: \", trial.value)\r\n\r\n    print(\"  Params: \")\r\n    for key, value in trial.params.items():\r\n        print(\"    {}: {}\".format(key, value))\r\n    \r\n    \r\n    if optuna.visualization.is_available:\r\n        optuna.visualization.plot_contour(study)\r\n        plt.savefig(\"plot_contour.pdf\")\r\n        optuna.visualization.plot_edf(study)\r\n        \r\n        optuna.visualization.plot_optimization_history(study)\r\n        plt.savefig(\"plot_optimization_history.pdf\")\r\n        \r\n        optuna.visualization.plot_parallel_coordinate(study)\r\n        plt.savefig(\"plot_parallel_coordinate.pdf\")\r\n        \r\n        optuna.visualization.plot_param_importances(study)\r\n        plt.savefig(\"plot_param_importances.pdf\")\r\n        \r\n        optuna.visualization.plot_pareto_front(study)\r\n        plt.savefig(\"plot_pareto_front.pdf\")\r\n        \r\n        optuna.visualization.plot_slice(study)\r\n        plt.savefig(\"plot_slice.pdf\")\r\n        \r\n```\r\n\r\nThis program runs for two days functionally. I can see the printed information from the terminal. But today, I found the terminal is struck.\r\n```\r\n================================================================\r\nTotal params: 1,559,616\r\nTrainable params: 1,559,616\r\nNon-trainable params: 0\r\n----------------------------------------------------------------\r\nInput size (MB): 48.00\r\nForward/backward pass size (MB): 30.47\r\nParams size (MB): 5.95\r\nEstimated Total Size (MB): 84.42\r\n----------------------------------------------------------------\r\n                                                                                                 ^[[B^[[B^[[B^[[B^[[B\r\n\r\n\r\n\r\n\r\n\r\n\r\n  0%|                                                                    | 0/139 [00:00<?, ?it/s]\r\n\r\n```\r\nI hypothesis  it is because the process is too heavy to execute.  \r\nI then check out the sys info with `nvidia-smi`, `top` , and `free -h`.\r\nThe results shows that the linux system is not in a very bad condition.\r\n```\r\n(pytorch_p38) ubuntu@ip-172-31-14-60:~/spatial-temporal-transformer$ free -h\r\n              total        used        free      shared  buff/cache   available\r\nMem:            30G         24G        1.4G        1.3G        4.7G        4.3G\r\nSwap:            0B          0B          0B\r\n```\r\n\r\n```\r\ntop - 04:28:51 up 3 days,  1:43,  1 user,  load average: 1.08, 1.04, 1.00\r\nTasks: 241 total,   1 running, 172 sleeping,   0 stopped,   0 zombie\r\n%Cpu(s):  8.1 us,  5.5 sy,  0.0 ni, 86.5 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st\r\nKiB Mem : 32408368 total,  1421828 free, 26056316 used,  4930224 buff/cache\r\nKiB Swap:        0 total,        0 free,        0 used.  4535800 avail Mem \r\n\r\n  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                                                                                                                 \r\n 7979 ubuntu    20   0 45.467g 0.015t 1.393g S 100.0 50.8   5723:27 python                                                                                                                  \r\n  986 ubuntu    20   0  970060  75236  34092 S   1.7  0.2   0:29.08 node                                                                                                                    \r\n 2286 mysql     20   0 1489576 167180   3292 S   0.3  0.5   2:00.20 mysqld                                                                                                                  \r\n32299 ubuntu    20   0  943440  66120  31796 S   0.3  0.2   0:03.53 node                                                                                                                    \r\n    1 root      20   0  225476   5424   2868 S   0.0  0.0   0:03.70 systemd                                                                                                                 \r\n    2 root      20   0       0      0      0 S   0.0  0.0   0:00.02 kthreadd                                                                                                                \r\n    3 root       0 -20       0      0      0 I   0.0  0.0   0:00.00 rcu_gp             \r\n```\r\n```\r\n(pytorch_p38) ubuntu@ip-172-31-14-60:~/spatial-temporal-transformer$ nvidia-smi\r\nSun Mar 13 04:29:22 2022       \r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 510.47.03    Driver Version: 510.47.03    CUDA Version: 11.6     |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|                               |                      |               MIG M. |\r\n|===============================+======================+======================|\r\n|   0  Tesla T4            On   | 00000000:00:1E.0 Off |                    0 |\r\n| N/A   31C    P0    27W /  70W |  12701MiB / 15360MiB |      0%      Default |\r\n|                               |                      |                  N/A |\r\n+-------------------------------+----------------------+----------------------+\r\n                                                                               \r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                                  |\r\n|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\r\n|        ID   ID                                                   Usage      |\r\n|=============================================================================|\r\n|    0   N/A  N/A      7979      C   python                          12697MiB |\r\n+-----------------------------------------------------------------------------+\r\n```\r\n\r\nI do not know if this process is still running or not. What should I do about it? Can I have my searched hyper-parameters back? (I already have the database file, but I do not know how to find the best hyperparameters based on sql operations).  Do you all have any idea? Any suggestions would much appreciated!\n\n### Environment\n\n- Optuna version:\r\n- Python version: \r\n- OS: ubuntu\r\n- (Optional) Other libraries and their versions:\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\nnot necessary.\n```\n\n\n### Steps to reproduce\n\n1. not necessary.\r\n2.\r\n3.\r\n```python\r\n# python code\r\n```\r\n\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3379/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3379/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3373", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3373/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3373/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3373/events", "html_url": "https://github.com/optuna/optuna/pull/3373", "id": 1165468727, "node_id": "PR_kwDOB0okGM40QCvm", "number": 3373, "title": "Fix parallel coordinate with missing value", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}, {"id": 3264287142, "node_id": "MDU6TGFiZWwzMjY0Mjg3MTQy", "url": "https://api.github.com/repos/optuna/optuna/labels/v3", "name": "v3", "color": "339FD7", "default": false, "description": "Issue/PR for Optuna version 3."}], "state": "closed", "locked": false, "assignee": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/41", "html_url": "https://github.com/optuna/optuna/milestone/41", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/41/labels", "id": 7640188, "node_id": "MI_kwDOB0okGM4AdJR8", "number": 41, "title": "v3.0.0-b0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 85, "state": "closed", "created_at": "2022-02-04T05:12:58Z", "updated_at": "2022-04-12T04:16:51Z", "due_on": null, "closed_at": "2022-04-12T04:16:51Z"}, "comments": 2, "created_at": "2022-03-10T16:45:33Z", "updated_at": "2022-03-24T09:38:41Z", "closed_at": "2022-03-24T06:32:48Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3373", "html_url": "https://github.com/optuna/optuna/pull/3373", "diff_url": "https://github.com/optuna/optuna/pull/3373.diff", "patch_url": "https://github.com/optuna/optuna/pull/3373.patch", "merged_at": "2022-03-24T06:32:48Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\nResolve https://github.com/optuna/optuna/issues/3372\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\n\r\nIf a trial has a missing parameter used in a parallel coordinate plot, remove the trail from the visualization data for Plotly. \r\n\r\nNote that by this change, coordinates' max/min values might change because the master's implementation set max/min based on all complete trials' values. On the other hand, this PR set max/min value based on only used trials that have no missing params. Personally, this PR's change makes sense since the parallel coordinate plot creates empty space in the coordinate as in the matplotlib's plot on https://github.com/optuna/optuna/issues/3372: 1--2 on `Objective Value` axis or 0--1 on `param_b` axis.\r\n\r\n\r\n<img width=\"950\" alt=\"Screenshot 2022-03-11 at 1 40 23\" src=\"https://user-images.githubusercontent.com/7121753/157712017-96381183-0439-4d5e-a024-1909bb0ad625.png\">\r\n\r\n\r\nImplementing the same logic to determine the max/min range in matplotlib should be a follow-up.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3373/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3373/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3372", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3372/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3372/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3372/events", "html_url": "https://github.com/optuna/optuna/issues/3372", "id": 1165394557, "node_id": "I_kwDOB0okGM5FdoJ9", "number": 3372, "title": "Plotly's parallel coordinate plot with missing value looks wrong", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-03-10T15:46:12Z", "updated_at": "2022-03-24T06:32:48Z", "closed_at": "2022-03-24T06:32:48Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "### Expected behavior\n\nGiven the following trials, \r\n\r\n```python\r\ntrial id:0, objective:0.0, params:{'param_a': 1.0, 'param_b': 2.0}\r\ntrial id:1, objective:2.0, params:{'param_b': 0.0}\r\ntrial id:2, objective:1.0, params:{'param_a': 2.5, 'param_b': 1.0}\r\n```\r\n\r\nthe parallel coordinate plot shows trial#0 and trial#2 because trial#1 does not have `param_a` by following the documentation page \r\n> Note that, if a parameter contains missing values, a trial with missing values is not plotted.\r\n\r\nHowever, the generated plot is like \r\n\r\n\r\n<img width=\"919\" alt=\"Screenshot 2022-03-11 at 0 44 47\" src=\"https://user-images.githubusercontent.com/7121753/157698604-5e27ec83-7586-4189-9f42-ef22f36a5b6a.png\">\r\n\r\nAs we can see, objective=2.0 is used and objective=1.0 is missing. \n\n### Environment\n\n- Optuna version: latest \r\n- Python version: 3.9.7\r\n- OS: Mac\r\n- (Optional) Other libraries and their versions:\r\nmatplotlib: 3.9,8\n\n### Error messages, stack traces, or logs\n\n```shell\nN/A\n```\n\n\n### Steps to reproduce\n\n1.\r\n2.\r\n3.\r\n```python\r\nfrom optuna.testing.visualization import prepare_study_with_trials\r\nimport optuna\r\n\r\nstudy = prepare_study_with_trials(with_c_d=False)\r\n\r\nfor t in study.get_trials():\r\n    print(f\"trial id:{t.number}, objective:{t.value}, params:{t.params}\")\r\n\r\n    \r\n\r\noptuna.visualization.plot_parallel_coordinate(study)\r\noptuna.visualization.matplotlib.plot_parallel_coordinate(study)\r\n```\r\n\n\n### Additional context (optional)\n\nMatplotlib looks fine;\r\n\r\n<img width=\"403\" alt=\"Screenshot 2022-03-11 at 0 44 52\" src=\"https://user-images.githubusercontent.com/7121753/157698765-f6f90673-6949-4e9f-a992-d9ff1b7a42ba.png\">\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3372/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3372/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3371", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3371/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3371/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3371/events", "html_url": "https://github.com/optuna/optuna/pull/3371", "id": 1165365567, "node_id": "PR_kwDOB0okGM40PtZv", "number": 3371, "title": "Fix `matplotlib.plot_parallel_coordinate` with log distributions", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/41", "html_url": "https://github.com/optuna/optuna/milestone/41", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/41/labels", "id": 7640188, "node_id": "MI_kwDOB0okGM4AdJR8", "number": 41, "title": "v3.0.0-b0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 85, "state": "closed", "created_at": "2022-02-04T05:12:58Z", "updated_at": "2022-04-12T04:16:51Z", "due_on": null, "closed_at": "2022-04-12T04:16:51Z"}, "comments": 4, "created_at": "2022-03-10T15:22:12Z", "updated_at": "2022-03-23T06:31:50Z", "closed_at": "2022-03-23T06:26:08Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3371", "html_url": "https://github.com/optuna/optuna/pull/3371", "diff_url": "https://github.com/optuna/optuna/pull/3371.diff", "patch_url": "https://github.com/optuna/optuna/pull/3371.patch", "merged_at": "2022-03-23T06:26:08Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nResolve https://github.com/optuna/optuna/issues/3370\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\nI think we do not need to take the log of parameters in this visualisation method except for line collection.\r\n\r\nBy this PR, the plot function generates\r\n\r\n<img width=\"457\" alt=\"Screenshot 2022-03-11 at 6 05 22\" src=\"https://user-images.githubusercontent.com/7121753/157754717-b1eafb11-c948-4c6e-a8cf-3fc9ace78c6a.png\">\r\n\r\nAs a reference, plotly shows the following plot:\r\n\r\n<img width=\"994\" alt=\"Screenshot 2022-03-11 at 6 07 33\" src=\"https://user-images.githubusercontent.com/7121753/157754914-c7a8d332-eb9e-4da4-8538-93e5204cfc8b.png\">\r\n\r\n\r\n### Code\r\n\r\n```python\r\nfrom optuna.study import create_study\r\nfrom optuna.visualization.matplotlib import plot_parallel_coordinate\r\nfrom optuna.distributions import LogUniformDistribution\r\nfrom optuna.trial import create_trial\r\nimport matplotlib.pyplot as plt\r\n\r\n\r\nstudy_log_params = create_study()\r\nstudy_log_params.add_trial(\r\n    create_trial(\r\n        value=0.0,\r\n        params={\"param_a\": 1e-6, \"param_b\": 10},\r\n        distributions={\r\n            \"param_a\": LogUniformDistribution(1e-7, 1e-2),\r\n            \"param_b\": LogUniformDistribution(1, 1000),\r\n        },\r\n    )\r\n)\r\nstudy_log_params.add_trial(\r\n    create_trial(\r\n        value=1.0,\r\n        params={\"param_a\": 2e-5, \"param_b\": 200},\r\n        distributions={\r\n            \"param_a\": LogUniformDistribution(1e-7, 1e-2),\r\n            \"param_b\": LogUniformDistribution(1, 1000),\r\n        },\r\n    )\r\n)\r\nstudy_log_params.add_trial(\r\n    create_trial(\r\n        value=0.1,\r\n        params={\"param_a\": 1e-4, \"param_b\": 30},\r\n        distributions={\r\n            \"param_a\": LogUniformDistribution(1e-7, 1e-2),\r\n            \"param_b\": LogUniformDistribution(1, 1000),\r\n        },\r\n    )\r\n)\r\nfigure = plot_parallel_coordinate(study_log_params)\r\nplt.savefig(\"lovely.png\")\r\n```\r\n\r\nAdding `plt.savefig(sys.stdout.buffer)` to other matplotlib will be a followup.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3371/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3371/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3370", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3370/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3370/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3370/events", "html_url": "https://github.com/optuna/optuna/issues/3370", "id": 1165340903, "node_id": "I_kwDOB0okGM5FdbDn", "number": 3370, "title": "`visualization.matplotlib.parallel_coordinate` cannot draw a graph if a param suggested from log dist.", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-03-10T15:02:50Z", "updated_at": "2022-03-23T06:26:08Z", "closed_at": "2022-03-23T06:26:08Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nBy running the script, we can see the figure saved on our local machine.\r\n\r\n### Environment\r\n\r\n- Optuna version: Latest\r\n- Python version: 3.9.7\r\n- OS: Mac\r\n- (Optional) Other libraries and their versions:\r\n  - matplotlib: 3.5.1 (latest stable)\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\nValueError                                Traceback (most recent call last)\r\n/var/folders/n3/7_7r1yrx6jsc_0780bvg02lr0000gn/T/ipykernel_80098/1185611049.py in <module>\r\n     37 )\r\n     38 figure = plot_parallel_coordinate(study_log_params)\r\n---> 39 plt.savefig(\"lovely.png\")\r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib/pyplot.py in savefig(*args, **kwargs)\r\n    956 def savefig(*args, **kwargs):\r\n    957     fig = gcf()\r\n--> 958     res = fig.savefig(*args, **kwargs)\r\n    959     fig.canvas.draw_idle()   # need this if 'transparent=True' to reset colors\r\n    960     return res\r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib/figure.py in savefig(self, fname, transparent, **kwargs)\r\n   3017                         ax.patch._cm_set(facecolor='none', edgecolor='none'))\r\n   3018 \r\n-> 3019             self.canvas.print_figure(fname, **kwargs)\r\n   3020 \r\n   3021     def ginput(self, n=1, timeout=30, show_clicks=True,\r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib/backend_bases.py in print_figure(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)\r\n   2317                 # force the figure dpi to 72), so we need to set it again here.\r\n   2318                 with cbook._setattr_cm(self.figure, dpi=dpi):\r\n-> 2319                     result = print_method(\r\n   2320                         filename,\r\n   2321                         facecolor=facecolor,\r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib/backend_bases.py in wrapper(*args, **kwargs)\r\n   1646             kwargs.pop(arg)\r\n   1647 \r\n-> 1648         return func(*args, **kwargs)\r\n   1649 \r\n   1650     return wrapper\r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib/_api/deprecation.py in wrapper(*inner_args, **inner_kwargs)\r\n    410                          else deprecation_addendum,\r\n    411                 **kwargs)\r\n--> 412         return func(*inner_args, **inner_kwargs)\r\n    413 \r\n    414     DECORATORS[wrapper] = decorator\r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib/backends/backend_agg.py in print_png(self, filename_or_obj, metadata, pil_kwargs, *args)\r\n    538             *metadata*, including the default 'Software' key.\r\n    539         \"\"\"\r\n--> 540         FigureCanvasAgg.draw(self)\r\n    541         mpl.image.imsave(\r\n    542             filename_or_obj, self.buffer_rgba(), format=\"png\", origin=\"upper\",\r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib/backends/backend_agg.py in draw(self)\r\n    434              (self.toolbar._wait_cursor_for_draw_cm() if self.toolbar\r\n    435               else nullcontext()):\r\n--> 436             self.figure.draw(self.renderer)\r\n    437             # A GUI class may be need to update a window using this draw, so\r\n    438             # don't forget to call the superclass.\r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib/artist.py in draw_wrapper(artist, renderer, *args, **kwargs)\r\n     71     @wraps(draw)\r\n     72     def draw_wrapper(artist, renderer, *args, **kwargs):\r\n---> 73         result = draw(artist, renderer, *args, **kwargs)\r\n     74         if renderer._rasterizing:\r\n     75             renderer.stop_rasterizing()\r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib/artist.py in draw_wrapper(artist, renderer)\r\n     48                 renderer.start_filter()\r\n     49 \r\n---> 50             return draw(artist, renderer)\r\n     51         finally:\r\n     52             if artist.get_agg_filter() is not None:\r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib/figure.py in draw(self, renderer)\r\n   2808 \r\n   2809             self.patch.draw(renderer)\r\n-> 2810             mimage._draw_list_compositing_images(\r\n   2811                 renderer, self, artists, self.suppressComposite)\r\n   2812 \r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib/image.py in _draw_list_compositing_images(renderer, parent, artists, suppress_composite)\r\n    130     if not_composite or not has_images:\r\n    131         for a in artists:\r\n--> 132             a.draw(renderer)\r\n    133     else:\r\n    134         # Composite any adjacent images together\r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib/artist.py in draw_wrapper(artist, renderer)\r\n     48                 renderer.start_filter()\r\n     49 \r\n---> 50             return draw(artist, renderer)\r\n     51         finally:\r\n     52             if artist.get_agg_filter() is not None:\r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib/axes/_base.py in draw(self, renderer)\r\n   3080             renderer.stop_rasterizing()\r\n   3081 \r\n-> 3082         mimage._draw_list_compositing_images(\r\n   3083             renderer, self, artists, self.figure.suppressComposite)\r\n   3084 \r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib/image.py in _draw_list_compositing_images(renderer, parent, artists, suppress_composite)\r\n    130     if not_composite or not has_images:\r\n    131         for a in artists:\r\n--> 132             a.draw(renderer)\r\n    133     else:\r\n    134         # Composite any adjacent images together\r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib/artist.py in draw_wrapper(artist, renderer)\r\n     48                 renderer.start_filter()\r\n     49 \r\n---> 50             return draw(artist, renderer)\r\n     51         finally:\r\n     52             if artist.get_agg_filter() is not None:\r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib/axis.py in draw(self, renderer, *args, **kwargs)\r\n   1156         renderer.open_group(__name__, gid=self.get_gid())\r\n   1157 \r\n-> 1158         ticks_to_draw = self._update_ticks()\r\n   1159         ticklabelBoxes, ticklabelBoxes2 = self._get_tick_bboxes(ticks_to_draw,\r\n   1160                                                                 renderer)\r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib/axis.py in _update_ticks(self)\r\n   1043         the axes.  Return the list of ticks that will be drawn.\r\n   1044         \"\"\"\r\n-> 1045         major_locs = self.get_majorticklocs()\r\n   1046         major_labels = self.major.formatter.format_ticks(major_locs)\r\n   1047         major_ticks = self.get_major_ticks(len(major_locs))\r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib/axis.py in get_majorticklocs(self)\r\n   1275     def get_majorticklocs(self):\r\n   1276         \"\"\"Return this Axis' major tick locations in data coordinates.\"\"\"\r\n-> 1277         return self.major.locator()\r\n   1278 \r\n   1279     def get_minorticklocs(self):\r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib/ticker.py in __call__(self)\r\n   2290         \"\"\"Return the locations of the ticks.\"\"\"\r\n   2291         vmin, vmax = self.axis.get_view_interval()\r\n-> 2292         return self.tick_values(vmin, vmax)\r\n   2293 \r\n   2294     def tick_values(self, vmin, vmax):\r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib/ticker.py in tick_values(self, vmin, vmax)\r\n   2315 \r\n   2316             if vmin <= 0.0 or not np.isfinite(vmin):\r\n-> 2317                 raise ValueError(\r\n   2318                     \"Data has no positive values, and therefore can not be \"\r\n   2319                     \"log-scaled.\")\r\n\r\nValueError: Data has no positive values, and therefore can not be log-scaled.\r\n\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib_inline/backend_inline.py in show(close, block)\r\n     41             display(\r\n     42                 figure_manager.canvas.figure,\r\n---> 43                 metadata=_fetch_figure_metadata(figure_manager.canvas.figure)\r\n     44             )\r\n     45     finally:\r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib_inline/backend_inline.py in _fetch_figure_metadata(fig)\r\n    229     if _is_transparent(fig.get_facecolor()):\r\n    230         # the background is transparent\r\n--> 231         ticksLight = _is_light([label.get_color()\r\n    232                                 for axes in fig.axes\r\n    233                                 for axis in (axes.xaxis, axes.yaxis)\r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib_inline/backend_inline.py in <listcomp>(.0)\r\n    232                                 for axes in fig.axes\r\n    233                                 for axis in (axes.xaxis, axes.yaxis)\r\n--> 234                                 for label in axis.get_ticklabels()])\r\n    235         if ticksLight.size and (ticksLight == ticksLight[0]).all():\r\n    236             # there are one or more tick labels, all with the same lightness\r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib/axis.py in get_ticklabels(self, minor, which)\r\n   1247         if minor:\r\n   1248             return self.get_minorticklabels()\r\n-> 1249         return self.get_majorticklabels()\r\n   1250 \r\n   1251     def get_majorticklines(self):\r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib/axis.py in get_majorticklabels(self)\r\n   1199     def get_majorticklabels(self):\r\n   1200         \"\"\"Return this Axis' major tick labels, as a list of `~.text.Text`.\"\"\"\r\n-> 1201         ticks = self.get_major_ticks()\r\n   1202         labels1 = [tick.label1 for tick in ticks if tick.label1.get_visible()]\r\n   1203         labels2 = [tick.label2 for tick in ticks if tick.label2.get_visible()]\r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib/axis.py in get_major_ticks(self, numticks)\r\n   1369         r\"\"\"Return the list of major `.Tick`\\s.\"\"\"\r\n   1370         if numticks is None:\r\n-> 1371             numticks = len(self.get_majorticklocs())\r\n   1372 \r\n   1373         while len(self.majorTicks) < numticks:\r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib/axis.py in get_majorticklocs(self)\r\n   1275     def get_majorticklocs(self):\r\n   1276         \"\"\"Return this Axis' major tick locations in data coordinates.\"\"\"\r\n-> 1277         return self.major.locator()\r\n   1278 \r\n   1279     def get_minorticklocs(self):\r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib/ticker.py in __call__(self)\r\n   2290         \"\"\"Return the locations of the ticks.\"\"\"\r\n   2291         vmin, vmax = self.axis.get_view_interval()\r\n-> 2292         return self.tick_values(vmin, vmax)\r\n   2293 \r\n   2294     def tick_values(self, vmin, vmax):\r\n\r\n/opt/homebrew/Caskroom/miniconda/base/envs/optuna/lib/python3.9/site-packages/matplotlib/ticker.py in tick_values(self, vmin, vmax)\r\n   2315 \r\n   2316             if vmin <= 0.0 or not np.isfinite(vmin):\r\n-> 2317                 raise ValueError(\r\n   2318                     \"Data has no positive values, and therefore can not be \"\r\n   2319                     \"log-scaled.\")\r\n\r\nValueError: Data has no positive values, and therefore can not be log-scaled.\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\nRun the code below\r\n\r\n```python\r\nfrom optuna.study import create_study\r\nfrom optuna.visualization.matplotlib import plot_parallel_coordinate\r\nfrom optuna.distributions import LogUniformDistribution\r\nfrom optuna.trial import create_trial\r\nimport matplotlib.pyplot as plt\r\n\r\n\r\nstudy_log_params = create_study()\r\nstudy_log_params.add_trial(\r\n    create_trial(\r\n        value=0.0,\r\n        params={\"param_a\": 1e-6, \"param_b\": 10},\r\n        distributions={\r\n            \"param_a\": LogUniformDistribution(1e-7, 1e-2),\r\n            \"param_b\": LogUniformDistribution(1, 1000),\r\n        },\r\n    )\r\n)\r\nstudy_log_params.add_trial(\r\n    create_trial(\r\n        value=1.0,\r\n        params={\"param_a\": 2e-5, \"param_b\": 200},\r\n        distributions={\r\n            \"param_a\": LogUniformDistribution(1e-7, 1e-2),\r\n            \"param_b\": LogUniformDistribution(1, 1000),\r\n        },\r\n    )\r\n)\r\nstudy_log_params.add_trial(\r\n    create_trial(\r\n        value=0.1,\r\n        params={\"param_a\": 1e-4, \"param_b\": 30},\r\n        distributions={\r\n            \"param_a\": LogUniformDistribution(1e-7, 1e-2),\r\n            \"param_b\": LogUniformDistribution(1, 1000),\r\n        },\r\n    )\r\n)\r\nfigure = plot_parallel_coordinate(study_log_params)\r\nplt.savefig(\"lovely.png\")\r\n```\r\n\r\n\r\n### Additional context (optional)\r\n\r\nThis example code is actually used in the test https://github.com/optuna/optuna/blob/0102d65254b7af7f0fce3143dd602c6d6ff33424/tests/visualization_tests/matplotlib_tests/test_parallel_coordinate.py#L128-L162. However, we can see this error when we save the figure or see it on a jupyter notebook.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3370/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3370/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3369", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3369/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3369/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3369/events", "html_url": "https://github.com/optuna/optuna/pull/3369", "id": 1165250144, "node_id": "PR_kwDOB0okGM40PUqK", "number": 3369, "title": "Fix objective scale in parallel coordinate of Matplotlib", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}, {"id": 3264287142, "node_id": "MDU6TGFiZWwzMjY0Mjg3MTQy", "url": "https://api.github.com/repos/optuna/optuna/labels/v3", "name": "v3", "color": "339FD7", "default": false, "description": "Issue/PR for Optuna version 3."}], "state": "closed", "locked": false, "assignee": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/41", "html_url": "https://github.com/optuna/optuna/milestone/41", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/41/labels", "id": 7640188, "node_id": "MI_kwDOB0okGM4AdJR8", "number": 41, "title": "v3.0.0-b0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 85, "state": "closed", "created_at": "2022-02-04T05:12:58Z", "updated_at": "2022-04-12T04:16:51Z", "due_on": null, "closed_at": "2022-04-12T04:16:51Z"}, "comments": 1, "created_at": "2022-03-10T13:48:21Z", "updated_at": "2022-03-15T12:14:29Z", "closed_at": "2022-03-15T11:07:42Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3369", "html_url": "https://github.com/optuna/optuna/pull/3369", "diff_url": "https://github.com/optuna/optuna/pull/3369.diff", "patch_url": "https://github.com/optuna/optuna/pull/3369.patch", "merged_at": "2022-03-15T11:07:42Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\nThe motivation can be categorised into `2. Unify appearance between Plotly and Matplotlib` in https://github.com/optuna/optuna/issues/2959. \r\n\r\nThe colourbar of `optuna.visualize.matplotlib.plot_parallel_coordinate` always includes `0` by default. As a result, the generated colourbar is inconsistent with Plotly's counterpart when zero is not in the range of objective values. For example, \r\n\r\n\r\n```python\r\nimport optuna\r\ndef objective(trial):\r\n    return trial.suggest_int(\"x\", 10, 20)\r\n\r\n\r\nstudy = optuna.create_study()\r\nstudy.optimize(objective, n_trials=10)\r\noptuna.visualization.matplotlib.plot_parallel_coordinate(study)\r\n```\r\n\r\nClearly, `objective` does not return zero. However, the generated colour bar always includes `0` as follows:\r\n\r\n<img width=\"503\" alt=\"Screenshot 2022-03-10 at 22 35 00\" src=\"https://user-images.githubusercontent.com/7121753/157673848-9713ece6-52f1-40de-8ce3-c17d8c559db9.png\">\r\n\r\nPlotly's counterpart does not use this trick (at least in the latest stable). So the plot looks like\r\n\r\n<img width=\"939\" alt=\"Screenshot 2022-03-10 at 22 34 37\" src=\"https://user-images.githubusercontent.com/7121753/157673865-89129e09-8625-4538-bdfc-054ad63b25a7.png\">\r\n\r\n\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\nRemove the hard-coded zero. The generated plots will be like\r\n\r\n<img width=\"444\" alt=\"Screenshot 2022-03-10 at 22 34 34\" src=\"https://user-images.githubusercontent.com/7121753/157673910-61ff475f-3e98-47ec-9582-ce792ca2ebd4.png\">\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3369/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3369/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3366", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3366/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3366/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3366/events", "html_url": "https://github.com/optuna/optuna/issues/3366", "id": 1164843052, "node_id": "I_kwDOB0okGM5Fbhgs", "number": 3366, "title": "CI failed due to the error in AllenNLP integration", "user": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}, {"id": 2107128673, "node_id": "MDU6TGFiZWwyMTA3MTI4Njcz", "url": "https://api.github.com/repos/optuna/optuna/labels/no-stale", "name": "no-stale", "color": "BBBBBB", "default": false, "description": "Exempt from stale bot"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-03-10T07:16:49Z", "updated_at": "2022-05-22T07:10:51Z", "closed_at": "2022-05-22T07:10:51Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nhttps://github.com/optuna/optuna/actions/runs/1960157156\r\n\r\n### Environment\r\n\r\n- Optuna version: 3.0.0b0.dev\r\n- Python version: 3.9.0\r\n- OS: 20.04.3\r\n- (Optional) Other libraries and their versions: AllenNLP 2.9.1\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\n_ test_allennlp_pruning_callback_with_executor[tests/integration_tests/allennlp_tests/example_with_executor_and_pruner_distributed.jsonnet-HyperbandPruner-pruner_kwargs0] _\r\n\r\npruner_class = <class 'optuna.pruners._hyperband.HyperbandPruner'>\r\npruner_kwargs = {'max_resource': 10, 'min_resource': 3, 'reduction_factor': 5}\r\ninput_config_file = 'tests/integration_tests/allennlp_tests/example_with_executor_and_pruner_distributed.jsonnet'\r\n\r\n    @pytest.mark.parametrize(\r\n        \"pruner_class,pruner_kwargs\",\r\n        [\r\n            (\r\n                optuna.pruners.HyperbandPruner,\r\n                {\"min_resource\": 3, \"max_resource\": 10, \"reduction_factor\": 5},\r\n            ),\r\n            (\r\n                optuna.pruners.MedianPruner,\r\n                {\"n_startup_trials\": 8, \"n_warmup_steps\": 1, \"interval_steps\": 3},\r\n            ),\r\n            (optuna.pruners.NopPruner, {}),\r\n            (\r\n                optuna.pruners.PercentilePruner,\r\n                {\"percentile\": 50.0, \"n_startup_trials\": 10, \"n_warmup_steps\": 1, \"interval_steps\": 3},\r\n            ),\r\n            (\r\n                optuna.pruners.SuccessiveHalvingPruner,\r\n                {\"min_resource\": 3, \"reduction_factor\": 5, \"min_early_stopping_rate\": 1},\r\n            ),\r\n            (\r\n                optuna.pruners.ThresholdPruner,\r\n                {\"lower\": 0.0, \"upper\": 1.0, \"n_warmup_steps\": 3, \"interval_steps\": 2},\r\n            ),\r\n        ],\r\n    )\r\n    @pytest.mark.parametrize(\r\n        \"input_config_file\",\r\n        [\r\n            \"tests/integration_tests/allennlp_tests/example_with_executor_and_pruner.jsonnet\",\r\n            \"tests/integration_tests/allennlp_tests/example_with_executor_and_pruner_distributed.jsonnet\",  # noqa: E501\r\n        ],\r\n    )\r\n    def test_allennlp_pruning_callback_with_executor(\r\n        pruner_class: Type[optuna.pruners.BasePruner],\r\n        pruner_kwargs: Dict[str, Union[int, float]],\r\n        input_config_file: str,\r\n    ) -> None:\r\n        def run_allennlp_executor(pruner: optuna.pruners.BasePruner) -> None:\r\n            study = optuna.create_study(direction=\"maximize\", pruner=pruner, storage=storage)\r\n            trial = optuna.trial.Trial(study, study._storage.create_new_trial(study._study_id))\r\n            trial.suggest_float(\"DROPOUT\", 0.0, 0.5)\r\n            executor = optuna.integration.AllenNLPExecutor(trial, input_config_file, serialization_dir)\r\n            executor.run()\r\n    \r\n        with tempfile.TemporaryDirectory() as tmp_dir:\r\n            pruner_name = pruner_class.__name__\r\n            os.mkdir(os.path.join(tmp_dir, pruner_name))\r\n            storage = \"sqlite:///\" + os.path.join(tmp_dir, pruner_name, \"result.db\")\r\n            serialization_dir = os.path.join(tmp_dir, pruner_name, \"allennlp\")\r\n    \r\n            pruner = pruner_class(**pruner_kwargs)  # type: ignore\r\n>           run_allennlp_executor(pruner)\r\n\r\ntests/integration_tests/allennlp_tests/test_allennlp.py:391: \r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\ntests/integration_tests/allennlp_tests/test_allennlp.py:382: in run_allennlp_executor\r\n    executor.run()\r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n\r\nself = <optuna.integration.allennlp._executor.AllenNLPExecutor object at 0x7f7d4443ebb0>\r\n\r\n    def run(self) -> float:\r\n        \"\"\"Train a model using AllenNLP.\"\"\"\r\n        for package_name in self._include_package:\r\n            allennlp.common.util.import_module_and_submodules(package_name)\r\n    \r\n        # Without the following lines, the transformer model construction only takes place in the\r\n        # first trial (which would consume some random numbers), and the cached model will be used\r\n        # in trials afterwards (which would not consume random numbers), leading to inconsistent\r\n        # results between single trial and multiple trials. To make results reproducible in\r\n        # multiple trials, we clear the cache before each trial.\r\n        # TODO(MagiaSN) When AllenNLP has introduced a better API to do this, one should remove\r\n        # these lines and use the new API instead. For example, use the `_clear_caches()` method\r\n        # which will be in the next AllenNLP release after 2.4.0.\r\n        allennlp.common.cached_transformers._model_cache.clear()\r\n        allennlp.common.cached_transformers._tokenizer_cache.clear()\r\n    \r\n        self._set_environment_variables()\r\n        params = allennlp.common.params.Params(self._build_params())\r\n    \r\n        if \"distributed\" in params:\r\n    \r\n            if OPTUNA_ALLENNLP_DISTRIBUTED_FLAG in os.environ:\r\n                warnings.warn(\r\n                    \"Other process may already exists.\"\r\n                    \" If you have trouble, please unset the environment\"\r\n                    \" variable `OPTUNA_ALLENNLP_USE_DISTRIBUTED`\"\r\n                    \" and try it again.\"\r\n                )\r\n    \r\n            os.environ[OPTUNA_ALLENNLP_DISTRIBUTED_FLAG] = \"1\"\r\n    \r\n        try:\r\n            allennlp.commands.train.train_model(\r\n                params=params,\r\n                serialization_dir=self._serialization_dir,\r\n                file_friendly_logging=self._file_friendly_logging,\r\n                force=self._force,\r\n                include_package=self._include_package,\r\n            )\r\n        except ProcessRaisedException as e:\r\n            if \"raise TrialPruned()\" in str(e):\r\n                raise TrialPruned()\r\n    \r\n>       metrics = json.load(open(os.path.join(self._serialization_dir, \"metrics.json\")))\r\nE       FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpawf96wcz/HyperbandPruner/allennlp/metrics.json'\r\n\r\noptuna/integration/allennlp/_executor.py:236: FileNotFoundError\r\n```\r\n\r\n### Steps to reproduce\r\n\r\nSee https://github.com/optuna/optuna/actions/runs/1960157156.\r\n\r\n### Additional context (optional)\r\n\r\n- Maybe related to https://github.com/allenai/allennlp/releases/tag/v2.9.1\r\n- Error happened on distributed configuration", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3366/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3366/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3352", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3352/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3352/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3352/events", "html_url": "https://github.com/optuna/optuna/pull/3352", "id": 1154770759, "node_id": "PR_kwDOB0okGM4zsyL-", "number": 3352, "title": "Fix missing `user_attrs` and `system_attrs` in study summaries.", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/41", "html_url": "https://github.com/optuna/optuna/milestone/41", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/41/labels", "id": 7640188, "node_id": "MI_kwDOB0okGM4AdJR8", "number": 41, "title": "v3.0.0-b0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 85, "state": "closed", "created_at": "2022-02-04T05:12:58Z", "updated_at": "2022-04-12T04:16:51Z", "due_on": null, "closed_at": "2022-04-12T04:16:51Z"}, "comments": 1, "created_at": "2022-03-01T02:17:17Z", "updated_at": "2022-03-09T08:22:40Z", "closed_at": "2022-03-09T08:22:34Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3352", "html_url": "https://github.com/optuna/optuna/pull/3352", "diff_url": "https://github.com/optuna/optuna/pull/3352.diff", "patch_url": "https://github.com/optuna/optuna/pull/3352.patch", "merged_at": "2022-03-09T08:22:34Z"}, "body": "## Motivation\r\n\r\nThis PR addresses the issue mentioned in https://github.com/optuna/optuna/pull/3105#issuecomment-1008990728.\r\n@hvy kindly shared the reproducible code as follows:\r\n\r\n```python\r\nimport optuna\r\n\r\nfor i in range(3):\r\n    study = optuna.create_study(study_name=f\"foo_{i}\", storage=\"sqlite:///test.db\")\r\n    study.set_user_attr(\"a\", \"b\")\r\n\r\n    sss = optuna.get_all_study_summaries(study._storage)\r\n    for ss in sss:\r\n        print(ss.user_attrs)\r\n```\r\n\r\nThe current master\r\n```console\r\n[I 2022-03-01 11:20:33,333] A new study created in RDB with name: foo_0\r\n{'a': 'b'}\r\n[I 2022-03-01 11:20:33,371] A new study created in RDB with name: foo_1\r\n{}\r\n{'a': 'b'}\r\n[I 2022-03-01 11:20:33,408] A new study created in RDB with name: foo_2\r\n{}\r\n{}\r\n{'a': 'b'}\r\n```\r\n\r\nThis PR\r\n```console\r\n[I 2022-03-01 11:21:27,458] A new study created in RDB with name: foo_0\r\n{'a': 'b'}\r\n[I 2022-03-01 11:21:27,498] A new study created in RDB with name: foo_1\r\n{'a': 'b'}\r\n{'a': 'b'}\r\n[I 2022-03-01 11:21:27,536] A new study created in RDB with name: foo_2\r\n{'a': 'b'}\r\n{'a': 'b'}\r\n{'a': 'b'}\r\n```\r\n\r\n## Description of the changes\r\n\r\n- The `study_id` to look up `user_attrs` and `system_attrs` is wrong. This PR fixes it.\r\n- Add items of `user_attrs` and `system_attrs` to the test of study summaries.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3352/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3352/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3333", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3333/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3333/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3333/events", "html_url": "https://github.com/optuna/optuna/issues/3333", "id": 1150067262, "node_id": "I_kwDOB0okGM5EjKI-", "number": 3333, "title": "Urgent GSoC revisions are needed.", "user": {"login": "henrykironde", "id": 5192965, "node_id": "MDQ6VXNlcjUxOTI5NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5192965?v=4", "gravatar_id": "", "url": "https://api.github.com/users/henrykironde", "html_url": "https://github.com/henrykironde", "followers_url": "https://api.github.com/users/henrykironde/followers", "following_url": "https://api.github.com/users/henrykironde/following{/other_user}", "gists_url": "https://api.github.com/users/henrykironde/gists{/gist_id}", "starred_url": "https://api.github.com/users/henrykironde/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/henrykironde/subscriptions", "organizations_url": "https://api.github.com/users/henrykironde/orgs", "repos_url": "https://api.github.com/users/henrykironde/repos", "events_url": "https://api.github.com/users/henrykironde/events{/privacy}", "received_events_url": "https://api.github.com/users/henrykironde/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-02-25T05:43:56Z", "updated_at": "2022-02-25T13:59:09Z", "closed_at": "2022-02-25T13:59:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "Confirmation needed: https://github.com/numfocus/gsoc/issues/396\r\nGoogle is not happy with our idea lists.\r\n \r\n \r\n1. Be sure to include whether the project is a 175 hour (medium sized) or 350 hour (large project). If it can be either, please state that-per idea. \r\n2. `Your Ideas Page URL should be accessible to all and not require login. --- (Covered)`\r\n3. As we state in the Defining a Project Idea List section of the Mentor guide, please provide the following information for each idea:\r\na) a project title/description \r\nb) more detailed description of the project (2-5+ sentences) \r\nc) expected outcomes \r\nd) skills required/preferred \r\ne) possible mentors \r\nf) expected size of project (175 or 350 hour) \r\ng) an easy, medium or hard difficulty rating of each project.\r\n \r\n \r\nIf you want to be selected this year I strongly suggest you make sure your Project Ideas list meets the above requirements ASAP. \r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3333/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3333/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3319", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3319/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3319/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3319/events", "html_url": "https://github.com/optuna/optuna/pull/3319", "id": 1140097803, "node_id": "PR_kwDOB0okGM4y7jfM", "number": 3319, "title": "Clip untransformed values sampled from int uniform distributions", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/41", "html_url": "https://github.com/optuna/optuna/milestone/41", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/41/labels", "id": 7640188, "node_id": "MI_kwDOB0okGM4AdJR8", "number": 41, "title": "v3.0.0-b0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 85, "state": "closed", "created_at": "2022-02-04T05:12:58Z", "updated_at": "2022-04-12T04:16:51Z", "due_on": null, "closed_at": "2022-04-12T04:16:51Z"}, "comments": 7, "created_at": "2022-02-16T14:31:18Z", "updated_at": "2022-03-18T09:42:03Z", "closed_at": "2022-03-17T04:38:01Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3319", "html_url": "https://github.com/optuna/optuna/pull/3319", "diff_url": "https://github.com/optuna/optuna/pull/3319.diff", "patch_url": "https://github.com/optuna/optuna/pull/3319.patch", "merged_at": "2022-03-17T04:38:00Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\nResolve #3316 \r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\n- Apply `DiscreteUniformDistribution`'s un-transformation logic to the values sampled from `IntUniform`.\r\n- Define a new test function in https://github.com/optuna/optuna/blob/master/tests/test_transform.py to check untransformation with clip operation\r\n- Use `clip` instead of `min` and `max` for simplexity\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3319/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3319/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3317", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3317/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3317/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3317/events", "html_url": "https://github.com/optuna/optuna/issues/3317", "id": 1138614655, "node_id": "I_kwDOB0okGM5D3eF_", "number": 3317, "title": "Installation problem --- zipfile.BadZipFile: File is not a zip file ", "user": {"login": "edgarsmdn", "id": 47745870, "node_id": "MDQ6VXNlcjQ3NzQ1ODcw", "avatar_url": "https://avatars.githubusercontent.com/u/47745870?v=4", "gravatar_id": "", "url": "https://api.github.com/users/edgarsmdn", "html_url": "https://github.com/edgarsmdn", "followers_url": "https://api.github.com/users/edgarsmdn/followers", "following_url": "https://api.github.com/users/edgarsmdn/following{/other_user}", "gists_url": "https://api.github.com/users/edgarsmdn/gists{/gist_id}", "starred_url": "https://api.github.com/users/edgarsmdn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/edgarsmdn/subscriptions", "organizations_url": "https://api.github.com/users/edgarsmdn/orgs", "repos_url": "https://api.github.com/users/edgarsmdn/repos", "events_url": "https://api.github.com/users/edgarsmdn/events{/privacy}", "received_events_url": "https://api.github.com/users/edgarsmdn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-02-15T12:19:11Z", "updated_at": "2022-02-15T12:49:24Z", "closed_at": "2022-02-15T12:49:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\n\nHi, I tried `pip install optuna` in a Linux machine, but I am facing the error: `zipfile.BadZipFile: File is not a zip file` during the installation.\r\nCould you advice on how to solve this issue?\r\n\r\n\r\n\n\n### Environment\n\n- Optuna version: None\r\n- Python version: 3.9.7\r\n- OS: Linux-3.10.0-1160.25.1.el7.x86_64-x86_64-with-glibc2.17\r\n\r\n\n\n### Error messages, stack traces, or logs\n\n```shell\nCollecting pyperclip>=1.6\r\n  Using cached pyperclip-1.8.2-py3-none-any.whl\r\nERROR: Exception:\r\nTraceback (most recent call last):\r\n  File \".../lib/python3.9/site-packages/pip/_internal/cli/base_command.py\", line 173, in _main\r\n    status = self.run(options, args)\r\n  File \".../lib/python3.9/site-packages/pip/_internal/cli/req_command.py\", line 203, in wrapper\r\n    return func(self, options, args)\r\n  File \".../lib/python3.9/site-packages/pip/_internal/commands/install.py\", line 315, in run\r\n    requirement_set = resolver.resolve(\r\n  File \".../lib/python3.9/site-packages/pip/_internal/resolution/resolvelib/resolver.py\", line 94, in resolve\r\n    result = self._result = resolver.resolve(\r\n  File \".../lib/python3.9/site-packages/pip/_vendor/resolvelib/resolvers.py\", line 472, in resolve\r\n    state = resolution.resolve(requirements, max_rounds=max_rounds)\r\n  File \".../lib/python3.9/site-packages/pip/_vendor/resolvelib/resolvers.py\", line 366, in resolve\r\n    failure_causes = self._attempt_to_pin_criterion(name)\r\n  File \".../lib/python3.9/site-packages/pip/_vendor/resolvelib/resolvers.py\", line 212, in _attempt_to_pin_criterion\r\n    criteria = self._get_updated_criteria(candidate)\r\n  File \".../lib/python3.9/site-packages/pip/_vendor/resolvelib/resolvers.py\", line 203, in _get_updated_criteria\r\n    self._add_to_criteria(criteria, requirement, parent=candidate)\r\n  File \".../lib/python3.9/site-packages/pip/_vendor/resolvelib/resolvers.py\", line 172, in _add_to_criteria\r\n    if not criterion.candidates:\r\n  File \".../lib/python3.9/site-packages/pip/_vendor/resolvelib/structs.py\", line 151, in __bool__\r\n    return bool(self._sequence)\r\n  File \".../lib/python3.9/site-packages/pip/_internal/resolution/resolvelib/found_candidates.py\", line 140, in __bool__\r\n    return any(self)\r\n  File \".../lib/python3.9/site-packages/pip/_internal/resolution/resolvelib/found_candidates.py\", line 128, in <genexpr>\r\n    return (c for c in iterator if id(c) not in self._incompatible_ids)\r\n  File \".../lib/python3.9/site-packages/pip/_internal/resolution/resolvelib/found_candidates.py\", line 32, in _iter_built\r\n    candidate = func()\r\n  File \".../lib/python3.9/site-packages/pip/_internal/resolution/resolvelib/factory.py\", line 204, in _make_candidate_from_link\r\n    self._link_candidate_cache[link] = LinkCandidate(\r\n  File \".../lib/python3.9/site-packages/pip/_internal/resolution/resolvelib/candidates.py\", line 295, in __init__\r\n    super().__init__(\r\n  File \".../lib/python3.9/site-packages/pip/_internal/resolution/resolvelib/candidates.py\", line 156, in __init__\r\n    self.dist = self._prepare()\r\n  File \".../lib/python3.9/site-packages/pip/_internal/resolution/resolvelib/candidates.py\", line 227, in _prepare\r\n    dist = self._prepare_distribution()\r\n  File \".../lib/python3.9/site-packages/pip/_internal/resolution/resolvelib/candidates.py\", line 305, in _prepare_distribution\r\n    return self._factory.preparer.prepare_linked_requirement(\r\n  File \".../lib/python3.9/site-packages/pip/_internal/operations/prepare.py\", line 508, in prepare_linked_requirement\r\n    return self._prepare_linked_requirement(req, parallel_builds)\r\n  File \".../lib/python3.9/site-packages/pip/_internal/operations/prepare.py\", line 570, in _prepare_linked_requirement\r\n    dist = _get_prepared_distribution(\r\n  File \".../lib/python3.9/site-packages/pip/_internal/operations/prepare.py\", line 61, in _get_prepared_distribution\r\n    return abstract_dist.get_pkg_resources_distribution()\r\n  File \".../lib/python3.9/site-packages/pip/_internal/distributions/wheel.py\", line 26, in get_pkg_resources_distribution\r\n    with ZipFile(self.req.local_file_path, allowZip64=True) as z:\r\n  File \".../lib/python3.9/zipfile.py\", line 1257, in __init__\r\n    self._RealGetContents()\r\n  File \".../lib/python3.9/zipfile.py\", line 1324, in _RealGetContents\r\n    raise BadZipFile(\"File is not a zip file\")\r\nzipfile.BadZipFile: File is not a zip file\n```\n\n\n### Steps to reproduce\n\n1. Install optuna via `pip` install optuna` on the specified system. And receive the above error.\r\n\r\n\n\n### Additional context (optional)\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3317/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3317/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3316", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3316/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3316/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3316/events", "html_url": "https://github.com/optuna/optuna/issues/3316", "id": 1138582636, "node_id": "I_kwDOB0okGM5D3WRs", "number": 3316, "title": "CmaEsSampler uses independent sampler even for non-dynamic search spaces", "user": {"login": "Callidior", "id": 7915048, "node_id": "MDQ6VXNlcjc5MTUwNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/7915048?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Callidior", "html_url": "https://github.com/Callidior", "followers_url": "https://api.github.com/users/Callidior/followers", "following_url": "https://api.github.com/users/Callidior/following{/other_user}", "gists_url": "https://api.github.com/users/Callidior/gists{/gist_id}", "starred_url": "https://api.github.com/users/Callidior/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Callidior/subscriptions", "organizations_url": "https://api.github.com/users/Callidior/orgs", "repos_url": "https://api.github.com/users/Callidior/repos", "events_url": "https://api.github.com/users/Callidior/events{/privacy}", "received_events_url": "https://api.github.com/users/Callidior/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2022-02-15T11:49:26Z", "updated_at": "2022-03-17T04:38:00Z", "closed_at": "2022-03-17T04:38:00Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nI am using a clearly non-dynamic search space with the `CmaEsSampler` but still see warnings that the independent sampler is triggered very frequently.\r\n\r\nI investigated this with a debugger and found that `CmaEsSampler` sometimes (or in my case, frequently) samples values that are just a bit outside of the distribution bounds. `Trial._is_relative_param()` then checks whether the value sampled for the relative search space is within bounds and, if not, the independent sampler is triggered.\r\n\r\n#1557 seems to be a related issue.\r\n\r\nMy `Trial.relative_search_space` looks as follows:\r\n\r\n```python\r\n{\r\n    'initial_learning_rate': LogUniformDistribution(high=0.001, low=1e-05),\r\n    'learning_rate_decay_factor': UniformDistribution(high=0.9999, low=0.8),\r\n    'base_filter_size_ln2': IntUniformDistribution(high=6, low=3, step=1),\r\n    'block_size': IntUniformDistribution(high=2, low=1, step=1),\r\n    'bottleneck_size': IntUniformDistribution(high=150, low=10, step=10),\r\n    'num_blocks': IntUniformDistribution(high=5, low=2, step=1),\r\n    'num_downsampling_steps': IntUniformDistribution(high=7, low=3, step=1),\r\n    'reg_scale_l1': LogUniformDistribution(high=0.1, low=0.0001),\r\n    'number_of_epochs': IntUniformDistribution(high=1000, low=500, step=100),\r\n    'weight_decay': LogUniformDistribution(high=0.001, low=1e-06)\r\n}\r\n```\r\n\r\nAnd the trial I investigated with the debugger had the following `Trial.relative_params` sampled with CmaEsSampler:\r\n\r\n```python\r\n{\r\n    'initial_learning_rate': 9.999999999999997e-06,\r\n    'learning_rate_decay_factor': 0.9998999999999999,\r\n    'base_filter_size_ln2': 7,\r\n    'block_size': 1,\r\n    'bottleneck_size': 150,\r\n    'num_blocks': 2,\r\n    'num_downsampling_steps': 3,\r\n    'reg_scale_l1': 0.00010000000000000009,\r\n    'number_of_epochs': 500,\r\n    'weight_decay': 0.0009999999999999998\r\n}\r\n```\r\n\r\nWe can see that some sampled values are slightly out of bounds:\r\n\r\n- `initial_learning_rate` is 9.999e-06 < 1e-05.\r\n- `base_filter_size_ln2` is 7 > 6.\r\n\r\nThis happens on almost every trial for me. Especially the integer parameters are prone to this.\r\nIs this a bug or do I need to make my search space less restricted?\r\n\r\n### Environment\r\n\r\n- Optuna version: 2.10.0\r\n- Python version: 3.8.12\r\n- OS: Linux-5.4.0-94-generic-x86_64-with-glibc2.10\r\n- (Optional) Other libraries and their versions:\r\n  - cmaes: 0.8.2\r\n\r\n\r\n### Error messages, stack traces, or logs\r\n\r\n```shell\r\nThe parameter 'number_of_epochs' in trial#217 is sampled independently by using `TPESampler` instead of `CmaEsSampler` (optimization performance may be degraded). `CmaEsSampler` does not support dynamic search space or `CategoricalDistribution`. You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\nThe parameter 'base_filter_size_ln2' in trial#217 is sampled independently by using `TPESampler` instead of `CmaEsSampler` (optimization performance may be degraded). `CmaEsSampler` does not support dynamic search space or `CategoricalDistribution`. You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\nThe parameter 'num_downsampling_steps' in trial#217 is sampled independently by using `TPESampler` instead of `CmaEsSampler` (optimization performance may be degraded). `CmaEsSampler` does not support dynamic search space or `CategoricalDistribution`. You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\nThe parameter 'num_blocks' in trial#217 is sampled independently by using `TPESampler` instead of `CmaEsSampler` (optimization performance may be degraded). `CmaEsSampler` does not support dynamic search space or `CategoricalDistribution`. You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\nThe parameter 'block_size' in trial#217 is sampled independently by using `TPESampler` instead of `CmaEsSampler` (optimization performance may be degraded). `CmaEsSampler` does not support dynamic search space or `CategoricalDistribution`. You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\nAdmittedly, the following MWE is not optimal, but I could reproduce the behavior with it at least one out of 100 times:\r\n\r\n```python\r\nimport optuna\r\n\r\nclass MWE:\r\n    def __call__(self, trial):\r\n        num = trial.suggest_int(\"num\", 0, 15, step=1)\r\n        denom = trial.suggest_int(\"denom\", 1, 2, step=1)\r\n        x = num / denom\r\n        return 6 * (x**4) - 14 * (x**3) - 2 * (x**2) + 10 * x\r\n\r\nif __name__ == \"__main__\":\r\n    optuna.logging.set_verbosity(optuna.logging.WARNING)\r\n    objective = MWE()\r\n\r\n    for seed in range(100):\r\n        study = optuna.create_study(\r\n            sampler=optuna.samplers.CmaEsSampler(seed=seed)\r\n        )\r\n        study.optimize(objective, n_trials=500)\r\n        print(\"Best value: {} (params: {})\\n\".format(study.best_value, study.best_params))\r\n```\r\n\r\nThis yielded:\r\n\r\n```\r\n[W 2022-02-15 13:36:30,988] The parameter 'denom' in trial#37 is sampled independently by using `RandomSampler` instead of `CmaEsSampler` (optimization performance may be degraded). `CmaEsSampler` does not support dynamic search space or `CategoricalDistribution`. You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\n```\r\n\r\n### Additional context (optional)\r\n\r\n_No response_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3316/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3316/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3303", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3303/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3303/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3303/events", "html_url": "https://github.com/optuna/optuna/pull/3303", "id": 1128054024, "node_id": "PR_kwDOB0okGM4yRp1T", "number": 3303, "title": "[Backport] Allow fail_state_trials show warning when heartbeat is enabled", "user": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/42", "html_url": "https://github.com/optuna/optuna/milestone/42", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/42/labels", "id": 7657035, "node_id": "MI_kwDOB0okGM4AdNZL", "number": 42, "title": "v3.0.0-a2", "description": "", "creator": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 2, "state": "closed", "created_at": "2022-02-09T04:37:03Z", "updated_at": "2022-02-14T04:43:01Z", "due_on": null, "closed_at": "2022-02-14T04:43:01Z"}, "comments": 1, "created_at": "2022-02-09T04:57:22Z", "updated_at": "2022-02-09T05:57:59Z", "closed_at": "2022-02-09T05:57:58Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3303", "html_url": "https://github.com/optuna/optuna/pull/3303", "diff_url": "https://github.com/optuna/optuna/pull/3303.diff", "patch_url": "https://github.com/optuna/optuna/pull/3303.patch", "merged_at": "2022-02-09T05:57:58Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nBackport #3301 to v3.0.0-a2 branch\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3303/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3303/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3301", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3301/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3301/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3301/events", "html_url": "https://github.com/optuna/optuna/pull/3301", "id": 1128000328, "node_id": "PR_kwDOB0okGM4yRe9B", "number": 3301, "title": "Allow `fail_state_trials` show warning when heartbeat is enabled", "user": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/41", "html_url": "https://github.com/optuna/optuna/milestone/41", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/41/labels", "id": 7640188, "node_id": "MI_kwDOB0okGM4AdJR8", "number": 41, "title": "v3.0.0-b0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 85, "state": "closed", "created_at": "2022-02-04T05:12:58Z", "updated_at": "2022-04-12T04:16:51Z", "due_on": null, "closed_at": "2022-04-12T04:16:51Z"}, "comments": 2, "created_at": "2022-02-09T03:17:26Z", "updated_at": "2022-02-09T05:09:31Z", "closed_at": "2022-02-09T04:41:59Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3301", "html_url": "https://github.com/optuna/optuna/pull/3301", "diff_url": "https://github.com/optuna/optuna/pull/3301.diff", "patch_url": "https://github.com/optuna/optuna/pull/3301.patch", "merged_at": "2022-02-09T04:41:59Z"}, "body": "In the current latest alpha release, the same warning message is displayed repeatedly, which is not intentional.\r\nThis behavior seemingly comes from the known issue of `warnings.catch_warnings`, which was reported in https://bugs.python.org/issue29672.\r\n\r\nInvoking `warnings.catch_warnings` has a side-effect, and it would be better not to invoke it for not only Optuna but also the library users. So, in this PR, I remove `catch_warnings` in `_run_trial` and check if heartbeat is enabled by the user instead.\r\n\r\n## Motivation\r\nStop showing a warning repeatedly.\r\n\r\n## Description of the changes\r\n- ecb80fb remove `catch_warnings` and check if heartbeat is enabled\r\n- 9e2bea9 flake8 fix (remove unused import)\r\n\r\n```python\r\nimport optuna\r\n\r\n\r\ndef objective(trial):\r\n    return trial.suggest_float(\"x\", 0, 1)\r\n\r\n\r\nstudy = optuna.create_study()\r\nstudy.optimize(objective, n_trials=5)\r\n```\r\n\r\n\r\n### Before\r\n\r\n```\r\n> python tmp/optimize_test.py                                                                                                                                                                                                          2022-02-09 12:11:42\r\n[I 2022-02-09 12:11:45,937] A new study created in memory with name: no-name-47406b8b-8af8-40b1-9c90-d9cb1e2a8d42\r\n/Users/himkt/work/github.com/himkt/optuna/optuna/trial/_trial.py:169: FutureWarning: UniformDistribution has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :class:`~optuna.distributions.FloatDistribution` instead.\r\n  distribution = UniformDistribution(low=low, high=high)\r\n[I 2022-02-09 12:11:45,939] Trial 0 finished with value: 0.7981646615533516 and parameters: {'x': 0.7981646615533516}. Best is trial 0 with value: 0.7981646615533516.\r\n/Users/himkt/work/github.com/himkt/optuna/optuna/trial/_trial.py:169: FutureWarning: UniformDistribution has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :class:`~optuna.distributions.FloatDistribution` instead.\r\n  distribution = UniformDistribution(low=low, high=high)\r\n[I 2022-02-09 12:11:45,939] Trial 1 finished with value: 0.7292757393008622 and parameters: {'x': 0.7292757393008622}. Best is trial 1 with value: 0.7292757393008622.\r\n/Users/himkt/work/github.com/himkt/optuna/optuna/trial/_trial.py:169: FutureWarning: UniformDistribution has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :class:`~optuna.distributions.FloatDistribution` instead.\r\n  distribution = UniformDistribution(low=low, high=high)\r\n[I 2022-02-09 12:11:45,959] Trial 2 finished with value: 0.4639811119742068 and parameters: {'x': 0.4639811119742068}. Best is trial 2 with value: 0.4639811119742068.\r\n/Users/himkt/work/github.com/himkt/optuna/optuna/trial/_trial.py:169: FutureWarning: UniformDistribution has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :class:`~optuna.distributions.FloatDistribution` instead.\r\n  distribution = UniformDistribution(low=low, high=high)\r\n[I 2022-02-09 12:11:45,974] Trial 3 finished with value: 0.9529777145282745 and parameters: {'x': 0.9529777145282745}. Best is trial 2 with value: 0.4639811119742068.\r\n/Users/himkt/work/github.com/himkt/optuna/optuna/trial/_trial.py:169: FutureWarning: UniformDistribution has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :class:`~optuna.distributions.FloatDistribution` instead.\r\n  distribution = UniformDistribution(low=low, high=high)\r\n[I 2022-02-09 12:11:45,975] Trial 4 finished with value: 0.5049101745390385 and parameters: {'x': 0.5049101745390385}. Best is trial 2 with value: 0.4639811119742068.\r\n```\r\n\r\n\r\n### After\r\n\r\n```\r\n> python tmp/optimize_test.py                                                                                                                                                                                                          2022-02-09 12:11:35\r\n[I 2022-02-09 12:11:39,216] A new study created in memory with name: no-name-76610cf6-85f2-42da-aabb-51442d6e6c4e\r\n/Users/himkt/work/github.com/himkt/optuna/optuna/trial/_trial.py:169: FutureWarning: UniformDistribution has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :class:`~optuna.distributions.FloatDistribution` instead.\r\n  distribution = UniformDistribution(low=low, high=high)\r\n[I 2022-02-09 12:11:39,221] Trial 0 finished with value: 0.12598191592979535 and parameters: {'x': 0.12598191592979535}. Best is trial 0 with value: 0.12598191592979535.\r\n[I 2022-02-09 12:11:39,222] Trial 1 finished with value: 0.5999996391722033 and parameters: {'x': 0.5999996391722033}. Best is trial 0 with value: 0.12598191592979535.\r\n[I 2022-02-09 12:11:39,223] Trial 2 finished with value: 0.9303211620451699 and parameters: {'x': 0.9303211620451699}. Best is trial 0 with value: 0.12598191592979535.\r\n[I 2022-02-09 12:11:39,224] Trial 3 finished with value: 0.9111266953883 and parameters: {'x': 0.9111266953883}. Best is trial 0 with value: 0.12598191592979535.\r\n[I 2022-02-09 12:11:39,224] Trial 4 finished with value: 0.9499001545534816 and parameters: {'x': 0.9499001545534816}. Best is trial 0 with value: 0.12598191592979535.\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3301/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3301/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3286", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3286/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3286/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3286/events", "html_url": "https://github.com/optuna/optuna/pull/3286", "id": 1122984098, "node_id": "PR_kwDOB0okGM4yBVcZ", "number": 3286, "title": "Skip limiting the value if it is `nan`", "user": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/40", "html_url": "https://github.com/optuna/optuna/milestone/40", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/40/labels", "id": 7453644, "node_id": "MI_kwDOB0okGM4AcbvM", "number": 40, "title": "v3.0.0-a1", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 73, "state": "closed", "created_at": "2021-12-03T05:21:42Z", "updated_at": "2022-04-08T05:21:45Z", "due_on": null, "closed_at": "2022-02-07T06:55:34Z"}, "comments": 4, "created_at": "2022-02-03T11:42:22Z", "updated_at": "2022-02-04T03:58:20Z", "closed_at": "2022-02-04T03:58:20Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3286", "html_url": "https://github.com/optuna/optuna/pull/3286", "diff_url": "https://github.com/optuna/optuna/pull/3286.diff", "patch_url": "https://github.com/optuna/optuna/pull/3286.patch", "merged_at": "2022-02-04T03:58:19Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nIn #3238, the objective value or intermediate values are clipped between `np.finfo(np.float32).min` and `np.finfo(np.float32).max`. If the value if `nan`, it clipped in `np.finfo(np.float32).min`. This PR skips limiting the value.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\nSkip limiting the value if if is `nan` by using `np.clip` as @not522 suggested.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3286/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3286/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3249", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3249/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3249/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3249/events", "html_url": "https://github.com/optuna/optuna/pull/3249", "id": 1111897225, "node_id": "PR_kwDOB0okGM4xdUPj", "number": 3249, "title": "Fix axis range issue in matplotlib contour plot", "user": {"login": "harupy", "id": 17039389, "node_id": "MDQ6VXNlcjE3MDM5Mzg5", "avatar_url": "https://avatars.githubusercontent.com/u/17039389?v=4", "gravatar_id": "", "url": "https://api.github.com/users/harupy", "html_url": "https://github.com/harupy", "followers_url": "https://api.github.com/users/harupy/followers", "following_url": "https://api.github.com/users/harupy/following{/other_user}", "gists_url": "https://api.github.com/users/harupy/gists{/gist_id}", "starred_url": "https://api.github.com/users/harupy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/harupy/subscriptions", "organizations_url": "https://api.github.com/users/harupy/orgs", "repos_url": "https://api.github.com/users/harupy/repos", "events_url": "https://api.github.com/users/harupy/events{/privacy}", "received_events_url": "https://api.github.com/users/harupy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}, {"id": 3264287142, "node_id": "MDU6TGFiZWwzMjY0Mjg3MTQy", "url": "https://api.github.com/repos/optuna/optuna/labels/v3", "name": "v3", "color": "339FD7", "default": false, "description": "Issue/PR for Optuna version 3."}], "state": "closed", "locked": false, "assignee": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/41", "html_url": "https://github.com/optuna/optuna/milestone/41", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/41/labels", "id": 7640188, "node_id": "MI_kwDOB0okGM4AdJR8", "number": 41, "title": "v3.0.0-b0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 85, "state": "closed", "created_at": "2022-02-04T05:12:58Z", "updated_at": "2022-04-12T04:16:51Z", "due_on": null, "closed_at": "2022-04-12T04:16:51Z"}, "comments": 5, "created_at": "2022-01-23T15:10:21Z", "updated_at": "2022-03-09T04:51:34Z", "closed_at": "2022-02-05T08:10:47Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3249", "html_url": "https://github.com/optuna/optuna/pull/3249", "diff_url": "https://github.com/optuna/optuna/pull/3249.diff", "patch_url": "https://github.com/optuna/optuna/pull/3249.patch", "merged_at": "2022-02-05T08:10:46Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\nFix #3197\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\nWhen computing the subplot ranges for parameter X, ignore other parameters.\r\n\r\n## Test\r\n\r\nRun this script and confirm the subplot ranges are correct:\r\n\r\n```python\r\nimport optuna\r\nfrom optuna.testing.visualization import prepare_study_with_trials\r\nimport matplotlib.pyplot as plt\r\n\r\nstudy = prepare_study_with_trials(more_than_three=True, n_objectives=2, with_c_d=True)\r\nprint(study.trials_dataframe())\r\nfigure = optuna.visualization.plot_contour(study, target=lambda t: t.values[0])\r\n\r\nfigure.write_image('plotly.png')\r\noptuna.visualization.matplotlib.plot_contour(study, target=lambda t: t.values[0])\r\nplt.savefig('matplotlib.png')\r\n```\r\n\r\n### Before\r\n\r\n![image](https://user-images.githubusercontent.com/17039389/150685072-d3ab4bb6-a6d4-426b-8cba-1a84ed59c331.png)\r\n\r\n### After\r\n\r\n![image](https://user-images.githubusercontent.com/17039389/150685039-e290347c-017d-4962-8907-52739000ad74.png)", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3249/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3249/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3238", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3238/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3238/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3238/events", "html_url": "https://github.com/optuna/optuna/pull/3238", "id": 1107262838, "node_id": "PR_kwDOB0okGM4xOJQJ", "number": 3238, "title": "Handle `-inf` and `inf` values in `RDBStorage`", "user": {"login": "xadrianzetx", "id": 37713008, "node_id": "MDQ6VXNlcjM3NzEzMDA4", "avatar_url": "https://avatars.githubusercontent.com/u/37713008?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xadrianzetx", "html_url": "https://github.com/xadrianzetx", "followers_url": "https://api.github.com/users/xadrianzetx/followers", "following_url": "https://api.github.com/users/xadrianzetx/following{/other_user}", "gists_url": "https://api.github.com/users/xadrianzetx/gists{/gist_id}", "starred_url": "https://api.github.com/users/xadrianzetx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xadrianzetx/subscriptions", "organizations_url": "https://api.github.com/users/xadrianzetx/orgs", "repos_url": "https://api.github.com/users/xadrianzetx/repos", "events_url": "https://api.github.com/users/xadrianzetx/events{/privacy}", "received_events_url": "https://api.github.com/users/xadrianzetx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}, {"id": 3264287142, "node_id": "MDU6TGFiZWwzMjY0Mjg3MTQy", "url": "https://api.github.com/repos/optuna/optuna/labels/v3", "name": "v3", "color": "339FD7", "default": false, "description": "Issue/PR for Optuna version 3."}], "state": "closed", "locked": false, "assignee": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/40", "html_url": "https://github.com/optuna/optuna/milestone/40", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/40/labels", "id": 7453644, "node_id": "MI_kwDOB0okGM4AcbvM", "number": 40, "title": "v3.0.0-a1", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 73, "state": "closed", "created_at": "2021-12-03T05:21:42Z", "updated_at": "2022-04-08T05:21:45Z", "due_on": null, "closed_at": "2022-02-07T06:55:34Z"}, "comments": 5, "created_at": "2022-01-18T19:06:18Z", "updated_at": "2022-01-30T08:37:08Z", "closed_at": "2022-01-30T02:08:46Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3238", "html_url": "https://github.com/optuna/optuna/pull/3238", "diff_url": "https://github.com/optuna/optuna/pull/3238.diff", "patch_url": "https://github.com/optuna/optuna/pull/3238.patch", "merged_at": "2022-01-30T02:08:46Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nPreviously an error could be raised when `-inf` or `inf` was registered in rdb storage. Depending on SQL dialect in backend, those special values might be supported or not. This PR introduces a simple way to get around this limitation by storing `-inf` and `inf` as minimum and maximum values of 32 bit float and providing thin translation layer between stored and true values on database reads and writes. This gives effective available range for trial values of `(-3.4028235e+38, 3.4028235e+38)`. Everything beyond that is interpreted as infinity. Closes #3206.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n* Implement `inf` handling in `RDBStorage`\r\n* Test", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3238/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3238/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3218", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3218/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3218/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3218/events", "html_url": "https://github.com/optuna/optuna/pull/3218", "id": 1092832001, "node_id": "PR_kwDOB0okGM4we8xK", "number": 3218, "title": "Fix log scale axes padding in `matplotlib.contour_plot`", "user": {"login": "xadrianzetx", "id": 37713008, "node_id": "MDQ6VXNlcjM3NzEzMDA4", "avatar_url": "https://avatars.githubusercontent.com/u/37713008?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xadrianzetx", "html_url": "https://github.com/xadrianzetx", "followers_url": "https://api.github.com/users/xadrianzetx/followers", "following_url": "https://api.github.com/users/xadrianzetx/following{/other_user}", "gists_url": "https://api.github.com/users/xadrianzetx/gists{/gist_id}", "starred_url": "https://api.github.com/users/xadrianzetx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xadrianzetx/subscriptions", "organizations_url": "https://api.github.com/users/xadrianzetx/orgs", "repos_url": "https://api.github.com/users/xadrianzetx/repos", "events_url": "https://api.github.com/users/xadrianzetx/events{/privacy}", "received_events_url": "https://api.github.com/users/xadrianzetx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/40", "html_url": "https://github.com/optuna/optuna/milestone/40", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/40/labels", "id": 7453644, "node_id": "MI_kwDOB0okGM4AcbvM", "number": 40, "title": "v3.0.0-a1", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 73, "state": "closed", "created_at": "2021-12-03T05:21:42Z", "updated_at": "2022-04-08T05:21:45Z", "due_on": null, "closed_at": "2022-02-07T06:55:34Z"}, "comments": 3, "created_at": "2022-01-03T21:26:36Z", "updated_at": "2022-01-11T12:27:09Z", "closed_at": "2022-01-11T07:34:03Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3218", "html_url": "https://github.com/optuna/optuna/pull/3218", "diff_url": "https://github.com/optuna/optuna/pull/3218.diff", "patch_url": "https://github.com/optuna/optuna/pull/3218.patch", "merged_at": "2022-01-11T07:34:03Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nPreviously, padding operation was applied incorrectly to log scale axis, which resulted in malformed plots. Discovered while working on #3199, and implements one of the tests cases mentioned there, along with bugfix.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n- Fix buggy padding logic\r\n- Add tests\r\n\r\n## Examples\r\n```python\r\n# [...]\r\nstudy = create_study()\r\nstudy.add_trial(\r\n    create_trial(\r\n        value=0.0,\r\n        params={\"param_a\": 1e-6, \"param_b\": \"100\"},\r\n        distributions={\r\n            \"param_a\": FloatDistribution(1e-7, 1e-2, log=True),\r\n            \"param_b\": CategoricalDistribution([\"100\", \"101\"]),\r\n        },\r\n    )\r\n)\r\nstudy.add_trial(\r\n    create_trial(\r\n        value=1.0,\r\n        params={\"param_a\": 1e-5, \"param_b\": \"101\"},\r\n        distributions={\r\n            \"param_a\": FloatDistribution(1e-7, 1e-2, log=True),\r\n            \"param_b\": CategoricalDistribution([\"100\", \"101\"]),\r\n        },\r\n    )\r\n)\r\nfigure = plot_contour(study)\r\n```\r\n\r\n### master\r\n![Screenshot from 2022-01-03 19-29-30](https://user-images.githubusercontent.com/37713008/147981415-2fb9c6d6-5a91-4428-b63d-3509eee7aa08.png)\r\n\r\n### This PR\r\n![Screenshot from 2022-01-03 20-57-06](https://user-images.githubusercontent.com/37713008/147981443-31437ab4-8fef-419c-9480-a608b9216346.png)\r\n\r\n\r\n### Plotly\r\n![Screenshot from 2022-01-03 19-30-11](https://user-images.githubusercontent.com/37713008/147981550-6a643c80-9247-45ee-ac11-0193569f4676.png)\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3218/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3218/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3213", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3213/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3213/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3213/events", "html_url": "https://github.com/optuna/optuna/pull/3213", "id": 1090581259, "node_id": "PR_kwDOB0okGM4wXwSH", "number": 3213, "title": "Handle non-numerical params in `matplotlib.contour_plot`", "user": {"login": "xadrianzetx", "id": 37713008, "node_id": "MDQ6VXNlcjM3NzEzMDA4", "avatar_url": "https://avatars.githubusercontent.com/u/37713008?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xadrianzetx", "html_url": "https://github.com/xadrianzetx", "followers_url": "https://api.github.com/users/xadrianzetx/followers", "following_url": "https://api.github.com/users/xadrianzetx/following{/other_user}", "gists_url": "https://api.github.com/users/xadrianzetx/gists{/gist_id}", "starred_url": "https://api.github.com/users/xadrianzetx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xadrianzetx/subscriptions", "organizations_url": "https://api.github.com/users/xadrianzetx/orgs", "repos_url": "https://api.github.com/users/xadrianzetx/repos", "events_url": "https://api.github.com/users/xadrianzetx/events{/privacy}", "received_events_url": "https://api.github.com/users/xadrianzetx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/40", "html_url": "https://github.com/optuna/optuna/milestone/40", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/40/labels", "id": 7453644, "node_id": "MI_kwDOB0okGM4AcbvM", "number": 40, "title": "v3.0.0-a1", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 73, "state": "closed", "created_at": "2021-12-03T05:21:42Z", "updated_at": "2022-04-08T05:21:45Z", "due_on": null, "closed_at": "2022-02-07T06:55:34Z"}, "comments": 4, "created_at": "2021-12-29T15:08:49Z", "updated_at": "2022-01-12T15:07:47Z", "closed_at": "2022-01-12T05:33:50Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3213", "html_url": "https://github.com/optuna/optuna/pull/3213", "diff_url": "https://github.com/optuna/optuna/pull/3213.diff", "patch_url": "https://github.com/optuna/optuna/pull/3213.patch", "merged_at": "2022-01-12T05:33:50Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nPreviously, an error was raised when matplotlib backed contour plot was created with non-numerical params from `CategoricalDistribution`. This PR introduces a handler for such cases, similar to plotly backend. Discovered while working on #3199, and implements one of the tests cases mentioned there, along with bugfix.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n* Handle non-numerical params in `matplotlib.contour_plot`\r\n* Write tests", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3213/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3213/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3206", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3206/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3206/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3206/events", "html_url": "https://github.com/optuna/optuna/issues/3206", "id": 1088151719, "node_id": "I_kwDOB0okGM5A2-Cn", "number": 3206, "title": "`inf` handling in Optuna", "user": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 2107128673, "node_id": "MDU6TGFiZWwyMTA3MTI4Njcz", "url": "https://api.github.com/repos/optuna/optuna/labels/no-stale", "name": "no-stale", "color": "BBBBBB", "default": false, "description": "Exempt from stale bot"}, {"id": 3264287142, "node_id": "MDU6TGFiZWwzMjY0Mjg3MTQy", "url": "https://api.github.com/repos/optuna/optuna/labels/v3", "name": "v3", "color": "339FD7", "default": false, "description": "Issue/PR for Optuna version 3."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-12-24T05:04:19Z", "updated_at": "2022-06-24T05:40:18Z", "closed_at": "2022-06-24T05:40:17Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n## Expected behavior\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\nRegardless of the type of storage used, the trial accepts `inf` for its value when an objective function returns `inf`, when `inf` is passed in `trial.report`, or when `inf` is passed in `study.tell`. Note that it is the responsibility of the sampler or pruner to decide how to use the `inf` values stored in the storage. For example, `TPESampler`, the default sampler in Optuna, is implemented to be able to use `inf`.\r\n\r\nWe need to fix the followings.\r\n- [x] If `inf` is returned by objective function, the study accepts it regardless of the type of storage used.\r\n- [x] If `inf` is passed in `trial.report`, the study accepts it regardless of the type of storage used.\r\n- [x] If `inf` is passed in `study.tell`, the study accepts it regardless of the type of storage used.\r\n\r\n## Environment\r\n\r\n<!--\r\nYou can get this information by typing the following:\r\n```\r\npython -c 'import optuna; print(optuna.__version__)'\r\npython -c 'import platform; print(platform.python_version())'\r\npython -c 'import platform; print(platform.platform())'\r\n```\r\n-->\r\n\r\n- Optuna version: a70cbff8dbc454f137b61622633404bd4e4657fc\r\n- Python version: 3.9.9\r\n- OS: macOS Catalina 10.15.7\r\n- (Optional) Other libraries and their versions:\r\npsycopg2:    2.9.2\r\nPyMySQL:     1.0.2\r\n\r\n## Error messages, stack traces, or logs\r\n\r\nIf we run the script `inf-objective.py`, we will get the following output. The script is provided in the section of `Reproducible examples`. I think we need to modify this behavior as explained in `Expected behavior`. Concretely, we should fix the behavior with MySQL to accept the `inf`.\r\n<details>\r\n<summary>output</summary>\r\n\r\n```\r\n(venv) mamu@HideakinoMacBook-puro test % python inf-objective.py \r\n[I 2021-12-24 13:58:54,771] A new study created in memory with name: no-name-f7f28497-2f1c-4739-b9c8-edca726274fc\r\n[I 2021-12-24 13:58:54,772] Trial 0 finished with value: inf and parameters: {}. Best is trial 0 with value: inf.\r\nIn-memory : Trial state is TrialState.COMPLETE\r\n[I 2021-12-24 13:58:54,843] A new study created in RDB with name: no-name-168f23c0-0ac5-4785-a6d6-bdfd31dda5ab\r\n[I 2021-12-24 13:58:54,909] Trial 0 finished with value: inf and parameters: {}. Best is trial 0 with value: inf.\r\nSQLite    : Trial state is TrialState.COMPLETE\r\n[I 2021-12-24 13:58:55,052] A new study created in RDB with name: no-name-22068297-6685-4435-bf88-124621f797c1\r\nRecord does not exist.\r\nMySQL     : Trial state is TrialState.RUNNING\r\n[I 2021-12-24 13:58:55,501] A new study created in RDB with name: no-name-39229033-d3b5-43fa-93f6-1e9a313593f6\r\n[I 2021-12-24 13:58:55,700] Trial 0 finished with value: inf and parameters: {}. Best is trial 0 with value: inf.\r\nPostgreSQL: Trial state is TrialState.COMPLETE\r\n```\r\n</details>\r\n\r\nOn the other hand, if we run the script `inf-report.py`, we will get the following output. The script is provided in the section of `Reproducible examples`. I think we need to modify this behavior as explained in `Expected behavior`. Concretely, we should fix the behavior with MySQL to accept the `inf`.\r\n<details>\r\n<summary>output</summary>\r\n\r\n```\r\n(venv) mamu@HideakinoMacBook-puro test % python inf-report.py \r\n[I 2021-12-24 14:01:01,970] A new study created in memory with name: no-name-44b8d7da-1b6f-4e38-80f4-33d826b4ff74\r\n[I 2021-12-24 14:01:01,971] Trial 0 finished with value: 1.0 and parameters: {}. Best is trial 0 with value: 1.0.\r\nIn-memory : Trial state is TrialState.COMPLETE\r\n[I 2021-12-24 14:01:02,040] A new study created in RDB with name: no-name-8e47d68f-83e3-4016-b18c-b7ae4930986b\r\n[I 2021-12-24 14:01:02,564] Trial 0 finished with value: 1.0 and parameters: {}. Best is trial 0 with value: 1.0.\r\nSQLite    : Trial state is TrialState.COMPLETE\r\n[I 2021-12-24 14:01:02,712] A new study created in RDB with name: no-name-dede90c7-9907-47d5-9a78-873233f61f36\r\n[W 2021-12-24 14:01:02,830] Trial 0 failed because of the following error: StorageInternalError('An exception is raised during the commit. This typically happens due to invalid data in the commit, e.g. exceeding max length. ')\r\nTraceback (most recent call last):\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py\", line 1802, in _execute_context\r\n    self.dialect.do_execute(\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/engine/default.py\", line 732, in do_execute\r\n    cursor.execute(statement, parameters)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/cursors.py\", line 146, in execute\r\n    query = self.mogrify(query, args)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/cursors.py\", line 125, in mogrify\r\n    query = query % self._escape_args(args, conn)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/cursors.py\", line 109, in _escape_args\r\n    return {key: conn.literal(val) for (key, val) in args.items()}\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/cursors.py\", line 109, in <dictcomp>\r\n    return {key: conn.literal(val) for (key, val) in args.items()}\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/connections.py\", line 517, in literal\r\n    return self.escape(obj, self.encoders)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/connections.py\", line 510, in escape\r\n    return converters.escape_item(obj, self.charset, mapping=mapping)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/converters.py\", line 25, in escape_item\r\n    val = encoder(val, mapping)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/converters.py\", line 60, in escape_float\r\n    raise ProgrammingError(\"%s can not be used with MySQL\" % s)\r\npymysql.err.ProgrammingError: inf can not be used with MySQL\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/optuna/storages/_rdb/storage.py\", line 54, in _create_scoped_session\r\n    session.commit()\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py\", line 1431, in commit\r\n    self._transaction.commit(_to_root=self.future)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py\", line 829, in commit\r\n    self._prepare_impl()\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py\", line 808, in _prepare_impl\r\n    self.session.flush()\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py\", line 3363, in flush\r\n    self._flush(objects)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py\", line 3503, in _flush\r\n    transaction.rollback(_capture_exception=True)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py\", line 70, in __exit__\r\n    compat.raise_(\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/util/compat.py\", line 207, in raise_\r\n    raise exception\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py\", line 3463, in _flush\r\n    flush_context.execute()\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py\", line 456, in execute\r\n    rec.execute(self)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py\", line 630, in execute\r\n    util.preloaded.orm_persistence.save_obj(\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py\", line 244, in save_obj\r\n    _emit_insert_statements(\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py\", line 1221, in _emit_insert_statements\r\n    result = connection._execute_20(\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py\", line 1614, in _execute_20\r\n    return meth(self, args_10style, kwargs_10style, execution_options)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/sql/elements.py\", line 325, in _execute_on_connection\r\n    return connection._execute_clauseelement(\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py\", line 1481, in _execute_clauseelement\r\n    ret = self._execute_context(\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py\", line 1845, in _execute_context\r\n    self._handle_dbapi_exception(\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py\", line 2026, in _handle_dbapi_exception\r\n    util.raise_(\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/util/compat.py\", line 207, in raise_\r\n    raise exception\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py\", line 1802, in _execute_context\r\n    self.dialect.do_execute(\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/engine/default.py\", line 732, in do_execute\r\n    cursor.execute(statement, parameters)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/cursors.py\", line 146, in execute\r\n    query = self.mogrify(query, args)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/cursors.py\", line 125, in mogrify\r\n    query = query % self._escape_args(args, conn)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/cursors.py\", line 109, in _escape_args\r\n    return {key: conn.literal(val) for (key, val) in args.items()}\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/cursors.py\", line 109, in <dictcomp>\r\n    return {key: conn.literal(val) for (key, val) in args.items()}\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/connections.py\", line 517, in literal\r\n    return self.escape(obj, self.encoders)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/connections.py\", line 510, in escape\r\n    return converters.escape_item(obj, self.charset, mapping=mapping)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/converters.py\", line 25, in escape_item\r\n    val = encoder(val, mapping)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/converters.py\", line 60, in escape_float\r\n    raise ProgrammingError(\"%s can not be used with MySQL\" % s)\r\nsqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) inf can not be used with MySQL\r\n[SQL: INSERT INTO trial_intermediate_values (trial_id, step, intermediate_value) VALUES (%(trial_id)s, %(step)s, %(intermediate_value)s)]\r\n[parameters: {'trial_id': 10, 'step': 1, 'intermediate_value': inf}]\r\n(Background on this error at: https://sqlalche.me/e/14/f405)\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/optuna/study/_optimize.py\", line 213, in _run_trial\r\n    value_or_values = func(trial)\r\n  File \"/Users/mamu/Dev/pfn/code_snippets_for_optuna/test/inf-report.py\", line 5, in objective\r\n    trial.report(float(np.inf), 1)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/optuna/trial/_trial.py\", line 506, in report\r\n    self.storage.set_trial_intermediate_value(self._trial_id, step, value)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/optuna/storages/_cached_storage.py\", line 293, in set_trial_intermediate_value\r\n    self._backend.set_trial_intermediate_value(trial_id, step, intermediate_value)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/optuna/storages/_rdb/storage.py\", line 754, in set_trial_intermediate_value\r\n    self._set_trial_intermediate_value_without_commit(\r\n  File \"/Users/mamu/.pyenv/versions/3.9.9/lib/python3.9/contextlib.py\", line 126, in __exit__\r\n    next(self.gen)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/optuna/storages/_rdb/storage.py\", line 71, in _create_scoped_session\r\n    raise optuna.exceptions.StorageInternalError(message) from e\r\noptuna.exceptions.StorageInternalError: An exception is raised during the commit. This typically happens due to invalid data in the commit, e.g. exceeding max length. \r\nAn exception is raised during the commit. This typically happens due to invalid data in the commit, e.g. exceeding max length. \r\nMySQL     : Trial state is TrialState.FAIL\r\n[I 2021-12-24 14:01:03,078] A new study created in RDB with name: no-name-da490862-bbd5-4e04-8b64-be71deddeb52\r\n[I 2021-12-24 14:01:03,238] Trial 0 finished with value: 1.0 and parameters: {}. Best is trial 0 with value: 1.0.\r\nPostgreSQL: Trial state is TrialState.COMPLETE\r\n```\r\n</details>\r\n\r\nIn addition, if we run the script `inf-tell.py`, we will get the following output. The script is provided in the section of `Reproducible examples`. I think we need to modify this behavior as explained in `Expected behavior`. Concretely, we should fix the behavior with MySQL to accept the `inf`.\r\n<details>\r\n<summary>output</summary>\r\n\r\n```\r\n[I 2021-12-24 15:26:11,042] A new study created in memory with name: no-name-7cc77d37-ffee-45a6-8488-8b66aeda30e8\r\nIn-memory : Trial state is TrialState.COMPLETE\r\n[I 2021-12-24 15:26:11,105] A new study created in RDB with name: no-name-5200946f-3b52-4043-b477-74c84d1fa160\r\nSQLite    : Trial state is TrialState.COMPLETE\r\n[I 2021-12-24 15:26:11,287] A new study created in RDB with name: no-name-5821e24f-163e-4e3b-9702-6adb73fe2311\r\nAn exception is raised during the commit. This typically happens due to invalid data in the commit, e.g. exceeding max length. \r\nMySQL     : Trial state is TrialState.RUNNING\r\n[I 2021-12-24 15:26:11,613] A new study created in RDB with name: no-name-218980c1-e3ff-48b8-b349-243b210034f7\r\nPostgreSQL: Trial state is TrialState.COMPLETE\r\n```\r\n</details>\r\n\r\n## Steps to reproduce\r\n\r\n1. Install docker\r\n2. Setup MySQL DB\r\n```\r\ndocker run --name mysql -e MYSQL_ROOT_PASSWORD=test -p 3306:3306 -p 33060:33060 -d mysql:8.0.22\r\ndocker run --network host -it --rm mysql:8.0.22  mysql -h 127.0.0.1 -uroot -ptest -e \"create database mysql;\"\r\n```\r\n3. Setup PostgreSQL DB\r\n```\r\ndocker run -it --rm --name postgres-test -e POSTGRES_PASSWORD=test -p 15432:5432 -d postgres\r\n```\r\n4. Run `inf-objectibe.py`, `inf-report.py`, and `inf-tell.py`.\r\n\r\n## Reproducible examples (optional)\r\n- `inf-objective.py`\r\n```python\r\nimport optuna\r\nimport numpy as np\r\n\r\ndef objective(trial):\r\n    return float(np.inf)\r\n\r\n# In-memory storage\r\nstudy = optuna.create_study()\r\nstudy.optimize(objective, n_trials=1)\r\nprint(f\"In-memory : Trial state is {study.trials[-1].state}\")\r\n\r\n# RDB storage (SQLite)\r\nstudy = optuna.create_study(storage='sqlite:///../sqlite.db')\r\nstudy.optimize(objective, n_trials=1)\r\nprint(f\"SQLite    : Trial state is {study.trials[-1].state}\")\r\n\r\n# RDB storage (MySQL)\r\nstudy = optuna.create_study(storage=\"mysql+pymysql://root:test@localhost/mysql\")\r\ntry:\r\n    study.optimize(objective, n_trials=1)\r\nexcept Exception as e:\r\n    print(e)\r\n    print(f\"MySQL     : Trial state is {study.trials[-1].state}\")\r\n\r\n# RDB storage (PostgreSQL)\r\nstudy = optuna.create_study(storage=\"postgresql+psycopg2://postgres:test@localhost:15432/postgres\")\r\nstudy.optimize(objective, n_trials=1)\r\nprint(f\"PostgreSQL: Trial state is {study.trials[-1].state}\")\r\n```\r\n\r\n- `inf-report.py`\r\n```python\r\nimport optuna\r\nimport numpy as np\r\n\r\ndef objective(trial):\r\n    trial.report(float(np.inf), 1)\r\n    return 1\r\n\r\n# In-memory storage\r\nstudy = optuna.create_study()\r\nstudy.optimize(objective, n_trials=1)\r\nprint(f\"In-memory : Trial state is {study.trials[-1].state}\")\r\n\r\n# RDB storage (SQLite)\r\nstudy = optuna.create_study(storage='sqlite:///../sqlite.db')\r\nstudy.optimize(objective, n_trials=1)\r\nprint(f\"SQLite    : Trial state is {study.trials[-1].state}\")\r\n\r\n# RDB storage (MySQL)\r\nstudy = optuna.create_study(storage=\"mysql+pymysql://root:test@localhost/mysql\")\r\ntry:\r\n    study.optimize(objective, n_trials=1)\r\nexcept Exception as e:\r\n    print(e)\r\n    print(f\"MySQL     : Trial state is {study.trials[-1].state}\")\r\n\r\n# RDB storage (PostgreSQL)\r\nstudy = optuna.create_study(storage=\"postgresql+psycopg2://postgres:test@localhost:15432/postgres\")\r\nstudy.optimize(objective, n_trials=1)\r\nprint(f\"PostgreSQL: Trial state is {study.trials[-1].state}\")\r\n``` \r\n\r\n- `inf-tel.py`\r\n```python\r\nimport optuna\r\nimport numpy as np\r\n\r\n\r\n# In-memory storage\r\nstudy = optuna.create_study()\r\ntrial = study.ask()\r\nstudy.tell(trial, float(np.inf))\r\nprint(f\"In-memory : Trial state is {study.trials[-1].state}\")\r\n\r\n# RDB storage (SQLite)\r\nstudy = optuna.create_study(storage='sqlite:///../sqlite.db')\r\ntrial = study.ask()\r\nstudy.tell(trial, float(np.inf))\r\nprint(f\"SQLite    : Trial state is {study.trials[-1].state}\")\r\n\r\n# RDB storage (MySQL)\r\nstudy = optuna.create_study(storage=\"mysql+pymysql://root:test@localhost/mysql\")\r\ntrial = study.ask()\r\ntry:\r\n    study.tell(trial, float(np.inf))\r\nexcept Exception as e:\r\n    print(e)\r\n    print(f\"MySQL     : Trial state is {study.trials[-1].state}\")\r\n\r\n# RDB storage (PostgreSQL)\r\nstudy = optuna.create_study(storage=\"postgresql+psycopg2://postgres:test@localhost:15432/postgres\")\r\ntrial = study.ask()\r\nstudy.tell(trial, float(np.inf))\r\nprint(f\"PostgreSQL: Trial state is {study.trials[-1].state}\")\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3206/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3206/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3205", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3205/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3205/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3205/events", "html_url": "https://github.com/optuna/optuna/issues/3205", "id": 1088146531, "node_id": "I_kwDOB0okGM5A28xj", "number": 3205, "title": "`nan` handling in Optuna", "user": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}, {"id": 2107128673, "node_id": "MDU6TGFiZWwyMTA3MTI4Njcz", "url": "https://api.github.com/repos/optuna/optuna/labels/no-stale", "name": "no-stale", "color": "BBBBBB", "default": false, "description": "Exempt from stale bot"}, {"id": 3264287142, "node_id": "MDU6TGFiZWwzMjY0Mjg3MTQy", "url": "https://api.github.com/repos/optuna/optuna/labels/v3", "name": "v3", "color": "339FD7", "default": false, "description": "Issue/PR for Optuna version 3."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-12-24T04:47:53Z", "updated_at": "2022-05-16T00:59:18Z", "closed_at": "2022-05-16T00:59:18Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\nA new version of https://github.com/optuna/optuna/issues/2169 adapted to the latest Optuna.\r\nAnd related to https://github.com/optuna/optuna/issues/3132.\r\n\r\n[note: fixed 2022/01/30]\r\n\r\n## Expected behavior\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n~Regardless of the type of storage used, mark the corresponding trial as `FAILED` when an objective function returns `nan`, when `nan` is passed in `trial.report`, or when `nan` is passed in `study.tell`.~\r\nRegardless of the type of storage used, mark the corresponding trial as `FAILED` when an objective function returns `nan` or when `nan` is passed in `study.tell`.\r\nOn the other hand, regardless of the type of storage used, accept the reported `nan` when `nan` is reported with `trial.report`.\r\n\r\nWe need to fix the following.\r\n- [x] ~If `nan` is passed in `trial.report`, mark the trial as `FAILED` regardless of the type of storage used.~ If `nan` is passed in `trial.report`, accept the reported `nan` regardless of the type of storage used. #3348\r\n- [x] ~Add document for workaround when passing `nan` in `trial.report`. In a trial, if the intermediate value is `nan` at the beginning of the calculation, but it reverts to the appropriate value in the middle, the user can check if it is not `nan` before `trial.report`.~\r\n- [x] If `nan` is passed in `study.tell`, mark the trial as `FAILED` regardless of the type of storage used. https://github.com/optuna/optuna/pull/3144 \r\n\r\n## Environment\r\n\r\n<!--\r\nYou can get this information by typing the following:\r\n```\r\npython -c 'import optuna; print(optuna.__version__)'\r\npython -c 'import platform; print(platform.python_version())'\r\npython -c 'import platform; print(platform.platform())'\r\n```\r\n-->\r\n\r\n- Optuna version: a70cbff8dbc454f137b61622633404bd4e4657fc\r\n- Python version: 3.9.9\r\n- OS: macOS Catalina 10.15.7\r\n- (Optional) Other libraries and their versions:\r\npsycopg2:    2.9.2\r\nPyMySQL:     1.0.2\r\n\r\n## Error messages, stack traces, or logs\r\n\r\nIf we run the script `nan-objective.py`, we will get the following output. The script is provided in the section of `Reproducible examples`. I think this output is ideal and does not need to be modified. We should mark the trial as `FAILED` for all storages.\r\n<details>\r\n<summary>output</summary>\r\n\r\n```\r\n(venv) mamu@HideakinoMacBook-puro test % python nan-objective.py \r\n[I 2021-12-24 13:36:27,998] A new study created in memory with name: no-name-769e5aec-62ec-4719-ac85-6a6fbf375bee\r\n[W 2021-12-24 13:36:28,002] Trial 0 failed, because the objective function returned nan.\r\nIn-memory : Trial state is TrialState.FAIL\r\n[I 2021-12-24 13:36:28,086] A new study created in RDB with name: no-name-8d701653-5818-4c28-9a8f-0e38d8f9019c\r\n[W 2021-12-24 13:36:28,135] Trial 0 failed, because the objective function returned nan.\r\nSQLite    : Trial state is TrialState.FAIL\r\n[I 2021-12-24 13:36:28,295] A new study created in RDB with name: no-name-4367a62b-fe90-4cd0-89e8-74c18e272f21\r\n[W 2021-12-24 13:36:28,403] Trial 0 failed, because the objective function returned nan.\r\nMySQL     : Trial state is TrialState.FAIL\r\n[I 2021-12-24 13:36:28,722] A new study created in RDB with name: no-name-8cc33f98-2f7b-41ef-802e-8d46abb6e266\r\n[W 2021-12-24 13:36:28,850] Trial 0 failed, because the objective function returned nan.\r\nPostgreSQL: Trial state is TrialState.FAIL\r\n```\r\n</details>\r\n\r\nOn the other hand, if we run the script `nan-report.py`, we will get the following output. The script is provided in the section of `Reproducible examples`. I think we need to modify this behavior as explained in the section of `Expected behavior`.  \r\n<details>\r\n<summary>output</summary>\r\n\r\n```\r\n(venv) mamu@HideakinoMacBook-puro test % python nan-report.py \r\n[I 2021-12-24 13:39:15,478] A new study created in memory with name: no-name-f34999a1-b56e-45d5-894a-a18db92956f6\r\n[I 2021-12-24 13:39:15,479] Trial 0 finished with value: 1.0 and parameters: {}. Best is trial 0 with value: 1.0.\r\nIn-memory : Trial state is TrialState.COMPLETE\r\n[I 2021-12-24 13:39:15,603] A new study created in RDB with name: no-name-aa0bdcc0-dd7c-4c19-8bf3-df7451bab2eb\r\n[I 2021-12-24 13:39:15,704] Trial 0 finished with value: 1.0 and parameters: {}. Best is trial 0 with value: 1.0.\r\nSQLite    : Trial state is TrialState.COMPLETE\r\n[I 2021-12-24 13:39:15,878] A new study created in RDB with name: no-name-96a37aca-68a4-48d2-83b5-051be816f138\r\n[W 2021-12-24 13:39:16,019] Trial 0 failed because of the following error: StorageInternalError('An exception is raised during the commit. This typically happens due to invalid data in the commit, e.g. exceeding max length. ')\r\nTraceback (most recent call last):\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py\", line 1802, in _execute_context\r\n    self.dialect.do_execute(\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/engine/default.py\", line 732, in do_execute\r\n    cursor.execute(statement, parameters)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/cursors.py\", line 146, in execute\r\n    query = self.mogrify(query, args)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/cursors.py\", line 125, in mogrify\r\n    query = query % self._escape_args(args, conn)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/cursors.py\", line 109, in _escape_args\r\n    return {key: conn.literal(val) for (key, val) in args.items()}\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/cursors.py\", line 109, in <dictcomp>\r\n    return {key: conn.literal(val) for (key, val) in args.items()}\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/connections.py\", line 517, in literal\r\n    return self.escape(obj, self.encoders)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/connections.py\", line 510, in escape\r\n    return converters.escape_item(obj, self.charset, mapping=mapping)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/converters.py\", line 25, in escape_item\r\n    val = encoder(val, mapping)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/converters.py\", line 60, in escape_float\r\n    raise ProgrammingError(\"%s can not be used with MySQL\" % s)\r\npymysql.err.ProgrammingError: nan can not be used with MySQL\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/optuna/storages/_rdb/storage.py\", line 54, in _create_scoped_session\r\n    session.commit()\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py\", line 1431, in commit\r\n    self._transaction.commit(_to_root=self.future)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py\", line 829, in commit\r\n    self._prepare_impl()\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py\", line 808, in _prepare_impl\r\n    self.session.flush()\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py\", line 3363, in flush\r\n    self._flush(objects)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py\", line 3503, in _flush\r\n    transaction.rollback(_capture_exception=True)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py\", line 70, in __exit__\r\n    compat.raise_(\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/util/compat.py\", line 207, in raise_\r\n    raise exception\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py\", line 3463, in _flush\r\n    flush_context.execute()\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py\", line 456, in execute\r\n    rec.execute(self)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/orm/unitofwork.py\", line 630, in execute\r\n    util.preloaded.orm_persistence.save_obj(\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py\", line 244, in save_obj\r\n    _emit_insert_statements(\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/orm/persistence.py\", line 1221, in _emit_insert_statements\r\n    result = connection._execute_20(\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py\", line 1614, in _execute_20\r\n    return meth(self, args_10style, kwargs_10style, execution_options)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/sql/elements.py\", line 325, in _execute_on_connection\r\n    return connection._execute_clauseelement(\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py\", line 1481, in _execute_clauseelement\r\n    ret = self._execute_context(\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py\", line 1845, in _execute_context\r\n    self._handle_dbapi_exception(\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py\", line 2026, in _handle_dbapi_exception\r\n    util.raise_(\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/util/compat.py\", line 207, in raise_\r\n    raise exception\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py\", line 1802, in _execute_context\r\n    self.dialect.do_execute(\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/sqlalchemy/engine/default.py\", line 732, in do_execute\r\n    cursor.execute(statement, parameters)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/cursors.py\", line 146, in execute\r\n    query = self.mogrify(query, args)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/cursors.py\", line 125, in mogrify\r\n    query = query % self._escape_args(args, conn)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/cursors.py\", line 109, in _escape_args\r\n    return {key: conn.literal(val) for (key, val) in args.items()}\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/cursors.py\", line 109, in <dictcomp>\r\n    return {key: conn.literal(val) for (key, val) in args.items()}\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/connections.py\", line 517, in literal\r\n    return self.escape(obj, self.encoders)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/connections.py\", line 510, in escape\r\n    return converters.escape_item(obj, self.charset, mapping=mapping)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/converters.py\", line 25, in escape_item\r\n    val = encoder(val, mapping)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/pymysql/converters.py\", line 60, in escape_float\r\n    raise ProgrammingError(\"%s can not be used with MySQL\" % s)\r\nsqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) nan can not be used with MySQL\r\n[SQL: INSERT INTO trial_intermediate_values (trial_id, step, intermediate_value) VALUES (%(trial_id)s, %(step)s, %(intermediate_value)s)]\r\n[parameters: {'trial_id': 7, 'step': 1, 'intermediate_value': nan}]\r\n(Background on this error at: https://sqlalche.me/e/14/f405)\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/optuna/study/_optimize.py\", line 213, in _run_trial\r\n    value_or_values = func(trial)\r\n  File \"/Users/mamu/Dev/pfn/code_snippets_for_optuna/test/nan-report.py\", line 5, in objective\r\n    trial.report(float(np.nan), 1)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/optuna/trial/_trial.py\", line 506, in report\r\n    self.storage.set_trial_intermediate_value(self._trial_id, step, value)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/optuna/storages/_cached_storage.py\", line 293, in set_trial_intermediate_value\r\n    self._backend.set_trial_intermediate_value(trial_id, step, intermediate_value)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/optuna/storages/_rdb/storage.py\", line 754, in set_trial_intermediate_value\r\n    self._set_trial_intermediate_value_without_commit(\r\n  File \"/Users/mamu/.pyenv/versions/3.9.9/lib/python3.9/contextlib.py\", line 126, in __exit__\r\n    next(self.gen)\r\n  File \"/Users/mamu/Dev/pfn/venv/lib/python3.9/site-packages/optuna/storages/_rdb/storage.py\", line 71, in _create_scoped_session\r\n    raise optuna.exceptions.StorageInternalError(message) from e\r\noptuna.exceptions.StorageInternalError: An exception is raised during the commit. This typically happens due to invalid data in the commit, e.g. exceeding max length. \r\nAn exception is raised during the commit. This typically happens due to invalid data in the commit, e.g. exceeding max length. \r\nMySQL     : Trial state is TrialState.FAIL\r\n[I 2021-12-24 13:39:16,341] A new study created in RDB with name: no-name-1d3ad4c8-ae5b-4da8-aafb-5139770192a3\r\n[I 2021-12-24 13:39:16,519] Trial 0 finished with value: 1.0 and parameters: {}. Best is trial 0 with value: 1.0.\r\nPostgreSQL: Trial state is TrialState.COMPLETE\r\n```\r\n</details>\r\n\r\nIn addition, if we run the script `nan-tell.py`, we will get the following output. The script is provided in the section of `Reproducible examples`. I think we need to modify this behavior as explained in the section of `Expected behavior`. \r\n<details>\r\n<summary>output</summary>\r\n\r\n```\r\n(venv) mamu@HideakinoMacBook-puro 3205-3206 % python nan-tell.py\r\n[I 2021-12-24 14:57:53,054] A new study created in memory with name: no-name-0dab10fe-1de5-4ec6-8a17-145f92fdf286\r\nTrial 0 failed, because the objective function returned nan.\r\nIn-memory : Trial state is TrialState.RUNNING\r\n[I 2021-12-24 14:57:53,138] A new study created in RDB with name: no-name-7757614d-b4bc-43ba-9489-1e691ae1ad3d\r\nTrial 0 failed, because the objective function returned nan.\r\nSQLite    : Trial state is TrialState.RUNNING\r\n[I 2021-12-24 14:57:53,308] A new study created in RDB with name: no-name-a7651b7d-0b60-47e6-96c9-2c5563819437\r\nTrial 0 failed, because the objective function returned nan.\r\nMySQL     : Trial state is TrialState.RUNNING\r\n[I 2021-12-24 14:57:53,659] A new study created in RDB with name: no-name-831368be-d69a-4aeb-a00b-76818043fac1\r\nTrial 0 failed, because the objective function returned nan.\r\nPostgreSQL: Trial state is TrialState.RUNNING\r\n```\r\n</details>\r\n\r\n## Steps to reproduce\r\n\r\n1. Install docker\r\n2. Setup MySQL DB\r\n```\r\ndocker run --name mysql -e MYSQL_ROOT_PASSWORD=test -p 3306:3306 -p 33060:33060 -d mysql:8.0.22\r\ndocker run --network host -it --rm mysql:8.0.22  mysql -h 127.0.0.1 -uroot -ptest -e \"create database mysql;\"\r\n```\r\n3. Setup PostgreSQL DB\r\n```\r\ndocker run -it --rm --name postgres-test -e POSTGRES_PASSWORD=test -p 15432:5432 -d postgres\r\n```\r\n4. Run `nan-objectibe.py`, `nan-report.py` and `nan-tell.py`.\r\n\r\n## Reproducible examples (optional)\r\n- `nan-objective.py`\r\n```python\r\nimport optuna\r\nimport numpy as np\r\n\r\ndef objective(trial):\r\n    return float(np.nan)\r\n\r\n# In-memory storage\r\nstudy = optuna.create_study()\r\nstudy.optimize(objective, n_trials=1)\r\nprint(f\"In-memory : Trial state is {study.trials[-1].state}\")\r\n\r\n# RDB storage (SQLite)\r\nstudy = optuna.create_study(storage='sqlite:///../sqlite.db')\r\nstudy.optimize(objective, n_trials=1)\r\nprint(f\"SQLite    : Trial state is {study.trials[-1].state}\")\r\n\r\n# RDB storage (MySQL)\r\nstudy = optuna.create_study(storage=\"mysql+pymysql://root:test@localhost/mysql\")\r\nstudy.optimize(objective, n_trials=1)\r\nprint(f\"MySQL     : Trial state is {study.trials[-1].state}\")\r\n\r\n# RDB storage (PostgreSQL)\r\nstudy = optuna.create_study(storage=\"postgresql+psycopg2://postgres:test@localhost:15432/postgres\")\r\nstudy.optimize(objective, n_trials=1)\r\nprint(f\"PostgreSQL: Trial state is {study.trials[-1].state}\")\r\n```\r\n\r\n- `nan-report.py`\r\n```python\r\nimport optuna\r\nimport numpy as np\r\n\r\ndef objective(trial):\r\n    trial.report(float(np.nan), 1)\r\n    return 1\r\n\r\n# In-memory storage\r\nstudy = optuna.create_study()\r\nstudy.optimize(objective, n_trials=1)\r\nprint(f\"In-memory : Trial state is {study.trials[-1].state}\")\r\n\r\n# RDB storage (SQLite)\r\nstudy = optuna.create_study(storage='sqlite:///../sqlite.db')\r\nstudy.optimize(objective, n_trials=1)\r\nprint(f\"SQLite    : Trial state is {study.trials[-1].state}\")\r\n\r\n# RDB storage (MySQL)\r\nstudy = optuna.create_study(storage=\"mysql+pymysql://root:test@localhost/mysql\")\r\ntry:\r\n    study.optimize(objective, n_trials=1)\r\nexcept Exception as e:\r\n    print(e)\r\nfinally:\r\n    print(f\"MySQL     : Trial state is {study.trials[-1].state}\")\r\n\r\n# RDB storage (PostgreSQL)\r\nstudy = optuna.create_study(storage=\"postgresql+psycopg2://postgres:test@localhost:15432/postgres\")\r\nstudy.optimize(objective, n_trials=1)\r\nprint(f\"PostgreSQL: Trial state is {study.trials[-1].state}\")\r\n``` \r\n\r\n- `nan-tell.py`\r\n```python\r\nimport optuna\r\nimport numpy as np\r\n\r\n\r\n# In-memory storage\r\nstudy = optuna.create_study()\r\ntrial = study.ask()\r\ntry:\r\n    study.tell(trial, float(np.nan))\r\nexcept Exception as e:\r\n    print(e)\r\nfinally:\r\n    print(f\"In-memory : Trial state is {study.trials[-1].state}\")\r\n\r\n# RDB storage (SQLite)\r\nstudy = optuna.create_study(storage='sqlite:///../sqlite.db')\r\ntrial = study.ask()\r\ntry:\r\n    study.tell(trial, float(np.nan))\r\nexcept Exception as e:\r\n    print(e)\r\nfinally:\r\n    print(f\"SQLite    : Trial state is {study.trials[-1].state}\")\r\n\r\n# RDB storage (MySQL)\r\nstudy = optuna.create_study(storage=\"mysql+pymysql://root:test@localhost/mysql\")\r\ntrial = study.ask()\r\ntry:\r\n    study.tell(trial, float(np.nan))\r\nexcept Exception as e:\r\n    print(e)\r\nfinally:\r\n    print(f\"MySQL     : Trial state is {study.trials[-1].state}\")\r\n\r\n# RDB storage (PostgreSQL)\r\nstudy = optuna.create_study(storage=\"postgresql+psycopg2://postgres:test@localhost:15432/postgres\")\r\ntrial = study.ask()\r\ntry:\r\n    study.tell(trial, float(np.nan))\r\nexcept Exception as e:\r\n    print(e)\r\nfinally:\r\n    print(f\"PostgreSQL: Trial state is {study.trials[-1].state}\")\r\n\r\n```\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3205/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3205/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3197", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3197/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3197/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3197/events", "html_url": "https://github.com/optuna/optuna/issues/3197", "id": 1084446575, "node_id": "I_kwDOB0okGM5Ao1dv", "number": 3197, "title": "Fix the axes of `optuna.visualization.matplotlib.plot_contour`", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}, {"id": 2107128673, "node_id": "MDU6TGFiZWwyMTA3MTI4Njcz", "url": "https://api.github.com/repos/optuna/optuna/labels/no-stale", "name": "no-stale", "color": "BBBBBB", "default": false, "description": "Exempt from stale bot"}, {"id": 3264287142, "node_id": "MDU6TGFiZWwzMjY0Mjg3MTQy", "url": "https://api.github.com/repos/optuna/optuna/labels/v3", "name": "v3", "color": "339FD7", "default": false, "description": "Issue/PR for Optuna version 3."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-12-20T07:21:01Z", "updated_at": "2022-02-05T08:10:46Z", "closed_at": "2022-02-05T08:10:46Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "I found that the axes of `optuna.visualization.matplotlib.plot_contour` has bug.\r\n\r\n```python\r\nimport optuna\r\nfrom optuna.testing.visualization import prepare_study_with_trials\r\nimport matplotlib.pyplot as plt\r\n\r\nstudy = prepare_study_with_trials(more_than_three=True, n_objectives=2, with_c_d=True)\r\nprint(study.trials_dataframe())\r\nfigure = optuna.visualization.plot_contour(study, target=lambda t: t.values[0])\r\n\r\nfigure.write_image('plotly.png')\r\noptuna.visualization.matplotlib.plot_contour(study, target=lambda t: t.values[0])\r\nplt.savefig('matplotlib.png')\r\n```\r\n\r\n![plotly](https://user-images.githubusercontent.com/1255726/146722151-9516e355-f9a7-4ccc-95fd-3158e5ea500b.png)\r\n\r\n![matplotlib](https://user-images.githubusercontent.com/1255726/146722133-f7a48ce3-1985-4537-b672-bd4150e5307c.png)\r\n\r\nTo plot a-b subplot, the max and the min of params are determined with trials whose params have `a` and `b`. But the maximum and minimum values should be determined independently for `a` and `b`.\r\n\r\n_Originally posted by @not522 in https://github.com/optuna/optuna/issues/2959#issuecomment-997638266_", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3197/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3197/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3190", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3190/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3190/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3190/events", "html_url": "https://github.com/optuna/optuna/pull/3190", "id": 1084040619, "node_id": "PR_kwDOB0okGM4wCta7", "number": 3190, "title": "Fix #3129: TPE not working with a categorical variable with different choice types", "user": {"login": "keisukefukuda", "id": 18257, "node_id": "MDQ6VXNlcjE4MjU3", "avatar_url": "https://avatars.githubusercontent.com/u/18257?v=4", "gravatar_id": "", "url": "https://api.github.com/users/keisukefukuda", "html_url": "https://github.com/keisukefukuda", "followers_url": "https://api.github.com/users/keisukefukuda/followers", "following_url": "https://api.github.com/users/keisukefukuda/following{/other_user}", "gists_url": "https://api.github.com/users/keisukefukuda/gists{/gist_id}", "starred_url": "https://api.github.com/users/keisukefukuda/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/keisukefukuda/subscriptions", "organizations_url": "https://api.github.com/users/keisukefukuda/orgs", "repos_url": "https://api.github.com/users/keisukefukuda/repos", "events_url": "https://api.github.com/users/keisukefukuda/events{/privacy}", "received_events_url": "https://api.github.com/users/keisukefukuda/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}, {"id": 3654963671, "node_id": "LA_kwDOB0okGM7Z2lHX", "url": "https://api.github.com/repos/optuna/optuna/labels/sprint-20211219", "name": "sprint-20211219", "color": "93a8d8", "default": false, "description": "PR from the online sprint event Dec 19, 2021."}], "state": "closed", "locked": false, "assignee": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/41", "html_url": "https://github.com/optuna/optuna/milestone/41", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/41/labels", "id": 7640188, "node_id": "MI_kwDOB0okGM4AdJR8", "number": 41, "title": "v3.0.0-b0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 85, "state": "closed", "created_at": "2022-02-04T05:12:58Z", "updated_at": "2022-04-12T04:16:51Z", "due_on": null, "closed_at": "2022-04-12T04:16:51Z"}, "comments": 6, "created_at": "2021-12-19T08:16:57Z", "updated_at": "2022-03-08T09:39:42Z", "closed_at": "2022-02-22T06:06:58Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3190", "html_url": "https://github.com/optuna/optuna/pull/3190", "diff_url": "https://github.com/optuna/optuna/pull/3190.diff", "patch_url": "https://github.com/optuna/optuna/pull/3190.patch", "merged_at": "2022-02-22T06:06:58Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nBugfix of #3129 \r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\nThis bug is caused by[ `_get_observation_pairs()`](https://github.com/optuna/optuna/blob/f0b2071333ecd20fc3a18f4695b67225c26eb933/optuna/samplers/_tpe/sampler.py#L633) function in `_tpe/sample.py`. The function uses `None` as the \"fallback default\" value for searching params in `trial.params`.\r\n\r\n```\r\nraw_param_value = trial.params.get(param_name, None)\r\nparam_value: Optional[float]\r\nif raw_param_value is not None:\r\n```\r\n\r\nHowever,  when `raw_param_value` is `None`, this does not work. The code is fixed to use `if param_name in trial.params` and avoid using a particular value as the default value.\r\n\r\nAfter the bugfix, the reproduce script `optuna_test.py` that is created by the original reporter of the issue works fine.\r\n\r\n```\r\n$ optuna create-study --study-name '1234' --storage 'sqlite:///test.db' --direction 'maximize' && python3 optuna_test.py\r\n[I 2021-12-19 17:15:16,275] A new study created in RDB with name: 1234\r\n1234\r\n/Users/keisukefukuda/work/optuna/optuna/samplers/_tpe/sampler.py:266: ExperimentalWarning: ``multivariate`` option is an experimental feature. The interface can change in the future.\r\n  ExperimentalWarning,\r\n/Users/keisukefukuda/work/optuna/optuna/samplers/_tpe/sampler.py:285: ExperimentalWarning: ``constant_liar`` option is an experimental feature. The interface can change in the future.\r\n  ExperimentalWarning,\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:23,402] Trial 0 finished with value: 20.23027610219457 and parameters: {'x1': -4.497807921887569, 'x2': None}. Best is trial 0 with value: 20.23027610219457.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:23,661] Trial 1 finished with value: 0.0 and parameters: {'x1': -6.830249984050218, 'x2': 100}. Best is trial 0 with value: 20.23027610219457.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:23,884] Trial 2 finished with value: 94.9583753816821 and parameters: {'x1': -9.74465881299505, 'x2': None}. Best is trial 2 with value: 94.9583753816821.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:24,196] Trial 3 finished with value: 19.311182262077164 and parameters: {'x1': 4.394449028271595, 'x2': None}. Best is trial 2 with value: 94.9583753816821.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:24,463] Trial 4 finished with value: 0.0 and parameters: {'x1': -4.861678154418259, 'x2': 100}. Best is trial 2 with value: 94.9583753816821.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:24,589] Trial 5 finished with value: 0.0 and parameters: {'x1': 8.091630635228949, 'x2': 100}. Best is trial 2 with value: 94.9583753816821.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:24,697] Trial 6 finished with value: 22.43454883422271 and parameters: {'x1': 4.736512306985247, 'x2': None}. Best is trial 2 with value: 94.9583753816821.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:24,830] Trial 7 finished with value: 8.56039415731601 and parameters: {'x1': -2.9258151269887183, 'x2': None}. Best is trial 2 with value: 94.9583753816821.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:24,975] Trial 8 finished with value: 47.24752561887984 and parameters: {'x1': -6.873683555334784, 'x2': None}. Best is trial 2 with value: 94.9583753816821.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:25,119] Trial 9 finished with value: 0.0 and parameters: {'x1': -0.7344751334333814, 'x2': 100}. Best is trial 2 with value: 94.9583753816821.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:25,238] Trial 10 finished with value: 74.63123120750546 and parameters: {'x1': -8.638936925774228, 'x2': None}. Best is trial 2 with value: 94.9583753816821.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:25,344] Trial 11 finished with value: 87.77309746399034 and parameters: {'x1': -9.368729767902922, 'x2': None}. Best is trial 2 with value: 94.9583753816821.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:25,468] Trial 12 finished with value: 88.38159368713423 and parameters: {'x1': -9.401148530213435, 'x2': None}. Best is trial 2 with value: 94.9583753816821.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:25,611] Trial 13 finished with value: 0.0 and parameters: {'x1': -9.73597876503898, 'x2': 100}. Best is trial 2 with value: 94.9583753816821.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:25,811] Trial 14 finished with value: 97.57899506041372 and parameters: {'x1': -9.87820808954811, 'x2': None}. Best is trial 14 with value: 97.57899506041372.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:25,995] Trial 15 finished with value: 97.42559374186968 and parameters: {'x1': -9.87044040262995, 'x2': None}. Best is trial 14 with value: 97.57899506041372.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:26,388] Trial 16 finished with value: 0.6909139571730675 and parameters: {'x1': -0.8312123418074755, 'x2': None}. Best is trial 14 with value: 97.57899506041372.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:26,629] Trial 17 finished with value: 25.43548256342697 and parameters: {'x1': -5.043360245255832, 'x2': None}. Best is trial 14 with value: 97.57899506041372.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:27,231] Trial 18 finished with value: 99.11895326426185 and parameters: {'x1': 9.955850202984266, 'x2': None}. Best is trial 18 with value: 99.11895326426185.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:27,829] Trial 19 finished with value: 67.39676602219951 and parameters: {'x1': 8.209553338775473, 'x2': None}. Best is trial 18 with value: 99.11895326426185.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:28,508] Trial 20 finished with value: 71.96823410644555 and parameters: {'x1': 8.483409344505636, 'x2': None}. Best is trial 18 with value: 99.11895326426185.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:29,211] Trial 21 finished with value: 79.19397590016085 and parameters: {'x1': 8.89909972413844, 'x2': None}. Best is trial 18 with value: 99.11895326426185.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:29,708] Trial 22 finished with value: 95.56493864534751 and parameters: {'x1': 9.775732128354761, 'x2': None}. Best is trial 18 with value: 99.11895326426185.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:30,013] Trial 23 finished with value: 97.55860858513729 and parameters: {'x1': -9.87717614428017, 'x2': None}. Best is trial 18 with value: 99.11895326426185.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:30,511] Trial 24 finished with value: 99.18178000327762 and parameters: {'x1': -9.959004970541868, 'x2': None}. Best is trial 24 with value: 99.18178000327762.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:30,886] Trial 25 finished with value: 0.0 and parameters: {'x1': 4.4393163713188235, 'x2': 100}. Best is trial 24 with value: 99.18178000327762.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:31,507] Trial 26 finished with value: 35.03470468458785 and parameters: {'x1': -5.919012137560443, 'x2': None}. Best is trial 24 with value: 99.18178000327762.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:31,858] Trial 27 finished with value: 93.91825948206618 and parameters: {'x1': -9.691143352673418, 'x2': None}. Best is trial 24 with value: 99.18178000327762.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:32,090] Trial 28 finished with value: 77.18243604348694 and parameters: {'x1': 8.785353495647568, 'x2': None}. Best is trial 24 with value: 99.18178000327762.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:32,546] Trial 29 finished with value: 23.904534918966615 and parameters: {'x1': -4.889226413142126, 'x2': None}. Best is trial 24 with value: 99.18178000327762.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:32,875] Trial 30 finished with value: 29.689655282608044 and parameters: {'x1': -5.4488214581327625, 'x2': None}. Best is trial 24 with value: 99.18178000327762.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:33,133] Trial 31 finished with value: 92.9196089499113 and parameters: {'x1': -9.6394817780787, 'x2': None}. Best is trial 24 with value: 99.18178000327762.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:33,445] Trial 32 finished with value: 97.97594132645159 and parameters: {'x1': -9.89827971550873, 'x2': None}. Best is trial 24 with value: 99.18178000327762.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:33,705] Trial 33 finished with value: 0.0 and parameters: {'x1': -9.109364019645351, 'x2': 100}. Best is trial 24 with value: 99.18178000327762.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:33,893] Trial 34 finished with value: 97.98863117180308 and parameters: {'x1': -9.898920707420737, 'x2': None}. Best is trial 24 with value: 99.18178000327762.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:34,155] Trial 35 finished with value: 96.3450346153301 and parameters: {'x1': -9.81555065268017, 'x2': None}. Best is trial 24 with value: 99.18178000327762.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:34,295] Trial 36 finished with value: 85.65082597994967 and parameters: {'x1': -9.25477314578535, 'x2': None}. Best is trial 24 with value: 99.18178000327762.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:34,507] Trial 37 finished with value: 0.0 and parameters: {'x1': -5.465556788267465, 'x2': 100}. Best is trial 24 with value: 99.18178000327762.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:34,659] Trial 38 finished with value: 96.82759942985447 and parameters: {'x1': -9.840101596520967, 'x2': None}. Best is trial 24 with value: 99.18178000327762.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:34,862] Trial 39 finished with value: 0.0 and parameters: {'x1': 7.086505180697853, 'x2': 100}. Best is trial 24 with value: 99.18178000327762.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:35,056] Trial 40 finished with value: 0.0 and parameters: {'x1': 9.701757828680893, 'x2': 100}. Best is trial 24 with value: 99.18178000327762.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:35,273] Trial 41 finished with value: 94.71545700466312 and parameters: {'x1': -9.732186650730817, 'x2': None}. Best is trial 24 with value: 99.18178000327762.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:35,514] Trial 42 finished with value: 91.7458394388747 and parameters: {'x1': -9.578404848348951, 'x2': None}. Best is trial 24 with value: 99.18178000327762.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:35,677] Trial 43 finished with value: 91.46618858314017 and parameters: {'x1': -9.563795720483586, 'x2': None}. Best is trial 24 with value: 99.18178000327762.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:35,846] Trial 44 finished with value: 46.29485628296195 and parameters: {'x1': -6.80403235463809, 'x2': None}. Best is trial 24 with value: 99.18178000327762.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:35,995] Trial 45 finished with value: 95.10143557734003 and parameters: {'x1': -9.75199649186463, 'x2': None}. Best is trial 24 with value: 99.18178000327762.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:36,446] Trial 46 finished with value: 18.77415673981897 and parameters: {'x1': 4.332915501116883, 'x2': None}. Best is trial 24 with value: 99.18178000327762.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:36,985] Trial 47 finished with value: 99.8660064099571 and parameters: {'x1': -9.993298074707724, 'x2': None}. Best is trial 47 with value: 99.8660064099571.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:37,278] Trial 48 finished with value: 41.09839537034104 and parameters: {'x1': -6.410803020709733, 'x2': None}. Best is trial 47 with value: 99.8660064099571.\r\ntest.py:5: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use :func:`~optuna.trial.Trial.suggest_float` instead.\r\n  x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n[I 2021-12-19 17:15:37,701] Trial 49 finished with value: 0.0 and parameters: {'x1': -9.772832759492589, 'x2': 100}. Best is trial 47 with value: 99.8660064099571.\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3190/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3190/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3189", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3189/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3189/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3189/events", "html_url": "https://github.com/optuna/optuna/issues/3189", "id": 1084038159, "node_id": "I_kwDOB0okGM5AnRwP", "number": 3189, "title": "test_contour Plotly and Matplotlib generate different figures", "user": {"login": "belldandyxtq", "id": 5637270, "node_id": "MDQ6VXNlcjU2MzcyNzA=", "avatar_url": "https://avatars.githubusercontent.com/u/5637270?v=4", "gravatar_id": "", "url": "https://api.github.com/users/belldandyxtq", "html_url": "https://github.com/belldandyxtq", "followers_url": "https://api.github.com/users/belldandyxtq/followers", "following_url": "https://api.github.com/users/belldandyxtq/following{/other_user}", "gists_url": "https://api.github.com/users/belldandyxtq/gists{/gist_id}", "starred_url": "https://api.github.com/users/belldandyxtq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/belldandyxtq/subscriptions", "organizations_url": "https://api.github.com/users/belldandyxtq/orgs", "repos_url": "https://api.github.com/users/belldandyxtq/repos", "events_url": "https://api.github.com/users/belldandyxtq/events{/privacy}", "received_events_url": "https://api.github.com/users/belldandyxtq/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 3264287142, "node_id": "MDU6TGFiZWwzMjY0Mjg3MTQy", "url": "https://api.github.com/repos/optuna/optuna/labels/v3", "name": "v3", "color": "339FD7", "default": false, "description": "Issue/PR for Optuna version 3."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-12-19T08:04:14Z", "updated_at": "2021-12-22T05:10:19Z", "closed_at": "2021-12-22T05:10:00Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\ncontour is tested with both [plotly](https://github.com/optuna/optuna/blob/master/tests/visualization_tests/test_contour.py) and [matplotlib](https://github.com/optuna/optuna/blob/master/tests/visualization_tests/matplotlib_tests/test_contour.py). However, the two tests generate two totally different figures, with different number of dots.\r\n![matplotlib1](https://user-images.githubusercontent.com/5637270/146667864-48215549-4c66-4c3d-8fad-2cc7cb366fa3.png)\r\n![plotly](https://user-images.githubusercontent.com/5637270/146667865-4e7aa236-c8b8-4988-a848-08918bd51b13.png)\r\n\r\n## Expected behavior\r\nTwo similar figures\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\n\r\n## Environment\r\n$ python -c 'import optuna; print(optuna.__version__)'\r\n\r\n3.0.0a1.dev\r\n$ python -c 'import platform; print(platform.python_version())'\r\n3.6.9\r\n$ python -c 'import platform; print(platform.platform())'\r\nLinux-5.4.0-56-generic-x86_64-with-Ubuntu-18.04-bionic\r\n\r\n## How to reproduce\r\n1. Use the following path to save the figure\r\n```\r\ndiff --git a/tests/visualization_tests/matplotlib_tests/test_contour.py b/tests/visualization_tests/matplotlib_tests/test_contour.py\r\nindex dd641fd4..6f49c07a 100644\r\n--- a/tests/visualization_tests/matplotlib_tests/test_contour.py\r\n+++ b/tests/visualization_tests/matplotlib_tests/test_contour.py\r\n@@ -10,6 +10,7 @@ from optuna.trial import Trial\r\n from optuna.visualization.matplotlib import plot_contour\r\n from optuna.visualization.matplotlib._contour import _create_zmap\r\n from optuna.visualization.matplotlib._contour import _interpolate_zmap\r\n+import matplotlib.pyplot as plt\r\n\r\n\r\n def test_create_zmap() -> None:\r\n@@ -105,6 +106,7 @@ def test_plot_contour(params: Optional[List[str]]) -> None:\r\n             assert len(figure.get_lines()) == 0\r\n         elif len(params) == 2:\r\n             assert len(figure.get_lines()) == 0\r\n+            plt.savefig(\"matplotlib.png\")\r\n     elif params is None:\r\n         assert figure.shape == (len(study.best_params), len(study.best_params))\r\n         for i in range(len(study.best_params)):\r\ndiff --git a/tests/visualization_tests/test_contour.py b/tests/visualization_tests/test_contour.py\r\nindex a7b5c6e5..0aca776b 100644\r\n--- a/tests/visualization_tests/test_contour.py\r\n+++ b/tests/visualization_tests/test_contour.py\r\n@@ -90,6 +90,7 @@ def test_plot_contour(params: Optional[List[str]]) -> None:\r\n             assert figure.data[1][\"y\"] == (2.0, 1.0)\r\n             assert figure.layout[\"xaxis\"][\"range\"] == (0.925, 2.575)\r\n             assert figure.layout[\"yaxis\"][\"range\"] == (-0.1, 2.1)\r\n+            figure.write_image(\"plotly.png\")\r\n     else:\r\n         # TODO(crcrpar): Add more checks. Currently this only checks the number of data.\r\n         n_params = len(params) if params is not None else 4\r\n```\r\n2. run pytest `visualization_tests$ pytest test_contour.py matplotlib_tests/test_contour.py`", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3189/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3189/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3187", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3187/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3187/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3187/events", "html_url": "https://github.com/optuna/optuna/pull/3187", "id": 1084029228, "node_id": "PR_kwDOB0okGM4wCrOi", "number": 3187, "title": "Fix bug of nondeterministic behavior of TPESampler when `group=True`", "user": {"login": "xuzijian629", "id": 22091519, "node_id": "MDQ6VXNlcjIyMDkxNTE5", "avatar_url": "https://avatars.githubusercontent.com/u/22091519?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xuzijian629", "html_url": "https://github.com/xuzijian629", "followers_url": "https://api.github.com/users/xuzijian629/followers", "following_url": "https://api.github.com/users/xuzijian629/following{/other_user}", "gists_url": "https://api.github.com/users/xuzijian629/gists{/gist_id}", "starred_url": "https://api.github.com/users/xuzijian629/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xuzijian629/subscriptions", "organizations_url": "https://api.github.com/users/xuzijian629/orgs", "repos_url": "https://api.github.com/users/xuzijian629/repos", "events_url": "https://api.github.com/users/xuzijian629/events{/privacy}", "received_events_url": "https://api.github.com/users/xuzijian629/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}, {"id": 3654963671, "node_id": "LA_kwDOB0okGM7Z2lHX", "url": "https://api.github.com/repos/optuna/optuna/labels/sprint-20211219", "name": "sprint-20211219", "color": "93a8d8", "default": false, "description": "PR from the online sprint event Dec 19, 2021."}], "state": "closed", "locked": false, "assignee": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/40", "html_url": "https://github.com/optuna/optuna/milestone/40", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/40/labels", "id": 7453644, "node_id": "MI_kwDOB0okGM4AcbvM", "number": 40, "title": "v3.0.0-a1", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 73, "state": "closed", "created_at": "2021-12-03T05:21:42Z", "updated_at": "2022-04-08T05:21:45Z", "due_on": null, "closed_at": "2022-02-07T06:55:34Z"}, "comments": 8, "created_at": "2021-12-19T07:02:55Z", "updated_at": "2022-01-12T05:35:35Z", "closed_at": "2022-01-11T10:06:45Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3187", "html_url": "https://github.com/optuna/optuna/pull/3187", "diff_url": "https://github.com/optuna/optuna/pull/3187.diff", "patch_url": "https://github.com/optuna/optuna/pull/3187.patch", "merged_at": "2022-01-11T10:06:45Z"}, "body": "## Motivation\r\nFix #3137\r\n\r\nDue to Python's nondeterministic string hashing, the iteration of `Dict[str, BaseDistribution]` is in nondeterministic order.\r\n\r\n## Description of the changes\r\nSorted the keys to make the iteration deterministic.\r\n\r\n\r\n\r\nI don't think that this PR is perfect to resolve the original issue because:\r\n* It is very hard for users and developers to always keep in mind that iterating distributions is nondeterministic while development.\r\n* Moreover, such situation may usually happen because `Dict[str, BaseDistribution]` appears in various positions in the codebase.\r\n\r\nOne of possible solutions may be creating `SearchSpace` class instead of the raw `Dict[str, BaseDistribution]` and manually handle hashing, but this may require a large-scale modification.\r\n\r\nIf you have any ideas for modification, please let me know.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3187/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3187/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3137", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3137/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3137/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3137/events", "html_url": "https://github.com/optuna/optuna/issues/3137", "id": 1067481859, "node_id": "I_kwDOB0okGM4_oHsD", "number": 3137, "title": "Non-determinism in TPE sampler when `group=True`", "user": {"login": "vineethk", "id": 828050, "node_id": "MDQ6VXNlcjgyODA1MA==", "avatar_url": "https://avatars.githubusercontent.com/u/828050?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vineethk", "html_url": "https://github.com/vineethk", "followers_url": "https://api.github.com/users/vineethk/followers", "following_url": "https://api.github.com/users/vineethk/following{/other_user}", "gists_url": "https://api.github.com/users/vineethk/gists{/gist_id}", "starred_url": "https://api.github.com/users/vineethk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vineethk/subscriptions", "organizations_url": "https://api.github.com/users/vineethk/orgs", "repos_url": "https://api.github.com/users/vineethk/repos", "events_url": "https://api.github.com/users/vineethk/events{/privacy}", "received_events_url": "https://api.github.com/users/vineethk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 2107128673, "node_id": "MDU6TGFiZWwyMTA3MTI4Njcz", "url": "https://api.github.com/repos/optuna/optuna/labels/no-stale", "name": "no-stale", "color": "BBBBBB", "default": false, "description": "Exempt from stale bot"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-11-30T17:13:56Z", "updated_at": "2022-01-11T10:06:45Z", "closed_at": "2022-01-11T10:06:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "TPE sampler is non-deterministic in different runs (with the same seed, no parallelization) when group decomposed search space is enabled.\r\n\r\n## Expected behavior\r\n\r\nConsider the script below:\r\n```python\r\n\r\nimport optuna\r\n\r\nsampler = optuna.samplers.TPESampler(n_startup_trials=1, seed=2, multivariate=True, group=True)\r\nstudy = optuna.create_study(sampler=sampler)\r\n\r\nfor _ in range(10):\r\n    trial = study.ask()\r\n    picked = [i for i in range(10) if trial.suggest_int(str(i), 0, 1) == 1]\r\n    print(picked)\r\n    study.tell(trial, len(picked))\r\n\r\n```\r\n\r\nDifferent runs of this script are expected to yield the same output (because the seed is fixed, the objective function is deterministic, and we are running in sequential mode), but they do not. For example, two consecutive runs of this script yielded the following outputs (your output might differ) :\r\n\r\nFirst run:\r\n```\r\n[2, 7]\r\n[2, 7]\r\n[2, 7]\r\n[5, 6, 7, 8, 9]\r\n[1, 5]\r\n[0, 2, 3, 4, 7]\r\n[2, 3, 8]\r\n[1, 2, 3, 6, 7]\r\n[0, 1, 2, 4]\r\n[3, 5, 7]\r\n```\r\n\r\nSecond run:\r\n```\r\n[2, 7]\r\n[2, 7, 9]\r\n[2, 7]\r\n[1, 6]\r\n[2, 3, 6, 7, 8]\r\n[0, 2, 3, 5, 7]\r\n[1, 7, 8]\r\n[0, 1, 2, 6, 7]\r\n[3]\r\n[3, 5]\r\n```\r\n\r\nNote that if we set `group=False` when initializing the TPE sampler, we get deterministic outputs.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.91\r\n- Python version: 3.7.4\r\n- OS: Linux\r\n\r\n## Error messages, stack traces, or logs\r\n\r\nNot applicable.\r\n\r\n## Steps to reproduce\r\n\r\nRun the script above multiple times. Observe that the output changes everytime.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3137/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3137/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3136", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3136/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3136/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3136/events", "html_url": "https://github.com/optuna/optuna/issues/3136", "id": 1067341278, "node_id": "I_kwDOB0okGM4_nlXe", "number": 3136, "title": "Update doctest to follow the latest MLflow", "user": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-11-30T15:03:14Z", "updated_at": "2022-01-06T00:53:00Z", "closed_at": "2022-01-06T00:53:00Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\nMLflow released the new version (v1.22.0) \ud83c\udf89 and it changed logging format.\r\nThe doctest in Optuna depends on the log format of MLflow so it fails with the latest MLflow.\r\n(\ud83d\udd17 See also the tentative fix in https://github.com/optuna/optuna/pull/3135)\r\n\r\n## Expected behavior\r\n\r\nAll doctests pass.\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\n## Environment\r\n\r\n<!--\r\nYou can get this information by typing the following:\r\n```\r\npython -c 'import optuna; print(optuna.__version__)'\r\npython -c 'import platform; print(platform.python_version())'\r\npython -c 'import platform; print(platform.platform())'\r\n```\r\n-->\r\n\r\n- Optuna version: 2.10.0\r\n- Python version: 3.9.6\r\n- OS: Ubuntu 20.04 (WSL2)\r\n- (Optional) Other libraries and their versions: MLflow 1.22.0\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nExpected:\r\n    INFO: 'my_other_study' does not exist. Creating a new experiment\r\nGot nothing\r\n```\r\n\r\nhttps://github.com/optuna/optuna/runs/4368455449?check_suite_focus=true#step:6:6119\r\n\r\n## Steps to reproduce\r\n\r\n1. Install Optuna\r\n2. Install the latest version of MLflow (`pip install -U mlflow`)\r\n3. Run doctest\r\n\r\n## Reproducible examples (optional)\r\n\r\nNone (see doctest)\r\n\r\nhttps://github.com/optuna/optuna/blob/51b548324fb00e9b1cb4a60ac68bd0a438566bc4/optuna/integration/mlflow.py#L69\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3136/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3136/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3132", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3132/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3132/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3132/events", "html_url": "https://github.com/optuna/optuna/issues/3132", "id": 1065663973, "node_id": "I_kwDOB0okGM4_hL3l", "number": 3132, "title": "`nan` handling of `optuna tell`.", "user": {"login": "ytsmiling", "id": 20983513, "node_id": "MDQ6VXNlcjIwOTgzNTEz", "avatar_url": "https://avatars.githubusercontent.com/u/20983513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ytsmiling", "html_url": "https://github.com/ytsmiling", "followers_url": "https://api.github.com/users/ytsmiling/followers", "following_url": "https://api.github.com/users/ytsmiling/following{/other_user}", "gists_url": "https://api.github.com/users/ytsmiling/gists{/gist_id}", "starred_url": "https://api.github.com/users/ytsmiling/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ytsmiling/subscriptions", "organizations_url": "https://api.github.com/users/ytsmiling/orgs", "repos_url": "https://api.github.com/users/ytsmiling/repos", "events_url": "https://api.github.com/users/ytsmiling/events{/privacy}", "received_events_url": "https://api.github.com/users/ytsmiling/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 2107128673, "node_id": "MDU6TGFiZWwyMTA3MTI4Njcz", "url": "https://api.github.com/repos/optuna/optuna/labels/no-stale", "name": "no-stale", "color": "BBBBBB", "default": false, "description": "Exempt from stale bot"}, {"id": 3264287142, "node_id": "MDU6TGFiZWwzMjY0Mjg3MTQy", "url": "https://api.github.com/repos/optuna/optuna/labels/v3", "name": "v3", "color": "339FD7", "default": false, "description": "Issue/PR for Optuna version 3."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-11-29T06:36:46Z", "updated_at": "2022-04-21T09:03:19Z", "closed_at": "2022-04-21T09:03:19Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "When we perform `optuna tell` with `nan`, you'll get the following error message.\r\n\r\n```text\r\n$ optuna create-study --storage sqlite:///debug.db --study-name foo\r\n[I 2021-11-29 15:22:23,775] A new study created in RDB with name: foo\r\nfoo\r\n$ optuna ask --storage sqlite:///debug.db --study-name foo\r\n.../python3.8/site-packages/optuna/cli.py:796: ExperimentalWarning: 'ask' is an experimental CLI command. The interface can change in the future.\r\nwarnings.warn(\r\n[I 2021-11-29 15:22:31,214] Using an existing study with name 'foo' instead of creating a new one.\r\n[I 2021-11-29 15:22:31,267] Asked trial 0 with parameters {}.\r\n{\"number\": 0, \"params\": {}}\r\n$ optuna tell --storage sqlite:///debug.db --study-name foo --trial-number 0 --values nan\r\n.../python3.8/site-packages/optuna/cli.py:863: ExperimentalWarning: 'tell' is an experimental CLI command. The interface can change in the future.\r\nwarnings.warn(\r\n[E 2021-11-29 15:22:43,074] Trial 0 failed, because the objective function returned nan.\r\n```\r\nHowever, the state of `trial 0` remains `RUNNING`.\r\n```python\r\nIn [1]: import optuna\r\nIn [2]: optuna.load_study(storage=\"sqlite:///debug.db\", study_name=\"foo\").get_trials()[0]\r\nOut[2]: FrozenTrial(number=0, values=None, datetime_start=datetime.datetime(2021, 11, 29, 15, 22, 31, 248437), datetime_complete=None, params={}, distributions={}, user_attrs={}, system_attrs={}, intermediate_values={}, trial_id=1, state=TrialState.RUNNING, value=None)\r\n```\r\n\r\n## Expected behavior\r\n\r\nI think there are several \"correct\" behavior. I personally prefer `pattern A` but this might not be optimal from a more general perspective.\r\n\r\n### pattern A\r\n\r\n`optuna tell` (more precisely, `study.tell`) set the study's state to `FAILED` and raise no errors just like `study.optimize`.\r\n\r\n### pattern B\r\n\r\n`optuna tell` (more precisely, `study.tell`) set the study's state to `FAILED` and raise an error.\r\n\r\n### pattern C\r\n\r\nChange the error message.\r\n\r\n## Environment\r\n\r\n- Optuna version: a3.0.0a1.dev\r\n- Python version: 3.8.6\r\n- OS: Linux-5.10.60.1-microsoft-standard-WSL2-x86_64-with-glibc2.29 \r\n- (Optional) Other libraries and their versions:\r\n\r\n## Additional context (optional)\r\n\r\nNone, null, and other nans:\r\n```text\r\n$ optuna tell --storage sqlite:///debug.db --study-name foo --trial-number 0 --values NaN\r\n/home/ytsmiling/.venv/lib/python3.8/site-packages/optuna/cli.py:863: ExperimentalWarning: 'tell' is an experimental CLI command. The interface can change in the future.\r\nwarnings.warn(\r\n[E 2021-11-29 15:43:17,883] Trial 0 failed, because the objective function returned nan.\r\n```\r\n```text\r\n$ optuna tell --storage sqlite:///debug.db --study-name foo --trial-number 0 --values np.nan\r\nusage: optuna tell [-h] [--study-name STUDY_NAME] [--trial-number TRIAL_NUMBER] [--values VALUES [VALUES ...]] [--state STATE]\r\noptuna tell: error: argument --values: invalid float value: 'np.nan'\r\n[E 2021-11-29 15:43:23,779]\r\n```\r\n```text\r\n$ optuna tell --storage sqlite:///debug.db --study-name foo --trial-number 0 --values None\r\nusage: optuna tell [-h] [--study-name STUDY_NAME] [--trial-number TRIAL_NUMBER] [--values VALUES [VALUES ...]] [--state STATE]\r\noptuna tell: error: argument --values: invalid float value: 'None'\r\n[E 2021-11-29 15:33:50,293]\r\n```\r\n```text\r\n$ optuna tell --storage sqlite:///debug.db --study-name foo --trial-number 0 --values null\r\nusage: optuna tell [-h] [--study-name STUDY_NAME] [--trial-number TRIAL_NUMBER] [--values VALUES [VALUES ...]] [--state STATE]\r\noptuna tell: error: argument --values: invalid float value: 'null'\r\n[E 2021-11-29 15:33:57,260]\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3132/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3132/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3129", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3129/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3129/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3129/events", "html_url": "https://github.com/optuna/optuna/issues/3129", "id": 1065321674, "node_id": "I_kwDOB0okGM4_f4TK", "number": 3129, "title": "TPE not working with a categorical variable with different choice types", "user": {"login": "chledowski", "id": 24462884, "node_id": "MDQ6VXNlcjI0NDYyODg0", "avatar_url": "https://avatars.githubusercontent.com/u/24462884?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chledowski", "html_url": "https://github.com/chledowski", "followers_url": "https://api.github.com/users/chledowski/followers", "following_url": "https://api.github.com/users/chledowski/following{/other_user}", "gists_url": "https://api.github.com/users/chledowski/gists{/gist_id}", "starred_url": "https://api.github.com/users/chledowski/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chledowski/subscriptions", "organizations_url": "https://api.github.com/users/chledowski/orgs", "repos_url": "https://api.github.com/users/chledowski/repos", "events_url": "https://api.github.com/users/chledowski/events{/privacy}", "received_events_url": "https://api.github.com/users/chledowski/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 2107128673, "node_id": "MDU6TGFiZWwyMTA3MTI4Njcz", "url": "https://api.github.com/repos/optuna/optuna/labels/no-stale", "name": "no-stale", "color": "BBBBBB", "default": false, "description": "Exempt from stale bot"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-11-28T12:38:55Z", "updated_at": "2022-04-22T07:54:00Z", "closed_at": "2022-04-22T07:53:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi. Thanks for this amazing library!\r\n\r\nWhen I try to optimize a model with a categorical variable with different choice types, it gives me `IndexError: shape mismatch: indexing arrays could not be broadcast together with shapes (9,) (4,)`. This error always happens after 10 trials.\r\n\r\nI would be very grateful for an explanation on why is that the case - I guess it has to do with how TPE makes categorical variables continuous, but I wasn't able to find how it's done.\r\n\r\nAlso, I think that it might be very useful for people relatively new to Optuna if the error was more self-explanatory. In my case, it took over 10h to find out why my optimization failed.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.10.0\r\n- Python version: 3.6.10\r\n- OS: Linux-4.18.0-305.10.2.el8_4.ppc64le-ppc64le-with-redhat-8.4-Ootpa\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n/home/chledj01/.local/lib/python3.6/site-packages/optuna/samplers/_tpe/sampler.py:266: ExperimentalWarning: ``multivariate`` option is an experimental feature. The interface can change in the future.\r\n  ExperimentalWarning,\r\n/home/chledj01/.local/lib/python3.6/site-packages/optuna/samplers/_tpe/sampler.py:285: ExperimentalWarning: ``constant_liar`` option is an experimental feature. The interface can change in the future.\r\n  ExperimentalWarning,\r\n[I 2021-11-28 07:31:46,317] Trial 0 finished with value: 51.25318418441549 and parameters: {'x1': 7.159132921270249, 'x2': None}. Best is trial 0 with value: 51.25318418441549.\r\n[I 2021-11-28 07:31:46,661] Trial 1 finished with value: 0.0 and parameters: {'x1': -6.523347451025641, 'x2': 1}. Best is trial 0 with value: 51.25318418441549.\r\n[I 2021-11-28 07:31:46,857] Trial 2 finished with value: 77.13131244750303 and parameters: {'x1': 8.782443421252598, 'x2': None}. Best is trial 2 with value: 77.13131244750303.\r\n[I 2021-11-28 07:31:47,067] Trial 3 finished with value: 71.35511499232025 and parameters: {'x1': -8.447195688056496, 'x2': None}. Best is trial 2 with value: 77.13131244750303.\r\n[I 2021-11-28 07:31:47,283] Trial 4 finished with value: 0.0 and parameters: {'x1': 7.448216057409198, 'x2': 1}. Best is trial 2 with value: 77.13131244750303.\r\n[I 2021-11-28 07:31:47,537] Trial 5 finished with value: 42.52100156846517 and parameters: {'x1': 6.520812953034703, 'x2': None}. Best is trial 2 with value: 77.13131244750303.\r\n[I 2021-11-28 07:31:47,757] Trial 6 finished with value: 0.0 and parameters: {'x1': 3.2600618681215856, 'x2': 1}. Best is trial 2 with value: 77.13131244750303.\r\n[I 2021-11-28 07:31:47,905] Trial 7 finished with value: 88.15753251520141 and parameters: {'x1': 9.389224276541775, 'x2': None}. Best is trial 7 with value: 88.15753251520141.\r\n[I 2021-11-28 07:31:48,029] Trial 8 finished with value: 39.329878182295595 and parameters: {'x1': 6.271353775884087, 'x2': None}. Best is trial 7 with value: 88.15753251520141.\r\n[I 2021-11-28 07:31:48,144] Trial 9 finished with value: 0.0 and parameters: {'x1': -7.077110913961812, 'x2': 1}. Best is trial 7 with value: 88.15753251520141.\r\nTraceback (most recent call last):\r\n  File \"optuna_test.py\", line 23, in <module>\r\n    study.optimize(train, n_trials=300)\r\n  File \"/home/chledj01/.local/lib/python3.6/site-packages/optuna/study/study.py\", line 409, in optimize\r\n    show_progress_bar=show_progress_bar,\r\n  File \"/home/chledj01/.local/lib/python3.6/site-packages/optuna/study/_optimize.py\", line 76, in _optimize\r\n    progress_bar=progress_bar,\r\n  File \"/home/chledj01/.local/lib/python3.6/site-packages/optuna/study/_optimize.py\", line 163, in _optimize_sequential\r\n    trial = _run_trial(study, func, catch)\r\n  File \"/home/chledj01/.local/lib/python3.6/site-packages/optuna/study/_optimize.py\", line 194, in _run_trial\r\n    trial = study.ask()\r\n  File \"/home/chledj01/.local/lib/python3.6/site-packages/optuna/study/study.py\", line 486, in ask\r\n    trial = trial_module.Trial(self, trial_id)\r\n  File \"/home/chledj01/.local/lib/python3.6/site-packages/optuna/trial/_trial.py\", line 56, in __init__\r\n    self._init_relative_params()\r\n  File \"/home/chledj01/.local/lib/python3.6/site-packages/optuna/trial/_trial.py\", line 66, in _init_relative_params\r\n    study, trial, self.relative_search_space\r\n  File \"/home/chledj01/.local/lib/python3.6/site-packages/optuna/samplers/_tpe/sampler.py\", line 349, in sample_relative\r\n    return self._sample_relative(study, trial, search_space)\r\n  File \"/home/chledj01/.local/lib/python3.6/site-packages/optuna/samplers/_tpe/sampler.py\", line 386, in _sample_relative\r\n    mpe_above = _ParzenEstimator(above, search_space, self._parzen_estimator_parameters)\r\n  File \"/home/chledj01/.local/lib/python3.6/site-packages/optuna/samplers/_tpe/parzen_estimator.py\", line 87, in __init__\r\n    param_observations, param_name\r\n  File \"/home/chledj01/.local/lib/python3.6/site-packages/optuna/samplers/_tpe/parzen_estimator.py\", line 366, in _calculate_categorical_params\r\n    weights[np.arange(n_observations), observations] += 1\r\nIndexError: shape mismatch: indexing arrays could not be broadcast together with shapes (9,) (4,)\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Create an optuna study with `optuna create-study --study-name '1234' --storage 'sqlite:///test.db' --direction 'maximize'`\r\n2. Run `optuna_test.py` defined below.\r\n\r\n## Reproducible examples (optional)\r\n\r\n`optuna_test.py`:\r\n```python\r\nimport optuna\r\n\r\n\r\ndef train(trial):\r\n    x1 = trial.suggest_uniform('x1', -10, 10)\r\n    x2 = trial.suggest_categorical('x2', [None, 1])\r\n    if x2:\r\n        score = 0\r\n    else:\r\n        score = x1 ** 2\r\n    return score\r\n\r\n\r\nif __name__ == \"__main__\":\r\n\r\n    sampler = optuna.samplers.TPESampler(multivariate=True,\r\n                                         group=False,\r\n                                         constant_liar=True)\r\n    study = optuna.load_study(study_name='1234',\r\n                              sampler=sampler,\r\n                              storage=\"sqlite:///test.db\")\r\n\r\n    study.optimize(train, n_trials=300)\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3129/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3129/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3088", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3088/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3088/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3088/events", "html_url": "https://github.com/optuna/optuna/issues/3088", "id": 1047006671, "node_id": "I_kwDOB0okGM4-aA3P", "number": 3088, "title": "SuccessiveHalving from Hyperband have some issues in parallelization", "user": {"login": "donny8", "id": 55653250, "node_id": "MDQ6VXNlcjU1NjUzMjUw", "avatar_url": "https://avatars.githubusercontent.com/u/55653250?v=4", "gravatar_id": "", "url": "https://api.github.com/users/donny8", "html_url": "https://github.com/donny8", "followers_url": "https://api.github.com/users/donny8/followers", "following_url": "https://api.github.com/users/donny8/following{/other_user}", "gists_url": "https://api.github.com/users/donny8/gists{/gist_id}", "starred_url": "https://api.github.com/users/donny8/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/donny8/subscriptions", "organizations_url": "https://api.github.com/users/donny8/orgs", "repos_url": "https://api.github.com/users/donny8/repos", "events_url": "https://api.github.com/users/donny8/events{/privacy}", "received_events_url": "https://api.github.com/users/donny8/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-11-08T04:27:40Z", "updated_at": "2022-03-02T23:05:38Z", "closed_at": "2022-03-02T23:05:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\nI think there are some issues in Hyperband Pruner in parallelization.\r\nTo be specific, the problem lies inside the SuccesiveHalving from Hyperband.\r\n\r\nThe first issue is, \r\n__the objective/rung_keys  for the very first trial (Trial 0) is omitted.__\r\nAs you know, SuccessiveHalving takes the objective value at each rung_promotion_step from `study._storage.set_trial_system_attr(trial._trial_id, rung_key, value)` inside the while loop of `prune`.\r\nHowever, the first trial had never entered the SuccessiveHalving `prune` since there is no trial with `TrialState.COMPLETE`\r\n so that the length of self._pruners in Hyperband is always 0 and return False.\r\n\r\nThe second issue is, \r\n__the first trials  for each bracket (except the very first trial) make unfair comparison in the _competing_values_.__\r\nLet\u2019s assume Trial 0, 1, 2, 3 started at the same time, and the Trial 0 ended earlier than any other trial.\r\nAs I said at the first issue, the trial 0 had never entered the pruning process.\r\nThe remaining Trial 1, 2, 3 also never entered the pruning process because they also have no trial with `TrialState.COMPLETE`.\r\nHowever, when the trial 0 had completed, the things changed.\r\nAt the last epoch of trial 1, 2, 3, they finally have a trial with `TrialState.COMPLETE` (trial 0).\r\nSo they enter the SuccesiveHalving Pruner through the Hyperband with the value at the last epoch.\r\nSuccessiveHalving `pruner` taking the value at the last_step had no problem if and only if there was at least one finished trial when they'd started since the pruner will return False if the last epoch is smaller than the rung_promotion_step.\r\nHowever, if the trial that had never got the chance to `prune` and entered `prune` at the last epoch, the values for every rung_key for the trial would filled with the last epoch accuracy.\r\n\r\n\r\nThe last issue is somewhat close to a question.\r\n__I do not understand why the code `competing_values.append(value)` in the `_get_competing_values` function in `SuccesiveHalving` exists.__\r\nThe `_get_competing_values` returns the competing values which are the accuracies of the trials at the specific _rung_promotion_step_.\r\nIt just seems to insert the value of the last trial accuracy at the _rung_promotion_step_ once more.\r\nThere could be some problems.\r\nFor example, let\u2019s assume there are 5 trials  in consideration.\r\nOrginally, the pruner would consider the accuracies of 5 trials at a rung and leave only 1 out of 5 trials (since 5//3 = 1)\r\nHowever, with the append line, the length of the _competing_values_ becomes 6 so that 2 out of 5 trials would survive.\r\nIs this intended?\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.10.0\r\n- Python version: 3.6.9\r\n- OS: Linux\r\n\r\n## Error messages, stack traces, or logs\r\n\r\nI included a figure containing all the issues.\r\n![Bracket 0](https://user-images.githubusercontent.com/55653250/140681041-1cc93a91-a1c7-4815-9bf0-3e041f9f9644.png)\r\nAs shown in the figure, the trial 0, 2, 3 and 5 are included in Bracket 0.\r\nWhen I checked the _competing_values_ in `SuccesiveHalving`, \r\n\r\n1. the value for the trial 0 is omitted since the trial 0 had never passed the line `study._storage.set_trial_system_attr(trial._trial_id, rung_key, value) .` in the while loop inside the `SuccessiveHalving`\r\n2. The competing_values for the trial 2 and 3 are the accuracy at the last epoch(Trial2 : 12, Trial 3: 11 ; I guess the Trial 3 got completed trial at epoch 11), not at the _rung_promotion_step_ epoch(1)\r\n3. The competing values contain 4 values from [Trial 2, Trial3, Trial5, Trial5]\r\n\r\nI also included another table figure that contains the accuracies of the trials at each epoch(0 ~ 12)\r\n![Accuracies](https://user-images.githubusercontent.com/55653250/140681113-3245868f-6e63-49a2-b078-bdfe07a6670f.png)\r\nYou can check that the competing values for the Trial 2 and 3 is not the accuracy at epoch 1, but at epoch 12(which is the last epoch)\r\n\r\n## Steps to reproduce\r\n\r\n__Issue 1.__ Check the competing_values for the bracket including the very first trial. (It would not consider the very first trial)\r\n__Issue 2.__ Consider the case when trial 1 had never entered `prune` because of the absence of the completed trial and \r\n              finally entered `prune` at the last epoch as the trial 0 had just been completed.\r\n__Issue 3.__ Print the competing values of the trials at each rung_promotion_step.\r\n\r\nHere are the following codes related to each issue\r\nI'd just added some print() lines without adding or changing the original codes\r\n\r\n`    \r\n\r\n    def prune(self, study: \"optuna.study.Study\", trial: \"optuna.trial.FrozenTrial\") -> bool:\r\n        step = trial.last_step\r\n        if step is None:\r\n            return False\r\n        rung = _get_current_rung(trial)\r\n        value = trial.intermediate_values[step]\r\n       #============================================================================================= #\r\n        #\r\n        # Issue 1-(1) : The message below will never be printed at the very first trial (Trial 0)\r\n        print('Prune init : rung %d trial '%(rung), trial.number, 'last step ', step,' value ', value) \r\n        #\r\n        #============================================================================================= #\r\n\r\n        trials: Optional[List[\"optuna.trial.FrozenTrial\"]] = None\r\n\r\n        while True:\r\n            if self._min_resource is None:\r\n                if trials is None:\r\n                    trials = study.get_trials(deepcopy=False)\r\n                self._min_resource = _estimate_min_resource(trials)\r\n                if self._min_resource is None:\r\n                    return False\r\n\r\n            assert self._min_resource is not None\r\n            rung_promotion_step = self._min_resource * (\r\n                self._reduction_factor ** (self._min_early_stopping_rate + rung)\r\n            )\r\n            if step < rung_promotion_step:\r\n                return False\r\n\r\n            if math.isnan(value):\r\n                return True\r\n\r\n            if trials is None:\r\n                trials = study.get_trials(deepcopy=False)\r\n\r\n            rung_key = _completed_rung_key(rung)\r\n            print('Prune: trial : ', trial.number ,' value : ',value,' Candidate : ', trial.intermediate_values[rung_promotion_step], 'at rung_promotion_step ', rung_promotion_step) \r\n\r\n            #============================================================================================= #\r\n            #\r\n            # Issue 1-(2) : Consequently, trial 0 had never filled its rung_key\r\n            # Issue 2 : If the trial 1 enterd this while loop for the firtime at its last epoch, \r\n            #           all the rung_key would be filled with the value which is the last epoch accuracy \r\n            #         \r\n            study._storage.set_trial_system_attr(trial._trial_id, rung_key, value) \r\n            #\r\n            #============================================================================================= #\r\n\r\n\r\n            competing = _get_competing_values(trials, value, rung_key)\r\n            print('Prune rung',rung,'competing',competing) \\\r\n            # 'competing' already includes the current trial\r\n            # Therefore, we need to use the '<=' operator here\r\n            if len(competing) <= self._bootstrap_count:\r\n                return True\r\n\r\n            if not _is_trial_promotable_to_next_rung(\r\n                value,\r\n                competing,\r\n                self._reduction_factor,\r\n                study.direction,\r\n            ):\r\n                return True\r\n\r\n            rung += 1\r\n\r\n\r\n`\r\n\r\n    def _get_competing_values(\r\n        trials: List[\"optuna.trial.FrozenTrial\"], value: float, rung_key: str # Original\r\n    ) -> List[float]:\r\n        print('\\n') # DoKim edited\r\n        for t in trials :\r\n            if rung_key in t.system_attrs:\r\n                compet = [t.system_attrs[rung_key]]\r\n                print('   Get_competing_values: '+ rung_key, ' trial ',t.number,'competing ',compet)\r\n        #============================================================================================= #\r\n        #\r\n        # Issue 1-(3) : Since the trial 0 had never filled the rung_keys, it is alwyas omited\r\n        competing_values = [t.system_attrs[rung_key] for t in trials if rung_key in t.system_attrs]\r\n\r\n        # Issue 3 : The value is already included in the competing_values. What's the purpose of the line below?\r\n        competing_values.append(value)\r\n        #\r\n        #============================================================================================= #\r\n        return competing_values\r\n\r\n`", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3088/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3088/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3085", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3085/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3085/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3085/events", "html_url": "https://github.com/optuna/optuna/pull/3085", "id": 1046517466, "node_id": "PR_kwDOB0okGM4uLorH", "number": 3085, "title": "Handle `single` distributions in `fANOVA` evaluator", "user": {"login": "xadrianzetx", "id": 37713008, "node_id": "MDQ6VXNlcjM3NzEzMDA4", "avatar_url": "https://avatars.githubusercontent.com/u/37713008?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xadrianzetx", "html_url": "https://github.com/xadrianzetx", "followers_url": "https://api.github.com/users/xadrianzetx/followers", "following_url": "https://api.github.com/users/xadrianzetx/following{/other_user}", "gists_url": "https://api.github.com/users/xadrianzetx/gists{/gist_id}", "starred_url": "https://api.github.com/users/xadrianzetx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xadrianzetx/subscriptions", "organizations_url": "https://api.github.com/users/xadrianzetx/orgs", "repos_url": "https://api.github.com/users/xadrianzetx/repos", "events_url": "https://api.github.com/users/xadrianzetx/events{/privacy}", "received_events_url": "https://api.github.com/users/xadrianzetx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1964887919, "node_id": "MDU6TGFiZWwxOTY0ODg3OTE5", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.importance", "name": "optuna.importance", "color": "1c659e", "default": false, "description": "Related to the `optuna.importance` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/39", "html_url": "https://github.com/optuna/optuna/milestone/39", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/39/labels", "id": 7208320, "node_id": "MI_kwDOB0okGM4Abf2A", "number": 39, "title": "v3.0.0-a0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 92, "state": "closed", "created_at": "2021-10-01T05:10:48Z", "updated_at": "2022-02-04T05:14:05Z", "due_on": null, "closed_at": "2022-02-04T05:14:05Z"}, "comments": 3, "created_at": "2021-11-06T14:09:24Z", "updated_at": "2021-11-12T15:48:43Z", "closed_at": "2021-11-12T04:01:04Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3085", "html_url": "https://github.com/optuna/optuna/pull/3085", "diff_url": "https://github.com/optuna/optuna/pull/3085.diff", "patch_url": "https://github.com/optuna/optuna/pull/3085.patch", "merged_at": "2021-11-12T04:01:04Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nThis PR fixes #2542 by making `FanovaImportanceEvaluator` correctly handle param distributions with equal lower and upper bounds. This is an alternative implementation, as discussed in #3074 (thanks @hvy!).\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n* Handle `single` distributions in `FanovaImportanceEvaluator.evaluate`\r\n* Write tests", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3085/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3085/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3083", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3083/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3083/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3083/events", "html_url": "https://github.com/optuna/optuna/issues/3083", "id": 1045379504, "node_id": "I_kwDOB0okGM4-Tzmw", "number": 3083, "title": "Hyperband bracket assignment using hash in parallelization", "user": {"login": "donny8", "id": 55653250, "node_id": "MDQ6VXNlcjU1NjUzMjUw", "avatar_url": "https://avatars.githubusercontent.com/u/55653250?v=4", "gravatar_id": "", "url": "https://api.github.com/users/donny8", "html_url": "https://github.com/donny8", "followers_url": "https://api.github.com/users/donny8/followers", "following_url": "https://api.github.com/users/donny8/following{/other_user}", "gists_url": "https://api.github.com/users/donny8/gists{/gist_id}", "starred_url": "https://api.github.com/users/donny8/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/donny8/subscriptions", "organizations_url": "https://api.github.com/users/donny8/orgs", "repos_url": "https://api.github.com/users/donny8/repos", "events_url": "https://api.github.com/users/donny8/events{/privacy}", "received_events_url": "https://api.github.com/users/donny8/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 22, "created_at": "2021-11-05T01:51:53Z", "updated_at": "2022-11-07T01:03:11Z", "closed_at": "2022-11-07T01:03:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\nI think there could be a problem when using Hyperband pruner in parallelization.\r\nIn Hyperband, each trial is assigned to the bracket by computing hash(\"{}{}\".format(study.studyname, trial.number).\r\nHowever, the hash gives different value for the same input when executed on different terminal.\r\nA trial n, for example, could be assigned to the bracket 1 at process 1 and the bracket 2 at process 2 , which ruins the benefits of using Hyperband pruner instead of the SuccesiveHalving pruner.\r\n\r\n## Expected behavior\r\n\r\nA trial needs to be assigned to the identical bracket among each process.\r\n \r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\n## Environment\r\n\r\n<!--\r\nYou can get this information by typing the following:\r\n```\r\npython -c 'import optuna; print(optuna.__version__)'\r\npython -c 'import platform; print(platform.python_version())'\r\npython -c 'import platform; print(platform.platform())'\r\n```\r\n-->\r\n\r\n- Optuna version: 2.10.0\r\n- Python version: 3.6.9\r\n- OS: Linux\r\n\r\n## Error messages, stack traces, or logs\r\n\r\nI attached an custom-made log that I'd added in the SuccessiveHalving code, which is a part of the Hyperband.\r\nThe trials 1, 2, 3, 4 were included in bracket 1 at both process 1 and 2\r\nHowever, the trials 5, 7, 9 were included in the bracket only at process 2. \r\n\r\n**Trials for bracket 1 at process 1**\r\n![image](https://user-images.githubusercontent.com/55653250/140302703-a7ea8e8a-0f9d-4be1-ae1c-246686535c17.png)\r\n\r\n**Trials for the same bracket 1 at process 2**\r\n![image](https://user-images.githubusercontent.com/55653250/140302720-94e346e1-0984-4278-a278-005534efe9cc.png)\r\n\r\n\r\n## Steps to reproduce\r\n\r\n1. Add the following codes at the beginning of the **def _get_competing_values( )** in the **_successive_halving.py**\r\n```\r\nfor t in trials :\r\n    if rung_key in t.system_attrs:\r\n        compet = [t.system_attrs[rung_key]]\r\n        print('   Prune SH Get_competing_values: '+ rung_key, ' trial ',t.number,'competing ',compet)\r\n```\r\n2. Check if the trials consisting of a bracket differs among each process\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\nAs you can see [here](https://docs.python.org/3.3/using/cmdline.html), it was due to the update that hash randomization is turned on after python version 3.3.\r\nOf course, the randomization could be turned off by setting the PYTHONHASHSEED=0 when executing the python script.\r\nSince I did not see any warning or suggestion about this problem, I would like to ask if my assertion was legit.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3083/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3083/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3053", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3053/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3053/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3053/events", "html_url": "https://github.com/optuna/optuna/issues/3053", "id": 1038668660, "node_id": "I_kwDOB0okGM496NN0", "number": 3053, "title": "Trial time completion increases x10 with PostgreSQL", "user": {"login": "jmakov", "id": 2602122, "node_id": "MDQ6VXNlcjI2MDIxMjI=", "avatar_url": "https://avatars.githubusercontent.com/u/2602122?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jmakov", "html_url": "https://github.com/jmakov", "followers_url": "https://api.github.com/users/jmakov/followers", "following_url": "https://api.github.com/users/jmakov/following{/other_user}", "gists_url": "https://api.github.com/users/jmakov/gists{/gist_id}", "starred_url": "https://api.github.com/users/jmakov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jmakov/subscriptions", "organizations_url": "https://api.github.com/users/jmakov/orgs", "repos_url": "https://api.github.com/users/jmakov/repos", "events_url": "https://api.github.com/users/jmakov/events{/privacy}", "received_events_url": "https://api.github.com/users/jmakov/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-10-28T15:43:18Z", "updated_at": "2021-11-02T11:56:25Z", "closed_at": "2021-11-02T11:56:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "Starting a study on a local cluster, the trials complete in about 0.5s (the objective function has a constant runtime). At about 80k trials one trial takes about 5s to complete.\r\n\r\n## Expected behavior\r\nAs number of trials increases the trials shouldn't take longer to complete. Is there perhaps an index missing in SQL tables?\r\n\r\n## Environment\r\n- Optuna version:  2.10.0\r\n- Python version: 3.7.10\r\n- OS: Ubuntu 21.10 (Linux-5.13.0-20-generic-x86_64-with-debian-11.0)\r\n- (Optional) Other libraries and their versions:\r\nPostgreSQL 12\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nfrom the trials table:\r\ntrial_id, number, stuy_id, state, datetime_start, datetime_complete\r\n541,540,1,COMPLETE,2021-10-28 15:44:26.864200,2021-10-28 15:44:27.202030  # took about 0.5s to complete\r\nvs\r\n83535,83534,1,COMPLETE,2021-10-28 17:35:33.607027,2021-10-28 17:35:38.514746  # took 5s to complete\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. prepare an objective function that always evaluates under 1s\r\n2. run study with about 100k trials\r\n3. observe how long a trial takes when the study reaches 10k trials, 50k trials and 100k trials (trials DB table)\r\n\r\n## Reproducible examples (optional)\r\n\r\n## Additional context (optional)\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3053/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3053/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3046", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3046/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3046/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3046/events", "html_url": "https://github.com/optuna/optuna/pull/3046", "id": 1036098356, "node_id": "PR_kwDOB0okGM4trKY8", "number": 3046, "title": "Fix `matplotlib.plot_contour` bug", "user": {"login": "IEP", "id": 5747517, "node_id": "MDQ6VXNlcjU3NDc1MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5747517?v=4", "gravatar_id": "", "url": "https://api.github.com/users/IEP", "html_url": "https://github.com/IEP", "followers_url": "https://api.github.com/users/IEP/followers", "following_url": "https://api.github.com/users/IEP/following{/other_user}", "gists_url": "https://api.github.com/users/IEP/gists{/gist_id}", "starred_url": "https://api.github.com/users/IEP/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/IEP/subscriptions", "organizations_url": "https://api.github.com/users/IEP/orgs", "repos_url": "https://api.github.com/users/IEP/repos", "events_url": "https://api.github.com/users/IEP/events{/privacy}", "received_events_url": "https://api.github.com/users/IEP/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}, {"id": 3264287142, "node_id": "MDU6TGFiZWwzMjY0Mjg3MTQy", "url": "https://api.github.com/repos/optuna/optuna/labels/v3", "name": "v3", "color": "339FD7", "default": false, "description": "Issue/PR for Optuna version 3."}], "state": "closed", "locked": false, "assignee": {"login": "Crissman", "id": 4338467, "node_id": "MDQ6VXNlcjQzMzg0Njc=", "avatar_url": "https://avatars.githubusercontent.com/u/4338467?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Crissman", "html_url": "https://github.com/Crissman", "followers_url": "https://api.github.com/users/Crissman/followers", "following_url": "https://api.github.com/users/Crissman/following{/other_user}", "gists_url": "https://api.github.com/users/Crissman/gists{/gist_id}", "starred_url": "https://api.github.com/users/Crissman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Crissman/subscriptions", "organizations_url": "https://api.github.com/users/Crissman/orgs", "repos_url": "https://api.github.com/users/Crissman/repos", "events_url": "https://api.github.com/users/Crissman/events{/privacy}", "received_events_url": "https://api.github.com/users/Crissman/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "Crissman", "id": 4338467, "node_id": "MDQ6VXNlcjQzMzg0Njc=", "avatar_url": "https://avatars.githubusercontent.com/u/4338467?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Crissman", "html_url": "https://github.com/Crissman", "followers_url": "https://api.github.com/users/Crissman/followers", "following_url": "https://api.github.com/users/Crissman/following{/other_user}", "gists_url": "https://api.github.com/users/Crissman/gists{/gist_id}", "starred_url": "https://api.github.com/users/Crissman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Crissman/subscriptions", "organizations_url": "https://api.github.com/users/Crissman/orgs", "repos_url": "https://api.github.com/users/Crissman/repos", "events_url": "https://api.github.com/users/Crissman/events{/privacy}", "received_events_url": "https://api.github.com/users/Crissman/received_events", "type": "User", "site_admin": false}, {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/39", "html_url": "https://github.com/optuna/optuna/milestone/39", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/39/labels", "id": 7208320, "node_id": "MI_kwDOB0okGM4Abf2A", "number": 39, "title": "v3.0.0-a0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 92, "state": "closed", "created_at": "2021-10-01T05:10:48Z", "updated_at": "2022-02-04T05:14:05Z", "due_on": null, "closed_at": "2022-02-04T05:14:05Z"}, "comments": 9, "created_at": "2021-10-26T10:09:14Z", "updated_at": "2021-12-03T05:38:56Z", "closed_at": "2021-11-01T09:52:16Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3046", "html_url": "https://github.com/optuna/optuna/pull/3046", "diff_url": "https://github.com/optuna/optuna/pull/3046.diff", "patch_url": "https://github.com/optuna/optuna/pull/3046.patch", "merged_at": "2021-11-01T09:52:16Z"}, "body": "Close #3039  about `matplotlib.plot_contour` bug \r\n\r\n## Description\r\n\r\nWhen the top left subplot is being plotted, the `len(zi) == 0` thus\r\n- `ax.set_xlim(x_values_range[0], x_values_range[1])`, and\r\n- `ax.set_ylim(y_values_range[0], y_values_range[1])`\r\nare not executed and resulting the top left subplot doesn't have proper `xlim` and `ylim`", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3046/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3046/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3039", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3039/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3039/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3039/events", "html_url": "https://github.com/optuna/optuna/issues/3039", "id": 1035082561, "node_id": "I_kwDOB0okGM49shtB", "number": 3039, "title": "Fix labels on the `matplotlib.plot_contour` with more than two params", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}, {"id": 1846694757, "node_id": "MDU6TGFiZWwxODQ2Njk0NzU3", "url": "https://api.github.com/repos/optuna/optuna/labels/good%20first%20issue", "name": "good first issue", "color": "c2e0c6", "default": true, "description": "Good first issue for contribution."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}, {"id": 3264287142, "node_id": "MDU6TGFiZWwzMjY0Mjg3MTQy", "url": "https://api.github.com/repos/optuna/optuna/labels/v3", "name": "v3", "color": "339FD7", "default": false, "description": "Issue/PR for Optuna version 3."}, {"id": 3396188600, "node_id": "LA_kwDOB0okGM7Kbbm4", "url": "https://api.github.com/repos/optuna/optuna/labels/Hacktoberfest", "name": "Hacktoberfest", "color": "ff7518", "default": false, "description": "Good first issues to participate in Hacktoberfest"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-10-25T12:34:51Z", "updated_at": "2021-11-01T09:52:16Z", "closed_at": "2021-11-01T09:52:16Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n## Expected behavior\r\n\r\nThe red circled part should be fixed since the actual range is `(-100, 100)`.\r\n\r\n<img width=\"484\" alt=\"Screenshot 2021-10-25 at 21 26 49\" src=\"https://user-images.githubusercontent.com/7121753/138695549-3d5dbe3e-ab9a-4b6f-a1f4-60404c5aab58.png\">\r\n\r\nAs a reference, plotly's counter plot is as follows:\r\n\r\n<img width=\"1020\" alt=\"Screenshot 2021-10-25 at 21 30 10\" src=\"https://user-images.githubusercontent.com/7121753/138695303-7b024ec2-bcab-4942-bdf0-a2f1c95bb418.png\">\r\n\r\n\r\n\r\n\r\n## Environment\r\n\r\n- Optuna version:3.0.0a1.dev\r\n- Python version:3.8.12\r\n- OS:macOS-10.16-x86_64-i386-64bit\r\n- (Optional) Other libraries and their versions:\r\n    - matplotlib                    3.4.2\r\n    - plotly                        5.3.1\r\n\r\n\r\n## Steps to reproduce\r\n\r\nPlease run the following code. Note that the plot with two params: `optuna.visualization.matplotlib.plot_contour(study, params=[\"y\", \"x\"])` is fine.\r\n\r\n## Reproducible examples (optional)\r\n```python\r\nimport optuna\r\n\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_float(\"x\", -100, 100)\r\n    y = trial.suggest_categorical(\"y\", [-1, 0, 1])\r\n    z = trial.suggest_categorical(\"z\", [-1, 0, 1])    \r\n    return x ** 2 + y - z\r\n\r\n\r\nsampler = optuna.samplers.TPESampler(seed=10)\r\nstudy = optuna.create_study(sampler=sampler)\r\nstudy.optimize(objective, n_trials=30)\r\n\r\noptuna.visualization.matplotlib.plot_contour(study)\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3039/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3039/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3033", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3033/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3033/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3033/events", "html_url": "https://github.com/optuna/optuna/issues/3033", "id": 1032291889, "node_id": "I_kwDOB0okGM49h4Yx", "number": 3033, "title": "When dumping a study using v2.8.0, it cannot be loaded on v2.10.0", "user": {"login": "skulas", "id": 1819156, "node_id": "MDQ6VXNlcjE4MTkxNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1819156?v=4", "gravatar_id": "", "url": "https://api.github.com/users/skulas", "html_url": "https://github.com/skulas", "followers_url": "https://api.github.com/users/skulas/followers", "following_url": "https://api.github.com/users/skulas/following{/other_user}", "gists_url": "https://api.github.com/users/skulas/gists{/gist_id}", "starred_url": "https://api.github.com/users/skulas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/skulas/subscriptions", "organizations_url": "https://api.github.com/users/skulas/orgs", "repos_url": "https://api.github.com/users/skulas/repos", "events_url": "https://api.github.com/users/skulas/events{/privacy}", "received_events_url": "https://api.github.com/users/skulas/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-10-21T09:55:29Z", "updated_at": "2021-10-28T15:15:21Z", "closed_at": "2021-10-28T15:15:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "Try loading using v2.10.0 a Study that was created and dumped using v2.8.0 \r\n## Expected behavior\r\n\r\nConstruct a Study object initialized in the condition in which the study instance was dumped\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.10.0\r\n- Python version: 3.9.2\r\n- OS: macOS-10.16-x86_64-i386-64bit\r\n- joblib (1.0.1 -> 1.1.0) -- Used 1.0.1 for dumping and 1.1.0 for reloading\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nModuleNotFoundError                       Traceback (most recent call last)\r\n/var/folders/41/z1nzwb8d3m92x7dd6__1tqw00000gn/T/ipykernel_17363/3244084132.py in <module>\r\n     23 else:\r\n     24     print(f'Loading prev study: {prev_study_filename}')\r\n---> 25     study = joblib.load(prev_study_filename)\r\n\r\n~/Library/Caches/pypoetry/virtualenvs/statistical-analysis-jxhGUr6J-py3.9/lib/python3.9/site-packages/joblib/numpy_pickle.py in load(filename, mmap_mode)\r\n    585                     return load_compatibility(fobj)\r\n    586 \r\n--> 587                 obj = _unpickle(fobj, filename, mmap_mode)\r\n    588     return obj\r\n\r\n~/Library/Caches/pypoetry/virtualenvs/statistical-analysis-jxhGUr6J-py3.9/lib/python3.9/site-packages/joblib/numpy_pickle.py in _unpickle(fobj, filename, mmap_mode)\r\n    504     obj = None\r\n    505     try:\r\n--> 506         obj = unpickler.load()\r\n    507         if unpickler.compat_mode:\r\n    508             warnings.warn(\"The file '%s' has been generated with a \"\r\n\r\n/usr/local/Cellar/python@3.9/3.9.2_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/pickle.py in load(self)\r\n   1210                     raise EOFError\r\n   1211                 assert isinstance(key, bytes_types)\r\n-> 1212                 dispatch[key[0]](self)\r\n   1213         except _Stop as stopinst:\r\n   1214             return stopinst.value\r\n\r\n/usr/local/Cellar/python@3.9/3.9.2_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/pickle.py in load_stack_global(self)\r\n   1535         if type(name) is not str or type(module) is not str:\r\n   1536             raise UnpicklingError(\"STACK_GLOBAL requires str\")\r\n-> 1537         self.append(self.find_class(module, name))\r\n   1538     dispatch[STACK_GLOBAL[0]] = load_stack_global\r\n   1539 \r\n\r\n/usr/local/Cellar/python@3.9/3.9.2_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/pickle.py in find_class(self, module, name)\r\n   1577             elif module in _compat_pickle.IMPORT_MAPPING:\r\n   1578                 module = _compat_pickle.IMPORT_MAPPING[module]\r\n-> 1579         __import__(module, level=0)\r\n   1580         if self.proto >= 4:\r\n   1581             return _getattribute(sys.modules[module], name)[0]\r\n\r\nModuleNotFoundError: No module named 'optuna._study_direction'\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Run a Study using version 2.8.0\r\n2. Save the Study using version 2.8.0 (joblib v1.0.1)\r\n`joblib.dump(study, f'{study_save_filename_base}_study.pkl')`\r\n2. Update to version 2.10.0 (joblib updated to v1.1.0)\r\n3. Load the same study\r\n`study = joblib.load(prev_study_filename)`\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3033/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3033/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3013", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3013/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3013/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3013/events", "html_url": "https://github.com/optuna/optuna/issues/3013", "id": 1028198503, "node_id": "I_kwDOB0okGM49SRBn", "number": 3013, "title": "Default value of `verbose_eval` for LightGBMTuner/LightGBMTunerCV causes deprecated warning ", "user": {"login": "chezou", "id": 916653, "node_id": "MDQ6VXNlcjkxNjY1Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/916653?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chezou", "html_url": "https://github.com/chezou", "followers_url": "https://api.github.com/users/chezou/followers", "following_url": "https://api.github.com/users/chezou/following{/other_user}", "gists_url": "https://api.github.com/users/chezou/gists{/gist_id}", "starred_url": "https://api.github.com/users/chezou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chezou/subscriptions", "organizations_url": "https://api.github.com/users/chezou/orgs", "repos_url": "https://api.github.com/users/chezou/repos", "events_url": "https://api.github.com/users/chezou/events{/privacy}", "received_events_url": "https://api.github.com/users/chezou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 3396188600, "node_id": "LA_kwDOB0okGM7Kbbm4", "url": "https://api.github.com/repos/optuna/optuna/labels/Hacktoberfest", "name": "Hacktoberfest", "color": "ff7518", "default": false, "description": "Good first issues to participate in Hacktoberfest"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-10-17T02:42:17Z", "updated_at": "2021-10-22T10:39:03Z", "closed_at": "2021-10-22T10:39:03Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Since LightGBM 3.3.0, the following arguments are deprecated to use callbacks instead:\r\n- `verbose_eval`\r\n- `early_stopping_rounds` \r\n- `learning_rates`\r\n- `eval_result`\r\n\r\nhttps://github.com/microsoft/LightGBM/commit/86bda6f061138b666aa41f4dbea7285f8efdc5a7\r\n\r\nExample arguments before LightGBM 3.3.0:\r\n\r\n```\r\ntuner = lgb.LightGBMTunerCV(params, dtrain, verbose_eval=100, early_stopping_rounds=100, folds=KFold(n_splits=3))\r\n```\r\n\r\nEquivalent arguments in LightGBM 3.3.0:\r\n\r\n```\r\ntuner = lgb.LightGBMTunerCV(params, dtrain, callbacks=[log_evaluation(100), early_stopping(100, False, True)], folds=KFold(n_splits=3))\r\n```\r\n\r\nHowever, the default value of `verbose_eval` for `LightGBMTuner` and `LightGBMTunerCV` is `True` so that we need to write extra `verbose_eval=None` to avoid blocking to use `log_evaluation` callback.\r\n\r\nhttps://github.com/optuna/optuna/blob/563d0c7a50114a19f5cac2a502cdf7b0a68d2bab/optuna/integration/_lightgbm_tuner/optimize.py#L364\r\n\r\n```\r\ntuner = lgb.LightGBMTunerCV(params, dtrain, verbose_eval=None, callbacks=[log_evaluation(100), early_stopping(100, False, True)], folds=KFold(n_splits=3))\r\n```\r\n\r\n\r\n## Expected behavior\r\n\r\nNo need to write extra `verbose_eval=None` and output logs like:\r\n\r\n```\r\n[I 2021-10-17 02:22:20,543] A new study created in memory with name: no-name-1f095c7a-7f99-4b63-b18d-09d228fd3e16\r\n\r\n  0%|          | 0/7 [00:00<?, ?it/s]\r\nfeature_fraction, val_score: inf:   0%|          | 0/7 [00:00<?, ?it/s]Training until validation scores don't improve for 100 rounds\r\n[100]\tcv_agg's l2: 1067.5 + 83.0349\r\n\r\nfeature_fraction, val_score: 1051.388339:   0%|          | 0/7 [00:00<?, ?it/s]\r\nfeature_fraction, val_score: 1051.388339:  14%|#4        | 1/7 [00:00<00:01,  3.21it/s][I 2021-10-17 02:22:20,880] Trial 0 finished with value: 1051.3883391380703 and parameters: {'feature_fraction': 0.4}. Best is trial 0 with value: 1051.3883391380703.\r\n\r\nfeature_fraction, val_score: 1051.388339:  14%|#4        | 1/7 [00:00<00:01,  3.21it/s]Early stopping, best iteration is:\r\n[35]\tcv_agg's l2: 1051.39 + 83.9186\r\n```\r\n\r\n\r\n\r\n## Environment\r\n\r\n<!--\r\nYou can get this information by typing the following:\r\n```\r\npython -c 'import optuna; print(optuna.__version__)'\r\npython -c 'import platform; print(platform.python_version())'\r\npython -c 'import platform; print(platform.platform())'\r\n```\r\n-->\r\n\r\n- Optuna version: 2.10.0\r\n- Python version: 3.7.12\r\n- OS: Linux-5.4.104+-x86_64-with-Ubuntu-18.04-bionic\r\n- (Optional) Other libraries and their versions: LightGBM 3.3.0\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n[I 2021-10-17 02:39:50,486] A new study created in memory with name: no-name-741b6e25-44ba-4f3b-bbd9-54547b04f3c9\r\n\r\n\r\n  0%|          | 0/7 [00:00<?, ?it/s]\r\n\r\nfeature_fraction, val_score: inf:   0%|          | 0/7 [00:00<?, ?it/s]/usr/local/lib/python3.7/dist-packages/lightgbm/engine.py:621: UserWarning:\r\n\r\n'verbose_eval' argument is deprecated and will be removed in a future release of LightGBM. Pass 'log_evaluation()' callback via 'callbacks' argument instead.\r\n\r\n[1]\tcv_agg's l2: 1218.99 + 85.3389\r\nTraining until validation scores don't improve for 100 rounds\r\n[2]\tcv_agg's l2: 1185.36 + 85.4061\r\n[3]\tcv_agg's l2: 1158.39 + 85.7244\r\n[4]\tcv_agg's l2: 1136.65 + 86.152\r\n```\r\n\r\n\r\n\r\n\r\n## Steps to reproduce\r\n\r\n1. Create an instance of LightGBMTuner/LightGBMTunerCV without `verbose_eval=None` with `log_evaluation` callbacks\r\n2. Run tuner\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\nfrom sklearn.model_selection import KFold\r\nfrom lightgbm import early_stopping, log_evaluation\r\n\r\nparams = {\r\n    \"objective\": \"regression\",\r\n    \"metric\": \"l2\",\r\n    \"verbosity\": -1,\r\n    \"boosting_type\": \"gbdt\",\r\n    \"random_state\": 314\r\n}\r\n\r\ntuner = lgb.LightGBMTunerCV(params, dtrain, callbacks=[log_evaluation(100), early_stopping(100, False, True)], folds=KFold(n_splits=3))\r\ntuner.run()\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3013/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3013/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3009", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3009/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3009/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3009/events", "html_url": "https://github.com/optuna/optuna/issues/3009", "id": 1027230155, "node_id": "I_kwDOB0okGM49OknL", "number": 3009, "title": "Optuna timeout not respected", "user": {"login": "yaumeg", "id": 16510325, "node_id": "MDQ6VXNlcjE2NTEwMzI1", "avatar_url": "https://avatars.githubusercontent.com/u/16510325?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yaumeg", "html_url": "https://github.com/yaumeg", "followers_url": "https://api.github.com/users/yaumeg/followers", "following_url": "https://api.github.com/users/yaumeg/following{/other_user}", "gists_url": "https://api.github.com/users/yaumeg/gists{/gist_id}", "starred_url": "https://api.github.com/users/yaumeg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yaumeg/subscriptions", "organizations_url": "https://api.github.com/users/yaumeg/orgs", "repos_url": "https://api.github.com/users/yaumeg/repos", "events_url": "https://api.github.com/users/yaumeg/events{/privacy}", "received_events_url": "https://api.github.com/users/yaumeg/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-10-15T08:56:26Z", "updated_at": "2021-10-15T14:39:16Z", "closed_at": "2021-10-15T14:39:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\n\r\nWhen setting a timeout value in study.optimize(), the study does not stop at defined timeout.\r\n\r\nFor instance, if I set a timeout=60, study does not stop at 60s but approximately at 200s. I should add that each of my trial last approximately 10s, and n_jobs is defined to 1.\r\n\r\n## Environment\r\noptuna.__version__: 2.10.0\r\nplatform.python_version(): 3.7.9\r\nplatform.platform(): Linux-4.19.128-microsoft-standard-x86_64-with-debian-buster-sid", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3009/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3009/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3004", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3004/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3004/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3004/events", "html_url": "https://github.com/optuna/optuna/issues/3004", "id": 1024709836, "node_id": "I_kwDOB0okGM49E9TM", "number": 3004, "title": "Encountered `NotPSDError()` when using botorch as sampler", "user": {"login": "fsmosca", "id": 22366935, "node_id": "MDQ6VXNlcjIyMzY2OTM1", "avatar_url": "https://avatars.githubusercontent.com/u/22366935?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fsmosca", "html_url": "https://github.com/fsmosca", "followers_url": "https://api.github.com/users/fsmosca/followers", "following_url": "https://api.github.com/users/fsmosca/following{/other_user}", "gists_url": "https://api.github.com/users/fsmosca/gists{/gist_id}", "starred_url": "https://api.github.com/users/fsmosca/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fsmosca/subscriptions", "organizations_url": "https://api.github.com/users/fsmosca/orgs", "repos_url": "https://api.github.com/users/fsmosca/repos", "events_url": "https://api.github.com/users/fsmosca/events{/privacy}", "received_events_url": "https://api.github.com/users/fsmosca/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-10-13T02:49:19Z", "updated_at": "2021-10-13T13:36:30Z", "closed_at": "2021-10-13T13:36:30Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Encountered `NotPSDError()` when using botorch as sampler to optimize parameters.\r\n\r\nThere were not less than 30 parameters of `optuna.distributions.IntUniformDistribution` type that were tried to be optimized. This had happened after 480 trials were done.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.10.0\r\n- Python version: 3.9\r\n- OS: win10\r\n- (Optional) Other libraries and their versions: botorch 0.5.1, torch==1.9.1, scikit-learn==0.24.2\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nFile \"D:\\zzz\\yyy\\venv\\lib\\site-packages\\gpytorch\\utils\\cholesky.py\", line 48, in _psd_safe_cholesky\r\n    raise NotPSDError(f\"Matrix not positive definite after repeatedly adding jitter up to {jitter_new:.1e}.\")\r\ngpytorch.utils.errors.NotPSDError: Matrix not positive definite after repeatedly adding jitter up to 1.0e-06.\r\n```\r\n\r\n## Steps to reproduce\r\n\r\nOptimize param with ask and tell interface using botorch as sampler.\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\n```\r\n\r\n## Additional context (optional)\r\nPseudo code.\r\n```python\r\ndef main():\r\n    epochs = 2\r\n    sampler = optuna.integration.BoTorchSampler()\r\n\r\n    study = optuna.create_study(\r\n        study_name=study_name,\r\n        sampler=sampler,\r\n        direction=\"minimize\",\r\n        storage=f'sqlite:///{study_name}',\r\n        load_if_exists=True\r\n    )\r\n\r\n    for _ in range(epochs):\r\n\t\r\n        for _ in range(1000):\r\n\r\n            trial = study.ask(distributions)\r\n\r\n            param = {}\r\n            for k, v in distributions.items():\r\n                param.update({k: trial.params[k]})\r\n\r\n            result = objective(param)\r\n\r\n            study.tell(trial, result)\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3004/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3004/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3002", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3002/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3002/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3002/events", "html_url": "https://github.com/optuna/optuna/pull/3002", "id": 1023817138, "node_id": "PR_kwDOB0okGM4tEoWz", "number": 3002, "title": "Do not call `trial.report` during sanity check", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561256, "node_id": "MDU6TGFiZWwxOTQ3NTYxMjU2", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.integration", "name": "optuna.integration", "color": "1c659e", "default": false, "description": "Related to the `optuna.integration` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "Crissman", "id": 4338467, "node_id": "MDQ6VXNlcjQzMzg0Njc=", "avatar_url": "https://avatars.githubusercontent.com/u/4338467?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Crissman", "html_url": "https://github.com/Crissman", "followers_url": "https://api.github.com/users/Crissman/followers", "following_url": "https://api.github.com/users/Crissman/following{/other_user}", "gists_url": "https://api.github.com/users/Crissman/gists{/gist_id}", "starred_url": "https://api.github.com/users/Crissman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Crissman/subscriptions", "organizations_url": "https://api.github.com/users/Crissman/orgs", "repos_url": "https://api.github.com/users/Crissman/repos", "events_url": "https://api.github.com/users/Crissman/events{/privacy}", "received_events_url": "https://api.github.com/users/Crissman/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "Crissman", "id": 4338467, "node_id": "MDQ6VXNlcjQzMzg0Njc=", "avatar_url": "https://avatars.githubusercontent.com/u/4338467?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Crissman", "html_url": "https://github.com/Crissman", "followers_url": "https://api.github.com/users/Crissman/followers", "following_url": "https://api.github.com/users/Crissman/following{/other_user}", "gists_url": "https://api.github.com/users/Crissman/gists{/gist_id}", "starred_url": "https://api.github.com/users/Crissman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Crissman/subscriptions", "organizations_url": "https://api.github.com/users/Crissman/orgs", "repos_url": "https://api.github.com/users/Crissman/repos", "events_url": "https://api.github.com/users/Crissman/events{/privacy}", "received_events_url": "https://api.github.com/users/Crissman/received_events", "type": "User", "site_admin": false}, {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/39", "html_url": "https://github.com/optuna/optuna/milestone/39", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/39/labels", "id": 7208320, "node_id": "MI_kwDOB0okGM4Abf2A", "number": 39, "title": "v3.0.0-a0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 92, "state": "closed", "created_at": "2021-10-01T05:10:48Z", "updated_at": "2022-02-04T05:14:05Z", "due_on": null, "closed_at": "2022-02-04T05:14:05Z"}, "comments": 3, "created_at": "2021-10-12T13:20:14Z", "updated_at": "2021-11-17T06:31:22Z", "closed_at": "2021-11-17T05:53:30Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3002", "html_url": "https://github.com/optuna/optuna/pull/3002", "diff_url": "https://github.com/optuna/optuna/pull/3002.diff", "patch_url": "https://github.com/optuna/optuna/pull/3002.patch", "merged_at": "2021-11-17T05:53:29Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\n**[Updated]** non-ddp training has the same issue. For example, https://github.com/optuna/optuna-examples/blob/main/pytorch/pytorch_lightning_simple.py shows the same warning message.\r\n\r\nWhen using `PyTorchLightningPruningCallback` with ddp backend,  the current implementation shows a warning message, `UserWarning: The reported value is ignored because this step 0 is already reported.`, at the first step.\r\n\r\nWe can reproduce it by running the example code in https://github.com/optuna/optuna-examples/pull/43.\r\n\r\nThe root reason is that PyTorch-lightning calls `validation_end` before training as a sanity check for debugging by default.\r\nRef: https://pytorch-lightning.readthedocs.io/en/latest/common/trainer.html#num-sanity-val-steps\r\n\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\nDo not call `trial.report` during sanity checking. To do so, we can use `Trainer.sanity_checking` that is a flag to know the current `validation_end` is called a sanity check or not.\r\n\r\nNote that I could not find the documentation of `sanity_checking`, so I refer to https://github.com/PyTorchLightning/pytorch-lightning/issues/1391 in the comment. In addition, `running_sanity_check` will be removed lightning 1.5.0 according to [`CHANGELOG.md`](https://github.com/PyTorchLightning/pytorch-lightning/blob/master/CHANGELOG.md). This is why I use `sanity_checking`.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3002/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3002/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/3001", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/3001/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/3001/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/3001/events", "html_url": "https://github.com/optuna/optuna/pull/3001", "id": 1023511993, "node_id": "PR_kwDOB0okGM4tDqGy", "number": 3001, "title": "Fix to raise `ValueError` for invalid `q` in `DiscreteUniformDistribution`", "user": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/39", "html_url": "https://github.com/optuna/optuna/milestone/39", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/39/labels", "id": 7208320, "node_id": "MI_kwDOB0okGM4Abf2A", "number": 39, "title": "v3.0.0-a0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 92, "state": "closed", "created_at": "2021-10-01T05:10:48Z", "updated_at": "2022-02-04T05:14:05Z", "due_on": null, "closed_at": "2022-02-04T05:14:05Z"}, "comments": 0, "created_at": "2021-10-12T08:21:06Z", "updated_at": "2021-10-18T02:51:18Z", "closed_at": "2021-10-18T02:50:45Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/3001", "html_url": "https://github.com/optuna/optuna/pull/3001", "diff_url": "https://github.com/optuna/optuna/pull/3001.diff", "patch_url": "https://github.com/optuna/optuna/pull/3001.patch", "merged_at": "2021-10-18T02:50:45Z"}, "body": "## Motivation\r\nThis PR fixes to raise `ValueError` for invalid `q` in `DiscreteUniformDistribution`.\r\n\r\n## Description of the changes\r\n- Fix to raise `ValueError` for invalid `q` in `DiscreteUniformDistribution`\r\n- Add tests for invalid `q` and `step` for `DiscreteUniformDistribution`, `IntUniformDistribution`, `suggest_float`, and `suggest_int`", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/3001/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/3001/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2995", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2995/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2995/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2995/events", "html_url": "https://github.com/optuna/optuna/issues/2995", "id": 1021722525, "node_id": "I_kwDOB0okGM485j-d", "number": 2995, "title": "CIs fail when testing LightGBM integration", "user": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-10-09T14:28:48Z", "updated_at": "2021-10-11T01:40:27Z", "closed_at": "2021-10-11T01:40:27Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Currently, tests in LightGBM integration module fail.\r\n\r\n```bash\r\n[W 2021-10-09 13:53:50,068] Trial 0 failed because of the following error: TypeError('Data list can only be of ndarray or Sequence')\r\nTraceback (most recent call last):\r\n  File \"/home/runner/work/optuna/optuna/optuna/study/_optimize.py\", line 213, in _run_trial\r\n    value_or_values = func(trial)\r\n  File \"/home/runner/work/optuna/optuna/tests/integration_tests/test_lightgbm.py\", line 145, in objective\r\n    callbacks=[pruning_callback],\r\n  File \"/opt/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/lightgbm/engine.py\", line 272, in train\r\n    booster = Booster(params=params, train_set=train_set)\r\n  File \"/opt/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/lightgbm/basic.py\", line 2605, in __init__\r\n    train_set.construct()\r\n  File \"/opt/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/lightgbm/basic.py\", line 1819, in construct\r\n    categorical_feature=self.categorical_feature, params=self.params)\r\n  File \"/opt/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/lightgbm/basic.py\", line 1545, in _lazy_init\r\nError:     raise TypeError('Data list can only be of ndarray or Sequence')\r\nTypeError: Data list can only be of ndarray or Sequence\r\n```\r\n\r\nhttps://github.com/optuna/optuna/runs/3846766083#step:7:483\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2995/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2995/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2991", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2991/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2991/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2991/events", "html_url": "https://github.com/optuna/optuna/pull/2991", "id": 1019730422, "node_id": "PR_kwDOB0okGM4s4Krn", "number": 2991, "title": "Fix the type of `trial.values` in MLflow integration", "user": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561256, "node_id": "MDU6TGFiZWwxOTQ3NTYxMjU2", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.integration", "name": "optuna.integration", "color": "1c659e", "default": false, "description": "Related to the `optuna.integration` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/39", "html_url": "https://github.com/optuna/optuna/milestone/39", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/39/labels", "id": 7208320, "node_id": "MI_kwDOB0okGM4Abf2A", "number": 39, "title": "v3.0.0-a0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 92, "state": "closed", "created_at": "2021-10-01T05:10:48Z", "updated_at": "2022-02-04T05:14:05Z", "due_on": null, "closed_at": "2022-02-04T05:14:05Z"}, "comments": 5, "created_at": "2021-10-07T07:52:56Z", "updated_at": "2021-10-18T15:34:21Z", "closed_at": "2021-10-18T15:34:20Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2991", "html_url": "https://github.com/optuna/optuna/pull/2991", "diff_url": "https://github.com/optuna/optuna/pull/2991.diff", "patch_url": "https://github.com/optuna/optuna/pull/2991.patch", "merged_at": "2021-10-18T15:34:20Z"}, "body": "## Motivation\r\nFix the CI error: https://github.com/optuna/optuna-examples/runs/3816748688?check_suite_focus=true. \r\nThe type of `FrozenTrial.values` is `Optional[List[float]]`, but it is annotated as `List[Optional[float]]` in the MLflow integration. This PR fix the inconsistency.\r\n\r\n## Description of the changes\r\nFix the integration and the test.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2991/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2991/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2985", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2985/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2985/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2985/events", "html_url": "https://github.com/optuna/optuna/issues/2985", "id": 1016129776, "node_id": "I_kwDOB0okGM48kOjw", "number": 2985, "title": "Tried to import 'plotly' but failed", "user": {"login": "Greco1899", "id": 28339294, "node_id": "MDQ6VXNlcjI4MzM5Mjk0", "avatar_url": "https://avatars.githubusercontent.com/u/28339294?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Greco1899", "html_url": "https://github.com/Greco1899", "followers_url": "https://api.github.com/users/Greco1899/followers", "following_url": "https://api.github.com/users/Greco1899/following{/other_user}", "gists_url": "https://api.github.com/users/Greco1899/gists{/gist_id}", "starred_url": "https://api.github.com/users/Greco1899/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Greco1899/subscriptions", "organizations_url": "https://api.github.com/users/Greco1899/orgs", "repos_url": "https://api.github.com/users/Greco1899/repos", "events_url": "https://api.github.com/users/Greco1899/events{/privacy}", "received_events_url": "https://api.github.com/users/Greco1899/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2021-10-05T10:04:32Z", "updated_at": "2022-08-20T23:24:54Z", "closed_at": "2021-10-15T01:31:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n## Expected behavior\r\nPlot of param importances of optimized study.\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\n## Environment\r\n\r\n<!--\r\nYou can get this information by typing the following:\r\n```\r\npython -c 'import optuna; print(optuna.__version__)'\r\npython -c 'import platform; print(platform.python_version())'\r\npython -c 'import platform; print(platform.platform())'\r\n```\r\n-->\r\n\r\n- Optuna version: 2.9.1\r\n- Python version: 3.8.5\r\n- OS: Windows 10\r\n- Plotly: 5.3.1\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nImportError: Tried to import 'plotly' but failed. Please make sure that the package is installed correctly to use this feature. Actual error: No module named 'plotly'.\r\n---------------------------------------------------------------------------\r\nModuleNotFoundError                       Traceback (most recent call last)\r\n~\\Anaconda3\\lib\\site-packages\\optuna\\visualization\\_plotly_imports.py in <module>\r\n      6 with try_import() as _imports:  # NOQA\r\n----> 7     import plotly  # NOQA\r\n      8     from plotly import __version__ as plotly_version\r\n\r\nModuleNotFoundError: No module named 'plotly'\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nImportError                               Traceback (most recent call last)\r\n<ipython-input-46-ec7b157c78f5> in <module>\r\n----> 1 optuna.visualization.plot_param_importances(study)\r\n\r\n~\\Anaconda3\\lib\\site-packages\\optuna\\visualization\\_param_importances.py in plot_param_importances(study, evaluator, params, target, target_name)\r\n     93     \"\"\"\r\n     94 \r\n---> 95     _imports.check()\r\n     96     _check_plot_args(study, target, target_name)\r\n     97 \r\n\r\n~\\Anaconda3\\lib\\site-packages\\optuna\\_imports.py in check(self)\r\n     84         if self._deferred is not None:\r\n     85             exc_value, message = self._deferred\r\n---> 86             raise ImportError(message) from exc_value\r\n     87 \r\n     88 \r\n\r\nImportError: Tried to import 'plotly' but failed. Please make sure that the package is installed correctly to use this feature. Actual error: No module named 'plotly'.\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Create objective, optimize study\r\n2. Run optuna.visualization.plot_param_importances(study)\r\n\r\n## Additional context (optional)\r\n\r\nThis issue here https://github.com/optuna/optuna/issues/1339 has been closed but others have continued reporting similar issues.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2985/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2985/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2972", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2972/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2972/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2972/events", "html_url": "https://github.com/optuna/optuna/issues/2972", "id": 1011312424, "node_id": "I_kwDOB0okGM48R2co", "number": 2972, "title": "loading study from relative path overwrites db object even if load_if_exists=True", "user": {"login": "VMBoehm", "id": 22053912, "node_id": "MDQ6VXNlcjIyMDUzOTEy", "avatar_url": "https://avatars.githubusercontent.com/u/22053912?v=4", "gravatar_id": "", "url": "https://api.github.com/users/VMBoehm", "html_url": "https://github.com/VMBoehm", "followers_url": "https://api.github.com/users/VMBoehm/followers", "following_url": "https://api.github.com/users/VMBoehm/following{/other_user}", "gists_url": "https://api.github.com/users/VMBoehm/gists{/gist_id}", "starred_url": "https://api.github.com/users/VMBoehm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/VMBoehm/subscriptions", "organizations_url": "https://api.github.com/users/VMBoehm/orgs", "repos_url": "https://api.github.com/users/VMBoehm/repos", "events_url": "https://api.github.com/users/VMBoehm/events{/privacy}", "received_events_url": "https://api.github.com/users/VMBoehm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-09-29T18:24:14Z", "updated_at": "2022-01-30T23:05:26Z", "closed_at": "2022-01-30T23:05:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\n\r\nI'm trying to load a study from a saved database object which is located in a different folder than the script I use to load it. I noticed that if I pass the relative path as study name, the database object gets overwritten despite the 'load_if_exists=True' flag. This must either be a bug or the way I'm referencing the database object is not the way I'm supposed to. In any case, the behavior seems counterintuitive.\r\nThanks in advance  for your feedback!\r\n\r\nExample: This overwrites example-study.db located in '../study_folder/' and creates a new db object in that folder.\r\n\r\nstudy_name = \"../study_folder/example-study\"   # relative path to saved study\r\nstorage_name = \"sqlite:///{}.db\".format(study_name)\r\nstudy = optuna.create_study(study_name=study_name, storage=storage_name, load_if_exists=True) # creates new db object in ../study_folder/ and overwrites old one\r\n\r\nI'm using optuna version '2.9.1'\r\n\r\nPlease let me know if you need any more information to track this down.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2972/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2972/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2965", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2965/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2965/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2965/events", "html_url": "https://github.com/optuna/optuna/issues/2965", "id": 1009918184, "node_id": "I_kwDOB0okGM48MiDo", "number": 2965, "title": "OptunaSearchCV does not work with scikit-learn 1.0", "user": {"login": "Garve", "id": 932327, "node_id": "MDQ6VXNlcjkzMjMyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/932327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Garve", "html_url": "https://github.com/Garve", "followers_url": "https://api.github.com/users/Garve/followers", "following_url": "https://api.github.com/users/Garve/following{/other_user}", "gists_url": "https://api.github.com/users/Garve/gists{/gist_id}", "starred_url": "https://api.github.com/users/Garve/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Garve/subscriptions", "organizations_url": "https://api.github.com/users/Garve/orgs", "repos_url": "https://api.github.com/users/Garve/repos", "events_url": "https://api.github.com/users/Garve/events{/privacy}", "received_events_url": "https://api.github.com/users/Garve/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-09-28T15:44:49Z", "updated_at": "2021-09-30T08:26:33Z", "closed_at": "2021-09-30T08:26:33Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hi!\r\n\r\nThe OptunaSearchCV does not work anymore with scikit-learn 1.0 because it does not like positional keywords anymore.  I think that this should be really easy to fix by just adding a `classifier` keyword to the `check_cv` function.\r\n\r\n## Expected behavior\r\n\r\nThat it works.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.9.1\r\n- Python version: 3.7.7\r\n- OS: Windows-10-10.0.19041-SP0\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```python\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-58-868ead6be421> in <module>\r\n----> 1 tuned_model.fit(X, y)\r\n\r\nc:\\users\\robert.kuebler\\miniconda3\\lib\\site-packages\\optuna\\integration\\sklearn.py in fit(self, X, y, groups, **fit_params)\r\n    839 \r\n    840         classifier = is_classifier(self.estimator)\r\n--> 841         cv = check_cv(self.cv, y_res, classifier)\r\n    842 \r\n    843         self.n_splits_ = cv.get_n_splits(X_res, y_res, groups=groups_res)\r\n\r\nTypeError: check_cv() takes from 0 to 2 positional arguments but 3 were given\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Just fit an OptunaSearchCV object.\r\n2.\r\n3.\r\n\r\nBest\r\nRobert\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2965/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2965/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2963", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2963/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2963/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2963/events", "html_url": "https://github.com/optuna/optuna/issues/2963", "id": 1009208817, "node_id": "I_kwDOB0okGM48J03x", "number": 2963, "title": "LightGBMTunerCV doesn't support `folds` as a generator", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1157544077, "node_id": "MDU6TGFiZWwxMTU3NTQ0MDc3", "url": "https://api.github.com/repos/optuna/optuna/labels/document", "name": "document", "color": "d60ca0", "default": false, "description": "Documentation related."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}, {"id": 1947561256, "node_id": "MDU6TGFiZWwxOTQ3NTYxMjU2", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.integration", "name": "optuna.integration", "color": "1c659e", "default": false, "description": "Related to the `optuna.integration` submodule. This is automatically labeled by github-actions."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-09-28T04:41:52Z", "updated_at": "2022-03-02T23:05:42Z", "closed_at": "2022-03-02T23:05:42Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what content in https://optuna.readthedocs.io/ is an issue. -->\r\n\r\nSince the original issue is closed, let me create this issue.  According to the investigation in https://github.com/optuna/optuna/issues/2960#issuecomment-928204820, users expect that  [`LightGBMTunerCV`](https://optuna.readthedocs.io/en/stable/reference/generated/optuna.integration.lightgbm.LightGBMTunerCV.html) pass generator as `nfolds` by following [`lightgbm.cv`](https://lightgbm.readthedocs.io/en/latest/pythonapi/lightgbm.cv.html) saying\r\n\r\n> folds (generator or iterator of (train_idx, test_idx) tuples, scikit-learn splitter object or None, optional (default=None)) \u2013 If generator or iterator, it should yield the train and test indices for each fold. If object, it should be one of the scikit-learn splitter classes (https://scikit-learn.org/stable/modules/classes.html#splitter-classes) and have split method. This argument has highest priority over other data split arguments.\r\n\r\n\r\nHowever, `LightGBMTunerCV` uses the `nfolds`' generator `n_trials` times during the optimisation, so we cannot pass the generator directly in practice. \r\n\r\nTo address this issue, I suppose \r\n\r\n1. clarify the type of `nfolds`\r\n2. Reuse generator inside `LightGBMTunerCV`\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2963/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2963/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2960", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2960/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2960/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2960/events", "html_url": "https://github.com/optuna/optuna/issues/2960", "id": 1008200325, "node_id": "I_kwDOB0okGM48F-qF", "number": 2960, "title": "LightGBMTunerCV Doesn't Support folds as a Generator", "user": {"login": "docmarionum1", "id": 178798, "node_id": "MDQ6VXNlcjE3ODc5OA==", "avatar_url": "https://avatars.githubusercontent.com/u/178798?v=4", "gravatar_id": "", "url": "https://api.github.com/users/docmarionum1", "html_url": "https://github.com/docmarionum1", "followers_url": "https://api.github.com/users/docmarionum1/followers", "following_url": "https://api.github.com/users/docmarionum1/following{/other_user}", "gists_url": "https://api.github.com/users/docmarionum1/gists{/gist_id}", "starred_url": "https://api.github.com/users/docmarionum1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/docmarionum1/subscriptions", "organizations_url": "https://api.github.com/users/docmarionum1/orgs", "repos_url": "https://api.github.com/users/docmarionum1/repos", "events_url": "https://api.github.com/users/docmarionum1/events{/privacy}", "received_events_url": "https://api.github.com/users/docmarionum1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-09-27T14:08:50Z", "updated_at": "2021-09-28T04:00:11Z", "closed_at": "2021-09-27T19:30:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "When I try running `LightGBMTunerCV` with an iterator for `folds` it passes the first trial (Trial 0) and then fails the second trial (Trial 1). This is similar to #1710 (which is now closed) except that #1710 mentions this error on Trial 0 instead of 1.\r\n\r\n## Expected behavior\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\nI expect it to run without error in the same manner as if I didn't pass the `folds` parameter.\r\n\r\n## Environment\r\n\r\n<!--\r\nYou can get this information by typing the following:\r\n```\r\npython -c 'import optuna; print(optuna.__version__)'\r\npython -c 'import platform; print(platform.python_version())'\r\npython -c 'import platform; print(platform.platform())'\r\n```\r\n-->\r\n\r\n- Optuna version: 2.9.1\r\n- Python version: 3.7.12\r\n- OS: Linux-5.4.104+-x86_64-with-Ubuntu-18.04-bionic\r\n- (Optional) Other libraries and their versions: \r\n  - I'm running on colab.\r\n  - `lightgbm==3.2.1`\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nfeature_fraction, val_score: 0.038508:  14%|#4        | 1/7 [00:22<02:13, 22.19s/it][I 2021-09-27 13:46:01,691] Trial 0 finished with value: 0.038507561915105994 and parameters: {'feature_fraction': 0.5}. Best is trial 0 with value: 0.038507561915105994.\r\n\r\n\r\nfeature_fraction, val_score: 0.038508:  14%|#4        | 1/7 [00:22<02:13, 22.19s/it]/usr/local/lib/python3.7/dist-packages/lightgbm/engine.py:532: UserWarning:\r\n\r\nFound `early_stopping` in params. Will use it instead of argument\r\n\r\n[W 2021-09-27 13:46:05,049] Trial 1 failed because of the following error: ValueError('For early stopping, at least one dataset and eval metric is required for evaluation')\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.7/dist-packages/optuna/study/_optimize.py\", line 213, in _run_trial\r\n    value_or_values = func(trial)\r\n  File \"/usr/local/lib/python3.7/dist-packages/optuna/integration/_lightgbm_tuner/optimize.py\", line 320, in __call__\r\n    cv_results = lgb.cv(self.lgbm_params, train_set, **self.lgbm_kwargs)\r\n  File \"/usr/local/lib/python3.7/dist-packages/lightgbm/engine.py\", line 601, in cv\r\n    evaluation_result_list=res))\r\n  File \"/usr/local/lib/python3.7/dist-packages/lightgbm/callback.py\", line 215, in _callback\r\n    _init(env)\r\n  File \"/usr/local/lib/python3.7/dist-packages/lightgbm/callback.py\", line 186, in _init\r\n    raise ValueError('For early stopping, '\r\nValueError: For early stopping, at least one dataset and eval metric is required for evaluation\r\n```\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\nimport optuna.integration.lightgbm as lgb\r\nimport numpy as np\r\nfrom sklearn.model_selection import GroupKFold\r\n\r\nX = np.arange(100).reshape(-1, 1)\r\ny = X.flatten() >= 50\r\ngroup = X.flatten() % 2 == 0\r\n\r\ntrain_data = lgb.Dataset(X, y)\r\n\r\nparams = {\r\n    'objective': 'binary',\r\n    'early_stopping': 1\r\n}\r\n\r\ngkf = GroupKFold(2)\r\n\r\ntuner = lgb.LightGBMTunerCV(\r\n    params, \r\n    train_data,\r\n    folds=gkf.split(X, y, group), \r\n)\r\n\r\ntuner.run()\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2960/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2960/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2947", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2947/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2947/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2947/events", "html_url": "https://github.com/optuna/optuna/pull/2947", "id": 1003937188, "node_id": "PR_kwDOB0okGM4sHhqD", "number": 2947, "title": "Fix method `untransform` of `_SearchSpaceTransform` with `distribution.single() == True`", "user": {"login": "yoshinobc", "id": 33712536, "node_id": "MDQ6VXNlcjMzNzEyNTM2", "avatar_url": "https://avatars.githubusercontent.com/u/33712536?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yoshinobc", "html_url": "https://github.com/yoshinobc", "followers_url": "https://api.github.com/users/yoshinobc/followers", "following_url": "https://api.github.com/users/yoshinobc/following{/other_user}", "gists_url": "https://api.github.com/users/yoshinobc/gists{/gist_id}", "starred_url": "https://api.github.com/users/yoshinobc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yoshinobc/subscriptions", "organizations_url": "https://api.github.com/users/yoshinobc/orgs", "repos_url": "https://api.github.com/users/yoshinobc/repos", "events_url": "https://api.github.com/users/yoshinobc/events{/privacy}", "received_events_url": "https://api.github.com/users/yoshinobc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "Crissman", "id": 4338467, "node_id": "MDQ6VXNlcjQzMzg0Njc=", "avatar_url": "https://avatars.githubusercontent.com/u/4338467?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Crissman", "html_url": "https://github.com/Crissman", "followers_url": "https://api.github.com/users/Crissman/followers", "following_url": "https://api.github.com/users/Crissman/following{/other_user}", "gists_url": "https://api.github.com/users/Crissman/gists{/gist_id}", "starred_url": "https://api.github.com/users/Crissman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Crissman/subscriptions", "organizations_url": "https://api.github.com/users/Crissman/orgs", "repos_url": "https://api.github.com/users/Crissman/repos", "events_url": "https://api.github.com/users/Crissman/events{/privacy}", "received_events_url": "https://api.github.com/users/Crissman/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "Crissman", "id": 4338467, "node_id": "MDQ6VXNlcjQzMzg0Njc=", "avatar_url": "https://avatars.githubusercontent.com/u/4338467?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Crissman", "html_url": "https://github.com/Crissman", "followers_url": "https://api.github.com/users/Crissman/followers", "following_url": "https://api.github.com/users/Crissman/following{/other_user}", "gists_url": "https://api.github.com/users/Crissman/gists{/gist_id}", "starred_url": "https://api.github.com/users/Crissman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Crissman/subscriptions", "organizations_url": "https://api.github.com/users/Crissman/orgs", "repos_url": "https://api.github.com/users/Crissman/repos", "events_url": "https://api.github.com/users/Crissman/events{/privacy}", "received_events_url": "https://api.github.com/users/Crissman/received_events", "type": "User", "site_admin": false}, {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/37", "html_url": "https://github.com/optuna/optuna/milestone/37", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/37/labels", "id": 7016772, "node_id": "MI_kwDOB0okGM4AaxFE", "number": 37, "title": "v2.10.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 44, "state": "closed", "created_at": "2021-07-30T05:54:09Z", "updated_at": "2021-10-04T06:39:13Z", "due_on": null, "closed_at": "2021-10-04T06:39:13Z"}, "comments": 1, "created_at": "2021-09-22T07:30:43Z", "updated_at": "2021-09-28T06:03:55Z", "closed_at": "2021-09-28T05:45:43Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2947", "html_url": "https://github.com/optuna/optuna/pull/2947", "diff_url": "https://github.com/optuna/optuna/pull/2947.diff", "patch_url": "https://github.com/optuna/optuna/pull/2947.patch", "merged_at": "2021-09-28T05:45:43Z"}, "body": "## Motivation\r\nThe current `untransform` method of `_SearchSpaceTransform` uses the higher bound offset logic, but it may return wrong values when `low==high` in `uniformDistribution` and `LogUniformDistribution`.\r\nDetails of this issue are reported in #2945 .\r\n\r\n## Description of the changes\r\n-  Do not apply `min()` when `d.single()==True`.\r\n- Add some tests", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2947/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2947/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2946", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2946/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2946/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2946/events", "html_url": "https://github.com/optuna/optuna/pull/2946", "id": 1003682276, "node_id": "PR_kwDOB0okGM4sGtEa", "number": 2946, "title": "Fix `GridSampler` with `RetryFailedTrialCallback` or `enqueue_trial`", "user": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "Crissman", "id": 4338467, "node_id": "MDQ6VXNlcjQzMzg0Njc=", "avatar_url": "https://avatars.githubusercontent.com/u/4338467?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Crissman", "html_url": "https://github.com/Crissman", "followers_url": "https://api.github.com/users/Crissman/followers", "following_url": "https://api.github.com/users/Crissman/following{/other_user}", "gists_url": "https://api.github.com/users/Crissman/gists{/gist_id}", "starred_url": "https://api.github.com/users/Crissman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Crissman/subscriptions", "organizations_url": "https://api.github.com/users/Crissman/orgs", "repos_url": "https://api.github.com/users/Crissman/repos", "events_url": "https://api.github.com/users/Crissman/events{/privacy}", "received_events_url": "https://api.github.com/users/Crissman/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "Crissman", "id": 4338467, "node_id": "MDQ6VXNlcjQzMzg0Njc=", "avatar_url": "https://avatars.githubusercontent.com/u/4338467?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Crissman", "html_url": "https://github.com/Crissman", "followers_url": "https://api.github.com/users/Crissman/followers", "following_url": "https://api.github.com/users/Crissman/following{/other_user}", "gists_url": "https://api.github.com/users/Crissman/gists{/gist_id}", "starred_url": "https://api.github.com/users/Crissman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Crissman/subscriptions", "organizations_url": "https://api.github.com/users/Crissman/orgs", "repos_url": "https://api.github.com/users/Crissman/repos", "events_url": "https://api.github.com/users/Crissman/events{/privacy}", "received_events_url": "https://api.github.com/users/Crissman/received_events", "type": "User", "site_admin": false}, {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/39", "html_url": "https://github.com/optuna/optuna/milestone/39", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/39/labels", "id": 7208320, "node_id": "MI_kwDOB0okGM4Abf2A", "number": 39, "title": "v3.0.0-a0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 92, "state": "closed", "created_at": "2021-10-01T05:10:48Z", "updated_at": "2022-02-04T05:14:05Z", "due_on": null, "closed_at": "2022-02-04T05:14:05Z"}, "comments": 4, "created_at": "2021-09-22T02:28:15Z", "updated_at": "2021-11-22T08:43:49Z", "closed_at": "2021-10-14T15:53:45Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2946", "html_url": "https://github.com/optuna/optuna/pull/2946", "diff_url": "https://github.com/optuna/optuna/pull/2946.diff", "patch_url": "https://github.com/optuna/optuna/pull/2946.patch", "merged_at": "2021-10-14T15:53:45Z"}, "body": "## Motivation\r\nWhen we use `GridSampler` with `RetryFailedTrialCallback` or `enqueue_trial`, the sampler does not pick up all grids. This PR fixes this behavior by ignoring enqueued trials.\r\n\r\n```python\r\nimport optuna\r\n\r\ndef objective(trial):\r\n    return trial.suggest_float(\"x\", -10, 10)\r\n\r\nsampler = optuna.samplers.GridSampler({\"x\": [-1, 0, 1]})\r\nstudy = optuna.create_study(sampler=sampler)\r\nstudy.enqueue_trial({\"x\": 10})\r\nstudy.optimize(objective)\r\n```\r\n\r\n- master\r\n\r\n```\r\n[I 2021-09-22 11:21:34,761] A new study created in memory with name: no-name-298969ad-d8eb-4cab-a2cf-6ec0cd2b7fde\r\n[I 2021-09-22 11:21:34,762] Trial 0 finished with value: 10.0 and parameters: {'x': 10}. Best is trial 0 with value: 10.0.\r\n[I 2021-09-22 11:21:34,763] Trial 1 finished with value: 1.0 and parameters: {'x': 1}. Best is trial 1 with value: 1.0.\r\n[I 2021-09-22 11:21:34,763] Trial 2 finished with value: -1.0 and parameters: {'x': -1}. Best is trial 2 with value: -1.0.\r\n```\r\n\r\n- PR\r\n\r\n```\r\n[I 2021-09-22 11:21:22,920] A new study created in memory with name: no-name-b2e9c514-7365-467a-8b1b-4be82226a5cd\r\n[I 2021-09-22 11:21:23,345] Trial 0 finished with value: 10.0 and parameters: {'x': 10}. Best is trial 0 with value: 10.0.\r\n[I 2021-09-22 11:21:23,346] Trial 1 finished with value: -1.0 and parameters: {'x': -1}. Best is trial 1 with value: -1.0.\r\n[I 2021-09-22 11:21:23,348] Trial 2 finished with value: 1.0 and parameters: {'x': 1}. Best is trial 1 with value: -1.0.\r\n[I 2021-09-22 11:21:23,350] Trial 3 finished with value: 0.0 and parameters: {'x': 0}. Best is trial 1 with value: -1.0.\r\n```\r\n\r\n## Description of the changes\r\n- Fix `GridSampler` to ignore enqueued trials\r\n- Add tests", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2946/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2946/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2945", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2945/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2945/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2945/events", "html_url": "https://github.com/optuna/optuna/issues/2945", "id": 1002041277, "node_id": "I_kwDOB0okGM47ue-9", "number": 2945, "title": "`_SearchSpaceTransform` not expecting float distributions where `low == high`", "user": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-09-21T08:23:20Z", "updated_at": "2021-09-28T06:04:24Z", "closed_at": "2021-09-28T06:04:09Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n## Expected behavior\r\n\r\nThe higher bound offset logic introduced to the untransformation in `_SearchSpaceTransform` in https://github.com/optuna/optuna/pull/2243 may not be applied for float distributions where `low == high`, i.e. when those distributions are \"single\" (`BaseDistribution.single() == True`). \r\n\r\n## Steps to reproduce\r\n\r\n1. Run the following example. Notice that an assertion error is raised.\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\n    search_space = {\r\n        \"x0\": UniformDistribution(1, 1),  # `low == high`\r\n        \"x1\": LogUniformDistribution(2, 2),\r\n    }\r\n\r\n    params = {\r\n        \"x0\": 1.0,\r\n        \"x1\": 2.0,\r\n    }\r\n\r\n    trans = _SearchSpaceTransform(search_space)\r\n    trans_params = trans.transform(params)\r\n    untrans_params = trans.untransform(trans_params)\r\n\r\n\r\n    for name in params.keys():\r\n        assert untrans_params[name] == params[name]  # Fails, but shouldn't.\r\n```\r\n\r\n## Additional context (optional)\r\n\r\nThe most simple solution is to apply `nextafter` only if the distribution is not \"single\". Alternative is to prohibit \"single\" distributions in `_SearchSpaceTransform`.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2945/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2945/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2931", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2931/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2931/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2931/events", "html_url": "https://github.com/optuna/optuna/pull/2931", "id": 998293604, "node_id": "PR_kwDOB0okGM4r133V", "number": 2931, "title": "Validate `FrozenTrial.values`", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562567, "node_id": "MDU6TGFiZWwxOTQ3NTYyNTY3", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.trial", "name": "optuna.trial", "color": "1c659e", "default": false, "description": "Related to the `optuna.trial` submodule. This is automatically labeled by github-actions."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2021-09-16T14:39:12Z", "updated_at": "2022-01-20T23:05:34Z", "closed_at": "2022-01-20T23:05:34Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": true, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2931", "html_url": "https://github.com/optuna/optuna/pull/2931", "diff_url": "https://github.com/optuna/optuna/pull/2931.diff", "patch_url": "https://github.com/optuna/optuna/pull/2931.patch", "merged_at": null}, "body": "## Motivation\r\n\r\nThis PR Addresses #2929.\r\n\r\n## Description of the changes\r\n\r\nUsers use `optuna.create_trial` to create `FrozenTrial` instances and it calls `FrozenTrial._validate`. So, I added the value checking to `FrozenTrial._validate` instead of the setter of `FrozenTrial.values`.\r\n\r\n- Check `FrozenTrial.values` in `FrozenTrial._validate`.\r\n- Add test cases for `FrozenTrial.values`.\r\n\r\nAlternatively, we can check then in . I think ", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2931/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2931/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2929", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2929/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2929/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2929/events", "html_url": "https://github.com/optuna/optuna/issues/2929", "id": 997944198, "node_id": "I_kwDOB0okGM47e2uG", "number": 2929, "title": "`optuna.create_trial` generates infeasible trials if multiple values are set to `value`", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-09-16T08:42:08Z", "updated_at": "2022-02-02T23:05:28Z", "closed_at": "2022-02-02T23:05:28Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n## Expected behavior\r\n\r\nI expect `optuna.create_trial` will raise errors if I set `value=(1, 2)` because I should use the `values` argument instead of `value`. I think the error will be `ValueError` since the input value is inappropriate.\r\n\r\n## Environment\r\n\r\n<!--\r\nYou can get this information by typing the following:\r\n```\r\npython -c 'import optuna; print(optuna.__version__)'\r\npython -c 'import platform; print(platform.python_version())'\r\npython -c 'import platform; print(platform.platform())'\r\n```\r\n-->\r\n\r\n- Optuna version: 2.10.0.dev\r\n- Python version: 3.8.10\r\n- OS: Linux-4.19.128-microsoft-standard-x86_64-with-glibc2.29\r\n\r\n## Error messages, stack traces, or logs\r\n\r\nTthe current optuna generates the infeasible trial whose `values` is `[(1, 2)]` as follows: \r\n\r\n```console\r\n>>> import optuna\r\n>>> optuna.create_trial(value=(1, 2))\r\nFrozenTrial(number=-1, values=[(1, 2)], datetime_start=datetime.datetime(2021, 9, 16, 17, 19, 44, 238726), datetime_complete=datetime.datetime(2021, 9, 16, 17, 19, 44, 238726), params={}, distributions={}, user_attrs={}, system_attrs={}, intermediate_values={}, trial_id=-1, state=TrialState.COMPLETE, value=None)\r\n```\r\n\r\nI think it should raise `ValueError`. Alternatively, the `values` should be `[1, 2]` if Optuna does not raise the error.\r\n\r\n```console\r\n>>> optuna.create_trial(values=(1, 2))\r\nFrozenTrial(number=-1, values=[1, 2], datetime_start=datetime.datetime(2021, 9, 16, 17, 21, 31, 123218), datetime_complete=datetime.datetime(2021, 9, 16, 17, 21, 31, 123218), params={}, distributions={}, user_attrs={}, system_attrs={}, intermediate_values={}, trial_id=-1, state=TrialState.COMPLETE, value=None)\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Run `python -c 'import optuna; print(optuna.create_trial(value=(1,2)))'`\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2929/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2929/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2897", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2897/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2897/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2897/events", "html_url": "https://github.com/optuna/optuna/pull/2897", "id": 986294931, "node_id": "MDExOlB1bGxSZXF1ZXN0NzI1NTE2MTcw", "number": 2897, "title": "Add tests of `sample_relative` and fix type of return values of `SkoptSampler` and `PyCmaSampler`", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561256, "node_id": "MDU6TGFiZWwxOTQ3NTYxMjU2", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.integration", "name": "optuna.integration", "color": "1c659e", "default": false, "description": "Related to the `optuna.integration` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/39", "html_url": "https://github.com/optuna/optuna/milestone/39", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/39/labels", "id": 7208320, "node_id": "MI_kwDOB0okGM4Abf2A", "number": 39, "title": "v3.0.0-a0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 92, "state": "closed", "created_at": "2021-10-01T05:10:48Z", "updated_at": "2022-02-04T05:14:05Z", "due_on": null, "closed_at": "2022-02-04T05:14:05Z"}, "comments": 6, "created_at": "2021-09-02T07:33:05Z", "updated_at": "2021-12-03T05:42:51Z", "closed_at": "2021-10-01T06:56:07Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2897", "html_url": "https://github.com/optuna/optuna/pull/2897", "diff_url": "https://github.com/optuna/optuna/pull/2897.diff", "patch_url": "https://github.com/optuna/optuna/pull/2897.patch", "merged_at": "2021-10-01T06:56:06Z"}, "body": "## Motivation\r\n\r\nCurrently, tests of the `sample_relative` methods are missing in `tests/sampler_tests/test_sampler.py` while the `sample_independent` methods are tested in it. I think this is because only a few samplers implemented `sample_relative` when we introduced `sample_relative` and each sampler with `sample_relative` tested it in the individual test file (i.e., `tests/sampler_tests/test_cmaes.py`).\r\n\r\nNow that multiple samplers implement `sample_relative`, I think we can introduce the test cases for `sample_relative` to `tests/sampler_tests/test_sampler.py`.\r\n\r\n\r\n## Description of the changes\r\n\r\n- Add test cases of `sample_relative` for `TPESampler(multivariate=True)`, `CmaEsSampler`, `SkoptSampler` and `PyCmaSampler`.\r\n- Fix type of return values of `SkoptSampler` and `PyCmaSampler`.\r\n  - This type checking can be seen in the test cases of `sample_independent`.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2897/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2897/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2879", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2879/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2879/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2879/events", "html_url": "https://github.com/optuna/optuna/pull/2879", "id": 981615879, "node_id": "MDExOlB1bGxSZXF1ZXN0NzIxNjI4Nzkw", "number": 2879, "title": "Hyperband no longer assumes it is the only pruner", "user": {"login": "cowwoc", "id": 633348, "node_id": "MDQ6VXNlcjYzMzM0OA==", "avatar_url": "https://avatars.githubusercontent.com/u/633348?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cowwoc", "html_url": "https://github.com/cowwoc", "followers_url": "https://api.github.com/users/cowwoc/followers", "following_url": "https://api.github.com/users/cowwoc/following{/other_user}", "gists_url": "https://api.github.com/users/cowwoc/gists{/gist_id}", "starred_url": "https://api.github.com/users/cowwoc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cowwoc/subscriptions", "organizations_url": "https://api.github.com/users/cowwoc/orgs", "repos_url": "https://api.github.com/users/cowwoc/repos", "events_url": "https://api.github.com/users/cowwoc/events{/privacy}", "received_events_url": "https://api.github.com/users/cowwoc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561539, "node_id": "MDU6TGFiZWwxOTQ3NTYxNTM5", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.pruners", "name": "optuna.pruners", "color": "1c659e", "default": false, "description": "Related to the `optuna.pruners` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/37", "html_url": "https://github.com/optuna/optuna/milestone/37", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/37/labels", "id": 7016772, "node_id": "MI_kwDOB0okGM4AaxFE", "number": 37, "title": "v2.10.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 44, "state": "closed", "created_at": "2021-07-30T05:54:09Z", "updated_at": "2021-10-04T06:39:13Z", "due_on": null, "closed_at": "2021-10-04T06:39:13Z"}, "comments": 7, "created_at": "2021-08-27T21:41:03Z", "updated_at": "2021-10-01T05:09:25Z", "closed_at": "2021-08-31T13:40:08Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2879", "html_url": "https://github.com/optuna/optuna/pull/2879", "diff_url": "https://github.com/optuna/optuna/pull/2879.diff", "patch_url": "https://github.com/optuna/optuna/pull/2879.patch", "merged_at": "2021-08-31T13:40:07Z"}, "body": "Fixes #2878", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2879/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2879/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2878", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2878/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2878/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2878/events", "html_url": "https://github.com/optuna/optuna/issues/2878", "id": 981608163, "node_id": "MDU6SXNzdWU5ODE2MDgxNjM=", "number": 2878, "title": "HyperbandPruner incorrectly assumes it is the only pruner", "user": {"login": "cowwoc", "id": 633348, "node_id": "MDQ6VXNlcjYzMzM0OA==", "avatar_url": "https://avatars.githubusercontent.com/u/633348?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cowwoc", "html_url": "https://github.com/cowwoc", "followers_url": "https://api.github.com/users/cowwoc/followers", "following_url": "https://api.github.com/users/cowwoc/following{/other_user}", "gists_url": "https://api.github.com/users/cowwoc/gists{/gist_id}", "starred_url": "https://api.github.com/users/cowwoc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cowwoc/subscriptions", "organizations_url": "https://api.github.com/users/cowwoc/orgs", "repos_url": "https://api.github.com/users/cowwoc/repos", "events_url": "https://api.github.com/users/cowwoc/events{/privacy}", "received_events_url": "https://api.github.com/users/cowwoc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-08-27T21:24:52Z", "updated_at": "2021-08-31T13:40:07Z", "closed_at": "2021-08-31T13:40:07Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "If you take the `MultiplePruners` code from https://github.com/optuna/optuna/issues/2042#issuecomment-731515468 and create a study with `pruner=MultiplePruners([first, second, optuna.pruners.HyperbandPruner()])`\r\n\r\nthen you will end up with the following error at runtime:\r\n\r\n```\r\n[...]\r\n  File \"C:\\Users\\Gili\\Documents\\myproject\\python\\lib\\site-packages\\optuna\\pruners\\_hyperband.py\", line 177, in prune\r\n    return self._pruners[bracket_id].prune(bracket_study, trial)\r\n  File \"C:\\Users\\Gili\\Documents\\myproject\\python\\lib\\site-packages\\optuna\\pruners\\_successive_halving.py\", line 192, in prune\r\n    trials = study.get_trials(deepcopy=False)\r\n  File \"C:\\Users\\Gili\\Documents\\myproject\\python\\lib\\site-packages\\optuna\\pruners\\_hyperband.py\", line 304, in get_trials\r\n    assert isinstance(pruner, HyperbandPruner)\r\nAssertionError\r\n```\r\n\r\nThe problem is that `hyperband._BracketStudy.get_trials()` incorrectly assumes that `study.getPruner()` will return the hyperband but in fact it returns the `MultiplePruners` instance. You can probably fix this by passing a reference of the pruner into `_BracketStudy`'s constructor and then using it in `_BracketStudy.get_trials()`.\r\n\r\n## Environment\r\n\r\noptuna version is 2.9.1\r\npython version 3.9.0\r\nMicrosoft Windows [Version 10.0.19043.1165]", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2878/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2878/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2874", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2874/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2874/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2874/events", "html_url": "https://github.com/optuna/optuna/issues/2874", "id": 980370757, "node_id": "MDU6SXNzdWU5ODAzNzA3NTc=", "number": 2874, "title": "Not able to import Optuna library - Import Error", "user": {"login": "Avishnaredi77", "id": 54072462, "node_id": "MDQ6VXNlcjU0MDcyNDYy", "avatar_url": "https://avatars.githubusercontent.com/u/54072462?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Avishnaredi77", "html_url": "https://github.com/Avishnaredi77", "followers_url": "https://api.github.com/users/Avishnaredi77/followers", "following_url": "https://api.github.com/users/Avishnaredi77/following{/other_user}", "gists_url": "https://api.github.com/users/Avishnaredi77/gists{/gist_id}", "starred_url": "https://api.github.com/users/Avishnaredi77/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Avishnaredi77/subscriptions", "organizations_url": "https://api.github.com/users/Avishnaredi77/orgs", "repos_url": "https://api.github.com/users/Avishnaredi77/repos", "events_url": "https://api.github.com/users/Avishnaredi77/events{/privacy}", "received_events_url": "https://api.github.com/users/Avishnaredi77/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-08-26T15:21:35Z", "updated_at": "2021-09-20T08:01:22Z", "closed_at": "2021-09-20T08:01:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "So, I am trying to work with the optuna library for a Bayesian regression problem. However, I am not able to import it into my python code.\r\nI have reproduced the error I am facing here.\r\n\r\nImportError Traceback (most recent call last)\r\nin\r\n6 from multiprocessing import Process, Queue\r\n7 import pandas as pd\r\n----> 8 import optuna\r\n9 import matplotlib.pyplot as plt\r\n10 from matplotlib.gridspec import GridSpec\r\n\r\nC:\\ProgramData\\Anaconda3\\lib\\site-packages\\optuna_init_.py in\r\n1 from optuna import config # NOQA\r\n----> 2 from optuna import dashboard # NOQA\r\n3 from optuna import distributions # NOQA\r\n4 from optuna import integration # NOQA\r\n5 from optuna import logging # NOQA\r\n\r\nC:\\ProgramData\\Anaconda3\\lib\\site-packages\\optuna\\dashboard.py in\r\n20 import optuna.logging\r\n21 import optuna.structs\r\n---> 22 import optuna.study\r\n23 from optuna import types\r\n24\r\n\r\nC:\\ProgramData\\Anaconda3\\lib\\site-packages\\optuna\\study_init_.py in\r\n----> 1 from optuna._callbacks import MaxTrialsCallback\r\n2 from optuna.study._study_direction import StudyDirection\r\n3 from optuna.study._study_summary import StudySummary\r\n4 from optuna.study.study import BaseStudy\r\n5 from optuna.study.study import copy_study\r\n\r\nC:\\ProgramData\\Anaconda3\\lib\\site-packages\\optuna_callbacks.py in\r\n4 import optuna\r\n5 from optuna._experimental import experimental\r\n----> 6 from optuna.trial import FrozenTrial\r\n7 from optuna.trial import TrialState\r\n8\r\n\r\nC:\\ProgramData\\Anaconda3\\lib\\site-packages\\optuna\\trial_init_.py in\r\n----> 1 from optuna.trial._base import BaseTrial\r\n2 from optuna.trial._fixed import FixedTrial\r\n3 from optuna.trial._frozen import create_trial\r\n4 from optuna.trial._frozen import FrozenTrial\r\n5 from optuna.trial._state import TrialState\r\n\r\nC:\\ProgramData\\Anaconda3\\lib\\site-packages\\optuna\\trial_base.py in\r\n7\r\n8 from optuna.distributions import BaseDistribution\r\n----> 9 from optuna.distributions import CategoricalChoiceType\r\n10\r\n11\r\n\r\nImportError: cannot import name 'CategoricalChoiceType' from 'optuna.distributions' (C:\\ProgramData\\Anaconda3\\lib\\site-packages\\optuna\\distributions.py)\r\n\r\nEnvironment\r\nI am using Windows 10, and working on Jupyter Notebook, as well as using latest versions of both.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2874/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2874/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2864", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2864/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2864/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2864/events", "html_url": "https://github.com/optuna/optuna/issues/2864", "id": 974991232, "node_id": "MDU6SXNzdWU5NzQ5OTEyMzI=", "number": 2864, "title": "same hyperparameters are chosen again and again even if the training was failed ", "user": {"login": "ofiryaish", "id": 17110771, "node_id": "MDQ6VXNlcjE3MTEwNzcx", "avatar_url": "https://avatars.githubusercontent.com/u/17110771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ofiryaish", "html_url": "https://github.com/ofiryaish", "followers_url": "https://api.github.com/users/ofiryaish/followers", "following_url": "https://api.github.com/users/ofiryaish/following{/other_user}", "gists_url": "https://api.github.com/users/ofiryaish/gists{/gist_id}", "starred_url": "https://api.github.com/users/ofiryaish/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ofiryaish/subscriptions", "organizations_url": "https://api.github.com/users/ofiryaish/orgs", "repos_url": "https://api.github.com/users/ofiryaish/repos", "events_url": "https://api.github.com/users/ofiryaish/events{/privacy}", "received_events_url": "https://api.github.com/users/ofiryaish/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-08-19T19:46:33Z", "updated_at": "2021-08-27T10:45:07Z", "closed_at": "2021-08-27T10:45:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\n\r\nI training to use Optuna to optimize my TensorFlow model. The problem is that for some hyperparameters, the training is failing, and therefore I'm getting for example:\r\n`Trial 3 failed because of the following error: InternalError()`\r\n(The problem was that I didn't have enough memory in the GPU for this run)\r\n\r\nI was thinking that if it failed to run the model with those hyperparameters, then Optuna will deliver new hyperparameters, but it keeps creating the same hyperparameters, and therefore I'm getting the error above again and again. Is anything can be done?\r\n\r\n- Optuna version: 2.1.0\r\n- Python version: 3.6.6\r\n- OS: Linux-3.10.0-1160.25.1.el7.x86_64-x86_64-with-centos-7.9.2009-Core\r\n\r\nThank you,\r\nOfir\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2864/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2864/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2859", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2859/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2859/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2859/events", "html_url": "https://github.com/optuna/optuna/issues/2859", "id": 971612361, "node_id": "MDU6SXNzdWU5NzE2MTIzNjE=", "number": 2859, "title": "Ticklabels too small / not consistent using matplotlib.plot_contour", "user": {"login": "andife", "id": 20612932, "node_id": "MDQ6VXNlcjIwNjEyOTMy", "avatar_url": "https://avatars.githubusercontent.com/u/20612932?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andife", "html_url": "https://github.com/andife", "followers_url": "https://api.github.com/users/andife/followers", "following_url": "https://api.github.com/users/andife/following{/other_user}", "gists_url": "https://api.github.com/users/andife/gists{/gist_id}", "starred_url": "https://api.github.com/users/andife/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andife/subscriptions", "organizations_url": "https://api.github.com/users/andife/orgs", "repos_url": "https://api.github.com/users/andife/repos", "events_url": "https://api.github.com/users/andife/events{/privacy}", "received_events_url": "https://api.github.com/users/andife/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-08-16T10:55:39Z", "updated_at": "2021-08-16T12:28:45Z", "closed_at": "2021-08-16T12:24:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "The x/yticklabel size in the Contour_plot is not consistent. It is smaller at the images 2,3, 5,6\r\nwhen is image is composed of three variables and visualized as\r\n\r\n1 2 3\r\n4 5 6\r\n7 8 9\r\n\r\n## Expected behavior\r\n\r\nAll labels should have the same size\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\n## Environment\r\n\r\n<!--\r\nYou can get this information by typing the following:\r\n```\r\npython -c 'import optuna; print(optuna.__version__)'\r\npython -c 'import platform; print(platform.python_version())'\r\npython -c 'import platform; print(platform.platform())'\r\n```\r\n-->\r\n\r\n- Optuna version: 2.9.1\r\n- Python version:\r\n- OS:\r\n- (Optional) Other libraries and their versions:\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n# error messages, stack traces, or logs\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1.\r\n2.\r\n3.\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\n# python code\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n![labelsize_optuna](https://user-images.githubusercontent.com/20612932/129552796-3d80c9ca-adf3-4349-bbb7-edf4e88b1762.PNG)\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2859/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2859/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2858", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2858/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2858/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2858/events", "html_url": "https://github.com/optuna/optuna/issues/2858", "id": 971605244, "node_id": "MDU6SXNzdWU5NzE2MDUyNDQ=", "number": 2858, "title": "Visualization (plot_contou) different after upgrading db from optuna 2.4 to 2.9.1", "user": {"login": "andife", "id": 20612932, "node_id": "MDQ6VXNlcjIwNjEyOTMy", "avatar_url": "https://avatars.githubusercontent.com/u/20612932?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andife", "html_url": "https://github.com/andife", "followers_url": "https://api.github.com/users/andife/followers", "following_url": "https://api.github.com/users/andife/following{/other_user}", "gists_url": "https://api.github.com/users/andife/gists{/gist_id}", "starred_url": "https://api.github.com/users/andife/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andife/subscriptions", "organizations_url": "https://api.github.com/users/andife/orgs", "repos_url": "https://api.github.com/users/andife/repos", "events_url": "https://api.github.com/users/andife/events{/privacy}", "received_events_url": "https://api.github.com/users/andife/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-08-16T10:45:49Z", "updated_at": "2021-08-16T10:58:32Z", "closed_at": "2021-08-16T10:58:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\nUpgrading the sqlite db from optuna 2.4 to 2.9.1 results in a different visualization using\r\noptuna.visualization.matplotlib.plot_contour(study)\r\n\r\n## Expected behavior\r\n\r\nThe images should look quite similiar\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\n## Environment\r\n\r\n<!--\r\nYou can get this information by typing the following:\r\n```\r\npython -c 'import optuna; print(optuna.__version__)'\r\npython -c 'import platform; print(platform.python_version())'\r\npython -c 'import platform; print(platform.platform())'\r\n```\r\n-->\r\n\r\n- Optuna version: 2.9.1 (2.4)\r\n\r\n\r\n- Python version:\r\n- OS: ubuntu 18.04\r\n- (Optional) Other libraries and their versions:\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n# error messages, stack traces, or logs\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1.\r\n2.\r\n3.\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\n# python code\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n![optuna_bug](https://user-images.githubusercontent.com/20612932/129552001-de581b1b-fe55-4bd0-995b-654d9378e3ba.PNG)\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2858/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2858/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2854", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2854/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2854/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2854/events", "html_url": "https://github.com/optuna/optuna/issues/2854", "id": 970761328, "node_id": "MDU6SXNzdWU5NzA3NjEzMjg=", "number": 2854, "title": "Running consecutive studies with CategoricalDistribution results in ValueError", "user": {"login": "eric-tc-wong", "id": 85085599, "node_id": "MDQ6VXNlcjg1MDg1NTk5", "avatar_url": "https://avatars.githubusercontent.com/u/85085599?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eric-tc-wong", "html_url": "https://github.com/eric-tc-wong", "followers_url": "https://api.github.com/users/eric-tc-wong/followers", "following_url": "https://api.github.com/users/eric-tc-wong/following{/other_user}", "gists_url": "https://api.github.com/users/eric-tc-wong/gists{/gist_id}", "starred_url": "https://api.github.com/users/eric-tc-wong/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eric-tc-wong/subscriptions", "organizations_url": "https://api.github.com/users/eric-tc-wong/orgs", "repos_url": "https://api.github.com/users/eric-tc-wong/repos", "events_url": "https://api.github.com/users/eric-tc-wong/events{/privacy}", "received_events_url": "https://api.github.com/users/eric-tc-wong/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2021-08-13T23:16:43Z", "updated_at": "2021-12-08T23:05:32Z", "closed_at": "2021-12-08T23:05:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "I run a study for a regression model and then a study for classification, and it seems that the classification study was somehow exposed to values used in the first study. After a random number of trials, I get the error \u201cValueError: CategoricalDistribution does not support dynamic value space.\u201d\r\nThe error is from the categorical value check in distributions.py:\r\n```python\r\n    if dist_old.choices != dist_new.choices:\r\n        raise ValueError(\r\n            CategoricalDistribution.__name__ + \" does not support dynamic value space.\"\r\n        )\r\n```\r\nI printed out the old and new choices:\r\n```python\r\nprint(f'old: {dist_old.choices} new: {dist_new.choices}')\r\n```\r\nOuput:\r\n\told: ('MSELoss', 'L1Loss', 'HuberLoss') new: ('NLLLoss', 'MultiMarginLoss')\r\nThe new values are classification loss function names, while the old ones are for regression. This is odd because it only occurs after some number of trials. If my code somehow switches to regression loss, then the regression loss should be in the variable \u201cdist_new\u201d and not \u201cdist_old\u201d.\r\n\r\nAny idea why this could happen? Is there a need to somehow clean up the previous study before starting a new one?\r\n\r\nThanks!\r\n\r\n\r\n\r\n\r\n## Expected behavior\r\n\r\ndist_old == dist_new\r\n\r\n## Environment\r\n\r\n(Colab)\r\n- Optuna version: 2.9.1\r\n- Python version: 2.9.1\r\n- OS: Ubuntu 18.04.5\r\n- (Optional) Other libraries and their versions:\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-23-af9934efe4ca> in <module>()\r\n     49                                           no_trial_save=False,#Note!, be false to save trial history\r\n     50                                           dloader_params=dloader_params,\r\n---> 51                                           **hyper_obj_params), n_trials=unfished_trials, timeout=17000)#n_trials=120\r\n     52 print(\"--- %s seconds ---\" % (time.time() - start_time))\r\n     53 \r\n\r\n9 frames\r\n/usr/local/lib/python3.7/dist-packages/optuna/study/study.py in optimize(self, func, n_trials, timeout, n_jobs, catch, callbacks, gc_after_trial, show_progress_bar)\r\n    407             callbacks=callbacks,\r\n    408             gc_after_trial=gc_after_trial,\r\n--> 409             show_progress_bar=show_progress_bar,\r\n    410         )\r\n    411 \r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/study/_optimize.py in _optimize(study, func, n_trials, timeout, n_jobs, catch, callbacks, gc_after_trial, show_progress_bar)\r\n     74                 reseed_sampler_rng=False,\r\n     75                 time_start=None,\r\n---> 76                 progress_bar=progress_bar,\r\n     77             )\r\n     78         else:\r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/study/_optimize.py in _optimize_sequential(study, func, n_trials, timeout, catch, callbacks, gc_after_trial, reseed_sampler_rng, time_start, progress_bar)\r\n    161 \r\n    162         try:\r\n--> 163             trial = _run_trial(study, func, catch)\r\n    164         except Exception:\r\n    165             raise\r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/study/_optimize.py in _run_trial(study, func, catch)\r\n    262 \r\n    263     if state == TrialState.FAIL and func_err is not None and not isinstance(func_err, catch):\r\n--> 264         raise func_err\r\n    265     return trial\r\n    266 \r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/study/_optimize.py in _run_trial(study, func, catch)\r\n    211 \r\n    212     try:\r\n--> 213         value_or_values = func(trial)\r\n    214     except exceptions.TrialPruned as e:\r\n    215         # TODO(mamu): Handle multi-objective cases.\r\n\r\n<ipython-input-11-4bcb0433f52b> in objective(trial)\r\n     39         lr = trial.suggest_float(\"lr\", 1e-5, 1e-1, log=True)\r\n     40 \r\n---> 41         loss_name = trial.suggest_categorical(\"loss\", loss_categories)\r\n     42         loss = getattr(nn, loss_name)()\r\n     43 \r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/trial/_trial.py in suggest_categorical(self, name, choices)\r\n    503         # CategoricalDistribution does not support dynamic value space.\r\n    504 \r\n--> 505         return self._suggest(name, CategoricalDistribution(choices=choices))\r\n    506 \r\n    507     def report(self, value: float, step: int) -> None:\r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/trial/_trial.py in _suggest(self, name, distribution)\r\n    713             elif distribution.single():\r\n    714                 param_value = distributions._get_single_value(distribution)\r\n--> 715             elif self._is_relative_param(name, distribution):\r\n    716                 param_value = self.relative_params[name]\r\n    717             else:\r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/trial/_trial.py in _is_relative_param(self, name, distribution)\r\n    758 \r\n    759         relative_distribution = self.relative_search_space[name]\r\n--> 760         distributions.check_distribution_compatibility(relative_distribution, distribution)\r\n    761 \r\n    762         param_value = self.relative_params[name]\r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/distributions.py in check_distribution_compatibility(dist_old, dist_new)\r\n    529     if dist_old.choices != dist_new.choices:\r\n    530         raise ValueError(\r\n--> 531             CategoricalDistribution.__name__ + \" does not support dynamic value space.\"\r\n    532         )\r\n    533 \r\n\r\nValueError: CategoricalDistribution does not support dynamic value space.\r\n```\r\n\r\n## Steps to reproduce\r\n\r\nThe error occurs after a random number of trials, so I don't have reproducible code.\r\n\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\n# python code\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2854/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2854/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2853", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2853/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2853/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2853/events", "html_url": "https://github.com/optuna/optuna/issues/2853", "id": 970503119, "node_id": "MDU6SXNzdWU5NzA1MDMxMTk=", "number": 2853, "title": "NSGA2 _collect_parent_population picking up pruned trials", "user": {"login": "TalhaAsmal", "id": 224751, "node_id": "MDQ6VXNlcjIyNDc1MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/224751?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TalhaAsmal", "html_url": "https://github.com/TalhaAsmal", "followers_url": "https://api.github.com/users/TalhaAsmal/followers", "following_url": "https://api.github.com/users/TalhaAsmal/following{/other_user}", "gists_url": "https://api.github.com/users/TalhaAsmal/gists{/gist_id}", "starred_url": "https://api.github.com/users/TalhaAsmal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TalhaAsmal/subscriptions", "organizations_url": "https://api.github.com/users/TalhaAsmal/orgs", "repos_url": "https://api.github.com/users/TalhaAsmal/repos", "events_url": "https://api.github.com/users/TalhaAsmal/events{/privacy}", "received_events_url": "https://api.github.com/users/TalhaAsmal/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-08-13T15:27:03Z", "updated_at": "2021-09-12T13:36:13Z", "closed_at": "2021-09-12T13:36:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\nWhen running Optuna with multiple objectives (2 in my case), the NSGA2 sampler picks up pruned trials of previous generations, resulting in failure in `_dominates` due to the `trial.values` being `None`\r\n\r\n## Expected behavior\r\n\r\nThe parent selection and subsequent parameter selection to work without throwing an error\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\n## Environment\r\n\r\n<!--\r\nYou can get this information by typing the following:\r\n```\r\npython -c 'import optuna; print(optuna.__version__)'\r\npython -c 'import platform; print(platform.python_version())'\r\npython -c 'import platform; print(platform.platform())'\r\n```\r\n-->\r\n\r\n- Optuna version: 2.9.1\r\n- Python version: 3.6.8\r\n- OS: Windows-10-10.0.19041-SP0\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"K:\\python_virtual_envs\\numerai\\lib\\site-packages\\optuna\\study\\_optimize.py\", line 76, in _optimize\r\n    progress_bar=progress_bar,\r\n  File \"K:\\python_virtual_envs\\numerai\\lib\\site-packages\\optuna\\study\\_optimize.py\", line 163, in _optimize_sequential\r\n    trial = _run_trial(study, func, catch)\r\n  File \"K:\\python_virtual_envs\\numerai\\lib\\site-packages\\optuna\\study\\_optimize.py\", line 194, in _run_trial\r\n    trial = study.ask()\r\n  File \"K:\\python_virtual_envs\\numerai\\lib\\site-packages\\optuna\\study\\study.py\", line 486, in ask\r\n    trial = trial_module.Trial(self, trial_id)\r\n  File \"K:\\python_virtual_envs\\numerai\\lib\\site-packages\\optuna\\trial\\_trial.py\", line 57, in __init__\r\n    self._init_relative_params()\r\n  File \"K:\\python_virtual_envs\\numerai\\lib\\site-packages\\optuna\\trial\\_trial.py\", line 67, in _init_relative_params\r\n    study, trial, self.relative_search_space\r\n  File \"K:\\python_virtual_envs\\numerai\\lib\\site-packages\\optuna\\samplers\\_nsga2.py\", line 161, in sample_relative\r\n    study, [t for t in parent_population if t._trial_id != p0._trial_id]\r\n  File \"K:\\python_virtual_envs\\numerai\\lib\\site-packages\\optuna\\samplers\\_nsga2.py\", line 302, in _select_parent\r\n    if dominates(candidate0, candidate1, study.directions):\r\n  File \"K:\\python_virtual_envs\\numerai\\lib\\site-packages\\optuna\\study\\_multi_objective.py\", line 68, in _dominates\r\n    assert values0 is not None\r\nAssertionError\r\npython-BaseException\r\n\r\nProcess finished with exit code 1\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Use multi-objective optimizer\r\n2. Have pruned trials\r\n3. Run study.optimize() until failure\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\n# python code\r\n```\r\n\r\n## Additional context (optional)\r\n\r\nI'm not 100% sure, but I believe the root issue may be that pruned trials are being added to the list of `nsga2:population:<cache_key>` values in study_system_attributes table. This is then pulled in `NSGAIISampler._collect_parent_population()`  (_nsga2.py line 253) \r\n\r\nNot sure what the impact would be, but a potential fix is to amend line 258 to:\r\n`population = [trials[n] for n in cached_population_numbers if trials[n].state == optuna.trial.TrialState.COMPLETE]`\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2853/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2853/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2850", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2850/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2850/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2850/events", "html_url": "https://github.com/optuna/optuna/issues/2850", "id": 963568654, "node_id": "MDU6SXNzdWU5NjM1Njg2NTQ=", "number": 2850, "title": "Missing assertion error when trying to store inf/NaN value in hyperparameter DB", "user": {"login": "jkterry1", "id": 19422700, "node_id": "MDQ6VXNlcjE5NDIyNzAw", "avatar_url": "https://avatars.githubusercontent.com/u/19422700?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jkterry1", "html_url": "https://github.com/jkterry1", "followers_url": "https://api.github.com/users/jkterry1/followers", "following_url": "https://api.github.com/users/jkterry1/following{/other_user}", "gists_url": "https://api.github.com/users/jkterry1/gists{/gist_id}", "starred_url": "https://api.github.com/users/jkterry1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jkterry1/subscriptions", "organizations_url": "https://api.github.com/users/jkterry1/orgs", "repos_url": "https://api.github.com/users/jkterry1/repos", "events_url": "https://api.github.com/users/jkterry1/events{/privacy}", "received_events_url": "https://api.github.com/users/jkterry1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-08-09T01:20:32Z", "updated_at": "2021-08-09T12:26:57Z", "closed_at": "2021-08-09T12:26:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "So I use Optuna for optimizing deep RL things. For a variety of reasons, deep RL is very unstable and often very numerically unstable and often results in infinities and NaNs with bad hyperparameters (which you find a lot of during hyperparameter optimization). I accidentally tried to store an inf in my database during distributed tuning, except SQL databases generally cannot store infs or NaNs, and that resulted in an absolutely massive error message that was very hard to parse out, and I'm even still somewhat unclear on what specific value I was trying to store that was inf. It seems like a reasonable and useful feature for Optuna to just catch these errors before sending the values to the SQL database and produce a reasonable error message, and I'm fairly surprised Optuna does not already have this. An example error message of this and so on is available in this issue in a downstream package that depends on Optuna:\r\n\r\nhttps://github.com/DLR-RM/rl-baselines3-zoo/issues/146", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2850/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2850/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2846", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2846/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2846/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2846/events", "html_url": "https://github.com/optuna/optuna/pull/2846", "id": 961456555, "node_id": "MDExOlB1bGxSZXF1ZXN0NzA0Mzg5MTcz", "number": 2846, "title": "Fix `datetime_complete` in `_CachedStorage`", "user": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/37", "html_url": "https://github.com/optuna/optuna/milestone/37", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/37/labels", "id": 7016772, "node_id": "MI_kwDOB0okGM4AaxFE", "number": 37, "title": "v2.10.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 44, "state": "closed", "created_at": "2021-07-30T05:54:09Z", "updated_at": "2021-10-04T06:39:13Z", "due_on": null, "closed_at": "2021-10-04T06:39:13Z"}, "comments": 2, "created_at": "2021-08-05T05:25:25Z", "updated_at": "2021-08-06T13:49:20Z", "closed_at": "2021-08-06T13:46:05Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2846", "html_url": "https://github.com/optuna/optuna/pull/2846", "diff_url": "https://github.com/optuna/optuna/pull/2846.diff", "patch_url": "https://github.com/optuna/optuna/pull/2846.patch", "merged_at": "2021-08-06T13:46:05Z"}, "body": "## Motivation\r\nThe cached `datetime_complete` is inconsistent with the one in the RDB. This PR fixes the bug.\r\n\r\n## Description of the changes\r\n- Fix `datetime_complete` in `_CachedStorage`\r\n- Add test", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2846/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2846/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2832", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2832/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2832/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2832/events", "html_url": "https://github.com/optuna/optuna/issues/2832", "id": 957650148, "node_id": "MDU6SXNzdWU5NTc2NTAxNDg=", "number": 2832, "title": "StorageInternalError when using pruning", "user": {"login": "grudloff", "id": 12706143, "node_id": "MDQ6VXNlcjEyNzA2MTQz", "avatar_url": "https://avatars.githubusercontent.com/u/12706143?v=4", "gravatar_id": "", "url": "https://api.github.com/users/grudloff", "html_url": "https://github.com/grudloff", "followers_url": "https://api.github.com/users/grudloff/followers", "following_url": "https://api.github.com/users/grudloff/following{/other_user}", "gists_url": "https://api.github.com/users/grudloff/gists{/gist_id}", "starred_url": "https://api.github.com/users/grudloff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/grudloff/subscriptions", "organizations_url": "https://api.github.com/users/grudloff/orgs", "repos_url": "https://api.github.com/users/grudloff/repos", "events_url": "https://api.github.com/users/grudloff/events{/privacy}", "received_events_url": "https://api.github.com/users/grudloff/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2021-08-02T01:10:51Z", "updated_at": "2021-08-11T07:39:28Z", "closed_at": "2021-08-11T07:39:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am having trouble running a study, after a couple (10 to 20) iterations it stops and raises an `StorageInternalError`. I have already run another similar study on the same file with no issues.  I saw that there are a couple of closed issues regarding this same error but they don't seem to be the same problem and I couldn't figure out how to fix it. If anyone could give some pointers to understand the raised error and how to fix it, I would greatly appreciate it.\r\n\r\nEdit: It seems the source of the error is an `OperationalError` described by sqlalchemy doc as:\r\n```\r\nException raised for errors that are related to the database\u2019s operation and not necessarily under the control of the programmer, e.g. an unexpected disconnect occurs, the data source name is not found, a transaction could not be processed, a memory allocation error occurred during processing, etc.\r\n```\r\nbut I am working on a local file and the disk still has plenty of space. What could be causing this?\r\n\r\n## Environment\r\n\r\n<!--\r\nYou can get this information by typing the following:\r\n```\r\npython -c 'import optuna; print(optuna.__version__)'\r\npython -c 'import platform; print(platform.python_version())'\r\npython -c 'import platform; print(platform.platform())'\r\n```\r\n-->\r\n\r\n- Optuna version: 2.8.0\r\n- Python version: 3.9.5\r\n- OS: Windows-10-10.0.19043-SP0\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n\r\n\r\n<details>\r\n  <summary>Log</summary>\r\n\r\n\r\n  ```\r\n---------------------------------------------------------------------------\r\nOperationalError                          Traceback (most recent call last)\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\engine\\base.py in _wrap_pool_connect(self, fn, connection)\r\n   3211         try:\r\n-> 3212             return fn()\r\n   3213         except dialect.dbapi.Error as e:\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\pool\\base.py in connect(self)\r\n    306         \"\"\"\r\n--> 307         return _ConnectionFairy._checkout(self)\r\n    308 \r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\pool\\base.py in _checkout(cls, pool, threadconns, fairy)\r\n    766         if not fairy:\r\n--> 767             fairy = _ConnectionRecord.checkout(pool)\r\n    768 \r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\pool\\base.py in checkout(cls, pool)\r\n    424     def checkout(cls, pool):\r\n--> 425         rec = pool._do_get()\r\n    426         try:\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\pool\\impl.py in _do_get(self)\r\n    255     def _do_get(self):\r\n--> 256         return self._create_connection()\r\n    257 \r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\pool\\base.py in _create_connection(self)\r\n    252 \r\n--> 253         return _ConnectionRecord(self)\r\n    254 \r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\pool\\base.py in __init__(self, pool, connect)\r\n    367         if connect:\r\n--> 368             self.__connect()\r\n    369         self.finalize_callback = deque()\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\pool\\base.py in __connect(self)\r\n    610             with util.safe_reraise():\r\n--> 611                 pool.logger.debug(\"Error on connect(): %s\", e)\r\n    612         else:\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py in __exit__(self, type_, value, traceback)\r\n     69             if not self.warn_only:\r\n---> 70                 compat.raise_(\r\n     71                     exc_value,\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\util\\compat.py in raise_(***failed resolving arguments***)\r\n    206         try:\r\n--> 207             raise exception\r\n    208         finally:\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\pool\\base.py in __connect(self)\r\n    604             self.starttime = time.time()\r\n--> 605             connection = pool._invoke_creator(self)\r\n    606             pool.logger.debug(\"Created new connection %r\", connection)\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\engine\\create.py in connect(connection_record)\r\n    577                         return connection\r\n--> 578             return dialect.connect(*cargs, **cparams)\r\n    579 \r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\engine\\default.py in connect(self, *cargs, **cparams)\r\n    583         # inherits the docstring from interfaces.Dialect.connect\r\n--> 584         return self.dbapi.connect(*cargs, **cparams)\r\n    585 \r\n\r\nOperationalError: unable to open database file\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nOperationalError                          Traceback (most recent call last)\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\optuna\\storages\\_rdb\\storage.py in _create_scoped_session(scoped_session, ignore_integrity_error)\r\n     52     try:\r\n---> 53         yield session\r\n     54         session.commit()\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\optuna\\storages\\_rdb\\storage.py in _update_trial(self, trial_id, state, values, intermediate_values, params, distributions_, user_attrs, system_attrs, datetime_start, datetime_complete)\r\n    667         with _create_scoped_session(self.scoped_session) as session:\r\n--> 668             trial_model = models.TrialModel.find_or_raise_by_id(trial_id, session)\r\n    669             if trial_model.state.is_finished():\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\optuna\\storages\\_rdb\\models.py in find_or_raise_by_id(cls, trial_id, session, for_update)\r\n    240 \r\n--> 241         trial = query.one_or_none()\r\n    242         if trial is None:\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\orm\\query.py in one_or_none(self)\r\n   2788         \"\"\"\r\n-> 2789         return self._iter().one_or_none()\r\n   2790 \r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\orm\\query.py in _iter(self)\r\n   2846         statement = self._statement_20()\r\n-> 2847         result = self.session.execute(\r\n   2848             statement,\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\orm\\session.py in execute(self, statement, params, execution_options, bind_arguments, _parent_execute_state, _add_event, **kw)\r\n   1687         else:\r\n-> 1688             conn = self._connection_for_bind(bind)\r\n   1689         result = conn._execute_20(statement, params or {}, execution_options)\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\orm\\session.py in _connection_for_bind(self, engine, execution_options, **kw)\r\n   1528         if self._transaction is not None or self._autobegin():\r\n-> 1529             return self._transaction._connection_for_bind(\r\n   1530                 engine, execution_options\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\orm\\session.py in _connection_for_bind(self, bind, execution_options)\r\n    746             else:\r\n--> 747                 conn = bind.connect()\r\n    748                 local_connect = True\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\engine\\base.py in connect(self, close_with_result)\r\n   3165 \r\n-> 3166         return self._connection_cls(self, close_with_result=close_with_result)\r\n   3167 \r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\engine\\base.py in __init__(self, engine, connection, close_with_result, _branch_from, _execution_options, _dispatch, _has_events, _allow_revalidate)\r\n     95                 if connection is not None\r\n---> 96                 else engine.raw_connection()\r\n     97             )\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\engine\\base.py in raw_connection(self, _connection)\r\n   3244         \"\"\"\r\n-> 3245         return self._wrap_pool_connect(self.pool.connect, _connection)\r\n   3246 \r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\engine\\base.py in _wrap_pool_connect(self, fn, connection)\r\n   3214             if connection is None:\r\n-> 3215                 Connection._handle_dbapi_exception_noconnection(\r\n   3216                     e, dialect, self\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\engine\\base.py in _handle_dbapi_exception_noconnection(cls, e, dialect, engine)\r\n   2068         elif should_wrap:\r\n-> 2069             util.raise_(\r\n   2070                 sqlalchemy_exception, with_traceback=exc_info[2], from_=e\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\util\\compat.py in raise_(***failed resolving arguments***)\r\n    206         try:\r\n--> 207             raise exception\r\n    208         finally:\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\engine\\base.py in _wrap_pool_connect(self, fn, connection)\r\n   3211         try:\r\n-> 3212             return fn()\r\n   3213         except dialect.dbapi.Error as e:\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\pool\\base.py in connect(self)\r\n    306         \"\"\"\r\n--> 307         return _ConnectionFairy._checkout(self)\r\n    308 \r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\pool\\base.py in _checkout(cls, pool, threadconns, fairy)\r\n    766         if not fairy:\r\n--> 767             fairy = _ConnectionRecord.checkout(pool)\r\n    768 \r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\pool\\base.py in checkout(cls, pool)\r\n    424     def checkout(cls, pool):\r\n--> 425         rec = pool._do_get()\r\n    426         try:\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\pool\\impl.py in _do_get(self)\r\n    255     def _do_get(self):\r\n--> 256         return self._create_connection()\r\n    257 \r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\pool\\base.py in _create_connection(self)\r\n    252 \r\n--> 253         return _ConnectionRecord(self)\r\n    254 \r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\pool\\base.py in __init__(self, pool, connect)\r\n    367         if connect:\r\n--> 368             self.__connect()\r\n    369         self.finalize_callback = deque()\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\pool\\base.py in __connect(self)\r\n    610             with util.safe_reraise():\r\n--> 611                 pool.logger.debug(\"Error on connect(): %s\", e)\r\n    612         else:\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py in __exit__(self, type_, value, traceback)\r\n     69             if not self.warn_only:\r\n---> 70                 compat.raise_(\r\n     71                     exc_value,\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\util\\compat.py in raise_(***failed resolving arguments***)\r\n    206         try:\r\n--> 207             raise exception\r\n    208         finally:\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\pool\\base.py in __connect(self)\r\n    604             self.starttime = time.time()\r\n--> 605             connection = pool._invoke_creator(self)\r\n    606             pool.logger.debug(\"Created new connection %r\", connection)\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\engine\\create.py in connect(connection_record)\r\n    577                         return connection\r\n--> 578             return dialect.connect(*cargs, **cparams)\r\n    579 \r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\sqlalchemy\\engine\\default.py in connect(self, *cargs, **cparams)\r\n    583         # inherits the docstring from interfaces.Dialect.connect\r\n--> 584         return self.dbapi.connect(*cargs, **cparams)\r\n    585 \r\n\r\nOperationalError: (sqlite3.OperationalError) unable to open database file\r\n(Background on this error at: https://sqlalche.me/e/14/e3q8)\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nStorageInternalError                      Traceback (most recent call last)\r\n<ipython-input-5-b47477278440> in <module>\r\n      2 study = optuna.create_study(study_name='Conv_serial', storage='sqlite:///db.sqlite3', direction='minimize',\r\n      3                             pruner=pruner, load_if_exists=True)\r\n----> 4 study.optimize(objective, n_trials=100)\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\optuna\\study.py in optimize(self, func, n_trials, timeout, n_jobs, catch, callbacks, gc_after_trial, show_progress_bar)\r\n    399             )\r\n    400 \r\n--> 401         _optimize(\r\n    402             study=self,\r\n    403             func=func,\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\optuna\\_optimize.py in _optimize(study, func, n_trials, timeout, n_jobs, catch, callbacks, gc_after_trial, show_progress_bar)\r\n     63     try:\r\n     64         if n_jobs == 1:\r\n---> 65             _optimize_sequential(\r\n     66                 study,\r\n     67                 func,\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\optuna\\_optimize.py in _optimize_sequential(study, func, n_trials, timeout, catch, callbacks, gc_after_trial, reseed_sampler_rng, time_start, progress_bar)\r\n    160 \r\n    161         try:\r\n--> 162             trial = _run_trial(study, func, catch)\r\n    163         except Exception:\r\n    164             raise\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\optuna\\_optimize.py in _run_trial(study, func, catch)\r\n    241     # `Study.tell` may raise during trial post-processing.\r\n    242     try:\r\n--> 243         study.tell(trial, values=values, state=state)\r\n    244     except Exception:\r\n    245         raise\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\optuna\\study.py in tell(self, trial, values, state)\r\n    663                 self._storage.set_trial_values(trial_id, values)\r\n    664 \r\n--> 665             self._storage.set_trial_state(trial_id, state)\r\n    666 \r\n    667     def set_user_attr(self, key: str, value: Any) -> None:\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\optuna\\storages\\_cached_storage.py in set_trial_state(self, trial_id, state)\r\n    212                     updates.datetime_complete = datetime.datetime.now()\r\n    213                     cached_trial.datetime_complete = datetime.datetime.now()\r\n--> 214                 return self._flush_trial(trial_id)\r\n    215 \r\n    216         ret = self._backend.set_trial_state(trial_id, state)\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\optuna\\storages\\_cached_storage.py in _flush_trial(self, trial_id)\r\n    425             return True\r\n    426         del study.updates[number]\r\n--> 427         return self._backend._update_trial(\r\n    428             trial_id=trial_id,\r\n    429             values=updates.values,\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\optuna\\storages\\_rdb\\storage.py in _update_trial(self, trial_id, state, values, intermediate_values, params, distributions_, user_attrs, system_attrs, datetime_start, datetime_complete)\r\n    765                 )\r\n    766 \r\n--> 767             session.add(trial_model)\r\n    768 \r\n    769         return True\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\contextlib.py in __exit__(self, type, value, traceback)\r\n    133                 value = type()\r\n    134             try:\r\n--> 135                 self.gen.throw(type, value, traceback)\r\n    136             except StopIteration as exc:\r\n    137                 # Suppress StopIteration *unless* it's the same exception that\r\n\r\nC:\\ProgramData\\Miniconda3\\envs\\tf-gpu\\lib\\site-packages\\optuna\\storages\\_rdb\\storage.py in _create_scoped_session(scoped_session, ignore_integrity_error)\r\n     69             \"e.g. exceeding max length. \"\r\n     70         )\r\n---> 71         raise optuna.exceptions.StorageInternalError(message) from e\r\n     72     except Exception:\r\n     73         session.rollback()\r\n\r\nStorageInternalError: An exception is raised during the commit. This typically happens due to invalid data in the commit, e.g. exceeding max length. \r\n\r\n  ```\r\n  \r\n</details>\r\n\r\n\r\n## Code\r\n\r\n```python\r\nfrom tensorflow.keras import Sequential\r\nfrom tensorflow.keras.layers import Dense, Dropout, Reshape, Flatten, Conv1D, InputLayer\r\nfrom tensorflow.keras import regularizers\r\nfrom tensorflow.keras.callbacks import EarlyStopping\r\nfrom tensorflow.keras.optimizers import Adam\r\nimport optuna\r\nfrom optuna.integration import TFKerasPruningCallback\r\n\r\nearlystop = EarlyStopping(patience=1000, mode='min', restore_best_weights=True)\r\n\r\ndef create_model(trial):\r\n    model = Sequential()\r\n    model.add(InputLayer(input_shape=vars.N))\r\n    model.add(Reshape(target_shape=(-1, 1))) #add channel dimension\r\n    for i in range(trial.suggest_int('num_layers', 2, 20, log=True)):\r\n        model.add(Conv1D(filters=trial.suggest_int('units_conv_' + str(i),\r\n                                            low=2,\r\n                                            high=64,\r\n                                            step=2),\r\n                          kernel_size=trial.suggest_int('conv_size_' + str(i),\r\n                                            low=32,\r\n                                            high=256,\r\n                                            step=32),\r\n                          padding=\"same\",\r\n                          activation='relu'))\r\n    model.add(Flatten())\r\n    model.add(Dense(trial.suggest_int('dense_1', low=32, high=512, step=32), activation='relu'))\r\n    model.add(Dense(trial.suggest_int('dense_2', low=32, high=512, step=32), activation='relu'))\r\n    model.add(Dense(vars.Q))\r\n    model.compile(\r\n        optimizer=Adam(trial.suggest_categorical('learning_rate', [1e-2, 1e-3, 1e-4])),\r\n        loss='MSE',\r\n        metrics=['mean_absolute_error'])\r\n    \r\n    return model\r\n\r\ndef objective(trial):\r\n    model = create_model(trial)\r\n    model.fit(X_train, y_train, validation_data=(X_test, y_test), batch_size=1000,\r\n          epochs=5000, callbacks=[earlystop, TFKerasPruningCallback(trial, 'val_loss')], verbose=0)\r\n\r\n    score = model.evaluate(X_test, y_test, verbose=0)\r\n    return score[1]\r\n```\r\n\r\n```python\r\npruner = optuna.pruners.MedianPruner(n_startup_trials=10, n_warmup_steps=1000, interval_steps=100)\r\nstudy = optuna.create_study(study_name='Conv_serial', storage='sqlite:///db.sqlite3', direction='minimize',\r\n                            pruner=pruner, load_if_exists=True)\r\nstudy.optimize(objective, n_trials=100)\r\n```\r\n\r\n## Data\r\n\r\n* data: [link](https://we.tl/t-6Xewl2cjgH)\r\n\r\n* load data:\r\n\r\n```python\r\n\r\nX_train, y_train, X_test, y_test = pickle.load( open( \"save.p\", \"rb\" ) )\r\n\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2832/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2832/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2825", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2825/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2825/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2825/events", "html_url": "https://github.com/optuna/optuna/issues/2825", "id": 954681901, "node_id": "MDU6SXNzdWU5NTQ2ODE5MDE=", "number": 2825, "title": "attribute error in importing optuna", "user": {"login": "kaussie-k", "id": 85570726, "node_id": "MDQ6VXNlcjg1NTcwNzI2", "avatar_url": "https://avatars.githubusercontent.com/u/85570726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kaussie-k", "html_url": "https://github.com/kaussie-k", "followers_url": "https://api.github.com/users/kaussie-k/followers", "following_url": "https://api.github.com/users/kaussie-k/following{/other_user}", "gists_url": "https://api.github.com/users/kaussie-k/gists{/gist_id}", "starred_url": "https://api.github.com/users/kaussie-k/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kaussie-k/subscriptions", "organizations_url": "https://api.github.com/users/kaussie-k/orgs", "repos_url": "https://api.github.com/users/kaussie-k/repos", "events_url": "https://api.github.com/users/kaussie-k/events{/privacy}", "received_events_url": "https://api.github.com/users/kaussie-k/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2021-07-28T09:55:12Z", "updated_at": "2021-09-26T03:56:46Z", "closed_at": "2021-09-26T03:56:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm using jupyter environment.\r\nOptuna got successfully installed.\r\nWhile importing it gives error:\r\nAttributeError: 'Version' object has no attribute 'major'\r\n\r\npackaging is updated to latest version 21.0\r\n\r\n> Full error:\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-207-deb984238a1b> in <module>\r\n----> 1 import optuna\r\n\r\n~\\Anaconda3\\lib\\site-packages\\optuna\\__init__.py in <module>\r\n      6 from optuna import distributions\r\n      7 from optuna import exceptions\r\n----> 8 from optuna import importance\r\n      9 from optuna import integration\r\n     10 from optuna import logging\r\n\r\n~\\Anaconda3\\lib\\site-packages\\optuna\\importance\\__init__.py in <module>\r\n      4 from typing import Optional\r\n      5 \r\n----> 6 from optuna.importance._base import BaseImportanceEvaluator\r\n      7 from optuna.importance._fanova import FanovaImportanceEvaluator\r\n      8 from optuna.importance._mean_decrease_impurity import MeanDecreaseImpurityImportanceEvaluator\r\n\r\n~\\Anaconda3\\lib\\site-packages\\optuna\\importance\\_base.py in <module>\r\n      7 \r\n      8 from optuna.distributions import BaseDistribution\r\n----> 9 from optuna.samplers import intersection_search_space\r\n     10 from optuna.study import Study\r\n     11 from optuna.trial import FrozenTrial\r\n\r\n~\\Anaconda3\\lib\\site-packages\\optuna\\samplers\\__init__.py in <module>\r\n----> 1 from optuna.samplers._base import BaseSampler\r\n      2 from optuna.samplers._cmaes import CmaEsSampler\r\n      3 from optuna.samplers._grid import GridSampler\r\n      4 from optuna.samplers._nsga2 import NSGAIISampler\r\n      5 from optuna.samplers._partial_fixed import PartialFixedSampler\r\n\r\n~\\Anaconda3\\lib\\site-packages\\optuna\\samplers\\_base.py in <module>\r\n      6 \r\n      7 from optuna.distributions import BaseDistribution\r\n----> 8 from optuna.study import Study\r\n      9 from optuna.trial import FrozenTrial\r\n     10 from optuna.trial import TrialState\r\n\r\n~\\Anaconda3\\lib\\site-packages\\optuna\\study.py in <module>\r\n    208 \r\n    209 \r\n--> 210 class Study(BaseStudy):\r\n    211     \"\"\"A study corresponds to an optimization task, i.e., a set of trials.\r\n    212 \r\n\r\n~\\Anaconda3\\lib\\site-packages\\optuna\\study.py in Study()\r\n    985         return None\r\n    986 \r\n--> 987     @deprecated(\"2.5.0\")\r\n    988     def _ask(self) -> trial_module.Trial:\r\n    989         return self.ask()\r\n\r\n~\\Anaconda3\\lib\\site-packages\\optuna\\_deprecated.py in deprecated(deprecated_version, removed_version, name, text)\r\n     83     _validate_version(deprecated_version)\r\n     84     if removed_version is None:\r\n---> 85         removed_version = _get_removed_version_from_deprecated_version(deprecated_version)\r\n     86     _validate_version(removed_version)\r\n     87     _validate_two_version(deprecated_version, removed_version)\r\n\r\n~\\Anaconda3\\lib\\site-packages\\optuna\\_deprecated.py in _get_removed_version_from_deprecated_version(deprecated_version)\r\n     45     parsed_deprecated_version = version.parse(deprecated_version)\r\n     46     assert isinstance(parsed_deprecated_version, version.Version)  # Required for mypy.\r\n---> 47     return \"{}.0.0\".format(parsed_deprecated_version.major + 2)\r\n     48 \r\n     49 \r\n\r\nAttributeError: 'Version' object has no attribute 'major'", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2825/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2825/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2813", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2813/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2813/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2813/events", "html_url": "https://github.com/optuna/optuna/issues/2813", "id": 946829565, "node_id": "MDU6SXNzdWU5NDY4Mjk1NjU=", "number": 2813, "title": "`Checks` CI job fails with missing `toml` dependency", "user": {"login": "xadrianzetx", "id": 37713008, "node_id": "MDQ6VXNlcjM3NzEzMDA4", "avatar_url": "https://avatars.githubusercontent.com/u/37713008?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xadrianzetx", "html_url": "https://github.com/xadrianzetx", "followers_url": "https://api.github.com/users/xadrianzetx/followers", "following_url": "https://api.github.com/users/xadrianzetx/following{/other_user}", "gists_url": "https://api.github.com/users/xadrianzetx/gists{/gist_id}", "starred_url": "https://api.github.com/users/xadrianzetx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xadrianzetx/subscriptions", "organizations_url": "https://api.github.com/users/xadrianzetx/orgs", "repos_url": "https://api.github.com/users/xadrianzetx/repos", "events_url": "https://api.github.com/users/xadrianzetx/events{/privacy}", "received_events_url": "https://api.github.com/users/xadrianzetx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-07-17T13:59:03Z", "updated_at": "2021-07-18T11:16:05Z", "closed_at": "2021-07-18T11:16:05Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "Black in latest release [switched from using `toml` to `tomli`](https://github.com/psf/black/pull/2301). Since `toml` is no longer installed in `Checks` workflow, `blackdoc` will fail the CI job.\r\n\r\n## Expected behavior\r\n\r\n`toml` should be installed when CI job runs `pip install --progress-bar off -U .[checking]`\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.9.0.dev0\r\n- Python version: Any\r\n- OS: Any\r\n\r\n## Error messages, stack traces, or logs\r\nIn `Checks` CI job\r\n```\r\nRun blackdoc . --check --diff\r\nTraceback (most recent call last):\r\n  File \"/opt/hostedtoolcache/Python/3.7.11/x64/bin/blackdoc\", line 5, in <module>\r\n    from blackdoc.__main__ import main\r\n  File \"/opt/hostedtoolcache/Python/3.7.11/x64/lib/python3.7/site-packages/blackdoc/__main__.py\", line 12, in <module>\r\n    from .blackcompat import (\r\n  File \"/opt/hostedtoolcache/Python/3.7.11/x64/lib/python3.7/site-packages/blackdoc/blackcompat.py\", line 9, in <module>\r\n    import toml\r\nModuleNotFoundError: No module named 'toml'\r\n```\r\n[Example](https://github.com/optuna/optuna/pull/2810/checks?check_run_id=3088486083)\r\n\r\n## Steps to reproduce\r\n\r\n1.  Push the code to trigger `Checks` CI job", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2813/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2813/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2812", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2812/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2812/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2812/events", "html_url": "https://github.com/optuna/optuna/issues/2812", "id": 946152200, "node_id": "MDU6SXNzdWU5NDYxNTIyMDA=", "number": 2812, "title": "RuntimeError: The runtime optuna version 2.8.0 is no longer compatible with the table schema (set up by optuna 2.8.0). Please try updating optuna to the latest version by `$ pip install -U optuna`.", "user": {"login": "Zakhar17", "id": 20302984, "node_id": "MDQ6VXNlcjIwMzAyOTg0", "avatar_url": "https://avatars.githubusercontent.com/u/20302984?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Zakhar17", "html_url": "https://github.com/Zakhar17", "followers_url": "https://api.github.com/users/Zakhar17/followers", "following_url": "https://api.github.com/users/Zakhar17/following{/other_user}", "gists_url": "https://api.github.com/users/Zakhar17/gists{/gist_id}", "starred_url": "https://api.github.com/users/Zakhar17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Zakhar17/subscriptions", "organizations_url": "https://api.github.com/users/Zakhar17/orgs", "repos_url": "https://api.github.com/users/Zakhar17/repos", "events_url": "https://api.github.com/users/Zakhar17/events{/privacy}", "received_events_url": "https://api.github.com/users/Zakhar17/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-07-16T10:21:27Z", "updated_at": "2021-10-21T10:14:18Z", "closed_at": "2021-10-21T10:14:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n## Expected behavior\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\nI am trying to use MySQL DB as the Optuna storage, however when trying to create the study (optuna.create_study(... , storage=link_to_db, load_if_exists=True)) I receive the following error: RuntimeError: The runtime optuna version 2.8.0 is no longer compatible with the table schema (set up by optuna 2.8.0). Please try updating optuna to the latest version by `$ pip install -U optuna`. \r\n\r\nI tried to install and uninstall optuna, create a new venv, recreate DB but it doesn't help. Have no idea what to do. Perhaps, some problems may be with installed packages. When trying to run the code for the first time there was an error that there is no module MySQLdb. However, installing this package didn't help with the error. I googled -  this package is for Python 2. So I installed mysqlclient package for my Python 3.8.10. The code went further but then I get the error above and can't find anything on it in google.\r\n\r\nThank you for any help!\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.8.0\r\n- Python version: 3.8.10\r\n- OS: Ubuntu 20.04.2 LTS\r\n- (Optional) Other libraries and their versions:\r\nalembic==1.4.1\r\nattrs==21.2.0\r\ncertifi==2021.5.30\r\ncharset-normalizer==2.0.2\r\nclick==8.0.1\r\ncliff==3.8.0\r\ncloudpickle==1.6.0\r\ncmaes==0.8.2\r\ncmd2==2.1.2\r\ncolorama==0.4.4\r\ncolorlog==5.0.1\r\ndatabricks-cli==0.14.3\r\ndocker==5.0.0\r\nentrypoints==0.3\r\nFlask==2.0.1\r\ngitdb==4.0.7\r\nGitPython==3.1.18\r\ngreenlet==1.1.0\r\ngunicorn==20.1.0\r\nidna==3.2\r\nitsdangerous==2.0.1\r\nJinja2==3.0.1\r\njoblib==1.0.1\r\nlightgbm==3.2.1\r\nMako==1.1.4\r\nMarkupSafe==2.0.1\r\nmlflow==1.19.0\r\nmysqlclient==2.0.3\r\nnumpy==1.21.0\r\noptuna==2.8.0\r\npackaging==21.0\r\npandas==1.3.0\r\npbr==5.6.0\r\nprettytable==2.1.0\r\nprometheus-client==0.11.0\r\nprometheus-flask-exporter==0.18.2\r\nprotobuf==3.17.3\r\npyparsing==2.4.7\r\npyperclip==1.8.2\r\npython-dateutil==2.8.2\r\npython-editor==1.0.4\r\npytz==2021.1\r\nPyYAML==5.4.1\r\nquerystring-parser==1.2.4\r\nrequests==2.26.0\r\nscikit-learn==0.24.2\r\nscipy==1.7.0\r\nsix==1.16.0\r\nsmmap==4.0.0\r\nSQLAlchemy==1.4.21\r\nsqlparse==0.4.1\r\nstevedore==3.3.0\r\ntabulate==0.8.9\r\nthreadpoolctl==2.2.0\r\ntqdm==4.61.2\r\nurllib3==1.26.6\r\nwcwidth==0.2.5\r\nwebsocket-client==1.1.0\r\nWerkzeug==2.0.1\r\nxgboost==1.4.2\r\n\r\n\r\n## Error messages, stack traces, or logs\r\nFile \"/home/dev0007/Projects/automl/optuna_mlflow/optuna_mlflow_new_venv/lib/python3.8/site-packages/optuna/study.py\", line 1137, in create_study\r\n    storage = storages.get_storage(storage)\r\n  File \"/home/dev0007/Projects/automl/optuna_mlflow/optuna_mlflow_new_venv/lib/python3.8/site-packages/optuna/storages/__init__.py\", line 29, in get_storage\r\n    return _CachedStorage(RDBStorage(storage))\r\n  File \"/home/dev0007/Projects/automl/optuna_mlflow/optuna_mlflow_new_venv/lib/python3.8/site-packages/optuna/storages/_rdb/storage.py\", line 186, in __init__\r\n    self._version_manager.check_table_schema_compatibility()\r\n  File \"/home/dev0007/Projects/automl/optuna_mlflow/optuna_mlflow_new_venv/lib/python3.8/site-packages/optuna/storages/_rdb/storage.py\", line 1330, in check_table_schema_compatibility\r\n    raise RuntimeError(message)\r\nRuntimeError: The runtime optuna version 2.8.0 is no longer compatible with the table schema (set up by optuna 2.8.0). Please try updating optuna to the latest version by `$ pip install -U optuna`.\r\n```\r\n# error messages, stack traces, or logs\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1.\r\n2.\r\n3.\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\n# python code\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2812/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2812/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2804", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2804/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2804/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2804/events", "html_url": "https://github.com/optuna/optuna/issues/2804", "id": 944268745, "node_id": "MDU6SXNzdWU5NDQyNjg3NDU=", "number": 2804, "title": "Memory leak when used with a custom tensorflow loop", "user": {"login": "ghost", "id": 10137, "node_id": "MDQ6VXNlcjEwMTM3", "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ghost", "html_url": "https://github.com/ghost", "followers_url": "https://api.github.com/users/ghost/followers", "following_url": "https://api.github.com/users/ghost/following{/other_user}", "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}", "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ghost/subscriptions", "organizations_url": "https://api.github.com/users/ghost/orgs", "repos_url": "https://api.github.com/users/ghost/repos", "events_url": "https://api.github.com/users/ghost/events{/privacy}", "received_events_url": "https://api.github.com/users/ghost/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-07-14T10:14:04Z", "updated_at": "2021-07-18T18:20:23Z", "closed_at": "2021-07-18T18:20:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\nHere's a colab [notebook](https://colab.research.google.com/drive/1mIO3Pd-HSskvIrcl3Bp3Evg_MzAEuwPc?usp=sharing) containing the full code. \r\n\r\nI'm encountering a subtle memory leak, and unable to determine the source using tracemalloc. I run the code in google colab, which is meant to optimize hyperparameters for a custom ppo agent. Also, the speed at which the leak happens varies: sometimes it happens within 10-20 minutes of runtime / 5-10 iterations while on other times it may take up to an hour. This could be a tensorflow issue therefore I created another [issue](https://github.com/tensorflow/tensorflow/issues/50765) there.\r\n\r\n**Note:** I tried with / without passing `gc_after_trial=True` and it doesn't make any difference.\r\n\r\n## Expected behavior\r\n\r\nMemory usage should be constant over time, since there are no objects stored in memory intentionally as the training progresses. After each call to `optimize_agent()` in the code, the memory should be released, yet it doesn't.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.8.0\r\n- Python version: 3.7\r\n- OS: Ubuntu 18 (google colab)\r\n- (Optional) Other libraries and their versions:\r\n\r\n## Error messages, stack traces, or logs\r\n\r\nHere are the resulting [memory snapshots](https://drive.google.com/file/d/1RH89X5B5xsUY8a1RA4Gh9WmEIqXhs84R/view?usp=sharing) at 15 consecutive iterations up to the crash, which do not show any particular red flags. Besides, by summing up the `size` column of the most recent snapshot, it totals 967249710 bytes ~= 1GB, which is weird because the available memory on colab ~= 12GB. \r\n\r\nHere's a sample crash log which is not very informative:\r\n\r\n```\r\n   Timestamp                  Level    Message\r\n\r\nJul 14, 2021, 11:07:41 AM | WARNING | WARNING:root:kernel a3ecdd9e-1765-4f67-af0e-60c198c896ec restarted\r\nJul 14, 2021, 11:07:41 AM | INFO | KernelRestarter: restarting kernel (1/5), keep random ports\r\nJul 14, 2021, 10:22:16 AM | WARNING | 2021-07-14 08:22:16.518184: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11\r\nJul 14, 2021, 10:22:13 AM | WARNING | 2021-07-14 08:22:13.939377: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11\r\nJul 14, 2021, 10:21:50 AM | WARNING | 2021-07-14 08:21:50.140299: I tensorflow/stream_executor/cuda/cuda_dnn.cc:359] Loaded cuDNN version 8004\r\nJul 14, 2021, 10:21:47 AM | WARNING | 2021-07-14 08:21:47.841310: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8\r\nJul 14, 2021, 10:21:44 AM | WARNING | 2021-07-14 08:21:44.642335: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2199995000 Hz\r\nJul 14, 2021, 10:21:44 AM | WARNING | 2021-07-14 08:21:44.559306: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)\r\nJul 14, 2021, 10:21:30 AM | WARNING | 2021-07-14 08:21:30.355834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13837 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5)\r\nJul 14, 2021, 10:21:30 AM | WARNING | 2021-07-14 08:21:30.355771: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.\r\nJul 14, 2021, 10:21:30 AM | WARNING | 2021-07-14 08:21:30.354979: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\nJul 14, 2021, 10:21:30 AM | WARNING | 2021-07-14 08:21:30.354000: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\nJul 14, 2021, 10:21:30 AM | WARNING | 2021-07-14 08:21:30.352104: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\nJul 14, 2021, 10:21:30 AM | WARNING | 2021-07-14 08:21:30.351844: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0: N\r\nJul 14, 2021, 10:21:30 AM | WARNING | 2021-07-14 08:21:30.351828: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264] 0\r\nJul 14, 2021, 10:21:30 AM | WARNING | 2021-07-14 08:21:30.351772: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:\r\nJul 14, 2021, 10:21:25 AM | WARNING | 2021-07-14 08:21:25.206565: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0\r\nJul 14, 2021, 10:21:25 AM | WARNING | 2021-07-14 08:21:25.203344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1871] Adding visible gpu devices: 0\r\nJul 14, 2021, 10:21:25 AM | WARNING | 2021-07-14 08:21:25.202526: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\nJul 14, 2021, 10:21:25 AM | WARNING | 2021-07-14 08:21:25.201577: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\nJul 14, 2021, 10:21:25 AM | WARNING | coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s\r\nJul 14, 2021, 10:21:25 AM | WARNING | pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5\r\nJul 14, 2021, 10:21:25 AM | WARNING | 2021-07-14 08:21:25.201438: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 0 with properties:\r\nJul 14, 2021, 10:21:25 AM | WARNING | 2021-07-14 08:21:25.200536: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\nJul 14, 2021, 10:21:25 AM | WARNING | 2021-07-14 08:21:25.199581: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1871] Adding visible gpu devices: 0\r\nJul 14, 2021, 10:21:25 AM | WARNING | 2021-07-14 08:21:25.195723: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\nJul 14, 2021, 10:21:25 AM | WARNING | 2021-07-14 08:21:25.194598: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\nJul 14, 2021, 10:21:25 AM | WARNING | 2021-07-14 08:21:25.194398: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8\r\nJul 14, 2021, 10:21:25 AM | WARNING | 2021-07-14 08:21:25.190679: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusparse.so.11\r\nJul 14, 2021, 10:21:25 AM | WARNING | 2021-07-14 08:21:25.144200: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusolver.so.10\r\nJul 14, 2021, 10:21:24 AM | WARNING | 2021-07-14 08:21:24.851273: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcurand.so.10\r\nJul 14, 2021, 10:21:24 AM | WARNING | 2021-07-14 08:21:24.832903: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcufft.so.10\r\nJul 14, 2021, 10:21:24 AM | WARNING | 2021-07-14 08:21:24.660570: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11\r\nJul 14, 2021, 10:21:24 AM | WARNING | 2021-07-14 08:21:24.660379: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11\r\nJul 14, 2021, 10:21:24 AM | WARNING | 2021-07-14 08:21:24.533359: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0\r\nJul 14, 2021, 10:21:24 AM | WARNING | coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.75GiB deviceMemoryBandwidth: 298.08GiB/s\r\nJul 14, 2021, 10:21:24 AM | WARNING | pciBusID: 0000:00:04.0 name: Tesla T4 computeCapability: 7.5\r\nJul 14, 2021, 10:21:24 AM | WARNING | 2021-07-14 08:21:24.533253: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 0 with properties:\r\nJul 14, 2021, 10:21:24 AM | WARNING | 2021-07-14 08:21:24.532176: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\nJul 14, 2021, 10:21:24 AM | WARNING | 2021-07-14 08:21:24.461038: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcuda.so.1\r\nJul 14, 2021, 10:21:07 AM | WARNING | 2021-07-14 08:21:07.977292: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0\r\nJul 14, 2021, 10:20:27 AM | INFO | Adapting to protocol v5.1 for kernel a3ecdd9e-1765-4f67-af0e-60c198c896ec\r\nJul 14, 2021, 10:20:26 AM | INFO | Kernel started: a3ecdd9e-1765-4f67-af0e-60c198c896ec\r\nJul 14, 2021, 10:20:20 AM | INFO | Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).\r\nJul 14, 2021, 10:20:20 AM | INFO | http://172.28.0.12:9000/\r\nJul 14, 2021, 10:20:20 AM | INFO | The Jupyter Notebook is running at:\r\nJul 14, 2021, 10:20:20 AM | INFO | Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).\r\nJul 14, 2021, 10:20:20 AM | INFO | 0 active kernels\r\nJul 14, 2021, 10:20:20 AM | INFO | http://172.28.0.2:9000/\r\nJul 14, 2021, 10:20:20 AM | INFO | The Jupyter Notebook is running at:\r\nJul 14, 2021, 10:20:20 AM | INFO | Serving notebooks from local directory: /\r\nJul 14, 2021, 10:20:20 AM | INFO | 0 active kernels\r\nJul 14, 2021, 10:20:20 AM | INFO | Serving notebooks from local directory: /\r\nJul 14, 2021, 10:20:20 AM | INFO | google.colab serverextension initialized.\r\nJul 14, 2021, 10:20:20 AM | INFO | google.colab serverextension initialized.\r\nJul 14, 2021, 10:20:20 AM | INFO | Writing notebook server cookie secret to /root/.local/share/jupyter/runtime/notebook_cookie_secret\r\nJul 14, 2021, 10:20:20 AM | INFO | Writing notebook server cookie secret to /root/.local/share/jupyter/runtime/notebook_cookie_secret\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Go to this [notebook](https://colab.research.google.com/drive/1mIO3Pd-HSskvIrcl3Bp3Evg_MzAEuwPc?usp=sharing)\r\n2. Run the notebook and wait, it should crash within 30-60 minutes.\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\n# python code\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2804/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2804/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2790", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2790/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2790/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2790/events", "html_url": "https://github.com/optuna/optuna/issues/2790", "id": 938452338, "node_id": "MDU6SXNzdWU5Mzg0NTIzMzg=", "number": 2790, "title": "`NSGAIISampler` tries to evaluate `constraint_func` even when trails fail.", "user": {"login": "ytsmiling", "id": 20983513, "node_id": "MDQ6VXNlcjIwOTgzNTEz", "avatar_url": "https://avatars.githubusercontent.com/u/20983513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ytsmiling", "html_url": "https://github.com/ytsmiling", "followers_url": "https://api.github.com/users/ytsmiling/followers", "following_url": "https://api.github.com/users/ytsmiling/following{/other_user}", "gists_url": "https://api.github.com/users/ytsmiling/gists{/gist_id}", "starred_url": "https://api.github.com/users/ytsmiling/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ytsmiling/subscriptions", "organizations_url": "https://api.github.com/users/ytsmiling/orgs", "repos_url": "https://api.github.com/users/ytsmiling/repos", "events_url": "https://api.github.com/users/ytsmiling/events{/privacy}", "received_events_url": "https://api.github.com/users/ytsmiling/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-07-07T03:51:51Z", "updated_at": "2021-07-19T10:29:25Z", "closed_at": "2021-07-19T10:29:25Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "## Expected behavior\r\n\r\n`NSGAIISampler` does not evaluate `constraints_func` when trials did not complete.\r\n\r\n## Environment\r\n\r\n- Optuna version: `2.9.0.dev`\r\n- Python version: 3.8.6\r\n- OS: ubuntu (WSL2)\r\n- (Optional) Other libraries and their versions:\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n[I 2021-07-07 12:44:56,751] A new study created in memory with name: no-name-be57671e-58b7-4219-a290-93f93adccdcd\r\n[I 2021-07-07 12:44:56,752] Trial 0 finished with values: [0.1, 0.2] and parameters: {}.\r\n[I 2021-07-07 12:44:56,752] Trial 1 pruned.\r\nTraceback (most recent call last):\r\n  File \"tmp.py\", line 11, in <module>\r\n    optuna.create_study(sampler=sampler, directions=[\"maximize\", \"minimize\"]).optimize(objective, n_trials=200)\r\n  File \"path/to/optuna/optuna/study/study.py\", line 400, in optimize\r\n    _optimize(\r\n  File \"path/to/optuna/optuna/study/_optimize.py\", line 65, in _optimize\r\n    _optimize_sequential(\r\n  File \"path/to/optuna/optuna/study/_optimize.py\", line 162, in _optimize_sequential\r\n    trial = _run_trial(study, func, catch)\r\n  File \"path/to/optuna/optuna/study/_optimize.py\", line 243, in _run_trial\r\n    study.tell(trial, values=values, state=state)\r\n  File \"path/to/optuna/optuna/study/study.py\", line 657, in tell\r\n    self.sampler.after_trial(study, frozen_trial, state, values)\r\n  File \"path/to/optuna/optuna/samplers/_nsga2.py\", line 353, in after_trial\r\n    con = self._constraints_func(trial)\r\n  File \"tmp.py\", line 10, in <lambda>\r\n    sampler = optuna.samplers.NSGAIISampler(constraints_func=lambda t: [t.user_attrs[\"constraint\"]])\r\nKeyError: 'constraint'\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Optimize an objective that failes w/ `NSGAIISampler` and `constraint_func`.\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\nimport optuna\r\n\r\ndef objective(trial):\r\n    if trial.number % 2:\r\n        raise optuna.TrialPruned\r\n    trial.set_user_attr(\"constraint\", 0.2 - 0.1)\r\n    return 0.1, 0.2\r\n\r\n\r\nsampler = optuna.samplers.NSGAIISampler(constraints_func=lambda t: [t.user_attrs[\"constraint\"]])\r\noptuna.create_study(sampler=sampler, directions=[\"maximize\", \"minimize\"]).optimize(objective, n_trials=200)\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2790/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2790/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2762", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2762/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2762/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2762/events", "html_url": "https://github.com/optuna/optuna/issues/2762", "id": 930625865, "node_id": "MDU6SXNzdWU5MzA2MjU4NjU=", "number": 2762, "title": "KeyError: 'binary_logloss'", "user": {"login": "subarubknb03", "id": 77526420, "node_id": "MDQ6VXNlcjc3NTI2NDIw", "avatar_url": "https://avatars.githubusercontent.com/u/77526420?v=4", "gravatar_id": "", "url": "https://api.github.com/users/subarubknb03", "html_url": "https://github.com/subarubknb03", "followers_url": "https://api.github.com/users/subarubknb03/followers", "following_url": "https://api.github.com/users/subarubknb03/following{/other_user}", "gists_url": "https://api.github.com/users/subarubknb03/gists{/gist_id}", "starred_url": "https://api.github.com/users/subarubknb03/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/subarubknb03/subscriptions", "organizations_url": "https://api.github.com/users/subarubknb03/orgs", "repos_url": "https://api.github.com/users/subarubknb03/repos", "events_url": "https://api.github.com/users/subarubknb03/events{/privacy}", "received_events_url": "https://api.github.com/users/subarubknb03/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-06-26T06:08:57Z", "updated_at": "2021-06-26T07:15:39Z", "closed_at": "2021-06-26T07:15:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Environment\r\n\r\n- Optuna version: 2.8.0\r\n- Python version: 3.8.5\r\n- OS: macOS Big Sur version 11.4\r\n- (Optional) Other libraries and their versions:\r\n- Docker version: 20.10.7\r\n- Computer: MacBook Air (M1, 2020)\r\n\r\n```dockerfile\r\nFROM ubuntu:20.04\r\n# update and install\r\nRUN apt-get update && apt-get install -y \\\r\n    sudo \\\r\n    wget \\\r\n    vim \\\r\n    libx11-6 \\\r\n    libx11-dev \\\r\n    graphviz\r\n\r\n# install anaconda3\r\nWORKDIR /opt\r\n# download anaconda3 package and install anaconda3\r\nRUN wget https://repo.anaconda.com/archive/Anaconda3-2020.11-Linux-x86_64.sh && \\\r\n    sh Anaconda3-2020.11-Linux-x86_64.sh -b -p /opt/anaconda3 && \\\r\n    rm -f Anaconda3-2020.11-Linux-x86_64.sh\r\n\r\n# set path\r\nENV PATH=/opt/anaconda3/bin:$PATH\r\n\r\n# update pip\r\nRUN pip install --upgrade pip && pip install \\\r\n    graphviz \\\r\n    japanize_matplotlib \\\r\n    pydotplus \\\r\n    xgboost \\\r\n    lightgbm \\\r\n    optuna\r\n\r\nWORKDIR /\r\nRUN mkdir /work\r\nWORKDIR /work\r\n\r\n# execute jupyterlab as default command\r\nCMD [\"jupyter\", \"lab\", \"--ip=0.0.0.0\", \"--allow-root\", \"--LabApp.token=''\"]\r\n```\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n[W 2021-06-25 17:59:03,714] Trial 0 failed because of the following error: KeyError('binary_logloss')\r\nTraceback (most recent call last):\r\n  File \"/opt/anaconda3/lib/python3.8/site-packages/optuna/_optimize.py\", line 216, in _run_trial\r\n    value_or_values = func(trial)\r\n  File \"/opt/anaconda3/lib/python3.8/site-packages/optuna/integration/_lightgbm_tuner/optimize.py\", line 251, in __call__\r\n    val_score = self._get_booster_best_score(booster)\r\n  File \"/opt/anaconda3/lib/python3.8/site-packages/optuna/integration/_lightgbm_tuner/optimize.py\", line 118, in _get_booster_best_score\r\n    val_score = booster.best_score[valid_name][metric]\r\nKeyError: 'binary_logloss'\r\n---------------------------------------------------------------------------\r\nKeyError                                  Traceback (most recent call last)\r\n<ipython-input-4-cc91ab7b37c4> in <module>\r\n     17 }\r\n     18 \r\n---> 19 model = lgb_o.train(params,\r\n     20                     trains,\r\n     21                     valid_sets=valids,\r\n\r\n/opt/anaconda3/lib/python3.8/site-packages/optuna/integration/_lightgbm_tuner/__init__.py in train(*args, **kwargs)\r\n     33 \r\n     34     auto_booster = LightGBMTuner(*args, **kwargs)\r\n---> 35     auto_booster.run()\r\n     36     return auto_booster.get_best_booster()\r\n\r\n/opt/anaconda3/lib/python3.8/site-packages/optuna/integration/_lightgbm_tuner/optimize.py in run(self)\r\n    544         self.sample_train_set()\r\n    545 \r\n--> 546         self.tune_feature_fraction()\r\n    547         self.tune_num_leaves()\r\n    548         self.tune_bagging()\r\n\r\n/opt/anaconda3/lib/python3.8/site-packages/optuna/integration/_lightgbm_tuner/optimize.py in tune_feature_fraction(self, n_trials)\r\n    569 \r\n    570         sampler = optuna.samplers.GridSampler({param_name: param_values})\r\n--> 571         self._tune_params([param_name], len(param_values), sampler, \"feature_fraction\")\r\n    572 \r\n    573     def tune_num_leaves(self, n_trials: int = 20) -> None:\r\n\r\n/opt/anaconda3/lib/python3.8/site-packages/optuna/integration/_lightgbm_tuner/optimize.py in _tune_params(self, target_param_names, n_trials, sampler, step_name)\r\n    652             _timeout = None\r\n    653         if _n_trials > 0:\r\n--> 654             study.optimize(\r\n    655                 objective,\r\n    656                 n_trials=_n_trials,\r\n\r\n/opt/anaconda3/lib/python3.8/site-packages/optuna/study.py in optimize(self, func, n_trials, timeout, n_jobs, catch, callbacks, gc_after_trial, show_progress_bar)\r\n    399             )\r\n    400 \r\n--> 401         _optimize(\r\n    402             study=self,\r\n    403             func=func,\r\n\r\n/opt/anaconda3/lib/python3.8/site-packages/optuna/_optimize.py in _optimize(study, func, n_trials, timeout, n_jobs, catch, callbacks, gc_after_trial, show_progress_bar)\r\n     63     try:\r\n     64         if n_jobs == 1:\r\n---> 65             _optimize_sequential(\r\n     66                 study,\r\n     67                 func,\r\n\r\n/opt/anaconda3/lib/python3.8/site-packages/optuna/_optimize.py in _optimize_sequential(study, func, n_trials, timeout, catch, callbacks, gc_after_trial, reseed_sampler_rng, time_start, progress_bar)\r\n    160 \r\n    161         try:\r\n--> 162             trial = _run_trial(study, func, catch)\r\n    163         except Exception:\r\n    164             raise\r\n\r\n/opt/anaconda3/lib/python3.8/site-packages/optuna/_optimize.py in _run_trial(study, func, catch)\r\n    265 \r\n    266     if state == TrialState.FAIL and func_err is not None and not isinstance(func_err, catch):\r\n--> 267         raise func_err\r\n    268     return trial\r\n    269 \r\n\r\n/opt/anaconda3/lib/python3.8/site-packages/optuna/_optimize.py in _run_trial(study, func, catch)\r\n    214 \r\n    215     try:\r\n--> 216         value_or_values = func(trial)\r\n    217     except exceptions.TrialPruned as e:\r\n    218         # TODO(mamu): Handle multi-objective cases.\r\n\r\n/opt/anaconda3/lib/python3.8/site-packages/optuna/integration/_lightgbm_tuner/optimize.py in __call__(self, trial)\r\n    249         booster = lgb.train(self.lgbm_params, train_set, **kwargs)\r\n    250 \r\n--> 251         val_score = self._get_booster_best_score(booster)\r\n    252         elapsed_secs = time.time() - start_time\r\n    253         average_iteration_time = elapsed_secs / booster.current_iteration()\r\n\r\n/opt/anaconda3/lib/python3.8/site-packages/optuna/integration/_lightgbm_tuner/optimize.py in _get_booster_best_score(self, booster)\r\n    116             raise NotImplementedError\r\n    117 \r\n--> 118         val_score = booster.best_score[valid_name][metric]\r\n    119         return val_score\r\n    120 \r\n\r\nKeyError: 'binary_logloss'\r\n```\r\n\r\n## Steps to reproduce\r\n\r\nActually, the data I used is the data analysis competition data.\r\nYou can probably reproduce it with the code below.\r\n\r\n## Reproducible examples\r\n\r\n```python\r\nboston = load_boston()\r\nX_array = boston.data\r\ny_array = boston.target\r\ndf = pd.DataFrame(X_array, columns = boston.feature_names).assign(MEDV=np.array(y_array))\r\n\r\ndf_train, df_val = train_test_split(df, test_size=0.2, random_state=71)\r\ncol = 'MEDV'\r\ntrain_y = df_train[col]\r\ntrain_x = df_train.drop(col, axis=1)\r\n\r\nval_y = df_val[col]\r\nval_x = df_val.drop(col, axis=1)\r\n\r\ntrains = lgb.Dataset(train_x, train_y)\r\nvalids = lgb.Dataset(val_x, val_y)\r\n\r\nparams = {\r\n    'objective': 'regression',\r\n    'metrics': 'rmse',\r\n    'boosting_type': 'gbdt',\r\n    'verbosity': -1\r\n}\r\n\r\nmodel = lgb.train(params,\r\n                  trains,\r\n                  valid_sets=valids,\r\n                  num_boost_round=1000,\r\n                  early_stopping_rounds=100,\r\n                  verbose_eval=100)\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2762/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2762/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2749", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2749/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2749/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2749/events", "html_url": "https://github.com/optuna/optuna/pull/2749", "id": 922299826, "node_id": "MDExOlB1bGxSZXF1ZXN0NjcxMTk0MDEz", "number": 2749, "title": "Fix `infer_relative_search_space` of TPE with the single point distributions", "user": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/36", "html_url": "https://github.com/optuna/optuna/milestone/36", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/36/labels", "id": 6809937, "node_id": "MDk6TWlsZXN0b25lNjgwOTkzNw==", "number": 36, "title": "v2.9.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 47, "state": "closed", "created_at": "2021-06-01T01:07:05Z", "updated_at": "2021-08-02T06:09:08Z", "due_on": null, "closed_at": "2021-08-02T06:09:08Z"}, "comments": 8, "created_at": "2021-06-16T08:29:11Z", "updated_at": "2021-06-17T13:35:23Z", "closed_at": "2021-06-17T13:35:23Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2749", "html_url": "https://github.com/optuna/optuna/pull/2749", "diff_url": "https://github.com/optuna/optuna/pull/2749.diff", "patch_url": "https://github.com/optuna/optuna/pull/2749.patch", "merged_at": "2021-06-17T13:35:23Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nThe current TPESampler should ignore the single point distributions such as `UniformDistribution(low=1.0, high=1.0)`, but does not. This PR fixes the `infer_relative_search_space` of TPESampelr so that it ignores the single point distributions.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n- Fix the `infer_relative_search_space` of TPESampelr so that it ignores the single point distributions.\r\n- Add tests.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2749/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2749/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2739", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2739/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2739/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2739/events", "html_url": "https://github.com/optuna/optuna/pull/2739", "id": 916319055, "node_id": "MDExOlB1bGxSZXF1ZXN0NjY2MDA1OTIy", "number": 2739, "title": "Fix `Nan` cast bug in `TPESampler`", "user": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "keisuke-umezawa", "id": 1277089, "node_id": "MDQ6VXNlcjEyNzcwODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1277089?v=4", "gravatar_id": "", "url": "https://api.github.com/users/keisuke-umezawa", "html_url": "https://github.com/keisuke-umezawa", "followers_url": "https://api.github.com/users/keisuke-umezawa/followers", "following_url": "https://api.github.com/users/keisuke-umezawa/following{/other_user}", "gists_url": "https://api.github.com/users/keisuke-umezawa/gists{/gist_id}", "starred_url": "https://api.github.com/users/keisuke-umezawa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/keisuke-umezawa/subscriptions", "organizations_url": "https://api.github.com/users/keisuke-umezawa/orgs", "repos_url": "https://api.github.com/users/keisuke-umezawa/repos", "events_url": "https://api.github.com/users/keisuke-umezawa/events{/privacy}", "received_events_url": "https://api.github.com/users/keisuke-umezawa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "keisuke-umezawa", "id": 1277089, "node_id": "MDQ6VXNlcjEyNzcwODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1277089?v=4", "gravatar_id": "", "url": "https://api.github.com/users/keisuke-umezawa", "html_url": "https://github.com/keisuke-umezawa", "followers_url": "https://api.github.com/users/keisuke-umezawa/followers", "following_url": "https://api.github.com/users/keisuke-umezawa/following{/other_user}", "gists_url": "https://api.github.com/users/keisuke-umezawa/gists{/gist_id}", "starred_url": "https://api.github.com/users/keisuke-umezawa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/keisuke-umezawa/subscriptions", "organizations_url": "https://api.github.com/users/keisuke-umezawa/orgs", "repos_url": "https://api.github.com/users/keisuke-umezawa/repos", "events_url": "https://api.github.com/users/keisuke-umezawa/events{/privacy}", "received_events_url": "https://api.github.com/users/keisuke-umezawa/received_events", "type": "User", "site_admin": false}, {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/36", "html_url": "https://github.com/optuna/optuna/milestone/36", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/36/labels", "id": 6809937, "node_id": "MDk6TWlsZXN0b25lNjgwOTkzNw==", "number": 36, "title": "v2.9.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 47, "state": "closed", "created_at": "2021-06-01T01:07:05Z", "updated_at": "2021-08-02T06:09:08Z", "due_on": null, "closed_at": "2021-08-02T06:09:08Z"}, "comments": 7, "created_at": "2021-06-09T15:08:43Z", "updated_at": "2021-06-10T07:53:44Z", "closed_at": "2021-06-10T07:53:22Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2739", "html_url": "https://github.com/optuna/optuna/pull/2739", "diff_url": "https://github.com/optuna/optuna/pull/2739.diff", "patch_url": "https://github.com/optuna/optuna/pull/2739.patch", "merged_at": "2021-06-10T07:53:22Z"}, "body": "## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nAs @tohmae discovered in https://github.com/optuna/optuna/pull/2734#issuecomment-857649769, the current master `TPESampler` causes an error when the objective function has parameters containing branching. This is because we cast the parameter values to `float` before removing `None` in `TPESampler._split_observation_pairs`. This PR fix the error.\r\n\r\n\r\n## Description of the changes\r\n- Remove nan instead of None\r\n- Make `_split_observation_pairs` a free function\r\n- Add test\r\n\r\n## How to reproduce the error.\r\nExecute https://github.com/optuna/optuna-examples/blob/main/xgboost/xgboost_simple.py with the current master (https://github.com/optuna/optuna/commit/5de458987d7f027f59a140b4391d1991bcb73e42)\r\n\r\nError logs:\r\n```\r\n(venv) mamu@HideakinoMacBook-puro optuna-examples % python ./xgboost/xgboost_simple.py\r\n[I 2021-06-09 23:50:50,364] A new study created in memory with name: no-name-8c7ec59f-9eec-4b44-a567-92ad87b034c9\r\n[I 2021-06-09 23:50:50,380] Trial 0 finished with value: 0.8321678321678322 and parameters: {'booster': 'gblinear', 'lambda': 0.040398224953566465, 'alpha': 0.5443271290979902, 'subsample': 0.9824882214036883, 'colsample_bytree': 0.8993790284987895}. Best is trial 0 with value: 0.8321678321678322.\r\n[I 2021-06-09 23:50:50,396] Trial 1 finished with value: 0.9370629370629371 and parameters: {'booster': 'gblinear', 'lambda': 5.1215991618968e-07, 'alpha': 2.5389780441107583e-07, 'subsample': 0.3087557340681471, 'colsample_bytree': 0.6748019528883034}. Best is trial 1 with value: 0.9370629370629371.\r\n[I 2021-06-09 23:50:50,419] Trial 2 finished with value: 0.9230769230769231 and parameters: {'booster': 'gblinear', 'lambda': 0.009706741622334536, 'alpha': 0.05731950271820943, 'subsample': 0.2768919453042081, 'colsample_bytree': 0.29044111320457777}. Best is trial 1 with value: 0.9370629370629371.\r\n[I 2021-06-09 23:50:50,447] Trial 3 finished with value: 0.9370629370629371 and parameters: {'booster': 'gbtree', 'lambda': 0.002801324673032621, 'alpha': 8.77678561131975e-06, 'subsample': 0.2824301743195605, 'colsample_bytree': 0.9209405766613006, 'max_depth': 7, 'min_child_weight': 6, 'eta': 0.00018224151539981037, 'gamma': 0.006771053282283436, 'grow_policy': 'lossguide'}. Best is trial 1 with value: 0.9370629370629371.\r\n[I 2021-06-09 23:50:50,477] Trial 4 finished with value: 0.9230769230769231 and parameters: {'booster': 'dart', 'lambda': 0.8625890552039833, 'alpha': 3.702240957256518e-08, 'subsample': 0.8817257155243725, 'colsample_bytree': 0.25821315901446795, 'max_depth': 9, 'min_child_weight': 9, 'eta': 6.276758483441583e-07, 'gamma': 0.002234134294509528, 'grow_policy': 'lossguide', 'sample_type': 'uniform', 'normalize_type': 'forest', 'rate_drop': 0.0042353012141847285, 'skip_drop': 2.203775877284396e-06}. Best is trial 1 with value: 0.9370629370629371.\r\n[I 2021-06-09 23:50:50,494] Trial 5 finished with value: 0.9020979020979021 and parameters: {'booster': 'gblinear', 'lambda': 0.04477960826403899, 'alpha': 0.26904318327505633, 'subsample': 0.6249821608759203, 'colsample_bytree': 0.29193691489242024}. Best is trial 1 with value: 0.9370629370629371.\r\n[I 2021-06-09 23:50:50,534] Trial 6 finished with value: 0.9230769230769231 and parameters: {'booster': 'gbtree', 'lambda': 1.602889292272454e-07, 'alpha': 0.016671612106849323, 'subsample': 0.8106009566846204, 'colsample_bytree': 0.583769315682823, 'max_depth': 7, 'min_child_weight': 10, 'eta': 0.0007125974117337914, 'gamma': 4.030224436007477e-05, 'grow_policy': 'lossguide'}. Best is trial 1 with value: 0.9370629370629371.\r\n[I 2021-06-09 23:50:50,560] Trial 7 finished with value: 0.9090909090909091 and parameters: {'booster': 'gbtree', 'lambda': 0.0002106202492135643, 'alpha': 1.1772928216750774e-07, 'subsample': 0.2603990025637316, 'colsample_bytree': 0.38094833891962826, 'max_depth': 3, 'min_child_weight': 6, 'eta': 3.8906958028388586e-08, 'gamma': 0.00021830157418713093, 'grow_policy': 'depthwise'}. Best is trial 1 with value: 0.9370629370629371.\r\n[I 2021-06-09 23:50:50,581] Trial 8 finished with value: 0.9300699300699301 and parameters: {'booster': 'gblinear', 'lambda': 5.6590034731208574e-08, 'alpha': 0.004626874994323875, 'subsample': 0.6181073251904217, 'colsample_bytree': 0.6557153334766561}. Best is trial 1 with value: 0.9370629370629371.\r\n[I 2021-06-09 23:50:50,609] Trial 9 finished with value: 0.972027972027972 and parameters: {'booster': 'dart', 'lambda': 0.12198765442066387, 'alpha': 0.00016278380419690108, 'subsample': 0.604445508805894, 'colsample_bytree': 0.30814867066506546, 'max_depth': 5, 'min_child_weight': 7, 'eta': 8.213226691474149e-08, 'gamma': 0.005631033075392603, 'grow_policy': 'lossguide', 'sample_type': 'weighted', 'normalize_type': 'tree', 'rate_drop': 0.00018656823367699428, 'skip_drop': 5.282717829309669e-08}. Best is trial 9 with value: 0.972027972027972.\r\n[W 2021-06-09 23:50:50,659] Trial 10 failed because of the following error: IndexError('index -9223372036854775808 is out of bounds for axis 1 with size 2')\r\nTraceback (most recent call last):\r\n  File \"/Users/mamu/Dev/pfn/optuna/optuna/_optimize.py\", line 216, in _run_trial\r\n    value_or_values = func(trial)\r\n  File \"/Users/mamu/Dev/pfn/optuna-examples/./xgboost/xgboost_simple.py\", line 51, in objective\r\n    param[\"grow_policy\"] = trial.suggest_categorical(\"grow_policy\", [\"depthwise\", \"lossguide\"])\r\n  File \"/Users/mamu/Dev/pfn/optuna/optuna/trial/_trial.py\", line 505, in suggest_categorical\r\n    return self._suggest(name, CategoricalDistribution(choices=choices))\r\n  File \"/Users/mamu/Dev/pfn/optuna/optuna/trial/_trial.py\", line 716, in _suggest\r\n    param_value = self.study.sampler.sample_independent(\r\n  File \"/Users/mamu/Dev/pfn/optuna/optuna/samplers/_tpe/sampler.py\", line 402, in sample_independent\r\n    mpe_above = _ParzenEstimator(\r\n  File \"/Users/mamu/Dev/pfn/optuna/optuna/samplers/_tpe/parzen_estimator.py\", line 83, in __init__\r\n    categorical_weights = self._calculate_categorical_params(\r\n  File \"/Users/mamu/Dev/pfn/optuna/optuna/samplers/_tpe/parzen_estimator.py\", line 348, in _calculate_categorical_params\r\n    weights[np.arange(n_observations), observations] += 1\r\nIndexError: index -9223372036854775808 is out of bounds for axis 1 with size 2\r\nTraceback (most recent call last):\r\n  File \"/Users/mamu/Dev/pfn/optuna-examples/./xgboost/xgboost_simple.py\", line 68, in <module>\r\n    study.optimize(objective, n_trials=100, timeout=600)\r\n  File \"/Users/mamu/Dev/pfn/optuna/optuna/study.py\", line 401, in optimize\r\n    _optimize(\r\n  File \"/Users/mamu/Dev/pfn/optuna/optuna/_optimize.py\", line 65, in _optimize\r\n    _optimize_sequential(\r\n  File \"/Users/mamu/Dev/pfn/optuna/optuna/_optimize.py\", line 162, in _optimize_sequential\r\n    trial = _run_trial(study, func, catch)\r\n  File \"/Users/mamu/Dev/pfn/optuna/optuna/_optimize.py\", line 267, in _run_trial\r\n    raise func_err\r\n  File \"/Users/mamu/Dev/pfn/optuna/optuna/_optimize.py\", line 216, in _run_trial\r\n    value_or_values = func(trial)\r\n  File \"/Users/mamu/Dev/pfn/optuna-examples/./xgboost/xgboost_simple.py\", line 51, in objective\r\n    param[\"grow_policy\"] = trial.suggest_categorical(\"grow_policy\", [\"depthwise\", \"lossguide\"])\r\n  File \"/Users/mamu/Dev/pfn/optuna/optuna/trial/_trial.py\", line 505, in suggest_categorical\r\n    return self._suggest(name, CategoricalDistribution(choices=choices))\r\n  File \"/Users/mamu/Dev/pfn/optuna/optuna/trial/_trial.py\", line 716, in _suggest\r\n    param_value = self.study.sampler.sample_independent(\r\n  File \"/Users/mamu/Dev/pfn/optuna/optuna/samplers/_tpe/sampler.py\", line 402, in sample_independent\r\n    mpe_above = _ParzenEstimator(\r\n  File \"/Users/mamu/Dev/pfn/optuna/optuna/samplers/_tpe/parzen_estimator.py\", line 83, in __init__\r\n    categorical_weights = self._calculate_categorical_params(\r\n  File \"/Users/mamu/Dev/pfn/optuna/optuna/samplers/_tpe/parzen_estimator.py\", line 348, in _calculate_categorical_params\r\n    weights[np.arange(n_observations), observations] += 1\r\nIndexError: index -9223372036854775808 is out of bounds for axis 1 with size 2\r\n```\r\n\r\n## How to confirm that the error is fixed.\r\nSucceeded to execute the above example `xgboost_simple.py`.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2739/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2739/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2733", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2733/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2733/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2733/events", "html_url": "https://github.com/optuna/optuna/issues/2733", "id": 913998375, "node_id": "MDU6SXNzdWU5MTM5OTgzNzU=", "number": 2733, "title": "Wrong Best Value Report", "user": {"login": "etetteh", "id": 28512232, "node_id": "MDQ6VXNlcjI4NTEyMjMy", "avatar_url": "https://avatars.githubusercontent.com/u/28512232?v=4", "gravatar_id": "", "url": "https://api.github.com/users/etetteh", "html_url": "https://github.com/etetteh", "followers_url": "https://api.github.com/users/etetteh/followers", "following_url": "https://api.github.com/users/etetteh/following{/other_user}", "gists_url": "https://api.github.com/users/etetteh/gists{/gist_id}", "starred_url": "https://api.github.com/users/etetteh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/etetteh/subscriptions", "organizations_url": "https://api.github.com/users/etetteh/orgs", "repos_url": "https://api.github.com/users/etetteh/repos", "events_url": "https://api.github.com/users/etetteh/events{/privacy}", "received_events_url": "https://api.github.com/users/etetteh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2021-06-07T22:19:29Z", "updated_at": "2021-06-08T01:19:46Z", "closed_at": "2021-06-08T01:19:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am using the optuna v2.8.0, but the following results does not look like what I expect.\r\nThe optimization is to maximize the average ROCAUC, and I don't understand why the value 11.2961 from epoch 1 is the best.\r\n\r\n![Screenshot from 2021-06-07 18-18-48](https://user-images.githubusercontent.com/28512232/121094554-d36f5500-c7bc-11eb-9fd8-6e98e35a5768.png)\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2733/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2733/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2732", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2732/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2732/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2732/events", "html_url": "https://github.com/optuna/optuna/issues/2732", "id": 913976572, "node_id": "MDU6SXNzdWU5MTM5NzY1NzI=", "number": 2732, "title": "'MedianPruner' object has no attribute '_n_min_trials'", "user": {"login": "chrismaliszewski", "id": 7532602, "node_id": "MDQ6VXNlcjc1MzI2MDI=", "avatar_url": "https://avatars.githubusercontent.com/u/7532602?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chrismaliszewski", "html_url": "https://github.com/chrismaliszewski", "followers_url": "https://api.github.com/users/chrismaliszewski/followers", "following_url": "https://api.github.com/users/chrismaliszewski/following{/other_user}", "gists_url": "https://api.github.com/users/chrismaliszewski/gists{/gist_id}", "starred_url": "https://api.github.com/users/chrismaliszewski/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chrismaliszewski/subscriptions", "organizations_url": "https://api.github.com/users/chrismaliszewski/orgs", "repos_url": "https://api.github.com/users/chrismaliszewski/repos", "events_url": "https://api.github.com/users/chrismaliszewski/events{/privacy}", "received_events_url": "https://api.github.com/users/chrismaliszewski/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-06-07T21:39:03Z", "updated_at": "2021-06-16T12:56:13Z", "closed_at": "2021-06-16T12:56:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "The same kind of issue as https://github.com/optuna/optuna/issues/2729 after updating to 2.8.0 with a study loaded from pickle that was created on 2.5.0.\r\n\r\nTrace:\r\n```Epoch 1/4\r\n   6/1214 [..............................] - ETA: 5:32 - loss: -0.1459 - accuracy: 0.0100 - binary_crossentropy: 0.9002 - binary_accuracy: 0.4804 - cosine_similarity: 0.1459 - categorical_crossentropy: 5.7268WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.1194s vs `on_train_batch_end` time: 0.1305s). Check your callbacks.\r\n1214/1214 [==============================] - 395s 293ms/step - loss: -0.7491 - accuracy: 0.2546 - binary_crossentropy: 1.3429 - binary_accuracy: 0.8657 - cosine_similarity: 0.7491 - categorical_crossentropy: 3.6063 - val_loss: -0.5604 - val_accuracy: 0.2891 - val_binary_crossentropy: 0.4177 - val_binary_accuracy: 0.8896 - val_cosine_similarity: 0.5604 - val_categorical_crossentropy: 4.8951\r\n[W 2021-06-07 21:34:47,809] Trial 143 failed because of the following error: AttributeError(\"'MedianPruner' object has no attribute '_n_min_trials'\")\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.7/dist-packages/optuna/_optimize.py\", line 216, in _run_trial\r\n    value_or_values = func(trial)\r\n  File \"<ipython-input-6-c2a95d8e8976>\", line 181, in objective\r\n    callbacks=callbacks,\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/training.py\", line 1229, in fit\r\n    callbacks.on_epoch_end(epoch, epoch_logs)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/callbacks.py\", line 435, in on_epoch_end\r\n    callback.on_epoch_end(epoch, logs)\r\n  File \"/usr/local/lib/python3.7/dist-packages/optuna/integration/tfkeras.py\", line 60, in on_epoch_end\r\n    if self._trial.should_prune():\r\n  File \"/usr/local/lib/python3.7/dist-packages/optuna/trial/_trial.py\", line 626, in should_prune\r\n    return self.study.pruner.prune(self.study, trial)\r\n  File \"/usr/local/lib/python3.7/dist-packages/optuna/pruners/_percentile.py\", line 207, in prune\r\n    all_trials, direction, step, self._percentile, self._n_min_trials\r\nAttributeError: 'MedianPruner' object has no attribute '_n_min_trials'\r\n```\r\n```/usr/local/lib/python3.7/dist-packages/optuna/study.py in optimize(self, func, n_trials, timeout, n_jobs, catch, callbacks, gc_after_trial, show_progress_bar)\r\n    408             callbacks=callbacks,\r\n    409             gc_after_trial=gc_after_trial,\r\n--> 410             show_progress_bar=show_progress_bar,\r\n    411         )\r\n    412 \r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/_optimize.py in _optimize(study, func, n_trials, timeout, n_jobs, catch, callbacks, gc_after_trial, show_progress_bar)\r\n     73                 reseed_sampler_rng=False,\r\n     74                 time_start=None,\r\n---> 75                 progress_bar=progress_bar,\r\n     76             )\r\n     77         else:\r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/_optimize.py in _optimize_sequential(study, func, n_trials, timeout, catch, callbacks, gc_after_trial, reseed_sampler_rng, time_start, progress_bar)\r\n    160 \r\n    161         try:\r\n--> 162             trial = _run_trial(study, func, catch)\r\n    163         except Exception:\r\n    164             raise\r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/_optimize.py in _run_trial(study, func, catch)\r\n    265 \r\n    266     if state == TrialState.FAIL and func_err is not None and not isinstance(func_err, catch):\r\n--> 267         raise func_err\r\n    268     return trial\r\n    269 \r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/_optimize.py in _run_trial(study, func, catch)\r\n    214 \r\n    215     try:\r\n--> 216         value_or_values = func(trial)\r\n    217     except exceptions.TrialPruned as e:\r\n    218         # TODO(mamu): Handle multi-objective cases.\r\n\r\n<ipython-input-6-c2a95d8e8976> in objective(trial)\r\n    179         validation_data=(data[1][INPUT_FORMAT], data[1][OUTPUT_FORMAT]),\r\n    180         # validation_steps=VALIDATION_STEPS,\r\n--> 181         callbacks=callbacks,\r\n    182     )\r\n    183 \r\n\r\n/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/training.py in fit(self, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_batch_size, validation_freq, max_queue_size, workers, use_multiprocessing)\r\n   1227           epoch_logs.update(val_logs)\r\n   1228 \r\n-> 1229         callbacks.on_epoch_end(epoch, epoch_logs)\r\n   1230         training_logs = epoch_logs\r\n   1231         if self.stop_training:\r\n\r\n/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/callbacks.py in on_epoch_end(self, epoch, logs)\r\n    433     logs = self._process_logs(logs)\r\n    434     for callback in self.callbacks:\r\n--> 435       callback.on_epoch_end(epoch, logs)\r\n    436 \r\n    437   def on_train_batch_begin(self, batch, logs=None):\r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/integration/tfkeras.py in on_epoch_end(self, epoch, logs)\r\n     58 \r\n     59         # Prune trial if needed\r\n---> 60         if self._trial.should_prune():\r\n     61             message = \"Trial was pruned at epoch {}.\".format(epoch)\r\n     62             raise optuna.TrialPruned(message)\r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/trial/_trial.py in should_prune(self)\r\n    624 \r\n    625         trial = self.study._storage.get_trial(self._trial_id)\r\n--> 626         return self.study.pruner.prune(self.study, trial)\r\n    627 \r\n    628     def set_user_attr(self, key: str, value: Any) -> None:\r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/pruners/_percentile.py in prune(self, study, trial)\r\n    205 \r\n    206         p = _get_percentile_intermediate_result_over_trials(\r\n--> 207             all_trials, direction, step, self._percentile, self._n_min_trials\r\n    208         )\r\n    209         if math.isnan(p):\r\n\r\nAttributeError: 'MedianPruner' object has no attribute '_n_min_trials'\r\n```\r\n\r\nPresumably, to solve the issue I'll need to instantiate MedianPruner after loading the study.\r\n\r\nPlease make the error message better that suggests where the problem is. Another possible solution was provided in the attached issue.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2732/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2732/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2731", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2731/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2731/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2731/events", "html_url": "https://github.com/optuna/optuna/pull/2731", "id": 913731805, "node_id": "MDExOlB1bGxSZXF1ZXN0NjYzNzE5ODU0", "number": 2731, "title": "Use `repr` and `eval` to restore pruner parameters in AllenNLP integration", "user": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561256, "node_id": "MDU6TGFiZWwxOTQ3NTYxMjU2", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.integration", "name": "optuna.integration", "color": "1c659e", "default": false, "description": "Related to the `optuna.integration` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/36", "html_url": "https://github.com/optuna/optuna/milestone/36", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/36/labels", "id": 6809937, "node_id": "MDk6TWlsZXN0b25lNjgwOTkzNw==", "number": 36, "title": "v2.9.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 47, "state": "closed", "created_at": "2021-06-01T01:07:05Z", "updated_at": "2021-08-02T06:09:08Z", "due_on": null, "closed_at": "2021-08-02T06:09:08Z"}, "comments": 5, "created_at": "2021-06-07T16:28:59Z", "updated_at": "2021-06-10T12:39:55Z", "closed_at": "2021-06-10T11:50:35Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2731", "html_url": "https://github.com/optuna/optuna/pull/2731", "diff_url": "https://github.com/optuna/optuna/pull/2731.diff", "patch_url": "https://github.com/optuna/optuna/pull/2731.patch", "merged_at": "2021-06-10T11:50:35Z"}, "body": "The current implementation of AllenNLP integration doesn't handle `None` correctly.\r\nWhen `None` is given as a parameter, it is saved as a string value of `\"None\"`.\r\nThis causes an error in `AllenNLPPruningCallback`.\r\n\r\nIn advance of this PR, we explored another approach to save a repr value of pruner and\r\nrestore it using eval. But this approach could induce some restriction to future implementation of the pruner.\r\nThen we decided to fix the current implementation instead of changing the way of saving/restoring pruners.\r\nFor a detailed discussion, please see https://github.com/optuna/optuna/pull/2707.\r\n\r\n## Motivation\r\nResolve https://github.com/himkt/allennlp-optuna/issues/39.\r\n\r\n## Description of the changes\r\n- a06cfae removes `infer_and_cast` and add `repr` and `eval` to restore pruner parameters\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2731/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2731/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2729", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2729/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2729/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2729/events", "html_url": "https://github.com/optuna/optuna/issues/2729", "id": 913277815, "node_id": "MDU6SXNzdWU5MTMyNzc4MTU=", "number": 2729, "title": "'TPESampler' object has no attribute '_group'", "user": {"login": "chrismaliszewski", "id": 7532602, "node_id": "MDQ6VXNlcjc1MzI2MDI=", "avatar_url": "https://avatars.githubusercontent.com/u/7532602?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chrismaliszewski", "html_url": "https://github.com/chrismaliszewski", "followers_url": "https://api.github.com/users/chrismaliszewski/followers", "following_url": "https://api.github.com/users/chrismaliszewski/following{/other_user}", "gists_url": "https://api.github.com/users/chrismaliszewski/gists{/gist_id}", "starred_url": "https://api.github.com/users/chrismaliszewski/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chrismaliszewski/subscriptions", "organizations_url": "https://api.github.com/users/chrismaliszewski/orgs", "repos_url": "https://api.github.com/users/chrismaliszewski/repos", "events_url": "https://api.github.com/users/chrismaliszewski/events{/privacy}", "received_events_url": "https://api.github.com/users/chrismaliszewski/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-06-07T08:26:52Z", "updated_at": "2021-06-16T12:55:40Z", "closed_at": "2021-06-16T12:55:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "The bug appears as soon as I run optimize method on a loaded study. \r\n\r\nStrangely, the study worked today (2021-06-07) a few hours earlier but when I wanted to continue it further, the bug started to appear. Interestingly, the study that works fine on v.2.5.0 which I have on my local machine and confirmed the study working on Colab with v.2.5.0! \r\nI think the study was saved by the earlier version than the current one, 2.8.0, and there is something wrong with 2.8.0. \r\n\r\n## Expected behavior\r\nThe study is being optimized without the error.\r\n\r\n## Environment\r\nColab, Optuna 2.8.0\r\n\r\n## Error messages, stack traces, or logs\r\nError message as the title of the issue: 'TPESampler' object has no attribute '_group'\r\n\r\n```\r\n/usr/local/lib/python3.7/dist-packages/optuna/study.py in optimize(self, func, n_trials, timeout, n_jobs, catch, callbacks, gc_after_trial, show_progress_bar)\r\n    408             callbacks=callbacks,\r\n    409             gc_after_trial=gc_after_trial,\r\n--> 410             show_progress_bar=show_progress_bar,\r\n    411         )\r\n    412 \r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/_optimize.py in _optimize(study, func, n_trials, timeout, n_jobs, catch, callbacks, gc_after_trial, show_progress_bar)\r\n     73                 reseed_sampler_rng=False,\r\n     74                 time_start=None,\r\n---> 75                 progress_bar=progress_bar,\r\n     76             )\r\n     77         else:\r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/_optimize.py in _optimize_sequential(study, func, n_trials, timeout, catch, callbacks, gc_after_trial, reseed_sampler_rng, time_start, progress_bar)\r\n    160 \r\n    161         try:\r\n--> 162             trial = _run_trial(study, func, catch)\r\n    163         except Exception:\r\n    164             raise\r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/_optimize.py in _run_trial(study, func, catch)\r\n    195                 failed_trial_callback(study, failed_trial)\r\n    196 \r\n--> 197     trial = study.ask()\r\n    198 \r\n    199     state: Optional[TrialState] = None\r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/study.py in ask(self, fixed_distributions)\r\n    485         if trial_id is None:\r\n    486             trial_id = self._storage.create_new_trial(self._study_id)\r\n--> 487         trial = trial_module.Trial(self, trial_id)\r\n    488 \r\n    489         for name, param in fixed_distributions.items():\r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/trial/_trial.py in __init__(self, study, trial_id)\r\n     55         self.storage = self.study._storage\r\n     56 \r\n---> 57         self._init_relative_params()\r\n     58 \r\n     59     def _init_relative_params(self) -> None:\r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/trial/_trial.py in _init_relative_params(self)\r\n     65         self.relative_search_space = self.study.sampler.infer_relative_search_space(study, trial)\r\n     66         self.relative_params = self.study.sampler.sample_relative(\r\n---> 67             study, trial, self.relative_search_space\r\n     68         )\r\n     69 \r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/samplers/_tpe/sampler.py in sample_relative(self, study, trial, search_space)\r\n    327         self._raise_error_if_multi_objective(study)\r\n    328 \r\n--> 329         if self._group:\r\n    330             assert self._search_space_group is not None\r\n    331             params = {}\r\n\r\nAttributeError: 'TPESampler' object has no attribute '_group'\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2729/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2729/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2728", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2728/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2728/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2728/events", "html_url": "https://github.com/optuna/optuna/pull/2728", "id": 913092476, "node_id": "MDExOlB1bGxSZXF1ZXN0NjYzMTY5MTg5", "number": 2728, "title": "Fix results not reproducible when running AllenNLPExecutor multiple t\u2026 (Backport of #2717)", "user": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561256, "node_id": "MDU6TGFiZWwxOTQ3NTYxMjU2", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.integration", "name": "optuna.integration", "color": "1c659e", "default": false, "description": "Related to the `optuna.integration` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/35", "html_url": "https://github.com/optuna/optuna/milestone/35", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/35/labels", "id": 6618764, "node_id": "MDk6TWlsZXN0b25lNjYxODc2NA==", "number": 35, "title": "v2.8.0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 89, "state": "closed", "created_at": "2021-04-02T05:04:44Z", "updated_at": "2021-06-07T07:06:35Z", "due_on": null, "closed_at": "2021-06-07T07:06:35Z"}, "comments": 2, "created_at": "2021-06-07T05:03:11Z", "updated_at": "2021-06-07T06:33:29Z", "closed_at": "2021-06-07T05:44:57Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2728", "html_url": "https://github.com/optuna/optuna/pull/2728", "diff_url": "https://github.com/optuna/optuna/pull/2728.diff", "patch_url": "https://github.com/optuna/optuna/pull/2728.patch", "merged_at": "2021-06-07T05:44:57Z"}, "body": "Fix results not reproducible when running AllenNLPExecutor multiple t\u2026\r\n\r\n<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n\r\nSee below.\r\n\r\n## Description of the changes\r\n\r\nBackport of https://github.com/optuna/optuna/pull/2717 to include bug fix in v2.8.0.\r\n\r\nCc. @himkt ", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2728/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2728/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2726", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2726/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2726/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2726/events", "html_url": "https://github.com/optuna/optuna/issues/2726", "id": 911472303, "node_id": "MDU6SXNzdWU5MTE0NzIzMDM=", "number": 2726, "title": "Pruning with PyTorch and mp.spawn", "user": {"login": "tfurmston", "id": 11030437, "node_id": "MDQ6VXNlcjExMDMwNDM3", "avatar_url": "https://avatars.githubusercontent.com/u/11030437?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tfurmston", "html_url": "https://github.com/tfurmston", "followers_url": "https://api.github.com/users/tfurmston/followers", "following_url": "https://api.github.com/users/tfurmston/following{/other_user}", "gists_url": "https://api.github.com/users/tfurmston/gists{/gist_id}", "starred_url": "https://api.github.com/users/tfurmston/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tfurmston/subscriptions", "organizations_url": "https://api.github.com/users/tfurmston/orgs", "repos_url": "https://api.github.com/users/tfurmston/repos", "events_url": "https://api.github.com/users/tfurmston/events{/privacy}", "received_events_url": "https://api.github.com/users/tfurmston/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-06-04T12:51:35Z", "updated_at": "2021-09-29T23:05:08Z", "closed_at": "2021-09-29T23:05:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n## Expected behavior\r\n\r\nI have noticed an issue with pruning functionality. In particular, when used with PyTorch in a distributed manner using the `DistributedDataParallel` class and `mp.spawn`.\r\n\r\nI have a model training function (called `perform_model_training`) that is called by `mp.spawn` within my Optuna objective function. When calling `perform_model_training` I pass in the `trial` object so that I can report the intermediate metrics and prune as appropriate.\r\n\r\nI expect the pruning to happen as documented.\r\n\r\nAlso, I have tried `TorchDistributedTrial`, but it hangs for me when trying to report metrics using the approach approach.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.7.0\r\n- Python version: 3.8\r\n- OS: MacOS\r\n- (Optional) Other libraries and their versions:\r\n\r\n## Error messages, stack traces, or logs\r\n\r\nI have no error message, per se, it is just that no pruning occurs at all.\r\n\r\n```\r\n# error messages, stack traces, or logs\r\n```\r\n\r\n## Steps to reproduce\r\n\r\nI'm not sure what steps you would like me to detail. I have included the core part of the problem code below.\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\n\r\ndef objective(trial: BaseTrial, node_rank: int, node_size: int, world_size: int, data_path: str = None) -> float:\r\n    sampled_parameters = sample_hyperparameters(trial)\r\n    logger.info('Hyper-Parameters: %s', sampled_parameters)\r\n\r\n    with tempfile.TemporaryDirectory() as model_log_path:\r\n        # The perform_model_training function does the actual distributed model training over all epochs. This is where\r\n        # the calls:\r\n        #        -> trial.report\r\n        #        -> trial.should_prune\r\n        # are made after each epoch.\r\n        mp.spawn(\r\n            perform_model_training,\r\n            nprocs=node_size,\r\n            args=(\r\n                node_rank,\r\n                node_size,\r\n                world_size,\r\n                trial.suggest_int('num_epochs', 2, 200),\r\n                trial.suggest_float('learning_rate', 0.001, 0.005),\r\n                trial.suggest_int('batch_size', 50, 150),\r\n                trial.suggest_float('momentum', 0.25, 0.75),\r\n                model_log_path,\r\n                trial,\r\n                data_path,\r\n            ),\r\n        )\r\n        # load metrics from file, as you can't return results directly from mp.spawn\r\n        val_metrics = load_model_training_results(model_log_path)\r\n    return val_metrics[sampled_parameters['num_epochs']]['negative_log_likelihood']\r\n\r\n\r\n\r\nos.environ['MASTER_ADDR'] = 'localhost'\r\nos.environ['MASTER_PORT'] = '12355'\r\npartial_objective = partial(\r\n    objective,\r\n    node_rank=0,\r\n    node_size=4,\r\n    world_size=4,\r\n    data_path='/data',\r\n)\r\nstudy = optuna.create_study(pruner=optuna.pruners.MedianPruner())\r\nstudy.optimize(partial_objective, n_trials=10)\r\n\r\n```\r\n\r\n## Additional context (optional)\r\n\r\nWhen running this example I have noticed that no pruning occurs at all. I did some investigating and I have the reason for the issue. \r\n\r\nEssentially, when `mp.spawn` is called it makes a copy of the trial object for each of the individual processes. When the metrics are reported to the trial in the rank zero proess, or any of them actually, it is reporting them to the copy of the original trial. \r\n\r\nTherefore the original trial continues to have no reported metrics, which means that in future trials there are no stored trials that will be used to determine whether to prune the current trial. \r\n\r\nHopefully I have explained the problem clearly. \r\n\r\nFor the moment I have resolved the issue by writing the validation metrics to file, loading them in the main process after the training run finishes and then manually reporting each one to the original trial. It's not very elegant, but it is working. I suppose an alternative would be to use queues, but still it seems like it is quite a manual process to set up for pruning.\r\n\r\nNot sure what you would suggest, but I wanted to highlight the issue. Perhaps a working example to cover this case would be helpful? The current documentation doesn't cover this type of workflow for Pytorch. Or perhaps you have other suggestions?\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2726/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2726/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2722", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2722/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2722/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2722/events", "html_url": "https://github.com/optuna/optuna/issues/2722", "id": 910656342, "node_id": "MDU6SXNzdWU5MTA2NTYzNDI=", "number": 2722, "title": "Trial will not be saved if database file is removed after start", "user": {"login": "pyscorcher", "id": 59569502, "node_id": "MDQ6VXNlcjU5NTY5NTAy", "avatar_url": "https://avatars.githubusercontent.com/u/59569502?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pyscorcher", "html_url": "https://github.com/pyscorcher", "followers_url": "https://api.github.com/users/pyscorcher/followers", "following_url": "https://api.github.com/users/pyscorcher/following{/other_user}", "gists_url": "https://api.github.com/users/pyscorcher/gists{/gist_id}", "starred_url": "https://api.github.com/users/pyscorcher/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pyscorcher/subscriptions", "organizations_url": "https://api.github.com/users/pyscorcher/orgs", "repos_url": "https://api.github.com/users/pyscorcher/repos", "events_url": "https://api.github.com/users/pyscorcher/events{/privacy}", "received_events_url": "https://api.github.com/users/pyscorcher/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-06-03T16:19:21Z", "updated_at": "2021-07-05T01:59:28Z", "closed_at": "2021-07-05T01:59:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "If we start a trial which creates a new study (that is, also creates a new sqlite database file), and then *remove* said database file before the trial has finished, the data of that trial is lost.\r\n\r\n## Expected behavior\r\n\r\nI understand that for an efficient distributed training the database file needs to be created *first*, but it would make sense to create a new database file at the *end* of a trial if it doesn't exist anymore.  This would be especially helpful for trials that take very long.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.7\r\n- Python version: 3.9\r\n- OS: Ubuntu 18.04\r\n\r\n## Error messages, stack traces, or logs\r\n\r\nIf we do remove the database file during the first trial, following error will occur at the end of said trial:\r\n```\r\nTraceback (most recent call last):\r\n  File \"/opt/anaconda3/lib/python3.9/site-packages/optuna/_optimize.py\", line 244, in _run_trial\r\n    study.tell(trial, values=values, state=state)\r\n  File \"/opt/anaconda3/lib/python3.9/site-packages/optuna/study.py\", line 664, in tell\r\n    self._storage.set_trial_state(trial_id, state)\r\n  File \"/opt/anaconda3/lib/python3.9/site-packages/optuna/storages/_cached_storage.py\", line 214, in set_trial_state\r\n    return self._flush_trial(trial_id)\r\n  File \"/opt/anaconda3/lib/python3.9/site-packages/optuna/storages/_cached_storage.py\", line 427, in _flush_trial\r\n    return self._backend._update_trial(\r\n  File \"/opt/anaconda3/lib/python3.9/site-packages/optuna/storages/_rdb/storage.py\", line 668, in _update_trial\r\n    trial_model = models.TrialModel.find_or_raise_by_id(trial_id, session)\r\n  File \"/opt/anaconda3/lib/python3.9/site-packages/optuna/storages/_rdb/models.py\", line 243, in find_or_raise_by_id\r\n    raise KeyError(NOT_FOUND_MSG)\r\nKeyError: 'Record does not exist.'\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/user/proj/script.py\", line 91, in <module>\r\n    main()\r\n  File \"/home/user/proj/script.py\", line 86, in main\r\n    study.optimize(objective, n_trials=100)\r\n  File \"/opt/anaconda3/lib/python3.9/site-packages/optuna/study.py\", line 400, in optimize\r\n    _optimize(\r\n  File \"/opt/anaconda3/lib/python3.9/site-packages/optuna/_optimize.py\", line 66, in _optimize\r\n    _optimize_sequential(\r\n  File \"/opt/anaconda3/lib/python3.9/site-packages/optuna/_optimize.py\", line 163, in _optimize_sequential\r\n    trial = _run_trial(study, func, catch)\r\n  File \"/opt/anaconda3/lib/python3.9/site-packages/optuna/_optimize.py\", line 249, in _run_trial\r\n    study._log_completed_trial(trial, cast(List[float], values))\r\n  File \"/opt/anaconda3/lib/python3.9/site-packages/optuna/study.py\", line 1014, in _log_completed_trial\r\n    self.best_trial.number,\r\n  File \"/opt/anaconda3/lib/python3.9/site-packages/optuna/study.py\", line 97, in best_trial\r\n    return copy.deepcopy(self._storage.get_best_trial(self._study_id))\r\n  File \"/opt/anaconda3/lib/python3.9/site-packages/optuna/storages/_cached_storage.py\", line 284, in get_best_trial\r\n    return self._backend.get_best_trial(study_id)\r\n  File \"/opt/anaconda3/lib/python3.9/site-packages/optuna/storages/_rdb/storage.py\", line 1112, in get_best_trial\r\n    _directions = self.get_study_directions(study_id)\r\n  File \"/opt/anaconda3/lib/python3.9/site-packages/optuna/storages/_rdb/storage.py\", line 340, in get_study_directions\r\n    study = models.StudyModel.find_or_raise_by_id(study_id, session)\r\n  File \"/opt/anaconda3/lib/python3.9/site-packages/optuna/storages/_rdb/models.py\", line 55, in find_or_raise_by_id\r\n    raise KeyError(NOT_FOUND_MSG)\r\nKeyError: 'Record does not exist.'\r\n\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Create new trial witha new study with sqlite database file. Make sure the trial takes long enough.\r\n2. Remove/Rename the database file during this trial.\r\n3. Observe the error at the end of the trial\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2722/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2722/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2717", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2717/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2717/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2717/events", "html_url": "https://github.com/optuna/optuna/pull/2717", "id": 908541574, "node_id": "MDExOlB1bGxSZXF1ZXN0NjU5MjE4MDI2", "number": 2717, "title": "Fix `AllenNLPExecutor` reproducibility", "user": {"login": "MagiaSN", "id": 15558746, "node_id": "MDQ6VXNlcjE1NTU4NzQ2", "avatar_url": "https://avatars.githubusercontent.com/u/15558746?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MagiaSN", "html_url": "https://github.com/MagiaSN", "followers_url": "https://api.github.com/users/MagiaSN/followers", "following_url": "https://api.github.com/users/MagiaSN/following{/other_user}", "gists_url": "https://api.github.com/users/MagiaSN/gists{/gist_id}", "starred_url": "https://api.github.com/users/MagiaSN/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MagiaSN/subscriptions", "organizations_url": "https://api.github.com/users/MagiaSN/orgs", "repos_url": "https://api.github.com/users/MagiaSN/repos", "events_url": "https://api.github.com/users/MagiaSN/events{/privacy}", "received_events_url": "https://api.github.com/users/MagiaSN/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561256, "node_id": "MDU6TGFiZWwxOTQ3NTYxMjU2", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.integration", "name": "optuna.integration", "color": "1c659e", "default": false, "description": "Related to the `optuna.integration` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "Crissman", "id": 4338467, "node_id": "MDQ6VXNlcjQzMzg0Njc=", "avatar_url": "https://avatars.githubusercontent.com/u/4338467?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Crissman", "html_url": "https://github.com/Crissman", "followers_url": "https://api.github.com/users/Crissman/followers", "following_url": "https://api.github.com/users/Crissman/following{/other_user}", "gists_url": "https://api.github.com/users/Crissman/gists{/gist_id}", "starred_url": "https://api.github.com/users/Crissman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Crissman/subscriptions", "organizations_url": "https://api.github.com/users/Crissman/orgs", "repos_url": "https://api.github.com/users/Crissman/repos", "events_url": "https://api.github.com/users/Crissman/events{/privacy}", "received_events_url": "https://api.github.com/users/Crissman/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "Crissman", "id": 4338467, "node_id": "MDQ6VXNlcjQzMzg0Njc=", "avatar_url": "https://avatars.githubusercontent.com/u/4338467?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Crissman", "html_url": "https://github.com/Crissman", "followers_url": "https://api.github.com/users/Crissman/followers", "following_url": "https://api.github.com/users/Crissman/following{/other_user}", "gists_url": "https://api.github.com/users/Crissman/gists{/gist_id}", "starred_url": "https://api.github.com/users/Crissman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Crissman/subscriptions", "organizations_url": "https://api.github.com/users/Crissman/orgs", "repos_url": "https://api.github.com/users/Crissman/repos", "events_url": "https://api.github.com/users/Crissman/events{/privacy}", "received_events_url": "https://api.github.com/users/Crissman/received_events", "type": "User", "site_admin": false}, {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/36", "html_url": "https://github.com/optuna/optuna/milestone/36", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/36/labels", "id": 6809937, "node_id": "MDk6TWlsZXN0b25lNjgwOTkzNw==", "number": 36, "title": "v2.9.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 47, "state": "closed", "created_at": "2021-06-01T01:07:05Z", "updated_at": "2021-08-02T06:09:08Z", "due_on": null, "closed_at": "2021-08-02T06:09:08Z"}, "comments": 3, "created_at": "2021-06-01T17:43:28Z", "updated_at": "2021-07-30T06:38:13Z", "closed_at": "2021-06-05T11:30:16Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2717", "html_url": "https://github.com/optuna/optuna/pull/2717", "diff_url": "https://github.com/optuna/optuna/pull/2717.diff", "patch_url": "https://github.com/optuna/optuna/pull/2717.patch", "merged_at": "2021-06-05T11:30:16Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\nFixes #2716\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\nClear transformer model cache in `allennlp` at the start of `AllenNLPExecutor.run`\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2717/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2717/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2716", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2716/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2716/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2716/events", "html_url": "https://github.com/optuna/optuna/issues/2716", "id": 908538689, "node_id": "MDU6SXNzdWU5MDg1Mzg2ODk=", "number": 2716, "title": "Results not reproducible when running `AllenNLPExecutor` multiple times with transformers", "user": {"login": "MagiaSN", "id": 15558746, "node_id": "MDQ6VXNlcjE1NTU4NzQ2", "avatar_url": "https://avatars.githubusercontent.com/u/15558746?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MagiaSN", "html_url": "https://github.com/MagiaSN", "followers_url": "https://api.github.com/users/MagiaSN/followers", "following_url": "https://api.github.com/users/MagiaSN/following{/other_user}", "gists_url": "https://api.github.com/users/MagiaSN/gists{/gist_id}", "starred_url": "https://api.github.com/users/MagiaSN/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MagiaSN/subscriptions", "organizations_url": "https://api.github.com/users/MagiaSN/orgs", "repos_url": "https://api.github.com/users/MagiaSN/repos", "events_url": "https://api.github.com/users/MagiaSN/events{/privacy}", "received_events_url": "https://api.github.com/users/MagiaSN/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-06-01T17:39:25Z", "updated_at": "2021-06-05T11:30:16Z", "closed_at": "2021-06-05T11:30:16Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n## Expected behavior\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\nIf we run `AllenNLPExecutor` multiples times in a single process, we should get exactly the same results as we run `AllenNLPExecutor` one time in different processes. However, with transformer models we get different results in 2nd trial and afterwards.\r\n\r\nI found this is caused by `allennlp.common.cached_transformers` module, which only constructs the model in the first trial (which would consume some random numbers), and uses the cached model in trials afterwards (which would not consume random numbers), leading to inconsistent results between single run and multiple runs.\r\n\r\nI have reported the same issue in https://github.com/himkt/allennlp-optuna/issues/45 and we think it is better to fix it here.\r\n\r\n## Environment\r\n\r\n- Optuna version: \r\n- Python version: 3.7.9\r\n- OS: CentOS 7\r\n- (Optional) Other libraries and their versions:\r\n  - pytorch: 1.7.1+cu101\r\n  - allennlp: 2.4.0\r\n  - allennlp-models: 2.4.0\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nIrrelevant\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Run `test.py --lrs 3e-5 5e-5` (see below) with 2 trials, results for `trial_1` (lr=5e-5) are listed below:\r\n   ```\r\n   {\r\n     \"best_epoch\": 0,\r\n     \"peak_worker_0_memory_MB\": 4430.26171875,\r\n     \"peak_gpu_0_memory_MB\": 1087.1904296875,\r\n     \"training_duration\": \"0:01:19.745650\",\r\n     \"training_start_epoch\": 0,\r\n     \"training_epochs\": 0,\r\n     \"epoch\": 0,\r\n     \"training_accuracy\": 0.890610765835982,\r\n     \"training_loss\": 0.2591960741486883,\r\n     \"training_worker_0_memory_MB\": 4430.26171875,\r\n     \"training_gpu_0_memory_MB\": 1087.1904296875,\r\n     \"validation_accuracy\": 0.8784403669724771,\r\n     \"validation_loss\": 0.29463143753153936,\r\n     \"best_validation_accuracy\": 0.8784403669724771,\r\n     \"best_validation_loss\": 0.29463143753153936,\r\n     \"test_accuracy\": 0.8956617243272927,\r\n     \"test_loss\": 0.25426666027513045\r\n   }\r\n   ```\r\n\r\n2. Run `test.py --lrs 5e-5`, with only one trial (lr=5e-5), results are listed below, note the accuracy and loss are different from the first run:\r\n   ```\r\n   {\r\n     \"best_epoch\": 0,\r\n     \"peak_worker_0_memory_MB\": 4268.87890625,\r\n     \"peak_gpu_0_memory_MB\": 107.75439453125,\r\n     \"training_duration\": \"0:01:21.888510\",\r\n     \"training_start_epoch\": 0,\r\n     \"training_epochs\": 0,\r\n     \"epoch\": 0,\r\n     \"training_accuracy\": 0.891380043322469,\r\n     \"training_loss\": 0.25985829611887934,\r\n     \"training_worker_0_memory_MB\": 4268.87890625,\r\n     \"training_gpu_0_memory_MB\": 107.75439453125,\r\n     \"validation_accuracy\": 0.8841743119266054,\r\n     \"validation_loss\": 0.29488931596279144,\r\n     \"best_validation_accuracy\": 0.8841743119266054,\r\n     \"best_validation_loss\": 0.29488931596279144,\r\n     \"test_accuracy\": 0.8973091707852828,\r\n     \"test_loss\": 0.25216216080147646\r\n   }\r\n   ```\r\n\r\n## Reproducible examples (optional)\r\n\r\n- `test.py`\r\n  ```python\r\n  import argparse\r\n  import os\r\n  import random\r\n\r\n  import optuna\r\n  from optuna import Trial\r\n  from optuna.integration import AllenNLPExecutor\r\n  from optuna.samplers import GridSampler\r\n\r\n\r\n  def main(args: argparse.Namespace) -> None:\r\n      study_name = \"test\"\r\n      config_file = \"config.jsonnet\"\r\n      serialization_dir = \"output\"\r\n      metrics = \"best_validation_accuracy\"\r\n      direction = \"maximize\"\r\n      storage = \"sqlite:///allennlp_optuna.db\"\r\n\r\n      # For reproducibility\r\n      random.seed(1)\r\n\r\n      os.makedirs(serialization_dir, exist_ok=True)\r\n\r\n      def objective(trial: Trial) -> float:\r\n          trial.suggest_float(name=\"lr\", low=1e-5, high=5e-5)\r\n          optuna_serialization_dir = os.path.join(serialization_dir, \"trial_{}\".format(trial.number))\r\n          executor = AllenNLPExecutor(\r\n              trial,\r\n              config_file,\r\n              optuna_serialization_dir,\r\n              metrics=metrics,\r\n              include_package=\"allennlp_models\",\r\n          )\r\n          return executor.run()\r\n\r\n      sampler = GridSampler({\"lr\": args.lrs})\r\n\r\n      study = optuna.create_study(\r\n          study_name=study_name,\r\n          direction=direction,\r\n          storage=storage,\r\n          sampler=sampler,\r\n      )\r\n\r\n      study.optimize(objective)\r\n\r\n\r\n  if __name__ == \"__main__\":\r\n      arg_parser = argparse.ArgumentParser()\r\n      arg_parser.add_argument(\"--lrs\", type=float, nargs=\"+\", default=[3e-5, 5e-5])\r\n      args = arg_parser.parse_args()\r\n\r\n      main(args)\r\n  ```\r\n\r\n- `config.jsonnet`\r\n  ```jsonnet\r\n  local pretrained_model = \"haisongzhang/roberta-tiny-cased\";\r\n\r\n  local lr = std.parseJson(std.extVar(\"lr\"));\r\n\r\n  {\r\n    \"random_seed\": 42,\r\n    \"numpy_seed\": 42,\r\n    \"pytorch_seed\": 42,\r\n    \"evaluate_on_test\": true,\r\n    \"train_data_path\": \"https://allennlp.s3.amazonaws.com/datasets/sst/train.txt\",\r\n    \"validation_data_path\": \"https://allennlp.s3.amazonaws.com/datasets/sst/dev.txt\",\r\n    \"test_data_path\": \"https://allennlp.s3.amazonaws.com/datasets/sst/test.txt\",\r\n    \"dataset_reader\": {\r\n      \"type\": \"sst_tokens\",\r\n      \"use_subtrees\": true,\r\n      \"granularity\": \"2-class\",\r\n      \"token_indexers\": {\r\n        \"tokens\": {\r\n          \"type\": \"pretrained_transformer\",\r\n          \"model_name\": pretrained_model\r\n        }\r\n      },\r\n      \"tokenizer\": {\r\n        \"type\": \"pretrained_transformer\",\r\n        \"model_name\": pretrained_model\r\n      }\r\n    },\r\n    \"validation_dataset_reader\": self.dataset_reader + {\r\n      \"use_subtrees\": false\r\n    },\r\n    \"data_loader\": {\r\n      \"batch_sampler\": {\r\n        \"type\": \"bucket\",\r\n        \"sorting_keys\": [\"tokens\"],\r\n        \"batch_size\": 64,\r\n      }\r\n    },\r\n    \"model\": {\r\n      \"type\": \"basic_classifier\",\r\n      \"text_field_embedder\": {\r\n        \"token_embedders\": {\r\n          \"tokens\": {\r\n            \"type\": \"pretrained_transformer\",\r\n            \"model_name\": pretrained_model\r\n          }\r\n        }\r\n      },\r\n      \"seq2vec_encoder\": {\r\n        \"type\": \"bert_pooler\",\r\n        \"pretrained_model\": pretrained_model,\r\n        \"dropout\": 0.1\r\n      },\r\n      \"namespace\": \"tokens\",\r\n      \"label_namespace\": \"label\"\r\n    },\r\n    \"trainer\": {\r\n      \"num_epochs\": 1,\r\n      \"validation_metric\": \"+accuracy\",\r\n      \"patience\": 3,\r\n      \"optimizer\": {\r\n        \"type\": \"adam\",\r\n        \"lr\": lr\r\n      },\r\n      \"learning_rate_scheduler\": {\r\n        \"type\": \"slanted_triangular\",\r\n        \"cut_frac\": 0.0\r\n      }\r\n    }\r\n  }\r\n  ```\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2716/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2716/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2715", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2715/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2715/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2715/events", "html_url": "https://github.com/optuna/optuna/issues/2715", "id": 908076465, "node_id": "MDU6SXNzdWU5MDgwNzY0NjU=", "number": 2715, "title": "Windows Fatal Exception with Catboost & Pytest", "user": {"login": "nielsuit227", "id": 34714661, "node_id": "MDQ6VXNlcjM0NzE0NjYx", "avatar_url": "https://avatars.githubusercontent.com/u/34714661?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nielsuit227", "html_url": "https://github.com/nielsuit227", "followers_url": "https://api.github.com/users/nielsuit227/followers", "following_url": "https://api.github.com/users/nielsuit227/following{/other_user}", "gists_url": "https://api.github.com/users/nielsuit227/gists{/gist_id}", "starred_url": "https://api.github.com/users/nielsuit227/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nielsuit227/subscriptions", "organizations_url": "https://api.github.com/users/nielsuit227/orgs", "repos_url": "https://api.github.com/users/nielsuit227/repos", "events_url": "https://api.github.com/users/nielsuit227/events{/privacy}", "received_events_url": "https://api.github.com/users/nielsuit227/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-06-01T09:05:06Z", "updated_at": "2021-06-01T16:36:45Z", "closed_at": "2021-06-01T16:36:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "Apologies if this is not the appropriate place, but I can only reproduce behavior when Optuna place a role. \r\n\r\nI have set up a study to optimize the parameters of a CatBoostClassifier and wrote a unittest for it. Pytest can train a CatBoostClassifier, but when it creates a study and optimizes the hyperparameters, I run into a `Windows Fatal Error`. \r\n\r\n## Environment\r\n\r\n- Optuna version: 2.7.0\r\n- Python version: 3.9.1\r\n- OS: Windows 10 Pro Version 20H2 (OS Build 19042.985)\r\n- (Optional) Other libraries and their versions: \r\n- Pytest: 6.2.4\r\n- Catboost 0.25.1\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nCurrent thread 0x000022c4 (most recent call first):\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\catboost\\core.py\", line 1437 in _calc_fstr\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\catboost\\core.py\", line 2672 in get_feature_importance\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\catboost\\core.py\", line 1938 in _fit\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\catboost\\core.py\", line 4539 in fit\r\n  File \"C:\\Users\\Niels Uitterdijk\\Documents\\Python\\Sandbox\\bug_pytest\\test_cb.py\", line 20 in objective\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\optuna\\_optimize.py\", line 217 in _run_trial\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\optuna\\_optimize.py\", line 163 in _optimize_sequential\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\optuna\\_optimize.py\", line 66 in _optimize\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\optuna\\study.py\", line 400 in optimize\r\n  File \"C:\\Users\\Niels Uitterdijk\\Documents\\Python\\Sandbox\\bug_pytest\\test_cb.py\", line 14 in test_cb\r\n  File \"c:\\users\\niels uitterdijk\\desktop\\pytest\\src\\_pytest\\python.py\", line 185 in pytest_pyfunc_call\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\pluggy\\callers.py\", line 187 in _multicall\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\pluggy\\manager.py\", line 84 in <lambda>\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\pluggy\\manager.py\", line 93 in _hookexec\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\pluggy\\hooks.py\", line 286 in __call__\r\n  File \"c:\\users\\niels uitterdijk\\desktop\\pytest\\src\\_pytest\\python.py\", line 1651 in runtest\r\n  File \"c:\\users\\niels uitterdijk\\desktop\\pytest\\src\\_pytest\\runner.py\", line 168 in pytest_runtest_call\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\pluggy\\callers.py\", line 187 in _multicall\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\pluggy\\manager.py\", line 84 in <lambda>\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\pluggy\\manager.py\", line 93 in _hookexec\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\pluggy\\hooks.py\", line 286 in __call__\r\n  File \"c:\\users\\niels uitterdijk\\desktop\\pytest\\src\\_pytest\\runner.py\", line 261 in <lambda>\r\n  File \"c:\\users\\niels uitterdijk\\desktop\\pytest\\src\\_pytest\\runner.py\", line 340 in from_call\r\n  File \"c:\\users\\niels uitterdijk\\desktop\\pytest\\src\\_pytest\\runner.py\", line 260 in call_runtest_hook\r\n  File \"c:\\users\\niels uitterdijk\\desktop\\pytest\\src\\_pytest\\runner.py\", line 221 in call_and_report\r\n  File \"c:\\users\\niels uitterdijk\\desktop\\pytest\\src\\_pytest\\runner.py\", line 132 in runtestprotocol\r\n  File \"c:\\users\\niels uitterdijk\\desktop\\pytest\\src\\_pytest\\runner.py\", line 113 in pytest_runtest_protocol\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\pluggy\\callers.py\", line 187 in _multicall\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\pluggy\\manager.py\", line 84 in <lambda>\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\pluggy\\manager.py\", line 93 in _hookexec\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\pluggy\\hooks.py\", line 286 in __call__\r\n  File \"c:\\users\\niels uitterdijk\\desktop\\pytest\\src\\_pytest\\main.py\", line 349 in pytest_runtestloop\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\pluggy\\callers.py\", line 187 in _multicall\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\pluggy\\manager.py\", line 84 in <lambda>\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\pluggy\\manager.py\", line 93 in _hookexec\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\pluggy\\hooks.py\", line 286 in __call__\r\n  File \"c:\\users\\niels uitterdijk\\desktop\\pytest\\src\\_pytest\\main.py\", line 324 in _main\r\n  File \"c:\\users\\niels uitterdijk\\desktop\\pytest\\src\\_pytest\\main.py\", line 270 in wrap_session\r\n  File \"c:\\users\\niels uitterdijk\\desktop\\pytest\\src\\_pytest\\main.py\", line 317 in pytest_cmdline_main\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\pluggy\\callers.py\", line 187 in _multicall\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\pluggy\\manager.py\", line 84 in <lambda>\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\pluggy\\manager.py\", line 93 in _hookexec\r\n  File \"c:\\users\\niels uitterdijk\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\pluggy\\hooks.py\", line 286 in __call__\r\n  File \"c:\\users\\niels uitterdijk\\desktop\\pytest\\src\\_pytest\\config\\__init__.py\", line 165 in main\r\n  File \"c:\\users\\niels uitterdijk\\desktop\\pytest\\src\\_pytest\\config\\__init__.py\", line 188 in console_main\r\n  File \"C:\\Users\\Niels Uitterdijk\\AppData\\Local\\Programs\\Python\\Python39\\Scripts\\pytest-script.py\", line 33 in <module>\r\n\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Have a file `test_optuna.py` in a `bug_test` folder.\r\n2. Open a terminal in the parent folder and run `pytest bug_test`\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\n\r\nimport catboost\r\nimport optuna\r\nimport copy\r\nfrom functools import partial\r\nfrom sklearn.datasets import make_classification\r\nfrom sklearn.metrics import accuracy_score\r\n\r\n\r\ndef test_cb():\r\n    m = catboost.CatBoostClassifier()\r\n    x, y = make_classification()\r\n    study = optuna.create_study()\r\n    study.optimize(partial(objective, m, x, y), n_trials=2)\r\n\r\n\r\ndef objective(model, x, y, trial):\r\n    m = copy.deepcopy(model)\r\n    m.set_params(**get_params(trial))\r\n    m.fit(x, y)\r\n    return accuracy_score(y, m.predict(x))\r\n\r\n\r\ndef get_params(trial):\r\n    return {\r\n                \"verbose\": 0,\r\n                'depth': trial.suggest_int('depth', 1, 10),\r\n                'min_data_in_leaf': trial.suggest_int('min_data_in_leaf', 50, 500),\r\n                'grow_policy': trial.suggest_categorical('grow_policy', ['SymmetricTree', 'Depthwise', 'Lossguide']),\r\n            }\r\n```\r\n\r\n## Additional context (optional)\r\nFound some relating issues, mostly seem to be a dll. Just think it belongs here as all my tests work fine, up till the point I add optuna. \r\nhttps://github.com/pywinauto/pywinauto/issues/858\r\nhttps://github.com/enthought/comtypes/issues/204\r\nhttps://stackoverflow.com/questions/61381620/pytest-windows-fatal-exception-access-violation\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2715/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2715/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2693", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2693/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2693/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2693/events", "html_url": "https://github.com/optuna/optuna/issues/2693", "id": 896951829, "node_id": "MDU6SXNzdWU4OTY5NTE4Mjk=", "number": 2693, "title": "optuna interfering with pytorch dataloaders", "user": {"login": "pyscorcher", "id": 59569502, "node_id": "MDQ6VXNlcjU5NTY5NTAy", "avatar_url": "https://avatars.githubusercontent.com/u/59569502?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pyscorcher", "html_url": "https://github.com/pyscorcher", "followers_url": "https://api.github.com/users/pyscorcher/followers", "following_url": "https://api.github.com/users/pyscorcher/following{/other_user}", "gists_url": "https://api.github.com/users/pyscorcher/gists{/gist_id}", "starred_url": "https://api.github.com/users/pyscorcher/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pyscorcher/subscriptions", "organizations_url": "https://api.github.com/users/pyscorcher/orgs", "repos_url": "https://api.github.com/users/pyscorcher/repos", "events_url": "https://api.github.com/users/pyscorcher/events{/privacy}", "received_events_url": "https://api.github.com/users/pyscorcher/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-05-20T15:04:26Z", "updated_at": "2022-01-05T23:05:30Z", "closed_at": "2022-01-05T23:05:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "When using optuna with pytorch/torchvision dataloaders with multiple workers, sometimes the dataloader workers will pause indefinitely. If the order of imports is changed, it works fine. The behaviour only randomly seems to affect some runs. \r\n\r\n## Expected behavior\r\nI expect the import order not to matter at all. I suspect optuna changes some global settings with respect to the multiprocessing libraries.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.7.0\r\n- Python version: 3.9.2\r\n- OS: Ubuntu 20.04\r\n- Pytorch: 1.8.1\r\n\r\n## Example\r\nUnfortunately I'm not able to make a minimal reproducible example due to the erratic behaviour because only in about one of five or ten runs this issue would arise. But I wanted to bring thes strange behavour to attention and I try my best to describe the relevant parts:\r\n\r\nIn my case `train.py` just contains a training loop over a dataloader, loading large amounts of data (multiple 3d-volumes), which is created about as follows. Note that the issue only arises when using multiple workers, which means there are subprocesses being created.\r\n\r\n```python\r\nloader = torch.utils.data.DataLoader(\r\n    my_dataset,\r\n    batch_size=5,\r\n    num_workers=3, # 0: loading from main process, >=1: loading from subprocesses (multiprocessing)\r\n)\r\n```\r\n\r\nThe hyperparameter optimization is in a separate file that imports `train.py` as well as `optuna`.\r\n\r\n```python\r\n# optuna main file\r\nimport optuna\r\nfrom train import train  # this order of imports sometimes causes issues with the DataLoader\r\n\r\ndef objective(trial: optuna.trial.BaseTrial):\r\n    p = dict()\r\n    p['var'] = trial.suggest_int('var', low=0, high=100)\r\n    metric = train(p)\r\n    return metric\r\n\r\ndef main():\r\n    study = optuna.create_study(\r\n        study_name='my_study',\r\n        storage=\"sqlite:///my_database.db\",\r\n        load_if_exists=True,\r\n        direction='maximize'\r\n        )\r\n    study.optimize(objective, n_trials=100)\r\n    print(f'{study.best_params=}')\r\n\r\nif __name__ == '__main__':\r\n    main()\r\n\r\n```\r\n\r\n## Possible Workaround\r\nIf we have the opposite order of imports (like the following), everything seems to work fine.\r\n\r\n```python\r\nfrom train import train\r\nimport optuna\r\n```\r\n\r\n\r\n## Additional context\r\nAs mentioned above, I believe that importing `optuna` somehow changes some global settings or the way `multiprocessing` works. I have noticed that `optuna` will also spawn subprocesses with the code snippet above, even if this is conceptually not necessary. \r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2693/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2693/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2687", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2687/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2687/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2687/events", "html_url": "https://github.com/optuna/optuna/pull/2687", "id": 894927924, "node_id": "MDExOlB1bGxSZXF1ZXN0NjQ3MjE4OTQw", "number": 2687, "title": "Update version info entry on RDB storage upgrade", "user": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/35", "html_url": "https://github.com/optuna/optuna/milestone/35", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/35/labels", "id": 6618764, "node_id": "MDk6TWlsZXN0b25lNjYxODc2NA==", "number": 35, "title": "v2.8.0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 89, "state": "closed", "created_at": "2021-04-02T05:04:44Z", "updated_at": "2021-06-07T07:06:35Z", "due_on": null, "closed_at": "2021-06-07T07:06:35Z"}, "comments": 2, "created_at": "2021-05-19T02:26:46Z", "updated_at": "2021-05-21T04:45:21Z", "closed_at": "2021-05-21T04:18:27Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2687", "html_url": "https://github.com/optuna/optuna/pull/2687", "diff_url": "https://github.com/optuna/optuna/pull/2687.diff", "patch_url": "https://github.com/optuna/optuna/pull/2687.patch", "merged_at": "2021-05-21T04:18:27Z"}, "body": "## Motivation\r\n\r\nFixes https://github.com/optuna/optuna/issues/2627.\r\n\r\n## Description of the changes\r\n\r\nUpdates the `_VersionManager` model entry/row on storage upgrade (e.g. using the Optuna CLI command).", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2687/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2687/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2685", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2685/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2685/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2685/events", "html_url": "https://github.com/optuna/optuna/issues/2685", "id": 893147627, "node_id": "MDU6SXNzdWU4OTMxNDc2Mjc=", "number": 2685, "title": "Waiting for Heartbeat", "user": {"login": "Turakar", "id": 3958680, "node_id": "MDQ6VXNlcjM5NTg2ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/3958680?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Turakar", "html_url": "https://github.com/Turakar", "followers_url": "https://api.github.com/users/Turakar/followers", "following_url": "https://api.github.com/users/Turakar/following{/other_user}", "gists_url": "https://api.github.com/users/Turakar/gists{/gist_id}", "starred_url": "https://api.github.com/users/Turakar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Turakar/subscriptions", "organizations_url": "https://api.github.com/users/Turakar/orgs", "repos_url": "https://api.github.com/users/Turakar/repos", "events_url": "https://api.github.com/users/Turakar/events{/privacy}", "received_events_url": "https://api.github.com/users/Turakar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-05-17T09:42:05Z", "updated_at": "2021-05-21T09:42:34Z", "closed_at": "2021-05-21T09:42:34Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n## Expected behavior\r\n\r\nAfter `study.optimize` with a high heartbeat interval (e.g. 60s) finishes running trials, it should exit almost immediately. \r\n\r\n## Environment\r\n\r\n- Optuna version: 2.7.0\r\n- Python version: 3.9\r\n- OS: Fedora 33\r\n- (Optional) Other libraries and their versions: PostgreSQL\r\n\r\n## Observed Behavior\r\nInstead of exiting immediately, the main thread tries to join with the heartbeat thread, which only completes after the next scheduled hearbeat. This can lead to high delays where the program does basically nothing.\r\n\r\n## Steps to reproduce\r\n\r\n1. Create a RDB storage with a heartbeat interval of 60s.\r\n2. Create a fast objective, a study and call `study.optimize(n_trials=1)`.\r\n3. Measure runtime.\r\n\r\n## Additional context (optional)\r\nIt might be better to use the [`wait(timeout=...)`](https://docs.python.org/3/library/threading.html#threading.Event.wait) method [here](https://github.com/optuna/optuna/blob/2fd68d0102a22e76b5a4a142cc87722d92dcf667/optuna/_optimize.py#L340).\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2685/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2685/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2681", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2681/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2681/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2681/events", "html_url": "https://github.com/optuna/optuna/pull/2681", "id": 892417006, "node_id": "MDExOlB1bGxSZXF1ZXN0NjQ1MTI1Mzgy", "number": 2681, "title": "Read environment variables in dump_best_config", "user": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561256, "node_id": "MDU6TGFiZWwxOTQ3NTYxMjU2", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.integration", "name": "optuna.integration", "color": "1c659e", "default": false, "description": "Related to the `optuna.integration` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/35", "html_url": "https://github.com/optuna/optuna/milestone/35", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/35/labels", "id": 6618764, "node_id": "MDk6TWlsZXN0b25lNjYxODc2NA==", "number": 35, "title": "v2.8.0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 89, "state": "closed", "created_at": "2021-04-02T05:04:44Z", "updated_at": "2021-06-07T07:06:35Z", "due_on": null, "closed_at": "2021-06-07T07:06:35Z"}, "comments": 10, "created_at": "2021-05-15T11:15:42Z", "updated_at": "2021-05-31T14:18:42Z", "closed_at": "2021-05-31T13:21:16Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2681", "html_url": "https://github.com/optuna/optuna/pull/2681", "diff_url": "https://github.com/optuna/optuna/pull/2681.diff", "patch_url": "https://github.com/optuna/optuna/pull/2681.patch", "merged_at": "2021-05-31T13:21:16Z"}, "body": "Ref. https://github.com/himkt/allennlp-optuna/issues/41\r\n\r\n## Motivation\r\nAllenNLP supports reading some parameters from environment variables.\r\nThus, a config file could contain some external variables that are not related to hyperparameters.\r\nWhen invoking `dump_best_config`, we have to read environment variables as well as best-performing hyperparameters.\r\n\r\n```jsonnet\r\nlocal dropout = std.parseJson(std.extVar('dropout'));\r\nlocal embedding_dim = std.parseInt(std.extVar('embedding_dim'));\r\nlocal lr = std.parseJson(std.extVar('lr'));\r\n\r\n\r\n{\r\n  dataset_reader: {\r\n    ...\r\n  },\r\n  train_data_path: std.extVar('train_data_path'),       // these are not hyperparameter but simple external parameter\r\n  validation_data_path: std.extVar('valid_data_path'),  // which are given from environment variables\r\n  model: {\r\n    type: 'basic_classifier',\r\n    text_field_embedder: {\r\n      token_embedders: {\r\n        tokens: {\r\n          type: 'embedding',\r\n          embedding_dim: embedding_dim,  // it is hyperparameter defined at the top of configuration\r\n        },\r\n      },\r\n    },\r\n    seq2vec_encoder: {\r\n      ....\r\n    }\r\n  },\r\n  data_loader: {\r\n    batch_size: 1,\r\n  },\r\n  ...\r\n}\r\n```\r\n\r\n\r\n## Description of the changes\r\n- 59dbd75 reads environment variables in `dump_best_config`\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2681/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2681/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2671", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2671/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2671/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2671/events", "html_url": "https://github.com/optuna/optuna/issues/2671", "id": 890952769, "node_id": "MDU6SXNzdWU4OTA5NTI3Njk=", "number": 2671, "title": "Overwrite existing study with new parameter distributions", "user": {"login": "marcelned", "id": 82392567, "node_id": "MDQ6VXNlcjgyMzkyNTY3", "avatar_url": "https://avatars.githubusercontent.com/u/82392567?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marcelned", "html_url": "https://github.com/marcelned", "followers_url": "https://api.github.com/users/marcelned/followers", "following_url": "https://api.github.com/users/marcelned/following{/other_user}", "gists_url": "https://api.github.com/users/marcelned/gists{/gist_id}", "starred_url": "https://api.github.com/users/marcelned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marcelned/subscriptions", "organizations_url": "https://api.github.com/users/marcelned/orgs", "repos_url": "https://api.github.com/users/marcelned/repos", "events_url": "https://api.github.com/users/marcelned/events{/privacy}", "received_events_url": "https://api.github.com/users/marcelned/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-05-13T11:12:57Z", "updated_at": "2021-05-18T09:50:47Z", "closed_at": "2021-05-18T09:50:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "When I run a study, saving results to Postgres, I cannot load an old study with new parameters. \r\n\r\nIf the parameters distributions aren't exactly the same as when the study was first run, i get the following error:\r\n\r\n```\r\nValueError: Cannot set different distribution kind to the same parameter name.\r\n```\r\n\r\nIs there a way to use Optuna to either delete old studies from the database, or reset them? Currently I have to resort to renaming the study everytime I run it with new parameters.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2671/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2671/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2662", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2662/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2662/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2662/events", "html_url": "https://github.com/optuna/optuna/issues/2662", "id": 885579698, "node_id": "MDU6SXNzdWU4ODU1Nzk2OTg=", "number": 2662, "title": "Inconsistent error handling in `suggest_int` and `suggest_float`", "user": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1904423825, "node_id": "MDU6TGFiZWwxOTA0NDIzODI1", "url": "https://api.github.com/repos/optuna/optuna/labels/needs-discussion", "name": "needs-discussion", "color": "e99695", "default": false, "description": "Issue/PR which needs discussion."}, {"id": 2107128673, "node_id": "MDU6TGFiZWwyMTA3MTI4Njcz", "url": "https://api.github.com/repos/optuna/optuna/labels/no-stale", "name": "no-stale", "color": "BBBBBB", "default": false, "description": "Exempt from stale bot"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2021-05-11T01:32:21Z", "updated_at": "2022-06-24T05:21:21Z", "closed_at": "2022-06-24T05:21:21Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n## Expected behavior\r\n\r\nMore consistent error handling for `suggest_int` and `suggest_float`.\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\nimport optuna\r\n\r\n\r\n# Suggest int. OK.\r\nstudy = optuna.create_study()\r\ntrial = study.ask()\r\ntrial.suggest_int(\"x\", 0, 10)\r\ntrial = study.ask() \r\ntrial.suggest_int(\"x\", 0, 10, step=2)  # OK.\r\n\r\n# Suggest float. ValueError.\r\nstudy = optuna.create_study()\r\ntrial = study.ask()\r\ntrial.suggest_float(\"x\", 0, 10)\r\ntrial = study.ask()\r\ntrial.suggest_float(\"x\", 0, 10, step=2)  # ValueError: Cannot set different distribution kind to the same parameter name.\r\n\r\n# Note: Similar behavior reproducible without the second `study.ask()`s.\r\n```\r\n\r\n## Additional context (optional)\r\n\r\nThe inconsistency stem from historical reasons and in particular inconsistent distribution types and a consistency check based on these types https://github.com/optuna/optuna/blob/master/optuna/distributions.py#L521-L522. For instance, to suggest floats with steps you previously had to use `suggest_discrete_uniform`, similarly for log `suggest_loguniform`, until `suggest_float` was introduced which covers both cases. Internally, `suggest_float` simply calls `suggest_discrete_uniform`, etc. and hence the associated distribution types become different depending on arguments. At the same time, this interface is not symmetric for `suggest_int`. There is no `suggest_discrete_int` or `suggest_logint`. \r\n\r\nTo properly fix this issue, we probably have to rethink what distribution types to provide and make sure that samplers and other components depending on these distributions are aware.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2662/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2662/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2652", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2652/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2652/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2652/events", "html_url": "https://github.com/optuna/optuna/pull/2652", "id": 878428461, "node_id": "MDExOlB1bGxSZXF1ZXN0NjMyMjYwMzgw", "number": 2652, "title": "Fix distribution's `_contains`", "user": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/35", "html_url": "https://github.com/optuna/optuna/milestone/35", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/35/labels", "id": 6618764, "node_id": "MDk6TWlsZXN0b25lNjYxODc2NA==", "number": 35, "title": "v2.8.0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 89, "state": "closed", "created_at": "2021-04-02T05:04:44Z", "updated_at": "2021-06-07T07:06:35Z", "due_on": null, "closed_at": "2021-06-07T07:06:35Z"}, "comments": 7, "created_at": "2021-05-07T04:16:10Z", "updated_at": "2021-05-25T10:45:29Z", "closed_at": "2021-05-13T04:36:29Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2652", "html_url": "https://github.com/optuna/optuna/pull/2652", "diff_url": "https://github.com/optuna/optuna/pull/2652.diff", "patch_url": "https://github.com/optuna/optuna/pull/2652.patch", "merged_at": "2021-05-13T04:36:29Z"}, "body": "## Motivation\r\nFix #2557. The distribution's `_contains` should take account of the `step` argument.\r\n\r\n## Description of the changes\r\n- Fix distributions' `_contains`\r\n- Fix test\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2652/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2652/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2639", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2639/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2639/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2639/events", "html_url": "https://github.com/optuna/optuna/issues/2639", "id": 874892722, "node_id": "MDU6SXNzdWU4NzQ4OTI3MjI=", "number": 2639, "title": "FloatingPointError due to underflow encountered in exp in TPE sampler since latest version", "user": {"login": "hugocool", "id": 25592581, "node_id": "MDQ6VXNlcjI1NTkyNTgx", "avatar_url": "https://avatars.githubusercontent.com/u/25592581?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hugocool", "html_url": "https://github.com/hugocool", "followers_url": "https://api.github.com/users/hugocool/followers", "following_url": "https://api.github.com/users/hugocool/following{/other_user}", "gists_url": "https://api.github.com/users/hugocool/gists{/gist_id}", "starred_url": "https://api.github.com/users/hugocool/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hugocool/subscriptions", "organizations_url": "https://api.github.com/users/hugocool/orgs", "repos_url": "https://api.github.com/users/hugocool/repos", "events_url": "https://api.github.com/users/hugocool/events{/privacy}", "received_events_url": "https://api.github.com/users/hugocool/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2021-05-03T20:40:54Z", "updated_at": "2021-08-31T01:41:54Z", "closed_at": "2021-08-31T01:41:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "Since upgrading to the latest version optuna, an optimisation which used to work now doesn't even though it is the same dataset.\r\nI get the same error on a different dataset and have included the code where i encounter the problem below.\r\nThe error does not happen in first ten trials, however after enough trials this error is encountered.\r\n\r\n\r\n## Expected behavior\r\n\r\nI expect the optuna TPE sampler to work, just like it did before.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.7.0\r\n- Python version: 3.7\r\n- OS: linux (google colab)\r\n- xgboost version : 1.4.1\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n[I 2021-05-03 20:06:30,229] Trial 41 finished with value: 58.96419669999999 and parameters: {'booster': 'gbtree', 'lambda': 0.10473082821492902, 'alpha': 0.0034424292875279952, 'subsample': 0.08381812656141696, 'max_depth': 1, 'min_child_weight': 15, 'eta': 0.33668240574729064, 'gamma': 0.003057081444431449, 'grow_policy': 'depthwise'}. Best is trial 9 with value: 55.697677600000006.\r\n[I 2021-05-03 20:06:30,707] Trial 42 pruned. Trial was pruned at iteration 0.\r\n[W 2021-05-03 20:06:30,716] Trial 43 failed because of the following error: FloatingPointError('underflow encountered in exp')\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.7/dist-packages/optuna/_optimize.py\", line 217, in _run_trial\r\n    value_or_values = func(trial)\r\n  File \"<ipython-input-22-46c8a6d0e2a1>\", line 27, in objective\r\n    \"subsample\": trial.suggest_float(\"subsample\", 0, 1.0),\r\n  File \"/usr/local/lib/python3.7/dist-packages/optuna/trial/_trial.py\", line 178, in suggest_float\r\n    return self.suggest_uniform(name, low, high)\r\n  File \"/usr/local/lib/python3.7/dist-packages/optuna/trial/_trial.py\", line 237, in suggest_uniform\r\n    return self._suggest(name, distribution)\r\n  File \"/usr/local/lib/python3.7/dist-packages/optuna/trial/_trial.py\", line 717, in _suggest\r\n    study, trial, name, distribution\r\n  File \"/usr/local/lib/python3.7/dist-packages/optuna/samplers/_tpe/sampler.py\", line 288, in sample_independent\r\n    return self._sample_uniform(param_distribution, below_param_values, above_param_values)\r\n  File \"/usr/local/lib/python3.7/dist-packages/optuna/samplers/_tpe/sampler.py\", line 366, in _sample_uniform\r\n    return self._sample_numerical(low, high, below, above)\r\n  File \"/usr/local/lib/python3.7/dist-packages/optuna/samplers/_tpe/sampler.py\", line 467, in _sample_numerical\r\n    q=q,\r\n  File \"/usr/local/lib/python3.7/dist-packages/optuna/samplers/_tpe/sampler.py\", line 600, in _gmm_log_pdf\r\n    return TPESampler._logsum_rows(-0.5 * mahalanobis + np.log(coefficient))\r\n  File \"/usr/local/lib/python3.7/dist-packages/optuna/samplers/_tpe/sampler.py\", line 689, in _logsum_rows\r\n    return np.log(np.exp(x - m[:, None]).sum(axis=1)) + m\r\nFloatingPointError: underflow encountered in exp\r\n---------------------------------------------------------------------------\r\nFloatingPointError                        Traceback (most recent call last)\r\n<ipython-input-23-33764dde9087> in <module>()\r\n      2 \r\n      3 study = optuna.create_study(study_name=STUDY_NAME,direction=DIRECTION)\r\n----> 4 study.optimize(objective, n_trials=N_OPTUNA_TRIALS)\r\n\r\n13 frames\r\n/usr/local/lib/python3.7/dist-packages/optuna/study.py in optimize(self, func, n_trials, timeout, n_jobs, catch, callbacks, gc_after_trial, show_progress_bar)\r\n    407             callbacks=callbacks,\r\n    408             gc_after_trial=gc_after_trial,\r\n--> 409             show_progress_bar=show_progress_bar,\r\n    410         )\r\n    411 \r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/_optimize.py in _optimize(study, func, n_trials, timeout, n_jobs, catch, callbacks, gc_after_trial, show_progress_bar)\r\n     74                 reseed_sampler_rng=False,\r\n     75                 time_start=None,\r\n---> 76                 progress_bar=progress_bar,\r\n     77             )\r\n     78         else:\r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/_optimize.py in _optimize_sequential(study, func, n_trials, timeout, catch, callbacks, gc_after_trial, reseed_sampler_rng, time_start, progress_bar)\r\n    161 \r\n    162         try:\r\n--> 163             trial = _run_trial(study, func, catch)\r\n    164         except Exception:\r\n    165             raise\r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/_optimize.py in _run_trial(study, func, catch)\r\n    266 \r\n    267     if state == TrialState.FAIL and func_err is not None and not isinstance(func_err, catch):\r\n--> 268         raise func_err\r\n    269     return trial\r\n    270 \r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/_optimize.py in _run_trial(study, func, catch)\r\n    215 \r\n    216     try:\r\n--> 217         value_or_values = func(trial)\r\n    218     except exceptions.TrialPruned as e:\r\n    219         # TODO(mamu): Handle multi-objective cases.\r\n\r\n<ipython-input-22-46c8a6d0e2a1> in objective(trial)\r\n     25         \"lambda\": trial.suggest_loguniform(\"lambda\", 1e-7, 1.0),\r\n     26         \"alpha\": trial.suggest_loguniform(\"alpha\", 1e-7, 1.0),\r\n---> 27         \"subsample\": trial.suggest_float(\"subsample\", 0, 1.0),\r\n     28 \r\n     29         }\r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/trial/_trial.py in suggest_float(self, name, low, high, step, log)\r\n    176                 return self.suggest_loguniform(name, low, high)\r\n    177             else:\r\n--> 178                 return self.suggest_uniform(name, low, high)\r\n    179 \r\n    180     def suggest_uniform(self, name: str, low: float, high: float) -> float:\r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/trial/_trial.py in suggest_uniform(self, name, low, high)\r\n    235         self._check_distribution(name, distribution)\r\n    236 \r\n--> 237         return self._suggest(name, distribution)\r\n    238 \r\n    239     def suggest_loguniform(self, name: str, low: float, high: float) -> float:\r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/trial/_trial.py in _suggest(self, name, distribution)\r\n    715                 study = pruners._filter_study(self.study, trial)\r\n    716                 param_value = self.study.sampler.sample_independent(\r\n--> 717                     study, trial, name, distribution\r\n    718                 )\r\n    719 \r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/samplers/_tpe/sampler.py in sample_independent(self, study, trial, param_name, param_distribution)\r\n    286 \r\n    287         if isinstance(param_distribution, distributions.UniformDistribution):\r\n--> 288             return self._sample_uniform(param_distribution, below_param_values, above_param_values)\r\n    289         elif isinstance(param_distribution, distributions.LogUniformDistribution):\r\n    290             return self._sample_loguniform(\r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/samplers/_tpe/sampler.py in _sample_uniform(self, distribution, below, above)\r\n    364         low = distribution.low\r\n    365         high = distribution.high\r\n--> 366         return self._sample_numerical(low, high, below, above)\r\n    367 \r\n    368     def _sample_loguniform(\r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/samplers/_tpe/sampler.py in _sample_numerical(self, low, high, below, above, q, is_log)\r\n    465             low=low,\r\n    466             high=high,\r\n--> 467             q=q,\r\n    468         )\r\n    469 \r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/samplers/_tpe/sampler.py in _gmm_log_pdf(self, samples, parzen_estimator, low, high, q)\r\n    598             Z = np.sqrt(2 * np.pi) * sigmas\r\n    599             coefficient = weights / Z / p_accept\r\n--> 600             return TPESampler._logsum_rows(-0.5 * mahalanobis + np.log(coefficient))\r\n    601         else:\r\n    602             cdf_func = TPESampler._normal_cdf\r\n\r\n/usr/local/lib/python3.7/dist-packages/optuna/samplers/_tpe/sampler.py in _logsum_rows(cls, x)\r\n    687         x = np.asarray(x)\r\n    688         m = x.max(axis=1)\r\n--> 689         return np.log(np.exp(x - m[:, None]).sum(axis=1)) + m\r\n    690 \r\n    691     @classmethod\r\n\r\nFloatingPointError: underflow encountered in exp\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. load data\r\n2. define xgboost model, trial with cv metric\r\n3. optimise hypers with 40+ trials\r\n\r\n## Reproducible example\r\n\r\n```python\r\nfrom sklearn.datasets import load_diabetes\r\nimport pandas as pd\r\n\r\ndata = load_diabetes()\r\nprint(data.DESCR)\r\nX = pd.DataFrame(data = data['data'],columns = data['feature_names'])\r\ny = data['target']\r\nX['sex'] = X['sex'].apply(lambda x: x>0)*1\r\nX.rename(columns={\"sex\": \"male\"})\r\n\r\nN_FOLDS = 10\r\nXGB_OBJECTIVE = 'reg:squarederror'\r\nXGB_EVAL_METRIC = 'rmse'\r\nNUM_BOOST_ROUNDS=3000 #10000\r\nEARLY_STOPPING_ROUNDS = 50 #200\r\n\r\nN_OPTUNA_TRIALS = 100 #1000\r\nSTUDY_NAME = 'diabetes'\r\nDIRECTION = 'minimize' #'maximize\r\n\r\nxgb_params = {\r\n    \"objective\": XGB_OBJECTIVE,\r\n    \"eval_metric\": XGB_EVAL_METRIC,\r\n    \"sampling_method\":'gradient_based',\r\n    'tree_method': 'gpu_hist'\r\n    }\r\n\r\nimport xgboost as xgb\r\n\r\nxgb_full = xgb.DMatrix(X, label=y)  \r\n\r\ndef objective(trial):\r\n    \r\n\r\n    param = {\r\n        **xgb_params,\r\n        **{\r\n        \"booster\": trial.suggest_categorical(\"booster\", [\"gbtree\",\"dart\"]),\r\n        \"lambda\": trial.suggest_loguniform(\"lambda\", 1e-7, 1.0),\r\n        \"alpha\": trial.suggest_loguniform(\"alpha\", 1e-7, 1.0),\r\n        \"subsample\": trial.suggest_float(\"subsample\", 0, 1.0),\r\n\r\n        }\r\n    }\r\n\r\n    if param[\"booster\"] == \"gbtree\" or param[\"booster\"] == \"dart\":\r\n        param[\"max_depth\"] = trial.suggest_int(\"max_depth\", 1, 9)\r\n        param[\"min_child_weight\"] = trial.suggest_int('min_child_weight', 1, 20)\r\n        param[\"eta\"] = trial.suggest_loguniform(\"eta\", 1e-7, 1.0)\r\n        param[\"gamma\"] = trial.suggest_loguniform(\"gamma\", 1e-7, 1.0)\r\n        param[\"grow_policy\"] = trial.suggest_categorical(\"grow_policy\", [\"depthwise\", \"lossguide\"])\r\n    if param[\"booster\"] == \"dart\":\r\n        param[\"sample_type\"] = trial.suggest_categorical(\"sample_type\", [\"uniform\", \"weighted\"])\r\n        param[\"normalize_type\"] = trial.suggest_categorical(\"normalize_type\", [\"tree\", \"forest\"])\r\n        param[\"rate_drop\"] = trial.suggest_loguniform(\"rate_drop\", 1e-7, 1.0)\r\n        param[\"skip_drop\"] = trial.suggest_loguniform(\"skip_drop\", 1e-7, 1.0)\r\n\r\n    pruning_callback = optuna.integration.XGBoostPruningCallback(trial, f\"test-{XGB_EVAL_METRIC}\")\r\n\r\n    xgb_cv_results = xgb.cv(\r\n        param,\r\n        xgb_full,\r\n        num_boost_round=NUM_BOOST_ROUNDS,\r\n        early_stopping_rounds = EARLY_STOPPING_ROUNDS,\r\n        nfold=N_FOLDS,\r\n        callbacks=[pruning_callback],\r\n        )\r\n\r\n    trial.set_user_attr(\"n_estimators\", len(xgb_cv_results))\r\n\r\n    best_score = xgb_cv_results[f\"test-{XGB_EVAL_METRIC}-mean\"].values[-1]\r\n\r\n    return best_score\r\n\r\nimport optuna\r\n\r\nstudy = optuna.create_study(study_name=STUDY_NAME,direction=DIRECTION)\r\nstudy.optimize(objective, n_trials=N_OPTUNA_TRIALS)\r\n\r\n\r\n```\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2639/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2639/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2638", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2638/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2638/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2638/events", "html_url": "https://github.com/optuna/optuna/issues/2638", "id": 871819723, "node_id": "MDU6SXNzdWU4NzE4MTk3MjM=", "number": 2638, "title": "Checkpointing and resuming", "user": {"login": "etetteh", "id": 28512232, "node_id": "MDQ6VXNlcjI4NTEyMjMy", "avatar_url": "https://avatars.githubusercontent.com/u/28512232?v=4", "gravatar_id": "", "url": "https://api.github.com/users/etetteh", "html_url": "https://github.com/etetteh", "followers_url": "https://api.github.com/users/etetteh/followers", "following_url": "https://api.github.com/users/etetteh/following{/other_user}", "gists_url": "https://api.github.com/users/etetteh/gists{/gist_id}", "starred_url": "https://api.github.com/users/etetteh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/etetteh/subscriptions", "organizations_url": "https://api.github.com/users/etetteh/orgs", "repos_url": "https://api.github.com/users/etetteh/repos", "events_url": "https://api.github.com/users/etetteh/events{/privacy}", "received_events_url": "https://api.github.com/users/etetteh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-04-30T02:12:02Z", "updated_at": "2021-05-17T05:54:58Z", "closed_at": "2021-05-17T05:54:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "I want to checkpoint and resume training (hyperparameter search), but that is not happening.\r\n\r\n```\r\nstudy_name = \"baseline-study\" \r\nstorage_name = \"sqlite:///{}.db\".format(study_name)\r\n\r\nsampler = optuna.samplers.TPESampler(seed=seed)    \r\nstudy = optuna.create_study(\r\n                sampler=sampler,\r\n                pruner=optuna.pruners.MedianPruner(n_startup_trials=3, n_warmup_steps=5, interval_steps=3),\r\n                direction='maximize',\r\n                study_name=study_name,\r\n                storage=storage_name,\r\n                load_if_exists=True) \r\n\r\nstudy.optimize(func=objective, n_trials=5, gc_after_trial=True)\r\n```\r\n\r\nThe code is to perform t trials. At the 4th training, I intentionally halted the execution and ran the code again, I expected the code to run for only  1 trial, to complete the total trials of 5. However, the code executed more than the remaining 1 trial.\r\n\r\nIs there a fix to this issue?", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2638/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2638/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2627", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2627/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2627/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2627/events", "html_url": "https://github.com/optuna/optuna/issues/2627", "id": 867159670, "node_id": "MDU6SXNzdWU4NjcxNTk2NzA=", "number": 2627, "title": "The error message of the RDB schema check shows an incorrect Optuna version", "user": {"login": "g-votte", "id": 1061922, "node_id": "MDQ6VXNlcjEwNjE5MjI=", "avatar_url": "https://avatars.githubusercontent.com/u/1061922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/g-votte", "html_url": "https://github.com/g-votte", "followers_url": "https://api.github.com/users/g-votte/followers", "following_url": "https://api.github.com/users/g-votte/following{/other_user}", "gists_url": "https://api.github.com/users/g-votte/gists{/gist_id}", "starred_url": "https://api.github.com/users/g-votte/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/g-votte/subscriptions", "organizations_url": "https://api.github.com/users/g-votte/orgs", "repos_url": "https://api.github.com/users/g-votte/repos", "events_url": "https://api.github.com/users/g-votte/events{/privacy}", "received_events_url": "https://api.github.com/users/g-votte/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-04-26T00:35:48Z", "updated_at": "2021-05-21T04:18:27Z", "closed_at": "2021-05-21T04:18:27Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Optuna shows an error message when the runtime Optuna version is incompatible with the schema version of the target RDB. The error message includes both the runtime Optuna version and the Optuna version that set up the RDB schema. However, the latter is incorrect when the schema of the target RDB has been upgraded once.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.6.0\r\n\r\n\r\n## Steps to reproduce\r\n\r\n### Step 1\r\nInstall an old version of Optuna whose RDB schema is more than 1 generation ago, here using `optuna==2.3.0`. Then, create a record in the target RDB.\r\n\r\n```console\r\n$ pip install optuna==2.3.0\r\n$ optuna create-study --study-name example --storage sqlite:///example.db\r\n```\r\n\r\n### Step 2\r\nInstall a newer version of Optuna whose RDB schema is 1 generation ago, here using `opunta==2.4.0`. Then, try to access the record created in step 1. This should show the error message, which is **expected**.\r\n\r\n```console\r\n$ pip install optuna==2.4.0\r\n$ optuna studies --storage sqlite:///example.db\r\n[E 2021-04-26 08:54:37,987] The runtime optuna version 2.4.0 is no longer compatible with the table schema (set up by optuna 2.3.0). Please execute `$ optuna storage upgrade --storage $STORAGE_URL` for upgrading the storage.\r\n```\r\n### Step 3\r\nUpgrade the DB schema.\r\n\r\n```console\r\n$ optuna storage upgrade --storage sqlite:///example.db\r\n```\r\n\r\n### Step 4\r\nInstall the latest version of Optuna. Then, try to access the record created in step 1. This should show a similar error message to step 2, which contains the **unexpected** Optuna version.\r\n\r\nThe error message mentions that the Optuna version of the table schema is `2.3.0`. However, the expected version is `2.4.0`, where we have upgraded the schema with `optuna==2.4.0` in step 3.\r\n\r\n```console\r\n$ pip install optuna==2.6.0\r\n$ optuna studies --storage sqlite:///example.db        \r\n[E 2021-04-26 08:56:28,375] The runtime optuna version 2.6.0 is no longer compatible with the table schema (set up by optuna 2.3.0). Please execute `$ optuna storage upgrade --storage $STORAGE_URL` for upgrading the storage.\r\n```\r\n\r\n## Expected behavior\r\nThe error message shows the correct Optuna version or the corresponding alembic revision that upgraded the RDB schema.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2627/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2627/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2621", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2621/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2621/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2621/events", "html_url": "https://github.com/optuna/optuna/pull/2621", "id": 865620857, "node_id": "MDExOlB1bGxSZXF1ZXN0NjIxNjc0MjQy", "number": 2621, "title": "Round objective values of `LightGBMTuner` and `LightGBMTunerCV` for reproducibility.", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561256, "node_id": "MDU6TGFiZWwxOTQ3NTYxMjU2", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.integration", "name": "optuna.integration", "color": "1c659e", "default": false, "description": "Related to the `optuna.integration` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2021-04-23T00:25:18Z", "updated_at": "2021-04-23T02:59:27Z", "closed_at": "2021-04-23T02:59:27Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2621", "html_url": "https://github.com/optuna/optuna/pull/2621", "diff_url": "https://github.com/optuna/optuna/pull/2621.diff", "patch_url": "https://github.com/optuna/optuna/pull/2621.patch", "merged_at": null}, "body": "## Motivation\r\n\r\nThis PR is related to #2620. LightGBM sometimes returns slightly different scores, and `LightGBMTuner` loses the reproducibility due to the differences of objective value history.\r\n\r\n## Description of the changes\r\n\r\nThis PR applies `round` to ignore such differences and keep the original scores in the system attrs.\r\n\r\n## Opinion wanted\r\n\r\nI'm not sure if this workaround works when the score is quite small like `1e-10`, but I believe that the usual scores are as large as 1e-2.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2621/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2621/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2620", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2620/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2620/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2620/events", "html_url": "https://github.com/optuna/optuna/issues/2620", "id": 865610959, "node_id": "MDU6SXNzdWU4NjU2MTA5NTk=", "number": 2620, "title": "`LightGBMTuner` may not be reproducible even if the `optuna_seed` argument is specified.", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-04-23T00:17:38Z", "updated_at": "2021-04-26T00:47:54Z", "closed_at": "2021-04-26T00:47:54Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "## Expected behavior\r\n\r\nThe `optuna_seed` argument was introduced to LightGBM tuners by #2431, but the unit tests about LightGBM tuner's reproducibility sometimes fail.\r\n\r\nIn the test, two lightgbm runs are executed with the same seed values, and they should return the same objective values.\r\n\r\n## Environment\r\n\r\nI saw this issue in the [CI jobs on macOS](https://github.com/optuna/optuna/runs/2408648740#step:7:462) and local windows machine.\r\n\r\nEnvironment of window machine:\r\n- Optuna version: the current master (commit f696b7d4d4afa680160d32ecc48db51d1a7743c1)\r\n- Python version: 3.8.5\r\n- OS: Ubuntu 20.04.2 LTS on Windows 10 WSL2\r\n- (Optional) Other libraries and their versions: lightgbm==3.2.1\r\n\r\n## Error messages, stack traces, or logs\r\n\r\nThe tests failed in the following CI job:\r\nhttps://github.com/optuna/optuna/runs/2408648740#step:7:462\r\n\r\nAnd I saw similar errors on the local windows machine.\r\n\r\n```console\r\n____________ TestLightGBMTuner.test_tune_best_score_reproducibility ____________\r\n\r\nself = <tests.integration_tests.lightgbm_tuner_tests.test_optimize.TestLightGBMTuner object at 0x184611610>\r\n\r\n...\r\n\r\n>       assert best_score_second_try == best_score_first_try\r\nE       assert 4.434944906944917 == 4.542293905553135\r\n\r\ntests/integration_tests/lightgbm_tuner_tests/test_optimize.py:768: AssertionError\r\n\r\n...\r\n\r\n=========================== short test summary info ============================\r\nFAILED tests/integration_tests/lightgbm_tuner_tests/test_optimize.py::TestLightGBMTuner::test_tune_best_score_reproducibility\r\n===== 1 failed, 269 passed, 69 skipped, 142 warnings in 388.59s (0:06:28) ======\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. pip install `pytest-repeat`\r\n2. Run the unit test several times\r\n\r\n```console\r\n$ pytest --count 10 tests/integration_tests/lightgbm_tuner_tests/test_optimize.py::TestLightGBMTuner::test_tune_best_score_reproducibility\r\n$ pytest --count 10 tests/integration_tests/lightgbm_tuner_tests/test_optimize.py::TestLightGBMTunerCV::test_tune_best_score_reproducibility\r\n```\r\n\r\n## Possible Cause\r\n\r\nI found that `lightgbm` sometimes returned slightly different scores. The differences were quite small like `4.6362382010699035` and `4.636238201069904`, but `TPESampler` can distinguish them and suggests different values. I think this is, at least, a part of the cause of the problem.\r\n\r\nI'm not sure, but the precision of floating point values of lightgbm is not enough for the Python code of LightGBM Tuner.\r\n\r\n```\r\n# The first run\r\nRandom seed of TPE Sampler: 10\r\nHistory of objective values: [(-inf, 4.6362382010699035), (-inf, 4.829722101674704), (-inf, 4.6362382010699035), (-inf, 4.6362382010699035), (-inf, 4.636238201069904), (-inf, 4.6362382010699035), (-inf, 4.6362382010699035), (-inf, 4.636238201069904), (-inf, 4.6362382010699035), (-inf, 4.636238201069904)]\r\nnum_leaves: 239\r\n\r\n# The second run\r\nRandom seed of TPE Sampler: 10\r\nHistory of objective values: [(-inf, 4.636238201069904), (-inf, 4.829722101674704), (-inf, 4.6362382010699035), (-inf, 4.636238201069904), (-inf, 4.6362382010699035), (-inf, 4.6362382010699035), (-inf, 4.636238201069904), (-inf, 4.6362382010699035), (-inf, 4.6362382010699035), (-inf, 4.6362382010699035)]\r\nnum_leaves: 132\r\n```\r\n\r\nI'll create a PR about this problem.\r\n\r\n## Additional context (optional)\r\n\r\nI'm not sure if it is related to this issue, but LightGBM seems to be unstable since it caused segmentation fault during the CI job on mac.\r\n\r\nhttps://github.com/optuna/optuna/runs/2408648740#step:7:462\r\n\r\n<details>\r\n<summary>Log message</summary>\r\n\r\n```console\r\ntests/integration_tests/test_lightgbm.py ..\r\n[I 2021-04-22 09:32:26,452] A new study created in memory with name: no-name-212e3c9d-bd0f-4869-8609-e96e5966c4dd\r\n[I 2021-04-22 09:32:26,454] A new study created in memory with name: no-name-f0580782-d194-47ea-b55f-68c2a1c34d07\r\n[I 2021-04-22 09:32:26,455] A new study created in memory with name: no-name-cf87ee24-86ff-4221-81d5-9b6475181ec4\r\n[I 2021-04-22 09:32:26,457] A new study created in memory with name: no-name-32d29e4f-ac61-48da-be89-a5fe89b5feed\r\nFatal Python error: Segmentation fault\r\n\r\nThread 0x00007000031d1000 (most recent call first):\r\n\r\nThread 0x00000001066c3dc0 (most recent call first):\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/lightgbm/basic.py\", line 1392 in __init_from_csr\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/lightgbm/basic.py\", line 1278 in _lazy_init\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/lightgbm/basic.py\", line 1472 in construct\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/lightgbm/basic.py\", line 2229 in __init__\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/lightgbm/engine.py\", line 228 in train\r\n  File \"/Users/runner/work/optuna/optuna/tests/integration_tests/test_lightgbm.py\", line 145 in objective\r\n  File \"/Users/runner/work/optuna/optuna/optuna/_optimize.py\", line 217 in _run_trial\r\n  File \"/Users/runner/work/optuna/optuna/optuna/_optimize.py\", line 163 in _optimize_sequential\r\n  File \"/Users/runner/work/optuna/optuna/optuna/_optimize.py\", line 76 in _optimize\r\n  File \"/Users/runner/work/optuna/optuna/optuna/study.py\", line 409 in optimize\r\n  File \"/Users/runner/work/optuna/optuna/tests/integration_tests/test_lightgbm.py\", line 51 in test_lightgbm_pruning_callback\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/_pytest/python.py\", line 183 in pytest_pyfunc_call\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/pluggy/callers.py\", line 187 in _multicall\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/pluggy/manager.py\", line 87 in <lambda>\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/pluggy/manager.py\", line 93 in _hookexec\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/pluggy/hooks.py\", line 286 in __call__\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/_pytest/python.py\", line 1641 in runtest\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/_pytest/runner.py\", line 162 in pytest_runtest_call\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/pluggy/callers.py\", line 187 in _multicall\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/pluggy/manager.py\", line 87 in <lambda>\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/pluggy/manager.py\", line 93 in _hookexec\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/pluggy/hooks.py\", line 286 in __call__\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/_pytest/runner.py\", line 255 in <lambda>\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/_pytest/runner.py\", line 311 in from_call\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/_pytest/runner.py\", line 255 in call_runtest_hook\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/_pytest/runner.py\", line 215 in call_and_report\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/_pytest/runner.py\", line 126 in runtestprotocol\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/_pytest/runner.py\", line 109 in pytest_runtest_protocol\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/pluggy/callers.py\", line 187 in _multicall\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/pluggy/manager.py\", line 87 in <lambda>\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/pluggy/manager.py\", line 93 in _hookexec\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/pluggy/hooks.py\", line 286 in __call__\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/_pytest/main.py\", line 348 in pytest_runtestloop\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/pluggy/callers.py\", line 187 in _multicall\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/pluggy/manager.py\", line 87 in <lambda>\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/pluggy/manager.py\", line 93 in _hookexec\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/pluggy/hooks.py\", line 286 in __call__\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/_pytest/main.py\", line 323 in _main\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/_pytest/main.py\", line 269 in wrap_session\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/_pytest/main.py\", line 316 in pytest_cmdline_main\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/pluggy/callers.py\", line 187 in _multicall\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/pluggy/manager.py\", line 87 in <lambda>\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/pluggy/manager.py\", line 93 in _hookexec\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/pluggy/hooks.py\", line 286 in __call__\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/_pytest/config/__init__.py\", line 163 in main\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/_pytest/config/__init__.py\", line 185 in console_main\r\n  File \"/Users/runner/hostedtoolcache/Python/3.7.10/x64/bin/pytest\", line 8 in <module>\r\n/Users/runner/work/_temp/3976062e-5119-4031-b08b-ff82aaa0731d.sh: line 2:  4391 Segmentation fault: 11  pytest -s tests/integration_tests\r\nError: Process completed with exit code 139.\r\n```\r\n</detials>", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2620/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2620/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2613", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2613/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2613/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2613/events", "html_url": "https://github.com/optuna/optuna/issues/2613", "id": 863922025, "node_id": "MDU6SXNzdWU4NjM5MjIwMjU=", "number": 2613, "title": "plot_contour not working with multi-objective study", "user": {"login": "Akkarine", "id": 13115270, "node_id": "MDQ6VXNlcjEzMTE1Mjcw", "avatar_url": "https://avatars.githubusercontent.com/u/13115270?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Akkarine", "html_url": "https://github.com/Akkarine", "followers_url": "https://api.github.com/users/Akkarine/followers", "following_url": "https://api.github.com/users/Akkarine/following{/other_user}", "gists_url": "https://api.github.com/users/Akkarine/gists{/gist_id}", "starred_url": "https://api.github.com/users/Akkarine/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Akkarine/subscriptions", "organizations_url": "https://api.github.com/users/Akkarine/orgs", "repos_url": "https://api.github.com/users/Akkarine/repos", "events_url": "https://api.github.com/users/Akkarine/events{/privacy}", "received_events_url": "https://api.github.com/users/Akkarine/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-04-21T13:57:21Z", "updated_at": "2021-04-21T15:21:02Z", "closed_at": "2021-04-21T15:21:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "`_get_contour_plot()` at `optuna/visualization/_contour.py` is not compatible with multi-objective study.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.7.0\r\n- Python version: 3.8.5\r\n- OS: ubuntu 20.04.2\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-48-3ccdd3f1173a> in <module>\r\n----> 1 optuna.visualization.plot_contour(study=study, target=value_to_display, target_name=target_name, params=['daily_seasonality','weekly_seasonality'])\r\n\r\n~/.local/share/virtualenvs/jupyterlab-NhNFbejC/lib/python3.8/site-packages/optuna/visualization/_contour.py in plot_contour(study, params, target, target_name)\r\n     88     _imports.check()\r\n     89     _check_plot_args(study, target, target_name)\r\n---> 90     return _get_contour_plot(study, params, target, target_name)\r\n     91 \r\n     92 \r\n\r\n~/.local/share/virtualenvs/jupyterlab-NhNFbejC/lib/python3.8/site-packages/optuna/visualization/_contour.py in _get_contour_plot(study, params, target, target_name)\r\n    159         y_param = sorted_params[1]\r\n    160         sub_plots = _generate_contour_subplot(\r\n--> 161             trials, x_param, y_param, study.direction, param_values_range, target, target_name\r\n    162         )\r\n    163         figure = go.Figure(data=sub_plots, layout=layout)\r\n\r\n~/.local/share/virtualenvs/jupyterlab-NhNFbejC/lib/python3.8/site-packages/optuna/study.py in direction(self)\r\n    125 \r\n    126         if self._is_multi_objective():\r\n--> 127             raise RuntimeError(\r\n    128                 \"A single direction cannot be retrieved from a multi-objective study. Consider \"\r\n    129                 \"using Study.directions to retrieve a list containing all directions.\"\r\n\r\nRuntimeError: A single direction cannot be retrieved from a multi-objective study. Consider using Study.directions to retrieve a list containing all directions.\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2613/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2613/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2596", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2596/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2596/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2596/events", "html_url": "https://github.com/optuna/optuna/issues/2596", "id": 860376853, "node_id": "MDU6SXNzdWU4NjAzNzY4NTM=", "number": 2596, "title": "Switch off grid lines in matplotlib parallel coordinate plot", "user": {"login": "pplonski", "id": 6959032, "node_id": "MDQ6VXNlcjY5NTkwMzI=", "avatar_url": "https://avatars.githubusercontent.com/u/6959032?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pplonski", "html_url": "https://github.com/pplonski", "followers_url": "https://api.github.com/users/pplonski/followers", "following_url": "https://api.github.com/users/pplonski/following{/other_user}", "gists_url": "https://api.github.com/users/pplonski/gists{/gist_id}", "starred_url": "https://api.github.com/users/pplonski/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pplonski/subscriptions", "organizations_url": "https://api.github.com/users/pplonski/orgs", "repos_url": "https://api.github.com/users/pplonski/repos", "events_url": "https://api.github.com/users/pplonski/events{/privacy}", "received_events_url": "https://api.github.com/users/pplonski/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-04-17T10:17:11Z", "updated_at": "2021-04-17T13:01:32Z", "closed_at": "2021-04-17T12:59:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "In the matplotlib parallel coordinate plot there are grid lines that make the plot hard to read. They should be switched off. The grid lines are added to each ax of the parallel coordinate plot and that's why they break the image.\r\n\r\n![image](https://user-images.githubusercontent.com/6959032/115109459-21fb3280-9f76-11eb-8b81-92411db57d41.png)\r\n\r\n\r\nThis can be fixed by setting matplotlib properties before calling the plot method:\r\n```python\r\nplt.rcParams[\"axes.grid\"] = False\r\n```\r\n\r\nbut I believe it will be better to switch it off in the plot method.\r\n\r\nThis problem is only for matplotlib backend.\r\n\r\n\r\nI would like to thank you for the two backends for plots. I love the plotly interactive plots in the jupyter notebook. For creating reports I'm using matplotlib backend plots because I don't want to install additional plotly dependencies (with chromium) to save plots to png files. Thank you!\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2596/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2596/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2595", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2595/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2595/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2595/events", "html_url": "https://github.com/optuna/optuna/issues/2595", "id": 859598494, "node_id": "MDU6SXNzdWU4NTk1OTg0OTQ=", "number": 2595, "title": "The objective range of Matplotlib contour plot has a different numerical range from Plotly backend", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2021-04-16T08:34:11Z", "updated_at": "2021-06-09T13:10:41Z", "closed_at": "2021-06-09T13:10:41Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n## Expected behavior\r\n\r\nThe range of objective  in `optuna.visualization.matplotlib.plot_contour` should have a similar range to `optuna.visualization.plot_contour`.\r\n\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.7.0\r\n- Python version: 3.8.8\r\n- OS: Mac\r\n- (Optional) Other libraries and their versions:\r\n    - matplotlib: 3.3.4\r\n    - Plotly: 4.11.0\r\n\r\n## Error messages, stack traces, or logs\r\nThe matplotlib range is from `-60 000` to `360 000` as in the following figure.\r\n\r\n![download (2)](https://user-images.githubusercontent.com/7121753/114876635-79e04f00-9e39-11eb-97c6-3b7b16e89456.png)\r\n\r\nOn the other hand, Plotly's range is from `0` to `9 000`. That is supposed to be true.\r\n\r\n![newplot (2)](https://user-images.githubusercontent.com/7121753/114876650-7baa1280-9e39-11eb-9c3e-554d16ed2496.png)\r\n\r\n\r\n## Steps to reproduce\r\n\r\n1. Please run a following example code blocks\r\n\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\nimport optuna\r\n\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_uniform('x', -100, 100)\r\n    y = trial.suggest_categorical('y', list(range(-10, 10)))\r\n    z = trial.suggest_uniform('z', -100, 100)\r\n    return x ** 2 + y - z\r\n\r\nstudy = optuna.create_study(sampler=optuna.samplers.TPESampler(seed=7))\r\nstudy.optimize(objective, n_trials=200)\r\n\r\noptuna.visualization.matplotlib.plot_contour(study, params=['y', 'z'])\r\noptuna.visualization.plot_contour(study, params=['y', 'z']) # plotly\r\n```\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2595/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2595/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2589", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2589/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2589/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2589/events", "html_url": "https://github.com/optuna/optuna/pull/2589", "id": 856787703, "node_id": "MDExOlB1bGxSZXF1ZXN0NjE0MzEyMTYw", "number": 2589, "title": "Fix contour plot with multi-objective study and `target` being specified", "user": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562070, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDcw", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.testing", "name": "optuna.testing", "color": "1c659e", "default": false, "description": "Related to the `optuna.testing` submodule. This is automatically labeled by github-actions."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/35", "html_url": "https://github.com/optuna/optuna/milestone/35", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/35/labels", "id": 6618764, "node_id": "MDk6TWlsZXN0b25lNjYxODc2NA==", "number": 35, "title": "v2.8.0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 89, "state": "closed", "created_at": "2021-04-02T05:04:44Z", "updated_at": "2021-06-07T07:06:35Z", "due_on": null, "closed_at": "2021-06-07T07:06:35Z"}, "comments": 2, "created_at": "2021-04-13T09:45:15Z", "updated_at": "2021-04-14T02:03:51Z", "closed_at": "2021-04-14T01:59:14Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2589", "html_url": "https://github.com/optuna/optuna/pull/2589", "diff_url": "https://github.com/optuna/optuna/pull/2589.diff", "patch_url": "https://github.com/optuna/optuna/pull/2589.patch", "merged_at": "2021-04-14T01:59:14Z"}, "body": "## Motivation\r\n\r\nContour plots should work even for multi objective studies as long as the `target` argument is specified. Currently, they do not.\r\n\r\n## Description of the changes\r\n\r\nFixes contour plot to ignore the direction if `target` is specified.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2589/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2589/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2584", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2584/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2584/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2584/events", "html_url": "https://github.com/optuna/optuna/pull/2584", "id": 855970248, "node_id": "MDExOlB1bGxSZXF1ZXN0NjEzNjI0MTM1", "number": 2584, "title": "Add type conversion for reference point and solution set", "user": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/35", "html_url": "https://github.com/optuna/optuna/milestone/35", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/35/labels", "id": 6618764, "node_id": "MDk6TWlsZXN0b25lNjYxODc2NA==", "number": 35, "title": "v2.8.0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 89, "state": "closed", "created_at": "2021-04-02T05:04:44Z", "updated_at": "2021-06-07T07:06:35Z", "due_on": null, "closed_at": "2021-06-07T07:06:35Z"}, "comments": 2, "created_at": "2021-04-12T13:20:12Z", "updated_at": "2021-04-14T02:42:51Z", "closed_at": "2021-04-13T21:52:29Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2584", "html_url": "https://github.com/optuna/optuna/pull/2584", "diff_url": "https://github.com/optuna/optuna/pull/2584.diff", "patch_url": "https://github.com/optuna/optuna/pull/2584.patch", "merged_at": "2021-04-13T21:52:29Z"}, "body": "## Motivation\r\nThis PR is sent for #2421.\r\n\r\nWhen `np.ndarray` of integers is passed to `optuna.multi_objective._hypervolume.WFG.compute()`, the result become incorrect. This PR adds explicitly type conversions for `reference_point` and `solution_set` to make `optuna.multi_objective._hypervolume.WFG._compute_rec` takes only ndarray of floating points.\r\n\r\n## Description of the changes\r\n- Add type conversion for `reference_point` and `solution_set` in `optuna.multi_objective._hypervolume.WFG.compute()`\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2584/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2584/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2580", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2580/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2580/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2580/events", "html_url": "https://github.com/optuna/optuna/issues/2580", "id": 855356766, "node_id": "MDU6SXNzdWU4NTUzNTY3NjY=", "number": 2580, "title": "optuna/optuna/blob/master/examples/rl/sb3_simple.py AttributeError: 'DummyVecEnv' object has no attribute 'venv'", "user": {"login": "patterntrade", "id": 45533621, "node_id": "MDQ6VXNlcjQ1NTMzNjIx", "avatar_url": "https://avatars.githubusercontent.com/u/45533621?v=4", "gravatar_id": "", "url": "https://api.github.com/users/patterntrade", "html_url": "https://github.com/patterntrade", "followers_url": "https://api.github.com/users/patterntrade/followers", "following_url": "https://api.github.com/users/patterntrade/following{/other_user}", "gists_url": "https://api.github.com/users/patterntrade/gists{/gist_id}", "starred_url": "https://api.github.com/users/patterntrade/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/patterntrade/subscriptions", "organizations_url": "https://api.github.com/users/patterntrade/orgs", "repos_url": "https://api.github.com/users/patterntrade/repos", "events_url": "https://api.github.com/users/patterntrade/events{/privacy}", "received_events_url": "https://api.github.com/users/patterntrade/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-04-11T17:06:09Z", "updated_at": "2021-07-05T00:57:45Z", "closed_at": "2021-07-05T00:57:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "### \ud83d\udc1b Bug\r\n\r\nIn optuna/optuna/blob/master/examples/rl/sb3_simple.py\r\n\r\nCartPole-type envs working, but not Atari envs. \r\n\r\nOnly change: Line 30 changed to `ENV_ID = \"AirRaid-v4\"`\r\n\r\nComplains: `AttributeError: 'DummyVecEnv' object has no attribute 'venv'`\r\n(Also: `UserWarning: Training and eval env are not of the same type)`\r\n\r\n```\r\n A new study created in memory with name: no-name-ce409574-70b2-4e87-bafa-e7064d74d8f0\r\n/home/usr/.virtualenvs/v_env/lib/python3.8/site-packages/optuna/study.py:393: FutureWarning: `n_jobs` argument has been deprecated in v2.7.0. This feature will be removed in v4.0.0. See https://github.com/optuna/optuna/releases/tag/v2.7.0.\r\n  warnings.warn(\r\n/home/usr/.virtualenvs/v_env/lib/python3.8/site-packages/stable_baselines3/common/callbacks.py:327: UserWarning: Training and eval env are not of the same type<stable_baselines3.common.vec_env.vec_transpose.VecTransposeImage object at 0x7f70b3ee8ee0> != <stable_baselines3.common.vec_env.dummy_vec_env.DummyVecEnv object at 0x7f70b248d7c0>\r\n  warnings.warn(\"Training and eval env are not of the same type\" f\"{self.training_env} != {self.eval_env}\")\r\n/home/usr/.virtualenvs/v_env/lib/python3.8/site-packages/stable_baselines3/common/callbacks.py:327: UserWarning: Training and eval env are not of the same type<stable_baselines3.common.vec_env.vec_transpose.VecTransposeImage object at 0x7f70b3efddf0> != <stable_baselines3.common.vec_env.dummy_vec_env.DummyVecEnv object at 0x7f70b248d940>\r\n  warnings.warn(\"Training and eval env are not of the same type\" f\"{self.training_env} != {self.eval_env}\")\r\n[W 2021-04-11 19:00:38,748] Trial 0 failed because of the following error: AttributeError(\"'DummyVecEnv' object has no attribute 'venv'\")\r\nTraceback (most recent call last):\r\n  File \"/home/usr/.virtualenvs/v_env/lib/python3.8/site-packages/optuna/_optimize.py\", line 217, in _run_trial\r\n    value_or_values = func(trial)\r\n  File \"/home/usr/v_env/opt_uni_gpu.py\", line 129, in objective\r\n    model.learn(N_TIMESTEPS, callback=eval_callback)\r\n  File \"/home/usr/.virtualenvs/v_env/lib/python3.8/site-packages/stable_baselines3/a2c/a2c.py\", line 190, in learn\r\n    return super(A2C, self).learn(\r\n  File \"/home/usr/.virtualenvs/v_env/lib/python3.8/site-packages/stable_baselines3/common/on_policy_algorithm.py\", line 227, in learn\r\n    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)\r\n  File \"/home/usr/.virtualenvs/v_env/lib/python3.8/site-packages/stable_baselines3/common/on_policy_algorithm.py\", line 174, in collect_rollouts\r\n    if callback.on_step() is False:\r\n  File \"/home/usr/.virtualenvs/v_env/lib/python3.8/site-packages/stable_baselines3/common/callbacks.py\", line 88, in on_step\r\n    return self._on_step()\r\n  File \"/home/usr/v_env/opt_uni_gpu.py\", line 102, in _on_step\r\n    super()._on_step()\r\n  File \"/home/usr/.virtualenvs/v_env/lib/python3.8/site-packages/stable_baselines3/common/callbacks.py\", line 358, in _on_step\r\n    sync_envs_normalization(self.training_env, self.eval_env)\r\n  File \"/home/usr/.virtualenvs/v_env/lib/python3.8/site-packages/stable_baselines3/common/vec_env/__init__.py\", line 69, in sync_envs_normalization\r\n    eval_env_tmp = eval_env_tmp.venv\r\nAttributeError: 'DummyVecEnv' object has no attribute 'venv'\r\n```\r\n\r\n### Expected behavior\r\n\r\nAtari and custom env's to work just as well as EG CartPole\r\n\r\n### System Info\r\n\r\n* Ubuntu desktop\r\n* All installed with pip\r\n* 2x RTX 2070\r\n* 48 GB RAM\r\n* Python 3.8.5 64-bit\r\n* Pytorch 1.8.1+cu102\r\n* Gym version 0.18.0\r\n* Stable_baselines3 1.0\r\n* x86 architecture\r\n\r\n### Checklist\r\n\r\n- [v] I have checked that there is no similar [issue](https://github.com/DLR-RM/stable-baselines3/issues) in the repo (**required**)\r\n- [v] I have read the [documentation](https://stable-baselines3.readthedocs.io/en/master/) (**required**)\r\n- [v] I have provided a minimal working example to reproduce the bug (**required**)\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2580/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2580/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2570", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2570/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2570/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2570/events", "html_url": "https://github.com/optuna/optuna/issues/2570", "id": 851497608, "node_id": "MDU6SXNzdWU4NTE0OTc2MDg=", "number": 2570, "title": "LightGBMTuner seems to print a lot with verbosity -1", "user": {"login": "alexis-intellegens", "id": 70898844, "node_id": "MDQ6VXNlcjcwODk4ODQ0", "avatar_url": "https://avatars.githubusercontent.com/u/70898844?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexis-intellegens", "html_url": "https://github.com/alexis-intellegens", "followers_url": "https://api.github.com/users/alexis-intellegens/followers", "following_url": "https://api.github.com/users/alexis-intellegens/following{/other_user}", "gists_url": "https://api.github.com/users/alexis-intellegens/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexis-intellegens/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexis-intellegens/subscriptions", "organizations_url": "https://api.github.com/users/alexis-intellegens/orgs", "repos_url": "https://api.github.com/users/alexis-intellegens/repos", "events_url": "https://api.github.com/users/alexis-intellegens/events{/privacy}", "received_events_url": "https://api.github.com/users/alexis-intellegens/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-04-06T14:40:59Z", "updated_at": "2021-04-06T15:05:56Z", "closed_at": "2021-04-06T15:05:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Expected behavior\r\n\r\nI run the tuner with verbosity off for both lightGBM and Optuna, I expect no printouts. Instead I get a bunch.\r\n\r\nFull code:\r\n```[python]\r\nfrom optuna.integration.lightgbm import LightGBMTuner\r\nimport optuna\r\nfrom sklearn.model_selection import train_test_split\r\nimport numpy as np\r\nimport lightgbm as lgb\r\n\r\noptuna.logging.set_verbosity(verbosity=0)\r\n\r\n# make a synthetic dataset\r\nX = np.random.random(size=[2_000, 10])\r\ny = np.sum(X, axis = 1)\r\nX_train, X_test, y_train, y_test = train_test_split(X, y)\r\ntrain_data = lgb.Dataset(X_train, label=y_train)\r\nvalid_data = lgb.Dataset(X_test, label=y_test)\r\n\r\nparams = {\r\n        \"objective\": \"regression\",\r\n        \"metric\": \"l2\",\r\n        \"verbosity\": -5,\r\n    }\r\n\r\noptimiser = LightGBMTuner(params=params, time_budget=10, train_set=train_data, valid_sets=valid_data, num_boost_round=100)\r\noptimiser.run()\r\n```\r\n\r\nOutputs:\r\n```\r\n\r\n\r\n  0%|          | 0/7 [00:00<?, ?it/s]\r\n\r\nfeature_fraction, val_score: inf:   0%|          | 0/7 [00:00<?, ?it/s]\r\n\r\nfeature_fraction, val_score: 0.059230:   0%|          | 0/7 [00:00<?, ?it/s]\r\n\r\nfeature_fraction, val_score: 0.059230:  14%|#4        | 1/7 [00:00<00:00,  7.10it/s]\r\n\r\nfeature_fraction, val_score: 0.059230:  14%|#4        | 1/7 [00:00<00:00,  7.10it/s]\r\n[1]\tvalid_0's l2: 0.833219\r\n[2]\tvalid_0's l2: 0.774187\r\n[3]\tvalid_0's l2: 0.717872\r\n[4]\tvalid_0's l2: 0.666161\r\n[5]\tvalid_0's l2: 0.62173\r\n[6]\tvalid_0's l2: 0.58181\r\n[7]\tvalid_0's l2: 0.539303\r\n....\r\n```\r\nand so on for every boosted round. I can't seem to find many docs around using LightGBMTuner directly however I am running it similarly to: https://github.com/optuna/optuna/blob/master/examples/lightgbm/lightgbm_tuner_simple.py\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.5.0\r\n- Python version: 3.8.5 anaconda Python\r\n- OS: Ubuntu 18.04 WSL2 on Windows 10\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2570/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2570/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2557", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2557/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2557/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2557/events", "html_url": "https://github.com/optuna/optuna/issues/2557", "id": 848874371, "node_id": "MDU6SXNzdWU4NDg4NzQzNzE=", "number": 2557, "title": "trial.suggest_int() ignores step", "user": {"login": "shu65", "id": 261656, "node_id": "MDQ6VXNlcjI2MTY1Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/261656?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shu65", "html_url": "https://github.com/shu65", "followers_url": "https://api.github.com/users/shu65/followers", "following_url": "https://api.github.com/users/shu65/following{/other_user}", "gists_url": "https://api.github.com/users/shu65/gists{/gist_id}", "starred_url": "https://api.github.com/users/shu65/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shu65/subscriptions", "organizations_url": "https://api.github.com/users/shu65/orgs", "repos_url": "https://api.github.com/users/shu65/repos", "events_url": "https://api.github.com/users/shu65/events{/privacy}", "received_events_url": "https://api.github.com/users/shu65/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 2107128673, "node_id": "MDU6TGFiZWwyMTA3MTI4Njcz", "url": "https://api.github.com/repos/optuna/optuna/labels/no-stale", "name": "no-stale", "color": "BBBBBB", "default": false, "description": "Exempt from stale bot"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-04-02T00:33:11Z", "updated_at": "2021-05-13T04:36:29Z", "closed_at": "2021-05-13T04:36:29Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I used `trial.suggest_int()` with step. But, `suggest_int()` ignores arguments when study has trials with different distributions.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.6.0 \r\n- Python version: 3.7.10\r\n- OS: (I used Google Colab)\r\n- (Optional) Other libraries and their versions:\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n# error messages, stack traces, or logs\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. run reproducible example on Google Colab\r\n\r\n## Reproducible examples (optional)\r\n\r\nBug case:\r\n```python\r\nimport optuna\r\n\r\nsampler = optuna.samplers.TPESampler(multivariate=True, n_startup_trials=10)\r\nstudy = optuna.create_study(direction='maximize', sampler=sampler)\r\n\r\ntest_int_dist = optuna.distributions.IntUniformDistribution(0, 100) # no step\r\nfor v in range(100):\r\n  trial = optuna.trial.create_trial(\r\n          params={'test-int':v},\r\n          distributions={'test-int': test_int_dist},\r\n          value=0)\r\n  study.add_trial(trial)\r\n\r\ntrial = study.ask()\r\ntrial.suggest_int('test-int', low=0, high=100, step=5) # specific step\r\n```\r\n\r\nthe output is this:\r\n![image](https://user-images.githubusercontent.com/261656/113367103-1f091b00-9396-11eb-8d80-4a7dba851d0f.png)\r\n\r\ncorrect case:\r\n```python\r\nimport optuna\r\n\r\nsampler = optuna.samplers.TPESampler(multivariate=True, n_startup_trials=10)\r\nstudy = optuna.create_study(direction='maximize', sampler=sampler)\r\n\r\ntest_int_dist = optuna.distributions.IntUniformDistribution(0, 100, step=5) \r\nfor v in range(100):\r\n  trial = optuna.trial.create_trial(\r\n          params={'test-int':v},\r\n          distributions={'test-int': test_int_dist},\r\n          value=0)\r\n  study.add_trial(trial)\r\n\r\ntrial = study.ask()\r\ntrial.suggest_int('test-int', low=0, high=100, step=5) # specific step\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2557/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2557/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2542", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2542/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2542/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2542/events", "html_url": "https://github.com/optuna/optuna/issues/2542", "id": 844283734, "node_id": "MDU6SXNzdWU4NDQyODM3MzQ=", "number": 2542, "title": "`ZeroDivisionError` when plotting parameter importance", "user": {"login": "dmar1n", "id": 19255753, "node_id": "MDQ6VXNlcjE5MjU1NzUz", "avatar_url": "https://avatars.githubusercontent.com/u/19255753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dmar1n", "html_url": "https://github.com/dmar1n", "followers_url": "https://api.github.com/users/dmar1n/followers", "following_url": "https://api.github.com/users/dmar1n/following{/other_user}", "gists_url": "https://api.github.com/users/dmar1n/gists{/gist_id}", "starred_url": "https://api.github.com/users/dmar1n/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dmar1n/subscriptions", "organizations_url": "https://api.github.com/users/dmar1n/orgs", "repos_url": "https://api.github.com/users/dmar1n/repos", "events_url": "https://api.github.com/users/dmar1n/events{/privacy}", "received_events_url": "https://api.github.com/users/dmar1n/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}, {"id": 2107128673, "node_id": "MDU6TGFiZWwyMTA3MTI4Njcz", "url": "https://api.github.com/repos/optuna/optuna/labels/no-stale", "name": "no-stale", "color": "BBBBBB", "default": false, "description": "Exempt from stale bot"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-03-30T09:31:32Z", "updated_at": "2021-11-12T04:01:04Z", "closed_at": "2021-11-12T04:01:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "Plotting parameter importance of a multi-objective study causes a `ZeroDivisionError: Weights sum to zero, can't be normalized.` The error happens with a with two-objective study, which otherwise runs nicely and produces a Pareto plot without any problem.\r\n\r\n## Expected behavior\r\n\r\nGenerate a plot of parameter importance based on a multi-objective study, as described in the documentation.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.6.0\r\n- Python version: 3.8\r\n- OS: Ubuntu 18.04\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nERROR Traceback (most recent call last):\r\n  File \"/opt/mt/anaconda3/envs/develop/lib/python3.8/site-packages/optuna/visualization/_param_importances.py\", line 126, in plot_param_importances\r\n    importances = optuna.importance.get_param_importances(\r\n  File \"/opt/mt/anaconda3/envs/develop/lib/python3.8/site-packages/optuna/importance/__init__.py\", line 91, in get_param_importances\r\n    return evaluator.evaluate(study, params=params, target=target)\r\n  File \"/opt/mt/anaconda3/envs/develop/lib/python3.8/site-packages/optuna/importance/_fanova/_evaluator.py\", line 121, in evaluate\r\n    evaluator.fit(\r\n  File \"/opt/mt/anaconda3/envs/develop/lib/python3.8/site-packages/optuna/importance/_fanova/_fanova.py\", line 74, in fit\r\n    self._trees = [_FanovaTree(e.tree_, search_spaces) for e in self._forest.estimators_]\r\n  File \"/opt/mt/anaconda3/envs/develop/lib/python3.8/site-packages/optuna/importance/_fanova/_fanova.py\", line 74, in <listcomp>\r\n    self._trees = [_FanovaTree(e.tree_, search_spaces) for e in self._forest.estimators_]\r\n  File \"/opt/mt/anaconda3/envs/develop/lib/python3.8/site-packages/optuna/importance/_fanova/_tree.py\", line 23, in __init__\r\n    statistics = self._precompute_statistics()\r\n  File \"/opt/mt/anaconda3/envs/develop/lib/python3.8/site-packages/optuna/importance/_fanova/_tree.py\", line 185, in _precompute_statistics\r\n    value = numpy.average(child_values, weights=child_weights)\r\n  File \"<__array_function__ internals>\", line 5, in average\r\n  File \"/opt/mt/anaconda3/envs/develop/lib/python3.8/site-packages/numpy/lib/function_base.py\", line 409, in average\r\n    raise ZeroDivisionError(\r\nZeroDivisionError: Weights sum to zero, can't be normalized\r\n\r\n---------------------------------------------------------------------------\r\nZeroDivisionError                         Traceback (most recent call last)\r\n<ipython-input-10-380c9d9887b3> in <module>\r\n/opt/mt/anaconda3/envs/develop/lib/python3.8/site-packages/... in create_param_importance_plot(self)\r\n    168 \r\n    169     def create_param_importance_plot(self):\r\n--> 170         param_importance_fig = optuna.visualization.plot_param_importances(\r\n    171             self.study, target_name=Q_METRIC_NAME, target=lambda t: t.values[0]\r\n    172         )\r\n\r\n/opt/mt/anaconda3/envs/develop/lib/python3.8/site-packages/optuna/visualization/_param_importances.py in plot_param_importances(study, evaluator, params, target, target_name)\r\n    124         return go.Figure(data=[], layout=layout)\r\n    125 \r\n--> 126     importances = optuna.importance.get_param_importances(\r\n    127         study, evaluator=evaluator, params=params, target=target\r\n    128     )\r\n\r\n/opt/mt/anaconda3/envs/develop/lib/python3.8/site-packages/optuna/importance/__init__.py in get_param_importances(study, evaluator, params, target)\r\n     89         raise TypeError(\"Evaluator must be a subclass of BaseImportanceEvaluator.\")\r\n     90 \r\n---> 91     return evaluator.evaluate(study, params=params, target=target)\r\n\r\n/opt/mt/anaconda3/envs/develop/lib/python3.8/site-packages/optuna/importance/_fanova/_evaluator.py in evaluate(self, study, params, target)\r\n    119 \r\n    120         evaluator = self._evaluator\r\n--> 121         evaluator.fit(\r\n    122             X=trans_params,\r\n    123             y=trans_values,\r\n\r\n/opt/mt/anaconda3/envs/develop/lib/python3.8/site-packages/optuna/importance/_fanova/_fanova.py in fit(self, X, y, search_spaces, column_to_encoded_columns)\r\n     72         self._forest.fit(X, y)\r\n     73 \r\n---> 74         self._trees = [_FanovaTree(e.tree_, search_spaces) for e in self._forest.estimators_]\r\n     75         self._column_to_encoded_columns = column_to_encoded_columns\r\n     76         self._variances = {}\r\n\r\n/opt/mt/anaconda3/envs/develop/lib/python3.8/site-packages/optuna/importance/_fanova/_fanova.py in <listcomp>(.0)\r\n     72         self._forest.fit(X, y)\r\n     73 \r\n---> 74         self._trees = [_FanovaTree(e.tree_, search_spaces) for e in self._forest.estimators_]\r\n     75         self._column_to_encoded_columns = column_to_encoded_columns\r\n     76         self._variances = {}\r\n\r\n/opt/mt/anaconda3/envs/develop/lib/python3.8/site-packages/optuna/importance/_fanova/_tree.py in __init__(self, tree, search_spaces)\r\n     21         self._search_spaces = search_spaces\r\n     22 \r\n---> 23         statistics = self._precompute_statistics()\r\n     24         split_midpoints, split_sizes = self._precompute_split_midpoints_and_sizes()\r\n     25         subtree_active_features = self._precompute_subtree_active_features()\r\n\r\n/opt/mt/anaconda3/envs/develop/lib/python3.8/site-packages/optuna/importance/_fanova/_tree.py in _precompute_statistics(self)\r\n    183                     child_values.append(statistics[child_node_index, 0])\r\n    184                     child_weights.append(statistics[child_node_index, 1])\r\n--> 185                 value = numpy.average(child_values, weights=child_weights)\r\n    186                 weight = numpy.sum(child_weights)\r\n    187                 statistics[node_index] = [value, weight]\r\n\r\n<__array_function__ internals> in average(*args, **kwargs)\r\n\r\n/opt/mt/anaconda3/envs/develop/lib/python3.8/site-packages/numpy/lib/function_base.py in average(a, axis, weights, returned)\r\n    407         scl = wgt.sum(axis=axis, dtype=result_dtype)\r\n    408         if np.any(scl == 0.0):\r\n--> 409             raise ZeroDivisionError(\r\n    410                 \"Weights sum to zero, can't be normalized\")\r\n    411 \r\n\r\nZeroDivisionError: Weights sum to zero, can't be normalized\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Configure and run a default study with two objectives (maximize, maximize), the main function returning the result of a rounded float for one objective and an integer division for the second objective.\r\n2. Generate a parameter importance plot with:\r\n```python\r\nfig = optuna.visualization.plot_param_importances(study, target_name=METRIC_NAME, target=lambda t: t.values[0]) \r\n```\r\n\r\n## Additional context (optional)\r\n\r\nApart from the param importances not being generated, the study runs smoothly and I can generate a Pareto front plot without any problem.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2542/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2542/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2540", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2540/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2540/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2540/events", "html_url": "https://github.com/optuna/optuna/issues/2540", "id": 843814237, "node_id": "MDU6SXNzdWU4NDM4MTQyMzc=", "number": 2540, "title": "Reproducibility problem with optuna.integration.OptunaSearchCV", "user": {"login": "cconstantinou73", "id": 75975438, "node_id": "MDQ6VXNlcjc1OTc1NDM4", "avatar_url": "https://avatars.githubusercontent.com/u/75975438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cconstantinou73", "html_url": "https://github.com/cconstantinou73", "followers_url": "https://api.github.com/users/cconstantinou73/followers", "following_url": "https://api.github.com/users/cconstantinou73/following{/other_user}", "gists_url": "https://api.github.com/users/cconstantinou73/gists{/gist_id}", "starred_url": "https://api.github.com/users/cconstantinou73/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cconstantinou73/subscriptions", "organizations_url": "https://api.github.com/users/cconstantinou73/orgs", "repos_url": "https://api.github.com/users/cconstantinou73/repos", "events_url": "https://api.github.com/users/cconstantinou73/events{/privacy}", "received_events_url": "https://api.github.com/users/cconstantinou73/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2021-03-29T21:11:32Z", "updated_at": "2021-03-31T09:55:12Z", "closed_at": "2021-03-31T09:55:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n## Problem in getting reproducible results using a specified seed. After consecutive trials the model_grid.best_params_ printed are different each time despite specifying a seed for the random_state argument\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\n## I expect to have reproducible results\r\n\r\n- Optuna version: '2.0.0'\r\n- Python version: Python 3.8.8\r\n- OS: PRETTY_NAME=\"Ubuntu 18.04.3 LTS\", VERSION_ID=\"18.04\"\r\n- (Optional) Other libraries and their versions:\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n# error messages, stack traces, or logs\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. see script below\r\n2.\r\n3.\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\n\r\nimport optuna\r\nimport xgboost as xgb\r\nfrom sklearn.datasets import load_boston\r\n\r\nX, y = load_boston(return_X_y=True)\r\n\r\nseed = 7\r\nn_iter = 3\r\noptimize = 'r2'\r\ntuner_verbose = 0\r\nn_jobs = -1\r\nearly_stopping_max_iters = 10\r\nprune = False\r\nfold = 3\r\n\r\nregressor = xgb.XGBRegressor()\r\n\r\nsampler = optuna.samplers.TPESampler(seed=seed)\r\nstudy =  optuna.create_study(\r\n            direction=\"maximize\", sampler=sampler\r\n        )\r\n\r\nparam_grid = {'eta':optuna.distributions.LogUniformDistribution(high=0.5, low=1e-06),\r\n              'depth':optuna.distributions.IntUniformDistribution(high=11, low=1, step=1),\r\n              'n_estimators':optuna.distributions.IntUniformDistribution(high=300, low=10, step=1),\r\n              'random_strength':optuna.distributions.UniformDistribution(high=0.8, low=0),\r\n              'l2_leaf_reg':optuna.distributions.IntLogUniformDistribution(high=200, low=1, step=1)\r\n             }\r\n\r\n\r\nmodel_grid = optuna.integration.OptunaSearchCV(\r\n    estimator=regressor,\r\n    param_distributions=param_grid,\r\n    cv=fold,\r\n    enable_pruning=prune,\r\n    max_iter=early_stopping_max_iters,\r\n    n_jobs=n_jobs,\r\n    n_trials=n_iter,\r\n    random_state=seed,\r\n    scoring=optimize,\r\n    study=study,\r\n    refit=False,\r\n    verbose=tuner_verbose,\r\n    error_score=\"raise\",\r\n)\r\n\r\nmodel_grid.fit(X, y)\r\n\r\nprint(model_grid.best_params_)\r\n\r\n```\r\n\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\nAfter trial and error i have noticed that if i comment out the n_jobs, study and random_state arguments and use numpy.random.seed(7) i get reproducible results but its desired to use n_jobs=-1 rather than the default value of n_jobs=1\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2540/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2540/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2532", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2532/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2532/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2532/events", "html_url": "https://github.com/optuna/optuna/pull/2532", "id": 842619051, "node_id": "MDExOlB1bGxSZXF1ZXN0NjAyMTUyODk5", "number": 2532, "title": "Fix `visualization.matplotlib.plot_optimization_history` for multi-objective", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "keisuke-umezawa", "id": 1277089, "node_id": "MDQ6VXNlcjEyNzcwODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1277089?v=4", "gravatar_id": "", "url": "https://api.github.com/users/keisuke-umezawa", "html_url": "https://github.com/keisuke-umezawa", "followers_url": "https://api.github.com/users/keisuke-umezawa/followers", "following_url": "https://api.github.com/users/keisuke-umezawa/following{/other_user}", "gists_url": "https://api.github.com/users/keisuke-umezawa/gists{/gist_id}", "starred_url": "https://api.github.com/users/keisuke-umezawa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/keisuke-umezawa/subscriptions", "organizations_url": "https://api.github.com/users/keisuke-umezawa/orgs", "repos_url": "https://api.github.com/users/keisuke-umezawa/repos", "events_url": "https://api.github.com/users/keisuke-umezawa/events{/privacy}", "received_events_url": "https://api.github.com/users/keisuke-umezawa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "keisuke-umezawa", "id": 1277089, "node_id": "MDQ6VXNlcjEyNzcwODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1277089?v=4", "gravatar_id": "", "url": "https://api.github.com/users/keisuke-umezawa", "html_url": "https://github.com/keisuke-umezawa", "followers_url": "https://api.github.com/users/keisuke-umezawa/followers", "following_url": "https://api.github.com/users/keisuke-umezawa/following{/other_user}", "gists_url": "https://api.github.com/users/keisuke-umezawa/gists{/gist_id}", "starred_url": "https://api.github.com/users/keisuke-umezawa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/keisuke-umezawa/subscriptions", "organizations_url": "https://api.github.com/users/keisuke-umezawa/orgs", "repos_url": "https://api.github.com/users/keisuke-umezawa/repos", "events_url": "https://api.github.com/users/keisuke-umezawa/events{/privacy}", "received_events_url": "https://api.github.com/users/keisuke-umezawa/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/33", "html_url": "https://github.com/optuna/optuna/milestone/33", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/33/labels", "id": 6509911, "node_id": "MDk6TWlsZXN0b25lNjUwOTkxMQ==", "number": 33, "title": "v2.7.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 61, "state": "closed", "created_at": "2021-03-05T05:35:07Z", "updated_at": "2021-04-06T00:32:00Z", "due_on": null, "closed_at": "2021-04-06T00:32:00Z"}, "comments": 5, "created_at": "2021-03-27T22:59:08Z", "updated_at": "2021-04-02T02:01:27Z", "closed_at": "2021-04-02T02:01:00Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2532", "html_url": "https://github.com/optuna/optuna/pull/2532", "diff_url": "https://github.com/optuna/optuna/pull/2532.diff", "patch_url": "https://github.com/optuna/optuna/pull/2532.patch", "merged_at": "2021-04-02T02:01:00Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\nSee #2531 \r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\nUnify the logic to Plotly's one.\r\n\r\n## Results \r\n---\r\n\r\n```python\r\nimport optuna\r\n\r\n\r\ndef objective(trial):\r\n    # Binh and Korn function.\r\n    x = trial.suggest_float(\"x\", 0, 5)\r\n    y = trial.suggest_float(\"y\", 0, 3)\r\n\r\n    v0 = 4 * x ** 2 + 4 * y ** 2\r\n    v1 = (x - 5) ** 2 + (y - 5) ** 2\r\n    return v0, v1\r\n\r\n\r\nstudy = optuna.study.create_study(directions=[\"minimize\", \"minimize\"])\r\nstudy.optimize(objective, n_trials=10)\r\n\r\noptuna.visualization.plot_optimization_history(study, target=lambda t: t.values[0])\r\noptuna.visualization.matplotlib.plot_optimization_history(study, target=lambda t: t.values[0])\r\n```\r\n\r\n## Matplotlib\r\n![download (1)](https://user-images.githubusercontent.com/7121753/112737531-8e4dcc00-8f9e-11eb-9cd1-b7c0ce9e0839.png)\r\n\r\n\r\n### Plotly as reference\r\n![newplot (1)](https://user-images.githubusercontent.com/7121753/112737528-8726be00-8f9e-11eb-9b5f-fb534d7bcafb.png)\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2532/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2532/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2531", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2531/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2531/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2531/events", "html_url": "https://github.com/optuna/optuna/issues/2531", "id": 842604156, "node_id": "MDU6SXNzdWU4NDI2MDQxNTY=", "number": 2531, "title": "[BUG] `plot_optimization_history` not working with multi objective even if target is given", "user": {"login": "YannDubs", "id": 24327668, "node_id": "MDQ6VXNlcjI0MzI3NjY4", "avatar_url": "https://avatars.githubusercontent.com/u/24327668?v=4", "gravatar_id": "", "url": "https://api.github.com/users/YannDubs", "html_url": "https://github.com/YannDubs", "followers_url": "https://api.github.com/users/YannDubs/followers", "following_url": "https://api.github.com/users/YannDubs/following{/other_user}", "gists_url": "https://api.github.com/users/YannDubs/gists{/gist_id}", "starred_url": "https://api.github.com/users/YannDubs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/YannDubs/subscriptions", "organizations_url": "https://api.github.com/users/YannDubs/orgs", "repos_url": "https://api.github.com/users/YannDubs/repos", "events_url": "https://api.github.com/users/YannDubs/events{/privacy}", "received_events_url": "https://api.github.com/users/YannDubs/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-03-27T21:19:30Z", "updated_at": "2021-04-02T09:37:44Z", "closed_at": "2021-04-02T09:37:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "`matplotlib.plot_optimization_history` does not work in multi objective setting even if the `target` is given. Despite the doc saying that it would raise an error only if `If target is None and study is being used for multi-objective optimization.`\r\n\r\nThe issue is that the code uses `study.direction` (which does not exist in multi objective) at this line:\r\nhttps://github.com/optuna/optuna/blob/master/optuna/visualization/matplotlib/_optimization_history.py#L102 \r\n\r\nAnd so the error is : \r\n```\r\nRuntimeError: The single direction of a `study` is only supported for single-objective optimization.\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2531/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2531/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2517", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2517/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2517/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2517/events", "html_url": "https://github.com/optuna/optuna/issues/2517", "id": 839628449, "node_id": "MDU6SXNzdWU4Mzk2Mjg0NDk=", "number": 2517, "title": "Adding pytest's `filterwarnings` causes 0% coverage", "user": {"login": "g-votte", "id": 1061922, "node_id": "MDQ6VXNlcjEwNjE5MjI=", "avatar_url": "https://avatars.githubusercontent.com/u/1061922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/g-votte", "html_url": "https://github.com/g-votte", "followers_url": "https://api.github.com/users/g-votte/followers", "following_url": "https://api.github.com/users/g-votte/following{/other_user}", "gists_url": "https://api.github.com/users/g-votte/gists{/gist_id}", "starred_url": "https://api.github.com/users/g-votte/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/g-votte/subscriptions", "organizations_url": "https://api.github.com/users/g-votte/orgs", "repos_url": "https://api.github.com/users/g-votte/repos", "events_url": "https://api.github.com/users/g-votte/events{/privacy}", "received_events_url": "https://api.github.com/users/g-votte/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 2107128673, "node_id": "MDU6TGFiZWwyMTA3MTI4Njcz", "url": "https://api.github.com/repos/optuna/optuna/labels/no-stale", "name": "no-stale", "color": "BBBBBB", "default": false, "description": "Exempt from stale bot"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-03-24T11:30:59Z", "updated_at": "2022-07-04T09:06:56Z", "closed_at": "2022-07-04T09:06:56Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "## Steps to reproduce\r\n\r\n1. Apply the change of https://github.com/optuna/optuna/pull/2405 , which adds `filterwarnings` of pytest.\r\n2. Run pytest with coverage reporting\r\n\r\n## Current behavior\r\n\r\nThe coverage drastically downs and shows [0% in the CI](https://app.codecov.io/gh/optuna/optuna/compare/2405/overview).\r\n\r\n## Expected behavior\r\n\r\nThe coverage does not change.\r\n\r\n## Reproducible examples\r\n\r\nYou can quickly reproduce the drastic decrease by locally running the following command and checking the output report.\r\n\r\n```console\r\npytest --cov=optuna --cov-report=html tests/study_tests/test_study.py\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n- https://github.com/optuna/optuna/pull/2405 was reverted in https://github.com/optuna/optuna/pull/2413 due to the coverage decrease.\r\n- We want to re-apply the `filterwarning` after resolving this issue, which removes a lot of noises in the unit tests' log.\r\n- This issue also blocks https://github.com/optuna/optuna/pull/2416.\r\n- This issue was also investigated in https://github.com/optuna/optuna/pull/2417 . However, adding parentheses did not resolve the problem.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2517/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2517/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2513", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2513/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2513/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2513/events", "html_url": "https://github.com/optuna/optuna/issues/2513", "id": 838654103, "node_id": "MDU6SXNzdWU4Mzg2NTQxMDM=", "number": 2513, "title": "Kubernetes + MLflow example fails due to the MNIST download error ", "user": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-03-23T12:03:53Z", "updated_at": "2021-03-31T05:58:30Z", "closed_at": "2021-03-31T05:58:30Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "If we follow the instructions in `examples/kubernetes/mlflow/README.md` with current master (https://github.com/optuna/optuna/commit/bffdbdcd32cb88e2d886f3860b6bbfd85cb52565), the worker pods fail due to the MNIST download error like https://github.com/optuna/optuna/issues/2469. \r\n\r\n## Expected behavior\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\nThe worker pods succeed if we follow the instructions in `examples/kubernetes/mlflow/README.md`.\r\n\r\n## Environment\r\n\r\n- Optuna version: current master (https://github.com/optuna/optuna/commit/bffdbdcd32cb88e2d886f3860b6bbfd85cb52565)\r\n- OS: macOS Catalina 10.15.7\r\n- docker for mac 20.10.5\r\n- kubernetes: minikube 1.18.1\r\n\r\n## Error messages, stack traces, or logs\r\nIf we follow the instructions in `examples/kubernetes/mlflow/README.md` and check the log message, we get the following errors.\r\n```\r\nmamu@HideakinoMacBook-puro mlflow % kubectl logs worker-kg66q\r\n/usr/local/lib/python3.7/site-packages/optuna/_experimental.py:83: ExperimentalWarning: MLflowCallback is experimental (supported from v1.4.0). The interface can change in the future.\r\n  ExperimentalWarning,\r\nGPU available: False, used: False\r\nTPU available: False, using: 0 TPU cores\r\n/usr/local/lib/python3.7/site-packages/pytorch_lightning/utilities/distributed.py:25: DeprecationWarning: Argument `val_percent_check` is now set by `limit_val_batches` since v0.8.0 and this argument will be removed in v0.10.0\r\n  warnings.warn(*args, **kwargs)\r\n\r\n  | Name  | Type       | Params\r\n-------------------------------------\r\n0 | model | Sequential | 72 K  \r\nDownloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz to /usr/src/MNIST/raw/train-images-idx3-ubyte.gz\r\n0it [00:00, ?it/s][W 2021-03-23 11:49:21,342] Setting status of trial#4 as TrialState.FAIL because of the following error: <HTTPError 522: 'Origin Connection Time-out'>\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.7/site-packages/optuna/study.py\", line 734, in _run_trial\r\n    result = func(trial)\r\n  File \"pytorch_lightning_distributed.py\", line 110, in objective\r\n    trainer.fit(model)\r\n  File \"/usr/local/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py\", line 1044, in fit\r\n    results = self.run_pretrain_routine(model)\r\n  File \"/usr/local/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py\", line 1185, in run_pretrain_routine\r\n    self.reset_val_dataloader(ref_model)\r\n  File \"/usr/local/lib/python3.7/site-packages/pytorch_lightning/trainer/data_loading.py\", line 343, in reset_val_dataloader\r\n    self.num_val_batches, self.val_dataloaders = self._reset_eval_dataloader(model, 'val')\r\n  File \"/usr/local/lib/python3.7/site-packages/pytorch_lightning/trainer/data_loading.py\", line 270, in _reset_eval_dataloader\r\n    dataloaders = self.request_dataloader(getattr(model, f'{mode}_dataloader'))\r\n  File \"/usr/local/lib/python3.7/site-packages/pytorch_lightning/trainer/data_loading.py\", line 364, in request_dataloader\r\n    dataloader = dataloader_fx()\r\n  File \"pytorch_lightning_distributed.py\", line 91, in val_dataloader\r\n    datasets.MNIST(DIR, train=False, download=True, transform=transforms.ToTensor()),\r\n  File \"/usr/local/lib/python3.7/site-packages/torchvision/datasets/mnist.py\", line 70, in __init__\r\n    self.download()\r\n  File \"/usr/local/lib/python3.7/site-packages/torchvision/datasets/mnist.py\", line 137, in download\r\n    download_and_extract_archive(url, download_root=self.raw_folder, filename=filename, md5=md5)\r\n  File \"/usr/local/lib/python3.7/site-packages/torchvision/datasets/utils.py\", line 249, in download_and_extract_archive\r\n    download_url(url, download_root, filename, md5)\r\n  File \"/usr/local/lib/python3.7/site-packages/torchvision/datasets/utils.py\", line 83, in download_url\r\n    raise e\r\n  File \"/usr/local/lib/python3.7/site-packages/torchvision/datasets/utils.py\", line 71, in download_url\r\n    reporthook=gen_bar_updater()\r\n  File \"/usr/local/lib/python3.7/urllib/request.py\", line 247, in urlretrieve\r\n    with contextlib.closing(urlopen(url, data)) as fp:\r\n  File \"/usr/local/lib/python3.7/urllib/request.py\", line 222, in urlopen\r\n    return opener.open(url, data, timeout)\r\n  File \"/usr/local/lib/python3.7/urllib/request.py\", line 531, in open\r\n    response = meth(req, response)\r\n  File \"/usr/local/lib/python3.7/urllib/request.py\", line 641, in http_response\r\n    'http', request, response, code, msg, hdrs)\r\n  File \"/usr/local/lib/python3.7/urllib/request.py\", line 569, in error\r\n    return self._call_chain(*args)\r\n  File \"/usr/local/lib/python3.7/urllib/request.py\", line 503, in _call_chain\r\n    result = func(*args)\r\n  File \"/usr/local/lib/python3.7/urllib/request.py\", line 649, in http_error_default\r\n    raise HTTPError(req.full_url, code, msg, hdrs, fp)\r\nurllib.error.HTTPError: HTTP Error 522: Origin Connection Time-out\r\nTraceback (most recent call last):\r\n  File \"pytorch_lightning_distributed.py\", line 128, in <module>\r\n    callbacks=[MLflowCallback(tracking_uri=\"http://mlflow:5000/\", metric_name=\"val_accuracy\")],\r\n  File \"/usr/local/lib/python3.7/site-packages/optuna/study.py\", line 339, in optimize\r\n    func, n_trials, timeout, catch, callbacks, gc_after_trial, None\r\n  File \"/usr/local/lib/python3.7/site-packages/optuna/study.py\", line 682, in _optimize_sequential\r\n    self._run_trial_and_callbacks(func, catch, callbacks, gc_after_trial)\r\n  File \"/usr/local/lib/python3.7/site-packages/optuna/study.py\", line 713, in _run_trial_and_callbacks\r\n    trial = self._run_trial(func, catch, gc_after_trial)\r\n  File \"/usr/local/lib/python3.7/site-packages/optuna/study.py\", line 734, in _run_trial\r\n    result = func(trial)\r\n  File \"pytorch_lightning_distributed.py\", line 110, in objective\r\n    trainer.fit(model)\r\n  File \"/usr/local/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py\", line 1044, in fit\r\n    results = self.run_pretrain_routine(model)\r\n  File \"/usr/local/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py\", line 1185, in run_pretrain_routine\r\n    self.reset_val_dataloader(ref_model)\r\n  File \"/usr/local/lib/python3.7/site-packages/pytorch_lightning/trainer/data_loading.py\", line 343, in reset_val_dataloader\r\n    self.num_val_batches, self.val_dataloaders = self._reset_eval_dataloader(model, 'val')\r\n  File \"/usr/local/lib/python3.7/site-packages/pytorch_lightning/trainer/data_loading.py\", line 270, in _reset_eval_dataloader\r\n    dataloaders = self.request_dataloader(getattr(model, f'{mode}_dataloader'))\r\n  File \"/usr/local/lib/python3.7/site-packages/pytorch_lightning/trainer/data_loading.py\", line 364, in request_dataloader\r\n    dataloader = dataloader_fx()\r\n  File \"pytorch_lightning_distributed.py\", line 91, in val_dataloader\r\n    datasets.MNIST(DIR, train=False, download=True, transform=transforms.ToTensor()),\r\n  File \"/usr/local/lib/python3.7/site-packages/torchvision/datasets/mnist.py\", line 70, in __init__\r\n    self.download()\r\n  File \"/usr/local/lib/python3.7/site-packages/torchvision/datasets/mnist.py\", line 137, in download\r\n    download_and_extract_archive(url, download_root=self.raw_folder, filename=filename, md5=md5)\r\n  File \"/usr/local/lib/python3.7/site-packages/torchvision/datasets/utils.py\", line 249, in download_and_extract_archive\r\n    download_url(url, download_root, filename, md5)\r\n  File \"/usr/local/lib/python3.7/site-packages/torchvision/datasets/utils.py\", line 83, in download_url\r\n    raise e\r\n  File \"/usr/local/lib/python3.7/site-packages/torchvision/datasets/utils.py\", line 71, in download_url\r\n    reporthook=gen_bar_updater()\r\n  File \"/usr/local/lib/python3.7/urllib/request.py\", line 247, in urlretrieve\r\n    with contextlib.closing(urlopen(url, data)) as fp:\r\n  File \"/usr/local/lib/python3.7/urllib/request.py\", line 222, in urlopen\r\n    return opener.open(url, data, timeout)\r\n  File \"/usr/local/lib/python3.7/urllib/request.py\", line 531, in open\r\n    response = meth(req, response)\r\n  File \"/usr/local/lib/python3.7/urllib/request.py\", line 641, in http_response\r\n    'http', request, response, code, msg, hdrs)\r\n  File \"/usr/local/lib/python3.7/urllib/request.py\", line 569, in error\r\n    return self._call_chain(*args)\r\n  File \"/usr/local/lib/python3.7/urllib/request.py\", line 503, in _call_chain\r\n    result = func(*args)\r\n  File \"/usr/local/lib/python3.7/urllib/request.py\", line 649, in http_error_default\r\n    raise HTTPError(req.full_url, code, msg, hdrs, fp)\r\nurllib.error.HTTPError: HTTP Error 522: Origin Connection Time-out\r\n0it [00:31, ?it/s]\r\n```\r\n\r\n## Steps to reproduce\r\n\r\nFollow the instructions in `examples/kubernetes/mlflow/README.md`.\r\n\r\n## Additional context (optional)\r\n\r\nThis bug was found in the discussion in https://github.com/optuna/optuna/pull/2472. Thanks @0x41head!\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2513/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2513/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2509", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2509/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2509/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2509/events", "html_url": "https://github.com/optuna/optuna/issues/2509", "id": 838281673, "node_id": "MDU6SXNzdWU4MzgyODE2NzM=", "number": 2509, "title": "Optuna study crashes on TensorFlow models with Estimators", "user": {"login": "fonnesbeck", "id": 81476, "node_id": "MDQ6VXNlcjgxNDc2", "avatar_url": "https://avatars.githubusercontent.com/u/81476?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fonnesbeck", "html_url": "https://github.com/fonnesbeck", "followers_url": "https://api.github.com/users/fonnesbeck/followers", "following_url": "https://api.github.com/users/fonnesbeck/following{/other_user}", "gists_url": "https://api.github.com/users/fonnesbeck/gists{/gist_id}", "starred_url": "https://api.github.com/users/fonnesbeck/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fonnesbeck/subscriptions", "organizations_url": "https://api.github.com/users/fonnesbeck/orgs", "repos_url": "https://api.github.com/users/fonnesbeck/repos", "events_url": "https://api.github.com/users/fonnesbeck/events{/privacy}", "received_events_url": "https://api.github.com/users/fonnesbeck/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-03-23T02:07:13Z", "updated_at": "2021-07-23T06:09:58Z", "closed_at": "2021-07-22T23:06:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have a relatively large TensorFlow model (>1M rows) that implements the DNNClassifier estimator. It fits without issue when run outside of Optuna, but once I try to optimize it, the study will crash either an AWS instance or a Google Colab Pro instance (high memory, GPU) before completion. \r\n\r\nA couple of things I notice: if I set a model_dir and try to monitor runs using TensorBoard, the study crashes before the first trial is complete, every time. If the model_dir is not set, it will typically complete 4-5 trials. If I use a SQLite backend instead of in-memory, it extends the life of the study even further (sometimes as many as 10 trials), but it will also eventually crash.\r\n\r\nThe data I am using is large and proprietary, so I can't give a good reproducible example, but here is what I am trying to fit:\r\n\r\n```python\r\n\r\n    optimizers = {\r\n        \"RMSprop\": lambda lr: tf.keras.optimizers.RMSprop(learning_rate=lr, momentum=0.9), \r\n        \"Adam\": lambda lr: tf.keras.optimizers.Adam(learning_rate=lr)\r\n    }\r\n\r\n    def create_model(trial):\r\n\r\n        num_units = trial.suggest_categorical(\"num_units\", [64, 128, 512, 1024])\r\n        num_layers = trial.suggest_int(\"num_layers\", 2, 4)\r\n        learning_rate = trial.suggest_categorical(\"learning_rate\", [1e-2, 1e-3, 1e-4])\r\n        dropout = trial.suggest_categorical(\"dropout\", [0, 0.3, 0.5])\r\n        optimizer = trial.suggest_categorical(\"optimizer\", [\"RMSprop\", \"Adam\"])\r\n\r\n        model = tf.estimator.DNNClassifier(\r\n            feature_columns=get_feature_columns(),\r\n            # model_dir=\"./logs/\" + datetime.datetime.now().strftime(\"%Y%m%d-%H%M%S\"),\r\n            hidden_units=[num_units]*num_layers,\r\n            activation_fn=tf.nn.leaky_relu,\r\n            n_classes=n_classes,\r\n            dropout=dropout,\r\n            optimizer=optimizers[optimizer](learning_rate),\r\n        )\r\n\r\n        return model\r\n\r\n    def objective(trial):\r\n\r\n        batch_size = trial.suggest_categorical('batch_size', [32, 128, 1024])\r\n\r\n        estimator = create_model(trial)\r\n\r\n        pruning_hook = optuna.integration.TensorFlowPruningHook(\r\n            trial=trial,\r\n            estimator=estimator,\r\n            metric=\"accuracy\",\r\n            run_every_steps=100,\r\n        )\r\n\r\n        train_spec = tf.estimator.TrainSpec(\r\n            input_fn=lambda: input_fn(batch_size=batch_size), \r\n            hooks=[pruning_hook],\r\n            max_steps=5000\r\n        )\r\n        eval_spec = tf.estimator.EvalSpec(input_fn=lambda: input_fn(training=False))\r\n\r\n        eval_result, _ = tf.estimator.train_and_evaluate(estimator, train_spec, eval_spec)\r\n\r\n        return eval_result['loss']\r\n\r\n    logging.getLogger(\"tensorflow\").setLevel(logging.ERROR)\r\n    optuna.logging.get_logger(\"optuna\").addHandler(logging.StreamHandler(sys.stdout))\r\n\r\n    study_name = \"matchup-model\" \r\n    storage_name = f\"sqlite:///{study_name}.db\"\r\n    study = optuna.create_study(study_name=study_name, storage=storage_name, load_if_exists=True)\r\n    # study = optuna. create_study()\r\n    study.optimize(objective, n_trials=10, n_jobs=2)\r\n\r\n    best_trial = study.best_trial\r\n```\r\n\r\nhere is what the terminal looks like as the study dies:\r\n\r\n```\r\n2021-03-23 02:01:14.989105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10623 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:00:1e.0, compute capability: 3.7)\r\n2021-03-23 02:02:12.547231: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set\r\n2021-03-23 02:02:12.547553: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2021-03-23 02:02:12.548037: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: \r\npciBusID: 0000:00:1e.0 name: Tesla K80 computeCapability: 3.7\r\ncoreClock: 0.8235GHz coreCount: 13 deviceMemorySize: 11.17GiB deviceMemoryBandwidth: 223.96GiB/s\r\n2021-03-23 02:02:12.548120: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0\r\n2021-03-23 02:02:12.548183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11\r\n2021-03-23 02:02:12.548232: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11\r\n2021-03-23 02:02:12.548281: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10\r\n2021-03-23 02:02:12.548333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10\r\n2021-03-23 02:02:12.548389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10\r\n2021-03-23 02:02:12.548442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11\r\n2021-03-23 02:02:12.548491: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8\r\n2021-03-23 02:02:12.548601: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2021-03-23 02:02:12.549029: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2021-03-23 02:02:12.549422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0\r\n2021-03-23 02:02:12.549468: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2021-03-23 02:02:12.549488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 \r\n2021-03-23 02:02:12.549508: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N \r\n2021-03-23 02:02:12.549671: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2021-03-23 02:02:12.550100: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2021-03-23 02:02:12.550457: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10623 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:00:1e.0, compute capability: 3.7)\r\nKilled\r\n```\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.3.0\r\n- Python version: 3.8.3 (AWS) and 3.7 (Colab)\r\n- OS: Ubuntu or Colab\r\n- (Optional) Other libraries and their versions: TF 2.4.1\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2509/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2509/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2502", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2502/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2502/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2502/events", "html_url": "https://github.com/optuna/optuna/issues/2502", "id": 835120706, "node_id": "MDU6SXNzdWU4MzUxMjA3MDY=", "number": 2502, "title": "Time zone problems", "user": {"login": "Turakar", "id": 3958680, "node_id": "MDQ6VXNlcjM5NTg2ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/3958680?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Turakar", "html_url": "https://github.com/Turakar", "followers_url": "https://api.github.com/users/Turakar/followers", "following_url": "https://api.github.com/users/Turakar/following{/other_user}", "gists_url": "https://api.github.com/users/Turakar/gists{/gist_id}", "starred_url": "https://api.github.com/users/Turakar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Turakar/subscriptions", "organizations_url": "https://api.github.com/users/Turakar/orgs", "repos_url": "https://api.github.com/users/Turakar/repos", "events_url": "https://api.github.com/users/Turakar/events{/privacy}", "received_events_url": "https://api.github.com/users/Turakar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-03-18T18:21:33Z", "updated_at": "2021-07-11T23:06:20Z", "closed_at": "2021-07-11T23:06:20Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I use Optuna with a RDB backend and from two different workers, one on my home computer and one remote. The two computers use different time zones (GMT+1 and UTC respectively). The datetimes in the database seem to wrong, i.e. the stored datetime is the local time of the machine.\r\n\r\n## Expected behavior\r\nThe shown datetimes either store time zone information with them or all use one time zone (e.g. UTC).\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.5.0\r\n- Python version: 3.9\r\n- OS: Linux (Fedora 33 and Docker `python:3.9` container)\r\n- (Optional) Other libraries and their versions: PostgreSQL 12\r\n\r\n## Steps to reproduce\r\n\r\n1. Create a study with a RDB backend.\r\n2. Set up two workers with different time zones.\r\n3. Observe the datetime values in the database.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2502/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2502/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2501", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2501/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2501/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2501/events", "html_url": "https://github.com/optuna/optuna/pull/2501", "id": 835112562, "node_id": "MDExOlB1bGxSZXF1ZXN0NTk1ODE3NTc3", "number": 2501, "title": "Fix Warm Starting CMA-ES with a maximize direction", "user": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/33", "html_url": "https://github.com/optuna/optuna/milestone/33", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/33/labels", "id": 6509911, "node_id": "MDk6TWlsZXN0b25lNjUwOTkxMQ==", "number": 33, "title": "v2.7.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 61, "state": "closed", "created_at": "2021-03-05T05:35:07Z", "updated_at": "2021-04-06T00:32:00Z", "due_on": null, "closed_at": "2021-04-06T00:32:00Z"}, "comments": 2, "created_at": "2021-03-18T18:10:26Z", "updated_at": "2021-03-23T08:19:08Z", "closed_at": "2021-03-23T07:40:17Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2501", "html_url": "https://github.com/optuna/optuna/pull/2501", "diff_url": "https://github.com/optuna/optuna/pull/2501.diff", "patch_url": "https://github.com/optuna/optuna/pull/2501.patch", "merged_at": "2021-03-23T07:40:17Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nFix  a bug of Warm Starting CMA-ES with a maximize direction.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\nMultiply `-1` if the direction is maximize.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2501/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2501/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2500", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2500/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2500/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2500/events", "html_url": "https://github.com/optuna/optuna/issues/2500", "id": 834504050, "node_id": "MDU6SXNzdWU4MzQ1MDQwNTA=", "number": 2500, "title": "optuna create-study, Could not load the Qt platform plugin \"xcb\" in \"\" even though it was found", "user": {"login": "max-yue", "id": 13486398, "node_id": "MDQ6VXNlcjEzNDg2Mzk4", "avatar_url": "https://avatars.githubusercontent.com/u/13486398?v=4", "gravatar_id": "", "url": "https://api.github.com/users/max-yue", "html_url": "https://github.com/max-yue", "followers_url": "https://api.github.com/users/max-yue/followers", "following_url": "https://api.github.com/users/max-yue/following{/other_user}", "gists_url": "https://api.github.com/users/max-yue/gists{/gist_id}", "starred_url": "https://api.github.com/users/max-yue/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/max-yue/subscriptions", "organizations_url": "https://api.github.com/users/max-yue/orgs", "repos_url": "https://api.github.com/users/max-yue/repos", "events_url": "https://api.github.com/users/max-yue/events{/privacy}", "received_events_url": "https://api.github.com/users/max-yue/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-03-18T08:00:05Z", "updated_at": "2021-04-11T11:52:38Z", "closed_at": "2021-04-11T11:52:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "# optuna create-study --study-name \"distributed-example\" --storage \"mysql://root@localhost/example\"\r\n\r\nQFactoryLoader::QFactoryLoader() checking directory path \"/share/apps/anaconda3/envs/qa_env/lib/python3.6/site-packages/PyQt5/Qt/plugins/platforms\" ...\r\nQFactoryLoader::QFactoryLoader() looking at \"/share/apps/anaconda3/envs/qa_env/lib/python3.6/site-packages/PyQt5/Qt/plugins/platforms/libqeglfs.so\"\r\nFound metadata in lib /share/apps/anaconda3/envs/qa_env/lib/python3.6/site-packages/PyQt5/Qt/plugins/platforms/libqeglfs.so, metadata=\r\n{\r\n    \"IID\": \"org.qt-project.Qt.QPA.QPlatformIntegrationFactoryInterface.5.3\",\r\n    \"MetaData\": {\r\n        \"Keys\": [\r\n            \"eglfs\"\r\n        ]\r\n    },\r\n    \"archreq\": 0,\r\n    \"className\": \"QEglFSIntegrationPlugin\",\r\n    \"debug\": false,\r\n    \"version\": 331520\r\n}\r\n\r\n\r\nGot keys from plugin meta data (\"eglfs\")\r\nQFactoryLoader::QFactoryLoader() looking at \"/share/apps/anaconda3/envs/qa_env/lib/python3.6/site-packages/PyQt5/Qt/plugins/platforms/libqlinuxfb.so\"\r\nFound metadata in lib /share/apps/anaconda3/envs/qa_env/lib/python3.6/site-packages/PyQt5/Qt/plugins/platforms/libqlinuxfb.so, metadata=\r\n{\r\n    \"IID\": \"org.qt-project.Qt.QPA.QPlatformIntegrationFactoryInterface.5.3\",\r\n    \"MetaData\": {\r\n        \"Keys\": [\r\n            \"linuxfb\"\r\n        ]\r\n    },\r\n    \"archreq\": 0,\r\n    \"className\": \"QLinuxFbIntegrationPlugin\",\r\n    \"debug\": false,\r\n    \"version\": 331520\r\n}\r\n\r\n\r\nGot keys from plugin meta data (\"linuxfb\")\r\nQFactoryLoader::QFactoryLoader() looking at \"/share/apps/anaconda3/envs/qa_env/lib/python3.6/site-packages/PyQt5/Qt/plugins/platforms/libqminimal.so\"\r\nFound metadata in lib /share/apps/anaconda3/envs/qa_env/lib/python3.6/site-packages/PyQt5/Qt/plugins/platforms/libqminimal.so, metadata=\r\n{\r\n    \"IID\": \"org.qt-project.Qt.QPA.QPlatformIntegrationFactoryInterface.5.3\",\r\n    \"MetaData\": {\r\n        \"Keys\": [\r\n            \"minimal\"\r\n        ]\r\n    },\r\n    \"archreq\": 0,\r\n    \"className\": \"QMinimalIntegrationPlugin\",\r\n    \"debug\": false,\r\n    \"version\": 331520\r\n}\r\n\r\n\r\nGot keys from plugin meta data (\"minimal\")\r\nQFactoryLoader::QFactoryLoader() looking at \"/share/apps/anaconda3/envs/qa_env/lib/python3.6/site-packages/PyQt5/Qt/plugins/platforms/libqminimalegl.so\"\r\nFound metadata in lib /share/apps/anaconda3/envs/qa_env/lib/python3.6/site-packages/PyQt5/Qt/plugins/platforms/libqminimalegl.so, metadata=\r\n{\r\n    \"IID\": \"org.qt-project.Qt.QPA.QPlatformIntegrationFactoryInterface.5.3\",\r\n    \"MetaData\": {\r\n        \"Keys\": [\r\n            \"minimalegl\"\r\n        ]\r\n    },\r\n    \"archreq\": 0,\r\n    \"className\": \"QMinimalEglIntegrationPlugin\",\r\n    \"debug\": false,\r\n    \"version\": 331520\r\n}\r\n\r\n\r\nGot keys from plugin meta data (\"minimalegl\")\r\nQFactoryLoader::QFactoryLoader() looking at \"/share/apps/anaconda3/envs/qa_env/lib/python3.6/site-packages/PyQt5/Qt/plugins/platforms/libqoffscreen.so\"\r\nFound metadata in lib /share/apps/anaconda3/envs/qa_env/lib/python3.6/site-packages/PyQt5/Qt/plugins/platforms/libqoffscreen.so, metadata=\r\n{\r\n    \"IID\": \"org.qt-project.Qt.QPA.QPlatformIntegrationFactoryInterface.5.3\",\r\n    \"MetaData\": {\r\n        \"Keys\": [\r\n            \"offscreen\"\r\n        ]\r\n    },\r\n    \"archreq\": 0,\r\n    \"className\": \"QOffscreenIntegrationPlugin\",\r\n    \"debug\": false,\r\n    \"version\": 331520\r\n}\r\n\r\n\r\nGot keys from plugin meta data (\"offscreen\")\r\nQFactoryLoader::QFactoryLoader() looking at \"/share/apps/anaconda3/envs/qa_env/lib/python3.6/site-packages/PyQt5/Qt/plugins/platforms/libqvnc.so\"\r\nFound metadata in lib /share/apps/anaconda3/envs/qa_env/lib/python3.6/site-packages/PyQt5/Qt/plugins/platforms/libqvnc.so, metadata=\r\n{\r\n    \"IID\": \"org.qt-project.Qt.QPA.QPlatformIntegrationFactoryInterface.5.3\",\r\n    \"MetaData\": {\r\n        \"Keys\": [\r\n            \"vnc\"\r\n        ]\r\n    },\r\n    \"archreq\": 0,\r\n    \"className\": \"QVncIntegrationPlugin\",\r\n    \"debug\": false,\r\n    \"version\": 331520\r\n}\r\n\r\n\r\nGot keys from plugin meta data (\"vnc\")\r\nQFactoryLoader::QFactoryLoader() looking at \"/share/apps/anaconda3/envs/qa_env/lib/python3.6/site-packages/PyQt5/Qt/plugins/platforms/libqwayland-egl.so\"\r\nFound metadata in lib /share/apps/anaconda3/envs/qa_env/lib/python3.6/site-packages/PyQt5/Qt/plugins/platforms/libqwayland-egl.so, metadata=\r\n{\r\n    \"IID\": \"org.qt-project.Qt.QPA.QPlatformIntegrationFactoryInterface.5.3\",\r\n    \"MetaData\": {\r\n        \"Keys\": [\r\n            \"wayland-egl\"\r\n        ]\r\n    },\r\n    \"archreq\": 0,\r\n    \"className\": \"QWaylandEglPlatformIntegrationPlugin\",\r\n    \"debug\": false,\r\n    \"version\": 331520\r\n}\r\n\r\n\r\nGot keys from plugin meta data (\"wayland-egl\")\r\nQFactoryLoader::QFactoryLoader() looking at \"/share/apps/anaconda3/envs/qa_env/lib/python3.6/site-packages/PyQt5/Qt/plugins/platforms/libqwayland-generic.so\"\r\nFound metadata in lib /share/apps/anaconda3/envs/qa_env/lib/python3.6/site-packages/PyQt5/Qt/plugins/platforms/libqwayland-generic.so, metadata=\r\n{\r\n    \"IID\": \"org.qt-project.Qt.QPA.QPlatformIntegrationFactoryInterface.5.3\",\r\n    \"MetaData\": {\r\n        \"Keys\": [\r\n            \"wayland\"\r\n        ]\r\n    },\r\n    \"archreq\": 0,\r\n    \"className\": \"QWaylandIntegrationPlugin\",\r\n    \"debug\": false,\r\n    \"version\": 331520\r\n}\r\n\r\n\r\nGot keys from plugin meta data (\"wayland\")\r\nQFactoryLoader::QFactoryLoader() looking at \"/share/apps/anaconda3/envs/qa_env/lib/python3.6/site-packages/PyQt5/Qt/plugins/platforms/libqwayland-xcomposite-egl.so\"\r\nFound metadata in lib /share/apps/anaconda3/envs/qa_env/lib/python3.6/site-packages/PyQt5/Qt/plugins/platforms/libqwayland-xcomposite-egl.so, metadata=\r\n{\r\n    \"IID\": \"org.qt-project.Qt.QPA.QPlatformIntegrationFactoryInterface.5.3\",\r\n    \"MetaData\": {\r\n        \"Keys\": [\r\n            \"wayland-xcomposite-egl\"\r\n        ]\r\n    },\r\n    \"archreq\": 0,\r\n    \"className\": \"QWaylandXCompositeEglPlatformIntegrationPlugin\",\r\n    \"debug\": false,\r\n    \"version\": 331520\r\n}\r\n\r\n\r\nGot keys from plugin meta data (\"wayland-xcomposite-egl\")\r\nQFactoryLoader::QFactoryLoader() looking at \"/share/apps/anaconda3/envs/qa_env/lib/python3.6/site-packages/PyQt5/Qt/plugins/platforms/libqwayland-xcomposite-glx.so\"\r\nFound metadata in lib /share/apps/anaconda3/envs/qa_env/lib/python3.6/site-packages/PyQt5/Qt/plugins/platforms/libqwayland-xcomposite-glx.so, metadata=\r\n{\r\n    \"IID\": \"org.qt-project.Qt.QPA.QPlatformIntegrationFactoryInterface.5.3\",\r\n    \"MetaData\": {\r\n        \"Keys\": [\r\n            \"wayland-xcomposite-glx\"\r\n        ]\r\n    },\r\n    \"archreq\": 0,\r\n    \"className\": \"QWaylandXCompositeGlxPlatformIntegrationPlugin\",\r\n    \"debug\": false,\r\n    \"version\": 331520\r\n}\r\n\r\n\r\nGot keys from plugin meta data (\"wayland-xcomposite-glx\")\r\nQFactoryLoader::QFactoryLoader() looking at \"/share/apps/anaconda3/envs/qa_env/lib/python3.6/site-packages/PyQt5/Qt/plugins/platforms/libqwebgl.so\"\r\nFound metadata in lib /share/apps/anaconda3/envs/qa_env/lib/python3.6/site-packages/PyQt5/Qt/plugins/platforms/libqwebgl.so, metadata=\r\n{\r\n    \"IID\": \"org.qt-project.Qt.QPA.QPlatformIntegrationFactoryInterface.5.3\",\r\n    \"MetaData\": {\r\n        \"Keys\": [\r\n            \"webgl\"\r\n        ]\r\n    },\r\n    \"archreq\": 0,\r\n    \"className\": \"QWebGLIntegrationPlugin\",\r\n    \"debug\": false,\r\n    \"version\": 331520\r\n}\r\n\r\n\r\nGot keys from plugin meta data (\"webgl\")\r\nQFactoryLoader::QFactoryLoader() looking at \"/share/apps/anaconda3/envs/qa_env/lib/python3.6/site-packages/PyQt5/Qt/plugins/platforms/libqxcb.so\"\r\nFound metadata in lib /share/apps/anaconda3/envs/qa_env/lib/python3.6/site-packages/PyQt5/Qt/plugins/platforms/libqxcb.so, metadata=\r\n{\r\n    \"IID\": \"org.qt-project.Qt.QPA.QPlatformIntegrationFactoryInterface.5.3\",\r\n    \"MetaData\": {\r\n        \"Keys\": [\r\n            \"xcb\"\r\n        ]\r\n    },\r\n    \"archreq\": 0,\r\n    \"className\": \"QXcbIntegrationPlugin\",\r\n    \"debug\": false,\r\n    \"version\": 331520\r\n}\r\n\r\n\r\nGot keys from plugin meta data (\"xcb\")\r\nQFactoryLoader::QFactoryLoader() checking directory path \"/share/apps/anaconda3/envs/qa_env/bin/platforms\" ...\r\nloaded library \"/share/apps/anaconda3/envs/qa_env/lib/python3.6/site-packages/PyQt5/Qt/plugins/platforms/libqxcb.so\"\r\nqt.qpa.xcb: could not connect to display localhost:0.0\r\nqt.qpa.plugin: Could not load the Qt platform plugin \"xcb\" in \"\" even though it was found.\r\nThis application failed to start because no Qt platform plugin could be initialized. Reinstalling the application may fix this problem.\r\n\r\nAvailable platform plugins are: eglfs, linuxfb, minimal, minimalegl, offscreen, vnc, wayland-egl, wayland, wayland-xcomposite-egl, wayland-xcomposite-glx, webgl, xcb.\r\n\r\nAborted\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2500/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2500/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2487", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2487/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2487/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2487/events", "html_url": "https://github.com/optuna/optuna/pull/2487", "id": 832403152, "node_id": "MDExOlB1bGxSZXF1ZXN0NTkzNTY1NDM1", "number": 2487, "title": "Use 2.0 style delete API of SQLAlchemy", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/33", "html_url": "https://github.com/optuna/optuna/milestone/33", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/33/labels", "id": 6509911, "node_id": "MDk6TWlsZXN0b25lNjUwOTkxMQ==", "number": 33, "title": "v2.7.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 61, "state": "closed", "created_at": "2021-03-05T05:35:07Z", "updated_at": "2021-04-06T00:32:00Z", "due_on": null, "closed_at": "2021-04-06T00:32:00Z"}, "comments": 2, "created_at": "2021-03-16T04:40:34Z", "updated_at": "2021-03-16T07:45:45Z", "closed_at": "2021-03-16T06:45:49Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2487", "html_url": "https://github.com/optuna/optuna/pull/2487", "diff_url": "https://github.com/optuna/optuna/pull/2487.diff", "patch_url": "https://github.com/optuna/optuna/pull/2487.patch", "merged_at": "2021-03-16T06:45:49Z"}, "body": "## Motivation\r\n\r\nCI of schema upgrade failed ([log](https://github.com/optuna/optuna/runs/2117130971?check_suite_focus=true)) after the release of sqlalchemy==1.4.0.\r\nIt includes the migration from sqlalchemy v1.x to v2.0, and it seems to have some breaking changes.\r\nc.f., https://docs.sqlalchemy.org/en/14/glossary.html#term-1.x-style\r\n\r\n## Description of the changes\r\n\r\nCurrently, the schema migration code uses v1.x style of delete API. This PR replace it with v2.0 style API.\r\n\r\nc.f., \r\nhttps://docs.sqlalchemy.org/en/14/orm/session_basics.html#update-and-delete-with-arbitrary-where-clause\r\n\r\n### Note\r\n\r\n#### Do we need to change the requirements of `sqlalchmy`?\r\n\r\nNo. It worked with `sqlalchemy==1.1.0`.\r\n\r\nPlease note that we need to re-install `alembic` after we upgrade/downgrade sqlalchemy. Otherwise, the following error will occur.\r\n~Yes. This feature requires `sqlalchem>=1.3.0`, but the current requirement is `sqlalchemy>=1.1.0`.~\r\n\r\n```console\r\nvenv/lib/python3.8/site-packages/alembic/ddl/mssql.py:8: in <module>\r\n    from .base import AddColumn\r\nvenv/lib/python3.8/site-packages/alembic/ddl/base.py:11: in <module>\r\n    from ..util.sqla_compat import _columns_for_constraint  # noqa\r\nvenv/lib/python3.8/site-packages/alembic/util/__init__.py:32: in <module>\r\n    raise CommandError(\"SQLAlchemy 1.3.0 or greater is required.\")\r\nE   alembic.util.exc.CommandError: SQLAlchemy 1.3.0 or greater is required.\r\n```\r\n\r\n#### Upgrade tests\r\n\r\n<details>\r\n<summary>Python script: `sample.py`</summary>\r\n\r\n```python\r\nimport sys\r\nimport optuna\r\n\r\n\r\ndef objective(trial):\r\n    trial.set_user_attr(\"a\", \"a\")\r\n    trial.set_system_attr(\"b\", \"b\")\r\n    trial.suggest_categorical(\"x\", [0])\r\n    return 1\r\n\r\n\r\nstudy = optuna.create_study(storage=sys.argv[1])\r\nstudy.set_user_attr(\"c\", \"c\")\r\nstudy.set_system_attr(\"d\", \"d\")\r\nstudy.optimize(objective, n_trials=1)\r\n```\r\n\r\n</details>\r\n\r\nSQLite\r\n\r\n```console\r\n$ pip install optuna==1.2.0\r\n$ python sample.py sqlite:///tmp.db\r\n$ pip install -U git+https://github.com/toshihikoyanase/optuna.git@fix-delete-with-sqlalchemy-140\r\n$ optuna storage upgrade --storage sqlite:///tmp.db\r\n$ python sample.py sqlite:///tmp.db\r\n```\r\n\r\nMySQL\r\n\r\n```console\r\n$ MYSQL_HOST=127.0.0.1\r\n$ docker run --name mysql -e MYSQL_ROOT_PASSWORD=test -p 3306:3306 -p 33060:33060 -d mysql:8\r\n$ docker run --network host -it --rm mysql:8  mysql -h ${MYSQL_HOST} -uroot -ptest -e \"create database test_optuna;\"\r\n$ pip install optuna==1.2.0 PyMySQL\r\n$ python sample.py  mysql+pymysql://root:test@${MYSQL_HOST}:3306/test_optuna\r\n$ pip install -U git+https://github.com/toshihikoyanase/optuna.git@fix-delete-with-sqlalchemy-140\r\n$ optuna storage upgrade --storage mysql+pymysql://root:test@${MYSQL_HOST}:3306/test_optuna\r\n$ python sample.py  mysql+pymysql://root:test@${MYSQL_HOST}:3306/test_optuna\r\n```\r\n\r\nPostgreSQL\r\n\r\n```console\r\n$ PG_HOST=127.0.0.1\r\n$ docker run -it --rm --name postgres -e POSTGRES_PASSWORD=test -p 15432:5432 -d postgres\r\n$ pip install optuna==1.2.0 psycopg2-binary\r\n$ python sample.py postgresql+psycopg2://postgres:test@${PG_HOST}:15432/postgres\r\n$ pip install -U git+https://github.com/toshihikoyanase/optuna.git@fix-delete-with-sqlalchemy-140\r\n$ optuna storage upgrade --storage postgresql+psycopg2://postgres:test@${PG_HOST}:15432/postgres\r\n$ python sample.py  postgresql+psycopg2://postgres:test@${PG_HOST}:15432/postgres\r\n```\r\n\r\n\r\n\r\n## TODO\r\n\r\n- [x] Test with older versions of sqlalchemy\r\n- [x] Upgrade test with sqlite, mysql and postgresql", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2487/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2487/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2479", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2479/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2479/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2479/events", "html_url": "https://github.com/optuna/optuna/issues/2479", "id": 831074868, "node_id": "MDU6SXNzdWU4MzEwNzQ4Njg=", "number": 2479, "title": "Optuna's Catalyst integration is not compatible with Catalyst 21.3", "user": {"login": "crcrpar", "id": 16191443, "node_id": "MDQ6VXNlcjE2MTkxNDQz", "avatar_url": "https://avatars.githubusercontent.com/u/16191443?v=4", "gravatar_id": "", "url": "https://api.github.com/users/crcrpar", "html_url": "https://github.com/crcrpar", "followers_url": "https://api.github.com/users/crcrpar/followers", "following_url": "https://api.github.com/users/crcrpar/following{/other_user}", "gists_url": "https://api.github.com/users/crcrpar/gists{/gist_id}", "starred_url": "https://api.github.com/users/crcrpar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/crcrpar/subscriptions", "organizations_url": "https://api.github.com/users/crcrpar/orgs", "repos_url": "https://api.github.com/users/crcrpar/repos", "events_url": "https://api.github.com/users/crcrpar/events{/privacy}", "received_events_url": "https://api.github.com/users/crcrpar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-03-14T05:58:48Z", "updated_at": "2021-03-31T05:54:12Z", "closed_at": "2021-03-31T05:54:12Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I'm not sure whether it's better or not to continue the support of Catalyst as Catalyst team also provides a callback for Optuna: https://catalyst-team.github.io/catalyst/api/callbacks.html?highlight=optuna#catalyst.callbacks.optuna.OptunaPruningCallback.\r\n\r\n```console\r\n________________________ test_catalyst_pruning_callback ________________________\r\n\r\n    def test_catalyst_pruning_callback() -> None:\r\n        data = torch.zeros(3, 4, dtype=torch.float32)\r\n        target = torch.zeros(3, dtype=torch.float32)\r\n        dataset = torch.utils.data.TensorDataset(data, target)\r\n    \r\n        loaders = {\r\n            \"train\": torch.utils.data.DataLoader(dataset, batch_size=1),\r\n            \"valid\": torch.utils.data.DataLoader(dataset, batch_size=1),\r\n        }\r\n    \r\n        def objective(trial: optuna.trial.Trial) -> float:\r\n            model = torch.nn.Linear(4, 1)\r\n            criterion = torch.nn.MSELoss()\r\n            optimizer = torch.optim.Adam(model.parameters())\r\n    \r\n            dirpath = tempfile.mkdtemp()\r\n    \r\n            runner = catalyst.dl.SupervisedRunner()\r\n            runner.train(\r\n                model=model,\r\n                criterion=criterion,\r\n                optimizer=optimizer,\r\n                loaders=loaders,\r\n                logdir=dirpath,\r\n                num_epochs=2,\r\n                verbose=True,\r\n                callbacks=[CatalystPruningCallback(trial, metric=\"loss\")],\r\n            )\r\n    \r\n            shutil.rmtree(dirpath)\r\n    \r\n            return 1.0\r\n    \r\n        study = optuna.create_study(pruner=DeterministicPruner(True))\r\n>       study.optimize(objective, n_trials=1)\r\n\r\ntests/integration_tests/test_catalyst.py:52: \r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\noptuna/study.py:394: in optimize\r\n    show_progress_bar=show_progress_bar,\r\noptuna/_optimize.py:76: in _optimize\r\n    progress_bar=progress_bar,\r\noptuna/_optimize.py:163: in _optimize_sequential\r\n    trial = _run_trial(study, func, catch)\r\noptuna/_optimize.py:268: in _run_trial\r\n    raise func_err\r\noptuna/_optimize.py:217: in _run_trial\r\n    value_or_values = func(trial)\r\ntests/integration_tests/test_catalyst.py:44: in objective\r\n    callbacks=[CatalystPruningCallback(trial, metric=\"loss\")],\r\n/opt/hostedtoolcache/Python/3.6.13/x64/lib/python3.6/site-packages/catalyst/runners/runner.py:320: in train\r\n    self.run()\r\n/opt/hostedtoolcache/Python/3.6.13/x64/lib/python3.6/site-packages/catalyst/core/runner.py:678: in run\r\n    self._run_event(\"on_exception\")\r\n/opt/hostedtoolcache/Python/3.6.13/x64/lib/python3.6/site-packages/catalyst/core/runner.py:601: in _run_event\r\n    getattr(self, event)(self)\r\n/opt/hostedtoolcache/Python/3.6.13/x64/lib/python3.6/site-packages/catalyst/core/runner.py:593: in on_exception\r\n    raise self.exception\r\n/opt/hostedtoolcache/Python/3.6.13/x64/lib/python3.6/site-packages/catalyst/core/runner.py:675: in run\r\n    self._run_experiment()\r\n/opt/hostedtoolcache/Python/3.6.13/x64/lib/python3.6/site-packages/catalyst/core/runner.py:665: in _run_experiment\r\n    self._run_stage()\r\n/opt/hostedtoolcache/Python/3.6.13/x64/lib/python3.6/site-packages/catalyst/core/runner.py:648: in _run_stage\r\n    self._run_epoch()\r\n/opt/hostedtoolcache/Python/3.6.13/x64/lib/python3.6/site-packages/catalyst/core/runner.py:638: in _run_epoch\r\n    self._run_event(\"on_epoch_end\")\r\n/opt/hostedtoolcache/Python/3.6.13/x64/lib/python3.6/site-packages/catalyst/core/runner.py:599: in _run_event\r\n    getattr(callback, event)(self)\r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n\r\nself = <optuna.integration.catalyst.CatalystPruningCallback object at 0x7f558f590438>\r\nstate = <catalyst.runners.runner.SupervisedRunner object at 0x7f558f5907b8>\r\n\r\n    def on_epoch_end(self, state: Any) -> None:\r\n    \r\n>       current_score = state.valid_metrics[self.metric]\r\nE       AttributeError: 'SupervisedRunner' object has no attribute 'valid_metrics'\r\n```\r\n\r\n\r\nSee https://github.com/optuna/optuna/runs/2105121400#step:7:127 for the details.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2479/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2479/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2467", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2467/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2467/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2467/events", "html_url": "https://github.com/optuna/optuna/issues/2467", "id": 829167289, "node_id": "MDU6SXNzdWU4MjkxNjcyODk=", "number": 2467, "title": "trial.suggest_int is not sticking to step size", "user": {"login": "Username159", "id": 80465506, "node_id": "MDQ6VXNlcjgwNDY1NTA2", "avatar_url": "https://avatars.githubusercontent.com/u/80465506?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Username159", "html_url": "https://github.com/Username159", "followers_url": "https://api.github.com/users/Username159/followers", "following_url": "https://api.github.com/users/Username159/following{/other_user}", "gists_url": "https://api.github.com/users/Username159/gists{/gist_id}", "starred_url": "https://api.github.com/users/Username159/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Username159/subscriptions", "organizations_url": "https://api.github.com/users/Username159/orgs", "repos_url": "https://api.github.com/users/Username159/repos", "events_url": "https://api.github.com/users/Username159/events{/privacy}", "received_events_url": "https://api.github.com/users/Username159/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-03-11T13:46:14Z", "updated_at": "2021-05-25T18:50:59Z", "closed_at": "2021-05-25T18:50:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n## Expected behavior\r\nI am using Optuna to optimize the hyperparameters for my CNNLSTM neural net. \r\nI am using Pytorch.\r\nI am using suggest_int to suggest a number for the kernels of my two Conv2-layers and the max pooling layer.\r\n\r\n```\r\nkernel1 = trial.suggest_int('kernel1',1,7, step=2)\r\nkernel2 = trial.suggest_int('kernel2',1,7, step=2)\r\nkernel_pool = trial.suggest_int('kernel_pool',3,5, step=2)\r\n```\r\n\r\nI am using a TPESampler\r\n`sampler = optuna.samplers.TPESampler(seed=10, n_startup_trials = 15, multivariate=True)`\r\nand a PercentilePruner\r\n`pruner = optuna.pruners.PercentilePruner(65.0, n_startup_trials=10, n_warmup_steps=175, interval_steps=3)`\r\n\r\nAnd I optimize my objective function like this:\r\n`study.optimize(objective_week, n_trials=15,  gc_after_trial=True, catch=(RuntimeError,))`.\r\n\r\nI have three other hyperparamters where I use trial.suggest_int\r\n```\r\nlayers = trial.suggest_int('layers',2,4)\r\nhidden_states = trial.suggest_int('hidden_states',64,256, step=32)\r\nepochs = trial.suggest_int('epochs', 600, 1400, step=200)\r\n```\r\nand got no problems with them yet.\r\n\r\n**Since trial 22 I am getting 2,4,6 (resp. 4 for kernel_pool) as suggested values for the kernels1/2 and no longer 1,3,5,7 (resp. 3,5 for kernel_pool).**\r\n\r\n\r\n\r\nFor the other hyperparameter I use suggest_float, suggest_categorical, no problems there.\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.5.0\r\n- Python version: 3.9.1\r\n- OS: Linux Manjaro\r\n- (Optional) Other libraries and their versions:\r\ntorch: 1.7.1\r\n\r\n## Steps to reproduce\r\n\r\n1.\r\n2.\r\n3.\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\n# python code\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2467/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2467/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2462", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2462/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2462/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2462/events", "html_url": "https://github.com/optuna/optuna/issues/2462", "id": 827222785, "node_id": "MDU6SXNzdWU4MjcyMjI3ODU=", "number": 2462, "title": "StorageInternalError (data exceeding max length) with TPESampler", "user": {"login": "ironv", "id": 4298134, "node_id": "MDQ6VXNlcjQyOTgxMzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4298134?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ironv", "html_url": "https://github.com/ironv", "followers_url": "https://api.github.com/users/ironv/followers", "following_url": "https://api.github.com/users/ironv/following{/other_user}", "gists_url": "https://api.github.com/users/ironv/gists{/gist_id}", "starred_url": "https://api.github.com/users/ironv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ironv/subscriptions", "organizations_url": "https://api.github.com/users/ironv/orgs", "repos_url": "https://api.github.com/users/ironv/repos", "events_url": "https://api.github.com/users/ironv/events{/privacy}", "received_events_url": "https://api.github.com/users/ironv/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-03-10T06:46:01Z", "updated_at": "2021-03-10T21:32:44Z", "closed_at": "2021-03-10T21:32:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "Using the following Optuna code\r\n\r\n```\r\nsampler = optuna.samplers.TPESampler(n_startup_trials=5)\r\npruner = optuna.pruners.MedianPruner(n_warmup_steps=10, interval_steps=4)\r\nstudy = optuna.create_study(storage=f\"sqlite:///{clargs['CHKPT_DIR']}/example.db\", study_name=\"test\"\r\n                            , load_if_exists=True, sampler=sampler, pruner=pruner, direction=\"maximize\")\r\n```\r\n\r\nI get the following error in one of the terminals when running in parallel.  I see a similar error here #2331  but here I am using the `sqlite`, `TPESampler` and it happens much sooner (neither of which may be relevant for fixing!).  Is there a programmatic way of doing the fix suggested there and will that even work here? \r\n\r\n```\r\n[W 2021-03-10 06:23:17,129] Trial 6 failed because of the following error: StorageInternalError('An exception is raised during the commit. This typically happens due to invalid data in the commit, e.g. exceeding max length. ')\r\nTraceback (most recent call last):\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1244, in _execute_context\r\n    cursor, statement, parameters, context\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/default.py\", line 552, in do_execute\r\n    cursor.execute(statement, parameters)\r\nsqlite3.OperationalError: database is locked\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/anaconda3/lib/python3.7/site-packages/optuna/storages/_rdb/storage.py\", line 52, in _create_scoped_session\r\n    yield session\r\n  File \"/anaconda3/lib/python3.7/site-packages/optuna/storages/_rdb/storage.py\", line 643, in _update_trial\r\n    trial_model = models.TrialModel.find_or_raise_by_id(trial_id, session)\r\n  File \"/anaconda3/lib/python3.7/site-packages/optuna/storages/_rdb/models.py\", line 242, in find_or_raise_by_id\r\n    trial = query.one_or_none()\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/orm/query.py\", line 3244, in one_or_none\r\n    ret = list(self)\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/orm/query.py\", line 3317, in __iter__\r\n    return self._execute_and_instances(context)\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/orm/query.py\", line 3342, in _execute_and_instances\r\n    result = conn.execute(querycontext.statement, self._params)\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 988, in execute\r\n    return meth(self, multiparams, params)\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/sql/elements.py\", line 287, in _execute_on_connection\r\n    return connection._execute_clauseelement(self, multiparams, params)\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1107, in _execute_clauseelement\r\n    distilled_params,\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1248, in _execute_context\r\n    e, statement, parameters, cursor, context\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1466, in _handle_dbapi_exception\r\n    util.raise_from_cause(sqlalchemy_exception, exc_info)\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/util/compat.py\", line 383, in raise_from_cause\r\n    reraise(type(exception), exception, tb=exc_tb, cause=cause)\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/util/compat.py\", line 128, in reraise\r\n    raise value.with_traceback(tb)\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1244, in _execute_context\r\n    cursor, statement, parameters, context\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/default.py\", line 552, in do_execute\r\n    cursor.execute(statement, parameters)\r\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) database is locked\r\n[SQL: SELECT trials.trial_id AS trials_trial_id, trials.number AS trials_number, trials.study_id AS trials_study_id, trials.state AS trials_state, trials.datetime_start AS trials_datetime_start, trials.datetime_complete AS trials_datetime_complete \r\nFROM trials \r\nWHERE trials.trial_id = ?]\r\n[parameters: (7,)]\r\n(Background on this error at: http://sqlalche.me/e/e3q8)\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/anaconda3/lib/python3.7/site-packages/optuna/_optimize.py\", line 211, in _run_trial\r\n    value_or_values = func(trial)\r\n  File \"mlp-sqlite.py\", line 158, in __call__\r\n    trainer.fit(FFNPL(params))\r\n  File \"/anaconda3/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py\", line 513, in fit\r\n    self.dispatch()\r\n  File \"/anaconda3/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py\", line 553, in dispatch\r\n    self.accelerator.start_training(self)\r\n  File \"/anaconda3/lib/python3.7/site-packages/pytorch_lightning/accelerators/accelerator.py\", line 74, in start_training\r\n    self.training_type_plugin.start_training(trainer)\r\n  File \"/anaconda3/lib/python3.7/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py\", line 111, in start_training\r\n    self._results = trainer.run_train()\r\n  File \"/anaconda3/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py\", line 644, in run_train\r\n    self.train_loop.run_training_epoch()\r\n  File \"/anaconda3/lib/python3.7/site-packages/pytorch_lightning/trainer/training_loop.py\", line 578, in run_training_epoch\r\n    self.trainer.run_evaluation(on_epoch=True)\r\n  File \"/anaconda3/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py\", line 758, in run_evaluation\r\n    self.evaluation_loop.on_evaluation_end()\r\n  File \"/anaconda3/lib/python3.7/site-packages/pytorch_lightning/trainer/evaluation_loop.py\", line 100, in on_evaluation_end\r\n    self.trainer.call_hook('on_validation_end', *args, **kwargs)\r\n  File \"/anaconda3/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py\", line 1101, in call_hook\r\n    trainer_hook(*args, **kwargs)\r\n  File \"/anaconda3/lib/python3.7/site-packages/pytorch_lightning/trainer/callback_hook.py\", line 185, in on_validation_end\r\n    callback.on_validation_end(self, self.lightning_module)\r\n  File \"/anaconda3/lib/python3.7/site-packages/optuna/integration/pytorch_lightning.py\", line 49, in on_validation_end\r\n    self._trial.report(current_score, step=epoch)\r\n  File \"/anaconda3/lib/python3.7/site-packages/optuna/trial/_trial.py\", line 594, in report\r\n    self.storage.set_trial_intermediate_value(self._trial_id, step, value)\r\n  File \"/anaconda3/lib/python3.7/site-packages/optuna/storages/_cached_storage.py\", line 308, in set_trial_intermediate_value\r\n    self._flush_trial(trial_id)\r\n  File \"/anaconda3/lib/python3.7/site-packages/optuna/storages/_cached_storage.py\", line 427, in _flush_trial\r\n    datetime_complete=updates.datetime_complete,\r\n  File \"/anaconda3/lib/python3.7/site-packages/optuna/storages/_rdb/storage.py\", line 739, in _update_trial\r\n    session.add(trial_model)\r\n  File \"/anaconda3/lib/python3.7/contextlib.py\", line 130, in __exit__\r\n    self.gen.throw(type, value, traceback)\r\n  File \"/anaconda3/lib/python3.7/site-packages/optuna/storages/_rdb/storage.py\", line 70, in _create_scoped_session\r\n    raise optuna.exceptions.StorageInternalError(message) from e\r\noptuna.exceptions.StorageInternalError: An exception is raised during the commit. This typically happens due to invalid data in the commit, e.g. exceeding max length. \r\nTraceback (most recent call last):\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1244, in _execute_context\r\n    cursor, statement, parameters, context\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/default.py\", line 552, in do_execute\r\n    cursor.execute(statement, parameters)\r\nsqlite3.OperationalError: database is locked\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/anaconda3/lib/python3.7/site-packages/optuna/storages/_rdb/storage.py\", line 52, in _create_scoped_session\r\n    yield session\r\n  File \"/anaconda3/lib/python3.7/site-packages/optuna/storages/_rdb/storage.py\", line 643, in _update_trial\r\n    trial_model = models.TrialModel.find_or_raise_by_id(trial_id, session)\r\n  File \"/anaconda3/lib/python3.7/site-packages/optuna/storages/_rdb/models.py\", line 242, in find_or_raise_by_id\r\n    trial = query.one_or_none()\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/orm/query.py\", line 3244, in one_or_none\r\n    ret = list(self)\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/orm/query.py\", line 3317, in __iter__\r\n    return self._execute_and_instances(context)\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/orm/query.py\", line 3342, in _execute_and_instances\r\n    result = conn.execute(querycontext.statement, self._params)\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 988, in execute\r\n    return meth(self, multiparams, params)\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/sql/elements.py\", line 287, in _execute_on_connection\r\n    return connection._execute_clauseelement(self, multiparams, params)\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1107, in _execute_clauseelement\r\n    distilled_params,\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1248, in _execute_context\r\n    e, statement, parameters, cursor, context\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1466, in _handle_dbapi_exception\r\n    util.raise_from_cause(sqlalchemy_exception, exc_info)\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/util/compat.py\", line 383, in raise_from_cause\r\n    reraise(type(exception), exception, tb=exc_tb, cause=cause)\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/util/compat.py\", line 128, in reraise\r\n    raise value.with_traceback(tb)\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1244, in _execute_context\r\n    cursor, statement, parameters, context\r\n  File \"/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/default.py\", line 552, in do_execute\r\n    cursor.execute(statement, parameters)\r\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) database is locked\r\n[SQL: SELECT trials.trial_id AS trials_trial_id, trials.number AS trials_number, trials.study_id AS trials_study_id, trials.state AS trials_state, trials.datetime_start AS trials_datetime_start, trials.datetime_complete AS trials_datetime_complete \r\nFROM trials \r\nWHERE trials.trial_id = ?]\r\n[parameters: (7,)]\r\n(Background on this error at: http://sqlalche.me/e/e3q8)\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"mlp-sqlite.py\", line 187, in <module>\r\n    study.optimize(obj, callbacks=[max_trial_callback])\r\n  File \"/anaconda3/lib/python3.7/site-packages/optuna/study.py\", line 385, in optimize\r\n    show_progress_bar=show_progress_bar,\r\n  File \"/anaconda3/lib/python3.7/site-packages/optuna/_optimize.py\", line 73, in _optimize\r\n    progress_bar=progress_bar,\r\n  File \"/anaconda3/lib/python3.7/site-packages/optuna/_optimize.py\", line 164, in _optimize_sequential\r\n    trial = _run_trial(study, func, catch)\r\n  File \"/anaconda3/lib/python3.7/site-packages/optuna/_optimize.py\", line 262, in _run_trial\r\n    raise func_err\r\n  File \"/anaconda3/lib/python3.7/site-packages/optuna/_optimize.py\", line 211, in _run_trial\r\n    value_or_values = func(trial)\r\n  File \"mlp-sqlite.py\", line 158, in __call__\r\n    trainer.fit(FFNPL(params))\r\n  File \"/anaconda3/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py\", line 513, in fit\r\n    self.dispatch()\r\n  File \"/anaconda3/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py\", line 553, in dispatch\r\n    self.accelerator.start_training(self)\r\n  File \"/anaconda3/lib/python3.7/site-packages/pytorch_lightning/accelerators/accelerator.py\", line 74, in start_training\r\n    self.training_type_plugin.start_training(trainer)\r\n  File \"/anaconda3/lib/python3.7/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py\", line 111, in start_training\r\n    self._results = trainer.run_train()\r\n  File \"/anaconda3/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py\", line 644, in run_train\r\n    self.train_loop.run_training_epoch()\r\n  File \"/anaconda3/lib/python3.7/site-packages/pytorch_lightning/trainer/training_loop.py\", line 578, in run_training_epoch\r\n    self.trainer.run_evaluation(on_epoch=True)\r\n  File \"/anaconda3/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py\", line 758, in run_evaluation\r\n    self.evaluation_loop.on_evaluation_end()\r\n  File \"/anaconda3/lib/python3.7/site-packages/pytorch_lightning/trainer/evaluation_loop.py\", line 100, in on_evaluation_end\r\n    self.trainer.call_hook('on_validation_end', *args, **kwargs)\r\n  File \"/anaconda3/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py\", line 1101, in call_hook\r\n    trainer_hook(*args, **kwargs)\r\n  File \"/anaconda3/lib/python3.7/site-packages/pytorch_lightning/trainer/callback_hook.py\", line 185, in on_validation_end\r\n    callback.on_validation_end(self, self.lightning_module)\r\n  File \"/anaconda3/lib/python3.7/site-packages/optuna/integration/pytorch_lightning.py\", line 49, in on_validation_end\r\n    self._trial.report(current_score, step=epoch)\r\n  File \"/anaconda3/lib/python3.7/site-packages/optuna/trial/_trial.py\", line 594, in report\r\n    self.storage.set_trial_intermediate_value(self._trial_id, step, value)\r\n  File \"/anaconda3/lib/python3.7/site-packages/optuna/storages/_cached_storage.py\", line 308, in set_trial_intermediate_value\r\n    self._flush_trial(trial_id)\r\n  File \"/anaconda3/lib/python3.7/site-packages/optuna/storages/_cached_storage.py\", line 427, in _flush_trial\r\n    datetime_complete=updates.datetime_complete,\r\n  File \"/anaconda3/lib/python3.7/site-packages/optuna/storages/_rdb/storage.py\", line 739, in _update_trial\r\n    session.add(trial_model)\r\n  File \"/anaconda3/lib/python3.7/contextlib.py\", line 130, in __exit__\r\n    self.gen.throw(type, value, traceback)\r\n  File \"/anaconda3/lib/python3.7/site-packages/optuna/storages/_rdb/storage.py\", line 70, in _create_scoped_session\r\n    raise optuna.exceptions.StorageInternalError(message) from e\r\noptuna.exceptions.StorageInternalError: An exception is raised during the commit. This typically happens due to invalid data in the commit, e.g. exceeding max length. \r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2462/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2462/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2441", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2441/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2441/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2441/events", "html_url": "https://github.com/optuna/optuna/issues/2441", "id": 822565146, "node_id": "MDU6SXNzdWU4MjI1NjUxNDY=", "number": 2441, "title": "Pruner is too aggressive when trials have different numbers of steps", "user": {"login": "thomasj02", "id": 2532431, "node_id": "MDQ6VXNlcjI1MzI0MzE=", "avatar_url": "https://avatars.githubusercontent.com/u/2532431?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thomasj02", "html_url": "https://github.com/thomasj02", "followers_url": "https://api.github.com/users/thomasj02/followers", "following_url": "https://api.github.com/users/thomasj02/following{/other_user}", "gists_url": "https://api.github.com/users/thomasj02/gists{/gist_id}", "starred_url": "https://api.github.com/users/thomasj02/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thomasj02/subscriptions", "organizations_url": "https://api.github.com/users/thomasj02/orgs", "repos_url": "https://api.github.com/users/thomasj02/repos", "events_url": "https://api.github.com/users/thomasj02/events{/privacy}", "received_events_url": "https://api.github.com/users/thomasj02/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 18, "created_at": "2021-03-04T22:37:58Z", "updated_at": "2022-09-01T15:23:43Z", "closed_at": "2021-05-03T03:41:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm using the MedianPruner (although I think the PercentilePruner has the same issue). When there are more than n_startup_trials trials, but only one of them is long-running (e.g., most trials end at epoch 10, but one trial ends at epoch 100), then it looks like the MedianPruner will trigger pruning on epoch 11 on a new trial if the new trial is worse than the long-running trial. This makes the MedianPruner overly aggressive in terms of triggering pruning. \r\n\r\nIt would be better (and more intuitive) if the pruner only triggered pruning if there were at least n_startup_trials samples at the epoch being evaluated (or introduce a new parameter / rename n_startup_trials if you think that's more appropriate).\r\n\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.5.0\r\n- Python version: 3.7.3\r\n- OS: Ubuntu\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2441/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2441/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2421", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2421/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2421/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2421/events", "html_url": "https://github.com/optuna/optuna/issues/2421", "id": 817904752, "node_id": "MDU6SXNzdWU4MTc5MDQ3NTI=", "number": 2421, "title": "Hypervolume computation results are incorrect", "user": {"login": "y0z", "id": 30489874, "node_id": "MDQ6VXNlcjMwNDg5ODc0", "avatar_url": "https://avatars.githubusercontent.com/u/30489874?v=4", "gravatar_id": "", "url": "https://api.github.com/users/y0z", "html_url": "https://github.com/y0z", "followers_url": "https://api.github.com/users/y0z/followers", "following_url": "https://api.github.com/users/y0z/following{/other_user}", "gists_url": "https://api.github.com/users/y0z/gists{/gist_id}", "starred_url": "https://api.github.com/users/y0z/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/y0z/subscriptions", "organizations_url": "https://api.github.com/users/y0z/orgs", "repos_url": "https://api.github.com/users/y0z/repos", "events_url": "https://api.github.com/users/y0z/events{/privacy}", "received_events_url": "https://api.github.com/users/y0z/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 2107128673, "node_id": "MDU6TGFiZWwyMTA3MTI4Njcz", "url": "https://api.github.com/repos/optuna/optuna/labels/no-stale", "name": "no-stale", "color": "BBBBBB", "default": false, "description": "Exempt from stale bot"}], "state": "closed", "locked": false, "assignee": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2021-02-27T11:47:38Z", "updated_at": "2021-04-13T21:53:28Z", "closed_at": "2021-04-13T21:52:29Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hypervolume must be monotonically increasing according to the addition of a nondominated point.\r\nHowever, Optuna's hypervolume computation module sometimes returns a decreased value.\r\n\r\n## Reproducible examples and Expected behavior\r\n\r\nPlease refer to the following colab.\r\nhttps://colab.research.google.com/drive/1rZMYwNjQOxVNN8huDztsyl6BNAVMWdW9?usp=sharing\r\n\r\nFor the purposes of comparison, I also compute hypervolumes in the colab by using pygmo that is a widely used framework for multiobjective optimization and seems to be a reliable implementation.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2421/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 1, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2421/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2401", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2401/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2401/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2401/events", "html_url": "https://github.com/optuna/optuna/pull/2401", "id": 817801307, "node_id": "MDExOlB1bGxSZXF1ZXN0NTgxMjM1MzA1", "number": 2401, "title": "Remove indices from `optuna.visualization.plot_parallel_coordinate` with categorical values", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}, {"id": 2774533055, "node_id": "MDU6TGFiZWwyNzc0NTMzMDU1", "url": "https://api.github.com/repos/optuna/optuna/labels/sprint-20210227", "name": "sprint-20210227", "color": "93a8d8", "default": false, "description": "PR from the online sprint event Feb 27, 2021."}], "state": "closed", "locked": false, "assignee": {"login": "keisuke-umezawa", "id": 1277089, "node_id": "MDQ6VXNlcjEyNzcwODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1277089?v=4", "gravatar_id": "", "url": "https://api.github.com/users/keisuke-umezawa", "html_url": "https://github.com/keisuke-umezawa", "followers_url": "https://api.github.com/users/keisuke-umezawa/followers", "following_url": "https://api.github.com/users/keisuke-umezawa/following{/other_user}", "gists_url": "https://api.github.com/users/keisuke-umezawa/gists{/gist_id}", "starred_url": "https://api.github.com/users/keisuke-umezawa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/keisuke-umezawa/subscriptions", "organizations_url": "https://api.github.com/users/keisuke-umezawa/orgs", "repos_url": "https://api.github.com/users/keisuke-umezawa/repos", "events_url": "https://api.github.com/users/keisuke-umezawa/events{/privacy}", "received_events_url": "https://api.github.com/users/keisuke-umezawa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "keisuke-umezawa", "id": 1277089, "node_id": "MDQ6VXNlcjEyNzcwODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1277089?v=4", "gravatar_id": "", "url": "https://api.github.com/users/keisuke-umezawa", "html_url": "https://github.com/keisuke-umezawa", "followers_url": "https://api.github.com/users/keisuke-umezawa/followers", "following_url": "https://api.github.com/users/keisuke-umezawa/following{/other_user}", "gists_url": "https://api.github.com/users/keisuke-umezawa/gists{/gist_id}", "starred_url": "https://api.github.com/users/keisuke-umezawa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/keisuke-umezawa/subscriptions", "organizations_url": "https://api.github.com/users/keisuke-umezawa/orgs", "repos_url": "https://api.github.com/users/keisuke-umezawa/repos", "events_url": "https://api.github.com/users/keisuke-umezawa/events{/privacy}", "received_events_url": "https://api.github.com/users/keisuke-umezawa/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/32", "html_url": "https://github.com/optuna/optuna/milestone/32", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/32/labels", "id": 6366089, "node_id": "MDk6TWlsZXN0b25lNjM2NjA4OQ==", "number": 32, "title": "v2.6.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 85, "state": "closed", "created_at": "2021-01-29T05:19:18Z", "updated_at": "2021-03-08T06:34:50Z", "due_on": null, "closed_at": "2021-03-08T06:34:50Z"}, "comments": 1, "created_at": "2021-02-27T02:41:03Z", "updated_at": "2021-02-28T08:58:16Z", "closed_at": "2021-02-28T08:49:11Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2401", "html_url": "https://github.com/optuna/optuna/pull/2401", "diff_url": "https://github.com/optuna/optuna/pull/2401.diff", "patch_url": "https://github.com/optuna/optuna/pull/2401.patch", "merged_at": "2021-02-28T08:49:11Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\nSee https://github.com/optuna/optuna/issues/2389\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2401/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2401/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2392", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2392/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2392/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2392/events", "html_url": "https://github.com/optuna/optuna/pull/2392", "id": 816514864, "node_id": "MDExOlB1bGxSZXF1ZXN0NTgwMTYzMDIw", "number": 2392, "title": "Use `low` in `_transform_from_uniform` for TPE sampler", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/32", "html_url": "https://github.com/optuna/optuna/milestone/32", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/32/labels", "id": 6366089, "node_id": "MDk6TWlsZXN0b25lNjM2NjA4OQ==", "number": 32, "title": "v2.6.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 85, "state": "closed", "created_at": "2021-01-29T05:19:18Z", "updated_at": "2021-03-08T06:34:50Z", "due_on": null, "closed_at": "2021-03-08T06:34:50Z"}, "comments": 4, "created_at": "2021-02-25T14:57:41Z", "updated_at": "2021-03-11T13:58:12Z", "closed_at": "2021-03-04T00:02:10Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2392", "html_url": "https://github.com/optuna/optuna/pull/2392", "diff_url": "https://github.com/optuna/optuna/pull/2392.diff", "patch_url": "https://github.com/optuna/optuna/pull/2392.patch", "merged_at": "2021-03-04T00:02:10Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\nSee #2391\r\n\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\nI'm really not familiar with this function, but i think `low` should be added.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2392/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2392/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2391", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2391/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2391/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2391/events", "html_url": "https://github.com/optuna/optuna/issues/2391", "id": 816459893, "node_id": "MDU6SXNzdWU4MTY0NTk4OTM=", "number": 2391, "title": "Optuna TPE optimizer with multivariate=True returns incorrect range of numbers for suggest_int after some trials", "user": {"login": "casparvl", "id": 33718780, "node_id": "MDQ6VXNlcjMzNzE4Nzgw", "avatar_url": "https://avatars.githubusercontent.com/u/33718780?v=4", "gravatar_id": "", "url": "https://api.github.com/users/casparvl", "html_url": "https://github.com/casparvl", "followers_url": "https://api.github.com/users/casparvl/followers", "following_url": "https://api.github.com/users/casparvl/following{/other_user}", "gists_url": "https://api.github.com/users/casparvl/gists{/gist_id}", "starred_url": "https://api.github.com/users/casparvl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/casparvl/subscriptions", "organizations_url": "https://api.github.com/users/casparvl/orgs", "repos_url": "https://api.github.com/users/casparvl/repos", "events_url": "https://api.github.com/users/casparvl/events{/privacy}", "received_events_url": "https://api.github.com/users/casparvl/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-02-25T13:55:53Z", "updated_at": "2021-03-04T00:03:38Z", "closed_at": "2021-03-04T00:03:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "When using a TPE sample with `multivariate=True` (i.e. `optuna.samplers.TPESampler(multivariate=True)`), the `suggest_int` function starts to return integers that are not within the specified range after a certain number of trials. \r\n\r\nFor example, I've specified `my_int = trial.suggest_int('my_int', 1, 9, 2)`, thus expected trials to select `my_int` from the range `1, 3, 5, 7, 9`. However, after ~15-25 trials, the sampler starts generating even numbers (`2, 4, 6, 8`) and stops generating `3, 5, 7` (it still generates 1's and 9's).\r\n\r\nThe exact number of trials after which this behaviour is show varies, probably because this behaviour is related to the underlying model that is estimated by the sampler (and which is different every run since my objective function is not deterministic between runs).\r\n\r\n## Expected behavior\r\n\r\nI expect that `my_int = trial.suggest_int('my_int', 1, 9, 2)` only generates numbers from the range `1, 3, 5, 7, 9`. While I understand that the sampler will estimate an underlying model, I dont think it should under any circumstance generate a number that is not allowed by my prespecified `low`, `high` and `step`.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.3.0\r\n- Python version: 3.6.6\r\n- OS: Debian 10\r\n- (Optional) Other libraries and their versions: N/A\r\n\r\n## Error messages, stack traces, or logs\r\n\r\nN/A\r\n# error messages, stack traces, or logs\r\nN/A\r\n\r\n## Steps to reproduce\r\nSee below\r\n\r\n## Reproducible examples (optional)\r\n\r\nThis small reproducer gives me even numbers after ~15-25 trials:\r\n\r\n```python\r\nimport random as rand\r\nimport optuna\r\n\r\nstudy_name='multivariate'\r\ncurrent_sampler = optuna.samplers.TPESampler(multivariate=True)\r\ncurrent_pruner = optuna.pruners.SuccessiveHalvingPruner()\r\nstudy = optuna.create_study(direction = \"minimize\", study_name = study_name, \r\n                pruner = current_pruner, sampler = current_sampler\r\n            )\r\n\r\ndef optuna_objective(trial):\r\n    my_int = trial.suggest_int('my_int', 1, 9, 2)\r\n    return rand.random()\r\n\r\nstudy.optimize(optuna_objective, n_trials = 100)\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2391/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2391/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2389", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2389/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2389/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2389/events", "html_url": "https://github.com/optuna/optuna/issues/2389", "id": 816343873, "node_id": "MDU6SXNzdWU4MTYzNDM4NzM=", "number": 2389, "title": "`optuna.visualization.plot_parallel_coordinate` plots categorical values and indices", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-02-25T11:20:13Z", "updated_at": "2021-02-28T08:57:45Z", "closed_at": "2021-02-28T08:57:45Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n## Expected behavior\r\n\r\nWhen we use `visualization.plot_parallel_coordinate` for categorical hyper-parameters, the y-axis contains the categorical values and indices. For example, hyper-parameter `y` of [the latest version](https://optuna.readthedocs.io/en/latest/reference/visualization/generated/optuna.visualization.plot_parallel_coordinate.html)  is this example:\r\n\r\n![newplot](https://user-images.githubusercontent.com/7121753/109145631-137a7100-77a6-11eb-83b9-d4ccc0e6881f.png)\r\n\r\nIn an older version, let say [v2.4.0](https://optuna.readthedocs.io/en/v2.4.0/reference/visualization/generated/optuna.visualization.plot_parallel_coordinate.html), we do not see these indices.\r\n\r\nI checked out my optuna to v.2.4.0 locally, the function showed the correct plot as in the document.\r\n\r\n## Environment\r\n\r\n- Optuna version: latest\r\n- Python version: 3.8.6\r\n- OS: MacOS Big Sur\r\n- (Optional) Other libraries and their versions:\r\n  -  plotly: 4.12.0\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n# error messages, stack traces, or logs\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Just run the code on the document page.\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\nimport optuna\r\n\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_uniform(\"x\", -100, 100)\r\n    y = trial.suggest_categorical(\"y\", [-1, 0, 1])\r\n    return x ** 2 + y\r\n\r\n\r\nsampler = optuna.samplers.TPESampler(seed=10)\r\nstudy = optuna.create_study(sampler=sampler)\r\nstudy.optimize(objective, n_trials=10)\r\n\r\noptuna.visualization.plot_parallel_coordinate(study)\r\n\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2389/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2389/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2371", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2371/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2371/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2371/events", "html_url": "https://github.com/optuna/optuna/issues/2371", "id": 813187647, "node_id": "MDU6SXNzdWU4MTMxODc2NDc=", "number": 2371, "title": "Trial.suggest_int() with NSGAIISampler exceeds the range which is set using another sampled variable", "user": {"login": "kousakuin-A", "id": 63457118, "node_id": "MDQ6VXNlcjYzNDU3MTE4", "avatar_url": "https://avatars.githubusercontent.com/u/63457118?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kousakuin-A", "html_url": "https://github.com/kousakuin-A", "followers_url": "https://api.github.com/users/kousakuin-A/followers", "following_url": "https://api.github.com/users/kousakuin-A/following{/other_user}", "gists_url": "https://api.github.com/users/kousakuin-A/gists{/gist_id}", "starred_url": "https://api.github.com/users/kousakuin-A/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kousakuin-A/subscriptions", "organizations_url": "https://api.github.com/users/kousakuin-A/orgs", "repos_url": "https://api.github.com/users/kousakuin-A/repos", "events_url": "https://api.github.com/users/kousakuin-A/events{/privacy}", "received_events_url": "https://api.github.com/users/kousakuin-A/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 2107128673, "node_id": "MDU6TGFiZWwyMTA3MTI4Njcz", "url": "https://api.github.com/repos/optuna/optuna/labels/no-stale", "name": "no-stale", "color": "BBBBBB", "default": false, "description": "Exempt from stale bot"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2021-02-22T06:48:34Z", "updated_at": "2022-03-08T13:43:56Z", "closed_at": "2022-03-08T13:43:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\nWhen one variable was sampled with the range using another sampled variable, such as `a = trial.suggest_int('a', 0, 100)` and `b = trial.suggest_int('b', 0, 100-a)`, `a + b <= 100` should be True.\r\nHowever, this constraint happened to be violated when used with `NSGAIISampler`.\r\nI also tried with `RandomSampler` and `TPESampler`, and these samplers seems to obey the constraint.\r\n\r\n## Expected behavior\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\nWhen two variable `a` and `b` was sampled as below:\r\n```python\r\na = trial.suggest_int('a', 0, 100)\r\nb = trial.suggest_int('b', 0, 100-a)\r\n```\r\nthen, `a+b <= 100` should always be True.\r\n\r\n## Environment\r\n- Environment 1\r\n  - Optuna version: 2.5.0\r\n  - Python version: 3.7.0\r\n  - OS: Windows 10 Home 1909\r\n  - (Optional) Other libraries and their versions: nupy 1.17.4\r\n- Environment 2\r\n  - Optuna version: 2.5.0\r\n  - Python version: 3.7.3\r\n  - OS: Ubuntu 18.04.3 on WSL1 system on the above environment.\r\n  - (Optional) Other libraries and their versions:  numpy 1.18.1\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n[W 2021-02-22 14:44:46,194] Trial 50 failed because of the following error: AssertionError(\"param={'a': 64, 'b': 37}, dist={'a': IntUniformDistribution(high=100, low=0, step=1), 'b': IntUniformDistribution(high=36, low=0, step=1)}\")\r\n```\r\n\r\n## Steps to reproduce\r\nSee *Reproducible examples*.\r\n`seed=42` and `n_jobs=1` are set to reproduce the trial number when AssertionError occured.\r\n\r\n## Reproducible examples\r\n\r\n```python\r\nimport optuna\r\n\r\n\r\ndef objective(trial):\r\n    a = trial.suggest_int('a', 0, 100)\r\n    b = trial.suggest_int('b', 0, 100-a)\r\n    assert a+b <= 100, f'param={trial.params}, dist={trial.distributions}'\r\n    return (a-50)**2 + (b-50)**2\r\n\r\n\r\n# OK\r\nstudy = optuna.create_study(sampler=optuna.samplers.RandomSampler(seed=42))\r\nstudy.optimize(objective, n_trials=2000, n_jobs=1)\r\n\r\n# OK\r\nstudy = optuna.create_study(sampler=optuna.samplers.TPESampler(seed=42))\r\nstudy.optimize(objective, n_trials=200, n_jobs=1)\r\n\r\n# Failed at Trial 50\r\nstudy = optuna.create_study(sampler=optuna.samplers.NSGAIISampler(seed=42))\r\nstudy.optimize(objective, n_trials=2000, n_jobs=1)\r\n```\r\n\r\n## Additional context\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\nI have faced this problem when I was using optuna for optimization of a chemical composition.\r\nSuppose there is a ternary system. The compound was composed of three materials A, B, and C. I'd like to know the optimal composition ratio (wt%) of these materials, `a`, `b`, and `c`, and `a+b+c==100`.\r\nThe objective function is a prediction model of the chemical property of the compound from `a`, `b`, and `c`.\r\nSo,\r\n```python\r\ndef objective(trial):\r\n    a = trial.suggest_int('a', 0, 100)\r\n    b = trial.suggest_int('b', 0, 100-a)\r\n    c = 100 - a - b\r\n    return model.predict([a, b, c])\r\n```\r\nis what I want to do.\r\nAt first I faced this problem when I tried multi-objective optimization. `optuna.visualization.plot_pareto_front` is quite useful for that.\r\nFinally I found the problem seems to be related to NSGAIISampler, and the multi-objective optimization is not.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2371/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2371/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2370", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2370/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2370/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2370/events", "html_url": "https://github.com/optuna/optuna/pull/2370", "id": 813081550, "node_id": "MDExOlB1bGxSZXF1ZXN0NTc3Mjg1MTQy", "number": 2370, "title": "Fix assertion in cached storage for state update", "user": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "keisuke-umezawa", "id": 1277089, "node_id": "MDQ6VXNlcjEyNzcwODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1277089?v=4", "gravatar_id": "", "url": "https://api.github.com/users/keisuke-umezawa", "html_url": "https://github.com/keisuke-umezawa", "followers_url": "https://api.github.com/users/keisuke-umezawa/followers", "following_url": "https://api.github.com/users/keisuke-umezawa/following{/other_user}", "gists_url": "https://api.github.com/users/keisuke-umezawa/gists{/gist_id}", "starred_url": "https://api.github.com/users/keisuke-umezawa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/keisuke-umezawa/subscriptions", "organizations_url": "https://api.github.com/users/keisuke-umezawa/orgs", "repos_url": "https://api.github.com/users/keisuke-umezawa/repos", "events_url": "https://api.github.com/users/keisuke-umezawa/events{/privacy}", "received_events_url": "https://api.github.com/users/keisuke-umezawa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "keisuke-umezawa", "id": 1277089, "node_id": "MDQ6VXNlcjEyNzcwODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1277089?v=4", "gravatar_id": "", "url": "https://api.github.com/users/keisuke-umezawa", "html_url": "https://github.com/keisuke-umezawa", "followers_url": "https://api.github.com/users/keisuke-umezawa/followers", "following_url": "https://api.github.com/users/keisuke-umezawa/following{/other_user}", "gists_url": "https://api.github.com/users/keisuke-umezawa/gists{/gist_id}", "starred_url": "https://api.github.com/users/keisuke-umezawa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/keisuke-umezawa/subscriptions", "organizations_url": "https://api.github.com/users/keisuke-umezawa/orgs", "repos_url": "https://api.github.com/users/keisuke-umezawa/repos", "events_url": "https://api.github.com/users/keisuke-umezawa/events{/privacy}", "received_events_url": "https://api.github.com/users/keisuke-umezawa/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/32", "html_url": "https://github.com/optuna/optuna/milestone/32", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/32/labels", "id": 6366089, "node_id": "MDk6TWlsZXN0b25lNjM2NjA4OQ==", "number": 32, "title": "v2.6.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 85, "state": "closed", "created_at": "2021-01-29T05:19:18Z", "updated_at": "2021-03-08T06:34:50Z", "due_on": null, "closed_at": "2021-03-08T06:34:50Z"}, "comments": 1, "created_at": "2021-02-22T03:39:24Z", "updated_at": "2021-03-02T10:47:55Z", "closed_at": "2021-03-02T10:45:45Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2370", "html_url": "https://github.com/optuna/optuna/pull/2370", "diff_url": "https://github.com/optuna/optuna/pull/2370.diff", "patch_url": "https://github.com/optuna/optuna/pull/2370.patch", "merged_at": "2021-03-02T10:45:45Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n\r\nSee https://github.com/optuna/optuna/pull/2236#discussion_r578995373.\r\n\r\n## Description of the changes\r\n\r\nSee above.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2370/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2370/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2366", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2366/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2366/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2366/events", "html_url": "https://github.com/optuna/optuna/pull/2366", "id": 812532594, "node_id": "MDExOlB1bGxSZXF1ZXN0NTc2ODgwMDc5", "number": 2366, "title": "Fix - make model_dir by _LightGBMBaseTuner", "user": {"login": "nyanhi", "id": 63458275, "node_id": "MDQ6VXNlcjYzNDU4Mjc1", "avatar_url": "https://avatars.githubusercontent.com/u/63458275?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nyanhi", "html_url": "https://github.com/nyanhi", "followers_url": "https://api.github.com/users/nyanhi/followers", "following_url": "https://api.github.com/users/nyanhi/following{/other_user}", "gists_url": "https://api.github.com/users/nyanhi/gists{/gist_id}", "starred_url": "https://api.github.com/users/nyanhi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nyanhi/subscriptions", "organizations_url": "https://api.github.com/users/nyanhi/orgs", "repos_url": "https://api.github.com/users/nyanhi/repos", "events_url": "https://api.github.com/users/nyanhi/events{/privacy}", "received_events_url": "https://api.github.com/users/nyanhi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561256, "node_id": "MDU6TGFiZWwxOTQ3NTYxMjU2", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.integration", "name": "optuna.integration", "color": "1c659e", "default": false, "description": "Related to the `optuna.integration` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, {"login": "crcrpar", "id": 16191443, "node_id": "MDQ6VXNlcjE2MTkxNDQz", "avatar_url": "https://avatars.githubusercontent.com/u/16191443?v=4", "gravatar_id": "", "url": "https://api.github.com/users/crcrpar", "html_url": "https://github.com/crcrpar", "followers_url": "https://api.github.com/users/crcrpar/followers", "following_url": "https://api.github.com/users/crcrpar/following{/other_user}", "gists_url": "https://api.github.com/users/crcrpar/gists{/gist_id}", "starred_url": "https://api.github.com/users/crcrpar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/crcrpar/subscriptions", "organizations_url": "https://api.github.com/users/crcrpar/orgs", "repos_url": "https://api.github.com/users/crcrpar/repos", "events_url": "https://api.github.com/users/crcrpar/events{/privacy}", "received_events_url": "https://api.github.com/users/crcrpar/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/32", "html_url": "https://github.com/optuna/optuna/milestone/32", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/32/labels", "id": 6366089, "node_id": "MDk6TWlsZXN0b25lNjM2NjA4OQ==", "number": 32, "title": "v2.6.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 85, "state": "closed", "created_at": "2021-01-29T05:19:18Z", "updated_at": "2021-03-08T06:34:50Z", "due_on": null, "closed_at": "2021-03-08T06:34:50Z"}, "comments": 3, "created_at": "2021-02-20T06:42:10Z", "updated_at": "2021-03-05T00:25:07Z", "closed_at": "2021-03-05T00:25:02Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2366", "html_url": "https://github.com/optuna/optuna/pull/2366", "diff_url": "https://github.com/optuna/optuna/pull/2366.diff", "patch_url": "https://github.com/optuna/optuna/pull/2366.patch", "merged_at": "2021-03-05T00:25:02Z"}, "body": "## Motivation\r\nTo address the issue #2324 .\r\n\r\n## Description of the changes\r\nMoved following code, which makes the model directory, to `_LightGBMBaseTuner.__init__()` so that it behaves consistently across the subclasses (i.e. `LightGBMTuner` and `LightGBMTunerCV`).\r\nAlso added descriptions of `model_dir` and `return_cvbooster`.\r\n\r\n```\r\n        if self._model_dir is not None and not os.path.exists(self._model_dir):\r\n            os.mkdir(self._model_dir)\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2366/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2366/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2356", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2356/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2356/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2356/events", "html_url": "https://github.com/optuna/optuna/issues/2356", "id": 809267442, "node_id": "MDU6SXNzdWU4MDkyNjc0NDI=", "number": 2356, "title": "examples/kubernetes `check_study.sh` should match whole words", "user": {"login": "twolffpiggott", "id": 13351115, "node_id": "MDQ6VXNlcjEzMzUxMTE1", "avatar_url": "https://avatars.githubusercontent.com/u/13351115?v=4", "gravatar_id": "", "url": "https://api.github.com/users/twolffpiggott", "html_url": "https://github.com/twolffpiggott", "followers_url": "https://api.github.com/users/twolffpiggott/followers", "following_url": "https://api.github.com/users/twolffpiggott/following{/other_user}", "gists_url": "https://api.github.com/users/twolffpiggott/gists{/gist_id}", "starred_url": "https://api.github.com/users/twolffpiggott/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/twolffpiggott/subscriptions", "organizations_url": "https://api.github.com/users/twolffpiggott/orgs", "repos_url": "https://api.github.com/users/twolffpiggott/repos", "events_url": "https://api.github.com/users/twolffpiggott/events{/privacy}", "received_events_url": "https://api.github.com/users/twolffpiggott/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-02-16T12:24:52Z", "updated_at": "2021-02-21T05:25:30Z", "closed_at": "2021-02-21T05:25:30Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "In the [Distributed Optimisation on Kubernetes](https://github.com/optuna/optuna/tree/master/examples/kubernetes) example, the `check_study` script is intended to ensure that a study exists before allowing the Optuna workers to start optimisation.\r\n\r\nSince it uses `grep PATTERN` instead of `grep -w PATTERN`, it can succeed when a study that only has \"k8s_mlflow\" as a substring exists e.g. \"foo_k8s_mlflow\" but the study \"k8s_mlflow\" does not exist. This IMO is unexpected behaviour and can allow the workers to start without the expected study existing.\r\n\r\nhttps://github.com/optuna/optuna/blob/7cd4fa3c764b5ef8c0e9d14096ebe2453ba3b651/examples/kubernetes/mlflow/check_study.sh#L2\r\n\r\nI would suggest the very minor update of using `grep -w PATTERN` to ensure the expected study exists and prevent matching substrings.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2356/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2356/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2354", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2354/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2354/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2354/events", "html_url": "https://github.com/optuna/optuna/pull/2354", "id": 809057508, "node_id": "MDExOlB1bGxSZXF1ZXN0NTczOTg1ODc2", "number": 2354, "title": "Fix `matplotlib.plot_parallel_coordinate` with only one suggested parameter.", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "crcrpar", "id": 16191443, "node_id": "MDQ6VXNlcjE2MTkxNDQz", "avatar_url": "https://avatars.githubusercontent.com/u/16191443?v=4", "gravatar_id": "", "url": "https://api.github.com/users/crcrpar", "html_url": "https://github.com/crcrpar", "followers_url": "https://api.github.com/users/crcrpar/followers", "following_url": "https://api.github.com/users/crcrpar/following{/other_user}", "gists_url": "https://api.github.com/users/crcrpar/gists{/gist_id}", "starred_url": "https://api.github.com/users/crcrpar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/crcrpar/subscriptions", "organizations_url": "https://api.github.com/users/crcrpar/orgs", "repos_url": "https://api.github.com/users/crcrpar/repos", "events_url": "https://api.github.com/users/crcrpar/events{/privacy}", "received_events_url": "https://api.github.com/users/crcrpar/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "crcrpar", "id": 16191443, "node_id": "MDQ6VXNlcjE2MTkxNDQz", "avatar_url": "https://avatars.githubusercontent.com/u/16191443?v=4", "gravatar_id": "", "url": "https://api.github.com/users/crcrpar", "html_url": "https://github.com/crcrpar", "followers_url": "https://api.github.com/users/crcrpar/followers", "following_url": "https://api.github.com/users/crcrpar/following{/other_user}", "gists_url": "https://api.github.com/users/crcrpar/gists{/gist_id}", "starred_url": "https://api.github.com/users/crcrpar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/crcrpar/subscriptions", "organizations_url": "https://api.github.com/users/crcrpar/orgs", "repos_url": "https://api.github.com/users/crcrpar/repos", "events_url": "https://api.github.com/users/crcrpar/events{/privacy}", "received_events_url": "https://api.github.com/users/crcrpar/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/32", "html_url": "https://github.com/optuna/optuna/milestone/32", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/32/labels", "id": 6366089, "node_id": "MDk6TWlsZXN0b25lNjM2NjA4OQ==", "number": 32, "title": "v2.6.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 85, "state": "closed", "created_at": "2021-01-29T05:19:18Z", "updated_at": "2021-03-08T06:34:50Z", "due_on": null, "closed_at": "2021-03-08T06:34:50Z"}, "comments": 2, "created_at": "2021-02-16T07:19:22Z", "updated_at": "2021-02-18T02:26:11Z", "closed_at": "2021-02-18T02:26:06Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2354", "html_url": "https://github.com/optuna/optuna/pull/2354", "diff_url": "https://github.com/optuna/optuna/pull/2354.diff", "patch_url": "https://github.com/optuna/optuna/pull/2354.patch", "merged_at": "2021-02-18T02:26:06Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nAs discussed in https://github.com/optuna/optuna/issues/2011, `matplotlib.plot_parallel_coordinate` raises the error if a hyper-parameter contains only one unique value.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\nTo avoid the zero-divide, if a hyper-parameter contains only one unique value, set a middle value based on objective values.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2354/reactions", "total_count": 3, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 3, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2354/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2353", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2353/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2353/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2353/events", "html_url": "https://github.com/optuna/optuna/pull/2353", "id": 809044512, "node_id": "MDExOlB1bGxSZXF1ZXN0NTczOTc0NzI4", "number": 2353, "title": "Fix improper stopping with the combination of `GridSampler` and `HyperbandPruner`", "user": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561539, "node_id": "MDU6TGFiZWwxOTQ3NTYxNTM5", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.pruners", "name": "optuna.pruners", "color": "1c659e", "default": false, "description": "Related to the `optuna.pruners` submodule. This is automatically labeled by github-actions."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/32", "html_url": "https://github.com/optuna/optuna/milestone/32", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/32/labels", "id": 6366089, "node_id": "MDk6TWlsZXN0b25lNjM2NjA4OQ==", "number": 32, "title": "v2.6.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 85, "state": "closed", "created_at": "2021-01-29T05:19:18Z", "updated_at": "2021-03-08T06:34:50Z", "due_on": null, "closed_at": "2021-03-08T06:34:50Z"}, "comments": 3, "created_at": "2021-02-16T06:57:42Z", "updated_at": "2021-05-06T08:56:43Z", "closed_at": "2021-02-18T02:14:32Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2353", "html_url": "https://github.com/optuna/optuna/pull/2353", "diff_url": "https://github.com/optuna/optuna/pull/2353.diff", "patch_url": "https://github.com/optuna/optuna/pull/2353.patch", "merged_at": "2021-02-18T02:14:32Z"}, "body": "## Motivation\r\nResolve #2327 \r\n## Description of the changes\r\nWhen we use `HyperbandPruner`, `study.trials` is filtered by `bracket_id`. This causes improper stopping bug for `GridSampler` because it cannot check all nodes are visited using `study.trials`.\r\nThis PR adds `stop` method for `_BracketStudy` and checks visited nodes using `study._storage.get_all_trials`.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2353/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2353/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2350", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2350/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2350/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2350/events", "html_url": "https://github.com/optuna/optuna/issues/2350", "id": 808886397, "node_id": "MDU6SXNzdWU4MDg4ODYzOTc=", "number": 2350, "title": "Trial 44 failed because of the following error: ValueError('All layers added to a Sequential model should have unique names.", "user": {"login": "ali3assi", "id": 16214827, "node_id": "MDQ6VXNlcjE2MjE0ODI3", "avatar_url": "https://avatars.githubusercontent.com/u/16214827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ali3assi", "html_url": "https://github.com/ali3assi", "followers_url": "https://api.github.com/users/ali3assi/followers", "following_url": "https://api.github.com/users/ali3assi/following{/other_user}", "gists_url": "https://api.github.com/users/ali3assi/gists{/gist_id}", "starred_url": "https://api.github.com/users/ali3assi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ali3assi/subscriptions", "organizations_url": "https://api.github.com/users/ali3assi/orgs", "repos_url": "https://api.github.com/users/ali3assi/repos", "events_url": "https://api.github.com/users/ali3assi/events{/privacy}", "received_events_url": "https://api.github.com/users/ali3assi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2021-02-16T00:03:17Z", "updated_at": "2021-03-03T01:16:41Z", "closed_at": "2021-03-03T01:16:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "when running the paralisation in optuna as follows:\r\n ```\r\nstudy = optuna.create_study(\r\n        direction=\"maximize\",\r\n        study_name=\"test\", \r\n        storage=\"sqlite:///mydb.db\", \r\n        load_if_exists= True, #to skip creating a new study if it already exists. \r\n        pruner=HyperbandPruner(min_resource=1, max_resource=100, reduction_factor=3),\r\n    )\r\n```\r\n\r\ni get the following exception:\r\n`[W 2021-02-15 18:53:35,171] Trial 44 failed because of the following error: ValueError('All layers added to a Sequential model should have unique names. Name \"batch_normalization\" is already the name of a layer in this model. Update the `name` argument to pass a unique name.')\r\n\r\n  \r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\n## Environment\r\n\r\n- Optuna version:\r\n- Python version:\r\n- OS:\r\n- (Optional) Other libraries and their versio\r\n\r\n```\r\n# error messages, stack traces, or logs\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1.\r\n2.\r\n3.\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\n# python code\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2350/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2350/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2343", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2343/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2343/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2343/events", "html_url": "https://github.com/optuna/optuna/pull/2343", "id": 807754788, "node_id": "MDExOlB1bGxSZXF1ZXN0NTcyOTQxMDk5", "number": 2343, "title": "Add type conversions for upper/lower whose values are integers", "user": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561256, "node_id": "MDU6TGFiZWwxOTQ3NTYxMjU2", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.integration", "name": "optuna.integration", "color": "1c659e", "default": false, "description": "Related to the `optuna.integration` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "keisuke-umezawa", "id": 1277089, "node_id": "MDQ6VXNlcjEyNzcwODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1277089?v=4", "gravatar_id": "", "url": "https://api.github.com/users/keisuke-umezawa", "html_url": "https://github.com/keisuke-umezawa", "followers_url": "https://api.github.com/users/keisuke-umezawa/followers", "following_url": "https://api.github.com/users/keisuke-umezawa/following{/other_user}", "gists_url": "https://api.github.com/users/keisuke-umezawa/gists{/gist_id}", "starred_url": "https://api.github.com/users/keisuke-umezawa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/keisuke-umezawa/subscriptions", "organizations_url": "https://api.github.com/users/keisuke-umezawa/orgs", "repos_url": "https://api.github.com/users/keisuke-umezawa/repos", "events_url": "https://api.github.com/users/keisuke-umezawa/events{/privacy}", "received_events_url": "https://api.github.com/users/keisuke-umezawa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "keisuke-umezawa", "id": 1277089, "node_id": "MDQ6VXNlcjEyNzcwODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1277089?v=4", "gravatar_id": "", "url": "https://api.github.com/users/keisuke-umezawa", "html_url": "https://github.com/keisuke-umezawa", "followers_url": "https://api.github.com/users/keisuke-umezawa/followers", "following_url": "https://api.github.com/users/keisuke-umezawa/following{/other_user}", "gists_url": "https://api.github.com/users/keisuke-umezawa/gists{/gist_id}", "starred_url": "https://api.github.com/users/keisuke-umezawa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/keisuke-umezawa/subscriptions", "organizations_url": "https://api.github.com/users/keisuke-umezawa/orgs", "repos_url": "https://api.github.com/users/keisuke-umezawa/repos", "events_url": "https://api.github.com/users/keisuke-umezawa/events{/privacy}", "received_events_url": "https://api.github.com/users/keisuke-umezawa/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/32", "html_url": "https://github.com/optuna/optuna/milestone/32", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/32/labels", "id": 6366089, "node_id": "MDk6TWlsZXN0b25lNjM2NjA4OQ==", "number": 32, "title": "v2.6.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 85, "state": "closed", "created_at": "2021-01-29T05:19:18Z", "updated_at": "2021-03-08T06:34:50Z", "due_on": null, "closed_at": "2021-03-08T06:34:50Z"}, "comments": 3, "created_at": "2021-02-13T14:00:22Z", "updated_at": "2021-02-17T07:53:12Z", "closed_at": "2021-02-17T07:48:23Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2343", "html_url": "https://github.com/optuna/optuna/pull/2343", "diff_url": "https://github.com/optuna/optuna/pull/2343.diff", "patch_url": "https://github.com/optuna/optuna/pull/2343.patch", "merged_at": "2021-02-17T07:48:22Z"}, "body": "Resolve #2337.\r\n\r\n## Motivation\r\nThis PR introduces type conversions for `distribution.high` and `distribution.low` where a distribution is either `UniformDistribution` or `LogUniformDistribution`. Without these conversions, `hp.RealInterval` raises an error reported in #2337.\r\n\r\nI think this problem could also be solved by adding type conversions to (a) initializers of `UniformDistribution` and `LogUniformDistribution` or (b) `suggest_float`. I'd like other developer's opinions/suggestions for solving this problem.\r\n\r\nhttps://github.com/optuna/optuna/blob/183bcf6d391325ac9574d7d7ff0d53689a0b9e26/optuna/distributions.py#L121-L122\r\nhttps://github.com/optuna/optuna/blob/183bcf6d391325ac9574d7d7ff0d53689a0b9e26/optuna/distributions.py#L165-L166\r\nhttps://github.com/optuna/optuna/blob/183bcf6d391325ac9574d7d7ff0d53689a0b9e26/optuna/trial/_trial.py#L169-L178)\r\n\r\n## Description of the changes\r\n- Added type conversion in `_add_distributions`\r\n- Added the test\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2343/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2343/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2337", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2337/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2337/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2337/events", "html_url": "https://github.com/optuna/optuna/issues/2337", "id": 806364154, "node_id": "MDU6SXNzdWU4MDYzNjQxNTQ=", "number": 2337, "title": "Tensorboard integration with integers for parameter boundaries", "user": {"login": "timonegk", "id": 25013222, "node_id": "MDQ6VXNlcjI1MDEzMjIy", "avatar_url": "https://avatars.githubusercontent.com/u/25013222?v=4", "gravatar_id": "", "url": "https://api.github.com/users/timonegk", "html_url": "https://github.com/timonegk", "followers_url": "https://api.github.com/users/timonegk/followers", "following_url": "https://api.github.com/users/timonegk/following{/other_user}", "gists_url": "https://api.github.com/users/timonegk/gists{/gist_id}", "starred_url": "https://api.github.com/users/timonegk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/timonegk/subscriptions", "organizations_url": "https://api.github.com/users/timonegk/orgs", "repos_url": "https://api.github.com/users/timonegk/repos", "events_url": "https://api.github.com/users/timonegk/events{/privacy}", "received_events_url": "https://api.github.com/users/timonegk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2021-02-11T12:54:51Z", "updated_at": "2021-02-17T14:02:41Z", "closed_at": "2021-02-17T07:48:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "When using the `optuna.integration.tensorboard.TensorBoardCallback` with integer parameters for `suggest_uniform`, a `TypeError` is raised.\r\n\r\n## Expected behavior\r\nNo TypeError should be raised, instead the integer should be casted to a float.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.5.0\r\n- Python version: 3.7.5\r\n- OS: Debian Testing\r\n- (Optional) Other libraries and their versions: Tensorboard 2.4.1\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"tensorboard_test.py\", line 13, in <module>\r\n    study.optimize(objective, n_trials=10, timeout=600, callbacks=[tensorboard_callback])\r\n  File \"/home/timon/.pyenv/versions/3.7.5/lib/python3.7/site-packages/optuna/study.py\", line 385, in optimize\r\n    show_progress_bar=show_progress_bar,\r\n  File \"/home/timon/.pyenv/versions/3.7.5/lib/python3.7/site-packages/optuna/_optimize.py\", line 73, in _optimize\r\n    progress_bar=progress_bar,\r\n  File \"/home/timon/.pyenv/versions/3.7.5/lib/python3.7/site-packages/optuna/_optimize.py\", line 178, in _optimize_sequential\r\n    callback(study, frozen_trial)\r\n  File \"/home/timon/.pyenv/versions/3.7.5/lib/python3.7/site-packages/optuna/integration/tensorboard.py\", line 41, in __call__\r\n    self._initialization(study)\r\n  File \"/home/timon/.pyenv/versions/3.7.5/lib/python3.7/site-packages/optuna/integration/tensorboard.py\", line 102, in _initialization\r\n    self._add_distributions(trial.distributions)\r\n  File \"/home/timon/.pyenv/versions/3.7.5/lib/python3.7/site-packages/optuna/integration/tensorboard.py\", line 62, in _add_distributions\r\n    param_name, hp.RealInterval(param_distribution.low, param_distribution.high)\r\n  File \"/home/timon/.pyenv/versions/3.7.5/lib/python3.7/site-packages/tensorboard/plugins/hparams/summary_v2.py\", line 444, in __init__\r\n    raise TypeError(\"min_value must be a float: %r\" % (min_value,))\r\nTypeError: min_value must be a float: 0\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Execute the example below\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\nimport optuna\r\nfrom optuna.integration.tensorboard import TensorBoardCallback\r\n\r\ndef objective(trial: optuna.trial.Trial) -> float:\r\n    param = trial.suggest_uniform(\"param\", 0, 1)\r\n    return param**2\r\n\r\ntensorboard_callback = TensorBoardCallback(\"logs/\", metric_name=\"value\")\r\n\r\nstudy = optuna.create_study()\r\nstudy.optimize(objective, n_trials=10, callbacks=[tensorboard_callback])\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2337/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2337/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2335", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2335/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2335/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2335/events", "html_url": "https://github.com/optuna/optuna/pull/2335", "id": 806083628, "node_id": "MDExOlB1bGxSZXF1ZXN0NTcxNTcxMzE4", "number": 2335, "title": "Fix TensorBoard integration for `suggest_float`", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561256, "node_id": "MDU6TGFiZWwxOTQ3NTYxMjU2", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.integration", "name": "optuna.integration", "color": "1c659e", "default": false, "description": "Related to the `optuna.integration` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/32", "html_url": "https://github.com/optuna/optuna/milestone/32", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/32/labels", "id": 6366089, "node_id": "MDk6TWlsZXN0b25lNjM2NjA4OQ==", "number": 32, "title": "v2.6.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 85, "state": "closed", "created_at": "2021-01-29T05:19:18Z", "updated_at": "2021-03-08T06:34:50Z", "due_on": null, "closed_at": "2021-03-08T06:34:50Z"}, "comments": 1, "created_at": "2021-02-11T05:11:07Z", "updated_at": "2021-02-15T11:31:55Z", "closed_at": "2021-02-15T11:23:25Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2335", "html_url": "https://github.com/optuna/optuna/pull/2335", "diff_url": "https://github.com/optuna/optuna/pull/2335.diff", "patch_url": "https://github.com/optuna/optuna/pull/2335.patch", "merged_at": "2021-02-15T11:23:25Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\nThe current tensorboard integration does not work for hyper-parameters sampled by using `suggest_float` with `step` argument.\r\n\r\nSee https://github.com/optuna/optuna/issues/2334 for the reproducible code and the reported issue.\r\n\r\n\r\n## Description of the changes \r\n<!-- Describe the changes in this PR. -->\r\n\r\n- Replace `hp.Discrete` with `hp.RealInterval`.\r\n  - Fix the argument of `hp.Discrete` is another option, but it takes an iterable objective as the argument, so I believe `RealInterval` is simpler.\r\n- Add a test for `suggest_float`\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2335/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2335/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2334", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2334/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2334/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2334/events", "html_url": "https://github.com/optuna/optuna/issues/2334", "id": 805550217, "node_id": "MDU6SXNzdWU4MDU1NTAyMTc=", "number": 2334, "title": "Tensorboard integration breaks when using suggest_float with step parameter", "user": {"login": "SammyRamone", "id": 11520148, "node_id": "MDQ6VXNlcjExNTIwMTQ4", "avatar_url": "https://avatars.githubusercontent.com/u/11520148?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SammyRamone", "html_url": "https://github.com/SammyRamone", "followers_url": "https://api.github.com/users/SammyRamone/followers", "following_url": "https://api.github.com/users/SammyRamone/following{/other_user}", "gists_url": "https://api.github.com/users/SammyRamone/gists{/gist_id}", "starred_url": "https://api.github.com/users/SammyRamone/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SammyRamone/subscriptions", "organizations_url": "https://api.github.com/users/SammyRamone/orgs", "repos_url": "https://api.github.com/users/SammyRamone/repos", "events_url": "https://api.github.com/users/SammyRamone/events{/privacy}", "received_events_url": "https://api.github.com/users/SammyRamone/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-02-10T14:15:04Z", "updated_at": "2021-03-23T10:18:08Z", "closed_at": "2021-03-23T10:18:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\nThe tensorboard integration throws an error if the `trial.suggest_float()` method is used with a `step` parameter. If no step parameter is given, it works fine.\r\n\r\n## Expected behavior\r\nShould not throw an error.\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.5.0\r\n- Python version: 3.6\r\n- OS: Ubuntu 18.04\r\n- (Optional) Other libraries and their versions: tensorboard 2.4.1, tensorflow 2.4.1\r\n\r\n## Error messages, stack traces, or logs\r\n\r\nTraceback (most recent call last):\r\n  File \"test.py\", line 43, in <module>\r\n    study.optimize(objective, n_trials=10, timeout=600, callbacks=[tensorboard_callback])\r\n  File \"/home/marc/.local/lib/python3.6/site-packages/optuna/study.py\", line 385, in optimize\r\n    show_progress_bar=show_progress_bar,\r\n  File \"/home/marc/.local/lib/python3.6/site-packages/optuna/_optimize.py\", line 73, in _optimize\r\n    progress_bar=progress_bar,\r\n  File \"/home/marc/.local/lib/python3.6/site-packages/optuna/_optimize.py\", line 178, in _optimize_sequential\r\n    callback(study, frozen_trial)\r\n  File \"/home/marc/.local/lib/python3.6/site-packages/optuna/integration/tensorboard.py\", line 41, in __call__\r\n    self._initialization(study)\r\n  File \"/home/marc/.local/lib/python3.6/site-packages/optuna/integration/tensorboard.py\", line 102, in _initialization\r\n    self._add_distributions(trial.distributions)\r\n  File \"/home/marc/.local/lib/python3.6/site-packages/optuna/integration/tensorboard.py\", line 70, in _add_distributions\r\n    param_name, hp.Discrete(param_distribution.low, param_distribution.high)\r\n  File \"/home/marc/.local/lib/python3.6/site-packages/tensorboard/plugins/hparams/summary_v2.py\", line 500, in __init__\r\n    self._values = list(values)\r\nTypeError: 'float' object is not iterable\r\n\r\n## Steps to reproduce\r\n\r\n1. Use example from here https://github.com/optuna/optuna/blob/master/examples/tensorboard_simple.py\r\n2. Change line 33 to `dropout_rate = trial.suggest_float(\"DROPOUT_RATE\", 0.1, 0.2, step=0.001)`\r\n3. Run and error is thrown\r\n4. Remove `step=0.001`\r\n5. Run and no error is thrown\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2334/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2334/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2331", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2331/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2331/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2331/events", "html_url": "https://github.com/optuna/optuna/issues/2331", "id": 804391535, "node_id": "MDU6SXNzdWU4MDQzOTE1MzU=", "number": 2331, "title": "MOTPESampler StorageInternalError after ~300 iterations", "user": {"login": "sehoff", "id": 34772392, "node_id": "MDQ6VXNlcjM0NzcyMzky", "avatar_url": "https://avatars.githubusercontent.com/u/34772392?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sehoff", "html_url": "https://github.com/sehoff", "followers_url": "https://api.github.com/users/sehoff/followers", "following_url": "https://api.github.com/users/sehoff/following{/other_user}", "gists_url": "https://api.github.com/users/sehoff/gists{/gist_id}", "starred_url": "https://api.github.com/users/sehoff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sehoff/subscriptions", "organizations_url": "https://api.github.com/users/sehoff/orgs", "repos_url": "https://api.github.com/users/sehoff/repos", "events_url": "https://api.github.com/users/sehoff/events{/privacy}", "received_events_url": "https://api.github.com/users/sehoff/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-02-09T09:56:28Z", "updated_at": "2021-03-26T11:29:11Z", "closed_at": "2021-03-26T11:29:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "Running a multiobjective optimization using the MOTPESampler, an exception is raised after ~300 iterations when writing to a postgres DB. Apparently, the length of the insert into trial_system_attributes is too long.\r\n\r\n- The optuna exceptions is: \"optuna.exceptions.StorageInternalError: An exception is raised during the commit. This typically happens due to invalid data in the commit, e.g. exceeding max length.\"\r\n- It occurs when inserting into trial_system_attributes and the key: 'motpe:splitcache'.\r\n\r\n## Expected behavior\r\n\r\n(i) Is there a chance to increase the limit (maybe no limit) of the column, such that this exception is not raised?\r\n(ii) If not, can this be handled in another way ? I actually do not need this information myself, so maybe there is an option to not write it to the RDB\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.5.0\r\n- Python version: 3.8.5\r\n- OS: Windows10\r\n\r\n## Error messages, stack traces, or logs\r\n- This is the error from the example provided below. The one I get is basically the same. Is use three objective functions but this should not matter here!\r\n\r\n[I 2021-02-09 10:51:19,607] Trial 298 finished with values: [4.007762489974416, 38.003975116711004] and parameters: {'x': 0.3695368246169375, 'y': 0.9302597259613226}.\r\n[I 2021-02-09 10:51:20,211] Trial 299 finished with values: [49.20740296652893, 12.833723674946304] and parameters: {'x': 2.291235054547539, 'y': 2.655577652121054}.\r\n[I 2021-02-09 10:51:21,086] Trial 300 finished with values: [90.85183690981745, 12.874199880388066] and parameters: {'x': 4.5426754735860415, 'y': 1.4412004611205884}.\r\n[I 2021-02-09 10:51:21,778] Trial 301 finished with values: [24.243756546890843, 23.964240426067477] and parameters: {'x': 2.279352836003099, 'y': 0.9303170350624244}.\r\n[I 2021-02-09 10:51:22,231] Trial 303 finished with values: [35.489315997021954, 24.6078917994922] and parameters: {'x': 0.48805437834067955, 'y': 2.938389341635649}.\r\n[I 2021-02-09 10:51:22,303] Trial 302 finished with values: [29.709922859084305, 19.10484199146676] and parameters: {'x': 2.121506619593528, 'y': 1.7107572527369035}.\r\n[I 2021-02-09 10:51:23,111] Trial 304 finished with values: [37.020124677459904, 24.090399224150516] and parameters: {'x': 0.5188215621728609, 'y': 2.997641632348585}.\r\n[I 2021-02-09 10:51:24,065] Trial 305 finished with values: [35.64562542691311, 24.521412656755626] and parameters: {'x': 0.4951533240150495, 'y': 2.9438460459822156}.\r\n[W 2021-02-09 10:51:24,414] Trial 306 failed because of the following error: StorageInternalError('An exception is raised during the commit. This typically happens due to invalid data in the commit, e.g. exceeding max length. ')\r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1276, in _execute_context\r\n    self.dialect.do_execute(\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 593, in do_execute\r\n    cursor.execute(statement, parameters)\r\npsycopg2.errors.StringDataRightTruncation: value too long for type character varying(2048)\r\n\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\optuna\\storages\\_rdb\\storage.py\", line 53, in _create_scoped_session\r\n    session.commit()\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1042, in commit\r\n    self.transaction.commit()\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 504, in commit\r\n    self._prepare_impl()\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 483, in _prepare_impl\r\n    self.session.flush()\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2536, in flush\r\n    self._flush(objects)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2678, in _flush\r\n    transaction.rollback(_capture_exception=True)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 68, in __exit__\r\n    compat.raise_(\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\util\\compat.py\", line 182, in raise_\r\n    raise exception\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2638, in _flush\r\n    flush_context.execute()\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 422, in execute\r\n    rec.execute(self)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 586, in execute\r\n    persistence.save_obj(\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 239, in save_obj\r\n    _emit_insert_statements(\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1135, in _emit_insert_statements\r\n    result = cached_connections[connection].execute(\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1011, in execute\r\n    return meth(self, multiparams, params)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 298, in _execute_on_connection\r\n    return connection._execute_clauseelement(self, multiparams, params)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1124, in _execute_clauseelement\r\n    ret = self._execute_context(\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1316, in _execute_context\r\n    self._handle_dbapi_exception(\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1510, in _handle_dbapi_exception\r\n    util.raise_(\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\util\\compat.py\", line 182, in raise_\r\n    raise exception\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1276, in _execute_context\r\n    self.dialect.do_execute(\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 593, in do_execute\r\n    cursor.execute(statement, parameters)\r\nsqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(2048)\r\n\r\n[SQL: INSERT INTO trial_system_attributes (trial_id, key, value_json) VALUES (%(trial_id)s, %(key)s, %(value_json)s) RETURNING trial_system_attributes.trial_system_attribute_id]\r\n[parameters: {'trial_id': 307, 'key': 'motpe:splitcache', 'value_json': '{\"indices_below\": [193, 213, 105, 262, 187, 271, 123, 31, 153, 168, 97, 159, 8, 274, 246, 44, 203, 270, 149, 42, 110, 226, 59, 264, 229, 52, 241, 268 ... (1753 characters truncated) ... 65, 0.2898335894719627, 0.2834317038837007, 0.25384174600837245, 0.22567013790028984, 0.22467341592524187, 0.17310754919901758, 0.17209539166212695]}'}]\r\n(Background on this error at: http://sqlalche.me/e/13/9h9h)\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\optuna\\_optimize.py\", line 211, in _run_trial\r\n    value_or_values = func(trial)\r\n  File \"optuna_git.py\", line 15, in objective\r\n    x = trial.suggest_float(\"x\", 0, 5)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\optuna\\trial\\_trial.py\", line 178, in suggest_float\r\n    return self.suggest_uniform(name, low, high)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\optuna\\trial\\_trial.py\", line 237, in suggest_uniform\r\n    return self._suggest(name, distribution)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\optuna\\trial\\_trial.py\", line 716, in _suggest\r\n    param_value = self.study.sampler.sample_independent(\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\optuna\\samplers\\_tpe\\multi_objective_sampler.py\", line 182, in sample_independent\r\n    below_param_values, above_param_values = self._split_mo_observation_pairs(\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\optuna\\samplers\\_tpe\\multi_objective_sampler.py\", line 291, in _split_mo_observation_pairs\r\n    study._storage.set_trial_system_attr(trial._trial_id, _SPLITCACHE_KEY, attrs)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\optuna\\storages\\_cached_storage.py\", line 340, in set_trial_system_attr\r\n    self._flush_trial(trial_id)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\optuna\\storages\\_cached_storage.py\", line 418, in _flush_trial\r\n    return self._backend._update_trial(\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\optuna\\storages\\_rdb\\storage.py\", line 739, in _update_trial\r\n    session.add(trial_model)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\contextlib.py\", line 120, in __exit__\r\n    next(self.gen)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\optuna\\storages\\_rdb\\storage.py\", line 70, in _create_scoped_session\r\n    raise optuna.exceptions.StorageInternalError(message) from e\r\noptuna.exceptions.StorageInternalError: An exception is raised during the commit. This typically happens due to invalid data in the commit, e.g. exceeding max length.\r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1276, in _execute_context\r\n    self.dialect.do_execute(\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 593, in do_execute\r\n    cursor.execute(statement, parameters)\r\npsycopg2.errors.StringDataRightTruncation: value too long for type character varying(2048)\r\n\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\optuna\\storages\\_rdb\\storage.py\", line 53, in _create_scoped_session\r\n    session.commit()\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1042, in commit\r\n    self.transaction.commit()\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 504, in commit\r\n    self._prepare_impl()\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 483, in _prepare_impl\r\n    self.session.flush()\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2536, in flush\r\n    self._flush(objects)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2678, in _flush\r\n    transaction.rollback(_capture_exception=True)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 68, in __exit__\r\n    compat.raise_(\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\util\\compat.py\", line 182, in raise_\r\n    raise exception\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2638, in _flush\r\n    flush_context.execute()\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 422, in execute\r\n    rec.execute(self)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 586, in execute\r\n    persistence.save_obj(\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 239, in save_obj\r\n    _emit_insert_statements(\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1135, in _emit_insert_statements\r\n    result = cached_connections[connection].execute(\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1011, in execute\r\n    return meth(self, multiparams, params)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 298, in _execute_on_connection\r\n    return connection._execute_clauseelement(self, multiparams, params)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1124, in _execute_clauseelement\r\n    ret = self._execute_context(\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1316, in _execute_context\r\n    self._handle_dbapi_exception(\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1510, in _handle_dbapi_exception\r\n    util.raise_(\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\util\\compat.py\", line 182, in raise_\r\n    raise exception\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1276, in _execute_context\r\n    self.dialect.do_execute(\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 593, in do_execute\r\n    cursor.execute(statement, parameters)\r\nsqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(2048)\r\n\r\n[SQL: INSERT INTO trial_system_attributes (trial_id, key, value_json) VALUES (%(trial_id)s, %(key)s, %(value_json)s) RETURNING trial_system_attributes.trial_system_attribute_id]\r\n[parameters: {'trial_id': 307, 'key': 'motpe:splitcache', 'value_json': '{\"indices_below\": [193, 213, 105, 262, 187, 271, 123, 31, 153, 168, 97, 159, 8, 274, 246, 44, 203, 270, 149, 42, 110, 226, 59, 264, 229, 52, 241, 268 ... (1753 characters truncated) ... 65, 0.2898335894719627, 0.2834317038837007, 0.25384174600837245, 0.22567013790028984, 0.22467341592524187, 0.17310754919901758, 0.17209539166212695]}'}]\r\n(Background on this error at: http://sqlalche.me/e/13/9h9h)\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"optuna_git.py\", line 25, in <module>\r\n    study.optimize(objective, n_trials=1000, n_jobs=5)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\optuna\\study.py\", line 376, in optimize\r\n    _optimize(\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\optuna\\_optimize.py\", line 109, in _optimize\r\n    parallel(\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\joblib\\parallel.py\", line 1061, in __call__\r\n    self.retrieve()\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\joblib\\parallel.py\", line 940, in retrieve\r\n    self._output.extend(job.get(timeout=self.timeout))\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\multiprocessing\\pool.py\", line 771, in get\r\n    raise self._value\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\multiprocessing\\pool.py\", line 125, in worker\r\n    result = (True, func(*args, **kwds))\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\joblib\\_parallel_backends.py\", line 595, in __call__\r\n    return self.func(*args, **kwargs)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\joblib\\parallel.py\", line 262, in __call__\r\n    return [func(*args, **kwargs)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\joblib\\parallel.py\", line 262, in <listcomp>\r\n    return [func(*args, **kwargs)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\optuna\\_optimize.py\", line 164, in _optimize_sequential\r\n    trial = _run_trial(study, func, catch)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\optuna\\_optimize.py\", line 262, in _run_trial\r\n    raise func_err\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\optuna\\_optimize.py\", line 211, in _run_trial\r\n    value_or_values = func(trial)\r\n  File \"optuna_git.py\", line 15, in objective\r\n    x = trial.suggest_float(\"x\", 0, 5)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\optuna\\trial\\_trial.py\", line 178, in suggest_float\r\n    return self.suggest_uniform(name, low, high)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\optuna\\trial\\_trial.py\", line 237, in suggest_uniform\r\n    return self._suggest(name, distribution)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\optuna\\trial\\_trial.py\", line 716, in _suggest\r\n    param_value = self.study.sampler.sample_independent(\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\optuna\\samplers\\_tpe\\multi_objective_sampler.py\", line 182, in sample_independent\r\n    below_param_values, above_param_values = self._split_mo_observation_pairs(\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\optuna\\samplers\\_tpe\\multi_objective_sampler.py\", line 291, in _split_mo_observation_pairs\r\n    study._storage.set_trial_system_attr(trial._trial_id, _SPLITCACHE_KEY, attrs)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\optuna\\storages\\_cached_storage.py\", line 340, in set_trial_system_attr\r\n    self._flush_trial(trial_id)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\optuna\\storages\\_cached_storage.py\", line 418, in _flush_trial\r\n    return self._backend._update_trial(\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\optuna\\storages\\_rdb\\storage.py\", line 739, in _update_trial\r\n    session.add(trial_model)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\contextlib.py\", line 120, in __exit__\r\n    next(self.gen)\r\n  File \"C:\\Users\\sebas\\anaconda3\\envs\\tvp\\lib\\site-packages\\optuna\\storages\\_rdb\\storage.py\", line 70, in _create_scoped_session\r\n    raise optuna.exceptions.StorageInternalError(message) from e\r\noptuna.exceptions.StorageInternalError: An exception is raised during the commit. This typically happens due to invalid data in the commit, e.g. exceeding max length.\r\n\r\n## Reproducible examples (optional)\r\nThe example is taken from Release Note v2.4.0.\r\n\r\n```python\r\nimport optuna\r\ndef objective(trial):\r\n    # The Binh and Korn function. It has two objectives to minimize.\r\n    x = trial.suggest_float(\"x\", 0, 5)\r\n    y = trial.suggest_float(\"y\", 0, 3)\r\n\r\n    v0 = 4 * x ** 2 + 4 * y ** 2\r\n    v1 = (x - 5) ** 2 + (y - 5) ** 2\r\n    return v0, v1\r\n    \r\nstorage='postgresql://postgres:xxx@localhost:xxx/GitExample' \r\nsampler = optuna.samplers.MOTPESampler(n_startup_trials=100, n_ehvi_candidates=50, seed=1)\r\nstudy = optuna.create_study(directions=[\"minimize\", \"minimize\"],storage=storage, sampler=sampler)\r\nstudy.optimize(objective, n_trials=1000, n_jobs=5)\r\n```\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2331/reactions", "total_count": 4, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2331/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2330", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2330/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2330/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2330/events", "html_url": "https://github.com/optuna/optuna/pull/2330", "id": 803620581, "node_id": "MDExOlB1bGxSZXF1ZXN0NTY5NTE3OTEz", "number": 2330, "title": "Only fail trials associated with the current study", "user": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/32", "html_url": "https://github.com/optuna/optuna/milestone/32", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/32/labels", "id": 6366089, "node_id": "MDk6TWlsZXN0b25lNjM2NjA4OQ==", "number": 32, "title": "v2.6.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 85, "state": "closed", "created_at": "2021-01-29T05:19:18Z", "updated_at": "2021-03-08T06:34:50Z", "due_on": null, "closed_at": "2021-03-08T06:34:50Z"}, "comments": 3, "created_at": "2021-02-08T14:33:54Z", "updated_at": "2021-02-12T02:20:53Z", "closed_at": "2021-02-12T02:20:53Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2330", "html_url": "https://github.com/optuna/optuna/pull/2330", "diff_url": "https://github.com/optuna/optuna/pull/2330.diff", "patch_url": "https://github.com/optuna/optuna/pull/2330.patch", "merged_at": "2021-02-12T02:20:53Z"}, "body": "## Motivation\r\nCurrently, if we specify `heartbeat_interval` for `RDBStorage`, the stale trials are searched for from all studies associated with the specified storage. This can lead to confusing behavior if you specify a different `heartbeat_interval` for each study you create. This PR aims to only fail trials associated with the current study.\r\n\r\n## Description of the changes\r\n- Only fail trials associated with the current study\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2330/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2330/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2327", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2327/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2327/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2327/events", "html_url": "https://github.com/optuna/optuna/issues/2327", "id": 803114682, "node_id": "MDU6SXNzdWU4MDMxMTQ2ODI=", "number": 2327, "title": "`Study.optimize` cannot be stopped properly when `sampler=GridSampler` and `pruner=HyperbandPruner`", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-02-08T01:16:31Z", "updated_at": "2021-02-18T02:14:32Z", "closed_at": "2021-02-18T02:14:32Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "## Expected behavior\r\n\r\nThe study should be stopped without errors.\r\n\r\n## Environment\r\n\r\n- Optuna version: v2.6.0.dev\r\n- Python version: 3.8.5\r\n- OS: Ubuntu 20.04\r\n- (Optional) Other libraries and their versions: N/A\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```console\r\n[I 2021-02-08 10:06:01,525] Trial 22 pruned. \r\nTraceback (most recent call last):\r\n  File \"study-error-2322.py\", line 18, in <module>\r\n    study.optimize(objective, n_trials=2 ** 4 + 10)\r\n  File \"/home/yanase/pfn/code/optuna/optuna/study.py\", line 378, in optimize\r\n    _optimize(\r\n  File \"/home/yanase/pfn/code/optuna/optuna/_optimize.py\", line 66, in _optimize\r\n    _optimize_sequential(\r\n  File \"/home/yanase/pfn/code/optuna/optuna/_optimize.py\", line 163, in _optimize_sequential\r\n    trial = _run_trial(study, func, catch)\r\n  File \"/home/yanase/pfn/code/optuna/optuna/_optimize.py\", line 237, in _run_trial\r\n    study.tell(trial, values=values, state=state)\r\n  File \"/home/yanase/pfn/code/optuna/optuna/study.py\", line 627, in tell\r\n    self.sampler.after_trial(study, frozen_trial, state, values)\r\n  File \"/home/yanase/pfn/code/optuna/optuna/samplers/_grid.py\", line 196, in after_trial\r\n    study.stop()\r\n  File \"/home/yanase/pfn/code/optuna/optuna/pruners/_hyperband.py\", line 306, in __getattribute__\r\n    raise AttributeError(\r\nAttributeError: _BracketStudy does not have attribute of 'stop'\r\n```\r\n\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\nimport optuna\r\n\r\n\r\ndef objective(trial):\r\n    total = 0\r\n    for i in range(4):\r\n        x = trial.suggest_categorical(f\"x{i}\", (0, 1))\r\n        total += x\r\n        trial.report(total, i)\r\n        if trial.should_prune():\r\n            raise optuna.TrialPruned()\r\n    return total\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    sampler = optuna.samplers.GridSampler(search_space={f\"x{i}\": (0, 1) for i in range(4)})\r\n    study = optuna.create_study(sampler=sampler, pruner=optuna.pruners.HyperbandPruner())\r\n    study.optimize(objective, n_trials=2 ** 4 + 10)\r\n    print(study.trials_dataframe())\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n### Cause\r\n\r\nThis is mainly because `_BracketStudy` does not have the `stop` attribute since it was filtered out by `_VALID_ATTRS`:\r\n\r\nhttps://github.com/optuna/optuna/blob/533f081d33817f2a9a37b21916eb5f03a0fc13c2/optuna/pruners/_hyperband.py#L271-L283\r\n\r\nWhen I simply add `stop` to `_VALID_ATTRS`, another error occured as follows:\r\n\r\n```console\r\n[I 2021-02-08 10:07:20,648] Trial 15 finished with value: 4.0 and parameters: {'x0': 1, 'x1': 1, 'x2': 1, 'x3': 1}. Best is trial 2 with value: 0.0.\r\nTraceback (most recent call last):\r\n  File \"study-error-2322.py\", line 18, in <module>\r\n    study.optimize(objective, n_trials=2 ** 4 + 10)\r\n  File \"/home/yanase/pfn/code/optuna/optuna/study.py\", line 378, in optimize\r\n    _optimize(\r\n  File \"/home/yanase/pfn/code/optuna/optuna/_optimize.py\", line 66, in _optimize\r\n    _optimize_sequential(\r\n  File \"/home/yanase/pfn/code/optuna/optuna/_optimize.py\", line 163, in _optimize_sequential\r\n    trial = _run_trial(study, func, catch)\r\n  File \"/home/yanase/pfn/code/optuna/optuna/_optimize.py\", line 237, in _run_trial\r\n    study.tell(trial, values=values, state=state)\r\n  File \"/home/yanase/pfn/code/optuna/optuna/study.py\", line 627, in tell\r\n    self.sampler.after_trial(study, frozen_trial, state, values)\r\n  File \"/home/yanase/pfn/code/optuna/optuna/samplers/_grid.py\", line 196, in after_trial\r\n    study.stop()\r\n  File \"/home/yanase/pfn/code/optuna/optuna/study.py\", line 785, in stop\r\n    if self._optimize_lock.acquire(False):\r\n  File \"/home/yanase/pfn/code/optuna/optuna/pruners/_hyperband.py\", line 307, in __getattribute__\r\n    raise AttributeError(\r\nAttributeError: _BracketStudy does not have attribute of '_optimize_lock'\r\n```\r\n\r\nFurther investigation is required.\r\n\r\n### CI\r\n\r\nThe error can be seen in the [CI log](https://github.com/optuna/optuna/pull/2322/checks?check_run_id=1849119156). This error occurs stochastically.\r\n\r\n```console\r\n>       study.optimize(objective, n_trials=10)\r\n\r\ntests/pruners_tests/test_hyperband.py:213: \r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\noptuna/study.py:387: in optimize\r\n    show_progress_bar=show_progress_bar,\r\noptuna/_optimize.py:76: in _optimize\r\n    progress_bar=progress_bar,\r\noptuna/_optimize.py:163: in _optimize_sequential\r\n    trial = _run_trial(study, func, catch)\r\noptuna/_optimize.py:237: in _run_trial\r\n    study.tell(trial, values=values, state=state)\r\noptuna/study.py:627: in tell\r\n    self.sampler.after_trial(study, frozen_trial, state, values)\r\noptuna/samplers/_grid.py:196: in after_trial\r\n    study.stop()\r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n\r\nself = <optuna.pruners._hyperband.HyperbandPruner._create_bracket_study.<locals>._BracketStudy object at 0x7fa8ced1d6d0>\r\nattr_name = 'stop'\r\n\r\n    def __getattribute__(self, attr_name):  # type: ignore\r\n        if attr_name not in _BracketStudy._VALID_ATTRS:\r\n            raise AttributeError(\r\n>               \"_BracketStudy does not have attribute of '{}'\".format(attr_name)\r\n            )\r\nE           AttributeError: _BracketStudy does not have attribute of 'stop'\r\n\r\noptuna/pruners/_hyperband.py:307: AttributeError\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2327/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2327/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2324", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2324/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2324/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2324/events", "html_url": "https://github.com/optuna/optuna/issues/2324", "id": 802906373, "node_id": "MDU6SXNzdWU4MDI5MDYzNzM=", "number": 2324, "title": "`model_dir` of `LightGBMTunerCV` is not generated.", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2021-02-07T09:17:54Z", "updated_at": "2021-03-08T06:32:57Z", "closed_at": "2021-03-08T01:53:35Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n## Expected behavior \r\n\r\nAccording to [`LightGBMTuner` ](https://optuna.readthedocs.io/en/stable/reference/generated/optuna.integration.lightgbm.LightGBMTuner.html#optuna.integration.lightgbm.LightGBMTuner), if `model_dir` does not exist, optuna creates the directory, and saves boosters into the directory. I can confirm that I just add `model_dir=` (say `model_dir=\"./boosters\"`) to the argument of `.train()` in [this example](https://github.com/optuna/optuna/blob/533f081d33817f2a9a37b21916eb5f03a0fc13c2/examples/lightgbm_tuner_simple.py#L30).\r\n\r\n> `model_dir` \u2013 A directory to save boosters. By default, it is set to None and no boosters are saved. Please set shared directory (e.g., directories on NFS) if you want to access `get_best_booster()` in distributed environments. Otherwise, it may raise ValueError. If the directory does not exist, it will be created. The filenames of the boosters will be `{model_dir}/{trial_number}.pkl` (e.g., `./boosters/0.pkl`).\r\n\r\nHowever, when I add the same argument to `LightGBMTunerCV` in [this example](https://github.com/optuna/optuna/blob/533f081d33817f2a9a37b21916eb5f03a0fc13c2/examples/lightgbm_tuner_cv.py#L25), the directory is not generated. We (at least I) do not expect this inconsistent behavior.\r\n\r\nI also replace `train` with `run` and set `model_dir` as in `LightGBMTunerCV`'s case I described for `LightGBMTuner`, and it worked well:\r\n\r\n```python\r\ntuner = lgb.LightGBMTuner(params, dtrain, valid_sets=[dtrain, dval], verbose_eval=100, early_stopping_rounds=100,\r\n                          model_dir=\"./best_boosters\",)\r\ntuner.run()\r\n```\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\n## Environment\r\n\r\n- Optuna version: 533f081\r\n- Python version: 3.8.6\r\n- OS: MacOS Catalina\r\n- (Optional) Other libraries and their versions:\r\n    - lightgbm: 3.1.1\r\n\r\n## Reproducible example\r\n\r\n```python\r\nimport sklearn.datasets\r\nfrom sklearn.model_selection import KFold\r\n\r\nimport optuna.integration.lightgbm as lgb\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    data, target = sklearn.datasets.load_breast_cancer(return_X_y=True)\r\n    dtrain = lgb.Dataset(data, label=target)\r\n\r\n    params = {\r\n        \"objective\": \"binary\",\r\n        \"metric\": \"binary_logloss\",\r\n        \"verbosity\": -1,\r\n        \"boosting_type\": \"gbdt\",\r\n    }\r\n\r\n    tuner = lgb.LightGBMTunerCV(\r\n        params, dtrain, verbose_eval=100, early_stopping_rounds=100, folds=KFold(n_splits=3),\r\n        model_dir=\"./boosters\",\r\n    )\r\n\r\n    tuner.run()\r\n\r\n    print(\"Best score:\", tuner.best_score)\r\n    best_params = tuner.best_params\r\n    print(\"Best params:\", best_params)\r\n    print(\"  Params: \")\r\n    for key, value in best_params.items():\r\n        print(\"    {}: {}\".format(key, value))\r\n\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2324/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2324/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2317", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2317/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2317/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2317/events", "html_url": "https://github.com/optuna/optuna/issues/2317", "id": 802308197, "node_id": "MDU6SXNzdWU4MDIzMDgxOTc=", "number": 2317, "title": "Two issues with optuna.integration.allennlp.AllenNLPExecutor. One is error, the other is wrong results.", "user": {"login": "allenciox", "id": 49794702, "node_id": "MDQ6VXNlcjQ5Nzk0NzAy", "avatar_url": "https://avatars.githubusercontent.com/u/49794702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/allenciox", "html_url": "https://github.com/allenciox", "followers_url": "https://api.github.com/users/allenciox/followers", "following_url": "https://api.github.com/users/allenciox/following{/other_user}", "gists_url": "https://api.github.com/users/allenciox/gists{/gist_id}", "starred_url": "https://api.github.com/users/allenciox/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/allenciox/subscriptions", "organizations_url": "https://api.github.com/users/allenciox/orgs", "repos_url": "https://api.github.com/users/allenciox/repos", "events_url": "https://api.github.com/users/allenciox/events{/privacy}", "received_events_url": "https://api.github.com/users/allenciox/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2021-02-05T16:38:08Z", "updated_at": "2021-06-09T23:05:39Z", "closed_at": "2021-06-09T23:05:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a cle<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\nThere are two issues, using Optuna with optuna.integration.allennlp.AllenNLPExecutor.   The first is that everything works fine when number of jobs is set to be greater than one.   But when njobs is set > 1 an error always occurs after a random number of trials. \r\n\r\nThe second is that when the parameter to be optimized is based on validation data, it is always obtained from the last epoch, not the best epoch, \r\n\r\n## Expected behavior\r\n\r\nI expected to be able to do a run with study.optimize( objective, n_jobs=2) without getting an error at some random trial about some other trial. 100% of the time, at some random point an error is generated. \r\n\r\nI expected that when using \"best_validation_accuracy\" as the metric, that it would return the validation_accuracy of the \"best\" epoch, not the last epoch, when patience is set to 4.  On an example run where I set max_epochs to 32, the last epoch of trial 36 is listed as the \"best_trial\" in the results with a validation accuracy of .691.  However, for trial 45, the 23rd epoch had a validation accuracy of .694 but had an accuracy of .689 in the 27th (and last, because of patience of 4) epoch.  Yet this is not returned as the best model, since the last epoch had a worse result. \r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.4.0\r\n- Python version: 3.7.7\r\n- OS: Linux\r\n- (Optional) Other libraries and their versions:\r\n- allennlp: 1.2.1\r\n- SQLAlchemy                         1.3.17\r\n- sqlitedict                         1.6.0\r\n\r\n## Error messages, stack traces, or logs\r\n\r\nThis error is generated if and only if n_jobs > 1 when n_trials is set to 64.   Sometimes it might run a bunch of trials before it happens, other times it happens early on (as in the error below)  It generally happens faster if n_jobs is set to higher numbers. \r\n\r\n[W 2021-02-04 16:29:48,994] Trial 2 failed because of the following error: RuntimeError('Trial#3 has already finished and can not be updated.')\r\nTraceback (most recent call last):\r\n  File \"/bigdisk/lax/cox/anaconda/lib/python3.7/site-packages/optuna/_optimize.py\", line 198, in _run_trial\r\n    value_or_values = func(trial)\r\n\r\nThis is immediately followed by another error message, and the process ends soon after that:\r\n2021-02-04 16:29:49,839 - ERROR - sqlalchemy.pool.impl.NullPool - Exception closing connection <sqlite3.Connection object at 0x7f861010fe30>\r\nTraceback (most recent call last):\r\n  File \"/bigdisk/lax/cox/anaconda/lib/python3.7/site-packages/sqlalchemy/pool/base.py\", line 697, in _finalize_fairy\r\n    fairy._reset(pool)\r\n  File \"/bigdisk/lax/cox/anaconda/lib/python3.7/site-packages/sqlalchemy/pool/base.py\", line 893, in _reset\r\n    pool._dialect.do_rollback(self)\r\n  File \"/bigdisk/lax/cox/anaconda/lib/python3.7/site-packages/sqlalchemy/engine/default.py\", line 540, in do_rollback\r\n    dbapi_connection.rollback()\r\nsqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 140213797365504 and this is thread id 140213805758208.\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/bigdisk/lax/cox/anaconda/lib/python3.7/site-packages/sqlalchemy/pool/base.py\", line 270, in _close_connection\r\n    self._dialect.do_close(connection)\r\n  File \"/bigdisk/lax/cox/anaconda/lib/python3.7/site-packages/sqlalchemy/engine/default.py\", line 546, in do_close\r\n    dbapi_connection.close()\r\nsqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 140213797365504 and this is thread id 140213805758208.\r\n\r\n```\r\n# error messages, stack traces, or logs\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Set up study\r\n2. Run study.optimize()\r\n3. View results\r\n\r\n## Reproducible examples (optional)\r\n```python\r\n# python code\r\nHere is my code:\r\nimport optuna\r\ndef objective(trial: optuna.Trial) -> float:\r\n    trial.suggest_int(\"rnn_hidden\", 1, 64, log=True)\r\n    trial.suggest_float(\"model_dropout\", 0.0, 0.8)\r\n    trial.suggest_float(\"feedforward_dropout\", 0.0, 0.8)\r\n    trial.suggest_float(\"lr\", 5e-4, 5e-1, log=True)\r\n    trial.suggest_categorical(\"opt_type\", [\"adam\",\"adamw\",\"adagrad\"])\r\n\r\n    executor = optuna.integration.allennlp.AllenNLPExecutor(\r\n        trial=trial,  # trial object\r\n        config_file=f\"/bigdisk/lax/cox/jupyter/news3_cat.jsonnet\",  # path to jsonnet\r\n        serialization_dir=f\"/bigdisk/lax/cox/jupyter/news3/o_{trial.number}\",\r\n        metrics=\"best_validation_accuracy\",\r\n        force=True,\r\n        file_friendly_logging=True,\r\n    )\r\n    return executor.run()\r\n\r\n\r\nstudy = optuna.create_study(\r\n        storage=\"sqlite:////bigdisk/lax/cox/db/news3.db\",  # save results in DB\r\n        sampler=optuna.samplers.TPESampler(seed=24),\r\n        study_name=\"optuna_news3_cat\",\r\n        direction=\"maximize\",\r\n        pruner=optuna.pruners.HyperbandPruner(),  # pruner here!\r\n        load_if_exists=True,\r\n    )\r\n\r\n    timeout = 60 * 5  # timeout (sec): 60*60*10 sec => 10 hours\r\n    \r\n    study.optimize(\r\n        objective,\r\n        n_jobs=4,  # number of processes in parallel execution\r\n        n_trials=64,  # number of trials to train a model\r\n        timeout=timeout,  # threshold for executing time (sec)\r\n         )\r\n    \r\nIf I set n_jobs above to 1, it always runs, but doesn't return the best result from a trial. \r\n\r\n## Additional context (optional)\r\n\r\nthis is my jsonnet script that is referenced above:\r\n\r\nlocal batch_size = 16;\r\nlocal cuda_device = 0;\r\nlocal num_epochs = 32;\r\nlocal patience=4;\r\nlocal embedding_dim=300;\r\nlocal model_dropout=0.2;\r\nlocal feedforward_dropout=0.2;\r\nlocal opt_lr=0.001;\r\n\r\nlocal data_path=\"/bigdisk/lax/cox/data/nhtsa\";\r\nlocal seed = 3542;\r\nlocal opt_type=\"adam\";\r\nlocal env(var,type='char') = \r\n      if type == 'char' then std.extVar(var)\r\n      else if type == 'int' then std.parseInt(std.extVar(var))\r\n      else if type == 'float' then std.parseJson(std.extVar(var))\r\n      else if type == 'bool' then (std.parseInt(std.extvar(var)) == 1)\r\n      ;\r\nlocal seed=env('seed','int');\r\nlocal model_dropout=env('model_dropout','float');\r\nlocal feedforward_dropout=env('feedforward_dropout','float');\r\nlocal hidden_dims=env('rnn_hidden', 'int');\r\nlocal opt_type=env('opt_type');\r\n// local opt_type=std.extvar(\"opt_type\");\r\nlocal opt_lr=env('opt_lr', 'float');\r\n// local opt_eps=env('opt_eps', 'float');\r\n\r\n\r\n{\r\n  numpy_seed: seed,\r\n  pytorch_seed: seed,\r\n  random_seed: seed,\r\n  dataset_reader: {\r\n    type: \"text_classification_jsonfile\",\r\n    text_key: \"cdescr\",\r\n    label_key: \"component\",\r\n    token_indexers: {\r\n       tokens: {\r\n          type: \"single_id\",\r\n          },\r\n       },\r\n    },\r\n    train_data_path: data_path + \"_train.json\",\r\n    // train_data_path: \"/bigdisk/lax/cox/data/news3_train.json\",\r\n    validation_data_path: data_path + \"_val.json\",            \r\n    model: {\r\n       type: \"basic_classifier\",\r\n       dropout: model_dropout,\r\n       text_field_embedder: {\r\n           token_embedders: {\r\n              tokens: {\r\n                 type: \"embedding\",\r\n                 embedding_dim: embedding_dim,\r\n                 trainable: false,\r\n                 pretrained_file: data_path + \"_embed.txt\",\r\n                 },\r\n              },\r\n           },\r\n       // seq2seq_encoder: ,\r\n       seq2vec_encoder: {\r\n          type: \"bag_of_embeddings\",\r\n          embedding_dim: embedding_dim,\r\n          averaged: true,\r\n          },\r\n       feedforward: {\r\n          input_dim: embedding_dim,\r\n          num_layers: 1,\r\n          hidden_dims: hidden_dims,\r\n          dropout: feedforward_dropout,\r\n          activations: {\r\n             type: 'torch.nn.ReLU'\r\n             },\r\n          },\r\n       \r\n       },\r\n    data_loader: {\r\n       \"batch_size\": batch_size,\r\n       \"shuffle\": true,\r\n       // batches_per_epoch: None,\r\n       },\r\n    trainer: {\r\n     epoch_callbacks: [ {type: 'optuna_pruner',},],\r\n     \"optimizer\": {\r\n       type: opt_type,   // can be adam, sparseadam, adamax, adamw, huggingface_adamw, adagrad,dense_sparse_adam\r\n       lr: opt_lr,       // default is 0.001\r\n       // betas: opt_beta,  // default is Tuple[float, float] = (0.9, 0.999)\r\n       // eps: opt_eps,     // default is 1e-08\r\n       // weight_decay: opt_decay, // default is 0\r\n        },\r\n    \"num_epochs\": num_epochs,\r\n    \"patience\": patience,\r\n    \"cuda_device\": cuda_device,\r\n    // \"validation_metric\": \"+f1-measure-overall\",\r\n\r\n    },\r\n\r\n  }    \r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2317/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2317/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2316", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2316/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2316/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2316/events", "html_url": "https://github.com/optuna/optuna/issues/2316", "id": 802210077, "node_id": "MDU6SXNzdWU4MDIyMTAwNzc=", "number": 2316, "title": "AssertionError using multivariate TPE sampler", "user": {"login": "mhdadk", "id": 17471410, "node_id": "MDQ6VXNlcjE3NDcxNDEw", "avatar_url": "https://avatars.githubusercontent.com/u/17471410?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mhdadk", "html_url": "https://github.com/mhdadk", "followers_url": "https://api.github.com/users/mhdadk/followers", "following_url": "https://api.github.com/users/mhdadk/following{/other_user}", "gists_url": "https://api.github.com/users/mhdadk/gists{/gist_id}", "starred_url": "https://api.github.com/users/mhdadk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mhdadk/subscriptions", "organizations_url": "https://api.github.com/users/mhdadk/orgs", "repos_url": "https://api.github.com/users/mhdadk/repos", "events_url": "https://api.github.com/users/mhdadk/events{/privacy}", "received_events_url": "https://api.github.com/users/mhdadk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2021-02-05T14:30:24Z", "updated_at": "2021-03-13T14:15:50Z", "closed_at": "2021-03-13T14:15:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n## Expected behavior\r\n\r\nScript was running normally. Completed trial 18, but then got an `AssertionError`. This never happened before while running the same script. I previously ran the same script for 36 trials until it stopped due to a CUDA out of memory error, but that's not relevant here.\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.5.0\r\n- Python version: 3.8.5\r\n- OS: Red Hat Enterprise Linux\r\n- (Optional) Other libraries and their versions:\r\n```\r\n_libgcc_mutex             0.1                 conda_forge    conda-forge\r\n_openmp_mutex             4.5                       1_gnu    conda-forge\r\nalembic                   1.5.4                     <pip>\r\nattrs                     20.3.0                    <pip>\r\nblas                      1.0                         mkl\r\nca-certificates           2020.12.5            ha878542_0    conda-forge\r\ncertifi                   2020.12.5        py38h578d9bd_1    conda-forge\r\ncliff                     3.6.0                     <pip>\r\ncmaes                     0.8.0                     <pip>\r\ncmd2                      1.5.0                     <pip>\r\ncolorama                  0.4.4                     <pip>\r\ncolorlog                  4.7.2                     <pip>\r\ncudatoolkit               10.2.89              hfd86e86_1\r\nfreetype                  2.10.4               h5ab3b9f_0\r\nintel-openmp              2020.2                      254\r\njoblib                    1.0.0              pyhd8ed1ab_0    conda-forge\r\njpeg                      9b                   h024ee3a_2\r\nlcms2                     2.11                 h396b838_0\r\nld_impl_linux-64          2.33.1               h53a641e_7\r\nlibblas                   3.9.0           1_h86c2bf4_netlib    conda-forge\r\nlibcblas                  3.9.0           3_h92ddd45_netlib    conda-forge\r\nlibedit                   3.1.20191231         h14c3975_1\r\nlibffi                    3.3                  he6710b0_2\r\nlibgcc-ng                 9.3.0               h5dbcf3e_17    conda-forge\r\nlibgfortran-ng            9.3.0               he4bcb1c_17    conda-forge\r\nlibgfortran5              9.3.0               he4bcb1c_17    conda-forge\r\nlibgomp                   9.3.0               h5dbcf3e_17    conda-forge\r\nliblapack                 3.9.0           3_h92ddd45_netlib    conda-forge\r\nlibpng                    1.6.37               hbc83047_0\r\nlibstdcxx-ng              9.3.0               h2ae2ef3_17    conda-forge\r\nlibtiff                   4.1.0                h2733197_1\r\nlibuv                     1.40.0               h7b6447c_0\r\nlz4-c                     1.9.2                heb0550a_3\r\nMako                      1.1.4                     <pip>\r\nMarkupSafe                1.1.1                     <pip>\r\nmkl                       2020.2                      256\r\nmkl-service               2.3.0            py38he904b0f_0\r\nmkl_fft                   1.2.0            py38h23d657b_0\r\nmkl_random                1.1.1            py38h0573a6f_0\r\nncurses                   6.2                  he6710b0_1\r\nninja                     1.10.2           py38hff7bd54_0\r\nnumpy                     1.19.2           py38h54aff64_0\r\nnumpy-base                1.19.2           py38hfa32c7d_0\r\nolefile                   0.46                       py_0\r\nopenssl                   1.1.1i               h7f98852_0    conda-forge\r\noptuna                    2.5.0                     <pip>\r\npackaging                 20.9                      <pip>\r\npandas                    1.2.0            py38ha9443f7_0\r\npbr                       5.5.1                     <pip>\r\npillow                    8.1.0            py38he98fc37_0\r\npip                       20.3.3           py38h06a4308_0\r\nprettytable               0.7.2                     <pip>\r\npyparsing                 2.4.7                     <pip>\r\npyperclip                 1.8.1                     <pip>\r\npython                    3.8.5                h7579374_1\r\npython-dateutil           2.8.1                      py_0\r\npython-editor             1.0.4                     <pip>\r\npython_abi                3.8                      1_cp38    conda-forge\r\npytorch                   1.7.1           py3.8_cuda10.2.89_cudnn7.6.5_0    pytorch\r\npytz                      2020.5             pyhd3eb1b0_0\r\nPyYAML                    5.4.1                     <pip>\r\nreadline                  8.0                  h7b6447c_0\r\nscikit-learn              0.24.0           py38h658cfdd_0    conda-forge\r\nscipy                     1.6.0            py38hb2138dd_0    conda-forge\r\nsetuptools                51.0.0           py38h06a4308_2\r\nsix                       1.15.0           py38h06a4308_0\r\nSQLAlchemy                1.3.23                    <pip>\r\nsqlite                    3.33.0               h62c20be_0\r\nstevedore                 3.3.0                     <pip>\r\nthreadpoolctl             2.1.0              pyh5ca1d4c_0    conda-forge\r\ntk                        8.6.10               hbc83047_0\r\ntorchaudio                0.7.2                      py38    pytorch\r\ntorchvision               0.8.2                py38_cu102    pytorch\r\ntqdm                      4.56.0                    <pip>\r\ntyping_extensions         3.7.4.3                    py_0\r\nwcwidth                   0.2.5                     <pip>\r\nwheel                     0.36.2             pyhd3eb1b0_0\r\nxz                        5.2.5                h7b6447c_0\r\nzlib                      1.2.11               h7b6447c_3\r\nzstd                      1.4.5                h9ceee32_0\r\n```\r\n\r\n## Error messages, stack traces, or logs\r\n\r\nHere is everything starting from trial 15:\r\n\r\n```\r\n[I 2021-02-05 07:29:35,802] Trial 15 pruned.\r\n\r\nAverage Validation Loss: 2594.3800\r\n\r\nEpoch 1/5\r\n\r\nAverage Training loss: 11902.6517\r\n\r\nAverage Validation Loss: 10585.8529\r\n\r\nEpoch 2/5\r\n\r\nAverage Training loss: 8536.1782\r\n[I 2021-02-05 07:44:59,435] Trial 16 pruned.\r\n\r\nAverage Validation Loss: 6230.1825\r\n\r\nEpoch 1/5\r\n\r\nAverage Training loss: 605.1005\r\n\r\nAverage Validation Loss: 532.8016\r\n\r\nEpoch 2/5\r\n\r\nAverage Training loss: 526.2966\r\n\r\nAverage Validation Loss: 524.1667\r\n\r\nEpoch 3/5\r\n\r\nAverage Training loss: 524.6881\r\n\r\nAverage Validation Loss: 526.1336\r\n\r\nEpoch 4/5\r\n\r\nAverage Training loss: 524.3555\r\n[I 2021-02-05 08:16:04,120] Trial 17 pruned.\r\n\r\nAverage Validation Loss: 523.4189\r\n\r\nEpoch 1/5\r\n\r\nAverage Training loss: 1805.4577\r\n\r\nAverage Validation Loss: 1617.5258\r\n\r\nEpoch 2/5\r\n\r\nAverage Training loss: 1586.4583\r\n\r\nAverage Validation Loss: 1567.8128\r\n\r\nEpoch 3/5\r\n\r\nAverage Training loss: 1567.9229\r\n\r\nAverage Validation Loss: 1565.4937\r\n\r\nEpoch 4/5\r\n\r\nAverage Training loss: 1566.8196\r\n\r\nAverage Validation Loss: 1564.4235\r\n\r\nEpoch 5/5\r\n\r\nAverage Training loss: 1565.9849\r\n[I 2021-02-05 08:54:46,640] Trial 18 finished with value: 1565.4634710145326 and parameters: {'num_channels': 64, 'optimizer': 'RMSprop', 'lr': 2.618149026594371e-05, 'momentum': 0.8016042722596308, 'rmsprop_alpha': 0.902569807347318, 'batch_size': 8, 'loss_func_alpha': 3.0}. Best is trial 9 with value: 519.5251754050875.\r\n\r\nAverage Validation Loss: 1565.4635\r\nTraceback (most recent call last):\r\n  File \"recon_hp_tuning.py\", line 258, in <module>\r\n    study.optimize(objective,\r\n  File \"/afs/unity.ncsu.edu/users/m/maabdelk/.conda/envs/local/lib/python3.8/site-packages/optuna/study.py\", line 376, in optimize\r\n  File \"/afs/unity.ncsu.edu/users/m/maabdelk/.conda/envs/local/lib/python3.8/site-packages/optuna/_optimize.py\", line 63, in _optimize\r\n  File \"/afs/unity.ncsu.edu/users/m/maabdelk/.conda/envs/local/lib/python3.8/site-packages/optuna/_optimize.py\", line 164, in _optimize_sequential\r\n  File \"/afs/unity.ncsu.edu/users/m/maabdelk/.conda/envs/local/lib/python3.8/site-packages/optuna/_optimize.py\", line 191, in _run_trial\r\n  File \"/afs/unity.ncsu.edu/users/m/maabdelk/.conda/envs/local/lib/python3.8/site-packages/optuna/study.py\", line 421, in ask\r\n  File \"/afs/unity.ncsu.edu/users/m/maabdelk/.conda/envs/local/lib/python3.8/site-packages/optuna/trial/_trial.py\", line 57, in __init__\r\n  File \"/afs/unity.ncsu.edu/users/m/maabdelk/.conda/envs/local/lib/python3.8/site-packages/optuna/trial/_trial.py\", line 66, in _init_relative_params\r\n  File \"/afs/unity.ncsu.edu/users/m/maabdelk/.conda/envs/local/lib/python3.8/site-packages/optuna/samplers/_tpe/sampler.py\", line 238, in sample_relative\r\n  File \"/afs/unity.ncsu.edu/users/m/maabdelk/.conda/envs/local/lib/python3.8/site-packages/optuna/samplers/_tpe/sampler.py\", line 830, in _get_multivariate_observation_pairs\r\nAssertionError\r\n```\r\n\r\nThe `AssertionError` happens on line 830 here:\r\n\r\nhttps://github.com/optuna/optuna/blob/1d3b3955fa41181b0a59f4e7b7be21a841ee9153/optuna/samplers/_tpe/sampler.py#L827-L834\r\n\r\n## Steps to reproduce\r\n\r\nI don't think I can reproduce this since it was random.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2316/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2316/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2313", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2313/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2313/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2313/events", "html_url": "https://github.com/optuna/optuna/issues/2313", "id": 801562279, "node_id": "MDU6SXNzdWU4MDE1NjIyNzk=", "number": 2313, "title": "Reopen  : https://github.com/optuna/optuna/issues/1339", "user": {"login": "Inayat-Khan", "id": 57253699, "node_id": "MDQ6VXNlcjU3MjUzNjk5", "avatar_url": "https://avatars.githubusercontent.com/u/57253699?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Inayat-Khan", "html_url": "https://github.com/Inayat-Khan", "followers_url": "https://api.github.com/users/Inayat-Khan/followers", "following_url": "https://api.github.com/users/Inayat-Khan/following{/other_user}", "gists_url": "https://api.github.com/users/Inayat-Khan/gists{/gist_id}", "starred_url": "https://api.github.com/users/Inayat-Khan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Inayat-Khan/subscriptions", "organizations_url": "https://api.github.com/users/Inayat-Khan/orgs", "repos_url": "https://api.github.com/users/Inayat-Khan/repos", "events_url": "https://api.github.com/users/Inayat-Khan/events{/privacy}", "received_events_url": "https://api.github.com/users/Inayat-Khan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2021-02-04T19:13:36Z", "updated_at": "2021-06-09T23:05:41Z", "closed_at": "2021-06-09T23:05:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "Please reopen ticket  :  https://github.com/optuna/optuna/issues/1339 \r\nWindows 10 doesn't work with the visualisation feature of Optuna , check out the original ticket for the details I wrote there. \r\n\r\nThanks\r\nInayat Khan", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2313/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2313/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2297", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2297/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2297/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2297/events", "html_url": "https://github.com/optuna/optuna/pull/2297", "id": 799018913, "node_id": "MDExOlB1bGxSZXF1ZXN0NTY1NzM2MTA2", "number": 2297, "title": "Fix `optuna.visualization.plot_contour` of subplot case with categorical axes.", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "keisuke-umezawa", "id": 1277089, "node_id": "MDQ6VXNlcjEyNzcwODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1277089?v=4", "gravatar_id": "", "url": "https://api.github.com/users/keisuke-umezawa", "html_url": "https://github.com/keisuke-umezawa", "followers_url": "https://api.github.com/users/keisuke-umezawa/followers", "following_url": "https://api.github.com/users/keisuke-umezawa/following{/other_user}", "gists_url": "https://api.github.com/users/keisuke-umezawa/gists{/gist_id}", "starred_url": "https://api.github.com/users/keisuke-umezawa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/keisuke-umezawa/subscriptions", "organizations_url": "https://api.github.com/users/keisuke-umezawa/orgs", "repos_url": "https://api.github.com/users/keisuke-umezawa/repos", "events_url": "https://api.github.com/users/keisuke-umezawa/events{/privacy}", "received_events_url": "https://api.github.com/users/keisuke-umezawa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "keisuke-umezawa", "id": 1277089, "node_id": "MDQ6VXNlcjEyNzcwODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1277089?v=4", "gravatar_id": "", "url": "https://api.github.com/users/keisuke-umezawa", "html_url": "https://github.com/keisuke-umezawa", "followers_url": "https://api.github.com/users/keisuke-umezawa/followers", "following_url": "https://api.github.com/users/keisuke-umezawa/following{/other_user}", "gists_url": "https://api.github.com/users/keisuke-umezawa/gists{/gist_id}", "starred_url": "https://api.github.com/users/keisuke-umezawa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/keisuke-umezawa/subscriptions", "organizations_url": "https://api.github.com/users/keisuke-umezawa/orgs", "repos_url": "https://api.github.com/users/keisuke-umezawa/repos", "events_url": "https://api.github.com/users/keisuke-umezawa/events{/privacy}", "received_events_url": "https://api.github.com/users/keisuke-umezawa/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/32", "html_url": "https://github.com/optuna/optuna/milestone/32", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/32/labels", "id": 6366089, "node_id": "MDk6TWlsZXN0b25lNjM2NjA4OQ==", "number": 32, "title": "v2.6.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 85, "state": "closed", "created_at": "2021-01-29T05:19:18Z", "updated_at": "2021-03-08T06:34:50Z", "due_on": null, "closed_at": "2021-03-08T06:34:50Z"}, "comments": 6, "created_at": "2021-02-02T07:33:47Z", "updated_at": "2021-02-10T15:59:00Z", "closed_at": "2021-02-09T14:54:35Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2297", "html_url": "https://github.com/optuna/optuna/pull/2297", "diff_url": "https://github.com/optuna/optuna/pull/2297.diff", "patch_url": "https://github.com/optuna/optuna/pull/2297.patch", "merged_at": "2021-02-09T14:54:35Z"}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\nSee #2242\r\n\r\n---\r\n\r\nThis PR's figure:\r\n\r\n```python\r\nimport optuna\r\n\r\ndef objective(trial):\r\n    trial.suggest_categorical(\"a\", [\"one\", \"two\", \"three\"])\r\n    trial.suggest_categorical(\"b\", [\"eins\", \"zwei\", \"drei\"])\r\n    trial.suggest_categorical(\"c\", [\"uno\", \"dos\", \"tres\"])\r\n    return 0\r\n\r\nstudy = optuna.create_study()\r\nstudy.optimize(objective, n_trials=50)\r\n\r\noptuna.visualization.plot_contour(study)\r\n```\r\n![newplot](https://user-images.githubusercontent.com/7121753/106566911-53b64d00-6574-11eb-9992-dd157d5fbc3d.png)\r\n\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2297/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2297/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2296", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2296/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2296/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2296/events", "html_url": "https://github.com/optuna/optuna/issues/2296", "id": 798731090, "node_id": "MDU6SXNzdWU3OTg3MzEwOTA=", "number": 2296, "title": "Importances in plot do not match values in dictionary saved out", "user": {"login": "brethvoice", "id": 11823408, "node_id": "MDQ6VXNlcjExODIzNDA4", "avatar_url": "https://avatars.githubusercontent.com/u/11823408?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brethvoice", "html_url": "https://github.com/brethvoice", "followers_url": "https://api.github.com/users/brethvoice/followers", "following_url": "https://api.github.com/users/brethvoice/following{/other_user}", "gists_url": "https://api.github.com/users/brethvoice/gists{/gist_id}", "starred_url": "https://api.github.com/users/brethvoice/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brethvoice/subscriptions", "organizations_url": "https://api.github.com/users/brethvoice/orgs", "repos_url": "https://api.github.com/users/brethvoice/repos", "events_url": "https://api.github.com/users/brethvoice/events{/privacy}", "received_events_url": "https://api.github.com/users/brethvoice/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-02-01T21:40:41Z", "updated_at": "2021-02-02T15:51:35Z", "closed_at": "2021-02-02T15:51:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "The parameter importances I saved out as a .json dictionary do not match what appears when they are plotted automatically.\r\n\r\n## Expected behavior\r\n\r\nThe numbers and order of importance could match to make more sense.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.4\r\n- Python version: 3.8\r\n- OS: Windows 10\r\n\r\n## Steps to reproduce\r\n\r\n1.  Save out parameter importances ordered dictionary as .json file in callback, as so:\r\n```\r\ndef save_importances_as_json(study, trial):\r\n    completed_trials = [\r\n        t for t in study.trials if t.state == optuna.trial.TrialState.COMPLETE\r\n    ]\r\n    if len(completed_trials) > 1:\r\n        importances_dict = optuna.importance.get_param_importances(study)\r\n        with open('importances.json', 'w') as fp:\r\n            json.dump(importances_dict, fp, indent=2)\r\n```\r\n2.  After `study.optimize(objective, callbacks=[save_importances_as_json])` is completed, run the following to produce the plot of importances:\r\n```\r\nfig = optuna.visualization.plot_param_importances(study)\r\nfig.show()\r\n```\r\n3.  Compare the two.  The importances.json file will be over-written at the end of each trial so it will be up to date.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2296/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2296/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2288", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2288/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2288/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2288/events", "html_url": "https://github.com/optuna/optuna/pull/2288", "id": 797655397, "node_id": "MDExOlB1bGxSZXF1ZXN0NTY0NjEyNDUx", "number": 2288, "title": "[WIP] Fix mypy for numpy 1.20.", "user": {"login": "keisuke-umezawa", "id": 1277089, "node_id": "MDQ6VXNlcjEyNzcwODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1277089?v=4", "gravatar_id": "", "url": "https://api.github.com/users/keisuke-umezawa", "html_url": "https://github.com/keisuke-umezawa", "followers_url": "https://api.github.com/users/keisuke-umezawa/followers", "following_url": "https://api.github.com/users/keisuke-umezawa/following{/other_user}", "gists_url": "https://api.github.com/users/keisuke-umezawa/gists{/gist_id}", "starred_url": "https://api.github.com/users/keisuke-umezawa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/keisuke-umezawa/subscriptions", "organizations_url": "https://api.github.com/users/keisuke-umezawa/orgs", "repos_url": "https://api.github.com/users/keisuke-umezawa/repos", "events_url": "https://api.github.com/users/keisuke-umezawa/events{/privacy}", "received_events_url": "https://api.github.com/users/keisuke-umezawa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561256, "node_id": "MDU6TGFiZWwxOTQ3NTYxMjU2", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.integration", "name": "optuna.integration", "color": "1c659e", "default": false, "description": "Related to the `optuna.integration` submodule. This is automatically labeled by github-actions."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}, {"id": 1964887919, "node_id": "MDU6TGFiZWwxOTY0ODg3OTE5", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.importance", "name": "optuna.importance", "color": "1c659e", "default": false, "description": "Related to the `optuna.importance` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-01-31T08:29:07Z", "updated_at": "2021-02-02T12:50:09Z", "closed_at": "2021-02-02T12:48:15Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2288", "html_url": "https://github.com/optuna/optuna/pull/2288", "diff_url": "https://github.com/optuna/optuna/pull/2288.diff", "patch_url": "https://github.com/optuna/optuna/pull/2288.patch", "merged_at": null}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2288/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2288/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2274", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2274/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2274/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2274/events", "html_url": "https://github.com/optuna/optuna/pull/2274", "id": 795078864, "node_id": "MDExOlB1bGxSZXF1ZXN0NTYyNDg3MTE2", "number": 2274, "title": "Fix calculate_weights_below", "user": {"login": "y0z", "id": 30489874, "node_id": "MDQ6VXNlcjMwNDg5ODc0", "avatar_url": "https://avatars.githubusercontent.com/u/30489874?v=4", "gravatar_id": "", "url": "https://api.github.com/users/y0z", "html_url": "https://github.com/y0z", "followers_url": "https://api.github.com/users/y0z/followers", "following_url": "https://api.github.com/users/y0z/following{/other_user}", "gists_url": "https://api.github.com/users/y0z/gists{/gist_id}", "starred_url": "https://api.github.com/users/y0z/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/y0z/subscriptions", "organizations_url": "https://api.github.com/users/y0z/orgs", "repos_url": "https://api.github.com/users/y0z/repos", "events_url": "https://api.github.com/users/y0z/events{/privacy}", "received_events_url": "https://api.github.com/users/y0z/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/31", "html_url": "https://github.com/optuna/optuna/milestone/31", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/31/labels", "id": 6287377, "node_id": "MDk6TWlsZXN0b25lNjI4NzM3Nw==", "number": 31, "title": "v2.5.0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 48, "state": "closed", "created_at": "2021-01-08T05:08:34Z", "updated_at": "2021-02-01T06:04:58Z", "due_on": null, "closed_at": "2021-02-01T06:04:58Z"}, "comments": 2, "created_at": "2021-01-27T12:57:32Z", "updated_at": "2021-01-28T04:20:01Z", "closed_at": "2021-01-28T02:11:18Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2274", "html_url": "https://github.com/optuna/optuna/pull/2274", "diff_url": "https://github.com/optuna/optuna/pull/2274.diff", "patch_url": "https://github.com/optuna/optuna/pull/2274.patch", "merged_at": "2021-01-28T02:11:18Z"}, "body": "## Motivation\r\nThis PR fixes issue #2247.\r\n\r\n## Description of the changes\r\n- Fix `calculate_weights_below` (see #2247 for details)\r\n- Add some test cases for `calculate_weights_below`", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2274/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2274/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2270", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2270/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2270/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2270/events", "html_url": "https://github.com/optuna/optuna/issues/2270", "id": 794819965, "node_id": "MDU6SXNzdWU3OTQ4MTk5NjU=", "number": 2270, "title": "Optuna 2.4.0 and XGBoost 1.3.3 : Using optuna integration and xgb.cv() : n_jobs > 16", "user": {"login": "SurajitTest", "id": 59294362, "node_id": "MDQ6VXNlcjU5Mjk0MzYy", "avatar_url": "https://avatars.githubusercontent.com/u/59294362?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SurajitTest", "html_url": "https://github.com/SurajitTest", "followers_url": "https://api.github.com/users/SurajitTest/followers", "following_url": "https://api.github.com/users/SurajitTest/following{/other_user}", "gists_url": "https://api.github.com/users/SurajitTest/gists{/gist_id}", "starred_url": "https://api.github.com/users/SurajitTest/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SurajitTest/subscriptions", "organizations_url": "https://api.github.com/users/SurajitTest/orgs", "repos_url": "https://api.github.com/users/SurajitTest/repos", "events_url": "https://api.github.com/users/SurajitTest/events{/privacy}", "received_events_url": "https://api.github.com/users/SurajitTest/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-01-27T06:41:30Z", "updated_at": "2021-05-23T23:05:46Z", "closed_at": "2021-05-23T23:05:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "1. When I use Optuna 2.4.0 and XGBoost 1.3.3 (using optuna integration and xgb.cv()) with 'n_jobs'=32 in a machine that has 60 CPUs - the program runs for 18 hours without any trial output.\r\n\r\n2. I am presently using Optuna 2.4.0 and XGBoost 1.3.3 , with 'n_jobs'=16 on a machine with 60 CPUs, I start obtaining results of trial outputs within 45-60 mins.\r\n\r\nAs I have a machine with 60 CPUs , what value to set for n_jobs (greater than 16)  so that I can complete trials faster ?", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2270/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2270/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2265", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2265/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2265/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2265/events", "html_url": "https://github.com/optuna/optuna/pull/2265", "id": 793877905, "node_id": "MDExOlB1bGxSZXF1ZXN0NTYxNDg4NDAz", "number": 2265, "title": "Fix `trials_dataframe` for multi-objective optimization with fail or pruned trials", "user": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/31", "html_url": "https://github.com/optuna/optuna/milestone/31", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/31/labels", "id": 6287377, "node_id": "MDk6TWlsZXN0b25lNjI4NzM3Nw==", "number": 31, "title": "v2.5.0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 48, "state": "closed", "created_at": "2021-01-08T05:08:34Z", "updated_at": "2021-02-01T06:04:58Z", "due_on": null, "closed_at": "2021-02-01T06:04:58Z"}, "comments": 2, "created_at": "2021-01-26T02:37:24Z", "updated_at": "2021-01-27T22:33:14Z", "closed_at": "2021-01-27T13:11:19Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2265", "html_url": "https://github.com/optuna/optuna/pull/2265", "diff_url": "https://github.com/optuna/optuna/pull/2265.diff", "patch_url": "https://github.com/optuna/optuna/pull/2265.patch", "merged_at": "2021-01-27T13:11:19Z"}, "body": "## Motivation\r\nFix #2227.\r\n## Description of the changes\r\nWhen the trial's state is `FAIL` or `PRUNED`, `values_*` is set to `None`.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2265/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2265/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2256", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2256/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2256/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2256/events", "html_url": "https://github.com/optuna/optuna/issues/2256", "id": 792738841, "node_id": "MDU6SXNzdWU3OTI3Mzg4NDE=", "number": 2256, "title": "TypeError: can't pickle _thread.RLock objects", "user": {"login": "EROPLM", "id": 50483373, "node_id": "MDQ6VXNlcjUwNDgzMzcz", "avatar_url": "https://avatars.githubusercontent.com/u/50483373?v=4", "gravatar_id": "", "url": "https://api.github.com/users/EROPLM", "html_url": "https://github.com/EROPLM", "followers_url": "https://api.github.com/users/EROPLM/followers", "following_url": "https://api.github.com/users/EROPLM/following{/other_user}", "gists_url": "https://api.github.com/users/EROPLM/gists{/gist_id}", "starred_url": "https://api.github.com/users/EROPLM/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/EROPLM/subscriptions", "organizations_url": "https://api.github.com/users/EROPLM/orgs", "repos_url": "https://api.github.com/users/EROPLM/repos", "events_url": "https://api.github.com/users/EROPLM/events{/privacy}", "received_events_url": "https://api.github.com/users/EROPLM/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2021-01-24T07:27:43Z", "updated_at": "2021-01-29T13:35:00Z", "closed_at": "2021-01-29T13:34:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "When training tensorflow.keras model using Jupiter lab, program prints TypeError on finishing trial_0.\r\nTraining data is MNIST data. \r\n\r\n# Steps to reproduce\r\n\r\n1) Downloading data \r\n\r\n2) Preprocessing data below\r\n\r\nimage data shape: (n_data,28,28,1)\r\ntarget data shape: (n_data,10)\r\nimage data file: X_train.npy\r\ntarget data file: y_train.npy\r\n\r\n3) Run source code below\r\n`\r\nimport os\r\nimport optuna\r\nimport numpy as np\r\nimport matplotlib.pyplot as plt\r\nimport tensorflow as tf\r\nfrom tensorflow import keras\r\nfrom tensorflow.keras.models import Sequential\r\nfrom tensorflow.keras.layers import Conv2D,MaxPooling2D,BatchNormalization\r\nfrom tensorflow.keras.layers import Dropout,Flatten,Dense\r\nfrom tensorflow.keras.callbacks import EarlyStopping\r\nfrom tensorflow.keras.callbacks import CSVLogger\r\nfrom optuna.integration import TFKerasPruningCallback\r\nfrom tensorflow.keras import backend as K\r\nfrom sklearn.model_selection import train_test_split\r\nfrom optuna.samplers import RandomSampler \r\nfrom optuna.pruners import SuccessiveHalvingPruner\r\n\r\nos.environ['KMP_DUPLICATE_LIB_OK'] = 'True'\r\nnp.random.seed(10)\r\ntf.random.set_seed(11)\r\n\r\ndef cnn_model(trial):\r\n    model = Sequential()\r\n    model.add(Conv2D(trial.suggest_int(\"input_1\",1,1000),(3,3),activation=\"relu\",padding=\"same\",input_shape=input_shape))\r\n    model.add(Conv2D(trial.suggest_int(\"block1_conv1\",1,1000), (3,3), activation='relu', padding='same'))\r\n    model.add(Conv2D(trial.suggest_int(\"block1_conv2\",1,1000), (3,3), activation='relu', padding='same'))\r\n    model.add(BatchNormalization())\r\n    model.add(MaxPooling2D(pool_size=(2,2)))\r\n    model.add(Dropout(drop_rate))\r\n    model.add(Conv2D(trial.suggest_int(\"block2_conv1\",1,1000), (3,3), activation='relu', padding='same'))\r\n    model.add(Conv2D(trial.suggest_int(\"block2_conv2\",1,1000), (3,3), activation='relu', padding='same'))\r\n    model.add(BatchNormalization())\r\n    model.add(MaxPooling2D(pool_size=(2,2)))\r\n    model.add(Dropout(drop_rate))\r\n    model.add(Conv2D(trial.suggest_int(\"block3_conv1\",1,1000), (3,3), activation='relu', padding='same'))\r\n    model.add(Conv2D(trial.suggest_int(\"block3_conv2\",1,1000), (3,3), activation='relu', padding='same'))\r\n    model.add(Conv2D(trial.suggest_int(\"block3_conv3\",1,1000), (3,3), activation='relu', padding='same'))\r\n    model.add(BatchNormalization())\r\n    model.add(MaxPooling2D(pool_size=(2,2)))\r\n    model.add(Dropout(drop_rate))\r\n    model.add(Conv2D(trial.suggest_int(\"block4_conv1\",1,1000), (3,3), activation='relu', padding='same'))\r\n    model.add(Conv2D(trial.suggest_int(\"block4_conv2\",1,1000), (3,3), activation='relu', padding='same'))\r\n    model.add(Conv2D(trial.suggest_int(\"block4_conv3\",1,1000), (3,3), activation='relu', padding='same'))\r\n    model.add(BatchNormalization())\r\n    model.add(MaxPooling2D(pool_size=(2,2)))\r\n    model.add(Dropout(drop_rate))\r\n    model.add(Conv2D(trial.suggest_int(\"block5_conv1\",1,1000), (3,3), activation='relu', padding='same'))\r\n    model.add(Conv2D(trial.suggest_int(\"block5_conv2\",1,1000), (3,3), activation='relu', padding='same'))\r\n    model.add(Conv2D(trial.suggest_int(\"block5_conv3\",1,1000), (3,3), activation='relu', padding='same'))\r\n    model.add(BatchNormalization())\r\n    model.add(MaxPooling2D(pool_size=(2,2),padding='same'))\r\n    model.add(Dropout(drop_rate))\r\n    model.add(Flatten())\r\n    model.add(Dense(trial.suggest_int(\"fc1\",1,1000), activation='relu'))\r\n    model.add(Dense(trial.suggest_int(\"fc2\",1,1000), activation='relu'))\r\n    model.add(Dropout(drop_rate))\r\n    model.add(Dense(output_classes, activation=\"softmax\"))\r\n    return model\r\n\r\ndef callback(study, trial):\r\n    if study.best_trial.number == trial.number:\r\n        study.set_user_attr(key=\"best_model\", value=trial.user_attrs[\"best_model\"])\r\n\r\ndef objective(trial):\r\n    batch_size = 1280\r\n    epochs = 100\r\n    validation_split = 0.25\r\n    X_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.25, random_state=1,shuffle=True)\r\n    model = cnn_model(trial)\r\n    model.compile(loss='categorical_crossentropy', optimizer='rmsprop',\r\n              metrics=[\"accuracy\"])\r\n    callbacks = [EarlyStopping(monitor=\"val_accuracy\",patience=4,verbose=1),TFKerasPruningCallback(trial,\"val_accuracy\")]\r\n    model.fit(X_train, y_train, batch_size=batch_size,epochs=epochs, validation_split=validation_split,callbacks=callbacks)\r\n    score = model.evaluate(X_test, y_test, verbose=0)\r\n    trial.set_user_attr(key=\"best_model\",value=model)\r\n    return score[1]\r\n\r\nsampler = RandomSampler(seed=5)\r\nstudy = optuna.create_study(direction=\"maximize\",sampler=sampler,pruner=SuccessiveHalvingPruner())\r\nstudy.optimize(objective,n_trials=200,callbacks=[callback])\r\nbest_model = study.user_attrs[\"best_model\"]\r\n\r\nprint(study.best_params)\r\nprint(study.best_value)\r\nprint(best_model.summary())\r\nmodel_file = \"best_model.h5\"\r\nbest_model.save(model_file)\r\n\r\n`\r\n# Actual Behavior\r\nAfter running code, I expect to make model file named \"best_model.h5\".\r\nI saw an error page as attached. Please refer to the following error and log as well.\r\n# error and log\r\n\r\n[I 2021-01-23 19:12:35,802] A new study created in memory with name: no-name-2b2ac2d7-95c5-4bb2-8a12-4df2be6444cb\r\nEpoch 1/100\r\n19/19 [==============================] - 2541s 134s/step - loss: 2.4031 - accuracy: 0.1624 - val_loss: 3.6026 - val_accuracy: 0.0937\r\nEpoch 2/100\r\n19/19 [==============================] - 2543s 134s/step - loss: 1.7317 - accuracy: 0.3212 - val_loss: 1.9697 - val_accuracy: 0.3157\r\nEpoch 3/100\r\n19/19 [==============================] - 2574s 135s/step - loss: 1.4891 - accuracy: 0.4021 - val_loss: 1.5672 - val_accuracy: 0.4437\r\nEpoch 4/100\r\n19/19 [==============================] - 2523s 133s/step - loss: 1.0424 - accuracy: 0.5749 - val_loss: 2.4903 - val_accuracy: 0.4566\r\nEpoch 5/100\r\n19/19 [==============================] - 2557s 135s/step - loss: 0.8922 - accuracy: 0.6639 - val_loss: 3.0987 - val_accuracy: 0.4432\r\nEpoch 6/100\r\n19/19 [==============================] - 2586s 136s/step - loss: 0.5586 - accuracy: 0.8032 - val_loss: 1.9330 - val_accuracy: 0.6080\r\nEpoch 7/100\r\n19/19 [==============================] - 2627s 138s/step - loss: 0.4925 - accuracy: 0.8481 - val_loss: 1.2843 - val_accuracy: 0.7171\r\nEpoch 8/100\r\n19/19 [==============================] - 2619s 138s/step - loss: 0.3437 - accuracy: 0.8997 - val_loss: 0.6904 - val_accuracy: 0.8010\r\nEpoch 9/100\r\n19/19 [==============================] - 2543s 134s/step - loss: 0.2038 - accuracy: 0.9441 - val_loss: 1.6648 - val_accuracy: 0.6272\r\nEpoch 10/100\r\n19/19 [==============================] - 2547s 134s/step - loss: 0.2471 - accuracy: 0.9286 - val_loss: 0.5681 - val_accuracy: 0.8705\r\nEpoch 11/100\r\n19/19 [==============================] - 2548s 134s/step - loss: 0.1330 - accuracy: 0.9640 - val_loss: 0.3243 - val_accuracy: 0.9274\r\nEpoch 12/100\r\n19/19 [==============================] - 2538s 134s/step - loss: 0.1784 - accuracy: 0.9545 - val_loss: 2.0230 - val_accuracy: 0.6674\r\nEpoch 13/100\r\n19/19 [==============================] - 2536s 133s/step - loss: 0.0992 - accuracy: 0.9739 - val_loss: 0.1754 - val_accuracy: 0.9688\r\nEpoch 14/100\r\n19/19 [==============================] - 2531s 133s/step - loss: 0.1103 - accuracy: 0.9703 - val_loss: 0.3091 - val_accuracy: 0.9084\r\nEpoch 15/100\r\n19/19 [==============================] - 2539s 134s/step - loss: 0.1133 - accuracy: 0.9705 - val_loss: 0.1693 - val_accuracy: 0.9689\r\nEpoch 16/100\r\n19/19 [==============================] - 2542s 134s/step - loss: 0.2012 - accuracy: 0.9591 - val_loss: 0.3192 - val_accuracy: 0.9454\r\nEpoch 17/100\r\n19/19 [==============================] - 2532s 133s/step - loss: 0.0465 - accuracy: 0.9878 - val_loss: 0.2381 - val_accuracy: 0.9605\r\nEpoch 18/100\r\n19/19 [==============================] - 2542s 134s/step - loss: 0.0654 - accuracy: 0.9826 - val_loss: 0.2098 - val_accuracy: 0.9637\r\nEpoch 19/100\r\n19/19 [==============================] - 2534s 133s/step - loss: 0.0783 - accuracy: 0.9782 - val_loss: 0.1598 - val_accuracy: 0.9712\r\nEpoch 20/100\r\n19/19 [==============================] - 2542s 134s/step - loss: 0.0459 - accuracy: 0.9888 - val_loss: 0.3331 - val_accuracy: 0.9430\r\nEpoch 21/100\r\n19/19 [==============================] - 2537s 134s/step - loss: 0.0583 - accuracy: 0.9851 - val_loss: 0.2036 - val_accuracy: 0.9705\r\nEpoch 22/100\r\n19/19 [==============================] - 2538s 134s/step - loss: 0.0534 - accuracy: 0.9860 - val_loss: 0.2062 - val_accuracy: 0.9646\r\nEpoch 23/100\r\n19/19 [==============================] - 2539s 134s/step - loss: 0.0424 - accuracy: 0.9890 - val_loss: 0.6059 - val_accuracy: 0.8954\r\nEpoch 00023: early stopping\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-7-5ab3d8acb473> in <module>\r\n      1 sampler = RandomSampler(seed=5)\r\n      2 study = optuna.create_study(direction=\"maximize\",sampler=sampler,pruner=SuccessiveHalvingPruner())\r\n----> 3 study.optimize(objective,n_trials=200,callbacks=[callback])\r\n      4 best_model = study.user_attrs[\"best_model\"]\r\n\r\n~\\Miniconda3\\envs\\kaggle\\lib\\site-packages\\optuna\\study.py in optimize(self, func, n_trials, timeout, n_jobs, catch, callbacks, gc_after_trial, show_progress_bar)\r\n    379             callbacks=callbacks,\r\n    380             gc_after_trial=gc_after_trial,\r\n--> 381             show_progress_bar=show_progress_bar,\r\n    382         )\r\n    383 \r\n\r\n~\\Miniconda3\\envs\\kaggle\\lib\\site-packages\\optuna\\_optimize.py in _optimize(study, func, n_trials, timeout, n_jobs, catch, callbacks, gc_after_trial, show_progress_bar)\r\n     68                 reseed_sampler_rng=False,\r\n     69                 time_start=None,\r\n---> 70                 progress_bar=progress_bar,\r\n     71             )\r\n     72         else:\r\n\r\n~\\Miniconda3\\envs\\kaggle\\lib\\site-packages\\optuna\\_optimize.py in _optimize_sequential(study, func, n_trials, timeout, catch, callbacks, gc_after_trial, reseed_sampler_rng, time_start, progress_bar)\r\n    159 \r\n    160         try:\r\n--> 161             trial = _run_trial(study, func, catch)\r\n    162         except Exception:\r\n    163             raise\r\n\r\n~\\Miniconda3\\envs\\kaggle\\lib\\site-packages\\optuna\\_optimize.py in _run_trial(study, func, catch)\r\n    228 \r\n    229         if state == TrialState.COMPLETE:\r\n--> 230             study._log_completed_trial(trial, cast(List[float], values))\r\n    231         elif state == TrialState.PRUNED:\r\n    232             _logger.info(\"Trial {} pruned. {}\".format(trial.number, str(func_err)))\r\n\r\n~\\Miniconda3\\envs\\kaggle\\lib\\site-packages\\optuna\\study.py in _log_completed_trial(self, trial, values)\r\n    693                     values[0],\r\n    694                     trial.params,\r\n--> 695                     self.best_trial.number,\r\n    696                     self.best_value,\r\n    697                 )\r\n\r\n~\\Miniconda3\\envs\\kaggle\\lib\\site-packages\\optuna\\study.py in best_trial(self)\r\n     89             )\r\n     90 \r\n---> 91         return copy.deepcopy(self._storage.get_best_trial(self._study_id))\r\n     92 \r\n     93     @property\r\n\r\nC:\\Python37\\Lib\\copy.py in deepcopy(x, memo, _nil)\r\n    178                     y = x\r\n    179                 else:\r\n--> 180                     y = _reconstruct(x, memo, *rv)\r\n    181 \r\n    182     # If is its own copy, don't memoize.\r\n\r\nC:\\Python37\\Lib\\copy.py in _reconstruct(x, memo, func, args, state, listiter, dictiter, deepcopy)\r\n    278     if state is not None:\r\n    279         if deep:\r\n--> 280             state = deepcopy(state, memo)\r\n    281         if hasattr(y, '__setstate__'):\r\n    282             y.__setstate__(state)\r\n\r\nC:\\Python37\\Lib\\copy.py in deepcopy(x, memo, _nil)\r\n    148     copier = _deepcopy_dispatch.get(cls)\r\n    149     if copier:\r\n--> 150         y = copier(x, memo)\r\n    151     else:\r\n    152         try:\r\n\r\nC:\\Python37\\Lib\\copy.py in _deepcopy_dict(x, memo, deepcopy)\r\n    238     memo[id(x)] = y\r\n    239     for key, value in x.items():\r\n--> 240         y[deepcopy(key, memo)] = deepcopy(value, memo)\r\n    241     return y\r\n    242 d[dict] = _deepcopy_dict\r\n\r\nC:\\Python37\\Lib\\copy.py in deepcopy(x, memo, _nil)\r\n    148     copier = _deepcopy_dispatch.get(cls)\r\n    149     if copier:\r\n--> 150         y = copier(x, memo)\r\n    151     else:\r\n    152         try:\r\n\r\nC:\\Python37\\Lib\\copy.py in _deepcopy_dict(x, memo, deepcopy)\r\n    238     memo[id(x)] = y\r\n    239     for key, value in x.items():\r\n--> 240         y[deepcopy(key, memo)] = deepcopy(value, memo)\r\n    241     return y\r\n    242 d[dict] = _deepcopy_dict\r\n\r\nC:\\Python37\\Lib\\copy.py in deepcopy(x, memo, _nil)\r\n    178                     y = x\r\n    179                 else:\r\n--> 180                     y = _reconstruct(x, memo, *rv)\r\n    181 \r\n    182     # If is its own copy, don't memoize.\r\n\r\nC:\\Python37\\Lib\\copy.py in _reconstruct(x, memo, func, args, state, listiter, dictiter, deepcopy)\r\n    278     if state is not None:\r\n    279         if deep:\r\n--> 280             state = deepcopy(state, memo)\r\n    281         if hasattr(y, '__setstate__'):\r\n    282             y.__setstate__(state)\r\n\r\nC:\\Python37\\Lib\\copy.py in deepcopy(x, memo, _nil)\r\n    148     copier = _deepcopy_dispatch.get(cls)\r\n    149     if copier:\r\n--> 150         y = copier(x, memo)\r\n    151     else:\r\n    152         try:\r\n\r\nC:\\Python37\\Lib\\copy.py in _deepcopy_dict(x, memo, deepcopy)\r\n    238     memo[id(x)] = y\r\n    239     for key, value in x.items():\r\n--> 240         y[deepcopy(key, memo)] = deepcopy(value, memo)\r\n    241     return y\r\n    242 d[dict] = _deepcopy_dict\r\n\r\nC:\\Python37\\Lib\\copy.py in deepcopy(x, memo, _nil)\r\n    148     copier = _deepcopy_dispatch.get(cls)\r\n    149     if copier:\r\n--> 150         y = copier(x, memo)\r\n    151     else:\r\n    152         try:\r\n\r\nC:\\Python37\\Lib\\copy.py in _deepcopy_list(x, memo, deepcopy)\r\n    213     append = y.append\r\n    214     for a in x:\r\n--> 215         append(deepcopy(a, memo))\r\n    216     return y\r\n    217 d[list] = _deepcopy_list\r\n\r\nC:\\Python37\\Lib\\copy.py in deepcopy(x, memo, _nil)\r\n    178                     y = x\r\n    179                 else:\r\n--> 180                     y = _reconstruct(x, memo, *rv)\r\n    181 \r\n    182     # If is its own copy, don't memoize.\r\n\r\nC:\\Python37\\Lib\\copy.py in _reconstruct(x, memo, func, args, state, listiter, dictiter, deepcopy)\r\n    278     if state is not None:\r\n    279         if deep:\r\n--> 280             state = deepcopy(state, memo)\r\n    281         if hasattr(y, '__setstate__'):\r\n    282             y.__setstate__(state)\r\n\r\nC:\\Python37\\Lib\\copy.py in deepcopy(x, memo, _nil)\r\n    148     copier = _deepcopy_dispatch.get(cls)\r\n    149     if copier:\r\n--> 150         y = copier(x, memo)\r\n    151     else:\r\n    152         try:\r\n\r\nC:\\Python37\\Lib\\copy.py in _deepcopy_dict(x, memo, deepcopy)\r\n    238     memo[id(x)] = y\r\n    239     for key, value in x.items():\r\n--> 240         y[deepcopy(key, memo)] = deepcopy(value, memo)\r\n    241     return y\r\n    242 d[dict] = _deepcopy_dict\r\n\r\nC:\\Python37\\Lib\\copy.py in deepcopy(x, memo, _nil)\r\n    148     copier = _deepcopy_dispatch.get(cls)\r\n    149     if copier:\r\n--> 150         y = copier(x, memo)\r\n    151     else:\r\n    152         try:\r\n\r\nC:\\Python37\\Lib\\copy.py in _deepcopy_list(x, memo, deepcopy)\r\n    213     append = y.append\r\n    214     for a in x:\r\n--> 215         append(deepcopy(a, memo))\r\n    216     return y\r\n    217 d[list] = _deepcopy_list\r\n\r\nC:\\Python37\\Lib\\copy.py in deepcopy(x, memo, _nil)\r\n    178                     y = x\r\n    179                 else:\r\n--> 180                     y = _reconstruct(x, memo, *rv)\r\n    181 \r\n    182     # If is its own copy, don't memoize.\r\n\r\nC:\\Python37\\Lib\\copy.py in _reconstruct(x, memo, func, args, state, listiter, dictiter, deepcopy)\r\n    278     if state is not None:\r\n    279         if deep:\r\n--> 280             state = deepcopy(state, memo)\r\n    281         if hasattr(y, '__setstate__'):\r\n    282             y.__setstate__(state)\r\n\r\nC:\\Python37\\Lib\\copy.py in deepcopy(x, memo, _nil)\r\n    148     copier = _deepcopy_dispatch.get(cls)\r\n    149     if copier:\r\n--> 150         y = copier(x, memo)\r\n    151     else:\r\n    152         try:\r\n\r\nC:\\Python37\\Lib\\copy.py in _deepcopy_dict(x, memo, deepcopy)\r\n    238     memo[id(x)] = y\r\n    239     for key, value in x.items():\r\n--> 240         y[deepcopy(key, memo)] = deepcopy(value, memo)\r\n    241     return y\r\n    242 d[dict] = _deepcopy_dict\r\n\r\nC:\\Python37\\Lib\\copy.py in deepcopy(x, memo, _nil)\r\n    178                     y = x\r\n    179                 else:\r\n--> 180                     y = _reconstruct(x, memo, *rv)\r\n    181 \r\n    182     # If is its own copy, don't memoize.\r\n\r\nC:\\Python37\\Lib\\copy.py in _reconstruct(x, memo, func, args, state, listiter, dictiter, deepcopy)\r\n    278     if state is not None:\r\n    279         if deep:\r\n--> 280             state = deepcopy(state, memo)\r\n    281         if hasattr(y, '__setstate__'):\r\n    282             y.__setstate__(state)\r\n\r\nC:\\Python37\\Lib\\copy.py in deepcopy(x, memo, _nil)\r\n    148     copier = _deepcopy_dispatch.get(cls)\r\n    149     if copier:\r\n--> 150         y = copier(x, memo)\r\n    151     else:\r\n    152         try:\r\n\r\nC:\\Python37\\Lib\\copy.py in _deepcopy_dict(x, memo, deepcopy)\r\n    238     memo[id(x)] = y\r\n    239     for key, value in x.items():\r\n--> 240         y[deepcopy(key, memo)] = deepcopy(value, memo)\r\n    241     return y\r\n    242 d[dict] = _deepcopy_dict\r\n\r\nC:\\Python37\\Lib\\copy.py in deepcopy(x, memo, _nil)\r\n    178                     y = x\r\n    179                 else:\r\n--> 180                     y = _reconstruct(x, memo, *rv)\r\n    181 \r\n    182     # If is its own copy, don't memoize.\r\n\r\nC:\\Python37\\Lib\\copy.py in _reconstruct(x, memo, func, args, state, listiter, dictiter, deepcopy)\r\n    278     if state is not None:\r\n    279         if deep:\r\n--> 280             state = deepcopy(state, memo)\r\n    281         if hasattr(y, '__setstate__'):\r\n    282             y.__setstate__(state)\r\n\r\nC:\\Python37\\Lib\\copy.py in deepcopy(x, memo, _nil)\r\n    148     copier = _deepcopy_dispatch.get(cls)\r\n    149     if copier:\r\n--> 150         y = copier(x, memo)\r\n    151     else:\r\n    152         try:\r\n\r\nC:\\Python37\\Lib\\copy.py in _deepcopy_dict(x, memo, deepcopy)\r\n    238     memo[id(x)] = y\r\n    239     for key, value in x.items():\r\n--> 240         y[deepcopy(key, memo)] = deepcopy(value, memo)\r\n    241     return y\r\n    242 d[dict] = _deepcopy_dict\r\n\r\nC:\\Python37\\Lib\\copy.py in deepcopy(x, memo, _nil)\r\n    178                     y = x\r\n    179                 else:\r\n--> 180                     y = _reconstruct(x, memo, *rv)\r\n    181 \r\n    182     # If is its own copy, don't memoize.\r\n\r\nC:\\Python37\\Lib\\copy.py in _reconstruct(x, memo, func, args, state, listiter, dictiter, deepcopy)\r\n    278     if state is not None:\r\n    279         if deep:\r\n--> 280             state = deepcopy(state, memo)\r\n    281         if hasattr(y, '__setstate__'):\r\n    282             y.__setstate__(state)\r\n\r\nC:\\Python37\\Lib\\copy.py in deepcopy(x, memo, _nil)\r\n    148     copier = _deepcopy_dispatch.get(cls)\r\n    149     if copier:\r\n--> 150         y = copier(x, memo)\r\n    151     else:\r\n    152         try:\r\n\r\nC:\\Python37\\Lib\\copy.py in _deepcopy_dict(x, memo, deepcopy)\r\n    238     memo[id(x)] = y\r\n    239     for key, value in x.items():\r\n--> 240         y[deepcopy(key, memo)] = deepcopy(value, memo)\r\n    241     return y\r\n    242 d[dict] = _deepcopy_dict\r\n\r\nC:\\Python37\\Lib\\copy.py in deepcopy(x, memo, _nil)\r\n    167                     reductor = getattr(x, \"__reduce_ex__\", None)\r\n    168                     if reductor:\r\n--> 169                         rv = reductor(4)\r\n    170                     else:\r\n    171                         reductor = getattr(x, \"__reduce__\", None)\r\n\r\nTypeError: can't pickle _thread.RLock objects\r\n\r\n\r\n# package list\r\n\r\n Name =Version=Build  Channel\r\n_py-xgboost-mutex=2.0=cpu_0\r\n_tflow_select=2.3.0=eigen\r\nabsl-py=0.11.0=pyhd3eb1b0_1\r\nalembic=1.5.2=pyhd3eb1b0_0\r\nargon2-cffi=20.1.0=py37he774522_1\r\nastunparse=1.6.3=py_0\r\nasync_generator=1.10=py37h28b3542_0\r\nattrs=20.3.0=pyhd3eb1b0_0\r\nbackcall=0.2.0=py_0\r\nblas=1.0=mkl\r\nbleach=3.2.2=pyhd3eb1b0_0\r\nblinker=1.4=py37_0\r\nca-certificates=2021.1.19=haa95532_0\r\ncachetools=4.2.0=pyhd3eb1b0_0\r\ncertifi=2020.12.5=py37haa95532_0\r\ncffi=1.14.4=py37hcd4344a_0\r\nchainer=6.3.0=py_0\r\nchardet=4.0.0=py37haa95532_1003\r\nclick=7.1.2=pyhd3eb1b0_0\r\ncliff=3.5.0=pyhd8ed1ab_0\r\ncmaes=0.7.0=pyhac0dd68_0\r\ncmd2=0.9.22=py37hc8dfbb8_1\r\ncolorama=0.4.4=pyhd3eb1b0_0\r\ncolorlog=4.7.2=py37haa95532_1\r\ncryptography=3.3.1=py37hcd4344a_0\r\ncycler=0.10.0=py37_0\r\ndecorator=4.4.2=py_0\r\ndefusedxml=0.6.0=py_0\r\nentrypoints=0.3=py37_0\r\nfilelock=3.0.12=pyhd3eb1b0_1\r\nfreetype=2.10.4=hd328e21_0\r\ngast=0.3.3=py_0\r\ngoogle-auth=1.21.3=py_0\r\ngoogle-auth-oauthlib=0.4.2=pyhd3eb1b0_2\r\ngoogle-pasta=0.2.0=py_0\r\ngrpcio=1.31.0=py37he7da953_0\r\nh5py=2.10.0=py37h5e291fa_0\r\nhdf5=1.10.4=h7ebc959_0\r\nicc_rt=2019.0.0=h0cc432a_1\r\nicu=58.2=ha925a31_3\r\nidna=2.10=pyhd3eb1b0_0\r\nimportlib-metadata=2.0.0=py_1\r\nimportlib_metadata=2.0.0=1\r\nintel-openmp=2020.2=254\r\nipykernel=5.3.4=py37h5ca1d4c_0\r\nipython=7.19.0=py37hd4e2768_0\r\nipython_genutils=0.2.0=pyhd3eb1b0_1\r\njedi=0.18.0=py37haa95532_1\r\njinja2=2.11.2=pyhd3eb1b0_0\r\njoblib=1.0.0=pyhd3eb1b0_0\r\njpeg=9b=hb83a4c4_2\r\njson5=0.9.5=py_0\r\njsonschema=3.2.0=py_2\r\njupyter_client=6.1.7=py_0\r\njupyter_core=4.7.0=py37haa95532_0\r\njupyterlab=2.2.6=py_0\r\njupyterlab_pygments=0.1.2=py_0\r\njupyterlab_server=1.2.0=py_0\r\nkaggle=1.5.10=py37h03978a9_0\r\nkeras-applications=1.0.8=py_1\r\nkeras-preprocessing=1.1.0=py_1\r\nkiwisolver=1.3.0=py37hd77b12b_0\r\nlibpng=1.6.37=h2a8f88b_0\r\nlibprotobuf=3.13.0.1=h200bbdf_0\r\nlibsodium=1.0.18=h62dcd97_0\r\nlibtiff=4.1.0=h56a325e_1\r\nlibxgboost=0.90=1\r\nlightgbm=3.1.1=py37hd77b12b_0\r\nlz4-c=1.9.3=h2bbff1b_0\r\nm2w64-gcc-libgfortran=5.3.0=6\r\nm2w64-gcc-libs=5.3.0=7\r\nm2w64-gcc-libs-core=5.3.0=7\r\nm2w64-gmp=6.1.0=2\r\nm2w64-libwinpthread-git=5.0.0.4634.697f757=2\r\nmako=1.1.4=pyhd3eb1b0_0\r\nmarkdown=3.3.3=py37haa95532_0\r\nmarkupsafe=1.1.1=py37hfa6e2cd_1\r\nmatplotlib=3.3.2=haa95532_0\r\nmatplotlib-base=3.3.2=py37hba9282a_0\r\nmistune=0.8.4=py37hfa6e2cd_1001\r\nmkl=2020.2=256\r\nmkl-service=2.3.0=py37h196d8e1_0\r\nmkl_fft=1.2.0=py37h45dec08_0\r\nmkl_random=1.1.1=py37h47e9c7a_0\r\nmsys2-conda-epoch=20160418=1\r\nnbclient=0.5.1=py_0\r\nnbconvert=6.0.7=py37_0\r\nnbformat=5.1.2=pyhd3eb1b0_1\r\nnest-asyncio=1.4.3=pyhd3eb1b0_0\r\nnotebook=6.2.0=py37haa95532_0\r\nnumpy=1.19.2=py37hadc3359_0\r\nnumpy-base=1.19.2=py37ha3acd2a_0\r\noauthlib=3.1.0=py_0\r\nolefile=0.46=py37_0\r\nopenssl=1.1.1i=h2bbff1b_0\r\nopt_einsum=3.1.0=py_0\r\noptuna=2.4.0=pyhd8ed1ab_0\r\npackaging=20.8=pyhd3eb1b0_0\r\npandas=1.2.1=py37hf11a4ad_0\r\npandoc=2.11=h9490d1a_0\r\npandocfilters=1.4.3=py37haa95532_1\r\nparso=0.8.1=pyhd3eb1b0_0\r\npbr=5.5.1=py_0\r\npickleshare=0.7.5=pyhd3eb1b0_1003\r\npillow=8.1.0=py37h4fa10fc_0\r\npip=20.3.3=py37haa95532_0\r\nprettytable=2.0.0=pyhd8ed1ab_0\r\nprometheus_client=0.9.0=pyhd3eb1b0_0\r\nprompt-toolkit=3.0.8=py_0\r\nprotobuf=3.13.0.1=py37ha925a31_1\r\npy-xgboost=0.90=py37_1\r\npyasn1=0.4.8=py_0\r\npyasn1-modules=0.2.8=py_0\r\npycparser=2.20=py_2\r\npygments=2.7.4=pyhd3eb1b0_0\r\npyjwt=1.7.1=py37_0\r\npyopenssl=20.0.1=pyhd3eb1b0_1\r\npyparsing=2.4.7=pyhd3eb1b0_0\r\npyperclip=1.8.0=pyh9f0ad1d_0\r\npyqt=5.9.2=py37h6538335_2\r\npyreadline=2.1=py37_1\r\npyrsistent=0.17.3=py37he774522_0\r\npysocks=1.7.1=py37_1\r\npython=3.7.9=h60c2a47_0\r\npython-dateutil=2.8.1=py_0\r\npython-editor=1.0.4=py_0\r\npython-slugify=4.0.1=py_0\r\npython_abi=3.7=1_cp37m\r\npytz=2020.5=pyhd3eb1b0_0\r\npywin32=227=py37he774522_1\r\npywinpty=0.5.7=py37_0\r\npyyaml=5.4.1=py37h2bbff1b_1\r\npyzmq=20.0.0=py37hd77b12b_1\r\nqt=5.9.7=vc14h73c81de_0\r\nrequests=2.25.1=pyhd3eb1b0_0\r\nrequests-oauthlib=1.3.0=py_0\r\nrsa=4.7=pyhd3eb1b0_1\r\nscikit-learn=0.23.2=py37h47e9c7a_0\r\nscipy=1.5.2=py37h9439919_0\r\nsend2trash=1.5.0=pyhd3eb1b0_1\r\nsetuptools=51.3.3=py37haa95532_4\r\nsip=4.19.8=py37h6538335_0\r\nsix=1.15.0=py37haa95532_0\r\nsqlalchemy=1.3.21=py37h2bbff1b_0\r\nsqlite=3.33.0=h2a8f88b_0\r\nstevedore=3.3.0=py37h03978a9_1\r\ntensorboard=2.3.0=pyh4dce500_0\r\ntensorboard-plugin-wit=1.6.0=py_0\r\ntensorflow=2.3.0=mkl_py37h04bc1aa_0\r\ntensorflow-base=2.3.0=eigen_py37h17acbac_0\r\ntensorflow-estimator=2.3.0=pyheb71bc4_0\r\ntermcolor=1.1.0=py37_1\r\nterminado=0.9.2=py37haa95532_0\r\ntestpath=0.4.4=py_0\r\ntext-unidecode=1.3=py_0\r\nthreadpoolctl=2.1.0=pyh5ca1d4c_0\r\ntk=8.6.10=he774522_0\r\ntornado=6.1=py37h2bbff1b_0\r\ntqdm=4.55.1=pyhd3eb1b0_0\r\ntraitlets=5.0.5=py_0\r\ntyping=3.7.4.3=py37_0\r\ntyping_extensions=3.7.4.3=py_0\r\nunidecode=1.1.2=pyhd3eb1b0_0\r\nurllib3=1.24.3=py37_0\r\nvc=14.2=h21ff451_1\r\nvs2015_runtime=14.27.29016=h5e58377_2\r\nwcwidth=0.2.5=py_0\r\nwebencodings=0.5.1=py37_1\r\nwerkzeug=1.0.1=py_0\r\nwheel=0.36.2=pyhd3eb1b0_0\r\nwin_inet_pton=1.1.0=py37haa95532_0\r\nwincertstore=0.2=py37_0\r\nwinpty=0.4.3=4\r\nwrapt=1.12.1=py37he774522_1\r\nxz=5.2.5=h62dcd97_0\r\nyaml=0.2.5=he774522_0\r\nzeromq=4.3.3=ha925a31_3\r\nzipp=3.4.0=pyhd3eb1b0_0\r\nzlib=1.2.11=h62dcd97_4\r\nzstd=1.4.5=h04227a9_0\r\n\r\n# Execution environment\r\n- Optuna version: 2.4.0\r\n- Python version: 3.7\r\n- OS: Windows10 Miniconda3\r\n\r\n\r\nThank you all.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2256/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2256/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2247", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2247/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2247/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2247/events", "html_url": "https://github.com/optuna/optuna/issues/2247", "id": 790749786, "node_id": "MDU6SXNzdWU3OTA3NDk3ODY=", "number": 2247, "title": "`MOTPESampler` raises `ValueError` when it solves a simple knapsack problem", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2021-01-21T06:46:03Z", "updated_at": "2021-01-28T02:20:11Z", "closed_at": "2021-01-28T02:20:11Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "## Expected behavior\r\n\r\nWhen I tried to solve a simplified multi-objective knapsack problem using `MOTPE`, I got `ValueError`. I think it should handle this problem or show a more user-friendly error message.\r\n\r\nThe problem is defined as follows:\r\n```python\r\nimport numpy as np\r\n\r\nimport optuna\r\n\r\n\r\ndef create_knapsack(n_items, n_knapsack, seed):\r\n    rng = np.random.RandomState(seed=seed)\r\n    profits = rng.randint(10, 101, size=(n_knapsack, n_items))\r\n    return profits\r\n\r\n\r\ndef knapsack(trial, profits):\r\n    p0, p1 = 0, 0\r\n    for i, p in enumerate(profits.tolist()):\r\n        x = trial.suggest_categorical(f\"x_{i}\", (0, 1))\r\n        p0 += p[0] * x\r\n        p1 += p[1] * x\r\n\r\n    return p0, p1\r\n\r\nprofits = create_knapsack(20, 2, 1)\r\nobjective = lambda t: knapsack(t, profits)\r\n```\r\n\r\n## Environment\r\n\r\n- Optuna version: v2.4.0\r\n- Python version: Python 3.6 (Google Colab)\r\n- OS: N/A (Google Colab)\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```console\r\n[W 2021-01-21 06:35:39,582] Trial 20 failed because of the following error: ValueError('pvals < 0, pvals > 1 or pvals contains NaNs',)\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.6/dist-packages/optuna/_optimize.py\", line 198, in _run_trial\r\n    value_or_values = func(trial)\r\n  File \"<ipython-input-3-7aaa3bf88873>\", line 7, in <lambda>\r\n    objective = lambda t: knapsack(t, profits)\r\n  File \"<ipython-input-2-d1a010db23b5>\", line 15, in knapsack\r\n    x = trial.suggest_categorical(f\"x_{i}\", (0, 1))\r\n  File \"/usr/local/lib/python3.6/dist-packages/optuna/trial/_trial.py\", line 505, in suggest_categorical\r\n    return self._suggest(name, CategoricalDistribution(choices=choices))\r\n  File \"/usr/local/lib/python3.6/dist-packages/optuna/trial/_trial.py\", line 717, in _suggest\r\n    study, trial, name, distribution\r\n  File \"/usr/local/lib/python3.6/dist-packages/optuna/samplers/_tpe/multi_objective_sampler.py\", line 208, in sample_independent\r\n    study, trial, param_distribution, below_param_values, above_param_values\r\n  File \"/usr/local/lib/python3.6/dist-packages/optuna/samplers/_tpe/multi_objective_sampler.py\", line 476, in _sample_mo_categorical_index\r\n    samples_below = self._sample_from_categorical_dist(weighted_below, size)\r\n  File \"/usr/local/lib/python3.6/dist-packages/optuna/samplers/_tpe/sampler.py\", line 628, in _sample_from_categorical_dist\r\n    sample = self._rng.multinomial(n=1, pvals=probabilities, size=n_draws)\r\n  File \"mtrand.pyx\", line 4212, in numpy.random.mtrand.RandomState.multinomial\r\n  File \"_common.pyx\", line 338, in numpy.random._common.check_array_constraint\r\nValueError: pvals < 0, pvals > 1 or pvals contains NaNs\r\n```\r\n\r\n## Steps to reproduce\r\n\r\nPlease refer to this [notebook](https://colab.research.google.com/drive/1dufGlGX_TIUOdpIQrz8Usnfl52BMwoKA?usp=sharing).\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2247/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2247/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2242", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2242/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2242/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2242/events", "html_url": "https://github.com/optuna/optuna/issues/2242", "id": 789696995, "node_id": "MDU6SXNzdWU3ODk2OTY5OTU=", "number": 2242, "title": "Some categorical ticks are plotted as float numbers with `optuna.visualization.plot_contour`", "user": {"login": "g-votte", "id": 1061922, "node_id": "MDQ6VXNlcjEwNjE5MjI=", "avatar_url": "https://avatars.githubusercontent.com/u/1061922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/g-votte", "html_url": "https://github.com/g-votte", "followers_url": "https://api.github.com/users/g-votte/followers", "following_url": "https://api.github.com/users/g-votte/following{/other_user}", "gists_url": "https://api.github.com/users/g-votte/gists{/gist_id}", "starred_url": "https://api.github.com/users/g-votte/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/g-votte/subscriptions", "organizations_url": "https://api.github.com/users/g-votte/orgs", "repos_url": "https://api.github.com/users/g-votte/repos", "events_url": "https://api.github.com/users/g-votte/events{/privacy}", "received_events_url": "https://api.github.com/users/g-votte/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-01-20T06:56:23Z", "updated_at": "2021-02-16T22:24:46Z", "closed_at": "2021-02-16T22:24:45Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "With `optuna.visualization.plot_contour`, some categorical ticks are shown as float numbers. \r\n\r\n## Environment\r\n\r\n- Optuna version: 2.4.0\r\n- Python version: 3.7.9\r\n\r\n## Reproducible examples\r\n\r\nRun the following code:\r\n```python\r\nimport optuna\r\n\r\ndef objective(trial):\r\n    trial.suggest_categorical(\"a\", [\"one\", \"two\", \"three\"])\r\n    trial.suggest_categorical(\"b\", [\"eins\", \"zwei\", \"drei\"])\r\n    trial.suggest_categorical(\"c\", [\"uno\", \"dos\", \"tres\"])\r\n    return 0\r\n\r\nstudy = optuna.create_study()\r\nstudy.optimize(objective, n_trials=50)\r\n\r\noptuna.visualization.plot_contour(study)\r\n```\r\n\r\n## Current behavior\r\nThe following figure shows the output of the repro example. Some ticks are not shown as categorical values. For example the values of `a` in the vertical axis and those of `a` `c` in the horizontal axis are float numbers.\r\n\r\n![image](https://user-images.githubusercontent.com/1061922/105135223-02996880-5b33-11eb-8658-cd54e6fde1b9.png)\r\n\r\n## Expected behavior\r\nAll categorical parameters are shown with their categorical labels.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2242/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2242/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2235", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2235/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2235/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2235/events", "html_url": "https://github.com/optuna/optuna/issues/2235", "id": 788939305, "node_id": "MDU6SXNzdWU3ODg5MzkzMDU=", "number": 2235, "title": "Optuna does not overwrite a suggested value by another following suggestion", "user": {"login": "ZumbiAzul", "id": 3943327, "node_id": "MDQ6VXNlcjM5NDMzMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/3943327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ZumbiAzul", "html_url": "https://github.com/ZumbiAzul", "followers_url": "https://api.github.com/users/ZumbiAzul/followers", "following_url": "https://api.github.com/users/ZumbiAzul/following{/other_user}", "gists_url": "https://api.github.com/users/ZumbiAzul/gists{/gist_id}", "starred_url": "https://api.github.com/users/ZumbiAzul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ZumbiAzul/subscriptions", "organizations_url": "https://api.github.com/users/ZumbiAzul/orgs", "repos_url": "https://api.github.com/users/ZumbiAzul/repos", "events_url": "https://api.github.com/users/ZumbiAzul/events{/privacy}", "received_events_url": "https://api.github.com/users/ZumbiAzul/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-01-19T11:22:43Z", "updated_at": "2021-06-01T23:21:29Z", "closed_at": "2021-06-01T23:21:29Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- How to make optuna suggest different values (i.e. overwrite them) few times in a row? -->\r\n\r\nHere is the code example:\r\n```\r\nimport optuna\r\n\r\ndef objective(trial):\r\n    i=0\r\n    while i < 5:\r\n        x = trial.suggest_uniform('x', -10, 10)\r\n        c = trial.suggest_categorical('c',['dave','masha'])\r\n        print('x =',x,'; c =',c)\r\n        i +=1\r\n    return (x - 2) ** 2\r\n\r\nstudy = optuna.create_study()\r\nstudy.optimize(objective, n_trials=1)\r\n```\r\n\r\nWhen I run it I get this:\r\n```\r\n[I 2021-01-18 15:54:35,991] A new study created in memory with name: no-name-dede52a4-81d4-494d-9461-79d6bc45092c\r\n[I 2021-01-18 15:54:35,993] Trial 0 finished with value: 1.1393024707748967 and parameters: {'x': 0.9326188727662004, 'c': 'dave'}. Best is trial 0 with value: 1.1393024707748967.\r\nx = 0.9326188727662004 ; c = dave\r\nx = 0.9326188727662004 ; c = dave\r\nx = 0.9326188727662004 ; c = dave\r\nx = 0.9326188727662004 ; c = dave\r\nx = 0.9326188727662004 ; c = dave\r\n```\r\nAs you see, `trial` somehow sticks to the value it initially suggested.\r\nIt would be more natural if `trial` suggested new value each time `trial.suggest...` is called. It is also very handy when building up a neural network architecture, and in cases when a suggested parameter does not satisfy a certain condition, so another suggestion is required.\r\n\r\nI have also posted this question on [StackOverflow](https://stackoverflow.com/questions/65777040/how-to-make-optuna-suggest-different-values-few-times-in-a-row-and-use-only-th).", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2235/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2235/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2233", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2233/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2233/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2233/events", "html_url": "https://github.com/optuna/optuna/issues/2233", "id": 788734456, "node_id": "MDU6SXNzdWU3ODg3MzQ0NTY=", "number": 2233, "title": "Call base sampler's `after_trial`", "user": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}, {"id": 2107128673, "node_id": "MDU6TGFiZWwyMTA3MTI4Njcz", "url": "https://api.github.com/repos/optuna/optuna/labels/no-stale", "name": "no-stale", "color": "BBBBBB", "default": false, "description": "Exempt from stale bot"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-01-19T06:04:29Z", "updated_at": "2021-03-10T09:56:59Z", "closed_at": "2021-03-10T09:56:59Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "## Expected behavior\r\n\r\nA sampler may hold a different sampler object to which suggestions are fallen back. E.g. `TPESampler` falls back to the `RandomSampler` for the first few trials. (At least) When a fallback occurs, the `after_trial` method of that different sampler should be called. \r\n\r\n### Samplers\r\n\r\n- [x]  `PartialFixedSampler` #2209\r\n- [x]   `CmaEsSampler` #2359 \r\n- [x]   `PyCmaEsampler` #2365 \r\n- [x]  `SkoptSampler` #2372 \r\n- [x]   `BoTorchSampler` #2372  \r\n- [x]  `TPESampler` #2376 \r\n- [x]   `NSGAIISampler` #2436 \r\n- [x]  `MOTPESampler` #2425 \r\n\r\nNote that while some samplers allow users to inject arbitrary samplers at construction, some internally creates a `RandomSampler` instance without allowing the user to specify which. The `RandomSampler` does currently not implement `after_trial` but I would suggest covering these cases as well. It boils down to a `pass` so we shouldn't have to worry about any performance impacts, and we'll guard ourselves against future changes to the `RandomSampler` (although not that likely) or if the hard-coded sampler changes.\r\n\r\n## Steps to reproduce\r\n\r\n1.  Run `Study.optimize` with any of the above samplers.\r\n2. Notice that the `after_trial` method of the alternative sampler held by the above sampler is not called.\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\nimport optuna\r\nfrom optuna import samplers\r\n\r\n\r\nclass MySampler(samplers.RandomSampler):\r\n    def after_trial(self, *args, **kwargs):\r\n        assert False  # This line is never invoked in master, but it should.\r\n\r\n\r\nsampler = optuna.samplers.CmaEsSampler(\r\n    n_startup_trials=3,\r\n    independent_sampler=MySampler(),\r\n)\r\nstudy = optuna.create_study(sampler=sampler)\r\nstudy.optimize(lambda _: 1.0, n_trials=3)\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2233/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2233/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2227", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2227/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2227/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2227/events", "html_url": "https://github.com/optuna/optuna/issues/2227", "id": 788518552, "node_id": "MDU6SXNzdWU3ODg1MTg1NTI=", "number": 2227, "title": "`study.trials_dataframe` call fails for multi-objective studies", "user": {"login": "blaney83", "id": 42789727, "node_id": "MDQ6VXNlcjQyNzg5NzI3", "avatar_url": "https://avatars.githubusercontent.com/u/42789727?v=4", "gravatar_id": "", "url": "https://api.github.com/users/blaney83", "html_url": "https://github.com/blaney83", "followers_url": "https://api.github.com/users/blaney83/followers", "following_url": "https://api.github.com/users/blaney83/following{/other_user}", "gists_url": "https://api.github.com/users/blaney83/gists{/gist_id}", "starred_url": "https://api.github.com/users/blaney83/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/blaney83/subscriptions", "organizations_url": "https://api.github.com/users/blaney83/orgs", "repos_url": "https://api.github.com/users/blaney83/repos", "events_url": "https://api.github.com/users/blaney83/events{/privacy}", "received_events_url": "https://api.github.com/users/blaney83/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-01-18T20:06:25Z", "updated_at": "2021-01-27T13:12:37Z", "closed_at": "2021-01-27T13:11:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "When using the new multi-objective study framework in v2.4.0 (`optuna.create_study(..., directions=[...])`), calling the `trials_dataframe` message raises an exception caused by some incorrect column spec type comparison in the _dataframe framework. It appears the column aggregation for contains a bug when used with multiple objectives, which adds an extra `values` Tuple to the `values` Set during the initial mapping of `'value' -> 'values'` for a multi-objective study.\r\n\r\n## Expected behavior\r\n\r\nAccessing the `trials_dataframe` method of a study works the same for both single and multi-objective studies.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.3.0 -> 2.4.0\r\n- Python version: 3.8\r\n- OS: Ubuntu 20.04.1, Linux Kernel v5.4.0-56\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"optuna_vis.py\", line 12, in <module>\r\n    study_df = study.trials_dataframe()\r\n  File \"/home/user.name/anaconda3/lib/python3.8/site-packages/optuna/study.py\", line 499, in trials_dataframe\r\n    return _trials_dataframe(self, attrs, multi_index)\r\n  File \"/home/user.name/anaconda3/lib/python3.8/site-packages/optuna/_dataframe.py\", line 80, in _trials_dataframe\r\n    columns: List[Tuple[str, str]] = sum(\r\n  File \"/home/user.name/anaconda3/lib/python3.8/site-packages/optuna/_dataframe.py\", line 81, in <genexpr>\r\n    (sorted(column_agg[k]) for k in attrs if k in column_agg), []\r\nTypeError: '<' not supported between instances of 'str' and 'int'\r\n```\r\n\r\nBy inspecting the `attr` field in the `_trials_dataframe` method (line 23, _dataframe.py), reveals an extra `values` item:\r\n\r\n```\r\n{'number': {('number', '')}, 'values': {('values', 1), ('values', ''), ('values', 0), ('values', 3), ('values', 2)}, 'datetime_start': {('datetime_start', '')}, 'datetime_complete': {('datetime_complete', '')}, 'duration': {('duration', '')}, 'params': {(<param_tuples>), ...}, 'user_attrs': {('user_attrs', 'total_x'), ('user_attrs', 'total_y'), ('user_attrs', '_time_'), ('user_attrs', 'value_total')}, 'system_attrs': {('system_attrs', 'nsga2:generation')}, 'state': {('state', '')}}\r\n```\r\n\r\nFor context, I have defined 4 objectives in this study. After the first trial, there appears this `('values', '')` anomaly which causes the above exception.\r\n\r\n## Steps to reproduce\r\n\r\n1. Create a MPO study with 4 objectives.\r\n2. Start your study and after at least 2 trials, try to call the `study.trials_dataframe()` method.\r\n3. The above exception will be raised.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2227/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2227/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2216", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2216/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2216/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2216/events", "html_url": "https://github.com/optuna/optuna/issues/2216", "id": 787717986, "node_id": "MDU6SXNzdWU3ODc3MTc5ODY=", "number": 2216, "title": "v2.4.0 DB migration script corrupts saved studies over a certain size", "user": {"login": "blaney83", "id": 42789727, "node_id": "MDQ6VXNlcjQyNzg5NzI3", "avatar_url": "https://avatars.githubusercontent.com/u/42789727?v=4", "gravatar_id": "", "url": "https://api.github.com/users/blaney83", "html_url": "https://github.com/blaney83", "followers_url": "https://api.github.com/users/blaney83/followers", "following_url": "https://api.github.com/users/blaney83/following{/other_user}", "gists_url": "https://api.github.com/users/blaney83/gists{/gist_id}", "starred_url": "https://api.github.com/users/blaney83/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/blaney83/subscriptions", "organizations_url": "https://api.github.com/users/blaney83/orgs", "repos_url": "https://api.github.com/users/blaney83/repos", "events_url": "https://api.github.com/users/blaney83/events{/privacy}", "received_events_url": "https://api.github.com/users/blaney83/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2021-01-17T14:31:01Z", "updated_at": "2021-01-22T02:58:17Z", "closed_at": "2021-01-22T02:58:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "After update to v2.4.0, the DB migration script for migrating table schema from study DB's <2.4.0 (`$ optuna storage upgrade --storage $STORAGE_URL`) corrupts sqlite DB's over a certain size (number of trials).\r\n\r\n## Expected behavior\r\n\r\nThe migration/update to the table schema works fine for smaller tables, so I would expect it to work on larger tables as well. If not, perhaps a warning before it corrupts the db file.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.3.0 -> 2.4.0\r\n- Python version: 3.8\r\n- OS: Ubuntu 20.04.1, Linux Kernel v5.4.0-56\r\n- (Optional) Other libraries and their versions:\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/sqlalchemy/engine/result.py\", line 1284, in fetchall\r\n    l = self.process_rows(self._fetchall_impl())\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/sqlalchemy/engine/result.py\", line 1230, in _fetchall_impl\r\n    return self.cursor.fetchall()\r\nsqlite3.DatabaseError: database disk image is malformed\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/optuna/storages/_rdb/storage.py\", line 51, in _create_scoped_session\r\n    yield session\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/optuna/storages/_rdb/storage.py\", line 980, in _get_trials\r\n    session.query(models.TrialModel)\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/sqlalchemy/orm/query.py\", line 3373, in all\r\n    return list(self)\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/sqlalchemy/orm/loading.py\", line 100, in instances\r\n    cursor.close()\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/sqlalchemy/util/langhelpers.py\", line 68, in __exit__\r\n    compat.raise_(\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/sqlalchemy/util/compat.py\", line 182, in raise_\r\n    raise exception\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/sqlalchemy/orm/loading.py\", line 88, in instances\r\n    post_load.invoke(context, path)\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/sqlalchemy/orm/loading.py\", line 908, in invoke\r\n    loader(context, path, states, self.load_keys, *arg, **kw)\r\n  File \"<string>\", line 1, in <lambda>\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/sqlalchemy/orm/strategies.py\", line 2411, in _load_for_path\r\n    self._load_via_parent(our_states, query_info, q, context)\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/sqlalchemy/orm/strategies.py\", line 2469, in _load_via_parent\r\n    for k, v in itertools.groupby(\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/sqlalchemy/orm/loading.py\", line 100, in instances\r\n    cursor.close()\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/sqlalchemy/util/langhelpers.py\", line 68, in __exit__\r\n    compat.raise_(\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/sqlalchemy/util/compat.py\", line 182, in raise_\r\n    raise exception\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/sqlalchemy/orm/loading.py\", line 76, in instances\r\n    fetch = cursor.fetchall()\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/sqlalchemy/engine/result.py\", line 1288, in fetchall\r\n    self.connection._handle_dbapi_exception(\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/sqlalchemy/engine/base.py\", line 1510, in _handle_dbapi_exception\r\n    util.raise_(\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/sqlalchemy/util/compat.py\", line 182, in raise_\r\n    raise exception\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/sqlalchemy/engine/result.py\", line 1284, in fetchall\r\n    l = self.process_rows(self._fetchall_impl())\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/sqlalchemy/engine/result.py\", line 1230, in _fetchall_impl\r\n    return self.cursor.fetchall()\r\nsqlalchemy.exc.DatabaseError: (sqlite3.DatabaseError) database disk image is malformed\r\n(Background on this error at: http://sqlalche.me/e/13/4xp6)\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"optuna_vis.py\", line 12, in <module>\r\n    x = optuna.visualization.plot_slice(study)\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/optuna/visualization/_slice.py\", line 80, in plot_slice\r\n    return _get_slice_plot(study, params, target, target_name)\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/optuna/visualization/_slice.py\", line 92, in _get_slice_plot\r\n    trials = [trial for trial in study.trials if trial.state == TrialState.COMPLETE]\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/optuna/study.py\", line 150, in trials\r\n    return self.get_trials(deepcopy=True, states=None)\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/optuna/study.py\", line 199, in get_trials\r\n    self._storage.read_trials_from_remote_storage(self._study_id)\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/optuna/storages/_cached_storage.py\", line 397, in read_trials_from_remote_storage\r\n    trials = self._backend._get_trials(\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/optuna/storages/_rdb/storage.py\", line 1015, in _get_trials\r\n    trials = [self._build_frozen_trial_from_trial_model(trial) for trial in trial_models]\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/contextlib.py\", line 131, in __exit__\r\n    self.gen.throw(type, value, traceback)\r\n  File \"/home/<user.name>/anaconda3/lib/python3.8/site-packages/optuna/storages/_rdb/storage.py\", line 69, in _create_scoped_session\r\n    raise optuna.exceptions.StorageInternalError(message) from e\r\noptuna.exceptions.StorageInternalError: An exception is raised during the commit. This typically happens due to invalid data in the commit, e.g. exceeding max length. \r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Run a study with optuna v2.3.0, saving the study to a local sqlite db file\r\n2. Update optuna to v2.4.0\r\n3. Use `$ optuna storage upgrade --storage $STORAGE_URL` to update the study `.db` file schema\r\n4. Attempt to load the study using `optuna.load_study(...)`\r\n5. Over a certain size, the loading fails with the above exception. (I don't know the exact size, but I have one study with ~600 trials which loads fine and one with ~800 trials that doesn't. I imagine it depends on the number of parameters as well, so this likely depends on the HPO being performed)\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2216/reactions", "total_count": 3, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 3}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2216/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2209", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2209/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2209/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2209/events", "html_url": "https://github.com/optuna/optuna/pull/2209", "id": 786468552, "node_id": "MDExOlB1bGxSZXF1ZXN0NTU1MzMyODg4", "number": 2209, "title": "Call base sampler's `after_trial` in `PartialFixedSampler`", "user": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/31", "html_url": "https://github.com/optuna/optuna/milestone/31", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/31/labels", "id": 6287377, "node_id": "MDk6TWlsZXN0b25lNjI4NzM3Nw==", "number": 31, "title": "v2.5.0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 48, "state": "closed", "created_at": "2021-01-08T05:08:34Z", "updated_at": "2021-02-01T06:04:58Z", "due_on": null, "closed_at": "2021-02-01T06:04:58Z"}, "comments": 8, "created_at": "2021-01-15T01:50:00Z", "updated_at": "2021-01-19T06:06:35Z", "closed_at": "2021-01-19T06:06:35Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2209", "html_url": "https://github.com/optuna/optuna/pull/2209", "diff_url": "https://github.com/optuna/optuna/pull/2209.diff", "patch_url": "https://github.com/optuna/optuna/pull/2209.patch", "merged_at": "2021-01-19T06:06:35Z"}, "body": "## Motivations\r\nCurrently, the method of `after_trial` is not implemented for `PartialFixedSampler`. This means the base sampler's `after_trial` is not executed if the sampler is wrapped in `PartialFixedSampler`. For example, in the case of the `GridSampler` with `PartialFixedSampler`, the study is not stopped even if all grids are visited as follows.\r\n\r\n```python\r\nimport optuna\r\n\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_float(\"x\", -10, 10)\r\n    y = trial.suggest_float(\"y\", -10, 10)\r\n    return x ** 2 + y ** 2\r\n\r\n# the number of grids is 4 * 4 = 16\r\nsearch_space = {\"x\": list(range(-10, 10, 5)), \"y\": list(range(-10, 10, 5))}\r\n\r\nstudy0 = optuna.create_study()\r\nstudy0.sampler = optuna.samplers.GridSampler(search_space)\r\nstudy0.optimize(objective, n_trials=100)\r\n\r\nstudy1 = optuna.create_study()\r\nstudy1.sampler = optuna.samplers.PartialFixedSampler(\r\n    fixed_params={}, base_sampler=optuna.samplers.GridSampler(search_space)\r\n)\r\nstudy1.optimize(objective, n_trials=100)\r\n\r\nprint(len(study0.trials))\r\nprint(len(study1.trials))\r\n```\r\n\r\n### Output in Optuna v2.4.0\r\n```\r\n16\r\n100\r\n```\r\n\r\n### Output in this PR\r\n```\r\n16\r\n16\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2209/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2209/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2207", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2207/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2207/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2207/events", "html_url": "https://github.com/optuna/optuna/issues/2207", "id": 785863358, "node_id": "MDU6SXNzdWU3ODU4NjMzNTg=", "number": 2207, "title": "plot_param_importances is portraying parameter importances different from get_param_importances", "user": {"login": "XyDrKRulof", "id": 65008699, "node_id": "MDQ6VXNlcjY1MDA4Njk5", "avatar_url": "https://avatars.githubusercontent.com/u/65008699?v=4", "gravatar_id": "", "url": "https://api.github.com/users/XyDrKRulof", "html_url": "https://github.com/XyDrKRulof", "followers_url": "https://api.github.com/users/XyDrKRulof/followers", "following_url": "https://api.github.com/users/XyDrKRulof/following{/other_user}", "gists_url": "https://api.github.com/users/XyDrKRulof/gists{/gist_id}", "starred_url": "https://api.github.com/users/XyDrKRulof/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/XyDrKRulof/subscriptions", "organizations_url": "https://api.github.com/users/XyDrKRulof/orgs", "repos_url": "https://api.github.com/users/XyDrKRulof/repos", "events_url": "https://api.github.com/users/XyDrKRulof/events{/privacy}", "received_events_url": "https://api.github.com/users/XyDrKRulof/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-01-14T10:18:23Z", "updated_at": "2021-01-14T11:18:34Z", "closed_at": "2021-01-14T10:32:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "(My first issue on an open source GitHub repository)\r\nWhen I am using the function _plot_param_importances(study)_ the plot is displaying different values than the ordered dict received by the function _get_param_importances(study)_.\r\n\r\n## Expected behavior\r\n\r\nI would expect the function _plot_param_importances_ to display values close to those of _get_param_importances_.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.4.0\r\n- Python version: 3.6.9\r\n- OS: Ubuntu 18.04\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n![importance_ddpg](https://user-images.githubusercontent.com/65008699/104577124-661a2680-5659-11eb-8252-fae6d9318756.png)\r\n![Selection_048](https://user-images.githubusercontent.com/65008699/104577139-6a464400-5659-11eb-92fd-f00c5d598153.png)\r\n\r\n![importance_td3](https://user-images.githubusercontent.com/65008699/104577161-703c2500-5659-11eb-9719-816dfbe95688.png)\r\n![image](https://user-images.githubusercontent.com/65008699/104577748-2142bf80-565a-11eb-8137-e2836582115d.png)\r\n\r\n\r\n\r\n## Steps to reproduce\r\n\r\n1. Pretty Print optuna.importance.get_param_importances(study)\r\n2. Plot optuna.visualization.plot_param_importances(study)\r\n3. Compare\r\n\r\n## Reproducible examples\r\n\r\n```python\r\nimportance_dict = optuna.importance.get_param_importances(study)\r\npprint.pprint(importance_dict)\r\nfig = optuna.visualization.plot_param_importances(study)\r\nfig.write_image(f\"images/importances.png\")\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2207/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2207/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2204", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2204/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2204/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2204/events", "html_url": "https://github.com/optuna/optuna/issues/2204", "id": 785644054, "node_id": "MDU6SXNzdWU3ODU2NDQwNTQ=", "number": 2204, "title": "`suggest_float` doesn't finish when `low` and `high` is dynamically determined.", "user": {"login": "azriel1rf", "id": 43790845, "node_id": "MDQ6VXNlcjQzNzkwODQ1", "avatar_url": "https://avatars.githubusercontent.com/u/43790845?v=4", "gravatar_id": "", "url": "https://api.github.com/users/azriel1rf", "html_url": "https://github.com/azriel1rf", "followers_url": "https://api.github.com/users/azriel1rf/followers", "following_url": "https://api.github.com/users/azriel1rf/following{/other_user}", "gists_url": "https://api.github.com/users/azriel1rf/gists{/gist_id}", "starred_url": "https://api.github.com/users/azriel1rf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/azriel1rf/subscriptions", "organizations_url": "https://api.github.com/users/azriel1rf/orgs", "repos_url": "https://api.github.com/users/azriel1rf/repos", "events_url": "https://api.github.com/users/azriel1rf/events{/privacy}", "received_events_url": "https://api.github.com/users/azriel1rf/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-01-14T04:37:56Z", "updated_at": "2021-01-14T04:50:15Z", "closed_at": "2021-01-14T04:50:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n## Expected behavior\r\nfinish\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.3.0\r\n- Python version: 3.8.6\r\n- OS: Windows 10\r\n\r\n## Error messages, stack traces, or logs\r\nnothing\r\n\r\n## Reproducible examples\r\n\r\n```python\r\nimport optuna\r\nimport numpy as np\r\n\r\ndef objective(trial):\r\n    k = 10\r\n    ratios = np.zeros(k)\r\n    \r\n    residual = 1\r\n    for i in range(k - 1):\r\n        ratios[i] = trial.suggest_float(f'ratio_{i}', 0, residual)\r\n        residual -= ratios[i]\r\n        \r\n    ratios[k - 1] = trial.suggest_float(f'ratio_{k - 1}', residual, residual)\r\n    ratios[k - 1] = residual\r\n    return np.log(ratios).sum()\r\n\r\nstudy = optuna.create_study(direction='maximize')\r\nstudy.optimize(objective, n_trials=12)\r\n```\r\n\r\n## Additional context (optional)\r\nWhen `n_trials` is 11, this code works.\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2204/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2204/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2199", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2199/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2199/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2199/events", "html_url": "https://github.com/optuna/optuna/issues/2199", "id": 784924237, "node_id": "MDU6SXNzdWU3ODQ5MjQyMzc=", "number": 2199, "title": "ValueError: CategoricalDistribution does not support dynamic value space.", "user": {"login": "nothingeasy", "id": 19639505, "node_id": "MDQ6VXNlcjE5NjM5NTA1", "avatar_url": "https://avatars.githubusercontent.com/u/19639505?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nothingeasy", "html_url": "https://github.com/nothingeasy", "followers_url": "https://api.github.com/users/nothingeasy/followers", "following_url": "https://api.github.com/users/nothingeasy/following{/other_user}", "gists_url": "https://api.github.com/users/nothingeasy/gists{/gist_id}", "starred_url": "https://api.github.com/users/nothingeasy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nothingeasy/subscriptions", "organizations_url": "https://api.github.com/users/nothingeasy/orgs", "repos_url": "https://api.github.com/users/nothingeasy/repos", "events_url": "https://api.github.com/users/nothingeasy/events{/privacy}", "received_events_url": "https://api.github.com/users/nothingeasy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-01-13T09:10:07Z", "updated_at": "2021-01-16T03:30:56Z", "closed_at": "2021-01-16T03:30:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "trail.suggest_categorical(\"batch_size\", [64, 128])  does not work and raise error;\r\ntrail.suggest_categorical(\"batch_size\", [64, 128,256,512])  work;\r\nI think I do not need to talk more about it , the question is so clear and everyone can reproduce it.\r\nHow can i use different value(no step case) i want  ?", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2199/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2199/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2196", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2196/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2196/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2196/events", "html_url": "https://github.com/optuna/optuna/pull/2196", "id": 784805983, "node_id": "MDExOlB1bGxSZXF1ZXN0NTUzOTM1NTg5", "number": 2196, "title": "Fix the wrong way to set `datetime_start`", "user": {"login": "chenghuzi", "id": 11160442, "node_id": "MDQ6VXNlcjExMTYwNDQy", "avatar_url": "https://avatars.githubusercontent.com/u/11160442?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chenghuzi", "html_url": "https://github.com/chenghuzi", "followers_url": "https://api.github.com/users/chenghuzi/followers", "following_url": "https://api.github.com/users/chenghuzi/following{/other_user}", "gists_url": "https://api.github.com/users/chenghuzi/gists{/gist_id}", "starred_url": "https://api.github.com/users/chenghuzi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chenghuzi/subscriptions", "organizations_url": "https://api.github.com/users/chenghuzi/orgs", "repos_url": "https://api.github.com/users/chenghuzi/repos", "events_url": "https://api.github.com/users/chenghuzi/events{/privacy}", "received_events_url": "https://api.github.com/users/chenghuzi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2021-01-13T05:41:02Z", "updated_at": "2021-01-19T21:21:27Z", "closed_at": "2021-01-19T21:21:27Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2196", "html_url": "https://github.com/optuna/optuna/pull/2196", "diff_url": "https://github.com/optuna/optuna/pull/2196.diff", "patch_url": "https://github.com/optuna/optuna/pull/2196.patch", "merged_at": null}, "body": "<!-- Thank you for creating a pull request! In general, we merge your pull requests after they get two or more approvals. -->\r\n\r\nFixes #2036.\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\nThe current mechanism to set the `datetime_start` of a given trial is to add a time value when creating that trial. However, this could be wrong if the created trial is not the one to be executed right after its creation. The `datetime_start` of these waiting trials won't be updated before and after their delayed execution. For specific example, see [#2306](https://github.com/optuna/optuna/issues/2036).\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\nThe mechanism to initialize `datetime_start` is changed. Now we set the time of trial start when its state changes to `RUNNING`. This ensures the `datetime_start ` to be the moment right before execution. This is implemented in `set_trial_state`.\r\n\r\n\r\n<img width=\"747\" alt=\"Xnip2021-01-13_00-34-10\" src=\"https://user-images.githubusercontent.com/11160442/104410931-5b677080-5537-11eb-84e7-5d4a0782a52b.png\">\r\nTrial 11-20 were appended to the study through `enqueue_trial ` after trial 10 but were executed several minutes later. After change the `datetime_start ` becomes the 2s duration set by the objective function:\r\n\r\n```python\r\ndef objective(trial):\r\n    x = trial.suggest_uniform(\"x\", 0, 10)\r\n    time.sleep(2)\r\n    return x**2\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2196/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2196/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2180", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2180/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2180/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2180/events", "html_url": "https://github.com/optuna/optuna/pull/2180", "id": 780350797, "node_id": "MDExOlB1bGxSZXF1ZXN0NTUwMjU0MTU1", "number": 2180, "title": "Drop unnecessary constraint from upgraded `trial_values` table", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/30", "html_url": "https://github.com/optuna/optuna/milestone/30", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/30/labels", "id": 6049240, "node_id": "MDk6TWlsZXN0b25lNjA0OTI0MA==", "number": 30, "title": "v2.4.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 125, "state": "closed", "created_at": "2020-10-30T04:40:49Z", "updated_at": "2021-01-12T07:33:34Z", "due_on": null, "closed_at": "2021-01-12T07:33:34Z"}, "comments": 4, "created_at": "2021-01-06T09:15:01Z", "updated_at": "2021-02-26T01:37:53Z", "closed_at": "2021-01-07T04:32:50Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2180", "html_url": "https://github.com/optuna/optuna/pull/2180", "diff_url": "https://github.com/optuna/optuna/pull/2180.diff", "patch_url": "https://github.com/optuna/optuna/pull/2180.patch", "merged_at": "2021-01-07T04:32:50Z"}, "body": "## Motivation\r\n\r\nAddresses #2179.\r\n\r\n## Description of the changes\r\n\r\nThis PR removes the `trial_id` from the unique constraint of the `trial_values` table. It is not unique since v2.4.0 because of the support of multi-objective optimization. A pair of `trial_id` and `objective` is the unique key of `trial_values` now.\r\n\r\n## TODO\r\n\r\n- [x] Manual test with MySQL\r\n- [x] Manual test with PostgreSQL\r\n- [x] Manual test with SQLite\r\n\r\nTest for SQLite\r\n\r\n<details>\r\n<summary>Python scripts for tests</summary>\r\n\r\nsingle.py\r\n```python\r\nimport sys\r\nimport optuna\r\n\r\ndef objective(trial):\r\n    return trial.suggest_float(\"x\", 0, 1)\r\n\r\nstudy = optuna.create_study(study_name=sys.argv[1], storage=sys.argv[2], load_if_exists=True)\r\nstudy.optimize(objective, n_trials=1)\r\n```\r\n\r\nmulti.py\r\n```python\r\nimport sys\r\nimport optuna\r\n\r\ndef objective(trial):\r\n    return trial.suggest_float(\"x\", 0, 1), trial.suggest_float(\"y\", 0, 1)\r\n\r\nstudy = optuna.create_study(directions=[\"maximize\", \"minimize\"], study_name=sys.argv[1], storage=sys.argv[2], load_if_exists=True)\r\nstudy.optimize(objective, n_trials=1)\r\n```\r\n\r\n</details>\r\n\r\nTest for MySQL\r\n\r\n```console\r\ndocker run --name mysql -e MYSQL_ROOT_PASSWORD=test -p 3306:3306 -p 33060:33060 -d mysql:8.0.22\r\ndocker run --network host -it --rm mysql:8.0.22  mysql -h 127.0.0.1 -uroot -ptest -e \"create database test_optuna;\"\r\n\r\npip uninstall optuna\r\npip install optuna\r\npython single.py single mysql+pymysql://root:test@localhost:3306/test_optuna\r\npip install git+https://github.com/toshihikoyanase/optuna.git@fix-rdb-upgrade-v2.4.0\r\noptuna storage upgrade --storage mysql+pymysql://root:test@localhost:3306/test_optuna\r\npython multi.py multi mysql+pymysql://root:test@localhost:3306/test_optuna\r\n```\r\n\r\nTest for PostgreSQL\r\n\r\n```console\r\ndocker run -it --rm --name postgres-test -e POSTGRES_PASSWORD=test -p 15432:5432 -d postgres\r\n\r\npip uninstall optuna\r\npip install optuna\r\npython single.py single postgres+psycopg2://postgres:test@localhost:15432/postgres\r\npip install git+https://github.com/toshihikoyanase/optuna.git@fix-rdb-upgrade-v2.4.0\r\noptuna storage upgrade --storage postgres+psycopg2://postgres:test@localhost:15432/postgres\r\npython multi.py multi postgres+psycopg2://postgres:test@localhost:15432/postgres\r\n```\r\n\r\n\r\nTest for SQLite\r\n\r\n```console\r\npip uninstall optuna\r\npip install optuna\r\npython single.py single sqlite:///example.db\r\npip install git+https://github.com/toshihikoyanase/optuna.git@fix-rdb-upgrade-v2.4.0\r\noptuna storage upgrade --storage sqlite:///example.db\r\npython multi.py multi sqlite:///example.db\r\n```\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2180/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2180/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2179", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2179/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2179/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2179/events", "html_url": "https://github.com/optuna/optuna/issues/2179", "id": 780269997, "node_id": "MDU6SXNzdWU3ODAyNjk5OTc=", "number": 2179, "title": "Cannot run multi-objective optimization after upgrading storage from v2.3.0 to master.", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-01-06T08:26:51Z", "updated_at": "2021-01-07T04:36:37Z", "closed_at": "2021-01-07T04:36:37Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "## Expected behavior\r\n\r\nWhen I upgrade the Optuna storage in MySQL 8.0 from v2.3.0 to the current master, I couldn't execute the multi-objective optimization due to the integrity error of `trial_id`. The single objective optimization can be executed even after the upgrade, so I think the unique constraint of `trial_id` is not set appropriately. \r\n\r\nOptimization should be executed after upgrading the storage.\r\n\r\n## Environment\r\n\r\n- Optuna version: v2.3.0 to master\r\n- Python version: 3.7.7\r\n- OS: macOS 10.15.7\r\n- (Optional) Other libraries and their versions:\r\n  - MySQL==8.0.22\r\n  - PyMySQL==0.9.3\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```console\r\nsqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, \"Duplicate entry '4' for key 'trial_values.trial_id'\")\r\n[SQL: INSERT INTO trial_values (trial_id, objective, value) VALUES (%(trial_id)s, %(objective)s, %(value)s)]\r\n[parameters: {'trial_id': 4, 'objective': 1, 'value': 0.18631845259151747}]\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Launch MySQL server\r\n2. Run optimization with optuna==v2.3.0\r\n3. Upgrade storage using optuna@master\r\n4. Run multi-objective optimization with optuna@master\r\n\r\n## Reproducible examples (optional)\r\n\r\n1. Launch MySQL server\r\n```console\r\n$ docker run --name mysql -e MYSQL_ROOT_PASSWORD=test -p 3306:3306 -p 33060:33060 -d mysql:8.0.22\r\n$ docker run --network host -it --rm mysql:8.0.22  mysql -h 127.0.0.1 -uroot -ptest -e \"create database migration_optuna;\"\r\n```\r\n\r\n2. Run optimization with optuna==v2.3.0\r\n```python\r\nimport optuna\r\n\r\ndef objective(trial):\r\n    return trial.suggest_float(\"x\", 0, 1)\r\n\r\nstudy = optuna.create_study(study_name=\"single\", storage=\"mysql+pymysql://root:test@localhost:3306/migration_optuna\", load_if_exists=True)\r\nstudy.optimize(objective, n_trials=1)\r\n```\r\n\r\n3. Upgrade storage using optuna@master\r\n```console\r\n$ optuna storage upgrade --storage mysql+pymysql://root:test@localhost:3306/migration_optuna\r\n```\r\n\r\n4. Run multi-objective optimization with optuna@master\r\n```python\r\nimport optuna\r\n\r\ndef objective(trial):\r\n    return trial.suggest_float(\"x\", 0, 1), trial.suggest_float(\"y\", 0, 1)\r\n\r\nstudy = optuna.create_study(directions=[\"maximize\", \"minimize\"], study_name=\"bi\", storage=\"mysql+pymysql://root:test@localhost:3306/migration_optuna\", load_if_exists=True)\r\nstudy.optimize(objective, n_trials=1)\r\n```\r\n\r\n## Additional context (optional)\r\n\r\nThe trial_values table of upgraded RDB has `trial_id` as a unique key in addition to the combined unique key of `trial_id` and `objective`.\r\n\r\n>   UNIQUE KEY `trial_id` (`trial_id`),\r\n>   UNIQUE KEY `uq_trial_values_trial_id_objective` (`trial_id`,`objective`),\r\n\r\nThis is because the upgrade script simply adds the combined unique constraint without removing the existing unique constraint. I guess we need to remove it.\r\n\r\nhttps://github.com/optuna/optuna/blob/add10e9fc5d734915c1cbe2d872db25c8297837c/optuna/storages/_rdb/alembic/versions/v2.4.0.a.py#L139-L146\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2179/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2179/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2169", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2169/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2169/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2169/events", "html_url": "https://github.com/optuna/optuna/issues/2169", "id": 778683943, "node_id": "MDU6SXNzdWU3Nzg2ODM5NDM=", "number": 2169, "title": "`nan` handling in `trial.report` and multi-objective study.", "user": {"login": "ytsmiling", "id": 20983513, "node_id": "MDQ6VXNlcjIwOTgzNTEz", "avatar_url": "https://avatars.githubusercontent.com/u/20983513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ytsmiling", "html_url": "https://github.com/ytsmiling", "followers_url": "https://api.github.com/users/ytsmiling/followers", "following_url": "https://api.github.com/users/ytsmiling/following{/other_user}", "gists_url": "https://api.github.com/users/ytsmiling/gists{/gist_id}", "starred_url": "https://api.github.com/users/ytsmiling/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ytsmiling/subscriptions", "organizations_url": "https://api.github.com/users/ytsmiling/orgs", "repos_url": "https://api.github.com/users/ytsmiling/repos", "events_url": "https://api.github.com/users/ytsmiling/events{/privacy}", "received_events_url": "https://api.github.com/users/ytsmiling/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562439, "node_id": "MDU6TGFiZWwxOTQ3NTYyNDM5", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.study", "name": "optuna.study", "color": "1c659e", "default": false, "description": "Related to the `optuna.study` submodule. This is automatically labeled by github-actions."}, {"id": 1947562567, "node_id": "MDU6TGFiZWwxOTQ3NTYyNTY3", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.trial", "name": "optuna.trial", "color": "1c659e", "default": false, "description": "Related to the `optuna.trial` submodule. This is automatically labeled by github-actions."}, {"id": 2107128673, "node_id": "MDU6TGFiZWwyMTA3MTI4Njcz", "url": "https://api.github.com/repos/optuna/optuna/labels/no-stale", "name": "no-stale", "color": "BBBBBB", "default": false, "description": "Exempt from stale bot"}, {"id": 3264287142, "node_id": "MDU6TGFiZWwzMjY0Mjg3MTQy", "url": "https://api.github.com/repos/optuna/optuna/labels/v3", "name": "v3", "color": "339FD7", "default": false, "description": "Issue/PR for Optuna version 3."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2021-01-05T07:42:48Z", "updated_at": "2022-06-24T05:15:52Z", "closed_at": "2022-06-24T05:15:51Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "## Expected behavior\r\n\r\n* ``trial.report()`` accepts ``nan``\r\n* Return value of multi-objective study accepts ``nan``\r\n* Multi-objective study mark trials as ``FAILED`` when one or more return values are ``nan``.\r\n\r\n## Bugs\r\n\r\n1. ``trial.report`` fails when the value is ``nan`` when combined with MySQL backend.\r\n2. Multi-objective trial also fails on ``report`` with ``nan`` value when combined with MySQL backend.\r\n3. Multi-objective study internally depends on `trial.report` and thus error occurs when one or more return value is ``nan``.\r\n4. With in-memory db, multi-objective study registers trials with ``nan`` return value as ``COMPLETED`` trial.\r\n\r\n## Notes\r\n\r\nI think whether ``trial.report`` should accept ``nan`` or not requires discussion.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.3.0\r\n- Python version: 3.8\r\n- OS: macOS Catalina\r\n- PyMySQL version: 0.10.1\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n(When called `trial.report` with ``nan`` value w/ MySQL backend.)\r\n```\r\nProgrammingError: (pymysql.err.ProgrammingError) nan can not be used with MySQL\r\n[SQL: INSERT INTO trial_values (trial_id, step, value) VALUES (%(trial_id)s, %(step)s, %(value)s)]\r\n[parameters: {'trial_id': 34849, 'step': 1, 'value': nan}]\r\n(Background on this error at: http://sqlalche.me/e/13/f405)\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. ``trial.report(float(np.nan), 1)``\r\n\r\n## Additional context (optional)\r\n\r\nSingle-objective study accepts nan as the return value and marks it as `failed`. This is achieved in the following.\r\nhttps://github.com/optuna/optuna/blob/4b4891dee27fb3fac2cb21a532e5a6ba2dd5b6aa/optuna/_optimize.py#L305\r\n\r\nWith in-memory db, `trial.report` accepts ``nan``.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2169/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2169/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2151", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2151/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2151/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2151/events", "html_url": "https://github.com/optuna/optuna/issues/2151", "id": 774308016, "node_id": "MDU6SXNzdWU3NzQzMDgwMTY=", "number": 2151, "title": "Trying to resume study throws ValueError: No trials are completed yet", "user": {"login": "yonatansc97", "id": 52149642, "node_id": "MDQ6VXNlcjUyMTQ5NjQy", "avatar_url": "https://avatars.githubusercontent.com/u/52149642?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yonatansc97", "html_url": "https://github.com/yonatansc97", "followers_url": "https://api.github.com/users/yonatansc97/followers", "following_url": "https://api.github.com/users/yonatansc97/following{/other_user}", "gists_url": "https://api.github.com/users/yonatansc97/gists{/gist_id}", "starred_url": "https://api.github.com/users/yonatansc97/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yonatansc97/subscriptions", "organizations_url": "https://api.github.com/users/yonatansc97/orgs", "repos_url": "https://api.github.com/users/yonatansc97/repos", "events_url": "https://api.github.com/users/yonatansc97/events{/privacy}", "received_events_url": "https://api.github.com/users/yonatansc97/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-12-24T10:03:32Z", "updated_at": "2021-01-12T10:09:40Z", "closed_at": "2021-01-12T10:09:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi All,\r\n\r\nI created a study on a remote machine, which ran for a couple of trials before it crashed as a result of connectivity issues.\r\nI tried to resume this sudy as described here, using the joblib and pickle library: https://optuna.readthedocs.io/en/stable/faq.html.\r\nThis throws the following error:\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/yonatan/Desktop/yonas_code/dcnn/main.py\", line 99, in <module>\r\n    optuna_study(resume='24-12-20 11 02 12study.pkl')\r\n  File \"/home/yonatan/Desktop/yonas_code/dcnn/main.py\", line 48, in optuna_study\r\n    print(' Value: ', study.best_trial.value)\r\n  File \"/home/yonatan/anaconda3/envs/yonatan_env/lib/python3.8/site-packages/optuna/study.py\", line 72, in best_trial\r\n    return copy.deepcopy(self._storage.get_best_trial(self._study_id))\r\n  File \"/home/yonatan/anaconda3/envs/yonatan_env/lib/python3.8/site-packages/optuna/storages/_in_memory.py\", line 275, in get_best_trial\r\n    raise ValueError(\"No trials are completed yet.\")\r\nValueError: No trials are completed yet.\r\n```\r\n\r\n## Expected behavior\r\n\r\nThe expected behaviour is that optuna would resume the optimization of th ovjective function, and consider the previous trials as a part of the study.\r\nNote: There has been already 3 trials that finished, I confirmed so by visualizing them in TensorBoard.\r\n![image](https://user-images.githubusercontent.com/52149642/103081135-01caf080-45e0-11eb-9d77-09d4c492cb85.png)\r\n\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.3.0\r\n- Python version: 3.8.0\r\n- OS: Ubuntu 18.04\r\n- Pytorch: 1.7.1\r\n\r\n## Code that I wrote\r\n\r\nI have a feeling I'm not using optuna correctly, so I'm attaching the code I wrote for the main.py\r\nNote that the first run was with ```resume=False```, and only then do I use the ```resume='24-12-20 ...'```.\r\n\r\n```\r\ndef objective(trial):\r\n    # PyTorch Lightning will try to restore model parameters from previous trials if checkpoint\r\n    # filenames match. Therefore, the filenames for each trial must be made unique.\r\n    checkpoint_callback = pl.callbacks.ModelCheckpoint(\r\n        Path('./model_dirs') / f'trial_{trial.number}',\r\n        monitor='val_acc',\r\n    )\r\n\r\n    dm = HoobariDataModule(trial=trial)\r\n\r\n    trainer = pl.Trainer(\r\n        log_every_n_steps=20,\r\n        logger=TensorBoardLogger('optuna_241220_tb_logs',\r\n                                 name='',\r\n                                 version=f'trial_{trial.number}',\r\n                                 default_hp_metric=False),\r\n        checkpoint_callback=checkpoint_callback,\r\n        max_epochs=3,\r\n        num_sanity_val_steps=0,\r\n        check_val_every_n_epoch=1,\r\n        gpus=1 if torch.cuda.is_available() else None,\r\n        # callbacks=[metrics_callback,\r\n        #            PyTorchLightningPruningCallback(trial, monitor='val_acc')]\r\n    )\r\n\r\n    model = resnet.resnet34(trial=trial)\r\n    trainer.fit(model, dm)\r\n\r\n    return model.val_metrics_track[-1][\"val_acc\"].item()\r\n\r\n\r\ndef optuna_study(resume=False):\r\n    if resume:\r\n        study = joblib.load(resume)\r\n        print('Best trial until now:')\r\n        print(' Value: ', study.best_trial.value)\r\n        print(' Params: ')\r\n        for key, value in study.best_trial.params.items():\r\n            print(f'    {key}: {value}')\r\n    else:\r\n        study = optuna.create_study(direction='maximize',\r\n                                    pruner=optuna.pruners.MedianPruner())\r\n        joblib.dump(study, datetime.now().strftime('%d-%m-%y %H %M %S') +\r\n                    'study.pkl')\r\n    study.optimize(objective, timeout=60 * 60 * 24)\r\n\r\n    print(\"Number of finished trials: {}\".format(len(study.trials)))\r\n\r\n    print(\"Best trial:\")\r\n    trial = study.best_trial\r\n\r\n    print(\"  Value: {}\".format(trial.value))\r\n\r\n    print(\"  Params: \")\r\n    for key, value in trial.params.items():\r\n        print(\"    {}: {}\".format(key, value))\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    optuna_study(resume='24-12-20 11 02 12study.pkl')\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2151/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2151/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2146", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2146/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2146/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2146/events", "html_url": "https://github.com/optuna/optuna/issues/2146", "id": 773564830, "node_id": "MDU6SXNzdWU3NzM1NjQ4MzA=", "number": 2146, "title": "Old style callback is deprecated (XGBoost 1.3.1)", "user": {"login": "GuidoBartoli", "id": 16103676, "node_id": "MDQ6VXNlcjE2MTAzNjc2", "avatar_url": "https://avatars.githubusercontent.com/u/16103676?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuidoBartoli", "html_url": "https://github.com/GuidoBartoli", "followers_url": "https://api.github.com/users/GuidoBartoli/followers", "following_url": "https://api.github.com/users/GuidoBartoli/following{/other_user}", "gists_url": "https://api.github.com/users/GuidoBartoli/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuidoBartoli/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuidoBartoli/subscriptions", "organizations_url": "https://api.github.com/users/GuidoBartoli/orgs", "repos_url": "https://api.github.com/users/GuidoBartoli/repos", "events_url": "https://api.github.com/users/GuidoBartoli/events{/privacy}", "received_events_url": "https://api.github.com/users/GuidoBartoli/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-12-23T07:58:15Z", "updated_at": "2020-12-23T08:50:38Z", "closed_at": "2020-12-23T08:50:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "While using the `optuna.integration` module to activate pruning via callback, the latest version of XGBoost gives a warning about the deprecation of the supplied callback style.\r\n\r\n## Expected behavior\r\n\r\nDespite displaying this message, the pruning procedure seems to be enabled anyway, but since it is deprecated I think it is not guaranteed to work in the future.\r\n\r\n## Environment\r\n\r\n- Optuna version: **2.3.0**\r\n- Python version: **3.8.5**\r\n- OS: **Linux Mint 20** (based on Ubuntu 20.04 with kernel 5.4.0)\r\n- Other libraries and their versions: **XGBoost 1.3.1**\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nUserWarning: Old style callback is deprecated.  See: https://xgboost.readthedocs.io/en/latest/python/callbacks.html\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n- Run the code of the official [example](https://github.com/optuna/optuna/blob/master/examples/pruning/xgboost_integration.py)\r\n\r\n## Reproducible examples\r\n\r\n```python xgboost_integration.py```\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2146/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2146/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2101", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2101/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2101/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2101/events", "html_url": "https://github.com/optuna/optuna/issues/2101", "id": 762908260, "node_id": "MDU6SXNzdWU3NjI5MDgyNjA=", "number": 2101, "title": "study.best_trial gives confusing errors with early pruning", "user": {"login": "KerekesDavid", "id": 9087461, "node_id": "MDQ6VXNlcjkwODc0NjE=", "avatar_url": "https://avatars.githubusercontent.com/u/9087461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/KerekesDavid", "html_url": "https://github.com/KerekesDavid", "followers_url": "https://api.github.com/users/KerekesDavid/followers", "following_url": "https://api.github.com/users/KerekesDavid/following{/other_user}", "gists_url": "https://api.github.com/users/KerekesDavid/gists{/gist_id}", "starred_url": "https://api.github.com/users/KerekesDavid/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/KerekesDavid/subscriptions", "organizations_url": "https://api.github.com/users/KerekesDavid/orgs", "repos_url": "https://api.github.com/users/KerekesDavid/repos", "events_url": "https://api.github.com/users/KerekesDavid/events{/privacy}", "received_events_url": "https://api.github.com/users/KerekesDavid/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2020-12-11T21:10:06Z", "updated_at": "2021-09-09T06:42:27Z", "closed_at": "2021-04-08T23:24:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "Calling `best_trial` either gives the error `ValueError: Record does not exist.` or `ValueError: No trials are completed yet.` if called when only pruned trials exist in a study. The error changes depending on whether the study was initialized with a db or in memory.\r\n\r\n## Expected behavior\r\n\r\nFor my use-case the most intuitive behavior would be for best_trial to also take pruned trials into account.\r\n\r\nI'm running trials one-by-one on a distributed environment and trying to report the best trial as each one finishes. I spent a few hours debugging why there are seemingly no trials logged in the database before I realized what was happening. \r\n\r\nEdited just to clarify: the `ValueError: No trials are completed yet.` is at least pointing the user in the right direction, the `ValueError: Record does not exist.` was what led me on a wild goose chase.\r\n\r\nIf this is not desirable for other use-cases, I think best_trial should either return a `None` value, or at least an easy to catch, consistent error. The first option would allow for the pythonic  `if study.best_trial: print(study.best_trial)` handling of the edge case.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.3.0\r\n- Python version: 3.8.6\r\n- OS: Ubuntu 20.10\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"optuna_debug.py\", line 11, in <module>\r\n    print(study.best_trial)\r\n  File \"/home/david/envs/optuna/lib/python3.8/site-packages/optuna/study.py\", line 72, in best_trial\r\n    return copy.deepcopy(self._storage.get_best_trial(self._study_id))\r\n  File \"/home/david/envs/optuna/lib/python3.8/site-packages/optuna/storages/_cached_storage.py\", line 264, in get_best_trial\r\n    return self._backend.get_best_trial(study_id)\r\n  File \"/home/david/envs/optuna/lib/python3.8/site-packages/optuna/storages/_rdb/storage.py\", line 1035, in get_best_trial\r\n    trial = models.TrialModel.find_min_value_trial(study_id, session)\r\n  File \"/home/david/envs/optuna/lib/python3.8/site-packages/optuna/storages/_rdb/models.py\", line 216, in find_min_value_trial\r\n    raise ValueError(NOT_FOUND_MSG)\r\nValueError: Record does not exist.\r\n```\r\n\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"optuna_debug.py\", line 11, in <module>\r\n    print(study.best_trial)\r\n  File \"/home/david/envs/optuna/lib/python3.8/site-packages/optuna/study.py\", line 72, in best_trial\r\n    return copy.deepcopy(self._storage.get_best_trial(self._study_id))\r\n  File \"/home/david/envs/optuna/lib/python3.8/site-packages/optuna/storages/_in_memory.py\", line 275, in get_best_trial\r\n    raise ValueError(\"No trials are completed yet.\")\r\nValueError: No trials are completed yet.\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Create a new study\r\n2. Prune a trial\r\n3. Try to access study.best_trial\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\nimport optuna\r\n\r\ndef objective(trial):\r\n    trial.report(1.0, step=1)\r\n    raise optuna.TrialPruned()\r\n\r\nstudy = optuna.create_study()\r\nstudy.optimize(objective, n_trials=1)\r\n\r\nprint(study.best_trial)\r\n```\r\n\r\n```python\r\nimport optuna\r\n\r\ndef objective(trial):\r\n    trial.report(1.0, step=1)\r\n    raise optuna.TrialPruned()\r\n\r\nstudy = optuna.create_study(storage='sqlite:///./optuna.db')\r\nstudy.optimize(objective, n_trials=1)\r\n\r\nprint(study.best_trial)\r\n```\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2101/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2101/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2096", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2096/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2096/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2096/events", "html_url": "https://github.com/optuna/optuna/pull/2096", "id": 762818071, "node_id": "MDExOlB1bGxSZXF1ZXN0NTM3MzI3MTIz", "number": 2096, "title": "Replace builtin `isnumerical` to capture float values in `plot_contour`.", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/30", "html_url": "https://github.com/optuna/optuna/milestone/30", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/30/labels", "id": 6049240, "node_id": "MDk6TWlsZXN0b25lNjA0OTI0MA==", "number": 30, "title": "v2.4.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 125, "state": "closed", "created_at": "2020-10-30T04:40:49Z", "updated_at": "2021-01-12T07:33:34Z", "due_on": null, "closed_at": "2021-01-12T07:33:34Z"}, "comments": 3, "created_at": "2020-12-11T19:47:19Z", "updated_at": "2020-12-14T09:37:39Z", "closed_at": "2020-12-14T08:43:29Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2096", "html_url": "https://github.com/optuna/optuna/pull/2096", "diff_url": "https://github.com/optuna/optuna/pull/2096.diff", "patch_url": "https://github.com/optuna/optuna/pull/2096.patch", "merged_at": "2020-12-14T08:43:29Z"}, "body": "<!-- Thank you for creating a pull request! -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\nIf the categorical candidates contain only `float` and `None`,  the `plot_contour` generate [a blank plot](https://user-images.githubusercontent.com/7121753/97346796-403d7b00-18cf-11eb-952e-06cd5b89e01e.png) with older `plotly`, which may be older than `4.12.0`. Note that the latest plotly is fine.\r\n\r\nPlease see #1834 for more details.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\nJust apply https://github.com/optuna/optuna/issues/1834#issuecomment-719941511.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2096/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2096/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2090", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2090/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2090/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2090/events", "html_url": "https://github.com/optuna/optuna/pull/2090", "id": 761808069, "node_id": "MDExOlB1bGxSZXF1ZXN0NTM2NDIxMzY4", "number": 2090, "title": "Fix flipped colormap in `matplotlib` backend `plot_parallel_coordinate`", "user": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/30", "html_url": "https://github.com/optuna/optuna/milestone/30", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/30/labels", "id": 6049240, "node_id": "MDk6TWlsZXN0b25lNjA0OTI0MA==", "number": 30, "title": "v2.4.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 125, "state": "closed", "created_at": "2020-10-30T04:40:49Z", "updated_at": "2021-01-12T07:33:34Z", "due_on": null, "closed_at": "2021-01-12T07:33:34Z"}, "comments": 0, "created_at": "2020-12-11T02:30:16Z", "updated_at": "2020-12-11T04:44:39Z", "closed_at": "2020-12-11T04:43:50Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2090", "html_url": "https://github.com/optuna/optuna/pull/2090", "diff_url": "https://github.com/optuna/optuna/pull/2090.diff", "patch_url": "https://github.com/optuna/optuna/pull/2090.patch", "merged_at": "2020-12-11T04:43:50Z"}, "body": "## Motivation\r\nThe colormap in matplotlib backend `plot_parallel_coordinate` is flipped.\r\n## Description of the changes\r\nUse `Blues_r` if the study direction is `minimize`. This PR does not add unit tests because I don't know how to check it...\r\n- plotly\r\n![plotly](https://user-images.githubusercontent.com/1255726/101853155-81010300-3ba2-11eb-82bf-d8707f976b94.png)\r\n- matplotlib (master)\r\n![master](https://user-images.githubusercontent.com/1255726/101853207-94ac6980-3ba2-11eb-8ba6-0ce12c34a723.png)\r\n- matplotlib (PR)\r\n![PR](https://user-images.githubusercontent.com/1255726/101853218-97a75a00-3ba2-11eb-8929-bcbd6bd57e27.png)", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2090/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2090/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2079", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2079/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2079/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2079/events", "html_url": "https://github.com/optuna/optuna/pull/2079", "id": 759537940, "node_id": "MDExOlB1bGxSZXF1ZXN0NTM0NTI2ODE2", "number": 2079, "title": "Remove circular reference of study.", "user": {"login": "keisuke-umezawa", "id": 1277089, "node_id": "MDQ6VXNlcjEyNzcwODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1277089?v=4", "gravatar_id": "", "url": "https://api.github.com/users/keisuke-umezawa", "html_url": "https://github.com/keisuke-umezawa", "followers_url": "https://api.github.com/users/keisuke-umezawa/followers", "following_url": "https://api.github.com/users/keisuke-umezawa/following{/other_user}", "gists_url": "https://api.github.com/users/keisuke-umezawa/gists{/gist_id}", "starred_url": "https://api.github.com/users/keisuke-umezawa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/keisuke-umezawa/subscriptions", "organizations_url": "https://api.github.com/users/keisuke-umezawa/orgs", "repos_url": "https://api.github.com/users/keisuke-umezawa/repos", "events_url": "https://api.github.com/users/keisuke-umezawa/events{/privacy}", "received_events_url": "https://api.github.com/users/keisuke-umezawa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/30", "html_url": "https://github.com/optuna/optuna/milestone/30", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/30/labels", "id": 6049240, "node_id": "MDk6TWlsZXN0b25lNjA0OTI0MA==", "number": 30, "title": "v2.4.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 125, "state": "closed", "created_at": "2020-10-30T04:40:49Z", "updated_at": "2021-01-12T07:33:34Z", "due_on": null, "closed_at": "2021-01-12T07:33:34Z"}, "comments": 6, "created_at": "2020-12-08T15:25:38Z", "updated_at": "2020-12-24T09:47:15Z", "closed_at": "2020-12-18T00:23:14Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2079", "html_url": "https://github.com/optuna/optuna/pull/2079", "diff_url": "https://github.com/optuna/optuna/pull/2079.diff", "patch_url": "https://github.com/optuna/optuna/pull/2079.patch", "merged_at": "2020-12-18T00:23:14Z"}, "body": "<!-- Thank you for creating a pull request! -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nTo solve the issue 2 written in https://github.com/optuna/optuna/issues/1347#issuecomment-650852619.\r\n\r\nActually, in the previous code, study is never garbage collected and `_finalize` is never called, because weakref is used wrongly c.f. [note at the bottom](https://docs.python.org/3/library/weakref.html#weakref.finalize). So, in my understanding, `_finalize` is not needed. Also, [SQL alchemy documentation](https://docs.sqlalchemy.org/en/13/orm/contextual.html#thread-local-scope) says that we do not need to call scoped_session.remove().\r\n\r\n> The scoped_session.remove() method, as always, removes the current Session associated with the thread, if any. However, one advantage of the threading.local() object is that if the application thread itself ends, the \u201cstorage\u201d for that thread is also garbage collected. So it is in fact \u201csafe\u201d to use thread local scope with an application that spawns and tears down threads, without the need to call scoped_session.remove().\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n- [x] Remove weakref which make circular reference. c.f. [note at the bottom](https://docs.python.org/3/library/weakref.html#weakref.finalize)\r\n\r\n## checks\r\n```\r\nimport optuna\r\n\r\nconn_str= \"postgresql://localhost:5432/foo\"\r\n\r\nfor i in range(101):  # 100 is the maximum allowed number of connections for postgresql by default.\r\n    study = optuna.create_study(conn_str, study_name=f\"test_{i}\")\r\n    study._storage._backend.delete_study(study._study_id)\r\n```\r\n\r\nThe above code run correctly.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2079/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2079/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2057", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2057/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2057/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2057/events", "html_url": "https://github.com/optuna/optuna/issues/2057", "id": 754396054, "node_id": "MDU6SXNzdWU3NTQzOTYwNTQ=", "number": 2057, "title": "Color map is unexpectedly flipped in contour plot", "user": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}, {"id": 1846694757, "node_id": "MDU6TGFiZWwxODQ2Njk0NzU3", "url": "https://api.github.com/repos/optuna/optuna/labels/good%20first%20issue", "name": "good first issue", "color": "c2e0c6", "default": true, "description": "Good first issue for contribution."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}, {"id": 2107128673, "node_id": "MDU6TGFiZWwyMTA3MTI4Njcz", "url": "https://api.github.com/repos/optuna/optuna/labels/no-stale", "name": "no-stale", "color": "BBBBBB", "default": false, "description": "Exempt from stale bot"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-12-01T13:30:25Z", "updated_at": "2022-02-02T14:59:59Z", "closed_at": "2021-02-08T13:15:28Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "In contour plots, the color map is flipped between stable and latest.\r\n\r\n### Latest\r\n\r\nhttps://optuna.readthedocs.io/en/latest/reference/visualization/generated/optuna.visualization.plot_contour.html\r\n\r\n![Screen Shot 2020-12-01 at 22 16 20](https://user-images.githubusercontent.com/5164000/100745590-da3e9900-3422-11eb-9ee2-a7acd466eef5.jpg)\r\n\r\n## Stable\r\n\r\nhttps://optuna.readthedocs.io/en/stable/reference/visualization/generated/optuna.visualization.plot_contour.html#optuna.visualization.plot_contour\r\n\r\n![Screen Shot 2020-12-01 at 22 16 33](https://user-images.githubusercontent.com/5164000/100745646-f2161d00-3422-11eb-9d6c-c1ae6782512c.jpg)\r\n\r\nIf this change was introduced unintentionally, it would be better to make the color map the same as in the stable version.\r\n\r\n===\r\n\r\nDo we have to make color maps of plots consistent? For example, the high-value points become blue in the slice plot but the lines with the high objective values are plotted with white in the coordinate plot.\r\n\r\n- slice plot: https://optuna.readthedocs.io/en/stable/reference/visualization/generated/optuna.visualization.plot_slice.html#optuna.visualization.plot_slice\r\n- coordinate plot: https://optuna.readthedocs.io/en/stable/reference/visualization/generated/optuna.visualization.plot_parallel_coordinate.html", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2057/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2057/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2055", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2055/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2055/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2055/events", "html_url": "https://github.com/optuna/optuna/pull/2055", "id": 753818585, "node_id": "MDExOlB1bGxSZXF1ZXN0NTI5ODIzMzgw", "number": 2055, "title": "Added test and fix for relative sampling failure in multivariate TPE", "user": {"login": "alexrobomind", "id": 5833672, "node_id": "MDQ6VXNlcjU4MzM2NzI=", "avatar_url": "https://avatars.githubusercontent.com/u/5833672?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexrobomind", "html_url": "https://github.com/alexrobomind", "followers_url": "https://api.github.com/users/alexrobomind/followers", "following_url": "https://api.github.com/users/alexrobomind/following{/other_user}", "gists_url": "https://api.github.com/users/alexrobomind/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexrobomind/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexrobomind/subscriptions", "organizations_url": "https://api.github.com/users/alexrobomind/orgs", "repos_url": "https://api.github.com/users/alexrobomind/repos", "events_url": "https://api.github.com/users/alexrobomind/events{/privacy}", "received_events_url": "https://api.github.com/users/alexrobomind/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/32", "html_url": "https://github.com/optuna/optuna/milestone/32", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/32/labels", "id": 6366089, "node_id": "MDk6TWlsZXN0b25lNjM2NjA4OQ==", "number": 32, "title": "v2.6.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 85, "state": "closed", "created_at": "2021-01-29T05:19:18Z", "updated_at": "2021-03-08T06:34:50Z", "due_on": null, "closed_at": "2021-03-08T06:34:50Z"}, "comments": 12, "created_at": "2020-11-30T21:31:00Z", "updated_at": "2021-03-03T08:05:48Z", "closed_at": "2021-03-03T08:05:48Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/2055", "html_url": "https://github.com/optuna/optuna/pull/2055", "diff_url": "https://github.com/optuna/optuna/pull/2055.diff", "patch_url": "https://github.com/optuna/optuna/pull/2055.patch", "merged_at": "2021-03-03T08:05:48Z"}, "body": "## Motivation\r\nCurrently, on the master branch, the following minimal example fails:\r\n\r\n```\r\nimport optuna\r\n\r\ndef mwe(trial):\r\n\tif trial.number == 0:\r\n\t\ttrial.suggest_uniform(\"param1\", 0, 1)\r\n\t\traise optuna.exceptions.TrialPruned()\r\n\t\r\n\tif trial.number == 1:\r\n\t\ttrial.suggest_uniform(\"param2\", 0, 1)\r\n\t\treturn 0\r\n\t\r\n\treturn 0\r\n\r\nsampler = optuna.samplers.TPESampler(n_startup_trials = 1, multivariate = True)\r\nstudy = optuna.create_study(sampler = sampler)\r\n\r\nstudy.optimize(mwe, 3)\r\n```\r\n\r\nThis is because the multivariate TPE uses pruned and completed trials for its relative sampling, but the search space computation only looks at completed trials. Therefore, it can include parameters missing from the pruned trials, which the TPE can't handle. This leads to the assertion `assert param_name in trial.params` in sampler.py to fail.\r\n\r\n## Description of the changes\r\nThis PR contains three modifications:\r\n- Modifies the assertion param_name in trial.params to be a bit more explanatory\r\n- Adds an optional argument `include_pruned` (default False) to IntersectionSearchSpace.calculate and intersection_search_space, and sets this to True in the TPESampler.\r\n- Adds the above failing example as a test.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2055/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2055/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2039", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2039/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2039/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2039/events", "html_url": "https://github.com/optuna/optuna/issues/2039", "id": 746967036, "node_id": "MDU6SXNzdWU3NDY5NjcwMzY=", "number": 2039, "title": "Duplicate values in GridSampler with multiple machines", "user": {"login": "VitorGuizilini-TRI", "id": 58576956, "node_id": "MDQ6VXNlcjU4NTc2OTU2", "avatar_url": "https://avatars.githubusercontent.com/u/58576956?v=4", "gravatar_id": "", "url": "https://api.github.com/users/VitorGuizilini-TRI", "html_url": "https://github.com/VitorGuizilini-TRI", "followers_url": "https://api.github.com/users/VitorGuizilini-TRI/followers", "following_url": "https://api.github.com/users/VitorGuizilini-TRI/following{/other_user}", "gists_url": "https://api.github.com/users/VitorGuizilini-TRI/gists{/gist_id}", "starred_url": "https://api.github.com/users/VitorGuizilini-TRI/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/VitorGuizilini-TRI/subscriptions", "organizations_url": "https://api.github.com/users/VitorGuizilini-TRI/orgs", "repos_url": "https://api.github.com/users/VitorGuizilini-TRI/repos", "events_url": "https://api.github.com/users/VitorGuizilini-TRI/events{/privacy}", "received_events_url": "https://api.github.com/users/VitorGuizilini-TRI/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2020-11-19T22:13:38Z", "updated_at": "2021-05-30T23:15:44Z", "closed_at": "2021-05-30T23:15:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, once again thanks for the great library. \r\n\r\nI am integrating Optuna with my codebase, including distributed training in multiple machines using MySQL in AWS. Everything seems to be working correctly, I can create one single database that is shared for different trials. However, when I use GridSampler each machine gets duplicated suggestions, is this expected? ", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2039/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2039/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2036", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2036/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2036/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2036/events", "html_url": "https://github.com/optuna/optuna/issues/2036", "id": 745442107, "node_id": "MDU6SXNzdWU3NDU0NDIxMDc=", "number": 2036, "title": "Start time is wrong when calculating trials added by `enqueue_trial`.", "user": {"login": "PhilipMay", "id": 229382, "node_id": "MDQ6VXNlcjIyOTM4Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/229382?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PhilipMay", "html_url": "https://github.com/PhilipMay", "followers_url": "https://api.github.com/users/PhilipMay/followers", "following_url": "https://api.github.com/users/PhilipMay/following{/other_user}", "gists_url": "https://api.github.com/users/PhilipMay/gists{/gist_id}", "starred_url": "https://api.github.com/users/PhilipMay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PhilipMay/subscriptions", "organizations_url": "https://api.github.com/users/PhilipMay/orgs", "repos_url": "https://api.github.com/users/PhilipMay/repos", "events_url": "https://api.github.com/users/PhilipMay/events{/privacy}", "received_events_url": "https://api.github.com/users/PhilipMay/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 16, "created_at": "2020-11-18T08:21:29Z", "updated_at": "2021-02-22T03:33:04Z", "closed_at": "2021-02-22T03:33:04Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I have a study with 30 trials. I read this study with all trials and use `enqueue_trial` to create a new study and add the best 10 trials. Then I start optuna to calculate the results on all 10 trials of the new study.\r\n\r\nI observe that the logged \"datetime_start\" of all 10 trials is the same (which is wrong since the runs need a significant amount of time). After the 10 enqued runs the time is logged correctly for trial 11 and so on.\r\n\r\nI am using optuna 2.3.0 from pip.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2036/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2036/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2014", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2014/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2014/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2014/events", "html_url": "https://github.com/optuna/optuna/issues/2014", "id": 741622504, "node_id": "MDU6SXNzdWU3NDE2MjI1MDQ=", "number": 2014, "title": "tests are installed as a package", "user": {"login": "130ndim", "id": 24513943, "node_id": "MDQ6VXNlcjI0NTEzOTQz", "avatar_url": "https://avatars.githubusercontent.com/u/24513943?v=4", "gravatar_id": "", "url": "https://api.github.com/users/130ndim", "html_url": "https://github.com/130ndim", "followers_url": "https://api.github.com/users/130ndim/followers", "following_url": "https://api.github.com/users/130ndim/following{/other_user}", "gists_url": "https://api.github.com/users/130ndim/gists{/gist_id}", "starred_url": "https://api.github.com/users/130ndim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/130ndim/subscriptions", "organizations_url": "https://api.github.com/users/130ndim/orgs", "repos_url": "https://api.github.com/users/130ndim/repos", "events_url": "https://api.github.com/users/130ndim/events{/privacy}", "received_events_url": "https://api.github.com/users/130ndim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-11-12T13:57:14Z", "updated_at": "2020-11-18T00:20:12Z", "closed_at": "2020-11-18T00:20:12Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\ntests directory gets installed as a package after running setup.py.\r\nIt causes ModuleNotFoundError when trying to import something from a local tests module (for example, during testing).\r\n\r\n## Expected behavior\r\n\r\ntests directory should be excluded on find_packages call.\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.2.0\r\n- Python version: 3.7\r\n- OS:\r\n- (Optional) Other libraries and their versions:\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nImportError                               Traceback (most recent call last)\r\n<ipython-input-142-c506fd19fa98> in <module>\r\n----> 1 from tests import get_test_data\r\n\r\nImportError: cannot import name 'get_test_data' from 'tests' (/opt/conda/envs/empnn/lib/python3.7/site-packages/tests/__init__.py)\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Create a local tests directory with some *.py files\r\n2. Install optuna\r\n3. Try to import a module from tests\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2014/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2014/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2011", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2011/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2011/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2011/events", "html_url": "https://github.com/optuna/optuna/issues/2011", "id": 740923256, "node_id": "MDU6SXNzdWU3NDA5MjMyNTY=", "number": 2011, "title": "ZeroDivisionError when plotting parallel_coordinate with matplotlib backend", "user": {"login": "appleparan", "id": 156580, "node_id": "MDQ6VXNlcjE1NjU4MA==", "avatar_url": "https://avatars.githubusercontent.com/u/156580?v=4", "gravatar_id": "", "url": "https://api.github.com/users/appleparan", "html_url": "https://github.com/appleparan", "followers_url": "https://api.github.com/users/appleparan/followers", "following_url": "https://api.github.com/users/appleparan/following{/other_user}", "gists_url": "https://api.github.com/users/appleparan/gists{/gist_id}", "starred_url": "https://api.github.com/users/appleparan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/appleparan/subscriptions", "organizations_url": "https://api.github.com/users/appleparan/orgs", "repos_url": "https://api.github.com/users/appleparan/repos", "events_url": "https://api.github.com/users/appleparan/events{/privacy}", "received_events_url": "https://api.github.com/users/appleparan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2020-11-11T17:01:14Z", "updated_at": "2021-02-27T01:49:17Z", "closed_at": "2021-02-27T01:49:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Expected behavior\r\n\r\nJust plot parallel coordinate without Error\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.3.0\r\n- Python version: 3.8.2\r\n- OS: Ubuntu 18.04\r\n- (Optional) Other libraries and their versions:\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"mise/mise.py\", line 106, in <module>\r\n    ml(args)\r\n  File \"mise/mise.py\", line 84, in ml\r\n    globals()[f]()\r\n  File \"/home/appleparan/src/Mise.py/mise/ml/rnn_mul_tpa_attn_general.py\", line 309, in ml_rnn_mul_tpa_attn_general\r\n    ax_pcoord = optmpl.plot_parallel_coordinate(\r\n  File \"/home/appleparan/.pyenv/versions/mise/lib/python3.8/site-packages/optuna/_experimental.py\", line 68, in new_func\r\n    return func(*args, **kwargs)  # type: ignore\r\n  File \"/home/appleparan/.pyenv/versions/mise/lib/python3.8/site-packages/optuna/visualization/matplotlib/_parallel_coordinate.py\", line 42, in plot_parallel_coordinate\r\n    return _get_parallel_coordinate_plot(study, params)\r\n  File \"/home/appleparan/.pyenv/versions/mise/lib/python3.8/site-packages/optuna/visualization/matplotlib/_parallel_coordinate.py\", line 96, in _get_parallel_coordinate_plot\r\n    dims_obj_base[i].append((v - p_min) / p_w * obj_w + obj_min)\r\nZeroDivisionError: division by zero\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Use Optuna in my code based on `pytorch_lightning_example.py` with pruning\r\n2. ZeroDivisionError occurred sometimes. It is hard to provide MWE(Minimal Working Example) yet.\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\n# python code\r\n```\r\n\r\n## Additional context (optional)\r\nAFAIK, It seems the error occurred when parameter values has only single value. This makes `p_w` is zero throwing `ZeroDivisionError`.\r\nhttps://github.com/optuna/optuna/blob/e54cc6f0d7864fb855aa97bfd0f30c5a28107562/optuna/visualization/matplotlib/_parallel_coordinate.py#L92-L96\r\n\r\nEven I'm failed to provide MWE, I think there would be two solutions. \r\n1. Handle exception\r\n2. Remove a possibility `p_w` to be zero. I think `parallel_coordinate` should be plotted even parameter `values` has only single value by lines just passing single point in figure. ", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2011/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2011/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/2001", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/2001/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/2001/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/2001/events", "html_url": "https://github.com/optuna/optuna/issues/2001", "id": 738850027, "node_id": "MDU6SXNzdWU3Mzg4NTAwMjc=", "number": 2001, "title": "Disabling the logging handler continue to print certain messages", "user": {"login": "nsinenian", "id": 4325187, "node_id": "MDQ6VXNlcjQzMjUxODc=", "avatar_url": "https://avatars.githubusercontent.com/u/4325187?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nsinenian", "html_url": "https://github.com/nsinenian", "followers_url": "https://api.github.com/users/nsinenian/followers", "following_url": "https://api.github.com/users/nsinenian/following{/other_user}", "gists_url": "https://api.github.com/users/nsinenian/gists{/gist_id}", "starred_url": "https://api.github.com/users/nsinenian/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nsinenian/subscriptions", "organizations_url": "https://api.github.com/users/nsinenian/orgs", "repos_url": "https://api.github.com/users/nsinenian/repos", "events_url": "https://api.github.com/users/nsinenian/events{/privacy}", "received_events_url": "https://api.github.com/users/nsinenian/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-11-09T09:22:26Z", "updated_at": "2021-03-04T23:21:21Z", "closed_at": "2021-03-04T23:21:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "Calling `optuna.logging.disable_default_handler()` or otherwise setting the verbosity level (either, or both) suppresses most log output messages, except for pruning messages, which are still printed to screen:\r\n\r\n\"Engine run is terminating due to exception: Trial was pruned at 1 epoch..\"\r\n\r\n## Expected behavior\r\n\r\nI expect that disabling the logging handler for optuna would also suppress messages with respect to pruning.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.2.0\r\n- Python version: 3.8.1\r\n- OS: macOS Catalina (10.15.6)\r\n- (Optional) Other libraries and their versions: PyTorch (1.6.0)\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n\r\n## Steps to reproduce\r\n\r\n1. Define an objective function `objective`\r\n2. Run a trial with a pruner\r\n\r\n## Reproducible examples (optional)\r\n\r\n```\r\noptuna.logging.disable_default_handler()\r\nstudy = optuna.create_study(direction=\"maximize\",pruner=optuna.pruners.optuna.pruners.SuccessiveHalvingPruner())\r\nstudy.optimize(objective,n_trials=trials,timeout=timeout)\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/2001/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/2001/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1984", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1984/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1984/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1984/events", "html_url": "https://github.com/optuna/optuna/issues/1984", "id": 733966648, "node_id": "MDU6SXNzdWU3MzM5NjY2NDg=", "number": 1984, "title": "LightGBMTuner picks the last valid_sets for the optimization", "user": {"login": "jeffzi", "id": 16199817, "node_id": "MDQ6VXNlcjE2MTk5ODE3", "avatar_url": "https://avatars.githubusercontent.com/u/16199817?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jeffzi", "html_url": "https://github.com/jeffzi", "followers_url": "https://api.github.com/users/jeffzi/followers", "following_url": "https://api.github.com/users/jeffzi/following{/other_user}", "gists_url": "https://api.github.com/users/jeffzi/gists{/gist_id}", "starred_url": "https://api.github.com/users/jeffzi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jeffzi/subscriptions", "organizations_url": "https://api.github.com/users/jeffzi/orgs", "repos_url": "https://api.github.com/users/jeffzi/repos", "events_url": "https://api.github.com/users/jeffzi/events{/privacy}", "received_events_url": "https://api.github.com/users/jeffzi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-11-01T13:30:10Z", "updated_at": "2021-02-28T23:21:17Z", "closed_at": "2021-02-28T23:21:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "While working on #1947, I noticed that `LightGBMTuner` always picks the last `valid_sets` for the optimization. This can lead to unexpected results, especially if the training set is last in `valid_sets`. \r\n\r\nhttps://github.com/optuna/optuna/blob/8ef763023e5ad858284566b3de2fa5eca7fd19b2/optuna/integration/_lightgbm_tuner/optimize.py#L102\r\n\r\nhttps://github.com/optuna/optuna/blob/8ef763023e5ad858284566b3de2fa5eca7fd19b2/optuna/integration/_lightgbm_tuner/optimize.py#L110\r\n\r\n## Expected behavior\r\n\r\nThis behavior should be documented.\r\n\r\nOptionally: LightGBM's [normal behavior](https://lightgbm.readthedocs.io/en/latest/pythonapi/lightgbm.train.html) is to ignore training data in `valid_sets`. `LightGBMTuner` could reproduce it. \r\n\r\nFor #1947 (`StepwiseLightGBMTuner`), I chose to replicate LightGBM's behavior and pick the first `valid_sets` (similar to `first_metric_only` option).\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.2.0\r\n- Python version: 3.8.5\r\n- OS: Linux\r\n\r\n## Steps to reproduce\r\n\r\nTune a LightGBM model with train set as last element of `valid_sets`.\r\n\r\n## Reproducible example\r\n\r\n```python\r\nimport sklearn.datasets\r\nfrom sklearn.model_selection import train_test_split\r\n\r\nimport optuna.integration.lightgbm as lgb\r\nimport optuna.logging\r\n\r\noptuna.logging.set_verbosity(optuna.logging.WARN)\r\n\r\ndata, target = sklearn.datasets.load_breast_cancer(return_X_y=True)\r\ntrain_x, val_x, train_y, val_y = train_test_split(data, target, test_size=0.25)\r\ndtrain = lgb.Dataset(train_x, label=train_y)\r\ndval = lgb.Dataset(val_x, label=val_y)\r\n\r\nparams = {\r\n    \"objective\": \"binary\",\r\n    \"metric\": \"binary_logloss\",\r\n    \"verbosity\": -1,\r\n    \"boosting_type\": \"gbdt\",\r\n}\r\n\r\ntuner = lgb.LightGBMTuner(\r\n    params,\r\n    dtrain,\r\n    verbose_eval=10,\r\n    num_boost_round=10,\r\n    early_stopping_rounds=1,\r\n    valid_sets=[dtrain, dval],\r\n    show_progress_bar=False,\r\n)\r\ntuner.tune_feature_fraction(n_trials=1)\r\n#> Training until validation scores don't improve for 1 rounds\r\n#> [10]\tvalid_0's binary_logloss: 0.2563\tvalid_1's binary_logloss: 0.279778\r\n#> Did not meet early stopping. Best iteration is:\r\n#> [10]\tvalid_0's binary_logloss: 0.2563\tvalid_1's binary_logloss: 0.279778\r\nprint(f\"Best score: {tuner.best_score}\")  # Score of dval (valid_1)\r\n#> Best score: 0.2797775495440344\r\n\r\ntuner = lgb.LightGBMTuner(\r\n    params,\r\n    dtrain,\r\n    verbose_eval=10,\r\n    num_boost_round=10,\r\n    early_stopping_rounds=1,\r\n    valid_sets=[dval, dtrain],\r\n    show_progress_bar=False,\r\n)\r\ntuner.tune_feature_fraction(n_trials=1)\r\n#> Training until validation scores don't improve for 1 rounds\r\n#> [10]\tvalid_0's binary_logloss: 0.279778\tvalid_1's binary_logloss: 0.2563\r\n#> Did not meet early stopping. Best iteration is:\r\n#> [10]\tvalid_0's binary_logloss: 0.279778\tvalid_1's binary_logloss: 0.2563\r\nprint(f\"Best score: {tuner.best_score}\")  # Score of dtrain (valid_1)\r\n#> Best score: 0.25629950460234735\r\n```\r\n\r\n<sup>Created on 2020-11-01 by the [reprexpy package](https://github.com/crew102/reprexpy)</sup>\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1984/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1984/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1983", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1983/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1983/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1983/events", "html_url": "https://github.com/optuna/optuna/pull/1983", "id": 733721681, "node_id": "MDExOlB1bGxSZXF1ZXN0NTEzNDM0MzAy", "number": 1983, "title": "Fix the range of categorical values.", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/30", "html_url": "https://github.com/optuna/optuna/milestone/30", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/30/labels", "id": 6049240, "node_id": "MDk6TWlsZXN0b25lNjA0OTI0MA==", "number": 30, "title": "v2.4.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 125, "state": "closed", "created_at": "2020-10-30T04:40:49Z", "updated_at": "2021-01-12T07:33:34Z", "due_on": null, "closed_at": "2021-01-12T07:33:34Z"}, "comments": 5, "created_at": "2020-10-31T13:35:09Z", "updated_at": "2020-11-30T14:32:50Z", "closed_at": "2020-11-30T14:10:30Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1983", "html_url": "https://github.com/optuna/optuna/pull/1983", "diff_url": "https://github.com/optuna/optuna/pull/1983.diff", "patch_url": "https://github.com/optuna/optuna/pull/1983.patch", "merged_at": "2020-11-30T14:10:30Z"}, "body": "## Motivation\r\nThis PR addresses https://github.com/optuna/optuna/issues/1967.\r\n\r\n## Description of the changes\r\nThis PR changes the plot range of categorical parameters for `plotly>=4.12.0`. As I mentioned in the comment, plotly seems to generate contours using indices of categorical values, but it determines plot ranges based on raw values. So, I updated the range based on the indices.\r\n\r\nCode (from #1819)\r\n```python\r\nimport optuna\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_categorical(\"x\", [\"10\", \"11\", \"100\"])\r\n    y = trial.suggest_categorical(\"y\", [\"sigmoid\", \"relu\", \"leakyrelu\"])\r\n    z = trial.suggest_loguniform(\"z\", 1e-1, 1e2)\r\n    return int(\"0\" in x) + abs(len(y) - 5) + (z/50) ** 2\r\n\r\nstudy = optuna.create_study()\r\nstudy.optimize(objective, n_trials=30)\r\n\r\noptuna.visualization.plot_contour(study).show()\r\n```\r\n\r\nThis PR:\r\n![image](https://user-images.githubusercontent.com/3255979/97780590-e4257000-1bc8-11eb-8b1b-73b7d7708b55.png)\r\n\r\nThe current master:\r\n![image](https://user-images.githubusercontent.com/3255979/97780644-36ff2780-1bc9-11eb-98ee-7752e8e0dc39.png)\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1983/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1983/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1979", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1979/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1979/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1979/events", "html_url": "https://github.com/optuna/optuna/pull/1979", "id": 732929032, "node_id": "MDExOlB1bGxSZXF1ZXN0NTEyNzk2NDYz", "number": 1979, "title": "Make always compute `weights_below` in  `MOTPEMultiObjectiveSampler`", "user": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "not522", "id": 1255726, "node_id": "MDQ6VXNlcjEyNTU3MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1255726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/not522", "html_url": "https://github.com/not522", "followers_url": "https://api.github.com/users/not522/followers", "following_url": "https://api.github.com/users/not522/following{/other_user}", "gists_url": "https://api.github.com/users/not522/gists{/gist_id}", "starred_url": "https://api.github.com/users/not522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/not522/subscriptions", "organizations_url": "https://api.github.com/users/not522/orgs", "repos_url": "https://api.github.com/users/not522/repos", "events_url": "https://api.github.com/users/not522/events{/privacy}", "received_events_url": "https://api.github.com/users/not522/received_events", "type": "User", "site_admin": false}, {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/30", "html_url": "https://github.com/optuna/optuna/milestone/30", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/30/labels", "id": 6049240, "node_id": "MDk6TWlsZXN0b25lNjA0OTI0MA==", "number": 30, "title": "v2.4.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 125, "state": "closed", "created_at": "2020-10-30T04:40:49Z", "updated_at": "2021-01-12T07:33:34Z", "due_on": null, "closed_at": "2021-01-12T07:33:34Z"}, "comments": 9, "created_at": "2020-10-30T06:46:49Z", "updated_at": "2020-12-24T07:23:58Z", "closed_at": "2020-12-24T07:23:58Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1979", "html_url": "https://github.com/optuna/optuna/pull/1979", "diff_url": "https://github.com/optuna/optuna/pull/1979.diff", "patch_url": "https://github.com/optuna/optuna/pull/1979.patch", "merged_at": "2020-12-24T07:23:58Z"}, "body": "Depends on #1978.\r\n\r\n## Motivation\r\nCurrently, the `MOTPEMultiObjectiveSampler` fails if the `weights` argument is specified. Based on the [original MOTPE paper](https://dl.acm.org/doi/pdf/10.1145/3377930.3389817), the computation of `weights_below` is a central part of the algorithm and should not be freely changed by the user. Therefore, in this PR, I rename the `weights` argument to `weights_above`, so that `weights_below` is computed internally.\r\n\r\nReproducible failing code from https://github.com/optuna/optuna/pull/1979#issuecomment-748770675\r\n```python\r\nimport numpy as np\r\nimport optuna\r\n\r\ndef objective(trial):\r\n    # Binh and Korn function.\r\n    x = trial.suggest_float(\"x\", 0, 5)\r\n    y = trial.suggest_float(\"y\", 0, 3)\r\n\r\n    v0 = 4 * x ** 2 + 4 * y ** 2\r\n    v1 = (x - 5) ** 2 + (y - 5) ** 2\r\n    return v0, v1\r\n\r\ndef weights(i: int) -> np.array:\r\n    return np.asarray([i * 0.05 for _ in range(i)])\r\n\r\nstudy = optuna.multi_objective.create_study([\"minimize\", \"minimize\"], sampler=optuna.multi_objective.samplers.MOTPEMultiObjectiveSampler(weights=weights))\r\nstudy.optimize(objective, n_trials=100)\r\n```\r\n\r\n## Description of the changes\r\n- Rename `weights` argument in `__init__` to `weights_above`.\r\n- Rename `_calculate_default_weights_below` to `_calculate_weights_below`.\r\n- Remove the logic to calculate the non-default `weights_below`.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1979/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1979/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1967", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1967/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1967/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1967/events", "html_url": "https://github.com/optuna/optuna/issues/1967", "id": 730737294, "node_id": "MDU6SXNzdWU3MzA3MzcyOTQ=", "number": 1967, "title": "Strange contour plot is generated with latest `plotly`", "user": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-10-27T19:12:57Z", "updated_at": "2020-12-23T02:59:53Z", "closed_at": "2020-12-23T02:59:53Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "## Expected behavior\r\nThis bug is originally reported by @harupy in [here](https://github.com/optuna/optuna/pull/1944#issuecomment-716473083).\r\n\r\nThe example code in the documentation should generate the contour plot as follows.\r\n<img width=\"1869\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2020-10-27 12 02 48\" src=\"https://user-images.githubusercontent.com/38826298/97252000-581feb00-184c-11eb-948c-edae184e590b.png\">\r\n\r\nBut, it generates as follows with the latest `plotly` of version 4.12.0.\r\n<img width=\"1867\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2020-10-28 4 11 22\" src=\"https://user-images.githubusercontent.com/38826298/97350100-aaf0b580-18d3-11eb-99be-a68c4e5eba17.png\">\r\n\r\n\r\n## Environment\r\n\r\n- Optuna version: https://github.com/optuna/optuna/commit/fe9909a04cb343fcb346a9f4cbcf4c1d9efc066f\r\n- Python version: 3.8\r\n- Plotly version: 4.12.0\r\n\r\n## Reproducible examples\r\n\r\n```python\r\nimport optuna\r\n\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_uniform(\"x\", -100, 100)\r\n    y = trial.suggest_categorical(\"y\", [-1, 0, 1])\r\n    return x ** 2 + y\r\n\r\n\r\nstudy = optuna.create_study()\r\nstudy.optimize(objective, n_trials=30)\r\n\r\nfig = optuna.visualization.plot_contour(study, params=[\"x\", \"y\"])\r\nprint(fig)\r\nfig.show()\r\n\r\n```\r\n\r\n## Additional context (optional)\r\n\r\nWith the `plotly` of version 4.9.0,  the above code generates the appropriate contour plot.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1967/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1967/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1966", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1966/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1966/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1966/events", "html_url": "https://github.com/optuna/optuna/pull/1966", "id": 730201500, "node_id": "MDExOlB1bGxSZXF1ZXN0NTEwNTQ2NTk3", "number": 1966, "title": "Fix `StudyDirection` of `mape` in `LightGBMTuner`", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561256, "node_id": "MDU6TGFiZWwxOTQ3NTYxMjU2", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.integration", "name": "optuna.integration", "color": "1c659e", "default": false, "description": "Related to the `optuna.integration` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/29", "html_url": "https://github.com/optuna/optuna/milestone/29", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/29/labels", "id": 5941237, "node_id": "MDk6TWlsZXN0b25lNTk0MTIzNw==", "number": 29, "title": "v2.3.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 55, "state": "closed", "created_at": "2020-10-02T05:28:23Z", "updated_at": "2020-11-04T04:29:10Z", "due_on": null, "closed_at": "2020-11-04T04:29:10Z"}, "comments": 1, "created_at": "2020-10-27T07:41:27Z", "updated_at": "2020-10-29T01:22:52Z", "closed_at": "2020-10-29T01:21:55Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1966", "html_url": "https://github.com/optuna/optuna/pull/1966", "diff_url": "https://github.com/optuna/optuna/pull/1966.diff", "patch_url": "https://github.com/optuna/optuna/pull/1966.patch", "merged_at": "2020-10-29T01:21:55Z"}, "body": "## Motivation\r\nFixes #1858. I found that `mape` `startswith` `map` when I read the code in #1947 . \r\n\r\nhttps://github.com/optuna/optuna/blob/9fc26c2277b347788d5554dad66dba81585716b2/optuna/integration/_lightgbm_tuner/optimize.py#L146\r\n\r\n## Description of the changes\r\n- Use `in` instead of `startswith` to check the metrics. I assumed that the metrics are converted by `_handling_alias_metrics`.\r\n- Add `mape` to the test case.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1966/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1966/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1955", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1955/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1955/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1955/events", "html_url": "https://github.com/optuna/optuna/pull/1955", "id": 728191079, "node_id": "MDExOlB1bGxSZXF1ZXN0NTA4OTQzNzU0", "number": 1955, "title": "Fix retuned type of MultivariateTPE samplers", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/29", "html_url": "https://github.com/optuna/optuna/milestone/29", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/29/labels", "id": 5941237, "node_id": "MDk6TWlsZXN0b25lNTk0MTIzNw==", "number": 29, "title": "v2.3.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 55, "state": "closed", "created_at": "2020-10-02T05:28:23Z", "updated_at": "2020-11-04T04:29:10Z", "due_on": null, "closed_at": "2020-11-04T04:29:10Z"}, "comments": 1, "created_at": "2020-10-23T12:48:15Z", "updated_at": "2020-10-24T06:30:23Z", "closed_at": "2020-10-24T00:56:54Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1955", "html_url": "https://github.com/optuna/optuna/pull/1955", "diff_url": "https://github.com/optuna/optuna/pull/1955.diff", "patch_url": "https://github.com/optuna/optuna/pull/1955.patch", "merged_at": "2020-10-24T00:56:54Z"}, "body": "<!-- Thank you for creating a pull request! -->\r\n\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\nSolve #1952\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\nApply the change suggested in https://github.com/optuna/optuna/issues/1952#issuecomment-715014449 by @toshihikoyanase.\r\n\r\n---\r\n\r\nNow, the returned types in the example code in the issue are as follows.\r\n\r\n```bash\r\nUnivariate:\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\nMultivariate:\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1955/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1955/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1952", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1952/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1952/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1952/events", "html_url": "https://github.com/optuna/optuna/issues/1952", "id": 727568592, "node_id": "MDU6SXNzdWU3Mjc1Njg1OTI=", "number": 1952, "title": "suggest_*** returns numpy.float64 instead of float when optuna.samplers.TPESampler(multivariate=True) is used", "user": {"login": "hal-314", "id": 22135069, "node_id": "MDQ6VXNlcjIyMTM1MDY5", "avatar_url": "https://avatars.githubusercontent.com/u/22135069?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hal-314", "html_url": "https://github.com/hal-314", "followers_url": "https://api.github.com/users/hal-314/followers", "following_url": "https://api.github.com/users/hal-314/following{/other_user}", "gists_url": "https://api.github.com/users/hal-314/gists{/gist_id}", "starred_url": "https://api.github.com/users/hal-314/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hal-314/subscriptions", "organizations_url": "https://api.github.com/users/hal-314/orgs", "repos_url": "https://api.github.com/users/hal-314/repos", "events_url": "https://api.github.com/users/hal-314/events{/privacy}", "received_events_url": "https://api.github.com/users/hal-314/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-10-22T17:05:26Z", "updated_at": "2020-10-26T00:48:08Z", "closed_at": "2020-10-26T00:48:07Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "suggest_*** functions that should return float returns numpy.float64 under multivariate=True in Optuna 2.2\r\nI tested `trial.suggest_uniform` and `trial.suggest_float`\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\nimport optuna\r\ndef objective(trial):\r\n    x = trial.suggest_uniform('x', -10, 10)\r\n    #x = trial.suggest_float('x', -10, 10)\r\n    print(type(x))\r\n    return (x - 2) ** 2\r\n\r\nprint(\"Univariate:\")\r\nstudy = optuna.create_study(sampler=optuna.samplers.TPESampler(multivariate=False))\r\nstudy.optimize(objective, n_trials=15)\r\nprint('Multivariate:')\r\nstudy = optuna.create_study(sampler=optuna.samplers.TPESampler(multivariate=True))\r\nstudy.optimize(objective, n_trials=15)\r\n```\r\nIt prints:\r\n```\r\nUnivariate:\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\nMultivariate:\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'float'>\r\n<class 'numpy.float64'>\r\n<class 'numpy.float64'>\r\n<class 'numpy.float64'>\r\n<class 'numpy.float64'>\r\n<class 'numpy.float64'>\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1952/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1952/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1949", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1949/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1949/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1949/events", "html_url": "https://github.com/optuna/optuna/pull/1949", "id": 726810099, "node_id": "MDExOlB1bGxSZXF1ZXN0NTA3ODE4NzM0", "number": 1949, "title": "Safe decode of system/usr attributes for optuna studies", "user": {"login": "zzorba", "id": 1091291, "node_id": "MDQ6VXNlcjEwOTEyOTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1091291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zzorba", "html_url": "https://github.com/zzorba", "followers_url": "https://api.github.com/users/zzorba/followers", "following_url": "https://api.github.com/users/zzorba/following{/other_user}", "gists_url": "https://api.github.com/users/zzorba/gists{/gist_id}", "starred_url": "https://api.github.com/users/zzorba/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zzorba/subscriptions", "organizations_url": "https://api.github.com/users/zzorba/orgs", "repos_url": "https://api.github.com/users/zzorba/repos", "events_url": "https://api.github.com/users/zzorba/events{/privacy}", "received_events_url": "https://api.github.com/users/zzorba/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2020-10-21T19:39:27Z", "updated_at": "2021-02-28T23:21:24Z", "closed_at": "2021-02-28T23:21:24Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1949", "html_url": "https://github.com/optuna/optuna/pull/1949", "diff_url": "https://github.com/optuna/optuna/pull/1949.diff", "patch_url": "https://github.com/optuna/optuna/pull/1949.patch", "merged_at": null}, "body": "## Motivation\r\nWe encountered issues where very large callstacks were being serialized into remote storage (as part of the `fail_system` system attr).  Unfortunately, because the system_attr serializer converts things to json before storing them, the column truncation caused by the database caused these simple \"string\" attributes to no longer be decodeable as 'json'. This causes the trial to fail to load, rendering the study inoperable for future trials or later analysis.\r\n\r\n## Description of the changes\r\nThe code here wraps the current usage of `json.loads` with a simple try/except block to catch bad JSON decoding. If bad JSON is encountered, it simply treats the value as a string (not ideal in all situations, but arguably preferable behavior to rendering the trial/study inoperable.  For very long string fields this seems okay, for objects it might not be ideal but it should still be quite apparent that they are broken (as opposed to today where it fails when reading them back).\r\n\r\nAn alternate approach could try to prevent very long strings from entering the system, but defensive reads seems worthwhile regardless.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1949/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1949/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1946", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1946/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1946/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1946/events", "html_url": "https://github.com/optuna/optuna/issues/1946", "id": 726102755, "node_id": "MDU6SXNzdWU3MjYxMDI3NTU=", "number": 1946, "title": "RuntimeError('Trial#0 [or 1, etc.] has already finished and can not be updated.',)", "user": {"login": "brethvoice", "id": 11823408, "node_id": "MDQ6VXNlcjExODIzNDA4", "avatar_url": "https://avatars.githubusercontent.com/u/11823408?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brethvoice", "html_url": "https://github.com/brethvoice", "followers_url": "https://api.github.com/users/brethvoice/followers", "following_url": "https://api.github.com/users/brethvoice/following{/other_user}", "gists_url": "https://api.github.com/users/brethvoice/gists{/gist_id}", "starred_url": "https://api.github.com/users/brethvoice/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brethvoice/subscriptions", "organizations_url": "https://api.github.com/users/brethvoice/orgs", "repos_url": "https://api.github.com/users/brethvoice/repos", "events_url": "https://api.github.com/users/brethvoice/events{/privacy}", "received_events_url": "https://api.github.com/users/brethvoice/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-10-21T03:34:33Z", "updated_at": "2020-10-24T00:19:23Z", "closed_at": "2020-10-24T00:16:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "Trial 1 [or 2, etc.] in study (indexed with first trial as 0) fails to complete when test object not instantiated within objective function.\r\n\r\n## Expected behavior\r\nEach trial, once begun, completes successfully and/or is pruned.\r\n\r\n## Environment\r\n- Optuna version:  2.2\r\n- Python version:  3.6.9\r\n- OS: Ubuntu (NVIDIA docker)\r\n- Tensorflow: 2.3\r\n\r\n## Error messages and stack traces\r\n```\r\nTrial 2 failed because of the following error: RuntimeError('Trial#1 has already finished and can not be updated.',)\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.6/dist-packages/optuna/study.py\", line 799, in _run_trial\r\n    result = func(trial)\r\n  File \"simple_study_mnist_classifier_settings.py\", line 110, in objective\r\n    batch_size=standard_object.batch_size,\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/engine/training.py\", line 108, in _method_wrapper\r\n    return method(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/engine/training.py\", line 1137, in fit\r\n    callbacks.on_epoch_end(epoch, epoch_logs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/callbacks.py\", line 416, in on_epoch_end\r\n    callback.on_epoch_end(epoch, numpy_logs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/optuna/integration/tfkeras.py\", line 51, in on_epoch_end\r\n    self._trial.report(float(current_score), step=epoch)\r\n  File \"/usr/local/lib/python3.6/dist-packages/optuna/trial/_trial.py\", line 579, in report\r\n    self.storage.set_trial_intermediate_value(self._trial_id, step, value)\r\n  File \"/usr/local/lib/python3.6/dist-packages/optuna/storages/_in_memory.py\", line 332, in set_trial_intermediate_value\r\n    self.check_trial_is_updatable(trial_id, trial.state)\r\n  File \"/usr/local/lib/python3.6/dist-packages/optuna/storages/_base.py\", line 676, in check_trial_is_updatable\r\n    \"Trial#{} has already finished and can not be updated.\".format(trial.number)\r\nRuntimeError: Trial#1 has already finished and can not be updated.\r\nTraceback (most recent call last):\r\n  File \"simple_study_mnist_classifier_settings.py\", line 135, in <module>\r\n    gc_after_trial=True,\r\n  File \"/usr/local/lib/python3.6/dist-packages/optuna/study.py\", line 339, in optimize\r\n    func, n_trials, timeout, catch, callbacks, gc_after_trial, None\r\n  File \"/usr/local/lib/python3.6/dist-packages/optuna/study.py\", line 747, in _optimize_sequential\r\n    self._run_trial_and_callbacks(func, catch, callbacks, gc_after_trial)\r\n  File \"/usr/local/lib/python3.6/dist-packages/optuna/study.py\", line 776, in _run_trial_and_callbacks\r\n    trial = self._run_trial(func, catch, gc_after_trial)\r\n  File \"/usr/local/lib/python3.6/dist-packages/optuna/study.py\", line 799, in _run_trial\r\n    result = func(trial)\r\n  File \"simple_study_mnist_classifier_settings.py\", line 110, in objective\r\n    batch_size=standard_object.batch_size,\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/engine/training.py\", line 108, in _method_wrapper\r\n    return method(self, *args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/engine/training.py\", line 1137, in fit\r\n    callbacks.on_epoch_end(epoch, epoch_logs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/callbacks.py\", line 416, in on_epoch_end\r\n    callback.on_epoch_end(epoch, numpy_logs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/optuna/integration/tfkeras.py\", line 51, in on_epoch_end\r\n    self._trial.report(float(current_score), step=epoch)\r\n  File \"/usr/local/lib/python3.6/dist-packages/optuna/trial/_trial.py\", line 579, in report\r\n    self.storage.set_trial_intermediate_value(self._trial_id, step, value)\r\n  File \"/usr/local/lib/python3.6/dist-packages/optuna/storages/_in_memory.py\", line 332, in set_trial_intermediate_value\r\n    self.check_trial_is_updatable(trial_id, trial.state)\r\n  File \"/usr/local/lib/python3.6/dist-packages/optuna/storages/_base.py\", line 676, in check_trial_is_updatable\r\n    \"Trial#{} has already finished and can not be updated.\".format(trial.number)\r\nRuntimeError: Trial#1 has already finished and can not be updated.\r\n```\r\n\r\n## Steps to reproduce\r\n1. Install plotly, optuna, and tensorflow\r\n2. Run `simple_study_mnist_settings.py` from https://github.com/brethvoice/optuna_demo_MNIST (also requires EvaluateMNIST.py from https://github.com/brethvoice/optuna_demo_MNIST\r\n\r\n## Reproducible example\r\n```\r\nCUDA_VISIBLE_DEVICES='0' TF_FORCE_GPU_ALLOW_GROWTH='false' python simple_study_mnist_settings.py\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1946/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1946/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1929", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1929/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1929/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1929/events", "html_url": "https://github.com/optuna/optuna/pull/1929", "id": 721130730, "node_id": "MDExOlB1bGxSZXF1ZXN0NTAzMTAxNTgz", "number": 1929, "title": "Fixed `plot_contour`", "user": {"login": "carefree0910", "id": 15677328, "node_id": "MDQ6VXNlcjE1Njc3MzI4", "avatar_url": "https://avatars.githubusercontent.com/u/15677328?v=4", "gravatar_id": "", "url": "https://api.github.com/users/carefree0910", "html_url": "https://github.com/carefree0910", "followers_url": "https://api.github.com/users/carefree0910/followers", "following_url": "https://api.github.com/users/carefree0910/following{/other_user}", "gists_url": "https://api.github.com/users/carefree0910/gists{/gist_id}", "starred_url": "https://api.github.com/users/carefree0910/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/carefree0910/subscriptions", "organizations_url": "https://api.github.com/users/carefree0910/orgs", "repos_url": "https://api.github.com/users/carefree0910/repos", "events_url": "https://api.github.com/users/carefree0910/events{/privacy}", "received_events_url": "https://api.github.com/users/carefree0910/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/29", "html_url": "https://github.com/optuna/optuna/milestone/29", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/29/labels", "id": 5941237, "node_id": "MDk6TWlsZXN0b25lNTk0MTIzNw==", "number": 29, "title": "v2.3.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 55, "state": "closed", "created_at": "2020-10-02T05:28:23Z", "updated_at": "2020-11-04T04:29:10Z", "due_on": null, "closed_at": "2020-11-04T04:29:10Z"}, "comments": 8, "created_at": "2020-10-14T04:42:05Z", "updated_at": "2020-10-26T23:03:56Z", "closed_at": "2020-10-26T23:03:12Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1929", "html_url": "https://github.com/optuna/optuna/pull/1929", "diff_url": "https://github.com/optuna/optuna/pull/1929.diff", "patch_url": "https://github.com/optuna/optuna/pull/1929.patch", "merged_at": "2020-10-26T23:03:12Z"}, "body": "## Motivation\r\nWhen mixture types were used as `categorical`, they could not compare to each other, which would raise errors.\r\n\r\n## Description of the changes\r\nI fixed it by converting them to `str` but this solution is nowhere near elegant \ud83d\ude15\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1929/reactions", "total_count": 2, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1929/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1923", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1923/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1923/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1923/events", "html_url": "https://github.com/optuna/optuna/pull/1923", "id": 720612671, "node_id": "MDExOlB1bGxSZXF1ZXN0NTAyNjM3ODE2", "number": 1923, "title": "add some jitters in `_MultivariateParzenEstimators`", "user": {"login": "kstoneriv3", "id": 30857855, "node_id": "MDQ6VXNlcjMwODU3ODU1", "avatar_url": "https://avatars.githubusercontent.com/u/30857855?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kstoneriv3", "html_url": "https://github.com/kstoneriv3", "followers_url": "https://api.github.com/users/kstoneriv3/followers", "following_url": "https://api.github.com/users/kstoneriv3/following{/other_user}", "gists_url": "https://api.github.com/users/kstoneriv3/gists{/gist_id}", "starred_url": "https://api.github.com/users/kstoneriv3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kstoneriv3/subscriptions", "organizations_url": "https://api.github.com/users/kstoneriv3/orgs", "repos_url": "https://api.github.com/users/kstoneriv3/repos", "events_url": "https://api.github.com/users/kstoneriv3/events{/privacy}", "received_events_url": "https://api.github.com/users/kstoneriv3/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/29", "html_url": "https://github.com/optuna/optuna/milestone/29", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/29/labels", "id": 5941237, "node_id": "MDk6TWlsZXN0b25lNTk0MTIzNw==", "number": 29, "title": "v2.3.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 55, "state": "closed", "created_at": "2020-10-02T05:28:23Z", "updated_at": "2020-11-04T04:29:10Z", "due_on": null, "closed_at": "2020-11-04T04:29:10Z"}, "comments": 3, "created_at": "2020-10-13T17:56:21Z", "updated_at": "2020-10-15T15:22:25Z", "closed_at": "2020-10-15T01:24:46Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1923", "html_url": "https://github.com/optuna/optuna/pull/1923", "diff_url": "https://github.com/optuna/optuna/pull/1923.diff", "patch_url": "https://github.com/optuna/optuna/pull/1923.patch", "merged_at": "2020-10-15T01:24:46Z"}, "body": "<!-- Thank you for creating a pull request! -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nAs discussed in #1917, the multivariate TPE lacks some of the jitters (jitters `EPS` are often added to variables before division or logarithm for avoiding errors) that independent TPE has. This PR aims to make the use of jitters consistent between multivariate and independent TPEs.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1923/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1923/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1917", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1917/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1917/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1917/events", "html_url": "https://github.com/optuna/optuna/issues/1917", "id": 719335844, "node_id": "MDU6SXNzdWU3MTkzMzU4NDQ=", "number": 1917, "title": "divide by zero encountered in log for TPESampler(multivariate=True)", "user": {"login": "fsmosca", "id": 22366935, "node_id": "MDQ6VXNlcjIyMzY2OTM1", "avatar_url": "https://avatars.githubusercontent.com/u/22366935?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fsmosca", "html_url": "https://github.com/fsmosca", "followers_url": "https://api.github.com/users/fsmosca/followers", "following_url": "https://api.github.com/users/fsmosca/following{/other_user}", "gists_url": "https://api.github.com/users/fsmosca/gists{/gist_id}", "starred_url": "https://api.github.com/users/fsmosca/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fsmosca/subscriptions", "organizations_url": "https://api.github.com/users/fsmosca/orgs", "repos_url": "https://api.github.com/users/fsmosca/repos", "events_url": "https://api.github.com/users/fsmosca/events{/privacy}", "received_events_url": "https://api.github.com/users/fsmosca/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-10-12T12:20:36Z", "updated_at": "2020-10-15T11:05:02Z", "closed_at": "2020-10-15T11:05:02Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n## Expected behavior\r\n\r\nNo runtime warning.\r\n\r\n## Environment\r\n\r\n- Optuna version: v2.2.0\r\n- Python version: 3.8.5\r\n- OS: Win 10\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nD:\\param_tuner\\Optuna-Game-Parameter-Tuner-master\\venv\\lib\\site-packages\\optuna\\samplers\\_tpe\\multivariate_parzen_estimator.py:168: RuntimeWarning: divide by zero encountered in log\r\n  log_pdf = np.log(cdf) - np.log(p_accept)\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. On windows 10, install python 3.8 or later\r\n2. Create a folder param_tuner in c or d drive\r\n3. Press Code->Download Zip in the repo https://github.com/fsmosca/Optuna-Game-Parameter-Tuner\r\n4. Copy it in param_tuner folder\r\n5. Unzip the Optuna-Game-Parameter-Tuner-master.zip onto Optuna-Game-Parameter-Tuner-master\r\n6. Open powershell at folder Optuna-Game-Parameter-Tuner-master to get this\r\n`D:\\param_tuner\\Optuna-Game-Parameter-Tuner-master>`\r\n7. Create virtual environment venv\r\n`PS D:\\param_tuner\\Optuna-Game-Parameter-Tuner-master> python -m venv venv`\r\n8. Type `ls` and you should see this\r\n```\r\nPS D:\\param_tuner\\Optuna-Game-Parameter-Tuner-master> ls\r\n\r\n\r\n    Directory: D:\\param_tuner\\Optuna-Game-Parameter-Tuner-master\r\n\r\n\r\nMode                 LastWriteTime         Length Name\r\n----                 -------------         ------ ----\r\nd-----        12/10/2020   8:33 pm                engines\r\nd-----        12/10/2020   8:33 pm                start_opening\r\nd-----        12/10/2020   8:33 pm                tools\r\nd-----        12/10/2020   8:33 pm                tourney_manager\r\nd-----        12/10/2020  11:33 pm                venv\r\nd-----        12/10/2020   8:33 pm                visuals\r\n------        12/10/2020   8:33 pm           1865 .gitignore\r\n------        12/10/2020   8:33 pm           1064 LICENSE\r\n------        12/10/2020   8:33 pm          11202 README.md\r\n------        12/10/2020   8:33 pm            636 requirements.txt\r\n------        12/10/2020   8:33 pm          32886 tuner.py\r\n```\r\n\r\n9. Activate the virtual environment\r\n`PS D:\\param_tuner\\Optuna-Game-Parameter-Tuner-master> .\\venv\\scripts\\activate`\r\n\r\n10. Install optuna\r\n`(venv) PS D:\\param_tuner\\Optuna-Game-Parameter-Tuner-master> pip install optuna`\r\n\r\n11. Run the command line below\r\n* Notes:  \r\n  * The sampler used `--sampler name=tpe multivariate=true`  \r\n  * Concurrency is 6 `--concurrency 6`. There will be 6 threads to be used in game simulation. My pc has 8 threads.\r\n\r\n```\r\n(venv) PS D:\\param_tuner\\Optuna-Game-Parameter-Tuner-master> python -u tuner.py --sampler name=tpe multivariate=true --initial-best-value 0.52 --trials 200 --games-per-trial 20 --base-time-sec 120 --depth 6 --study-name mv_true --pgn-output mv_true_games.pgn --engine ./engines/stockfish-modern/stockfish.exe --hash 64 --concurrency 6 --opening-file ./start_opening/ogpt_chess_startpos.epd --input-param \"{'KingAttackWeights[4]': {'default':44, 'min':0, 'max':148, 'step':4}, 'eMobilityBonus[0][2]': {'default':-31, 'min':-100, 'max':100, 'step':4}, 'eThreatByMinor[3]': {'default':56, 'min':0, 'max':100, 'step':4}, 'mThreatBySafePawn': {'default':173, 'min':0, 'max':248, 'step':4}, 'FutMargin': {'default':227, 'min':100, 'max':348, 'step':4}}\" --threshold-pruner result=0.45\r\n```\r\n\r\nIt triggers after trial 146 in this case.\r\n```\r\n2020-10-13 00:00:01,295 | INFO  | starting trial: 146 ...\r\n2020-10-13 00:00:01,295 | INFO  | suggested param for test engine: {'FutMargin': 220, 'KingAttackWeights[4]': 28, 'eMobilityBonus[0][2]': 76, 'eThreatByMinor[3]': 4, 'mThreatBySafePawn': 120}\r\n2020-10-13 00:00:01,295 | INFO  | param for base engine          : {'FutMargin': 152, 'KingAttackWeights[4]': 20, 'eMobilityBonus[0][2]': 40, 'eThreatByMinor[3]': 12, 'mThreatBySafePawn': 172}\r\n\r\n2020-10-13 00:00:01,310 | INFO  | init param: {'FutMargin': 227, 'KingAttackWeights[4]': 44, 'eMobilityBonus[0][2]': -31, 'eThreatByMinor[3]': 56, 'mThreatBySafePawn': 173}\r\n2020-10-13 00:00:01,310 | INFO  | init value: 0.52\r\n2020-10-13 00:00:01,310 | INFO  | study best param: {'FutMargin': 152, 'KingAttackWeights[4]': 20, 'eMobilityBonus[0][2]': 40, 'eThreatByMinor[3]': 12, 'mThreatBySafePawn': 172}\r\n2020-10-13 00:00:01,310 | INFO  | study best value: 0.5904687499999998\r\n\r\n2020-10-13 00:00:01,310 | INFO  | games_to_play: 10\r\n2020-10-13 00:00:03,218 | INFO  | played_games: 10, result: {intermediate: 0.65, average: 0.65}\r\n2020-10-13 00:00:03,406 | INFO  | games_to_play: 10\r\n2020-10-13 00:00:05,494 | INFO  | played_games: 20, result: {intermediate: 0.6, average: 0.625}\r\n2020-10-13 00:00:05,603 | INFO  | Actual match result: 0.625, point of view: optimizer suggested values\r\n2020-10-13 00:00:05,744 | INFO  | Trial 146 finished with value: 0.5921093749999997 and parameters: {'FutMargin': 220, 'KingAttackWeights[4]': 28, 'eMobilityBonus[0][2]': 76, 'eThreatByMinor[3]': 4, 'mThreatBySafePawn': 120}. Best is trial 146 with value: 0.5921093749999997.\r\nD:\\param_tuner\\Optuna-Game-Parameter-Tuner-master\\venv\\lib\\site-packages\\optuna\\samplers\\_tpe\\multivariate_parzen_estimator.py:168: RuntimeWarning: divide by zero encountered in log\r\n  log_pdf = np.log(cdf) - np.log(p_accept)\r\n```\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\n# python code\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n```\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1917/reactions", "total_count": 2, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1917/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1881", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1881/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1881/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1881/events", "html_url": "https://github.com/optuna/optuna/issues/1881", "id": 712591291, "node_id": "MDU6SXNzdWU3MTI1OTEyOTE=", "number": 1881, "title": "`visualization.plot_contour` with `suggest_categorical` that contains `str`", "user": {"login": "haenry", "id": 15144498, "node_id": "MDQ6VXNlcjE1MTQ0NDk4", "avatar_url": "https://avatars.githubusercontent.com/u/15144498?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haenry", "html_url": "https://github.com/haenry", "followers_url": "https://api.github.com/users/haenry/followers", "following_url": "https://api.github.com/users/haenry/following{/other_user}", "gists_url": "https://api.github.com/users/haenry/gists{/gist_id}", "starred_url": "https://api.github.com/users/haenry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haenry/subscriptions", "organizations_url": "https://api.github.com/users/haenry/orgs", "repos_url": "https://api.github.com/users/haenry/repos", "events_url": "https://api.github.com/users/haenry/events{/privacy}", "received_events_url": "https://api.github.com/users/haenry/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-10-01T07:50:39Z", "updated_at": "2020-10-19T07:45:00Z", "closed_at": "2020-10-19T07:45:00Z", "author_association": "NONE", "active_lock_reason": null, "body": "`plot_contour` does not support categorical string values and doesn't inform the user.\r\n\r\n## Expected behavior\r\n\r\nThe user should be informed that string values from `trial.suggest_categorical` do not work in `plot_contour`. Or the plotting function should exclude string values. Or it should support them for plotting.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.1.0 \r\n- Python version: 3.7.7\r\n- OS: Linux\r\n- (Optional) Other libraries and their versions:\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/me/workspace/service_train/src/service_train/train2/test_bug.py\", line 27, in <module>\r\n    optuna.visualization.plot_contour(study)\r\n  File \"/home/me/.cache/pypoetry/virtualenvs/test-c2Tex7wS-py3.7/lib/python3.7/site-packages/optuna/visualization/_contour.py\", line 66, in plot_contour\r\n    return _get_contour_plot(study, params)\r\n  File \"/home/me/.cache/pypoetry/virtualenvs/test-c2Tex7wS-py3.7/lib/python3.7/site-packages/optuna/visualization/_contour.py\", line 102, in _get_contour_plot\r\n    padding = (max_value - min_value) * padding_ratio\r\nTypeError: unsupported operand type(s) for -: 'str' and 'str'\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. create a study which uses `trial.suggest_categorical` with string values in the choice\r\n2. call `plot_contour` for this study\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\nimport numpy as np\r\nfrom sklearn.datasets import load_iris\r\nfrom sklearn.model_selection import train_test_split\r\nfrom sklearn.linear_model import LogisticRegression\r\n\r\nimport optuna\r\n\r\n\r\nrnd = np.random.RandomState(7)\r\n\r\nX, y = load_iris(return_X_y=True)\r\nX_train, X_valid, y_train, y_valid = train_test_split(X, y, random_state=rnd)\r\n\r\n\r\ndef objective(trial):\r\n    C = trial.suggest_float('C', 0., 7.)\r\n    solver = trial.suggest_categorical(\"solver\", ['newton-cg', 'lbfgs', 'liblinear', 'sag', 'saga'])\r\n    clf = LogisticRegression(C=C, random_state=0, solver=solver)\r\n    clf.fit(X_train, y_train)\r\n    return clf.score(X_valid, y_valid)\r\n\r\n\r\nstudy = optuna.create_study(direction='maximize')\r\nstudy.optimize(objective, n_trials=4)\r\nprint(study.best_params, study.best_value)\r\n\r\noptuna.visualization.plot_contour(study)\r\n\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1881/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1881/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1871", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1871/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1871/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1871/events", "html_url": "https://github.com/optuna/optuna/issues/1871", "id": 710669547, "node_id": "MDU6SXNzdWU3MTA2Njk1NDc=", "number": 1871, "title": "Refererence missing :module:s", "user": {"login": "crcrpar", "id": 16191443, "node_id": "MDQ6VXNlcjE2MTkxNDQz", "avatar_url": "https://avatars.githubusercontent.com/u/16191443?v=4", "gravatar_id": "", "url": "https://api.github.com/users/crcrpar", "html_url": "https://github.com/crcrpar", "followers_url": "https://api.github.com/users/crcrpar/followers", "following_url": "https://api.github.com/users/crcrpar/following{/other_user}", "gists_url": "https://api.github.com/users/crcrpar/gists{/gist_id}", "starred_url": "https://api.github.com/users/crcrpar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/crcrpar/subscriptions", "organizations_url": "https://api.github.com/users/crcrpar/orgs", "repos_url": "https://api.github.com/users/crcrpar/repos", "events_url": "https://api.github.com/users/crcrpar/events{/privacy}", "received_events_url": "https://api.github.com/users/crcrpar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1157544077, "node_id": "MDU6TGFiZWwxMTU3NTQ0MDc3", "url": "https://api.github.com/repos/optuna/optuna/labels/document", "name": "document", "color": "d60ca0", "default": false, "description": "Documentation related."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": {"login": "crcrpar", "id": 16191443, "node_id": "MDQ6VXNlcjE2MTkxNDQz", "avatar_url": "https://avatars.githubusercontent.com/u/16191443?v=4", "gravatar_id": "", "url": "https://api.github.com/users/crcrpar", "html_url": "https://github.com/crcrpar", "followers_url": "https://api.github.com/users/crcrpar/followers", "following_url": "https://api.github.com/users/crcrpar/following{/other_user}", "gists_url": "https://api.github.com/users/crcrpar/gists{/gist_id}", "starred_url": "https://api.github.com/users/crcrpar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/crcrpar/subscriptions", "organizations_url": "https://api.github.com/users/crcrpar/orgs", "repos_url": "https://api.github.com/users/crcrpar/repos", "events_url": "https://api.github.com/users/crcrpar/events{/privacy}", "received_events_url": "https://api.github.com/users/crcrpar/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "crcrpar", "id": 16191443, "node_id": "MDQ6VXNlcjE2MTkxNDQz", "avatar_url": "https://avatars.githubusercontent.com/u/16191443?v=4", "gravatar_id": "", "url": "https://api.github.com/users/crcrpar", "html_url": "https://github.com/crcrpar", "followers_url": "https://api.github.com/users/crcrpar/followers", "following_url": "https://api.github.com/users/crcrpar/following{/other_user}", "gists_url": "https://api.github.com/users/crcrpar/gists{/gist_id}", "starred_url": "https://api.github.com/users/crcrpar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/crcrpar/subscriptions", "organizations_url": "https://api.github.com/users/crcrpar/orgs", "repos_url": "https://api.github.com/users/crcrpar/repos", "events_url": "https://api.github.com/users/crcrpar/events{/privacy}", "received_events_url": "https://api.github.com/users/crcrpar/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-09-29T00:54:10Z", "updated_at": "2020-10-21T04:56:03Z", "closed_at": "2020-10-21T04:56:03Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what content in https://optuna.readthedocs.io/ is an issue. -->\r\n\r\nAs in https://optuna.readthedocs.io/en/stable/reference/visualization.html, references to `module` directives like ``` :mod:`~optuna.visualization` ``` are not working in the current documentation.\r\n\r\nThe reason is that there are no `module` definitions in docs/source/reference/**/*.rst files (This change was made in #1400 with the conjunction of the introduction of autosummary).\r\n\r\nWorse, CI has not detected this problem (I want CI to have told us this...).", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1871/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1871/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1867", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1867/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1867/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1867/events", "html_url": "https://github.com/optuna/optuna/pull/1867", "id": 709861207, "node_id": "MDExOlB1bGxSZXF1ZXN0NDkzODEyNDk4", "number": 1867, "title": "Add `matplotlib` directory to `optuna.visualization.__init__.py`", "user": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/28", "html_url": "https://github.com/optuna/optuna/milestone/28", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/28/labels", "id": 5843602, "node_id": "MDk6TWlsZXN0b25lNTg0MzYwMg==", "number": 28, "title": "v2.2.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 53, "state": "closed", "created_at": "2020-09-04T05:47:18Z", "updated_at": "2020-10-05T04:19:24Z", "due_on": null, "closed_at": "2020-10-05T04:19:24Z"}, "comments": 0, "created_at": "2020-09-28T01:11:33Z", "updated_at": "2021-05-18T04:38:48Z", "closed_at": "2020-09-29T05:10:00Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1867", "html_url": "https://github.com/optuna/optuna/pull/1867", "diff_url": "https://github.com/optuna/optuna/pull/1867.diff", "patch_url": "https://github.com/optuna/optuna/pull/1867.patch", "merged_at": "2020-09-29T05:10:00Z"}, "body": "## Motivation\r\n`matplotlib` is missed in `optuna.visualization.__init__.py`.\r\n\r\n## Description of the changes\r\nAdd `matplotlib` directory to `optuna.visualization.__init__.py`.\r\n\r\n## Before\r\n```python\r\nIn [1]: import optuna\r\n\r\nIn [2]: optuna.visualization.matplotlib.plot_edf\r\n---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-2-e8d69a155978> in <module>\r\n----> 1 optuna.visualization.matplotlib.plot_edf\r\n\r\nAttributeError: module 'optuna.visualization' has no attribute 'matplotlib'\r\n```\r\n\r\n## After\r\n```python\r\nIn [1]: import optuna\r\n\r\nIn [2]: optuna.visualization.matplotlib.plot_edf\r\nOut[2]: <function optuna.visualization.matplotlib._edf.plot_edf(study: Union[optuna.study.Study, Sequence[optuna.study.Study]]) -> matplotlib.axes._axes.Axes>\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1867/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1867/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1865", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1865/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1865/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1865/events", "html_url": "https://github.com/optuna/optuna/issues/1865", "id": 709723535, "node_id": "MDU6SXNzdWU3MDk3MjM1MzU=", "number": 1865, "title": "n_trials not respected when using database", "user": {"login": "Madman600", "id": 38760981, "node_id": "MDQ6VXNlcjM4NzYwOTgx", "avatar_url": "https://avatars.githubusercontent.com/u/38760981?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Madman600", "html_url": "https://github.com/Madman600", "followers_url": "https://api.github.com/users/Madman600/followers", "following_url": "https://api.github.com/users/Madman600/following{/other_user}", "gists_url": "https://api.github.com/users/Madman600/gists{/gist_id}", "starred_url": "https://api.github.com/users/Madman600/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Madman600/subscriptions", "organizations_url": "https://api.github.com/users/Madman600/orgs", "repos_url": "https://api.github.com/users/Madman600/repos", "events_url": "https://api.github.com/users/Madman600/events{/privacy}", "received_events_url": "https://api.github.com/users/Madman600/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2020-09-27T11:40:44Z", "updated_at": "2020-09-29T10:18:09Z", "closed_at": "2020-09-29T10:18:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "Running a study with rdb backend does not respect n_trials parameter.\r\n\r\nFor example if I modify \"First Optimization\" code to use rdb backend like so:\r\n\r\n```\r\nimport optuna\r\n\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_uniform('x', -10, 10)\r\n    return (x - 2) ** 2\r\n\r\n\r\nstorage = \"mysql://optuna@192.168.10.3/optuna\"\r\n\r\nstudy = optuna.create_study(study_name=\"test\", storage=storage, load_if_exists=True)\r\nstudy.optimize(objective, n_trials=100)\r\n\r\nprint(study.best_params)\r\n\r\nstudy.best_params\r\n\r\nstudy.best_value\r\n\r\nstudy.best_trial\r\n\r\nstudy.trials\r\n\r\nlen(study.trials)\r\n\r\nstudy.optimize(objective, n_trials=100)\r\n\r\nlen(study.trials)\r\n\r\n```\r\nThe second call to study.optimize should not execute anymore trials because we have already performed 100 trials. Instead it performs another hundred trials.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1865/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1865/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1863", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1863/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1863/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1863/events", "html_url": "https://github.com/optuna/optuna/issues/1863", "id": 709360039, "node_id": "MDU6SXNzdWU3MDkzNjAwMzk=", "number": 1863, "title": "Cythonizing Optuna", "user": {"login": "MananVyas24", "id": 7193066, "node_id": "MDQ6VXNlcjcxOTMwNjY=", "avatar_url": "https://avatars.githubusercontent.com/u/7193066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MananVyas24", "html_url": "https://github.com/MananVyas24", "followers_url": "https://api.github.com/users/MananVyas24/followers", "following_url": "https://api.github.com/users/MananVyas24/following{/other_user}", "gists_url": "https://api.github.com/users/MananVyas24/gists{/gist_id}", "starred_url": "https://api.github.com/users/MananVyas24/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MananVyas24/subscriptions", "organizations_url": "https://api.github.com/users/MananVyas24/orgs", "repos_url": "https://api.github.com/users/MananVyas24/repos", "events_url": "https://api.github.com/users/MananVyas24/events{/privacy}", "received_events_url": "https://api.github.com/users/MananVyas24/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-09-25T23:58:25Z", "updated_at": "2021-02-28T23:21:35Z", "closed_at": "2021-02-28T23:21:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am trying to create a binary *.so of Optuna.\r\n\r\n## Expected behavior\r\nCreate the *.so files of everything inside the optuna/ dir and be able to import import optuna from only the generated SO's\r\n\r\nThe import produces the following \r\nPython 3.7.7 (default, Mar 26 2020, 15:48:22) \r\n[GCC 7.3.0] :: Anaconda, Inc. on linux\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> import optuna\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"optuna/__init__.py\", line 11, in init optuna.__init__\r\n  File \"optuna/importance/__init__.py\", line 5, in init optuna.importance.__init__\r\n  File \"optuna/importance/_base.py\", line 12, in init optuna.importance._base\r\n  File \"optuna/samplers/__init__.py\", line 5, in init optuna.samplers.__init__\r\n  File \"optuna/samplers/_search_space.py\", line 8, in init optuna.samplers._search_space\r\n  File \"optuna/study.py\", line 30, in init optuna.study\r\nImportError: cannot import name samplers\r\n\r\nIs this because of presence of circular imports ? \r\nWhat is the recommended process of creating an *.so of Optuna ?\r\n\r\n## Environment\r\n\r\n- Optuna version: 1.5.0 / 2.1.0\r\n- Python version: 3.7.7\r\n- OS: Red Hat 6.5 Santiago Kernel Linux 2.6.32-431.11.2.el6.x86_64\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nPython 3.7.7 (default, Mar 26 2020, 15:48:22) \r\n[GCC 7.3.0] :: Anaconda, Inc. on linux\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> import optuna\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"optuna/__init__.py\", line 11, in init optuna.__init__\r\n  File \"optuna/importance/__init__.py\", line 5, in init optuna.importance.__init__\r\n  File \"optuna/importance/_base.py\", line 12, in init optuna.importance._base\r\n  File \"optuna/samplers/__init__.py\", line 5, in init optuna.samplers.__init__\r\n  File \"optuna/samplers/_search_space.py\", line 8, in init optuna.samplers._search_space\r\n  File \"optuna/study.py\", line 30, in init optuna.study\r\nImportError: cannot import name samplers\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Add the code mentioned in (Reproducible Examples) in setup.py\r\n2. Run : python setup.py build_ext --inplace\r\n3. In python >>>import optuna\r\n\r\n## Reproducible examples (optional)\r\nI've added the following to setup.py \r\n```python\r\nextensions = (                                                                                                                                                                         \r\n     Extension('optuna.*', ['optuna/*.py']),\r\n     Extension('optuna.importance.*',[ 'optuna/importance/*.py']),\r\n     Extension('optuna.importance._fanova*',[ 'optuna/importance/_fanova/*.py']),\r\n     Extension('optuna.integration.*',['optuna/integration/*.py']),\r\n     Extension('optuna.integration._lightgbm_tuner*',['optuna/integration/_lightgbm_tuner/*.py']),\r\n     Extension('optuna.multi_objective.*',['optuna/multi_objective/*.py']),\r\n     Extension('optuna.multi_objective.samplers.*',['optuna/multi_objective/samplers/*.py']),\r\n     Extension('optuna.multi_objective._hypervolume.*',['optuna/multi_objective/_hypervolume/*.py']),\r\n     Extension('optuna.multi_objective.visualization.*',['optuna/multi_objective/visualization/*.py']),\r\n     Extension('optuna.pruners.*',['optuna/pruners/*.py']),\r\n     Extension('optuna.samplers.*',['optuna/samplers/*.py']),\r\n     Extension('optuna.samplers._tpe.*',['optuna/samplers/_tpe/*.py']),\r\n     Extension('optuna.storages.*',['optuna/storages/*.py']),\r\n     Extension('optuna.storages._rdb.*',['optuna/storages/_rdb/*.py']),\r\n     Extension('optuna.storages._rdb.alembic.*',['optuna/storages/_rdb/alembic/*.py']),\r\n     Extension('optuna.storages._rdb.alembic.versions.*',['optuna/storages/_rdb/alembic/versions/*.py']),\r\n     Extension('optuna.testing.*',['optuna/testing/*.py']),\r\n     Extension('optuna.trial.*',['optuna/trial/*.py']),\r\n     Extension('optuna.visualization.*',['optuna/visualization/*.py']),\r\n     )\r\nsetup(\r\n    ext_modules=cythonize(extensions, language_level=\"3\", \r\n           build_dir=\"build\",                                                                                                                                               \r\n           compiler_directives=dict(always_allow_keywords=True)\r\n           ),\r\n           cmdclass=dict(build_ext=build_ext),\r\n           packages=[\"optuna\"]\r\n)\r\n\r\n```\r\n\r\n## Additional context (optional)\r\nAlthough running :\r\n\r\n```python\r\npython setup.py build_ext --inplace \r\n```\r\nProduced the SO's like ;\r\n![image](https://user-images.githubusercontent.com/7193066/94324664-a4c38e00-ff4f-11ea-91dc-478eb462fb0e.png)\r\n\r\nI am unable to import optuna after that with the following error :  ImportError: cannot import name samplers\r\nThe import produces the following \r\nPython 3.7.7 (default, Mar 26 2020, 15:48:22) \r\n[GCC 7.3.0] :: Anaconda, Inc. on linux\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> import optuna\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"optuna/__init__.py\", line 11, in init optuna.__init__\r\n  File \"optuna/importance/__init__.py\", line 5, in init optuna.importance.__init__\r\n  File \"optuna/importance/_base.py\", line 12, in init optuna.importance._base\r\n  File \"optuna/samplers/__init__.py\", line 5, in init optuna.samplers.__init__\r\n  File \"optuna/samplers/_search_space.py\", line 8, in init optuna.samplers._search_space\r\n  File \"optuna/study.py\", line 30, in init optuna.study\r\nImportError: cannot import name samplers\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1863/reactions", "total_count": 2, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 2}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1863/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1858", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1858/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1858/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1858/events", "html_url": "https://github.com/optuna/optuna/issues/1858", "id": 707972991, "node_id": "MDU6SXNzdWU3MDc5NzI5OTE=", "number": 1858, "title": "Metric MAPE direction should be reversed with reference to MAP", "user": {"login": "dileepbapat", "id": 633838, "node_id": "MDQ6VXNlcjYzMzgzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/633838?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dileepbapat", "html_url": "https://github.com/dileepbapat", "followers_url": "https://api.github.com/users/dileepbapat/followers", "following_url": "https://api.github.com/users/dileepbapat/following{/other_user}", "gists_url": "https://api.github.com/users/dileepbapat/gists{/gist_id}", "starred_url": "https://api.github.com/users/dileepbapat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dileepbapat/subscriptions", "organizations_url": "https://api.github.com/users/dileepbapat/orgs", "repos_url": "https://api.github.com/users/dileepbapat/repos", "events_url": "https://api.github.com/users/dileepbapat/events{/privacy}", "received_events_url": "https://api.github.com/users/dileepbapat/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2020-09-24T08:35:31Z", "updated_at": "2020-10-29T01:21:55Z", "closed_at": "2020-10-29T01:21:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "https://github.com/optuna/optuna/blob/9fc26c2277b347788d5554dad66dba81585716b2/optuna/integration/_lightgbm_tuner/optimize.py#L146", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1858/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1858/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1854", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1854/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1854/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1854/events", "html_url": "https://github.com/optuna/optuna/issues/1854", "id": 706337361, "node_id": "MDU6SXNzdWU3MDYzMzczNjE=", "number": 1854, "title": "Raise KeyError when fobj is passed to lgb.train", "user": {"login": "Y-oHr-N", "id": 11706038, "node_id": "MDQ6VXNlcjExNzA2MDM4", "avatar_url": "https://avatars.githubusercontent.com/u/11706038?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Y-oHr-N", "html_url": "https://github.com/Y-oHr-N", "followers_url": "https://api.github.com/users/Y-oHr-N/followers", "following_url": "https://api.github.com/users/Y-oHr-N/following{/other_user}", "gists_url": "https://api.github.com/users/Y-oHr-N/gists{/gist_id}", "starred_url": "https://api.github.com/users/Y-oHr-N/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Y-oHr-N/subscriptions", "organizations_url": "https://api.github.com/users/Y-oHr-N/orgs", "repos_url": "https://api.github.com/users/Y-oHr-N/repos", "events_url": "https://api.github.com/users/Y-oHr-N/events{/privacy}", "received_events_url": "https://api.github.com/users/Y-oHr-N/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 2107128673, "node_id": "MDU6TGFiZWwyMTA3MTI4Njcz", "url": "https://api.github.com/repos/optuna/optuna/labels/no-stale", "name": "no-stale", "color": "BBBBBB", "default": false, "description": "Exempt from stale bot"}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-09-22T12:24:50Z", "updated_at": "2020-10-10T19:16:32Z", "closed_at": "2020-10-10T19:16:31Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.1.0\r\n- Python version: Python 3.8.2\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n[I 2020-09-22 21:07:32,840] A new study created in memory with name: no-name-7c57d5c3-27a8-4238-8846-6acf2c0faf1d\r\nfeature_fraction, val_score: inf:   0%|                                                                | 0/7 [00:00<?, ?it/s][LightGBM] [Warning] Unknown parameter: feature_pre_filter\r\n[LightGBM] [Warning] Unknown parameter: feature_pre_filter\r\n[LightGBM] [Warning] Using self-defined objective function\r\n[LightGBM] [Info] Total Bins 4266\r\n[LightGBM] [Info] Number of data: 426, number of used features: 30\r\n[LightGBM] [Warning] Unknown parameter: feature_pre_filter\r\n[LightGBM] [Warning] Using self-defined objective function\r\n[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\r\n[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\r\n[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\r\n[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\r\n[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\r\n[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\r\n[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\r\n[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\r\n[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\r\n[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\r\n[W 2020-09-22 21:07:32,850] Trial 0 failed because of the following error: KeyError('binary_logloss')\r\nTraceback (most recent call last):\r\n  File \"/home/yohori/optuna/optuna/study.py\", line 778, in _run_trial\r\n    result = func(trial)\r\n  File \"/home/yohori/optuna/optuna/integration/_lightgbm_tuner/optimize.py\", line 237, in __call__\r\n    val_score = self._get_booster_best_score(booster)\r\n  File \"/home/yohori/optuna/optuna/integration/_lightgbm_tuner/optimize.py\", line 114, in _get_booster_best_score\r\n    val_score = booster.best_score[valid_name][metric]\r\nKeyError: 'binary_logloss'\r\n---------------------------------------------------------------------------\r\nKeyError                                  Traceback (most recent call last)\r\n<ipython-input-2-52c3726d7cbf> in <module>\r\n     24 dvalid = lgb.Dataset(X_valid, y_valid)\r\n     25 \r\n---> 26 booster = lgb.train(params, dtrain, valid_sets=dvalid, num_boost_round=10, fobj=loglikelihood)\r\n\r\n~/optuna/optuna/integration/_lightgbm_tuner/__init__.py in train(*args, **kwargs)\r\n     31 \r\n     32     auto_booster = LightGBMTuner(*args, **kwargs)\r\n---> 33     auto_booster.run()\r\n     34     return auto_booster.get_best_booster()\r\n\r\n~/optuna/optuna/integration/_lightgbm_tuner/optimize.py in run(self)\r\n    472         self.sample_train_set()\r\n    473 \r\n--> 474         self.tune_feature_fraction()\r\n    475         self.tune_num_leaves()\r\n    476         self.tune_bagging()\r\n\r\n~/optuna/optuna/integration/_lightgbm_tuner/optimize.py in tune_feature_fraction(self, n_trials)\r\n    497 \r\n    498         sampler = optuna.samplers.GridSampler({param_name: param_values})\r\n--> 499         self._tune_params([param_name], len(param_values), sampler, \"feature_fraction\")\r\n    500 \r\n    501     def tune_num_leaves(self, n_trials: int = 20) -> None:\r\n\r\n~/optuna/optuna/integration/_lightgbm_tuner/optimize.py in _tune_params(self, target_param_names, n_trials, sampler, step_name)\r\n    825     ) -> _OptunaObjective:\r\n    826 \r\n--> 827         objective = super(LightGBMTuner, self)._tune_params(\r\n    828             target_param_names, n_trials, sampler, step_name\r\n    829         )\r\n\r\n~/optuna/optuna/integration/_lightgbm_tuner/optimize.py in _tune_params(self, target_param_names, n_trials, sampler, step_name)\r\n    573             _timeout = None\r\n    574         if _n_trials > 0:\r\n--> 575             study.optimize(\r\n    576                 objective,\r\n    577                 n_trials=_n_trials,\r\n\r\n~/optuna/optuna/study.py in optimize(self, func, n_trials, timeout, n_jobs, catch, callbacks, gc_after_trial, show_progress_bar)\r\n    325         try:\r\n    326             if n_jobs == 1:\r\n--> 327                 self._optimize_sequential(\r\n    328                     func, n_trials, timeout, catch, callbacks, gc_after_trial, None\r\n    329                 )\r\n\r\n~/optuna/optuna/study.py in _optimize_sequential(self, func, n_trials, timeout, catch, callbacks, gc_after_trial, time_start)\r\n    724                     break\r\n    725 \r\n--> 726             self._run_trial_and_callbacks(func, catch, callbacks, gc_after_trial)\r\n    727 \r\n    728             self._progress_bar.update((datetime.datetime.now() - time_start).total_seconds())\r\n\r\n~/optuna/optuna/study.py in _run_trial_and_callbacks(self, func, catch, callbacks, gc_after_trial)\r\n    753     ) -> None:\r\n    754 \r\n--> 755         trial = self._run_trial(func, catch, gc_after_trial)\r\n    756         if callbacks is not None:\r\n    757             frozen_trial = copy.deepcopy(self._storage.get_trial(trial._trial_id))\r\n\r\n~/optuna/optuna/study.py in _run_trial(self, func, catch, gc_after_trial)\r\n    776 \r\n    777         try:\r\n--> 778             result = func(trial)\r\n    779         except exceptions.TrialPruned as e:\r\n    780             message = \"Trial {} pruned. {}\".format(trial_number, str(e))\r\n\r\n~/optuna/optuna/integration/_lightgbm_tuner/optimize.py in __call__(self, trial)\r\n    235         booster = lgb.train(self.lgbm_params, self.train_set, **self.lgbm_kwargs)\r\n    236 \r\n--> 237         val_score = self._get_booster_best_score(booster)\r\n    238         elapsed_secs = time.time() - start_time\r\n    239         average_iteration_time = elapsed_secs / booster.current_iteration()\r\n\r\n~/optuna/optuna/integration/_lightgbm_tuner/optimize.py in _get_booster_best_score(self, booster)\r\n    112             raise NotImplementedError\r\n    113 \r\n--> 114         val_score = booster.best_score[valid_name][metric]\r\n    115         return val_score\r\n    116 \r\n\r\nKeyError: 'binary_logloss'\r\n```\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\n# success\r\n# import lightgbm as lgb\r\n# failure\r\nimport optuna.integration.lightgbm as lgb\r\nimport numpy as np\r\nfrom sklearn.datasets import load_breast_cancer\r\nfrom sklearn.model_selection import train_test_split\r\n\r\n\r\ndef loglikelihood(preds, train_data): \r\n    labels = train_data.get_label() \r\n    preds = 1. / (1. + np.exp(-preds)) \r\n    grad = preds - labels \r\n    hess = preds * (1. - preds) \r\n    return grad, hess\r\n\r\n\r\nparams = {\"n_jobs\": 1, \"objective\": \"binary\", \"seed\": 0} \r\n\r\nX, y = load_breast_cancer(return_X_y=True)\r\nX, X_valid, y, y_valid = train_test_split(X, y)\r\n\r\ndtrain = lgb.Dataset(X, y)\r\ndvalid = lgb.Dataset(X_valid, y_valid)\r\n\r\nbooster = lgb.train(params, dtrain, valid_sets=dvalid, num_boost_round=10, fobj=loglikelihood)\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1854/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1854/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1849", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1849/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1849/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1849/events", "html_url": "https://github.com/optuna/optuna/pull/1849", "id": 704283124, "node_id": "MDExOlB1bGxSZXF1ZXN0NDg5MjM2NDE1", "number": 1849, "title": "Add maximize support on CmaEsSampler", "user": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/28", "html_url": "https://github.com/optuna/optuna/milestone/28", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/28/labels", "id": 5843602, "node_id": "MDk6TWlsZXN0b25lNTg0MzYwMg==", "number": 28, "title": "v2.2.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 53, "state": "closed", "created_at": "2020-09-04T05:47:18Z", "updated_at": "2020-10-05T04:19:24Z", "due_on": null, "closed_at": "2020-10-05T04:19:24Z"}, "comments": 1, "created_at": "2020-09-18T10:50:16Z", "updated_at": "2020-10-02T05:29:23Z", "closed_at": "2020-09-25T11:44:33Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1849", "html_url": "https://github.com/optuna/optuna/pull/1849", "diff_url": "https://github.com/optuna/optuna/pull/1849.diff", "patch_url": "https://github.com/optuna/optuna/pull/1849.patch", "merged_at": "2020-09-25T11:44:33Z"}, "body": "<!-- Thank you for creating a pull request! -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nFix #1848 and #1569.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\nReport `-t.value` if study direction is maximize.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1849/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1849/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1848", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1848/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1848/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1848/events", "html_url": "https://github.com/optuna/optuna/issues/1848", "id": 704273081, "node_id": "MDU6SXNzdWU3MDQyNzMwODE=", "number": 1848, "title": "CmaEsSampler support for direction='maximize'", "user": {"login": "brunofacca", "id": 13872579, "node_id": "MDQ6VXNlcjEzODcyNTc5", "avatar_url": "https://avatars.githubusercontent.com/u/13872579?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brunofacca", "html_url": "https://github.com/brunofacca", "followers_url": "https://api.github.com/users/brunofacca/followers", "following_url": "https://api.github.com/users/brunofacca/following{/other_user}", "gists_url": "https://api.github.com/users/brunofacca/gists{/gist_id}", "starred_url": "https://api.github.com/users/brunofacca/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brunofacca/subscriptions", "organizations_url": "https://api.github.com/users/brunofacca/orgs", "repos_url": "https://api.github.com/users/brunofacca/repos", "events_url": "https://api.github.com/users/brunofacca/events{/privacy}", "received_events_url": "https://api.github.com/users/brunofacca/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-09-18T10:32:49Z", "updated_at": "2020-09-25T11:44:33Z", "closed_at": "2020-09-25T11:44:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "Thank you for this great library.\r\n\r\nI may be missing something, but it seems that `optuna.samplers._cmaes.CmaEsSampler` lacks support for `direction='maximize'` and that that is not documented anywhere.\r\n\r\n## Expected behavior\r\n\r\nWhen `direction='maximize'` is passed to `optuna.create_study`, `CmaEsSampler` should try to maximize the objective.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.1.0\r\n- Python version: 3.8.5\r\n- OS: Ubuntu 20.04\r\n\r\n## Steps to reproduce\r\n\r\n1. Use the code below\r\n2. Watch as TPESampler consistently improves (increases) the objective then, after the sampler is switched to  CmaEsSampler, watch it as it consistently worsens (decreases) the objective.\r\n\r\nMaybe `direction='maximize'` is working properly in `CmaEsSampler` and it just didn't do well with my use case, but I'm using MCC as a metric and it consistently reduced the MCC up to the point of having a significant *negative* score, which indicates a negative correlation between the predictions and the actual labels of the validation data (it does not seem like a coincidence).\r\n\r\nAdditionally, I've looked at [the CmaEsSampler source](https://github.com/optuna/optuna/blob/master/optuna/samplers/_cmaes.py) and was unable to locate any code used to handle `direction='maximize'`. Maybe I've missed something, but I could clearly find such code in the [TPESampler source](https://github.com/optuna/optuna/blob/master/optuna/samplers/_tpe/sampler.py#L625). \r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\n    study = optuna.create_study(sampler=TPESampler(), direction='maximize')\r\n    study.optimize(\r\n        objective_to_maximize,\r\n        timeout=timeout_seconds*0.5,\r\n        show_progress_bar=True,\r\n        n_jobs=-1\r\n    )\r\n\r\n    study.sampler = CmaEsSampler(\r\n        restart_strategy='ipop',\r\n        consider_pruned_trials=True,\r\n        independent_sampler=TPESampler(),\r\n        warn_independent_sampling=False\r\n    )\r\n    study.optimize(\r\n        objective_to_maximize,\r\n        timeout=timeout_seconds*0.5, \r\n        show_progress_bar=True,\r\n        n_jobs=1\r\n    )\r\n\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1848/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1848/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1846", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1846/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1846/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1846/events", "html_url": "https://github.com/optuna/optuna/issues/1846", "id": 704038508, "node_id": "MDU6SXNzdWU3MDQwMzg1MDg=", "number": 1846, "title": "How to resolve `error: Cannot assign to a type` in `mypy`", "user": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-09-18T02:50:23Z", "updated_at": "2021-02-28T23:21:42Z", "closed_at": "2021-02-28T23:21:42Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\nIn PR #1804, to address the `error: Cannot assign to a type` issue for `optuna/integration/chainer.py:13:`, I just add `# type: ignore`.\r\n```python\r\nif not _imports.is_successful():\r\n    Extension = object  # type: ignore # NOQA\r\n```\r\nHowever, as pointed by @toshihikoyanase in #1804, there are the same substitutions in other places such as\r\n```python\r\n# In optuna/integration/keras.py\r\nif not _imports.is_successful():\r\n    Callback = object  # NOQA\r\n\r\n# In optuna/integration/allennlp.py\r\nif _imports.is_successful():\r\n    import _jsonnet\r\nelse:\r\n    EpochCallback = object  # NOQA\r\n```\r\nThese substitutions do not raise any `mypy` errors.\r\n\r\n## Expected behavior\r\n\r\nThere are two possibilities to addres\r\n1. We can remove `# type: ignore` from `optuna/integration/chainer.py` by some fixes.\r\n2. We have to add `#type: ignore` to `optuna/integration/{keras.py, allennlp.py}`, indeed.\r\n\r\nWe would like to clarify why the `mypy` error occurs in `optuna/integration/chainer.py` but does not in `optuna/integration/{keras.py, allennlp.py}`.\r\n\r\n## Environment\r\n\r\n- Optuna version: https://github.com/optuna/optuna/commit/5f4109020ef280eccf66db6db591892ae8aa2b2a and https://github.com/optuna/optuna/commit/ed661d57d450169cf45113d8463d3a65c56c19fe\r\n- Python version: 3.8.5\r\n- OS: macOS Catalina 10.15.6\r\n- (Optional) Other libraries and their versions: mypy 0.782\r\n\r\n## Error messages, stack traces, or logs\r\nIn https://github.com/optuna/optuna/commit/5f4109020ef280eccf66db6db591892ae8aa2b2a (before #1804 has been merged),\r\n\r\n1. `git checkout 5f4109020ef280eccf66db6db591892ae8aa2b2a`\r\n2. `pip install -e \".[testing]\"`\r\n3. `mypy .`\r\n```\r\n...\r\noptuna/integration/chainer.py:13: error: Cannot assign to a type\r\n...\r\nFound 20 errors in 6 files (checked 190 source files)\r\n```\r\n\r\nIn https://github.com/optuna/optuna/commit/ed661d57d450169cf45113d8463d3a65c56c19fe (after #1804 has been merged),\r\n\r\n1. `git checkout ed661d57d450169cf45113d8463d3a65c56c19fe`\r\n2. `pip install -e \".[testing]\"`\r\n3. `mypy .`\r\n```\r\nSuccess: no issues found in 202 source files\r\n```\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1846/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1846/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1845", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1845/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1845/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1845/events", "html_url": "https://github.com/optuna/optuna/issues/1845", "id": 703451045, "node_id": "MDU6SXNzdWU3MDM0NTEwNDU=", "number": 1845, "title": "optuna_pruner not in acceptable choices for epoch callbacks (AllenNLP)", "user": {"login": "cjber", "id": 44099524, "node_id": "MDQ6VXNlcjQ0MDk5NTI0", "avatar_url": "https://avatars.githubusercontent.com/u/44099524?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cjber", "html_url": "https://github.com/cjber", "followers_url": "https://api.github.com/users/cjber/followers", "following_url": "https://api.github.com/users/cjber/following{/other_user}", "gists_url": "https://api.github.com/users/cjber/gists{/gist_id}", "starred_url": "https://api.github.com/users/cjber/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cjber/subscriptions", "organizations_url": "https://api.github.com/users/cjber/orgs", "repos_url": "https://api.github.com/users/cjber/repos", "events_url": "https://api.github.com/users/cjber/events{/privacy}", "received_events_url": "https://api.github.com/users/cjber/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-09-17T10:08:43Z", "updated_at": "2020-09-17T15:28:52Z", "closed_at": "2020-09-17T15:28:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "Running the AllenNLP jsonnet example from [here](https://github.com/optuna/optuna/tree/master/examples/allennlp) gives the error: \r\n\r\n```\r\nallennlp.common.checks.ConfigurationError: optuna_pruner not in acceptable choices for trainer.epoch_callbacks.0.type: ['null', 'track_epoch_callback']. You should either use the --include-package flag to make sure the correct module is loaded, or use a fully qualified class name in your config file like {\"model\": \"my_module.models.MyModel\"} to have it imported automatically.\r\n```\r\n\r\n## Expected behavior\r\n\r\nThis callback is registered [here](https://github.com/optuna/optuna/blob/9d4dbb07063d0ae68f71b5f49dacccc048881472/optuna/integration/allennlp.py#L368) using `@EpochCallback.register(\"optuna_pruner\")`.\r\n\r\nSo adding it as an epoch callback to the jsonnet should work but doesn't for me:\r\n\r\n```\r\n    epoch_callbacks: [\r\n      {\r\n        type: 'optuna_pruner',\r\n      },\r\n    ],\r\n```\r\n\r\nSorry is this is more of an AllenNLP issue, I thought is ask here since it's reproducible using the optuna example.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.1.0\r\n- Python version: 3.8.5\r\n- OS: Arch Linux\r\n- (Optional) Other libraries and their versions:\r\n\r\n- Allennlp version: 1.1.0\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n[W 2020-09-17 11:04:05,065] Trial 0 failed because of the following error: ConfigurationError()\r\nTraceback (most recent call last):\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/optuna/study.py\", line 778, in _run_trial\r\n    result = func(trial)\r\n  File \"test_op.py\", line 41, in objective\r\n    return executor.run()\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/optuna/integration/allennlp.py\", line 145, in run\r\n    allennlp.commands.train.train_model(params, self._serialization_dir)\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/commands/train.py\", line 224, in train_model\r\n    model = _train_worker(\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/commands/train.py\", line 417, in _train_worker\r\n    train_loop = TrainModel.from_params(\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/common/from_params.py\", line 576, in from_params\r\n    return retyped_subclass.from_params(\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/common/from_params.py\", line 611, in from_params\r\n    return constructor_to_call(**kwargs)  # type: ignore\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/commands/train.py\", line 670, in from_partial_objects\r\n    trainer_ = trainer.construct(\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/common/lazy.py\", line 46, in construct\r\n    return self._constructor(**kwargs)\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/common/from_params.py\", line 446, in constructor\r\n    return value_cls.from_params(params=deepcopy(popped_params), **constructor_extras)\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/common/from_params.py\", line 576, in from_params\r\n    return retyped_subclass.from_params(\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/common/from_params.py\", line 609, in from_params\r\n    kwargs = create_kwargs(constructor_to_inspect, cls, params, **extras)\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/common/from_params.py\", line 180, in create_kwargs\r\n    constructed_arg = pop_and_construct_arg(\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/common/from_params.py\", line 287, in pop_and_construct_arg\r\n    return construct_arg(class_name, name, popped_params, annotation, default, **extras)\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/common/from_params.py\", line 463, in construct_arg\r\n    value = construct_arg(\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/common/from_params.py\", line 321, in construct_arg\r\n    return annotation.from_params(params=popped_params, **subextras)\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/common/from_params.py\", line 557, in from_params\r\n    choice = params.pop_choice(\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/common/params.py\", line 351, in pop_choice\r\n    raise ConfigurationError(message)\r\nallennlp.common.checks.ConfigurationError: optuna_pruner not in acceptable choices for trainer.epoch_callbacks.0.type: ['null']. You should either use the --include-package flag to make sure the correct module is loaded, or use a fully qualified class name in your config file like {\"model\": \"my_module.models.MyModel\"} to have it imported automatically.\r\nTraceback (most recent call last):\r\n  File \"test_op.py\", line 53, in <module>\r\n    study.optimize(objective, n_trials=50, timeout=600)\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/optuna/study.py\", line 327, in optimize\r\n    self._optimize_sequential(\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/optuna/study.py\", line 726, in _optimize_sequential\r\n    self._run_trial_and_callbacks(func, catch, callbacks, gc_after_trial)\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/optuna/study.py\", line 755, in _run_trial_and_callbacks\r\n    trial = self._run_trial(func, catch, gc_after_trial)\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/optuna/study.py\", line 778, in _run_trial\r\n    result = func(trial)\r\n  File \"test_op.py\", line 41, in objective\r\n    return executor.run()\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/optuna/integration/allennlp.py\", line 145, in run\r\n    allennlp.commands.train.train_model(params, self._serialization_dir)\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/commands/train.py\", line 224, in train_model\r\n    model = _train_worker(\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/commands/train.py\", line 417, in _train_worker\r\n    train_loop = TrainModel.from_params(\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/common/from_params.py\", line 576, in from_params\r\n    return retyped_subclass.from_params(\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/common/from_params.py\", line 611, in from_params\r\n    return constructor_to_call(**kwargs)  # type: ignore\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/commands/train.py\", line 670, in from_partial_objects\r\n    trainer_ = trainer.construct(\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/common/lazy.py\", line 46, in construct\r\n    return self._constructor(**kwargs)\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/common/from_params.py\", line 446, in constructor\r\n    return value_cls.from_params(params=deepcopy(popped_params), **constructor_extras)\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/common/from_params.py\", line 576, in from_params\r\n    return retyped_subclass.from_params(\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/common/from_params.py\", line 609, in from_params\r\n    kwargs = create_kwargs(constructor_to_inspect, cls, params, **extras)\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/common/from_params.py\", line 180, in create_kwargs\r\n    constructed_arg = pop_and_construct_arg(\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/common/from_params.py\", line 287, in pop_and_construct_arg\r\n    return construct_arg(class_name, name, popped_params, annotation, default, **extras)\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/common/from_params.py\", line 463, in construct_arg\r\n    value = construct_arg(\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/common/from_params.py\", line 321, in construct_arg\r\n    return annotation.from_params(params=popped_params, **subextras)\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/common/from_params.py\", line 557, in from_params\r\n    choice = params.pop_choice(\r\n  File \"/home/cjber/.pyenv/versions/py3nvim/lib/python3.8/site-packages/allennlp/common/params.py\", line 351, in pop_choice\r\n    raise ConfigurationError(message)\r\nallennlp.common.checks.ConfigurationError: optuna_pruner not in acceptable choices for trainer.epoch_callbacks.0.type: ['null']. You should either use the --include-package flag to make sure the correct module is loaded, or use a fully qualified class name in your config file like {\"model\": \"my_module.models.MyModel\"} to have it imported automatically.\r\n```\r\n\r\n## Reproducible examples (optional)\r\n\r\nSee https://github.com/optuna/optuna/tree/master/examples/allennlp\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1845/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1845/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1834", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1834/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1834/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1834/events", "html_url": "https://github.com/optuna/optuna/issues/1834", "id": 701762117, "node_id": "MDU6SXNzdWU3MDE3NjIxMTc=", "number": 1834, "title": "`visualization.plot_contour` with `suggest_categorical` that contains `None`", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 16, "created_at": "2020-09-15T09:20:17Z", "updated_at": "2020-12-14T13:54:23Z", "closed_at": "2020-12-14T13:54:23Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n## Expected behavior\r\n\r\n`visualization.plot_contour` shows an error if `params` contains a hyper-parameter that could be `None`.  But `choice` option of `suggest_categorical` can contain `None` as an element, so, I think users expect the plot functions perform in such a case.\r\n\r\nI'm not sure that the other visualisation functions have a similar issue.\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\n## Environment\r\n\r\n- Optuna version: https://github.com/optuna/optuna/tree/a4237f087ec01bcd2c181d8a1a7d553d2292b7cf\r\n- Python version: 3.8.3\r\n- OS: MacOS 10.15.6\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-1-c1f5a8612550> in <module>\r\n     24 print(study.best_params, study.best_value)\r\n     25 \r\n---> 26 optuna.visualization.plot_contour(study, params=['l1_ratio', 'C'])\r\n\r\n~/PycharmProjects/optuna/optuna/visualization/_contour.py in plot_contour(study, params)\r\n     64 \r\n     65     _imports.check()\r\n---> 66     return _get_contour_plot(study, params)\r\n     67 \r\n     68 \r\n\r\n~/PycharmProjects/optuna/optuna/visualization/_contour.py in _get_contour_plot(study, params)\r\n     93     for p_name in sorted_params:\r\n     94         values = [t.params[p_name] for t in trials if p_name in t.params]\r\n---> 95         max_value = max(values)\r\n     96         min_value = min(values)\r\n     97         if _is_log_scale(trials, p_name):\r\n\r\nTypeError: '>' not supported between instances of 'NoneType' and 'NoneType'\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Run the following example\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\nimport numpy as np\r\nfrom sklearn.datasets import load_iris\r\nfrom sklearn.model_selection import train_test_split\r\nfrom sklearn.linear_model import LogisticRegression\r\n\r\nimport optuna\r\n\r\n\r\nrnd = np.random.RandomState(7)\r\n\r\nX, y = load_iris(return_X_y=True)\r\nX_train, X_valid, y_train, y_valid = train_test_split(X, y, random_state=rnd)\r\n\r\ndef objective(trial):\r\n    l1_ratio = trial.suggest_categorical('l1_ratio', [None, 0.1])\r\n    C = trial.suggest_float('C', 0., 7.)\r\n\r\n    clf = LogisticRegression(l1_ratio=l1_ratio, C=C, random_state=0, solver=\"saga\")\r\n    clf.fit(X_train, y_train)\r\n    return clf.score(X_valid, y_valid)\r\n\r\nstudy = optuna.create_study(direction='maximize')\r\nstudy.optimize(objective, n_trials=4)\r\nprint(study.best_params, study.best_value)\r\n\r\noptuna.visualization.plot_contour(study, params=['l1_ratio', 'C'])\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1834/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1834/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1833", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1833/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1833/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1833/events", "html_url": "https://github.com/optuna/optuna/pull/1833", "id": 701599762, "node_id": "MDExOlB1bGxSZXF1ZXN0NDg3MDI1MTU1", "number": 1833, "title": "Store CMAES optimizer after splitting into substrings.", "user": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/28", "html_url": "https://github.com/optuna/optuna/milestone/28", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/28/labels", "id": 5843602, "node_id": "MDk6TWlsZXN0b25lNTg0MzYwMg==", "number": 28, "title": "v2.2.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 53, "state": "closed", "created_at": "2020-09-04T05:47:18Z", "updated_at": "2020-10-05T04:19:24Z", "due_on": null, "closed_at": "2020-10-05T04:19:24Z"}, "comments": 4, "created_at": "2020-09-15T04:34:58Z", "updated_at": "2020-09-24T11:16:05Z", "closed_at": "2020-09-24T10:51:26Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1833", "html_url": "https://github.com/optuna/optuna/pull/1833", "diff_url": "https://github.com/optuna/optuna/pull/1833.diff", "patch_url": "https://github.com/optuna/optuna/pull/1833.patch", "merged_at": "2020-09-24T10:51:26Z"}, "body": "<!-- Thank you for creating a pull request! -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nfix #1775\r\n\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\nSplit an optimizer string, puts these substrings into system_attrs.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1833/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1833/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1827", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1827/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1827/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1827/events", "html_url": "https://github.com/optuna/optuna/issues/1827", "id": 700613664, "node_id": "MDU6SXNzdWU3MDA2MTM2NjQ=", "number": 1827, "title": "Use of function in categorical breaks log_study", "user": {"login": "tbenst", "id": 863327, "node_id": "MDQ6VXNlcjg2MzMyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/863327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tbenst", "html_url": "https://github.com/tbenst", "followers_url": "https://api.github.com/users/tbenst/followers", "following_url": "https://api.github.com/users/tbenst/following{/other_user}", "gists_url": "https://api.github.com/users/tbenst/gists{/gist_id}", "starred_url": "https://api.github.com/users/tbenst/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tbenst/subscriptions", "organizations_url": "https://api.github.com/users/tbenst/orgs", "repos_url": "https://api.github.com/users/tbenst/repos", "events_url": "https://api.github.com/users/tbenst/events{/privacy}", "received_events_url": "https://api.github.com/users/tbenst/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-09-13T17:39:16Z", "updated_at": "2021-02-28T23:21:44Z", "closed_at": "2021-02-28T23:21:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Expected behavior\r\n\r\nI have this line of code: `nonlinearity = trial.suggest_categorical(\"nonlinearity\", [F.relu, F.celu, F.sigmoid, F.tanh, F.leaky_relu, F.gelu, F.hardswish])`. Log study should succeed.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.1.0\r\n- Python version: 3.8\r\n- OS: Ubuntu\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n\r\n```\r\noptuna_utils.log_study(study)\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-12-9562bbecc7f3> in <module>\r\n----> 1 optuna_utils.log_study(study)\r\n\r\n~/lib/anaconda3/envs/torch/lib/python3.8/site-packages/neptunecontrib/monitoring/optuna.py in log_study(study, experiment, log_charts, params)\r\n    143     \"\"\"\r\n    144     warnings.warn(message)\r\n--> 145     return log_study_info(study, experiment, log_charts, params)\r\n    146 \r\n    147 \r\n\r\n~/lib/anaconda3/envs/torch/lib/python3.8/site-packages/neptunecontrib/monitoring/optuna.py in log_study_info(study, experiment, log_charts, params)\r\n    132     if log_charts:\r\n    133         log_chart(name='optimization_history', chart=vis.plot_optimization_history(study), experiment=_exp)\r\n--> 134         log_chart(name='contour', chart=vis.plot_contour(study, params=params), experiment=_exp)\r\n    135         log_chart(name='parallel_coordinate', chart=vis.plot_parallel_coordinate(study, params=params), experiment=_exp)\r\n    136         log_chart(name='slice', chart=vis.plot_slice(study, params=params), experiment=_exp)\r\n\r\n~/lib/anaconda3/envs/torch/lib/python3.8/site-packages/optuna/visualization/_contour.py in plot_contour(study, params)\r\n     64 \r\n     65     _imports.check()\r\n---> 66     return _get_contour_plot(study, params)\r\n     67 \r\n     68 \r\n\r\n~/lib/anaconda3/envs/torch/lib/python3.8/site-packages/optuna/visualization/_contour.py in _get_contour_plot(study, params)\r\n     93     for p_name in sorted_params:\r\n     94         values = [t.params[p_name] for t in trials if p_name in t.params]\r\n---> 95         max_value = max(values)\r\n     96         min_value = min(values)\r\n     97         if _is_log_scale(trials, p_name):\r\n\r\nTypeError: '>' not supported between instances of 'function' and 'function'\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. In `optimize` select categorical variable among functions\r\n2. `log_study`", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1827/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1827/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1819", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1819/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1819/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1819/events", "html_url": "https://github.com/optuna/optuna/pull/1819", "id": 700092858, "node_id": "MDExOlB1bGxSZXF1ZXN0NDg1Nzc4OTIx", "number": 1819, "title": "Fix contour plot error for categorical distributions", "user": {"login": "zchenry", "id": 29617239, "node_id": "MDQ6VXNlcjI5NjE3MjM5", "avatar_url": "https://avatars.githubusercontent.com/u/29617239?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zchenry", "html_url": "https://github.com/zchenry", "followers_url": "https://api.github.com/users/zchenry/followers", "following_url": "https://api.github.com/users/zchenry/following{/other_user}", "gists_url": "https://api.github.com/users/zchenry/gists{/gist_id}", "starred_url": "https://api.github.com/users/zchenry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zchenry/subscriptions", "organizations_url": "https://api.github.com/users/zchenry/orgs", "repos_url": "https://api.github.com/users/zchenry/repos", "events_url": "https://api.github.com/users/zchenry/events{/privacy}", "received_events_url": "https://api.github.com/users/zchenry/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}, {"id": 2342192210, "node_id": "MDU6TGFiZWwyMzQyMTkyMjEw", "url": "https://api.github.com/repos/optuna/optuna/labels/sprint-20200912", "name": "sprint-20200912", "color": "93a8d8", "default": false, "description": "PR from the online sprint event Sep 12, 2020."}], "state": "closed", "locked": false, "assignee": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/28", "html_url": "https://github.com/optuna/optuna/milestone/28", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/28/labels", "id": 5843602, "node_id": "MDk6TWlsZXN0b25lNTg0MzYwMg==", "number": 28, "title": "v2.2.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 53, "state": "closed", "created_at": "2020-09-04T05:47:18Z", "updated_at": "2020-10-05T04:19:24Z", "due_on": null, "closed_at": "2020-10-05T04:19:24Z"}, "comments": 1, "created_at": "2020-09-12T06:09:15Z", "updated_at": "2020-10-05T04:42:44Z", "closed_at": "2020-09-12T10:33:52Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1819", "html_url": "https://github.com/optuna/optuna/pull/1819", "diff_url": "https://github.com/optuna/optuna/pull/1819.diff", "patch_url": "https://github.com/optuna/optuna/pull/1819.patch", "merged_at": "2020-09-12T10:33:52Z"}, "body": "## Motivation\r\nAs mentioned in https://github.com/optuna/optuna/issues/1803, error occurs when a categorical distribution of non-numerical values are used.\r\n\r\n## Description of the changes\r\nThis pull request fixed the above error. \r\n\r\nFor a categorical distribution, plotly behaves differently depending on the values.\r\n\r\n- For values such as `[\"\"sigmoid\", \"relu\", \"leakyrelu\"\"]` which cannot be converted to numbers, plotly will automatically plot it as the category type. In this case, updating the axes type will cause undesirable plots (shown below).\r\n- For values such as `[\"10\", \"11\", \"100\"]` which can be converted to numbers, plotly will plot it as normal numbers. In this case, we need to update the axes type.\r\n\r\nTherefore, I introduce a dictinary `update_category_axes` to store the above information.\r\n\r\nSample code and output:\r\n```python\r\ndef objective(trial):\r\n    x = trial.suggest_categorical(\"x\", [\"10\", \"11\", \"100\"])\r\n    y = trial.suggest_categorical(\"y\", [\"sigmoid\", \"relu\", \"leakyrelu\"])\r\n    z = trial.suggest_loguniform(\"z\", 1e-1, 1e2)\r\n    return int(\"0\" in x) + abs(len(y) - 5) + (z/50) ** 2\r\n\r\nstudy = optuna.create_study()\r\nstudy.optimize(objective, n_trials=30)\r\n\r\noptuna.visualization.plot_contour(study).show()\r\n```\r\n\r\n<img width=\"1286\" alt=\"good\" src=\"https://user-images.githubusercontent.com/29617239/92988691-cf9df300-f508-11ea-9b40-8d95745ca218.png\">\r\n\r\nFor parameter `\"y\"`, if the axes type is manually updated, the plot becomes as follows.\r\n\r\n<img width=\"1291\" alt=\"bad\" src=\"https://user-images.githubusercontent.com/29617239/92988713-fbb97400-f508-11ea-8f3f-0c5593105786.png\">\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1819/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1819/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1812", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1812/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1812/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1812/events", "html_url": "https://github.com/optuna/optuna/pull/1812", "id": 699981771, "node_id": "MDExOlB1bGxSZXF1ZXN0NDg1Njc1NjY5", "number": 1812, "title": "Fix WFG._compute()", "user": {"login": "y0z", "id": 30489874, "node_id": "MDQ6VXNlcjMwNDg5ODc0", "avatar_url": "https://avatars.githubusercontent.com/u/30489874?v=4", "gravatar_id": "", "url": "https://api.github.com/users/y0z", "html_url": "https://github.com/y0z", "followers_url": "https://api.github.com/users/y0z/followers", "following_url": "https://api.github.com/users/y0z/following{/other_user}", "gists_url": "https://api.github.com/users/y0z/gists{/gist_id}", "starred_url": "https://api.github.com/users/y0z/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/y0z/subscriptions", "organizations_url": "https://api.github.com/users/y0z/orgs", "repos_url": "https://api.github.com/users/y0z/repos", "events_url": "https://api.github.com/users/y0z/events{/privacy}", "received_events_url": "https://api.github.com/users/y0z/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 2342192210, "node_id": "MDU6TGFiZWwyMzQyMTkyMjEw", "url": "https://api.github.com/repos/optuna/optuna/labels/sprint-20200912", "name": "sprint-20200912", "color": "93a8d8", "default": false, "description": "PR from the online sprint event Sep 12, 2020."}], "state": "closed", "locked": false, "assignee": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/28", "html_url": "https://github.com/optuna/optuna/milestone/28", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/28/labels", "id": 5843602, "node_id": "MDk6TWlsZXN0b25lNTg0MzYwMg==", "number": 28, "title": "v2.2.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 53, "state": "closed", "created_at": "2020-09-04T05:47:18Z", "updated_at": "2020-10-05T04:19:24Z", "due_on": null, "closed_at": "2020-10-05T04:19:24Z"}, "comments": 0, "created_at": "2020-09-12T02:45:16Z", "updated_at": "2020-09-12T05:31:15Z", "closed_at": "2020-09-12T05:16:27Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1812", "html_url": "https://github.com/optuna/optuna/pull/1812", "diff_url": "https://github.com/optuna/optuna/pull/1812.diff", "patch_url": "https://github.com/optuna/optuna/pull/1812.patch", "merged_at": "2020-09-12T05:16:27Z"}, "body": "This PR fixes an unintended side effect that _compute() overwrites the original user-defined reference_point.\r\n\r\nReference: https://github.com/optuna/optuna/pull/1530#discussion_r487354710", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1812/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1812/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1809", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1809/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1809/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1809/events", "html_url": "https://github.com/optuna/optuna/issues/1809", "id": 699357992, "node_id": "MDU6SXNzdWU2OTkzNTc5OTI=", "number": 1809, "title": "`plot_parallel_coordinate` connects data points from different trials when `objective` function has conditional branches.", "user": {"login": "ytknzw", "id": 7210163, "node_id": "MDQ6VXNlcjcyMTAxNjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7210163?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ytknzw", "html_url": "https://github.com/ytknzw", "followers_url": "https://api.github.com/users/ytknzw/followers", "following_url": "https://api.github.com/users/ytknzw/following{/other_user}", "gists_url": "https://api.github.com/users/ytknzw/gists{/gist_id}", "starred_url": "https://api.github.com/users/ytknzw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ytknzw/subscriptions", "organizations_url": "https://api.github.com/users/ytknzw/orgs", "repos_url": "https://api.github.com/users/ytknzw/repos", "events_url": "https://api.github.com/users/ytknzw/events{/privacy}", "received_events_url": "https://api.github.com/users/ytknzw/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2020-09-11T14:03:04Z", "updated_at": "2021-09-22T23:05:34Z", "closed_at": "2021-09-22T23:05:34Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "## Expected behavior\r\nThe `plot_parallel_coordinate` function connects data points only from the same trial.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.0.0\r\n- Python version: 3.7.3\r\n- OS: macOS 10.14.6\r\n- plotly: 4.9.0\r\n\r\n## Error messages, stack traces, or logs\r\nNo error message but the `plot_parallel_coordinate` function connects data points from different trials when `objective` function has conditional branches. In the graph below, lines that go through `SVC,1` on the `classifier` axis should not go through any data point on the `rf_max_depth` axis, and lines that go through `RandomForest,0` on the `classifier` axis should not go through any data point on the `svc_c` axis.\r\n![image](https://user-images.githubusercontent.com/7210163/92930111-97e96980-f47c-11ea-84f2-ca219cb1aa77.png)\r\n\r\n## Steps to reproduce\r\n\r\n1. Run the example code below.\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\nimport sklearn.datasets\r\nimport sklearn.ensemble\r\nimport sklearn.svm\r\n\r\nimport optuna\r\nfrom optuna.visualization import plot_parallel_coordinate\r\n\r\n\r\ndef objective(trial):\r\n    iris = sklearn.datasets.load_iris()\r\n    x, y = iris.data, iris.target\r\n\r\n    classifier_name = trial.suggest_categorical(\"classifier\", [\"SVC\", \"RandomForest\"])\r\n    if classifier_name == \"SVC\":\r\n        svc_c = trial.suggest_float(\"svc_c\", 1e-10, 1e10, log=True)\r\n        classifier_obj = sklearn.svm.SVC(C=svc_c, gamma=\"auto\")\r\n    else:\r\n        rf_max_depth = trial.suggest_int(\"rf_max_depth\", 2, 32, log=True)\r\n        classifier_obj = sklearn.ensemble.RandomForestClassifier(\r\n            max_depth=rf_max_depth, n_estimators=10\r\n        )\r\n\r\n    score = sklearn.model_selection.cross_val_score(classifier_obj, x, y, n_jobs=-1, cv=3)\r\n    accuracy = score.mean()\r\n    return accuracy\r\n\r\n\r\nstudy = optuna.create_study(direction=\"maximize\")\r\nstudy.optimize(objective, n_trials=100)\r\n\r\nplot_parallel_coordinate(study).show()\r\n```\r\n\r\n## Additional context (optional)\r\nCause: the data set prepared for plotting has different numbers of data points for the `rf_max_depth` axis and the `svc_c` axis and has no `nan` value, so the values move up and the data set looks like below:\r\n\r\n|Trial|Objective value|classifier|rf_max_depth|svc_c|\r\n|---|---|---|---|---|\r\n|0|0.960375816993464|'RandomForest'|13|75.13951931369364|\r\n|1|0.960375816993464|'RandomForest'|4|0.04713959605198702|\r\n|2|0.960375816993464|'SVC'|18|2.0796584634335666e-05|\r\n|3|0.9534313725490197|'RandomForest'|3|282106030.95909935|\r\n|4|0.9342320261437909|'SVC'|2|2.473246123121966e-10|\r\n|...|...|...|...|...|\r\n\r\nwhile it should be:\r\n\r\n|Trial|Objective value|classifier|rf_max_depth|svc_c|\r\n|---|---|---|---|---|\r\n|0|0.960375816993464|'RandomForest'|13|nan|\r\n|1|0.960375816993464|'RandomForest'|4|nan|\r\n|2|0.960375816993464|'SVC'|nan|75.13951931369364|\r\n|3|0.9534313725490197|'RandomForest'|18|nan|\r\n|4|0.9342320261437909|'SVC'|nan|0.04713959605198702|\r\n|...|...|...|...|...|", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1809/reactions", "total_count": 3, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 3}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1809/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1804", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1804/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1804/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1804/events", "html_url": "https://github.com/optuna/optuna/pull/1804", "id": 697417880, "node_id": "MDExOlB1bGxSZXF1ZXN0NDgzMzYzODU0", "number": 1804, "title": "Fix `mypy` in an environment where some dependencies are installed", "user": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/28", "html_url": "https://github.com/optuna/optuna/milestone/28", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/28/labels", "id": 5843602, "node_id": "MDk6TWlsZXN0b25lNTg0MzYwMg==", "number": 28, "title": "v2.2.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 53, "state": "closed", "created_at": "2020-09-04T05:47:18Z", "updated_at": "2020-10-05T04:19:24Z", "due_on": null, "closed_at": "2020-10-05T04:19:24Z"}, "comments": 3, "created_at": "2020-09-10T04:32:54Z", "updated_at": "2021-05-18T04:38:45Z", "closed_at": "2020-09-17T09:05:00Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1804", "html_url": "https://github.com/optuna/optuna/pull/1804", "diff_url": "https://github.com/optuna/optuna/pull/1804.diff", "patch_url": "https://github.com/optuna/optuna/pull/1804.patch", "merged_at": "2020-09-17T09:05:00Z"}, "body": "## Motivation\r\nAddress the issue #1801. I have observed the same issue reported in #1801 after installing all dependencies by `pip install -e \".[testing]\"`.\r\n\r\nRelated issue: #1801 \r\n\r\n## Description of the changes\r\nChange some typing annotations and set `# type: ignore`.\r\n\r\n## Before\r\n```\r\n(venv) HideakinoMacBook-puro:optuna mamu$ mypy .\r\noptuna/dashboard.py:235: error: Argument 1 to \"coroutine\" has incompatible type \"Callable[[_DashboardApp], None]\"; expected \"Callable[..., Generator[Any, Any, <nothing>]]\"\r\noptuna/integration/chainer.py:13: error: Cannot assign to a type\r\noptuna/integration/chainer.py:13: error: Incompatible types in assignment (expression has type \"Type[object]\", variable has type \"Type[Extension]\")\r\noptuna/integration/chainer.py:74: error: Incompatible types in assignment (expression has type \"Optional[Any]\", variable has type \"Union[float, Variable]\")\r\noptuna/integration/chainer.py:77: error: Argument 1 to \"float\" has incompatible type \"Union[float, Variable]\"; expected \"Union[SupportsFloat, _SupportsIndex, str, bytes, bytearray]\"\r\ntests/test_logging.py:82: error: \"CaptureFixture\" has no attribute \"at_level\"\r\ntests/test_logging.py:84: error: \"CaptureFixture\" has no attribute \"text\"\r\ntests/test_logging.py:88: error: \"CaptureFixture\" has no attribute \"at_level\"\r\ntests/test_logging.py:90: error: \"CaptureFixture\" has no attribute \"text\"\r\ntests/test_logging.py:94: error: \"CaptureFixture\" has no attribute \"at_level\"\r\ntests/test_logging.py:96: error: \"CaptureFixture\" has no attribute \"text\"\r\ntests/integration_tests/test_fastai.py:82: error: Cannot assign to a method\r\ntests/integration_tests/test_chainer.py:47: error: Argument 3 to \"ChainerPruningExtension\" has incompatible type \"TimeTrigger\"; expected \"Union[Tuple[int, str], IntervalTrigger, ManualScheduleTrigger]\"\r\ntests/integration_tests/test_chainer.py:89: error: Argument 1 to \"__call__\" of \"ChainerPruningExtension\" has incompatible type \"_MockTrainer@83\"; expected \"Trainer\"\r\ntests/integration_tests/test_chainer.py:103: error: Argument 1 to \"_observation_exists\" of \"ChainerPruningExtension\" has incompatible type \"_MockTrainer@97\"; expected \"Trainer\"\r\ntests/integration_tests/test_chainer.py:105: error: Argument 1 to \"_observation_exists\" of \"ChainerPruningExtension\" has incompatible type \"_MockTrainer@97\"; expected \"Trainer\"\r\ntests/integration_tests/test_chainer.py:111: error: Argument 1 to \"_observation_exists\" of \"ChainerPruningExtension\" has incompatible type \"_MockTrainer@97\"; expected \"Trainer\"\r\ntests/integration_tests/test_chainer.py:113: error: Argument 1 to \"_observation_exists\" of \"ChainerPruningExtension\" has incompatible type \"_MockTrainer@97\"; expected \"Trainer\"\r\ntests/integration_tests/test_chainer.py:123: error: Argument 1 to \"_get_float_value\" of \"ChainerPruningExtension\" has incompatible type \"List[<nothing>]\"; expected \"Union[float, Variable]\"\r\nFound 19 errors in 5 files (checked 192 source files)\r\n```\r\n\r\n## After\r\n```\r\n(venv) HideakinoMacBook-puro:optuna mamu$ mypy .\r\nSuccess: no issues found in 192 source files\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1804/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1804/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1803", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1803/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1803/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1803/events", "html_url": "https://github.com/optuna/optuna/issues/1803", "id": 697044663, "node_id": "MDU6SXNzdWU2OTcwNDQ2NjM=", "number": 1803, "title": "plot_contour", "user": {"login": "z7ye", "id": 25996703, "node_id": "MDQ6VXNlcjI1OTk2NzAz", "avatar_url": "https://avatars.githubusercontent.com/u/25996703?v=4", "gravatar_id": "", "url": "https://api.github.com/users/z7ye", "html_url": "https://github.com/z7ye", "followers_url": "https://api.github.com/users/z7ye/followers", "following_url": "https://api.github.com/users/z7ye/following{/other_user}", "gists_url": "https://api.github.com/users/z7ye/gists{/gist_id}", "starred_url": "https://api.github.com/users/z7ye/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/z7ye/subscriptions", "organizations_url": "https://api.github.com/users/z7ye/orgs", "repos_url": "https://api.github.com/users/z7ye/repos", "events_url": "https://api.github.com/users/z7ye/events{/privacy}", "received_events_url": "https://api.github.com/users/z7ye/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-09-09T18:23:41Z", "updated_at": "2020-09-12T10:34:31Z", "closed_at": "2020-09-12T10:34:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n## Expected behavior\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.0.0\r\n- Python version:3.6.9\r\n- OS:LINUX\r\n- (Optional) Other libraries and their versions:\r\n\r\n## Error messages, stack traces, or logs\r\nin version 2.0.0 the code for contour plot use \"max_value - min_value\", in the case of categorical features, this will give an error. \r\n```\r\nstudy = <optuna.study.Study object at 0x7f7af7a4e0b8>, params = None\r\n\r\n      def _get_contour_plot(study: Study, params: Optional[List[str]] = None) -> \"go.Figure\":\r\n\r\n          layout = go.Layout(title=\"Contour Plot\")\r\n          trials = [trial for trial in study.trials if trial.state == TrialState.COMPLETE]\r\n          if len(trials) == 0:\r\n              _logger.warning(\"Your study does not have any completed trials.\")\r\n              return go.Figure(data=[], layout=layout)\r\n          all_params = {p_name for t in trials for p_name in t.params.keys()}\r\n          if params is None:\r\n              sorted_params = sorted(list(all_params))\r\n          elif len(params) <= 1:\r\n              _logger.warning(\"The length of params must be greater than 1.\")\r\n              return go.Figure(data=[], layout=layout)\r\n          else:\r\n >               padding = (max_value - min_value) * padding_ratio\r\n  E               TypeError: unsupported operand type(s) for -: 'str' and 'str'\r\n```\r\nIn version 1.9.0, \r\n```\r\nparam_values_range = dict()\r\n    for p_name in sorted_params:\r\n        values = [t.params[p_name] for t in trials if p_name in t.params]\r\n        param_values_range[p_name] = (min(values), max(values))\r\n```\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1803/reactions", "total_count": 2, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 2}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1803/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1793", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1793/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1793/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1793/events", "html_url": "https://github.com/optuna/optuna/issues/1793", "id": 694987525, "node_id": "MDU6SXNzdWU2OTQ5ODc1MjU=", "number": 1793, "title": "LightGBMTuner don't seem to be reproducible", "user": {"login": "RegiusQuant", "id": 36260888, "node_id": "MDQ6VXNlcjM2MjYwODg4", "avatar_url": "https://avatars.githubusercontent.com/u/36260888?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RegiusQuant", "html_url": "https://github.com/RegiusQuant", "followers_url": "https://api.github.com/users/RegiusQuant/followers", "following_url": "https://api.github.com/users/RegiusQuant/following{/other_user}", "gists_url": "https://api.github.com/users/RegiusQuant/gists{/gist_id}", "starred_url": "https://api.github.com/users/RegiusQuant/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RegiusQuant/subscriptions", "organizations_url": "https://api.github.com/users/RegiusQuant/orgs", "repos_url": "https://api.github.com/users/RegiusQuant/repos", "events_url": "https://api.github.com/users/RegiusQuant/events{/privacy}", "received_events_url": "https://api.github.com/users/RegiusQuant/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 15, "created_at": "2020-09-07T11:05:07Z", "updated_at": "2021-07-01T04:15:04Z", "closed_at": "2021-07-01T04:15:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n## Expected behavior\r\n\r\nI use LightGBMTuner to find params, but each run on the same dataset has different results\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.1.0\r\n- Python version: 3.8.5\r\n- OS: Linux\r\n- (Optional) Other libraries and their versions:\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n# error messages, stack traces, or logs\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1.\r\n2.\r\n3.\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\n# python code\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1793/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1793/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1790", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1790/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1790/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1790/events", "html_url": "https://github.com/optuna/optuna/pull/1790", "id": 694680985, "node_id": "MDExOlB1bGxSZXF1ZXN0NDgxMDI2MzY4", "number": 1790, "title": "[Backport] Fix fANOVA for `IntLogUniformDistribution`", "user": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1964887919, "node_id": "MDU6TGFiZWwxOTY0ODg3OTE5", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.importance", "name": "optuna.importance", "color": "1c659e", "default": false, "description": "Related to the `optuna.importance` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/27", "html_url": "https://github.com/optuna/optuna/milestone/27", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/27/labels", "id": 5659347, "node_id": "MDk6TWlsZXN0b25lNTY1OTM0Nw==", "number": 27, "title": "v2.1.0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 136, "state": "closed", "created_at": "2020-07-16T04:33:10Z", "updated_at": "2020-09-07T04:28:07Z", "due_on": null, "closed_at": "2020-09-07T04:28:07Z"}, "comments": 0, "created_at": "2020-09-07T04:06:27Z", "updated_at": "2020-09-07T04:23:16Z", "closed_at": "2020-09-07T04:23:09Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1790", "html_url": "https://github.com/optuna/optuna/pull/1790", "diff_url": "https://github.com/optuna/optuna/pull/1790.diff", "patch_url": "https://github.com/optuna/optuna/pull/1790.patch", "merged_at": "2020-09-07T04:23:09Z"}, "body": "Backport of https://github.com/optuna/optuna/pull/1788 for v2.1.0.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1790/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1790/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1788", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1788/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1788/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1788/events", "html_url": "https://github.com/optuna/optuna/pull/1788", "id": 693789494, "node_id": "MDExOlB1bGxSZXF1ZXN0NDgwMjU1NTYz", "number": 1788, "title": "Fix fANOVA for `IntLogUniformDistribution`", "user": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1964887919, "node_id": "MDU6TGFiZWwxOTY0ODg3OTE5", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.importance", "name": "optuna.importance", "color": "1c659e", "default": false, "description": "Related to the `optuna.importance` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/28", "html_url": "https://github.com/optuna/optuna/milestone/28", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/28/labels", "id": 5843602, "node_id": "MDk6TWlsZXN0b25lNTg0MzYwMg==", "number": 28, "title": "v2.2.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 53, "state": "closed", "created_at": "2020-09-04T05:47:18Z", "updated_at": "2020-10-05T04:19:24Z", "due_on": null, "closed_at": "2020-10-05T04:19:24Z"}, "comments": 0, "created_at": "2020-09-04T23:12:34Z", "updated_at": "2020-09-07T04:23:17Z", "closed_at": "2020-09-05T08:46:49Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1788", "html_url": "https://github.com/optuna/optuna/pull/1788", "diff_url": "https://github.com/optuna/optuna/pull/1788.diff", "patch_url": "https://github.com/optuna/optuna/pull/1788.patch", "merged_at": "2020-09-05T08:46:49Z"}, "body": "## Motivation\r\n\r\nSee below.\r\n\r\n## Description of the changes\r\n\r\nFixes a bug in fANOVA where `IntLogUniformDistribution` parameters used to raise an assertion error.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1788/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1788/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1776", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1776/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1776/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1776/events", "html_url": "https://github.com/optuna/optuna/pull/1776", "id": 689983980, "node_id": "MDExOlB1bGxSZXF1ZXN0NDc2OTQ4NDMz", "number": 1776, "title": "Add share_optimizer option on CmaEsSampler", "user": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1201493645, "node_id": "MDU6TGFiZWwxMjAxNDkzNjQ1", "url": "https://api.github.com/repos/optuna/optuna/labels/compatibility", "name": "compatibility", "color": "0778ea", "default": false, "description": "Change that breaks compatibility."}, {"id": 1904423825, "node_id": "MDU6TGFiZWwxOTA0NDIzODI1", "url": "https://api.github.com/repos/optuna/optuna/labels/needs-discussion", "name": "needs-discussion", "color": "e99695", "default": false, "description": "Issue/PR which needs discussion."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2020-09-01T09:28:58Z", "updated_at": "2020-09-15T09:51:51Z", "closed_at": "2020-09-15T09:51:26Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1776", "html_url": "https://github.com/optuna/optuna/pull/1776", "diff_url": "https://github.com/optuna/optuna/pull/1776.diff", "patch_url": "https://github.com/optuna/optuna/pull/1776.patch", "merged_at": null}, "body": "<!-- Thank you for creating a pull request! -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\nfix #1775 \r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\n* Add `share_optimizer` option which enables to store CMA object in system_attrs (default: False).\r\n* Add `randomize_x0` option to sample initial starting points randomly.\r\n\r\n## Discussion points\r\n\r\n###  Which ones should be set as a default argument, `share_optimizer=False` or `share_optimizer=True`?\r\n\r\n* Set `share_optimizer=False` from the next release: Existing users may be confused by this breaking change. From the next release, CmaEsSampler cannot resume optimizations.\r\n* Set `share_optimizer=True` until v3.0.0 release: It keeps current behavior. New users may be confused because this option does not work with PostgreSQL and MySQL.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1776/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1776/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1775", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1775/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1775/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1775/events", "html_url": "https://github.com/optuna/optuna/issues/1775", "id": 689935792, "node_id": "MDU6SXNzdWU2ODk5MzU3OTI=", "number": 1775, "title": "Cannot store CMA object on PostgreSQL and MySQL.", "user": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 2107128673, "node_id": "MDU6TGFiZWwyMTA3MTI4Njcz", "url": "https://api.github.com/repos/optuna/optuna/labels/no-stale", "name": "no-stale", "color": "BBBBBB", "default": false, "description": "Exempt from stale bot"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-09-01T08:25:04Z", "updated_at": "2020-09-24T10:51:26Z", "closed_at": "2020-09-24T10:51:26Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n## Problem details\r\n\r\nThis bug is reported by @maartenpants on gitter. Original report is here:\r\n\r\n> Hi there, has anyone else experienced this issue with CmaEsSampler and the PostgreSQL storage backend:\r\n> ```\r\n> (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(2048)\r\n> [SQL: INSERT INTO trial_system_attributes (trial_id, key, value_json) VALUES (%(trial_id)s, %(key)s, %(value_json)s) RETURNING trial_system_attributes.trial_system_attribute_id]\r\n> ```\r\n> It seems the serialized version of the CMA class is too large to fit in the 2048 character column. This code is the culprit:\r\n> ```\r\n> optimizer_str = pickle.dumps(optimizer).hex()\r\n> study._storage.set_trial_system_attr(trial._trial_id, \"cma:optimizer\", optimizer_str)\r\n> ```\r\n\r\nhttps://gitter.im/optuna/optuna?at=5f484dea36e6f709fd08a5fa\r\n\r\nI checked the length of serialized CMA object.\r\n\r\n```python\r\nimport pickle\r\n\r\nimport numpy as np\r\nfrom cmaes import CMA\r\n\r\n\r\ndef get_cma_object_size(dim: int) -> int:\r\n    optimizer = CMA(mean=np.zeros(dim), sigma=1.3)\r\n    optimizer_str = pickle.dumps(optimizer).hex()\r\n    return len(optimizer_str)\r\n\r\n\r\nif __name__ == '__main__':\r\n    for i in range(2, 32, 2):\r\n        print(f\"dim={i} size={get_cma_object_size(i)}\")\r\n```\r\n\r\n```\r\n$ python examples/cma_size.py \r\ndim=2 size=2516\r\ndim=4 size=2916\r\ndim=6 size=3364\r\ndim=8 size=3850\r\ndim=10 size=4442\r\ndim=12 size=5018\r\ndim=14 size=5738\r\ndim=16 size=6378\r\ndim=18 size=7194\r\ndim=20 size=8074\r\ndim=22 size=8906\r\ndim=24 size=9916\r\ndim=26 size=10956\r\ndim=28 size=12092\r\ndim=30 size=13148\r\n```\r\n\r\nThis result means that the bug is raised even on low-dimensional search space.\r\n\r\n## Additional context (optional)\r\n\r\nI've ever tested on SQLite3 but never bumped into this bug. The reason why is:\r\n\r\n> (9) What is the maximum size of a VARCHAR in SQLite?\r\n> SQLite does not enforce the length of a VARCHAR. You can declare a VARCHAR(10) and SQLite will be happy to store a 500-million character string there. And it will keep all 500-million characters intact. Your content is never truncated. SQLite understands the column type of \"VARCHAR(N)\" to be the same as \"TEXT\", regardless of the value of N.\r\n> https://www.sqlite.org/faq.html#:~:text=(9)%20What%20is%20the%20maximum,all%20500%2Dmillion%20characters%20intact.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1775/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1775/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1774", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1774/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1774/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1774/events", "html_url": "https://github.com/optuna/optuna/pull/1774", "id": 689827927, "node_id": "MDExOlB1bGxSZXF1ZXN0NDc2ODIzMTk1", "number": 1774, "title": "Disable `feature_pre_filter` in `LightGBMTuner`", "user": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561256, "node_id": "MDU6TGFiZWwxOTQ3NTYxMjU2", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.integration", "name": "optuna.integration", "color": "1c659e", "default": false, "description": "Related to the `optuna.integration` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/27", "html_url": "https://github.com/optuna/optuna/milestone/27", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/27/labels", "id": 5659347, "node_id": "MDk6TWlsZXN0b25lNTY1OTM0Nw==", "number": 27, "title": "v2.1.0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 136, "state": "closed", "created_at": "2020-07-16T04:33:10Z", "updated_at": "2020-09-07T04:28:07Z", "due_on": null, "closed_at": "2020-09-07T04:28:07Z"}, "comments": 1, "created_at": "2020-09-01T05:36:01Z", "updated_at": "2020-09-03T00:46:35Z", "closed_at": "2020-09-02T12:21:48Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1774", "html_url": "https://github.com/optuna/optuna/pull/1774", "diff_url": "https://github.com/optuna/optuna/pull/1774.diff", "patch_url": "https://github.com/optuna/optuna/pull/1774.patch", "merged_at": "2020-09-02T12:21:48Z"}, "body": "## Motivation\r\n\r\nFixes https://github.com/optuna/optuna/issues/1718.\r\n\r\n## Description of the changes\r\n\r\nAlways disables `feature_pre_filter`. See the above issue for details.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1774/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1774/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1765", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1765/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1765/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1765/events", "html_url": "https://github.com/optuna/optuna/issues/1765", "id": 688741570, "node_id": "MDU6SXNzdWU2ODg3NDE1NzA=", "number": 1765, "title": "Lightning example \"Address already in use\" error ddp (single/multi GPU)", "user": {"login": "bartmch", "id": 10415569, "node_id": "MDQ6VXNlcjEwNDE1NTY5", "avatar_url": "https://avatars.githubusercontent.com/u/10415569?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bartmch", "html_url": "https://github.com/bartmch", "followers_url": "https://api.github.com/users/bartmch/followers", "following_url": "https://api.github.com/users/bartmch/following{/other_user}", "gists_url": "https://api.github.com/users/bartmch/gists{/gist_id}", "starred_url": "https://api.github.com/users/bartmch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bartmch/subscriptions", "organizations_url": "https://api.github.com/users/bartmch/orgs", "repos_url": "https://api.github.com/users/bartmch/repos", "events_url": "https://api.github.com/users/bartmch/events{/privacy}", "received_events_url": "https://api.github.com/users/bartmch/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-08-30T15:44:29Z", "updated_at": "2021-02-28T23:21:54Z", "closed_at": "2021-02-28T23:21:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\nUsing the \"pytorch_lightning_simple.py\" example and adding the distributed_backend='ddp' option in pl.Trainer. It isn't working on one or more GPU's\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\n## Environment\r\n\r\n- Optuna version: optuna (2.0.0)\r\n- Python version: 3.7\r\n- OS: Linux Ubuntu\r\n- (Optional) Other libraries and their versions: pytorch-lightning (0.9.0), torch (1.6.0), torchvision (0.4.2) \r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nGPU available: True, used: True\r\nTPU available: False, using: 0 TPU cores\r\nCUDA_VISIBLE_DEVICES: [0]\r\n/home/bart.michiels/test_optuna/.venv/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:37: UserWarning: WORLD_SIZE environment variable (2) is not equal to the computed world size (1). Ignored.\r\n  warnings.warn(*args, **kwargs)\r\ninitializing ddp: GLOBAL_RANK: 0, MEMBER: 1/1\r\n----------------------------------------------------------------------------------------------------\r\ndistributed_backend=ddp\r\nAll DDP processes registered. Starting ddp with 1 processes\r\n----------------------------------------------------------------------------------------------------\r\n\r\n  | Name  | Type | Params\r\n-------------------------------\r\n0 | model | Net  | 3 K   \r\n/home/bart.michiels/test_optuna/.venv/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:37: UserWarning: The dataloader, val dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 80 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.\r\n  warnings.warn(*args, **kwargs)\r\n/home/bart.michiels/test_optuna/.venv/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:37: UserWarning: The dataloader, train dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 80 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.\r\n  warnings.warn(*args, **kwargs)\r\nEpoch 2: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588Saving latest checkpoint..\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 476/476 [00:07<00:00, 63.27it/s, loss=1.923]\r\nEpoch 2: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 476/476 [00:07<00:00, 63.26it/s, loss=1.923]\r\n[I 2020-08-30 19:43:02,990] Trial 0 finished with value: 0.3950892984867096 and parameters: {'n_layers': 3, 'dropout': 0.4634065756224022, 'n_units_l0': 4, 'n_units_l1': 16, 'n_units_l2': 13}. Best is trial 0 with value: 0.3950892984867096.\r\nGPU available: True, used: True\r\nTPU available: False, using: 0 TPU cores\r\nUsing environment variable NODE_RANK for node rank (0).\r\nCUDA_VISIBLE_DEVICES: [0]\r\ninitializing ddp: GLOBAL_RANK: 0, MEMBER: 1/1\r\n[W 2020-08-30 19:43:02,996] Trial 1 failed because of the following error: RuntimeError('Address already in use',)\r\nTraceback (most recent call last):\r\n  File \"/home/bart.michiels/test_optuna/.venv/lib/python3.6/site-packages/optuna/study.py\", line 709, in _run_trial\r\n    result = func(trial)\r\n  File \"test.py\", line 153, in objective\r\n    trainer.fit(model)\r\n  File \"/home/bart.michiels/test_optuna/.venv/lib/python3.6/site-packages/pytorch_lightning/trainer/states.py\", line 48, in wrapped_fn\r\n    result = fn(self, *args, **kwargs)\r\n  File \"/home/bart.michiels/test_optuna/.venv/lib/python3.6/site-packages/pytorch_lightning/trainer/trainer.py\", line 1058, in fit\r\n    results = self.accelerator_backend.spawn_ddp_children(model)\r\n  File \"/home/bart.michiels/test_optuna/.venv/lib/python3.6/site-packages/pytorch_lightning/accelerators/ddp_backend.py\", line 123, in spawn_ddp_children\r\n    results = self.ddp_train(local_rank, mp_queue=None, model=model, is_master=True)\r\n  File \"/home/bart.michiels/test_optuna/.venv/lib/python3.6/site-packages/pytorch_lightning/accelerators/ddp_backend.py\", line 164, in ddp_train\r\n    self.trainer.is_slurm_managing_tasks\r\n  File \"/home/bart.michiels/test_optuna/.venv/lib/python3.6/site-packages/pytorch_lightning/core/lightning.py\", line 908, in init_ddp_connection\r\n    torch_distrib.init_process_group(torch_backend, rank=global_rank, world_size=world_size)\r\n  File \"/home/bart.michiels/test_optuna/.venv/lib/python3.6/site-packages/torch/distributed/distributed_c10d.py\", line 422, in init_process_group\r\n    store, rank, world_size = next(rendezvous_iterator)\r\n  File \"/home/bart.michiels/test_optuna/.venv/lib/python3.6/site-packages/torch/distributed/rendezvous.py\", line 172, in _env_rendezvous_handler\r\n    store = TCPStore(master_addr, master_port, world_size, start_daemon, timeout)\r\nRuntimeError: Address already in use\r\nTraceback (most recent call last):\r\n  File \"test.py\", line 172, in <module>\r\n    study.optimize(objective, n_trials=100, timeout=600)\r\n  File \"/home/bart.michiels/test_optuna/.venv/lib/python3.6/site-packages/optuna/study.py\", line 292, in optimize\r\n    func, n_trials, timeout, catch, callbacks, gc_after_trial, None\r\n  File \"/home/bart.michiels/test_optuna/.venv/lib/python3.6/site-packages/optuna/study.py\", line 654, in _optimize_sequential\r\n    self._run_trial_and_callbacks(func, catch, callbacks, gc_after_trial)\r\n  File \"/home/bart.michiels/test_optuna/.venv/lib/python3.6/site-packages/optuna/study.py\", line 685, in _run_trial_and_callbacks\r\n    trial = self._run_trial(func, catch, gc_after_trial)\r\n  File \"/home/bart.michiels/test_optuna/.venv/lib/python3.6/site-packages/optuna/study.py\", line 709, in _run_trial\r\n    result = func(trial)\r\n  File \"test.py\", line 153, in objective\r\n    trainer.fit(model)\r\n  File \"/home/bart.michiels/test_optuna/.venv/lib/python3.6/site-packages/pytorch_lightning/trainer/states.py\", line 48, in wrapped_fn\r\n    result = fn(self, *args, **kwargs)\r\n  File \"/home/bart.michiels/test_optuna/.venv/lib/python3.6/site-packages/pytorch_lightning/trainer/trainer.py\", line 1058, in fit\r\n    results = self.accelerator_backend.spawn_ddp_children(model)\r\n  File \"/home/bart.michiels/test_optuna/.venv/lib/python3.6/site-packages/pytorch_lightning/accelerators/ddp_backend.py\", line 123, in spawn_ddp_children\r\n    results = self.ddp_train(local_rank, mp_queue=None, model=model, is_master=True)\r\n  File \"/home/bart.michiels/test_optuna/.venv/lib/python3.6/site-packages/pytorch_lightning/accelerators/ddp_backend.py\", line 164, in ddp_train\r\n    self.trainer.is_slurm_managing_tasks\r\n  File \"/home/bart.michiels/test_optuna/.venv/lib/python3.6/site-packages/pytorch_lightning/core/lightning.py\", line 908, in init_ddp_connection\r\n    torch_distrib.init_process_group(torch_backend, rank=global_rank, world_size=world_size)\r\n  File \"/home/bart.michiels/test_optuna/.venv/lib/python3.6/site-packages/torch/distributed/distributed_c10d.py\", line 422, in init_process_group\r\n    store, rank, world_size = next(rendezvous_iterator)\r\n  File \"/home/bart.michiels/test_optuna/.venv/lib/python3.6/site-packages/torch/distributed/rendezvous.py\", line 172, in _env_rendezvous_handler\r\n    store = TCPStore(master_addr, master_port, world_size, start_daemon, timeout)\r\nRuntimeError: Address already in use\r\n```\r\n\r\n## Steps to reproduce\r\n\r\nUsing the \"pytorch_lightning_simple.py\" example and adding the distributed_backend='ddp' option in pl.Trainer. It isn't working on one or more GPU's\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1765/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1765/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1739", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1739/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1739/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1739/events", "html_url": "https://github.com/optuna/optuna/issues/1739", "id": 687834162, "node_id": "MDU6SXNzdWU2ODc4MzQxNjI=", "number": 1739, "title": "ubuntu pip install error", "user": {"login": "yuanjie-ai", "id": 20265321, "node_id": "MDQ6VXNlcjIwMjY1MzIx", "avatar_url": "https://avatars.githubusercontent.com/u/20265321?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yuanjie-ai", "html_url": "https://github.com/yuanjie-ai", "followers_url": "https://api.github.com/users/yuanjie-ai/followers", "following_url": "https://api.github.com/users/yuanjie-ai/following{/other_user}", "gists_url": "https://api.github.com/users/yuanjie-ai/gists{/gist_id}", "starred_url": "https://api.github.com/users/yuanjie-ai/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yuanjie-ai/subscriptions", "organizations_url": "https://api.github.com/users/yuanjie-ai/orgs", "repos_url": "https://api.github.com/users/yuanjie-ai/repos", "events_url": "https://api.github.com/users/yuanjie-ai/events{/privacy}", "received_events_url": "https://api.github.com/users/yuanjie-ai/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2020-08-28T06:51:51Z", "updated_at": "2021-02-28T23:21:59Z", "closed_at": "2021-02-28T23:21:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "![image](https://user-images.githubusercontent.com/20265321/91530606-fa4f4f80-e93d-11ea-9653-946a3c7e653e.png)\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1739/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1739/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1738", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1738/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1738/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1738/events", "html_url": "https://github.com/optuna/optuna/issues/1738", "id": 687798724, "node_id": "MDU6SXNzdWU2ODc3OTg3MjQ=", "number": 1738, "title": "import optuna.integration.lightgbm as lgb", "user": {"login": "yuanjie-ai", "id": 20265321, "node_id": "MDQ6VXNlcjIwMjY1MzIx", "avatar_url": "https://avatars.githubusercontent.com/u/20265321?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yuanjie-ai", "html_url": "https://github.com/yuanjie-ai", "followers_url": "https://api.github.com/users/yuanjie-ai/followers", "following_url": "https://api.github.com/users/yuanjie-ai/following{/other_user}", "gists_url": "https://api.github.com/users/yuanjie-ai/gists{/gist_id}", "starred_url": "https://api.github.com/users/yuanjie-ai/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yuanjie-ai/subscriptions", "organizations_url": "https://api.github.com/users/yuanjie-ai/orgs", "repos_url": "https://api.github.com/users/yuanjie-ai/repos", "events_url": "https://api.github.com/users/yuanjie-ai/events{/privacy}", "received_events_url": "https://api.github.com/users/yuanjie-ai/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-08-28T06:30:26Z", "updated_at": "2020-09-02T01:56:07Z", "closed_at": "2020-09-02T01:56:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-57-4d0f80b09927> in <module>\r\n----> 1 import optuna.integration.lightgbm as lgb\r\n\r\n~/anaconda3/lib/python3.7/site-packages/optuna/integration/lightgbm.py in <module>\r\n      4 \r\n      5 from optuna._imports import try_import\r\n----> 6 from optuna.integration import _lightgbm_tuner as tuner\r\n      7 \r\n      8 \r\n\r\n~/anaconda3/lib/python3.7/site-packages/optuna/integration/_lightgbm_tuner/__init__.py in <module>\r\n      1 from typing import Any\r\n      2 \r\n----> 3 from optuna.integration._lightgbm_tuner.optimize import _imports as _imports\r\n      4 from optuna.integration._lightgbm_tuner.optimize import LightGBMTuner\r\n      5 from optuna.integration._lightgbm_tuner.optimize import LightGBMTunerCV  # NOQA\r\n\r\n~/anaconda3/lib/python3.7/site-packages/optuna/integration/_lightgbm_tuner/optimize.py in <module>\r\n    631 \r\n    632 \r\n--> 633 class LightGBMTuner(_LightGBMBaseTuner):\r\n    634     \"\"\"Hyperparameter tuner for LightGBM.\r\n    635 \r\n\r\n~/anaconda3/lib/python3.7/site-packages/optuna/integration/_lightgbm_tuner/optimize.py in LightGBMTuner()\r\n    759         \"1.4.0\",\r\n    760         text=(\r\n--> 761             \"Please get the best booster via \"\r\n    762             \":class:`~optuna.integration.lightgbm.LightGBMTuner.get_best_booster` instead.\"\r\n    763         ),\r\n\r\n~/anaconda3/lib/python3.7/site-packages/optuna/_deprecated.py in deprecated(deprecated_version, removed_version, name, text)\r\n     75     _validate_version(deprecated_version)\r\n     76     if removed_version is None:\r\n---> 77         removed_version = _get_removed_version_from_deprecated_version(deprecated_version)\r\n     78     _validate_version(removed_version)\r\n     79     _validate_two_version(deprecated_version, removed_version)\r\n\r\n~/anaconda3/lib/python3.7/site-packages/optuna/_deprecated.py in _get_removed_version_from_deprecated_version(deprecated_version)\r\n     37     parsed_deprecated_version = version.parse(deprecated_version)\r\n     38     assert isinstance(parsed_deprecated_version, version.Version)  # Required for mypy.\r\n---> 39     return \"{}.0.0\".format(parsed_deprecated_version.major + 2)\r\n     40 \r\n     41 \r\n\r\nAttributeError: 'Version' object has no attribute 'major'", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1738/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1738/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1734", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1734/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1734/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1734/events", "html_url": "https://github.com/optuna/optuna/issues/1734", "id": 687424302, "node_id": "MDU6SXNzdWU2ODc0MjQzMDI=", "number": 1734, "title": "[Bug] No module named 'optuna.storages.in_memory'", "user": {"login": "Chengyao-Peng", "id": 54242785, "node_id": "MDQ6VXNlcjU0MjQyNzg1", "avatar_url": "https://avatars.githubusercontent.com/u/54242785?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Chengyao-Peng", "html_url": "https://github.com/Chengyao-Peng", "followers_url": "https://api.github.com/users/Chengyao-Peng/followers", "following_url": "https://api.github.com/users/Chengyao-Peng/following{/other_user}", "gists_url": "https://api.github.com/users/Chengyao-Peng/gists{/gist_id}", "starred_url": "https://api.github.com/users/Chengyao-Peng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Chengyao-Peng/subscriptions", "organizations_url": "https://api.github.com/users/Chengyao-Peng/orgs", "repos_url": "https://api.github.com/users/Chengyao-Peng/repos", "events_url": "https://api.github.com/users/Chengyao-Peng/events{/privacy}", "received_events_url": "https://api.github.com/users/Chengyao-Peng/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-08-27T17:41:51Z", "updated_at": "2021-02-28T23:22:01Z", "closed_at": "2021-02-28T23:22:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\nNo module named 'optuna.storages.in_memory' when loading in-memory studies.\r\n## Expected behavior\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\nIn-memory studies should be able to be loaded again by joblib or pickle.\r\n## Environment\r\n\r\n- Optuna version: 2.0.0\r\n- Python version: 3.7.3\r\n- OS: Linux\r\n- (Optional) Other libraries and their versions:\r\njoblib\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nModuleNotFoundError                       Traceback (most recent call last)\r\n<ipython-input-15-450c43275578> in <module>\r\n----> 1 study = joblib.load('node2vec_optimization/study100.pkl')\r\n\r\n~/anaconda3/envs/cada/lib/python3.7/site-packages/joblib/numpy_pickle.py in load(filename, mmap_mode)\r\n    583                     return load_compatibility(fobj)\r\n    584 \r\n--> 585                 obj = _unpickle(fobj, filename, mmap_mode)\r\n    586     return obj\r\n\r\n~/anaconda3/envs/cada/lib/python3.7/site-packages/joblib/numpy_pickle.py in _unpickle(fobj, filename, mmap_mode)\r\n    502     obj = None\r\n    503     try:\r\n--> 504         obj = unpickler.load()\r\n    505         if unpickler.compat_mode:\r\n    506             warnings.warn(\"The file '%s' has been generated with a \"\r\n\r\n~/anaconda3/envs/cada/lib/python3.7/pickle.py in load(self)\r\n   1086                     raise EOFError\r\n   1087                 assert isinstance(key, bytes_types)\r\n-> 1088                 dispatch[key[0]](self)\r\n   1089         except _Stop as stopinst:\r\n   1090             return stopinst.value\r\n\r\n~/anaconda3/envs/cada/lib/python3.7/pickle.py in load_global(self)\r\n   1374         module = self.readline()[:-1].decode(\"utf-8\")\r\n   1375         name = self.readline()[:-1].decode(\"utf-8\")\r\n-> 1376         klass = self.find_class(module, name)\r\n   1377         self.append(klass)\r\n   1378     dispatch[GLOBAL[0]] = load_global\r\n\r\n~/anaconda3/envs/cada/lib/python3.7/pickle.py in find_class(self, module, name)\r\n   1424             elif module in _compat_pickle.IMPORT_MAPPING:\r\n   1425                 module = _compat_pickle.IMPORT_MAPPING[module]\r\n-> 1426         __import__(module, level=0)\r\n   1427         if self.proto >= 4:\r\n   1428             return _getattribute(sys.modules[module], name)[0]```\r\n---------------------------------------------------------------------------\r\nNo module named 'optuna.storages.in_memory'\r\n\r\n## Steps to reproduce\r\n\r\n1. create a study\r\n2. dump it using joblib.dump\r\n3. load it again with joblib.load\r\n## Reproducible examples (optional)\r\n\r\n```python\r\nstudy = optuna.create_study()\r\njoblib.dump(study, 'study.pkl')\r\nstudy = joblib.load('study.pkl')\r\n\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1734/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1734/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1727", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1727/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1727/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1727/events", "html_url": "https://github.com/optuna/optuna/issues/1727", "id": 686511267, "node_id": "MDU6SXNzdWU2ODY1MTEyNjc=", "number": 1727, "title": "ERROR while running optuna on a customized gym environment", "user": {"login": "meric-sakarya", "id": 38434300, "node_id": "MDQ6VXNlcjM4NDM0MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/38434300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/meric-sakarya", "html_url": "https://github.com/meric-sakarya", "followers_url": "https://api.github.com/users/meric-sakarya/followers", "following_url": "https://api.github.com/users/meric-sakarya/following{/other_user}", "gists_url": "https://api.github.com/users/meric-sakarya/gists{/gist_id}", "starred_url": "https://api.github.com/users/meric-sakarya/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/meric-sakarya/subscriptions", "organizations_url": "https://api.github.com/users/meric-sakarya/orgs", "repos_url": "https://api.github.com/users/meric-sakarya/repos", "events_url": "https://api.github.com/users/meric-sakarya/events{/privacy}", "received_events_url": "https://api.github.com/users/meric-sakarya/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-08-26T17:59:33Z", "updated_at": "2021-02-28T23:22:04Z", "closed_at": "2021-02-28T23:22:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am working with a customized Pendulum-v0 environment which has a maximum timestep attribute to allow early resets and therefore reward tracking and also uses rgb-array's for observation. I am trying to use the hyperparameter optimization for that environment and therefore registered the environment to gym. I can not run train.py with n_jobs larger than 1. \r\n \r\n\r\ntrain.py:\r\n```\r\n\r\nimport os\r\nimport time\r\nimport uuid\r\nimport difflib\r\nimport argparse\r\nimport importlib\r\nimport warnings\r\nfrom pprint import pprint\r\nfrom collections import OrderedDict\r\n\r\n# numpy warnings because of tensorflow\r\nwarnings.filterwarnings(\"ignore\", category=FutureWarning, module='tensorflow')\r\nwarnings.filterwarnings(\"ignore\", category=UserWarning, module='gym')\r\n\r\nimport gym\r\nimport numpy as np\r\nimport yaml\r\n# Optional dependencies\r\nimport utils.import_envs  # pytype: disable=import-error\r\ntry:\r\n    import mpi4py\r\n    from mpi4py import MPI\r\nexcept ImportError:\r\n    mpi4py = None\r\n\r\nfrom stable_baselines.common import set_global_seeds\r\nfrom stable_baselines.common.cmd_util import make_atari_env\r\nfrom stable_baselines.common.vec_env import VecFrameStack, SubprocVecEnv, VecNormalize, DummyVecEnv, VecEnv\r\nfrom stable_baselines.common.noise import AdaptiveParamNoiseSpec, NormalActionNoise, OrnsteinUhlenbeckActionNoise\r\nfrom stable_baselines.common.schedules import constfn\r\nfrom stable_baselines.common.callbacks import CheckpointCallback, EvalCallback\r\nfrom stable_baselines.her import HERGoalEnvWrapper\r\nfrom stable_baselines.common.base_class import _UnvecWrapper\r\n\r\nfrom utils import make_env, ALGOS, linear_schedule, get_latest_run_id, get_wrapper_class\r\nfrom utils.hyperparams_opt import hyperparam_optimization\r\nfrom utils.callbacks import SaveVecNormalizeCallback\r\nfrom utils.noise import LinearNormalActionNoise\r\nfrom utils.utils import StoreDict\r\n\r\n\r\nif __name__ == '__main__':\r\n    parser = argparse.ArgumentParser()\r\n    parser.add_argument('--env', type=str, default=\"CartPole-v1\", help='environment ID')\r\n    parser.add_argument('-tb', '--tensorboard-log', help='Tensorboard log dir', default='', type=str)\r\n    parser.add_argument('-i', '--trained-agent', help='Path to a pretrained agent to continue training',\r\n                        default='', type=str)\r\n    parser.add_argument('--algo', help='RL Algorithm', default='ppo2',\r\n                        type=str, required=False, choices=list(ALGOS.keys()))\r\n    parser.add_argument('-n', '--n-timesteps', help='Overwrite the number of timesteps', default=-1,\r\n                        type=int)\r\n    parser.add_argument('--log-interval', help='Override log interval (default: -1, no change)', default=-1,\r\n                        type=int)\r\n    parser.add_argument('--eval-freq', help='Evaluate the agent every n steps (if negative, no evaluation)',\r\n                        default=10000, type=int)\r\n    parser.add_argument('--eval-episodes', help='Number of episodes to use for evaluation',\r\n                        default=5, type=int)\r\n    parser.add_argument('--save-freq', help='Save the model every n steps (if negative, no checkpoint)',\r\n                        default=-1, type=int)\r\n    parser.add_argument('-f', '--log-folder', help='Log folder', type=str, default='logs')\r\n    parser.add_argument('--seed', help='Random generator seed', type=int, default=0)\r\n    parser.add_argument('--n-trials', help='Number of trials for optimizing hyperparameters', type=int, default=10)\r\n    parser.add_argument('-optimize', '--optimize-hyperparameters', action='store_true', default=False,\r\n                        help='Run hyperparameters search')\r\n    parser.add_argument('--n-jobs', help='Number of parallel jobs when optimizing hyperparameters', type=int, default=1)\r\n    parser.add_argument('--sampler', help='Sampler to use when optimizing hyperparameters', type=str,\r\n                        default='tpe', choices=['random', 'tpe', 'skopt'])\r\n    parser.add_argument('--pruner', help='Pruner to use when optimizing hyperparameters', type=str,\r\n                        default='median', choices=['halving', 'median', 'none'])\r\n    parser.add_argument('--verbose', help='Verbose mode (0: no output, 1: INFO)', default=1,\r\n                        type=int)\r\n    parser.add_argument('--gym-packages', type=str, nargs='+', default=[],\r\n                        help='Additional external Gym environemnt package modules to import (e.g. gym_minigrid)')\r\n    parser.add_argument('-params', '--hyperparams', type=str, nargs='+', action=StoreDict,\r\n                        help='Overwrite hyperparameter (e.g. learning_rate:0.01 train_freq:10)')\r\n    parser.add_argument('-uuid', '--uuid', action='store_true', default=False,\r\n                        help='Ensure that the run has a unique ID')\r\n    parser.add_argument('--env-kwargs', type=str, nargs='+', action=StoreDict,\r\n                        help='Optional keyword argument to pass to the env constructor')\r\n    args = parser.parse_args()\r\n\r\n    # Going through custom gym packages to let them register in the global registory\r\n    for env_module in args.gym_packages:\r\n        importlib.import_module(env_module)\r\n\r\n    env_id = args.env\r\n    registered_envs = set(gym.envs.registry.env_specs.keys())\r\n\r\n    # If the environment is not found, suggest the closest match\r\n    if env_id not in registered_envs:\r\n        try:\r\n            closest_match = difflib.get_close_matches(env_id, registered_envs, n=1)[0]\r\n        except IndexError:\r\n            closest_match = \"'no close match found...'\"\r\n        raise ValueError('{} not found in gym registry, you maybe meant {}?'.format(env_id, closest_match))\r\n\r\n    # Unique id to ensure there is no race condition for the folder creation\r\n    uuid_str = '_{}'.format(uuid.uuid4()) if args.uuid else ''\r\n    if args.seed < 0:\r\n        # Seed but with a random one\r\n        args.seed = np.random.randint(2**32 - 1)\r\n\r\n    set_global_seeds(args.seed)\r\n\r\n    if args.trained_agent != \"\":\r\n        valid_extension = args.trained_agent.endswith('.pkl') or args.trained_agent.endswith('.zip')\r\n        assert valid_extension and os.path.isfile(args.trained_agent), \\\r\n            \"The trained_agent must be a valid path to a .zip/.pkl file\"\r\n\r\n    rank = 0\r\n    if mpi4py is not None and MPI.COMM_WORLD.Get_size() > 1:\r\n        print(\"Using MPI for multiprocessing with {} workers\".format(MPI.COMM_WORLD.Get_size()))\r\n        rank = MPI.COMM_WORLD.Get_rank()\r\n        print(\"Worker rank: {}\".format(rank))\r\n\r\n        args.seed += rank\r\n        if rank != 0:\r\n            args.verbose = 0\r\n            args.tensorboard_log = ''\r\n\r\n    tensorboard_log = None if args.tensorboard_log == '' else os.path.join(args.tensorboard_log, env_id)\r\n\r\n    is_atari = False\r\n    if 'NoFrameskip' in env_id:\r\n        is_atari = True\r\n\r\n    print(\"=\" * 10, env_id, \"=\" * 10)\r\n    print(\"Seed: {}\".format(args.seed))\r\n\r\n    # Load hyperparameters from yaml file\r\n    with open('hyperparams/{}.yml'.format(args.algo), 'r') as f:\r\n        hyperparams_dict = yaml.safe_load(f)\r\n        if env_id in list(hyperparams_dict.keys()):\r\n            hyperparams = hyperparams_dict[env_id]\r\n        elif is_atari:\r\n            hyperparams = hyperparams_dict['atari']\r\n        else:\r\n            raise ValueError(\"Hyperparameters not found for {}-{}\".format(args.algo, env_id))\r\n\r\n    if args.hyperparams is not None:\r\n        # Overwrite hyperparams if needed\r\n        hyperparams.update(args.hyperparams)\r\n\r\n    # Sort hyperparams that will be saved\r\n    saved_hyperparams = OrderedDict([(key, hyperparams[key]) for key in sorted(hyperparams.keys())])\r\n\r\n    algo_ = args.algo\r\n    # HER is only a wrapper around an algo\r\n    if args.algo == 'her':\r\n        algo_ = saved_hyperparams['model_class']\r\n        assert algo_ in {'sac', 'ddpg', 'dqn', 'td3'}, \"{} is not compatible with HER\".format(algo_)\r\n        # Retrieve the model class\r\n        hyperparams['model_class'] = ALGOS[saved_hyperparams['model_class']]\r\n        if hyperparams['model_class'] is None:\r\n            raise ValueError('{} requires MPI to be installed'.format(algo_))\r\n\r\n    if args.verbose > 0:\r\n        pprint(saved_hyperparams)\r\n\r\n    n_envs = hyperparams.get('n_envs', 1)\r\n\r\n    if args.verbose > 0:\r\n        print(\"Using {} environments\".format(n_envs))\r\n\r\n    # Create learning rate schedules for ppo2 and sac\r\n    if algo_ in [\"ppo2\", \"sac\", \"td3\"]:\r\n        for key in ['learning_rate', 'cliprange', 'cliprange_vf']:\r\n            if key not in hyperparams:\r\n                continue\r\n            if isinstance(hyperparams[key], str):\r\n                schedule, initial_value = hyperparams[key].split('_')\r\n                initial_value = float(initial_value)\r\n                hyperparams[key] = linear_schedule(initial_value)\r\n            elif isinstance(hyperparams[key], (float, int)):\r\n                # Negative value: ignore (ex: for clipping)\r\n                if hyperparams[key] < 0:\r\n                    continue\r\n                hyperparams[key] = constfn(float(hyperparams[key]))\r\n            else:\r\n                raise ValueError('Invalid value for {}: {}'.format(key, hyperparams[key]))\r\n\r\n    # Should we overwrite the number of timesteps?\r\n    if args.n_timesteps > 0:\r\n        if args.verbose:\r\n            print(\"Overwriting n_timesteps with n={}\".format(args.n_timesteps))\r\n        n_timesteps = args.n_timesteps\r\n    else:\r\n        n_timesteps = int(hyperparams['n_timesteps'])\r\n\r\n    normalize = False\r\n    normalize_kwargs = {}\r\n    if 'normalize' in hyperparams.keys():\r\n        normalize = hyperparams['normalize']\r\n        if isinstance(normalize, str):\r\n            normalize_kwargs = eval(normalize)\r\n            normalize = True\r\n        del hyperparams['normalize']\r\n\r\n    # Convert to python object if needed\r\n    if 'policy_kwargs' in hyperparams.keys() and isinstance(hyperparams['policy_kwargs'], str):\r\n        hyperparams['policy_kwargs'] = eval(hyperparams['policy_kwargs'])\r\n\r\n    # Delete keys so the dict can be pass to the model constructor\r\n    if 'n_envs' in hyperparams.keys():\r\n        del hyperparams['n_envs']\r\n    del hyperparams['n_timesteps']\r\n\r\n    # obtain a class object from a wrapper name string in hyperparams\r\n    # and delete the entry\r\n    env_wrapper = get_wrapper_class(hyperparams)\r\n    if 'env_wrapper' in hyperparams.keys():\r\n        del hyperparams['env_wrapper']\r\n\r\n    log_path = \"{}/{}/\".format(args.log_folder, args.algo)\r\n    save_path = os.path.join(log_path, \"{}_{}{}\".format(env_id, get_latest_run_id(log_path, env_id) + 1, uuid_str))\r\n    params_path = \"{}/{}\".format(save_path, env_id)\r\n    os.makedirs(params_path, exist_ok=True)\r\n\r\n    callbacks = []\r\n    if args.save_freq > 0:\r\n        # Account for the number of parallel environments\r\n        args.save_freq = max(args.save_freq // n_envs, 1)\r\n        callbacks.append(CheckpointCallback(save_freq=args.save_freq,\r\n                                            save_path=save_path, name_prefix='rl_model', verbose=1))\r\n\r\n    env_kwargs = {} if args.env_kwargs is None else args.env_kwargs\r\n\r\n    def create_env(n_envs, eval_env=False):\r\n        \"\"\"\r\n        Create the environment and wrap it if necessary\r\n        :param n_envs: (int)\r\n        :param eval_env: (bool) Whether is it an environment used for evaluation or not\r\n        :return: (Union[gym.Env, VecEnv])\r\n        :return: (gym.Env)\r\n        \"\"\"\r\n        global hyperparams\r\n        global env_kwargs\r\n\r\n        # Do not log eval env (issue with writing the same file)\r\n        log_dir = None if eval_env else save_path\r\n\r\n        if is_atari:\r\n            if args.verbose > 0:\r\n                print(\"Using Atari wrapper\")\r\n            env = make_atari_env(env_id, num_env=n_envs, seed=args.seed)\r\n            # Frame-stacking with 4 frames\r\n            env = VecFrameStack(env, n_stack=4)\r\n        elif algo_ in ['dqn', 'ddpg']:\r\n            if hyperparams.get('normalize', False):\r\n                print(\"WARNING: normalization not supported yet for DDPG/DQN\")\r\n            env = gym.make(env_id, **env_kwargs)\r\n            env.seed(args.seed)\r\n            if env_wrapper is not None:\r\n                env = env_wrapper(env)\r\n        else:\r\n            if n_envs == 1:\r\n                env = DummyVecEnv([make_env(env_id, 0, args.seed, wrapper_class=env_wrapper, log_dir=log_dir, env_kwargs=env_kwargs)])\r\n            else:\r\n                # env = SubprocVecEnv([make_env(env_id, i, args.seed) for i in range(n_envs)])\r\n                # On most env, SubprocVecEnv does not help and is quite memory hungry\r\n                env = DummyVecEnv([make_env(env_id, i, args.seed, log_dir=log_dir,\r\n                                            wrapper_class=env_wrapper, env_kwargs=env_kwargs) for i in range(n_envs)])\r\n            if normalize:\r\n                if args.verbose > 0:\r\n                    if len(normalize_kwargs) > 0:\r\n                        print(\"Normalization activated: {}\".format(normalize_kwargs))\r\n                    else:\r\n                        print(\"Normalizing input and reward\")\r\n                env = VecNormalize(env, **normalize_kwargs)\r\n        # Optional Frame-stacking\r\n        if hyperparams.get('frame_stack', False):\r\n            n_stack = hyperparams['frame_stack']\r\n            env = VecFrameStack(env, n_stack)\r\n            print(\"Stacking {} frames\".format(n_stack))\r\n            del hyperparams['frame_stack']\r\n        if args.algo == 'her':\r\n            # Wrap the env if need to flatten the dict obs\r\n            if isinstance(env, VecEnv):\r\n                env = _UnvecWrapper(env)\r\n            env = HERGoalEnvWrapper(env)\r\n        return env\r\n\r\n\r\n    env = create_env(n_envs)\r\n    # Create test env if needed, do not normalize reward\r\n    eval_env = None\r\n    if args.eval_freq > 0:\r\n        # Account for the number of parallel environments\r\n        args.eval_freq = max(args.eval_freq // n_envs, 1)\r\n\r\n        # Do not normalize the rewards of the eval env\r\n        old_kwargs = None\r\n        if normalize:\r\n            if len(normalize_kwargs) > 0:\r\n                old_kwargs = normalize_kwargs.copy()\r\n                normalize_kwargs['norm_reward'] = False\r\n            else:\r\n                normalize_kwargs = {'norm_reward': False}\r\n\r\n        if args.verbose > 0:\r\n            print(\"Creating test environment\")\r\n\r\n        save_vec_normalize = SaveVecNormalizeCallback(save_freq=1, save_path=params_path)\r\n        eval_callback = EvalCallback(create_env(1, eval_env=True), callback_on_new_best=save_vec_normalize,\r\n                                     best_model_save_path=save_path, n_eval_episodes=args.eval_episodes,\r\n                                     log_path=save_path, eval_freq=args.eval_freq)\r\n        callbacks.append(eval_callback)\r\n\r\n        # Restore original kwargs\r\n        if old_kwargs is not None:\r\n            normalize_kwargs = old_kwargs.copy()\r\n\r\n\r\n    # Stop env processes to free memory\r\n    if args.optimize_hyperparameters and n_envs > 1:\r\n        env.close()\r\n\r\n    # Parse noise string for DDPG and SAC\r\n    if algo_ in ['ddpg', 'sac', 'td3'] and hyperparams.get('noise_type') is not None:\r\n        noise_type = hyperparams['noise_type'].strip()\r\n        noise_std = hyperparams['noise_std']\r\n        n_actions = env.action_space.shape[0]\r\n        if 'adaptive-param' in noise_type:\r\n            assert algo_ == 'ddpg', 'Parameter is not supported by SAC'\r\n            hyperparams['param_noise'] = AdaptiveParamNoiseSpec(initial_stddev=noise_std,\r\n                                                                desired_action_stddev=noise_std)\r\n        elif 'normal' in noise_type:\r\n            if 'lin' in noise_type:\r\n                hyperparams['action_noise'] = LinearNormalActionNoise(mean=np.zeros(n_actions),\r\n                                                                      sigma=noise_std * np.ones(n_actions),\r\n                                                                      final_sigma=hyperparams.get('noise_std_final', 0.0) * np.ones(n_actions),\r\n                                                                      max_steps=n_timesteps)\r\n            else:\r\n                hyperparams['action_noise'] = NormalActionNoise(mean=np.zeros(n_actions),\r\n                                                                sigma=noise_std * np.ones(n_actions))\r\n        elif 'ornstein-uhlenbeck' in noise_type:\r\n            hyperparams['action_noise'] = OrnsteinUhlenbeckActionNoise(mean=np.zeros(n_actions),\r\n                                                                       sigma=noise_std * np.ones(n_actions))\r\n        else:\r\n            raise RuntimeError('Unknown noise type \"{}\"'.format(noise_type))\r\n        print(\"Applying {} noise with std {}\".format(noise_type, noise_std))\r\n        del hyperparams['noise_type']\r\n        del hyperparams['noise_std']\r\n        if 'noise_std_final' in hyperparams:\r\n            del hyperparams['noise_std_final']\r\n\r\n    if ALGOS[args.algo] is None:\r\n        raise ValueError('{} requires MPI to be installed'.format(args.algo))\r\n\r\n    if os.path.isfile(args.trained_agent):\r\n        # Continue training\r\n        print(\"Loading pretrained agent\")\r\n        # Policy should not be changed\r\n        del hyperparams['policy']\r\n\r\n        model = ALGOS[args.algo].load(args.trained_agent, env=env,\r\n                                      tensorboard_log=tensorboard_log, verbose=args.verbose, **hyperparams)\r\n\r\n        exp_folder = args.trained_agent[:-4]\r\n        if normalize:\r\n            print(\"Loading saved running average\")\r\n            stats_path = os.path.join(exp_folder, env_id)\r\n            if os.path.exists(os.path.join(stats_path, 'vecnormalize.pkl')):\r\n                env = VecNormalize.load(os.path.join(stats_path, 'vecnormalize.pkl'), env)\r\n            else:\r\n                # Legacy:\r\n                env.load_running_average(exp_folder)\r\n\r\n    elif args.optimize_hyperparameters:\r\n\r\n        if args.verbose > 0:\r\n            print(\"Optimizing hyperparameters\")\r\n\r\n        def create_model(*_args, **kwargs):\r\n            \"\"\"\r\n            Helper to create a model with different hyperparameters\r\n            \"\"\"\r\n            return ALGOS[args.algo](env=create_env(n_envs), tensorboard_log=tensorboard_log,\r\n                                    verbose=0, **kwargs)\r\n\r\n        data_frame = hyperparam_optimization(args.algo, create_model, create_env, n_trials=args.n_trials,\r\n                                             n_timesteps=n_timesteps, hyperparams=hyperparams,\r\n                                             n_jobs=args.n_jobs, seed=args.seed,\r\n                                             sampler_method=args.sampler, pruner_method=args.pruner,\r\n                                             verbose=args.verbose)\r\n\r\n        report_name = \"report_{}_{}-trials-{}-{}-{}_{}.csv\".format(env_id, args.n_trials, n_timesteps,\r\n                                                                args.sampler, args.pruner, int(time.time()))\r\n\r\n        log_path = os.path.join(args.log_folder, args.algo, report_name)\r\n\r\n        if args.verbose:\r\n            print(\"Writing report to {}\".format(log_path))\r\n\r\n        os.makedirs(os.path.dirname(log_path), exist_ok=True)\r\n        data_frame.to_csv(log_path)\r\n        exit()\r\n    else:\r\n        # Train an agent from scratch\r\n        model = ALGOS[args.algo](env=env, tensorboard_log=tensorboard_log, verbose=args.verbose, **hyperparams)\r\n\r\n    kwargs = {}\r\n    if args.log_interval > -1:\r\n        kwargs = {'log_interval': args.log_interval}\r\n\r\n    if len(callbacks) > 0:\r\n        kwargs['callback'] = callbacks\r\n\r\n    # Save hyperparams\r\n    with open(os.path.join(params_path, 'config.yml'), 'w') as f:\r\n        yaml.dump(saved_hyperparams, f)\r\n\r\n    print(\"Log path: {}\".format(save_path))\r\n\r\n    try:\r\n        model.learn(n_timesteps, **kwargs)\r\n    except KeyboardInterrupt:\r\n        pass\r\n\r\n    # Only save worker of rank 0 when using mpi\r\n    if rank == 0:\r\n        print(\"Saving to {}\".format(save_path))\r\n\r\n        model.save(\"{}/{}\".format(save_path, env_id))\r\n\r\n    if normalize:\r\n        # Important: save the running average, for testing the agent we need that normalization\r\n        model.get_vec_normalize_env().save(os.path.join(params_path, 'vecnormalize.pkl'))\r\n        # Deprecated saving:\r\n        # env.save_running_average(params_path)\r\n\r\n```\r\nThe error:  \r\n\r\n```                                                                                                                             \r\n(pioneer) \r\nC:\\Users\\meric\\OneDrive\\Masa\u00fcst\u00fc\\TUM\\Thesis\\Code\\Zoo\\rl-baselines-zoo>python train.py --algo ppo2 --env PendulumIMG-v0 -n 50000 -optimize --n-trials 100 --n-jobs 2 --sampler random --pruner median\r\n                                            \r\n2020-08-24 16:48:55.212835: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll\r\n                                                                                                          \r\nWARNING:tensorflow: The TensorFlow contrib module will not be included in TensorFlow 2.0.                                                        For more information, please see:                                                                                              \r\n* https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md                                        \r\n* https://github.com/tensorflow/addons                                                                                       \r\n* https://github.com/tensorflow/io (for I/O related ops)                                                                   \r\nIf you depend on functionality not listed there, please file an issue.                                                                                                                                                                                    WARNING:tensorflow:From C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\stable_baselines\\common\\misc_util.py:26: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.                                                                                                                                                                   ========== PendulumIMG-v0 ==========                                                                                         \r\nSeed: 0                                                                                                                      \r\nOrderedDict([('cliprange', 0.2),                                                                                                          \r\n('ent_coef', 0.0),                                                                                                           \r\n('gamma', 0.99),                                                                                                             \r\n('lam', 0.95),                                                                                                               \r\n('learning_rate', 0.0003),                                                                                                   \r\n('n_steps', 2048),                                                                                                           \r\n('n_timesteps', 2000000.0),                                                                                                  \r\n('nminibatches', 32),                                                                                                        \r\n('noptepochs', 10),                                                                                                          \r\n('policy', 'MlpPolicy')])                                                                                       \r\nUsing 1 environments                                                                                                         \r\nOverwriting n_timesteps with n=50000                                                                                         \r\nCreating test environment                                                                                                    \r\nOptimizing hyperparameters                                                                                                   \r\nSampler: random - Pruner: median                                                                                             \r\nWARNING:tensorflow:From C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\stable_baselines\\common\\tf_util.py:191: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.                                                                                                                                                                            WARNING:tensorflow:From C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\stable_baselines\\common\\tf_util.py:200: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.                                                                                                                                                                                    2020-08-24 16:48:58.804156: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2                                                                                 \r\n2020-08-24 16:48:58.808697: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library nvcuda.dll                                                                                                                \r\n2020-08-24 16:48:59.234388: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties:         name: GeForce GTX 1050 major: 6 minor: 1 memoryClockRate(GHz): 1.493                                                         \r\npciBusID: 0000:01:00.0                                                                                                       \r\n2020-08-24 16:48:59.234620: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll                                                                                                          \r\n2020-08-24 16:48:59.239386: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll                                                                                                          \r\n2020-08-24 16:48:59.243933: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll                                                                                                           \r\n2020-08-24 16:48:59.246060: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll                                                                                                          \r\n2020-08-24 16:48:59.250758: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll                                                                                                        \r\n2020-08-24 16:48:59.253638: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll                                                                                                        \r\n2020-08-24 16:48:59.263978: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll                                                                                                             \r\n2020-08-24 16:48:59.264324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0           2020-08-24 16:48:59.909666: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:                                                                                                      \r\n2020-08-24 16:48:59.910059: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0                                  \r\n2020-08-24 16:48:59.911490: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N                                  \r\n2020-08-24 16:48:59.912589: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3001 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1050, pci bus id: 0000:01:00.0, compute capability: 6.1)                                                                                               \r\n2020-08-24 16:48:59.914510: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties:         name: GeForce GTX 1050 major: 6 minor: 1 memoryClockRate(GHz): 1.493                                                         \r\npciBusID: 0000:01:00.0                                                                                                       \r\n2020-08-24 16:48:59.914730: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll                                                                                                          \r\n2020-08-24 16:48:59.915234: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll                                                                                                          \r\n2020-08-24 16:48:59.915871: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll                                                                                                           \r\n2020-08-24 16:48:59.916369: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll                                                                                                          \r\n2020-08-24 16:48:59.917129: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll                                                                                                        \r\n2020-08-24 16:48:59.917621: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll                                                                                                        \r\n2020-08-24 16:48:59.918279: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll                                                                                                             \r\n2020-08-24 16:48:59.918792: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0           2020-08-24 16:48:59.919268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:                                                                                                      \r\n2020-08-24 16:48:59.919664: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0                                  \r\n2020-08-24 16:48:59.920011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N                                  \r\n2020-08-24 16:48:59.920561: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3001 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1050, pci bus id: 0000:01:00.0, compute capability: 6.1)                                                                                               WARNING:tensorflow:From C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\stable_baselines\\common\\policies.py:116: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.                                                                                                                                                                     WARNING:tensorflow:From C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\stable_baselines\\common\\input.py:25: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.                                                                                                                                                                               WARNING:tensorflow:From C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\stable_baselines\\common\\policies.py:561: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.                              \r\nInstructions for updating:                                                                                                   \r\nUse keras.layers.flatten instead.                                                                                            \r\nWARNING:tensorflow:From C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\tensorflow_core\\python\\layers\\core.py:332: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.            \r\nInstructions for updating:                                                                                                   \r\nPlease use `layer.__call__` method instead.                                                                                  \r\nWARNING:tensorflow:From C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\stable_baselines\\common\\tf_layers.py:123: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.                                                                                                                                                                        WARNING:tensorflow:From C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\stable_baselines\\common\\distributions.py:418: The name tf.random_normal is deprecated. Please use tf.random.normal instead.                                                                                                                                                                            WARNING:tensorflow:From C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\stable_baselines\\ppo2\\ppo2.py:190: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.                                                                                                                                                                           WARNING:tensorflow:From C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\stable_baselines\\ppo2\\ppo2.py:198: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.                                                                                                                                                                 WARNING:tensorflow:From C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\tensorflow_core\\python\\ops\\math_grad.py:1424: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.                         \r\nInstructions for updating:                                                                                                   Use tf.where in 2.0, which has the same broadcast rule as np.where                                                           WARNING:tensorflow:From C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\stable_baselines\\ppo2\\ppo2.py:206: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.                                                                                                                                                                 WARNING:tensorflow:From C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\stable_baselines\\ppo2\\ppo2.py:240: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.                                                                                                                                               WARNING:tensorflow:From C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\stable_baselines\\ppo2\\ppo2.py:242: The name tf.summary.merge_all is deprecated. Please use tf.compat.v1.summary.merge_all instead.                                                                                                                                                                     [W 2020-08-24 16:49:01,386] Setting status of trial#0 as TrialState.FAIL because of the following error: MissingFunctionException('wglChoosePixelFormatARB is not exported by the available OpenGL driver.  ARB_pixel_format is required for this functionality.')                                                                                                                     \r\nTraceback (most recent call last):                                                                                             \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\optuna\\study.py\", line 734, in _run_trial                        \r\nresult = func(trial)                                                                                                       \r\nFile \"C:\\Users\\meric\\OneDrive\\Masa\u00fcst\u00fc\\TUM\\Thesis\\Code\\Zoo\\rl-baselines-zoo\\utils\\hyperparams_opt.py\", line 108, in objective                                                                                                                               \r\nmodel.learn(n_timesteps, callback=eval_callback)                                                                           \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\stable_baselines\\ppo2\\ppo2.py\", line 336, in learn               rollout = self.runner.run(callback)                                                                                        \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\stable_baselines\\common\\base_class.py\", line 794, in runner      self._runner = self._make_runner()                                                                                         \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\stable_baselines\\ppo2\\ppo2.py\", line 101, in _make_runner        gamma=self.gamma, lam=self.lam)                                                                                            \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\stable_baselines\\ppo2\\ppo2.py\", line 449, in __init__            super().__init__(env=env, model=model, n_steps=n_steps)                                                                    \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\stable_baselines\\common\\runners.py\", line 31, in __init__        self.obs[:] = env.reset()                                                                                                  \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\stable_baselines\\common\\vec_env\\dummy_vec_env.py\", line 61, in reset                                                                                                                          \r\nobs = self.envs[env_idx].reset()                                                                                           \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\stable_baselines\\bench\\monitor.py\", line 80, in reset            return self.env.reset(**kwargs)                                                                                            \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\gym\\wrappers\\time_limit.py\", line 25, in reset                   \r\nreturn self.env.reset(**kwargs)                                                                                            \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\gym\\envs\\classic_control\\pendulum_IMG.py\", line 84, in reset     return self._get_obs()                                                                                                     \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\gym\\envs\\classic_control\\pendulum_IMG.py\", line 88, in _get_obs                                                                                                                               \r\nimg = self.render('rgb_array')                                                                                             \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\gym\\envs\\classic_control\\pendulum_IMG.py\", line 100, in render                                                                                                                                self.viewer = rendering.Viewer(50, 50)                                                                                     \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\gym\\envs\\classic_control\\rendering.py\", line 70, in __init__     self.window = get_window(width=width, height=height, display=display)                                                      \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\gym\\envs\\classic_control\\rendering.py\", line 59, in get_window                                                                                                                                config = screen[0].get_best_config() #selecting the first screen                                                           \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\pyglet\\canvas\\base.py\", line 187, in get_best_config             configs = self.get_matching_configs(template_config)                                                                       \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\pyglet\\canvas\\win32.py\", line 69, in get_matching_configs        configs = template.match(canvas)                                                                                           \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\pyglet\\gl\\win32.py\", line 57, in match                           \r\nreturn self._get_arb_pixel_format_matching_configs(canvas)                                                                 \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\pyglet\\gl\\win32.py\", line 128, in _get_arb_pixel_format_matching_configs                                                                                                                      wglext_arb.wglChoosePixelFormatARB(canvas.hdc, attrs, None, nformats, pformats, nformats)                                  \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\pyglet\\gl\\lib_wgl.py\", line 103, in __call__                     \r\nreturn self.func(*args, **kwargs)                                                                                          \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\pyglet\\gl\\lib.py\", line 60, in MissingFunction                   \r\nraise MissingFunctionException(name, requires, suggestions)                                                              pyglet.gl.lib.MissingFunctionException: wglChoosePixelFormatARB is not exported by the available OpenGL driver.  ARB_pixel_format is required for this functionality.                                                                                     \r\n2020-08-24 16:49:01.467203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties:         name: GeForce GTX 1050 major: 6 minor: 1 memoryClockRate(GHz): 1.493                                                         \r\npciBusID: 0000:01:00.0                                                                                                       \r\n2020-08-24 16:49:01.467503: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll                                                                                                          \r\n2020-08-24 16:49:01.469300: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll                                                                                                          \r\n2020-08-24 16:49:01.470278: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll                                                                                                           \r\n2020-08-24 16:49:01.472895: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll                                                                                                          \r\n2020-08-24 16:49:01.476622: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll                                                                                                        \r\n2020-08-24 16:49:01.478698: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll                                                                                                        \r\n2020-08-24 16:49:01.479360: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll                                                                                                             \r\n2020-08-24 16:49:01.480079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0           2020-08-24 16:49:01.480605: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:                                                                                                      \r\n2020-08-24 16:49:01.481265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0                                  \r\n2020-08-24 16:49:01.481671: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N                                  \r\n2020-08-24 16:49:01.482168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3001 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1050, pci bus id: 0000:01:00.0, compute capability: 6.1)                                                                                               \r\nTraceback (most recent call last):                                                                                             \r\nFile \"train.py\", line 385, in <module>                                                                                         \r\nverbose=args.verbose)                                                                                                      \r\nFile \"C:\\Users\\meric\\OneDrive\\Masa\u00fcst\u00fc\\TUM\\Thesis\\Code\\Zoo\\rl-baselines-zoo\\utils\\hyperparams_opt.py\", line 130, in hyperparam_optimization                                                                                                                 \r\nstudy.optimize(objective, n_trials=n_trials, n_jobs=n_jobs)                                                                \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\optuna\\study.py\", line 382, in optimize                          \r\nfor _ in _iter                                                                                                             \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\joblib\\parallel.py\", line 1042, in __call__                      self.retrieve()                                                                                                            \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\joblib\\parallel.py\", line 921, in retrieve                       self._output.extend(job.get(timeout=self.timeout))                                                                         \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\multiprocessing\\pool.py\", line 657, in get                                     \r\nraise self._value                                                                                                          \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\multiprocessing\\pool.py\", line 121, in worker                                  \r\nresult = (True, func(*args, **kwds))                                                                                       \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\joblib\\_parallel_backends.py\", line 595, in __call__             \r\nreturn self.func(*args, **kwargs)                                                                                          \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\joblib\\parallel.py\", line 253, in __call__                       \r\nfor func, args, kwargs in self.items]                                                                                      \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\joblib\\parallel.py\", line 253, in <listcomp>                     \r\nfor func, args, kwargs in self.items]                                                                                      \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\optuna\\study.py\", line 648, in _reseed_and_optimize_sequential                                                                                                                                func, n_trials, timeout, catch, callbacks, gc_after_trial, time_start                                                      \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\optuna\\study.py\", line 682, in _optimize_sequential              self._run_trial_and_callbacks(func, catch, callbacks, gc_after_trial)                                                      \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\optuna\\study.py\", line 713, in _run_trial_and_callbacks          \r\ntrial = self._run_trial(func, catch, gc_after_trial)                                                                       \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\optuna\\study.py\", line 734, in _run_trial                        \r\nresult = func(trial)                                                                                                       \r\nFile \"C:\\Users\\meric\\OneDrive\\Masa\u00fcst\u00fc\\TUM\\Thesis\\Code\\Zoo\\rl-baselines-zoo\\utils\\hyperparams_opt.py\", line 108, in objective                                                                                                                               \r\nmodel.learn(n_timesteps, callback=eval_callback)                                                                           \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\stable_baselines\\ppo2\\ppo2.py\", line 336, in learn               rollout = self.runner.run(callback)                                                                                        \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\stable_baselines\\common\\base_class.py\", line 794, in runner      self._runner = self._make_runner()                                                                                         \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\stable_baselines\\ppo2\\ppo2.py\", line 101, in _make_runner        gamma=self.gamma, lam=self.lam)                                                                                            \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\stable_baselines\\ppo2\\ppo2.py\", line 449, in __init__            super().__init__(env=env, model=model, n_steps=n_steps)                                                                  \r\n2020-08-24 16:49:01.655738: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll                                                                                                            \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\stable_baselines\\common\\runners.py\", line 31, in __init__        self.obs[:] = env.reset()                                                                                                  \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\stable_baselines\\common\\vec_env\\dummy_vec_env.py\", line 61, in reset                                                                                                                          \r\nobs = self.envs[env_idx].reset()                                                                                           \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\stable_baselines\\bench\\monitor.py\", line 80, in reset            return self.env.reset(**kwargs)                                                                                            \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\gym\\wrappers\\time_limit.py\", line 25, in reset                   \r\nreturn self.env.reset(**kwargs)                                                                                            \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\gym\\envs\\classic_control\\pendulum_IMG.py\", line 84, in reset     return self._get_obs()                                                                                                     \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\gym\\envs\\classic_control\\pendulum_IMG.py\", line 88, in _get_obs                                                                                                                               \r\nimg = self.render('rgb_array')                                                                                             \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\gym\\envs\\classic_control\\pendulum_IMG.py\", line 100, in render                                                                                                                                self.viewer = rendering.Viewer(50, 50)                                                                                     \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\gym\\envs\\classic_control\\rendering.py\", line 70, in __init__     self.window = get_window(width=width, height=height, display=display)                                                      \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\gym\\envs\\classic_control\\rendering.py\", line 59, in get_window                                                                                                                                config = screen[0].get_best_config() #selecting the first screen                                                           \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\pyglet\\canvas\\base.py\", line 187, in get_best_config             configs = self.get_matching_configs(template_config)                                                                       \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\pyglet\\canvas\\win32.py\", line 69, in get_matching_configs        configs = template.match(canvas)                                                                                           \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\pyglet\\gl\\win32.py\", line 57, in match                           \r\nreturn self._get_arb_pixel_format_matching_configs(canvas)                                                                 \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\pyglet\\gl\\win32.py\", line 128, in _get_arb_pixel_format_matching_configs                                                                                                                      wglext_arb.wglChoosePixelFormatARB(canvas.hdc, attrs, None, nformats, pformats, nformats)                                  \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\pyglet\\gl\\lib_wgl.py\", line 103, in __call__                     \r\nreturn self.func(*args, **kwargs)                                                                                          \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\pyglet\\gl\\lib.py\", line 60, in MissingFunction                   \r\nraise MissingFunctionException(name, requires, suggestions)                                                              pyglet.gl.lib.MissingFunctionException: wglChoosePixelFormatARB is not exported by the available OpenGL driver.  ARB_pixel_format is required for this functionality.                                                                                     \r\nException ignored in: <function Viewer.__del__ at 0x0000021B8CE99318>                                                        \r\nTraceback (most recent call last):                                                                                             \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\gym\\envs\\classic_control\\rendering.py\", line 162, in __del__   \r\nFile \"C:\\Users\\meric\\Anaconda3\\envs\\pioneer\\lib\\site-packages\\gym\\envs\\classic_control\\rendering.py\", line 81, in close    AttributeError: 'Viewer' object has no attribute 'window' \r\n```\r\n\r\n\r\nError 1:\r\n\r\n\r\nAny suggestion would be greatly appreciated!\r\n\r\n**System Info**\r\nDescribe the characteristic of your environment:\r\n * Describe how stable baselines was installed (pip, docker, source, ...): pip install stable-baselines[mpi]\r\n * GPU models and configuration: NVIDIA GTX 1050\r\n * Python version: 3.7\r\n * Tensorflow version: 1.15", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1727/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1727/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1718", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1718/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1718/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1718/events", "html_url": "https://github.com/optuna/optuna/issues/1718", "id": 685474458, "node_id": "MDU6SXNzdWU2ODU0NzQ0NTg=", "number": 1718, "title": "LightGBMTunerCV stepwise tuning got an error with lightgbm==3.0.0rc1", "user": {"login": "nyanhi", "id": 63458275, "node_id": "MDQ6VXNlcjYzNDU4Mjc1", "avatar_url": "https://avatars.githubusercontent.com/u/63458275?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nyanhi", "html_url": "https://github.com/nyanhi", "followers_url": "https://api.github.com/users/nyanhi/followers", "following_url": "https://api.github.com/users/nyanhi/following{/other_user}", "gists_url": "https://api.github.com/users/nyanhi/gists{/gist_id}", "starred_url": "https://api.github.com/users/nyanhi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nyanhi/subscriptions", "organizations_url": "https://api.github.com/users/nyanhi/orgs", "repos_url": "https://api.github.com/users/nyanhi/repos", "events_url": "https://api.github.com/users/nyanhi/events{/privacy}", "received_events_url": "https://api.github.com/users/nyanhi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-08-25T13:11:34Z", "updated_at": "2023-04-17T08:58:52Z", "closed_at": "2020-09-02T12:21:48Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "`LightGBMTunerCV.run()` got LightGBMError after updating `lightgbm` version==`3.0.0rc1`. \r\nWhile it's performing stepwise tuning, `lightgbm.basic` raised below error message at the step of `min_data_in_leaf` and tuning is interrupted. \r\nA workaround seems to be adding `feature_pre_filter=false` like following as the error message suggests:\r\n```\r\nparams = {\r\n    \"objective\": \"binary\",\r\n    \"metric\": \"binary_logloss\",\r\n    \"verbosity\": -1,\r\n    \"boosting_type\": \"gbdt\",\r\n    \"feature_pre_filter\": False,\r\n}\r\n``` \r\n## Environment\r\n\r\n- Optuna version: 2.0.0\r\n- Python version: 3.7\r\n- OS: linux/amd64 (Docker image: optuna/optuna:v2.0.0-py3.7)\r\n- Lightgbm version: 3.0.0rc\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.6/dist-packages/optuna/study.py\", line 709, in _run_trial\r\n    result = func(trial)\r\n  File \"/usr/local/lib/python3.6/dist-packages/optuna/integration/_lightgbm_tuner/optimize.py\", line 302, in __call__\r\n    cv_results = lgb.cv(self.lgbm_params, self.train_set, **self.lgbm_kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/lightgbm/engine.py\", line 554, in cv\r\n    train_set._update_params(params) \\\r\n  File \"/usr/local/lib/python3.6/dist-packages/lightgbm/basic.py\", line 1436, in _update_params\r\n    raise LightGBMError(decode_string(_LIB.LGBM_GetLastError()))\r\nlightgbm.basic.LightGBMError: Reducing `min_data_in_leaf` with `feature_pre_filter=true` may cause unexpected behaviour for features that were pre-filtered by the larger `min_data_in_leaf`.\r\nYou need to set `feature_pre_filter=false` to dynamically change the `min_data_in_leaf`.\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Update lightgbm to version==`3.0.0rc1`\r\n2. Execute the example code in https://github.com/optuna/optuna/blob/master/examples/lightgbm_tuner_cv.py\r\n3. The error occurs at \r\nhttps://github.com/optuna/optuna/blob/4680f36a470ffb9ead89abf65dcc7e7533fd789f/examples/lightgbm_tuner_cv.py#L24-L28", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1718/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1718/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1710", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1710/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1710/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1710/events", "html_url": "https://github.com/optuna/optuna/issues/1710", "id": 684778575, "node_id": "MDU6SXNzdWU2ODQ3Nzg1NzU=", "number": 1710, "title": "LightGBMTunerCV seems to not handle user specified CV-folds", "user": {"login": "bjoernholzhauer", "id": 18594459, "node_id": "MDQ6VXNlcjE4NTk0NDU5", "avatar_url": "https://avatars.githubusercontent.com/u/18594459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjoernholzhauer", "html_url": "https://github.com/bjoernholzhauer", "followers_url": "https://api.github.com/users/bjoernholzhauer/followers", "following_url": "https://api.github.com/users/bjoernholzhauer/following{/other_user}", "gists_url": "https://api.github.com/users/bjoernholzhauer/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjoernholzhauer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjoernholzhauer/subscriptions", "organizations_url": "https://api.github.com/users/bjoernholzhauer/orgs", "repos_url": "https://api.github.com/users/bjoernholzhauer/repos", "events_url": "https://api.github.com/users/bjoernholzhauer/events{/privacy}", "received_events_url": "https://api.github.com/users/bjoernholzhauer/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-08-24T15:51:48Z", "updated_at": "2022-10-30T15:17:19Z", "closed_at": "2021-02-28T23:22:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Expected behavior\r\n\r\nWhen users specify training and validation folds in the manner that the basic lightgbm.cv function accepts, this should (from what I understand work)\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.0.0\r\n- Python version: 3.6.9\r\n- OS: Google Collab/Linux\r\n- (Optional) Other libraries and their versions: LightGBM 2.3.1\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n0%|          | 0/7 [00:00<?, ?it/s]\r\nfeature_fraction, val_score: inf:   0%|          | 0/7 [00:00<?, ?it/s][W 2020-08-24 15:41:09,973] Trial 0 failed because of the following error: ValueError('For early stopping, at least one dataset and eval metric is required for evaluation',)\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.6/dist-packages/optuna/study.py\", line 709, in _run_trial\r\n    result = func(trial)\r\n  File \"/usr/local/lib/python3.6/dist-packages/optuna/integration/_lightgbm_tuner/optimize.py\", line 302, in __call__\r\n    cv_results = lgb.cv(self.lgbm_params, self.train_set, **self.lgbm_kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/lightgbm/engine.py\", line 576, in cv\r\n    evaluation_result_list=res))\r\n  File \"/usr/local/lib/python3.6/dist-packages/lightgbm/callback.py\", line 221, in _callback\r\n    _init(env)\r\n  File \"/usr/local/lib/python3.6/dist-packages/lightgbm/callback.py\", line 191, in _init\r\n    raise ValueError('For early stopping, '\r\nValueError: For early stopping, at least one dataset and eval metric is required for evaluation\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-18-0ec8edbe946a> in <module>()\r\n      2                      label = np.array( data['target'] ).flatten())\r\n      3 tuner = lgb.LightGBMTunerCV(params, dtrain, verbose_eval=100, early_stopping_rounds=100, folds=folds)\r\n----> 4 tuner.run()\r\n\r\n10 frames\r\n/usr/local/lib/python3.6/dist-packages/lightgbm/callback.py in _init(env)\r\n    189             return\r\n    190         if not env.evaluation_result_list:\r\n--> 191             raise ValueError('For early stopping, '\r\n    192                              'at least one dataset and eval metric is required for evaluation')\r\n    193 \r\n\r\nValueError: For early stopping, at least one dataset and eval metric is required for evaluation\r\n```\r\n\r\nAs well as (on the second version without early stopping, which I think is an issue that's already reported in another issue?):\r\n```\r\n0%|          | 0/7 [00:00<?, ?it/s]\r\n\r\n\r\nfeature_fraction, val_score: inf:   0%|          | 0/7 [00:00<?, ?it/s][W 2020-08-24 15:42:03,262] Trial 0 failed because of the following error: KeyError('l1-mean',)\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.6/dist-packages/optuna/study.py\", line 709, in _run_trial\r\n    result = func(trial)\r\n  File \"/usr/local/lib/python3.6/dist-packages/optuna/integration/_lightgbm_tuner/optimize.py\", line 304, in __call__\r\n    val_scores = self._get_cv_scores(cv_results)\r\n  File \"/usr/local/lib/python3.6/dist-packages/optuna/integration/_lightgbm_tuner/optimize.py\", line 294, in _get_cv_scores\r\n    val_scores = cv_results[\"{}-mean\".format(metric)]\r\nKeyError: 'l1-mean'\r\n---------------------------------------------------------------------------\r\nKeyError                                  Traceback (most recent call last)\r\n<ipython-input-21-942a30076787> in <module>()\r\n      1 tuner = lgb.LightGBMTunerCV(params, dtrain, verbose_eval=100, folds=folds)\r\n----> 2 tuner.run()\r\n\r\n8 frames\r\n/usr/local/lib/python3.6/dist-packages/optuna/integration/_lightgbm_tuner/optimize.py in _get_cv_scores(self, cv_results)\r\n    292 \r\n    293         metric = self._get_metric_for_objective()\r\n--> 294         val_scores = cv_results[\"{}-mean\".format(metric)]\r\n    295         return val_scores\r\n    296 \r\n\r\nKeyError: 'l1-mean'\r\n```\r\n## Steps to reproduce\r\n\r\n1. Get a Google Collab, then run the code below (extra installations beyond default collab explicitly via !pip below)\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\n!pip install lightgbm==2.3.1\r\nimport numpy as np\r\nimport pandas as pd\r\nfrom sklearn.model_selection import GroupKFold\r\n\r\nimport lightgbm as lgb\r\nlgb.__version__\r\nnp.random.seed(123)\r\ndata = pd.DataFrame({'var1': np.random.normal(loc=0, scale=1, size=100),\r\n                    'var2': np.random.normal(loc=0, scale=1, size=100),\r\n                    'var3': np.random.normal(loc=0, scale=1, size=100),\r\n                     'testfold': np.random.choice(a=np.repeat([x for x in range(5)], 20), size=100, replace=False)})\r\ndata['target'] = 7 + 0.1*data['var1'] + 1.0*data['var2'] + 5.0*data['var3'] - 2.0*data['var1']*data['var2'] + np.random.normal(loc=0, scale=0.5, size=100)\r\ndata.head()\r\nparams = {\r\n    'objective': 'l1',\r\n    'metric': 'l1',    \r\n    \"verbosity\": -1,\r\n    \"boosting_type\": \"gbdt\",\r\n    'seed': 1979\r\n    }\r\n\r\ndtrain = lgb.Dataset(data= np.array( data[ ['var1', 'var2', 'var3'] ] ),\r\n                     label = np.array( data['target'] ).flatten())\r\n\r\nfolds = GroupKFold().split(np.array( data[ ['var1', 'var2', 'var3'] ] ),\r\n                            np.array( data['target'] ).flatten(), \r\n                            np.array(data['testfold']).flatten())\r\nlgb.cv(params, dtrain, folds=folds, verbose_eval=100) # This is how base lightgbm does this, and it works fine\r\n\r\n\r\n!pip install optuna\r\nimport optuna.integration.lightgbm as lgb\r\n\r\ndtrain = lgb.Dataset(data= np.array( data[ ['var1', 'var2', 'var3'] ] ),\r\n                     label = np.array( data['target'] ).flatten())\r\ntuner = lgb.LightGBMTunerCV(params, dtrain, verbose_eval=100, early_stopping_rounds=100, folds=folds)\r\ntuner.run()\r\n\r\ntuner = lgb.LightGBMTunerCV(params, dtrain, verbose_eval=100, folds=folds)\r\ntuner.run()\r\n```\r\n\r\n## Additional context (optional)\r\n\r\nSame issue in Kaggle kernels, but thought it would be easier to share a simplified Collab example.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1710/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1710/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1676", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1676/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1676/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1676/events", "html_url": "https://github.com/optuna/optuna/pull/1676", "id": 683936816, "node_id": "MDExOlB1bGxSZXF1ZXN0NDcxOTQzNDc0", "number": 1676, "title": "Exit thread after session is destroyed", "user": {"login": "KoyamaSohei", "id": 17472875, "node_id": "MDQ6VXNlcjE3NDcyODc1", "avatar_url": "https://avatars.githubusercontent.com/u/17472875?v=4", "gravatar_id": "", "url": "https://api.github.com/users/KoyamaSohei", "html_url": "https://github.com/KoyamaSohei", "followers_url": "https://api.github.com/users/KoyamaSohei/followers", "following_url": "https://api.github.com/users/KoyamaSohei/following{/other_user}", "gists_url": "https://api.github.com/users/KoyamaSohei/gists{/gist_id}", "starred_url": "https://api.github.com/users/KoyamaSohei/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/KoyamaSohei/subscriptions", "organizations_url": "https://api.github.com/users/KoyamaSohei/orgs", "repos_url": "https://api.github.com/users/KoyamaSohei/repos", "events_url": "https://api.github.com/users/KoyamaSohei/events{/privacy}", "received_events_url": "https://api.github.com/users/KoyamaSohei/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/27", "html_url": "https://github.com/optuna/optuna/milestone/27", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/27/labels", "id": 5659347, "node_id": "MDk6TWlsZXN0b25lNTY1OTM0Nw==", "number": 27, "title": "v2.1.0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 136, "state": "closed", "created_at": "2020-07-16T04:33:10Z", "updated_at": "2020-09-07T04:28:07Z", "due_on": null, "closed_at": "2020-09-07T04:28:07Z"}, "comments": 3, "created_at": "2020-08-22T05:56:44Z", "updated_at": "2020-08-23T04:59:21Z", "closed_at": "2020-08-23T03:28:15Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1676", "html_url": "https://github.com/optuna/optuna/pull/1676", "diff_url": "https://github.com/optuna/optuna/pull/1676.diff", "patch_url": "https://github.com/optuna/optuna/pull/1676.patch", "merged_at": "2020-08-23T03:28:15Z"}, "body": "<!-- Thank you for creating a pull request! -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\nFix https://github.com/optuna/optuna/issues/278\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\nWhen bokeh's session is destroyed, set flag(stop_event) to true, and thread exits.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1676/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1676/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1651", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1651/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1651/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1651/events", "html_url": "https://github.com/optuna/optuna/issues/1651", "id": 681720742, "node_id": "MDU6SXNzdWU2ODE3MjA3NDI=", "number": 1651, "title": "[Bug] Early stopping not working in OptunaSearchCV", "user": {"login": "rohan-gt", "id": 2353212, "node_id": "MDQ6VXNlcjIzNTMyMTI=", "avatar_url": "https://avatars.githubusercontent.com/u/2353212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rohan-gt", "html_url": "https://github.com/rohan-gt", "followers_url": "https://api.github.com/users/rohan-gt/followers", "following_url": "https://api.github.com/users/rohan-gt/following{/other_user}", "gists_url": "https://api.github.com/users/rohan-gt/gists{/gist_id}", "starred_url": "https://api.github.com/users/rohan-gt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rohan-gt/subscriptions", "organizations_url": "https://api.github.com/users/rohan-gt/orgs", "repos_url": "https://api.github.com/users/rohan-gt/repos", "events_url": "https://api.github.com/users/rohan-gt/events{/privacy}", "received_events_url": "https://api.github.com/users/rohan-gt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2020-08-19T10:16:27Z", "updated_at": "2021-06-27T23:06:03Z", "closed_at": "2021-06-27T23:06:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "`max_iter` in `OptunaSearchCV` doesn't work with LightGBM because there's no `partial_fit`. [This](https://github.com/microsoft/LightGBM/issues/2718) could be a potential fix", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1651/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1651/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1645", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1645/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1645/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1645/events", "html_url": "https://github.com/optuna/optuna/issues/1645", "id": 680364824, "node_id": "MDU6SXNzdWU2ODAzNjQ4MjQ=", "number": 1645, "title": "CmaEsSampler.infer_relative_search_space is missing required positional argument: 'trial'", "user": {"login": "rbelew", "id": 120920, "node_id": "MDQ6VXNlcjEyMDkyMA==", "avatar_url": "https://avatars.githubusercontent.com/u/120920?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rbelew", "html_url": "https://github.com/rbelew", "followers_url": "https://api.github.com/users/rbelew/followers", "following_url": "https://api.github.com/users/rbelew/following{/other_user}", "gists_url": "https://api.github.com/users/rbelew/gists{/gist_id}", "starred_url": "https://api.github.com/users/rbelew/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rbelew/subscriptions", "organizations_url": "https://api.github.com/users/rbelew/orgs", "repos_url": "https://api.github.com/users/rbelew/repos", "events_url": "https://api.github.com/users/rbelew/events{/privacy}", "received_events_url": "https://api.github.com/users/rbelew/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-08-17T16:33:02Z", "updated_at": "2020-08-18T02:08:44Z", "closed_at": "2020-08-18T02:08:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "Use of CmaEsSampler throws an exception, \r\n`infer_relative_search_space is missing required positional argument: 'trial'`\r\n\r\n## Expected behavior\r\n\r\nBelow is code that contrasts use of CmaEsSampler vs. the default sampler\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.0\r\n- Python version: 3.7.7\r\n- OS: MacOSX 10.15\r\n- (Optional) Other libraries and their versions:\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n[I 2020-08-17 09:23:18,345] A new study created with name: cmaesTst\r\nTraceback (most recent call last):\r\n  File \"/Users/Shared/Relocated Items/Security/Data/virtualenv/covasim/src/cmaesTst.py\", line 82, in <module>\r\n    study.optimize(op_objective, n_trials=20)\r\n  File \"/Users/Shared/Relocated Items/Security/Data/virtualenv/covasim/lib/python3.7/site-packages/optuna/study.py\", line 292, in optimize\r\n    func, n_trials, timeout, catch, callbacks, gc_after_trial, None\r\n  File \"/Users/Shared/Relocated Items/Security/Data/virtualenv/covasim/lib/python3.7/site-packages/optuna/study.py\", line 654, in _optimize_sequential\r\n    self._run_trial_and_callbacks(func, catch, callbacks, gc_after_trial)\r\n  File \"/Users/Shared/Relocated Items/Security/Data/virtualenv/covasim/lib/python3.7/site-packages/optuna/study.py\", line 685, in _run_trial_and_callbacks\r\n    trial = self._run_trial(func, catch, gc_after_trial)\r\n  File \"/Users/Shared/Relocated Items/Security/Data/virtualenv/covasim/lib/python3.7/site-packages/optuna/study.py\", line 705, in _run_trial\r\n    trial = trial_module.Trial(self, trial_id)\r\n  File \"/Users/Shared/Relocated Items/Security/Data/virtualenv/covasim/lib/python3.7/site-packages/optuna/trial/_trial.py\", line 65, in __init__\r\n    self._init_relative_params()\r\n  File \"/Users/Shared/Relocated Items/Security/Data/virtualenv/covasim/lib/python3.7/site-packages/optuna/trial/_trial.py\", line 74, in _init_relative_params\r\n    self.relative_search_space = self.study.sampler.infer_relative_search_space(study, trial)\r\nTypeError: infer_relative_search_space() missing 1 required positional argument: 'trial'\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Run code, observe error using CmaEsSampler\r\n2. Comment out call to `make_study()` using CmaEsSampler\r\n3. Un-comment line below using  call to `make_study()` with default sampler\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\nimport numpy as np\r\nimport optuna as op\r\nimport sciris as sc\r\n\r\nfrom optuna.samplers import CmaEsSampler\r\n\r\ndef objective(trial):\r\n\tx = trial[0]\r\n\ty = trial[1]\r\n\treturn x ** 2 + y\r\n\r\n\r\n\r\ndef op_objective(trial):\r\n\r\n\tSIMparam = dict(beta = dict(lb=0.003, ub=0.008),\r\n\t\t \t\t    pop_infected = dict(lb=1000,   ub=10000) )\r\n\r\n\tx = np.zeros(len(SIMparam))\r\n\tfor k,key in enumerate(SIMparam.keys()):\r\n\t\tlb = SIMparam[key]['lb']\r\n\t\tub = SIMparam[key]['ub']\r\n\t\tx[k] = trial.suggest_uniform(key, lb, ub )\r\n\r\n\treturn objective(x)\r\n\r\ndef make_study(storage,name,sampler=None):\r\n\ttry: \r\n\t\top.delete_study(storage=storage, study_name=name)\r\n\texcept: \r\n\t\tpass\r\n\tif sampler == None:\r\n\t\treturn op.create_study(storage=storage, study_name=name)\r\n\telse:\r\n\t\treturn op.create_study(storage=storage, study_name=name,sampler=sampler)\r\n\r\n\r\nif __name__ == '__main__':\r\n\t\r\n\tname = 'cmaesTst'\r\n\tstorage   = f'sqlite:///{name}.db'\r\n\tstudy = make_study(storage, 'cmaesTst', sampler=CmaEsSampler)\r\n\t# study = make_study(storage,'cmaesTst')\r\n\tstudy.optimize(op_objective, n_trials=20)\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1645/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1645/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1612", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1612/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1612/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1612/events", "html_url": "https://github.com/optuna/optuna/issues/1612", "id": 676091804, "node_id": "MDU6SXNzdWU2NzYwOTE4MDQ=", "number": 1612, "title": "Visualization is not possible with built-in functions", "user": {"login": "Fritskee", "id": 18385896, "node_id": "MDQ6VXNlcjE4Mzg1ODk2", "avatar_url": "https://avatars.githubusercontent.com/u/18385896?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Fritskee", "html_url": "https://github.com/Fritskee", "followers_url": "https://api.github.com/users/Fritskee/followers", "following_url": "https://api.github.com/users/Fritskee/following{/other_user}", "gists_url": "https://api.github.com/users/Fritskee/gists{/gist_id}", "starred_url": "https://api.github.com/users/Fritskee/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Fritskee/subscriptions", "organizations_url": "https://api.github.com/users/Fritskee/orgs", "repos_url": "https://api.github.com/users/Fritskee/repos", "events_url": "https://api.github.com/users/Fritskee/events{/privacy}", "received_events_url": "https://api.github.com/users/Fritskee/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-08-10T12:17:29Z", "updated_at": "2020-08-11T08:51:38Z", "closed_at": "2020-08-11T07:15:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "When using the optuna built in functions for visualization, most of them cause an Attribute Error, OR the few that do run will not show you the actual graphic. Instead they will just print the script to the terminal. This happens both when running it as a python script in the shell, or when using a python notebook. \r\n\r\n## Expected behavior\r\n\r\nAs shown on the optuna website, I would expect to see graphs when I pass my study object to the functions. \r\n(https://optuna.readthedocs.io/en/stable/reference/visualization.html)\r\n\r\n## Environment\r\n\r\n- Optuna version: 0.13.0\r\n- Python version: 3.6\r\n- OS: macOS Mojave v10.14.6 \r\n- (Optional) Other libraries and their versions: Python Plotly version 4.9.0\r\n\r\n## Error messages, stack traces, or logs\r\nThe following function (and most others of the visualization api don't run and cause an Attribute error)\r\n`visualization.plot_param_importances(study)\r\n`Traceback (most recent call last):\r\n\r\n  File \"<ipython-input-19-7f3a5f83c732>\", line 1, in <module>\r\n    visualization.plot_param_importances(study)\r\n\r\nAttributeError: module 'optuna.visualization' has no attribute 'plot_param_importances'\r\n```\r\n# error messages, stack traces, or logs\r\n```\r\n`optuna.visualization.plot_intermediate_values(study)`\r\nthrows does not throw an error. Instead it will print the script and not show a visual. The following output is obtained: \r\n`{'text/html': '        <script type=\"text/javascript\">\\n        window.PlotlyConfig = {MathJaxConfig: \\'local\\'};\\n        if (window.MathJax) {MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}\\n        if (typeof require !== \\'undefined\\') {\\n        require.undef(\"plotly\");\\n        requirejs.config({\\n            paths: {\\n                \\'plotly\\': [\\'https://cdn.plot.ly/plotly-latest.min\\']\\n            }\\n        });\\n        require([\\'plotly\\'], function(Plotly) {\\n            window._Plotly = Plotly;\\n        });\\n        }\\n        </script>\\n        '}\r\n{'application/vnd.plotly.v1+json': {'config': {'linkText': 'Export to plot.ly', 'plotlyServerURL': 'https://plot.ly', 'showLink': False}, 'data': [], 'layout': {'showlegend': False, 'template': {'data': {'bar': [{'error_x': {'color': '#2a3f5f'}, 'error_y': {'color': '#2a3f5f'}, 'marker': {'line': {'color': '#E5ECF6', 'width': 0.5}}, 'type': 'bar'}], 'barpolar': [{'marker': {'line': {'color': '#E5ECF6', 'width': 0.5}}, 'type': 'barpolar'}], 'carpet': [{'aaxis': {'endlinecolor': '#2a3f5f', 'gridcolor': 'white', 'linecolor': 'white', 'minorgridcolor': 'white', 'startlinecolor': '#2a3f5f'}, 'baxis': {'endlinecolor': '#2a3f5f', 'gridcolor': 'white', 'linecolor': 'white', 'minorgridcolor': 'white', 'startlinecolor': '#2a3f5f'}, 'type': 'carpet'}], 'choropleth': [{'colorbar': {'outlinewidth': 0, 'ticks': ''}, 'type': 'choropleth'}], 'contour': [{'colorbar': {'outlinewidth': 0, 'ticks': ''}, 'colorscale': [[0.0, '#0d0887'], [0.1111111111111111, '#46039f'], [0.2222222222222222, '#7201a8'], [0.3333333333333333, '#9c179e'], [0.4444444444444444, '#bd3786'], [0.5555555555555556, '#d8576b'], [0.6666666666666666, '#ed7953'], [0.7777777777777778, '#fb9f3a'], [0.8888888888888888, '#fdca26'], [1.0, '#f0f921']], 'type': 'contour'}], 'contourcarpet': [{'colorbar': {'outlinewidth': 0, 'ticks': ''}, 'type': 'contourcarpet'}], 'heatmap': [{'colorbar': {'outlinewidth': 0, 'ticks': ''}, 'colorscale': [[0.0, '#0d0887'], [0.1111111111111111, '#46039f'], [0.2222222222222222, '#7201a8'], [0.3333333333333333, '#9c179e'], [0.4444444444444444, '#bd3786'], [0.5555555555555556, '#d8576b'], [0.6666666666666666, '#ed7953'], [0.7777777777777778, '#fb9f3a'], [0.8888888888888888, '#fdca26'], [1.0, '#f0f921']], 'type': 'heatmap'}], 'heatmapgl': [{'colorbar': {'outlinewidth': 0, 'ticks': ''}, 'colorscale': [[0.0, '#0d0887'], [0.1111111111111111, '#46039f'], [0.2222222222222222, '#7201a8'], [0.3333333333333333, '#9c179e'], [0.4444444444444444, '#bd3786'], [0.5555555555555556, '#d8576b'], [0.6666666666666666, '#ed7953'], [0.7777777777777778, '#fb9f3a'], [0.8888888888888888, '#fdca26'], [1.0, '#f0f921']], 'type': 'heatmapgl'}], 'histogram': [{'marker': {'colorbar': {'outlinewidth': 0, 'ticks': ''}}, 'type': 'histogram'}], 'histogram2d': [{'colorbar': {'outlinewidth': 0, 'ticks': ''}, 'colorscale': [[0.0, '#0d0887'], [0.1111111111111111, '#46039f'], [0.2222222222222222, '#7201a8'], [0.3333333333333333, '#9c179e'], [0.4444444444444444, '#bd3786'], [0.5555555555555556, '#d8576b'], [0.6666666666666666, '#ed7953'], [0.7777777777777778, '#fb9f3a'], [0.8888888888888888, '#fdca26'], [1.0, '#f0f921']], 'type': 'histogram2d'}], 'histogram2dcontour': [{'colorbar': {'outlinewidth': 0, 'ticks': ''}, 'colorscale': [[0.0, '#0d0887'], [0.1111111111111111, '#46039f'], [0.2222222222222222, '#7201a8'], [0.3333333333333333, '#9c179e'], [0.4444444444444444, '#bd3786'], [0.5555555555555556, '#d8576b'], [0.6666666666666666, '#ed7953'], [0.7777777777777778, '#fb9f3a'], [0.8888888888888888, '#fdca26'], [1.0, '#f0f921']], 'type': 'histogram2dcontour'}], 'mesh3d': [{'colorbar': {'outlinewidth': 0, 'ticks': ''}, 'type': 'mesh3d'}], 'parcoords': [{'line': {'colorbar': {'outlinewidth': 0, 'ticks': ''}}, 'type': 'parcoords'}], 'pie': [{'automargin': True, 'type': 'pie'}], 'scatter': [{'marker': {'colorbar': {'outlinewidth': 0, 'ticks': ''}}, 'type': 'scatter'}], 'scatter3d': [{'line': {'colorbar': {'outlinewidth': 0, 'ticks': ''}}, 'marker': {'colorbar': {'outlinewidth': 0, 'ticks': ''}}, 'type': 'scatter3d'}], 'scattercarpet': [{'marker': {'colorbar': {'outlinewidth': 0, 'ticks': ''}}, 'type': 'scattercarpet'}], 'scattergeo': [{'marker': {'colorbar': {'outlinewidth': 0, 'ticks': ''}}, 'type': 'scattergeo'}], 'scattergl': [{'marker': {'colorbar': {'outlinewidth': 0, 'ticks': ''}}, 'type': 'scattergl'}], 'scattermapbox': [{'marker': {'colorbar': {'outlinewidth': 0, 'ticks': ''}}, 'type': 'scattermapbox'}], 'scatterpolar': [{'marker': {'colorbar': {'outlinewidth': 0, 'ticks': ''}}, 'type': 'scatterpolar'}], 'scatterpolargl': [{'marker': {'colorbar': {'outlinewidth': 0, 'ticks': ''}}, 'type': 'scatterpolargl'}], 'scatterternary': [{'marker': {'colorbar': {'outlinewidth': 0, 'ticks': ''}}, 'type': 'scatterternary'}], 'surface': [{'colorbar': {'outlinewidth': 0, 'ticks': ''}, 'colorscale': [[0.0, '#0d0887'], [0.1111111111111111, '#46039f'], [0.2222222222222222, '#7201a8'], [0.3333333333333333, '#9c179e'], [0.4444444444444444, '#bd3786'], [0.5555555555555556, '#d8576b'], [0.6666666666666666, '#ed7953'], [0.7777777777777778, '#fb9f3a'], [0.8888888888888888, '#fdca26'], [1.0, '#f0f921']], 'type': 'surface'}], 'table': [{'cells': {'fill': {'color': '#EBF0F8'}, 'line': {'color': 'white'}}, 'header': {'fill': {'color': '#C8D4E3'}, 'line': {'color': 'white'}}, 'type': 'table'}]}, 'layout': {'annotationdefaults': {'arrowcolor': '#2a3f5f', 'arrowhead': 0, 'arrowwidth': 1}, 'coloraxis': {'colorbar': {'outlinewidth': 0, 'ticks': ''}}, 'colorscale': {'diverging': [[0, '#8e0152'], [0.1, '#c51b7d'], [0.2, '#de77ae'], [0.3, '#f1b6da'], [0.4, '#fde0ef'], [0.5, '#f7f7f7'], [0.6, '#e6f5d0'], [0.7, '#b8e186'], [0.8, '#7fbc41'], [0.9, '#4d9221'], [1, '#276419']], 'sequential': [[0.0, '#0d0887'], [0.1111111111111111, '#46039f'], [0.2222222222222222, '#7201a8'], [0.3333333333333333, '#9c179e'], [0.4444444444444444, '#bd3786'], [0.5555555555555556, '#d8576b'], [0.6666666666666666, '#ed7953'], [0.7777777777777778, '#fb9f3a'], [0.8888888888888888, '#fdca26'], [1.0, '#f0f921']], 'sequentialminus': [[0.0, '#0d0887'], [0.1111111111111111, '#46039f'], [0.2222222222222222, '#7201a8'], [0.3333333333333333, '#9c179e'], [0.4444444444444444, '#bd3786'], [0.5555555555555556, '#d8576b'], [0.6666666666666666, '#ed7953'], [0.7777777777777778, '#fb9f3a'], [0.8888888888888888, '#fdca26'], [1.0, '#f0f921']]}, 'colorway': ['#636efa', '#EF553B', '#00cc96', '#ab63fa', '#FFA15A', '#19d3f3', '#FF6692', '#B6E880', '#FF97FF', '#FECB52'], 'font': {'color': '#2a3f5f'}, 'geo': {'bgcolor': 'white', 'lakecolor': 'white', 'landcolor': '#E5ECF6', 'showlakes': True, 'showland': True, 'subunitcolor': 'white'}, 'hoverlabel': {'align': 'left'}, 'hovermode': 'closest', 'mapbox': {'style': 'light'}, 'paper_bgcolor': 'white', 'plot_bgcolor': '#E5ECF6', 'polar': {'angularaxis': {'gridcolor': 'white', 'linecolor': 'white', 'ticks': ''}, 'bgcolor': '#E5ECF6', 'radialaxis': {'gridcolor': 'white', 'linecolor': 'white', 'ticks': ''}}, 'scene': {'xaxis': {'backgroundcolor': '#E5ECF6', 'gridcolor': 'white', 'gridwidth': 2, 'linecolor': 'white', 'showbackground': True, 'ticks': '', 'zerolinecolor': 'white'}, 'yaxis': {'backgroundcolor': '#E5ECF6', 'gridcolor': 'white', 'gridwidth': 2, 'linecolor': 'white', 'showbackground': True, 'ticks': '', 'zerolinecolor': 'white'}, 'zaxis': {'backgroundcolor': '#E5ECF6', 'gridcolor': 'white', 'gridwidth': 2, 'linecolor': 'white', 'showbackground': True, 'ticks': '', 'zerolinecolor': 'white'}}, 'shapedefaults': {'line': {'color': '#2a3f5f'}}, 'ternary': {'aaxis': {'gridcolor': 'white', 'linecolor': 'white', 'ticks': ''}, 'baxis': {'gridcolor': 'white', 'linecolor': 'white', 'ticks': ''}, 'bgcolor': '#E5ECF6', 'caxis': {'gridcolor': 'white', 'linecolor': 'white', 'ticks': ''}}, 'title': {'x': 0.05}, 'xaxis': {'automargin': True, 'gridcolor': 'white', 'linecolor': 'white', 'ticks': '', 'title': {'standoff': 15}, 'zerolinecolor': 'white', 'zerolinewidth': 2}, 'yaxis': {'automargin': True, 'gridcolor': 'white', 'linecolor': 'white', 'ticks': '', 'title': {'standoff': 15}, 'zerolinecolor': 'white', 'zerolinewidth': 2}}}}}, 'text/html': '<div>\\n        \\n        \\n            <div id=\"4a651fc8-efe1-4bfc-8a5e-523e6d703e62\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>\\n            <script type=\"text/javascript\">\\n                require([\"plotly\"], function(Plotly) {\\n                    window.PLOTLYENV=window.PLOTLYENV || {};\\n                    \\n                if (document.getElementById(\"4a651fc8-efe1-4bfc-8a5e-523e6d703e62\")) {\\n                    Plotly.newPlot(\\n                        \\'4a651fc8-efe1-4bfc-8a5e-523e6d703e62\\',\\n                        [],\\n                        {\"showlegend\": false, \"template\": {\"data\": {\"bar\": [{\"error_x\": {\"color\": \"#2a3f5f\"}, \"error_y\": {\"color\": \"#2a3f5f\"}, \"marker\": {\"line\": {\"color\": \"#E5ECF6\", \"width\": 0.5}}, \"type\": \"bar\"}], \"barpolar\": [{\"marker\": {\"line\": {\"color\": \"#E5ECF6\", \"width\": 0.5}}, \"type\": \"barpolar\"}], \"carpet\": [{\"aaxis\": {\"endlinecolor\": \"#2a3f5f\", \"gridcolor\": \"white\", \"linecolor\": \"white\", \"minorgridcolor\": \"white\", \"startlinecolor\": \"#2a3f5f\"}, \"baxis\": {\"endlinecolor\": \"#2a3f5f\", \"gridcolor\": \"white\", \"linecolor\": \"white\", \"minorgridcolor\": \"white\", \"startlinecolor\": \"#2a3f5f\"}, \"type\": \"carpet\"}], \"choropleth\": [{\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}, \"type\": \"choropleth\"}], \"contour\": [{\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}, \"colorscale\": [[0.0, \"#0d0887\"], [0.1111111111111111, \"#46039f\"], [0.2222222222222222, \"#7201a8\"], [0.3333333333333333, \"#9c179e\"], [0.4444444444444444, \"#bd3786\"], [0.5555555555555556, \"#d8576b\"], [0.6666666666666666, \"#ed7953\"], [0.7777777777777778, \"#fb9f3a\"], [0.8888888888888888, \"#fdca26\"], [1.0, \"#f0f921\"]], \"type\": \"contour\"}], \"contourcarpet\": [{\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}, \"type\": \"contourcarpet\"}], \"heatmap\": [{\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}, \"colorscale\": [[0.0, \"#0d0887\"], [0.1111111111111111, \"#46039f\"], [0.2222222222222222, \"#7201a8\"], [0.3333333333333333, \"#9c179e\"], [0.4444444444444444, \"#bd3786\"], [0.5555555555555556, \"#d8576b\"], [0.6666666666666666, \"#ed7953\"], [0.7777777777777778, \"#fb9f3a\"], [0.8888888888888888, \"#fdca26\"], [1.0, \"#f0f921\"]], \"type\": \"heatmap\"}], \"heatmapgl\": [{\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}, \"colorscale\": [[0.0, \"#0d0887\"], [0.1111111111111111, \"#46039f\"], [0.2222222222222222, \"#7201a8\"], [0.3333333333333333, \"#9c179e\"], [0.4444444444444444, \"#bd3786\"], [0.5555555555555556, \"#d8576b\"], [0.6666666666666666, \"#ed7953\"], [0.7777777777777778, \"#fb9f3a\"], [0.8888888888888888, \"#fdca26\"], [1.0, \"#f0f921\"]], \"type\": \"heatmapgl\"}], \"histogram\": [{\"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"histogram\"}], \"histogram2d\": [{\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}, \"colorscale\": [[0.0, \"#0d0887\"], [0.1111111111111111, \"#46039f\"], [0.2222222222222222, \"#7201a8\"], [0.3333333333333333, \"#9c179e\"], [0.4444444444444444, \"#bd3786\"], [0.5555555555555556, \"#d8576b\"], [0.6666666666666666, \"#ed7953\"], [0.7777777777777778, \"#fb9f3a\"], [0.8888888888888888, \"#fdca26\"], [1.0, \"#f0f921\"]], \"type\": \"histogram2d\"}], \"histogram2dcontour\": [{\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}, \"colorscale\": [[0.0, \"#0d0887\"], [0.1111111111111111, \"#46039f\"], [0.2222222222222222, \"#7201a8\"], [0.3333333333333333, \"#9c179e\"], [0.4444444444444444, \"#bd3786\"], [0.5555555555555556, \"#d8576b\"], [0.6666666666666666, \"#ed7953\"], [0.7777777777777778, \"#fb9f3a\"], [0.8888888888888888, \"#fdca26\"], [1.0, \"#f0f921\"]], \"type\": \"histogram2dcontour\"}], \"mesh3d\": [{\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}, \"type\": \"mesh3d\"}], \"parcoords\": [{\"line\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"parcoords\"}], \"pie\": [{\"automargin\": true, \"type\": \"pie\"}], \"scatter\": [{\"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"scatter\"}], \"scatter3d\": [{\"line\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"scatter3d\"}], \"scattercarpet\": [{\"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"scattercarpet\"}], \"scattergeo\": [{\"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"scattergeo\"}], \"scattergl\": [{\"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"scattergl\"}], \"scattermapbox\": [{\"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"scattermapbox\"}], \"scatterpolar\": [{\"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"scatterpolar\"}], \"scatterpolargl\": [{\"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"scatterpolargl\"}], \"scatterternary\": [{\"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"scatterternary\"}], \"surface\": [{\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}, \"colorscale\": [[0.0, \"#0d0887\"], [0.1111111111111111, \"#46039f\"], [0.2222222222222222, \"#7201a8\"], [0.3333333333333333, \"#9c179e\"], [0.4444444444444444, \"#bd3786\"], [0.5555555555555556, \"#d8576b\"], [0.6666666666666666, \"#ed7953\"], [0.7777777777777778, \"#fb9f3a\"], [0.8888888888888888, \"#fdca26\"], [1.0, \"#f0f921\"]], \"type\": \"surface\"}], \"table\": [{\"cells\": {\"fill\": {\"color\": \"#EBF0F8\"}, \"line\": {\"color\": \"white\"}}, \"header\": {\"fill\": {\"color\": \"#C8D4E3\"}, \"line\": {\"color\": \"white\"}}, \"type\": \"table\"}]}, \"layout\": {\"annotationdefaults\": {\"arrowcolor\": \"#2a3f5f\", \"arrowhead\": 0, \"arrowwidth\": 1}, \"coloraxis\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"colorscale\": {\"diverging\": [[0, \"#8e0152\"], [0.1, \"#c51b7d\"], [0.2, \"#de77ae\"], [0.3, \"#f1b6da\"], [0.4, \"#fde0ef\"], [0.5, \"#f7f7f7\"], [0.6, \"#e6f5d0\"], [0.7, \"#b8e186\"], [0.8, \"#7fbc41\"], [0.9, \"#4d9221\"], [1, \"#276419\"]], \"sequential\": [[0.0, \"#0d0887\"], [0.1111111111111111, \"#46039f\"], [0.2222222222222222, \"#7201a8\"], [0.3333333333333333, \"#9c179e\"], [0.4444444444444444, \"#bd3786\"], [0.5555555555555556, \"#d8576b\"], [0.6666666666666666, \"#ed7953\"], [0.7777777777777778, \"#fb9f3a\"], [0.8888888888888888, \"#fdca26\"], [1.0, \"#f0f921\"]], \"sequentialminus\": [[0.0, \"#0d0887\"], [0.1111111111111111, \"#46039f\"], [0.2222222222222222, \"#7201a8\"], [0.3333333333333333, \"#9c179e\"], [0.4444444444444444, \"#bd3786\"], [0.5555555555555556, \"#d8576b\"], [0.6666666666666666, \"#ed7953\"], [0.7777777777777778, \"#fb9f3a\"], [0.8888888888888888, \"#fdca26\"], [1.0, \"#f0f921\"]]}, \"colorway\": [\"#636efa\", \"#EF553B\", \"#00cc96\", \"#ab63fa\", \"#FFA15A\", \"#19d3f3\", \"#FF6692\", \"#B6E880\", \"#FF97FF\", \"#FECB52\"], \"font\": {\"color\": \"#2a3f5f\"}, \"geo\": {\"bgcolor\": \"white\", \"lakecolor\": \"white\", \"landcolor\": \"#E5ECF6\", \"showlakes\": true, \"showland\": true, \"subunitcolor\": \"white\"}, \"hoverlabel\": {\"align\": \"left\"}, \"hovermode\": \"closest\", \"mapbox\": {\"style\": \"light\"}, \"paper_bgcolor\": \"white\", \"plot_bgcolor\": \"#E5ECF6\", \"polar\": {\"angularaxis\": {\"gridcolor\": \"white\", \"linecolor\": \"white\", \"ticks\": \"\"}, \"bgcolor\": \"#E5ECF6\", \"radialaxis\": {\"gridcolor\": \"white\", \"linecolor\": \"white\", \"ticks\": \"\"}}, \"scene\": {\"xaxis\": {\"backgroundcolor\": \"#E5ECF6\", \"gridcolor\": \"white\", \"gridwidth\": 2, \"linecolor\": \"white\", \"showbackground\": true, \"ticks\": \"\", \"zerolinecolor\": \"white\"}, \"yaxis\": {\"backgroundcolor\": \"#E5ECF6\", \"gridcolor\": \"white\", \"gridwidth\": 2, \"linecolor\": \"white\", \"showbackground\": true, \"ticks\": \"\", \"zerolinecolor\": \"white\"}, \"zaxis\": {\"backgroundcolor\": \"#E5ECF6\", \"gridcolor\": \"white\", \"gridwidth\": 2, \"linecolor\": \"white\", \"showbackground\": true, \"ticks\": \"\", \"zerolinecolor\": \"white\"}}, \"shapedefaults\": {\"line\": {\"color\": \"#2a3f5f\"}}, \"ternary\": {\"aaxis\": {\"gridcolor\": \"white\", \"linecolor\": \"white\", \"ticks\": \"\"}, \"baxis\": {\"gridcolor\": \"white\", \"linecolor\": \"white\", \"ticks\": \"\"}, \"bgcolor\": \"#E5ECF6\", \"caxis\": {\"gridcolor\": \"white\", \"linecolor\": \"white\", \"ticks\": \"\"}}, \"title\": {\"x\": 0.05}, \"xaxis\": {\"automargin\": true, \"gridcolor\": \"white\", \"linecolor\": \"white\", \"ticks\": \"\", \"title\": {\"standoff\": 15}, \"zerolinecolor\": \"white\", \"zerolinewidth\": 2}, \"yaxis\": {\"automargin\": true, \"gridcolor\": \"white\", \"linecolor\": \"white\", \"ticks\": \"\", \"title\": {\"standoff\": 15}, \"zerolinecolor\": \"white\", \"zerolinewidth\": 2}}}},\\n                        {\"responsive\": true}\\n                    ).then(function(){\\n                            \\nvar gd = document.getElementById(\\'4a651fc8-efe1-4bfc-8a5e-523e6d703e62\\');\\nvar x = new MutationObserver(function (mutations, observer) {{\\n        var display = window.getComputedStyle(gd).display;\\n        if (!display || display === \\'none\\') {{\\n            console.log([gd, \\'removed!\\']);\\n            Plotly.purge(gd);\\n            observer.disconnect();\\n        }}\\n}});\\n\\n// Listen for the removal of the full notebook cells\\nvar notebookContainer = gd.closest(\\'#notebook-container\\');\\nif (notebookContainer) {{\\n    x.observe(notebookContainer, {childList: true});\\n}}\\n\\n// Listen for the clearing of the current output cell\\nvar outputEl = gd.closest(\\'.output\\');\\nif (outputEl) {{\\n    x.observe(outputEl, {childList: true});\\n}}\\n\\n                        })\\n                };\\n                });\\n            </script>\\n        </div>'}`\r\n## Steps to reproduce\r\n\r\n1. Create a study \r\n2. Run the experiment\r\n3. Try to visualize the study after running it with the above mentioned functions\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1612/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1612/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1608", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1608/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1608/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1608/events", "html_url": "https://github.com/optuna/optuna/issues/1608", "id": 675519095, "node_id": "MDU6SXNzdWU2NzU1MTkwOTU=", "number": 1608, "title": "PercentilePruner raise RuntimeWarning: Mean of empty slice   return np.nanmean(a, axis, out=out, keepdims=keepdims)", "user": {"login": "chang19940513", "id": 40170551, "node_id": "MDQ6VXNlcjQwMTcwNTUx", "avatar_url": "https://avatars.githubusercontent.com/u/40170551?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chang19940513", "html_url": "https://github.com/chang19940513", "followers_url": "https://api.github.com/users/chang19940513/followers", "following_url": "https://api.github.com/users/chang19940513/following{/other_user}", "gists_url": "https://api.github.com/users/chang19940513/gists{/gist_id}", "starred_url": "https://api.github.com/users/chang19940513/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chang19940513/subscriptions", "organizations_url": "https://api.github.com/users/chang19940513/orgs", "repos_url": "https://api.github.com/users/chang19940513/repos", "events_url": "https://api.github.com/users/chang19940513/events{/privacy}", "received_events_url": "https://api.github.com/users/chang19940513/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-08-08T12:36:06Z", "updated_at": "2021-02-28T23:22:18Z", "closed_at": "2021-02-28T23:22:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\nWhen use PercentilePruner, if all trails' step are small and a new trail's step may too big, then _get_percentile_intermediate_result_over_trials will return None. And raise RuntimeWarning: Mean of empty slice   return np.nanmean(a, axis, out=out, keepdims=keepdims).\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\n## Environment\r\n\r\n- Optuna version:\r\n- Python version:\r\n- OS:\r\n- (Optional) Other libraries and their versions:\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n# error messages, stack traces, or logs\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1.\r\n2.\r\n3.\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\n# python code\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1608/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1608/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1602", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1602/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1602/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1602/events", "html_url": "https://github.com/optuna/optuna/issues/1602", "id": 674110817, "node_id": "MDU6SXNzdWU2NzQxMTA4MTc=", "number": 1602, "title": "LightGBMTunerCV not working for regression objective", "user": {"login": "thigm85", "id": 2162939, "node_id": "MDQ6VXNlcjIxNjI5Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/2162939?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thigm85", "html_url": "https://github.com/thigm85", "followers_url": "https://api.github.com/users/thigm85/followers", "following_url": "https://api.github.com/users/thigm85/following{/other_user}", "gists_url": "https://api.github.com/users/thigm85/gists{/gist_id}", "starred_url": "https://api.github.com/users/thigm85/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thigm85/subscriptions", "organizations_url": "https://api.github.com/users/thigm85/orgs", "repos_url": "https://api.github.com/users/thigm85/repos", "events_url": "https://api.github.com/users/thigm85/events{/privacy}", "received_events_url": "https://api.github.com/users/thigm85/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 14, "created_at": "2020-08-06T08:04:36Z", "updated_at": "2020-08-26T04:03:42Z", "closed_at": "2020-08-26T04:03:42Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The script https://github.com/optuna/optuna/blob/master/examples/lightgbm_tuner_cv.py runs just fine as it is. However, I get a `KeyError: 'mse-mean'` if I change the `objective` to `regression` and `metric` to `mse`. Similar erro happens to other metrics as well when the `objective` is set to `regression`.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.0.0\r\n- Python version: 3.7\r\n- OS: MacOS Catalina\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nKeyError                                  Traceback (most recent call last)\r\n<ipython-input-11-7753103b8251> in <module>\r\n     15 )\r\n     16 \r\n---> 17 tuner.run()\r\n     18 \r\n     19 print(\"Best score:\", tuner.best_score)\r\n\r\n/usr/local/lib/python3.7/site-packages/optuna/integration/_lightgbm_tuner/optimize.py in run(self)\r\n    461         self.sample_train_set()\r\n    462 \r\n--> 463         self.tune_feature_fraction()\r\n    464         self.tune_num_leaves()\r\n    465         self.tune_bagging()\r\n\r\n/usr/local/lib/python3.7/site-packages/optuna/integration/_lightgbm_tuner/optimize.py in tune_feature_fraction(self, n_trials)\r\n    486 \r\n    487         sampler = optuna.samplers.GridSampler({param_name: param_values})\r\n--> 488         self._tune_params([param_name], len(param_values), sampler, \"feature_fraction\")\r\n    489 \r\n    490     def tune_num_leaves(self, n_trials: int = 20) -> None:\r\n\r\n/usr/local/lib/python3.7/site-packages/optuna/integration/_lightgbm_tuner/optimize.py in _tune_params(self, target_param_names, n_trials, sampler, step_name)\r\n    567                 timeout=_timeout,\r\n    568                 catch=(),\r\n--> 569                 callbacks=self._optuna_callbacks,\r\n    570             )\r\n    571 \r\n\r\n/usr/local/lib/python3.7/site-packages/optuna/study.py in optimize(self, func, n_trials, timeout, n_jobs, catch, callbacks, gc_after_trial, show_progress_bar)\r\n    290             if n_jobs == 1:\r\n    291                 self._optimize_sequential(\r\n--> 292                     func, n_trials, timeout, catch, callbacks, gc_after_trial, None\r\n    293                 )\r\n    294             else:\r\n\r\n/usr/local/lib/python3.7/site-packages/optuna/study.py in _optimize_sequential(self, func, n_trials, timeout, catch, callbacks, gc_after_trial, time_start)\r\n    652                     break\r\n    653 \r\n--> 654             self._run_trial_and_callbacks(func, catch, callbacks, gc_after_trial)\r\n    655 \r\n    656             self._progress_bar.update((datetime.datetime.now() - time_start).total_seconds())\r\n\r\n/usr/local/lib/python3.7/site-packages/optuna/study.py in _run_trial_and_callbacks(self, func, catch, callbacks, gc_after_trial)\r\n    683         # type: (...) -> None\r\n    684 \r\n--> 685         trial = self._run_trial(func, catch, gc_after_trial)\r\n    686         if callbacks is not None:\r\n    687             frozen_trial = copy.deepcopy(self._storage.get_trial(trial._trial_id))\r\n\r\n/usr/local/lib/python3.7/site-packages/optuna/study.py in _run_trial(self, func, catch, gc_after_trial)\r\n    707 \r\n    708         try:\r\n--> 709             result = func(trial)\r\n    710         except exceptions.TrialPruned as e:\r\n    711             message = \"Trial {} pruned. {}\".format(trial_number, str(e))\r\n\r\n/usr/local/lib/python3.7/site-packages/optuna/integration/_lightgbm_tuner/optimize.py in __call__(self, trial)\r\n    302         cv_results = lgb.cv(self.lgbm_params, self.train_set, **self.lgbm_kwargs)\r\n    303 \r\n--> 304         val_scores = self._get_cv_scores(cv_results)\r\n    305         val_score = val_scores[-1]\r\n    306         elapsed_secs = time.time() - start_time\r\n\r\n/usr/local/lib/python3.7/site-packages/optuna/integration/_lightgbm_tuner/optimize.py in _get_cv_scores(self, cv_results)\r\n    292 \r\n    293         metric = self._get_metric_for_objective()\r\n--> 294         val_scores = cv_results[\"{}-mean\".format(metric)]\r\n    295         return val_scores\r\n    296 \r\n\r\nKeyError: 'mse-mean'\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Run [this script](https://github.com/optuna/optuna/blob/master/examples/lightgbm_tuner_cv.py) with objective = regression and metric = mse. \r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1602/reactions", "total_count": 3, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 3}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1602/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1598", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1598/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1598/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1598/events", "html_url": "https://github.com/optuna/optuna/issues/1598", "id": 673646343, "node_id": "MDU6SXNzdWU2NzM2NDYzNDM=", "number": 1598, "title": "study.optimize fails with LightGBM and packaging < 20.0", "user": {"login": "Isa-rentacs", "id": 1147443, "node_id": "MDQ6VXNlcjExNDc0NDM=", "avatar_url": "https://avatars.githubusercontent.com/u/1147443?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Isa-rentacs", "html_url": "https://github.com/Isa-rentacs", "followers_url": "https://api.github.com/users/Isa-rentacs/followers", "following_url": "https://api.github.com/users/Isa-rentacs/following{/other_user}", "gists_url": "https://api.github.com/users/Isa-rentacs/gists{/gist_id}", "starred_url": "https://api.github.com/users/Isa-rentacs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Isa-rentacs/subscriptions", "organizations_url": "https://api.github.com/users/Isa-rentacs/orgs", "repos_url": "https://api.github.com/users/Isa-rentacs/repos", "events_url": "https://api.github.com/users/Isa-rentacs/events{/privacy}", "received_events_url": "https://api.github.com/users/Isa-rentacs/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-08-05T15:48:26Z", "updated_at": "2020-08-06T00:26:00Z", "closed_at": "2020-08-06T00:26:00Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\nCurrent ```setup.py``` does not specify the version of [packaging](https://pypi.org/project/packaging/).\r\nHowever, ```packaging.version.Version.major``` which is used in [_deprecated.py](https://github.com/optuna/optuna/blob/master/optuna/_deprecated.py#L39) was introduced in version 20.0.\r\n\r\nc.f.)\r\nhttps://github.com/pypa/packaging/blob/19.2/packaging/version.py\r\nhttps://github.com/pypa/packaging/blob/20.0/packaging/version.py\r\n\r\nThis caused an error ```AttributeError: 'Version' object has no attribute 'major'``` when we call ```study.optimize``` if pacakaging is older than 20.0.\r\n\r\n## Expected behavior\r\n```study.optimize``` runs without aforementioned error. ([Gist](https://gist.github.com/Isa-rentacs/8aeb0b3506b2f72dd204c93380b377ce))\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\n## Environment\r\n- Optuna version: 2.0.0\r\n- Python version: 3.7\r\n- OS: Ubuntu 18.04\r\n- (Optional) Other libraries and their versions:\r\n  * packaging == 19.2\r\n  * lightgbm == 2.2.3\r\n\r\n## Error messages, stack traces, or logs\r\nGist with reproduce steps and error logs is [here](https://gist.github.com/Isa-rentacs/2151551016245cfae0a7ca92c868681e)\r\n\r\n## Steps to reproduce\r\n1. Install ```packaging``` == 19.2\r\n2. Setup ```study``` that uses LightGBM \r\n3. Call ```optimize```\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1598/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1598/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1569", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1569/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1569/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1569/events", "html_url": "https://github.com/optuna/optuna/issues/1569", "id": 667763502, "node_id": "MDU6SXNzdWU2Njc3NjM1MDI=", "number": 1569, "title": "trial.suggest_int uses RandomSampler instead of CmaEsSampler", "user": {"login": "koh-joshua", "id": 68499428, "node_id": "MDQ6VXNlcjY4NDk5NDI4", "avatar_url": "https://avatars.githubusercontent.com/u/68499428?v=4", "gravatar_id": "", "url": "https://api.github.com/users/koh-joshua", "html_url": "https://github.com/koh-joshua", "followers_url": "https://api.github.com/users/koh-joshua/followers", "following_url": "https://api.github.com/users/koh-joshua/following{/other_user}", "gists_url": "https://api.github.com/users/koh-joshua/gists{/gist_id}", "starred_url": "https://api.github.com/users/koh-joshua/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/koh-joshua/subscriptions", "organizations_url": "https://api.github.com/users/koh-joshua/orgs", "repos_url": "https://api.github.com/users/koh-joshua/repos", "events_url": "https://api.github.com/users/koh-joshua/events{/privacy}", "received_events_url": "https://api.github.com/users/koh-joshua/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 24, "created_at": "2020-07-29T11:17:04Z", "updated_at": "2020-10-01T05:15:50Z", "closed_at": "2020-10-01T05:15:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\nAll my parameters are using trial.suggest_int.\r\nTried optuna.samplers.CmaEsSampler but performance really bad. Many parameters used RandomSampler and objective score, R2 was very low and seemed static, R2 = 0.30\r\nTried optuna.integration.CmaEsSampler and performance was slightly better, R2 = 0.58 - 0.60 but also many parameters was sampled using RandomSampler.\r\nThe same study using TPESampler gives R2 = 0.749, no problems.\r\n\r\nSome representative codes:\r\n\r\ndef objective (trial):\r\n    params_list =[]\r\n    n_params = trial.suggest_int('n_params', 3, 5)\r\n    param1 = trial.suggest_int('param1', 0, 1200)\r\n    param2 = trial.suggest_int('param2', 0, 1199)\r\n    params_list.append(param1)\r\n    params_list.append(param2) \r\n    if n_params >=3: \r\n            param3 = trial.suggest_int('param3', 0, 1198)\r\n            params_list.append(param3)\r\n    if n_params >=4:\r\n            param4 = trial.suggest_int('param4', 0, 1197)\r\n            params_list.append(param4)\r\n   if n_params >=5:\r\n          param5 = trial.suggest_int('param5', 0, 1196)\r\n          params_list.append(param5)\r\n    model = model(params_list)\r\n    score = model.evaluate(x_test, y_test)   # R2 score\r\n    return score\r\n \r\nstudy = optuna.create_study(direction='maximize', sampler=optuna.samplers.CmaEsSampler)\r\nstudy.optimize(objective, n_trials=10000, n_jobs=-1)\r\n\r\nI have noticed that **RandomSampler is always used on params 3, 4, 5 i.e. those that were in the conditional if statements.** \r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\nI expect performance to be comparable to TPESampler and sampling is done using the CmaEsSampler.\r\n\r\n## Environment\r\n\r\n- Optuna version: 2.0\r\n- Python version: 3.7\r\n- OS: win10 64-bit\r\n- (Optional) Other libraries and their versions: \r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n# error messages, stack traces, or logs\r\nExample error messages:\r\n[W 2020-07-29 20:58:44,714] The parameter 'param3' in trial#9993 is sampled independently by using `RandomSampler` instead of `CmaEsSampler` (optimization performance may be degraded). You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\n[W 2020-07-29 20:58:44,714] The parameter 'param4' in trial#9994 is sampled independently by using `RandomSampler` instead of `CmaEsSampler` (optimization performance may be degraded). You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\n[W 2020-07-29 20:58:44,714] The parameter 'param5' in trial#9996 is sampled independently by using `RandomSampler` instead of `CmaEsSampler` (optimization performance may be degraded). You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1569/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1569/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1558", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1558/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1558/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1558/events", "html_url": "https://github.com/optuna/optuna/pull/1558", "id": 665794161, "node_id": "MDExOlB1bGxSZXF1ZXN0NDU2NzU4ODYw", "number": 1558, "title": "Avoid to sample the value which equals to upper bound", "user": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/27", "html_url": "https://github.com/optuna/optuna/milestone/27", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/27/labels", "id": 5659347, "node_id": "MDk6TWlsZXN0b25lNTY1OTM0Nw==", "number": 27, "title": "v2.1.0", "description": "", "creator": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 136, "state": "closed", "created_at": "2020-07-16T04:33:10Z", "updated_at": "2020-09-07T04:28:07Z", "due_on": null, "closed_at": "2020-09-07T04:28:07Z"}, "comments": 3, "created_at": "2020-07-26T14:39:29Z", "updated_at": "2020-07-28T07:06:16Z", "closed_at": "2020-07-28T04:05:36Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1558", "html_url": "https://github.com/optuna/optuna/pull/1558", "diff_url": "https://github.com/optuna/optuna/pull/1558.diff", "patch_url": "https://github.com/optuna/optuna/pull/1558.patch", "merged_at": "2020-07-28T04:05:35Z"}, "body": "<!-- Thank you for creating a pull request! -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\nTo fix #1557.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\nIt is not prohibited to sample the value which equals to upper bound in CyberAgent/cmaes (and pycma). But Optuna's continuous distribution only accepts `[low, high)`. So I cap the upper bound with tiny value to fix the problem which I reported to #1557.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1558/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1558/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1557", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1557/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1557/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1557/events", "html_url": "https://github.com/optuna/optuna/issues/1557", "id": 665785579, "node_id": "MDU6SXNzdWU2NjU3ODU1Nzk=", "number": 1557, "title": "Independent sampler is triggered even if the search space is not dynamic.", "user": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-07-26T14:03:18Z", "updated_at": "2020-07-28T04:05:36Z", "closed_at": "2020-07-28T04:05:36Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n## Expected behavior\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\nSometimes, independent sampler is triggered though the search space is clearly not dynamic.\r\n\r\n```python\r\nimport numpy as np\r\nimport optuna\r\n\r\n\r\nclass Rastrigin:\r\n    \"\"\"\r\n    https://www.sfu.ca/~ssurjano/rastr.html\r\n    \"\"\"\r\n    def __init__(self, n):\r\n        self.n = n\r\n\r\n    def __call__(self, trial):\r\n        x = np.array([trial.suggest_uniform(f\"x{i}\", -5.12, 5.12) for i in range(self.n)])\r\n        return 10 * self.n + np.sum(x ** 2 - 10 * np.cos(2 * np.pi * x))\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    optuna.logging.set_verbosity(optuna.logging.WARNING)\r\n    objective = Rastrigin(8)\r\n\r\n    for seed in range(10):\r\n        study = optuna.create_study(\r\n            sampler=optuna.samplers.CmaEsSampler(seed=seed)\r\n        )\r\n        study.optimize(objective, n_trials=1500)\r\n        print(\"Best value: {} (params: {})\\n\".format(study.best_value, study.best_params))\r\n```\r\n\r\n\r\n## Environment\r\n\r\n- Optuna version: master (rev: 278034a9)\r\n- Python version: 3.8.2\r\n- OS:macOS\r\n- (Optional) Other libraries and their versions:\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n$ python examples/quadratic_simple.py \r\n[W 2020-07-26 22:51:19,360] The parameter 'x6' in trial#1328 is sampled independently by using `RandomSampler` instead of `CmaEsSampler` (optimization performance may be degraded). You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\nBest value: 40.1899514495306 (params: {'x0': 0.995858149009119, 'x1': -1.1351238915698543, 'x2': -0.1801230004399368, 'x3': 1.9177514176898494, 'x4': 0.1605867098097168, 'x5': -2.0070995883976925, 'x6': 1.2348466691400497, 'x7': -1.1301172829126584})\r\n\r\nBest value: 32.4631637787495 (params: {'x0': -0.1888686495274782, 'x1': -0.8994779770534349, 'x2': 0.1759863776573024, 'x3': 0.08718985952421743, 'x4': -0.21347527704332003, 'x5': 0.1533930220554347, 'x6': -0.15323426159592224, 'x7': -0.009436181675708921})\r\n\r\nBest value: 31.91496288803713 (params: {'x0': 0.02690799189465823, 'x1': 0.9301003789280453, 'x2': -0.9063281146700595, 'x3': -0.11441781075028418, 'x4': 0.8908104409619761, 'x5': -0.55904514348641, 'x6': -1.0243546160884258, 'x7': 1.0191798909768646})\r\n\r\n[W 2020-07-26 22:51:26,492] The parameter 'x3' in trial#1483 is sampled independently by using `RandomSampler` instead of `CmaEsSampler` (optimization performance may be degraded). You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\n[W 2020-07-26 22:51:26,492] The parameter 'x4' in trial#1483 is sampled independently by using `RandomSampler` instead of `CmaEsSampler` (optimization performance may be degraded). You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\n[W 2020-07-26 22:51:26,493] The parameter 'x5' in trial#1483 is sampled independently by using `RandomSampler` instead of `CmaEsSampler` (optimization performance may be degraded). You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\n[W 2020-07-26 22:51:26,515] The parameter 'x1' in trial#1492 is sampled independently by using `RandomSampler` instead of `CmaEsSampler` (optimization performance may be degraded). You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\n[W 2020-07-26 22:51:26,515] The parameter 'x3' in trial#1492 is sampled independently by using `RandomSampler` instead of `CmaEsSampler` (optimization performance may be degraded). You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\n[W 2020-07-26 22:51:26,516] The parameter 'x6' in trial#1492 is sampled independently by using `RandomSampler` instead of `CmaEsSampler` (optimization performance may be degraded). You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\n[W 2020-07-26 22:51:26,524] The parameter 'x2' in trial#1495 is sampled independently by using `RandomSampler` instead of `CmaEsSampler` (optimization performance may be degraded). You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\n[W 2020-07-26 22:51:26,525] The parameter 'x3' in trial#1495 is sampled independently by using `RandomSampler` instead of `CmaEsSampler` (optimization performance may be degraded). You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\nBest value: 42.284741734204616 (params: {'x0': 0.8611571722449447, 'x1': -1.0202710839736775, 'x2': -0.9161870092865121, 'x3': 1.1074296676201707, 'x4': 2.020475272523612, 'x5': 2.6341278204885925, 'x6': -0.961020444464636, 'x7': -1.075404689687082})\r\n\r\nBest value: 35.837188844247734 (params: {'x0': 0.16491643650172522, 'x1': -0.9135554351547925, 'x2': -0.15711841139753724, 'x3': -0.7403737469975655, 'x4': 0.9699238273692735, 'x5': -0.9646192974710259, 'x6': -0.24383102905966858, 'x7': -0.9980549047856908})\r\n\r\n[W 2020-07-26 22:51:30,744] The parameter 'x7' in trial#1187 is sampled independently by using `RandomSampler` instead of `CmaEsSampler` (optimization performance may be degraded). You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\n[W 2020-07-26 22:51:31,066] The parameter 'x3' in trial#1324 is sampled independently by using `RandomSampler` instead of `CmaEsSampler` (optimization performance may be degraded). You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\n[W 2020-07-26 22:51:31,067] The parameter 'x4' in trial#1324 is sampled independently by using `RandomSampler` instead of `CmaEsSampler` (optimization performance may be degraded). You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\n[W 2020-07-26 22:51:31,067] The parameter 'x7' in trial#1324 is sampled independently by using `RandomSampler` instead of `CmaEsSampler` (optimization performance may be degraded). You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\n[W 2020-07-26 22:51:31,398] The parameter 'x2' in trial#1478 is sampled independently by using `RandomSampler` instead of `CmaEsSampler` (optimization performance may be degraded). You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\n[W 2020-07-26 22:51:31,435] The parameter 'x3' in trial#1492 is sampled independently by using `RandomSampler` instead of `CmaEsSampler` (optimization performance may be degraded). You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\n[W 2020-07-26 22:51:31,435] The parameter 'x7' in trial#1492 is sampled independently by using `RandomSampler` instead of `CmaEsSampler` (optimization performance may be degraded). You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\nBest value: 29.19879250598784 (params: {'x0': 2.0770115850339996, 'x1': 1.0571498004291093, 'x2': 1.0843035099445237, 'x3': 1.0745606517288824, 'x4': -1.8806912321660192, 'x5': -0.9559137545222565, 'x6': -1.193838173651328, 'x7': -0.09452242291271634})\r\n\r\nBest value: 29.34525115041371 (params: {'x0': 1.0355545841547409, 'x1': -0.14212348444599865, 'x2': -0.09354311427862283, 'x3': -0.10414346874509228, 'x4': -1.1537474227287918, 'x5': 0.9559745956916987, 'x6': 0.21069559289098455, 'x7': -1.1597322728811668})\r\n\r\n: (omit)\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1557/reactions", "total_count": 2, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 2}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1557/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1553", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1553/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1553/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1553/events", "html_url": "https://github.com/optuna/optuna/issues/1553", "id": 665467180, "node_id": "MDU6SXNzdWU2NjU0NjcxODA=", "number": 1553, "title": "Can I set search condition based on number of trials?", "user": {"login": "JoshKoh", "id": 32561239, "node_id": "MDQ6VXNlcjMyNTYxMjM5", "avatar_url": "https://avatars.githubusercontent.com/u/32561239?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JoshKoh", "html_url": "https://github.com/JoshKoh", "followers_url": "https://api.github.com/users/JoshKoh/followers", "following_url": "https://api.github.com/users/JoshKoh/following{/other_user}", "gists_url": "https://api.github.com/users/JoshKoh/gists{/gist_id}", "starred_url": "https://api.github.com/users/JoshKoh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JoshKoh/subscriptions", "organizations_url": "https://api.github.com/users/JoshKoh/orgs", "repos_url": "https://api.github.com/users/JoshKoh/repos", "events_url": "https://api.github.com/users/JoshKoh/events{/privacy}", "received_events_url": "https://api.github.com/users/JoshKoh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1646581847, "node_id": "MDU6TGFiZWwxNjQ2NTgxODQ3", "url": "https://api.github.com/repos/optuna/optuna/labels/question", "name": "question", "color": "e27802", "default": true, "description": "Question about Optuna."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 16, "created_at": "2020-07-24T23:29:31Z", "updated_at": "2020-07-28T01:30:58Z", "closed_at": "2020-07-28T01:30:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "Can I set search condition based on number of trials? For example, I want to explore certain value range for the first 5,000 trials, then change after 5,000 trials:\r\n\r\nIf trials <= 5,000:\r\n    param1 = trial.suggest_int('param1', 0, 50)\r\n    param2 = trial.suggest_int('param2', 0, 50)\r\nelif trials > 5,000:\r\n    param1 = trials.suggest_int('param1', 100, 200)\r\n    param2 = trials.suggest_int('param2', 100, 200)\r\n\r\nIs there a way to access the number of trials completed in the conditional statement? \r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1553/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1553/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1552", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1552/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1552/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1552/events", "html_url": "https://github.com/optuna/optuna/issues/1552", "id": 665334945, "node_id": "MDU6SXNzdWU2NjUzMzQ5NDU=", "number": 1552, "title": "Different sampling behavior depending on Trial Pruned or Trial Failed due to Exception.", "user": {"login": "lukovnikov", "id": 1732910, "node_id": "MDQ6VXNlcjE3MzI5MTA=", "avatar_url": "https://avatars.githubusercontent.com/u/1732910?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lukovnikov", "html_url": "https://github.com/lukovnikov", "followers_url": "https://api.github.com/users/lukovnikov/followers", "following_url": "https://api.github.com/users/lukovnikov/following{/other_user}", "gists_url": "https://api.github.com/users/lukovnikov/gists{/gist_id}", "starred_url": "https://api.github.com/users/lukovnikov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lukovnikov/subscriptions", "organizations_url": "https://api.github.com/users/lukovnikov/orgs", "repos_url": "https://api.github.com/users/lukovnikov/repos", "events_url": "https://api.github.com/users/lukovnikov/events{/privacy}", "received_events_url": "https://api.github.com/users/lukovnikov/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2020-07-24T18:14:13Z", "updated_at": "2022-01-07T03:26:44Z", "closed_at": "2020-08-18T12:18:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\nIt seems the sampling behavior differs between the cases where the trial has been pruned or where the trial failed with an exception.\r\n\r\n## Expected behavior\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\nThe sets of samples produced by the sampler should remain similar, independent of whether the trial was pruned or the trial failed due to an exception?\r\n\r\n## Environment\r\n\r\n- Optuna version: 1.5.0 (from pip install)\r\n- Python version: 3.6\r\n- OS: Windows\r\n- (Optional) Other libraries and their versions: Pytorch\r\n\r\n## Steps to reproduce\r\nRunning this\r\n```python\r\n    def obj(trial):\r\n        x = trial.suggest_uniform(\"x\", -5, 5)\r\n        y = trial.suggest_uniform(\"y\", -5, 5)\r\n        if not(abs(x) > abs(y) or y < 0):\r\n            raise optuna.TrialPruned()\r\n        return (abs(x) + abs(y)) ** 2\r\n\r\n    study = optuna.create_study(direction=\"minimize\")\r\n    study.optimize(obj, n_trials=200, catch=(Exception,))\r\n```\r\nand running this:\r\n```python\r\n    def obj(trial):\r\n        x = trial.suggest_uniform(\"x\", -5, 5)\r\n        y = trial.suggest_uniform(\"y\", -5, 5)\r\n        if not(abs(x) > abs(y) or y < 0):\r\n            raise Exception(\"invalid config\")\r\n        return (abs(x) + abs(y)) ** 2\r\n\r\n    study = optuna.create_study(direction=\"minimize\")\r\n    study.optimize(obj, n_trials=200, catch=(Exception,))\r\n```\r\ngives very different sets of samples. \r\n\r\nThe completed samples produced for the TrialPruned() version are: \r\n![afbeelding](https://user-images.githubusercontent.com/1732910/88421155-53304300-cde8-11ea-8175-6fded3c04887.png)\r\nThe completed samples produced for the Exception() version are:\r\n![afbeelding](https://user-images.githubusercontent.com/1732910/88421188-680cd680-cde8-11ea-9cf8-7edec4efebb6.png)\r\nover different runs.\r\n\r\nIn the case of a failure due to an exception, the sampler seems to retry other values in the neighbourhood of the failed sample.\r\n\r\nIs this behavior expected? It might be bad in some cases, where a portion of the search space leads to memory errors (or other problems). If the sampler keeps resampling very closely, only few experiments will actually be properly run (even a 1000 trial run had only the first 10-20 runs complete, while the remaining all failed).\r\n\r\nIs using `TrialPruned()` the correct way to exclude a portion of the search space without further influence on the search behavior (such as the sampler getting discouraged to sample closer to the pruned space)?", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1552/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1552/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1547", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1547/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1547/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1547/events", "html_url": "https://github.com/optuna/optuna/issues/1547", "id": 664235252, "node_id": "MDU6SXNzdWU2NjQyMzUyNTI=", "number": 1547, "title": "Same parameters for multiple trials under distributed parallel processing", "user": {"login": "JoshKoh", "id": 32561239, "node_id": "MDQ6VXNlcjMyNTYxMjM5", "avatar_url": "https://avatars.githubusercontent.com/u/32561239?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JoshKoh", "html_url": "https://github.com/JoshKoh", "followers_url": "https://api.github.com/users/JoshKoh/followers", "following_url": "https://api.github.com/users/JoshKoh/following{/other_user}", "gists_url": "https://api.github.com/users/JoshKoh/gists{/gist_id}", "starred_url": "https://api.github.com/users/JoshKoh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JoshKoh/subscriptions", "organizations_url": "https://api.github.com/users/JoshKoh/orgs", "repos_url": "https://api.github.com/users/JoshKoh/repos", "events_url": "https://api.github.com/users/JoshKoh/events{/privacy}", "received_events_url": "https://api.github.com/users/JoshKoh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-07-23T06:34:13Z", "updated_at": "2020-07-27T21:32:10Z", "closed_at": "2020-07-27T21:32:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\nRunning distributed parallel processing with postgresql.\r\nStarted 20 instances. \r\nThen noticed multiple trials having same parameters:\r\nTrial **13443 finished with value: 0.7391443119806878** and parameters: {'model_index': 7, 'band1_index': 25, 'band2_index': 17, 'band3_index': 16}. Best is trial 551 with value: 0.7406389004521836.\r\nTrial **13444 finished with value: 0.7391443119806878** and parameters: {'model_index': 7, 'band1_index': 25, 'band2_index': 17, 'band3_index': 16}. Best is trial 810 with value: 0.7406389004521836.\r\nTrial **13445 finished with value: 0.7391443119806878** and parameters: {'model_index': 7, 'band1_index': 25, 'band2_index': 17, 'band3_index': 16}. Best is trial 551 with value: 0.7406389004521836.\r\nTrial **13446 finished with value: 0.7391443119806878** and parameters: {'model_index': 7, 'band1_index': 25, 'band2_index': 17, 'band3_index': 16}. Best is trial 551 with value: 0.7406389004521836.\r\nTrial **13447 finished with value: 0.7391443119806878** and parameters: {'model_index': 7, 'band1_index': 25, 'band2_index': 17, 'band3_index': 16}. Best is trial 551 with value: 0.7406389004521836.\r\n\r\nSometimes up to 8 trials in a row will have same parameters and scores. It pretty consistent throughout the run.\r\n\r\n## Expected behavior\r\nEach trial to test different hyperparameter combination?\r\n\r\n## Environment\r\n\r\n- Optuna version: 1.5\r\n- Python version: 3.7\r\n- OS: Win10 Pro 64-bit\r\n- (Optional) Other libraries and their versions:\r\n\r\n## Error messages, stack traces, or logs\r\nNone\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1547/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1547/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1535", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1535/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1535/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1535/events", "html_url": "https://github.com/optuna/optuna/issues/1535", "id": 662298878, "node_id": "MDU6SXNzdWU2NjIyOTg4Nzg=", "number": 1535, "title": "Missing trial parameters with AllenNLP training", "user": {"login": "mateuszpieniak", "id": 31375424, "node_id": "MDQ6VXNlcjMxMzc1NDI0", "avatar_url": "https://avatars.githubusercontent.com/u/31375424?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mateuszpieniak", "html_url": "https://github.com/mateuszpieniak", "followers_url": "https://api.github.com/users/mateuszpieniak/followers", "following_url": "https://api.github.com/users/mateuszpieniak/following{/other_user}", "gists_url": "https://api.github.com/users/mateuszpieniak/gists{/gist_id}", "starred_url": "https://api.github.com/users/mateuszpieniak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mateuszpieniak/subscriptions", "organizations_url": "https://api.github.com/users/mateuszpieniak/orgs", "repos_url": "https://api.github.com/users/mateuszpieniak/repos", "events_url": "https://api.github.com/users/mateuszpieniak/events{/privacy}", "received_events_url": "https://api.github.com/users/mateuszpieniak/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-07-20T21:48:48Z", "updated_at": "2020-08-04T10:20:42Z", "closed_at": "2020-08-04T10:20:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\nI encountered a weird outcome whilst optimizing my AllenNLP model, which might be tough to reproduce. I miss some rows in `trial_params`. Surprisingly the table `trials` contains results for the missing parameters which suggests that the runs were successful.\r\n\r\n### Table `trials`\r\n![Values](https://user-images.githubusercontent.com/31375424/87988567-d8fa7880-cae0-11ea-8738-43c703a5d12b.png)\r\n\r\n### Table `trial_params`\r\n\r\n![Params](https://user-images.githubusercontent.com/31375424/87988620-f0396600-cae0-11ea-859c-dcfb3ba8edf7.png)\r\nMissing `trial_id` == 2, `trial_id` == 3, `trial_id` == 4. All other rows up to `trial_id` == 40 are fine.\r\n\r\n## Expected behavior\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\nA table `trial_params` is filled correctly.\r\n\r\n## Environment\r\n\r\n- Optuna version: 1.5.0 (https://github.com/mateuszpieniak/optuna)\r\nI removed only `allennlp.common.params.infer_and_cast` in `AllenNLPExecutor`. It doesn't work with `null` values in jsonnet. In addition, I believe that such casting is not needed anyway since jsonnet was designed in such way that a user is responsible for types casting e.g. `parseInt`, `parseJson` (https://jsonnet.org/ref/stdlib.html)\r\n- Python version: 3.6.9\r\n- OS: Ubuntu 18.04.4 LTS\r\n- AllenNLP 1.0.0 \r\nI know it wasn't supported officially in Optuna 1.5.0 & experimental, but it should work anyway as there is no modification in subsequent versions of Optuna\r\n\r\n## Steps to reproduce\r\nI have 4 GPUs, thus I have 4 runs and I want them all to share my SQLite database.\r\n1. Open 4 terminal tabs.\r\n2. In each tab type `export CUDA_DEVICE=0`, `export CUDA_DEVICE=1`, and so on (https://optuna.readthedocs.io/en/stable/faq.html#how-can-i-use-two-gpus-for-evaluating-two-trials-simultaneously).\r\n3. In each tab type `python optuna_code.py`\r\n\r\n## Reproducible examples (optional)\r\n\r\n### optuna_code.py\r\n```\r\nfrom optuna import Trial, create_study\r\nfrom optuna.integration.allennlp import AllenNLPExecutor\r\n\r\n\r\ndef objective(trial: Trial) -> float:\r\n    # Requires to define CUDA_DEVICE & DEBUG env variable externally to support multi GPU\r\n    trial.suggest_categorical(\"POOLING\", [\"mean\", \"cls\"])\r\n    trial.suggest_float(\"DROPOUT\", 0.0, 0.8)\r\n    trial.suggest_float(\"ALPHA\", 0.0, 1.0)\r\n    trial.suggest_float(\"GAMMA\", 0.0, 5.0)\r\n    trial.suggest_float(\"LEARNING_RATE\", 2e-7, 2e-5, log=True)\r\n    trial.suggest_float(\"WEIGHT_DECAY\", 1e-5, 1e5, log=True)\r\n\r\n    executor = AllenNLPExecutor(\r\n        trial=trial,\r\n        config_file=\"./configs/config_name.jsonnet\",\r\n        serialization_dir=f\"/experiments/optuna/{trial.number}\",\r\n        metrics=\"best_validation_roc_auc\",\r\n        include_package=[\"my_package\"],\r\n    )\r\n\r\n    return executor.run()\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    study = create_study(\r\n        study_name=\"study_name\"\r\n        storage=\"sqlite:///results.db\",\r\n        direction=\"maximize\",\r\n        load_if_exists=True,\r\n    )\r\n\r\n    study.optimize(func=objective, n_jobs=1, n_trials=5, show_progress_bar=True)\r\n\r\n```\r\n\r\n## Additional context (optional)\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n1) I believe that such bug is hard debug since the next time I run the code it can be fine. It looks like some race condition to me.\r\n2) Missing rows causes hyperparameters importance to fail:\r\n\r\n![Importance](https://user-images.githubusercontent.com/31375424/87990059-89697c00-cae3-11ea-97ed-bedbf549ff4d.png)\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1535/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1535/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1531", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1531/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1531/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1531/events", "html_url": "https://github.com/optuna/optuna/issues/1531", "id": 660060266, "node_id": "MDU6SXNzdWU2NjAwNjAyNjY=", "number": 1531, "title": "Distributed Parallel error: Trial has already finished and can not be updated.", "user": {"login": "ghost", "id": 10137, "node_id": "MDQ6VXNlcjEwMTM3", "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ghost", "html_url": "https://github.com/ghost", "followers_url": "https://api.github.com/users/ghost/followers", "following_url": "https://api.github.com/users/ghost/following{/other_user}", "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}", "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ghost/subscriptions", "organizations_url": "https://api.github.com/users/ghost/orgs", "repos_url": "https://api.github.com/users/ghost/repos", "events_url": "https://api.github.com/users/ghost/events{/privacy}", "received_events_url": "https://api.github.com/users/ghost/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-07-18T10:21:26Z", "updated_at": "2020-07-18T13:21:36Z", "closed_at": "2020-07-18T13:21:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am trying the distributed processing with Postgresql.\r\nAs per instructions, I have created a study 'optuna_exp' with storage in postgresql database 'Optuna'.\r\nI then execute optimisation script in terminal with the code:\r\nif __name__ == '__main__':\r\n    study = optuna.load_study(study_name='optuna_exp', storage='postgresql+psycopg2://postgres:password@localhost:5432/Optuna')\r\nstudy.optimize(objective, n_trials=5000)\r\n\r\nI am launching 12 terminals and executing the optimization script (32 cores).\r\n\r\nThe study starts fine on each of the instances but after a while, some instance starts to fail and terminate:\r\n\r\nRuntimeError: Trial#5329 has already finished and can not be updated.\r\nRuntimeError: Trial#10154 has already finished and can not be updated.\r\n\r\nThis repeats randomly with sometimes more than half of the instances terminated due to the RuntimeError. \r\n\r\n## Expected behavior\r\nAll instances to complete without error.\r\n\r\n## Environment\r\n- Optuna version: 1.5\r\n- Python version: 3.7\r\n- OS: Windows Pro 64-bit\r\n- (Optional) Other libraries and their versions: IDE PyCharm 2020.1.3 Pro.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1531/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1531/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1514", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1514/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1514/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1514/events", "html_url": "https://github.com/optuna/optuna/pull/1514", "id": 656278954, "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ4NjA3MTg0", "number": 1514, "title": "Fix frequent deadlock caused by conditional locks.", "user": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/26", "html_url": "https://github.com/optuna/optuna/milestone/26", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/26/labels", "id": 5614432, "node_id": "MDk6TWlsZXN0b25lNTYxNDQzMg==", "number": 26, "title": "v2.0.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 40, "state": "closed", "created_at": "2020-07-03T07:18:29Z", "updated_at": "2020-07-29T00:43:42Z", "due_on": null, "closed_at": "2020-07-29T00:43:42Z"}, "comments": 5, "created_at": "2020-07-14T02:39:22Z", "updated_at": "2020-07-14T08:21:42Z", "closed_at": "2020-07-14T08:18:24Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1514", "html_url": "https://github.com/optuna/optuna/pull/1514", "diff_url": "https://github.com/optuna/optuna/pull/1514.diff", "patch_url": "https://github.com/optuna/optuna/pull/1514.patch", "merged_at": "2020-07-14T08:18:24Z"}, "body": "## Motivation\r\n\r\nAlternative to https://github.com/optuna/optuna/pull/1509. See also https://github.com/optuna/optuna/pull/1509#issuecomment-657913671.\r\n\r\nThis fix does not contain any retries but as far as I could verify locally, deadlocks no longer occur. \r\n\r\n## Description of the changes\r\n\r\nOnly uses a single lock, over all trial-related tables.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1514/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1514/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1509", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1509/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1509/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1509/events", "html_url": "https://github.com/optuna/optuna/pull/1509", "id": 655563852, "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ4MDIwODU1", "number": 1509, "title": "Retry after insertion into RDB-storage.", "user": {"login": "ytsmiling", "id": 20983513, "node_id": "MDQ6VXNlcjIwOTgzNTEz", "avatar_url": "https://avatars.githubusercontent.com/u/20983513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ytsmiling", "html_url": "https://github.com/ytsmiling", "followers_url": "https://api.github.com/users/ytsmiling/followers", "following_url": "https://api.github.com/users/ytsmiling/following{/other_user}", "gists_url": "https://api.github.com/users/ytsmiling/gists{/gist_id}", "starred_url": "https://api.github.com/users/ytsmiling/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ytsmiling/subscriptions", "organizations_url": "https://api.github.com/users/ytsmiling/orgs", "repos_url": "https://api.github.com/users/ytsmiling/repos", "events_url": "https://api.github.com/users/ytsmiling/events{/privacy}", "received_events_url": "https://api.github.com/users/ytsmiling/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-07-13T04:00:43Z", "updated_at": "2020-07-14T03:26:25Z", "closed_at": "2020-07-14T03:26:24Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1509", "html_url": "https://github.com/optuna/optuna/pull/1509", "diff_url": "https://github.com/optuna/optuna/pull/1509.diff", "patch_url": "https://github.com/optuna/optuna/pull/1509.patch", "merged_at": null}, "body": "This PR is a follow-up of #1498 and #1499.\r\n\r\n## Motivation\r\nSee #1498 and #1499.\r\n\r\n## Description of the changes\r\n- Add retry loop so that we can re-issue operations on dead-lock.\r\n- Split data insertion into different sessions.\r\n\r\nAdditionally, this PR fixes the following two bugs.\r\n- Intermediate values are not correctly overwritten.\r\n- Params are not correctly overwritten. See #1327 for the change of storage specification.\r\n\r\n## Additional notes\r\nWe may replace `add_all` statements by bulk-insert to improve performance within this or in another PR.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1509/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1509/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1508", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1508/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1508/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1508/events", "html_url": "https://github.com/optuna/optuna/issues/1508", "id": 655447145, "node_id": "MDU6SXNzdWU2NTU0NDcxNDU=", "number": 1508, "title": "Trial's intermediate_values are overwritten by other new trial when running multiple experiments in parallel", "user": {"login": "dktemp888", "id": 61772475, "node_id": "MDQ6VXNlcjYxNzcyNDc1", "avatar_url": "https://avatars.githubusercontent.com/u/61772475?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dktemp888", "html_url": "https://github.com/dktemp888", "followers_url": "https://api.github.com/users/dktemp888/followers", "following_url": "https://api.github.com/users/dktemp888/following{/other_user}", "gists_url": "https://api.github.com/users/dktemp888/gists{/gist_id}", "starred_url": "https://api.github.com/users/dktemp888/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dktemp888/subscriptions", "organizations_url": "https://api.github.com/users/dktemp888/orgs", "repos_url": "https://api.github.com/users/dktemp888/repos", "events_url": "https://api.github.com/users/dktemp888/events{/privacy}", "received_events_url": "https://api.github.com/users/dktemp888/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2020-07-12T17:59:27Z", "updated_at": "2020-07-15T07:15:00Z", "closed_at": "2020-07-15T06:35:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\nTrial's intermediate_values are overwritten by other new trial when running multiple experiments in parallel\r\n## Expected behavior\r\nEach trial has its own intermediate_values that can be used for pruner correctly when running Optuna in parallel. This is important because otherwise the pruner logic will be wrong because of incorrect intermediate_values.\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\n## Environment\r\nUbuntu 1604\r\n\r\n- Optuna version: 1.14, 1.15\r\n- Python version: 3.6, 3.7\r\n- OS: Ubuntu 1604\r\n- (Optional) Other libraries and their versions:\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n# error messages, stack traces, or logs\r\n```\r\n\r\n## Steps to reproduce\r\nAssume you have a training code with Optuna as hyper-parameter optimizer\r\n1. run the first instance of train code with optuna;\r\n2. run the second instance of train code with optuna;\r\n3. observe the trial.intermediate_values dict, the first instance's intermediate_values are overwritten by the second. However if you check the database file all intermediate values and steps are correctly logged in the database. Only the runtime value is wrong.\r\n\r\nIt happens on both sqlite and mysql.\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\n# python code\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1508/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1508/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1506", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1506/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1506/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1506/events", "html_url": "https://github.com/optuna/optuna/pull/1506", "id": 654572998, "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ3Mjc1NTE5", "number": 1506, "title": "Fix `_CachedStorage` and `RDBStorage` distribution compatibility check race condition.", "user": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/26", "html_url": "https://github.com/optuna/optuna/milestone/26", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/26/labels", "id": 5614432, "node_id": "MDk6TWlsZXN0b25lNTYxNDQzMg==", "number": 26, "title": "v2.0.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 40, "state": "closed", "created_at": "2020-07-03T07:18:29Z", "updated_at": "2020-07-29T00:43:42Z", "due_on": null, "closed_at": "2020-07-29T00:43:42Z"}, "comments": 1, "created_at": "2020-07-10T07:28:52Z", "updated_at": "2020-07-13T06:18:55Z", "closed_at": "2020-07-13T06:18:45Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1506", "html_url": "https://github.com/optuna/optuna/pull/1506", "diff_url": "https://github.com/optuna/optuna/pull/1506.diff", "patch_url": "https://github.com/optuna/optuna/pull/1506.patch", "merged_at": "2020-07-13T06:18:45Z"}, "body": "_Depends on https://github.com/optuna/optuna/pull/1490, using study table query with `FOR UPDATE`._\r\n_Should be merged after https://github.com/optuna/optuna/pull/1498, addressing another parameter issue where rows are not inserted._\r\n\r\n## Motivation\r\n\r\nTrial distribution compatibility check is prone to race condition. This is because table query --> check does not involve any locks across trials. For instance, two workers could enter the distribution check simultaneously and both pass the check since they both see an empty table. The first worker should acquire a lock, check and insert, to ensure that the compatibility check really takes place for the second trial.\r\n\r\n## Description of the changes\r\n\r\nLocks across trials by locking a row in the study table.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1506/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1506/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1500", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1500/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1500/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1500/events", "html_url": "https://github.com/optuna/optuna/issues/1500", "id": 653917157, "node_id": "MDU6SXNzdWU2NTM5MTcxNTc=", "number": 1500, "title": "lgb.LightGBMTunerCV: TrialState.FAIL because the returned value from the objective function cannot be casted to float", "user": {"login": "konradsemsch", "id": 15321842, "node_id": "MDQ6VXNlcjE1MzIxODQy", "avatar_url": "https://avatars.githubusercontent.com/u/15321842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/konradsemsch", "html_url": "https://github.com/konradsemsch", "followers_url": "https://api.github.com/users/konradsemsch/followers", "following_url": "https://api.github.com/users/konradsemsch/following{/other_user}", "gists_url": "https://api.github.com/users/konradsemsch/gists{/gist_id}", "starred_url": "https://api.github.com/users/konradsemsch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/konradsemsch/subscriptions", "organizations_url": "https://api.github.com/users/konradsemsch/orgs", "repos_url": "https://api.github.com/users/konradsemsch/repos", "events_url": "https://api.github.com/users/konradsemsch/events{/privacy}", "received_events_url": "https://api.github.com/users/konradsemsch/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2020-07-09T09:36:54Z", "updated_at": "2021-03-01T23:21:50Z", "closed_at": "2021-03-01T23:21:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "The lgb.LightGBMTuner seems to run for a number of trials and then breaks unexpectedly. The strange thing is that it runs without problems for a number of steps before the error occurs.\r\n\r\n## Expected behavior\r\n\r\nThis is my code piece:\r\n\r\n```python\r\nself._parameters_set_2 = {\r\n                \"objective\": \"regression\",\r\n                \"metric\": \"rmse\", \r\n                \"verbosity\": -1,\r\n                \"boosting_type\": \"gbdt\"\r\n}\r\n\r\ndata_train_lgb = lgb.Dataset(\r\n                self._pipeline_prepare.fit_transform(self._data[\"training\"][\"X\"]), \r\n                label = self._data[\"training\"][\"y\"]\r\n)\r\n\r\ntuner_lgb = lgb.LightGBMTunerCV(\r\n                    self._parameters_set_2, \r\n                    data_train_lgb,  \r\n                    verbose_eval = 1,\r\n                    num_boost_round = 100, \r\n                    early_stopping_rounds = 10, \r\n                    time_budget = 10,\r\n                    folds = self._data[\"validation_time_cv\"]\r\n                )\r\n```\r\n\r\n## Environment\r\n\r\n- Optuna version: 1.5.0  \r\n- Python version: 3.7\r\n- OS: MacOS 10.15.3 (19D76)\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n[I 2020-07-09 11:33:03,956] Finished trial#29 with value: 0.07808463369078895 with parameters: {'bagging_fraction': 0.9527650536197096, 'bagging_freq': 2}. Best is trial#29 with value: 0.07808463369078895.\r\nbagging, val_score: 0.078085:  30%|######################################1                                                                                        | 3/10 [00:01<00:02,  2.38it/s][1]     cv_agg's rmse: 0.0783785 + 0.039904\r\n[2]     cv_agg's rmse: 0.0783836 + 0.0398658\r\n[3]     cv_agg's rmse: 0.0783535 + 0.0397835\r\n[4]     cv_agg's rmse: 0.0783261 + 0.0398097\r\n[5]     cv_agg's rmse: 0.0783087 + 0.0398446\r\n[6]     cv_agg's rmse: 0.0782265 + 0.0396464\r\n[7]     cv_agg's rmse: 0.0783195 + 0.0393913\r\n[8]     cv_agg's rmse: 0.0783578 + 0.0392715\r\n[9]     cv_agg's rmse: 0.0783393 + 0.0391258\r\n[10]    cv_agg's rmse: 0.0784091 + 0.0390127\r\n[11]    cv_agg's rmse: 0.0785363 + 0.0389685\r\n[12]    cv_agg's rmse: 0.0785213 + 0.0386974\r\n[13]    cv_agg's rmse: 0.0784512 + 0.0386922\r\n[14]    cv_agg's rmse: 0.0784105 + 0.0385913\r\n[15]    cv_agg's rmse: 0.0784307 + 0.0385545\r\n[16]    cv_agg's rmse: 0.078539 + 0.0384206\r\nbagging, val_score: 0.078085:  40%|##################################################8                                                                            | 4/10 [00:01<00:02,  2.44it/s][I 2020-07-09 11:33:04,344] Finished trial#30 with value: 0.07822653355517642 with parameters: {'bagging_fraction': 0.5620285231108505, 'bagging_freq': 2}. Best is trial#29 with value: 0.07808463369078895.\r\nbagging, val_score: 0.078085:  40%|##################################################8                                                                            | 4/10 [00:01<00:02,  2.44it/s][1]     cv_agg's rmse: 0.0783772 + 0.0399073\r\n[2]     cv_agg's rmse: 0.0783782 + 0.0398754\r\n[3]     cv_agg's rmse: 0.0781955 + 0.0395771\r\n[4]     cv_agg's rmse: 0.0782144 + 0.0395464\r\n[5]     cv_agg's rmse: 0.0782016 + 0.0395846\r\n[6]     cv_agg's rmse: 0.0781716 + 0.0395182\r\n[7]     cv_agg's rmse: 0.0782204 + 0.0394778\r\n[8]     cv_agg's rmse: 0.0782837 + 0.039339\r\n[9]     cv_agg's rmse: 0.0783296 + 0.0392405\r\n[10]    cv_agg's rmse: 0.0783967 + 0.0391217\r\n[11]    cv_agg's rmse: 0.0786546 + 0.0390099\r\n[12]    cv_agg's rmse: 0.078685 + 0.0387856\r\n[13]    cv_agg's rmse: 0.0786055 + 0.0387932\r\n[14]    cv_agg's rmse: 0.0785633 + 0.0386666\r\n[15]    cv_agg's rmse: 0.0784939 + 0.0384941\r\n[16]    cv_agg's rmse: 0.0785136 + 0.0383061\r\nbagging, val_score: 0.078085:  50%|###############################################################5                                                               | 5/10 [00:02<00:01,  2.52it/s][I 2020-07-09 11:33:04,711] Finished trial#31 with value: 0.0781716160037223 with parameters: {'bagging_fraction': 0.5886098133062734, 'bagging_freq': 4}. Best is trial#29 with value: 0.07808463369078895.\r\nbagging, val_score: 0.078085:  50%|###############################################################5                                                               | 5/10 [00:02<00:01,  2.52it/s][1]     cv_agg's rmse: 0.078378 + 0.0399054\r\n[2]     cv_agg's rmse: 0.0783789 + 0.0398714\r\n[3]     cv_agg's rmse: 0.0783394 + 0.0398052\r\n[4]     cv_agg's rmse: 0.0783081 + 0.0398094\r\n[5]     cv_agg's rmse: 0.0782946 + 0.0398459\r\n[6]     cv_agg's rmse: 0.0782345 + 0.0396868\r\n[7]     cv_agg's rmse: 0.0782768 + 0.0394813\r\n[8]     cv_agg's rmse: 0.0783277 + 0.0393536\r\n[9]     cv_agg's rmse: 0.0783678 + 0.0392847\r\n[10]    cv_agg's rmse: 0.0784627 + 0.0391973\r\n[11]    cv_agg's rmse: 0.0785918 + 0.0391482\r\n[12]    cv_agg's rmse: 0.0785799 + 0.0388465\r\n[13]    cv_agg's rmse: 0.0785052 + 0.0388237\r\n[14]    cv_agg's rmse: 0.0785005 + 0.0387125\r\n[15]    cv_agg's rmse: 0.078562 + 0.0386594\r\n[16]    cv_agg's rmse: 0.0786887 + 0.0385622\r\nbagging, val_score: 0.078085:  60%|############################################################################2                                                  | 6/10 [00:02<00:01,  2.56it/s][I 2020-07-09 11:33:05,084] Finished trial#32 with value: 0.07823448856454775 with parameters: {'bagging_fraction': 0.5748529547945029, 'bagging_freq': 2}. Best is trial#29 with value: 0.07808463369078895.\r\nbagging, val_score: 0.078085:  60%|############################################################################2                                                  | 6/10 [00:02<00:01,  2.42it/s]\r\n  0%|                                                                                                                                                                      | 0/6 [00:00<?, ?it/s]\r\n  0%|                                                                                                                                                                     | 0/20 [00:00<?, ?it/s]\r\n  0%|                                                                                                                                                                      | 0/5 [00:00<?, ?it/s]\r\nBest score: 0.07808463369078895\r\nBest params: {'objective': 'regression', 'metric': 'rmse', 'verbosity': -1, 'boosting_type': 'gbdt', 'lambda_l1': 0.0, 'lambda_l2': 0.0, 'num_leaves': 101, 'feature_fraction': 0.5, 'bagging_fraction': 0.9527650536197096, 'bagging_freq': 2, 'min_child_samples': 20}\r\n  Params: \r\n    objective: regression\r\n    metric: rmse\r\n    verbosity: -1\r\n    boosting_type: gbdt\r\n    lambda_l1: 0.0\r\n    lambda_l2: 0.0\r\n    num_leaves: 101\r\n    feature_fraction: 0.5\r\n    bagging_fraction: 0.9527650536197096\r\n    bagging_freq: 2\r\n    min_child_samples: 20\r\n[W 2020-07-09 11:33:05,134] Setting status of trial#9 as TrialState.FAIL because the returned value from the objective function cannot be casted to float. Returned value is: {'objective': 'regression', 'metric': 'rmse', 'verbosity': -1, 'boosting_type': 'gbdt', 'lambda_l1': 0.0, 'lambda_l2': 0.0, 'num_leaves': 101, 'feature_fraction': 0.5, 'bagging_fraction': 0.9527650536197096, 'bagging_freq': 2, 'min_child_samples': 20}\r\nTraceback (most recent call last):\r\n    print(f\"Second stage | best parameters are: {self._study_stage_2.best_params}\")\r\n  File \"/Users/konradsemsch/.local/share/virtualenvs/Package-21BxfxdE/lib/python3.7/site-packages/optuna/study.py\", line 72, in best_params\r\n    return self.best_trial.params\r\n  File \"/Users/konradsemsch/.local/share/virtualenvs/Package-21BxfxdE/lib/python3.7/site-packages/optuna/study.py\", line 97, in best_trial\r\n    return copy.deepcopy(self._storage.get_best_trial(self._study_id))\r\n  File \"/Users/konradsemsch/.local/share/virtualenvs/Package-21BxfxdE/lib/python3.7/site-packages/optuna/storages/in_memory.py\", line 293, in get_best_trial\r\n    raise ValueError(\"No trials are completed yet.\")\r\nValueError: No trials are completed yet.\r\n```\r\n\r\n## Steps to reproduce\r\n\r\nNot sure if it can be fully reproduced as I can't share the data that I'm using for this. Into which direction is this error pointing so that I could further validate?\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1500/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1500/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1499", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1499/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1499/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1499/events", "html_url": "https://github.com/optuna/optuna/issues/1499", "id": 653853191, "node_id": "MDU6SXNzdWU2NTM4NTMxOTE=", "number": 1499, "title": "Deadlock can occur when using MySQL backend.", "user": {"login": "ytsmiling", "id": 20983513, "node_id": "MDQ6VXNlcjIwOTgzNTEz", "avatar_url": "https://avatars.githubusercontent.com/u/20983513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ytsmiling", "html_url": "https://github.com/ytsmiling", "followers_url": "https://api.github.com/users/ytsmiling/followers", "following_url": "https://api.github.com/users/ytsmiling/following{/other_user}", "gists_url": "https://api.github.com/users/ytsmiling/gists{/gist_id}", "starred_url": "https://api.github.com/users/ytsmiling/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ytsmiling/subscriptions", "organizations_url": "https://api.github.com/users/ytsmiling/orgs", "repos_url": "https://api.github.com/users/ytsmiling/repos", "events_url": "https://api.github.com/users/ytsmiling/events{/privacy}", "received_events_url": "https://api.github.com/users/ytsmiling/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-07-09T08:03:17Z", "updated_at": "2020-07-15T03:45:46Z", "closed_at": "2020-07-15T03:45:45Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "## Expected behavior\r\n\r\nOptuna handles MySQL errors.\r\n\r\n## Environment\r\n\r\n- Optuna version: 1.5.0\r\n- Python version: 3.7\r\n- OS: mac OS Catalina\r\n- (Optional) Other libraries and their versions: MySQL + pymysql\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nsqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)\r\n(pymysql.err.OperationalError) (1213, 'Deadlock found when trying to get lock; try restarting transaction')\r\n[SQL: INSERT INTO trial_user_attributes (trial_id, `key`, value_json) VALUES (%(trial_id)s, %(key)s, %(value_json)s)]\r\n[parameters: {'trial_id': 2998, 'key': 'nodename', 'value_json': '\"anoanymized\"'}]\r\n(Background on this error at: http://sqlalche.me/e/13/e3q8) (Background on this error at: http://sqlalche.me/e/13/7s2a)\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Parallel optimization with MySQL backend.\r\n\r\n## Reproducible examples (optional)\r\n\r\n<details><summary>Code</summary>\r\n<p>\r\n\r\n```python\r\nimport os\r\nimport optuna\r\nfrom multiprocessing import Pool\r\n\r\n\r\ndef f(x):\r\n    return (x - 3) ** 2\r\n\r\n\r\n# Objective function\r\ndef optuna_objective(trial):\r\n    x = trial.suggest_uniform(\"x\", -10, 10)\r\n    y = f(x)\r\n\r\n    nodename = os.uname().nodename\r\n    trial.set_user_attr(\"nodename\", nodename)\r\n\r\n    print(\"x=%8.3f, y=%8.3f\" % (x, y))\r\n\r\n    return y\r\n\r\n\r\n# Entry point\r\ndef main(args):\r\n    rank, = args\r\n    # Create a study\r\n    ECHO=False\r\n    storage = optuna.storages.RDBStorage(os.environ[\"OPTUNA_SQL\"], engine_kwargs=dict(echo=ECHO))\r\n    study = optuna.create_study(\r\n        study_name=\"test_optuna_collision_01\",\r\n        storage=storage,\r\n        load_if_exists=True,\r\n        direction=\"minimize\"\r\n    )\r\n\r\n    # Run optimization\r\n    study.optimize(optuna_objective, n_trials=20)\r\n\r\n    import time\r\n    time.sleep(10)\r\n\r\n    # Visualize the result\r\n    if rank == 0:\r\n        print(\"  #  %8s  %8s  %8s  %28s\" % (\"x\", \"y\", \"NODENAME\", \"STARTED\"))\r\n    for trial in study.trials:\r\n        try:\r\n            x = \"%8.3f\" % trial.params[\"x\"]\r\n            y = \"%8.3f\" % (trial.value or -1)\r\n            if trial.value is None:\r\n                print(\"NO_VALUE: \", trial.number)\r\n            nodename = trial.user_attrs[\"nodename\"]\r\n            started = trial.datetime_start\r\n        except (KeyError, AttributeError):\r\n            x = \"\"\r\n            y = \"\"\r\n            nodename = \"\"\r\n            started = \"\"\r\n        if rank == 0:\r\n            print(\"%3d: %s  %s  %8s  %28s\" % (trial.number, x, y, nodename, started))\r\n\r\n\r\nif __name__ == '__main__':\r\n    with Pool(10) as pool:\r\n        pool.map(main, [(i,) for i in range(10)])\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n## Additional context (optional)\r\n\r\nSee #1496 \r\n\r\nI'll create a follow-up PR after #1490 and #1498 are merged.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1499/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1499/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1498", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1498/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1498/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1498/events", "html_url": "https://github.com/optuna/optuna/pull/1498", "id": 653785496, "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ2NjM1MTk5", "number": 1498, "title": "Fix `CachedStorage` skipping trial param row insertion on cache miss.", "user": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/26", "html_url": "https://github.com/optuna/optuna/milestone/26", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/26/labels", "id": 5614432, "node_id": "MDk6TWlsZXN0b25lNTYxNDQzMg==", "number": 26, "title": "v2.0.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 40, "state": "closed", "created_at": "2020-07-03T07:18:29Z", "updated_at": "2020-07-29T00:43:42Z", "due_on": null, "closed_at": "2020-07-29T00:43:42Z"}, "comments": 3, "created_at": "2020-07-09T05:54:14Z", "updated_at": "2020-07-16T02:54:55Z", "closed_at": "2020-07-13T01:34:55Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1498", "html_url": "https://github.com/optuna/optuna/pull/1498", "diff_url": "https://github.com/optuna/optuna/pull/1498.diff", "patch_url": "https://github.com/optuna/optuna/pull/1498.patch", "merged_at": "2020-07-13T01:34:55Z"}, "body": "## Motivation\r\n\r\nFixes https://github.com/optuna/optuna/issues/1488#issuecomment-655428975.\r\n\r\n## Description of the changes\r\n\r\nMakes sure parameters are flushed/committed even for the first trial that is a \"cache miss\". \r\n\r\n## Note\r\n\r\nThis is only an issue for the first trial in a distributed environment/continuing optimization on an already started/finished study.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1498/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1498/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1490", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1490/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1490/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1490/events", "html_url": "https://github.com/optuna/optuna/pull/1490", "id": 652142263, "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ1MjY4MTUx", "number": 1490, "title": "Fix race condition for trial number computation.", "user": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/26", "html_url": "https://github.com/optuna/optuna/milestone/26", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/26/labels", "id": 5614432, "node_id": "MDk6TWlsZXN0b25lNTYxNDQzMg==", "number": 26, "title": "v2.0.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 40, "state": "closed", "created_at": "2020-07-03T07:18:29Z", "updated_at": "2020-07-29T00:43:42Z", "due_on": null, "closed_at": "2020-07-29T00:43:42Z"}, "comments": 7, "created_at": "2020-07-07T09:01:57Z", "updated_at": "2020-07-13T01:33:21Z", "closed_at": "2020-07-13T01:33:16Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1490", "html_url": "https://github.com/optuna/optuna/pull/1490", "diff_url": "https://github.com/optuna/optuna/pull/1490.diff", "patch_url": "https://github.com/optuna/optuna/pull/1490.patch", "merged_at": "2020-07-13T01:33:16Z"}, "body": "## Motivation\r\n\r\nFixes https://github.com/optuna/optuna/issues/1488.\r\n\r\n## Description of the changes\r\n\r\nAllows `count_past_trials` to circumvent repeatable read isolation level. See the comments in the code for details.\r\n\r\n## Note\r\n\r\nVerified the changes with MySQL, by inspection, by checking for unique trial numbers after running a distributed optimization. The bug is otherwise reproducible, simply running a lot of trials with.\r\n\r\n```sql\r\nSELECT COUNT(DISTINCT(number)) FROM trials;\r\n```\r\n\r\n```python\r\nimport optuna\r\nfrom optuna.samplers import TPESampler\r\n\r\ndef objective(trial, n_params):\r\n    return sum(trial.suggest_float(f\"x{i}\", 0.0, 1.0) for i in range(n_params))\r\n\r\nif __name__ == \"__main__\":\r\n    n_params = 10\r\n    n_trials = 200\r\n\r\n    database = \"duplicatenumber1488\"\r\n    storage = \"mysql://root@localhost/duplicatenumber1488\"\r\n    study = optuna.create_study(sampler=TPESampler(), study_name=database, storage=storage, load_if_exists=True)\r\n\r\n    study.optimize(lambda trial: objective(trial, n_params), n_trials=n_trials)\r\n```\r\n\r\n**About isolation levels in sqlalchemy for different dialect** \r\nhttps://docs.sqlalchemy.org/en/13/core/connections.html#sqlalchemy.engine.Connection.execution_options.params.isolation_level.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1490/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1490/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1488", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1488/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1488/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1488/events", "html_url": "https://github.com/optuna/optuna/issues/1488", "id": 651639482, "node_id": "MDU6SXNzdWU2NTE2Mzk0ODI=", "number": 1488, "title": "Duplicate trial numbers on distributed optimization", "user": {"login": "nandnor93", "id": 67882711, "node_id": "MDQ6VXNlcjY3ODgyNzEx", "avatar_url": "https://avatars.githubusercontent.com/u/67882711?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nandnor93", "html_url": "https://github.com/nandnor93", "followers_url": "https://api.github.com/users/nandnor93/followers", "following_url": "https://api.github.com/users/nandnor93/following{/other_user}", "gists_url": "https://api.github.com/users/nandnor93/gists{/gist_id}", "starred_url": "https://api.github.com/users/nandnor93/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nandnor93/subscriptions", "organizations_url": "https://api.github.com/users/nandnor93/orgs", "repos_url": "https://api.github.com/users/nandnor93/repos", "events_url": "https://api.github.com/users/nandnor93/events{/privacy}", "received_events_url": "https://api.github.com/users/nandnor93/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 11, "created_at": "2020-07-06T15:43:05Z", "updated_at": "2020-07-13T01:33:16Z", "closed_at": "2020-07-13T01:33:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "When I run multiple Optuna processes on cloud servers that have job scheduler, Optuna occasionally assigns duplicate trial numbers (`trial.number`) to multiple trials that started at almost the same time.\r\n\r\n## Expected behavior\r\n\r\nEach trial obtains a different number; as a result, the trial numbers among a study become sequential.\r\n\r\n## Environment\r\n\r\n- Optuna version: 1.5.0\r\n- Python version: 3.8.3\r\n- OS: A CentOS 7.7 container running on Singularity on a SUSE Linux Enterprise Server 12 SP4 host\r\n- Other software versions: PostgreSQL 9.5.21, psycopg 2.8.5\r\n\r\n## Error messages, stack traces, or logs\r\n\r\nA simplified copy of the below-mentioned test program's output looks like:\r\n\r\n```\r\n[I 2020-07-07 00:07:24,134] Using an existing study with name 'test_optuna_collision_01' instead of creating a new one.\r\n\r\n......\r\n\r\n\r\n  #         x         y  NODENAME                       STARTED\r\n  0:   -7.260   105.276    r6i5n2    2020-07-06 23:42:14.603784\r\n  1:    8.803    33.677    r6i5n2    2020-07-06 23:42:14.776819\r\n  2:   -1.653    21.654    r6i5n2    2020-07-06 23:42:14.887652\r\n  3:    0.024     8.856    r6i5n2    2020-07-06 23:42:14.993142\r\n  4:    6.834    14.701    r6i5n2    2020-07-06 23:42:15.106251\r\n  5:   -4.047    49.663    r6i5n2    2020-07-06 23:42:15.215284\r\n  6:    7.026    16.205    r6i5n2    2020-07-06 23:42:15.325813\r\n  7:   -1.137    17.117    r6i5n2    2020-07-06 23:42:15.432296\r\n  8:    0.887     4.466    r6i5n2    2020-07-06 23:42:15.539958\r\n  9:   -9.392   153.554    r6i5n2    2020-07-06 23:42:15.692091\r\n 10:    2.665     0.112    r6i5n2    2020-07-06 23:42:15.836753\r\n 11:    3.273     0.074    r6i5n2    2020-07-06 23:42:15.986390\r\n 12:    3.699     0.489    r6i5n2    2020-07-06 23:42:16.100333\r\n 13:    3.481     0.232    r6i5n2    2020-07-06 23:42:16.216604\r\n 14:    3.461     0.213    r6i5n2    2020-07-06 23:42:16.331074\r\n 15:    5.481     6.154    r6i5n2    2020-07-06 23:42:16.445370\r\n 16:    1.499     2.253    r6i5n2    2020-07-06 23:42:16.560353\r\n 17:   -3.628    43.933    r6i5n2    2020-07-06 23:42:16.674461\r\n 18:    8.431    29.496    r6i5n2    2020-07-06 23:42:16.788654\r\n 19:    5.046     4.185    r6i5n2    2020-07-06 23:42:16.948887\r\n 20:    2.154     0.716    r3i5n6    2020-07-06 23:42:50.112204\r\n 20:    2.096     0.817    r3i5n6    2020-07-06 23:42:50.112892\r\n 20:    2.785     0.046    r2i2n5    2020-07-06 23:42:50.112536\r\n 20:    2.213     0.620    r2i2n5    2020-07-06 23:42:50.113374\r\n 20:    2.237     0.582    r3i5n6    2020-07-06 23:42:50.116946\r\n 25:    2.402     0.358    r3i5n6    2020-07-06 23:42:50.150646\r\n 25:    1.886     1.240    r3i5n6    2020-07-06 23:42:50.151986\r\n 26:    2.022     0.957    r2i2n5    2020-07-06 23:42:50.157673\r\n 28:    4.172     1.374    r2i2n5    2020-07-06 23:42:50.362914\r\n 28:    4.986     3.944    r2i2n5    2020-07-06 23:42:50.364238\r\n 28:    3.871     0.759    r3i5n6    2020-07-06 23:42:50.364441\r\n 28:    4.373     1.885    r3i5n6    2020-07-06 23:42:50.365054\r\n 28:    4.017     1.035    r3i5n6    2020-07-06 23:42:50.365227\r\n 28:    4.861     3.462    r3i5n6    2020-07-06 23:42:50.366699\r\n 28:    4.673     2.799    r3i5n6    2020-07-06 23:42:50.367405\r\n 35:    4.054     1.110    r2i2n5    2020-07-06 23:42:50.373785\r\n 36:    6.775    14.250    r2i2n5    2020-07-06 23:42:50.561707\r\n 36:   -2.051    25.517    r2i2n5    2020-07-06 23:42:50.567540\r\n 37:    6.959    15.676    r3i5n6    2020-07-06 23:42:50.569821\r\n 38:    7.065    16.527    r3i5n6    2020-07-06 23:42:50.574569\r\n 38:   -1.866    23.675    r3i5n6    2020-07-06 23:42:50.575655\r\n 39:    7.005    16.040    r3i5n6    2020-07-06 23:42:50.576151\r\n 39:    6.789    14.358    r3i5n6    2020-07-06 23:42:50.580927\r\n 40:    7.048    16.385    r2i2n5    2020-07-06 23:42:50.581646\r\n 44:    0.104     8.389    r2i2n5    2020-07-06 23:42:50.773439\r\n 45:    2.705     0.087    r2i2n5    2020-07-06 23:42:50.782284\r\n 46:    0.418     6.667    r3i5n6    2020-07-06 23:42:50.798938\r\n 47:    2.871     0.017    r2i2n5    2020-07-06 23:42:50.823891\r\n 47:    9.736    45.379    r3i5n6    2020-07-06 23:42:50.825717\r\n 47:    3.280     0.079    r3i5n6    2020-07-06 23:42:50.826783\r\n 47:    3.098     0.010    r3i5n6    2020-07-06 23:42:50.828179\r\n 51:    3.010     0.000    r3i5n6    2020-07-06 23:42:50.836315\r\n 52:    5.367     5.601    r2i2n5    2020-07-06 23:42:50.949296\r\n 53:    5.591     6.714    r2i2n5    2020-07-06 23:42:50.958469\r\n 54:    5.738     7.497    r3i5n6    2020-07-06 23:42:50.969918\r\n 55:    9.213    38.595    r2i2n5    2020-07-06 23:42:51.028821\r\n 56:   -1.009    16.075    r3i5n6    2020-07-06 23:42:51.046327\r\n 56:   -0.770    14.213    r3i5n6    2020-07-06 23:42:51.047563\r\n 56:   -0.897    15.188    r3i5n6    2020-07-06 23:42:51.050477\r\n 56:    2.905     0.009    r3i5n6    2020-07-06 23:42:51.050697\r\n 60:   -0.883    15.076    r2i2n5    2020-07-06 23:42:51.138237\r\n 61:   -0.566    12.719    r2i2n5    2020-07-06 23:42:51.153265\r\n 62:    1.074     3.708    r3i5n6    2020-07-06 23:42:51.162551\r\n 63:   -0.529    12.457    r2i2n5    2020-07-06 23:42:51.204287\r\n......\r\n```\r\n\r\nIn this result, five `trial`'s got the number 20.\r\n\r\n## Steps to reproduce\r\n\r\n1. Run parallel exploration on multiple nodes using a remote PostgreSQL storage.\r\n2. When multiple `trial`'s are generated in very short time duration (e.g. < 10 ms), they may have the same `number`.\r\n\r\nI ran the following script on 32 nodes as a tiny test.\r\n\r\n```python:\r\nimport os\r\nimport optuna\r\n\r\n\r\ndef f(x):\r\n    return (x - 3) ** 2\r\n\r\n\r\n# Objective function\r\ndef optuna_objective(trial):\r\n    x = trial.suggest_uniform(\"x\", -10, 10)\r\n    y = f(x)\r\n\r\n    nodename = os.uname().nodename\r\n    trial.set_user_attr(\"nodename\", nodename)\r\n\r\n    print(\"x=%8.3f, y=%8.3f\" % (x, y))\r\n\r\n    return y\r\n\r\n\r\n# Entry point\r\ndef main():\r\n    # Create a study\r\n    study = optuna.create_study(\r\n        study_name=\"test_optuna_collision_01\",\r\n        storage=os.environ[\"OPTUNA_SQL\"],  # Set a remote PostgreSQL server\r\n        load_if_exists=True,\r\n        direction=\"minimize\"\r\n    )\r\n\r\n    # Run optimization\r\n    study.optimize(optuna_objective, n_trials=20)\r\n\r\n    # Visualize the result\r\n    print(\"  #  %8s  %8s  %8s  %28s\" % (\"x\", \"y\", \"NODENAME\", \"STARTED\"))\r\n    for trial in study.trials:\r\n        try:\r\n            x = \"%8.3f\" % trial.params[\"x\"]\r\n            y = \"%8.3f\" % trial.value\r\n            nodename = trial.user_attrs[\"nodename\"]\r\n            started = trial.datetime_start\r\n        except (KeyError, AttributeError):\r\n            x = \"\"\r\n            y = \"\"\r\n            nodename = \"\"\r\n            started = \"\"\r\n        print(\"%3d: %s  %s  %8s  %28s\" % (trial.number, x, y, nodename, started))\r\n\r\n\r\nif __name__ == '__main__':\r\n    main()\r\n```\r\n\r\n## Additional context (optional)\r\n\r\nI guess this is caused by a non-atomic operation of the RDB storage.\r\nHere, Optuna assigns `number` to a newly created `trial` by counting the existing `trial`'s on the storage.  \r\n\r\nhttps://github.com/optuna/optuna/blob/69ee3ae5477dc6526b5c62320e4ad0393674cfd5/optuna/storages/rdb/storage.py#L517", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1488/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1488/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1481", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1481/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1481/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1481/events", "html_url": "https://github.com/optuna/optuna/pull/1481", "id": 650752931, "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ0MTgyNTMw", "number": 1481, "title": " Temporary fix for problem with length limit of 5000 in MLflow", "user": {"login": "PhilipMay", "id": 229382, "node_id": "MDQ6VXNlcjIyOTM4Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/229382?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PhilipMay", "html_url": "https://github.com/PhilipMay", "followers_url": "https://api.github.com/users/PhilipMay/followers", "following_url": "https://api.github.com/users/PhilipMay/following{/other_user}", "gists_url": "https://api.github.com/users/PhilipMay/gists{/gist_id}", "starred_url": "https://api.github.com/users/PhilipMay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PhilipMay/subscriptions", "organizations_url": "https://api.github.com/users/PhilipMay/orgs", "repos_url": "https://api.github.com/users/PhilipMay/repos", "events_url": "https://api.github.com/users/PhilipMay/events{/privacy}", "received_events_url": "https://api.github.com/users/PhilipMay/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561256, "node_id": "MDU6TGFiZWwxOTQ3NTYxMjU2", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.integration", "name": "optuna.integration", "color": "1c659e", "default": false, "description": "Related to the `optuna.integration` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/26", "html_url": "https://github.com/optuna/optuna/milestone/26", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/26/labels", "id": 5614432, "node_id": "MDk6TWlsZXN0b25lNTYxNDQzMg==", "number": 26, "title": "v2.0.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 40, "state": "closed", "created_at": "2020-07-03T07:18:29Z", "updated_at": "2020-07-29T00:43:42Z", "due_on": null, "closed_at": "2020-07-29T00:43:42Z"}, "comments": 2, "created_at": "2020-07-03T20:17:09Z", "updated_at": "2020-07-06T23:50:25Z", "closed_at": "2020-07-06T23:50:21Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1481", "html_url": "https://github.com/optuna/optuna/pull/1481", "diff_url": "https://github.com/optuna/optuna/pull/1481.diff", "patch_url": "https://github.com/optuna/optuna/pull/1481.patch", "merged_at": "2020-07-06T23:50:21Z"}, "body": "PR for #1340", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1481/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1481/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1480", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1480/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1480/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1480/events", "html_url": "https://github.com/optuna/optuna/issues/1480", "id": 650741443, "node_id": "MDU6SXNzdWU2NTA3NDE0NDM=", "number": 1480, "title": "Study parallel jobs should use multiprocessing", "user": {"login": "PhilipMay", "id": 229382, "node_id": "MDQ6VXNlcjIyOTM4Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/229382?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PhilipMay", "html_url": "https://github.com/PhilipMay", "followers_url": "https://api.github.com/users/PhilipMay/followers", "following_url": "https://api.github.com/users/PhilipMay/following{/other_user}", "gists_url": "https://api.github.com/users/PhilipMay/gists{/gist_id}", "starred_url": "https://api.github.com/users/PhilipMay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PhilipMay/subscriptions", "organizations_url": "https://api.github.com/users/PhilipMay/orgs", "repos_url": "https://api.github.com/users/PhilipMay/repos", "events_url": "https://api.github.com/users/PhilipMay/events{/privacy}", "received_events_url": "https://api.github.com/users/PhilipMay/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2020-07-03T19:30:06Z", "updated_at": "2022-02-23T01:09:19Z", "closed_at": "2021-03-01T23:21:54Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "When you do parallel execution in `study.optimize` (when `n_jobs=-1` for example). You say `with Parallel(n_jobs=n_jobs, prefer=\"threads\") as parallel:`. See here:\r\n\r\nhttps://github.com/optuna/optuna/blob/61c6a0acb22338789a83a02bb147326159f41d1e/optuna/study.py#L317\r\n\r\nIMO this just opens (threading) which suffers from the Python Global Interpreter Lock. See here: https://joblib.readthedocs.io/en/latest/generated/joblib.Parallel.html\r\n\r\nThis would not lead to real parallel execution and is useless with CPU bound problems. I suggest to use this: `with Parallel(n_jobs=n_jobs, backend=\"multiprocessing\") as parallel:`\r\n\r\nIf you want to I can provide a PR.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1480/reactions", "total_count": 16, "+1": 8, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 5, "eyes": 3}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1480/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1467", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1467/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1467/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1467/events", "html_url": "https://github.com/optuna/optuna/pull/1467", "id": 649084413, "node_id": "MDExOlB1bGxSZXF1ZXN0NDQyNzg0NzI2", "number": 1467, "title": "Avoid exploding queries with large exclusion sets.", "user": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/26", "html_url": "https://github.com/optuna/optuna/milestone/26", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/26/labels", "id": 5614432, "node_id": "MDk6TWlsZXN0b25lNTYxNDQzMg==", "number": 26, "title": "v2.0.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 40, "state": "closed", "created_at": "2020-07-03T07:18:29Z", "updated_at": "2020-07-29T00:43:42Z", "due_on": null, "closed_at": "2020-07-29T00:43:42Z"}, "comments": 3, "created_at": "2020-07-01T15:43:57Z", "updated_at": "2020-07-07T00:53:53Z", "closed_at": "2020-07-07T00:53:41Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1467", "html_url": "https://github.com/optuna/optuna/pull/1467", "diff_url": "https://github.com/optuna/optuna/pull/1467.diff", "patch_url": "https://github.com/optuna/optuna/pull/1467.patch", "merged_at": "2020-07-07T00:53:40Z"}, "body": "## Motivation\r\n\r\nA temporary fix for https://github.com/optuna/optuna/issues/1457.\r\n\r\n## Description of the changes\r\n\r\nSwitches from an exclusion list to an inclusion list if error is caught.\r\n\r\n## TODO\r\n\r\n- [x] Verify fix https://github.com/optuna/optuna/issues/1457#issuecomment-653587345\r\n- [x] Simplify/Clean up the code.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1467/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1467/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1457", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1457/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1457/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1457/events", "html_url": "https://github.com/optuna/optuna/issues/1457", "id": 648329855, "node_id": "MDU6SXNzdWU2NDgzMjk4NTU=", "number": 1457, "title": "Error on GCP cluster using sqlite (sqlite3.OperationalError: too many SQL variables)", "user": {"login": "salvadord", "id": 8440562, "node_id": "MDQ6VXNlcjg0NDA1NjI=", "avatar_url": "https://avatars.githubusercontent.com/u/8440562?v=4", "gravatar_id": "", "url": "https://api.github.com/users/salvadord", "html_url": "https://github.com/salvadord", "followers_url": "https://api.github.com/users/salvadord/followers", "following_url": "https://api.github.com/users/salvadord/following{/other_user}", "gists_url": "https://api.github.com/users/salvadord/gists{/gist_id}", "starred_url": "https://api.github.com/users/salvadord/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/salvadord/subscriptions", "organizations_url": "https://api.github.com/users/salvadord/orgs", "repos_url": "https://api.github.com/users/salvadord/repos", "events_url": "https://api.github.com/users/salvadord/events{/privacy}", "received_events_url": "https://api.github.com/users/salvadord/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1646581847, "node_id": "MDU6TGFiZWwxNjQ2NTgxODQ3", "url": "https://api.github.com/repos/optuna/optuna/labels/question", "name": "question", "color": "e27802", "default": true, "description": "Question about Optuna."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 16, "created_at": "2020-06-30T16:46:37Z", "updated_at": "2020-09-29T23:56:02Z", "closed_at": "2020-09-29T23:56:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am running optuna to optimize large-scale detailed models of cortical circuits on Google Cloud supercomputers. I integrated optuna within our modeling tool NetPyNE:  https://github.com/Neurosim-lab/netpyne/blob/optuna/netpyne/batch/optuna_parallel.py \r\n\r\nI was running 50 parallel processes on the controller node of a Google Cloud Platform (GCP) Slurm-based cluster. Each process is an optuna instance (run via 'screen') where the objective function submits a Slurm job to run a cortical simulation on 96-core compute job. Optuna was set up so the 50 processes exchange info via an sqlite db file:\r\n\r\n```\r\n    study = optuna.create_study(study_name=self.batchLabel, storage='sqlite:///%s/%s_storage.db' % (self.saveFolder, self.batchLabel), load_if_exists=True, direction=args['direction'])\r\n    study.optimize(lambda trial: objective(trial, args), n_trials=args['maxiters'], timeout=args['maxtime'])\r\n```\r\n\r\nAt around trial 1000 I got the error `sqlite3.OperationalError: too many SQL variables` on all processes (see detailed error below). \r\n\r\nI know that the doc suggests using PostgreSQL or MySQL for large distributed optimization, particularly if using NFS drives (as do the compute nodes in the cluster). Unfortunately, I have no idea how to replace SQLite with PostgresSQL or MySQL. My question is, do you have any examples of how to set that up? Or have any other suggestions on how to fix this error?\r\n\r\nThanks!\r\n\r\nFull error: \r\n`[I 2020-06-30 00:53:40,502] Finished trial#996 with value: 409.0361137631617 with parameters: {'EEGain': 1.2190444451070857, 'EIGain': 1.810497756045793, \"('IELayerGain', '1-3')\": 1.087901880175065, \"('IELayerGain', '4')\": 1.7309720923711636, \"('IELayerGain', '5')\": 0.5960648412842655, \"('IELayerGain', '6')\": 0.7978043150339824, \"('IILayerGain', '1-3')\": 1.1688903007202631, \"('IILayerGain', '4')\": 0.672447638702098, \"('IILayerGain', '5')\": 0.8073360248421282, \"('IILayerGain', '6')\": 1.8855740649714237, 'thalamoCorticalGain': 1.08285373691784, 'intraThalamicGain': 1.7758770967297166, 'corticoThalamicGain': 1.6566204337609691}. Best is trial#375 with value: 294.2097451307643.\r\n[W 2020-06-30 00:53:40,703] Setting status of trial#1046 as TrialState.FAIL because of the following error: OperationalError('(sqlite3.OperationalError) too many SQL variables',)\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib64/python3.6/site-packages/sqlalchemy/engine/base.py\", line 1278, in _execute_context\r\n    cursor, statement, parameters, context\r\n  File \"/usr/local/lib64/python3.6/site-packages/sqlalchemy/engine/default.py\", line 593, in do_execute\r\n    cursor.execute(statement, parameters)\r\nsqlite3.OperationalError: too many SQL variables\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/ext_salvadordura_gmail_com/.local/lib/python3.6/site-packages/optuna/study.py\", line 734, in _run_trial\r\n    result = func(trial)\r\n  File \"/home/ext_salvadordura_gmail_com/netpyne/netpyne/batch/optuna_parallel.py\", line 387, in <lambda>\r\n    study.optimize(lambda trial: objective(trial, args), n_trials=args['maxiters'], timeout=args['maxtime'])\r\n  File \"/home/ext_salvadordura_gmail_com/netpyne/netpyne/batch/optuna_parallel.py\", line 130, in objective\r\n    candidate.append(trial.suggest_uniform(str(paramLabel), minVal, maxVal))\r\n  File \"/home/ext_salvadordura_gmail_com/.local/lib/python3.6/site-packages/optuna/trial/_trial.py\", line 221, in suggest_uniform\r\n    return self._suggest(name, distribution)\r\n  File \"/home/ext_salvadordura_gmail_com/.local/lib/python3.6/site-packages/optuna/trial/_trial.py\", line 650, in _suggest\r\n    param_value = self.study.sampler.sample_independent(study, trial, name, distribution)\r\n  File \"/home/ext_salvadordura_gmail_com/.local/lib/python3.6/site-packages/optuna/samplers/tpe/sampler.py\", line 174, in sample_independent\r\n    values, scores = _get_observation_pairs(study, param_name, trial)\r\n  File \"/home/ext_salvadordura_gmail_com/.local/lib/python3.6/site-packages/optuna/samplers/tpe/sampler.py\", line 618, in _get_observation_pairs\r\n    for trial in study.get_trials(deepcopy=False):\r\n  File \"/home/ext_salvadordura_gmail_com/.local/lib/python3.6/site-packages/optuna/study.py\", line 145, in get_trials\r\n    return self._storage.get_all_trials(self._study_id, deepcopy=deepcopy)\r\n  File \"/home/ext_salvadordura_gmail_com/.local/lib/python3.6/site-packages/optuna/storages/cached_storage.py\", line 363, in get_all_trials\r\n    study_id, excluded_trial_ids=study.owned_or_finished_trial_ids\r\n  File \"/home/ext_salvadordura_gmail_com/.local/lib/python3.6/site-packages/optuna/storages/rdb/storage.py\", line 951, in _get_trials\r\n    models.TrialModel.study_id == study_id,\r\n  File \"/usr/local/lib64/python3.6/site-packages/sqlalchemy/orm/query.py\", line 3341, in all\r\n    return list(self)\r\n  File \"/usr/local/lib64/python3.6/site-packages/sqlalchemy/orm/query.py\", line 3503, in __iter__\r\n    return self._execute_and_instances(context)\r\n  File \"/usr/local/lib64/python3.6/site-packages/sqlalchemy/orm/query.py\", line 3528, in _execute_and_instances\r\n    result = conn.execute(querycontext.statement, self._params)\r\n  File \"/usr/local/lib64/python3.6/site-packages/sqlalchemy/engine/base.py\", line 1014, in execute\r\n    return meth(self, multiparams, params)\r\n  File \"/usr/local/lib64/python3.6/site-packages/sqlalchemy/sql/elements.py\", line 298, in _execute_on_connection\r\n    return connection._execute_clauseelement(self, multiparams, params)\r\n  File \"/usr/local/lib64/python3.6/site-packages/sqlalchemy/engine/base.py\", line 1133, in _execute_clauseelement\r\n    distilled_params,\r\n  File \"/usr/local/lib64/python3.6/site-packages/sqlalchemy/engine/base.py\", line 1318, in _execute_context\r\n    e, statement, parameters, cursor, context\r\n  File \"/usr/local/lib64/python3.6/site-packages/sqlalchemy/engine/base.py\", line 1512, in _handle_dbapi_exception\r\n    sqlalchemy_exception, with_traceback=exc_info[2], from_=e\r\n  File \"/usr/local/lib64/python3.6/site-packages/sqlalchemy/util/compat.py\", line 178, in raise_\r\n    raise exception\r\n  File \"/usr/local/lib64/python3.6/site-packages/sqlalchemy/engine/base.py\", line 1278, in _execute_context\r\n    cursor, statement, parameters, context\r\n  File \"/usr/local/lib64/python3.6/site-packages/sqlalchemy/engine/default.py\", line 593, in do_execute\r\n    cursor.execute(statement, parameters)\r\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) too many SQL variables\r\n[SQL: SELECT trials.trial_id AS trials_trial_id, trials.number AS trials_number, trials.study_id AS trials_study_id, trials.state AS trials_state, trials.value AS trials_value, trials.datetime_start AS trials_datetime_start, trials.datetime_complete AS trials_datetime_complete \r\nFROM trials \r\nWHERE trials.trial_id NOT IN (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) AND trials.study_id = ?]\r\n[parameters: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 612, 613, 614, 615, 616, 617, 618, 619, 620, 621, 622, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 634, 635, 636, 637, 638, 639, 640, 641, 642, 643, 644, 645, 646, 647, 648, 649, 650, 651, 652, 653, 654, 655, 656, 657, 658, 659, 660, 661, 662, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 680, 681, 682, 683, 684, 685, 686, 687, 688, 689, 690, 691, 692, 693, 694, 695, 696, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720, 721, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743, 744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755`", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1457/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1457/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1456", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1456/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1456/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1456/events", "html_url": "https://github.com/optuna/optuna/pull/1456", "id": 647942921, "node_id": "MDExOlB1bGxSZXF1ZXN0NDQxODQyMzE3", "number": 1456, "title": "Use `step` to calculate range of `IntUniformDistribution` in PyCmaSampler.", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/25", "html_url": "https://github.com/optuna/optuna/milestone/25", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/25/labels", "id": 5476490, "node_id": "MDk6TWlsZXN0b25lNTQ3NjQ5MA==", "number": 25, "title": "v2.0.0-rc0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 131, "state": "closed", "created_at": "2020-05-29T04:35:59Z", "updated_at": "2020-07-06T05:37:26Z", "due_on": null, "closed_at": "2020-07-06T05:37:26Z"}, "comments": 1, "created_at": "2020-06-30T07:38:47Z", "updated_at": "2022-03-07T08:43:59Z", "closed_at": "2020-07-01T04:09:38Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1456", "html_url": "https://github.com/optuna/optuna/pull/1456", "diff_url": "https://github.com/optuna/optuna/pull/1456.diff", "patch_url": "https://github.com/optuna/optuna/pull/1456.patch", "merged_at": "2020-07-01T04:09:37Z"}, "body": "## Motivation\r\nThis PR derived from https://github.com/optuna/optuna/pull/1302#discussion_r447462314.\r\n\r\n## Description of the changes\r\n`PyCmaSampler` does not consider the `IntUniformDistribution.step` to calculate the range (i.e., `low`, `high`). I think it is inconsistent with the range calculation for `DiscreteUniformDistribution`. This PR fixes the range of `IntUniformDistribution`.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1456/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1456/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1446", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1446/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1446/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1446/events", "html_url": "https://github.com/optuna/optuna/issues/1446", "id": 646843948, "node_id": "MDU6SXNzdWU2NDY4NDM5NDg=", "number": 1446, "title": "AllenNLP integration: Can't load configurations that expect ext_vars from environment variables", "user": {"login": "nickswalker", "id": 924295, "node_id": "MDQ6VXNlcjkyNDI5NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/924295?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nickswalker", "html_url": "https://github.com/nickswalker", "followers_url": "https://api.github.com/users/nickswalker/followers", "following_url": "https://api.github.com/users/nickswalker/following{/other_user}", "gists_url": "https://api.github.com/users/nickswalker/gists{/gist_id}", "starred_url": "https://api.github.com/users/nickswalker/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nickswalker/subscriptions", "organizations_url": "https://api.github.com/users/nickswalker/orgs", "repos_url": "https://api.github.com/users/nickswalker/repos", "events_url": "https://api.github.com/users/nickswalker/events{/privacy}", "received_events_url": "https://api.github.com/users/nickswalker/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-06-28T05:20:21Z", "updated_at": "2020-07-01T12:16:53Z", "closed_at": "2020-07-01T07:57:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "Optuna's AllenNLP integration evaluates the jsonnet config that you give it, passing in the trial parameters as the `ext_vars`. AllenNLP's default behavior when loading a configuration is a little different, in that it also passes through environment variables: \r\n\r\nhttps://github.com/allenai/allennlp/blob/4de68a42a0df89df01a999ee48f361f24c8c19d4/allennlp/common/params.py#L488\r\n\r\nSo if you rely on specifying e.g. a path to a file as an environment variable, that configuration won't load as expected when using the integration\r\n\r\n## Expected behavior\r\n\r\nOptuna should pass environment variables through when the jsonnet is interpreted. Ideally, it'd just use the AllenNLP config loading code directly so that all behavior is identical, just overriding whatever the trial needs to override.\r\n\r\n## Environment\r\n\r\n- Optuna version: 1.5.0\r\n- Python version: 3.6\r\n- OS: Ubuntu 18.04.4\r\n- (Optional) Other libraries and their versions: AllenNLP 1.0\r\n\r\n## Error messages, stack traces, or logs\r\n\r\nYou'll get `RuntimeError: undefined external variable` during the interpretation of the jsonnet here:\r\n\r\nhttps://github.com/optuna/optuna/blob/9f5c5cf5c36df1628567f0b4a9873892d148ad40/optuna/integration/allennlp.py#L108\r\n\r\n## Steps to reproduce\r\n\r\n1. Use a AllenNLP configuration that expects to be able to use an environment variable to fill an extVar", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1446/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1446/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1417", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1417/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1417/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1417/events", "html_url": "https://github.com/optuna/optuna/issues/1417", "id": 644365521, "node_id": "MDU6SXNzdWU2NDQzNjU1MjE=", "number": 1417, "title": "PyTorchLightningPruningCallback not pruning", "user": {"login": "david-waterworth", "id": 5028974, "node_id": "MDQ6VXNlcjUwMjg5NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5028974?v=4", "gravatar_id": "", "url": "https://api.github.com/users/david-waterworth", "html_url": "https://github.com/david-waterworth", "followers_url": "https://api.github.com/users/david-waterworth/followers", "following_url": "https://api.github.com/users/david-waterworth/following{/other_user}", "gists_url": "https://api.github.com/users/david-waterworth/gists{/gist_id}", "starred_url": "https://api.github.com/users/david-waterworth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/david-waterworth/subscriptions", "organizations_url": "https://api.github.com/users/david-waterworth/orgs", "repos_url": "https://api.github.com/users/david-waterworth/repos", "events_url": "https://api.github.com/users/david-waterworth/events{/privacy}", "received_events_url": "https://api.github.com/users/david-waterworth/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 2107128673, "node_id": "MDU6TGFiZWwyMTA3MTI4Njcz", "url": "https://api.github.com/repos/optuna/optuna/labels/no-stale", "name": "no-stale", "color": "BBBBBB", "default": false, "description": "Exempt from stale bot"}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 22, "created_at": "2020-06-24T06:50:10Z", "updated_at": "2021-07-01T02:46:37Z", "closed_at": "2021-07-01T02:46:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "I've only been using pytorch lightning and optuna for a few days (kudos, it literally took less than 30 minutes to implement with optuna, I've been using hyperopt and optuna has a much nicer API).\r\n\r\nIt seems to me though that `PyTorchLightningPruningCallback` implements `on_epoch_end` when it should in fact implement `on_validation_end`. Otherwise, the `MedianPruner` doesn't appear to get invoked. \r\n\r\n\r\n## Expected behavior\r\n\r\n`PyTorchLightningPruningCallback` to be invoked on each epoch, if you rename the `PyTorchLightningPruningCallback.on_epoch_end` to `PyTorchLightningPruningCallback.on_validation_end` the `MedianPruner` is invoked.\r\n\r\nAlternatively I just removed the `early_stop_callback` - then pruning does work, but I'm not sure what strategy it's using, I'm pretty sure it's not the `optuna.pruners.MedianPruner`, I guess it's a default pytorch_lightning pruner?\r\n\r\n## Environment\r\n\r\n- Optuna version: 1.5.0\r\n- Python version: 3.7\r\n- OS: Ubuntu 18.04\r\n- (Optional) Other libraries and their versions:\r\n\r\npytorch-lightning 0.8.1\r\n\r\n## Additional context (optional)\r\n\r\nI simplified my objective (the example doesn't log to tensorboard, I found that by commenting out much of the code it started logging correctly). I'm training a TCN with only 1 batch per epoch. I also modified the example so as to not pass the trial object into my `LightningModule`\r\n\r\n```\r\ndef objective(trial):\r\n    metrics_callback = MetricsCallback()\r\n    trainer = pl.Trainer(\r\n        callbacks=[metrics_callback],\r\n        early_stop_callback=PyTorchLightningPruningCallback(trial, monitor=\"avg_val_loss\"),\r\n    )\r\n\r\n    layers = trial.suggest_int(\"layers\", 1, 8)\r\n    filters = trial.suggest_int(\"filters\", 1, 32)\r\n    kernel_size = trial.suggest_int(\"kernel_size\", 2, 3)\r\n    dropout = trial.suggest_uniform(\"dropout\", 0.2, 0.5)\r\n    learning_rate = trial.suggest_loguniform(\"learning_rate\", 1e-5, 1e-1)\r\n    model = TCN(PATH, layers, filters, kernel_size, dropout, learning_rate)\r\n    trainer.fit(model)\r\n\r\n    return metrics_callback.metrics[-1][\"avg_val_loss\"].item()\r\n```\r\n\r\npretty sure the main code is essentially the same as the example\r\n\r\n```\r\n    hparams = vars(args)\r\n    tcn = TCN(**hparams)\r\n    pruner = optuna.pruners.MedianPruner()\r\n\r\n    trainer = pl.Trainer.from_argparse_args(args, pruner=pruner)\r\n    trainer.fit(tcn)\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1417/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1417/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1411", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1411/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1411/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1411/events", "html_url": "https://github.com/optuna/optuna/issues/1411", "id": 643969408, "node_id": "MDU6SXNzdWU2NDM5Njk0MDg=", "number": 1411, "title": "Deprecated decorator's message does not appear", "user": {"login": "nzw0301", "id": 7121753, "node_id": "MDQ6VXNlcjcxMjE3NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/7121753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nzw0301", "html_url": "https://github.com/nzw0301", "followers_url": "https://api.github.com/users/nzw0301/followers", "following_url": "https://api.github.com/users/nzw0301/following{/other_user}", "gists_url": "https://api.github.com/users/nzw0301/gists{/gist_id}", "starred_url": "https://api.github.com/users/nzw0301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nzw0301/subscriptions", "organizations_url": "https://api.github.com/users/nzw0301/orgs", "repos_url": "https://api.github.com/users/nzw0301/repos", "events_url": "https://api.github.com/users/nzw0301/events{/privacy}", "received_events_url": "https://api.github.com/users/nzw0301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2020-06-23T16:10:48Z", "updated_at": "2021-01-21T19:44:59Z", "closed_at": "2020-06-24T04:23:52Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n## Expected behavior\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\nWhen we run a method or class has [deprecated decorator](https://github.com/optuna/optuna/blob/879009b95b03988e5cd1f2e335f3bf1c6367aa87/optuna/_deprecated.py#L36) of optuna, we expect a warning message is shown. But the current implementation does not show any warning message.\r\n\r\n## Environment\r\n\r\n- Optuna version: [the lastest version](https://github.com/optuna/optuna/tree/879009b95b03988e5cd1f2e335f3bf1c6367aa87) & [additional commit](https://github.com/nzw0301/optuna/commit/0981f3f4eaed012b744a465f27d4534654fd19d7)\r\n- Python version: 3.8.4\r\n- OS: MacOSX 10.15.5\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n# error messages, stack traces, or logs\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. `pip install git+https://github.com/nzw0301/optuna.git@deprecated-test`\r\n2. Run the following examples: they do not show anything.\r\n\r\n## Reproducible examples (optional)\r\n\r\nBy the [additional commit](https://github.com/nzw0301/optuna/commit/0981f3f4eaed012b744a465f27d4534654fd19d7), `IntLogUniformDistribution` and  `IntLogUniformDistribution.single` have deprecated decorators. But no warning messages appear when they are called:\r\n\r\n```python\r\nimport optuna\r\nfrom optuna.distributions import IntLogUniformDistribution\r\n\r\ndist = IntLogUniformDistribution(1, 10)\r\ndist.single()\r\n```\r\n\r\nOr\r\n\r\n```python\r\nimport optuna\r\nfrom optuna.distributions import IntLogUniformDistribution\r\n\r\noptuna.logging.set_verbosity(optuna.logging.WARNING)\r\n\r\ndist = IntLogUniformDistribution(1, 10)\r\ndist.single()\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n\r\nOther optuna's codes such that it contains `DeprecatedWarning` such as [`optuna.structs.py`](https://github.com/optuna/optuna/blob/879009b95b03988e5cd1f2e335f3bf1c6367aa87/optuna/structs.py) show the warning message by default when we use them.\r\n\r\nFor example, if I run the following line,\r\n\r\n```python\r\nfrom optuna.structs import FrozenTrial\r\n```\r\n\r\nthen the following warning message is printed:\r\n\r\n```bash\r\n[W 2020-06-24 01:11:56,553] `structs` is deprecated. Classes have moved to the following modules. `structs.StudyDirection`->`study.StudyDirection`, `structs.StudySummary`->`study.StudySummary`, `structs.FrozenTrial`->`trial.FrozenTrial`, `structs.TrialState`->`trial.TrialState`, `structs.TrialPruned`->`exceptions.TrialPruned`.\r\n```\r\n\r\n---\r\n\r\nThank you @HideakiImamura for investigating this issue.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1411/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1411/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1406", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1406/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1406/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1406/events", "html_url": "https://github.com/optuna/optuna/pull/1406", "id": 643073466, "node_id": "MDExOlB1bGxSZXF1ZXN0NDM3OTQ0NTky", "number": 1406, "title": "Fix exception handling in `ChainerMNStudy.optimize`.", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/25", "html_url": "https://github.com/optuna/optuna/milestone/25", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/25/labels", "id": 5476490, "node_id": "MDk6TWlsZXN0b25lNTQ3NjQ5MA==", "number": 25, "title": "v2.0.0-rc0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 131, "state": "closed", "created_at": "2020-05-29T04:35:59Z", "updated_at": "2020-07-06T05:37:26Z", "due_on": null, "closed_at": "2020-07-06T05:37:26Z"}, "comments": 3, "created_at": "2020-06-22T13:29:52Z", "updated_at": "2020-06-23T06:35:24Z", "closed_at": "2020-06-23T04:25:14Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1406", "html_url": "https://github.com/optuna/optuna/pull/1406", "diff_url": "https://github.com/optuna/optuna/pull/1406.diff", "patch_url": "https://github.com/optuna/optuna/pull/1406.patch", "merged_at": "2020-06-23T04:25:14Z"}, "body": "## Motivation\r\nResolves #1395.\r\n\r\n\r\n## Description of the changes\r\n\r\nIf exceptions are raised in the objective function in the rank-1 node, it immediately exits `ChainerMNStudy.optimize` without waiting for the rank-0 node. If the rank-0 node writes the trial state of the last trial earlier than the rank-1's `ChainerMNStudy.trials`, the test can be passed. Otherwise, tests will fail.\r\n\r\nThis PR uses `try-finally` clauses to wait for the rank-0 node.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1406/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1406/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1401", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1401/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1401/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1401/events", "html_url": "https://github.com/optuna/optuna/issues/1401", "id": 642540706, "node_id": "MDU6SXNzdWU2NDI1NDA3MDY=", "number": 1401, "title": "Pruner doesn't prune at the first step.", "user": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-06-21T10:58:21Z", "updated_at": "2020-07-02T01:19:56Z", "closed_at": "2020-07-02T01:19:56Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "## Expected behavior\r\n\r\nPruner does the pruning.\r\n\r\n## Environment\r\n\r\n- Optuna version: 1.5.0\r\n- Python version: 3.7.7\r\n- OS: Ubuntu 18.04\r\n- (Optional) Other libraries and their versions: AllenNLP 1.0.0\r\n\r\n## Reproducible examples\r\n\r\n```python\r\nimport optuna\r\n\r\n\r\nstudy = optuna.study.create_study()\r\ntrial = optuna.trial.Trial(study, study._storage.create_new_trial(study._study_id))\r\npruner = optuna.pruners.ThresholdPruner(upper=2.0, n_warmup_steps=0, interval_steps=1)\r\n\r\ntrial.report(3.0, 1)\r\nassert pruner.prune(study=study, trial=study._storage.get_trial(trial._trial_id))  # prune!\r\n\r\ntrial.report(3.0, 0)\r\nassert pruner.prune(study=study, trial=study._storage.get_trial(trial._trial_id))  # doesn't prune!\r\n```\r\n\r\nIt's a small bug but some libraries (e.g. AllenNLP) report metrics from `epoch==0`.\r\nFor the input `epoch==0`, pruner never prunes a trial because it satisfies `step <= n_warmup_steps`.\r\n- https://github.com/optuna/optuna/blob/master/optuna/pruners/_threshold.py#L121\r\n- https://github.com/optuna/optuna/blob/master/optuna/pruners/_percentile.py#L170\r\n\r\nI think it doesn't have a strong impact, as almost pruner doesn't prune trial at the beginning of training.\r\nHowever, for `ThresholdPruner`, it could be matter.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1401/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1401/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1395", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1395/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1395/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1395/events", "html_url": "https://github.com/optuna/optuna/issues/1395", "id": 641821653, "node_id": "MDU6SXNzdWU2NDE4MjE2NTM=", "number": 1395, "title": "Occasional test failure with `ChainerMNStudy` with Python 3.5.", "user": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-06-19T09:06:54Z", "updated_at": "2020-06-23T04:25:14Z", "closed_at": "2020-06-23T04:25:14Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "## Expected behavior\r\n\r\nTests should pass.\r\n\r\n## Error messages, stack traces, or logs\r\n\r\nhttps://app.circleci.com/pipelines/github/optuna/optuna/1171/workflows/41e626df-8501-46ca-a724-9b1c27079253/jobs/45897\r\n\r\n## Additional context (optional)\r\n\r\nSeems to be specific to Python 3.5 and only happen randomly.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1395/reactions", "total_count": 3, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1395/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1392", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1392/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1392/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1392/events", "html_url": "https://github.com/optuna/optuna/pull/1392", "id": 641650693, "node_id": "MDExOlB1bGxSZXF1ZXN0NDM2ODQ1OTg5", "number": 1392, "title": "Fix for PyTorch Lightning v0.8.0.", "user": {"login": "crcrpar", "id": 16191443, "node_id": "MDQ6VXNlcjE2MTkxNDQz", "avatar_url": "https://avatars.githubusercontent.com/u/16191443?v=4", "gravatar_id": "", "url": "https://api.github.com/users/crcrpar", "html_url": "https://github.com/crcrpar", "followers_url": "https://api.github.com/users/crcrpar/followers", "following_url": "https://api.github.com/users/crcrpar/following{/other_user}", "gists_url": "https://api.github.com/users/crcrpar/gists{/gist_id}", "starred_url": "https://api.github.com/users/crcrpar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/crcrpar/subscriptions", "organizations_url": "https://api.github.com/users/crcrpar/orgs", "repos_url": "https://api.github.com/users/crcrpar/repos", "events_url": "https://api.github.com/users/crcrpar/events{/privacy}", "received_events_url": "https://api.github.com/users/crcrpar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561256, "node_id": "MDU6TGFiZWwxOTQ3NTYxMjU2", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.integration", "name": "optuna.integration", "color": "1c659e", "default": false, "description": "Related to the `optuna.integration` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/25", "html_url": "https://github.com/optuna/optuna/milestone/25", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/25/labels", "id": 5476490, "node_id": "MDk6TWlsZXN0b25lNTQ3NjQ5MA==", "number": 25, "title": "v2.0.0-rc0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 131, "state": "closed", "created_at": "2020-05-29T04:35:59Z", "updated_at": "2020-07-06T05:37:26Z", "due_on": null, "closed_at": "2020-07-06T05:37:26Z"}, "comments": 0, "created_at": "2020-06-19T02:01:24Z", "updated_at": "2020-06-19T11:54:03Z", "closed_at": "2020-06-19T10:27:32Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1392", "html_url": "https://github.com/optuna/optuna/pull/1392", "diff_url": "https://github.com/optuna/optuna/pull/1392.diff", "patch_url": "https://github.com/optuna/optuna/pull/1392.patch", "merged_at": "2020-06-19T10:27:32Z"}, "body": "<!-- Thank you for creating a pull request! -->\r\n\r\nPyTorch Lightning v0.8.0 has some breaking changes:\r\n1. `Trainer` module and the changes of `(min|max)_nb_epochs` to `(min|max)_epochss` affect our integration tests for it.\r\n2. `EarlyStoppingCallback` is now triggered by `on_validation_end` instead of `epoch_end`.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n- Fixes for the above two changes\r\n- Support Python 3.8\r\n\r\n\r\n__TODO__\r\n\r\n- [x] enable test & example on Python 3.8", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1392/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1392/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1368", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1368/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1368/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1368/events", "html_url": "https://github.com/optuna/optuna/issues/1368", "id": 638464750, "node_id": "MDU6SXNzdWU2Mzg0NjQ3NTA=", "number": 1368, "title": "Cannot build the docs with latest `sphinx` 3.1.1.", "user": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-06-15T00:33:22Z", "updated_at": "2020-06-19T06:08:14Z", "closed_at": "2020-06-19T06:08:14Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "## Expected behavior\r\n\r\nDocs should be built properly without warnings/errors. Following warnings are raised by `sphinx`'s latests release `3.1.1`.\r\n\r\n## Environment\r\n\r\n- `sphinx==3.1.1`\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nWARNING: Failed to update signature for <function MLflowCallback.__init__ at 0x7feea1b4e280>: parameter not found: 'args'\r\n \r\nWARNING: Failed to update signature for <function GridSampler.__init__ at 0x7feeabb5edc0>: parameter not found: 'args'\r\n \r\nWARNING: Failed to update signature for <function RedisStorage.__init__ at 0x7feeabb4ce50>: parameter not found: 'args'\r\n \r\nWARNING: Failed to update signature for <function Study.enqueue_trial at 0x7feeabb4ec10>: parameter not found: 'kwargs'\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. `pip install sphinx -U`\r\n2. `cd docs`\r\n3. `make clean`\r\n4. `make html`", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1368/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1368/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1351", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1351/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1351/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1351/events", "html_url": "https://github.com/optuna/optuna/issues/1351", "id": 636044676, "node_id": "MDU6SXNzdWU2MzYwNDQ2NzY=", "number": 1351, "title": "Error when using custom metrics in optuna.integration.lightgbm", "user": {"login": "worldblue0214", "id": 34713433, "node_id": "MDQ6VXNlcjM0NzEzNDMz", "avatar_url": "https://avatars.githubusercontent.com/u/34713433?v=4", "gravatar_id": "", "url": "https://api.github.com/users/worldblue0214", "html_url": "https://github.com/worldblue0214", "followers_url": "https://api.github.com/users/worldblue0214/followers", "following_url": "https://api.github.com/users/worldblue0214/following{/other_user}", "gists_url": "https://api.github.com/users/worldblue0214/gists{/gist_id}", "starred_url": "https://api.github.com/users/worldblue0214/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/worldblue0214/subscriptions", "organizations_url": "https://api.github.com/users/worldblue0214/orgs", "repos_url": "https://api.github.com/users/worldblue0214/repos", "events_url": "https://api.github.com/users/worldblue0214/events{/privacy}", "received_events_url": "https://api.github.com/users/worldblue0214/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1904423825, "node_id": "MDU6TGFiZWwxOTA0NDIzODI1", "url": "https://api.github.com/repos/optuna/optuna/labels/needs-discussion", "name": "needs-discussion", "color": "e99695", "default": false, "description": "Issue/PR which needs discussion."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2020-06-10T08:28:31Z", "updated_at": "2022-10-24T23:05:46Z", "closed_at": "2022-10-24T23:05:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n## Expected behavior\r\nI got an error when using custom metrics in optuna.integration.lightgbm.\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\n\r\n## Environment\r\n\r\n- Optuna version: 1.5.0\r\n- Python version: 3.7.7\r\n- OS: MacOS Catalina 10.15.5\r\n- Anaconda\r\n- (Optional) Other libraries and their versions:\r\n[conda_list.txt](https://github.com/optuna/optuna/files/4757062/conda_list.txt)\r\n\r\n\r\n## Error messages, stack traces, or logs\r\n```\r\n Early stopping, best iteration is:\r\n [113]\ttraining's custom_metrics: 0.73954\tvalid_1's custom_metrics: 2.25621\r\n\r\nKeyError                                  Traceback (most recent call last)\r\n<ipython-input-45-c87e652c308e> in <module>\r\n      1 best_params = {}\r\n      2 model = lgb_tuner.train(params, train_set, num_boost_round = 2500, early_stopping_rounds = 50,\r\n----> 3                   valid_sets = [train_set, val_set], verbose_eval = 100, feval= custom_metrics)\r\n\r\n~/opt/anaconda3/envs/dev-python37/lib/python3.7/site-packages/optuna/_experimental.py in new_func(*args, **kwargs)\r\n     62                 )\r\n     63 \r\n---> 64                 return func(*args, **kwargs)  # type: ignore\r\n     65 \r\n     66             return new_func\r\n\r\n~/opt/anaconda3/envs/dev-python37/lib/python3.7/site-packages/optuna/integration/lightgbm_tuner/__init__.py in train(*args, **kwargs)\r\n     44 \r\n     45     auto_booster = LightGBMTuner(*args, **kwargs)\r\n---> 46     auto_booster.run()\r\n     47     return auto_booster.get_best_booster()\r\n\r\n~/opt/anaconda3/envs/dev-python37/lib/python3.7/site-packages/optuna/integration/lightgbm_tuner/optimize.py in run(self)\r\n    483         self.sample_train_set()\r\n    484 \r\n--> 485         self.tune_feature_fraction()\r\n    486         self.tune_num_leaves()\r\n    487         self.tune_bagging()\r\n\r\n~/opt/anaconda3/envs/dev-python37/lib/python3.7/site-packages/optuna/integration/lightgbm_tuner/optimize.py in tune_feature_fraction(self, n_trials)\r\n    511             warnings.simplefilter(\"ignore\", category=optuna.exceptions.ExperimentalWarning)\r\n    512             sampler = optuna.samplers.GridSampler({param_name: param_values})\r\n--> 513         self.tune_params([param_name], len(param_values), sampler, \"feature_fraction\")\r\n    514 \r\n    515     def tune_num_leaves(self, n_trials: int = 20) -> None:\r\n\r\n~/opt/anaconda3/envs/dev-python37/lib/python3.7/site-packages/optuna/integration/lightgbm_tuner/optimize.py in tune_params(self, target_param_names, n_trials, sampler, step_name)\r\n    862 \r\n    863         objective = super(LightGBMTuner, self).tune_params(\r\n--> 864             target_param_names, n_trials, sampler, step_name\r\n    865         )\r\n    866 \r\n\r\n~/opt/anaconda3/envs/dev-python37/lib/python3.7/site-packages/optuna/integration/lightgbm_tuner/optimize.py in tune_params(self, target_param_names, n_trials, sampler, step_name)\r\n    595                     timeout=_timeout,\r\n    596                     catch=(),\r\n--> 597                     callbacks=self._optuna_callbacks,\r\n    598                 )\r\n    599             except ValueError:\r\n\r\n~/opt/anaconda3/envs/dev-python37/lib/python3.7/site-packages/optuna/study.py in optimize(self, func, n_trials, timeout, n_jobs, catch, callbacks, gc_after_trial, show_progress_bar)\r\n    337             if n_jobs == 1:\r\n    338                 self._optimize_sequential(\r\n--> 339                     func, n_trials, timeout, catch, callbacks, gc_after_trial, None\r\n    340                 )\r\n    341             else:\r\n\r\n~/opt/anaconda3/envs/dev-python37/lib/python3.7/site-packages/optuna/study.py in _optimize_sequential(self, func, n_trials, timeout, catch, callbacks, gc_after_trial, time_start)\r\n    680                     break\r\n    681 \r\n--> 682             self._run_trial_and_callbacks(func, catch, callbacks, gc_after_trial)\r\n    683 \r\n    684             self._progress_bar.update((datetime.datetime.now() - time_start).total_seconds())\r\n\r\n~/opt/anaconda3/envs/dev-python37/lib/python3.7/site-packages/optuna/study.py in _run_trial_and_callbacks(self, func, catch, callbacks, gc_after_trial)\r\n    711         # type: (...) -> None\r\n    712 \r\n--> 713         trial = self._run_trial(func, catch, gc_after_trial)\r\n    714         if callbacks is not None:\r\n    715             frozen_trial = copy.deepcopy(self._storage.get_trial(trial._trial_id))\r\n\r\n~/opt/anaconda3/envs/dev-python37/lib/python3.7/site-packages/optuna/study.py in _run_trial(self, func, catch, gc_after_trial)\r\n    732 \r\n    733         try:\r\n--> 734             result = func(trial)\r\n    735         except exceptions.TrialPruned as e:\r\n    736             message = \"Setting status of trial#{} as {}. {}\".format(\r\n\r\n~/opt/anaconda3/envs/dev-python37/lib/python3.7/site-packages/optuna/integration/lightgbm_tuner/optimize.py in __call__(self, trial)\r\n    247         booster = lgb.train(self.lgbm_params, self.train_set, **self.lgbm_kwargs)\r\n    248 \r\n--> 249         val_score = self._get_booster_best_score(booster)\r\n    250         elapsed_secs = time.time() - start_time\r\n    251         average_iteration_time = elapsed_secs / booster.current_iteration()\r\n\r\n~/opt/anaconda3/envs/dev-python37/lib/python3.7/site-packages/optuna/integration/lightgbm_tuner/optimize.py in _get_booster_best_score(self, booster)\r\n    119             raise NotImplementedError\r\n    120 \r\n--> 121         val_score = booster.best_score[valid_name][metric]\r\n    122         return val_score\r\n    123 \r\n\r\nKeyError: 'None'\r\n\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1.create custom_metric\r\n2.set params : params = {'metric' = 'None', ...}\r\n3.optuna.integration.lightgbm.train(params = params, feval = custom_metrics, ...)\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\n# python code\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1351/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1351/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1347", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1347/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1347/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1347/events", "html_url": "https://github.com/optuna/optuna/issues/1347", "id": 635438825, "node_id": "MDU6SXNzdWU2MzU0Mzg4MjU=", "number": 1347, "title": "Close connection after optimize", "user": {"login": "datasatanic", "id": 43723188, "node_id": "MDQ6VXNlcjQzNzIzMTg4", "avatar_url": "https://avatars.githubusercontent.com/u/43723188?v=4", "gravatar_id": "", "url": "https://api.github.com/users/datasatanic", "html_url": "https://github.com/datasatanic", "followers_url": "https://api.github.com/users/datasatanic/followers", "following_url": "https://api.github.com/users/datasatanic/following{/other_user}", "gists_url": "https://api.github.com/users/datasatanic/gists{/gist_id}", "starred_url": "https://api.github.com/users/datasatanic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/datasatanic/subscriptions", "organizations_url": "https://api.github.com/users/datasatanic/orgs", "repos_url": "https://api.github.com/users/datasatanic/repos", "events_url": "https://api.github.com/users/datasatanic/events{/privacy}", "received_events_url": "https://api.github.com/users/datasatanic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 14, "created_at": "2020-06-09T13:35:46Z", "updated_at": "2020-12-26T08:27:49Z", "closed_at": "2020-12-26T08:27:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n## Expected behavior\r\n\r\nI need to build many, fast-training models. For this i'm using multiprocessing.Pool:\r\n```\r\nwith Pool(maxtasksperchild=10) as pool:\r\n    res=pool.map(task,iter)\r\n```\r\nIn each task i'm creating stydy with unique name  and run optimize. As storage is used Postgres 12.\r\n\r\nAfter a few cycle, i get error from psycopg2: \"too many client\"\r\nHow I can manualy close connection for finished task and study. Or exist anotherway?\r\nP.S. I know about the possibility to \u0448ncrease quantity of clients on Postgres, but It only test data. Real task is much more.\r\n\r\n## Environment\r\n\r\n- Optuna version: 1.5.0\r\n- Python version: 3.7.7\r\n- OS: Ubuntu 20.04\r\n-  psycopg2-binary: 2.8.5\r\n- Postgres version: 12\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n# error messages, stack traces, or logs\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/ilya/anaconda3/lib/python3.7/multiprocessing/pool.py\", line 121, in worker\r\n    result = (True, func(*args, **kwds))\r\n  File \"/home/ilya/anaconda3/lib/python3.7/multiprocessing/pool.py\", line 44, in mapstar\r\n    return list(map(*args))\r\n  File \"<ipython-input-11-68b9f5f269e0>\", line 3, in task\r\n    df:pd.DataFrame=pd.read_sql_query(select_query.format(pan=pan),connect_string)\r\n  File \"/home/ilya/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py\", line 332, in read_sql_query\r\n    chunksize=chunksize,\r\n  File \"/home/ilya/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py\", line 1218, in read_query\r\n    result = self.execute(*args)\r\n  File \"/home/ilya/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py\", line 1087, in execute\r\n    return self.connectable.execute(*args, **kwargs)\r\n  File \"/home/ilya/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 2243, in execute\r\n    connection = self._contextual_connect(close_with_result=True)\r\n  File \"/home/ilya/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 2311, in _contextual_connect\r\n    self._wrap_pool_connect(self.pool.connect, None),\r\n  File \"/home/ilya/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 2349, in _wrap_pool_connect\r\n    e, dialect, self\r\n  File \"/home/ilya/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 1591, in _handle_dbapi_exception_noconnection\r\n    sqlalchemy_exception, with_traceback=exc_info[2], from_=e\r\n  File \"/home/ilya/anaconda3/lib/python3.7/site-packages/sqlalchemy/util/compat.py\", line 178, in raise_\r\n    raise exception\r\n  File \"/home/ilya/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py\", line 2345, in _wrap_pool_connect\r\n    return fn()\r\n  File \"/home/ilya/anaconda3/lib/python3.7/site-packages/sqlalchemy/pool/base.py\", line 364, in connect\r\n    return _ConnectionFairy._checkout(self)\r\n  File \"/home/ilya/anaconda3/lib/python3.7/site-packages/sqlalchemy/pool/base.py\", line 778, in _checkout\r\n    fairy = _ConnectionRecord.checkout(pool)\r\n  File \"/home/ilya/anaconda3/lib/python3.7/site-packages/sqlalchemy/pool/base.py\", line 495, in checkout\r\n    rec = pool._do_get()\r\n  File \"/home/ilya/anaconda3/lib/python3.7/site-packages/sqlalchemy/pool/impl.py\", line 140, in _do_get\r\n    self._dec_overflow()\r\n  File \"/home/ilya/anaconda3/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py\", line 69, in __exit__\r\n    exc_value, with_traceback=exc_tb,\r\n  File \"/home/ilya/anaconda3/lib/python3.7/site-packages/sqlalchemy/util/compat.py\", line 178, in raise_\r\n    raise exception\r\n  File \"/home/ilya/anaconda3/lib/python3.7/site-packages/sqlalchemy/pool/impl.py\", line 137, in _do_get\r\n    return self._create_connection()\r\n  File \"/home/ilya/anaconda3/lib/python3.7/site-packages/sqlalchemy/pool/base.py\", line 309, in _create_connection\r\n    return _ConnectionRecord(self)\r\n  File \"/home/ilya/anaconda3/lib/python3.7/site-packages/sqlalchemy/pool/base.py\", line 440, in __init__\r\n    self.__connect(first_connect_check=True)\r\n  File \"/home/ilya/anaconda3/lib/python3.7/site-packages/sqlalchemy/pool/base.py\", line 661, in __connect\r\n    pool.logger.debug(\"Error on connect(): %s\", e)\r\n  File \"/home/ilya/anaconda3/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py\", line 69, in __exit__\r\n    exc_value, with_traceback=exc_tb,\r\n  File \"/home/ilya/anaconda3/lib/python3.7/site-packages/sqlalchemy/util/compat.py\", line 178, in raise_\r\n    raise exception\r\n  File \"/home/ilya/anaconda3/lib/python3.7/site-packages/sqlalchemy/pool/base.py\", line 656, in __connect\r\n    connection = pool._invoke_creator(self)\r\n  File \"/home/ilya/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/strategies.py\", line 114, in connect\r\n    return dialect.connect(*cargs, **cparams)\r\n  File \"/home/ilya/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/default.py\", line 490, in connect\r\n    return self.dbapi.connect(*cargs, **cparams)\r\n  File \"/home/ilya/anaconda3/lib/python3.7/site-packages/psycopg2/__init__.py\", line 127, in connect\r\n    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)\r\nsqlalchemy.exc.OperationalError: (psycopg2.OperationalError) FATAL:  sorry, too many clients already\r\n\r\n(Background on this error at: http://sqlalche.me/e/e3q8)\r\n```\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1347/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1347/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1342", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1342/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1342/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1342/events", "html_url": "https://github.com/optuna/optuna/pull/1342", "id": 635050502, "node_id": "MDExOlB1bGxSZXF1ZXN0NDMxNDg4OTg2", "number": 1342, "title": "Temporary hotfix for `sphinx` update breaking existing type annotations.", "user": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/25", "html_url": "https://github.com/optuna/optuna/milestone/25", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/25/labels", "id": 5476490, "node_id": "MDk6TWlsZXN0b25lNTQ3NjQ5MA==", "number": 25, "title": "v2.0.0-rc0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 131, "state": "closed", "created_at": "2020-05-29T04:35:59Z", "updated_at": "2020-07-06T05:37:26Z", "due_on": null, "closed_at": "2020-07-06T05:37:26Z"}, "comments": 1, "created_at": "2020-06-09T02:01:53Z", "updated_at": "2020-06-09T02:35:01Z", "closed_at": "2020-06-09T02:34:36Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1342", "html_url": "https://github.com/optuna/optuna/pull/1342", "diff_url": "https://github.com/optuna/optuna/pull/1342.diff", "patch_url": "https://github.com/optuna/optuna/pull/1342.patch", "merged_at": "2020-06-09T02:34:36Z"}, "body": "## Motivation\r\n\r\nThe latest `sphinx` update 3.1.0 broke the `master` branch and is blocking other PRs from being merged.\r\n\r\n## Description of the changes\r\n\r\nPins the version of `sphinx` to older versions.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1342/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1342/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1340", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1340/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1340/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1340/events", "html_url": "https://github.com/optuna/optuna/issues/1340", "id": 634897709, "node_id": "MDU6SXNzdWU2MzQ4OTc3MDk=", "number": 1340, "title": "Avoid problem with length limit of 5000 in MLflow", "user": {"login": "PhilipMay", "id": 229382, "node_id": "MDQ6VXNlcjIyOTM4Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/229382?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PhilipMay", "html_url": "https://github.com/PhilipMay", "followers_url": "https://api.github.com/users/PhilipMay/followers", "following_url": "https://api.github.com/users/PhilipMay/following{/other_user}", "gists_url": "https://api.github.com/users/PhilipMay/gists{/gist_id}", "starred_url": "https://api.github.com/users/PhilipMay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PhilipMay/subscriptions", "organizations_url": "https://api.github.com/users/PhilipMay/orgs", "repos_url": "https://api.github.com/users/PhilipMay/repos", "events_url": "https://api.github.com/users/PhilipMay/events{/privacy}", "received_events_url": "https://api.github.com/users/PhilipMay/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2020-06-08T20:04:05Z", "updated_at": "2020-07-06T23:50:21Z", "closed_at": "2020-07-06T23:50:21Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "## Motivation\r\nWhen using the `MLflowCallback` it is possible that the user added `user_attrs` (like lists of float) that are longer then 5000 characters when converted to a `str`. This causes problems with MLflow which limits the length to 5000. See example below:\r\n\r\n``` bash\r\n[...]\r\n  File \"/home/smay/miniconda3/envs/py38/lib/python3.8/site-packages/mlflow/utils/validation.py\", line 136, in _validate_length_limit\r\n    raise MlflowException(\r\nmlflow.exceptions.MlflowException: Tag value '[0.8562690322984875, 0.8544098885636596, 0.8544098885636596, 0.8544098885636596, 0.8544098885636596, 0.859181214773054, 0.86273086038245, 0.86273086038245, 0.86273086038245, 0.86273086038245, 0.86273086038245, 0.8562690322984875, 0.8544098885636596, ' had length 5276, which exceeded length limit of 5000\r\n```\r\n\r\n## Description\r\nI suggest to check the strings if they are `len() > 5000` and cut them if needed. If this happens a warning should be printed.\r\n\r\nI can provide a PR if wanted. Just give me feedback to my proposal please.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1340/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1340/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1320", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1320/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1320/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1320/events", "html_url": "https://github.com/optuna/optuna/issues/1320", "id": 629885739, "node_id": "MDU6SXNzdWU2Mjk4ODU3Mzk=", "number": 1320, "title": "Dashboard to html option producing a bokeh error.", "user": {"login": "apiszcz", "id": 1430861, "node_id": "MDQ6VXNlcjE0MzA4NjE=", "avatar_url": "https://avatars.githubusercontent.com/u/1430861?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apiszcz", "html_url": "https://github.com/apiszcz", "followers_url": "https://api.github.com/users/apiszcz/followers", "following_url": "https://api.github.com/users/apiszcz/following{/other_user}", "gists_url": "https://api.github.com/users/apiszcz/gists{/gist_id}", "starred_url": "https://api.github.com/users/apiszcz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apiszcz/subscriptions", "organizations_url": "https://api.github.com/users/apiszcz/orgs", "repos_url": "https://api.github.com/users/apiszcz/repos", "events_url": "https://api.github.com/users/apiszcz/events{/privacy}", "received_events_url": "https://api.github.com/users/apiszcz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-06-03T10:36:47Z", "updated_at": "2020-06-19T01:51:53Z", "closed_at": "2020-06-19T01:51:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "Optuna 1.5.0, Python 3.7.7\r\n\r\n`optuna dashboard  --storage \"postgres://postgres@localhost:5444/optuna\" --study-name test --out optunadashboard.html`\r\n\r\n```\r\n[W 2020-06-03 06:30:19,131] Optuna dashboard is still highly experimental. Please use with caution!\r\nusage: bokeh [-h] [-v]\r\n             {build,info,init,json,sampledata,secret,serve,static} ...\r\nbokeh: error: invalid choice: 'html' (choose from 'build', 'info', 'init', 'json', 'sampledata', 'secret', 'serve', 'static')\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1320/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1320/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1319", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1319/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1319/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1319/events", "html_url": "https://github.com/optuna/optuna/issues/1319", "id": 629883741, "node_id": "MDU6SXNzdWU2Mjk4ODM3NDE=", "number": 1319, "title": "Optuna dashboard page shows up blank on localhost.", "user": {"login": "apiszcz", "id": 1430861, "node_id": "MDQ6VXNlcjE0MzA4NjE=", "avatar_url": "https://avatars.githubusercontent.com/u/1430861?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apiszcz", "html_url": "https://github.com/apiszcz", "followers_url": "https://api.github.com/users/apiszcz/followers", "following_url": "https://api.github.com/users/apiszcz/following{/other_user}", "gists_url": "https://api.github.com/users/apiszcz/gists{/gist_id}", "starred_url": "https://api.github.com/users/apiszcz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apiszcz/subscriptions", "organizations_url": "https://api.github.com/users/apiszcz/orgs", "repos_url": "https://api.github.com/users/apiszcz/repos", "events_url": "https://api.github.com/users/apiszcz/events{/privacy}", "received_events_url": "https://api.github.com/users/apiszcz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-06-03T10:33:39Z", "updated_at": "2020-06-19T01:51:12Z", "closed_at": "2020-06-19T01:51:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "Optuna 1.5.0, Python 3.7.7\r\n\r\nThe following command\r\n`optuna dashboard  --storage \"postgres://postgres@localhost:5444/optuna\" --study-name test\r\n`the http server starts up and the web page opens to a blank page. Refresh the page produces another blank page. Any ideas on where I should look to resolve the issue?\r\n\r\nThank you for a great package and documentation!\r\n\r\n```\r\n[W 2020-06-03 06:27:42,079] Optuna dashboard is still highly experimental. Please use with caution!\r\n[I 2020-06-03 06:27:42,087] Starting Bokeh server version 2.0.2 (running on Tornado 6.0.4)\r\n[I 2020-06-03 06:27:42,089] User authentication hooks NOT provided (default user enabled)\r\n[I 2020-06-03 06:27:42,092] Bokeh app running at: http://localhost:5006/dashboard\r\n[I 2020-06-03 06:27:42,093] Starting Bokeh server with process id: 31360\r\n[I 2020-06-03 06:27:43,014] 200 GET /dashboard (::1) 117.69ms\r\n[I 2020-06-03 06:27:43,670] 200 GET /static/js/bokeh.min.js?v=57d29d5936e494351385d736f792154c (::1) 612.41ms\r\n[I 2020-06-03 06:27:43,684] 200 GET /static/js/bokeh-widgets.min.js?v=fdb1f42cceaade9062de57963cac654c (::1) 11.93ms\r\n[I 2020-06-03 06:27:43,697] 200 GET /static/js/bokeh-tables.min.js?v=0a7f930d4b0805283dfba427bb3d0dae (::1) 24.89ms\r\n[I 2020-06-03 06:27:43,702] 200 GET /static/js/bokeh-gl.min.js?v=c376f0736800259be44cb1aed39a6cc3 (::1) 28.89ms\r\n[I 2020-06-03 06:27:43,787] 101 GET /dashboard/ws (::1) 0.00ms\r\n[I 2020-06-03 06:27:43,788] WebSocket connection opened\r\n[I 2020-06-03 06:27:43,790] ServerConnection created\r\n[W 2020-06-03 06:27:43,798] 404 GET /favicon.ico (::1) 1.00ms\r\n[I 2020-06-03 06:28:38,374] 200 GET /dashboard (::1) 3.96ms\r\n[I 2020-06-03 06:28:38,381] WebSocket connection closed: code=1001, reason=None\r\n[I 2020-06-03 06:28:38,510] 101 GET /dashboard/ws (::1) 1.00ms\r\n[I 2020-06-03 06:28:38,510] WebSocket connection opened\r\n[I 2020-06-03 06:28:38,511] ServerConnection created\r\n```\r\n![2020-06-03T093802_465_455](https://user-images.githubusercontent.com/1430861/83643384-f51c7780-a57d-11ea-9b0a-ab6ee0624afc.png)\r\n\r\n![2020-06-03T093812_683_381](https://user-images.githubusercontent.com/1430861/83643416-fd74b280-a57d-11ea-981d-d1f7da5e2535.png)\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1319/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1319/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1318", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1318/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1318/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1318/events", "html_url": "https://github.com/optuna/optuna/issues/1318", "id": 629780400, "node_id": "MDU6SXNzdWU2Mjk3ODA0MDA=", "number": 1318, "title": "Optimization starts from scratch after switching sampler from TPE to CMA-ES", "user": {"login": "danpolus", "id": 28355894, "node_id": "MDQ6VXNlcjI4MzU1ODk0", "avatar_url": "https://avatars.githubusercontent.com/u/28355894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/danpolus", "html_url": "https://github.com/danpolus", "followers_url": "https://api.github.com/users/danpolus/followers", "following_url": "https://api.github.com/users/danpolus/following{/other_user}", "gists_url": "https://api.github.com/users/danpolus/gists{/gist_id}", "starred_url": "https://api.github.com/users/danpolus/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/danpolus/subscriptions", "organizations_url": "https://api.github.com/users/danpolus/orgs", "repos_url": "https://api.github.com/users/danpolus/repos", "events_url": "https://api.github.com/users/danpolus/events{/privacy}", "received_events_url": "https://api.github.com/users/danpolus/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 15, "created_at": "2020-06-03T07:57:43Z", "updated_at": "2021-03-01T23:22:03Z", "closed_at": "2021-03-01T23:22:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "The following code performs 500 optimization trials with TPE sampler and then another 500 optimization trials with CMA-ES sampler. Sometimes the optimization continues from the same point after the sampler switch and sometimes it starts from scratch. \r\n\r\nsmp = optuna.samplers.TPESampler()\r\nstudy = optuna.create_study(sampler=smp)\r\nstudy.optimize(objective, n_trials=500)\r\nstudy.sampler = optuna.integration.CmaEsSampler()\r\nstudy.optimize(objective, n_trials=500)\r\n\r\n![Figure_1 TPE CMA combined params 2](https://user-images.githubusercontent.com/28355894/83610866-cce64600-a588-11ea-9fe2-ffa7564bbd9e.png)\r\n\r\n## Expected behavior\r\n\r\nI expect the optimization process to take in account the optimization achievements so far, after switching the sampler\r\n\r\n## Environment\r\n\r\n- Optuna version: 1.2.0\r\n- Python version: 3.7\r\n- OS: windows 10\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1318/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1318/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1281", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1281/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1281/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1281/events", "html_url": "https://github.com/optuna/optuna/issues/1281", "id": 624069154, "node_id": "MDU6SXNzdWU2MjQwNjkxNTQ=", "number": 1281, "title": "`experimental` decorator breaks class documentation.", "user": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-05-25T06:06:52Z", "updated_at": "2020-05-28T01:34:06Z", "closed_at": "2020-05-28T01:34:06Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "The `experimental` decorator used on classes break documentation. This could be one manifestation but there is an issue with how the documentation including type hints are propagated to the decorated class. This does not apply for free functions.\r\n\r\nSee https://github.com/optuna/optuna/pull/1265#issuecomment-633195955 for how it may break.\r\n\r\n## Expected behavior\r\n\r\nClass documentation should not be altered by applying the experimental decorator.\r\n\r\n## Steps to reproduce\r\n\r\n1. Apply the experimental decorator to a class.\r\n1. Build the document (`cd docs && make html`) \r\n1. Open the rendered documentation and note that the class signatures is broken.\r\n\r\n## Additional context (optional)\r\n\r\n- An issue regarding the indentation https://github.com/optuna/optuna/issues/1213.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1281/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1281/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1243", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1243/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1243/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1243/events", "html_url": "https://github.com/optuna/optuna/pull/1243", "id": 617999599, "node_id": "MDExOlB1bGxSZXF1ZXN0NDE3ODEwMjA1", "number": 1243, "title": "Fix CMA-ES boundary constraints and initial mean vector of LogUniformDistribution", "user": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/25", "html_url": "https://github.com/optuna/optuna/milestone/25", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/25/labels", "id": 5476490, "node_id": "MDk6TWlsZXN0b25lNTQ3NjQ5MA==", "number": 25, "title": "v2.0.0-rc0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 131, "state": "closed", "created_at": "2020-05-29T04:35:59Z", "updated_at": "2020-07-06T05:37:26Z", "due_on": null, "closed_at": "2020-07-06T05:37:26Z"}, "comments": 4, "created_at": "2020-05-14T07:40:34Z", "updated_at": "2020-06-12T04:28:36Z", "closed_at": "2020-06-12T04:02:11Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1243", "html_url": "https://github.com/optuna/optuna/pull/1243", "diff_url": "https://github.com/optuna/optuna/pull/1243.diff", "patch_url": "https://github.com/optuna/optuna/pull/1243.patch", "merged_at": "2020-06-12T04:02:11Z"}, "body": "<!-- Thank you for creating a pull request! -->\r\n\r\n## Motivation\r\nTo fix #1241.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\ncc: @HideakiImamura.\r\n\r\nThe cause of this bug is the setting of bound constraints. Thank you for reporting.\r\n\r\nBefore:\r\n\r\n```\r\n(venv) $ python examples/cmaes_loguniform.py\r\nRunning 2 trials...\r\n[I 2020-05-14 16:41:41,256] Finished trial#0 with value: 2564.887849352018 with parameters: {'w': 7.0, 'x': 50.158625626096466, 'y': 0, 'z': 0.011164816029172358}. Best is trial#0 with value: 2564.887849352018.\r\n[W 2020-05-14 16:41:41,259] The parameter 'y' in trial#1 is sampled independently by using `RandomSampler` instead of `CmaEsSampler` (optimization performance may be degraded). You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\n[W 2020-05-14 16:41:41,259] The parameter 'z' in trial#1 is sampled independently by using `RandomSampler` instead of `CmaEsSampler` (optimization performance may be degraded). You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\n[I 2020-05-14 16:41:41,292] Finished trial#1 with value: 48.03377381412535 with parameters: {'w': 7.0, 'x': 0.18056587488656362, 'y': -1, 'z': 0.034202031398689305}. Best is trial#1 with value: 48.03377381412535.\r\nBest value: 48.03377381412535 (params: {'w': 7.0, 'x': 0.18056587488656362, 'y': -1, 'z': 0.034202031398689305})\r\n```\r\n\r\n\r\nAfter:\r\n\r\n```\r\n(venv) $ python examples/cmaes_loguniform.py\r\nRunning 2 trials...\r\n[I 2020-05-14 16:41:16,970] Finished trial#0 with value: 7728.181280557202 with parameters: {'w': 7.0, 'x': -87.63519278326524, 'y': -1, 'z': 0.50424834867147}. Best is trial#0 with value: 7728.181280557202.\r\n[W 2020-05-14 16:41:16,973] The parameter 'y' in trial#1 is sampled independently by using `RandomSampler` instead of `CmaEsSampler` (optimization performance may be degraded). You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\n[I 2020-05-14 16:41:17,007] Finished trial#1 with value: 66.02744560919409 with parameters: {'w': 8.0, 'x': -0.7086091946645107, 'y': 1, 'z': 0.7247886715664064}. Best is trial#1 with value: 66.02744560919409.\r\nBest value: 66.02744560919409 (params: {'w': 8.0, 'x': -0.7086091946645107, 'y': 1, 'z': 0.7247886715664064})\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1243/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1243/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1242", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1242/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1242/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1242/events", "html_url": "https://github.com/optuna/optuna/pull/1242", "id": 617959686, "node_id": "MDExOlB1bGxSZXF1ZXN0NDE3Nzc4OTU0", "number": 1242, "title": "Upgrade the Version of `cmaes`.", "user": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/24", "html_url": "https://github.com/optuna/optuna/milestone/24", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/24/labels", "id": 5404286, "node_id": "MDk6TWlsZXN0b25lNTQwNDI4Ng==", "number": 24, "title": "v1.5.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 52, "state": "closed", "created_at": "2020-05-11T06:22:34Z", "updated_at": "2020-06-01T08:42:01Z", "due_on": null, "closed_at": "2020-06-01T08:42:01Z"}, "comments": 0, "created_at": "2020-05-14T06:26:22Z", "updated_at": "2021-05-18T04:38:26Z", "closed_at": "2020-05-14T07:08:02Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1242", "html_url": "https://github.com/optuna/optuna/pull/1242", "diff_url": "https://github.com/optuna/optuna/pull/1242.diff", "patch_url": "https://github.com/optuna/optuna/pull/1242.patch", "merged_at": "2020-05-14T07:08:02Z"}, "body": "## Motivation\r\nThis PR aims to address the problem discussed in PR https://github.com/optuna/optuna/pull/1240#issuecomment-628385348 by upgrading the version of `cmaes` from `0.3.2` to `0.5.0`.\r\n\r\n## Description of the changes\r\nUpgrade `cmaes` from `0.3.2` to `0.5.0`.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1242/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1242/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1241", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1241/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1241/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1241/events", "html_url": "https://github.com/optuna/optuna/issues/1241", "id": 617953432, "node_id": "MDU6SXNzdWU2MTc5NTM0MzI=", "number": 1241, "title": "`CmaEsSampler` uses the independent sampler for `trial.suggest_loguniform`", "user": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-05-14T06:13:24Z", "updated_at": "2020-06-12T04:02:11Z", "closed_at": "2020-06-12T04:02:11Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "In the current implementation, the `optuna.samplers.CmaEsSampler` uses the independent sampler for `trial.suggest_loguniform`. This is not intentional. It should be sampled by CMA-ES algorithm.\r\n\r\n# Environment\r\n\r\n- Optuna version: 1.4.0\r\n- Python version: 3.6.5\r\n- OS: macOS Catalina 10.15.4\r\n\r\n# Code \r\n```python\r\nimport optuna\r\n\r\n# Define a simple 2-dimensional objective function whose minimum value is -1 when (x, y) = (0, -1).\r\ndef objective(trial):\r\n    w = trial.suggest_discrete_uniform(\"w\", 1.0, 10.0, 1.0)\r\n    x = trial.suggest_uniform(\"x\", -100, 100)\r\n    y = trial.suggest_categorical(\"y\", [-1, 0, 1])\r\n    z = trial.suggest_loguniform(\"z\", 0.01, 1.0)\r\n    return w ** 2 + x ** 2 + y + z ** 2\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    # Let us minimize the objective function above.\r\n    sampler = optuna.samplers.CmaEsSampler(n_startup_trials=1)\r\n    print(\"Running 2 trials...\")\r\n    study = optuna.study.create_study(sampler=sampler)\r\n    study.optimize(objective, n_trials=2)\r\n    print(\"Best value: {} (params: {})\\n\".format(study.best_value, study.best_params))\r\n```\r\n\r\n# Result\r\n```\r\n$ python test.py \r\npython3.6/site-packages/pandas/compat/__init__.py:117: UserWarning: Could not import the lzma module. Your installed Python is incomplete. Attempting to use lzma compression will result in a RuntimeError.\r\n  warnings.warn(msg)\r\nRunning 2 trials...\r\n[I 2020-05-14 15:12:08,382] Finished trial#0 with value: 729.7092383151211 with parameters: {'w': 8.0, 'x': 25.807829185276148, 'y': -1, 'z': 0.8155924587254163}. Best is trial#0 with value: 729.7092383151211.\r\n[W 2020-05-14 15:12:08,384] The parameter 'y' in trial#1 is sampled independently by using `RandomSampler` instead of `CmaEsSampler` (optimization performance may be degraded). You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\n[W 2020-05-14 15:12:08,385] The parameter 'z' in trial#1 is sampled independently by using `RandomSampler` instead of `CmaEsSampler` (optimization performance may be degraded). You can suppress this warning by setting `warn_independent_sampling` to `False` in the constructor of `CmaEsSampler`, if this independent sampling is intended behavior.\r\n[I 2020-05-14 15:12:08,442] Finished trial#1 with value: 65.0908323918039 with parameters: {'w': 8.0, 'x': -1.0440794535810325, 'y': 0, 'z': 0.027027512165087225}. Best is trial#1 with value: 65.0908323918039.\r\nBest value: 65.0908323918039 (params: {'w': 8.0, 'x': -1.0440794535810325, 'y': 0, 'z': 0.027027512165087225})\r\n\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1241/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1241/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1240", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1240/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1240/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1240/events", "html_url": "https://github.com/optuna/optuna/pull/1240", "id": 617914879, "node_id": "MDExOlB1bGxSZXF1ZXN0NDE3NzQzMTU2", "number": 1240, "title": "Fix a type casting error when using `CmaEsSampler`.", "user": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/24", "html_url": "https://github.com/optuna/optuna/milestone/24", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/24/labels", "id": 5404286, "node_id": "MDk6TWlsZXN0b25lNTQwNDI4Ng==", "number": 24, "title": "v1.5.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 52, "state": "closed", "created_at": "2020-05-11T06:22:34Z", "updated_at": "2020-06-01T08:42:01Z", "due_on": null, "closed_at": "2020-06-01T08:42:01Z"}, "comments": 9, "created_at": "2020-05-14T04:28:56Z", "updated_at": "2020-05-14T06:03:26Z", "closed_at": "2020-05-14T06:03:23Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1240", "html_url": "https://github.com/optuna/optuna/pull/1240", "diff_url": "https://github.com/optuna/optuna/pull/1240.diff", "patch_url": "https://github.com/optuna/optuna/pull/1240.patch", "merged_at": "2020-05-14T06:03:23Z"}, "body": "This PR fixes the following error that was occurred when I run a `CmaEsSampler` benchmark:\r\n```console\r\n$ kurobako --version\r\nkurobako 0.1.14\r\n\r\n$ wget $(kurobako dataset hpobench URL) && tar zxvf fcnet_tabular_benchmarks.tar.gz\r\n$ kurobako problem-suite hpobench fcnet fcnet_tabular_benchmarks/ > problems.json\r\n$ kurobako solver optuna --sampler cma-es > solvers.json\r\n\r\n$ kurobako studies --problems (cat problems.json) --solvers (cat solvers.json) | kurobako run -q > result.json\r\n  File \"/home/ohta/.local/lib/python3.7/site-packages/kurobako/solver/__init__.py\", line 172, in run\r\n    while self._run_once():\r\n  File \"/home/ohta/.local/lib/python3.7/site-packages/kurobako/solver/__init__.py\", line 186, in _run_once\r\n    self._handle_ask_call(message)\r\n  File \"/home/ohta/.local/lib/python3.7/site-packages/kurobako/solver/__init__.py\", line 214, in _handle_ask_call\r\n    trial = solver.ask(idg)\r\n  File \"/home/ohta/.local/lib/python3.7/site-packages/kurobako/solver/optuna.py\", line 86, in ask\r\n    trial = self._create_new_trial()\r\n  File \"/home/ohta/.local/lib/python3.7/site-packages/kurobako/solver/optuna.py\", line 172, in _create_new_trial\r\n    return optuna.trial.Trial(self._study, trial_id)\r\n  File \"/home/ohta/dev/python/optuna/optuna/trial.py\", line 409, in __init__\r\n    self._init_relative_params()\r\n  File \"/home/ohta/dev/python/optuna/optuna/trial.py\", line 420, in _init_relative_params\r\n    self.study, trial, self.relative_search_space\r\n  File \"/home/ohta/dev/python/optuna/optuna/samplers/cmaes.py\", line 201, in sample_relative\r\n    optimizer.tell(solutions)\r\n  File \"/home/ohta/.local/lib/python3.7/site-packages/cmaes/cma.py\", line 265, in tell\r\n    self._mean += self._cm * self._sigma * y_w\r\nnumpy.core._exceptions.UFuncTypeError: Cannot cast ufunc 'add' output from dtype('float64') to dtype('int64') with casting rule 'same_kind'\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1240/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1240/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1236", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1236/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1236/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1236/events", "html_url": "https://github.com/optuna/optuna/pull/1236", "id": 616975980, "node_id": "MDExOlB1bGxSZXF1ZXN0NDE2OTgyOTI3", "number": 1236, "title": "Fix `sklearn` - `skopt` version incompatibility.", "user": {"login": "ytsmiling", "id": 20983513, "node_id": "MDQ6VXNlcjIwOTgzNTEz", "avatar_url": "https://avatars.githubusercontent.com/u/20983513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ytsmiling", "html_url": "https://github.com/ytsmiling", "followers_url": "https://api.github.com/users/ytsmiling/followers", "following_url": "https://api.github.com/users/ytsmiling/following{/other_user}", "gists_url": "https://api.github.com/users/ytsmiling/gists{/gist_id}", "starred_url": "https://api.github.com/users/ytsmiling/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ytsmiling/subscriptions", "organizations_url": "https://api.github.com/users/ytsmiling/orgs", "repos_url": "https://api.github.com/users/ytsmiling/repos", "events_url": "https://api.github.com/users/ytsmiling/events{/privacy}", "received_events_url": "https://api.github.com/users/ytsmiling/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1157559138, "node_id": "MDU6TGFiZWwxMTU3NTU5MTM4", "url": "https://api.github.com/repos/optuna/optuna/labels/test", "name": "test", "color": "ffcce1", "default": false, "description": "Unit test."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/24", "html_url": "https://github.com/optuna/optuna/milestone/24", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/24/labels", "id": 5404286, "node_id": "MDk6TWlsZXN0b25lNTQwNDI4Ng==", "number": 24, "title": "v1.5.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 52, "state": "closed", "created_at": "2020-05-11T06:22:34Z", "updated_at": "2020-06-01T08:42:01Z", "due_on": null, "closed_at": "2020-06-01T08:42:01Z"}, "comments": 1, "created_at": "2020-05-12T21:34:55Z", "updated_at": "2020-05-12T22:26:58Z", "closed_at": "2020-05-12T22:26:58Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1236", "html_url": "https://github.com/optuna/optuna/pull/1236", "diff_url": "https://github.com/optuna/optuna/pull/1236.diff", "patch_url": "https://github.com/optuna/optuna/pull/1236.patch", "merged_at": "2020-05-12T22:26:58Z"}, "body": "## Motivation\r\nThis PR fixes #1235.\r\n\r\n## Description of the changes\r\nAdd version retriction to scikit-learn (scikit-learn<0.23.0).", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1236/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1236/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1235", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1235/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1235/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1235/events", "html_url": "https://github.com/optuna/optuna/issues/1235", "id": 616962516, "node_id": "MDU6SXNzdWU2MTY5NjI1MTY=", "number": 1235, "title": "`sklearn`-`skopt` version incompatibility causes doctest failure.", "user": {"login": "ytsmiling", "id": 20983513, "node_id": "MDQ6VXNlcjIwOTgzNTEz", "avatar_url": "https://avatars.githubusercontent.com/u/20983513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ytsmiling", "html_url": "https://github.com/ytsmiling", "followers_url": "https://api.github.com/users/ytsmiling/followers", "following_url": "https://api.github.com/users/ytsmiling/following{/other_user}", "gists_url": "https://api.github.com/users/ytsmiling/gists{/gist_id}", "starred_url": "https://api.github.com/users/ytsmiling/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ytsmiling/subscriptions", "organizations_url": "https://api.github.com/users/ytsmiling/orgs", "repos_url": "https://api.github.com/users/ytsmiling/repos", "events_url": "https://api.github.com/users/ytsmiling/events{/privacy}", "received_events_url": "https://api.github.com/users/ytsmiling/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-05-12T21:10:44Z", "updated_at": "2020-05-12T22:26:58Z", "closed_at": "2020-05-12T22:26:58Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "## Expected behavior\r\n\r\nThe following test should succeed.\r\n```bash\r\ncircleci build --job doctest\r\n```\r\n\r\n## Environment\r\n\r\nPlease refer `.circleci/config.yml` and `setup.py`.\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n    ImportError: Scikit-Optimize is not available. Please install it to use this feature. Scikit-Optimize can be installed by executing `$ pip install scikit-optimize`. For further information, please refer to the installation guide of Scikit-Optimize. (The actual import error is as follows: cannot import name 'MaskedArray' from 'sklearn.utils.fixes' (/home/docs/project/venv/lib/python3.8/site-packages/sklearn/utils/fixes.py))\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. ```pip install scikit-learn==0.23.0```\r\n2. ```pip install scikit-optimize```\r\n3. ```python -c \"import skopt\"```\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1235/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1235/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1231", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1231/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1231/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1231/events", "html_url": "https://github.com/optuna/optuna/pull/1231", "id": 615941563, "node_id": "MDExOlB1bGxSZXF1ZXN0NDE2MTUxMzUw", "number": 1231, "title": "Fix out of bounds error of CMA-ES.", "user": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947561773, "node_id": "MDU6TGFiZWwxOTQ3NTYxNzcz", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.samplers", "name": "optuna.samplers", "color": "1c659e", "default": false, "description": "Related to the `optuna.samplers` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/24", "html_url": "https://github.com/optuna/optuna/milestone/24", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/24/labels", "id": 5404286, "node_id": "MDk6TWlsZXN0b25lNTQwNDI4Ng==", "number": 24, "title": "v1.5.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 52, "state": "closed", "created_at": "2020-05-11T06:22:34Z", "updated_at": "2020-06-01T08:42:01Z", "due_on": null, "closed_at": "2020-06-01T08:42:01Z"}, "comments": 1, "created_at": "2020-05-11T14:44:48Z", "updated_at": "2020-05-12T04:11:07Z", "closed_at": "2020-05-12T02:00:30Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1231", "html_url": "https://github.com/optuna/optuna/pull/1231", "diff_url": "https://github.com/optuna/optuna/pull/1231.diff", "patch_url": "https://github.com/optuna/optuna/pull/1231.patch", "merged_at": "2020-05-12T02:00:30Z"}, "body": "<!-- Thank you for creating a pull request! -->\r\n\r\n## Motivation\r\nTo fix #1230.\r\n\r\n## Description of the changes\r\n\r\nI couldn't reproduce the bug on my environment:\r\n\r\n* OS: macOS Catalina (10.15.4)\r\n* Python version: 3.8.2\r\n* numpy version: 1.18.1\r\n\r\nBut `high` argument of `randint()` method seems to be binded to int32. `2 ** 32` obviously out of the range.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1231/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1231/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1230", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1230/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1230/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1230/events", "html_url": "https://github.com/optuna/optuna/issues/1230", "id": 615910552, "node_id": "MDU6SXNzdWU2MTU5MTA1NTI=", "number": 1230, "title": "Out of bounds error when using CmaEsSampler", "user": {"login": "CristianMonea", "id": 60966501, "node_id": "MDQ6VXNlcjYwOTY2NTAx", "avatar_url": "https://avatars.githubusercontent.com/u/60966501?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CristianMonea", "html_url": "https://github.com/CristianMonea", "followers_url": "https://api.github.com/users/CristianMonea/followers", "following_url": "https://api.github.com/users/CristianMonea/following{/other_user}", "gists_url": "https://api.github.com/users/CristianMonea/gists{/gist_id}", "starred_url": "https://api.github.com/users/CristianMonea/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CristianMonea/subscriptions", "organizations_url": "https://api.github.com/users/CristianMonea/orgs", "repos_url": "https://api.github.com/users/CristianMonea/repos", "events_url": "https://api.github.com/users/CristianMonea/events{/privacy}", "received_events_url": "https://api.github.com/users/CristianMonea/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-05-11T14:03:25Z", "updated_at": "2020-05-12T02:00:30Z", "closed_at": "2020-05-12T02:00:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "I cannot run the sample code for the CME-ES algorithm provided [here](https://optuna.readthedocs.io/en/stable/reference/samplers.html). It runs for one trial and then it outputs an out of bounds error.\r\n\r\n## Expected behavior\r\n\r\nTo perform optimization of the given objective function using the CMA-ES algorithm.\r\n\r\n## Environment\r\n\r\n- Optuna version: 1.4.0\r\n- Python version: 3.6.8\r\n- OS: Windows 10 x64\r\n- Other libraries and their versions: conda 4.8.2\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nTraceback (most recent call last):\r\n\r\n  File \"C:\\Users\\User\\work\\untitled0.py\", line 10, in <module>\r\n    study.optimize(objective, n_trials=20)\r\n\r\n  File \"C:\\Users\\User\\Anaconda3\\envs\\base_clone\\lib\\site-packages\\optuna\\study.py\", line 334, in optimize\r\n    func, n_trials, timeout, catch, callbacks, gc_after_trial, None\r\n\r\n  File \"C:\\Users\\User\\Anaconda3\\envs\\base_clone\\lib\\site-packages\\optuna\\study.py\", line 648, in _optimize_sequential\r\n    self._run_trial_and_callbacks(func, catch, callbacks, gc_after_trial)\r\n\r\n  File \"C:\\Users\\User\\Anaconda3\\envs\\base_clone\\lib\\site-packages\\optuna\\study.py\", line 678, in _run_trial_and_callbacks\r\n    trial = self._run_trial(func, catch, gc_after_trial)\r\n\r\n  File \"C:\\Users\\User\\Anaconda3\\envs\\base_clone\\lib\\site-packages\\optuna\\study.py\", line 695, in _run_trial\r\n    trial = trial_module.Trial(self, trial_id)\r\n\r\n  File \"C:\\Users\\User\\Anaconda3\\envs\\base_clone\\lib\\site-packages\\optuna\\trial.py\", line 409, in __init__\r\n    self._init_relative_params()\r\n\r\n  File \"C:\\Users\\User\\Anaconda3\\envs\\base_clone\\lib\\site-packages\\optuna\\trial.py\", line 420, in _init_relative_params\r\n    self.study, trial, self.relative_search_space\r\n\r\n  File \"C:\\Users\\User\\Anaconda3\\envs\\base_clone\\lib\\site-packages\\optuna\\samplers\\cmaes.py\", line 175, in sample_relative\r\n    optimizer = self._restore_or_init_optimizer(completed_trials, search_space, ordered_keys)\r\n\r\n  File \"C:\\Users\\User\\Anaconda3\\envs\\base_clone\\lib\\site-packages\\optuna\\samplers\\cmaes.py\", line 251, in _restore_or_init_optimizer\r\n    seed=self._cma_rng.randint(1, 2 ** 32),\r\n\r\n  File \"mtrand.pyx\", line 745, in numpy.random.mtrand.RandomState.randint\r\n\r\n  File \"_bounded_integers.pyx\", line 1360, in numpy.random._bounded_integers._rand_int32\r\n\r\nValueError: high is out of bounds for int32\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Run the code provided below.\r\n\r\n## Reproducible examples\r\n\r\n```python\r\nimport optuna\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_uniform('x', -1, 1)\r\n    y = trial.suggest_int('y', -1, 1)\r\n    return x ** 2 + y\r\n\r\nsampler = optuna.samplers.CmaEsSampler()\r\nstudy = optuna.create_study(sampler=sampler)\r\nstudy.optimize(objective, n_trials=20)\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1230/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1230/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1228", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1228/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1228/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1228/events", "html_url": "https://github.com/optuna/optuna/pull/1228", "id": 615773323, "node_id": "MDExOlB1bGxSZXF1ZXN0NDE2MDEyNzA5", "number": 1228, "title": "Support multiple studies in `InMemoryStorage`.", "user": {"login": "ytsmiling", "id": 20983513, "node_id": "MDQ6VXNlcjIwOTgzNTEz", "avatar_url": "https://avatars.githubusercontent.com/u/20983513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ytsmiling", "html_url": "https://github.com/ytsmiling", "followers_url": "https://api.github.com/users/ytsmiling/followers", "following_url": "https://api.github.com/users/ytsmiling/following{/other_user}", "gists_url": "https://api.github.com/users/ytsmiling/gists{/gist_id}", "starred_url": "https://api.github.com/users/ytsmiling/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ytsmiling/subscriptions", "organizations_url": "https://api.github.com/users/ytsmiling/orgs", "repos_url": "https://api.github.com/users/ytsmiling/repos", "events_url": "https://api.github.com/users/ytsmiling/events{/privacy}", "received_events_url": "https://api.github.com/users/ytsmiling/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/24", "html_url": "https://github.com/optuna/optuna/milestone/24", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/24/labels", "id": 5404286, "node_id": "MDk6TWlsZXN0b25lNTQwNDI4Ng==", "number": 24, "title": "v1.5.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 52, "state": "closed", "created_at": "2020-05-11T06:22:34Z", "updated_at": "2020-06-01T08:42:01Z", "due_on": null, "closed_at": "2020-06-01T08:42:01Z"}, "comments": 6, "created_at": "2020-05-11T10:26:44Z", "updated_at": "2020-05-12T15:42:42Z", "closed_at": "2020-05-12T15:42:42Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1228", "html_url": "https://github.com/optuna/optuna/pull/1228", "diff_url": "https://github.com/optuna/optuna/pull/1228.diff", "patch_url": "https://github.com/optuna/optuna/pull/1228.patch", "merged_at": "2020-05-12T15:42:42Z"}, "body": "## Motivation\r\nThis PR adds multi-study support to in-memory storage.\r\nThis partially addresses #1170 and relates to #1191.\r\n\r\n## Description of the changes\r\nAdd multi-study support to in-memory db.\r\n\r\n## Other notes\r\nI checked that this passes tests in #1191 in python3.5.\r\n\r\nUpdate:\r\n- In this PR, in-memory storage raises ValueError instead of KeyError to pass deprecated tests, which will be fixed in #1191.\r\n- This PR removes some deprecated tests which will be completely removed or replaced by #1191.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1228/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1228/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1224", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1224/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1224/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1224/events", "html_url": "https://github.com/optuna/optuna/issues/1224", "id": 615023614, "node_id": "MDU6SXNzdWU2MTUwMjM2MTQ=", "number": 1224, "title": "OOM with pytorch after a few trials initialized.", "user": {"login": "diff7", "id": 34035501, "node_id": "MDQ6VXNlcjM0MDM1NTAx", "avatar_url": "https://avatars.githubusercontent.com/u/34035501?v=4", "gravatar_id": "", "url": "https://api.github.com/users/diff7", "html_url": "https://github.com/diff7", "followers_url": "https://api.github.com/users/diff7/followers", "following_url": "https://api.github.com/users/diff7/following{/other_user}", "gists_url": "https://api.github.com/users/diff7/gists{/gist_id}", "starred_url": "https://api.github.com/users/diff7/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/diff7/subscriptions", "organizations_url": "https://api.github.com/users/diff7/orgs", "repos_url": "https://api.github.com/users/diff7/repos", "events_url": "https://api.github.com/users/diff7/events{/privacy}", "received_events_url": "https://api.github.com/users/diff7/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-05-08T22:43:27Z", "updated_at": "2022-02-08T03:35:07Z", "closed_at": "2020-05-08T22:45:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "Setting status of trial#28 as TrialState.FAIL because of the following error: RuntimeError('CUDA out of memory. Tried to allocate 88.00 MiB (GPU 0; 10.76 GiB total capacity; 9.77 GiB already allocated; 9.25 MiB free; 9.67 MiB cached)',)\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1224/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1224/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1213", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1213/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1213/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1213/events", "html_url": "https://github.com/optuna/optuna/issues/1213", "id": 613779850, "node_id": "MDU6SXNzdWU2MTM3Nzk4NTA=", "number": 1213, "title": "`experimental` decorator adds extra indents to docs", "user": {"login": "g-votte", "id": 1061922, "node_id": "MDQ6VXNlcjEwNjE5MjI=", "avatar_url": "https://avatars.githubusercontent.com/u/1061922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/g-votte", "html_url": "https://github.com/g-votte", "followers_url": "https://api.github.com/users/g-votte/followers", "following_url": "https://api.github.com/users/g-votte/following{/other_user}", "gists_url": "https://api.github.com/users/g-votte/gists{/gist_id}", "starred_url": "https://api.github.com/users/g-votte/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/g-votte/subscriptions", "organizations_url": "https://api.github.com/users/g-votte/orgs", "repos_url": "https://api.github.com/users/g-votte/repos", "events_url": "https://api.github.com/users/g-votte/events{/privacy}", "received_events_url": "https://api.github.com/users/g-votte/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-05-07T05:20:22Z", "updated_at": "2020-06-05T14:45:30Z", "closed_at": "2020-06-05T14:45:30Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "An extra indent appears in the docs when the [`experimental`](https://github.com/optuna/optuna/blob/2d5f24b06eed56ece72b8dfa878135bb4bb63779/optuna/_experimental.py#L60) decorator is added to a method of a class. This does not happen with a top level (i.e., not nested) class or function.\r\n\r\n## Steps to reproduce\r\n\r\n1. add an `experimental` decorator to a method of a class\r\n2. make the document\r\n\r\n## Reproducible examples\r\nThe following figure shows the docs of [`Study.enqueue_trial`](https://optuna.readthedocs.io/en/latest/reference/study.html#optuna.study.Study.enqueue_trial). An extra indent appears after the second paragraph.\r\n\r\n![image](https://user-images.githubusercontent.com/1061922/81144389-e6f32f80-8fae-11ea-8dd2-33368293dafa.png)\r\n\r\n## Expected behavior\r\nno extra indent is shown after the second paragraph\r\n\r\nFor example, the docs of [`Study.get_trials`](https://optuna.readthedocs.io/en/latest/reference/study.html#optuna.study.Study.get_trials), which does not have the `experimental` decorator, appears as expected.\r\n\r\n![image](https://user-images.githubusercontent.com/1061922/81143489-f1142e80-8fac-11ea-9896-e56086228168.png)\r\n\r\nThe following figure shows another example. The docs of the [`train`](https://optuna.readthedocs.io/en/latest/reference/integration.html#optuna.integration.lightgbm.train) function of LightGBMTuner has no extra indent. Although the function has an `experimental` decorator, it belongs to the top level classes.\r\n\r\n![image](https://user-images.githubusercontent.com/1061922/81146606-98945f80-8fb3-11ea-8d67-5cf1cfbf8768.png)\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1213/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1213/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1209", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1209/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1209/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1209/events", "html_url": "https://github.com/optuna/optuna/pull/1209", "id": 613234162, "node_id": "MDExOlB1bGxSZXF1ZXN0NDE0MDI2NjI3", "number": 1209, "title": "Fix a bug that occurs when multiple callbacks are passed to `MultiObjectiveStudy.optimize`.", "user": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, {"login": "ytsmiling", "id": 20983513, "node_id": "MDQ6VXNlcjIwOTgzNTEz", "avatar_url": "https://avatars.githubusercontent.com/u/20983513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ytsmiling", "html_url": "https://github.com/ytsmiling", "followers_url": "https://api.github.com/users/ytsmiling/followers", "following_url": "https://api.github.com/users/ytsmiling/following{/other_user}", "gists_url": "https://api.github.com/users/ytsmiling/gists{/gist_id}", "starred_url": "https://api.github.com/users/ytsmiling/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ytsmiling/subscriptions", "organizations_url": "https://api.github.com/users/ytsmiling/orgs", "repos_url": "https://api.github.com/users/ytsmiling/repos", "events_url": "https://api.github.com/users/ytsmiling/events{/privacy}", "received_events_url": "https://api.github.com/users/ytsmiling/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/23", "html_url": "https://github.com/optuna/optuna/milestone/23", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/23/labels", "id": 5264564, "node_id": "MDk6TWlsZXN0b25lNTI2NDU2NA==", "number": 23, "title": "v1.4.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 91, "state": "closed", "created_at": "2020-04-02T01:56:00Z", "updated_at": "2020-05-11T08:49:35Z", "due_on": null, "closed_at": "2020-05-11T08:49:35Z"}, "comments": 3, "created_at": "2020-05-06T11:04:13Z", "updated_at": "2020-05-11T01:56:55Z", "closed_at": "2020-05-11T01:56:55Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1209", "html_url": "https://github.com/optuna/optuna/pull/1209", "diff_url": "https://github.com/optuna/optuna/pull/1209.diff", "patch_url": "https://github.com/optuna/optuna/pull/1209.patch", "merged_at": "2020-05-11T01:56:55Z"}, "body": "Fix #1207", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1209/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1209/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1208", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1208/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1208/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1208/events", "html_url": "https://github.com/optuna/optuna/pull/1208", "id": 613054861, "node_id": "MDExOlB1bGxSZXF1ZXN0NDEzODgxMzA2", "number": 1208, "title": "Raise `ValueError` that is not raised", "user": {"login": "harupy", "id": 17039389, "node_id": "MDQ6VXNlcjE3MDM5Mzg5", "avatar_url": "https://avatars.githubusercontent.com/u/17039389?v=4", "gravatar_id": "", "url": "https://api.github.com/users/harupy", "html_url": "https://github.com/harupy", "followers_url": "https://api.github.com/users/harupy/followers", "following_url": "https://api.github.com/users/harupy/following{/other_user}", "gists_url": "https://api.github.com/users/harupy/gists{/gist_id}", "starred_url": "https://api.github.com/users/harupy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/harupy/subscriptions", "organizations_url": "https://api.github.com/users/harupy/orgs", "repos_url": "https://api.github.com/users/harupy/repos", "events_url": "https://api.github.com/users/harupy/events{/privacy}", "received_events_url": "https://api.github.com/users/harupy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/23", "html_url": "https://github.com/optuna/optuna/milestone/23", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/23/labels", "id": 5264564, "node_id": "MDk6TWlsZXN0b25lNTI2NDU2NA==", "number": 23, "title": "v1.4.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 91, "state": "closed", "created_at": "2020-04-02T01:56:00Z", "updated_at": "2020-05-11T08:49:35Z", "due_on": null, "closed_at": "2020-05-11T08:49:35Z"}, "comments": 0, "created_at": "2020-05-06T05:12:14Z", "updated_at": "2020-05-07T02:28:51Z", "closed_at": "2020-05-07T01:59:55Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1208", "html_url": "https://github.com/optuna/optuna/pull/1208", "diff_url": "https://github.com/optuna/optuna/pull/1208.diff", "patch_url": "https://github.com/optuna/optuna/pull/1208.patch", "merged_at": "2020-05-07T01:59:55Z"}, "body": "<!-- Thank you for creating a pull request! -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\nJust instantiating `ValueError` does nothing. It needs to be raised.\r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\n- Raise `ValueError`.\r\n- Fix the test which currently catches a different `ValueError`.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1208/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1208/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1207", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1207/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1207/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1207/events", "html_url": "https://github.com/optuna/optuna/issues/1207", "id": 613043511, "node_id": "MDU6SXNzdWU2MTMwNDM1MTE=", "number": 1207, "title": "Bug when passing multiple callbacks to `MultiObjectiveStudy.optimize`", "user": {"login": "harupy", "id": 17039389, "node_id": "MDQ6VXNlcjE3MDM5Mzg5", "avatar_url": "https://avatars.githubusercontent.com/u/17039389?v=4", "gravatar_id": "", "url": "https://api.github.com/users/harupy", "html_url": "https://github.com/harupy", "followers_url": "https://api.github.com/users/harupy/followers", "following_url": "https://api.github.com/users/harupy/following{/other_user}", "gists_url": "https://api.github.com/users/harupy/gists{/gist_id}", "starred_url": "https://api.github.com/users/harupy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/harupy/subscriptions", "organizations_url": "https://api.github.com/users/harupy/orgs", "repos_url": "https://api.github.com/users/harupy/repos", "events_url": "https://api.github.com/users/harupy/events{/privacy}", "received_events_url": "https://api.github.com/users/harupy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-05-06T04:35:11Z", "updated_at": "2020-05-11T01:56:55Z", "closed_at": "2020-05-11T01:56:55Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\nWhen passing multiple callbacks to `MultiObjectiveStudy.optimize`, it uses only the last callback.\r\n\r\n```python\r\nimport optuna\r\n\r\n\r\nn_objectives = 2\r\ndirections = [\"minimize\" for _ in range(n_objectives)]\r\nstudy = optuna.multi_objective.create_study(directions)\r\n\r\n\r\ndef objective(trial):\r\n    return [trial.suggest_uniform(\"v{}\".format(i), 0, 5) for i in range(n_objectives)]\r\n\r\n\r\ncallbacks = [\r\n    lambda a, b: print(\"first callback\"),\r\n    lambda a, b: print(\"second callback\"),\r\n]\r\n\r\nstudy.optimize(objective, n_trials=10, callbacks=callbacks)\r\n```\r\n\r\nThis code outputs:\r\n\r\n```\r\n[I 2020-05-06 12:56:02,205] Finished trial#0 with values: [0.030503339013888686, 0.457606610954287] with parameters: {'v0': 0.030503339013888686, 'v1': 0.457606610954287}.\r\nsecond callback\r\nsecond callback\r\n[I 2020-05-06 12:56:02,243] Finished trial#1 with values: [3.7186248349736672, 1.8148814699741478] with parameters: {'v0': 3.7186248349736672, 'v1': 1.8148814699741478}.\r\nsecond callback\r\nsecond callback\r\n[I 2020-05-06 12:56:02,283] Finished trial#2 with values: [4.386752523520264, 1.180154220379264] with parameters: {'v0': 4.386752523520264, 'v1': 1.180154220379264}.\r\nsecond callback\r\nsecond callback\r\n...\r\n```\r\n\r\nColab notebook that reproduces this bug:\r\nhttps://colab.research.google.com/drive/1YeT8ItU9IO65wXsqY9k-_ATCrCBW0BRZ?usp=sharing\r\n\r\n\r\n## Expected behavior\r\n\r\nThe output is expected to be:\r\n\r\n```\r\n[I 2020-05-06 12:56:02,205] Finished trial#0 with values: [0.030503339013888686, 0.457606610954287] with parameters: {'v0': 0.030503339013888686, 'v1': 0.457606610954287}.\r\nfirst callback\r\nsecond callback\r\n[I 2020-05-06 12:56:02,243] Finished trial#1 with values: [3.7186248349736672, 1.8148814699741478] with parameters: {'v0': 3.7186248349736672, 'v1': 1.8148814699741478}.\r\nfirst callback\r\nsecond callback\r\n[I 2020-05-06 12:56:02,283] Finished trial#2 with values: [4.386752523520264, 1.180154220379264] with parameters: {'v0': 4.386752523520264, 'v1': 1.180154220379264}.\r\nfirst callback\r\nsecond callback\r\n...\r\n```\r\n## Environment\r\n\r\n- Optuna version: master branch\r\n- Python version: 3.6.9\r\n- OS: linux\r\n- (Optional) Other libraries and their versions:\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n# error messages, stack traces, or logs\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1.\r\n2.\r\n3.\r\n\r\n## Reproducible examples (optional)\r\n\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n\r\nI found this bug on https://lgtm.com/projects/g/optuna/optuna/?mode=list", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1207/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1207/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1199", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1199/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1199/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1199/events", "html_url": "https://github.com/optuna/optuna/issues/1199", "id": 611194702, "node_id": "MDU6SXNzdWU2MTExOTQ3MDI=", "number": 1199, "title": "get_param_importances(study) returns random values each call", "user": {"login": "zxweed", "id": 16319433, "node_id": "MDQ6VXNlcjE2MzE5NDMz", "avatar_url": "https://avatars.githubusercontent.com/u/16319433?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zxweed", "html_url": "https://github.com/zxweed", "followers_url": "https://api.github.com/users/zxweed/followers", "following_url": "https://api.github.com/users/zxweed/following{/other_user}", "gists_url": "https://api.github.com/users/zxweed/gists{/gist_id}", "starred_url": "https://api.github.com/users/zxweed/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zxweed/subscriptions", "organizations_url": "https://api.github.com/users/zxweed/orgs", "repos_url": "https://api.github.com/users/zxweed/repos", "events_url": "https://api.github.com/users/zxweed/events{/privacy}", "received_events_url": "https://api.github.com/users/zxweed/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 2107128673, "node_id": "MDU6TGFiZWwyMTA3MTI4Njcz", "url": "https://api.github.com/repos/optuna/optuna/labels/no-stale", "name": "no-stale", "color": "BBBBBB", "default": false, "description": "Exempt from stale bot"}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-05-02T13:50:34Z", "updated_at": "2020-07-15T03:05:32Z", "closed_at": "2020-07-15T03:05:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "After finished study.optimize call to `get_param_importances` returns different (and seems to be random) values each call.\r\n\r\n## Expected behavior\r\nThe values of importances must be the same.\r\n\r\n## Environment\r\n- Optuna version: 1.3.0\r\n- Python version: 3.7.5\r\n- OS: ubuntu 19.10\r\n\r\n## Reproducible examples (based on examples/sklearn_simple.py)\r\n```import sklearn.datasets\r\nimport sklearn.ensemble\r\nimport sklearn.model_selection\r\nimport sklearn.svm\r\nimport optuna\r\n\r\niris = sklearn.datasets.load_iris()\r\nx, y = iris.data, iris.target\r\n\r\ndef objective(trial):\r\n    classifier = trial.suggest_categorical(\"classifier\", [\"SVC\", \"RandomForest\"]),\r\n    value = trial.suggest_loguniform(\"value\", 2, 100)\r\n        \r\n    if classifier == \"SVC\":\r\n        svc_c = value\r\n        classifier_obj = sklearn.svm.SVC(C=svc_c, gamma=\"auto\")\r\n        \r\n    else:\r\n        rf_max_depth = int(value)\r\n        classifier_obj = sklearn.ensemble.RandomForestClassifier(max_depth=rf_max_depth, n_estimators=10)\r\n\r\n    score = sklearn.model_selection.cross_val_score(classifier_obj, x, y, n_jobs=16, cv=3)\r\n    accuracy = score.mean()\r\n    return accuracy\r\n\r\nif __name__ == \"__main__\":\r\n    study = optuna.create_study(direction=\"maximize\")\r\n    study.optimize(objective, n_trials=100, show_progress_bar=True)\r\n    print(study.best_trial)\r\n\r\n    # this calls must return same values each time\r\n    print (optuna.importance.get_param_importances(study))\r\n    print (optuna.importance.get_param_importances(study))\r\n```\r\nOrderedDict([('value', 0.7264216630695697), ('classifier', 0.2735783369304302)])\r\nOrderedDict([('value', 0.5280329436543916), ('classifier', 0.47196705634560837)])\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1199/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1199/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1191", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1191/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1191/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1191/events", "html_url": "https://github.com/optuna/optuna/pull/1191", "id": 609575133, "node_id": "MDExOlB1bGxSZXF1ZXN0NDExMTMzMTE0", "number": 1191, "title": "Increase test coverage of storage tests for single worker cases.", "user": {"login": "ytsmiling", "id": 20983513, "node_id": "MDQ6VXNlcjIwOTgzNTEz", "avatar_url": "https://avatars.githubusercontent.com/u/20983513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ytsmiling", "html_url": "https://github.com/ytsmiling", "followers_url": "https://api.github.com/users/ytsmiling/followers", "following_url": "https://api.github.com/users/ytsmiling/following{/other_user}", "gists_url": "https://api.github.com/users/ytsmiling/gists{/gist_id}", "starred_url": "https://api.github.com/users/ytsmiling/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ytsmiling/subscriptions", "organizations_url": "https://api.github.com/users/ytsmiling/orgs", "repos_url": "https://api.github.com/users/ytsmiling/repos", "events_url": "https://api.github.com/users/ytsmiling/events{/privacy}", "received_events_url": "https://api.github.com/users/ytsmiling/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1157559138, "node_id": "MDU6TGFiZWwxMTU3NTU5MTM4", "url": "https://api.github.com/repos/optuna/optuna/labels/test", "name": "test", "color": "ffcce1", "default": false, "description": "Unit test."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}, {"id": 1947562439, "node_id": "MDU6TGFiZWwxOTQ3NTYyNDM5", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.study", "name": "optuna.study", "color": "1c659e", "default": false, "description": "Related to the `optuna.study` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/24", "html_url": "https://github.com/optuna/optuna/milestone/24", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/24/labels", "id": 5404286, "node_id": "MDk6TWlsZXN0b25lNTQwNDI4Ng==", "number": 24, "title": "v1.5.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 52, "state": "closed", "created_at": "2020-05-11T06:22:34Z", "updated_at": "2020-06-01T08:42:01Z", "due_on": null, "closed_at": "2020-06-01T08:42:01Z"}, "comments": 2, "created_at": "2020-04-30T04:53:31Z", "updated_at": "2020-05-18T05:15:55Z", "closed_at": "2020-05-18T05:15:54Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1191", "html_url": "https://github.com/optuna/optuna/pull/1191", "diff_url": "https://github.com/optuna/optuna/pull/1191.diff", "patch_url": "https://github.com/optuna/optuna/pull/1191.patch", "merged_at": "2020-05-18T05:15:54Z"}, "body": "## Motivation\r\nMany storage features/specs are not tested. This low test coverage is a direct cause of the inconsistent implementations among storages. This PR aims to increase the test coverage and, at the same time, remove found bugs/inconsistent behaviors. This PR inevitably relies on #1175 and #1176. While we should test specs related to multi-worker settings, it will make this PR too complicated and it will be separated into another PR.\r\n\r\n## Description of the changes\r\n- This PR increases test coverage by adding more cases in tests/test_storage.py. Additionally, this PR resolves many inconsistent behaviors and bugs in the current implementation.\r\n- This PR slows down the test, which should be resolved by another PR by removing duplicated/redundant methods in the storage class.\r\n- This PR includes multi-study support from the in-memory storage.\r\n- This PR changes the interface of testing/StorageSuppliers and related tests. Importantly, this PR removes tests using \"common sqlite's db file.\" Tests related to behaviors in multi-worker settings should be added in other ways by other PRs.\r\n\r\n## The following space will be used to list all fixed/modified behaviors of storage implementations.\r\n\r\n- [x] Study_id duplication in In-memory DB.\r\n- [x] Study-name duplication is not handled in in-memory DB.\r\n- [x] In-meomry DB raises ValueError when deleting non-existent study (expected: KeyError).\r\n- [x] RDB backend raises ValueError when deleting non-existent study (expected: KeyError).\r\n- [x] Redis backend raises ValueError when deleting non-existent study (expected: KeyError).\r\n- [x] In-memory DB raises ValueError when study_id does not exist in get_study_name_from_id (expected: KeyError).\r\n- [x] RDB backend raises ValueError when study_id does not exist in get_study_name_from_id (expected: KeyError).\r\n- [x] Redis backend raises ValueError when study_id does not exist in get_study_name_from_id (expected: KeyError).\r\n- [x] In-memory DB raises ValueError when study_id does not exist in get_study_direction (expected: KeyError).\r\n- [x] RDB backend raises ValueError when study_id does not exist in get_study_direction (expected: KeyError).\r\n- [x] Redis backend raises AssertionError when study_id does not exist in get_study_direction (expected: KeyError).\r\n- [x] In-memory DB does not raise when study_id does not exist in get_study_user_attrs (expected: KeyError).\r\n- [x] RDB backend raises ValueError when study_id does not exist in get_study_user_attrs (expected: KeyError).\r\n- [x] Redis backend raises AssertionError when study_id does not exist in get_study_user_attrs (expected: KeyError).\r\n- [x] In-memory DB does not raise when study_id does not exist in get_study_system_attrs (expected: KeyError).\r\n- [x] RDB backend raises ValueError when study_id does not exist in get_study_system_attrs (expected: KeyError).\r\n- [x] Redis backend raises AssertionError when study_id does not exist in get_study_system_attrs (expected: KeyError).\r\n- [x] In-memory database raises ValueError when creating trial in non-existent study (expected: KeyError).\r\n- [x] RDB database (sqlite) does not raise when creating trial in non-existent study (expected: KeyError).\r\n- [x] Redis database raise ValueError when creating trial in non-existent study (expected: KeyError).\r\n- [x] In-memory database raises IndexError when fetching params of non-existent trials (expected: KeyError).\r\n- [x] RDB database (sqlite) raises ValueError when fetching params of non-existent trials (expected: KeyError).\r\n- [x] Redis database raise AssertionError when fetching params of non-existent trials (expected: KeyError).\r\n- [x] RDB database (sqlite) raises ValueError when setting params of non-existent trials (expected: KeyError).\r\n- [x] Redis database raise AssertionError when setting params of non-existent trials (expected: KeyError).\r\n- [x] In-memory database raises IndexError when setting values of non-existent trials (expected: KeyError).\r\n- [x] RDB database (sqlite) raises ValueError when setting values of non-existent trials (expected: KeyError).\r\n- [x] Redis database raise AssertionError when setting values of non-existent trials (expected: KeyError).\r\n- [x] In-memory database raises IndexError when setting intermediate_values of non-existent trials (expected: KeyError).\r\n- [x] RDB database (sqlite) raises ValueError when setting intermediate_values of non-existent trials (expected: KeyError).\r\n- [x] Redis database raise AssertionError when setting intermediate_values of non-existent trials (expected: KeyError).\r\n- [x] In-memory database raises IndexError when fetching user attributes of non-existent trials (expected: KeyError).\r\n- [x] RDB database (sqlite) raises ValueError when fetching user attributes of non-existent trials (expected: KeyError).\r\n- [x] Redis database raise AssertionError when fetching user attributes of non-existent trials (expected: KeyError).\r\n- [x] In-memory database raises IndexError when fetching system attributes of non-existent trials (expected: KeyError).\r\n- [x] RDB database (sqlite) raises ValueError when fetching system attributes of non-existent trials (expected: KeyError).\r\n- [x] Redis database raise AssertionError when fetching system attributes of non-existent trials (expected: KeyError).\r\n- [x] In-memory database raises IndexError when setting system attributes of non-existent trials (expected: KeyError).\r\n- [x] RDB database (sqlite) raises ValueError when setting system attributes of non-existent trials (expected: KeyError).\r\n- [x] Redis database raise AssertionError when setting system attributes of non-existent trials (expected: KeyError).\r\n- [x] In-memory database raises IndexError when fetching non-existent trials (expected: KeyError).\r\n- [x] RDB database (sqlite) raises ValueError when fetching non-existent trials (expected: KeyError).\r\n- [x] Redis database raise AssertionError when fetching non-existent trials (expected: KeyError).\r\n- [x] Broken get_all_study_summaries in Redis storage.\r\n- [x] RDB database (sqlite) raises ValueError when counting trials from non-existent study (expected: KeyError).\r\n- [x] Redis database raise AssertionError when counting trials from non-existent study (expected: KeyError).\r\n- [x] Broken deep_copy option of get_all_trials in RDB database (sqlite).\r\n\r\n## Some behaviors which need discussion, but not tackled in this PR.\r\n\r\n- Deleted study_id is reused in RDB backend (sqlite).\r\n- In-memory database arrows to change RUNNING state into WAITING.\r\n- RDB database arrows to change RUNNING state into WAITING.\r\n- Redis database arrows to change RUNNING state into WAITING.\r\n- Add MySQL to tests.\r\n- Add PostgreSQL to tests.\r\n- In-memory database arrows to change state into FINISHED even when the value is not set.\r\n- RDB database arrows to change state into FINISHED even when the value is not set.\r\n- Redis database arrows to change state into FINISHED even when the value is not set.\r\n- In-memory storage became slow due to multi-study support.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1191/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1191/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1186", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1186/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1186/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1186/events", "html_url": "https://github.com/optuna/optuna/issues/1186", "id": 609025783, "node_id": "MDU6SXNzdWU2MDkwMjU3ODM=", "number": 1186, "title": "attribute errors when trying pytorch_lightning_simple example", "user": {"login": "Jimmy2027", "id": 43926224, "node_id": "MDQ6VXNlcjQzOTI2MjI0", "avatar_url": "https://avatars.githubusercontent.com/u/43926224?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Jimmy2027", "html_url": "https://github.com/Jimmy2027", "followers_url": "https://api.github.com/users/Jimmy2027/followers", "following_url": "https://api.github.com/users/Jimmy2027/following{/other_user}", "gists_url": "https://api.github.com/users/Jimmy2027/gists{/gist_id}", "starred_url": "https://api.github.com/users/Jimmy2027/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Jimmy2027/subscriptions", "organizations_url": "https://api.github.com/users/Jimmy2027/orgs", "repos_url": "https://api.github.com/users/Jimmy2027/repos", "events_url": "https://api.github.com/users/Jimmy2027/events{/privacy}", "received_events_url": "https://api.github.com/users/Jimmy2027/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-04-29T12:41:37Z", "updated_at": "2020-05-15T02:46:41Z", "closed_at": "2020-05-15T02:46:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have tried to run the code from the [pytorch_lightning_simple](https://github.com/optuna/optuna/blob/master/examples/pytorch_lightning_simple.py) example for my own model, but get attribute errors with the `LightningModule`.\r\n\r\n## Expected behavior\r\n\r\nI expect the code from the example to run without errors.\r\n## Environment\r\n\r\n- Optuna version: 1.3.0\r\n- Python version: 3.7\r\n- OS: macOS Catalina Version 10.15.3 \r\n- (Optional) Other libraries and their versions: pytorch_lightning : 0.7.5\r\n\r\n## Error messages, stack traces, or logs\r\n```\r\n[W 2020-04-29 14:29:15,613] Setting status of trial#0 as TrialState.FAIL because of the following error: TypeError(\"Can't instantiate abstract class LightningNet with abstract methods forward\")\r\nTraceback (most recent call last):\r\n  File \"/Users/Hendrik/opt/anaconda3/lib/python3.7/site-packages/optuna/study.py\", line 677, in _run_trial\r\n    result = func(trial)\r\n  File \"/Users/Hendrik/Desktop/larry1/min_working.py\", line 172, in objective\r\n    model = LightningNet(train_dataset, val_dataset, trial)\r\nTypeError: Can't instantiate abstract class LightningNet with abstract methods forward\r\nTraceback (most recent call last):\r\n  File \"/Users/Hendrik/opt/anaconda3/lib/python3.7/site-packages/optuna/study.py\", line 331, in optimize\r\n    func, n_trials, timeout, catch, callbacks, gc_after_trial, None\r\n  File \"/Users/Hendrik/opt/anaconda3/lib/python3.7/site-packages/optuna/study.py\", line 626, in _optimize_sequential\r\n    self._run_trial_and_callbacks(func, catch, callbacks, gc_after_trial)\r\n  File \"/Users/Hendrik/opt/anaconda3/lib/python3.7/site-packages/optuna/study.py\", line 656, in _run_trial_and_callbacks\r\n    trial = self._run_trial(func, catch, gc_after_trial)\r\n  File \"/Users/Hendrik/opt/anaconda3/lib/python3.7/site-packages/optuna/study.py\", line 677, in _run_trial\r\n    result = func(trial)\r\n  File \"/Users/Hendrik/Desktop/larry1/min_working.py\", line 172, in objective\r\n    model = LightningNet(train_dataset, val_dataset, trial)\r\nTypeError: Can't instantiate abstract class LightningNet with abstract methods forward\r\n\r\n```\r\n## Steps to reproduce\r\nRun the minimal working example to reproduce the error.\r\n## Reproducible examples (optional)\r\n\r\n```python\r\nimport os\r\n\r\nimport numpy as np\r\nimport optuna\r\nimport pkg_resources\r\nimport pytorch_lightning as pl\r\nimport torch\r\nfrom optuna.integration import PyTorchLightningPruningCallback\r\nfrom pytorch_lightning.logging import LightningLoggerBase\r\nfrom torch.utils.data import DataLoader, Dataset\r\n\r\n\r\nclass MyDataset(Dataset):\r\n    def __init__(self, data, labels):\r\n        super(MyDataset, self).__init__()\r\n        self.data = data\r\n        self.labels = labels\r\n\r\n    def __len__(self):\r\n        return len(self.data)\r\n\r\n    def __getitem__(self, item):\r\n        return torch.from_numpy(self.data[item][None, ...]).float(), torch.from_numpy(self.labels[item]).float()\r\n\r\nx_train = x_val = [np.ones((12,35)) for i in range(5)]\r\ny_train = y_val = [np.ones((1,11)) for i in range(5)]\r\n\r\ntrain_dataset = MyDataset(x_train, y_train)\r\nval_dataset = MyDataset(x_val, y_val)\r\n\r\nif pkg_resources.parse_version(pl.__version__) < pkg_resources.parse_version(\"0.6.0\"):\r\n    raise RuntimeError(\"PyTorch Lightning>=0.6.0 is required for this example.\")\r\n\r\nclass DictLogger(LightningLoggerBase):\r\n    \"\"\"PyTorch Lightning `dict` logger.\"\"\"\r\n\r\n    def __init__(self, version):\r\n        super(DictLogger, self).__init__()\r\n        self.metrics = []\r\n        self._version = version\r\n\r\n    def log_metrics(self, metrics, step=None):\r\n        self.metrics.append(metrics)\r\n\r\n    @property\r\n    def version(self):\r\n        return self._version\r\n\r\n    @property\r\n    def experiment(self):\r\n        \"\"\"Return the experiment object associated with this logger.\"\"\"\r\n\r\n    def log_hyperparams(self, params):\r\n        \"\"\"\r\n        Record hyperparameters.\r\n        Args:\r\n            params: :class:`~argparse.Namespace` containing the hyperparameters\r\n        \"\"\"\r\n\r\n    @property\r\n    def name(self):\r\n        \"\"\"Return the experiment name.\"\"\"\r\n        return 'optuna'\r\n\r\nclass Flatten(torch.nn.Module):\r\n    def __init__(self):\r\n        super(Flatten, self).__init__()\r\n\r\n    def forward(self, x):\r\n        batch_size = x.shape[0]\r\n        return x.view(batch_size, -1)\r\n\r\nclass Net1(torch.nn.Module):\r\n    def __init__(self, trial):\r\n        super(Net1, self).__init__()\r\n\r\n        kernel_size1 = trial.suggest_int('kernel_size1', 2, 7)\r\n        kernel_size2 = trial.suggest_int('kernel_size2', 1, 16)\r\n        num_params = ((12 - kernel_size1 + 1) // 2) * ((35 - kernel_size2 + 1) // 1) * 64\r\n        self.network = torch.nn.Sequential(\r\n            torch.nn.Conv2d(1, 64, kernel_size=(kernel_size1, kernel_size2), stride=1, padding=0),\r\n            torch.nn.ReLU(inplace=True),\r\n            torch.nn.MaxPool2d((2, 1)),\r\n            Flatten(),\r\n            torch.nn.Linear(num_params, 50),\r\n            torch.nn.ReLU(inplace=True),\r\n            torch.nn.Linear(50, 11),\r\n            torch.nn.Sigmoid()\r\n        )\r\n\r\n    def forward(self, x):\r\n        return self.network(x)\r\n\r\nclass LightningNet(pl.LightningModule):\r\n    def __init__(self, train_dataset, val_dataset, trial):\r\n        super(LightningNet, self).__init__()\r\n        self.train_dataset = train_dataset\r\n        self.val_dataset = val_dataset\r\n        # Be careful not to overwrite `pl.LightningModule` attributes such as `self.model`.\r\n        self._model = Net1(trial)\r\n    def train_dataloader(self):\r\n        return DataLoader(self.train_dataset, batch_size=2048, num_workers=16)\r\n\r\n    def val_dataloader(self):\r\n        return DataLoader(self.val_dataset, batch_size=2048, num_workers=16)\r\n\r\n    def configure_optimizers(self):\r\n        return torch.optim.Adam(self.parameters(), lr=1e-4)\r\n\r\n    def training_step(self, batch, batch_index):\r\n        data, target = batch\r\n        output = self.forward(data)\r\n        loss = self.dice_loss(output, target)\r\n        logs = {'train_loss': loss}\r\n        return {'loss': loss, 'log': logs}\r\n\r\n    def validation_step(self, batch, batch_index):\r\n        data, target = batch\r\n        output = self.forward(data)\r\n        loss = self.dice_loss(output, target)\r\n        return {'val_loss': loss}\r\n\r\n    def validation_epoch_end(self, outputs):\r\n        avg_loss = torch.stack([x['val_loss'] for x in outputs]).mean()\r\n        tensorboard_logs = {'val_loss': avg_loss}\r\n        self.val_loss = avg_loss\r\n        return {'val_loss': avg_loss, 'log': tensorboard_logs}\r\n\r\n    def dice_loss(self, input, target):\r\n        smooth = 1.\r\n\r\n        iflat = input.view(-1)\r\n        tflat = target.view(-1)\r\n        intersection = (iflat * tflat).sum()\r\n\r\n        return 1 - ((2. * intersection + smooth) /\r\n                    (iflat.sum() + tflat.sum() + smooth))\r\n\r\n    # def forward(self, x):\r\n    #     return self._model(x)\r\n    #\r\n    # def get(self, item):\r\n    #     return self.__dict__[item]\r\n\r\nif not os.path.exists('optuna_dir'):\r\n    os.mkdir('optuna_dir')\r\n\r\nEPOCHS = 100\r\nDIR = 'optuna_dir'\r\nMODEL_DIR = os.path.join(DIR, \"result\")\r\n\r\n\r\ndef objective(trial):\r\n    # PyTorch Lightning will try to restore model parameters from previous trials if checkpoint\r\n    # filenames match. Therefore, the filenames for each trial must be made unique.\r\n    checkpoint_callback = pl.callbacks.ModelCheckpoint(\r\n        os.path.join(MODEL_DIR, \"trial_{}\".format(trial.number)), monitor=\"val_loss\"\r\n    )\r\n\r\n    # The default logger in PyTorch Lightning writes to event files to be consumed by\r\n    # TensorBoard. We create a simple logger instead that holds the log in memory so that the\r\n    # final accuracy can be obtained after optimization. When using the default logger, the\r\n    # final accuracy could be stored in an attribute of the `Trainer` instead.\r\n    logger = DictLogger(trial.number)\r\n\r\n    trainer = pl.Trainer(\r\n        logger=logger,\r\n        checkpoint_callback=checkpoint_callback,\r\n        max_epochs=EPOCHS,\r\n        gpus=0 if torch.cuda.is_available() else None,\r\n        early_stop_callback = PyTorchLightningPruningCallback(trial, monitor=\"val_loss\"),\r\n    )\r\n    model = LightningNet(train_dataset, val_dataset, trial)\r\n    trainer.fit(model)\r\n    return logger.metrics[-1][\"val_loss\"]\r\n\r\n\r\npruner = optuna.pruners.MedianPruner()\r\n\r\nstudy = optuna.create_study(direction=\"minimize\", pruner=pruner)\r\nstudy.optimize(objective, n_trials=100, timeout=600)\r\n\r\nprint(\"Number of finished trials: {}\".format(len(study.trials)))\r\n\r\nprint(\"Best trial:\")\r\ntrial = study.best_trial\r\n\r\nprint(\"  Value: {}\".format(trial.value))\r\n\r\nprint(\"  Params: \")\r\nfor key, value in trial.params.items():\r\n    print(\"    {}: {}\".format(key, value))\r\n```\r\n\r\n## Additional context (optional)\r\n\r\nResolving the abstract class conflicts by adding a `forward` and a `get` function to the LightningNet class (commented out in the minimal working example) results in following errors:\r\n```\r\n[W 2020-04-29 14:35:40,296] Setting status of trial#0 as TrialState.FAIL because of the following error: TypeError(\"'<' not supported between instances of 'Trainer' and 'int'\")\r\nTraceback (most recent call last):\r\n  File \"/Users/Hendrik/opt/anaconda3/lib/python3.7/site-packages/optuna/study.py\", line 677, in _run_trial\r\n    result = func(trial)\r\n  File \"/Users/Hendrik/Desktop/larry1/min_working.py\", line 174, in objective\r\n    trainer.fit(model)\r\n  File \"/Users/Hendrik/opt/anaconda3/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py\", line 793, in fit\r\n    self.run_pretrain_routine(model)\r\n  File \"/Users/Hendrik/opt/anaconda3/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py\", line 913, in run_pretrain_routine\r\n    self.train()\r\n  File \"/Users/Hendrik/opt/anaconda3/lib/python3.7/site-packages/pytorch_lightning/trainer/training_loop.py\", line 347, in train\r\n    self.run_training_epoch()\r\n  File \"/Users/Hendrik/opt/anaconda3/lib/python3.7/site-packages/pytorch_lightning/trainer/training_loop.py\", line 453, in run_training_epoch\r\n    self.call_early_stop_callback()\r\n  File \"/Users/Hendrik/opt/anaconda3/lib/python3.7/site-packages/pytorch_lightning/trainer/training_loop.py\", line 793, in call_early_stop_callback\r\n    self.early_stop_callback.on_epoch_end(self, self.get_model())\r\n  File \"/Users/Hendrik/opt/anaconda3/lib/python3.7/site-packages/optuna/integration/pytorch_lightning.py\", line 61, in on_epoch_end\r\n    self._trial.report(current_score, step=epoch)\r\n  File \"/Users/Hendrik/opt/anaconda3/lib/python3.7/site-packages/optuna/trial.py\", line 597, in report\r\n    if step < 0:\r\nTypeError: '<' not supported between instances of 'Trainer' and 'int'\r\nTraceback (most recent call last):\r\n  File \"/Users/Hendrik/opt/anaconda3/lib/python3.7/site-packages/optuna/study.py\", line 331, in optimize\r\n    func, n_trials, timeout, catch, callbacks, gc_after_trial, None\r\n  File \"/Users/Hendrik/opt/anaconda3/lib/python3.7/site-packages/optuna/study.py\", line 626, in _optimize_sequential\r\n    self._run_trial_and_callbacks(func, catch, callbacks, gc_after_trial)\r\n  File \"/Users/Hendrik/opt/anaconda3/lib/python3.7/site-packages/optuna/study.py\", line 656, in _run_trial_and_callbacks\r\n    trial = self._run_trial(func, catch, gc_after_trial)\r\n  File \"/Users/Hendrik/opt/anaconda3/lib/python3.7/site-packages/optuna/study.py\", line 677, in _run_trial\r\n    result = func(trial)\r\n  File \"/Users/Hendrik/Desktop/larry1/min_working.py\", line 174, in objective\r\n    trainer.fit(model)\r\n  File \"/Users/Hendrik/opt/anaconda3/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py\", line 793, in fit\r\n    self.run_pretrain_routine(model)\r\n  File \"/Users/Hendrik/opt/anaconda3/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py\", line 913, in run_pretrain_routine\r\n    self.train()\r\n  File \"/Users/Hendrik/opt/anaconda3/lib/python3.7/site-packages/pytorch_lightning/trainer/training_loop.py\", line 347, in train\r\n    self.run_training_epoch()\r\n  File \"/Users/Hendrik/opt/anaconda3/lib/python3.7/site-packages/pytorch_lightning/trainer/training_loop.py\", line 453, in run_training_epoch\r\n    self.call_early_stop_callback()\r\n  File \"/Users/Hendrik/opt/anaconda3/lib/python3.7/site-packages/pytorch_lightning/trainer/training_loop.py\", line 793, in call_early_stop_callback\r\n    self.early_stop_callback.on_epoch_end(self, self.get_model())\r\n  File \"/Users/Hendrik/opt/anaconda3/lib/python3.7/site-packages/optuna/integration/pytorch_lightning.py\", line 61, in on_epoch_end\r\n    self._trial.report(current_score, step=epoch)\r\n  File \"/Users/Hendrik/opt/anaconda3/lib/python3.7/site-packages/optuna/trial.py\", line 597, in report\r\n    if step < 0:\r\nTypeError: '<' not supported between instances of 'Trainer' and 'int'\r\n\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1186/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1186/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1181", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1181/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1181/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1181/events", "html_url": "https://github.com/optuna/optuna/pull/1181", "id": 608260727, "node_id": "MDExOlB1bGxSZXF1ZXN0NDEwMDcxNTYz", "number": 1181, "title": "Add figure title to contour plot", "user": {"login": "harupy", "id": 17039389, "node_id": "MDQ6VXNlcjE3MDM5Mzg5", "avatar_url": "https://avatars.githubusercontent.com/u/17039389?v=4", "gravatar_id": "", "url": "https://api.github.com/users/harupy", "html_url": "https://github.com/harupy", "followers_url": "https://api.github.com/users/harupy/followers", "following_url": "https://api.github.com/users/harupy/following{/other_user}", "gists_url": "https://api.github.com/users/harupy/gists{/gist_id}", "starred_url": "https://api.github.com/users/harupy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/harupy/subscriptions", "organizations_url": "https://api.github.com/users/harupy/orgs", "repos_url": "https://api.github.com/users/harupy/repos", "events_url": "https://api.github.com/users/harupy/events{/privacy}", "received_events_url": "https://api.github.com/users/harupy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1947562325, "node_id": "MDU6TGFiZWwxOTQ3NTYyMzI1", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.visualization", "name": "optuna.visualization", "color": "1c659e", "default": false, "description": "Related to the `optuna.visualization` submodule. This is automatically labeled by github-actions."}], "state": "closed", "locked": false, "assignee": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/23", "html_url": "https://github.com/optuna/optuna/milestone/23", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/23/labels", "id": 5264564, "node_id": "MDk6TWlsZXN0b25lNTI2NDU2NA==", "number": 23, "title": "v1.4.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 91, "state": "closed", "created_at": "2020-04-02T01:56:00Z", "updated_at": "2020-05-11T08:49:35Z", "due_on": null, "closed_at": "2020-05-11T08:49:35Z"}, "comments": 5, "created_at": "2020-04-28T11:59:38Z", "updated_at": "2020-05-01T01:53:23Z", "closed_at": "2020-05-01T01:47:25Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1181", "html_url": "https://github.com/optuna/optuna/pull/1181", "diff_url": "https://github.com/optuna/optuna/pull/1181.diff", "patch_url": "https://github.com/optuna/optuna/pull/1181.patch", "merged_at": "2020-05-01T01:47:24Z"}, "body": "<!-- Thank you for creating a pull request! -->\r\n\r\n## Motivation\r\n<!-- Describe your motivation why you will submit this PR. This is useful for reviewers to understand the context of PR. -->\r\n\r\nResolves #1176 \r\n\r\n## Description of the changes\r\n<!-- Describe the changes in this PR. -->\r\n\r\n- Add a figure title to the contour plot.\r\n- Update `plot_contour.html`.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1181/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1181/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1176", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1176/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1176/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1176/events", "html_url": "https://github.com/optuna/optuna/issues/1176", "id": 607966395, "node_id": "MDU6SXNzdWU2MDc5NjYzOTU=", "number": 1176, "title": "Show title in figure for contour plot.", "user": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-04-28T01:59:16Z", "updated_at": "2020-05-01T01:47:25Z", "closed_at": "2020-05-01T01:47:25Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I noticed `optuna.visualization.plot_contour` show a plot without its title.\r\n\r\n<img width=\"913\" alt=\"Screen Shot 2020-04-28 at 10 49 53\" src=\"https://user-images.githubusercontent.com/5164000/80437965-01d5fc00-893e-11ea-896a-343b2e51bc90.png\">\r\n\r\nI think it's better to show a title to be consistent with other plot features such as `optuna.visualization.plot_optimization_history` and `optuna.visualization.plot_slice`.\r\n\r\nWe can reproduce this behavior in the [official quickstart](https://colab.research.google.com/github/optuna/optuna/blob/master/examples/quickstart.ipynb)\r\n\r\n## Expected behavior\r\n\r\nShow title of a figure in the contour plot.\r\n\r\n## Environment\r\n\r\n- Optuna version: 1.3.0\r\n- Python version: 3.6.9\r\n- OS: Ubuntu 18.04.3 LTS\r\n\r\n## Steps to reproduce\r\n\r\nRun notebook on [Google Colab](https://colab.research.google.com/github/optuna/optuna/blob/master/examples/quickstart.ipynb).", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1176/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1176/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1143", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1143/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1143/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1143/events", "html_url": "https://github.com/optuna/optuna/pull/1143", "id": 603555122, "node_id": "MDExOlB1bGxSZXF1ZXN0NDA2MzE4Nzgz", "number": 1143, "title": "Fix the range of sampling in TPE sampler.", "user": {"login": "ytsmiling", "id": 20983513, "node_id": "MDQ6VXNlcjIwOTgzNTEz", "avatar_url": "https://avatars.githubusercontent.com/u/20983513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ytsmiling", "html_url": "https://github.com/ytsmiling", "followers_url": "https://api.github.com/users/ytsmiling/followers", "following_url": "https://api.github.com/users/ytsmiling/following{/other_user}", "gists_url": "https://api.github.com/users/ytsmiling/gists{/gist_id}", "starred_url": "https://api.github.com/users/ytsmiling/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ytsmiling/subscriptions", "organizations_url": "https://api.github.com/users/ytsmiling/orgs", "repos_url": "https://api.github.com/users/ytsmiling/repos", "events_url": "https://api.github.com/users/ytsmiling/events{/privacy}", "received_events_url": "https://api.github.com/users/ytsmiling/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, {"login": "ytsmiling", "id": 20983513, "node_id": "MDQ6VXNlcjIwOTgzNTEz", "avatar_url": "https://avatars.githubusercontent.com/u/20983513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ytsmiling", "html_url": "https://github.com/ytsmiling", "followers_url": "https://api.github.com/users/ytsmiling/followers", "following_url": "https://api.github.com/users/ytsmiling/following{/other_user}", "gists_url": "https://api.github.com/users/ytsmiling/gists{/gist_id}", "starred_url": "https://api.github.com/users/ytsmiling/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ytsmiling/subscriptions", "organizations_url": "https://api.github.com/users/ytsmiling/orgs", "repos_url": "https://api.github.com/users/ytsmiling/repos", "events_url": "https://api.github.com/users/ytsmiling/events{/privacy}", "received_events_url": "https://api.github.com/users/ytsmiling/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/23", "html_url": "https://github.com/optuna/optuna/milestone/23", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/23/labels", "id": 5264564, "node_id": "MDk6TWlsZXN0b25lNTI2NDU2NA==", "number": 23, "title": "v1.4.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 91, "state": "closed", "created_at": "2020-04-02T01:56:00Z", "updated_at": "2020-05-11T08:49:35Z", "due_on": null, "closed_at": "2020-05-11T08:49:35Z"}, "comments": 0, "created_at": "2020-04-20T21:44:09Z", "updated_at": "2020-04-21T07:07:59Z", "closed_at": "2020-04-21T04:49:57Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1143", "html_url": "https://github.com/optuna/optuna/pull/1143", "diff_url": "https://github.com/optuna/optuna/pull/1143.diff", "patch_url": "https://github.com/optuna/optuna/pull/1143.patch", "merged_at": "2020-04-21T04:49:57Z"}, "body": "## Motivation\r\nThis PR removes the possibility that the TPE samples from [low, high) in uniform and other distributions. Current implementation samples from [low, high].\r\n\r\n## Description of the changes\r\nCheck whether all samples are less than high. If not, it resamples.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1143/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1143/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1139", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1139/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1139/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1139/events", "html_url": "https://github.com/optuna/optuna/pull/1139", "id": 602821877, "node_id": "MDExOlB1bGxSZXF1ZXN0NDA1NzM1NTYz", "number": 1139, "title": "Support Copy-on-Write for thread safety in in-memory storage.", "user": {"login": "ytsmiling", "id": 20983513, "node_id": "MDQ6VXNlcjIwOTgzNTEz", "avatar_url": "https://avatars.githubusercontent.com/u/20983513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ytsmiling", "html_url": "https://github.com/ytsmiling", "followers_url": "https://api.github.com/users/ytsmiling/followers", "following_url": "https://api.github.com/users/ytsmiling/following{/other_user}", "gists_url": "https://api.github.com/users/ytsmiling/gists{/gist_id}", "starred_url": "https://api.github.com/users/ytsmiling/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ytsmiling/subscriptions", "organizations_url": "https://api.github.com/users/ytsmiling/orgs", "repos_url": "https://api.github.com/users/ytsmiling/repos", "events_url": "https://api.github.com/users/ytsmiling/events{/privacy}", "received_events_url": "https://api.github.com/users/ytsmiling/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/23", "html_url": "https://github.com/optuna/optuna/milestone/23", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/23/labels", "id": 5264564, "node_id": "MDk6TWlsZXN0b25lNTI2NDU2NA==", "number": 23, "title": "v1.4.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 91, "state": "closed", "created_at": "2020-04-02T01:56:00Z", "updated_at": "2020-05-11T08:49:35Z", "due_on": null, "closed_at": "2020-05-11T08:49:35Z"}, "comments": 1, "created_at": "2020-04-19T21:15:19Z", "updated_at": "2020-04-27T08:38:23Z", "closed_at": "2020-04-27T08:38:23Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1139", "html_url": "https://github.com/optuna/optuna/pull/1139", "diff_url": "https://github.com/optuna/optuna/pull/1139.diff", "patch_url": "https://github.com/optuna/optuna/pull/1139.patch", "merged_at": "2020-04-27T08:38:22Z"}, "body": "Since optuna internals are assumed to work in a copy-on-write manner, samplers and others access to trials without deep-copy. However, the in-memory storage class actually does not follow a copy-on-write fashion.\r\nWhile I did not check every sampler/study logics, the missing copy can result in untractable bugs under multi-thread settings.\r\nThis PR implements the missing copy-on-write logics for in-memory storage.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1139/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1139/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1133", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1133/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1133/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1133/events", "html_url": "https://github.com/optuna/optuna/issues/1133", "id": 602360892, "node_id": "MDU6SXNzdWU2MDIzNjA4OTI=", "number": 1133, "title": "CI failure: torch==1.4.0+cpu not found", "user": {"login": "crcrpar", "id": 16191443, "node_id": "MDQ6VXNlcjE2MTkxNDQz", "avatar_url": "https://avatars.githubusercontent.com/u/16191443?v=4", "gravatar_id": "", "url": "https://api.github.com/users/crcrpar", "html_url": "https://github.com/crcrpar", "followers_url": "https://api.github.com/users/crcrpar/followers", "following_url": "https://api.github.com/users/crcrpar/following{/other_user}", "gists_url": "https://api.github.com/users/crcrpar/gists{/gist_id}", "starred_url": "https://api.github.com/users/crcrpar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/crcrpar/subscriptions", "organizations_url": "https://api.github.com/users/crcrpar/orgs", "repos_url": "https://api.github.com/users/crcrpar/repos", "events_url": "https://api.github.com/users/crcrpar/events{/privacy}", "received_events_url": "https://api.github.com/users/crcrpar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1633027617, "node_id": "MDU6TGFiZWwxNjMzMDI3NjE3", "url": "https://api.github.com/repos/optuna/optuna/labels/CI", "name": "CI", "color": "0052cc", "default": false, "description": "Continuous integration."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-04-18T02:40:55Z", "updated_at": "2020-04-20T04:35:08Z", "closed_at": "2020-04-20T04:35:08Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\nCI failed to install pytorch CPU 1.4.0 in https://github.com/optuna/optuna/pull/1086/commits/f52aebb2f11147e903d0014b7b384e705b631bc1's CI.\r\n\r\n## Error messages, stack traces, or logs\r\n[build_36874_step_103_container_0.txt](https://github.com/optuna/optuna/files/4495905/build_36874_step_103_container_0.txt)\r\n\r\nCI: https://circleci.com/gh/optuna/optuna/36874?utm_campaign=vcs-integration-link&utm_medium=referral&utm_source=github-build-link\r\n\r\nIt might be due to the version specification introduced by #1118 and/or #1124.\r\n\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n\r\nCC: @hvy ", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1133/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1133/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1120", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1120/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1120/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1120/events", "html_url": "https://github.com/optuna/optuna/issues/1120", "id": 600137350, "node_id": "MDU6SXNzdWU2MDAxMzczNTA=", "number": 1120, "title": "AttributeError: module 'optuna.trial' has no attribute 'TrialState'", "user": {"login": "Crissman", "id": 4338467, "node_id": "MDQ6VXNlcjQzMzg0Njc=", "avatar_url": "https://avatars.githubusercontent.com/u/4338467?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Crissman", "html_url": "https://github.com/Crissman", "followers_url": "https://api.github.com/users/Crissman/followers", "following_url": "https://api.github.com/users/Crissman/following{/other_user}", "gists_url": "https://api.github.com/users/Crissman/gists{/gist_id}", "starred_url": "https://api.github.com/users/Crissman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Crissman/subscriptions", "organizations_url": "https://api.github.com/users/Crissman/orgs", "repos_url": "https://api.github.com/users/Crissman/repos", "events_url": "https://api.github.com/users/Crissman/events{/privacy}", "received_events_url": "https://api.github.com/users/Crissman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-04-15T08:59:15Z", "updated_at": "2020-04-16T01:43:06Z", "closed_at": "2020-04-16T01:43:06Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Error message running https://github.com/optuna/optuna/blob/master/examples/pruning/simple.py\r\nOn Optuna 1.3\r\n\r\n```Traceback (most recent call last):\r\n  File \"simple.py\", line 52, in <module>\r\n    pruned_trials = [t for t in study.trials if t.state == optuna.trial.TrialState.PRUNED]\r\n  File \"simple.py\", line 52, in <listcomp>\r\n    pruned_trials = [t for t in study.trials if t.state == optuna.trial.TrialState.PRUNED]\r\nAttributeError: module 'optuna.trial' has no attribute 'TrialState'\r\n```\r\n\r\nShould be `optuna.structs.TrialState.PRUNED`?", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1120/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1120/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1115", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1115/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1115/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1115/events", "html_url": "https://github.com/optuna/optuna/issues/1115", "id": 598639929, "node_id": "MDU6SXNzdWU1OTg2Mzk5Mjk=", "number": 1115, "title": "Study does not close all connections to RDB.", "user": {"login": "ytsmiling", "id": 20983513, "node_id": "MDQ6VXNlcjIwOTgzNTEz", "avatar_url": "https://avatars.githubusercontent.com/u/20983513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ytsmiling", "html_url": "https://github.com/ytsmiling", "followers_url": "https://api.github.com/users/ytsmiling/followers", "following_url": "https://api.github.com/users/ytsmiling/following{/other_user}", "gists_url": "https://api.github.com/users/ytsmiling/gists{/gist_id}", "starred_url": "https://api.github.com/users/ytsmiling/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ytsmiling/subscriptions", "organizations_url": "https://api.github.com/users/ytsmiling/orgs", "repos_url": "https://api.github.com/users/ytsmiling/repos", "events_url": "https://api.github.com/users/ytsmiling/events{/privacy}", "received_events_url": "https://api.github.com/users/ytsmiling/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 14, "created_at": "2020-04-13T03:01:27Z", "updated_at": "2022-02-18T14:57:45Z", "closed_at": "2021-06-24T23:05:34Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "## Expected behavior\r\n\r\nFinished studies do not consume database resources.\r\n\r\n## Environment\r\n\r\n- Optuna version: 1.3.0\r\n- Python version: 3.5\r\n- OS: Ubuntu 18.04\r\n- MySQL (docker): `mysql:8.0.19` (localhost)\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"path/to/venv/lib/python3.5/site-packages/sqlalchemy/engine/base.py\", line 2285, in _wrap_pool_connect\r\n    return fn()\r\n  File \"path/to/venv/lib/python3.5/site-packages/sqlalchemy/pool/base.py\", line 363, in connect\r\n    return _ConnectionFairy._checkout(self)\r\n  File \"path/to/venv/lib/python3.5/site-packages/sqlalchemy/pool/base.py\", line 773, in _checkout\r\n    fairy = _ConnectionRecord.checkout(pool)\r\n  File \"path/to/venv/lib/python3.5/site-packages/sqlalchemy/pool/base.py\", line 492, in checkout\r\n    rec = pool._do_get()\r\n  File \"path/to/venv/lib/python3.5/site-packages/sqlalchemy/pool/impl.py\", line 139, in _do_get\r\n    self._dec_overflow()\r\n  File \"path/to/venv/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py\", line 69, in __exit__\r\n    exc_value, with_traceback=exc_tb,\r\n  File \"path/to/venv/lib/python3.5/site-packages/sqlalchemy/util/compat.py\", line 178, in raise_\r\n    raise exception\r\n  File \"path/to/venv/lib/python3.5/site-packages/sqlalchemy/pool/impl.py\", line 136, in _do_get\r\n    return self._create_connection()\r\n  File \"path/to/venv/lib/python3.5/site-packages/sqlalchemy/pool/base.py\", line 308, in _create_connection\r\n    return _ConnectionRecord(self)\r\n  File \"path/to/venv/lib/python3.5/site-packages/sqlalchemy/pool/base.py\", line 437, in __init__\r\n    self.__connect(first_connect_check=True)\r\n  File \"path/to/venv/lib/python3.5/site-packages/sqlalchemy/pool/base.py\", line 657, in __connect\r\n    pool.logger.debug(\"Error on connect(): %s\", e)\r\n  File \"path/to/venv/lib/python3.5/site-packages/sqlalchemy/util/langhelpers.py\", line 69, in __exit__\r\n    exc_value, with_traceback=exc_tb,\r\n  File \"path/to/venv/lib/python3.5/site-packages/sqlalchemy/util/compat.py\", line 178, in raise_\r\n    raise exception\r\n  File \"path/to/venv/lib/python3.5/site-packages/sqlalchemy/pool/base.py\", line 652, in __connect\r\n    connection = pool._invoke_creator(self)\r\n  File \"path/to/venv/lib/python3.5/site-packages/sqlalchemy/engine/strategies.py\", line 114, in connect\r\n    return dialect.connect(*cargs, **cparams)\r\n  File \"path/to/venv/lib/python3.5/site-packages/sqlalchemy/engine/default.py\", line 488, in connect\r\n    return self.dbapi.connect(*cargs, **cparams)\r\n  File \"path/to/venv/lib/python3.5/site-packages/pymysql/__init__.py\", line 94, in Connect\r\n    return Connection(*args, **kwargs)\r\n  File \"path/to/venv/lib/python3.5/site-packages/pymysql/connections.py\", line 325, in __init__\r\n    self.connect()\r\n  File \"path/to/venv/lib/python3.5/site-packages/pymysql/connections.py\", line 598, in connect\r\n    self._get_server_information()\r\n  File \"path/to/venv/lib/python3.5/site-packages/pymysql/connections.py\", line 975, in _get_server_information\r\n    packet = self._read_packet()\r\n  File \"path/to/venv/lib/python3.5/site-packages/pymysql/connections.py\", line 684, in _read_packet\r\n    packet.check_error()\r\n  File \"path/to/venv/lib/python3.5/site-packages/pymysql/protocol.py\", line 220, in check_error\r\n    err.raise_mysql_exception(self._data)\r\n  File \"path/to/venv/lib/python3.5/site-packages/pymysql/err.py\", line 109, in raise_mysql_exception\r\n    raise errorclass(errno, errval)\r\npymysql.err.OperationalError: (1040, 'Too many connections')\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Use MySQL backend.\r\n2. Create multiple studies from a single process. \r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\nimport argparse\r\nimport math\r\nimport sys\r\n\r\nimport sqlalchemy\r\nfrom sqlalchemy.sql import text\r\n\r\nimport optuna\r\n\r\n\r\nN_STUDY = 10000\r\nN_TRIAL = 2\r\n\r\n\r\ndef objective(trial):\r\n    ret = 0.0\r\n    for i in range(10):\r\n        ret += math.sin(\r\n            trial.suggest_float('param-{}'.format(i), 0, math.pi * 2))\r\n    return ret\r\n\r\n\r\ndef run(storage, i):\r\n    study = optuna.create_study(\r\n        storage=storage, study_name=\"study-{}\".format(i), load_if_exists=True)\r\n    study.optimize(objective, n_trials=N_TRIAL, show_progress_bar=False)\r\n\r\n\r\ndef define_flags(parser):\r\n    parser.add_argument('mysql_user', type=str)\r\n    parser.add_argument('mysql_password', type=str)\r\n    parser.add_argument('mysql_host', type=str)\r\n    parser.add_argument('mysql_database', type=str)\r\n    return parser\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    parser = define_flags(argparse.ArgumentParser())\r\n    args = parser.parse_args()\r\n\r\n    storage = 'mysql+pymysql://{}:{}@{}/{}'.format(\r\n        args.mysql_user,\r\n        args.mysql_password,\r\n        args.mysql_host,\r\n        args.mysql_database,\r\n    )\r\n    engine = sqlalchemy.create_engine(storage)\r\n    conn = engine.connect()\r\n    # mysql specific\r\n    get_connection_cnt = text(\"show status where `Variable_name` = 'Threads_connected'\")\r\n\r\n    for t in range(N_STUDY):\r\n        conn_cnt = conn.execute(get_connection_cnt).fetchall()\r\n        sys.stdout.write(\r\n            '\\r{:0>5}/{:0>5} studies finished. Current connection: {}'.format(\r\n                t, N_STUDY, conn_cnt\r\n            ))\r\n        run(storage, t)\r\n    print('All studies successfully finished.' + ' ' * 20)\r\n\r\n    conn.close()\r\n```\r\n\r\n## Additional context (optional)\r\n\r\nCalling `study._storage.engine.dispose()` at the end of the `run` function prevents the increase of connections.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1115/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1115/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1092", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1092/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1092/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1092/events", "html_url": "https://github.com/optuna/optuna/issues/1092", "id": 594771573, "node_id": "MDU6SXNzdWU1OTQ3NzE1NzM=", "number": 1092, "title": "Race Condition For First Run", "user": {"login": "elbaro", "id": 1851290, "node_id": "MDQ6VXNlcjE4NTEyOTA=", "avatar_url": "https://avatars.githubusercontent.com/u/1851290?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elbaro", "html_url": "https://github.com/elbaro", "followers_url": "https://api.github.com/users/elbaro/followers", "following_url": "https://api.github.com/users/elbaro/following{/other_user}", "gists_url": "https://api.github.com/users/elbaro/gists{/gist_id}", "starred_url": "https://api.github.com/users/elbaro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elbaro/subscriptions", "organizations_url": "https://api.github.com/users/elbaro/orgs", "repos_url": "https://api.github.com/users/elbaro/repos", "events_url": "https://api.github.com/users/elbaro/events{/privacy}", "received_events_url": "https://api.github.com/users/elbaro/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-04-06T03:11:26Z", "updated_at": "2021-12-01T22:08:03Z", "closed_at": "2020-04-06T10:19:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "When spawning multiple studies with the same postgres backend,\r\nthe script crashes because each process tries to create the db table.\r\n\r\n## Expected behavior\r\n\r\ndb lock, no crash.\r\n\r\n## Environment\r\n\r\n- Optuna version: 1.2.0\r\n- Python version: 3.8\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\n..\r\nsqlalchemy.exc.ProgrammingError: ... relation \"alembic_version\" already exists\r\n..\r\nsqlalchemy.exc.IntegrityError: ... duplicate key value violates unique constraint \"pg_type_typename_nsp_index\"\r\n..\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n```\r\n[delete optuna db tables]\r\npython exp.py exp1 &\r\npython exp.py exp2 &\r\npython exp.py exp3 &\r\n```\r\n\r\n## Additional context (optional)\r\nonly tried postgres", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1092/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1092/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1014", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1014/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1014/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1014/events", "html_url": "https://github.com/optuna/optuna/pull/1014", "id": 579409932, "node_id": "MDExOlB1bGxSZXF1ZXN0Mzg2ODA5MDU1", "number": 1014, "title": "Use `SELECT FOR UPDATE` while updating trial state.", "user": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/22", "html_url": "https://github.com/optuna/optuna/milestone/22", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/22/labels", "id": 5169883, "node_id": "MDk6TWlsZXN0b25lNTE2OTg4Mw==", "number": 22, "title": "v1.3.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 52, "state": "closed", "created_at": "2020-03-05T01:46:09Z", "updated_at": "2020-04-02T04:55:22Z", "due_on": null, "closed_at": "2020-04-02T04:55:22Z"}, "comments": 2, "created_at": "2020-03-11T16:56:29Z", "updated_at": "2020-03-23T10:29:59Z", "closed_at": "2020-03-23T10:28:12Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/1014", "html_url": "https://github.com/optuna/optuna/pull/1014", "diff_url": "https://github.com/optuna/optuna/pull/1014.diff", "patch_url": "https://github.com/optuna/optuna/pull/1014.patch", "merged_at": "2020-03-23T10:28:12Z"}, "body": "## Summary\r\n\r\nFix a concurrency problem of `set_trial_state` by using `SELECT ... FOR UPDATE`.\r\n\r\n## Check script\r\n\r\n```sh\r\n#!/bin/sh\r\n\r\nset -ex\r\n\r\ndocker pull mysql:8.0\r\n\r\ndocker run \\\r\n  -d \\\r\n  --rm \\\r\n  -p 3306:3306 \\\r\n  --mount type=volume,src=mysql,dst=/etc/mysql/conf.d \\\r\n  -e MYSQL_USER=optuna \\\r\n  -e MYSQL_DATABASE=optuna \\\r\n  -e MYSQL_PASSWORD=password \\\r\n  -e MYSQL_ALLOW_EMPTY_PASSWORD=yes \\\r\n  --name optuna-mysql \\\r\n  mysql:8.0\r\n\r\nsleep 20\r\n\r\npython update_trial_state.py\r\n\r\ndocker stop optuna-mysql\r\n```\r\n\r\n```python\r\nimport optuna\r\n\r\n\r\ndef objective(trial):\r\n    x1 = trial.suggest_uniform(\"x1\", -10, 10)\r\n    print(\"x1\", x1)\r\n    return (x1 - 5) ** 2\r\n\r\n\r\ndef main():\r\n    optuna.logging.set_verbosity(optuna.logging.DEBUG)\r\n    storage = optuna.storages.RDBStorage(\"mysql+mysqldb://optuna:password@127.0.0.1:3306/optuna\")\r\n    study = optuna.create_study(storage=storage)\r\n    study.optimize(objective, n_trials=1)\r\n\r\n    for i in range(10):\r\n        study.enqueue_trial({\"x1\": i})\r\n\r\n    study.optimize(objective, n_jobs=10, n_trials=10)\r\n\r\n\r\nif __name__ == '__main__':\r\n    main()\r\n```\r\n \r\n## Before\r\n\r\n```\r\n$ python update_trial_state.py \r\n[D 2020-03-12 01:55:32,027] pool_pre_ping=True was set to engine_kwargs to prevent connection timeout.\r\n[I 2020-03-12 01:55:32,260] A new study created with name: no-name-eb48caa4-24a2-4310-8022-1c7240dbc8f9\r\nx1 -7.25102819034571\r\n[I 2020-03-12 01:55:32,562] Finished trial#0 resulted in value: 150.0876917206453. Current best value is 150.088 with parameters: {'x1': -7.25103}.\r\n/Users/a14737/src/github.com/pfnet/optuna/optuna/_experimental.py:83: ExperimentalWarning: enqueue_trial is experimental (supported from v1.2.0). The interface can change in the future.\r\n  warnings.warn(\r\n[D 2020-03-12 01:55:33,299] Trial#1 is popped from the trial queue.\r\n[D 2020-03-12 01:55:33,306] Trial#1 is popped from the trial queue.\r\n[D 2020-03-12 01:55:33,361] Trial#2 is popped from the trial queue.\r\n[D 2020-03-12 01:55:33,367] Trial#2 is popped from the trial queue.\r\n[D 2020-03-12 01:55:33,380] Trial#2 is popped from the trial queue.\r\n[D 2020-03-12 01:55:33,386] Trial#2 is popped from the trial queue.\r\n[D 2020-03-12 01:55:33,421] Trial#3 is popped from the trial queue.\r\n[D 2020-03-12 01:55:33,445] Trial#3 is popped from the trial queue.\r\n[D 2020-03-12 01:55:33,543] Trial#4 is popped from the trial queue.\r\n[D 2020-03-12 01:55:33,551] Trial#4 is popped from the trial queue.\r\nx1 0\r\n[D 2020-03-12 01:55:33,711] Ignoring IntegrityError('(MySQLdb._exceptions.IntegrityError) (1062, \"Duplicate entry \\'46-x1\\' for key \\'trial_params.trial_id\\'\")'). This happens due to a timing issue among threads/processes/nodes. Another one might have committed a record with the same key(s).\r\nx1 1\r\nx1 0.0\r\n[D 2020-03-12 01:55:33,896] Ignoring IntegrityError('(MySQLdb._exceptions.IntegrityError) (1062, \"Duplicate entry \\'47-x1\\' for key \\'trial_params.trial_id\\'\")'). This happens due to a timing issue among threads/processes/nodes. Another one might have committed a record with the same key(s).\r\n[D 2020-03-12 01:55:33,909] Ignoring IntegrityError('(MySQLdb._exceptions.IntegrityError) (1062, \"Duplicate entry \\'47-x1\\' for key \\'trial_params.trial_id\\'\")'). This happens due to a timing issue among threads/processes/nodes. Another one might have committed a record with the same key(s).\r\nx1 2\r\n[D 2020-03-12 01:55:34,024] Ignoring IntegrityError('(MySQLdb._exceptions.IntegrityError) (1062, \"Duplicate entry \\'48-x1\\' for key \\'trial_params.trial_id\\'\")'). This happens due to a timing issue among threads/processes/nodes. Another one might have committed a record with the same key(s).\r\nx1 1.0\r\nx1 1.0\r\nx1 1.0\r\nTraceback (most recent call last):\r\n  File \"update_trial_state.py\", line 23, in <module>\r\n[D 2020-03-12 01:55:34,244] Ignoring IntegrityError('(MySQLdb._exceptions.IntegrityError) (1062, \"Duplicate entry \\'49-x1\\' for key \\'trial_params.trial_id\\'\")'). This happens due to a timing issue among threads/processes/nodes. Another one might have committed a record with the same key(s).\r\nx1 2.0\r\n    main()\r\n  File \"update_trial_state.py\", line 19, in main\r\nx1 3\r\n    study.optimize(objective, n_jobs=10, n_trials=10)\r\n  File \"/Users/a14737/src/github.com/pfnet/optuna/optuna/study.py\", line 349, in optimize\r\n    parallel(\r\n  File \"/Users/a14737/src/github.com/pfnet/optuna/venv/lib/python3.8/site-packages/joblib-0.14.1-py3.8.egg/joblib/parallel.py\", line 1017, in __call__\r\nx1 3.0\r\n    self.retrieve()\r\n  File \"/Users/a14737/src/github.com/pfnet/optuna/venv/lib/python3.8/site-packages/joblib-0.14.1-py3.8.egg/joblib/parallel.py\", line 909, in retrieve\r\n    self._output.extend(job.get(timeout=self.timeout))\r\n  File \"/Users/a14737/.pyenv/versions/3.8.1/lib/python3.8/multiprocessing/pool.py\", line 768, in get\r\n    raise self._value\r\n  File \"/Users/a14737/.pyenv/versions/3.8.1/lib/python3.8/multiprocessing/pool.py\", line 125, in worker\r\n    result = (True, func(*args, **kwds))\r\n  File \"/Users/a14737/src/github.com/pfnet/optuna/venv/lib/python3.8/site-packages/joblib-0.14.1-py3.8.egg/joblib/_parallel_backends.py\", line 608, in __call__\r\n    return self.func(*args, **kwargs)\r\n  File \"/Users/a14737/src/github.com/pfnet/optuna/venv/lib/python3.8/site-packages/joblib-0.14.1-py3.8.egg/joblib/parallel.py\", line 255, in __call__\r\n    return [func(*args, **kwargs)\r\n  File \"/Users/a14737/src/github.com/pfnet/optuna/venv/lib/python3.8/site-packages/joblib-0.14.1-py3.8.egg/joblib/parallel.py\", line 255, in <listcomp>\r\n    return [func(*args, **kwargs)\r\n  File \"/Users/a14737/src/github.com/pfnet/optuna/optuna/study.py\", line 597, in _optimize_sequential\r\n    self._run_trial_and_callbacks(func, catch, callbacks, gc_after_trial)\r\n  File \"/Users/a14737/src/github.com/pfnet/optuna/optuna/study.py\", line 627, in _run_trial_and_callbacks\r\n[I 2020-03-12 01:55:34,553] Finished trial#3 resulted in value: 9.0. Current best value is 9.0 with parameters: {'x1': 3.0}.\r\n    trial = self._run_trial(func, catch, gc_after_trial)\r\n  File \"/Users/a14737/src/github.com/pfnet/optuna/optuna/study.py\", line 705, in _run_trial\r\n    self._storage.set_trial_state(trial_id, structs.TrialState.COMPLETE)\r\n  File \"/Users/a14737/src/github.com/pfnet/optuna/optuna/storages/rdb/storage.py\", line 484, in set_trial_state\r\n    self.check_trial_is_updatable(trial_id, trial.state)\r\n  File \"/Users/a14737/src/github.com/pfnet/optuna/optuna/storages/base.py\", line 220, in check_trial_is_updatable\r\n[I 2020-03-12 01:55:34,564] Finished trial#2 resulted in value: 16.0. Current best value is 16.0 with parameters: {'x1': 3.0}.\r\n[I 2020-03-12 01:55:34,566] Finished trial#1 resulted in value: 25.0. Current best value is 16.0 with parameters: {'x1': 3.0}.\r\n    raise RuntimeError(\r\nRuntimeError: Trial#1 has already finished and can not be updated.\r\n```\r\n\r\n## After\r\n\r\n```\r\n(venv) $ python update_trial_state.py \r\n[D 2020-03-12 01:53:42,814] pool_pre_ping=True was set to engine_kwargs to prevent connection timeout.\r\n[I 2020-03-12 01:53:42,983] A new study created with name: no-name-b864bada-4009-4d05-9688-f1ce11e58069\r\nx1 5.748453169544563\r\n[I 2020-03-12 01:53:43,283] Finished trial#0 resulted in value: 0.5601821470013022. Current best value is 0.560182 with parameters: {'x1': 5.74845}.\r\n/Users/a14737/src/github.com/pfnet/optuna/optuna/_experimental.py:83: ExperimentalWarning: enqueue_trial is experimental (supported from v1.2.0). The interface can change in the future.\r\n  warnings.warn(\r\n[D 2020-03-12 01:53:44,005] Trial#1 is popped from the trial queue.\r\n[D 2020-03-12 01:53:44,046] Trial#2 is popped from the trial queue.\r\n[D 2020-03-12 01:53:44,106] Trial#3 is popped from the trial queue.\r\n[D 2020-03-12 01:53:44,151] Trial#4 is popped from the trial queue.\r\n[D 2020-03-12 01:53:44,204] Trial#5 is popped from the trial queue.\r\n[D 2020-03-12 01:53:44,241] Trial#6 is popped from the trial queue.\r\n[D 2020-03-12 01:53:44,289] Trial#7 is popped from the trial queue.\r\nx1 0\r\n[D 2020-03-12 01:53:44,399] Trial#8 is popped from the trial queue.\r\n[D 2020-03-12 01:53:44,466] Trial#9 is popped from the trial queue.\r\nx1 1\r\n[D 2020-03-12 01:53:44,552] Trial#10 is popped from the trial queue.\r\nx1 2\r\nx1 3\r\nx1 5\r\n[I 2020-03-12 01:53:44,828] Finished trial#1 resulted in value: 25.0. Current best value is 0.560182 with parameters: {'x1': 5.74845}.\r\nx1 4\r\n[I 2020-03-12 01:53:44,911] Finished trial#2 resulted in value: 16.0. Current best value is 0.560182 with parameters: {'x1': 5.74845}.\r\nx1 6\r\n[I 2020-03-12 01:53:45,027] Finished trial#3 resulted in value: 9.0. Current best value is 0.560182 with parameters: {'x1': 5.74845}.\r\nx1 7\r\nx1 9\r\nx1 8\r\n[I 2020-03-12 01:53:45,213] Finished trial#4 resulted in value: 4.0. Current best value is 0.560182 with parameters: {'x1': 5.0}.\r\n[I 2020-03-12 01:53:45,278] Finished trial#5 resulted in value: 1.0. Current best value is 0.0 with parameters: {'x1': 5.0}.\r\n[I 2020-03-12 01:53:45,297] Finished trial#7 resulted in value: 1.0. Current best value is 0.0 with parameters: {'x1': 5.0}.\r\n[I 2020-03-12 01:53:45,298] Finished trial#6 resulted in value: 0.0. Current best value is 0.0 with parameters: {'x1': 5.0}.\r\n[I 2020-03-12 01:53:45,354] Finished trial#8 resulted in value: 4.0. Current best value is 0.0 with parameters: {'x1': 5.0}.\r\n[I 2020-03-12 01:53:45,355] Finished trial#9 resulted in value: 9.0. Current best value is 0.0 with parameters: {'x1': 5.0}.\r\n[I 2020-03-12 01:53:45,365] Finished trial#10 resulted in value: 16.0. Current best value is 0.0 with parameters: {'x1': 5.0}.\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1014/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1014/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/1000", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/1000/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/1000/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/1000/events", "html_url": "https://github.com/optuna/optuna/issues/1000", "id": 577654784, "node_id": "MDU6SXNzdWU1Nzc2NTQ3ODQ=", "number": 1000, "title": "Dashboard (beta) does not work with `bokeh==2.0.0`.", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-03-09T04:42:31Z", "updated_at": "2020-05-08T04:08:54Z", "closed_at": "2020-05-08T04:08:54Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "## Environment\r\n\r\n- Optuna version: 1.2.0\r\n- Python version: 3.7.2\r\n- OS: macOS 10.13.6\r\n- (Optional) Other libraries and their versions: pytorch_lightning==0.7.1\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```console\r\npytest tests/test_cli.py\r\n```\r\n\r\n```console\r\ntests/test_cli.py:224: \r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n\r\npopenargs = (['optuna', 'dashboard', '--study', 'no-name-eeca02bc-68ac-4d96-9805-370fc70e13ac', '--out', '/tmp/tmpzkcptkmq', ...],)\r\nkwargs = {}, retcode = 2\r\ncmd = ['optuna', 'dashboard', '--study', 'no-name-eeca02bc-68ac-4d96-9805-370fc70e13ac', '--out', '/tmp/tmpzkcptkmq', ...]\r\n\r\n    def check_call(*popenargs, **kwargs):\r\n        \"\"\"Run command with arguments.  Wait for command to complete.  If\r\n        the exit code was zero then return, otherwise raise\r\n        CalledProcessError.  The CalledProcessError object will have the\r\n        return code in the returncode attribute.\r\n    \r\n        The arguments are the same as for the call function.  Example:\r\n    \r\n        check_call([\"ls\", \"-l\"])\r\n        \"\"\"\r\n        retcode = call(*popenargs, **kwargs)\r\n        if retcode:\r\n            cmd = kwargs.get(\"args\")\r\n            if cmd is None:\r\n                cmd = popenargs[0]\r\n>           raise CalledProcessError(retcode, cmd)\r\nE           subprocess.CalledProcessError: Command '['optuna', 'dashboard', '--study', 'no-name-eeca02bc-68ac-4d96-9805-370fc70e13ac', '--out', '/tmp/tmpzkcptkmq', '--storage', 'sqlite:////tmp/tmp19f50p6m']' returned non-zero exit status 2.\r\n\r\n/usr/local/lib/python3.8/subprocess.py:364: CalledProcessError\r\n----------------------------- Captured stderr call -----------------------------\r\n[I 2020-03-09 03:53:42,580] A new study created with name: no-name-eeca02bc-68ac-4d96-9805-370fc70e13ac\r\n[W 2020-03-09 03:53:43,790] Optuna dashboard is still highly experimental. Please use with caution!\r\nusage: bokeh [-h] [-v]\r\n             {build,info,init,json,sampledata,secret,serve,static} ...\r\nbokeh: error: invalid choice: 'html' (choose from 'build', 'info', 'init', 'json', 'sampledata', 'secret', 'serve', 'static')\r\n```\r\n\r\n## Additional context (optional)\r\n\r\n- The dashboard is in the beta-phase. Do we update the current implementation? Or do we create a new one?", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/1000/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/1000/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/997", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/997/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/997/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/997/events", "html_url": "https://github.com/optuna/optuna/issues/997", "id": 577635883, "node_id": "MDU6SXNzdWU1Nzc2MzU4ODM=", "number": 997, "title": "`optuna.integration.PyTorchLightningPruningCallback` does not work with `pytorch_lightning==0.7.1`.", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-03-09T03:30:07Z", "updated_at": "2020-04-30T07:31:23Z", "closed_at": "2020-04-30T07:31:23Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "## Environment\r\n\r\n- Optuna version: 1.2.0\r\n- Python version: 3.7.2\r\n- OS: macOS 10.13.6\r\n- (Optional) Other libraries and their versions: pytorch_lightning==0.7.1\r\n\r\n## Error messages, stack traces, or logs\r\n\r\nCommand\r\n```console\r\npytest tests/integration_tests/test_pytorch_lightning.py\r\n```\r\n\r\nError message:\r\n```console\r\nself = <optuna.integration.pytorch_lightning.PyTorchLightningPruningCallback object at 0x7f2194069a20>\r\nlogs = {'accuracy': 0.0}\r\n\r\n    def check_metrics(self, logs):\r\n        monitor_val = logs.get(self.monitor)\r\n        error_msg = (f'Early stopping conditioned on metric `{self.monitor}`'\r\n                     f' which is not available. Available metrics are:'\r\n                     f' `{\"`, `\".join(list(logs.keys()))}`')\r\n    \r\n        if monitor_val is None:\r\n            if self.strict:\r\n>               raise RuntimeError(error_msg)\r\nE               RuntimeError: Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: `accuracy`\r\n\r\nvenv/lib/python3.6/site-packages/pytorch_lightning/callbacks/early_stopping.py:81: RuntimeError\r\n\r\n```\r\n\r\n## Additional context\r\n\r\nThe base class of `PyTorchLightningPruningCallback` (i.e., `EarlyStopping`) is updated by 0.7.x.\r\nFor example,\r\n1. the `check_metrics` method is newly added, and\r\n1. the arguments of `on_epoch_end` are changed.\r\n\r\nFor further details, please refer to the following code:\r\n- https://github.com/PyTorchLightning/pytorch-lightning/blob/0.7.1/pytorch_lightning/callbacks/early_stopping.py\r\n- https://github.com/PyTorchLightning/pytorch-lightning/blob/0.5.3.3/pytorch_lightning/callbacks/pt_callbacks.py\r\n\r\nTo resolve this issue, we may need to consider backward compatibility. Do we support both v0.7.x and 0.5.x?", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/997/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/997/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/941", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/941/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/941/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/941/events", "html_url": "https://github.com/optuna/optuna/pull/941", "id": 566968052, "node_id": "MDExOlB1bGxSZXF1ZXN0Mzc2Njc5NzE4", "number": 941, "title": "Use `weakref.finalize` instead of `__del__` for `RDBStorage`.", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/21", "html_url": "https://github.com/optuna/optuna/milestone/21", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/21/labels", "id": 5077081, "node_id": "MDk6TWlsZXN0b25lNTA3NzA4MQ==", "number": 21, "title": "v1.2.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 44, "state": "closed", "created_at": "2020-02-06T02:03:34Z", "updated_at": "2020-03-05T01:52:29Z", "due_on": null, "closed_at": "2020-03-05T01:52:29Z"}, "comments": 3, "created_at": "2020-02-18T15:23:55Z", "updated_at": "2020-03-05T01:27:16Z", "closed_at": "2020-02-21T06:06:20Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/941", "html_url": "https://github.com/optuna/optuna/pull/941", "diff_url": "https://github.com/optuna/optuna/pull/941.diff", "patch_url": "https://github.com/optuna/optuna/pull/941.patch", "merged_at": "2020-02-21T06:06:20Z"}, "body": "This PR addresses https://github.com/optuna/optuna/issues/938.\r\n\r\nCurrently, `RDBStorage` uses `__del__` to remove sessions when the program ends. But, the execution of `__del__` is not guaranteed according to the reference of [`__del__`](https://docs.python.org/3/reference/datamodel.html#object.__del__).\r\n\r\n> It is not guaranteed that __del__() methods are called for objects that still exist when the interpreter exits.\r\n\r\nIn the case of https://github.com/optuna/optuna/issues/938, the Python 3.8 with `ipython` or `jupyter` affects the timing of the call of `RDBStorage.__del__()`, and it causes the errors.\r\n\r\nPlease take a look at a log of `python -v 938.py`. (`938.py` can be found in https://github.com/optuna/optuna/issues/938#issuecomment-587322175.)\r\n```\r\n...\r\n# destroy sqlalchemy.orm.state\r\n...\r\n# cleanup[3] wiping __mp_main__\r\nException ignored in: <function RDBStorage.__del__ at 0x7f352b1c6310>\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.8/site-packages/optuna/storages/rdb/storage.py\", line 943, in __del__\r\n  File \"/usr/local/lib/python3.8/site-packages/optuna/storages/rdb/storage.py\", line 932, in remove_session\r\n...\r\n  File \"/usr/local/lib/python3.8/site-packages/sqlalchemy/orm/session.py\", line 1352, in expunge_all\r\nAttributeError: 'NoneType' object has no attribute 'InstanceState'\r\n```\r\n\r\n`RDBStorage.__del__` tried to access `state.InstanceState` ([here](https://github.com/sqlalchemy/sqlalchemy/blob/master/lib/sqlalchemy/orm/session.py#L1360)), but `sqlalchemy.orm.state` was destroyed at that time. I don't think this is expected behavior, but it would be safe if we explicitly remove the sessions.\r\n\r\nThis PR uses `weakref.finalize` instead of `__del__` as shown in [the reference of weakref](https://docs.python.org/3/library/weakref.html#comparing-finalizers-with-del-methods).\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/941/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/941/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/938", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/938/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/938/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/938/events", "html_url": "https://github.com/optuna/optuna/issues/938", "id": 566651988, "node_id": "MDU6SXNzdWU1NjY2NTE5ODg=", "number": 938, "title": "AttributeError is raised when using RDB storage.", "user": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2020-02-18T05:13:49Z", "updated_at": "2020-02-21T06:06:33Z", "closed_at": "2020-02-21T06:06:33Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\n\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\nimport optuna\r\n\r\n# Define a simple 2-dimensional objective function whose minimum value is -1 when (x, y) = (0, -1).\r\ndef objective(trial):\r\n    x = trial.suggest_uniform('x', -100, 100)\r\n    y = trial.suggest_categorical('y', [-1, 0, 1])\r\n    return x**2 + y\r\n\r\n\r\nif __name__ == '__main__':\r\n    # Let us minimize the objective function above.\r\n    print('Running 10 trials...')\r\n    study = optuna.create_study(storage=\"sqlite:///db.sqlite3\")\r\n    study.optimize(objective, n_trials=10)\r\n    print('Best value: {} (params: {})\\n'.format(study.best_value, study.best_params))\r\n```\r\n\r\n## Expected behavior\r\n\r\ntag: v1.1.0\r\n\r\n```console\r\n$ git co v1.1.0\r\n$ python examples/quadratic_simple.py \r\nRunning 10 trials...\r\n[I 2020-02-18 14:05:57,875] A new study created with name: no-name-a2889f9d-79d7-40cc-aff4-f4021183b6aa\r\n[I 2020-02-18 14:05:57,977] Finished trial#0 resulted in value: 78.25382960871015. Current best value is 78.25382960871015 with parameters: {'x': -8.78941577175128, 'y': 1}.\r\n[I 2020-02-18 14:05:58,067] Finished trial#1 resulted in value: 1601.2080527969047. Current best value is 78.25382960871015 with parameters: {'x': -8.78941577175128, 'y': 1}.\r\n[I 2020-02-18 14:05:58,159] Finished trial#2 resulted in value: 155.3355136572432. Current best value is 78.25382960871015 with parameters: {'x': -8.78941577175128, 'y': 1}.\r\n[I 2020-02-18 14:05:58,252] Finished trial#3 resulted in value: 4928.445801453334. Current best value is 78.25382960871015 with parameters: {'x': -8.78941577175128, 'y': 1}.\r\n[I 2020-02-18 14:05:58,349] Finished trial#4 resulted in value: 5494.046052713425. Current best value is 78.25382960871015 with parameters: {'x': -8.78941577175128, 'y': 1}.\r\n[I 2020-02-18 14:05:58,451] Finished trial#5 resulted in value: 7.806334896764313. Current best value is 7.806334896764313 with parameters: {'x': -2.793981907021646, 'y': 0}.\r\n[I 2020-02-18 14:05:58,540] Finished trial#6 resulted in value: 3581.7294062867. Current best value is 7.806334896764313 with parameters: {'x': -2.793981907021646, 'y': 0}.\r\n[I 2020-02-18 14:05:58,633] Finished trial#7 resulted in value: 6157.892248662727. Current best value is 7.806334896764313 with parameters: {'x': -2.793981907021646, 'y': 0}.\r\n[I 2020-02-18 14:05:58,729] Finished trial#8 resulted in value: 538.9770074142994. Current best value is 7.806334896764313 with parameters: {'x': -2.793981907021646, 'y': 0}.\r\n[I 2020-02-18 14:05:58,824] Finished trial#9 resulted in value: 2453.3913002520094. Current best value is 7.806334896764313 with parameters: {'x': -2.793981907021646, 'y': 0}.\r\nBest value: 7.806334896764313 (params: {'x': -2.793981907021646, 'y': 0})\r\n```\r\n\r\n## Error log\r\n\r\nrev: 7344ee0f\r\n\r\n```console\r\n$ git co master\r\n$ rm db.sqlite3 | true && python examples/quadratic_simple.py \r\nRunning 10 trials...\r\n[I 2020-02-18 14:06:51,506] A new study created with name: no-name-32a1bb2f-64c7-4faa-8834-0bbdbaff508b\r\n[I 2020-02-18 14:06:51,635] Finished trial#0 resulted in value: 2420.888780807176. Current best value is 2420.888780807176 with parameters: {'x': -49.192365066208964, 'y': 1}.\r\n[I 2020-02-18 14:06:51,746] Finished trial#1 resulted in value: 145.24171551709355. Current best value is 145.24171551709355 with parameters: {'x': 12.093044096384233, 'y': -1}.\r\n[I 2020-02-18 14:06:51,857] Finished trial#2 resulted in value: 1.014598248626613. Current best value is 1.014598248626613 with parameters: {'x': -0.12082321228395188, 'y': 1}.\r\n[I 2020-02-18 14:06:51,957] Finished trial#3 resulted in value: 8577.24930691218. Current best value is 1.014598248626613 with parameters: {'x': -0.12082321228395188, 'y': 1}.\r\n[I 2020-02-18 14:06:52,068] Finished trial#4 resulted in value: 8417.027436775961. Current best value is 1.014598248626613 with parameters: {'x': -0.12082321228395188, 'y': 1}.\r\n[I 2020-02-18 14:06:52,181] Finished trial#5 resulted in value: 319.0475577707139. Current best value is 1.014598248626613 with parameters: {'x': -0.12082321228395188, 'y': 1}.\r\n[I 2020-02-18 14:06:52,288] Finished trial#6 resulted in value: 4.4949007058993296. Current best value is 1.014598248626613 with parameters: {'x': -0.12082321228395188, 'y': 1}.\r\n[I 2020-02-18 14:06:52,391] Finished trial#7 resulted in value: 2865.4595762936938. Current best value is 1.014598248626613 with parameters: {'x': -0.12082321228395188, 'y': 1}.\r\n[I 2020-02-18 14:06:52,500] Finished trial#8 resulted in value: 2027.0173870485705. Current best value is 1.014598248626613 with parameters: {'x': -0.12082321228395188, 'y': 1}.\r\n[I 2020-02-18 14:06:52,605] Finished trial#9 resulted in value: 7283.744078340451. Current best value is 1.014598248626613 with parameters: {'x': -0.12082321228395188, 'y': 1}.\r\nBest value: 1.014598248626613 (params: {'x': -0.12082321228395188, 'y': 1})\r\n\r\nException ignored in: <function RDBStorage.__del__ at 0x130bd7ca0>\r\nTraceback (most recent call last):\r\n  File \"/Users/a14737/src/github.com/pfnet/optuna/optuna/storages/rdb/storage.py\", line 943, in __del__\r\n  File \"/Users/a14737/src/github.com/pfnet/optuna/optuna/storages/rdb/storage.py\", line 932, in remove_session\r\n  File \"/Users/a14737/src/github.com/pfnet/optuna/venv/lib/python3.8/site-packages/SQLAlchemy-1.3.12-py3.8-macosx-10.15-x86_64.egg/sqlalchemy/orm/scoping.py\", line 94, in remove\r\n  File \"/Users/a14737/src/github.com/pfnet/optuna/venv/lib/python3.8/site-packages/SQLAlchemy-1.3.12-py3.8-macosx-10.15-x86_64.egg/sqlalchemy/orm/session.py\", line 1298, in close\r\n  File \"/Users/a14737/src/github.com/pfnet/optuna/venv/lib/python3.8/site-packages/SQLAlchemy-1.3.12-py3.8-macosx-10.15-x86_64.egg/sqlalchemy/orm/session.py\", line 1334, in _close_impl\r\n  File \"/Users/a14737/src/github.com/pfnet/optuna/venv/lib/python3.8/site-packages/SQLAlchemy-1.3.12-py3.8-macosx-10.15-x86_64.egg/sqlalchemy/orm/session.py\", line 1352, in expunge_all\r\nAttributeError: 'NoneType' object has no attribute 'InstanceState'\r\n\r\n```\r\n\r\n## Environment\r\n\r\n- Optuna version: 1.2.0 (master branch, rev: 7344ee0f).\r\n- Python version: 3.8.1\r\n- OS: macOS\r\n- (Optional) Other libraries and their versions:\r\n\r\n## Steps to reproduce\r\n\r\n1. Optimize with RDB storage backend.\r\n\r\n\r\n## Additional context (optional)\r\n\r\n<!-- Please add any other context or screenshots about the problem here. -->\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/938/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/938/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/917", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/917/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/917/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/917/events", "html_url": "https://github.com/optuna/optuna/pull/917", "id": 563733276, "node_id": "MDExOlB1bGxSZXF1ZXN0Mzc0MDkxNzMz", "number": 917, "title": "Fix a TPE implementation on `DiscreteUniformDistribution`.", "user": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/21", "html_url": "https://github.com/optuna/optuna/milestone/21", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/21/labels", "id": 5077081, "node_id": "MDk6TWlsZXN0b25lNTA3NzA4MQ==", "number": 21, "title": "v1.2.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 44, "state": "closed", "created_at": "2020-02-06T02:03:34Z", "updated_at": "2020-03-05T01:52:29Z", "due_on": null, "closed_at": "2020-03-05T01:52:29Z"}, "comments": 4, "created_at": "2020-02-12T03:52:38Z", "updated_at": "2020-03-05T01:27:37Z", "closed_at": "2020-02-17T01:05:52Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/917", "html_url": "https://github.com/optuna/optuna/pull/917", "diff_url": "https://github.com/optuna/optuna/pull/917.diff", "patch_url": "https://github.com/optuna/optuna/pull/917.patch", "merged_at": "2020-02-17T01:05:52Z"}, "body": "I executed an example which is used at #916.\r\n\r\n```python\r\nimport optuna\r\nimport pprint\r\n\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_discrete_uniform('x', -10, 10, q=2.0)\r\n    y = trial.suggest_discrete_uniform('y', -10, 10, q=2.0)\r\n    return (x-8)**2 + (y+8)**2\r\n\r\n\r\nif __name__ == '__main__':\r\n    study = optuna.create_study(sampler=optuna.samplers.TPESampler(seed=0))\r\n    study.optimize(objective, n_trials=40)\r\n    pprint.pprint([t.params for t in study.trials])\r\n    print('Best value: {} (params: {})\\n'.format(study.best_value, study.best_params))\r\n```\r\n\r\nThe best trials is `Best value: 0.0 (params: {'x': 8.0, 'y': -8.0})`.\r\n\r\n<details>\r\n\r\n<summary>execution log</summary>\r\n\r\n```console\r\n$ python examples/quadratic_simple.py \r\n[I 2020-02-12 12:51:39,173] Finished trial#0 resulted in value: 180.0. Current best value is 180.0 with parameters: {'x': 2.0, 'y': 4.0}.\r\n[I 2020-02-12 12:51:39,196] Finished trial#1 resulted in value: 100.0. Current best value is 100.0 with parameters: {'x': 2.0, 'y': 0.0}.\r\n[I 2020-02-12 12:51:39,219] Finished trial#2 resulted in value: 244.0. Current best value is 100.0 with parameters: {'x': 2.0, 'y': 0.0}.\r\n[I 2020-02-12 12:51:39,241] Finished trial#3 resulted in value: 356.0. Current best value is 100.0 with parameters: {'x': 2.0, 'y': 0.0}.\r\n[I 2020-02-12 12:51:39,264] Finished trial#4 resulted in value: 40.0. Current best value is 40.0 with parameters: {'x': 10.0, 'y': -2.0}.\r\n[I 2020-02-12 12:51:39,288] Finished trial#5 resulted in value: 68.0. Current best value is 40.0 with parameters: {'x': 10.0, 'y': -2.0}.\r\n[I 2020-02-12 12:51:39,312] Finished trial#6 resulted in value: 360.0. Current best value is 40.0 with parameters: {'x': 10.0, 'y': -2.0}.\r\n[I 2020-02-12 12:51:39,335] Finished trial#7 resulted in value: 328.0. Current best value is 40.0 with parameters: {'x': 10.0, 'y': -2.0}.\r\n[I 2020-02-12 12:51:39,358] Finished trial#8 resulted in value: 580.0. Current best value is 40.0 with parameters: {'x': 10.0, 'y': -2.0}.\r\n[I 2020-02-12 12:51:39,381] Finished trial#9 resulted in value: 260.0. Current best value is 40.0 with parameters: {'x': 10.0, 'y': -2.0}.\r\n[I 2020-02-12 12:51:39,408] Finished trial#10 resulted in value: 4.0. Current best value is 4.0 with parameters: {'x': 10.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:39,435] Finished trial#11 resulted in value: 8.0. Current best value is 4.0 with parameters: {'x': 10.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:39,462] Finished trial#12 resulted in value: 8.0. Current best value is 4.0 with parameters: {'x': 10.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:39,491] Finished trial#13 resulted in value: 4.0. Current best value is 4.0 with parameters: {'x': 10.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:39,518] Finished trial#14 resulted in value: 8.0. Current best value is 4.0 with parameters: {'x': 10.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:39,548] Finished trial#15 resulted in value: 4.0. Current best value is 4.0 with parameters: {'x': 10.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:39,575] Finished trial#16 resulted in value: 200.0. Current best value is 4.0 with parameters: {'x': 10.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:39,603] Finished trial#17 resulted in value: 20.0. Current best value is 4.0 with parameters: {'x': 10.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:39,630] Finished trial#18 resulted in value: 16.0. Current best value is 4.0 with parameters: {'x': 10.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:39,658] Finished trial#19 resulted in value: 20.0. Current best value is 4.0 with parameters: {'x': 10.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:39,686] Finished trial#20 resulted in value: 36.0. Current best value is 4.0 with parameters: {'x': 10.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:39,713] Finished trial#21 resulted in value: 0.0. Current best value is 0.0 with parameters: {'x': 8.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:39,740] Finished trial#22 resulted in value: 0.0. Current best value is 0.0 with parameters: {'x': 8.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:39,767] Finished trial#23 resulted in value: 16.0. Current best value is 0.0 with parameters: {'x': 8.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:39,795] Finished trial#24 resulted in value: 0.0. Current best value is 0.0 with parameters: {'x': 8.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:39,822] Finished trial#25 resulted in value: 16.0. Current best value is 0.0 with parameters: {'x': 8.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:39,852] Finished trial#26 resulted in value: 68.0. Current best value is 0.0 with parameters: {'x': 8.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:39,881] Finished trial#27 resulted in value: 0.0. Current best value is 0.0 with parameters: {'x': 8.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:39,909] Finished trial#28 resulted in value: 20.0. Current best value is 0.0 with parameters: {'x': 8.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:39,938] Finished trial#29 resulted in value: 160.0. Current best value is 0.0 with parameters: {'x': 8.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:39,967] Finished trial#30 resulted in value: 100.0. Current best value is 0.0 with parameters: {'x': 8.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:39,995] Finished trial#31 resulted in value: 0.0. Current best value is 0.0 with parameters: {'x': 8.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:40,024] Finished trial#32 resulted in value: 4.0. Current best value is 0.0 with parameters: {'x': 8.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:40,054] Finished trial#33 resulted in value: 4.0. Current best value is 0.0 with parameters: {'x': 8.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:40,082] Finished trial#34 resulted in value: 36.0. Current best value is 0.0 with parameters: {'x': 8.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:40,111] Finished trial#35 resulted in value: 104.0. Current best value is 0.0 with parameters: {'x': 8.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:40,139] Finished trial#36 resulted in value: 20.0. Current best value is 0.0 with parameters: {'x': 8.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:40,168] Finished trial#37 resulted in value: 148.0. Current best value is 0.0 with parameters: {'x': 8.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:40,196] Finished trial#38 resulted in value: 40.0. Current best value is 0.0 with parameters: {'x': 8.0, 'y': -8.0}.\r\n[I 2020-02-12 12:51:40,224] Finished trial#39 resulted in value: 36.0. Current best value is 0.0 with parameters: {'x': 8.0, 'y': -8.0}.\r\n[{'x': 2.0, 'y': 4.0},\r\n {'x': 2.0, 'y': 0.0},\r\n {'x': -2.0, 'y': 4.0},\r\n {'x': -2.0, 'y': 8.0},\r\n {'x': 10.0, 'y': -2.0},\r\n {'x': 6.0, 'y': 0.0},\r\n {'x': 2.0, 'y': 10.0},\r\n {'x': -10.0, 'y': -10.0},\r\n {'x': -10.0, 'y': 8.0},\r\n {'x': 6.0, 'y': 8.0},\r\n {'x': 10.0, 'y': -8.0},\r\n {'x': 10.0, 'y': -10.0},\r\n {'x': 10.0, 'y': -10.0},\r\n {'x': 8.0, 'y': -6.0},\r\n {'x': 6.0, 'y': -6.0},\r\n {'x': 8.0, 'y': -6.0},\r\n {'x': -6.0, 'y': -6.0},\r\n {'x': 6.0, 'y': -4.0},\r\n {'x': 8.0, 'y': -4.0},\r\n {'x': 4.0, 'y': -6.0},\r\n {'x': 8.0, 'y': -2.0},\r\n {'x': 8.0, 'y': -8.0},\r\n {'x': 8.0, 'y': -8.0},\r\n {'x': 4.0, 'y': -8.0},\r\n {'x': 8.0, 'y': -8.0},\r\n {'x': 4.0, 'y': -8.0},\r\n {'x': 0.0, 'y': -10.0},\r\n {'x': 8.0, 'y': -8.0},\r\n {'x': 10.0, 'y': -4.0},\r\n {'x': 4.0, 'y': 4.0},\r\n {'x': 0.0, 'y': -2.0},\r\n {'x': 8.0, 'y': -8.0},\r\n {'x': 6.0, 'y': -8.0},\r\n {'x': 8.0, 'y': -10.0},\r\n {'x': 2.0, 'y': -8.0},\r\n {'x': 10.0, 'y': 2.0},\r\n {'x': 6.0, 'y': -4.0},\r\n {'x': -4.0, 'y': -10.0},\r\n {'x': 2.0, 'y': -6.0},\r\n {'x': 8.0, 'y': -2.0}]\r\nBest value: 0.0 (params: {'x': 8.0, 'y': -8.0})\r\n```\r\n\r\n</details>\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/917/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/917/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/916", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/916/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/916/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/916/events", "html_url": "https://github.com/optuna/optuna/issues/916", "id": 563728410, "node_id": "MDU6SXNzdWU1NjM3Mjg0MTA=", "number": 916, "title": "Problem of TPE optimization with `DiscreteUniformDistribution`", "user": {"login": "c-bata", "id": 5564044, "node_id": "MDQ6VXNlcjU1NjQwNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5564044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/c-bata", "html_url": "https://github.com/c-bata", "followers_url": "https://api.github.com/users/c-bata/followers", "following_url": "https://api.github.com/users/c-bata/following{/other_user}", "gists_url": "https://api.github.com/users/c-bata/gists{/gist_id}", "starred_url": "https://api.github.com/users/c-bata/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/c-bata/subscriptions", "organizations_url": "https://api.github.com/users/c-bata/orgs", "repos_url": "https://api.github.com/users/c-bata/repos", "events_url": "https://api.github.com/users/c-bata/events{/privacy}", "received_events_url": "https://api.github.com/users/c-bata/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-02-12T03:36:09Z", "updated_at": "2020-02-17T01:31:48Z", "closed_at": "2020-02-17T01:31:18Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I suspect that the implementation of TPE with `DiscreteUniformDistribution` has a problem when building its surrogate model. To check the problem, I prepare the following simple snippet:\r\n\r\n```python\r\nimport optuna\r\nimport pprint\r\n\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_discrete_uniform('x', -10, 10, q=2.0)\r\n    y = trial.suggest_discrete_uniform('y', -10, 10, q=2.0)\r\n    return (x-8)**2 + (y+8)**2\r\n\r\n\r\nif __name__ == '__main__':\r\n    study = optuna.create_study(sampler=optuna.samplers.TPESampler(seed=0))\r\n    study.optimize(objective, n_trials=40)\r\n    pprint.pprint([t.params for t in study.trials])\r\n    print('Best value: {} (params: {})\\n'.format(study.best_value, study.best_params))\r\n```\r\n\r\nThe best_params is `Best value: 8.0 (params: {'x': 6.0, 'y': -10.0})`. And the execution log is following.\r\n\r\n<details>\r\n\r\n<summary>execution log</summary>\r\n\r\n```console\r\n $ python examples/quadratic_simple.py \r\n[I 2020-02-12 12:26:48,488] Finished trial#0 resulted in value: 180.0. Current best value is 180.0 with parameters: {'x': 2.0, 'y': 4.0}.\r\n[I 2020-02-12 12:26:48,510] Finished trial#1 resulted in value: 100.0. Current best value is 100.0 with parameters: {'x': 2.0, 'y': 0.0}.\r\n[I 2020-02-12 12:26:48,533] Finished trial#2 resulted in value: 244.0. Current best value is 100.0 with parameters: {'x': 2.0, 'y': 0.0}.\r\n[I 2020-02-12 12:26:48,555] Finished trial#3 resulted in value: 356.0. Current best value is 100.0 with parameters: {'x': 2.0, 'y': 0.0}.\r\n[I 2020-02-12 12:26:48,579] Finished trial#4 resulted in value: 40.0. Current best value is 40.0 with parameters: {'x': 10.0, 'y': -2.0}.\r\n[I 2020-02-12 12:26:48,601] Finished trial#5 resulted in value: 68.0. Current best value is 40.0 with parameters: {'x': 10.0, 'y': -2.0}.\r\n[I 2020-02-12 12:26:48,624] Finished trial#6 resulted in value: 360.0. Current best value is 40.0 with parameters: {'x': 10.0, 'y': -2.0}.\r\n[I 2020-02-12 12:26:48,648] Finished trial#7 resulted in value: 328.0. Current best value is 40.0 with parameters: {'x': 10.0, 'y': -2.0}.\r\n[I 2020-02-12 12:26:48,670] Finished trial#8 resulted in value: 580.0. Current best value is 40.0 with parameters: {'x': 10.0, 'y': -2.0}.\r\n[I 2020-02-12 12:26:48,693] Finished trial#9 resulted in value: 260.0. Current best value is 40.0 with parameters: {'x': 10.0, 'y': -2.0}.\r\n[I 2020-02-12 12:26:48,719] Finished trial#10 resulted in value: 256.0. Current best value is 40.0 with parameters: {'x': 10.0, 'y': -2.0}.\r\n[I 2020-02-12 12:26:48,746] Finished trial#11 resulted in value: 328.0. Current best value is 40.0 with parameters: {'x': 10.0, 'y': -2.0}.\r\n[I 2020-02-12 12:26:48,772] Finished trial#12 resulted in value: 256.0. Current best value is 40.0 with parameters: {'x': 10.0, 'y': -2.0}.\r\n[I 2020-02-12 12:26:48,799] Finished trial#13 resulted in value: 328.0. Current best value is 40.0 with parameters: {'x': 10.0, 'y': -2.0}.\r\n[I 2020-02-12 12:26:48,827] Finished trial#14 resulted in value: 200.0. Current best value is 40.0 with parameters: {'x': 10.0, 'y': -2.0}.\r\n[I 2020-02-12 12:26:48,853] Finished trial#15 resulted in value: 324.0. Current best value is 40.0 with parameters: {'x': 10.0, 'y': -2.0}.\r\n[I 2020-02-12 12:26:48,881] Finished trial#16 resulted in value: 328.0. Current best value is 40.0 with parameters: {'x': 10.0, 'y': -2.0}.\r\n[I 2020-02-12 12:26:48,907] Finished trial#17 resulted in value: 8.0. Current best value is 8.0 with parameters: {'x': 6.0, 'y': -10.0}.\r\n[I 2020-02-12 12:26:48,935] Finished trial#18 resulted in value: 328.0. Current best value is 8.0 with parameters: {'x': 6.0, 'y': -10.0}.\r\n[I 2020-02-12 12:26:48,965] Finished trial#19 resulted in value: 328.0. Current best value is 8.0 with parameters: {'x': 6.0, 'y': -10.0}.\r\n[I 2020-02-12 12:26:48,999] Finished trial#20 resulted in value: 328.0. Current best value is 8.0 with parameters: {'x': 6.0, 'y': -10.0}.\r\n[I 2020-02-12 12:26:49,034] Finished trial#21 resulted in value: 256.0. Current best value is 8.0 with parameters: {'x': 6.0, 'y': -10.0}.\r\n[I 2020-02-12 12:26:49,063] Finished trial#22 resulted in value: 260.0. Current best value is 8.0 with parameters: {'x': 6.0, 'y': -10.0}.\r\n[I 2020-02-12 12:26:49,092] Finished trial#23 resulted in value: 212.0. Current best value is 8.0 with parameters: {'x': 6.0, 'y': -10.0}.\r\n[I 2020-02-12 12:26:49,120] Finished trial#24 resulted in value: 272.0. Current best value is 8.0 with parameters: {'x': 6.0, 'y': -10.0}.\r\n[I 2020-02-12 12:26:49,148] Finished trial#25 resulted in value: 260.0. Current best value is 8.0 with parameters: {'x': 6.0, 'y': -10.0}.\r\n[I 2020-02-12 12:26:49,177] Finished trial#26 resulted in value: 272.0. Current best value is 8.0 with parameters: {'x': 6.0, 'y': -10.0}.\r\n[I 2020-02-12 12:26:49,203] Finished trial#27 resulted in value: 272.0. Current best value is 8.0 with parameters: {'x': 6.0, 'y': -10.0}.\r\n[I 2020-02-12 12:26:49,232] Finished trial#28 resulted in value: 212.0. Current best value is 8.0 with parameters: {'x': 6.0, 'y': -10.0}.\r\n[I 2020-02-12 12:26:49,260] Finished trial#29 resulted in value: 212.0. Current best value is 8.0 with parameters: {'x': 6.0, 'y': -10.0}.\r\n[I 2020-02-12 12:26:49,291] Finished trial#30 resulted in value: 212.0. Current best value is 8.0 with parameters: {'x': 6.0, 'y': -10.0}.\r\n[I 2020-02-12 12:26:49,318] Finished trial#31 resulted in value: 8.0. Current best value is 8.0 with parameters: {'x': 6.0, 'y': -10.0}.\r\n[I 2020-02-12 12:26:49,347] Finished trial#32 resulted in value: 20.0. Current best value is 8.0 with parameters: {'x': 6.0, 'y': -10.0}.\r\n[I 2020-02-12 12:26:49,378] Finished trial#33 resulted in value: 272.0. Current best value is 8.0 with parameters: {'x': 6.0, 'y': -10.0}.\r\n[I 2020-02-12 12:26:49,409] Finished trial#34 resulted in value: 340.0. Current best value is 8.0 with parameters: {'x': 6.0, 'y': -10.0}.\r\n[I 2020-02-12 12:26:49,441] Finished trial#35 resulted in value: 212.0. Current best value is 8.0 with parameters: {'x': 6.0, 'y': -10.0}.\r\n[I 2020-02-12 12:26:49,471] Finished trial#36 resulted in value: 320.0. Current best value is 8.0 with parameters: {'x': 6.0, 'y': -10.0}.\r\n[I 2020-02-12 12:26:49,501] Finished trial#37 resulted in value: 232.0. Current best value is 8.0 with parameters: {'x': 6.0, 'y': -10.0}.\r\n[I 2020-02-12 12:26:49,532] Finished trial#38 resulted in value: 212.0. Current best value is 8.0 with parameters: {'x': 6.0, 'y': -10.0}.\r\n[I 2020-02-12 12:26:49,562] Finished trial#39 resulted in value: 212.0. Current best value is 8.0 with parameters: {'x': 6.0, 'y': -10.0}.\r\n[{'x': 2.0, 'y': 4.0},\r\n {'x': 2.0, 'y': 0.0},\r\n {'x': -2.0, 'y': 4.0},\r\n {'x': -2.0, 'y': 8.0},\r\n {'x': 10.0, 'y': -2.0},\r\n {'x': 6.0, 'y': 0.0},\r\n {'x': 2.0, 'y': 10.0},\r\n {'x': -10.0, 'y': -10.0},\r\n {'x': -10.0, 'y': 8.0},\r\n {'x': 6.0, 'y': 8.0},\r\n {'x': 8.0, 'y': 8.0},\r\n {'x': 6.0, 'y': 10.0},\r\n {'x': 8.0, 'y': 8.0},\r\n {'x': 6.0, 'y': 10.0},\r\n {'x': 6.0, 'y': 6.0},\r\n {'x': 8.0, 'y': 10.0},\r\n {'x': 6.0, 'y': 10.0},\r\n {'x': 6.0, 'y': -10.0},\r\n {'x': 6.0, 'y': 10.0},\r\n {'x': 6.0, 'y': 10.0},\r\n {'x': 6.0, 'y': 10.0},\r\n {'x': 8.0, 'y': 8.0},\r\n {'x': 6.0, 'y': 8.0},\r\n {'x': 4.0, 'y': 6.0},\r\n {'x': 4.0, 'y': 8.0},\r\n {'x': 6.0, 'y': 8.0},\r\n {'x': 4.0, 'y': 8.0},\r\n {'x': 4.0, 'y': 8.0},\r\n {'x': 4.0, 'y': 6.0},\r\n {'x': 4.0, 'y': 6.0},\r\n {'x': 4.0, 'y': 6.0},\r\n {'x': 6.0, 'y': -10.0},\r\n {'x': 4.0, 'y': -10.0},\r\n {'x': 4.0, 'y': 8.0},\r\n {'x': 4.0, 'y': 10.0},\r\n {'x': 4.0, 'y': 6.0},\r\n {'x': 0.0, 'y': 8.0},\r\n {'x': 2.0, 'y': 6.0},\r\n {'x': 4.0, 'y': 6.0},\r\n {'x': 4.0, 'y': 6.0}]\r\nBest value: 8.0 (params: {'x': 6.0, 'y': -10.0})\r\n```\r\n\r\n</details>\r\n\r\nThen I optimized the same objective function with `suggest_uniform()`.  This means the search space is wider than the previous example. But the best_value is improved (`Best value: 0.7501865899326501 (params: {'x': 8.754039799517779, 'y': -8.426157917532736})`).\r\n\r\n```python\r\nimport optuna\r\nimport pprint\r\n\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_uniform('x', -10, 10)\r\n    y = trial.suggest_uniform('y', -10, 10)\r\n    return (x-8)**2 + (y+8)**2\r\n\r\n\r\nif __name__ == '__main__':\r\n    study = optuna.create_study(sampler=optuna.samplers.TPESampler(seed=0))\r\n    study.optimize(objective, n_trials=40)\r\n    pprint.pprint([t.params for t in study.trials])\r\n    print('Best value: {} (params: {})\\n'.format(study.best_value, study.best_params))\r\n```\r\n\r\n<details>\r\n\r\n<summary>execution log</summary>\r\n\r\n```console\r\n$ python examples/quadratic_simple.py \r\n[I 2020-02-12 12:31:24,246] Finished trial#0 resulted in value: 200.71596460860084. Current best value is 200.71596460860084 with parameters: {'x': 0.9762700785464951, 'y': 4.30378732744839}.\r\n[I 2020-02-12 12:31:24,266] Finished trial#1 resulted in value: 114.50826284711097. Current best value is 114.50826284711097 with parameters: {'x': 2.055267521432878, 'y': 0.8976636599379368}.\r\n[I 2020-02-12 12:31:24,289] Finished trial#2 resulted in value: 209.9620531494761. Current best value is 114.50826284711097 with parameters: {'x': 2.055267521432878, 'y': 0.8976636599379368}.\r\n[I 2020-02-12 12:31:24,310] Finished trial#3 resulted in value: 336.2920287821092. Current best value is 114.50826284711097 with parameters: {'x': 2.055267521432878, 'y': 0.8976636599379368}.\r\n[I 2020-02-12 12:31:24,332] Finished trial#4 resulted in value: 33.75681666755005. Current best value is 33.75681666755005 with parameters: {'x': 9.273255210020587, 'y': -2.3311696234844455}.\r\n[I 2020-02-12 12:31:24,355] Finished trial#5 resulted in value: 78.26972782722031. Current best value is 33.75681666755005 with parameters: {'x': 9.273255210020587, 'y': -2.3311696234844455}.\r\n[I 2020-02-12 12:31:24,377] Finished trial#6 resulted in value: 316.7216890317852. Current best value is 33.75681666755005 with parameters: {'x': 9.273255210020587, 'y': -2.3311696234844455}.\r\n[I 2020-02-12 12:31:24,401] Finished trial#7 resulted in value: 274.938748693708. Current best value is 33.75681666755005 with parameters: {'x': 9.273255210020587, 'y': -2.3311696234844455}.\r\n[I 2020-02-12 12:31:24,422] Finished trial#8 resulted in value: 524.2990025172612. Current best value is 33.75681666755005 with parameters: {'x': 9.273255210020587, 'y': -2.3311696234844455}.\r\n[I 2020-02-12 12:31:24,445] Finished trial#9 resulted in value: 243.10579431471123. Current best value is 33.75681666755005 with parameters: {'x': 9.273255210020587, 'y': -2.3311696234844455}.\r\n[I 2020-02-12 12:31:24,470] Finished trial#10 resulted in value: 12.946457192708332. Current best value is 12.946457192708332 with parameters: {'x': 9.686243082413295, 'y': -4.821471809198219}.\r\n[I 2020-02-12 12:31:24,496] Finished trial#11 resulted in value: 10.701478253650269. Current best value is 10.701478253650269 with parameters: {'x': 9.708212252178804, 'y': -5.210109472549776}.\r\n[I 2020-02-12 12:31:24,522] Finished trial#12 resulted in value: 9.579557306645803. Current best value is 9.579557306645803 with parameters: {'x': 9.73750894101814, 'y': -5.438629275850951}.\r\n[I 2020-02-12 12:31:24,548] Finished trial#13 resulted in value: 1.9905991172634114. Current best value is 1.9905991172634114 with parameters: {'x': 6.787220711670441, 'y': -8.720947650708608}.\r\n[I 2020-02-12 12:31:24,573] Finished trial#14 resulted in value: 2.787134442293085. Current best value is 1.9905991172634114 with parameters: {'x': 6.787220711670441, 'y': -8.720947650708608}.\r\n[I 2020-02-12 12:31:24,599] Finished trial#15 resulted in value: 6.0477201513659615. Current best value is 1.9905991172634114 with parameters: {'x': 6.787220711670441, 'y': -8.720947650708608}.\r\n[I 2020-02-12 12:31:24,624] Finished trial#16 resulted in value: 15.744300260899426. Current best value is 1.9905991172634114 with parameters: {'x': 6.787220711670441, 'y': -8.720947650708608}.\r\n[I 2020-02-12 12:31:24,649] Finished trial#17 resulted in value: 200.40208368776987. Current best value is 1.9905991172634114 with parameters: {'x': 6.787220711670441, 'y': -8.720947650708608}.\r\n[I 2020-02-12 12:31:24,674] Finished trial#18 resulted in value: 24.631226446395882. Current best value is 1.9905991172634114 with parameters: {'x': 6.787220711670441, 'y': -8.720947650708608}.\r\n[I 2020-02-12 12:31:24,699] Finished trial#19 resulted in value: 20.985445341007892. Current best value is 1.9905991172634114 with parameters: {'x': 6.787220711670441, 'y': -8.720947650708608}.\r\n[I 2020-02-12 12:31:24,724] Finished trial#20 resulted in value: 4.353657092311067. Current best value is 1.9905991172634114 with parameters: {'x': 6.787220711670441, 'y': -8.720947650708608}.\r\n[I 2020-02-12 12:31:24,751] Finished trial#21 resulted in value: 3.812984233887978. Current best value is 1.9905991172634114 with parameters: {'x': 6.787220711670441, 'y': -8.720947650708608}.\r\n[I 2020-02-12 12:31:24,775] Finished trial#22 resulted in value: 3.457795936864317. Current best value is 1.9905991172634114 with parameters: {'x': 6.787220711670441, 'y': -8.720947650708608}.\r\n[I 2020-02-12 12:31:24,800] Finished trial#23 resulted in value: 20.221676496873553. Current best value is 1.9905991172634114 with parameters: {'x': 6.787220711670441, 'y': -8.720947650708608}.\r\n[I 2020-02-12 12:31:24,825] Finished trial#24 resulted in value: 30.31779566726328. Current best value is 1.9905991172634114 with parameters: {'x': 6.787220711670441, 'y': -8.720947650708608}.\r\n[I 2020-02-12 12:31:24,852] Finished trial#25 resulted in value: 149.0040196902956. Current best value is 1.9905991172634114 with parameters: {'x': 6.787220711670441, 'y': -8.720947650708608}.\r\n[I 2020-02-12 12:31:24,876] Finished trial#26 resulted in value: 26.723021729686693. Current best value is 1.9905991172634114 with parameters: {'x': 6.787220711670441, 'y': -8.720947650708608}.\r\n[I 2020-02-12 12:31:24,902] Finished trial#27 resulted in value: 2.1115754122144383. Current best value is 1.9905991172634114 with parameters: {'x': 6.787220711670441, 'y': -8.720947650708608}.\r\n[I 2020-02-12 12:31:24,926] Finished trial#28 resulted in value: 26.303366365533872. Current best value is 1.9905991172634114 with parameters: {'x': 6.787220711670441, 'y': -8.720947650708608}.\r\n[I 2020-02-12 12:31:24,952] Finished trial#29 resulted in value: 96.84561930745205. Current best value is 1.9905991172634114 with parameters: {'x': 6.787220711670441, 'y': -8.720947650708608}.\r\n[I 2020-02-12 12:31:24,978] Finished trial#30 resulted in value: 5.378089726755739. Current best value is 1.9905991172634114 with parameters: {'x': 6.787220711670441, 'y': -8.720947650708608}.\r\n[I 2020-02-12 12:31:25,004] Finished trial#31 resulted in value: 0.9351018565830189. Current best value is 0.9351018565830189 with parameters: {'x': 8.679579471197588, 'y': -8.687948834514476}.\r\n[I 2020-02-12 12:31:25,030] Finished trial#32 resulted in value: 0.7501865899326501. Current best value is 0.7501865899326501 with parameters: {'x': 8.754039799517779, 'y': -8.426157917532736}.\r\n[I 2020-02-12 12:31:25,056] Finished trial#33 resulted in value: 1.0895754508080087. Current best value is 0.7501865899326501 with parameters: {'x': 8.754039799517779, 'y': -8.426157917532736}.\r\n[I 2020-02-12 12:31:25,082] Finished trial#34 resulted in value: 1.7738376171795691. Current best value is 0.7501865899326501 with parameters: {'x': 8.754039799517779, 'y': -8.426157917532736}.\r\n[I 2020-02-12 12:31:25,107] Finished trial#35 resulted in value: 123.81710895410804. Current best value is 0.7501865899326501 with parameters: {'x': 8.754039799517779, 'y': -8.426157917532736}.\r\n[I 2020-02-12 12:31:25,133] Finished trial#36 resulted in value: 59.49247852436665. Current best value is 0.7501865899326501 with parameters: {'x': 8.754039799517779, 'y': -8.426157917532736}.\r\n[I 2020-02-12 12:31:25,158] Finished trial#37 resulted in value: 2.885303195813565. Current best value is 0.7501865899326501 with parameters: {'x': 8.754039799517779, 'y': -8.426157917532736}.\r\n[I 2020-02-12 12:31:25,184] Finished trial#38 resulted in value: 16.217465431118043. Current best value is 0.7501865899326501 with parameters: {'x': 8.754039799517779, 'y': -8.426157917532736}.\r\n[I 2020-02-12 12:31:25,209] Finished trial#39 resulted in value: 107.70758732187842. Current best value is 0.7501865899326501 with parameters: {'x': 8.754039799517779, 'y': -8.426157917532736}.\r\n[{'x': 0.9762700785464951, 'y': 4.30378732744839},\r\n {'x': 2.055267521432878, 'y': 0.8976636599379368},\r\n {'x': -1.5269040132219054, 'y': 2.917882261333123},\r\n {'x': -1.2482557747461502, 'y': 7.835460015641594},\r\n {'x': 9.273255210020587, 'y': -2.3311696234844455},\r\n {'x': 5.834500761653292, 'y': 0.5778983950580887},\r\n {'x': 1.3608912218786458, 'y': 8.51193276585322},\r\n {'x': -8.579278836042262, 'y': -8.257414005969185},\r\n {'x': -9.595632051193485, 'y': 6.65239691095876},\r\n {'x': 5.563135018997009, 'y': 7.400242964936382},\r\n {'x': 9.686243082413295, 'y': -4.821471809198219},\r\n {'x': 9.708212252178804, 'y': -5.210109472549776},\r\n {'x': 9.73750894101814, 'y': -5.438629275850951},\r\n {'x': 6.787220711670441, 'y': -8.720947650708608},\r\n {'x': 6.932136180360886, 'y': -9.28327756350637},\r\n {'x': 5.86952095650934, 'y': -9.228323734449955},\r\n {'x': 4.396721132406469, 'y': -9.661529916448485},\r\n {'x': -6.140848102960068, 'y': -7.337807719177768},\r\n {'x': 7.780221277778199, 'y': -3.0418830429633434},\r\n {'x': 3.534170967640166, 'y': -6.979305925000093},\r\n {'x': 7.394374857709929, 'y': -9.996716123873696},\r\n {'x': 7.450676982452702, 'y': -9.87382722156572},\r\n {'x': 7.99125233686058, 'y': -9.859494397747387},\r\n {'x': 3.50928554973873, 'y': -7.765137863655795},\r\n {'x': 7.976201068280483, 'y': -2.493891639450574},\r\n {'x': -4.080157449530058, 'y': -6.246769928144339},\r\n {'x': 4.886793566658666, 'y': -3.8731407301570338},\r\n {'x': 6.689677338837612, 'y': -8.628195778287912},\r\n {'x': 2.8931056709758196, 'y': -8.472225240446267},\r\n {'x': 0.5220111812144719, 'y': -1.6027113138790838},\r\n {'x': 6.390455176664282, 'y': -6.3304326343543575},\r\n {'x': 8.679579471197588, 'y': -8.687948834514476},\r\n {'x': 8.754039799517779, 'y': -8.426157917532736},\r\n {'x': 9.027289623466064, 'y': -8.185071554613238},\r\n {'x': 8.733823550159512, 'y': -6.888541222351967},\r\n {'x': 8.85090784797788, 'y': 3.0947313977562207},\r\n {'x': 9.940965948888914, 'y': -0.5350733620737829},\r\n {'x': 8.778125908009237, 'y': -6.490091636191664},\r\n {'x': 8.674918898054859, 'y': -4.029867771450621},\r\n {'x': -2.3740564859617095, 'y': -7.705824290679498}]\r\nBest value: 0.7501865899326501 (params: {'x': 8.754039799517779, 'y': -8.426157917532736})\r\n```\r\n\r\n</details>\r\n\r\n\r\n## Expected behavior\r\n\r\n`suggest_discrete_uniform` should be the same or better performance with `suggest_uniiform` in the example.\r\n\r\n## Environment\r\n\r\n- Optuna version: 1.1.0\r\n- Python version: 3.8.1\r\n- OS: macOS\r\n- (Optional) Other libraries and their versions:\r\n\r\n\r\n## Additional context (optional)\r\n\r\nI found this issue while reviewing https://github.com/optuna/optuna/pull/910", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/916/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/916/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/914", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/914/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/914/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/914/events", "html_url": "https://github.com/optuna/optuna/issues/914", "id": 563373366, "node_id": "MDU6SXNzdWU1NjMzNzMzNjY=", "number": 914, "title": "Unable to reproduce results before and after a study is deepcopied", "user": {"login": "Y-oHr-N", "id": 11706038, "node_id": "MDQ6VXNlcjExNzA2MDM4", "avatar_url": "https://avatars.githubusercontent.com/u/11706038?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Y-oHr-N", "html_url": "https://github.com/Y-oHr-N", "followers_url": "https://api.github.com/users/Y-oHr-N/followers", "following_url": "https://api.github.com/users/Y-oHr-N/following{/other_user}", "gists_url": "https://api.github.com/users/Y-oHr-N/gists{/gist_id}", "starred_url": "https://api.github.com/users/Y-oHr-N/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Y-oHr-N/subscriptions", "organizations_url": "https://api.github.com/users/Y-oHr-N/orgs", "repos_url": "https://api.github.com/users/Y-oHr-N/repos", "events_url": "https://api.github.com/users/Y-oHr-N/events{/privacy}", "received_events_url": "https://api.github.com/users/Y-oHr-N/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-02-11T17:47:20Z", "updated_at": "2020-05-08T04:20:37Z", "closed_at": "2020-05-08T04:20:37Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The behavior is different between 0.19.0 and 1.x.x.\r\n\r\n## Environment\r\n\r\n- Python version: 3.6.5\r\n- OS: Windows 10\r\n\r\n## Examples\r\n\r\n```python\r\nimport copy\r\n\r\nimport optuna\r\n\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_uniform('x', -10, 10)\r\n\r\n    return (x - 2) ** 2\r\n\r\n\r\nstudy = optuna.create_study(sampler=optuna.samplers.TPESampler(seed=0))\r\nstudy.optimize(objective, n_trials=1)\r\n\r\nstudy = optuna.create_study(sampler=optuna.samplers.TPESampler(seed=0))\r\nstudy = copy.deepcopy(study)\r\nstudy.optimize(objective, n_trials=1)\r\n```\r\n\r\n## Logs\r\n\r\n### v0.19.0\r\n\r\n```\r\n[I 2020-02-12 02:37:41,933] Finished trial#0 resulted in value: 1.0480229520791995. Current best value is 1.0480229520791995 with parameters: {'x': 0.9762700785464951}.\r\n[I 2020-02-12 02:37:41,990] Finished trial#0 resulted in value: 1.0480229520791995. Current best value is 1.0480229520791995 with parameters: {'x': 0.9762700785464951}.\r\n```\r\n\r\n### v1.0.0\r\n\r\n```\r\n[I 2020-02-12 02:38:44,010] Finished trial#0 resulted in value: 1.0480229520791995. Current best value is 1.0480229520791995 with parameters: {'x': 0.9762700785464951}.\r\n[I 2020-02-12 02:38:44,067] Finished trial#0 resulted in value: 46.90638356377688. Current best value is 46.90638356377688 with parameters: {'x': 8.848823516763801}.\r\n```\r\n\r\n### v1.1.0\r\n\r\n```\r\n[I 2020-02-12 02:39:39,168] Finished trial#0 resulted in value: 1.0480229520791995. Current best value is 1.0480229520791995 with parameters: {'x': 0.9762700785464951}.\r\n[I 2020-02-12 02:39:39,226] Finished trial#0 resulted in value: 2.756825098011473. Current best value is 2.756825098011473 with parameters: {'x': 3.6603689644207016}.\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/914/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/914/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/912", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/912/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/912/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/912/events", "html_url": "https://github.com/optuna/optuna/pull/912", "id": 562495658, "node_id": "MDExOlB1bGxSZXF1ZXN0MzczMDc5OTIx", "number": 912, "title": "Fix LightGBMTuner to handle metrics with evaluation positions.", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/21", "html_url": "https://github.com/optuna/optuna/milestone/21", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/21/labels", "id": 5077081, "node_id": "MDk6TWlsZXN0b25lNTA3NzA4MQ==", "number": 21, "title": "v1.2.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 44, "state": "closed", "created_at": "2020-02-06T02:03:34Z", "updated_at": "2020-03-05T01:52:29Z", "due_on": null, "closed_at": "2020-03-05T01:52:29Z"}, "comments": 1, "created_at": "2020-02-10T11:21:54Z", "updated_at": "2020-02-26T04:29:44Z", "closed_at": "2020-02-26T04:29:44Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/912", "html_url": "https://github.com/optuna/optuna/pull/912", "diff_url": "https://github.com/optuna/optuna/pull/912.diff", "patch_url": "https://github.com/optuna/optuna/pull/912.patch", "merged_at": "2020-02-26T04:29:44Z"}, "body": "This PR addresses #909. \r\nIt also fixes the output of `BaseTuner.higher_is_better`. If the metric is `'ndcg'` or `'map'`, the study direction seems to be reverted. I think `BaseTuner.higher_is_better` fails to handle the metric value, because it does not contain `'@'`. ", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/912/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/912/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/909", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/909/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/909/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/909/events", "html_url": "https://github.com/optuna/optuna/issues/909", "id": 562337936, "node_id": "MDU6SXNzdWU1NjIzMzc5MzY=", "number": 909, "title": "lightgbm tuner can't handle 'ndcg' metric", "user": {"login": "kondo-kk", "id": 43670643, "node_id": "MDQ6VXNlcjQzNjcwNjQz", "avatar_url": "https://avatars.githubusercontent.com/u/43670643?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kondo-kk", "html_url": "https://github.com/kondo-kk", "followers_url": "https://api.github.com/users/kondo-kk/followers", "following_url": "https://api.github.com/users/kondo-kk/following{/other_user}", "gists_url": "https://api.github.com/users/kondo-kk/gists{/gist_id}", "starred_url": "https://api.github.com/users/kondo-kk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kondo-kk/subscriptions", "organizations_url": "https://api.github.com/users/kondo-kk/orgs", "repos_url": "https://api.github.com/users/kondo-kk/repos", "events_url": "https://api.github.com/users/kondo-kk/events{/privacy}", "received_events_url": "https://api.github.com/users/kondo-kk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-02-10T05:42:07Z", "updated_at": "2020-02-27T03:00:41Z", "closed_at": "2020-02-27T03:00:41Z", "author_association": "NONE", "active_lock_reason": null, "body": " When I set 'ndcg' as metric, ligbtgbm_tuner raise key error at `booster.best_score[valid_name][metric]`\r\n\r\n## Expected behavior\r\n\r\n Probably, 'metric' variable at the tuner is 'ndcg' but `booster.best_score` dictionary at the booster class stores 'ndcg@20'. So the  KeyError has raised.\r\n\r\n## Environment\r\n\r\n- Optuna version: 1.1.0\r\n- Python version: 3.5.3\r\n- OS: Debian GNU/Linux 9\r\n- (Optional) Other libraries and their versions:\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nFile \"<ipython-input-8-44094cd56040>\", line 32, in train_lgbm_ranking\r\n    early_stopping_rounds=early_stopping_rounds, callbacks=None, best_params=best_params, tuning_history=tuning_history)\r\n  File \"/home/user/.local/lib/python3.5/site-packages/optuna/integration/lightgbm_tuner/__init__.py\", line 23, in train\r\n    booster = auto_booster.run()\r\n  File \"/home/user/.local/lib/python3.5/site-packages/optuna/integration/lightgbm_tuner/optimize.py\", line 379, in run\r\n    self.tune_feature_fraction()\r\n  File \"/home/user/.local/lib/python3.5/site-packages/optuna/integration/lightgbm_tuner/optimize.py\", line 425, in tune_feature_fraction\r\n    self.tune_params([param_name], len(param_values), sampler)\r\n  File \"/home/user/.local/lib/python3.5/site-packages/optuna/integration/lightgbm_tuner/optimize.py\", line 487, in tune_params\r\n    study.optimize(objective, n_trials=n_trials, catch=())\r\n  File \"/home/user/.local/lib/python3.5/site-packages/optuna/study.py\", line 302, in optimize\r\n    gc_after_trial, None)\r\n  File \"/home/user/.local/lib/python3.5/site-packages/optuna/study.py\", line 538, in _optimize_sequential\r\n    self._run_trial_and_callbacks(func, catch, callbacks, gc_after_trial)\r\n  File \"/home/user/.local/lib/python3.5/site-packages/optuna/study.py\", line 550, in _run_trial_and_callbacks\r\n    trial = self._run_trial(func, catch, gc_after_trial)\r\n  File \"/home/user/.local/lib/python3.5/site-packages/optuna/study.py\", line 569, in _run_trial\r\n    result = func(trial)\r\n  File \"/home/user/.local/lib/python3.5/site-packages/optuna/integration/lightgbm_tuner/optimize.py\", line 240, in __call__\r\n    val_score = self._get_booster_best_score(booster)\r\n  File \"/home/user/.local/lib/python3.5/site-packages/optuna/integration/lightgbm_tuner/optimize.py\", line 142, in _get_booster_best_score\r\n    val_score = booster.best_score[valid_name][metric]\r\nKeyError: 'ndcg'\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. set \"ndcg\" as metric, \"lambdarank\" as objective.\r\n2. set 20 as \"ndcg_eval_at\" \r\n3. train start\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/909/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/909/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/904", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/904/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/904/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/904/events", "html_url": "https://github.com/optuna/optuna/issues/904", "id": 561418013, "node_id": "MDU6SXNzdWU1NjE0MTgwMTM=", "number": 904, "title": "The doc of `optuna.integration.lightgbm.train` function cannot be generated if LightGBM isn't installed.", "user": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-02-07T04:45:53Z", "updated_at": "2020-02-21T00:31:22Z", "closed_at": "2020-02-21T00:31:22Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Due to the bug the title describes, [the current API reference doc](https://optuna.readthedocs.io/en/latest/) doesn't contain the entry of `optuna.integration.lightgbm.train` function.\r\n\r\n# Expected behavior\r\n\r\nThe build of the function doc should be succeeded even if LightGBM isn't installed in the build environment.\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```console\r\n$ cd optuna/docs\r\n$ make html\r\n...\r\nWARNING: autodoc: failed to import function 'train' from module 'optuna.integration.lightgbm'; the following exception was raised:\r\nTraceback (most recent call last):\r\n  File \"/home/docs/checkouts/readthedocs.org/user_builds/optuna/envs/latest/lib/python3.7/site-packages/sphinx/util/inspect.py\", line 225, in safe_getattr\r\n    return getattr(obj, name, *defargs)\r\nAttributeError: module 'optuna.integration.lightgbm' has no attribute 'train'\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/docs/checkouts/readthedocs.org/user_builds/optuna/envs/latest/lib/python3.7/site-packages/sphinx/ext/autodoc/importer.py\", line 193, in import_object\r\n    obj = attrgetter(obj, attrname)\r\n  File \"/home/docs/checkouts/readthedocs.org/user_builds/optuna/envs/latest/lib/python3.7/site-packages/sphinx/ext/autodoc/__init__.py\", line 290, in get_attr\r\n    return autodoc_attrgetter(self.env.app, obj, name, *defargs)\r\n  File \"/home/docs/checkouts/readthedocs.org/user_builds/optuna/envs/latest/lib/python3.7/site-packages/sphinx/ext/autodoc/__init__.py\", line 1563, in autodoc_attrgetter\r\n    return safe_getattr(obj, name, *defargs)\r\n  File \"/home/docs/checkouts/readthedocs.org/user_builds/optuna/envs/latest/lib/python3.7/site-packages/sphinx/util/inspect.py\", line 241, in safe_getattr\r\n    raise AttributeError(name)\r\nAttributeError: train\r\n...\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. Ensure that LightGBM isn't installed in the built environment.\r\n2. `$ git clone git://github.com/optuna/optuna.git`\r\n3. `$ cd optuna/docs`\r\n4. `$ make html`\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/904/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/904/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/889", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/889/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/889/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/889/events", "html_url": "https://github.com/optuna/optuna/pull/889", "id": 559462710, "node_id": "MDExOlB1bGxSZXF1ZXN0MzcwNjI2Mzcw", "number": 889, "title": "Sort intermediate values in `plot_intermediate_values`.", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/20", "html_url": "https://github.com/optuna/optuna/milestone/20", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/20/labels", "id": 4990005, "node_id": "MDk6TWlsZXN0b25lNDk5MDAwNQ==", "number": 20, "title": "v1.1.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 33, "state": "closed", "created_at": "2020-01-09T05:35:56Z", "updated_at": "2020-02-06T02:18:14Z", "due_on": "2020-02-06T08:00:00Z", "closed_at": "2020-02-06T02:18:14Z"}, "comments": 1, "created_at": "2020-02-04T03:18:10Z", "updated_at": "2020-02-06T01:32:50Z", "closed_at": "2020-02-04T04:49:34Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/889", "html_url": "https://github.com/optuna/optuna/pull/889", "diff_url": "https://github.com/optuna/optuna/pull/889.diff", "patch_url": "https://github.com/optuna/optuna/pull/889.patch", "merged_at": "2020-02-04T04:49:34Z"}, "body": "This PR addresses #886. \r\n\r\nIt simply sorts the intermediate steps before plotting them. #887 also addresses this issue, but I found out that its approach is not appropriate in some cases. So, I'd like to employ this approach and close #887.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/889/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/889/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/887", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/887/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/887/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/887/events", "html_url": "https://github.com/optuna/optuna/pull/887", "id": 558848629, "node_id": "MDExOlB1bGxSZXF1ZXN0MzcwMTI1Mjk1", "number": 887, "title": "Use OrderedDict to keep the order of intermediate values.", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-02-03T05:18:22Z", "updated_at": "2020-02-06T01:24:39Z", "closed_at": "2020-02-04T04:26:08Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/887", "html_url": "https://github.com/optuna/optuna/pull/887", "diff_url": "https://github.com/optuna/optuna/pull/887.diff", "patch_url": "https://github.com/optuna/optuna/pull/887.patch", "merged_at": null}, "body": "This PR addresses #886. \r\n\r\nI think it has two issues.\r\n\r\n1. `dict` does not keep the order of keys\r\n\r\nThe current implementation of `FrozenTrial.intermediate_values` employs `dict`. The order of keys is not ensured if the users use Python 3.6 or older. This PR uses `OrderedDict` for `FrozenTrial.intermediate_values`.\r\n\r\n2. RDBs do not ensure the order of results if a query has no `order by` clause.\r\n\r\nThis PR arranges the intermediate values when they are retrieved from databases.\r\nPlease note that the results are not necessarily ordered by primary keys when queries do not contain `order by`. (c.f., ['When no 'Order by' is specified, what order does a query choose for your record set?'](https://stackoverflow.com/questions/20050341/when-no-order-by-is-specified-what-order-does-a-query-choose-for-your-record))", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/887/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/887/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/879", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/879/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/879/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/879/events", "html_url": "https://github.com/optuna/optuna/issues/879", "id": 557385619, "node_id": "MDU6SXNzdWU1NTczODU2MTk=", "number": 879, "title": "PyMysql error not catched", "user": {"login": "ernestum", "id": 1250234, "node_id": "MDQ6VXNlcjEyNTAyMzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1250234?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ernestum", "html_url": "https://github.com/ernestum", "followers_url": "https://api.github.com/users/ernestum/followers", "following_url": "https://api.github.com/users/ernestum/following{/other_user}", "gists_url": "https://api.github.com/users/ernestum/gists{/gist_id}", "starred_url": "https://api.github.com/users/ernestum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ernestum/subscriptions", "organizations_url": "https://api.github.com/users/ernestum/orgs", "repos_url": "https://api.github.com/users/ernestum/repos", "events_url": "https://api.github.com/users/ernestum/events{/privacy}", "received_events_url": "https://api.github.com/users/ernestum/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1984762793, "node_id": "MDU6TGFiZWwxOTg0NzYyNzkz", "url": "https://api.github.com/repos/optuna/optuna/labels/stale", "name": "stale", "color": "fbca04", "default": false, "description": "Exempt from stale bot labeling."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-01-30T10:02:53Z", "updated_at": "2020-05-08T04:26:10Z", "closed_at": "2020-05-08T04:26:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!-- Please write a clear and concise description of what the bug is. -->\r\nDuring distributed optimization with five workers, one crashed with the following error:\r\n```\r\nsqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.InternalError) (1205, 'Lock wait timeout exceeded; try restarting transaction')\r\n[SQL: INSERT INTO trial_system_attributes (trial_id, `key`, value_json) VALUES (%(trial_id)s, %(key)s, %(value_json)s)]\r\n[parameters: {'trial_id': 4530, 'key': '_number', 'value_json': '16'}]\r\n(Background on this error at: http://sqlalche.me/e/2j85) (Background on this error at: http://sqlalche.me/e/7s2a)\r\n```\r\nFull log with all stack traced here: [failure.log](https://github.com/optuna/optuna/files/4133355/failure.log)\r\n\r\nIt looks like some problem with the pymysql driver which is of course not your fault. However it would be nice if such errors were caught and the trial dropped instead of crashing the entire worker.\r\n\r\nMight be related to #386\r\n\r\n## Expected behavior\r\n\r\n<!-- Please write a clear and concise description of what you expected to happen. -->\r\nNo crashes of the entire application in spite of database errors. Rather repeated retries.\r\n\r\n## Environment\r\n\r\n- Optuna version: 1.0.0\r\n- Python version: 3.6\r\n- OS: ubuntu:18.04\r\n- Other libraries and their versions: PyMySQL 0.9.3, sqlalchemy-1.3.13\r\n\r\n## Error messages, stack traces, or logs\r\n\r\nToo long. Look  [here](https://github.com/optuna/optuna/files/4133355/failure.log).\r\n\r\n## Steps to reproduce\r\n\r\nUnfortunately very hard to reproduce since the other workers are still running just fine.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/879/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/879/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/872", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/872/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/872/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/872/events", "html_url": "https://github.com/optuna/optuna/pull/872", "id": 556717649, "node_id": "MDExOlB1bGxSZXF1ZXN0MzY4NDM3MTYx", "number": 872, "title": "Fix LightGBM tuner raises exception when `max_depth=-1`.", "user": {"login": "smly", "id": 19337, "node_id": "MDQ6VXNlcjE5MzM3", "avatar_url": "https://avatars.githubusercontent.com/u/19337?v=4", "gravatar_id": "", "url": "https://api.github.com/users/smly", "html_url": "https://github.com/smly", "followers_url": "https://api.github.com/users/smly/followers", "following_url": "https://api.github.com/users/smly/following{/other_user}", "gists_url": "https://api.github.com/users/smly/gists{/gist_id}", "starred_url": "https://api.github.com/users/smly/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/smly/subscriptions", "organizations_url": "https://api.github.com/users/smly/orgs", "repos_url": "https://api.github.com/users/smly/repos", "events_url": "https://api.github.com/users/smly/events{/privacy}", "received_events_url": "https://api.github.com/users/smly/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/20", "html_url": "https://github.com/optuna/optuna/milestone/20", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/20/labels", "id": 4990005, "node_id": "MDk6TWlsZXN0b25lNDk5MDAwNQ==", "number": 20, "title": "v1.1.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 33, "state": "closed", "created_at": "2020-01-09T05:35:56Z", "updated_at": "2020-02-06T02:18:14Z", "due_on": "2020-02-06T08:00:00Z", "closed_at": "2020-02-06T02:18:14Z"}, "comments": 1, "created_at": "2020-01-29T08:46:47Z", "updated_at": "2020-02-06T01:34:53Z", "closed_at": "2020-01-31T02:26:52Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/872", "html_url": "https://github.com/optuna/optuna/pull/872", "diff_url": "https://github.com/optuna/optuna/pull/872.diff", "patch_url": "https://github.com/optuna/optuna/pull/872.patch", "merged_at": "2020-01-31T02:26:51Z"}, "body": "This PR addresses https://github.com/optuna/optuna/issues/870. Thank you @nyanp for reporting the issue!\r\n\r\nChanges:\r\n\r\n* Using a variable `max_depth` as an internal variable is confusing. In LightGBM Tuner, the variable is used for deciding the upper bound of `num_leaves`. This patch changes the internal variable name to `tree_depth`.\r\n* If max_depth <= 0 is specified, the Tuner fallback to its internal default (=8).", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/872/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/872/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/870", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/870/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/870/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/870/events", "html_url": "https://github.com/optuna/optuna/issues/870", "id": 556544694, "node_id": "MDU6SXNzdWU1NTY1NDQ2OTQ=", "number": 870, "title": "LightGBM tuner raises exception when max_depth=-1", "user": {"login": "nyanp", "id": 378738, "node_id": "MDQ6VXNlcjM3ODczOA==", "avatar_url": "https://avatars.githubusercontent.com/u/378738?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nyanp", "html_url": "https://github.com/nyanp", "followers_url": "https://api.github.com/users/nyanp/followers", "following_url": "https://api.github.com/users/nyanp/following{/other_user}", "gists_url": "https://api.github.com/users/nyanp/gists{/gist_id}", "starred_url": "https://api.github.com/users/nyanp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nyanp/subscriptions", "organizations_url": "https://api.github.com/users/nyanp/orgs", "repos_url": "https://api.github.com/users/nyanp/repos", "events_url": "https://api.github.com/users/nyanp/events{/privacy}", "received_events_url": "https://api.github.com/users/nyanp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "smly", "id": 19337, "node_id": "MDQ6VXNlcjE5MzM3", "avatar_url": "https://avatars.githubusercontent.com/u/19337?v=4", "gravatar_id": "", "url": "https://api.github.com/users/smly", "html_url": "https://github.com/smly", "followers_url": "https://api.github.com/users/smly/followers", "following_url": "https://api.github.com/users/smly/following{/other_user}", "gists_url": "https://api.github.com/users/smly/gists{/gist_id}", "starred_url": "https://api.github.com/users/smly/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/smly/subscriptions", "organizations_url": "https://api.github.com/users/smly/orgs", "repos_url": "https://api.github.com/users/smly/repos", "events_url": "https://api.github.com/users/smly/events{/privacy}", "received_events_url": "https://api.github.com/users/smly/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "smly", "id": 19337, "node_id": "MDQ6VXNlcjE5MzM3", "avatar_url": "https://avatars.githubusercontent.com/u/19337?v=4", "gravatar_id": "", "url": "https://api.github.com/users/smly", "html_url": "https://github.com/smly", "followers_url": "https://api.github.com/users/smly/followers", "following_url": "https://api.github.com/users/smly/following{/other_user}", "gists_url": "https://api.github.com/users/smly/gists{/gist_id}", "starred_url": "https://api.github.com/users/smly/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/smly/subscriptions", "organizations_url": "https://api.github.com/users/smly/orgs", "repos_url": "https://api.github.com/users/smly/repos", "events_url": "https://api.github.com/users/smly/events{/privacy}", "received_events_url": "https://api.github.com/users/smly/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-01-28T23:14:12Z", "updated_at": "2020-01-31T02:30:56Z", "closed_at": "2020-01-31T02:30:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "LightGBM tuner raises exception while tuning if initial lgbm parameters contain `max_depth=-1`.\r\n\r\nThis error is caused by the following code:\r\n\r\nhttps://github.com/optuna/optuna/blob/master/optuna/integration/lightgbm_tuner/optimize.py#L215-L218\r\n```python\r\nmax_depth = self.lgbm_params.get('max_depth', 8)\r\nself.lgbm_params['num_leaves'] = trial.suggest_int(\r\n    'num_leaves', 2, 2 ** max_depth)\r\n```\r\n\r\n## Expected behavior\r\n-1 is a default parameter in LightGBM.\r\nhttps://github.com/optuna/optuna/issues/870#issue-556544694\r\n\r\nIf `max_depth<=0` is specified, optuna should fallback to its internal default (=8).\r\n\r\n## Environment\r\n\r\n- Optuna version: 1.0.0\r\n- Python version: 3.7\r\n- OS: Mac OS\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nValueError: The `low` value must be smaller than or equal to the `high` value (low=2, high=0.5).\r\n```\r\n\r\n## Reproducible examples\r\n\r\n```python\r\nimport optuna\r\nimport optuna.integration.lightgbm as lgb\r\nfrom sklearn.datasets import make_classification\r\nfrom sklearn.model_selection import train_test_split\r\n\r\nX, y = make_classification()\r\nX_train, X_valid, y_train, y_valid = train_test_split(X, y)\r\n\r\ndtrain = lgb.Dataset(X_train, y_train)\r\ndvalid = lgb.Dataset(X_valid, y_valid)\r\n\r\nparams = {\r\n    'objective': 'binary',\r\n    'max_depth': -1\r\n}\r\n\r\nlgb.train(params, dtrain, valid_sets=[dvalid], verbose_eval=-1)\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/870/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/870/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/847", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/847/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/847/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/847/events", "html_url": "https://github.com/optuna/optuna/pull/847", "id": 552576610, "node_id": "MDExOlB1bGxSZXF1ZXN0MzY1MDU2NzU5", "number": 847, "title": "Make `PyTorchIgnitePruningHandler` report correct epoch.", "user": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/20", "html_url": "https://github.com/optuna/optuna/milestone/20", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/20/labels", "id": 4990005, "node_id": "MDk6TWlsZXN0b25lNDk5MDAwNQ==", "number": 20, "title": "v1.1.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 33, "state": "closed", "created_at": "2020-01-09T05:35:56Z", "updated_at": "2020-02-06T02:18:14Z", "due_on": "2020-02-06T08:00:00Z", "closed_at": "2020-02-06T02:18:14Z"}, "comments": 5, "created_at": "2020-01-21T01:28:51Z", "updated_at": "2020-01-22T00:32:59Z", "closed_at": "2020-01-21T07:11:33Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/847", "html_url": "https://github.com/optuna/optuna/pull/847", "diff_url": "https://github.com/optuna/optuna/pull/847.diff", "patch_url": "https://github.com/optuna/optuna/pull/847.patch", "merged_at": "2020-01-21T07:11:33Z"}, "body": "The current implementation of `PyTorchIgnitePruningHandler` reports **the epoch number of evaluator**, which means the value is always `1`. This PR fixes it to use **the epoch number of trainer** to match the expected behavior of the pruning handler.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/847/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/847/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/845", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/845/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/845/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/845/events", "html_url": "https://github.com/optuna/optuna/issues/845", "id": 551558179, "node_id": "MDU6SXNzdWU1NTE1NTgxNzk=", "number": 845, "title": "trial.suggest_uniform sampling very non-uniform", "user": {"login": "eafpres", "id": 30508983, "node_id": "MDQ6VXNlcjMwNTA4OTgz", "avatar_url": "https://avatars.githubusercontent.com/u/30508983?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eafpres", "html_url": "https://github.com/eafpres", "followers_url": "https://api.github.com/users/eafpres/followers", "following_url": "https://api.github.com/users/eafpres/following{/other_user}", "gists_url": "https://api.github.com/users/eafpres/gists{/gist_id}", "starred_url": "https://api.github.com/users/eafpres/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eafpres/subscriptions", "organizations_url": "https://api.github.com/users/eafpres/orgs", "repos_url": "https://api.github.com/users/eafpres/repos", "events_url": "https://api.github.com/users/eafpres/events{/privacy}", "received_events_url": "https://api.github.com/users/eafpres/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-01-17T18:08:54Z", "updated_at": "2020-01-23T04:26:35Z", "closed_at": "2020-01-22T18:29:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Problem\r\nUsing a call like:\r\n```colsample_bytree = trial.suggest_uniform('colsample_bytree', 0.1, 0.9)```\r\nproduces a highly skewed distribution:\r\n![image](https://user-images.githubusercontent.com/30508983/72634339-9f6d6880-3917-11ea-9c49-fb5190d04d7b.png)\r\n\r\n## Expected behavior\r\nThe distribution should be closer to uniform\r\n\r\n\r\n## Environment\r\n\r\n- Optuna version:\r\n```\r\noptuna.__version__  \r\nOut[47]: '0.19.0'\r\n```\r\n- Python version:\r\n```\r\npython                    3.6.9                h5500b2f_0\r\n```\r\n\r\n- OS:\r\n```\r\nOS Name             : Microsoft Windows 10 Home\r\nOS Version          : 10.0.18362 N/A Build 18362\r\nOS Manufacturer     : Microsoft Corporation\r\nOS Configuration    : Standalone Workstation\r\nOS Build Type       : Multiprocessor Free\r\nSystem Boot Time    : 1/15/2020, 5:34:36 PM\r\nSystem Manufacturer : LENOVO\r\nSystem Model        : 20349\r\nSystem Type         : x64-based PC\r\nSystem Directory    : C:\\Windows\\system32\r\nSystem Locale       : en-us;English (United States)\r\nHotfix(s)           : 11 Hotfix(s) Installed.,[01]: KB4532938,[02]: KB4497165,[03]: KB4498523,[04]: KB4503308,[05]: KB4515383,[06]: KB4516115,[07]: KB4520390,[08]: KB4521863,[09]: KB4524569,[10]:\r\n                      KB4528759,[11]: KB4528760\r\n```\r\n\r\n- (Optional) Other libraries and their versions:\r\n```\r\nxgb.__version__\r\nOut[50]: '0.90'\r\n```\r\n## Error messages, stack traces, or logs\r\nNone\r\n\r\n## Steps to reproduce\r\n```\r\ndef train_model(trial,\r\n                train_X,\r\n                train_Y,\r\n                val_X,\r\n                val_Y,\r\n                n_iters,\r\n                params,\r\n                n_class = None):\r\n    colsample_bytree = trial.suggest_uniform('colsample_bytree', 0.1, 0.9)\r\n```\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/845/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/845/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/837", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/837/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/837/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/837/events", "html_url": "https://github.com/optuna/optuna/issues/837", "id": 550360762, "node_id": "MDU6SXNzdWU1NTAzNjA3NjI=", "number": 837, "title": "Visualizations don't work in Jupyter Lab", "user": {"login": "srizvan", "id": 3490922, "node_id": "MDQ6VXNlcjM0OTA5MjI=", "avatar_url": "https://avatars.githubusercontent.com/u/3490922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/srizvan", "html_url": "https://github.com/srizvan", "followers_url": "https://api.github.com/users/srizvan/followers", "following_url": "https://api.github.com/users/srizvan/following{/other_user}", "gists_url": "https://api.github.com/users/srizvan/gists{/gist_id}", "starred_url": "https://api.github.com/users/srizvan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/srizvan/subscriptions", "organizations_url": "https://api.github.com/users/srizvan/orgs", "repos_url": "https://api.github.com/users/srizvan/repos", "events_url": "https://api.github.com/users/srizvan/events{/privacy}", "received_events_url": "https://api.github.com/users/srizvan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-01-15T18:40:52Z", "updated_at": "2021-03-14T20:51:18Z", "closed_at": "2020-01-17T19:39:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "Visualizations don't work in Jupyter Lab. I see just empty (white) plots. In Jupyter Notebook everything is OK.\r\n\r\n## Expected behavior\r\n\r\nVisualizations should be available from Jupyter Lab.\r\n\r\n## Environment\r\n\r\n- Optuna version: 1.0.0\r\n- Python version: 3.7.4\r\n- OS: Ubuntu 18.04.3\r\n- (Optional) Other libraries and their versions:\r\nplotly==4.4.1\r\njupyterlab==1.2.4\r\njupyterlab-server==1.0.6\r\n\r\n## Steps to reproduce\r\n\r\n1. Create a study object. \r\n2. Run study.optimize\r\n3. Plot any visualization.\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\noptuna.visualization.plot_slice(study)\r\n```\r\nOr any other plot.\r\n## Additional context (optional)\r\n\r\nScreenshot of empty visualization:\r\n![image](https://user-images.githubusercontent.com/3490922/72460097-d6873100-37d4-11ea-9433-62a4824622aa.png)\r\nThere is an error in the browser console:\r\n![Screenshot from 2020-01-15 20-26-45](https://user-images.githubusercontent.com/3490922/72460658-e6ebdb80-37d5-11ea-9b0e-8077ad5eee90.png)\r\n![Screenshot from 2020-01-15 20-27-13](https://user-images.githubusercontent.com/3490922/72460675-efdcad00-37d5-11ea-9283-4f70b860830d.png)", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/837/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/837/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/825", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/825/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/825/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/825/events", "html_url": "https://github.com/optuna/optuna/issues/825", "id": 545531563, "node_id": "MDU6SXNzdWU1NDU1MzE1NjM=", "number": 825, "title": "OptunaSearchCV does not support `scikit-learn>=0.22.1`.", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-01-06T04:22:15Z", "updated_at": "2020-02-09T09:01:53Z", "closed_at": "2020-02-09T09:01:53Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "## Expected behavior\r\n\r\n\r\nThe `OptunaSearchCV` does not work with the latest scikit-learn (v0.22.1). This is due to the update of the internal interface in [this commit](https://github.com/scikit-learn/scikit-learn/commit/46001e7cfb163b73a83d5adf73fb454e8a3c64b6).  More concretely, it removed `sklearn.model_selection._validation._index_param_value` which is used in `OptunaSearchCV` and added `sklearn.utils.validation._check_fit_params` instead.\r\n\r\n`OptunaSearchCV` uses some other internal interface of scikit-learn, and I think it would be better to stop using them to avoid similar issues.\r\n\r\n## Environment\r\n\r\n- Optuna version: 0.19.0\r\n- Python version: 3.7.5\r\n- OS : `Linux 75b723335ed2 4.9.184-linuxkit #1 SMP Tue Jul 2 22:58:16 UTC 2019 x86_64 GNU/Linux`\r\n- scikit-learn versions: `scikit-learn==0.22.1`\r\n\r\n\r\n## Reproducible examples\r\n\r\nSetup\r\n```bash\r\n$ docker run -it --rm python:3.7 bash\r\n$ pip install scikit-learn\r\n$ pip install optuna\r\n```\r\n\r\nReproducible code\r\n```python\r\n>>> import sklearn\r\n>>> import optuna.integration.sklearn\r\n\r\n# The following line raises import error even if sklearn has been installed.\r\n>>> optuna.integration.sklearn._check_sklearn_availability()\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/usr/local/lib/python3.8/site-packages/optuna/integration/sklearn.py\", line 65, in _check_sklearn_availability\r\n    raise ImportError(\r\nImportError: scikit-learn is not available. Please install scikit-learn to use this feature. scikit-learn can be installed by executing `$ pip install scikit-learn>=0.19.0`. For further information, please refer to the installation guide of scikit-learn. (The actual import error is as follows: cannot import name '_index_param_value' from 'sklearn.model_selection._validation' (/usr/local/lib/python3.8/site-packages/sklearn/model_selection/_validation.py))\r\n\r\n# The actual cause of the above error.\r\n>>> from sklearn.model_selection._validation import _index_param_value\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\nImportError: cannot import name '_index_param_value' from 'sklearn.model_selection._validation' (/usr/local/lib/python3.7/site-packages/sklearn/model_selection/_validation.py)\r\n\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/825/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/825/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/820", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/820/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/820/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/820/events", "html_url": "https://github.com/optuna/optuna/issues/820", "id": 542844728, "node_id": "MDU6SXNzdWU1NDI4NDQ3Mjg=", "number": 820, "title": "sqlite3.OperationalError: database is locked", "user": {"login": "louisabraham", "id": 13174805, "node_id": "MDQ6VXNlcjEzMTc0ODA1", "avatar_url": "https://avatars.githubusercontent.com/u/13174805?v=4", "gravatar_id": "", "url": "https://api.github.com/users/louisabraham", "html_url": "https://github.com/louisabraham", "followers_url": "https://api.github.com/users/louisabraham/followers", "following_url": "https://api.github.com/users/louisabraham/following{/other_user}", "gists_url": "https://api.github.com/users/louisabraham/gists{/gist_id}", "starred_url": "https://api.github.com/users/louisabraham/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/louisabraham/subscriptions", "organizations_url": "https://api.github.com/users/louisabraham/orgs", "repos_url": "https://api.github.com/users/louisabraham/repos", "events_url": "https://api.github.com/users/louisabraham/events{/privacy}", "received_events_url": "https://api.github.com/users/louisabraham/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1157563981, "node_id": "MDU6TGFiZWwxMTU3NTYzOTgx", "url": "https://api.github.com/repos/optuna/optuna/labels/feature", "name": "feature", "color": "d8d517", "default": false, "description": "Change that does not break compatibility, but affects the public interfaces."}, {"id": 1947562008, "node_id": "MDU6TGFiZWwxOTQ3NTYyMDA4", "url": "https://api.github.com/repos/optuna/optuna/labels/optuna.storages", "name": "optuna.storages", "color": "1c659e", "default": false, "description": "Related to the `optuna.storages` submodule. This is automatically labeled by github-actions."}, {"id": 2107128673, "node_id": "MDU6TGFiZWwyMTA3MTI4Njcz", "url": "https://api.github.com/repos/optuna/optuna/labels/no-stale", "name": "no-stale", "color": "BBBBBB", "default": false, "description": "Exempt from stale bot"}, {"id": 3264287142, "node_id": "MDU6TGFiZWwzMjY0Mjg3MTQy", "url": "https://api.github.com/repos/optuna/optuna/labels/v3", "name": "v3", "color": "339FD7", "default": false, "description": "Issue/PR for Optuna version 3."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 16, "created_at": "2019-12-27T11:29:31Z", "updated_at": "2021-11-28T06:52:10Z", "closed_at": "2021-11-28T05:08:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm deploying optuna on a single machine through a script that looks like this:\r\n\r\n```\r\noptuna create-study [\u2026]\r\n\r\nfor i in $(seq \"$1\")\r\ndo\r\n    optuna study optimize [\u2026] &\r\ndone\r\n\r\nwait\r\n\r\n# (copy trials.db from scratch to shared storage)\r\n[\u2026]\r\n```\r\n\r\n\r\nI got some `sqlite3.OperationalError: database is locked` errors on start (on 7 processes out of 32).\r\n\r\nI think that launching all processes at the same time causes them to make requests at the same time (*collide*). I'm lucky that my hyperparameters also control the computation time so that the processes have very low probability to *collide* after starting, but I guess this could also be a source of problems in other workflows that are massively parallel.\r\n\r\nI believe this could be fixed by increasing the timeout of the sqlite3 backend. There should be an option to do that from the command line and the API of optuna.\r\n\r\n## Alternatives\r\n\r\nI added a sleep in my loop.\r\n\r\n```\r\nfor i in $(seq \"$1\")\r\ndo\r\n    optuna study optimize [\u2026] &\r\n    sleep 5\r\ndone\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/820/reactions", "total_count": 6, "+1": 6, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/820/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/815", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/815/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/815/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/815/events", "html_url": "https://github.com/optuna/optuna/issues/815", "id": 542462804, "node_id": "MDU6SXNzdWU1NDI0NjI4MDQ=", "number": 815, "title": "database disk image is malformed", "user": {"login": "louisabraham", "id": 13174805, "node_id": "MDQ6VXNlcjEzMTc0ODA1", "avatar_url": "https://avatars.githubusercontent.com/u/13174805?v=4", "gravatar_id": "", "url": "https://api.github.com/users/louisabraham", "html_url": "https://github.com/louisabraham", "followers_url": "https://api.github.com/users/louisabraham/followers", "following_url": "https://api.github.com/users/louisabraham/following{/other_user}", "gists_url": "https://api.github.com/users/louisabraham/gists{/gist_id}", "starred_url": "https://api.github.com/users/louisabraham/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/louisabraham/subscriptions", "organizations_url": "https://api.github.com/users/louisabraham/orgs", "repos_url": "https://api.github.com/users/louisabraham/repos", "events_url": "https://api.github.com/users/louisabraham/events{/privacy}", "received_events_url": "https://api.github.com/users/louisabraham/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-12-26T07:20:03Z", "updated_at": "2019-12-27T08:32:55Z", "closed_at": "2019-12-26T09:18:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "When launching multiple instances of `optuna study optimize` ~in rapid succession (but by hand)~, I get the following error: \r\n\r\n    [W 2019-12-26 08:12:45,772] Setting status of trial#13 as TrialState.FAIL because of the following error: DatabaseError('(sqlite3.DatabaseError) database disk image is malformed')\r\n\r\n## Expected behavior\r\n\r\nNo error.\r\n\r\n## Environment\r\n\r\n- Optuna version: 0.19.0\r\n- Python version: Python 3.7.4\r\n- OS: CentOS Linux release 7.5.1804 (Core)\r\n\r\n\r\n## Error messages, stack traces, or logs\r\n\r\nhttps://pastebin.com/UPaiAm5t\r\n\r\n## Steps to reproduce\r\n\r\nLaunch multiple instances of  `optuna study optimize` ~in rapid succession~.\r\n\r\n## Additional context (optional)\r\n\r\nI'm launching the tasks over LSF on a cluster with a shared file system.\r\n\r\n**EDIT**: the tasks keep failing (even after executing some trials) so it probably isn't related to launching them in rapid succession.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/815/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/815/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/810", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/810/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/810/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/810/events", "html_url": "https://github.com/optuna/optuna/issues/810", "id": 539810528, "node_id": "MDU6SXNzdWU1Mzk4MTA1Mjg=", "number": 810, "title": "XGBoostPruningCallback is not compatible with xgboost cv()", "user": {"login": "algo-rythm", "id": 4627020, "node_id": "MDQ6VXNlcjQ2MjcwMjA=", "avatar_url": "https://avatars.githubusercontent.com/u/4627020?v=4", "gravatar_id": "", "url": "https://api.github.com/users/algo-rythm", "html_url": "https://github.com/algo-rythm", "followers_url": "https://api.github.com/users/algo-rythm/followers", "following_url": "https://api.github.com/users/algo-rythm/following{/other_user}", "gists_url": "https://api.github.com/users/algo-rythm/gists{/gist_id}", "starred_url": "https://api.github.com/users/algo-rythm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/algo-rythm/subscriptions", "organizations_url": "https://api.github.com/users/algo-rythm/orgs", "repos_url": "https://api.github.com/users/algo-rythm/repos", "events_url": "https://api.github.com/users/algo-rythm/events{/privacy}", "received_events_url": "https://api.github.com/users/algo-rythm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-12-18T17:10:53Z", "updated_at": "2020-02-05T10:57:15Z", "closed_at": "2020-02-05T10:57:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "XGBoostPruningCallback is not compatible with xgboost cross validation function cv().\r\n\r\nThe Optuna pruner is expecting only two elements in each tuple of the evaluation_result_list, but XGBoost.cv is also providing a third element: the stddev of the metric across the cross-valdation folds.\r\n\r\n## Expected behavior\r\nNo exception\r\n\r\n## Environment\r\n- Optuna version: 0.19.0\r\n- Python version: Python 3.7.5\r\n- OS: Windows 10\r\n\r\n## Error messages, stack traces, or logs\r\nFile \"C:\\Users\\me\\.conda\\envs\\feature-tools-ve\\lib\\site-packages\\optuna\\integration\\xgboost.py\", line 50, in __call__\r\n    current_score = dict(env.evaluation_result_list)[self.observation_key]\r\nValueError: dictionary update sequence element #0 has length 3; 2 is required\r\n\r\n## Additional context (optional)\r\nHere is a workaround callback:\r\n```\r\ndef remove_std_from_evaluation_result_list(xgb_callback_env):\r\n    \"\"\"Custom XGBoost callback adapter to fix compatibility with Optuna pruner.\r\n    The Optuna pruner is expecting only two elements in each tuple of the evaluation_result_list.\r\n    It expects the observation_key and the evaluation metric only, but XGBoost is also providing\r\n    a third element: the stddev of the metric across the cross-valdation folds.\r\n    \"\"\"\r\n    # drop the 3rd element (stddev) from each evaluation_result_list item.\r\n    erl_orig = xgb_callback_env.evaluation_result_list\r\n    erl_no_std = [(observation_key, metric) for observation_key, metric, std in erl_orig]\r\n    erl_orig.clear()\r\n    erl_orig.extend(erl_no_std)\r\n\r\nmetrics = [\"error\", \"logloss\"]\r\npruning_callback = optuna.integration.XGBoostPruningCallback(trial, \"test-logloss\")\r\ncallbacks = [remove_std_from_evaluation_result_list, pruning_callback]\r\ndf_rounds = xgb.cv(params, dtrain, metrics=metrics, callbacks=callbacks)\r\n```\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/810/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/810/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/800", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/800/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/800/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/800/events", "html_url": "https://github.com/optuna/optuna/issues/800", "id": 538933419, "node_id": "MDU6SXNzdWU1Mzg5MzM0MTk=", "number": 800, "title": "Segmentation fault during CI jobs.", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-12-17T09:12:22Z", "updated_at": "2019-12-18T01:54:17Z", "closed_at": "2019-12-18T01:54:17Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "## Environment\r\n\r\n- Optuna version: master (https://github.com/optuna/optuna/commit/b7cf4d68b9b00ca6f28929a80f9db4ce691dff8e)\r\n- Python version: 3.5, 3.6, 3.7\r\n- OS: Linux (in CircleCI VM)\r\n\r\n## Error messages, stack traces, or logs\r\n\r\nThe CI jobs  `tests-python35`, `tests-python36`, `tests-python37` and `codecov` failed due to the segmentation fault.\r\n\r\n[The error message](https://circleci.com/gh/optuna/optuna/24674) is as follows:\r\n\r\n```\r\n#!/bin/bash -eo pipefail\r\n. venv/bin/activate\r\npytest tests\r\n============================= test session starts ==============================\r\nplatform linux -- Python 3.7.5, pytest-5.3.2, py-1.8.0, pluggy-0.13.1\r\nrootdir: /home/circleci/project\r\ncollecting 223 items                                                           Fatal Python error: Segmentation fault\r\n\r\nCurrent thread 0x00007fcfd1270740 (most recent call first):\r\n  File \"<frozen importlib._bootstrap>\", line 219 in _call_with_frames_removed\r\n  File \"<frozen importlib._bootstrap_external>\", line 1043 in create_module\r\n  File \"<frozen importlib._bootstrap>\", line 583 in module_from_spec\r\n  File \"<frozen importlib._bootstrap>\", line 670 in _load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 967 in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 983 in _find_and_load\r\n...\r\n  File \"/home/circleci/project/venv/lib/python3.7/site-packages/_pytest/config/__init__.py\", line 92 in main\r\n  File \"/home/circleci/project/venv/bin/pytest\", line 8 in <module>\r\n\r\nReceived \"segmentation fault\" signal\r\n```\r\n\r\nThis error is reproducible in the local environment by \r\n```console\r\ncircleci build --job tests-python37 \r\n```\r\n\r\nThe CI jobs completed properly yesterday as can be seen in https://circleci.com/gh/optuna/optuna/24654. \r\n\r\nI'm not sure but I'm thinking some updates in `scipy==1.4.0` caused this error.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/800/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/800/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/760", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/760/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/760/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/760/events", "html_url": "https://github.com/optuna/optuna/issues/760", "id": 531306373, "node_id": "MDU6SXNzdWU1MzEzMDYzNzM=", "number": 760, "title": "study.best_trial takes minutes to load from postgres", "user": {"login": "dwiel", "id": 29542, "node_id": "MDQ6VXNlcjI5NTQy", "avatar_url": "https://avatars.githubusercontent.com/u/29542?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dwiel", "html_url": "https://github.com/dwiel", "followers_url": "https://api.github.com/users/dwiel/followers", "following_url": "https://api.github.com/users/dwiel/following{/other_user}", "gists_url": "https://api.github.com/users/dwiel/gists{/gist_id}", "starred_url": "https://api.github.com/users/dwiel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dwiel/subscriptions", "organizations_url": "https://api.github.com/users/dwiel/orgs", "repos_url": "https://api.github.com/users/dwiel/repos", "events_url": "https://api.github.com/users/dwiel/events{/privacy}", "received_events_url": "https://api.github.com/users/dwiel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2019-12-02T17:10:25Z", "updated_at": "2019-12-04T01:57:21Z", "closed_at": "2019-12-03T03:14:38Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "## Expected behavior\r\n\r\nI have a study with a few thousand trials. It takes a few minutes to simply load the best trial. It looks like not only is this query happening in the application layer, but the number of queries executed is `O(n)` instead of `O(1)`.\r\n\r\n## Environment\r\n\r\n- Optuna version: 0.19.0\r\n- Python version: 3.6.8\r\n- OS: Ubuntu 18.04\r\n\r\n## Steps to reproduce\r\n\r\n1. Use postgres backend\r\n2. Create a study with thousands of trials\r\n3. In a new process, attempt to access the studies best_trial\r\n\r\nIt takes similar amounts of time to do things like get a data frame with all trial information, render visualizations, etc.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/760/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/760/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/721", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/721/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/721/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/721/events", "html_url": "https://github.com/optuna/optuna/pull/721", "id": 524819241, "node_id": "MDExOlB1bGxSZXF1ZXN0MzQyNTI0NTQx", "number": 721, "title": "Use default parameter when tuned parameter doesn't improve.", "user": {"login": "smly", "id": 19337, "node_id": "MDQ6VXNlcjE5MzM3", "avatar_url": "https://avatars.githubusercontent.com/u/19337?v=4", "gravatar_id": "", "url": "https://api.github.com/users/smly", "html_url": "https://github.com/smly", "followers_url": "https://api.github.com/users/smly/followers", "following_url": "https://api.github.com/users/smly/following{/other_user}", "gists_url": "https://api.github.com/users/smly/gists{/gist_id}", "starred_url": "https://api.github.com/users/smly/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/smly/subscriptions", "organizations_url": "https://api.github.com/users/smly/orgs", "repos_url": "https://api.github.com/users/smly/repos", "events_url": "https://api.github.com/users/smly/events{/privacy}", "received_events_url": "https://api.github.com/users/smly/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/19", "html_url": "https://github.com/optuna/optuna/milestone/19", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/19/labels", "id": 4853919, "node_id": "MDk6TWlsZXN0b25lNDg1MzkxOQ==", "number": 19, "title": "v1.0.0", "description": "", "creator": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 84, "state": "closed", "created_at": "2019-11-18T02:20:18Z", "updated_at": "2020-01-14T04:22:38Z", "due_on": null, "closed_at": "2020-01-14T04:22:38Z"}, "comments": 1, "created_at": "2019-11-19T07:11:20Z", "updated_at": "2020-01-09T05:54:07Z", "closed_at": "2019-12-04T00:18:12Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/721", "html_url": "https://github.com/optuna/optuna/pull/721", "diff_url": "https://github.com/optuna/optuna/pull/721.diff", "patch_url": "https://github.com/optuna/optuna/pull/721.patch", "merged_at": "2019-12-04T00:18:12Z"}, "body": "LightGBMTuner tunes parameters in groups step by step. The current implementation adopts parameters that are worse than the default when the result of tuning at one stage is worse than at the previous stage. This PR resolves it.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/721/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/721/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/707", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/707/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/707/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/707/events", "html_url": "https://github.com/optuna/optuna/issues/707", "id": 522798289, "node_id": "MDU6SXNzdWU1MjI3OTgyODk=", "number": 707, "title": "Cannot import optuna.exceptions", "user": {"login": "AmenRa", "id": 11797097, "node_id": "MDQ6VXNlcjExNzk3MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/11797097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AmenRa", "html_url": "https://github.com/AmenRa", "followers_url": "https://api.github.com/users/AmenRa/followers", "following_url": "https://api.github.com/users/AmenRa/following{/other_user}", "gists_url": "https://api.github.com/users/AmenRa/gists{/gist_id}", "starred_url": "https://api.github.com/users/AmenRa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AmenRa/subscriptions", "organizations_url": "https://api.github.com/users/AmenRa/orgs", "repos_url": "https://api.github.com/users/AmenRa/repos", "events_url": "https://api.github.com/users/AmenRa/events{/privacy}", "received_events_url": "https://api.github.com/users/AmenRa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-11-14T11:28:47Z", "updated_at": "2019-11-14T12:00:09Z", "closed_at": "2019-11-14T11:59:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "Cannot import optuna.exceptions\r\n\r\n## Expected behavior\r\n\r\nIt should import optuna.exceptions as shown in [examples](https://github.com/pfnet/optuna/blob/cf6aba4b7ecd2d97aa9460c06ea353d8e72570a5/tests/samplers_tests/tpe_tests/test_sampler.py).\r\n\r\n## Environment\r\n\r\n- Optuna version: I installed 0.18.1 using Conda but if I list env dependancies it show 0.17.1\r\n- Python version: 3.7\r\n- OS: MacOS\r\n- (Optional) Other libraries and their versions:\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n```\r\nModuleNotFoundError: No module named 'optuna.exceptions'\r\n```\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\nfrom optuna.exceptions import TrialPruned\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/707/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/707/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/684", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/684/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/684/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/684/events", "html_url": "https://github.com/optuna/optuna/pull/684", "id": 520084820, "node_id": "MDExOlB1bGxSZXF1ZXN0MzM4NzM0NzQz", "number": 684, "title": "Fix #679 (`time_budget` option on `lightgbm_tuner.train()`)", "user": {"login": "momijiame", "id": 1781355, "node_id": "MDQ6VXNlcjE3ODEzNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1781355?v=4", "gravatar_id": "", "url": "https://api.github.com/users/momijiame", "html_url": "https://github.com/momijiame", "followers_url": "https://api.github.com/users/momijiame/followers", "following_url": "https://api.github.com/users/momijiame/following{/other_user}", "gists_url": "https://api.github.com/users/momijiame/gists{/gist_id}", "starred_url": "https://api.github.com/users/momijiame/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/momijiame/subscriptions", "organizations_url": "https://api.github.com/users/momijiame/orgs", "repos_url": "https://api.github.com/users/momijiame/repos", "events_url": "https://api.github.com/users/momijiame/events{/privacy}", "received_events_url": "https://api.github.com/users/momijiame/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/17", "html_url": "https://github.com/optuna/optuna/milestone/17", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/17/labels", "id": 4822579, "node_id": "MDk6TWlsZXN0b25lNDgyMjU3OQ==", "number": 17, "title": "v0.19.0", "description": "", "creator": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 20, "state": "closed", "created_at": "2019-11-07T03:08:03Z", "updated_at": "2019-11-18T02:21:00Z", "due_on": null, "closed_at": "2019-11-18T02:21:00Z"}, "comments": 0, "created_at": "2019-11-08T15:42:56Z", "updated_at": "2019-11-15T04:43:31Z", "closed_at": "2019-11-11T02:42:16Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/684", "html_url": "https://github.com/optuna/optuna/pull/684", "diff_url": "https://github.com/optuna/optuna/pull/684.diff", "patch_url": "https://github.com/optuna/optuna/pull/684.patch", "merged_at": "2019-11-11T02:42:16Z"}, "body": "fix the direction of the comparison operator reversed.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/684/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/684/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/679", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/679/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/679/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/679/events", "html_url": "https://github.com/optuna/optuna/issues/679", "id": 519725797, "node_id": "MDU6SXNzdWU1MTk3MjU3OTc=", "number": 679, "title": "`time_budget` option on `lightgbm_tuner.train()` is not working well", "user": {"login": "momijiame", "id": 1781355, "node_id": "MDQ6VXNlcjE3ODEzNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1781355?v=4", "gravatar_id": "", "url": "https://api.github.com/users/momijiame", "html_url": "https://github.com/momijiame", "followers_url": "https://api.github.com/users/momijiame/followers", "following_url": "https://api.github.com/users/momijiame/following{/other_user}", "gists_url": "https://api.github.com/users/momijiame/gists{/gist_id}", "starred_url": "https://api.github.com/users/momijiame/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/momijiame/subscriptions", "organizations_url": "https://api.github.com/users/momijiame/orgs", "repos_url": "https://api.github.com/users/momijiame/repos", "events_url": "https://api.github.com/users/momijiame/events{/privacy}", "received_events_url": "https://api.github.com/users/momijiame/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-11-08T04:39:28Z", "updated_at": "2019-11-11T02:42:17Z", "closed_at": "2019-11-11T02:42:17Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "`time_budget` option on `lightgbm_tuner.train()`  is not working well with stepwise optimization.\r\nIMHO, Isn't the direction of the comparison operator reversed the following?\r\n\r\nhttps://github.com/pfnet/optuna/blob/v0.18.0/optuna/integration/lightgbm_tuner/optimize.py#L378,L407\r\n\r\n## Expected behavior\r\n\r\nI expected `time_budget` to behave like `timeout` option of `Study#optimize()`.\r\nIn other words, it is specified for the time allowed for optimization.\r\nBut current `time_budget` does not behave that so.\r\nIf large value is set, only `feature_fraction` is optimized and exited.\r\nNOTE: `feature_fraction` is the first parameter of lightgbm_tuner step-wise optimization, I expect.\r\n\r\nSorry if the above expectation is fundamentally wrong...\r\n\r\n## Environment\r\n\r\n- Optuna version: 0.18.0\r\n- Python version: 3.7.5\r\n- OS: macOS Mojave (10.14.6)\r\n- LightGBM version: 2.3.0\r\n\r\n## Error messages, stack traces, or logs\r\n\r\n- Output of step 1 (set a large value to `time_budget`)\r\n\r\n```\r\n$ python3 lgbtune.py\r\n...\r\ntune_feature_fraction, val_score: 0.109507:  86%|########5 | 6/7 [00:00<00:00, 17.63it/s][I 2019-11-08 13:03:10,975] Finished trial#6 resulted in value: 0.11621424018474308. Current best value is 0.10950685788917311 with parameters: {'feature_fraction': 0.7}.\r\ntune_feature_fraction, val_score: 0.109507: 100%|##########| 7/7 [00:00<00:00, 16.58it/s]\r\n\r\n(Process finished with exit code 0)\r\n```\r\n\r\n- Output of step 3 (comment out `time_budget`)\r\n\r\n```\r\n$ python3 lgbtune.py\r\n...\r\n...\r\ntune_min_child_samples, val_score: 0.066915:  80%|########  | 4/5 [00:00<00:00, 21.78it/s][I 2019-11-08 13:27:24,351] Finished trial#4 resulted in value: 1.4095717272810777. Current best value is 0.08811113641629516 with parameters: {'min_child_samples': 10}.\r\ntune_min_child_samples, val_score: 0.066915: 100%|##########| 5/5 [00:00<00:00, 19.24it/s]\r\n\r\n(Process finished with exit code 0)\r\n```\r\n\r\n## Steps to reproduce\r\n\r\n1. run the following code (set large value to`time_budget`)\r\n2. edit the following code. (comment out or set to zero: `time_budget`)\r\n3. re-run\r\n\r\n## Reproducible examples (optional)\r\n\r\n```python\r\n#!/usr/bin/env python3\r\n# -*- coding: utf-8 -*-\r\n\r\nfrom sklearn import datasets\r\nfrom sklearn.model_selection import train_test_split\r\nfrom optuna.integration import lightgbm_tuner\r\nimport lightgbm as lgb\r\n\r\n\r\ndef main():\r\n    dataset = datasets.load_iris()\r\n    X, y = dataset.data, dataset.target\r\n    X_train, X_test, y_train, y_test = train_test_split(X, y,\r\n                                                        shuffle=True,\r\n                                                        random_state=42)\r\n\r\n    lgb_train = lgb.Dataset(X_train, y_train)\r\n    lgb_valid = lgb.Dataset(X_test, y_test, reference=lgb_train)\r\n\r\n    lgb_params = {\r\n        'objective': 'regression',\r\n        'metric': 'rmse',\r\n    }\r\n\r\n    lightgbm_tuner.train(lgb_params, lgb_train,\r\n                         valid_sets=lgb_valid,\r\n                         num_boost_round=1000,\r\n                         early_stopping_rounds=100,\r\n                         verbose_eval=10,\r\n                         time_budget=10000,\r\n                         )\r\n\r\n\r\nif __name__ == '__main__':\r\n    main()\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/679/reactions", "total_count": 3, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/679/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/674", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/674/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/674/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/674/events", "html_url": "https://github.com/optuna/optuna/pull/674", "id": 519095912, "node_id": "MDExOlB1bGxSZXF1ZXN0MzM3ODk5Mzg0", "number": 674, "title": "Fix `import optuna` failure on Python2.7 environment without LightGBM installed.", "user": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1633027617, "node_id": "MDU6TGFiZWwxNjMzMDI3NjE3", "url": "https://api.github.com/repos/optuna/optuna/labels/CI", "name": "CI", "color": "0052cc", "default": false, "description": "Continuous integration."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/18", "html_url": "https://github.com/optuna/optuna/milestone/18", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/18/labels", "id": 4826540, "node_id": "MDk6TWlsZXN0b25lNDgyNjU0MA==", "number": 18, "title": "v0.18.1", "description": "", "creator": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 2, "state": "closed", "created_at": "2019-11-08T04:04:23Z", "updated_at": "2019-11-08T05:06:56Z", "due_on": null, "closed_at": "2019-11-08T05:06:56Z"}, "comments": 0, "created_at": "2019-11-07T07:41:31Z", "updated_at": "2019-11-08T04:04:47Z", "closed_at": "2019-11-07T12:29:48Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/674", "html_url": "https://github.com/optuna/optuna/pull/674", "diff_url": "https://github.com/optuna/optuna/pull/674.diff", "patch_url": "https://github.com/optuna/optuna/pull/674.patch", "merged_at": "2019-11-07T12:29:48Z"}, "body": "This PR fixes a failure of `import optuna` on Python2.7 environment without LightGBM installed (see below for the details of the failure).\r\n\r\n```console\r\n$ docker run --rm -it python:2.7 /bin/bash\r\n\r\n// Install optuna.\r\nroot@16d5c79b9009:/# pip install optuna\r\nroot@16d5c79b9009:/# optuna --version\r\noptuna 0.18.0\r\n\r\n// Import optuna (failed).\r\nroot@16d5c79b9009:/# python -c 'import optuna'\r\nTraceback (most recent call last):\r\n  File \"<string>\", line 1, in <module>\r\n  File \"/usr/local/lib/python2.7/site-packages/optuna/__init__.py\", line 3, in <module>\r\n    from optuna import integration  # NOQA\r\n  File \"/usr/local/lib/python2.7/site-packages/optuna/integration/__init__.py\", line 37, in <module>\r\n    from optuna.integration.lightgbm import LightGBMTuner  # NOQA\r\nImportError: cannot import name LightGBMTuner\r\n\r\n// Install lightgbm then import optuna (succeeded).\r\nroot@16d5c79b9009:/# pip install lightgbm\r\nroot@16d5c79b9009:/# python -c 'import optuna'\r\n```\r\n\r\nIn addition, this PR adds an import check to CI so that similar problems can be detected early in the future.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/674/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/674/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/672", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/672/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/672/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/672/events", "html_url": "https://github.com/optuna/optuna/pull/672", "id": 518975601, "node_id": "MDExOlB1bGxSZXF1ZXN0MzM3ODAzNjc3", "number": 672, "title": "Fix CI failure due to pytorch_lightning-v0.5.3.", "user": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/15", "html_url": "https://github.com/optuna/optuna/milestone/15", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/15/labels", "id": 4741701, "node_id": "MDk6TWlsZXN0b25lNDc0MTcwMQ==", "number": 15, "title": "v0.18.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 61, "state": "closed", "created_at": "2019-10-11T02:58:30Z", "updated_at": "2019-11-07T03:20:48Z", "due_on": null, "closed_at": "2019-11-07T03:20:48Z"}, "comments": 0, "created_at": "2019-11-07T00:55:05Z", "updated_at": "2019-11-07T00:59:23Z", "closed_at": "2019-11-07T00:59:18Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/672", "html_url": "https://github.com/optuna/optuna/pull/672", "diff_url": "https://github.com/optuna/optuna/pull/672.diff", "patch_url": "https://github.com/optuna/optuna/pull/672.patch", "merged_at": "2019-11-07T00:59:17Z"}, "body": "Because pytorch_ligntning-v0.5.3 seems to have some issues (see: https://github.com/williamFalcon/pytorch-lightning/issues/469), this PR adds a version constraint to force Optuna to use v0.5.2 or less version of pytorch_lightning.\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/672/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/672/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/662", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/662/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/662/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/662/events", "html_url": "https://github.com/optuna/optuna/pull/662", "id": 516027174, "node_id": "MDExOlB1bGxSZXF1ZXN0MzM1MzU3MDc0", "number": 662, "title": "Fix colorbar of contour plots.", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/15", "html_url": "https://github.com/optuna/optuna/milestone/15", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/15/labels", "id": 4741701, "node_id": "MDk6TWlsZXN0b25lNDc0MTcwMQ==", "number": 15, "title": "v0.18.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 61, "state": "closed", "created_at": "2019-10-11T02:58:30Z", "updated_at": "2019-11-07T03:20:48Z", "due_on": null, "closed_at": "2019-11-07T03:20:48Z"}, "comments": 0, "created_at": "2019-11-01T10:15:13Z", "updated_at": "2019-11-05T06:00:27Z", "closed_at": "2019-11-05T06:00:24Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/662", "html_url": "https://github.com/optuna/optuna/pull/662", "diff_url": "https://github.com/optuna/optuna/pull/662.diff", "patch_url": "https://github.com/optuna/optuna/pull/662.patch", "merged_at": "2019-11-05T06:00:23Z"}, "body": "This PR fixes https://github.com/pfnet/optuna/issues/606.\r\nThe cause of the issue seems to be a bug of `go.Contour` because it only happens if both `contours_coloring='heatmap'` and `reversescale=True` are specified simultaneously.\r\n\r\nIn this PR, I stopped using `reversesecale` and sorted the color scale manually as a tentative fix.\r\n\r\nA plot of a minimization task (the brighter the better):\r\n![minimize-fix-colorbar2](https://user-images.githubusercontent.com/3255979/68018023-6f7cd480-fcdb-11e9-8f34-fd8e1d183664.png)\r\n\r\nCode of the minimization task:\r\n```python\r\nimport optuna\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_uniform('x', -10, 10)\r\n    y = trial.suggest_uniform('y', -10, 10)\r\n    return (x - 2) ** 2 + (y + 5) ** 2\r\n\r\nstudy = optuna.create_study(direction='minimize', sampler=optuna.samplers.RandomSampler())\r\nstudy.optimize(objective, n_trials=100, gc_after_trial=False)\r\noptuna.visualization.plot_contour(study)\r\n```\r\n\r\nA plot of a maximization task (the brighter the better):\r\n![maximize-fix-colorbar2](https://user-images.githubusercontent.com/3255979/68018100-a18e3680-fcdb-11e9-901f-7697a31a6c5c.png)\r\n\r\nCode of the maximization task:\r\n```python\r\nimport optuna\r\n\r\ndef objective(trial):\r\n    x = trial.suggest_uniform('x', -10, 10)\r\n    y = trial.suggest_uniform('y', -10, 10)\r\n    return - ((x - 2) ** 2 + (y + 5) ** 2)\r\n\r\nstudy = optuna.create_study(direction='maximize', sampler=optuna.samplers.RandomSampler())\r\nstudy.optimize(objective, n_trials=100, gc_after_trial=False)\r\n\r\noptuna.visualization.plot_contour(study)\r\n```\r\n ", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/662/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/662/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/646", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/646/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/646/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/646/events", "html_url": "https://github.com/optuna/optuna/pull/646", "id": 513208232, "node_id": "MDExOlB1bGxSZXF1ZXN0MzMzMDM5NDAy", "number": 646, "title": "Fix a bug that `LightGBMTuner` doesn't update `tuning_history` or `best_params`.", "user": {"login": "smly", "id": 19337, "node_id": "MDQ6VXNlcjE5MzM3", "avatar_url": "https://avatars.githubusercontent.com/u/19337?v=4", "gravatar_id": "", "url": "https://api.github.com/users/smly", "html_url": "https://github.com/smly", "followers_url": "https://api.github.com/users/smly/followers", "following_url": "https://api.github.com/users/smly/following{/other_user}", "gists_url": "https://api.github.com/users/smly/gists{/gist_id}", "starred_url": "https://api.github.com/users/smly/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/smly/subscriptions", "organizations_url": "https://api.github.com/users/smly/orgs", "repos_url": "https://api.github.com/users/smly/repos", "events_url": "https://api.github.com/users/smly/events{/privacy}", "received_events_url": "https://api.github.com/users/smly/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/15", "html_url": "https://github.com/optuna/optuna/milestone/15", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/15/labels", "id": 4741701, "node_id": "MDk6TWlsZXN0b25lNDc0MTcwMQ==", "number": 15, "title": "v0.18.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 61, "state": "closed", "created_at": "2019-10-11T02:58:30Z", "updated_at": "2019-11-07T03:20:48Z", "due_on": null, "closed_at": "2019-11-07T03:20:48Z"}, "comments": 0, "created_at": "2019-10-28T10:07:50Z", "updated_at": "2019-10-29T09:40:34Z", "closed_at": "2019-10-29T09:40:29Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/646", "html_url": "https://github.com/optuna/optuna/pull/646", "diff_url": "https://github.com/optuna/optuna/pull/646.diff", "patch_url": "https://github.com/optuna/optuna/pull/646.patch", "merged_at": "2019-10-29T09:40:29Z"}, "body": "This PR fixes the problem that `LightGBMTuner` doesn't update `tuning_history` or `best_params` when the given object for `tuning_history` or `best_params` is an empty `list` or `dict`.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/646/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/646/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/644", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/644/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/644/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/644/events", "html_url": "https://github.com/optuna/optuna/pull/644", "id": 513123665, "node_id": "MDExOlB1bGxSZXF1ZXN0MzMyOTcxNjYw", "number": 644, "title": "Add type casting to float.", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/15", "html_url": "https://github.com/optuna/optuna/milestone/15", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/15/labels", "id": 4741701, "node_id": "MDk6TWlsZXN0b25lNDc0MTcwMQ==", "number": 15, "title": "v0.18.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 61, "state": "closed", "created_at": "2019-10-11T02:58:30Z", "updated_at": "2019-11-07T03:20:48Z", "due_on": null, "closed_at": "2019-11-07T03:20:48Z"}, "comments": 0, "created_at": "2019-10-28T06:40:54Z", "updated_at": "2019-10-29T00:39:18Z", "closed_at": "2019-10-29T00:39:15Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/644", "html_url": "https://github.com/optuna/optuna/pull/644", "diff_url": "https://github.com/optuna/optuna/pull/644.diff", "patch_url": "https://github.com/optuna/optuna/pull/644.patch", "merged_at": "2019-10-29T00:39:15Z"}, "body": "Solves #642.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/644/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/644/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/642", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/642/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/642/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/642/events", "html_url": "https://github.com/optuna/optuna/issues/642", "id": 512852397, "node_id": "MDU6SXNzdWU1MTI4NTIzOTc=", "number": 642, "title": "Doesnt work with MySql or PostgreSql", "user": {"login": "rafaeldelrey", "id": 3863727, "node_id": "MDQ6VXNlcjM4NjM3Mjc=", "avatar_url": "https://avatars.githubusercontent.com/u/3863727?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rafaeldelrey", "html_url": "https://github.com/rafaeldelrey", "followers_url": "https://api.github.com/users/rafaeldelrey/followers", "following_url": "https://api.github.com/users/rafaeldelrey/following{/other_user}", "gists_url": "https://api.github.com/users/rafaeldelrey/gists{/gist_id}", "starred_url": "https://api.github.com/users/rafaeldelrey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rafaeldelrey/subscriptions", "organizations_url": "https://api.github.com/users/rafaeldelrey/orgs", "repos_url": "https://api.github.com/users/rafaeldelrey/repos", "events_url": "https://api.github.com/users/rafaeldelrey/events{/privacy}", "received_events_url": "https://api.github.com/users/rafaeldelrey/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-10-26T16:01:17Z", "updated_at": "2020-01-17T04:59:33Z", "closed_at": "2020-01-17T04:59:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "While using Optuna with Keras (from Tensorflow 1.13 or 1.14), I cannot make it work with MySql or Postgre.  It seems Optuna is passing a numpy.float32 for sqlalchemy, which is causing problems (I have tried pymysql or mysqldb connectors, as well as some connectors for pg).\r\n\r\nit seems on trial.py, line 378, there should be some handling of value param being passed to sqlalchemy.\r\n\r\nself.storage.set_trial_value(self._trial_id, value)\r\n\r\nThis is the error I m getting:\r\nAttributeError: 'numpy.float32' object has no attribute 'translate'\r\n\r\nSince this function is called from inside a keras callback, there is no easy way for the Optuna user to change this, afaik.\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/642/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/642/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/624", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/624/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/624/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/624/events", "html_url": "https://github.com/optuna/optuna/pull/624", "id": 509571894, "node_id": "MDExOlB1bGxSZXF1ZXN0MzMwMTAxMzIz", "number": 624, "title": "Hotfix: add missing comma", "user": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/15", "html_url": "https://github.com/optuna/optuna/milestone/15", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/15/labels", "id": 4741701, "node_id": "MDk6TWlsZXN0b25lNDc0MTcwMQ==", "number": 15, "title": "v0.18.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 61, "state": "closed", "created_at": "2019-10-11T02:58:30Z", "updated_at": "2019-11-07T03:20:48Z", "due_on": null, "closed_at": "2019-11-07T03:20:48Z"}, "comments": 0, "created_at": "2019-10-20T09:53:47Z", "updated_at": "2019-10-21T00:53:25Z", "closed_at": "2019-10-21T00:24:32Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/624", "html_url": "https://github.com/optuna/optuna/pull/624", "diff_url": "https://github.com/optuna/optuna/pull/624.diff", "patch_url": "https://github.com/optuna/optuna/pull/624.patch", "merged_at": "2019-10-21T00:24:31Z"}, "body": "Seemed like a comma was overlooked in #613. This PR adds that comma.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/624/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/624/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/619", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/619/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/619/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/619/events", "html_url": "https://github.com/optuna/optuna/pull/619", "id": 508817391, "node_id": "MDExOlB1bGxSZXF1ZXN0MzI5NTM1NDA4", "number": 619, "title": "Add EPS to resolve `ValueError` in `LightGBMTuner`.", "user": {"login": "smly", "id": 19337, "node_id": "MDQ6VXNlcjE5MzM3", "avatar_url": "https://avatars.githubusercontent.com/u/19337?v=4", "gravatar_id": "", "url": "https://api.github.com/users/smly", "html_url": "https://github.com/smly", "followers_url": "https://api.github.com/users/smly/followers", "following_url": "https://api.github.com/users/smly/following{/other_user}", "gists_url": "https://api.github.com/users/smly/gists{/gist_id}", "starred_url": "https://api.github.com/users/smly/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/smly/subscriptions", "organizations_url": "https://api.github.com/users/smly/orgs", "repos_url": "https://api.github.com/users/smly/repos", "events_url": "https://api.github.com/users/smly/events{/privacy}", "received_events_url": "https://api.github.com/users/smly/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/15", "html_url": "https://github.com/optuna/optuna/milestone/15", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/15/labels", "id": 4741701, "node_id": "MDk6TWlsZXN0b25lNDc0MTcwMQ==", "number": 15, "title": "v0.18.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 61, "state": "closed", "created_at": "2019-10-11T02:58:30Z", "updated_at": "2019-11-07T03:20:48Z", "due_on": null, "closed_at": "2019-11-07T03:20:48Z"}, "comments": 1, "created_at": "2019-10-18T02:28:54Z", "updated_at": "2019-11-07T01:36:43Z", "closed_at": "2019-10-24T01:41:18Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/619", "html_url": "https://github.com/optuna/optuna/pull/619", "diff_url": "https://github.com/optuna/optuna/pull/619.diff", "patch_url": "https://github.com/optuna/optuna/pull/619.patch", "merged_at": "2019-10-24T01:41:18Z"}, "body": "I found that LightGBMTuner raises `ValueError` (as below) whenever it tries to tune `feature_fraction`. This PR resolves this issue.\r\n\r\n```\r\ntune_feature_fraction, val_score: 0.215008:  86%|##############################################################5          | 6/7 [00:01<00:00,  3.94it/s]\r\nSetting status of trial#6 as TrialState.FAIL because of the following error:\r\nValueError('Suggest method is called for an invalid parameter: feature_frac\r\ntion.')\r\nTraceback (most recent call last):\r\n  File \"/home/ozaki/anaconda/lib/python3.7/site-packages/optuna/study.py\", line 504, in _run_trial\r\n    result = func(trial)\r\n  File \"/home/ozaki/anaconda/lib/python3.7/site-packages/optuna/integration/lightgbm_tuner/optimize.py\", line 210, in __call__\r\n    param_value = trial.suggest_uniform('feature_fraction', 0.4, 1.0)\r\n  File \"/home/ozaki/anaconda/lib/python3.7/site-packages/optuna/trial.py\", line 187, in suggest_uniform\r\n    return self._suggest(name, distribution)\r\n  File \"/home/ozaki/anaconda/lib/python3.7/site-packages/optuna/trial.py\", line 461, in _suggest\r\n    self.study, trial, name, distribution)\r\n  File \"/home/ozaki/anaconda/lib/python3.7/site-packages/optuna/integration/lightgbm_tuner/optimize.py\", line 58, in sample_independent\r\n    'Suggest method is called for an invalid parameter: {}.'.format(param_name))\r\nValueError: Suggest method is called for an invalid parameter: feature_fraction.\r\n```\r\n\r\nThis error causes when `_GridSamplerUniform1D`, a subclass of BaseSampler, calls `sample_independent()` unexpectedly.\r\n\r\n* [x] TODO: I will add a test case to detect this issue related to numerical precision.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/619/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/619/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/613", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/613/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/613/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/613/events", "html_url": "https://github.com/optuna/optuna/pull/613", "id": 508279138, "node_id": "MDExOlB1bGxSZXF1ZXN0MzI5MTAxNzM1", "number": 613, "title": "Hotfix: add missing comma", "user": {"login": "smly", "id": 19337, "node_id": "MDQ6VXNlcjE5MzM3", "avatar_url": "https://avatars.githubusercontent.com/u/19337?v=4", "gravatar_id": "", "url": "https://api.github.com/users/smly", "html_url": "https://github.com/smly", "followers_url": "https://api.github.com/users/smly/followers", "following_url": "https://api.github.com/users/smly/following{/other_user}", "gists_url": "https://api.github.com/users/smly/gists{/gist_id}", "starred_url": "https://api.github.com/users/smly/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/smly/subscriptions", "organizations_url": "https://api.github.com/users/smly/orgs", "repos_url": "https://api.github.com/users/smly/repos", "events_url": "https://api.github.com/users/smly/events{/privacy}", "received_events_url": "https://api.github.com/users/smly/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/15", "html_url": "https://github.com/optuna/optuna/milestone/15", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/15/labels", "id": 4741701, "node_id": "MDk6TWlsZXN0b25lNDc0MTcwMQ==", "number": 15, "title": "v0.18.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 61, "state": "closed", "created_at": "2019-10-11T02:58:30Z", "updated_at": "2019-11-07T03:20:48Z", "due_on": null, "closed_at": "2019-11-07T03:20:48Z"}, "comments": 0, "created_at": "2019-10-17T07:05:31Z", "updated_at": "2019-10-17T10:06:49Z", "closed_at": "2019-10-17T07:17:07Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/613", "html_url": "https://github.com/optuna/optuna/pull/613", "diff_url": "https://github.com/optuna/optuna/pull/613.diff", "patch_url": "https://github.com/optuna/optuna/pull/613.patch", "merged_at": "2019-10-17T07:17:07Z"}, "body": "", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/613/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/613/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/606", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/606/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/606/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/606/events", "html_url": "https://github.com/optuna/optuna/issues/606", "id": 507714901, "node_id": "MDU6SXNzdWU1MDc3MTQ5MDE=", "number": 606, "title": "Colorbar of contour plot doesn't reflect actual objective value.", "user": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-10-16T09:02:46Z", "updated_at": "2019-11-05T06:00:23Z", "closed_at": "2019-11-05T06:00:23Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "The following code plots a contour plot:\r\n```python\r\nimport optuna \r\n\r\ndef objective(trial):\r\n    x = trial.suggest_uniform('x', -10, 10)\r\n    y = trial.suggest_uniform('y', -10, 10)\r\n    return (x - 2) ** 2 + (y + 5) ** 2\r\n\r\nstudy = optuna.create_study(direction='minimize')\r\nstudy.optimize(objective, n_trials=100)\r\n\r\noptuna.visualization.plot_contour(study)\r\n```\r\n![image](https://user-images.githubusercontent.com/181413/66903062-b791cb00-f03c-11e9-9410-b8bcf56035ad.png)\r\n\r\n\r\nThe labels of the colorbar in this plot indicates that the darker the area, the worse (i.e., higher) the objective value.\r\nHowever, actually, the darker region mean that there are better (i.e., lower) objective values.\r\nI think this is a bug of `plot_contour()` method.\r\n\r\nLibrary version\r\n----------------\r\n\r\n- optuna: 0.17.1\r\n- plotly: 4.1.1\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/606/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/606/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/598", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/598/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/598/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/598/events", "html_url": "https://github.com/optuna/optuna/pull/598", "id": 507166285, "node_id": "MDExOlB1bGxSZXF1ZXN0MzI4MjA1NTk4", "number": 598, "title": "Add missing call to check function", "user": {"login": "hvy", "id": 5983694, "node_id": "MDQ6VXNlcjU5ODM2OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5983694?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvy", "html_url": "https://github.com/hvy", "followers_url": "https://api.github.com/users/hvy/followers", "following_url": "https://api.github.com/users/hvy/following{/other_user}", "gists_url": "https://api.github.com/users/hvy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvy/subscriptions", "organizations_url": "https://api.github.com/users/hvy/orgs", "repos_url": "https://api.github.com/users/hvy/repos", "events_url": "https://api.github.com/users/hvy/events{/privacy}", "received_events_url": "https://api.github.com/users/hvy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/15", "html_url": "https://github.com/optuna/optuna/milestone/15", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/15/labels", "id": 4741701, "node_id": "MDk6TWlsZXN0b25lNDc0MTcwMQ==", "number": 15, "title": "v0.18.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 61, "state": "closed", "created_at": "2019-10-11T02:58:30Z", "updated_at": "2019-11-07T03:20:48Z", "due_on": null, "closed_at": "2019-11-07T03:20:48Z"}, "comments": 0, "created_at": "2019-10-15T10:53:31Z", "updated_at": "2019-10-16T00:42:47Z", "closed_at": "2019-10-16T00:03:15Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/598", "html_url": "https://github.com/optuna/optuna/pull/598", "diff_url": "https://github.com/optuna/optuna/pull/598.diff", "patch_url": "https://github.com/optuna/optuna/pull/598.patch", "merged_at": "2019-10-16T00:03:15Z"}, "body": "Fixes to call an unused function.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/598/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/598/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/547", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/547/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/547/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/547/events", "html_url": "https://github.com/optuna/optuna/pull/547", "id": 498092060, "node_id": "MDExOlB1bGxSZXF1ZXN0MzIxMDkzODgw", "number": 547, "title": "Fix package of TracebackType.", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/13", "html_url": "https://github.com/optuna/optuna/milestone/13", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/13/labels", "id": 4652597, "node_id": "MDk6TWlsZXN0b25lNDY1MjU5Nw==", "number": 13, "title": "v0.17.0", "description": "", "creator": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 41, "state": "closed", "created_at": "2019-09-12T01:33:59Z", "updated_at": "2019-10-11T03:01:22Z", "due_on": null, "closed_at": "2019-10-11T03:01:22Z"}, "comments": 0, "created_at": "2019-09-25T07:07:29Z", "updated_at": "2019-09-30T07:14:50Z", "closed_at": "2019-09-25T08:59:55Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/547", "html_url": "https://github.com/optuna/optuna/pull/547", "diff_url": "https://github.com/optuna/optuna/pull/547.diff", "patch_url": "https://github.com/optuna/optuna/pull/547.patch", "merged_at": "2019-09-25T08:59:55Z"}, "body": "`optuna.type_checking` does not have `TracebackType`.\r\nI think these lines were changed by mistake in PR (#492).", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/547/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/547/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/504", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/504/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/504/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/504/events", "html_url": "https://github.com/optuna/optuna/pull/504", "id": 488131604, "node_id": "MDExOlB1bGxSZXF1ZXN0MzEzMjE3MzM1", "number": 504, "title": "Call session commit after read access.", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/14", "html_url": "https://github.com/optuna/optuna/milestone/14", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/14/labels", "id": 4652599, "node_id": "MDk6TWlsZXN0b25lNDY1MjU5OQ==", "number": 14, "title": "v0.16.0", "description": "", "creator": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 8, "state": "closed", "created_at": "2019-09-12T01:37:01Z", "updated_at": "2019-09-12T01:38:55Z", "due_on": null, "closed_at": "2019-09-12T01:38:55Z"}, "comments": 0, "created_at": "2019-09-02T11:00:48Z", "updated_at": "2019-09-12T01:38:21Z", "closed_at": "2019-09-03T04:40:59Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/504", "html_url": "https://github.com/optuna/optuna/pull/504", "diff_url": "https://github.com/optuna/optuna/pull/504.diff", "patch_url": "https://github.com/optuna/optuna/pull/504.patch", "merged_at": "2019-09-03T04:40:59Z"}, "body": "This PR adds `session.commit()` to read access in `RDBStorage` in order to terminate transactions explicitly.\r\n\r\nWhen I used `RDBStorage` with `MySQL`, the options to reconnect DB connections were ignored.\r\nMore specifically, I encountered `pymysql.err.OperationalError: (2013, 'Lost connection to MySQL server during query')` even if I set `pool_recycle` or `pool_pre_ping=True` as follows:\r\n\r\n```python\r\nimport optuna\r\nimport time\r\n\r\nurl = 'mysql+pymysql://...'\r\n\r\ndef objective(trial):\r\n    return trial.suggest_int('x', -10, 10)\r\n\r\nstorage = optuna.storages.RDBStorage(url, {'pool_recycle': 30}) # pool_recycle\r\nstudy = optuna.create_study(storage=storage)\r\nstudy.optimize(objective, n_trials=10)\r\nprint('Best value: {} (params: {})\\n'.format(study.best_value, study.best_params))\r\n\r\ntime.sleep(70)\r\nstudy.optimize(objective, n_trials=10)\r\n```\r\n\r\nThe current implementation of `RDBStorage`  reuses scoped sessions and they sometimes prevent reconnection by keeping the transaction implicitly. Therefore, I added `session.commit` to `RDBStorage`'s methods to reconnect connections properly.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/504/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/504/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/481", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/481/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/481/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/481/events", "html_url": "https://github.com/optuna/optuna/pull/481", "id": 478849663, "node_id": "MDExOlB1bGxSZXF1ZXN0MzA1ODc4MTA2", "number": 481, "title": "Prevent TensorFlowPruningHook from reporting None.", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/11", "html_url": "https://github.com/optuna/optuna/milestone/11", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/11/labels", "id": 4538688, "node_id": "MDk6TWlsZXN0b25lNDUzODY4OA==", "number": 11, "title": "v0.15.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 19, "state": "closed", "created_at": "2019-08-01T01:27:59Z", "updated_at": "2019-08-29T01:31:54Z", "due_on": null, "closed_at": "2019-08-29T01:30:55Z"}, "comments": 0, "created_at": "2019-08-09T07:53:52Z", "updated_at": "2019-08-16T04:44:16Z", "closed_at": "2019-08-16T04:44:13Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/481", "html_url": "https://github.com/optuna/optuna/pull/481", "diff_url": "https://github.com/optuna/optuna/pull/481.diff", "patch_url": "https://github.com/optuna/optuna/pull/481.patch", "merged_at": "2019-08-16T04:44:13Z"}, "body": "Current `oputna.integration.TensorFlowPruningHook` reports `None` as an intermediate value when the returned value of `tensorflow_estimator.python.estimator.early_stopping.read_eval_metrics` contains `None`. The intermediate values should be `float`, and some samplers will cause errors when they encounter non-float values (e.g., [TPESampler](https://github.com/pfnet/optuna/blob/master/optuna/samplers/tpe/sampler.py#L523)).\r\n\r\nThis PR converts `None` to `NaN` before reporting it as an intermediate value.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/481/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/481/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/476", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/476/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/476/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/476/events", "html_url": "https://github.com/optuna/optuna/pull/476", "id": 477749894, "node_id": "MDExOlB1bGxSZXF1ZXN0MzA1MDEzMDAy", "number": 476, "title": "Add NaN intermediate value handling to `TPESampler`.", "user": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/11", "html_url": "https://github.com/optuna/optuna/milestone/11", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/11/labels", "id": 4538688, "node_id": "MDk6TWlsZXN0b25lNDUzODY4OA==", "number": 11, "title": "v0.15.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 19, "state": "closed", "created_at": "2019-08-01T01:27:59Z", "updated_at": "2019-08-29T01:31:54Z", "due_on": null, "closed_at": "2019-08-29T01:30:55Z"}, "comments": 0, "created_at": "2019-08-07T07:19:45Z", "updated_at": "2019-08-16T04:50:27Z", "closed_at": "2019-08-16T04:50:25Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/476", "html_url": "https://github.com/optuna/optuna/pull/476", "diff_url": "https://github.com/optuna/optuna/pull/476.diff", "patch_url": "https://github.com/optuna/optuna/pull/476.patch", "merged_at": "2019-08-16T04:50:25Z"}, "body": "By this PR, `TPESampler` becomes to be able to handle trials that contain NaN intermediate values.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/476/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/476/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/449", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/449/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/449/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/449/events", "html_url": "https://github.com/optuna/optuna/pull/449", "id": 466783667, "node_id": "MDExOlB1bGxSZXF1ZXN0Mjk2NTU5Nzcz", "number": 449, "title": "Fix a bug when calling `suggest_categorical` with int and str choices.", "user": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/10", "html_url": "https://github.com/optuna/optuna/milestone/10", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/10/labels", "id": 4464370, "node_id": "MDk6TWlsZXN0b25lNDQ2NDM3MA==", "number": 10, "title": "v0.14.0", "description": "", "creator": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 13, "state": "closed", "created_at": "2019-07-04T01:12:52Z", "updated_at": "2019-08-01T01:27:52Z", "due_on": null, "closed_at": "2019-08-01T01:27:52Z"}, "comments": 0, "created_at": "2019-07-11T09:44:24Z", "updated_at": "2019-08-01T00:53:41Z", "closed_at": "2019-07-16T02:40:50Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/449", "html_url": "https://github.com/optuna/optuna/pull/449", "diff_url": "https://github.com/optuna/optuna/pull/449.diff", "patch_url": "https://github.com/optuna/optuna/pull/449.patch", "merged_at": "2019-07-16T02:40:50Z"}, "body": "Fix #448", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/449/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/449/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/415", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/415/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/415/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/415/events", "html_url": "https://github.com/optuna/optuna/pull/415", "id": 451359409, "node_id": "MDExOlB1bGxSZXF1ZXN0Mjg0NDY0NjE3", "number": 415, "title": "Fix the error that occurs when using a study that contains old trials.", "user": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/8", "html_url": "https://github.com/optuna/optuna/milestone/8", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/8/labels", "id": 4340556, "node_id": "MDk6TWlsZXN0b25lNDM0MDU1Ng==", "number": 8, "title": "v0.12.0", "description": "", "creator": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 11, "state": "closed", "created_at": "2019-05-23T02:09:30Z", "updated_at": "2019-06-06T02:18:25Z", "due_on": null, "closed_at": "2019-06-06T02:18:25Z"}, "comments": 0, "created_at": "2019-06-03T08:40:33Z", "updated_at": "2019-06-10T04:56:29Z", "closed_at": "2019-06-05T02:52:30Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/415", "html_url": "https://github.com/optuna/optuna/pull/415", "diff_url": "https://github.com/optuna/optuna/pull/415.diff", "patch_url": "https://github.com/optuna/optuna/pull/415.patch", "merged_at": "2019-06-05T02:52:30Z"}, "body": "This PR fixes the problem that the up-to-date optuna cannot handle studies that contain the trials created before v0.9.0.\r\n\r\n## How to reproduce this problem and confirm that this PR fixes it\r\n\r\n```console\r\n//\r\n// (1) Install Optuna before v0.9.0\r\n//\r\n$ pip install optuna==0.8.0\r\n\r\n//\r\n// (2) Create a study and executes it\r\n//\r\n$ optuna create-study --study foo --storage sqlite:///example.db\r\n[I 2019-06-03 17:16:18,417] A new study created with name: foo\r\n\r\n$ optuna study optimize examples/quadratic_simple.py objective --n-trials=1 --study foo --storage sqlite:///example.db\r\n[I 2019-06-03 17:17:14,429] Finished a trial resulted in value: 2926.8920645504154. Current best value is 2926.8920645504154 with parameters: {'y': -1, 'x': 54.10999967243038}.\r\n\r\n//\r\n// (3) Upgrade Optuna to the latest version\r\n//\r\n$ pip install optuna==0.11.0\r\n\r\n//\r\n// (4) Continue optimization from the existing study\r\n//      => Failed!\r\n$ optuna study optimize examples/quadratic_simple.py objective --n-trials=1 --study foo --storage sqlite:///example.db 2>&1 | head\r\n[W 2019-06-03 17:20:06,661] Setting status of trial#1 as TrialState.FAIL because of the following error: RecursionError('maximum recursion depth exceeded while calling a Python object',)\r\nTraceback (most recent call last):\r\n  File \"/home/ohta/.local/lib/python3.5/site-packages/optuna/study.py\", line 399, in _run_trial\r\n    result = func(trial)\r\n  File \"examples/quadratic_simple.py\", line 25, in objective\r\n    x = trial.suggest_uniform('x', -100, 100)\r\n  File \"/home/ohta/.local/lib/python3.5/site-packages/optuna/trial.py\", line 165, in suggest_uniform\r\n    return self._suggest(name, distribution)\r\n  File \"/home/ohta/.local/lib/python3.5/site-packages/optuna/trial.py\", line 436, in _suggest\r\n    distribution)\r\n\r\n//\r\n// (5) Re-install the patched version of Optuna\r\n//\r\n$ pip install -U git+http://github.com/pfnet/optuna.git@support-old-trials\r\n\r\n//\r\n// (6) Continue optimization from the existing study\r\n//      => Succeeded!\r\n$ optuna study optimize examples/quadratic_simple.py objective --n-trials=1 --study foo --storage sqlite:///example.db\r\n[I 2019-06-03 17:23:44,630] Finished trial#2 resulted in value: 1.476264522273886. Current best value is 1.476264522273886 with parameters: {'y': 1, 'x': -0.6901192087414216}.\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/415/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/415/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/413", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/413/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/413/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/413/events", "html_url": "https://github.com/optuna/optuna/pull/413", "id": 451297483, "node_id": "MDExOlB1bGxSZXF1ZXN0Mjg0NDE2ODg5", "number": 413, "title": "Synchronize when _ChainerMNTrial sets values.", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/8", "html_url": "https://github.com/optuna/optuna/milestone/8", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/8/labels", "id": 4340556, "node_id": "MDk6TWlsZXN0b25lNDM0MDU1Ng==", "number": 8, "title": "v0.12.0", "description": "", "creator": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 11, "state": "closed", "created_at": "2019-05-23T02:09:30Z", "updated_at": "2019-06-06T02:18:25Z", "due_on": null, "closed_at": "2019-06-06T02:18:25Z"}, "comments": 0, "created_at": "2019-06-03T05:22:54Z", "updated_at": "2019-06-06T01:53:16Z", "closed_at": "2019-06-03T09:17:12Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/413", "html_url": "https://github.com/optuna/optuna/pull/413", "diff_url": "https://github.com/optuna/optuna/pull/413.diff", "patch_url": "https://github.com/optuna/optuna/pull/413.patch", "merged_at": "2019-06-03T09:17:12Z"}, "body": "This PR fixes the timing issues that occur when users combine ChainerMN integration with pruning.\r\nThe cause of the issues is the rank-1 node sometimes accesses the intermediate values before the rank-0 node set the values. This PR adds synchronization after setting the values.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/413/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/413/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/402", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/402/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/402/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/402/events", "html_url": "https://github.com/optuna/optuna/pull/402", "id": 448067970, "node_id": "MDExOlB1bGxSZXF1ZXN0MjgxOTM2NzAy", "number": 402, "title": "Fix a bug that `FixedTrial` cannot handle categorical parameters correctly.", "user": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/8", "html_url": "https://github.com/optuna/optuna/milestone/8", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/8/labels", "id": 4340556, "node_id": "MDk6TWlsZXN0b25lNDM0MDU1Ng==", "number": 8, "title": "v0.12.0", "description": "", "creator": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 11, "state": "closed", "created_at": "2019-05-23T02:09:30Z", "updated_at": "2019-06-06T02:18:25Z", "due_on": null, "closed_at": "2019-06-06T02:18:25Z"}, "comments": 0, "created_at": "2019-05-24T09:26:21Z", "updated_at": "2019-05-27T04:41:59Z", "closed_at": "2019-05-27T04:41:52Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/402", "html_url": "https://github.com/optuna/optuna/pull/402", "diff_url": "https://github.com/optuna/optuna/pull/402.diff", "patch_url": "https://github.com/optuna/optuna/pull/402.patch", "merged_at": "2019-05-27T04:41:52Z"}, "body": "This PR fixes #401.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/402/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/402/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/396", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/396/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/396/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/396/events", "html_url": "https://github.com/optuna/optuna/pull/396", "id": 446447402, "node_id": "MDExOlB1bGxSZXF1ZXN0MjgwNjQ2Mzk4", "number": 396, "title": "Fix installation failure with Python-3.5.2.", "user": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/7", "html_url": "https://github.com/optuna/optuna/milestone/7", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/7/labels", "id": 4247519, "node_id": "MDk6TWlsZXN0b25lNDI0NzUxOQ==", "number": 7, "title": "v0.11.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 9, "state": "closed", "created_at": "2019-04-22T06:01:20Z", "updated_at": "2019-05-23T02:09:23Z", "due_on": null, "closed_at": "2019-05-23T02:09:23Z"}, "comments": 0, "created_at": "2019-05-21T06:57:20Z", "updated_at": "2019-05-23T01:15:40Z", "closed_at": "2019-05-23T01:15:37Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/396", "html_url": "https://github.com/optuna/optuna/pull/396", "diff_url": "https://github.com/optuna/optuna/pull/396.diff", "patch_url": "https://github.com/optuna/optuna/pull/396.patch", "merged_at": "2019-05-23T01:15:37Z"}, "body": "This PR fixes a problem that it fails to install the latest Optuna in Python-3.5.2 environment.\r\n\r\n### Cause and Solution\r\n\r\n[setup.py@v0.10.0](https://github.com/pfnet/optuna/blob/v0.10.0/setup.py#L88) uses wildcard string \"*\" as follows:\r\n```python\r\n    package_data={\r\n        'optuna':\r\n        ['storages/rdb/alembic.ini', 'storages/rdb/alembic/*', 'storages/rdb/alembic/versions/*']\r\n    }\r\n```\r\nPython-3.5.2 cannot handle this properly, so an installation error occurs (see next section).\r\nThis PR solves this problem by replacing the wildcard string with \"*.*\".\r\n\r\n### How to Reproduce the Problem\r\n\r\nPlease execute the following command (it fails):\r\n```console\r\n$ docker run --rm -it python:3.5.2 pip install optuna\r\n...\r\n    creating build/lib/optuna/storages/rdb/alembic\r\n    error: can't copy 'optuna/storages/rdb/alembic/versions': doesn't exist or not a regular file\r\n\r\n    ----------------------------------------\r\nCommand \"/usr/local/bin/python3.5 -u -c \"import setuptools, tokenize;__file__='/tmp/pip-build-dmsje_c6/optuna/setup.py';f=getattr(tokenize, 'open', open)(__file__);code=f.read().replace('\\r\\n', '\\n');f.close();exec(compile(code, __file__, 'exec'))\" install --reco\r\nrd /tmp/pip-3_d0obq6-record/install-record.txt --single-version-externally-managed --compile\" failed with error code 1 in /tmp/pip-build-dmsje_c6/optuna/\r\n```\r\n\r\nBy referring to this PR branch, the installation will success:\r\n```console\r\n$ docker run --rm -it python:3.5.2 pip install git+https://github.com/pfnet/optuna.git@fix-install-error-on-python3.5.2\r\n...\r\n  Running setup.py install for optuna ... done\r\nSuccessfully installed Mako-1.0.10 MarkupSafe-1.1.1 PrettyTable-0.7.2 PyYAML-5.1 alembic-1.0.10 attrs-19.1.0 cliff-2.14.1 cmd2-0.9.12 colorama-0.4.1 colorlog-4.0.2 numpy-1.16.3 optuna-0.10.0 pandas-0.24.2 pbr-5.2.0 pyparsing-2.4.0 pyperclip-1.7.0 python-dateutil-2.8.0 python-editor-1.0.4 pytz-2019.1 scipy-1.3.0 six-1.12.0 sqlalchemy-1.3.3 stevedore-1.30.1 typing-3.6.6 wcwidth-0.1.7\r\n```\r\n\r\nAnd this branch also works with other Python versions:\r\n```console\r\n$ docker run --rm -it python:2.7   pip install git+https://github.com/pfnet/optuna.git@fix-install-error-on-python3.5.2\r\n$ docker run --rm -it python:3.5.3 pip install git+https://github.com/pfnet/optuna.git@fix-install-error-on-python3.5.2\r\n$ docker run --rm -it python:3.6   pip install git+https://github.com/pfnet/optuna.git@fix-install-error-on-python3.5.2\r\n$ docker run --rm -it python:3.7   pip install git+https://github.com/pfnet/optuna.git@fix-install-error-on-python3.5.2\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/396/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/396/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/395", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/395/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/395/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/395/events", "html_url": "https://github.com/optuna/optuna/pull/395", "id": 444866604, "node_id": "MDExOlB1bGxSZXF1ZXN0Mjc5NDM0NjM0", "number": 395, "title": "Escape '%' character in storage URL.", "user": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/7", "html_url": "https://github.com/optuna/optuna/milestone/7", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/7/labels", "id": 4247519, "node_id": "MDk6TWlsZXN0b25lNDI0NzUxOQ==", "number": 7, "title": "v0.11.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 9, "state": "closed", "created_at": "2019-04-22T06:01:20Z", "updated_at": "2019-05-23T02:09:23Z", "due_on": null, "closed_at": "2019-05-23T02:09:23Z"}, "comments": 1, "created_at": "2019-05-16T10:04:45Z", "updated_at": "2019-05-23T01:22:02Z", "closed_at": "2019-05-23T01:17:21Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/395", "html_url": "https://github.com/optuna/optuna/pull/395", "diff_url": "https://github.com/optuna/optuna/pull/395.diff", "patch_url": "https://github.com/optuna/optuna/pull/395.patch", "merged_at": "2019-05-23T01:17:21Z"}, "body": "This PR fixes the problem that an error occurs when a storage URL that contains \"%\" is specified.\r\n\r\nThe following is an example of this problem:\r\n```python\r\n>>> import optuna\r\n>>> optuna.create_study(study_name='foo', storage='sqlite:///bar%baz.db')\r\nValueError: invalid interpolation syntax in 'sqlite:///bar%baz.db' at position 13\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/395/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/395/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/393", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/393/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/393/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/393/events", "html_url": "https://github.com/optuna/optuna/pull/393", "id": 441033193, "node_id": "MDExOlB1bGxSZXF1ZXN0Mjc2NDQzMDA2", "number": 393, "title": "Fix type of suggest APIs.", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/7", "html_url": "https://github.com/optuna/optuna/milestone/7", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/7/labels", "id": 4247519, "node_id": "MDk6TWlsZXN0b25lNDI0NzUxOQ==", "number": 7, "title": "v0.11.0", "description": "", "creator": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 9, "state": "closed", "created_at": "2019-04-22T06:01:20Z", "updated_at": "2019-05-23T02:09:23Z", "due_on": null, "closed_at": "2019-05-23T02:09:23Z"}, "comments": 0, "created_at": "2019-05-07T05:24:40Z", "updated_at": "2019-05-23T01:21:59Z", "closed_at": "2019-05-07T06:50:06Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/393", "html_url": "https://github.com/optuna/optuna/pull/393", "diff_url": "https://github.com/optuna/optuna/pull/393.diff", "patch_url": "https://github.com/optuna/optuna/pull/393.patch", "merged_at": "2019-05-07T06:50:06Z"}, "body": "This PR fixes the type of following suggest APIs:\r\n- `TPESampler.suggest_uniform`,\r\n- `TPESampler.suggest_loguniform`,\r\n- `TPESampler.suggest_discrete_uniform`,\r\n- `RandomSampler.suggest_loguniform`, and\r\n- `RandomSampler.suggest_discrete_uniform`.\r\n\r\nThe expected type is `float`, but the actual type is `numpy.float64`.\r\nThis mismatch causes errors when users use MySQL as reported in https://github.com/pfnet/optuna/issues/392.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/393/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/393/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/373", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/373/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/373/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/373/events", "html_url": "https://github.com/optuna/optuna/pull/373", "id": 429086494, "node_id": "MDExOlB1bGxSZXF1ZXN0MjY3Mjk3NDY0", "number": 373, "title": "Fix minor problems of `TPESampler` and `ParzenEstimator`.", "user": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/6", "html_url": "https://github.com/optuna/optuna/milestone/6", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/6/labels", "id": 4153438, "node_id": "MDk6TWlsZXN0b25lNDE1MzQzOA==", "number": 6, "title": "v0.10.0", "description": "", "creator": {"login": "g-votte", "id": 1061922, "node_id": "MDQ6VXNlcjEwNjE5MjI=", "avatar_url": "https://avatars.githubusercontent.com/u/1061922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/g-votte", "html_url": "https://github.com/g-votte", "followers_url": "https://api.github.com/users/g-votte/followers", "following_url": "https://api.github.com/users/g-votte/following{/other_user}", "gists_url": "https://api.github.com/users/g-votte/gists{/gist_id}", "starred_url": "https://api.github.com/users/g-votte/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/g-votte/subscriptions", "organizations_url": "https://api.github.com/users/g-votte/orgs", "repos_url": "https://api.github.com/users/g-votte/repos", "events_url": "https://api.github.com/users/g-votte/events{/privacy}", "received_events_url": "https://api.github.com/users/g-votte/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 16, "state": "closed", "created_at": "2019-03-19T08:20:01Z", "updated_at": "2019-04-22T06:01:49Z", "due_on": null, "closed_at": "2019-04-22T06:01:49Z"}, "comments": 0, "created_at": "2019-04-04T05:13:32Z", "updated_at": "2019-04-17T08:49:11Z", "closed_at": "2019-04-17T08:49:06Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/373", "html_url": "https://github.com/optuna/optuna/pull/373", "diff_url": "https://github.com/optuna/optuna/pull/373.diff", "patch_url": "https://github.com/optuna/optuna/pull/373.patch", "merged_at": "2019-04-17T08:49:06Z"}, "body": "This PR fixes minor problems of `TPESampler` and `ParzenEstimator`.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/373/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/373/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/361", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/361/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/361/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/361/events", "html_url": "https://github.com/optuna/optuna/pull/361", "id": 425790101, "node_id": "MDExOlB1bGxSZXF1ZXN0MjY0Nzk3OTQx", "number": 361, "title": "Fix an issue in parallel execution where inconsistent `FronzenTrial` could be created with low probability.", "user": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/6", "html_url": "https://github.com/optuna/optuna/milestone/6", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/6/labels", "id": 4153438, "node_id": "MDk6TWlsZXN0b25lNDE1MzQzOA==", "number": 6, "title": "v0.10.0", "description": "", "creator": {"login": "g-votte", "id": 1061922, "node_id": "MDQ6VXNlcjEwNjE5MjI=", "avatar_url": "https://avatars.githubusercontent.com/u/1061922?v=4", "gravatar_id": "", "url": "https://api.github.com/users/g-votte", "html_url": "https://github.com/g-votte", "followers_url": "https://api.github.com/users/g-votte/followers", "following_url": "https://api.github.com/users/g-votte/following{/other_user}", "gists_url": "https://api.github.com/users/g-votte/gists{/gist_id}", "starred_url": "https://api.github.com/users/g-votte/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/g-votte/subscriptions", "organizations_url": "https://api.github.com/users/g-votte/orgs", "repos_url": "https://api.github.com/users/g-votte/repos", "events_url": "https://api.github.com/users/g-votte/events{/privacy}", "received_events_url": "https://api.github.com/users/g-votte/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 16, "state": "closed", "created_at": "2019-03-19T08:20:01Z", "updated_at": "2019-04-22T06:01:49Z", "due_on": null, "closed_at": "2019-04-22T06:01:49Z"}, "comments": 1, "created_at": "2019-03-27T06:43:56Z", "updated_at": "2019-04-22T05:08:22Z", "closed_at": "2019-03-27T10:07:56Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/361", "html_url": "https://github.com/optuna/optuna/pull/361", "diff_url": "https://github.com/optuna/optuna/pull/361.diff", "patch_url": "https://github.com/optuna/optuna/pull/361.patch", "merged_at": "2019-03-27T10:07:56Z"}, "body": "This PR resolves the problem reported by https://github.com/pfnet/optuna/pull/349#issuecomment-475086642.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/361/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/361/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/326", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/326/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/326/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/326/events", "html_url": "https://github.com/optuna/optuna/pull/326", "id": 415405580, "node_id": "MDExOlB1bGxSZXF1ZXN0MjU2OTAxNDE3", "number": 326, "title": "Fix import errors in Python3.5.0 and Python3.5.1", "user": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/5", "html_url": "https://github.com/optuna/optuna/milestone/5", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/5/labels", "id": 4087143, "node_id": "MDk6TWlsZXN0b25lNDA4NzE0Mw==", "number": 5, "title": "v0.9.0", "description": "", "creator": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 19, "state": "closed", "created_at": "2019-02-26T01:13:16Z", "updated_at": "2019-03-19T08:19:47Z", "due_on": null, "closed_at": "2019-03-19T08:19:47Z"}, "comments": 1, "created_at": "2019-02-28T01:34:01Z", "updated_at": "2019-03-05T08:54:34Z", "closed_at": "2019-03-05T08:54:30Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/326", "html_url": "https://github.com/optuna/optuna/pull/326", "diff_url": "https://github.com/optuna/optuna/pull/326.diff", "patch_url": "https://github.com/optuna/optuna/pull/326.patch", "merged_at": "2019-03-05T08:54:30Z"}, "body": "`typing` module of Python3.5.0 and Python3.5.1 has not defined some classes that are provided in other Python versions (e.g., `typing.Type` class).\r\nBecause of this, in Python3.5.1 (or 3.5.0), `import optuna` fails as follows\r\n```console\r\n$ docker run --rm -it python:3.5.1 /bin/bash\r\n# git clone -b master git://github.com/pfnet/optuna\r\n# cd optuna\r\n\r\n$ pip install --upgrade pip\r\n# pip install .\r\n# python -c 'import optuna; print(\"OK\")'\r\nTraceback (most recent call last):\r\n  File \"<string>\", line 1, in <module>\r\n  File \"/optuna/optuna/__init__.py\", line 2, in <module>\r\n    from optuna import dashboard  # NOQA\r\n  File \"/optuna/optuna/dashboard.py\", line 26, in <module>\r\n    import optuna.study\r\n  File \"/optuna/optuna/study.py\", line 17, in <module>\r\n    from typing import Type  # NOQA\r\nImportError: cannot import name 'Type'\r\n```\r\n\r\nHowever, these missing classes are only needed for type checking by `mypy` and unnecessary for ordinal program executions.\r\nIn this PR, I changed to import those classes only when `optuna.types.TYPE_CHECKING` flag is set.\r\nBy this modification, `import optuna` became to work well in Python3.5.0 and Python3.5.1.\r\n```console\r\n$ docker run --rm -it python:3.5.1 /bin/bash\r\n# git clone -b fix-import-typing-error git://github.com/pfnet/optuna\r\n# cd optuna\r\n\r\n# pip install --upgrade pip\r\n# pip install .\r\n# python -c 'import optuna; print(\"OK\")'\r\nOK\r\n```", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/326/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/326/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/321", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/321/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/321/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/321/events", "html_url": "https://github.com/optuna/optuna/pull/321", "id": 411861349, "node_id": "MDExOlB1bGxSZXF1ZXN0MjU0MjA0MTIy", "number": 321, "title": "Fix the range of return values of Trial.suggest_discrete_uniform().", "user": {"login": "toshihikoyanase", "id": 3255979, "node_id": "MDQ6VXNlcjMyNTU5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3255979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/toshihikoyanase", "html_url": "https://github.com/toshihikoyanase", "followers_url": "https://api.github.com/users/toshihikoyanase/followers", "following_url": "https://api.github.com/users/toshihikoyanase/following{/other_user}", "gists_url": "https://api.github.com/users/toshihikoyanase/gists{/gist_id}", "starred_url": "https://api.github.com/users/toshihikoyanase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/toshihikoyanase/subscriptions", "organizations_url": "https://api.github.com/users/toshihikoyanase/orgs", "repos_url": "https://api.github.com/users/toshihikoyanase/repos", "events_url": "https://api.github.com/users/toshihikoyanase/events{/privacy}", "received_events_url": "https://api.github.com/users/toshihikoyanase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/5", "html_url": "https://github.com/optuna/optuna/milestone/5", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/5/labels", "id": 4087143, "node_id": "MDk6TWlsZXN0b25lNDA4NzE0Mw==", "number": 5, "title": "v0.9.0", "description": "", "creator": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 19, "state": "closed", "created_at": "2019-02-26T01:13:16Z", "updated_at": "2019-03-19T08:19:47Z", "due_on": null, "closed_at": "2019-03-19T08:19:47Z"}, "comments": 0, "created_at": "2019-02-19T10:50:20Z", "updated_at": "2019-03-05T07:01:21Z", "closed_at": "2019-03-05T06:57:03Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/321", "html_url": "https://github.com/optuna/optuna/pull/321", "diff_url": "https://github.com/optuna/optuna/pull/321.diff", "patch_url": "https://github.com/optuna/optuna/pull/321.patch", "merged_at": "2019-03-05T06:57:03Z"}, "body": "`Trial.suggest_discrete_uniform()` sometimes suggests smaller values than `low` or larger values than `high`. For example `trial.suggest_discrete_uniform('x', 64, 1312, 160)` will return `0`.\r\n\r\nThis is caused by the following three problems:\r\n- Wrong range setting in TPESampler,\r\n- Test cases skipping TPESampler due to its startup period,\r\n- Definition of returned values of `trial.suggest_discrete_uniform`.\r\n\r\n1.  Wrong range setting in TPESampler.\r\n\r\nThis issue may be caused when we refactored the TPESampler at v0.4.0.\r\n\r\nbefore\r\nhttps://github.com/pfnet/optuna/blob/v0.3.0/optuna/samplers/tpe.py#L109\r\n\r\nafter\r\nhttps://github.com/pfnet/optuna/blob/v0.4.0/optuna/samplers/tpe/sampler.py#L154\r\n\r\nThis PR fixes the issue by reverting the range of `TPESampler._sample_discrete_uniform` to v0.3.0.\r\n\r\n2. Test cases skipping TPESampler due to its startup period.\r\n\r\nTPESampler delegates parameter suggestions to RandomSampler until the number of observations exceeds `n_startup_trials`. Current test cases do not store any observations, and TPESampler does not suggest any parameters.  In this PR, I added the `study.optmize` to store observations to activate TPESampler.\r\n\r\n3. Definition of returned values of `trial.suggest_discrete_uniform`.\r\n\r\nCurrently, optuna tries to return multiples of `q` in `[low, high]` with `low` and `high` as boundary values.\r\nIn this PR, I'd like to change this definition according to the convention of `range` function in Python as follows:\r\nthe returned value would be `low + q * k <= high (k = 0, 1, 2, ...)`. With this change, we can ensure that the returned values are arranged in an equal interval while the current ones are not if `low % q != 0` or `high % q != 0`.\r\n\r\nFor example, `trial.suggest_discrete_uniform('x', 64, 1312, 160)` will return following values:\r\n```\r\nCurrent (w/o the bug reported in 1)\r\n64, 160, 320, ..., 1280, 1312\r\n\r\nThis PR: \r\n64, 224, 384, ..., 1024, 1284\r\n```\r\n\r\nNote that `high` may be excluded from ranges due to round-off errors if `q` is not an integer.\r\nPlease refer to the following test case:\r\nhttps://github.com/pfnet/optuna/pull/321/files#diff-1b9dd0f25ba98f584018a94420395c5cR81", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/321/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/321/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/optuna/optuna/issues/278", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/278/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/278/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/278/events", "html_url": "https://github.com/optuna/optuna/issues/278", "id": 392076842, "node_id": "MDU6SXNzdWUzOTIwNzY4NDI=", "number": 278, "title": "The number of threads increases each time dashboard page is reloaded.", "user": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}, {"id": 1832188112, "node_id": "MDU6TGFiZWwxODMyMTg4MTEy", "url": "https://api.github.com/repos/optuna/optuna/labels/contribution-welcome", "name": "contribution-welcome", "color": "c2e0c6", "default": false, "description": "Issue that welcomes contribution."}, {"id": 2107128673, "node_id": "MDU6TGFiZWwyMTA3MTI4Njcz", "url": "https://api.github.com/repos/optuna/optuna/labels/no-stale", "name": "no-stale", "color": "BBBBBB", "default": false, "description": "Exempt from stale bot"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-12-18T09:56:07Z", "updated_at": "2020-08-23T03:28:15Z", "closed_at": "2020-08-23T03:28:15Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "When a dashboard page is loaded, a new thread is spawned for rendering the page (https://github.com/pfnet/optuna/blob/v0.5.0/optuna/dashboard.py#L208). However, this thread never dies even after the page is closed (maybe). Thus, each time a user reloads the dashboard page, the number of threads increases.\r\nA thread will issue a query each second. So, this may overload the backend storage.", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/278/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/278/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/optuna/optuna/issues/261", "repository_url": "https://api.github.com/repos/optuna/optuna", "labels_url": "https://api.github.com/repos/optuna/optuna/issues/261/labels{/name}", "comments_url": "https://api.github.com/repos/optuna/optuna/issues/261/comments", "events_url": "https://api.github.com/repos/optuna/optuna/issues/261/events", "html_url": "https://github.com/optuna/optuna/pull/261", "id": 388666566, "node_id": "MDExOlB1bGxSZXF1ZXN0MjM2ODc3MDky", "number": 261, "title": "Making samplers/tpe/parzen_estimator.py Adaptive (bug fix)", "user": {"login": "HideakiImamura", "id": 38826298, "node_id": "MDQ6VXNlcjM4ODI2Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/38826298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HideakiImamura", "html_url": "https://github.com/HideakiImamura", "followers_url": "https://api.github.com/users/HideakiImamura/followers", "following_url": "https://api.github.com/users/HideakiImamura/following{/other_user}", "gists_url": "https://api.github.com/users/HideakiImamura/gists{/gist_id}", "starred_url": "https://api.github.com/users/HideakiImamura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HideakiImamura/subscriptions", "organizations_url": "https://api.github.com/users/HideakiImamura/orgs", "repos_url": "https://api.github.com/users/HideakiImamura/repos", "events_url": "https://api.github.com/users/HideakiImamura/events{/privacy}", "received_events_url": "https://api.github.com/users/HideakiImamura/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 843541471, "node_id": "MDU6TGFiZWw4NDM1NDE0NzE=", "url": "https://api.github.com/repos/optuna/optuna/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Issue/PR about behavior that is broken. Not for typos/examples/CI/test but for Optuna itself."}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/optuna/optuna/milestones/1", "html_url": "https://github.com/optuna/optuna/milestone/1", "labels_url": "https://api.github.com/repos/optuna/optuna/milestones/1/labels", "id": 3888676, "node_id": "MDk6TWlsZXN0b25lMzg4ODY3Ng==", "number": 1, "title": "v0.5.0", "description": "", "creator": {"login": "sile", "id": 181413, "node_id": "MDQ6VXNlcjE4MTQxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/181413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sile", "html_url": "https://github.com/sile", "followers_url": "https://api.github.com/users/sile/followers", "following_url": "https://api.github.com/users/sile/following{/other_user}", "gists_url": "https://api.github.com/users/sile/gists{/gist_id}", "starred_url": "https://api.github.com/users/sile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sile/subscriptions", "organizations_url": "https://api.github.com/users/sile/orgs", "repos_url": "https://api.github.com/users/sile/repos", "events_url": "https://api.github.com/users/sile/events{/privacy}", "received_events_url": "https://api.github.com/users/sile/received_events", "type": "User", "site_admin": false}, "open_issues": 0, "closed_issues": 18, "state": "closed", "created_at": "2018-12-11T07:16:05Z", "updated_at": "2018-12-14T02:13:08Z", "due_on": "2018-12-13T08:00:00Z", "closed_at": "2018-12-14T02:13:08Z"}, "comments": 0, "created_at": "2018-12-07T14:00:59Z", "updated_at": "2018-12-11T07:33:45Z", "closed_at": "2018-12-07T15:06:12Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/optuna/optuna/pulls/261", "html_url": "https://github.com/optuna/optuna/pull/261", "diff_url": "https://github.com/optuna/optuna/pull/261.diff", "patch_url": "https://github.com/optuna/optuna/pull/261.patch", "merged_at": "2018-12-07T15:06:12Z"}, "body": "Existing Optuna implementation of an adaptive parzen estimator is not \"adaptive\", because all covariance (=bandwidths) of kernels are equivalent to \"maxsigma = high - low\".\r\nThanks to this bug fix, we can consider \"adaptive\" parzen estimator. and then, strong anytime performance will be ensured.\r\nSome benchmark tests (blackbox optimization bench and pruning bench) prove that. ", "reactions": {"url": "https://api.github.com/repos/optuna/optuna/issues/261/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/optuna/optuna/issues/261/timeline", "performed_via_github_app": null, "state_reason": null}]