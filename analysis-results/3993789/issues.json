[{"url": "https://api.github.com/repos/secdev/scapy/issues/3979", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3979/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3979/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3979/events", "html_url": "https://github.com/secdev/scapy/pull/3979", "id": 1659938400, "node_id": "PR_kwDOApfmNs5N5Cag", "number": 3979, "title": "Fix get_if_list on windows", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1265179855, "node_id": "MDU6TGFiZWwxMjY1MTc5ODU1", "url": "https://api.github.com/repos/secdev/scapy/labels/platform-specific", "name": "platform-specific", "color": "14acba", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-04-09T16:59:33Z", "updated_at": "2023-04-17T17:49:55Z", "closed_at": "2023-04-17T17:49:52Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3979", "html_url": "https://github.com/secdev/scapy/pull/3979", "diff_url": "https://github.com/secdev/scapy/pull/3979.diff", "patch_url": "https://github.com/secdev/scapy/pull/3979.patch", "merged_at": "2023-04-17T17:49:52Z"}, "body": "fix https://github.com/secdev/scapy/issues/3891", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3979/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3979/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3975", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3975/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3975/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3975/events", "html_url": "https://github.com/secdev/scapy/pull/3975", "id": 1659604586, "node_id": "PR_kwDOApfmNs5N4G9N", "number": 3975, "title": "Fix FFDHE size computation", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-04-08T18:22:48Z", "updated_at": "2023-04-17T17:50:54Z", "closed_at": "2023-04-17T17:50:51Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3975", "html_url": "https://github.com/secdev/scapy/pull/3975", "diff_url": "https://github.com/secdev/scapy/pull/3975.diff", "patch_url": "https://github.com/secdev/scapy/pull/3975.patch", "merged_at": "2023-04-17T17:50:51Z"}, "body": "Fix a stupid mistake in ffdhe size computation on generation", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3975/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3975/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3957", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3957/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3957/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3957/events", "html_url": "https://github.com/secdev/scapy/issues/3957", "id": 1641048124, "node_id": "I_kwDOApfmNs5h0Gg8", "number": 3957, "title": "eapol_key fields appear reversed", "user": {"login": "lts-rad", "id": 37549748, "node_id": "MDQ6VXNlcjM3NTQ5NzQ4", "avatar_url": "https://avatars.githubusercontent.com/u/37549748?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lts-rad", "html_url": "https://github.com/lts-rad", "followers_url": "https://api.github.com/users/lts-rad/followers", "following_url": "https://api.github.com/users/lts-rad/following{/other_user}", "gists_url": "https://api.github.com/users/lts-rad/gists{/gist_id}", "starred_url": "https://api.github.com/users/lts-rad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lts-rad/subscriptions", "organizations_url": "https://api.github.com/users/lts-rad/orgs", "repos_url": "https://api.github.com/users/lts-rad/repos", "events_url": "https://api.github.com/users/lts-rad/events{/privacy}", "received_events_url": "https://api.github.com/users/lts-rad/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2023-03-26T19:23:27Z", "updated_at": "2023-04-08T19:21:58Z", "closed_at": "2023-04-08T19:21:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "https://github.com/secdev/scapy/blob/358f5465ddbf6149bcfe9cad8fef2f4b925dd173/scapy/layers/eap.py#L439\r\n\r\nWhen trying to use this structure I found that the bitfields were out of order for me for decoding data off the wire. The following worked. im also not sure if key_mic is conditional or not, but the below code is what worked for me. \r\n\r\ni'm not suggesting to take this code directly but mainly that EAPOL_KEY needs fixing.\r\n\r\n```python\r\nclass EAPOL_KEY(Packet):\r\n    name = \"EAPOL_KEY\"\r\n    fields_desc = [\r\n        ByteEnumField(\"key_descriptor_type\", 1, {1: \"RC4\", 2: \"RSN\"}),\r\n        # Key Information\r\n        BitField(\"reserved2\", 0, 2),\r\n        BitField(\"smk_message\", 0, 1),\r\n        BitField(\"encrypted_key_data\", 0, 1),\r\n        BitField(\"request\", 0, 1),\r\n        BitField(\"error\", 0, 1),\r\n        BitField(\"secure\", 0, 1),\r\n        BitField(\"has_key_mic\", 1, 1),\r\n        BitField(\"key_ack\", 0, 1),\r\n        BitField(\"install\", 0, 1),\r\n        BitField(\"key_index\", 0, 2),\r\n        BitEnumField(\"key_type\", 0, 1, {0: \"Group/SMK\", 1: \"Pairwise\"}),\r\n        BitEnumField(\"key_descriptor_type_version\", 0, 3, {\r\n            1: \"HMAC-MD5+ARC4\",\r\n            2: \"HMAC-SHA1-128+AES-128\",\r\n            3: \"AES-128-CMAC+AES-128\",\r\n        }),\r\n        #\r\n        LenField(\"len\", None, \"H\"),\r\n        LongField(\"key_replay_counter\", 0),\r\n        XStrFixedLenField(\"key_nonce\", b\"\\x00\"*32, 32),\r\n        XStrFixedLenField(\"key_iv\", b\"\\x00\"*16, 16),\r\n        XStrFixedLenField(\"key_rsc\", b\"\\x00\"*8, 8),\r\n        XStrFixedLenField(\"key_id\", b\"\\x00\"*8, 8),\r\n        XStrFixedLenField(\"key_mic\", b\"\\x00\"*16, 16),  # XXX size can be 24\r\n        LenField(\"key_length\", None, \"H\"),\r\n        ConditionalField(\r\n          XStrLenField(\"key\", b\"\\x00\"*16,\r\n                     length_from=lambda pkt: pkt.key_length),\r\n          lambda pkt: pkt.key_length and pkt.key_length > 0)\r\n    ]\r\n    ```", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3957/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3957/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3923", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3923/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3923/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3923/events", "html_url": "https://github.com/secdev/scapy/pull/3923", "id": 1609908158, "node_id": "PR_kwDOApfmNs5LSqGE", "number": 3923, "title": "Fix nested ListFields", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2023-03-04T18:59:07Z", "updated_at": "2023-03-31T08:58:43Z", "closed_at": "2023-03-31T08:58:43Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3923", "html_url": "https://github.com/secdev/scapy/pull/3923", "diff_url": "https://github.com/secdev/scapy/pull/3923.diff", "patch_url": "https://github.com/secdev/scapy/pull/3923.patch", "merged_at": "2023-03-31T08:58:43Z"}, "body": "In my opinion, a (much) better fix for https://github.com/secdev/scapy/issues/3894\r\n\r\nfixes https://github.com/secdev/scapy/issues/3894\r\ncloses https://github.com/secdev/scapy/pull/3919", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3923/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3923/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3831", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3831/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3831/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3831/events", "html_url": "https://github.com/secdev/scapy/issues/3831", "id": 1513967625, "node_id": "I_kwDOApfmNs5aPVAJ", "number": 3831, "title": "NetflowV9 Options Templates length field is not compliant with RFC 3954", "user": {"login": "theplatypus", "id": 10732775, "node_id": "MDQ6VXNlcjEwNzMyNzc1", "avatar_url": "https://avatars.githubusercontent.com/u/10732775?v=4", "gravatar_id": "", "url": "https://api.github.com/users/theplatypus", "html_url": "https://github.com/theplatypus", "followers_url": "https://api.github.com/users/theplatypus/followers", "following_url": "https://api.github.com/users/theplatypus/following{/other_user}", "gists_url": "https://api.github.com/users/theplatypus/gists{/gist_id}", "starred_url": "https://api.github.com/users/theplatypus/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/theplatypus/subscriptions", "organizations_url": "https://api.github.com/users/theplatypus/orgs", "repos_url": "https://api.github.com/users/theplatypus/repos", "events_url": "https://api.github.com/users/theplatypus/events{/privacy}", "received_events_url": "https://api.github.com/users/theplatypus/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-12-29T18:42:50Z", "updated_at": "2023-01-17T14:49:02Z", "closed_at": "2023-01-17T14:49:02Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Brief description\n\nIn the current scapy implementation of Netflow protocol, it seems like the Options-Templates Flowset `scapy.layers.netflow.NetflowOptionsFlowsetV9` length field does not include the padding length.\r\n\r\nHowever,  [Section 6.1 of RFC 3954 (NetflowV9)](https://www.ietf.org/rfc/rfc3954.txt), states that \r\n\r\n>    Padding\r\n         The Exporter SHOULD insert some padding bytes so that the\r\n         subsequent FlowSet starts at a 4-byte aligned boundary.  It is\r\n         important to note that the  **Length field includes the padding\r\n         bytes**.  Padding SHOULD be using zeros.\r\n\r\nIs it a misunderstanding of my side, or is it really a bug ?\r\n\r\nThanks !\n\n### Scapy version\n\n2.4.5\n\n### Python version\n\n3.10\n\n### Operating system\n\nLinux 5.15.0\n\n### Additional environment information\n\n_No response_\n\n### How to reproduce\n\n```python\r\nfrom scapy.layers.netflow import NetflowHeader, NetflowHeaderV9, NetflowOptionsFlowsetOptionV9, NetflowOptionsFlowsetV9, NetflowOptionsFlowsetScopeV9, NetflowDataflowsetV9\r\n\r\ntemplateFlowSet_256 = NetflowOptionsFlowsetV9(\r\n\ttemplateID = 256,\r\n\toption_scope_length = 4*1,\r\n\toption_field_length = 4*3,\r\n\tscopes = [\r\n\t\tNetflowOptionsFlowsetScopeV9(scopeFieldType=1,\tscopeFieldlength= 4),\r\n\t],\r\n\toptions = [\r\n\t\tNetflowOptionsFlowsetOptionV9(optionFieldType= 10,\toptionFieldlength= 4),\r\n\t\tNetflowOptionsFlowsetOptionV9(optionFieldType= 82,\toptionFieldlength= 32),\r\n\t\tNetflowOptionsFlowsetOptionV9(optionFieldType= 83,\toptionFieldlength= 240)\r\n\t])\r\n\r\nnetflow_header = NetflowHeader() / NetflowHeaderV9()\r\n\r\n\r\npkt = netflow_header / templateFlowSet_256\r\n\r\npkt.show2()\r\n```\r\n\r\n\n\n### Actual result\n\n```python\r\n###[ Netflow Header ]### \r\n  version   = 9\r\n###[ Netflow Header V9 ]### \r\n     count     = 1\r\n     sysUptime = 0\r\n     unixSecs  = Thu, 01 Jan 1970 00:00:00 +0000 (0)\r\n     packageSequence= 0\r\n     SourceID  = 0\r\n###[ Netflow Options Template FlowSet V9 ]### \r\n        flowSetID = 1\r\n        length    = 26\r\n        templateID= 256\r\n        option_scope_length= 4\r\n        option_field_length= 12\r\n        \\scopes    \\\r\n         |###[ Netflow Options Template FlowSet V9/10 - Scope ]### \r\n         |  scopeFieldType= System\r\n         |  scopeFieldlength= 4\r\n        \\options   \\\r\n         |###[ Netflow Options Template FlowSet V9/10 - Option ]### \r\n         |  enterpriseBit= 0\r\n         |  optionFieldType= INPUT_SNMP\r\n         |  optionFieldlength= 4\r\n         |###[ Netflow Options Template FlowSet V9/10 - Option ]### \r\n         |  enterpriseBit= 0\r\n         |  optionFieldType= IF_NAME\r\n         |  optionFieldlength= 32\r\n         |###[ Netflow Options Template FlowSet V9/10 - Option ]### \r\n         |  enterpriseBit= 0\r\n         |  optionFieldType= IF_DESC\r\n         |  optionFieldlength= 240\r\n        pad       = ''\r\n###[ Netflow FlowSet V9/10 ]### \r\n           flowSetID = 0\r\n           length    = None\r\n           \\templates \\\r\n```\r\n\n\n### Expected result\n\n- pre_build length is : `10 (flowsetID + length + templateID) + 4 (scope) + 12 (options) = 26 bytes`\r\n- padding should be of `26 % 4 = 2 bytes`\r\n- post_build Flowset length after `post_build()` should be of `26 + 2 (padding) = 28 bytes`\r\n\r\n```python\r\n\r\n###[ Netflow Header ]### \r\n  version   = 9\r\n###[ Netflow Header V9 ]### \r\n     count     = 1\r\n     sysUptime = 0\r\n     unixSecs  = Thu, 01 Jan 1970 00:00:00 +0000 (0)\r\n     packageSequence= 0\r\n     SourceID  = 0\r\n###[ Netflow Options Template FlowSet V9 ]### \r\n        flowSetID = 1\r\n        length    = 28\r\n        templateID= 256\r\n        option_scope_length= 4\r\n        option_field_length= 12\r\n        \\scopes    \\\r\n         |###[ Netflow Options Template FlowSet V9/10 - Scope ]### \r\n         |  scopeFieldType= System\r\n         |  scopeFieldlength= 4\r\n        \\options   \\\r\n         |###[ Netflow Options Template FlowSet V9/10 - Option ]### \r\n         |  enterpriseBit= 0\r\n         |  optionFieldType= INPUT_SNMP\r\n         |  optionFieldlength= 4\r\n         |###[ Netflow Options Template FlowSet V9/10 - Option ]### \r\n         |  enterpriseBit= 0\r\n         |  optionFieldType= IF_NAME\r\n         |  optionFieldlength= 32\r\n         |###[ Netflow Options Template FlowSet V9/10 - Option ]### \r\n         |  enterpriseBit= 0\r\n         |  optionFieldType= IF_DESC\r\n         |  optionFieldlength= 240\r\n        pad       = '\\x00\\x00'\r\n```\n\n### Related resources\n\n- [RFC 3954](https://www.ietf.org/rfc/rfc3954.txt), see section 6.1, p. 15\r\n- [Fix proposition](https://github.com/secdev/scapy/compare/master...ekinops:scapy:fix-NetflowV9-options-template-length) if the issue is confirmed to be a bug ", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3831/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3831/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3785", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3785/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3785/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3785/events", "html_url": "https://github.com/secdev/scapy/pull/3785", "id": 1440766358, "node_id": "PR_kwDOApfmNs5CdD81", "number": 3785, "title": "Bugfix: Add padding of CAN frame for kernel socket", "user": {"login": "polybassa", "id": 1676055, "node_id": "MDQ6VXNlcjE2NzYwNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1676055?v=4", "gravatar_id": "", "url": "https://api.github.com/users/polybassa", "html_url": "https://github.com/polybassa", "followers_url": "https://api.github.com/users/polybassa/followers", "following_url": "https://api.github.com/users/polybassa/following{/other_user}", "gists_url": "https://api.github.com/users/polybassa/gists{/gist_id}", "starred_url": "https://api.github.com/users/polybassa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/polybassa/subscriptions", "organizations_url": "https://api.github.com/users/polybassa/orgs", "repos_url": "https://api.github.com/users/polybassa/repos", "events_url": "https://api.github.com/users/polybassa/events{/privacy}", "received_events_url": "https://api.github.com/users/polybassa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-11-08T19:15:15Z", "updated_at": "2022-11-10T09:52:35Z", "closed_at": "2022-11-10T09:52:29Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3785", "html_url": "https://github.com/secdev/scapy/pull/3785", "diff_url": "https://github.com/secdev/scapy/pull/3785.diff", "patch_url": "https://github.com/secdev/scapy/pull/3785.patch", "merged_at": "2022-11-10T09:52:29Z"}, "body": "@superuserx Discovered this bug. Could you please merge this quickly?", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3785/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3785/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3777", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3777/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3777/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3777/events", "html_url": "https://github.com/secdev/scapy/issues/3777", "id": 1435926504, "node_id": "I_kwDOApfmNs5Vln_o", "number": 3777, "title": "RandTCPOptions fails to randomize MD5 (exception triggered)", "user": {"login": "nrathaus", "id": 2032238, "node_id": "MDQ6VXNlcjIwMzIyMzg=", "avatar_url": "https://avatars.githubusercontent.com/u/2032238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrathaus", "html_url": "https://github.com/nrathaus", "followers_url": "https://api.github.com/users/nrathaus/followers", "following_url": "https://api.github.com/users/nrathaus/following{/other_user}", "gists_url": "https://api.github.com/users/nrathaus/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrathaus/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrathaus/subscriptions", "organizations_url": "https://api.github.com/users/nrathaus/orgs", "repos_url": "https://api.github.com/users/nrathaus/repos", "events_url": "https://api.github.com/users/nrathaus/events{/privacy}", "received_events_url": "https://api.github.com/users/nrathaus/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-11-04T11:23:03Z", "updated_at": "2022-11-15T12:23:06Z", "closed_at": "2022-11-15T12:23:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Brief description\n\nIn the latest version (from git) there is a bug in the RandTCPOptions code where the '16s' of MD5 is treated incorrectly due to:\r\n```\r\nfor stru in structs:\r\n```\r\n\r\nBeing used on the string '16s', which results in:\r\n`stru`\r\nbeing used with this function:\r\n`struct.calcsize(stru)`\r\n\r\nWhich for the case of:\r\n`struct.calcsize('1')`\r\n\r\nAn exception is triggered\n\n### Scapy version\n\ngit master\n\n### Python version\n\n3.9\n\n### Operating system\n\nMacOS (but the bug is unrelated)\n\n### Additional environment information\n\n_No response_\n\n### How to reproduce\n\nThe \"easiest\" way to trigger this bug is to do:\r\n```\r\nimport scapy.all\r\npayload = scapy.all.Ether()/scapy.all.IP(dst='192.168.15.1')/scapy.all.TCP()\r\np = scapy.all.fuzz(payload)\r\np.show2()\r\n```\r\n\r\nAnd then to start fuzzing, when the fuzzing falls on the \"RandTCPOptions\" and MD5 as the field to randomize, an exception is triggered (note that the line numbers don't match as I modified the code to try and trace this issue... sorry :) ) :\r\n```\r\nCannot calcsize for [!1], error: repeat count given without format specifier\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/opt/homebrew/lib/python3.10/site-packages/scapy/packet.py\", line 1686, in show2\r\n    return self.__class__(raw(self)).show(dump, indent, lvl, label_lvl)\r\n  File \"/opt/homebrew/lib/python3.10/site-packages/scapy/compat.py\", line 294, in raw\r\n    return bytes(x)\r\n  File \"/opt/homebrew/lib/python3.10/site-packages/scapy/packet.py\", line 589, in __bytes__\r\n    return self.build()\r\n  File \"/opt/homebrew/lib/python3.10/site-packages/scapy/packet.py\", line 954, in build\r\n    p = self.do_build()\r\n  File \"/opt/homebrew/lib/python3.10/site-packages/scapy/packet.py\", line 709, in do_build\r\n    self = next(iter(self))\r\n  File \"/opt/homebrew/lib/python3.10/site-packages/scapy/packet.py\", line 1339, in loop\r\n    for x in loop(todo[:], done):\r\n  File \"/opt/homebrew/lib/python3.10/site-packages/scapy/packet.py\", line 1346, in loop\r\n    for payl in payloads:\r\n  File \"/opt/homebrew/lib/python3.10/site-packages/scapy/packet.py\", line 1339, in loop\r\n    for x in loop(todo[:], done):\r\n  File \"/opt/homebrew/lib/python3.10/site-packages/scapy/packet.py\", line 1339, in loop\r\n    for x in loop(todo[:], done):\r\n  File \"/opt/homebrew/lib/python3.10/site-packages/scapy/packet.py\", line 1339, in loop\r\n    for x in loop(todo[:], done):\r\n  [Previous line repeated 6 more times]\r\n  File \"/opt/homebrew/lib/python3.10/site-packages/scapy/packet.py\", line 1346, in loop\r\n    for payl in payloads:\r\n  File \"/opt/homebrew/lib/python3.10/site-packages/scapy/packet.py\", line 1339, in loop\r\n    for x in loop(todo[:], done):\r\n  File \"/opt/homebrew/lib/python3.10/site-packages/scapy/packet.py\", line 1339, in loop\r\n    for x in loop(todo[:], done):\r\n  File \"/opt/homebrew/lib/python3.10/site-packages/scapy/packet.py\", line 1339, in loop\r\n    for x in loop(todo[:], done):\r\n  [Previous line repeated 6 more times]\r\n  File \"/opt/homebrew/lib/python3.10/site-packages/scapy/packet.py\", line 1351, in loop\r\n    done2[k] = done2[k]._fix()\r\n  File \"/opt/homebrew/lib/python3.10/site-packages/scapy/layers/inet.py\", line 384, in _fix\r\n    v = random.randint(0, 2 ** (8 * _size) - 1)\r\n```\n\n### Actual result\n\nAn exception is triggered\n\n### Expected result\n\nShowing a packet dump of a random MD5\n\n### Related resources\n\nThe following patch can be used to resolve it, scapy/layers/inet.py, from:\r\n```\r\n                for stru in structs:\r\n```\r\n\r\nTo this:\r\n```\r\n                struct_list = list(structs) # split it char by char\r\n                if 's' in structs:\r\n                    # We need to split it with the number before the 's'\r\n                    struct_list = [structs]\r\n\r\n                for stru in struct_list:\r\n```\r\n\r\nYou can probably make a better fix", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3777/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3777/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3767", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3767/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3767/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3767/events", "html_url": "https://github.com/secdev/scapy/issues/3767", "id": 1418388769, "node_id": "I_kwDOApfmNs5UiuUh", "number": 3767, "title": "PPPoED miscalculated Padding", "user": {"login": "rndreece", "id": 46905371, "node_id": "MDQ6VXNlcjQ2OTA1Mzcx", "avatar_url": "https://avatars.githubusercontent.com/u/46905371?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rndreece", "html_url": "https://github.com/rndreece", "followers_url": "https://api.github.com/users/rndreece/followers", "following_url": "https://api.github.com/users/rndreece/following{/other_user}", "gists_url": "https://api.github.com/users/rndreece/gists{/gist_id}", "starred_url": "https://api.github.com/users/rndreece/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rndreece/subscriptions", "organizations_url": "https://api.github.com/users/rndreece/orgs", "repos_url": "https://api.github.com/users/rndreece/repos", "events_url": "https://api.github.com/users/rndreece/events{/privacy}", "received_events_url": "https://api.github.com/users/rndreece/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-10-21T13:59:43Z", "updated_at": "2022-11-27T13:04:26Z", "closed_at": "2022-11-27T13:04:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Brief description\r\n\r\nIf bytes 4 and 5 of the PPPoED payload are 0, the whole payload is considered `Padding`.\r\n\r\nMost of the time those bytes will contain a `PPPoED_Tag.tag_type`, e.g `0x0103`. With either vendor-specific tags or the end-of-list tag they can be 0. (The end-of-list tag is deprecated but convenient to illustrate the issue.)\r\n\r\nI believe `PPPoED.extract_padding` added in 65eac3369b3673f70295b888d793577a82b936ce\r\nhttps://github.com/secdev/scapy/blob/139966f37ee4188c676b958260312b1e4ad81be2/scapy/layers/ppp.py#L80-L84\r\nis meant to calculate the padding from `PPPoED.len` (bytes 4 and 5 in the PPPoED packet), but uses the payload bytes instead.\r\n\r\n### Scapy version\r\n\r\n65eac3369b3673f70295b888d793577a82b936ce\r\n\r\n### Python version\r\n\r\nany\r\n\r\n### Operating system\r\n\r\nany\r\n\r\n### Additional environment information\r\n\r\n_No response_\r\n\r\n### How to reproduce\r\n\r\n```python\r\nfrom scapy.all import *\r\n\r\neth = Ether(dst=\"ff:ff:ff:ff:ff:ff\", src=\"12:12:12:12:12:12\", type=0x8863)\r\npppoed = PPPoED(version=1, type=1, code=0x9, sessionid=0, len=8)\r\nserver_name = PPPoETag(tag_type=0x0101, tag_len=0)\r\nend_of_list = PPPoETag(tag_type=0, tag_len=0)\r\n\r\noriginal = eth / pppoed / server_name / end_of_list\r\ndissected = Ether(original.build())\r\n\r\nprint(f\"original:  {original.summary()}\")\r\nprint(f\"dissected: {dissected.summary()}\")\r\n```\r\n\r\n### Actual result\r\n\r\nExample output for v2.5.0rc2:\r\n```\r\noriginal:  Ether / PPPoE Active Discovery Initiation (PADI) / PPPoETag / PPPoETag\r\ndissected: Ether / PPPoE Active Discovery Initiation (PADI) / Padding\r\n```\r\nTags are considered `Padding`.\r\n\r\n### Expected result\r\n\r\nExample output for v2.4.4:\r\n```\r\noriginal:  12:12:12:12:12:12 > ff:ff:ff:ff:ff:ff (PPP_DISC) / PPPoED / PPPoETag / PPPoETag\r\ndissected: 12:12:12:12:12:12 > ff:ff:ff:ff:ff:ff (PPP_DISC) / PPPoED / PPPoED_Tags\r\n```\r\nTags are correctly identified as `PPPoED_Tags`\r\n\r\n### Related resources\r\n\r\nhttps://www.rfc-editor.org/rfc/rfc2516", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3767/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3767/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3743", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3743/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3743/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3743/events", "html_url": "https://github.com/secdev/scapy/pull/3743", "id": 1383460034, "node_id": "PR_kwDOApfmNs4_exd_", "number": 3743, "title": "Automata: improve memory management", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-09-23T08:25:12Z", "updated_at": "2022-11-16T12:01:38Z", "closed_at": "2022-11-16T12:01:34Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3743", "html_url": "https://github.com/secdev/scapy/pull/3743", "diff_url": "https://github.com/secdev/scapy/pull/3743.diff", "patch_url": "https://github.com/secdev/scapy/pull/3743.patch", "merged_at": "2022-11-16T12:01:34Z"}, "body": "This PR:\r\n- improves how automata manage memory\r\n  - add a **`destroy()`** function that cleans up an Automaton (called in `__del__`, but in best case should also be called manually, especially on PyPy)\r\n    - added a bit of doc. As a reminder of how it works: when you start an automaton, it calls `start()` and spawns stuff. An automaton can be restarted using `restart()`, so some stuff is kept open even after it finishes. `stop()` is an invitation for the automaton to close itself gracefully (it switches the automaton to a STOP state), and `forcestop()` forces it to close. There was no function that cleaned up what `start()` spawned, so introducting **`destroy()`**.\r\n  - minor adjustment to how `ObjectPipe` worked on Windows to be closer to the linux behavior, removing the need for some special cases\r\n  - spawn sockets only when necessary + properly close them\r\n- properly decode libpcap errors on Windows (using the locale)\r\n\r\nSide effects:\r\n- fix https://github.com/secdev/scapy/issues/3619\r\n- attempt at fixing https://github.com/secdev/scapy/issues/3706\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3743/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3743/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3732", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3732/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3732/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3732/events", "html_url": "https://github.com/secdev/scapy/pull/3732", "id": 1367396311, "node_id": "PR_kwDOApfmNs4-qBDH", "number": 3732, "title": "Remove usage of cryptography's `register_interface`", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 971730999, "node_id": "MDU6TGFiZWw5NzE3MzA5OTk=", "url": "https://api.github.com/repos/secdev/scapy/labels/dependency-related", "name": "dependency-related", "color": "713be5", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-09-09T07:14:39Z", "updated_at": "2022-09-10T15:11:45Z", "closed_at": "2022-09-10T14:52:16Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3732", "html_url": "https://github.com/secdev/scapy/pull/3732", "diff_url": "https://github.com/secdev/scapy/pull/3732.diff", "patch_url": "https://github.com/secdev/scapy/pull/3732.patch", "merged_at": "2022-09-10T14:52:16Z"}, "body": "cryptography removed `register_interface` without changelog nor deperecation notices (quite uncommon from them :/) https://github.com/pyca/cryptography/pull/7234", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3732/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3732/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3721", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3721/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3721/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3721/events", "html_url": "https://github.com/secdev/scapy/issues/3721", "id": 1345137786, "node_id": "I_kwDOApfmNs5QLSx6", "number": 3721, "title": "Test failing on OpenBSD 7.1", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 514033136, "node_id": "MDU6TGFiZWw1MTQwMzMxMzY=", "url": "https://api.github.com/repos/secdev/scapy/labels/tests", "name": "tests", "color": "0e8a16", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 0, "created_at": "2022-08-20T11:11:08Z", "updated_at": "2022-12-06T22:22:33Z", "closed_at": "2022-12-06T22:22:32Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "The test named `Check offline sniff() with a PcapNg file and a filter (by file object)`  is failing on OpenBSD 7.1 with the following error `scapy.error.Scapy_Exception: Failed to compile filter expression udp (-1)`. I will try to reproduce the issue on a local VM.\n\n__Originally posted by @guedou in https://github.com/secdev/scapy/pull/3716#issuecomment-1220521197__", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3721/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3721/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3706", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3706/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3706/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3706/events", "html_url": "https://github.com/secdev/scapy/issues/3706", "id": 1323975749, "node_id": "I_kwDOApfmNs5O6kRF", "number": 3706, "title": "File descriptors are not explicitly closed in TLS automata (which breaks with pypy)", "user": {"login": "pictyeye", "id": 4354338, "node_id": "MDQ6VXNlcjQzNTQzMzg=", "avatar_url": "https://avatars.githubusercontent.com/u/4354338?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pictyeye", "html_url": "https://github.com/pictyeye", "followers_url": "https://api.github.com/users/pictyeye/followers", "following_url": "https://api.github.com/users/pictyeye/following{/other_user}", "gists_url": "https://api.github.com/users/pictyeye/gists{/gist_id}", "starred_url": "https://api.github.com/users/pictyeye/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pictyeye/subscriptions", "organizations_url": "https://api.github.com/users/pictyeye/orgs", "repos_url": "https://api.github.com/users/pictyeye/repos", "events_url": "https://api.github.com/users/pictyeye/events{/privacy}", "received_events_url": "https://api.github.com/users/pictyeye/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 1, "created_at": "2022-08-01T07:43:16Z", "updated_at": "2022-12-05T18:30:23Z", "closed_at": "2022-12-05T18:30:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Brief description\n\nWe use TLS automata from scapy to interact with TLS servers, generating a big number of connections (each with a fresh automaton), and we observe that file descriptors can accumulate, especially with pypy where the number can reach several thousands.\n\n### Scapy version\n\nscapy-2.4.5rc1.dev317\n\n### Python version\n\n3.10-python and 3.9-pypy\n\n### Operating system\n\nDebian 5.10.127-1 (2022-06-30)\n\n### Additional environment information\n\nWe are using scapy to infer TLS state machines using the L* algorithm (see our [tool](https://gitlab.com/gaspians/pylstar-tls) if you are interested).\r\n\r\nFor our experiments, we tried switching from python to pypy, but we encountered a problem with file descriptors which were not explicitly closed (and since pypy does not do aggressive garbage collection, to-be-closed fds can last a rather long time, which is problematic for us). This is a [known problem with pypy](https://doc.pypy.org/en/latest/cpython_differences.html#differences-related-to-garbage-collection-strategies), but we do not know how to fix it properly in scapy-tls. For your information, it seems to be related to [a recent issue where test sockets were not properly closed](https://github.com/secdev/scapy/issues/3677), and there was an [old bug](https://github.com/secdev/scapy/issues/1831) which seems to also be related.\r\n\r\nWe are at your disposal for more tests, and thank you in advance for your help!\n\n### How to reproduce\n\nWe join a simple reproducer using TLS automata. The idea is to run n TLS connections in a row, while monitoring in /proc/PID/fd the number of open file descriptors. We observe a big number of fds (mostly pipes, but also sockets), which take time to be closed. We believe this comes from the implementation of automata in scapy, but this might also be TLS-specific?\r\n\r\n```python\r\nfrom argparse import ArgumentParser\r\nfrom scapy.layers.tls.automaton_cli import TLSClientAutomaton\r\n\r\n\r\ndef run(host, port, tls_version, n):\r\n    for _ in range(n):\r\n        tls = TLSClientAutomaton(\r\n            server=host,\r\n            dport=port,\r\n            version=tls_version,\r\n            data=\"quit\"\r\n        )\r\n        tls.run()\r\n\r\n\r\nrun(\"SERVERNAME\", 443, \"tls12\", 1000)\r\n```\r\n\r\nFor n=1000, the maximum reached with python is 185 open fds. With pypy, it seems several of the fds are never closed, leading to a growing stock of stale fds. On a first experiment, we reached 955 (and ended at 765). On a second experiment, we reached 1033... which led to an error in select (since select only supports 1024 fds).\n\n### Actual result\n\nThe number of open file descriptors grows steadily with pypy. This can lead to resource exhaustion or errors with select.\n\n### Expected result\n\nWe expect the number of open file descriptors to remain low during all the experiment, which is what we observe with python.\n\n### Related resources\n\n- https://doc.pypy.org/en/latest/cpython_differences.html#differences-related-to-garbage-collection-strategies\r\n- https://github.com/secdev/scapy/issues/3677\r\n- https://github.com/secdev/scapy/issues/1831", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3706/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3706/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3698", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3698/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3698/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3698/events", "html_url": "https://github.com/secdev/scapy/pull/3698", "id": 1311792938, "node_id": "PR_kwDOApfmNs47xiSJ", "number": 3698, "title": "Fix #3677: Bugfix in TestSocket `__init__` and `close()`", "user": {"login": "polybassa", "id": 1676055, "node_id": "MDQ6VXNlcjE2NzYwNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1676055?v=4", "gravatar_id": "", "url": "https://api.github.com/users/polybassa", "html_url": "https://github.com/polybassa", "followers_url": "https://api.github.com/users/polybassa/followers", "following_url": "https://api.github.com/users/polybassa/following{/other_user}", "gists_url": "https://api.github.com/users/polybassa/gists{/gist_id}", "starred_url": "https://api.github.com/users/polybassa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/polybassa/subscriptions", "organizations_url": "https://api.github.com/users/polybassa/orgs", "repos_url": "https://api.github.com/users/polybassa/repos", "events_url": "https://api.github.com/users/polybassa/events{/privacy}", "received_events_url": "https://api.github.com/users/polybassa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 514033136, "node_id": "MDU6TGFiZWw1MTQwMzMxMzY=", "url": "https://api.github.com/repos/secdev/scapy/labels/tests", "name": "tests", "color": "0e8a16", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "polybassa", "id": 1676055, "node_id": "MDQ6VXNlcjE2NzYwNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1676055?v=4", "gravatar_id": "", "url": "https://api.github.com/users/polybassa", "html_url": "https://github.com/polybassa", "followers_url": "https://api.github.com/users/polybassa/followers", "following_url": "https://api.github.com/users/polybassa/following{/other_user}", "gists_url": "https://api.github.com/users/polybassa/gists{/gist_id}", "starred_url": "https://api.github.com/users/polybassa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/polybassa/subscriptions", "organizations_url": "https://api.github.com/users/polybassa/orgs", "repos_url": "https://api.github.com/users/polybassa/repos", "events_url": "https://api.github.com/users/polybassa/events{/privacy}", "received_events_url": "https://api.github.com/users/polybassa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "polybassa", "id": 1676055, "node_id": "MDQ6VXNlcjE2NzYwNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1676055?v=4", "gravatar_id": "", "url": "https://api.github.com/users/polybassa", "html_url": "https://github.com/polybassa", "followers_url": "https://api.github.com/users/polybassa/followers", "following_url": "https://api.github.com/users/polybassa/following{/other_user}", "gists_url": "https://api.github.com/users/polybassa/gists{/gist_id}", "starred_url": "https://api.github.com/users/polybassa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/polybassa/subscriptions", "organizations_url": "https://api.github.com/users/polybassa/orgs", "repos_url": "https://api.github.com/users/polybassa/repos", "events_url": "https://api.github.com/users/polybassa/events{/privacy}", "received_events_url": "https://api.github.com/users/polybassa/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2022-07-20T19:47:48Z", "updated_at": "2023-02-08T14:48:56Z", "closed_at": "2022-07-26T20:53:56Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3698", "html_url": "https://github.com/secdev/scapy/pull/3698", "diff_url": "https://github.com/secdev/scapy/pull/3698.diff", "patch_url": "https://github.com/secdev/scapy/pull/3698.patch", "merged_at": "2022-07-26T20:53:56Z"}, "body": "This PR fixes issues for #3677 ", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3698/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3698/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3695", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3695/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3695/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3695/events", "html_url": "https://github.com/secdev/scapy/pull/3695", "id": 1308479086, "node_id": "PR_kwDOApfmNs47mH6c", "number": 3695, "title": "Fix minor bug in Automotive_Scanner kwargs validation", "user": {"login": "polybassa", "id": 1676055, "node_id": "MDQ6VXNlcjE2NzYwNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1676055?v=4", "gravatar_id": "", "url": "https://api.github.com/users/polybassa", "html_url": "https://github.com/polybassa", "followers_url": "https://api.github.com/users/polybassa/followers", "following_url": "https://api.github.com/users/polybassa/following{/other_user}", "gists_url": "https://api.github.com/users/polybassa/gists{/gist_id}", "starred_url": "https://api.github.com/users/polybassa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/polybassa/subscriptions", "organizations_url": "https://api.github.com/users/polybassa/orgs", "repos_url": "https://api.github.com/users/polybassa/repos", "events_url": "https://api.github.com/users/polybassa/events{/privacy}", "received_events_url": "https://api.github.com/users/polybassa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1000112749, "node_id": "MDU6TGFiZWwxMDAwMTEyNzQ5", "url": "https://api.github.com/repos/secdev/scapy/labels/cleanup", "name": "cleanup", "color": "FF68F6", "default": false, "description": "Performs some code clean-up"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-07-18T19:51:03Z", "updated_at": "2022-07-27T09:01:53Z", "closed_at": "2022-07-26T20:54:17Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3695", "html_url": "https://github.com/secdev/scapy/pull/3695", "diff_url": "https://github.com/secdev/scapy/pull/3695.diff", "patch_url": "https://github.com/secdev/scapy/pull/3695.patch", "merged_at": "2022-07-26T20:54:17Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3695/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3695/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3663", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3663/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3663/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3663/events", "html_url": "https://github.com/secdev/scapy/pull/3663", "id": 1284576708, "node_id": "PR_kwDOApfmNs46Wrw4", "number": 3663, "title": "Properly discard close_pipe on socket failure", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 4, "created_at": "2022-06-25T12:38:14Z", "updated_at": "2022-07-05T12:12:41Z", "closed_at": "2022-07-05T11:42:39Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3663", "html_url": "https://github.com/secdev/scapy/pull/3663", "diff_url": "https://github.com/secdev/scapy/pull/3663.diff", "patch_url": "https://github.com/secdev/scapy/pull/3663.patch", "merged_at": "2022-07-05T11:42:38Z"}, "body": "fix https://github.com/secdev/scapy/issues/3631\r\n\r\nI tried to put this code in the place the if would be called the least often, yet work.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3663/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3663/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3662", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3662/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3662/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3662/events", "html_url": "https://github.com/secdev/scapy/pull/3662", "id": 1284569884, "node_id": "PR_kwDOApfmNs46WqVP", "number": 3662, "title": "Fix length calculation in Dot11EltRSN", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 1, "created_at": "2022-06-25T12:14:26Z", "updated_at": "2022-07-02T08:23:54Z", "closed_at": "2022-07-02T07:48:41Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3662", "html_url": "https://github.com/secdev/scapy/pull/3662", "diff_url": "https://github.com/secdev/scapy/pull/3662.diff", "patch_url": "https://github.com/secdev/scapy/pull/3662.patch", "merged_at": "2022-07-02T07:48:40Z"}, "body": "fixes https://github.com/secdev/scapy/issues/3613\r\nfixes https://github.com/secdev/scapy/issues/3609\r\ncloses https://github.com/secdev/scapy/pull/3611", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3662/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3662/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3644", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3644/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3644/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3644/events", "html_url": "https://github.com/secdev/scapy/pull/3644", "id": 1273848946, "node_id": "PR_kwDOApfmNs45yph1", "number": 3644, "title": "dhcp: fix some random values", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-06-16T17:01:54Z", "updated_at": "2022-06-19T13:35:38Z", "closed_at": "2022-06-19T13:26:25Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3644", "html_url": "https://github.com/secdev/scapy/pull/3644", "diff_url": "https://github.com/secdev/scapy/pull/3644.diff", "patch_url": "https://github.com/secdev/scapy/pull/3644.patch", "merged_at": "2022-06-19T13:26:24Z"}, "body": "fixes https://github.com/secdev/scapy/issues/3638 by making sure DHCP's random fields stay in-bound", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3644/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3644/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3634", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3634/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3634/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3634/events", "html_url": "https://github.com/secdev/scapy/pull/3634", "id": 1262800070, "node_id": "PR_kwDOApfmNs45N7nw", "number": 3634, "title": "Fix docs CI-build", "user": {"login": "polybassa", "id": 1676055, "node_id": "MDQ6VXNlcjE2NzYwNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1676055?v=4", "gravatar_id": "", "url": "https://api.github.com/users/polybassa", "html_url": "https://github.com/polybassa", "followers_url": "https://api.github.com/users/polybassa/followers", "following_url": "https://api.github.com/users/polybassa/following{/other_user}", "gists_url": "https://api.github.com/users/polybassa/gists{/gist_id}", "starred_url": "https://api.github.com/users/polybassa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/polybassa/subscriptions", "organizations_url": "https://api.github.com/users/polybassa/orgs", "repos_url": "https://api.github.com/users/polybassa/repos", "events_url": "https://api.github.com/users/polybassa/events{/privacy}", "received_events_url": "https://api.github.com/users/polybassa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 514033136, "node_id": "MDU6TGFiZWw1MTQwMzMxMzY=", "url": "https://api.github.com/repos/secdev/scapy/labels/tests", "name": "tests", "color": "0e8a16", "default": false, "description": null}, {"id": 972547864, "node_id": "MDU6TGFiZWw5NzI1NDc4NjQ=", "url": "https://api.github.com/repos/secdev/scapy/labels/doc", "name": "doc", "color": "0e8a16", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-06-07T06:43:10Z", "updated_at": "2022-07-27T09:01:20Z", "closed_at": "2022-06-07T08:13:59Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3634", "html_url": "https://github.com/secdev/scapy/pull/3634", "diff_url": "https://github.com/secdev/scapy/pull/3634.diff", "patch_url": "https://github.com/secdev/scapy/pull/3634.patch", "merged_at": "2022-06-07T08:13:59Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3634/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3634/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3631", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3631/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3631/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3631/events", "html_url": "https://github.com/secdev/scapy/issues/3631", "id": 1255758518, "node_id": "I_kwDOApfmNs5K2Vq2", "number": 3631, "title": "Putting down an interface causes sniff() to get stuck on the ObjectPipe", "user": {"login": "Zalewa", "id": 563785, "node_id": "MDQ6VXNlcjU2Mzc4NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/563785?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Zalewa", "html_url": "https://github.com/Zalewa", "followers_url": "https://api.github.com/users/Zalewa/followers", "following_url": "https://api.github.com/users/Zalewa/following{/other_user}", "gists_url": "https://api.github.com/users/Zalewa/gists{/gist_id}", "starred_url": "https://api.github.com/users/Zalewa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Zalewa/subscriptions", "organizations_url": "https://api.github.com/users/Zalewa/orgs", "repos_url": "https://api.github.com/users/Zalewa/repos", "events_url": "https://api.github.com/users/Zalewa/events{/privacy}", "received_events_url": "https://api.github.com/users/Zalewa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-06-01T11:35:40Z", "updated_at": "2022-11-25T10:00:47Z", "closed_at": "2022-07-05T11:42:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Brief description\n\n`sniff()` gets stuck forever when the eth interface it sniffs on is brought down. There's no notification to the caller that the sniffing is dead, even though `sniff()` internally knows about that.\n\n### Scapy version\n\n2.4.5\n\n### Python version\n\n3.6.9\n\n### Operating system\n\n4.15.0-143-generic\n\n### Additional environment information\n\n_No response_\n\n### How to reproduce\n\n1. Open a terminal, in this terminal run a Python script:\r\n```\r\nfrom scapy.all import sniff\r\nsniff(iface=\"eth0\")\r\n```\r\nReplace \"eth0\" with your own interface if needed. \r\nThe script should now get stuck in the sniffing loop inside `sniff()`, which is correct and expected.\r\nLeave this terminal open and the script running.\r\n\r\n2. Open another terminal, run: `sudo ip link set eth0 down`\n\n### Actual result\n\nEntering the `sniff()` as presented in step 1. creates an `AsyncSniffer` object from the `sendrecv` module. There it opens 2 \"selectables\": a `scapy.arch.linux.L2ListenSocket` and a `scapy.automaton.ObjectPipe`. The `ObjectPipe` is opened because the `L2ListenSocket` is determined to be blocking and with the `ObjectPipe` we can stop the sniffing by calling the `stop()` method. Both of these \"selectables\" are put on the `sniff_sockets` list which is then passed to the blocking `select_func()`. So far so good.\r\n\r\nBut then we put the `eth0` interface down by doing step 2. This correctly triggers the `select_func()` on the `L2ListenSocket` which is detected to be EOF and then marked as dead and put on the `dead_sockets` list. The `L2ListenSocket` is subsequently removed from the `sniff_sockets` list. As there are no more actual sockets to sniff on, the `sniff()` should stop now. Right? But that doesn't happen. \r\n\r\nThe dummy `ObjectPipe` still remains on the `sniff_sockets` list and because the `while` loop checks if there is anything (**anything!** so the dummy `ObjectPipe` counts) on this list, the loop will get stuck on `select_func()` indefinitely - or at least until `stop()` on the `AsyncSniffer` is called, but when you call the `sniff()` function directly there's no reference to `AsyncSniffer` available.\r\n\r\n`sniff()` doesn't return and doesn't raise any error either. Moreover, even if the eth device is brought back up, `sniff()` will not resume sniffing. It doesn't help even if I bypass `sniff()` and create `AsyncSniffer` myself then call `AsyncSniffer._run()` directly, because the eth up/down status is usually controlled by outside means, so there's no easy way to determine when `AsyncSniffer.stop()` should be called.\n\n### Expected result\n\nI need a way to resurrect the sniffing after the interface is brought down and then back up. I need a way to detect that the old sniffing has died so that I can create a new sniffer on the same interface.\r\n\r\nPardon me if I'm incorrect but can non-blocking sockets raise the EOFError too? If yes then I don't think the behavior with a blocking socket should be different from the non-blocking socket. When the sniffed socket is non-blocking, the `ObjectPipe` is never created and never put on the `sniff_sockets` list, thus as soon as the main socket is determined to be dead, `sniff_sockets` list will become empty and `sniff()` will end and return to the caller. I think that when the sniffed interface is brought down and its socket is determined as dead then `sniff()` should end.\r\n\n\n### Related resources\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3631/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3631/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3616", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3616/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3616/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3616/events", "html_url": "https://github.com/secdev/scapy/pull/3616", "id": 1243835786, "node_id": "PR_kwDOApfmNs44Ogeb", "number": 3616, "title": "Adjust MQTTPublish when underlayer is QOS", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-05-21T01:54:05Z", "updated_at": "2022-06-18T13:12:50Z", "closed_at": "2022-06-18T13:12:50Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3616", "html_url": "https://github.com/secdev/scapy/pull/3616", "diff_url": "https://github.com/secdev/scapy/pull/3616.diff", "patch_url": "https://github.com/secdev/scapy/pull/3616.patch", "merged_at": "2022-06-18T13:12:50Z"}, "body": "This PR fixes #3572 ", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3616/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3616/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3613", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3613/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3613/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3613/events", "html_url": "https://github.com/secdev/scapy/issues/3613", "id": 1241292329, "node_id": "I_kwDOApfmNs5J_J4p", "number": 3613, "title": "Incorrect parsing  of RSN group_management_cipher_suite", "user": {"login": "jacontre-c", "id": 71885378, "node_id": "MDQ6VXNlcjcxODg1Mzc4", "avatar_url": "https://avatars.githubusercontent.com/u/71885378?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jacontre-c", "html_url": "https://github.com/jacontre-c", "followers_url": "https://api.github.com/users/jacontre-c/followers", "following_url": "https://api.github.com/users/jacontre-c/following{/other_user}", "gists_url": "https://api.github.com/users/jacontre-c/gists{/gist_id}", "starred_url": "https://api.github.com/users/jacontre-c/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jacontre-c/subscriptions", "organizations_url": "https://api.github.com/users/jacontre-c/orgs", "repos_url": "https://api.github.com/users/jacontre-c/repos", "events_url": "https://api.github.com/users/jacontre-c/events{/privacy}", "received_events_url": "https://api.github.com/users/jacontre-c/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-05-19T06:37:34Z", "updated_at": "2022-07-02T07:48:40Z", "closed_at": "2022-07-02T07:48:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Brief description\n\nDuring association req/resp parsing, if the frame contains PMKID list (for example, during OKC roaming), the subsequent IE present in the frame will be corrupted\r\nThis happens as parser takes group_management_cipher_suite, even if there are no enough bytes to do it, taking 4 bytes of the next IE\r\nA possible simple fix is to change the >=2, to >=3 in dot11.py, line 1219 in group_management_cipher_suite field (tested with different scenarios, worked for me)\n\n### Scapy version\n\n2.4.5\n\n### Python version\n\n3.9\n\n### Operating system\n\nAny. Specifically tested in Mac OS 11.6.5, but this is not OS dependent\n\n### Additional environment information\n\n_No response_\n\n### How to reproduce\n\nJust parse the included captures. Check the next IE ID after Dot11EltRSN, it will be incorrect value (1) for the non-working scenario\n\n### Actual result\n\n_No response_\n\n### Expected result\n\nFrom what I see, there  is a simple fix that works for me in all scenarios (including reassociation parsing with PMKIDs and groupwise keys)\r\n\r\nin dot11.py, for this section:\r\n ConditionalField(\r\n            PacketField(\"group_management_cipher_suite\",\r\n                        RSNCipherSuite(cipher=0x6), RSNCipherSuite),\r\n            lambda pkt: (\r\n                True if pkt.len is None else\r\n                pkt.len - (\r\n                    12 +\r\n                    (pkt.nb_pairwise_cipher_suites or 0) * 4 +\r\n                    (pkt.nb_akm_suites or 0) * 4 +\r\n                    (pkt.pmkids and pkt.pmkids.nb_pmkids or 0) * 16\r\n                ) >= 2                 # <<<<< change  this to 3\r\n            )\r\n        )\n\n### Related resources\n\n[examples.zip](https://github.com/secdev/scapy/files/8725880/examples.zip)\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3613/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3613/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3610", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3610/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3610/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3610/events", "html_url": "https://github.com/secdev/scapy/pull/3610", "id": 1239898435, "node_id": "PR_kwDOApfmNs44BfXP", "number": 3610, "title": "Cleanup sr1()", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1000112749, "node_id": "MDU6TGFiZWwxMDAwMTEyNzQ5", "url": "https://api.github.com/repos/secdev/scapy/labels/cleanup", "name": "cleanup", "color": "FF68F6", "default": false, "description": "Performs some code clean-up"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 4, "created_at": "2022-05-18T12:41:15Z", "updated_at": "2022-06-07T12:22:29Z", "closed_at": "2022-06-07T12:22:00Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3610", "html_url": "https://github.com/secdev/scapy/pull/3610", "diff_url": "https://github.com/secdev/scapy/pull/3610.diff", "patch_url": "https://github.com/secdev/scapy/pull/3610.patch", "merged_at": "2022-06-07T12:22:00Z"}, "body": "- add missing `_interface_selection` to `sr()`\r\n- Re-use `sr()` in `sr1()`\r\n\r\nfixes https://github.com/secdev/scapy/issues/3583", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3610/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3610/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3583", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3583/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3583/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3583/events", "html_url": "https://github.com/secdev/scapy/issues/3583", "id": 1206033038, "node_id": "I_kwDOApfmNs5H4pqO", "number": 3583, "title": "sr() FAILED to send packets [on the latest version of Window 11]", "user": {"login": "Ru0ch3n", "id": 47513906, "node_id": "MDQ6VXNlcjQ3NTEzOTA2", "avatar_url": "https://avatars.githubusercontent.com/u/47513906?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ru0ch3n", "html_url": "https://github.com/Ru0ch3n", "followers_url": "https://api.github.com/users/Ru0ch3n/followers", "following_url": "https://api.github.com/users/Ru0ch3n/following{/other_user}", "gists_url": "https://api.github.com/users/Ru0ch3n/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ru0ch3n/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ru0ch3n/subscriptions", "organizations_url": "https://api.github.com/users/Ru0ch3n/orgs", "repos_url": "https://api.github.com/users/Ru0ch3n/repos", "events_url": "https://api.github.com/users/Ru0ch3n/events{/privacy}", "received_events_url": "https://api.github.com/users/Ru0ch3n/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-04-16T06:44:55Z", "updated_at": "2022-06-07T12:22:00Z", "closed_at": "2022-06-07T12:22:00Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Brief description\r\n\r\n\r\nI've been using sr() and sr1() on my Win11 PC. And everything was fine.\r\n\r\n\r\nBut  lately I discovered that sr() FAILED to send packet. ( wireshark capturing proves that no packet successfully send)\r\n\r\n\r\nsr() FAILED to send packets,\r\nwhile sr1()  is still able to send packets. \r\n\r\nPretty sure that I run the script with admin privilege.\r\n![image](https://user-images.githubusercontent.com/47513906/163668606-76f60734-0c57-4cea-b177-5137d43c3372.png)\r\n![image](https://user-images.githubusercontent.com/47513906/163668625-e920330f-7416-457a-af15-7df583081718.png)\r\n\r\nIt seems something went wrong when sr() deals with iface selection on the latest windows platform...\r\nI manually implement _interface_selection in sr()\uff0c then the problem is solved.\r\n\r\nPlease consider adding  _interface_selection in sr() \r\n\r\n### Scapy version\r\n\r\n2.4.5\r\n\r\n### Python version\r\n\r\n3.8\r\n\r\n### Operating system\r\n\r\nWin 11[10.0.220000]\r\n\r\n### Additional environment information\r\n\r\n_No response_\r\n\r\n### How to reproduce\r\n\r\nsr()  while wireshark capturing just prove sr() could not successfully send the packet.\r\n\r\n### Actual result\r\n\r\n_No response_\r\n\r\n### Expected result\r\n\r\n_No response_\r\n\r\n### Related resources\r\n\r\n_No response_", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3583/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3583/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3567", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3567/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3567/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3567/events", "html_url": "https://github.com/secdev/scapy/issues/3567", "id": 1191776633, "node_id": "I_kwDOApfmNs5HCRF5", "number": 3567, "title": "The error raised by wrong BPF filter syntax is uncaught when using AsyncSniffer.", "user": {"login": "cosmin-ionut", "id": 49672709, "node_id": "MDQ6VXNlcjQ5NjcyNzA5", "avatar_url": "https://avatars.githubusercontent.com/u/49672709?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cosmin-ionut", "html_url": "https://github.com/cosmin-ionut", "followers_url": "https://api.github.com/users/cosmin-ionut/followers", "following_url": "https://api.github.com/users/cosmin-ionut/following{/other_user}", "gists_url": "https://api.github.com/users/cosmin-ionut/gists{/gist_id}", "starred_url": "https://api.github.com/users/cosmin-ionut/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cosmin-ionut/subscriptions", "organizations_url": "https://api.github.com/users/cosmin-ionut/orgs", "repos_url": "https://api.github.com/users/cosmin-ionut/repos", "events_url": "https://api.github.com/users/cosmin-ionut/events{/privacy}", "received_events_url": "https://api.github.com/users/cosmin-ionut/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 1, "created_at": "2022-04-04T13:16:48Z", "updated_at": "2022-04-13T18:47:52Z", "closed_at": "2022-04-13T18:47:52Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Brief description\n\nThe error raised by wrong BPF filter syntax in AsyncSniffer is not caught.\n\n### Scapy version\n\n2.4.5\n\n### Python version\n\n3.9.7\n\n### Operating system\n\nLinux 5.13.0-37-generic\n\n### Additional environment information\n\nThis behavior is only reproducible on Linux, it couldn't be reproduced on Windows.\r\nI didn't try on MAC.\n\n### How to reproduce\n\n**Step 1:**\r\nOpen scapy\r\n\r\n**Step 2:**\r\nRun the following lines of code:\r\n`e = AsyncSniffer(filter='adawdadadsadaaw')`\r\n`e.start()`\r\n\r\n**Step 3:**\r\nObserve that:\r\n- the incorrect filter error is uncaught\r\n- the AsyncSniffer doesn't capture packets\r\n- e.running is True, even though there was an error raised and the AsyncSniffer dosen't catch anything.\n\n### Actual result\n\n```\r\nException in thread AsyncSniffer:\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.9/threading.py\", line 973, in _bootstrap_inner\r\n    self.run()\r\n  File \"/usr/lib/python3.9/threading.py\", line 910, in run\r\n    self._target(*self._args, **self._kwargs)\r\n  File \"/usr/local/lib/python3.9/dist-packages/scapy/sendrecv.py\", line 1127, in _run\r\n    sniff_sockets[L2socket(type=ETH_P_ALL, iface=iface,\r\n  File \"/usr/local/lib/python3.9/dist-packages/scapy/arch/linux.py\", line 497, in __init__\r\n    attach_filter(self.ins, filter, self.iface)\r\n  File \"/usr/local/lib/python3.9/dist-packages/scapy/arch/linux.py\", line 166, in attach_filter\r\n    bp = compile_filter(bpf_filter, iface)\r\n  File \"/usr/local/lib/python3.9/dist-packages/scapy/arch/common.py\", line 156, in compile_filter\r\n    raise Scapy_Exception(\r\nscapy.error.Scapy_Exception: Failed to compile filter expression adawdadadsadaaw (-1)\r\n```\n\n### Expected result\n\nThe error should be caught.\r\n\r\n**For lack of a better section, I will add more info here:**\r\nAfter a brief investigation, this behavior might be caused by the fact that:\r\nFile scapy/scapy/arch/linux.py line 498, there is a try-except, whose `except `catches only `ImportErrors`:\r\n```\r\nif filter is not None:\r\n    try:\r\n        attach_filter(self.ins, filter, self.iface)\r\n    except ImportError as ex:\r\n        log_runtime.error(\"Cannot set filter: %s\", ex)\r\n```\r\n\r\nIf the `except` is edited to catch all exceptions, the error is caught and the problematic behavior is eliminated.\r\n```\r\nif filter is not None:\r\n    try:\r\n        attach_filter(self.ins, filter, self.iface)\r\n    except Exception as ex:\r\n        log_runtime.error(\"Cannot set filter: %s\", ex)\r\n```\r\n\r\nExample after modification:\r\n\r\n```\r\n>>> e = AsyncSniffer(filter='adawdadadsadaaw')\r\n>>> e.start()\r\n>>> ERROR: Cannot set filter: Failed to compile filter expression adawdadadsadaaw (-1)\r\n>>>\r\n>>> e.stop()\r\n<Sniffed: TCP:35 UDP:0 ICMP:0 Other:0>\r\n>>>\r\n```\n\n### Related resources\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3567/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3567/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3517", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3517/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3517/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3517/events", "html_url": "https://github.com/secdev/scapy/pull/3517", "id": 1118586602, "node_id": "PR_kwDOApfmNs4xy1Co", "number": 3517, "title": "Fix appveyor", "user": {"login": "polybassa", "id": 1676055, "node_id": "MDQ6VXNlcjE2NzYwNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1676055?v=4", "gravatar_id": "", "url": "https://api.github.com/users/polybassa", "html_url": "https://github.com/polybassa", "followers_url": "https://api.github.com/users/polybassa/followers", "following_url": "https://api.github.com/users/polybassa/following{/other_user}", "gists_url": "https://api.github.com/users/polybassa/gists{/gist_id}", "starred_url": "https://api.github.com/users/polybassa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/polybassa/subscriptions", "organizations_url": "https://api.github.com/users/polybassa/orgs", "repos_url": "https://api.github.com/users/polybassa/repos", "events_url": "https://api.github.com/users/polybassa/events{/privacy}", "received_events_url": "https://api.github.com/users/polybassa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1000112749, "node_id": "MDU6TGFiZWwxMDAwMTEyNzQ5", "url": "https://api.github.com/repos/secdev/scapy/labels/cleanup", "name": "cleanup", "color": "FF68F6", "default": false, "description": "Performs some code clean-up"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 9, "created_at": "2022-01-30T15:45:24Z", "updated_at": "2022-07-27T09:00:00Z", "closed_at": "2022-02-01T09:55:40Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3517", "html_url": "https://github.com/secdev/scapy/pull/3517", "diff_url": "https://github.com/secdev/scapy/pull/3517.diff", "patch_url": "https://github.com/secdev/scapy/pull/3517.patch", "merged_at": "2022-02-01T09:55:39Z"}, "body": "This PR \r\n- fixes appveyor\r\n- speeds up some automotive tests by removing `send_delay` from EcuAnsweringmachine\r\n- ~Speeds up and stabilizes imports.uts by limiting the files to test the import on to 40 randomly selected files~\r\n- disable imports.uts since I don't know how to fix it", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3517/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3517/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3511", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3511/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3511/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3511/events", "html_url": "https://github.com/secdev/scapy/pull/3511", "id": 1111799699, "node_id": "PR_kwDOApfmNs4xdCIv", "number": 3511, "title": "Fix #3507", "user": {"login": "polybassa", "id": 1676055, "node_id": "MDQ6VXNlcjE2NzYwNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1676055?v=4", "gravatar_id": "", "url": "https://api.github.com/users/polybassa", "html_url": "https://github.com/polybassa", "followers_url": "https://api.github.com/users/polybassa/followers", "following_url": "https://api.github.com/users/polybassa/following{/other_user}", "gists_url": "https://api.github.com/users/polybassa/gists{/gist_id}", "starred_url": "https://api.github.com/users/polybassa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/polybassa/subscriptions", "organizations_url": "https://api.github.com/users/polybassa/orgs", "repos_url": "https://api.github.com/users/polybassa/repos", "events_url": "https://api.github.com/users/polybassa/events{/privacy}", "received_events_url": "https://api.github.com/users/polybassa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1000112749, "node_id": "MDU6TGFiZWwxMDAwMTEyNzQ5", "url": "https://api.github.com/repos/secdev/scapy/labels/cleanup", "name": "cleanup", "color": "FF68F6", "default": false, "description": "Performs some code clean-up"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 3, "created_at": "2022-01-23T07:37:11Z", "updated_at": "2022-07-27T09:04:03Z", "closed_at": "2022-02-09T16:47:23Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3511", "html_url": "https://github.com/secdev/scapy/pull/3511", "diff_url": "https://github.com/secdev/scapy/pull/3511.diff", "patch_url": "https://github.com/secdev/scapy/pull/3511.patch", "merged_at": "2022-02-09T16:47:23Z"}, "body": "fixes #3507", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3511/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3511/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3505", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3505/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3505/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3505/events", "html_url": "https://github.com/secdev/scapy/pull/3505", "id": 1100625327, "node_id": "PR_kwDOApfmNs4w31Sv", "number": 3505, "title": "802.11 Radiotap timestamp, HE, HE_MU field fixes", "user": {"login": "bhdrozgn", "id": 45441291, "node_id": "MDQ6VXNlcjQ1NDQxMjkx", "avatar_url": "https://avatars.githubusercontent.com/u/45441291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bhdrozgn", "html_url": "https://github.com/bhdrozgn", "followers_url": "https://api.github.com/users/bhdrozgn/followers", "following_url": "https://api.github.com/users/bhdrozgn/following{/other_user}", "gists_url": "https://api.github.com/users/bhdrozgn/gists{/gist_id}", "starred_url": "https://api.github.com/users/bhdrozgn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bhdrozgn/subscriptions", "organizations_url": "https://api.github.com/users/bhdrozgn/orgs", "repos_url": "https://api.github.com/users/bhdrozgn/repos", "events_url": "https://api.github.com/users/bhdrozgn/events{/privacy}", "received_events_url": "https://api.github.com/users/bhdrozgn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 4, "created_at": "2022-01-12T17:49:12Z", "updated_at": "2022-06-18T21:02:54Z", "closed_at": "2022-06-18T21:02:54Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3505", "html_url": "https://github.com/secdev/scapy/pull/3505", "diff_url": "https://github.com/secdev/scapy/pull/3505.diff", "patch_url": "https://github.com/secdev/scapy/pull/3505.patch", "merged_at": "2022-06-18T21:02:54Z"}, "body": "These changes fixes below issues:\r\n\r\n- Scapy shows wrong ts_position value and lacks field named \"timestamp unit\" of RadioTap.\r\n- Scapy shows inverted he_data values\r\n- Scapy can't process 802.11ax frames when Radiotap Layer has HE_MU field #3501 \r\n\r\n\r\nfixes #3501", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3505/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3505/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3503", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3503/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3503/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3503/events", "html_url": "https://github.com/secdev/scapy/pull/3503", "id": 1096935087, "node_id": "PR_kwDOApfmNs4wsF7r", "number": 3503, "title": "Fix High CPU Windows", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1265179855, "node_id": "MDU6TGFiZWwxMjY1MTc5ODU1", "url": "https://api.github.com/repos/secdev/scapy/labels/platform-specific", "name": "platform-specific", "color": "14acba", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 1, "created_at": "2022-01-08T13:58:09Z", "updated_at": "2022-03-29T11:24:02Z", "closed_at": "2022-01-09T09:47:34Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3503", "html_url": "https://github.com/secdev/scapy/pull/3503", "diff_url": "https://github.com/secdev/scapy/pull/3503.diff", "patch_url": "https://github.com/secdev/scapy/pull/3503.patch", "merged_at": "2022-01-09T09:47:33Z"}, "body": "- fixes https://github.com/secdev/scapy/issues/3482\r\n\r\nThis is a dumb issue, for some reason it slipped under my radar that on Windows, INFINITE was 0xFFFFFFFF instead of None like on linux.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3503/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3503/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3502", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3502/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3502/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3502/events", "html_url": "https://github.com/secdev/scapy/issues/3502", "id": 1096717361, "node_id": "I_kwDOApfmNs5BXpQx", "number": 3502, "title": "vendored six module raises ImportWarning with Python 3.10 and 3.11a3", "user": {"login": "grayjk", "id": 2437532, "node_id": "MDQ6VXNlcjI0Mzc1MzI=", "avatar_url": "https://avatars.githubusercontent.com/u/2437532?v=4", "gravatar_id": "", "url": "https://api.github.com/users/grayjk", "html_url": "https://github.com/grayjk", "followers_url": "https://api.github.com/users/grayjk/followers", "following_url": "https://api.github.com/users/grayjk/following{/other_user}", "gists_url": "https://api.github.com/users/grayjk/gists{/gist_id}", "starred_url": "https://api.github.com/users/grayjk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/grayjk/subscriptions", "organizations_url": "https://api.github.com/users/grayjk/orgs", "repos_url": "https://api.github.com/users/grayjk/repos", "events_url": "https://api.github.com/users/grayjk/events{/privacy}", "received_events_url": "https://api.github.com/users/grayjk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 971730999, "node_id": "MDU6TGFiZWw5NzE3MzA5OTk=", "url": "https://api.github.com/repos/secdev/scapy/labels/dependency-related", "name": "dependency-related", "color": "713be5", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 5, "created_at": "2022-01-07T22:29:28Z", "updated_at": "2023-04-14T07:36:03Z", "closed_at": "2022-03-28T19:06:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Brief description\r\n\r\nIn Python 3.10 and 3.11a3, importing from scapy raises an ImportWarning:\r\n```\r\n$ python3.11 -W default\r\nPython 3.11.0a3 (main, Jan  6 2022, 09:16:02) [GCC 7.5.0] on linux\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> from scapy import base_classes\r\n<frozen importlib._bootstrap>:1049: ImportWarning: _SixMetaPathImporter.find_spec() not found; falling back to find_module()\r\n<frozen importlib._bootstrap>:673: ImportWarning: _SixMetaPathImporter.exec_module() not found; falling back to load_module()\r\n```\r\n\r\nThe version of six (scapy/modules/six.py) in scapy is 1.10.0 which is missing implementations of find_spec and exec_module.\r\n\r\nThe fall back methods were deprecated beginning in Python 3.10: https://docs.python.org/3.10/whatsnew/3.10.html#deprecated\r\n\r\nsix version 1.16.0 includes the missing methods.\r\n\r\n### Scapy version\r\n\r\n2.4.5\r\n\r\n### Python version\r\n\r\n3.11a3\r\n\r\n### Operating system\r\n\r\nUbuntu 18.04\r\n\r\n### Additional environment information\r\n\r\n_No response_\r\n\r\n### How to reproduce\r\n\r\n```\r\n$ python3.11 -W default\r\nPython 3.11.0a3 (main, Jan  6 2022, 09:16:02) [GCC 7.5.0] on linux\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> from scapy import base_classes\r\n<frozen importlib._bootstrap>:1049: ImportWarning: _SixMetaPathImporter.find_spec() not found; falling back to find_module()\r\n<frozen importlib._bootstrap>:673: ImportWarning: _SixMetaPathImporter.exec_module() not found; falling back to load_module()\r\n```\r\n\r\n### Actual result\r\n\r\n_No response_\r\n\r\n### Expected result\r\n\r\n_No response_\r\n\r\n### Related resources\r\n\r\n_No response_", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3502/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3502/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3427", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3427/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3427/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3427/events", "html_url": "https://github.com/secdev/scapy/pull/3427", "id": 1042011987, "node_id": "PR_kwDOApfmNs4t932Z", "number": 3427, "title": "inet6: Fix PseudoIPv6 uplen being only 16 bits", "user": {"login": "cdleonard", "id": 89484, "node_id": "MDQ6VXNlcjg5NDg0", "avatar_url": "https://avatars.githubusercontent.com/u/89484?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cdleonard", "html_url": "https://github.com/cdleonard", "followers_url": "https://api.github.com/users/cdleonard/followers", "following_url": "https://api.github.com/users/cdleonard/following{/other_user}", "gists_url": "https://api.github.com/users/cdleonard/gists{/gist_id}", "starred_url": "https://api.github.com/users/cdleonard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cdleonard/subscriptions", "organizations_url": "https://api.github.com/users/cdleonard/orgs", "repos_url": "https://api.github.com/users/cdleonard/repos", "events_url": "https://api.github.com/users/cdleonard/events{/privacy}", "received_events_url": "https://api.github.com/users/cdleonard/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 780561688, "node_id": "MDU6TGFiZWw3ODA1NjE2ODg=", "url": "https://api.github.com/repos/secdev/scapy/labels/needs%20testing", "name": "needs testing", "color": "fbca04", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 9, "created_at": "2021-11-02T08:23:02Z", "updated_at": "2022-03-29T11:25:01Z", "closed_at": "2021-11-27T10:19:21Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3427", "html_url": "https://github.com/secdev/scapy/pull/3427", "diff_url": "https://github.com/secdev/scapy/pull/3427.diff", "patch_url": "https://github.com/secdev/scapy/pull/3427.patch", "merged_at": "2021-11-27T10:19:21Z"}, "body": "According to RFC2460 the payload length in the ipv6 pseudoheader is 32bits. Nobody noticed so far likely because this is only used for computing 16-bit checksum. When computing alternative checksums this makes a difference.\r\n\r\nThis was found while working on TCP-MD5 and TCP-AO support, see #3358", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3427/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3427/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3386", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3386/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3386/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3386/events", "html_url": "https://github.com/secdev/scapy/pull/3386", "id": 1016474791, "node_id": "PR_kwDOApfmNs4stAxf", "number": 3386, "title": "Fix computation of answering machines functions", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 2, "created_at": "2021-10-05T15:33:13Z", "updated_at": "2022-03-29T11:24:54Z", "closed_at": "2021-10-11T10:28:07Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3386", "html_url": "https://github.com/secdev/scapy/pull/3386", "diff_url": "https://github.com/secdev/scapy/pull/3386.diff", "patch_url": "https://github.com/secdev/scapy/pull/3386.patch", "merged_at": "2021-10-11T10:28:07Z"}, "body": "Two things in this PR:\r\n- commands generated from answering machines (e.g. `dhcpd`) were not generated because of a misplaced metaclass\r\n- I took that opportunity to inject the signature of the parent's `parse_options` class. See the difference below in IPython\r\n\r\n  - **v2.4.5:**\r\n  ```\r\n  >>> dhcpd\r\n  <function scapy.ansmachine.ReferenceAM.__new__.<locals>.<lambda>(obj=<class 'scapy.layers.dhcp.DHCP_am'>, *args, **kargs)>\r\n  ```\r\n  \r\n  - This PR:\r\n  \r\n  ```\r\n  >>> dhcpd\r\n  <function scapy.ansmachine.dhcpd(self, pool=Net(\"192.168.1.128/25\"), network='192.168.1.0/24', gw='192.168.1.1', domain='localnet', renewal_time=60, lease_time=1800)>\r\n  ```", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3386/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3386/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3376", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3376/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3376/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3376/events", "html_url": "https://github.com/secdev/scapy/issues/3376", "id": 1009749857, "node_id": "I_kwDOApfmNs48L49h", "number": 3376, "title": "InvocationError on py39-bsd_root", "user": {"login": "polybassa", "id": 1676055, "node_id": "MDQ6VXNlcjE2NzYwNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1676055?v=4", "gravatar_id": "", "url": "https://api.github.com/users/polybassa", "html_url": "https://github.com/polybassa", "followers_url": "https://api.github.com/users/polybassa/followers", "following_url": "https://api.github.com/users/polybassa/following{/other_user}", "gists_url": "https://api.github.com/users/polybassa/gists{/gist_id}", "starred_url": "https://api.github.com/users/polybassa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/polybassa/subscriptions", "organizations_url": "https://api.github.com/users/polybassa/orgs", "repos_url": "https://api.github.com/users/polybassa/repos", "events_url": "https://api.github.com/users/polybassa/events{/privacy}", "received_events_url": "https://api.github.com/users/polybassa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 514033136, "node_id": "MDU6TGFiZWw1MTQwMzMxMzY=", "url": "https://api.github.com/repos/secdev/scapy/labels/tests", "name": "tests", "color": "0e8a16", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-09-28T13:23:17Z", "updated_at": "2022-06-25T13:58:35Z", "closed_at": "2022-06-25T13:58:35Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Brief description\n\nI've discovered InvocationErrors on py39-bsd_root CI machines. Here is an example:\r\nhttps://github.com/secdev/scapy/pull/3328/checks?check_run_id=3732737538#step:5:6150\r\n\n\n### Scapy version\n\ncurrent\n\n### Python version\n\n3.9\n\n### Operating system\n\nOS X\n\n### Additional environment information\n\n_No response_\n\n### How to reproduce\n\nThis bug seems sporadic\n\n### Actual result\n\n_No response_\n\n### Expected result\n\n_No response_\n\n### Related resources\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3376/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3376/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3366", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3366/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3366/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3366/events", "html_url": "https://github.com/secdev/scapy/pull/3366", "id": 993898279, "node_id": "MDExOlB1bGxSZXF1ZXN0NzMxOTcwMDQ4", "number": 3366, "title": "Fix p0f impersonation: MSS value too low", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 1, "created_at": "2021-09-11T18:10:53Z", "updated_at": "2022-03-29T11:27:02Z", "closed_at": "2021-09-11T20:42:00Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3366", "html_url": "https://github.com/secdev/scapy/pull/3366", "diff_url": "https://github.com/secdev/scapy/pull/3366.diff", "patch_url": "https://github.com/secdev/scapy/pull/3366.patch", "merged_at": "2021-09-11T20:42:00Z"}, "body": "The issue was that `p0f_impersonation` could set a MSS value too low (<100) that would afterwards get rejected\r\n\r\nfixes https://github.com/secdev/scapy/issues/3353\r\ncloses https://github.com/secdev/scapy/pull/3364", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3366/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3366/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3365", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3365/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3365/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3365/events", "html_url": "https://github.com/secdev/scapy/pull/3365", "id": 993495133, "node_id": "MDExOlB1bGxSZXF1ZXN0NzMxNjcyMTUx", "number": 3365, "title": "Fix do_copy() of class Field", "user": {"login": "waeva", "id": 74464394, "node_id": "MDQ6VXNlcjc0NDY0Mzk0", "avatar_url": "https://avatars.githubusercontent.com/u/74464394?v=4", "gravatar_id": "", "url": "https://api.github.com/users/waeva", "html_url": "https://github.com/waeva", "followers_url": "https://api.github.com/users/waeva/followers", "following_url": "https://api.github.com/users/waeva/following{/other_user}", "gists_url": "https://api.github.com/users/waeva/gists{/gist_id}", "starred_url": "https://api.github.com/users/waeva/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/waeva/subscriptions", "organizations_url": "https://api.github.com/users/waeva/orgs", "repos_url": "https://api.github.com/users/waeva/repos", "events_url": "https://api.github.com/users/waeva/events{/privacy}", "received_events_url": "https://api.github.com/users/waeva/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 3, "created_at": "2021-09-10T18:39:17Z", "updated_at": "2022-03-29T11:27:00Z", "closed_at": "2021-09-11T18:09:31Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3365", "html_url": "https://github.com/secdev/scapy/pull/3365", "diff_url": "https://github.com/secdev/scapy/pull/3365.diff", "patch_url": "https://github.com/secdev/scapy/pull/3365.patch", "merged_at": "2021-09-11T18:09:31Z"}, "body": "\r\n\r\n**Checklist:**\r\n\r\n-   [x] If you are new to Scapy: I have checked [CONTRIBUTING.md](https://github.com/secdev/scapy/blob/master/CONTRIBUTING.md) (esp. section submitting-pull-requests)\r\n-   [x] I squashed commits belonging together\r\n-   [x] I added unit tests or explained why they are not relevant\r\n-   [ ] I executed the regression tests for Python2 and Python3 (using `tox` or, `cd test && ./run_tests_py2, cd test && ./run_tests_py3`)\r\n-   [ ] If the PR is still not finished, please create a [Draft Pull Request](https://github.blog/2019-02-14-introducing-draft-pull-requests/)\r\n\r\n<!-- Fix PacketListField's copy() method runs differently in python2 and python3 -->\r\n\r\nfixes #3347 <!-- (add issue number here if appropriate, else remove this line) -->\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3365/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3365/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3363", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3363/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3363/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3363/events", "html_url": "https://github.com/secdev/scapy/pull/3363", "id": 989399179, "node_id": "MDExOlB1bGxSZXF1ZXN0NzI4MTQ4Njc4", "number": 3363, "title": "Loopback: fix & documentation", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 972547864, "node_id": "MDU6TGFiZWw5NzI1NDc4NjQ=", "url": "https://api.github.com/repos/secdev/scapy/labels/doc", "name": "doc", "color": "0e8a16", "default": false, "description": ""}, {"id": 1265179855, "node_id": "MDU6TGFiZWwxMjY1MTc5ODU1", "url": "https://api.github.com/repos/secdev/scapy/labels/platform-specific", "name": "platform-specific", "color": "14acba", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 3, "created_at": "2021-09-06T19:27:35Z", "updated_at": "2022-03-29T11:27:00Z", "closed_at": "2021-09-11T22:19:02Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3363", "html_url": "https://github.com/secdev/scapy/pull/3363", "diff_url": "https://github.com/secdev/scapy/pull/3363.diff", "patch_url": "https://github.com/secdev/scapy/pull/3363.patch", "merged_at": "2021-09-11T22:19:02Z"}, "body": "This PR fixes injecting IPv6 packets to the Windows loopback interface (#3357), and improves the documentation.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3363/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3363/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3357", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3357/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3357/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3357/events", "html_url": "https://github.com/secdev/scapy/issues/3357", "id": 983415106, "node_id": "MDU6SXNzdWU5ODM0MTUxMDY=", "number": 3357, "title": "Cannot send IPv6 packet to loopback", "user": {"login": "lewis1ee", "id": 12009842, "node_id": "MDQ6VXNlcjEyMDA5ODQy", "avatar_url": "https://avatars.githubusercontent.com/u/12009842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lewis1ee", "html_url": "https://github.com/lewis1ee", "followers_url": "https://api.github.com/users/lewis1ee/followers", "following_url": "https://api.github.com/users/lewis1ee/following{/other_user}", "gists_url": "https://api.github.com/users/lewis1ee/gists{/gist_id}", "starred_url": "https://api.github.com/users/lewis1ee/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lewis1ee/subscriptions", "organizations_url": "https://api.github.com/users/lewis1ee/orgs", "repos_url": "https://api.github.com/users/lewis1ee/repos", "events_url": "https://api.github.com/users/lewis1ee/events{/privacy}", "received_events_url": "https://api.github.com/users/lewis1ee/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1265179855, "node_id": "MDU6TGFiZWwxMjY1MTc5ODU1", "url": "https://api.github.com/repos/secdev/scapy/labels/platform-specific", "name": "platform-specific", "color": "14acba", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2021-08-31T04:02:28Z", "updated_at": "2021-09-12T05:56:14Z", "closed_at": "2021-09-12T05:56:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Brief description\n\nI successfully send packet to loopback using IPv4 and see it in wireshark.\r\nbut I failed to reproduce it using IPv6.\r\nPing to \"::1\" success.\n\n### Scapy version\n\n2.4.5\n\n### Python version\n\n3.9.1\n\n### Operating system\n\nWindows 10 x64 20H2\n\n### Additional environment information\n\n>>> conf.route6\r\nDestination                    Next Hop  Iface                                       Src candidates             Metric\r\n::1/128                        ::        Software Loopback Interface 1               ::1                        331\r\nfe80::/64                      ::        Realtek PCIe GbE Family Controller          fe80::d151:508b:32c5:ca77  261\r\nfe80::/64                      ::        Realtek PCIe GbE Family Controller #2       fe80::811d:90f6:b77e:910a  261\r\nfe80::/64                      ::        Bluetooth Device (Personal Area Network)    fe80::444b:1fc1:52f4:179e  321\r\nfe80::/64                      ::        Intel(R) Wi-Fi 6 AX200 160MHz               fe80::5457:6869:6276:8d77  301\r\nfe80::/64                      ::        VMware Virtual Ethernet Adapter for VMnet1  fe80::5dbc:cb5d:28:89bc    291\r\nfe80::/64                      ::        VMware Virtual Ethernet Adapter for VMnet8  fe80::fcf1:50ae:cadc:b72d  291\r\nfe80::/64                      ::        Microsoft Wi-Fi Direct Virtual Adapter      fe80::cd7c:1ac:7cb4:8875   281\r\nfe80::/64                      ::        Microsoft Wi-Fi Direct Virtual Adapter #2   fe80::cceb:b6a6:b303:5195  281\r\nfe80::444b:1fc1:52f4:179e/128  ::        Bluetooth Device (Personal Area Network)    fe80::444b:1fc1:52f4:179e  321\r\nfe80::5457:6869:6276:8d77/128  ::        Intel(R) Wi-Fi 6 AX200 160MHz               fe80::5457:6869:6276:8d77  301\r\nfe80::5dbc:cb5d:28:89bc/128    ::        VMware Virtual Ethernet Adapter for VMnet1  fe80::5dbc:cb5d:28:89bc    291\r\nfe80::811d:90f6:b77e:910a/128  ::        Realtek PCIe GbE Family Controller #2       fe80::811d:90f6:b77e:910a  261\r\nfe80::cceb:b6a6:b303:5195/128  ::        Microsoft Wi-Fi Direct Virtual Adapter #2   fe80::cceb:b6a6:b303:5195  281\r\nfe80::cd7c:1ac:7cb4:8875/128   ::        Microsoft Wi-Fi Direct Virtual Adapter      fe80::cd7c:1ac:7cb4:8875   281\r\nfe80::d151:508b:32c5:ca77/128  ::        Realtek PCIe GbE Family Controller          fe80::d151:508b:32c5:ca77  261\r\nfe80::fcf1:50ae:cadc:b72d/128  ::        VMware Virtual Ethernet Adapter for VMnet8  fe80::fcf1:50ae:cadc:b72d  291\r\nff00::/8                       ::        Software Loopback Interface 1               ::1                        331\r\n\r\n>>> conf.ifaces\r\nSource   Index  Name                                        MAC                IPv4             IPv6\r\nlibpcap  1      Software Loopback Interface 1               00:00:00:00:00:00  127.0.0.1        ::1\r\nlibpcap  11     Realtek PCIe GbE Family Controller #2       LCFCHeFe:73:d7:52  169.254.145.10   fe80::811d:90f6:b77e:910a\r\n                                                                               192.168.23.146\r\nlibpcap  12     VMware Virtual Ethernet Adapter for VMnet1  VMware:c0:00:01    192.168.204.1    fe80::5dbc:cb5d:28:89bc\r\nlibpcap  14     WAN Miniport (IPv6)\r\nlibpcap  18     Microsoft Wi-Fi Direct Virtual Adapter      IntelCor:30:e8:8d  169.254.136.117  fe80::cd7c:1ac:7cb4:8875\r\nlibpcap  20     VMware Virtual Ethernet Adapter for VMnet8  VMware:c0:00:08    192.168.11.1     fe80::fcf1:50ae:cadc:b72d\r\nlibpcap  21     Intel(R) Wi-Fi 6 AX200 160MHz               IntelCor:30:e8:8c  10.33.94.44      fe80::5457:6869:6276:8d77\r\nlibpcap  4      Realtek PCIe GbE Family Controller          LCFCHeFe:73:d7:53  169.254.202.119  fe80::d151:508b:32c5:ca77\r\nlibpcap  5      Microsoft Wi-Fi Direct Virtual Adapter #2   ca:e2:65:30:e8:8c  169.254.81.149   fe80::cceb:b6a6:b303:5195\r\nlibpcap  6      Bluetooth Device (Personal Area Network)    IntelCor:30:e8:90  169.254.23.158   fe80::444b:1fc1:52f4:179e\r\nlibpcap  7      WAN Miniport (IP)\r\nlibpcap  9      WAN Miniport (Network Monitor)\n\n### How to reproduce\n\nIPv6 send loopback code[FAILED]:\r\n```\r\nfrom scapy.all import *\r\n\r\niface = \"Software Loopback Interface 1\"\r\n\r\np = IPv6() / (b\"a\" * 0x10)\r\n\r\np.show()\r\n\"\"\"\r\n###[ IPv6 ]###\r\n  version   = 6\r\n  tc        = 0\r\n  fl        = 0\r\n  plen      = None\r\n  nh        = No Next Header\r\n  hlim      = 64\r\n  src       = ::1\r\n  dst       = ::1\r\n###[ Raw ]###\r\n     load      = 'aaaaaaaaaaaaaaaa'\r\n\"\"\"\r\n\r\nsend(p, iface=iface)\r\n```\r\n\r\nIPv4 send loopback code[SUCCESS]:\r\n```\r\nfrom scapy.all import *\r\n\r\np = IP() / (b\"a\" * 0x10)\r\nsend(p)\r\n```\r\n\n\n### Actual result\n\npacket not found in wireshark\n\n### Expected result\n\npacket found in wireshark\n\n### Related resources\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3357/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3357/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3349", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3349/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3349/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3349/events", "html_url": "https://github.com/secdev/scapy/pull/3349", "id": 982131371, "node_id": "MDExOlB1bGxSZXF1ZXN0NzIxOTczMTIx", "number": 3349, "title": "BGP: support additional path & fix dissection bug", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 1, "created_at": "2021-08-29T15:39:18Z", "updated_at": "2022-03-29T11:26:57Z", "closed_at": "2021-09-19T14:31:57Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3349", "html_url": "https://github.com/secdev/scapy/pull/3349", "diff_url": "https://github.com/secdev/scapy/pull/3349.diff", "patch_url": "https://github.com/secdev/scapy/pull/3349.patch", "merged_at": "2021-09-19T14:31:56Z"}, "body": "- fix https://github.com/secdev/scapy/issues/3345\r\n  - dissection loop (could cause DoS but it's not that critical considering BGP is NOT enabled by default)\r\n  - support for BGP's \"additional path\" extension. This was implemented using Wireshark's heuristic\r\n- fix a minor `sprintf` bug: it actually didn't call `i2repr(i)` but `i2repr(i2h(i))`. This is not an non-issue in almost every case except a few (BGP field)", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3349/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3349/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3348", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3348/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3348/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3348/events", "html_url": "https://github.com/secdev/scapy/pull/3348", "id": 982070675, "node_id": "MDExOlB1bGxSZXF1ZXN0NzIxOTMyNTU2", "number": 3348, "title": "Fix FFDH for scapy", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1317786288, "node_id": "MDU6TGFiZWwxMzE3Nzg2Mjg4", "url": "https://api.github.com/repos/secdev/scapy/labels/tls", "name": "tls", "color": "56088e", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 1, "created_at": "2021-08-29T11:12:20Z", "updated_at": "2022-05-18T12:57:50Z", "closed_at": "2021-09-02T15:15:00Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3348", "html_url": "https://github.com/secdev/scapy/pull/3348", "diff_url": "https://github.com/secdev/scapy/pull/3348.diff", "patch_url": "https://github.com/secdev/scapy/pull/3348.patch", "merged_at": "2021-09-02T15:15:00Z"}, "body": "- This PR is https://github.com/secdev/scapy/pull/3343 but better. I had actually started working on this a while back, notably:\r\n  - supports Python 2\r\n  - supports building\r\n  - add test\r\n- closes https://github.com/secdev/scapy/pull/3343\r\n- fixes https://github.com/secdev/scapy/issues/3324", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3348/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3348/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3347", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3347/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3347/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3347/events", "html_url": "https://github.com/secdev/scapy/issues/3347", "id": 981833841, "node_id": "MDU6SXNzdWU5ODE4MzM4NDE=", "number": 3347, "title": "After fuzzing the copied packet, the original packet is also modified", "user": {"login": "waeva", "id": 74464394, "node_id": "MDQ6VXNlcjc0NDY0Mzk0", "avatar_url": "https://avatars.githubusercontent.com/u/74464394?v=4", "gravatar_id": "", "url": "https://api.github.com/users/waeva", "html_url": "https://github.com/waeva", "followers_url": "https://api.github.com/users/waeva/followers", "following_url": "https://api.github.com/users/waeva/following{/other_user}", "gists_url": "https://api.github.com/users/waeva/gists{/gist_id}", "starred_url": "https://api.github.com/users/waeva/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/waeva/subscriptions", "organizations_url": "https://api.github.com/users/waeva/orgs", "repos_url": "https://api.github.com/users/waeva/repos", "events_url": "https://api.github.com/users/waeva/events{/privacy}", "received_events_url": "https://api.github.com/users/waeva/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-08-28T13:22:31Z", "updated_at": "2021-09-11T18:09:31Z", "closed_at": "2021-09-11T18:09:31Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Brief description\r\nhere's my code\r\n```\r\nfrom scapy.all import *\r\n\r\nclass TEST2(Packet):\r\n    name = \"TEST2\"\r\n    fields_desc = [\r\n        ByteField(\"type2\", 0x1),\r\n    ]\r\n    \r\nclass TEST(Packet):\r\n    name = \"TEST\"\r\n    fields_desc = [\r\n        PacketListField(\"packlist\", TEST2(), TEST2),\r\n    ]\r\n    \r\nd1 = TEST()\r\nd2 = d1.copy()\r\n\r\nhexdump(d1)\r\nfuzz(d2)\r\nhexdump(d1)\r\n```\r\nThe running results are different in python2 and python3.\r\nIn python3, after fuzzing d2 packet, d1 is modified.\r\n```\r\nusr@test:~/WorkSpace$ python3 test.py \r\n0000  01                                               .\r\n0000  8A                                               .\r\n```\r\nIn python2, after fuzzing d2 packet, d1 has not been modified.\r\n```\r\nusr@test:~/WorkSpace$ python2 test.py \r\n0000  01                                               .\r\n0000  01                                               .\r\n```\r\nFor PacketListField, the results of the copy() method running with python2 and python3 seem to be different.\r\nI found the definition of do_copy() in fields.py\r\n```\r\ndef do_copy(self, x):\r\n    # type: (I) -> I\r\n    if hasattr(x, \"copy\"):\r\n        return x.copy()  # type: ignore\r\n    if isinstance(x, list):\r\n        x = x[:]  # type: ignore\r\n        for i in range(len(x)):\r\n            if isinstance(x[i], BasePacket):\r\n                x[i] = x[i].copy()\r\n    return x\r\n```\r\nIn python3, the list data type has a copy attribute, ```hasattr(list, \"copy\") ```returns true.\r\n```\r\nusr@test:~/WorkSpace$ python3\r\nPython 3.8.10 (default, Jun  2 2021, 10:49:15)\r\n[GCC 9.4.0] on linux\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> list = []\r\n>>> hasattr(list, \"copy\")\r\nTrue\r\n>>>\r\n```\r\nIn python2, the list data type has no copy attribute, ```hasattr(list, \"copy\") ```returns false.\r\n```\r\nusr@test:~/WorkSpace$ python2\r\nPython 2.7.12 (default, Mar  1 2021, 11:38:31) \r\n[GCC 9.4.0] on linux\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> list = []\r\n>>> hasattr(list, \"copy\")\r\nFalse\r\n>>>\r\n```\r\nso I guess this is the reason why copy() method runs differently in python2 and python3.\r\n\r\n### Scapy version\r\n\r\n2.4.5\r\n\r\n### Python version\r\n\r\n3.8\r\n\r\n### Operating system\r\n\r\nUbuntu 20.04\r\n\r\n### Additional environment information\r\n\r\n_No response_\r\n\r\n### How to reproduce\r\n\r\nsee brief description\r\n\r\n### Actual result\r\n\r\nAfter fuzzing the copied packet, the original packet is modified.\r\n\r\n### Expected result\r\n\r\nAfter fuzzing the copied packet, the original packet has not been modified.\r\n\r\n### Related resources\r\n\r\n_No response_", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3347/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3347/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3345", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3345/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3345/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3345/events", "html_url": "https://github.com/secdev/scapy/issues/3345", "id": 981364296, "node_id": "MDU6SXNzdWU5ODEzNjQyOTY=", "number": 3345, "title": "Scapy blocks on parsing BGP pcap", "user": {"login": "jschwinger233", "id": 6435624, "node_id": "MDQ6VXNlcjY0MzU2MjQ=", "avatar_url": "https://avatars.githubusercontent.com/u/6435624?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jschwinger233", "html_url": "https://github.com/jschwinger233", "followers_url": "https://api.github.com/users/jschwinger233/followers", "following_url": "https://api.github.com/users/jschwinger233/following{/other_user}", "gists_url": "https://api.github.com/users/jschwinger233/gists{/gist_id}", "starred_url": "https://api.github.com/users/jschwinger233/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jschwinger233/subscriptions", "organizations_url": "https://api.github.com/users/jschwinger233/orgs", "repos_url": "https://api.github.com/users/jschwinger233/repos", "events_url": "https://api.github.com/users/jschwinger233/events{/privacy}", "received_events_url": "https://api.github.com/users/jschwinger233/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-08-27T15:33:09Z", "updated_at": "2021-09-19T14:31:56Z", "closed_at": "2021-09-19T14:31:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Brief description\r\n\r\nScapy hangs after `rdpcap('bgp.pcap')`, please download the pcap via [link](https://gist.github.com/jschwinger23/8a4cf4b13047b8b6086576413f1a60d5/raw/c51ac8e316c34b3b210f2e4965e4fa12c1ca7e78/bgp.pcap)\r\n\r\n### Scapy version\r\n\r\n2.4.5rc1.dev89\r\n\r\n### Python version\r\n\r\n3.8.10\r\n\r\n### Operating system\r\n\r\nLinux 5.8.0-50-generic\r\n\r\n### Additional environment information\r\n\r\n_No response_\r\n\r\n### How to reproduce\r\n\r\n1. prepare the [pcap file](https://gist.github.com/jschwinger23/8a4cf4b13047b8b6086576413f1a60d5/raw/c51ac8e316c34b3b210f2e4965e4fa12c1ca7e78/bgp.pcap): `curl -OL https://gist.github.com/jschwinger23/8a4cf4b13047b8b6086576413f1a60d5/raw/c51ac8e316c34b3b210f2e4965e4fa12c1ca7e78/bgp.pcap`\r\n2. run scapy\r\n3. type `load_contrib('bgp')` and `p = rdpcap('bgp.pcap')`, then it runs forever.\r\n\r\n### Actual result\r\n\r\nIf I press `Ctrl-C` to interrupt, the stack frames are\r\n```\r\n>>> load_contrib('bgp')\r\nWARNING: [bgp.py] use_2_bytes_asn: True\r\n>>> p = rdpcap('bgp.pcap')\r\n^C---------------------------------------------------------------------------\r\nKeyboardInterrupt                         Traceback (most recent call last)\r\n<ipython-input-2-3f100d0bd1c5> in <module>\r\n----> 1 p = rdpcap('bgp.pcap')\r\n\r\n~/.local/lib/python3.8/site-packages/scapy/utils.py in rdpcap(filename, count)\r\n   1115     # layout that will actually be supported and properly dissected.\r\n   1116     with PcapReader(filename) as fdesc:  # type: ignore\r\n-> 1117         return fdesc.read_all(count=count)\r\n   1118 \r\n   1119 \r\n\r\n~/.local/lib/python3.8/site-packages/scapy/utils.py in read_all(self, count)\r\n   1383     def read_all(self, count=-1):\r\n   1384         # type: (int) -> PacketList\r\n-> 1385         res = self._read_all(count)\r\n   1386         from scapy import plist\r\n   1387         return plist.PacketList(res, name=os.path.basename(self.filename))\r\n\r\n~/.local/lib/python3.8/site-packages/scapy/utils.py in _read_all(self, count)\r\n   1293             count -= 1\r\n   1294             try:\r\n-> 1295                 p = self.read_packet()  # type: Packet\r\n   1296             except EOFError:\r\n   1297                 break\r\n\r\n~/.local/lib/python3.8/site-packages/scapy/utils.py in read_packet(self, size)\r\n   1629         try:\r\n   1630             cls = conf.l2types.num2layer[linktype]  # type: Type[Packet]\r\n-> 1631             p = cls(s)  # type: Packet\r\n   1632         except KeyboardInterrupt:\r\n   1633             raise\r\n\r\n~/.local/lib/python3.8/site-packages/scapy/base_classes.py in __call__(cls, *args, **kargs)\r\n    387             cls.__dict__\r\n    388         )\r\n--> 389         i.__init__(*args, **kargs)\r\n    390         return i  # type: ignore\r\n    391 \r\n\r\n~/.local/lib/python3.8/site-packages/scapy/packet.py in __init__(self, _pkt, post_transform, _internal, _underlayer, **fields)\r\n    157         self.sniffed_on = None  # type: Optional[_GlobInterfaceType]\r\n    158         if _pkt:\r\n--> 159             self.dissect(_pkt)\r\n    160             if not _internal:\r\n    161                 self.dissection_done(self)\r\n\r\n~/.local/lib/python3.8/site-packages/scapy/packet.py in dissect(self, s)\r\n    997 \r\n    998         payl, pad = self.extract_padding(s)\r\n--> 999         self.do_dissect_payload(payl)\r\n   1000         if pad and conf.padding:\r\n   1001             self.add_payload(conf.padding_layer(pad))\r\n\r\n~/.local/lib/python3.8/site-packages/scapy/packet.py in do_dissect_payload(self, s)\r\n    972             cls = self.guess_payload_class(s)\r\n    973             try:\r\n--> 974                 p = cls(s, _internal=1, _underlayer=self)\r\n    975             except KeyboardInterrupt:\r\n    976                 raise\r\n\r\n~/.local/lib/python3.8/site-packages/scapy/base_classes.py in __call__(cls, *args, **kargs)\r\n    387             cls.__dict__\r\n    388         )\r\n--> 389         i.__init__(*args, **kargs)\r\n    390         return i  # type: ignore\r\n    391 \r\n\r\n~/.local/lib/python3.8/site-packages/scapy/packet.py in __init__(self, _pkt, post_transform, _internal, _underlayer, **fields)\r\n    157         self.sniffed_on = None  # type: Optional[_GlobInterfaceType]\r\n    158         if _pkt:\r\n--> 159             self.dissect(_pkt)\r\n    160             if not _internal:\r\n    161                 self.dissection_done(self)\r\n\r\n~/.local/lib/python3.8/site-packages/scapy/packet.py in dissect(self, s)\r\n    997 \r\n    998         payl, pad = self.extract_padding(s)\r\n--> 999         self.do_dissect_payload(payl)\r\n   1000         if pad and conf.padding:\r\n   1001             self.add_payload(conf.padding_layer(pad))\r\n\r\n~/.local/lib/python3.8/site-packages/scapy/packet.py in do_dissect_payload(self, s)\r\n    972             cls = self.guess_payload_class(s)\r\n    973             try:\r\n--> 974                 p = cls(s, _internal=1, _underlayer=self)\r\n    975             except KeyboardInterrupt:\r\n    976                 raise\r\n\r\n~/.local/lib/python3.8/site-packages/scapy/base_classes.py in __call__(cls, *args, **kargs)\r\n    387             cls.__dict__\r\n    388         )\r\n--> 389         i.__init__(*args, **kargs)\r\n    390         return i  # type: ignore\r\n    391 \r\n\r\n~/.local/lib/python3.8/site-packages/scapy/packet.py in __init__(self, _pkt, post_transform, _internal, _underlayer, **fields)\r\n    157         self.sniffed_on = None  # type: Optional[_GlobInterfaceType]\r\n    158         if _pkt:\r\n--> 159             self.dissect(_pkt)\r\n    160             if not _internal:\r\n    161                 self.dissection_done(self)\r\n\r\n~/.local/lib/python3.8/site-packages/scapy/packet.py in dissect(self, s)\r\n    997 \r\n    998         payl, pad = self.extract_padding(s)\r\n--> 999         self.do_dissect_payload(payl)\r\n   1000         if pad and conf.padding:\r\n   1001             self.add_payload(conf.padding_layer(pad))\r\n\r\n~/.local/lib/python3.8/site-packages/scapy/packet.py in do_dissect_payload(self, s)\r\n    972             cls = self.guess_payload_class(s)\r\n    973             try:\r\n--> 974                 p = cls(s, _internal=1, _underlayer=self)\r\n    975             except KeyboardInterrupt:\r\n    976                 raise\r\n\r\n~/.local/lib/python3.8/site-packages/scapy/base_classes.py in __call__(cls, *args, **kargs)\r\n    387             cls.__dict__\r\n    388         )\r\n--> 389         i.__init__(*args, **kargs)\r\n    390         return i  # type: ignore\r\n    391 \r\n\r\n~/.local/lib/python3.8/site-packages/scapy/packet.py in __init__(self, _pkt, post_transform, _internal, _underlayer, **fields)\r\n    157         self.sniffed_on = None  # type: Optional[_GlobInterfaceType]\r\n    158         if _pkt:\r\n--> 159             self.dissect(_pkt)\r\n    160             if not _internal:\r\n    161                 self.dissection_done(self)\r\n\r\n~/.local/lib/python3.8/site-packages/scapy/packet.py in dissect(self, s)\r\n    997 \r\n    998         payl, pad = self.extract_padding(s)\r\n--> 999         self.do_dissect_payload(payl)\r\n   1000         if pad and conf.padding:\r\n   1001             self.add_payload(conf.padding_layer(pad))\r\n\r\n~/.local/lib/python3.8/site-packages/scapy/packet.py in do_dissect_payload(self, s)\r\n    972             cls = self.guess_payload_class(s)\r\n    973             try:\r\n--> 974                 p = cls(s, _internal=1, _underlayer=self)\r\n    975             except KeyboardInterrupt:\r\n    976                 raise\r\n\r\n~/.local/lib/python3.8/site-packages/scapy/base_classes.py in __call__(cls, *args, **kargs)\r\n    387             cls.__dict__\r\n    388         )\r\n--> 389         i.__init__(*args, **kargs)\r\n    390         return i  # type: ignore\r\n    391 \r\n\r\n~/.local/lib/python3.8/site-packages/scapy/packet.py in __init__(self, _pkt, post_transform, _internal, _underlayer, **fields)\r\n    157         self.sniffed_on = None  # type: Optional[_GlobInterfaceType]\r\n    158         if _pkt:\r\n--> 159             self.dissect(_pkt)\r\n    160             if not _internal:\r\n    161                 self.dissection_done(self)\r\n\r\n~/.local/lib/python3.8/site-packages/scapy/packet.py in dissect(self, s)\r\n    992         s = self.pre_dissect(s)\r\n    993 \r\n--> 994         s = self.do_dissect(s)\r\n    995 \r\n    996         s = self.post_dissect(s)\r\n\r\n~/.local/lib/python3.8/site-packages/scapy/packet.py in do_dissect(self, s)\r\n    949             if not s:\r\n    950                 break\r\n--> 951             s, fval = f.getfield(self, s)\r\n    952             # Skip unused ConditionalField\r\n    953             if isinstance(f, ConditionalField) and fval is None:\r\n\r\n~/.local/lib/python3.8/site-packages/scapy/fields.py in getfield(self, pkt, s)\r\n   1417                  ):\r\n   1418         # type: (...) -> Tuple[bytes, K]\r\n-> 1419         i = self.m2i(pkt, s)\r\n   1420         remain = b\"\"\r\n   1421         if conf.padding_layer in i:\r\n\r\n~/.local/lib/python3.8/site-packages/scapy/fields.py in m2i(self, pkt, m)\r\n   1410     def m2i(self, pkt, m):\r\n   1411         # type: (Optional[Packet], bytes) -> Packet\r\n-> 1412         return self.cls(m)\r\n   1413 \r\n   1414     def getfield(self,\r\n\r\n~/.local/lib/python3.8/site-packages/scapy/base_classes.py in __call__(cls, *args, **kargs)\r\n    387             cls.__dict__\r\n    388         )\r\n--> 389         i.__init__(*args, **kargs)\r\n    390         return i  # type: ignore\r\n    391 \r\n\r\n~/.local/lib/python3.8/site-packages/scapy/packet.py in __init__(self, _pkt, post_transform, _internal, _underlayer, **fields)\r\n    157         self.sniffed_on = None  # type: Optional[_GlobInterfaceType]\r\n    158         if _pkt:\r\n--> 159             self.dissect(_pkt)\r\n    160             if not _internal:\r\n    161                 self.dissection_done(self)\r\n\r\n~/.local/lib/python3.8/site-packages/scapy/packet.py in dissect(self, s)\r\n    992         s = self.pre_dissect(s)\r\n    993 \r\n--> 994         s = self.do_dissect(s)\r\n    995 \r\n    996         s = self.post_dissect(s)\r\n\r\n~/.local/lib/python3.8/site-packages/scapy/packet.py in do_dissect(self, s)\r\n    949             if not s:\r\n    950                 break\r\n--> 951             s, fval = f.getfield(self, s)\r\n    952             # Skip unused ConditionalField\r\n    953             if isinstance(f, ConditionalField) and fval is None:\r\n\r\n~/.local/lib/python3.8/site-packages/scapy/contrib/bgp.py in getfield(self, pkt, s)\r\n   2463             current = remain[:orf_len]\r\n   2464             remain = remain[orf_len:]\r\n-> 2465             packet = self.m2i(pkt, current)\r\n   2466             lst.append(packet)\r\n   2467 \r\n\r\n~/.local/lib/python3.8/site-packages/scapy/contrib/bgp.py in m2i(self, pkt, m)\r\n   2406 \r\n   2407         else:\r\n-> 2408             ret = conf.raw_layer(m)\r\n   2409 \r\n   2410         return ret\r\n\r\n~/.local/lib/python3.8/site-packages/scapy/base_classes.py in __call__(cls, *args, **kargs)\r\n    387             cls.__dict__\r\n    388         )\r\n--> 389         i.__init__(*args, **kargs)\r\n    390         return i  # type: ignore\r\n    391 \r\n\r\n~/.local/lib/python3.8/site-packages/scapy/packet.py in __init__(self, _pkt, *args, **kwargs)\r\n   1923         if _pkt and not isinstance(_pkt, bytes):\r\n   1924             _pkt = bytes_encode(_pkt)\r\n-> 1925         super(Raw, self).__init__(_pkt, *args, **kwargs)\r\n   1926 \r\n   1927     def answers(self, other):\r\n\r\n~/.local/lib/python3.8/site-packages/scapy/packet.py in __init__(self, _pkt, post_transform, _internal, _underlayer, **fields)\r\n    146         self.fieldtype = {}  # type: Dict[str, AnyField]\r\n    147         self.packetfields = []  # type: List[AnyField]\r\n--> 148         self.payload = NoPayload()\r\n    149         self.init_fields()\r\n    150         self.underlayer = _underlayer\r\n\r\n~/.local/lib/python3.8/site-packages/scapy/packet.py in __setattr__(self, attr, val)\r\n    459             if attr == \"sent_time\":\r\n    460                 self.update_sent_time(val)\r\n--> 461             return object.__setattr__(self, attr, val)\r\n    462         try:\r\n    463             return self.setfieldval(attr, val)\r\n\r\nKeyboardInterrupt: \r\n>>>                                                           \r\n```\r\n\r\n### Expected result\r\n\r\nThe pcap actually can be parsed by tshark, and here's the result:\r\n\r\n```shell\r\n$ tshark -r bgp.pcap -V\r\nFrame 1: 361 bytes on wire (2888 bits), 361 bytes captured (2888 bits) on interface unknown, id 0\r\n    Interface id: 0 (unknown)\r\n        Interface name: unknown\r\n    Encapsulation type: Ethernet (1)\r\n    Arrival Time: Aug 22, 2021 18:55:17.463930000 +08\r\n    [Time shift for this packet: 0.000000000 seconds]\r\n    Epoch Time: 1629629717.463930000 seconds\r\n    [Time delta from previous captured frame: 0.000000000 seconds]\r\n    [Time delta from previous displayed frame: 0.000000000 seconds]\r\n    [Time since reference or first frame: 0.000000000 seconds]\r\n    Frame Number: 1\r\n    Frame Length: 361 bytes (2888 bits)\r\n    Capture Length: 361 bytes (2888 bits)\r\n    [Frame is marked: False]\r\n    [Frame is ignored: False]\r\n    [Protocols in frame: eth:ethertype:ip:tcp:bgp]\r\nEthernet II, Src: HuaweiTe_8b:cf:90 (f8:6e:ee:8b:cf:90), Dst: HuaweiTe_d9:8d:4c (cc:bb:fe:d9:8d:4c)\r\n    Destination: HuaweiTe_d9:8d:4c (cc:bb:fe:d9:8d:4c)\r\n        Address: HuaweiTe_d9:8d:4c (cc:bb:fe:d9:8d:4c)\r\n        .... ..0. .... .... .... .... = LG bit: Globally unique address (factory default)\r\n        .... ...0 .... .... .... .... = IG bit: Individual address (unicast)\r\n    Source: HuaweiTe_8b:cf:90 (f8:6e:ee:8b:cf:90)\r\n        Address: HuaweiTe_8b:cf:90 (f8:6e:ee:8b:cf:90)\r\n        .... ..0. .... .... .... .... = LG bit: Globally unique address (factory default)\r\n        .... ...0 .... .... .... .... = IG bit: Individual address (unicast)\r\n    Type: IPv4 (0x0800)\r\nInternet Protocol Version 4, Src: 10.22.12.88, Dst: 10.22.12.44\r\n    0100 .... = Version: 4\r\n    .... 0101 = Header Length: 20 bytes (5)\r\n    Differentiated Services Field: 0xc0 (DSCP: CS6, ECN: Not-ECT)\r\n        1100 00.. = Differentiated Services Codepoint: Class Selector 6 (48)\r\n        .... ..00 = Explicit Congestion Notification: Not ECN-Capable Transport (0)\r\n    Total Length: 347\r\n    Identification: 0x6688 (26248)\r\n    Flags: 0x4000, Don't fragment\r\n        0... .... .... .... = Reserved bit: Not set\r\n        .1.. .... .... .... = Don't fragment: Set\r\n        ..0. .... .... .... = More fragments: Not set\r\n    Fragment offset: 0\r\n    Time to live: 64\r\n    Protocol: TCP (6)\r\n    Header checksum: 0xa5a5 [validation disabled]\r\n    [Header checksum status: Unverified]\r\n    Source: 10.22.12.88\r\n    Destination: 10.22.12.44\r\nTransmission Control Protocol, Src Port: 47689, Dst Port: 179, Seq: 1, Ack: 1, Len: 307\r\n    Source Port: 47689\r\n    Destination Port: 179\r\n    [Stream index: 0]\r\n    [TCP Segment Len: 307]\r\n    Sequence number: 1    (relative sequence number)\r\n    Sequence number (raw): 2001537567\r\n    [Next sequence number: 308    (relative sequence number)]\r\n    Acknowledgment number: 1    (relative ack number)\r\n    Acknowledgment number (raw): 438819095\r\n    0101 .... = Header Length: 20 bytes (5)\r\n    Flags: 0x018 (PSH, ACK)\r\n        000. .... .... = Reserved: Not set\r\n        ...0 .... .... = Nonce: Not set\r\n        .... 0... .... = Congestion Window Reduced (CWR): Not set\r\n        .... .0.. .... = ECN-Echo: Not set\r\n        .... ..0. .... = Urgent: Not set\r\n        .... ...1 .... = Acknowledgment: Set\r\n        .... .... 1... = Push: Set\r\n        .... .... .0.. = Reset: Not set\r\n        .... .... ..0. = Syn: Not set\r\n        .... .... ...0 = Fin: Not set\r\n        [TCP Flags: \u00b7\u00b7\u00b7\u00b7\u00b7\u00b7\u00b7AP\u00b7\u00b7\u00b7]\r\n    Window size value: 237\r\n    [Calculated window size: 237]\r\n    [Window size scaling factor: -1 (unknown)]\r\n    Checksum: 0xd946 [unverified]\r\n    [Checksum Status: Unverified]\r\n    Urgent pointer: 0\r\n    [SEQ/ACK analysis]\r\n        [Bytes in flight: 307]\r\n        [Bytes sent since last PSH flag: 307]\r\n    [Timestamps]\r\n        [Time since first frame in this TCP stream: 0.000000000 seconds]\r\n        [Time since previous frame in this TCP stream: 0.000000000 seconds]\r\n    TCP payload (307 bytes)\r\nBorder Gateway Protocol - ROUTE-REFRESH Message\r\n    Marker: ffffffffffffffffffffffffffffffff\r\n    Length: 23\r\n    Type: ROUTE-REFRESH Message (5)\r\n    Address family identifier (AFI): IPv4 (1)\r\n    Subtype: Demarcation of the beginning of a route refresh (1)\r\n    Subsequent address family identifier (SAFI): Unicast (1)\r\nBorder Gateway Protocol - UPDATE Message\r\n    Marker: ffffffffffffffffffffffffffffffff\r\n    Length: 208\r\n    Type: UPDATE Message (2)\r\n    Withdrawn Routes Length: 185\r\n    Withdrawn Routes\r\n        0.0.0.0/0 PathId 2 \r\n            NLRI path id: 2\r\n            Prefix Length: 0\r\n            Withdrawn prefix: 0.0.0.0\r\n        10.233.25.178/32 PathId 4 \r\n            NLRI path id: 4\r\n            Prefix Length: 32\r\n            Withdrawn prefix: 10.233.25.178\r\n        10.233.25.144/32 PathId 4 \r\n            NLRI path id: 4\r\n            Prefix Length: 32\r\n            Withdrawn prefix: 10.233.25.144\r\n        10.233.25.147/32 PathId 4 \r\n            NLRI path id: 4\r\n            Prefix Length: 32\r\n            Withdrawn prefix: 10.233.25.147\r\n        10.233.25.187/32 PathId 4 \r\n            NLRI path id: 4\r\n            Prefix Length: 32\r\n            Withdrawn prefix: 10.233.25.187\r\n        10.233.25.159/32 PathId 4 \r\n            NLRI path id: 4\r\n            Prefix Length: 32\r\n            Withdrawn prefix: 10.233.25.159\r\n        10.233.25.140/32 PathId 4 \r\n            NLRI path id: 4\r\n            Prefix Length: 32\r\n            Withdrawn prefix: 10.233.25.140\r\n        10.233.25.177/32 PathId 4 \r\n            NLRI path id: 4\r\n            Prefix Length: 32\r\n            Withdrawn prefix: 10.233.25.177\r\n        10.233.25.143/32 PathId 4 \r\n            NLRI path id: 4\r\n            Prefix Length: 32\r\n            Withdrawn prefix: 10.233.25.143\r\n        10.233.25.152/32 PathId 4 \r\n            NLRI path id: 4\r\n            Prefix Length: 32\r\n            Withdrawn prefix: 10.233.25.152\r\n        10.233.25.155/32 PathId 4 \r\n            NLRI path id: 4\r\n            Prefix Length: 32\r\n            Withdrawn prefix: 10.233.25.155\r\n        10.233.25.139/32 PathId 4 \r\n            NLRI path id: 4\r\n            Prefix Length: 32\r\n            Withdrawn prefix: 10.233.25.139\r\n        10.233.25.179/32 PathId 4 \r\n            NLRI path id: 4\r\n            Prefix Length: 32\r\n            Withdrawn prefix: 10.233.25.179\r\n        10.233.25.145/32 PathId 4 \r\n            NLRI path id: 4\r\n            Prefix Length: 32\r\n            Withdrawn prefix: 10.233.25.145\r\n        10.233.25.182/32 PathId 4 \r\n            NLRI path id: 4\r\n            Prefix Length: 32\r\n            Withdrawn prefix: 10.233.25.182\r\n        10.233.25.148/32 PathId 4 \r\n            NLRI path id: 4\r\n            Prefix Length: 32\r\n            Withdrawn prefix: 10.233.25.148\r\n        10.233.25.151/32 PathId 4 \r\n            NLRI path id: 4\r\n            Prefix Length: 32\r\n            Withdrawn prefix: 10.233.25.151\r\n        10.233.25.188/32 PathId 4 \r\n            NLRI path id: 4\r\n            Prefix Length: 32\r\n            Withdrawn prefix: 10.233.25.188\r\n        10.233.25.157/32 PathId 4 \r\n            NLRI path id: 4\r\n            Prefix Length: 32\r\n            Withdrawn prefix: 10.233.25.157\r\n        10.233.25.163/32 PathId 4 \r\n            NLRI path id: 4\r\n            Prefix Length: 32\r\n            Withdrawn prefix: 10.233.25.163\r\n        10.233.25.132/32 PathId 4 \r\n            NLRI path id: 4\r\n            Prefix Length: 32\r\n            Withdrawn prefix: 10.233.25.132\r\n    Total Path Attribute Length: 0\r\nBorder Gateway Protocol - UPDATE Message\r\n    Marker: ffffffffffffffffffffffffffffffff\r\n    Length: 53\r\n    Type: UPDATE Message (2)\r\n    Withdrawn Routes Length: 0\r\n    Total Path Attribute Length: 21\r\n    Path attributes\r\n        Path Attribute - ORIGIN: IGP\r\n            Flags: 0x40, Transitive, Well-known, Complete\r\n                0... .... = Optional: Not set\r\n                .1.. .... = Transitive: Set\r\n                ..0. .... = Partial: Not set\r\n                ...0 .... = Extended-Length: Not set\r\n                .... 0000 = Unused: 0x0\r\n            Type Code: ORIGIN (1)\r\n            Length: 1\r\n            Origin: IGP (0)\r\n        Path Attribute - AS_PATH: empty\r\n            Flags: 0x40, Transitive, Well-known, Complete\r\n                0... .... = Optional: Not set\r\n                .1.. .... = Transitive: Set\r\n                ..0. .... = Partial: Not set\r\n                ...0 .... = Extended-Length: Not set\r\n                .... 0000 = Unused: 0x0\r\n            Type Code: AS_PATH (2)\r\n            Length: 0\r\n        Path Attribute - NEXT_HOP: 10.22.12.88 \r\n            Flags: 0x40, Transitive, Well-known, Complete\r\n                0... .... = Optional: Not set\r\n                .1.. .... = Transitive: Set\r\n                ..0. .... = Partial: Not set\r\n                ...0 .... = Extended-Length: Not set\r\n                .... 0000 = Unused: 0x0\r\n            Type Code: NEXT_HOP (3)\r\n            Length: 4\r\n            Next hop: 10.22.12.88\r\n        Path Attribute - LOCAL_PREF: 100\r\n            Flags: 0x40, Transitive, Well-known, Complete\r\n                0... .... = Optional: Not set\r\n                .1.. .... = Transitive: Set\r\n                ..0. .... = Partial: Not set\r\n                ...0 .... = Extended-Length: Not set\r\n                .... 0000 = Unused: 0x0\r\n            Type Code: LOCAL_PREF (5)\r\n            Length: 4\r\n            Local preference: 100\r\n    Network Layer Reachability Information (NLRI)\r\n        10.233.0.22/32 PathId 2 \r\n            NLRI path id: 2\r\n            Prefix Length: 32\r\n            NLRI prefix: 10.233.0.22\r\nBorder Gateway Protocol - ROUTE-REFRESH Message\r\n    Marker: ffffffffffffffffffffffffffffffff\r\n    Length: 23\r\n    Type: ROUTE-REFRESH Message (5)\r\n    Address family identifier (AFI): IPv4 (1)\r\n    Subtype: Demarcation of the ending of a route refresh (2)\r\n    Subsequent address family identifier (SAFI): Unicast (1)\r\n```\r\n\r\n### Related resources\r\n\r\nI ran a profile for this, and here's part of the output:\r\n\r\n```shell\r\n$ cat scapy_bug.py \r\nload_contrib('bgp')\r\nrdpcap('bgp.pcap')\r\n\r\n $  /usr/bin/python3 -mcProfile  -s calls /usr/local/bin/scapy -c scapy_bug.py\r\n   Ordered by: call count\r\n\r\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\r\n 43635869   12.852    0.000   13.095    0.000 packet.py:456(__setattr__)\r\n 11899790    1.702    0.000    1.702    0.000 packet.py:333(get_field)\r\n 11899650    0.934    0.000    0.934    0.000 fields.py:199(i2h)\r\n 11899650    6.199    0.000   14.138    0.000 packet.py:425(__getattr__)\r\n 11899650    5.304    0.000    7.006    0.000 packet.py:413(getfield_and_val)\r\n  5954674    0.603    0.000    0.603    0.000 {method 'get' of 'dict' objects}\r\n  4136270    0.783    0.000    0.783    0.000 {built-in method builtins.isinstance}\r\n3966836/80   11.001    0.000   73.444    0.918 base_classes.py:370(__call__)\r\n  2014650    0.224    0.000    0.224    0.000 {method 'append' of 'list' objects}\r\n  1989295    0.476    0.000    0.480    0.000 {built-in method __new__ of type object at 0x908780}\r\n  1987594    1.930    0.000    2.380    0.000 typing.py:868(__new__)\r\n  1985987    0.322    0.000    0.322    0.000 {method 'pop' of 'dict' objects}\r\n1984601/1984577    0.956    0.000    0.956    0.000 config.py:863(__getattribute__)\r\n  1983748    0.425    0.000    0.425    0.000 {method 'get' of 'mappingproxy' objects}\r\n  1983434    0.335    0.000    0.335    0.000 {built-in method time.time}\r\n1983418/80   10.063    0.000   73.443    0.918 packet.py:129(__init__)\r\n1983418/1983359    1.288    0.000    7.562    0.000 packet.py:224(init_fields)\r\n  1983418    0.243    0.000    0.243    0.000 packet.py:1044(update_sent_time)\r\n1983418/1983417    0.874    0.000    1.300    0.000 packet.py:1745(__new__)\r\n  1983418    0.228    0.000    0.228    0.000 packet.py:1753(__init__)\r\n1983416/1983357    3.676    0.000    6.016    0.000 packet.py:251(do_init_cached_fields)\r\n  1983275    1.740    0.000   40.862    0.000 packet.py:1921(__init__)\r\n  1983274    5.664    0.000   60.086    0.000 bgp.py:2390(m2i)\r\n   118568    0.035    0.000    0.059    0.000 compat.py:299(plain_str)\r\n   118473    0.017    0.000    0.017    0.000 {method 'decode' of 'bytes' objects}\r\n    77084    0.008    0.000    0.008    0.000 {method 'strip' of 'bytes' objects}\r\n46492/46078    0.004    0.000    0.004    0.000 {built-in method builtins.len}\r\n    40109    0.012    0.000    0.012    0.000 dadict.py:130(__setitem__)\r\n    39694    0.009    0.000    0.009    0.000 {method 'split' of 'bytes' objects}\r\n    39394    0.008    0.000    0.008    0.000 {method 'startswith' of 'bytes' objects}\r\n    37183    0.004    0.000    0.004    0.000 {method 'lstrip' of 'bytes' objects}\r\n    23332    0.004    0.000    0.006    0.000 base_classes.py:343(<genexpr>)\r\n    18541    0.001    0.000    0.001    0.000 typing.py:1149(cast)\r\n18359/18347    0.007    0.000    0.009    0.000 {built-in method builtins.hasattr}\r\n    13884    0.002    0.000    0.003    0.000 fields.py:2339(<genexpr>)\r\n     8585    0.001    0.000    0.001    0.000 {method 'startswith' of 'str' objects}\r\n8422/8325    0.004    0.000    0.004    0.000 {built-in method builtins.getattr}\r\n     6721    0.001    0.000    0.002    0.000 dadict.py:95(iterkeys)\r\n     5291    0.001    0.000    0.001    0.000 {method 'rstrip' of 'str' objects}\r\n     5272    0.008    0.000    0.008    0.000 main.py:120(_validate_local)\r\n     4579    0.001    0.000    0.002    0.000 fields.py:174(register_owner)\r\n     4100    0.001    0.000    0.001    0.000 {built-in method _struct.calcsize}\r\n     4082    0.009    0.000    0.017    0.000 fields.py:160(__init__)\r\n     3419    0.001    0.000    0.001    0.000 {built-in method builtins.setattr}\r\n     3134    0.001    0.000    0.003    0.000 fields.py:218(any2i)\r\n     3104    0.001    0.000    0.001    0.000 fields.py:194(h2i)\r\n     3088    0.001    0.000    0.001    0.000 {method 'join' of 'str' objects}\r\n     2574    0.001    0.000    0.001    0.000 <frozen importlib._bootstrap>:222(_verbose_message)\r\n     2421    0.001    0.000    0.002    0.000 <frozen importlib._bootstrap_external>:123(<listcomp>)\r\n     2421    0.002    0.000    0.004    0.000 <frozen importlib._bootstrap_external>:121(_path_join)\r\n     2344    0.001    0.000    0.001    0.000 sre_parse.py:164(__getitem__)\r\n2162/1769    0.016    0.000    0.239    0.000 {built-in method builtins.__build_class__}\r\n     2067    0.001    0.000    0.001    0.000 sre_parse.py:233(__next)\r\n     1870    0.000    0.000    0.000    0.000 {built-in method builtins.abs}\r\n     1635    0.000    0.000    0.001    0.000 fields.py:398(__getattr__)\r\n     1624    0.000    0.000    0.000    0.000 inspect.py:2551(kind)\r\n     1586    0.000    0.000    0.000    0.000 {method 'isupper' of 'str' objects}\r\n     1561    0.000    0.000    0.001    0.000 sre_parse.py:254(get)\r\n     1558    0.000    0.000    0.000    0.000 {method 'rpartition' of 'str' objects}\r\n     1335    0.000    0.000    0.000    0.000 {built-in method _imp.acquire_lock}\r\n     1335    0.000    0.000    0.000    0.000 {built-in method _imp.release_lock}\r\n     1228    0.000    0.000    0.000    0.000 dadict.py:126(__getitem__)\r\n     1216    0.000    0.000    0.000    0.000 {method '__init_subclass__' of 'object' objects}\r\n     1216    0.004    0.000    0.004    0.000 typing.py:900(__init_subclass__)\r\n     1214    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}\r\n     1184    0.000    0.000    0.000    0.000 inspect.py:2821(<genexpr>)\r\n     1184    0.000    0.000    0.000    0.000 inspect.py:2881(<genexpr>)\r\n1121/1091    0.001    0.000    0.044    0.000 <frozen importlib._bootstrap>:1017(_handle_fromlist)\r\n     1104    0.000    0.000    0.000    0.000 sre_parse.py:249(match)\r\n     1098    0.000    0.000    0.000    0.000 {built-in method builtins.id}\r\n     1061    0.000    0.000    0.000    0.000 {built-in method _struct.pack}\r\n     1043    0.008    0.000    0.008    0.000 {built-in method posix.stat}\r\n     1029    0.001    0.000    0.009    0.000 <frozen importlib._bootstrap_external>:135(_path_stat)\r\n      992    0.023    0.000    0.067    0.000 base_classes.py:287(__new__)\r\n      984    0.000    0.000    0.001    0.000 typing.py:646(_is_dunder)\r\n      984    0.001    0.000    0.001    0.000 typing.py:762(__setattr__)\r\n      979    0.000    0.000    0.000    0.000 {built-in method builtins.callable}\r\n      974    0.000    0.000    0.000    0.000 {built-in method builtins.min}\r\n      974    0.001    0.000    0.002    0.000 config.py:263(register)\r\n      956    0.000    0.000    0.000    0.000 {method 'isidentifier' of 'str' objects}\r\n      940    0.001    0.000    0.001    0.000 base_classes.py:363(__getattr__)\r\n      905    0.000    0.000    0.003    0.000 enum.py:313(__call__)\r\n      898    0.000    0.000    0.000    0.000 enum.py:631(__new__)\r\n      890    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:129(<genexpr>)\r\n      884    0.000    0.000    0.000    0.000 {method 'endswith' of 'str' objects}\r\n      866    0.000    0.000    0.000    0.000 compat.py:306(chb)\r\n      825    0.000    0.000    0.000    0.000 sre_parse.py:160(__len__)\r\n      812    0.001    0.000    0.002    0.000 inspect.py:2489(__init__)\r\n      812    0.000    0.000    0.000    0.000 inspect.py:2539(name)\r\n      773    0.001    0.000    0.005    0.000 {built-in method builtins.any}\r\n      771    0.000    0.000    0.000    0.000 volatile.py:434(<genexpr>)\r\n      765    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:863(__enter__)\r\n      765    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:867(__exit__)\r\n      747    0.000    0.000    0.000    0.000 {method 'values' of 'mappingproxy' objects}\r\n      744    0.000    0.000    0.000    0.000 inspect.py:2857(parameters)\r\n      744    0.000    0.000    0.000    0.000 inspect.py:158(isfunction)\r\n      733    0.000    0.000    0.000    0.000 {built-in method posix.fspath}\r\n      719    0.000    0.000    0.000    0.000 {built-in method builtins.ord}\r\n      693    0.000    0.000    0.001    0.000 fields.py:2373(any2i)\r\n      688    0.000    0.000    0.001    0.000 fields.py:2347(any2i_one)\r\n      685    0.000    0.000    0.000    0.000 {built-in method from_bytes}\r\n      679    0.008    0.000    0.018    0.000 fields.py:2298(__init__)\r\n      665    0.001    0.000    0.001    0.000 <frozen importlib._bootstrap_external>:79(_unpack_uint32)\r\n  630/621    0.000    0.000    0.000    0.000 {built-in method builtins.iter}\r\n      623    0.000    0.000    0.000    0.000 {method 'find' of 'bytearray' objects}\r\n      615    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}\r\n      608    0.000    0.000    0.001    0.000 {built-in method builtins.max}\r\n      583    0.000    0.000    0.000    0.000 {built-in method _thread.get_ident}\r\n      579    0.000    0.000    0.000    0.000 sre_parse.py:172(append)\r\n      572    0.000    0.000    0.000    0.000 {built-in method _thread.allocate_lock}\r\n      565    0.000    0.000    0.002    0.000 fields.py:954(__init__)\r\n      555    0.001    0.000    0.004    0.000 fields.py:2136(__init__)\r\n      545    0.000    0.000    0.000    0.000 {method 'translate' of 'str' objects}\r\n      543    0.000    0.000    0.000    0.000 sre_parse.py:286(tell)\r\n      526    0.000    0.000    0.000    0.000 {method 'find' of 'bytes' objects}\r\n      514    0.000    0.000    0.000    0.000 {method 'copy' of 'dict' objects}\r\n      513    0.000    0.000    0.001    0.000 <frozen importlib._bootstrap_external>:1330(_path_importer_cache)\r\n      509    0.000    0.000    0.000    0.000 {method 'endswith' of 'bytes' objects}\r\n      509    0.001    0.000    0.017    0.000 re.py:289(_compile)\r\n      488    0.000    0.000    0.003    0.000 fields.py:1314(__init__)\r\n      479    0.001    0.000    0.001    0.000 packet.py:1972(bind_bottom_up)\r\n  475/125    0.001    0.000    0.001    0.000 sre_parse.py:174(getwidth)\r\n      473    0.000    0.000    0.002    0.000 fields.py:1192(__init__)\r\n      466    0.000    0.000    0.000    0.000 {method 'encode' of 'str' objects}\r\n      464    0.000    0.000    0.000    0.000 {method 'rfind' of 'str' objects}\r\n      461    0.001    0.000    0.001    0.000 {method 'split' of 're.Pattern' objects}\r\n      461    0.000    0.000    0.001    0.000 re.py:223(split)\r\n      456    0.000    0.000    0.004    0.000 <frozen importlib._bootstrap>:376(cached)\r\n      454    0.000    0.000    0.001    0.000 dadict.py:33(fixname)\r\n      450    0.001    0.000    0.001    0.000 packet.py:1994(bind_top_down)\r\n      445    0.001    0.000    0.002    0.000 <frozen importlib._bootstrap_external>:127(_path_split)\r\n      444    0.002    0.000    0.005    0.000 <frozen importlib._bootstrap_external>:354(cache_from_source)\r\n      443    0.004    0.000    0.018    0.000 <frozen importlib._bootstrap_external>:1498(find_spec)\r\n      443    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:68(_relax_case)\r\n      432    0.000    0.000    0.002    0.000 packet.py:2015(bind_layers)\r\n      418    0.000    0.000    0.000    0.000 {built-in method builtins.chr}\r\n  413/176    0.001    0.000    0.003    0.000 copy.py:128(deepcopy)\r\n      410    0.001    0.000    0.002    0.000 fields.py:1325(any2i)\r\n      407    0.000    0.000    0.000    0.000 sre_parse.py:111(__init__)\r\n      406    0.000    0.000    0.000    0.000 inspect.py:2601(__eq__)\r\n      397    0.000    0.000    0.000    0.000 {built-in method builtins.issubclass}\r\n   389/39    0.002    0.000    0.005    0.000 sre_compile.py:71(_compile)\r\n  380/345    0.000    0.000    0.000    0.000 {built-in method builtins.hash}\r\n      379    0.000    0.000    0.000    0.000 socket.py:91(<lambda>)\r\n      378    0.000    0.000    0.000    0.000 socket.py:86(<lambda>)\r\n      377    0.000    0.000    0.000    0.000 socket.py:81(<lambda>)\r\n      376    0.000    0.000    0.000    0.000 socket.py:76(<lambda>)\r\n      372    0.000    0.000    0.000    0.000 {built-in method sys.getrecursionlimit}\r\n      372    0.000    0.000    0.000    0.000 inspect.py:513(_is_wrapper)\r\n      372    0.000    0.000    0.001    0.000 inspect.py:493(unwrap)\r\n      372    0.002    0.000    0.006    0.000 inspect.py:2124(_signature_from_function)\r\n      372    0.001    0.000    0.008    0.000 inspect.py:2218(_signature_from_callable)\r\n      372    0.001    0.000    0.001    0.000 inspect.py:2772(__init__)\r\n      372    0.000    0.000    0.008    0.000 inspect.py:2851(from_callable)\r\n      372    0.000    0.000    0.000    0.000 inspect.py:2861(return_annotation)\r\n      372    0.000    0.000    0.000    0.000 inspect.py:2884(<dictcomp>)\r\n      372    0.001    0.000    0.002    0.000 inspect.py:2880(_hash_basis)\r\n      372    0.000    0.000    0.008    0.000 inspect.py:3103(signature)\r\n      354    0.000    0.000    0.000    0.000 compat.py:281(bytes_encode)\r\n      338    0.000    0.000    0.006    0.000 <frozen importlib._bootstrap_external>:145(_path_is_mode_type)\r\n      336    0.000    0.000    0.001    0.000 fields.py:1222(__init__)\r\n      330    0.000    0.000    0.000    0.000 typing.py:669(<genexpr>)\r\n      329    0.000    0.000    0.000    0.000 fields.py:304(__getattr__)\r\n      326    0.000    0.000    0.008    0.000 fields.py:2476(__init__)\r\n    321/5    0.000    0.000    0.567    0.113 <frozen importlib._bootstrap>:211(_call_with_frames_removed)\r\n      313    0.000    0.000    0.001    0.000 fields.py:1204(__init__)\r\n      311    0.000    0.000    0.006    0.000 <frozen importlib._bootstrap_external>:154(_path_isfile)\r\n      308    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}\r\n      303    0.000    0.000    0.000    0.000 enum.py:417(__setattr__)\r\n      296    0.000    0.000    0.008    0.000 asn1fields.py:45(__init__)\r\n      288    0.001    0.000    0.001    0.000 <frozen importlib._bootstrap>:78(acquire)\r\n      288    0.001    0.000    0.001    0.000 <frozen importlib._bootstrap>:103(release)\r\n      288    0.001    0.000    0.002    0.000 <frozen importlib._bootstrap>:157(_get_module_lock)\r\n      282    0.000    0.000    0.001    0.000 <frozen importlib._bootstrap>:58(__init__)\r\n      282    0.000    0.000    0.001    0.000 <frozen importlib._bootstrap>:176(cb)\r\n      279    0.000    0.000    0.000    0.000 copy.py:182(_deepcopy_atomic)\r\n      275    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:143(__init__)\r\n      275    0.000    0.000    0.003    0.000 <frozen importlib._bootstrap>:147(__enter__)\r\n      275    0.000    0.000    0.001    0.000 <frozen importlib._bootstrap>:151(__exit__)\r\n    275/5    0.001    0.000    0.569    0.114 <frozen importlib._bootstrap>:986(_find_and_load)\r\n      273    0.000    0.000    0.000    0.000 data.py:345(__getitem__)\r\n      271    0.000    0.000    0.000    0.000 six.py:590(iteritems)\r\n      267    0.000    0.000    0.000    0.000 fields.py:2813(__setattr__)\r\n      267    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:342(__init__)\r\n    267/4    0.001    0.000    0.569    0.142 <frozen importlib._bootstrap>:956(_find_and_load_unlocked)\r\n      266    0.000    0.000    0.000    0.000 {method 'extend' of 'list' objects}\r\n      264    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:725(find_spec)\r\n  264/262    0.002    0.000    0.025    0.000 <frozen importlib._bootstrap>:890(_find_spec)\r\n      263    0.000    0.000    0.000    0.000 {method 'split' of 'str' objects}\r\n      259    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap_external>:175(_path_isabs)\r\n      257    0.000    0.000    0.000    0.000 hmac.py:17(<genexpr>)\r\n      257    0.000    0.000    0.000    0.000 hmac.py:18(<genexpr>)\r\n```", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3345/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3345/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3324", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3324/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3324/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3324/events", "html_url": "https://github.com/secdev/scapy/issues/3324", "id": 961084709, "node_id": "MDU6SXNzdWU5NjEwODQ3MDk=", "number": 3324, "title": "Scapy failing to fully parse ClientHello in some circumstances", "user": {"login": "vincentmacri", "id": 9146157, "node_id": "MDQ6VXNlcjkxNDYxNTc=", "avatar_url": "https://avatars.githubusercontent.com/u/9146157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vincentmacri", "html_url": "https://github.com/vincentmacri", "followers_url": "https://api.github.com/users/vincentmacri/followers", "following_url": "https://api.github.com/users/vincentmacri/following{/other_user}", "gists_url": "https://api.github.com/users/vincentmacri/gists{/gist_id}", "starred_url": "https://api.github.com/users/vincentmacri/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vincentmacri/subscriptions", "organizations_url": "https://api.github.com/users/vincentmacri/orgs", "repos_url": "https://api.github.com/users/vincentmacri/repos", "events_url": "https://api.github.com/users/vincentmacri/events{/privacy}", "received_events_url": "https://api.github.com/users/vincentmacri/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-08-04T21:34:30Z", "updated_at": "2021-09-02T15:15:00Z", "closed_at": "2021-09-02T15:15:00Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Brief description\n\nIn certain cases, parsing the bytes of a TLS ClientHello gives a TLS packet with the type `application_data` and the payload is left as `Raw`, rather than being parsed into a ClientHello packet.\r\n\r\nThe only difference I have noticed between my examples  where this bug occurs and where it doesn't occur, is it seems to occur when the key share sent in the ClientHello is for FFDHE (specifically `ffdhe4096` in the examples I've done). I could be wrong that this is related, and I see no reason why these should be related.\n\n### Scapy version\n\n2.4.5\n\n### Python version\n\n3.9\n\n### Operating system\n\nmacOS Big Sur\n\n### Additional environment information\n\nAlso tested with `scapy` 2.4.5 on Linux (I think it was a recent Ubuntu version).\r\n\r\nAlso tested on Big Sur with `scapy` version `d4c9a50dc1edd563f87f04dd55597435471c572c` from GitHub.\n\n### How to reproduce\n\n```python\r\nfrom scapy.all import *\r\nimport binascii\r\n\r\nload_layer(\"tls\")\r\nhex_data = \"16030102a8010002a4030330cc71861d50119dbe2b9c3a5207b7eff49aff19408096b32926d6fe8a4878e520c03832cba05660b5facc4b9991f3b006d326325ab1e0a9463287271952f4235f0004130200ff0100025700000020001e00001b6578616d706c653132333435362e6d79636f6d70616e792e636f6d000a000400020102002300000016000000170000000d000400020403002b0003020304002d00020101003302060204010202003476f00e12d8c768be0bd6db6af9e539441edd84b87178e8843bb2febc4b2097ac9619e65ed61837550e51834c32c7cb007b9b9a2f129d7127ee9f8bcbc2ba2141677300bc660d080d32257731d8d795bda7467df240cf07e8f1cde33bfc1f168385babee0f5834269f3c1070f7d89b3b9607b474edd306af54638d14e58cdc524b8972035a762dc446ef95b30a8c5e06876804ec9fb180f0255ea93b1438336e414761e1e1e2772909ce3fadc5282674337267f9697204b81a0b3ded2a3ecb03b46c1a4113e44b23a67d349b0406903b6acfdce0595e16b4f41dee9351f16e1267f9bdc6abbd897332552cb9b139f1556fc207fb8dee337d185acbe6b1b42c09751339e7d441933bec3cc4b24740b1640a2af73eadf700e0bee5065c38886f6a5983e1029f67085590f95f9546057725c004804cd97ed2c1c5ca0383751e77c087449719e65d9a39adad84e1bab92c0f9b7b472e58f60d4f81e3b622d7f62fd61c747e5951b54e9ef7b1a65b07e25c94baa7c19284ecf855a5cff7dae958359f3bd5d6184f11a3785026f8479d25595948160de89e8af62f306783c79b0bf28fb18da512737b52ede9f826ed95ed1ce8386e3ff3e74ba0b7ad82bef0c046223986475de12c9654f0fc3cb162d24ab02fe51120566bc993583e10149c16d953640357785e88748739cf84a3f0930fe5b4732f17f32e7e7fdf00023643a798cf7\"\r\n\r\ntls_packet = TLS(binascii.unhexlify(hex_data))\r\ntls_packet.show()\r\n```\n\n### Actual result\n\n```\r\n###[ TLS ]### \r\n  type      = application_data\r\n  version   = TLS 1.0\r\n  len       = 680    [deciphered_len= 680]\r\n  iv        = b''\r\n  \\msg       \\\r\n   |###[ Raw ]### \r\n   |  load      = \"\\x01\\x00\\x02\\\\xa4\\x03\\x030\\\\xccq\\\\x86\\x1dP\\x11\\\\x9d\\\\xbe+\\\\x9c:R\\x07\\\\xb7\\\\xef\\\\xf4\\\\x9a\\\\xff\\x19@\\\\x80\\\\x96\\\\xb3)&\\\\xd6\\\\xfe\\\\x8aHx\\\\xe5 \\\\xc082\u02e0V`\\\\xb5\\\\xfa\\\\xccK\\\\x99\\\\x91\\\\xf3\\\\xb0\\x06\\\\xd3&2Z\\\\xb1\\\\xe0\\\\xa9F2\\\\x87'\\x19R\\\\xf4#_\\x00\\x04\\x13\\x02\\x00\\\\xff\\x01\\x00\\x02W\\x00\\x00\\x00 \\x00\\x1e\\x00\\x00\\x1bexample123456.mycompany.com\\x00\\n\\x00\\x04\\x00\\x02\\x01\\x02\\x00#\\x00\\x00\\x00\\x16\\x00\\x00\\x00\\x17\\x00\\x00\\x00\\r\\x00\\x04\\x00\\x02\\x04\\x03\\x00+\\x00\\x03\\x02\\x03\\x04\\x00-\\x00\\x02\\x01\\x01\\x003\\x02\\x06\\x02\\x04\\x01\\x02\\x02\\x004v\\\\xf0\\x0e\\x12\\\\xd8\\\\xc7h\\\\xbe\\x0b\\\\xd6\\\\xdbj\\\\xf9\\\\xe59D\\x1e\u0744\\\\xb8qx\\\\xe8\\\\x84;\\\\xb2\\\\xfe\\\\xbcK \\\\x97\\\\xac\\\\x96\\x19\\\\xe6^\\\\xd6\\x187U\\x0eQ\\\\x83L2\\\\xc7\\\\xcb\\x00{\\\\x9b\\\\x9a/\\x12\\\\x9dq'\\ue7cb\\\\xcb\u00ba!Ags\\x00\\\\xbcf\\r\\x08\\r2%w1\\\\xd8\u05d5\\\\xbd\\\\xa7F}\\\\xf2@\\\\xcf\\x07\\\\xe8\\\\xf1\\\\xcd\\\\xe3;\\\\xfc\\x1f\\x16\\\\x83\\\\x85\\\\xba\\\\xbe\\\\xe0\\\\xf5\\\\x83Bi\\\\xf3\\\\xc1\\x07\\x0f}\\\\x89\\\\xb3\\\\xb9`{GN\\\\xdd0j\\\\xf5F8\\\\xd1NX\\\\xcd\\\\xc5$\\\\xb8\\\\x97 5\\\\xa7b\\\\xdcDn\\\\xf9[0\\\\xa8\\\\xc5\\\\xe0hv\\\\x80N\\\\xc9\\\\xfb\\x18\\x0f\\x02U\ua4f1C\\\\x836\\\\xe4\\x14v\\x1e\\x1e\\x1e'r\\\\x90\\\\x9c\\\\xe3\\\\xfa\\\\xdcR\\\\x82gC7&\\x7f\\\\x96\\\\x97 K\\\\x81\\\\xa0\\\\xb3\\\\xde\u04a3\\\\xec\\\\xb0;F\\\\xc1\\\\xa4\\x11>D\\\\xb2:g\\\\xd3I\\\\xb0@i\\x03\\\\xb6\\\\xac\\\\xfd\\\\xce\\x05\\\\x95\\\\xe1kOA\\\\xde\\\\xe95\\x1f\\x16\\\\xe1&\\x7f\\\\x9b\\\\xdcj\\\\xbb\u06173%R\u02db\\x13\\\\x9f\\x15V\\\\xfc \\x7f\\\\xb8\\\\xde\\\\xe37\u0445\\\\xac\\\\xbek\\x1bB\\\\xc0\\\\x97Q3\\\\x9e}D\\x193\\\\xbe\\\\xc3\\\\xccK$t\\x0b\\x16@\\\\xa2\\\\xafs\\\\xea\\\\xdfp\\x0e\\x0b\\\\xeePe\u00c8\\\\x86\\\\xf6\\\\xa5\\\\x98>\\x10)\\\\xf6p\\\\x85Y\\x0f\\\\x95\\\\xf9T`Wr\\\\\\x00H\\x04\u0357\\\\xed,\\x1c\\\\\\\\xa087Q\\\\xe7|\\x08tIq\\\\x9ee\u0663\\\\x9a\\\\xda\\\\xd8N\\x1b\\\\xab\\\\x92\\\\xc0\\\\xf9\\\\xb7\\\\xb4r\\\\xe5\\\\x8f`\\\\xd4\\\\xf8\\x1e;b-\\x7fb\\\\xfda\\\\xc7G\\\\xe5\\\\x95\\x1bT\\\\xe9\\\\xef{\\x1ae\\\\xb0~%\\\\xc9K\\\\xaa|\\x19(N\u03c5Z\\\\\\\\xff}\\\\xae\\\\x95\\\\x83Y\\\\xf3\\\\xbd]a\\\\x84\\\\xf1\\x1a7\\\\x85\\x02o\\\\x84y\\\\xd2U\\\\x95\\\\x94\\\\x81`\u0789\\\\xe8\\\\xafb\\\\xf3\\x06x<y\\\\xb0\\\\xbf(\\\\xfb\\x18\\\\xdaQ'7\\\\xb5.\u079f\\\\x82n\\\\xd9^\\\\xd1\\u0383\\\\x86\\\\xe3\\\\xff>t\\\\xba\\x0bz\\\\xd8+\\\\xef\\x0c\\x04b#\\\\x98du\\\\xde\\x12\\\\xc9eO\\x0f\\\\xc3\\\\xcb\\x16-$\\\\xab\\x02\\\\xfeQ\\x12\\x05f\\\\xbc\\\\x995\\\\x83\\\\xe1\\x01I\\\\xc1m\\\\x956@5w\\\\x85\\\\xe8\\\\x87Hs\\\\x9c\\\\xf8J?\\t0\\\\xfe[G2\\\\xf1\\x7f2\\\\xe7\\\\xe7\\\\xfd\\\\xf0\\x00#d:y\\\\x8c\\\\xf7\"\r\n  mac       = b''\r\n  pad       = b''\r\n  padlen    = None\r\n```\n\n### Expected result\n\nWireshark screenshots:\r\n\r\n![image](https://user-images.githubusercontent.com/9146157/128256941-fa428059-1612-4093-a79a-2ce5e2b42d42.png)\r\n![image](https://user-images.githubusercontent.com/9146157/128257000-dfb1fb79-5f2d-4841-94b1-6f0ca5e8e268.png)\r\n\n\n### Related resources\n\nHex data of the ClientHello in the above example:\r\n\r\n> 16030102a8010002a4030330cc71861d50119dbe2b9c3a5207b7eff49aff19408096b32926d6fe8a4878e520c03832cba05660b5facc4b9991f3b006d326325ab1e0a9463287271952f4235f0004130200ff0100025700000020001e00001b6578616d706c653132333435362e6d79636f6d70616e792e636f6d000a000400020102002300000016000000170000000d000400020403002b0003020304002d00020101003302060204010202003476f00e12d8c768be0bd6db6af9e539441edd84b87178e8843bb2febc4b2097ac9619e65ed61837550e51834c32c7cb007b9b9a2f129d7127ee9f8bcbc2ba2141677300bc660d080d32257731d8d795bda7467df240cf07e8f1cde33bfc1f168385babee0f5834269f3c1070f7d89b3b9607b474edd306af54638d14e58cdc524b8972035a762dc446ef95b30a8c5e06876804ec9fb180f0255ea93b1438336e414761e1e1e2772909ce3fadc5282674337267f9697204b81a0b3ded2a3ecb03b46c1a4113e44b23a67d349b0406903b6acfdce0595e16b4f41dee9351f16e1267f9bdc6abbd897332552cb9b139f1556fc207fb8dee337d185acbe6b1b42c09751339e7d441933bec3cc4b24740b1640a2af73eadf700e0bee5065c38886f6a5983e1029f67085590f95f9546057725c004804cd97ed2c1c5ca0383751e77c087449719e65d9a39adad84e1bab92c0f9b7b472e58f60d4f81e3b622d7f62fd61c747e5951b54e9ef7b1a65b07e25c94baa7c19284ecf855a5cff7dae958359f3bd5d6184f11a3785026f8479d25595948160de89e8af62f306783c79b0bf28fb18da512737b52ede9f826ed95ed1ce8386e3ff3e74ba0b7ad82bef0c046223986475de12c9654f0fc3cb162d24ab02fe51120566bc993583e10149c16d953640357785e88748739cf84a3f0930fe5b4732f17f32e7e7fdf00023643a798cf7", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3324/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3324/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3322", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3322/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3322/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3322/events", "html_url": "https://github.com/secdev/scapy/pull/3322", "id": 960946669, "node_id": "MDExOlB1bGxSZXF1ZXN0NzAzOTIwODUx", "number": 3322, "title": "Fixes and improves TrafficSelector handling in IKEv2", "user": {"login": "0xbf00", "id": 4608543, "node_id": "MDQ6VXNlcjQ2MDg1NDM=", "avatar_url": "https://avatars.githubusercontent.com/u/4608543?v=4", "gravatar_id": "", "url": "https://api.github.com/users/0xbf00", "html_url": "https://github.com/0xbf00", "followers_url": "https://api.github.com/users/0xbf00/followers", "following_url": "https://api.github.com/users/0xbf00/following{/other_user}", "gists_url": "https://api.github.com/users/0xbf00/gists{/gist_id}", "starred_url": "https://api.github.com/users/0xbf00/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/0xbf00/subscriptions", "organizations_url": "https://api.github.com/users/0xbf00/orgs", "repos_url": "https://api.github.com/users/0xbf00/repos", "events_url": "https://api.github.com/users/0xbf00/events{/privacy}", "received_events_url": "https://api.github.com/users/0xbf00/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 3, "created_at": "2021-08-04T19:44:06Z", "updated_at": "2021-08-31T21:38:51Z", "closed_at": "2021-08-31T21:38:51Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3322", "html_url": "https://github.com/secdev/scapy/pull/3322", "diff_url": "https://github.com/secdev/scapy/pull/3322.diff", "patch_url": "https://github.com/secdev/scapy/pull/3322.patch", "merged_at": "2021-08-31T21:38:50Z"}, "body": "Corrects dissecting of packets containing multiple TrafficSelectors\r\n\r\nPreviously, dissecting IKEv2_payload_IDi and IKEv2_payload_IDr with\r\nmore than one TrafficSelector would incorrectly result in just one of\r\nthe TrafficSelectors being properly identified.\r\n\r\nAdds automatic calculation of the number_of_TSs field for TSi and TSr\r\nIKEv2 payloads.\r\n\r\nAdds corresponding unit tests\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3322/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3322/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3313", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3313/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3313/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3313/events", "html_url": "https://github.com/secdev/scapy/pull/3313", "id": 957474050, "node_id": "MDExOlB1bGxSZXF1ZXN0NzAwODk0MTcy", "number": 3313, "title": "Fix RawPcap[Writer/Reader]", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 2, "created_at": "2021-08-01T12:03:56Z", "updated_at": "2022-03-29T11:27:34Z", "closed_at": "2021-08-17T15:19:30Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3313", "html_url": "https://github.com/secdev/scapy/pull/3313", "diff_url": "https://github.com/secdev/scapy/pull/3313.diff", "patch_url": "https://github.com/secdev/scapy/pull/3313.patch", "merged_at": "2021-08-17T15:19:30Z"}, "body": "- fix https://github.com/secdev/scapy/issues/3289\r\n- fix https://github.com/secdev/scapy/issues/3256\r\n- `RawPcapReader.read_all()` is unsupported. Forbid that", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3313/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3313/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3307", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3307/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3307/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3307/events", "html_url": "https://github.com/secdev/scapy/pull/3307", "id": 952154884, "node_id": "MDExOlB1bGxSZXF1ZXN0Njk2NDEwODcw", "number": 3307, "title": "Stabilize loop test, fix 3306, disable unstable tests", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 514033136, "node_id": "MDU6TGFiZWw1MTQwMzMxMzY=", "url": "https://api.github.com/repos/secdev/scapy/labels/tests", "name": "tests", "color": "0e8a16", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 3, "created_at": "2021-07-24T22:03:46Z", "updated_at": "2022-03-29T11:27:32Z", "closed_at": "2021-08-03T18:04:59Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3307", "html_url": "https://github.com/secdev/scapy/pull/3307", "diff_url": "https://github.com/secdev/scapy/pull/3307.diff", "patch_url": "https://github.com/secdev/scapy/pull/3307.patch", "merged_at": "2021-08-03T18:04:59Z"}, "body": "- fix https://github.com/secdev/scapy/issues/3306\r\n- stabilize various networking test\r\n- stabilize import tests\r\n- fix BPF being loaded on linux during a mock test which caused `ioctl` to fail. Loading BPF on linux is now impossible", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3307/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3307/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3306", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3306/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3306/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3306/events", "html_url": "https://github.com/secdev/scapy/issues/3306", "id": 951973977, "node_id": "MDU6SXNzdWU5NTE5NzM5Nzc=", "number": 3306, "title": "TypeError using send(fuzz(...)) since 2.4.5", "user": {"login": "mwutzke", "id": 4864624, "node_id": "MDQ6VXNlcjQ4NjQ2MjQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4864624?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mwutzke", "html_url": "https://github.com/mwutzke", "followers_url": "https://api.github.com/users/mwutzke/followers", "following_url": "https://api.github.com/users/mwutzke/following{/other_user}", "gists_url": "https://api.github.com/users/mwutzke/gists{/gist_id}", "starred_url": "https://api.github.com/users/mwutzke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mwutzke/subscriptions", "organizations_url": "https://api.github.com/users/mwutzke/orgs", "repos_url": "https://api.github.com/users/mwutzke/repos", "events_url": "https://api.github.com/users/mwutzke/events{/privacy}", "received_events_url": "https://api.github.com/users/mwutzke/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 0, "created_at": "2021-07-24T01:21:47Z", "updated_at": "2021-08-03T18:04:59Z", "closed_at": "2021-08-03T18:04:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Brief description\n\nGenerating Fuzzed traffic produces a a `TypeError` exception when calling `self.outs.bind(sdto)`\n\n### Scapy version\n\n2.4.5\n\n### Python version\n\n3.7\n\n### Operating system\n\nUbuntu 20.04.2\n\n### Additional environment information\n\nThe reproduction method worked on Scapy 2.4.4.\r\n\r\nThis seems to be limited to Fuzzed packets, as the following works correctly on 2.4.5:\r\n```\r\nscapy.all.send(ARP(pdst='172.17.0.1'))\r\n```\r\n\r\nI have also tried the same test case on CID 36448129bf99e52b0b2117edd1210eecac1dae36, and it still fails.\r\n\n\n### How to reproduce\n\n```\r\nscapy.all.send(fuzz(ARP(pdst='172.17.0.1')))\r\n```\n\n### Actual result\n\n```\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/venv/lib/python3.7/site-packages/scapy/sendrecv.py\", line 429, in send\r\n    **kargs\r\n  File \"/venv/lib/python3.7/site-packages/scapy/sendrecv.py\", line 397, in _send\r\n    realtime=realtime, return_packets=return_packets)\r\n  File \"/venv/lib/python3.7/site-packages/scapy/sendrecv.py\", line 360, in __gen_send\r\n    s.send(p)\r\n  File \"/venv/lib/python3.7/site-packages/scapy/arch/linux.py\", line 605, in send\r\n    self.outs.bind(sdto)\r\nTypeError: argument 1 must be str, not NetworkInterface\r\n```\n\n### Expected result\n\nFuzzed packets get generated, and no exception occurs.\n\n### Related resources\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3306/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3306/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3303", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3303/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3303/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3303/events", "html_url": "https://github.com/secdev/scapy/pull/3303", "id": 948077072, "node_id": "MDExOlB1bGxSZXF1ZXN0NjkyOTY3MjY0", "number": 3303, "title": "Repair unit tests", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 514033136, "node_id": "MDU6TGFiZWw1MTQwMzMxMzY=", "url": "https://api.github.com/repos/secdev/scapy/labels/tests", "name": "tests", "color": "0e8a16", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 2, "created_at": "2021-07-19T22:28:21Z", "updated_at": "2022-03-29T11:27:31Z", "closed_at": "2021-07-21T12:27:09Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3303", "html_url": "https://github.com/secdev/scapy/pull/3303", "diff_url": "https://github.com/secdev/scapy/pull/3303.diff", "patch_url": "https://github.com/secdev/scapy/pull/3303.patch", "merged_at": "2021-07-21T12:27:09Z"}, "body": "We had a temporary failure of the test suite that lead all tests to pass. https://github.com/secdev/scapy/issues/3298 This was thankfully caught fast by polybassa. This PR fixes the bugs introduced during that time.\r\n\r\n- https://github.com/secdev/scapy/pull/3295 caused a crash (TLS extensions are wrongly dissected) that wasn't discovered due to the temporary test suite failure. This PR re-introduces a check that should hopefully still fix what that PR aimed at fixing (although a reproducible example would have been nice), while fixing the extensions computation.\r\n- https://github.com/secdev/scapy/pull/3286 caused a failure in an unrelated pipetools test and a few failures in checks that tested the length of compressed packets.\r\n- https://github.com/secdev/scapy/pull/3271 dropped the check to make sure builtins were not imported. Re introduce that\r\n\r\nAlso took that opportunity to merge a tiny fix for some bad types I had as leftover.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3303/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3303/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3300", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3300/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3300/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3300/events", "html_url": "https://github.com/secdev/scapy/pull/3300", "id": 947479375, "node_id": "MDExOlB1bGxSZXF1ZXN0NjkyNDU0NTc0", "number": 3300, "title": "preserve rdlen when rdata is not a compressed DNS string", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 9, "created_at": "2021-07-19T09:55:47Z", "updated_at": "2021-10-10T09:42:19Z", "closed_at": "2021-10-10T09:42:16Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3300", "html_url": "https://github.com/secdev/scapy/pull/3300", "diff_url": "https://github.com/secdev/scapy/pull/3300.diff", "patch_url": "https://github.com/secdev/scapy/pull/3300.patch", "merged_at": "2021-10-10T09:42:16Z"}, "body": "This PR partially resolves #3269. It makes sure that `rdlen` is not set to None when `rdata` is not compressed.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3300/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3300/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3291", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3291/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3291/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3291/events", "html_url": "https://github.com/secdev/scapy/issues/3291", "id": 943728737, "node_id": "MDU6SXNzdWU5NDM3Mjg3Mzc=", "number": 3291, "title": "Scapy not defragmenting complete TLS message", "user": {"login": "dannybellis", "id": 26009395, "node_id": "MDQ6VXNlcjI2MDA5Mzk1", "avatar_url": "https://avatars.githubusercontent.com/u/26009395?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dannybellis", "html_url": "https://github.com/dannybellis", "followers_url": "https://api.github.com/users/dannybellis/followers", "following_url": "https://api.github.com/users/dannybellis/following{/other_user}", "gists_url": "https://api.github.com/users/dannybellis/gists{/gist_id}", "starred_url": "https://api.github.com/users/dannybellis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dannybellis/subscriptions", "organizations_url": "https://api.github.com/users/dannybellis/orgs", "repos_url": "https://api.github.com/users/dannybellis/repos", "events_url": "https://api.github.com/users/dannybellis/events{/privacy}", "received_events_url": "https://api.github.com/users/dannybellis/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1317786288, "node_id": "MDU6TGFiZWwxMzE3Nzg2Mjg4", "url": "https://api.github.com/repos/secdev/scapy/labels/tls", "name": "tls", "color": "56088e", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-07-13T18:44:23Z", "updated_at": "2021-09-15T14:29:16Z", "closed_at": "2021-09-15T14:29:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Brief description\n\nI'm trying to fully defragment TLS messages, however I've run into an issue where Scapy is not able to defragment/decrypt any TLS messages after a CertificateStatus message has been sent. In the example, any messages after the CertificateStatus message appear as a raw message. In Wireshark though, these bytes are converted to their proper messages. In the example I have, I run the following code:\r\n\r\n`from scapy.all import *\r\nload_layer('tls')\r\nconf.tls_session_enable = True\r\nclass TLS_over_TCP(TLSSession, TCPSession): \r\n    pass\r\n\r\ncapture = sniff(offline=\"capture.pcap\", session=TLS_over_TCP)\r\ncapture[1].show()`\r\n\r\nwhich produces the following output:\r\n![scapy_output](https://user-images.githubusercontent.com/26009395/125507046-a926d74e-7a56-4df8-8972-55bc96a373b2.PNG)\r\n(the bytes after the certificate status are left as raw bytes)\r\n\r\nWhereas Wireshark gives the correct output:\r\n![wireshark_output](https://user-images.githubusercontent.com/26009395/125507248-52a6569c-e94a-4d9d-93e2-805a4df6b124.PNG)\r\nWhich properly displays the bytes as their respective messages (server key exchange and server hello done).\r\n\r\nI have attached the code and pcap file I'm using below. I'm on the latest version of Scapy and python 3.8\r\n[scapy_issue.zip](https://github.com/secdev/scapy/files/6811224/scapy_issue.zip)\r\n\n\n### Scapy version\n\n2.4.5\n\n### Python version\n\n3.8\n\n### Operating system\n\nWindows 10\n\n### Additional environment information\n\n_No response_\n\n### How to reproduce\n\nRun the script in the provided zip archive\r\n[scapy_issue.zip](https://github.com/secdev/scapy/files/6811181/scapy_issue.zip)\r\n\n\n### Actual result\n\n![scapy_output](https://user-images.githubusercontent.com/26009395/125506241-f7ae88f1-1cb8-4624-9946-c3ef38ab2ff8.PNG)\r\n\n\n### Expected result\n\n![wireshark_output](https://user-images.githubusercontent.com/26009395/125506273-8cd93e28-d3ad-4afb-81a0-a941e5fcdeb1.PNG)\r\n\n\n### Related resources\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3291/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3291/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3279", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3279/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3279/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3279/events", "html_url": "https://github.com/secdev/scapy/pull/3279", "id": 935016094, "node_id": "MDExOlB1bGxSZXF1ZXN0NjgyMDAzNzcx", "number": 3279, "title": "TCP defragmentation fixed", "user": {"login": "xiaohuihui1024", "id": 20126304, "node_id": "MDQ6VXNlcjIwMTI2MzA0", "avatar_url": "https://avatars.githubusercontent.com/u/20126304?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xiaohuihui1024", "html_url": "https://github.com/xiaohuihui1024", "followers_url": "https://api.github.com/users/xiaohuihui1024/followers", "following_url": "https://api.github.com/users/xiaohuihui1024/following{/other_user}", "gists_url": "https://api.github.com/users/xiaohuihui1024/gists{/gist_id}", "starred_url": "https://api.github.com/users/xiaohuihui1024/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xiaohuihui1024/subscriptions", "organizations_url": "https://api.github.com/users/xiaohuihui1024/orgs", "repos_url": "https://api.github.com/users/xiaohuihui1024/repos", "events_url": "https://api.github.com/users/xiaohuihui1024/events{/privacy}", "received_events_url": "https://api.github.com/users/xiaohuihui1024/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 3, "created_at": "2021-07-01T16:25:47Z", "updated_at": "2022-03-29T11:28:34Z", "closed_at": "2021-07-19T22:53:12Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3279", "html_url": "https://github.com/secdev/scapy/pull/3279", "diff_url": "https://github.com/secdev/scapy/pull/3279.diff", "patch_url": "https://github.com/secdev/scapy/pull/3279.patch", "merged_at": "2021-07-19T22:53:12Z"}, "body": "<!-- brief description what this PR will do, e.g. fixes broken dissection of XXX -->\r\nFixed display issues with TCP defragmentation on Wireshark\r\n\r\nfixes #3277\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3279/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3279/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3269", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3269/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3269/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3269/events", "html_url": "https://github.com/secdev/scapy/issues/3269", "id": 929152454, "node_id": "MDU6SXNzdWU5MjkxNTI0NTQ=", "number": 3269, "title": "DNSRR parser don't set rdlen", "user": {"login": "PhilippTakacs", "id": 76390863, "node_id": "MDQ6VXNlcjc2MzkwODYz", "avatar_url": "https://avatars.githubusercontent.com/u/76390863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PhilippTakacs", "html_url": "https://github.com/PhilippTakacs", "followers_url": "https://api.github.com/users/PhilippTakacs/followers", "following_url": "https://api.github.com/users/PhilippTakacs/following{/other_user}", "gists_url": "https://api.github.com/users/PhilippTakacs/gists{/gist_id}", "starred_url": "https://api.github.com/users/PhilippTakacs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PhilippTakacs/subscriptions", "organizations_url": "https://api.github.com/users/PhilippTakacs/orgs", "repos_url": "https://api.github.com/users/PhilippTakacs/repos", "events_url": "https://api.github.com/users/PhilippTakacs/events{/privacy}", "received_events_url": "https://api.github.com/users/PhilippTakacs/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-06-24T11:56:43Z", "updated_at": "2021-10-10T19:42:39Z", "closed_at": "2021-10-10T09:42:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!--\r\nThings to consider\r\n\r\n1.  Please check that you are using the latest scapy version, e.g. installed via:\r\n\r\n    `pip install --upgrade git+git://github.com/secdev/scapy`\r\n\r\n2.  If you are here to ask a question - please check previous issues and online resources, and consider using gitter instead: <https://gitter.im/secdev/scapy>\r\n\r\n3.  Please understand that **this is not a forum** but an issue tracker. The following article explains why you should limit questions asked on Github issues: <https://medium.com/@methane/why-you-must-not-ask-questions-on-github-issues-51d741d83fde>\r\n-->\r\n\r\n#### Brief description\r\n\r\n<!-- describe the main issue in one sentence -->\r\n<!-- if possible, describe what components / protocols could be affected by the issue (e.g. wrpcap() + IPv6, it is likely this also affects XXX) -->\r\nParsing a DNS Packet don't set rdlen\r\n\r\n#### Environment\r\n\r\n-   Scapy version: `2da3800b87702178a0f60598aebdd7335ce5603d`\r\n-   Python version: `3.8.5`\r\n-   Operating System: `Ubuntu 20.04.2 LTS`\r\n\r\n<!-- if needed - further information to get a picture of your setup (e.g. a sketch of your network setup) -->\r\n\r\n#### How to reproduce\r\n\r\n<!-- step-by-step explanation or a short script, may reference section 'Related resources' -->\r\n\r\n```\r\np = DNS(DNS(qd=[DNSQR()],an=[DNSRR()]).build())\r\nprint(p.an[0].rdlen)\r\n```\r\n\r\n#### Actual result\r\n\r\n```\r\nNone\r\n```\r\n\r\n<!-- dump results that outline the issue, please format your code -->\r\n\r\n#### Expected result\r\n\r\n```\r\n4\r\n```\r\n\r\n<!-- describe the expected result and outline the difference to the actual one, could also be a screen shot (e.g. wireshark) -->\r\n\r\n#### Related resources\r\n\r\n<!-- traces / sample pcaps (stripped to the relevant frames), related standards, RFCs or other resources -->\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3269/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3269/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3264", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3264/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3264/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3264/events", "html_url": "https://github.com/secdev/scapy/issues/3264", "id": 922390292, "node_id": "MDU6SXNzdWU5MjIzOTAyOTI=", "number": 3264, "title": "Scapy pipes seem broken", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-06-16T09:47:42Z", "updated_at": "2022-06-25T14:03:24Z", "closed_at": "2022-06-25T14:03:10Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "According to `git bisect`, the following code does not work since 9a9853f39f091e781321c92b574ec612e1f62ddb\r\n\r\n```\r\nfrom scapy.all import *\r\n\r\nclf = CLIFeeder()\r\npe = PipeEngine(clf)\r\npe.start()\r\nclf.send(\"Hello Scapy!\")\r\nijs = InjectSink()\r\nclf > ijs\r\npe.stop()\r\n```\r\n\r\nIt currently fails with:\r\n```\r\nERROR: piping from ObjectPipe failed: 'InjectSink' object has no attribute 's'\r\nTraceback (most recent call last):\r\n  File \"/Users/guedou/Projects/Scapy/scapy.git/scapy/pipetool.py\", line 128, in run\r\n    fd.deliver()\r\n  File \"/Users/guedou/Projects/Scapy/scapy.git/scapy/pipetool.py\", line 425, in deliver\r\n    self._send(msg)\r\n  File \"/Users/guedou/Projects/Scapy/scapy.git/scapy/pipetool.py\", line 269, in _send\r\n    s.push(msg)\r\n  File \"/Users/guedou/Projects/Scapy/scapy.git/scapy/scapypipes.py\", line 129, in push\r\n    self.s.send(msg)\r\nAttributeError: 'InjectSink' object has no attribute 's'\r\n```", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3264/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3264/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3251", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3251/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3251/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3251/events", "html_url": "https://github.com/secdev/scapy/issues/3251", "id": 913810405, "node_id": "MDU6SXNzdWU5MTM4MTA0MDU=", "number": 3251, "title": "Dot11FCS raw puts FCS checksum in wrong location", "user": {"login": "zifik", "id": 2372529, "node_id": "MDQ6VXNlcjIzNzI1Mjk=", "avatar_url": "https://avatars.githubusercontent.com/u/2372529?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zifik", "html_url": "https://github.com/zifik", "followers_url": "https://api.github.com/users/zifik/followers", "following_url": "https://api.github.com/users/zifik/following{/other_user}", "gists_url": "https://api.github.com/users/zifik/gists{/gist_id}", "starred_url": "https://api.github.com/users/zifik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zifik/subscriptions", "organizations_url": "https://api.github.com/users/zifik/orgs", "repos_url": "https://api.github.com/users/zifik/repos", "events_url": "https://api.github.com/users/zifik/events{/privacy}", "received_events_url": "https://api.github.com/users/zifik/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-06-07T18:02:08Z", "updated_at": "2021-09-13T08:19:26Z", "closed_at": "2021-09-13T08:19:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\nWhen comparing the raw bytes from a PCAP file stream to the bytes output by `raw(scapy_packet)`, the FCS checksum is in the wrong location. \r\n\r\n#### Environment\r\n\r\n-   Scapy version: 2.4.5\r\n-   Python version: 2.7.5\r\n-   Operating System: CentOS 7\r\n\r\nPCAP data is flowing into our system from an external source as raw binary data.  The raw binary data is then being read into Scapy in memory. \r\n\r\n#### How to reproduce\r\nInput data: \r\nRAW HDR \r\n```\r\n60be5ac9000c06b50000028800000288\r\n```\r\nRAW DATA \r\n```\r\n00002c002b0030000d0e00000000000010006c090000ef0067458b6b0c000000ff0105000100000000000100080054001212121212121212121212121212121212126081aaaa03000000080045000238000100004011f95e0a010101564b1e0900500017000858102f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c6574736f50656e73212121214c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e732121212f4c657473476f50656e732121212f4c657473476f50656e732121212f4c657473476f50656e732121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121214c657473476f50656e732121212f4c657473476f50656e732121212f4c657473476f50656e732121212f4c657473476f50656e73e144d992\r\n```\r\n\r\nRead into a scapy packet using:\r\n```\r\nfrom scapy.all import RawPcapReader\r\nfrom scapy.config import conf\r\n\r\ndef _parse_packet(hdr, data, number):\r\n        \"\"\"Parse packet bytes into a useable packet. Logic was copied from\r\n        Scapy's PCAP reader to make it work for our case.\r\n\r\n        Args:\r\n            hdr (str): radiotap header\r\n            data (str): packet data\r\n\r\n        Raises:\r\n            EOFError: bad header data\r\n\r\n        Returns:\r\n            Packet: Scapy Packet object\r\n        \"\"\"\r\n        if len(hdr) < 16:\r\n            raise EOFError\r\n\r\n        print \"RAW HDR \\n\" + \"\".join(\"{:02x}\".format(ord(c)) for c in hdr)\r\n        print \"RAW DATA \\n\" + \"\".join(\"{:02x}\".format(ord(c)) for c in data)\r\n        sec, usec, caplen, wirelen = struct.unpack(self.endian + \"IIII\", hdr)\r\n        pkt_info = RawPcapReader.PacketMetadata(sec=sec,\r\n                                                usec=usec,\r\n                                                wirelen=wirelen,\r\n                                                caplen=caplen)\r\n\r\n        try:\r\n            llcls = conf.l2types[127]\r\n            packet = llcls(data)\r\n        except KeyboardInterrupt:\r\n            raise\r\n        except Exception:  # pylint: disable=broad-except\r\n            if conf.debug_dissector:\r\n                from scapy.sendrecv import debug\r\n                debug.crashed_on = (self.llcls, data)\r\n                raise\r\n            packet = conf.raw_layer(data)\r\n\r\n        power = Decimal(10) ** Decimal(-9 if self.nano else -6)\r\n        packet.time = Decimal(pkt_info.sec + power * pkt_info.usec)\r\n        packet.wirelen = pkt_info.wirelen\r\n        packet.number = number\r\n\r\n        return packet\r\n```\r\n\r\n#### Actual result\r\n\r\nAfter being parsed by Scapy I wanted to recompute the FCS and compare to see if the FCS in the packet was incorrectly provided by the source system. In an attempt to do so, I realized that the FCS bytes of the Scapy output are in the wrong location.\r\n\r\n`raw(scapy_packet)` output:\r\n\r\n```\r\n00002c002b0030000d0e00000000000010006c090000ef0067458b6b0c000000ff0105000100000000000100080054001212121212121212121212121212121212126081aaaa03000000080045000238000100004011f95e0a010101564b1e090050001700085810e144d9922f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c6574736f50656e73212121214c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e732121212f4c657473476f50656e732121212f4c657473476f50656e732121212f4c657473476f50656e732121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121214c657473476f50656e732121212f4c657473476f50656e732121212f4c657473476f50656e732121212f4c657473476f50656e73\r\n```\r\n\r\nFor quick reference, the checksum in this example is `e144d992`. \r\n\r\n#### Expected result\r\n\r\nI should be able to re-calculate the checksum using something like:\r\n```\r\nfcs_layer = scapy_packet.getlayer(Dot11FCS)\r\nc_fcs = struct.unpack(\"<I\", fcs_layer.compute_fcs(raw(scapy_packet.payload)[0:-4]))[0]\r\nif c_fcs != fcs_layer.fcs:\r\n    print(\"Oops, it broke!\")\r\n```\r\nThe following is the CORRECT form of the bytes for calculating checksum.\r\n```\r\n080054001212121212121212121212121212121212126081aaaa03000000080045000238000100004011f95e0a010101564b1e0900500017000858102f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c6574736f50656e73212121214c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e732121212f4c657473476f50656e732121212f4c657473476f50656e732121212f4c657473476f50656e732121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121214c657473476f50656e732121212f4c657473476f50656e732121212f4c657473476f50656e732121212f4c657473476f50656e73\r\n```\r\nYou can use https://crccalc.com/ to verify.\r\n\r\nA different view in normal text so its easy to see where the FCS is in the Scapy output -- which is incorrect. (Browser search feature with highlight text helps too)\r\n\r\n080054001212121212121212121212121212121212126081aaaa03000000080045000238000100004011f95e0a010101564b1e090050001700085810____e144d992____2f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c6574736f50656e73212121214c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e732121212f4c657473476f50656e732121212f4c657473476f50656e732121212f4c657473476f50656e732121212f4c657473476f50656e73212121212f4c657473476f50656e73212121212f4c657473476f50656e73212121214c657473476f50656e732121212f4c657473476f50656e732121212f4c657473476f50656e732121212f4c657473476f50656e73\r\n\r\n### External Resources\r\nhttps://crccalc.com/ - I used hex input and hex output to confirm. \r\n\r\nNOTE: The bytes for the checksum are reversed inside of raw data. So with a CRC32 of  `0x43A22AF0`, you will see the bytes in the data above as `f02aa243`\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3251/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3251/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3246", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3246/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3246/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3246/events", "html_url": "https://github.com/secdev/scapy/issues/3246", "id": 908660525, "node_id": "MDU6SXNzdWU5MDg2NjA1MjU=", "number": 3246, "title": "scapy.layers.inet import error on macOS 10.15.7", "user": {"login": "dantebben", "id": 20460641, "node_id": "MDQ6VXNlcjIwNDYwNjQx", "avatar_url": "https://avatars.githubusercontent.com/u/20460641?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dantebben", "html_url": "https://github.com/dantebben", "followers_url": "https://api.github.com/users/dantebben/followers", "following_url": "https://api.github.com/users/dantebben/following{/other_user}", "gists_url": "https://api.github.com/users/dantebben/gists{/gist_id}", "starred_url": "https://api.github.com/users/dantebben/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dantebben/subscriptions", "organizations_url": "https://api.github.com/users/dantebben/orgs", "repos_url": "https://api.github.com/users/dantebben/repos", "events_url": "https://api.github.com/users/dantebben/events{/privacy}", "received_events_url": "https://api.github.com/users/dantebben/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1265179855, "node_id": "MDU6TGFiZWwxMjY1MTc5ODU1", "url": "https://api.github.com/repos/secdev/scapy/labels/platform-specific", "name": "platform-specific", "color": "14acba", "default": false, "description": ""}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2021-06-01T20:25:45Z", "updated_at": "2023-02-16T16:24:44Z", "closed_at": "2021-07-13T22:39:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!--\r\nThings to consider\r\n\r\n1.  Please check that you are using the latest scapy version, e.g. installed via:\r\n\r\n    `pip install --upgrade git+git://github.com/secdev/scapy`\r\n\r\n2.  If you are here to ask a question - please check previous issues and online resources, and consider using gitter instead: <https://gitter.im/secdev/scapy>\r\n\r\n3.  Please understand that **this is not a forum** but an issue tracker. The following article explains why you should limit questions asked on Github issues: <https://medium.com/@methane/why-you-must-not-ask-questions-on-github-issues-51d741d83fde>\r\n-->\r\n\r\n#### Brief description\r\n\r\n<!-- describe the main issue in one sentence -->\r\nCannot import from `scapy.layers.inet` on macOS Catalina 10.15.7.  Get an Import Error:  Cannot import AnsweringMachine\r\n<!-- if possible, describe what components / protocols could be affected by the issue (e.g. wrpcap() + IPv6, it is likely this also affects XXX) -->\r\nThis affects importing  `IP`, `Ether`, `UDP`, `TCP`, etc. from `scapy.layers.inet`.  A similar error message is produced when trying to import `PPP`, `HDLC`, etc. from `scapy.layers.ppp`.\r\n\r\n#### Environment\r\n\r\n-   Scapy version: 2.4.5 (also tried with 2.4.0, 2.4.1)\r\n-   Python version: 3.9.5 (also tried with 3.9.1 and 3.8.10)\r\n-   Operating System: macOS 10.15.7 Catalina\r\n\r\n<!-- if needed - further information to get a picture of your setup (e.g. a sketch of your network setup) -->\r\nI have tried this on two MacBookPros, a fresh VM, plus a brand new Mac Mini that I just received.  Everything is running macOS 10.15.7.  This was working perhaps a month ago, so I tried rolling back to a previous version of Scapy (2.4.0, 2.4.1) and also previous versions of Python (3.9.1).  In each case the results are the same.  I do not see this issue on Ubuntu 20.04.  \r\n\r\n#### How to reproduce\r\n\r\n<!-- step-by-step explanation or a short script, may reference section 'Related resources' -->\r\n```python\r\nfrom scapy.layers.inet import IP\r\n```\r\n\r\n\r\n#### Actual result\r\n\r\n<!-- dump results that outline the issue, please format your code -->\r\n```python\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/Users/xxxxxxx/test_scapy/venv/lib/python3.9/site-packages/scapy/layers/inet.py\", line 22, in <module>\r\n    from scapy.ansmachine import AnsweringMachine\r\n  File \"/Users/xxxxxx/test_scapy/venv/lib/python3.9/site-packages/scapy/ansmachine.py\", line 20, in <module>\r\n    from scapy.sendrecv import send, sniff\r\n  File \"/Users/xxxxxx/test_scapy/venv/lib/python3.9/site-packages/scapy/sendrecv.py\", line 61, in <module>\r\n    import scapy.route  # noqa: F401\r\n  File \"/Users/xxxxxx/test_scapy/venv/lib/python3.9/site-packages/scapy/route.py\", line 218, in <module>\r\n    conf.route = Route()\r\n  File \"/Users/xxxxxx/test_scapy/venv/lib/python3.9/site-packages/scapy/route.py\", line 37, in __init__\r\n    self.resync()\r\n  File \"/Users/xxxxxx/test_scapy/venv/lib/python3.9/site-packages/scapy/route.py\", line 45, in resync\r\n    from scapy.arch import read_routes\r\n  File \"/Users/xxxxxx/test_scapy/venv/lib/python3.9/site-packages/scapy/arch/__init__.py\", line 130, in <module>\r\n    from scapy.arch.bpf.supersocket import *  # noqa F403\r\n  File \"/Users/xxxxxx/test_scapy/venv/lib/python3.9/site-packages/scapy/arch/bpf/supersocket.py\", line 27, in <module>\r\n    from scapy.layers.l2 import Loopback\r\n  File \"/Users/xxxxxx/test_scapy/venv/lib/python3.9/site-packages/scapy/layers/l2.py\", line 17, in <module>\r\n    from scapy.ansmachine import AnsweringMachine\r\nImportError: cannot import name 'AnsweringMachine' from partially initialized module 'scapy.ansmachine' (most likely due to a circular import) (/Users/xxxxxx/test_scapy/venv/lib/python3.9/site-packages/scapy/ansmachine.py)\r\n```\r\n\r\n\r\n#### Expected result\r\n\r\n<!-- describe the expected result and outline the difference to the actual one, could also be a screen shot (e.g. wireshark) -->\r\n\r\nNo Error messages, just the IP class has been imported.\r\n\r\n\r\n#### Related resources\r\n\r\nI have found a few work arounds, but each requires changing a large set of Scapy files I have created over time.\r\n\r\n##### Workaround 1\r\n```python\r\nfrom scapy.all import IP.  # this works, but an IDE such as PyCharm doesn't like it because scapy.all doesn't list IP\r\n```\r\n\r\n##### Workaround 2\r\n```python\r\nfrom scapy.arch import str2mac  # this works, but linters such as flake8 don't like it because of unused imports\r\nfrom scapy.layers.inet import IP  \r\n```\r\n\r\n##### Workaround 3 (this one is strange)\r\nWhen in an interactive environment such as iPython, using `tab-complete`, but not actually importing from scapy.arch\r\n```python\r\nfrom scapy.arch import st[TAB]  # then delete the line after the tab-complete options appear\r\nfrom scapy.layers.inet import IP\r\n```\r\n\r\n\r\n\r\n\r\n<!-- traces / sample pcaps (stripped to the relevant frames), related standards, RFCs or other resources -->\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3246/reactions", "total_count": 9, "+1": 9, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3246/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3240", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3240/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3240/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3240/events", "html_url": "https://github.com/secdev/scapy/pull/3240", "id": 906889220, "node_id": "MDExOlB1bGxSZXF1ZXN0NjU3ODExODcy", "number": 3240, "title": "Do not resolve the interface name globally", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 1, "created_at": "2021-05-30T21:38:46Z", "updated_at": "2022-03-29T11:28:27Z", "closed_at": "2021-05-31T18:38:33Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3240", "html_url": "https://github.com/secdev/scapy/pull/3240", "diff_url": "https://github.com/secdev/scapy/pull/3240.diff", "patch_url": "https://github.com/secdev/scapy/pull/3240.patch", "merged_at": "2021-05-31T18:38:33Z"}, "body": "- mostly like https://github.com/secdev/scapy/pull/3209 but with a test. (closes https://github.com/secdev/scapy/pull/3209)\r\n- fixes https://github.com/secdev/scapy/issues/3191\r\n\r\nSee also https://github.com/secdev/scapy/pull/3234", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3240/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3240/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3238", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3238/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3238/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3238/events", "html_url": "https://github.com/secdev/scapy/issues/3238", "id": 906572459, "node_id": "MDU6SXNzdWU5MDY1NzI0NTk=", "number": 3238, "title": "Frame with a RadioTap header is being parsed incorrectly", "user": {"login": "carcigenicate", "id": 18216244, "node_id": "MDQ6VXNlcjE4MjE2MjQ0", "avatar_url": "https://avatars.githubusercontent.com/u/18216244?v=4", "gravatar_id": "", "url": "https://api.github.com/users/carcigenicate", "html_url": "https://github.com/carcigenicate", "followers_url": "https://api.github.com/users/carcigenicate/followers", "following_url": "https://api.github.com/users/carcigenicate/following{/other_user}", "gists_url": "https://api.github.com/users/carcigenicate/gists{/gist_id}", "starred_url": "https://api.github.com/users/carcigenicate/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/carcigenicate/subscriptions", "organizations_url": "https://api.github.com/users/carcigenicate/orgs", "repos_url": "https://api.github.com/users/carcigenicate/repos", "events_url": "https://api.github.com/users/carcigenicate/events{/privacy}", "received_events_url": "https://api.github.com/users/carcigenicate/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-05-29T22:21:17Z", "updated_at": "2022-07-23T17:27:33Z", "closed_at": "2021-05-30T23:15:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\n\r\n`RadioTap` packets are being parsed improperly, which is causing the rest of the data to be parsed incorrectly as well.\r\n\r\nIn my specific case, a UDP datagram is being misinterpreted as a Dot11 Reassociation Response.\r\n\r\n#### Environment\r\n\r\n-   Scapy version: `2.4.5rc1.dev35`\r\n-   Python version: `3.9`\r\n-   Operating System: `ParrotOS` (`Linux parrot 5.10.0-6parrot1-amd64 #1 SMP Debian 5.10.28-6parrot1 (2021-04-12) x86_64 GNU/Linux`)\r\n\r\nThe capture is being done with a [BrosTrend adapter](https://www.amazon.ca/gp/product/B01BV91L7Y/ref=ppx_yo_dt_b_asin_title_o03_s00?ie=UTF8&psc=1).\r\n\r\n#### How to reproduce\r\n\r\nEither `sniff` or load a `pcap` using `PcapReader` that contains certain \"Radio Tap\" headers. Some packets parse fine, many don't.\r\n\r\n```python\r\nfrom scapy.all import *\r\nRadioTap(b'\\x00\\x00\\x15\\x00*H\\x08\\x00\\x10\\x00v\\t\\x80\\x04\\xec\\x00\\x00\\x00\\x00\\x00\\x0e\\x88\\x010\\x00\\x00&Z\\xfd\\x8a\\x08\\xa0\\xc9\\xa0\\x9d\\xaa\\xb9\\x00&Z\\xfd\\x8a\\x08P\\x01\\x00\\x00\\xaa\\xaa\\x03\\x00\\x00\\x00\\x08\\x00E\\x00\\x00KO\\xb6@\\x00@\\x11\\xa35\\xc0\\xa8cd\\xc0\\xa8c\\x01X1\\x005\\x007\\xf4\\x97D|\\x01\\x00\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x11connectivitycheck\\x07gstatic\\x03com\\x00\\x00\\x01\\x00\\x01\\x8f\\x86\\x1bH')\r\n\r\n<RadioTap  version=0 pad=0 len=21 present=Flags+Channel+dBm_AntSignal+Antenna+RXFlags+MCS Flags=FCS ChannelFrequency=2422 ChannelFlags=2GHz+Dynamic_CCK_OFDM dBm_AntSignal=-20 dBm Antenna=0 RXFlags= knownMCS=MCS_index+guard_interval+HT_format Ness_LSB=1 STBC_streams=0 FEC_type=BCC HT_format=greenfield guard_interval=Long_GI MCS_bandwidth=20MHz MCS_index=1 notdecoded='' |<Dot11FCS  subtype=Reassociation Response type=Management proto=0 FCfield= ID=38 addr1=5a:fd:8a:08:a0:c9 (RA=DA) addr2=a0:9d:aa:b9:00:26 (TA=SA) addr3=5a:fd:8a:08:50:01 (BSSID/STA) SC=0 fcs=0x481b868f |<Dot11ReassoResp  cap=res9+res11+DSSS-OFDM+res15+IBSS+CFP-req+short-preamble+agility status=3 AID=0 |<Dot11Elt  ID=8 len=0 info='' |<Dot11Elt  ID=69 len=0 info='' |<Dot11Elt  ID=SSID len=75 info='O\\\\xb6@\\x00@\\x11\\\\xa35\\\\xc0\\\\xa8cd\\\\xc0\\\\xa8c\\x01X1\\x005\\x007\\\\xf4\\\\x97D|\\x01\\x00\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x11connectivitycheck\\x07gstatic\\x03com\\x00\\x00\\x01\\x00\\x01' |>>>>>>\r\n```\r\n\r\nor from a capture (included at the end):\r\n\r\n```python\r\nfrom scapy.all import *\r\n\r\nngRdr = PcapReader(\"badDNS.pcap\")\r\n\r\nfor pkt in ngRdr:\r\n    print(pkt.show())\r\n\r\n###[ RadioTap ]### \r\n  version   = 0\r\n  pad       = 0\r\n  len       = 21\r\n  present   = Flags+Channel+dBm_AntSignal+Antenna+RXFlags+MCS\r\n  Flags     = FCS\r\n  ChannelFrequency= 2422\r\n  ChannelFlags= 2GHz+Dynamic_CCK_OFDM\r\n  dBm_AntSignal= -20 dBm\r\n  Antenna   = 0\r\n  RXFlags   = \r\n  knownMCS  = MCS_index+guard_interval+HT_format\r\n  Ness_LSB  = 1\r\n  STBC_streams= 0\r\n  FEC_type  = BCC\r\n  HT_format = greenfield\r\n  guard_interval= Long_GI\r\n  MCS_bandwidth= 20MHz\r\n  MCS_index = 1\r\n  notdecoded= ''\r\n###[ 802.11-FCS ]### \r\n     subtype   = Reassociation Response\r\n     type      = Management\r\n     proto     = 0\r\n     FCfield   = \r\n     ID        = 38\r\n     addr1     = 5a:fd:8a:08:a0:c9 (RA=DA)\r\n     addr2     = a0:9d:aa:b9:00:26 (TA=SA)\r\n     addr3     = 5a:fd:8a:08:50:01 (BSSID/STA)\r\n     SC        = 0\r\n     fcs       = 0x481b868f\r\n###[ 802.11 Reassociation Response ]### \r\n        cap       = res9+res11+DSSS-OFDM+res15+IBSS+CFP-req+short-preamble+agility\r\n        status    = 3\r\n        AID       = 0\r\n###[ 802.11 Information Element ]### \r\n           ID        = 8\r\n           len       = 0\r\n           info      = ''\r\n###[ 802.11 Information Element ]### \r\n           ID        = 69\r\n           len       = 0\r\n           info      = ''\r\n###[ 802.11 Information Element ]### \r\n           ID        = SSID\r\n           len       = 75\r\n           info      = 'O\\\\xb6@\\x00@\\x11\\\\xa35\\\\xc0\\\\xa8cd\\\\xc0\\\\xa8c\\x01X1\\x005\\x007\\\\xf4\\\\x97D|\\x01\\x00\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x11connectivitycheck\\x07gstatic\\x03com\\x00\\x00\\x01\\x00\\x01'\r\n\r\n\r\n```\r\n\r\nThis is supposed to be a DNS query (note the `connectivitycheck\\x07gstatic\\x03com` near the end). Wireshark parses it properly:\r\n\r\n![image](https://user-images.githubusercontent.com/18216244/120085771-29931880-c098-11eb-9b8a-3e9abfa1323f.png)\r\n\r\nMost of the `RadioTap` header parses fine, but you can see that by the end, the MCS Index is wrong:\r\n\r\n![image](https://user-images.githubusercontent.com/18216244/120085831-9c9c8f00-c098-11eb-97d4-76454461dca2.png)\r\n\r\nAfter that it gets worse. It thinks the next layer down is a Reassociation Response, when it should be a `Dot11QoS` (I believe):\r\n\r\n![image](https://user-images.githubusercontent.com/18216244/120085861-d2417800-c098-11eb-9c07-2e1fb9c3fbae.png)\r\n\r\n\r\n#### Related resources\r\n\r\n[Sample PCAP](https://drive.google.com/file/d/1HKchuz2v6HsQrudjmGoRT4YvSDqNENQb/view?usp=sharing)", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3238/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3238/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3218", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3218/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3218/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3218/events", "html_url": "https://github.com/secdev/scapy/pull/3218", "id": 891449182, "node_id": "MDExOlB1bGxSZXF1ZXN0NjQ0MzE5MTU2", "number": 3218, "title": "Fix regression: KeyError on EnumField", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 2, "created_at": "2021-05-13T23:05:21Z", "updated_at": "2022-03-29T11:30:00Z", "closed_at": "2021-05-30T21:45:34Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3218", "html_url": "https://github.com/secdev/scapy/pull/3218", "diff_url": "https://github.com/secdev/scapy/pull/3218.diff", "patch_url": "https://github.com/secdev/scapy/pull/3218.patch", "merged_at": "2021-05-30T21:45:34Z"}, "body": "fixes https://github.com/secdev/scapy/issues/3200", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3218/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3218/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3214", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3214/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3214/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3214/events", "html_url": "https://github.com/secdev/scapy/pull/3214", "id": 887552812, "node_id": "MDExOlB1bGxSZXF1ZXN0NjQwNzc3NDA3", "number": 3214, "title": "Added proper OIDs in defaul issuer, subject and directory name classes", "user": {"login": "martingalloar", "id": 3941628, "node_id": "MDQ6VXNlcjM5NDE2Mjg=", "avatar_url": "https://avatars.githubusercontent.com/u/3941628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/martingalloar", "html_url": "https://github.com/martingalloar", "followers_url": "https://api.github.com/users/martingalloar/followers", "following_url": "https://api.github.com/users/martingalloar/following{/other_user}", "gists_url": "https://api.github.com/users/martingalloar/gists{/gist_id}", "starred_url": "https://api.github.com/users/martingalloar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/martingalloar/subscriptions", "organizations_url": "https://api.github.com/users/martingalloar/orgs", "repos_url": "https://api.github.com/users/martingalloar/repos", "events_url": "https://api.github.com/users/martingalloar/events{/privacy}", "received_events_url": "https://api.github.com/users/martingalloar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 3, "created_at": "2021-05-11T15:00:15Z", "updated_at": "2022-03-29T11:29:59Z", "closed_at": "2021-05-14T07:15:27Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3214", "html_url": "https://github.com/secdev/scapy/pull/3214", "diff_url": "https://github.com/secdev/scapy/pull/3214.diff", "patch_url": "https://github.com/secdev/scapy/pull/3214.patch", "merged_at": "2021-05-14T07:15:27Z"}, "body": "The default constructs for Issuer, Subject and Directory Name in the X.509 layer were missing the proper set of the OID elements and instead used plain strings for the OID.\r\n\r\nBefore the PR:\r\n```\r\nIn [1]: from scapy.layers.x509 import *\r\n\r\nIn [2]: X509_DirectoryName\r\nOut[2]: scapy.layers.x509.X509_DirectoryName\r\n\r\nIn [3]: dn = X509_DirectoryName()\r\n\r\nIn [4]: dn\r\nOut[4]: <X509_DirectoryName  directoryName=[<X509_RDN  rdn=[<X509_AttributeTypeAndValue  |>] |>, <X509_RDN  rdn=[<X509_AttributeTypeAndValue  type='2.5.4.10' value=<ASN1_PRINTABLE_STRING['Scapy, Inc.']> |>] |>, <X509_RDN  rdn=[<X509_AttributeTypeAndValue  type='2.5.4.3' value=<ASN1_PRINTABLE_STRING['Scapy Default Name']> |>] |>] |>\r\n\r\nIn [5]: dn.show()\r\n###[ X509_DirectoryName ]### \r\n  \\directoryName\\\r\n   |###[ X509_RDN ]### \r\n   |  \\rdn       \\\r\n   |   |###[ X509_AttributeTypeAndValue ]### \r\n   |   |  type      = <ASN1_OID['countryName']>\r\n   |   |  value     = <ASN1_PRINTABLE_STRING['FR']>\r\n   |###[ X509_RDN ]### \r\n   |  \\rdn       \\\r\n   |   |###[ X509_AttributeTypeAndValue ]### \r\n   |   |  type      = '2.5.4.10'\r\n   |   |  value     = <ASN1_PRINTABLE_STRING['Scapy, Inc.']>\r\n   |###[ X509_RDN ]### \r\n   |  \\rdn       \\\r\n   |   |###[ X509_AttributeTypeAndValue ]### \r\n   |   |  type      = '2.5.4.3'\r\n   |   |  value     = <ASN1_PRINTABLE_STRING['Scapy Default Name']>\r\n```\r\n\r\nAfter the PR:\r\n```\r\nIn [1]: from scapy.layers.x509 import *\r\n\r\nIn [2]: dn = X509_DirectoryName()\r\n\r\nIn [3]: dn.show()\r\n###[ X509_DirectoryName ]### \r\n  \\directoryName\\\r\n   |###[ X509_RDN ]### \r\n   |  \\rdn       \\\r\n   |   |###[ X509_AttributeTypeAndValue ]### \r\n   |   |  type      = <ASN1_OID['countryName']>\r\n   |   |  value     = <ASN1_PRINTABLE_STRING['FR']>\r\n   |###[ X509_RDN ]### \r\n   |  \\rdn       \\\r\n   |   |###[ X509_AttributeTypeAndValue ]### \r\n   |   |  type      = <ASN1_OID['organizationName']>\r\n   |   |  value     = <ASN1_PRINTABLE_STRING['Scapy, Inc.']>\r\n   |###[ X509_RDN ]### \r\n   |  \\rdn       \\\r\n   |   |###[ X509_AttributeTypeAndValue ]### \r\n   |   |  type      = <ASN1_OID['commonName']>\r\n   |   |  value     = <ASN1_PRINTABLE_STRING['Scapy Default Name']>\r\n```", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3214/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3214/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3212", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3212/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3212/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3212/events", "html_url": "https://github.com/secdev/scapy/pull/3212", "id": 887138743, "node_id": "MDExOlB1bGxSZXF1ZXN0NjQwMzg3NDIw", "number": 3212, "title": "Improvements to `select_objects` on Windows", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 514033136, "node_id": "MDU6TGFiZWw1MTQwMzMxMzY=", "url": "https://api.github.com/repos/secdev/scapy/labels/tests", "name": "tests", "color": "0e8a16", "default": false, "description": null}, {"id": 1265179855, "node_id": "MDU6TGFiZWwxMjY1MTc5ODU1", "url": "https://api.github.com/repos/secdev/scapy/labels/platform-specific", "name": "platform-specific", "color": "14acba", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 2, "created_at": "2021-05-11T12:34:19Z", "updated_at": "2022-03-29T11:29:58Z", "closed_at": "2021-05-11T18:04:23Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3212", "html_url": "https://github.com/secdev/scapy/pull/3212", "diff_url": "https://github.com/secdev/scapy/pull/3212.diff", "patch_url": "https://github.com/secdev/scapy/pull/3212.patch", "merged_at": "2021-05-11T18:04:22Z"}, "body": "This PR performs some additional cleanups to `select_objects` on windows:\r\n- remove `SelectableObject`. Merge it into `ObjectPipe`. It was complicated to use + unless people were using it with `ObjectPipe`, it wouldn't use the fancy new system. This will force us to use the new elegant system implemented in `ObjectPipe`.\r\n- fix https://github.com/secdev/scapy/issues/3206 and other various bugs in the implementation", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3212/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3212/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3209", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3209/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3209/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3209/events", "html_url": "https://github.com/secdev/scapy/pull/3209", "id": 883880240, "node_id": "MDExOlB1bGxSZXF1ZXN0NjM3MzE0MDc1", "number": 3209, "title": "Do not resolve the interface name globally", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-05-10T10:03:44Z", "updated_at": "2021-05-31T18:38:33Z", "closed_at": "2021-05-31T18:38:33Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3209", "html_url": "https://github.com/secdev/scapy/pull/3209", "diff_url": "https://github.com/secdev/scapy/pull/3209.diff", "patch_url": "https://github.com/secdev/scapy/pull/3209.patch", "merged_at": null}, "body": "This PR fixes #3191. I do not know how to test it =/", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3209/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3209/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3206", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3206/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3206/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3206/events", "html_url": "https://github.com/secdev/scapy/issues/3206", "id": 877294185, "node_id": "MDU6SXNzdWU4NzcyOTQxODU=", "number": 3206, "title": "Pipetools is failing on appveyor", "user": {"login": "polybassa", "id": 1676055, "node_id": "MDQ6VXNlcjE2NzYwNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1676055?v=4", "gravatar_id": "", "url": "https://api.github.com/users/polybassa", "html_url": "https://github.com/polybassa", "followers_url": "https://api.github.com/users/polybassa/followers", "following_url": "https://api.github.com/users/polybassa/following{/other_user}", "gists_url": "https://api.github.com/users/polybassa/gists{/gist_id}", "starred_url": "https://api.github.com/users/polybassa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/polybassa/subscriptions", "organizations_url": "https://api.github.com/users/polybassa/orgs", "repos_url": "https://api.github.com/users/polybassa/repos", "events_url": "https://api.github.com/users/polybassa/events{/privacy}", "received_events_url": "https://api.github.com/users/polybassa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 514033136, "node_id": "MDU6TGFiZWw1MTQwMzMxMzY=", "url": "https://api.github.com/repos/secdev/scapy/labels/tests", "name": "tests", "color": "0e8a16", "default": false, "description": null}, {"id": 1265179855, "node_id": "MDU6TGFiZWwxMjY1MTc5ODU1", "url": "https://api.github.com/repos/secdev/scapy/labels/platform-specific", "name": "platform-specific", "color": "14acba", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-05-06T09:27:57Z", "updated_at": "2021-05-11T18:04:22Z", "closed_at": "2021-05-11T18:04:22Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "@gpotter2 I looked a little bit into the current errors on appveyor. The reason for the failed tests is the changed value of the ``remainms`` parameter in these lines: https://github.com/secdev/scapy/blob/db698d2ddebb1a0b3fa53247117f0fb6ef9950bc/scapy/automaton.py#L104-L113\r\nBut I've to less understanding of windows to figure out whats going on here.\r\n\r\n_Originally posted by @polybassa in https://github.com/secdev/scapy/issues/3197#issuecomment-830645927_", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3206/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3206/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3202", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3202/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3202/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3202/events", "html_url": "https://github.com/secdev/scapy/issues/3202", "id": 875484003, "node_id": "MDU6SXNzdWU4NzU0ODQwMDM=", "number": 3202, "title": "Wrong Modbus response code / class match", "user": {"login": "d3lb3", "id": 30991560, "node_id": "MDQ6VXNlcjMwOTkxNTYw", "avatar_url": "https://avatars.githubusercontent.com/u/30991560?v=4", "gravatar_id": "", "url": "https://api.github.com/users/d3lb3", "html_url": "https://github.com/d3lb3", "followers_url": "https://api.github.com/users/d3lb3/followers", "following_url": "https://api.github.com/users/d3lb3/following{/other_user}", "gists_url": "https://api.github.com/users/d3lb3/gists{/gist_id}", "starred_url": "https://api.github.com/users/d3lb3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/d3lb3/subscriptions", "organizations_url": "https://api.github.com/users/d3lb3/orgs", "repos_url": "https://api.github.com/users/d3lb3/repos", "events_url": "https://api.github.com/users/d3lb3/events{/privacy}", "received_events_url": "https://api.github.com/users/d3lb3/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-05-04T13:51:10Z", "updated_at": "2021-05-30T22:52:57Z", "closed_at": "2021-05-30T22:52:57Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "#### Description\r\n\r\nModbus PDUs are determined by function codes. \r\nExample : a _Read Coils_ PDU is associated with the code _0x01_.\r\n\r\nIf the received code is superior to _0x80_, then it is interpreted as an exception code. \r\nExample : a _Read Coils exception PDU_ is associated with the exception code _0x81_.\r\n\r\nScapy's Modbus contrib module associates codes to the appropriate Packet class in various dictionaries.\r\nExample :\r\n```\r\n_modbus_response_classes = {\r\n    0x01: ModbusPDU01ReadCoilsResponse,\r\n    0x02: ModbusPDU02ReadDiscreteInputsResponse,\r\n    0x03: ModbusPDU03ReadHoldingRegistersResponse,\r\n   ...\r\n}\r\n```\r\n\r\nIn Scapy version: 2.4.4.dev318, some code associations do not fit Modbus specifications. \r\nFor example _ModbusPDU08DiagnosticsResponse_ class is associated with the exception code _0x88_ instead of the response code _0x08_. \r\nTherefore, when the _0x88_ exception code is received, it is badly interpreted as a Raw payload instead of Modbus PDUs (this is determined in see _ModbusADUResponse_'s _guess_payload_class_ method). \r\nSimilarly, _ModbusPDU0BGetCommEventCounterResponse_ is associated with code _0x8B_ instead of _0x0B_.\r\n\r\nI am opening a PR to fix the issue.\r\n\r\n#### How to reproduce\r\n\r\n```python\r\n>>> from scapy.contrib.modbus import ModbusADUResponse\r\n>>> pkt = ModbusADUResponse(b\"\\x00\\x00\\x00\\x00\\x00\\x03\\x00\\x88\\x01\")\r\n>>> pkt.show2()\r\n```\r\n\r\n#### Actual result\r\n\r\n```python\r\n###[ ModbusADU ]### \r\n  transId   = 0x0\r\n  protoId   = 0x0\r\n  len       = 3\r\n  unitId    = 0x0\r\n###[ Raw ]### \r\n     load      = '\\x88\\x01'\r\n```\r\n\r\n#### Expected result\r\n\r\n```python\r\n###[ ModbusADU ]### \r\n  transId   = 0x0\r\n  protoId   = 0x0\r\n  len       = 3\r\n  unitId    = 0x0\r\n###[ Diagnostics Exception ]### \r\n     funcCode  = 0x88\r\n     exceptionCode= Illegal Function Code\r\n```\r\n\r\n#### Related resources\r\n\r\nModbus Specifications : https://modbus.org/docs/Modbus_Application_Protocol_V1_1b3.pdf (sections 6.8 and 6.9)\r\n\r\nPacket capture : [modbus_exceptions.zip](https://github.com/secdev/scapy/files/6421496/modbus_exceptions.zip)\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3202/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3202/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3200", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3200/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3200/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3200/events", "html_url": "https://github.com/secdev/scapy/issues/3200", "id": 871833121, "node_id": "MDU6SXNzdWU4NzE4MzMxMjE=", "number": 3200, "title": "EnumFields not raising KeyError", "user": {"login": "martingalloar", "id": 3941628, "node_id": "MDQ6VXNlcjM5NDE2Mjg=", "avatar_url": "https://avatars.githubusercontent.com/u/3941628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/martingalloar", "html_url": "https://github.com/martingalloar", "followers_url": "https://api.github.com/users/martingalloar/followers", "following_url": "https://api.github.com/users/martingalloar/following{/other_user}", "gists_url": "https://api.github.com/users/martingalloar/gists{/gist_id}", "starred_url": "https://api.github.com/users/martingalloar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/martingalloar/subscriptions", "organizations_url": "https://api.github.com/users/martingalloar/orgs", "repos_url": "https://api.github.com/users/martingalloar/repos", "events_url": "https://api.github.com/users/martingalloar/events{/privacy}", "received_events_url": "https://api.github.com/users/martingalloar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-04-30T02:23:34Z", "updated_at": "2021-05-30T21:45:34Z", "closed_at": "2021-05-30T21:45:34Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nStarting with Scapy 2.4.5 and in Python 2.7, `EnumField`s are not raising `KeyError` when provided with a value not defined as part of the enum and not corresponding to any key.\r\n\r\n#### Environment\r\n\r\n-   Scapy version:  2.4.5\r\n-   Python version: 2.7\r\n-   Operating System: *\r\n\r\n#### How to reproduce\r\n\r\n```\r\nclass Test(Packet):\r\n    fields_desc = [\r\n        ByteEnumField(\"enum\", 0, {0: \"zero\", 1: \"one\"})\r\n    ]\r\n\r\nTest(enum=0).show()\r\nTest(enum=1).show()\r\nTest(enum=2).show()\r\nTest(enum=\"zero\").show()\r\nTest(enum=\"one\").show()\r\nTest(enum=\"two\").show()\r\n```\r\n\r\n#### Actual result\r\n\r\n```\r\n###[ Test ]### \r\n  enum      = zero\r\n\r\n###[ Test ]### \r\n  enum      = one\r\n\r\n###[ Test ]### \r\n  enum      = 2\r\n\r\n###[ Test ]### \r\n  enum      = zero\r\n\r\n###[ Test ]### \r\n  enum      = one\r\n\r\n###[ Test ]### \r\n  enum      = 'two'\r\n```\r\n\r\n#### Expected result\r\n\r\n(from Scapy 2.4.4)\r\n```\r\n###[ Test ]### \r\n  enum      = zero\r\n\r\n###[ Test ]### \r\n  enum      = one\r\n\r\n###[ Test ]### \r\n  enum      = 2\r\n\r\n###[ Test ]### \r\n  enum      = zero\r\n\r\n###[ Test ]### \r\n  enum      = one\r\n\r\nTraceback (most recent call last):\r\n  File \"enum_test.py\", line 15, in <module>\r\n    Test(enum=\"two\").show()\r\n  File \"/home/martin/workspace/scapy/scapy/base_classes.py\", line 266, in __call__\r\n    i.__init__(*args, **kargs)\r\n  File \"/home/martin/workspace/scapy/scapy/packet.py\", line 170, in __init__\r\n    self.fields[fname] = self.get_field(fname).any2i(self, value)\r\n  File \"/home/martin/workspace/scapy/scapy/fields.py\", line 1808, in any2i\r\n    return self.any2i_one(pkt, x)\r\n  File \"/home/martin/workspace/scapy/scapy/fields.py\", line 1787, in any2i_one\r\n    x = self.s2i[x]\r\nKeyError: 'two'\r\n```\r\n\r\n#### Related resources\r\n\r\nI think this was introduced somehow in https://github.com/secdev/scapy/commit/f04b0ae1acf0cb72ce71103c52abbbc020405c68#diff-330de0527046a0fc8af1b24fbea040a50e66ca5fcf47b1c9296e48591b383074R2251", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3200/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3200/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3197", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3197/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3197/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3197/events", "html_url": "https://github.com/secdev/scapy/issues/3197", "id": 870265927, "node_id": "MDU6SXNzdWU4NzAyNjU5Mjc=", "number": 3197, "title": "100% CPU load with Pipetools on 2.4.5", "user": {"login": "micheloe", "id": 24808865, "node_id": "MDQ6VXNlcjI0ODA4ODY1", "avatar_url": "https://avatars.githubusercontent.com/u/24808865?v=4", "gravatar_id": "", "url": "https://api.github.com/users/micheloe", "html_url": "https://github.com/micheloe", "followers_url": "https://api.github.com/users/micheloe/followers", "following_url": "https://api.github.com/users/micheloe/following{/other_user}", "gists_url": "https://api.github.com/users/micheloe/gists{/gist_id}", "starred_url": "https://api.github.com/users/micheloe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/micheloe/subscriptions", "organizations_url": "https://api.github.com/users/micheloe/orgs", "repos_url": "https://api.github.com/users/micheloe/repos", "events_url": "https://api.github.com/users/micheloe/events{/privacy}", "received_events_url": "https://api.github.com/users/micheloe/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2021-04-28T19:15:45Z", "updated_at": "2021-05-01T15:09:39Z", "closed_at": "2021-04-29T07:51:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nWhile sniffing for probe requests on a wireless interface on a Raspberry Pi 4 Model B Rev 1.4, one CPU core is constantly 100% busy.\r\n\r\n#### Environment\r\n\r\n-   Scapy version: 2.4.5 / master branch\r\n-   Python version: 3.7.3\r\n-   Operating System: Raspbian GNU/Linux 10 (buster)\r\n\r\n#### How to reproduce\r\n\r\n1. Put the wireless interface in monitor mode:\r\n```bash\r\nip link set wlanX down\r\niw dev wlanX set type monitor\r\nip link set wlanX up\r\n```\r\n\r\n2. Start sniffing for probe requests:\r\n```python\r\nsource = SniffSource(iface='wlanX', filter='type mgt subtype probe-req')\r\nsink = ConsoleSink()\r\nsource > sink\r\n\r\np = PipeEngine(source)\r\np.start()\r\np.wait_and_stop()\r\n```\r\n\r\n#### Actual result\r\n\r\nNow start top in another session and watch CPU load:\r\n```\r\ntop - 20:50:42 up 6 days,  2:46,  2 users,  load average: 0.74, 0.24, 0.09\r\nTasks: 120 total,   1 running, 119 sleeping,   0 stopped,   0 zombie\r\n%Cpu0  : 66.1 us, 33.6 sy,  0.0 ni,  0.0 id,  0.0 wa,  0.0 hi,  0.3 si,  0.0 st\r\n%Cpu1  :  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st\r\n%Cpu2  :  3.0 us,  0.0 sy,  0.0 ni, 97.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st\r\n%Cpu3  :  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st\r\nMiB Mem :   7875.3 total,   7303.0 free,     97.1 used,    475.1 buff/cache\r\nMiB Swap:    100.0 total,    100.0 free,      0.0 used.   7526.4 avail Mem \r\n\r\n  PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND\r\n26761 root      20   0   44948  27364   9028 S 100.0   0.3   1:21.48 scapy\r\n...\r\n```\r\n\r\n#### Expected result\r\n\r\nExpected CPU load to be far less than 100%.\r\n\r\n#### Additional information\r\n1. Downgrading to 2.4.4 solves the issue. CPU load is just a few percent, depending on how many frames are actually received by the frame filter\r\n2. Both 2.4.5 and master branch expose this issue\r\n3. Only dissecting the packets with scapy 2.4.5 (using pcapy to capture with frame filter) does not show the same CPU load. Tested with:\r\n```python\r\nimport pcapy\r\nfrom scapy.all import *\r\nimport sys\r\n\r\ndef pkt_callback(hdr, data):\r\n    rt = RadioTap(data)\r\n    rt.show()\r\n    pr = rt.getlayer(Dot11ProbeReq)\r\n    print(f\"type:{rt.type} subtype:{rt.subtype} ts:{rt.time} signal:{rt.dBm_AntSignal}dBm rate:{rt.Rate} ant:{rt.Antenna} s_mac:{rt.addr2} BSSID:{pr.info.decode('utf-8')}\")\r\n\r\ndef main():\r\n    packets = pcapy.open_live(sys.argv[1], 1514, 1, 10)\r\n    packets.setfilter('subtype probe-req')\r\n    packets.loop(-1, pkt_callback)\r\n\r\nif __name__ == '__main__':\r\n    main()\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3197/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3197/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3191", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3191/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3191/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3191/events", "html_url": "https://github.com/secdev/scapy/issues/3191", "id": 866862065, "node_id": "MDU6SXNzdWU4NjY4NjIwNjU=", "number": 3191, "title": "Exception when calling sniff for multiple interfaces", "user": {"login": "hobobandy", "id": 30026704, "node_id": "MDQ6VXNlcjMwMDI2NzA0", "avatar_url": "https://avatars.githubusercontent.com/u/30026704?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hobobandy", "html_url": "https://github.com/hobobandy", "followers_url": "https://api.github.com/users/hobobandy/followers", "following_url": "https://api.github.com/users/hobobandy/following{/other_user}", "gists_url": "https://api.github.com/users/hobobandy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hobobandy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hobobandy/subscriptions", "organizations_url": "https://api.github.com/users/hobobandy/orgs", "repos_url": "https://api.github.com/users/hobobandy/repos", "events_url": "https://api.github.com/users/hobobandy/events{/privacy}", "received_events_url": "https://api.github.com/users/hobobandy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-04-24T23:54:46Z", "updated_at": "2021-05-31T18:38:33Z", "closed_at": "2021-05-31T18:38:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Brief description\r\n\r\nBasic sniff capture using multiple interfaces.\r\nWhen passing a list (or dict) of interfaces, Scapy raises an exception (see below).\r\n\r\nSee 'Related resources' for probable cause/fix.\r\n\r\n#### Environment\r\n\r\nScapy version: 2.4.5\r\nPython version: 3.8.5\r\nOperation System: Ubuntu 20.04.2.0 Desktop\r\n\r\n#### How to reproduce\r\n\r\n`packets = sniff(iface=[\"wlan0\", \"wlan1\", \"wlan2\", \"wlan3\"], prn=callback, store=0)`\r\n\r\n#### Actual result\r\n\r\n> File \"scapy_file.py\", line 197, in run\r\n>     packets = sniff(iface=[\"wlan0\",\"wlan1\",\"wlan2\",\"wlan3\"], prn=callback, store=0)\r\n>   File \"/root/.local/share/virtualenvs/myenv/lib/python3.8/site-packages/scapy/sendrecv.py\", line 1264, in sniff\r\n>     sniffer._run(*args, **kwargs)\r\n>   File \"/root/.local/share/virtualenvs/myenv/lib/python3.8/site-packages/scapy/sendrecv.py\", line 1128, in _run\r\n>     sniff_sockets[L2socket(type=ETH_P_ALL, iface=iface,\r\n>   File \"/root/.local/share/virtualenvs/myenv/lib/python3.8/site-packages/scapy/arch/linux.py\", line 501, in __init__\r\n>     set_promisc(self.ins, self.iface)\r\n>   File \"/root/.local/share/virtualenvs/myenv/lib/python3.8/site-packages/scapy/arch/linux.py\", line 181, in set_promisc\r\n>     mreq = struct.pack(\"IHH8s\", get_if_index(iff), PACKET_MR_PROMISC, 0, b\"\")\r\n>   File \"/root/.local/share/virtualenvs/myenv/lib/python3.8/site-packages/scapy/arch/linux.py\", line 401, in get_if_index\r\n>     return int(struct.unpack(\"I\", get_if(iff, SIOCGIFINDEX)[16:20])[0])\r\n>   File \"/root/.local/share/virtualenvs/myenv/lib/python3.8/site-packages/scapy/arch/common.py\", line 65, in get_if\r\n>     return ioctl(sck, cmd, struct.pack(\"16s16x\", iff.encode(\"utf8\")))\r\n> AttributeError: 'list' object has no attribute 'encode'\r\n\r\n#### Expected result\r\n\r\nExpecting sniff to begin.\r\n\r\n#### Related resources\r\n\r\nSource probably related to this issue:\r\n[sendrecv.py - line 1111 to line 1128](https://github.com/secdev/scapy/blob/master/scapy/sendrecv.py#L1111)\r\n\r\nSince I don't use a custom L2 socket, I simply commented out line 1111 to 1113 and used the default L2 socket:\r\n`L2socket = conf.L2listen`\r\n\r\nProper fix probably involves looping through list items to instance an L2socket.\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3191/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3191/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3187", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3187/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3187/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3187/events", "html_url": "https://github.com/secdev/scapy/pull/3187", "id": 864857084, "node_id": "MDExOlB1bGxSZXF1ZXN0NjIxMDE1Nzg5", "number": 3187, "title": "RadioTap MCS - fix padding", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-04-22T11:51:17Z", "updated_at": "2021-05-30T22:58:46Z", "closed_at": "2021-05-30T22:58:44Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3187", "html_url": "https://github.com/secdev/scapy/pull/3187", "diff_url": "https://github.com/secdev/scapy/pull/3187.diff", "patch_url": "https://github.com/secdev/scapy/pull/3187.patch", "merged_at": "2021-05-30T22:58:43Z"}, "body": "fix https://github.com/secdev/scapy/issues/3131", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3187/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3187/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3182", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3182/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3182/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3182/events", "html_url": "https://github.com/secdev/scapy/pull/3182", "id": 863816319, "node_id": "MDExOlB1bGxSZXF1ZXN0NjIwMTUzOTY3", "number": 3182, "title": "Travis cleanup / TunTap fixes / Mypy 3.9", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 514033136, "node_id": "MDU6TGFiZWw1MTQwMzMxMzY=", "url": "https://api.github.com/repos/secdev/scapy/labels/tests", "name": "tests", "color": "0e8a16", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": {"url": "https://api.github.com/repos/secdev/scapy/milestones/1", "html_url": "https://github.com/secdev/scapy/milestone/1", "labels_url": "https://api.github.com/repos/secdev/scapy/milestones/1/labels", "id": 6601491, "node_id": "MDk6TWlsZXN0b25lNjYwMTQ5MQ==", "number": 1, "title": "2.5.0", "description": "We're probably going to call this release 2.5.0 mostly because it should be the first one to include **code typing**, at least for all of the core.\r\n\r\nWe're keeping Python 2.7 support right now, but I would expect us to drop it by Scapy 2.6 or 2.7, once its usage has reached a low enough percentage and that we're really happy with a release.", "creator": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "open_issues": 1, "closed_issues": 212, "state": "open", "created_at": "2021-03-29T00:43:26Z", "updated_at": "2022-12-25T11:07:45Z", "due_on": null, "closed_at": null}, "comments": 2, "created_at": "2021-04-21T12:31:25Z", "updated_at": "2021-04-24T12:23:52Z", "closed_at": "2021-04-24T12:23:40Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3182", "html_url": "https://github.com/secdev/scapy/pull/3182", "diff_url": "https://github.com/secdev/scapy/pull/3182.diff", "patch_url": "https://github.com/secdev/scapy/pull/3182.patch", "merged_at": "2021-04-24T12:23:39Z"}, "body": "- Cleanup travis tests\r\n- fix the tuntap tests\r\n- run Mypy tests on Python 3.9 (5 changes required)\r\n- fix bad format in get_if_raw_hwaddr leading to negative address families being detected\r\n\r\nfixes https://github.com/secdev/scapy/issues/3172", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3182/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3182/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3176", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3176/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3176/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3176/events", "html_url": "https://github.com/secdev/scapy/issues/3176", "id": 860001584, "node_id": "MDU6SXNzdWU4NjAwMDE1ODQ=", "number": 3176, "title": "Incorrect example for `BitFields`", "user": {"login": "jpollard-jumptrading", "id": 82667316, "node_id": "MDQ6VXNlcjgyNjY3MzE2", "avatar_url": "https://avatars.githubusercontent.com/u/82667316?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jpollard-jumptrading", "html_url": "https://github.com/jpollard-jumptrading", "followers_url": "https://api.github.com/users/jpollard-jumptrading/followers", "following_url": "https://api.github.com/users/jpollard-jumptrading/following{/other_user}", "gists_url": "https://api.github.com/users/jpollard-jumptrading/gists{/gist_id}", "starred_url": "https://api.github.com/users/jpollard-jumptrading/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jpollard-jumptrading/subscriptions", "organizations_url": "https://api.github.com/users/jpollard-jumptrading/orgs", "repos_url": "https://api.github.com/users/jpollard-jumptrading/repos", "events_url": "https://api.github.com/users/jpollard-jumptrading/events{/privacy}", "received_events_url": "https://api.github.com/users/jpollard-jumptrading/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 972547864, "node_id": "MDU6TGFiZWw5NzI1NDc4NjQ=", "url": "https://api.github.com/repos/secdev/scapy/labels/doc", "name": "doc", "color": "0e8a16", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-04-16T17:02:31Z", "updated_at": "2021-04-18T17:33:35Z", "closed_at": "2021-04-18T17:33:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "https://github.com/secdev/scapy/blob/d680d279a9fd37629d5116433af34429a8095576/scapy/fields.py#L2116-L2131\r\n\r\n`BitField(\"a\", 0, 9, tot_size=-16)` etc. should read `BitField(\"a\", 0, 9, tot_size=-2)` (16 -> 2), since this is measured in bytes, not bits.\r\n\r\n[Unfortunately I cannot raise a PR right now.]", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3176/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3176/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3157", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3157/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3157/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3157/events", "html_url": "https://github.com/secdev/scapy/pull/3157", "id": 844536505, "node_id": "MDExOlB1bGxSZXF1ZXN0NjAzNzcyMDMz", "number": 3157, "title": "Fix NegociateContexts alignment in SMB2_Negociate_Protocol_Request_Header", "user": {"login": "maelleroub", "id": 22397632, "node_id": "MDQ6VXNlcjIyMzk3NjMy", "avatar_url": "https://avatars.githubusercontent.com/u/22397632?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maelleroub", "html_url": "https://github.com/maelleroub", "followers_url": "https://api.github.com/users/maelleroub/followers", "following_url": "https://api.github.com/users/maelleroub/following{/other_user}", "gists_url": "https://api.github.com/users/maelleroub/gists{/gist_id}", "starred_url": "https://api.github.com/users/maelleroub/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maelleroub/subscriptions", "organizations_url": "https://api.github.com/users/maelleroub/orgs", "repos_url": "https://api.github.com/users/maelleroub/repos", "events_url": "https://api.github.com/users/maelleroub/events{/privacy}", "received_events_url": "https://api.github.com/users/maelleroub/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-03-30T13:18:29Z", "updated_at": "2021-03-30T15:32:40Z", "closed_at": "2021-03-30T15:32:40Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3157", "html_url": "https://github.com/secdev/scapy/pull/3157", "diff_url": "https://github.com/secdev/scapy/pull/3157.diff", "patch_url": "https://github.com/secdev/scapy/pull/3157.patch", "merged_at": "2021-03-30T15:32:39Z"}, "body": "The NegociateContexts field of the SMB2_Negociate_Protocol_Request_Header must start on an 8-byte aligned offset, which is currently not implemented correctly, as shown by added test case", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3157/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3157/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3154", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3154/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3154/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3154/events", "html_url": "https://github.com/secdev/scapy/pull/3154", "id": 842632886, "node_id": "MDExOlB1bGxSZXF1ZXN0NjAyMTYzMTk0", "number": 3154, "title": "Improve Netflow padding detection", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-03-28T00:46:27Z", "updated_at": "2021-04-12T13:47:46Z", "closed_at": "2021-04-12T13:47:46Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3154", "html_url": "https://github.com/secdev/scapy/pull/3154", "diff_url": "https://github.com/secdev/scapy/pull/3154.diff", "patch_url": "https://github.com/secdev/scapy/pull/3154.patch", "merged_at": "2021-04-12T13:47:46Z"}, "body": "fixes https://github.com/secdev/scapy/issues/3101", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3154/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3154/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3152", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3152/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3152/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3152/events", "html_url": "https://github.com/secdev/scapy/pull/3152", "id": 842617629, "node_id": "MDExOlB1bGxSZXF1ZXN0NjAyMTUxODQ5", "number": 3152, "title": "Improve GroupManagementCipherSuite detection", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-03-27T22:48:23Z", "updated_at": "2021-04-14T18:51:25Z", "closed_at": "2021-04-14T18:51:13Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3152", "html_url": "https://github.com/secdev/scapy/pull/3152", "diff_url": "https://github.com/secdev/scapy/pull/3152.diff", "patch_url": "https://github.com/secdev/scapy/pull/3152.patch", "merged_at": "2021-04-14T18:51:13Z"}, "body": "fixes https://github.com/secdev/scapy/issues/3115\r\ncloses https://github.com/secdev/scapy/pull/3114", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3152/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3152/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3150", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3150/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3150/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3150/events", "html_url": "https://github.com/secdev/scapy/pull/3150", "id": 841358667, "node_id": "MDExOlB1bGxSZXF1ZXN0NjAxMTAzNTI1", "number": 3150, "title": "Fix for scapy.contrib.lldp. Add to XStrLenField's length_from lambda if statement to avoid performing substraction on None.", "user": {"login": "BartoszSiwinski", "id": 13608913, "node_id": "MDQ6VXNlcjEzNjA4OTEz", "avatar_url": "https://avatars.githubusercontent.com/u/13608913?v=4", "gravatar_id": "", "url": "https://api.github.com/users/BartoszSiwinski", "html_url": "https://github.com/BartoszSiwinski", "followers_url": "https://api.github.com/users/BartoszSiwinski/followers", "following_url": "https://api.github.com/users/BartoszSiwinski/following{/other_user}", "gists_url": "https://api.github.com/users/BartoszSiwinski/gists{/gist_id}", "starred_url": "https://api.github.com/users/BartoszSiwinski/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/BartoszSiwinski/subscriptions", "organizations_url": "https://api.github.com/users/BartoszSiwinski/orgs", "repos_url": "https://api.github.com/users/BartoszSiwinski/repos", "events_url": "https://api.github.com/users/BartoszSiwinski/events{/privacy}", "received_events_url": "https://api.github.com/users/BartoszSiwinski/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-03-25T22:12:35Z", "updated_at": "2021-03-27T23:40:22Z", "closed_at": "2021-03-27T23:40:22Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3150", "html_url": "https://github.com/secdev/scapy/pull/3150", "diff_url": "https://github.com/secdev/scapy/pull/3150.diff", "patch_url": "https://github.com/secdev/scapy/pull/3150.patch", "merged_at": "2021-03-27T23:40:21Z"}, "body": "Fix scapy.contrib.lldp. Add to XStrLenFields argument's length_from lambda if statement so in case that other referenced field is None lambda will not try to perform unhandeled operation on None eg. + integer.\r\n\r\n<!-- This is just a checklist to guide you. You can remove it safely. -->\r\n\r\nI'm new to the scapy and I have read the CONTRIBUTING.md. If I've missed something I apologize and I would be grateful for guidance on how to improve.\r\nI've not created any new unit tests as I don't add new functionality, but simply fix existing one. If maintainers still would like me to add some I would be happy to do so, but I will need a little bit of a help to make sure that they're resiliant to other changes in scapy.\r\n\r\n<!-- brief description what this PR will do, e.g. fixes broken dissection of XXX -->\r\nXStrLenField calls lambda from argument 'length_from' when running i2repr. It may happen as it is in the scapy.contrib.lldp that lambda consist of taking value from other field and adjusting it by addition/substraction. In such case if the referenced field has value 'None' it will raise exception TypeError.  This change is adding if statement to simply put '0' as the return of lambda in case the referenced field is None, so we won't try to perform unhandled operation like substracting integer from 'None'.\r\n\r\nfixes #3107\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3150/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3150/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3143", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3143/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3143/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3143/events", "html_url": "https://github.com/secdev/scapy/pull/3143", "id": 833732686, "node_id": "MDExOlB1bGxSZXF1ZXN0NTk0Njc5Mzgy", "number": 3143, "title": "Move libpcap tests to Github Actions", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 564414240, "node_id": "MDU6TGFiZWw1NjQ0MTQyNDA=", "url": "https://api.github.com/repos/secdev/scapy/labels/convergence", "name": "convergence", "color": "c2e0c6", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-03-17T12:46:43Z", "updated_at": "2021-03-30T14:58:52Z", "closed_at": "2021-03-30T14:58:05Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3143", "html_url": "https://github.com/secdev/scapy/pull/3143", "diff_url": "https://github.com/secdev/scapy/pull/3143.diff", "patch_url": "https://github.com/secdev/scapy/pull/3143.patch", "merged_at": "2021-03-30T14:58:05Z"}, "body": "- Move libpcap tests to Github actions since our travis suite is pretty much dead\r\n- Only test root with PyPy (the only differences we're testing with PyPy are the `attach_filter` functions.. root only + pypy tests already are super long due to the build-on-install)\r\n- Small Github Actions tweaks\r\n\r\nIt appears that 880d0487c6885a5ddd0c5f747f6a9e0461a35278 has broken libpcap on Linux. This fixes it", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3143/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3143/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3131", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3131/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3131/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3131/events", "html_url": "https://github.com/secdev/scapy/issues/3131", "id": 826587915, "node_id": "MDU6SXNzdWU4MjY1ODc5MTU=", "number": 3131, "title": "Incorrect MCS_index reported for multicast", "user": {"login": "andreasdotzler", "id": 7765929, "node_id": "MDQ6VXNlcjc3NjU5Mjk=", "avatar_url": "https://avatars.githubusercontent.com/u/7765929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andreasdotzler", "html_url": "https://github.com/andreasdotzler", "followers_url": "https://api.github.com/users/andreasdotzler/followers", "following_url": "https://api.github.com/users/andreasdotzler/following{/other_user}", "gists_url": "https://api.github.com/users/andreasdotzler/gists{/gist_id}", "starred_url": "https://api.github.com/users/andreasdotzler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andreasdotzler/subscriptions", "organizations_url": "https://api.github.com/users/andreasdotzler/orgs", "repos_url": "https://api.github.com/users/andreasdotzler/repos", "events_url": "https://api.github.com/users/andreasdotzler/events{/privacy}", "received_events_url": "https://api.github.com/users/andreasdotzler/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-03-09T20:28:01Z", "updated_at": "2021-05-30T22:58:44Z", "closed_at": "2021-05-30T22:58:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nThe MCS_index of a packet read from a recorded pcapng file is reported to be 0, while 10 is correct. \r\n\r\n#### Environment\r\n\r\n-   Scapy version: `scapy-2.4.4.dev319`\r\n-   Python version: `3.9`\r\n-   Operating System: `Linux 4.15.0`\r\n\r\n#### How to reproduce\r\n\r\n```\r\nfrom scapy.all import *\r\nscapy_cap = rdpcap(\"multicast.pcapng\")\r\nprint(scapy_cap[0].MCS_index)\r\n```\r\n\r\n#### Actual result\r\n\r\n```\r\nbash -c 'pip install --upgrade git+git://github.com/secdev/scapy; python -c \"from scapy.all import *; scapy_cap = rdpcap(\\\"multicast.pcapng\\\"); print(scapy_cap[0].MCS_index)\"'\r\n... \r\nSuccessfully installed scapy-2.4.4.dev319\r\n0\r\n```\r\n\r\n#### Expected result\r\n\r\nThe MCS_index reported should be 10, as in Wireshark or scapy version 2.4.3\r\n\r\n```\r\nbash -c 'pip install scapy==2.4.3; python -c \"from scapy.all import *; scapy_cap = rdpcap(\\\"multicast.pcapng\\\"); print(scapy_cap[0].MCS_index)\"\r\n...\r\nSuccessfully installed scapy-2.4.3\r\n10\r\n```\r\n\r\n#### Related resources\r\n[multicast.pcapng.TXT](https://github.com/secdev/scapy/files/6111196/multicast.pcapng.TXT)\r\n\r\n\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3131/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3131/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3130", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3130/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3130/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3130/events", "html_url": "https://github.com/secdev/scapy/pull/3130", "id": 826087132, "node_id": "MDExOlB1bGxSZXF1ZXN0NTg4MTE4NTUw", "number": 3130, "title": "gtp: fix GTPPDUSessionContainer layer implementation", "user": {"login": "raslandarawsheh", "id": 13299351, "node_id": "MDQ6VXNlcjEzMjk5MzUx", "avatar_url": "https://avatars.githubusercontent.com/u/13299351?v=4", "gravatar_id": "", "url": "https://api.github.com/users/raslandarawsheh", "html_url": "https://github.com/raslandarawsheh", "followers_url": "https://api.github.com/users/raslandarawsheh/followers", "following_url": "https://api.github.com/users/raslandarawsheh/following{/other_user}", "gists_url": "https://api.github.com/users/raslandarawsheh/gists{/gist_id}", "starred_url": "https://api.github.com/users/raslandarawsheh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/raslandarawsheh/subscriptions", "organizations_url": "https://api.github.com/users/raslandarawsheh/orgs", "repos_url": "https://api.github.com/users/raslandarawsheh/repos", "events_url": "https://api.github.com/users/raslandarawsheh/events{/privacy}", "received_events_url": "https://api.github.com/users/raslandarawsheh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-03-09T15:16:00Z", "updated_at": "2021-04-12T14:11:18Z", "closed_at": "2021-04-12T14:11:18Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3130", "html_url": "https://github.com/secdev/scapy/pull/3130", "diff_url": "https://github.com/secdev/scapy/pull/3130.diff", "patch_url": "https://github.com/secdev/scapy/pull/3130.patch", "merged_at": "2021-04-12T14:11:18Z"}, "body": "This reflects the rfc 38415-f20 with the following\r\nexample frame format:\r\n\r\nBits\t                Number of Octets\r\n7  6  5  4  3  2  1  0\r\n Field 1  |  Field 2          1          Octet 1\r\n Field 3  |  Field 4          2          Octet 2\r\n Field 4 Cont | Spare\t                 Octet 3\r\n          Field 6             2          Octet 4\r\n Field 6 Cont | Padding bits             Octet 5\r\n      Future Extension        0-m\r\n      Padding                 0-3\r\n\r\nSigned-off-by: Raslan Darawsheh <rasland@nvidia.com>\r\n\r\n<!-- This is just a checklist to guide you. You can remove it safely. -->\r\n\r\n**Checklist:**\r\n\r\n-   [ ] If you are new to Scapy: I have checked [CONTRIBUTING.md](https://github.com/secdev/scapy/blob/master/CONTRIBUTING.md) (esp. section submitting-pull-requests)\r\n-   [x] I squashed commits belonging together\r\n-   [ ] I added unit tests or explained why they are not relevant\r\n-   [x] I executed the regression tests for Python2 and Python3 (using `tox` or, `cd test && ./run_tests_py2, cd test && ./run_tests_py3`)\r\n-   [ ] If the PR is still not finished, please create a [Draft Pull Request](https://github.blog/2019-02-14-introducing-draft-pull-requests/)\r\n\r\n<!-- brief description what this PR will do, e.g. fixes broken dissection of XXX -->\r\n\r\n<!-- if required - short explanation why you fixed something in a way that may look more complicated as it actually is ->>\r\n\r\n<!-- if required - outline impacts on other parts of the library -->\r\n\r\nfixes #xxx <!-- (add issue number here if appropriate, else remove this line) -->\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3130/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3130/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3126", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3126/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3126/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3126/events", "html_url": "https://github.com/secdev/scapy/issues/3126", "id": 824304016, "node_id": "MDU6SXNzdWU4MjQzMDQwMTY=", "number": 3126, "title": "Pickle is not working for scapy.compat.NamedTuple on python < 3.7", "user": {"login": "polybassa", "id": 1676055, "node_id": "MDQ6VXNlcjE2NzYwNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1676055?v=4", "gravatar_id": "", "url": "https://api.github.com/users/polybassa", "html_url": "https://github.com/polybassa", "followers_url": "https://api.github.com/users/polybassa/followers", "following_url": "https://api.github.com/users/polybassa/following{/other_user}", "gists_url": "https://api.github.com/users/polybassa/gists{/gist_id}", "starred_url": "https://api.github.com/users/polybassa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/polybassa/subscriptions", "organizations_url": "https://api.github.com/users/polybassa/orgs", "repos_url": "https://api.github.com/users/polybassa/repos", "events_url": "https://api.github.com/users/polybassa/events{/privacy}", "received_events_url": "https://api.github.com/users/polybassa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-03-08T08:15:21Z", "updated_at": "2021-03-28T00:50:41Z", "closed_at": "2021-03-28T00:50:41Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "This issue is already discussed in  #3113.\r\n\r\nHere is a patch to add a suitable test-case, since I'll close #3113. \r\n#3113 is not a ready PR and I have no idea how to modify namedtuple, to fix this issue.\r\n\r\n`cat 0001-Add-pickle-test-for-PacketList.patch `\r\n```\r\nFrom 27026f286c76dadf29aa2ae108d4edc7977895c0 Mon Sep 17 00:00:00 2001\r\nFrom: Nils Weiss <nils@we155.de>\r\nDate: Wed, 24 Feb 2021 10:15:50 +0100\r\nSubject: [PATCH] Add pickle test for PacketList\r\n\r\n---\r\n test/regression.uts | 16 ++++++++++++++++\r\n 1 file changed, 16 insertions(+)\r\n\r\ndiff --git a/test/regression.uts b/test/regression.uts\r\nindex 22326e00..6fe86608 100644\r\n--- a/test/regression.uts\r\n+++ b/test/regression.uts\r\n@@ -4224,6 +4224,22 @@ srl, rl = pl.sr(lookahead=None)\r\n assert len(srl) == 1\r\n assert len(rl) == 7\r\n \r\n+= pickle test\r\n+import pickle\r\n+import io\r\n+\r\n+srl, rl = PacketList([Raw(b\"1\"), Raw(b\"1\"), Raw(b\"2\"), Raw(b\"3\"), Raw(b\"4\"), Raw(b\"3\"), Raw(b\"1\"), Raw(b\"1\"), Raw(b\"4\")]).sr()\r\n+assert len(srl) == 4\r\n+\r\n+f = io.BytesIO()\r\n+\r\n+pickle.dump(srl, f)\r\n+\r\n+unp = pickle.loads(f.getvalue())\r\n+\r\n+assert len(unp) == len(srl)\r\n+assert all(bytes(a[0]) == bytes(b[0]) for a, b in zip(unp, srl))\r\n+\r\n = plot()\r\n \r\n import mock\r\n-- \r\n2.30.0\r\n```\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3126/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3126/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3115", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3115/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3115/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3115/events", "html_url": "https://github.com/secdev/scapy/issues/3115", "id": 815442591, "node_id": "MDU6SXNzdWU4MTU0NDI1OTE=", "number": 3115, "title": "802.11 RSN Tag corrupts rest of frame.", "user": {"login": "asianrider", "id": 10201608, "node_id": "MDQ6VXNlcjEwMjAxNjA4", "avatar_url": "https://avatars.githubusercontent.com/u/10201608?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asianrider", "html_url": "https://github.com/asianrider", "followers_url": "https://api.github.com/users/asianrider/followers", "following_url": "https://api.github.com/users/asianrider/following{/other_user}", "gists_url": "https://api.github.com/users/asianrider/gists{/gist_id}", "starred_url": "https://api.github.com/users/asianrider/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asianrider/subscriptions", "organizations_url": "https://api.github.com/users/asianrider/orgs", "repos_url": "https://api.github.com/users/asianrider/repos", "events_url": "https://api.github.com/users/asianrider/events{/privacy}", "received_events_url": "https://api.github.com/users/asianrider/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-02-24T12:42:45Z", "updated_at": "2021-04-14T18:51:13Z", "closed_at": "2021-04-14T18:51:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "In all my captures, the 802.11 RSN tag corrupts the following tags because it uses too many bytes. The culprit is the group_management_cipher_suite, which does not appear in Wireshark.  \r\n\r\nIn the current code, it depends only on mfp_capable. I don't have the full 802.11 spec, but a search in internet revealed that, apparently, both mfp_capable and mfp_required must be set for the descriptor to be present.\r\n\r\nIt affects all Beacon frames, from APs from different manufacturers, so I assume the construction of those frames are compliant.\r\n\r\nCan somebody with access to the spec confirm, or design a better fix ?\r\n\r\nEnvironment: Ubuntu 20.04, Thinkpad P50 with wifi a/c card in monitor mode.\r\n\r\nPR: Fix condition for inclusion of group_management_cipher_suite\r\n\r\nLaurent", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3115/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3115/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3113", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3113/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3113/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3113/events", "html_url": "https://github.com/secdev/scapy/pull/3113", "id": 815281300, "node_id": "MDExOlB1bGxSZXF1ZXN0NTc5MTM2NzA3", "number": 3113, "title": "Add pickle test for PacketList [ready]", "user": {"login": "polybassa", "id": 1676055, "node_id": "MDQ6VXNlcjE2NzYwNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1676055?v=4", "gravatar_id": "", "url": "https://api.github.com/users/polybassa", "html_url": "https://github.com/polybassa", "followers_url": "https://api.github.com/users/polybassa/followers", "following_url": "https://api.github.com/users/polybassa/following{/other_user}", "gists_url": "https://api.github.com/users/polybassa/gists{/gist_id}", "starred_url": "https://api.github.com/users/polybassa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/polybassa/subscriptions", "organizations_url": "https://api.github.com/users/polybassa/orgs", "repos_url": "https://api.github.com/users/polybassa/repos", "events_url": "https://api.github.com/users/polybassa/events{/privacy}", "received_events_url": "https://api.github.com/users/polybassa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2021-02-24T09:16:24Z", "updated_at": "2022-07-27T08:58:54Z", "closed_at": "2021-03-27T11:40:34Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3113", "html_url": "https://github.com/secdev/scapy/pull/3113", "diff_url": "https://github.com/secdev/scapy/pull/3113.diff", "patch_url": "https://github.com/secdev/scapy/pull/3113.patch", "merged_at": "2021-03-27T11:40:34Z"}, "body": "**edited by gpotter2**\r\n\r\nThis PR:\r\n- fix `NamedTuple` (and `PacketList`) pickling on Python < 3.7", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3113/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3113/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3109", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3109/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3109/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3109/events", "html_url": "https://github.com/secdev/scapy/pull/3109", "id": 812916551, "node_id": "MDExOlB1bGxSZXF1ZXN0NTc3MTU1NDc4", "number": 3109, "title": "Improve BPF validation with tcpdump", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-02-21T18:18:56Z", "updated_at": "2021-04-12T13:54:51Z", "closed_at": "2021-04-12T13:54:48Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3109", "html_url": "https://github.com/secdev/scapy/pull/3109", "diff_url": "https://github.com/secdev/scapy/pull/3109.diff", "patch_url": "https://github.com/secdev/scapy/pull/3109.patch", "merged_at": "2021-04-12T13:54:48Z"}, "body": "- fix https://github.com/secdev/scapy/issues/3093\r\n- use libpcap utils when guessing tcpdump linktype (it will be installed since tcpdump uses libpcap..)", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3109/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3109/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3101", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3101/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3101/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3101/events", "html_url": "https://github.com/secdev/scapy/issues/3101", "id": 810718303, "node_id": "MDU6SXNzdWU4MTA3MTgzMDM=", "number": 3101, "title": "NetflowV9/V10 decode incorrectly adds padding between datasets.", "user": {"login": "JoshLitt", "id": 1700395, "node_id": "MDQ6VXNlcjE3MDAzOTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1700395?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JoshLitt", "html_url": "https://github.com/JoshLitt", "followers_url": "https://api.github.com/users/JoshLitt/followers", "following_url": "https://api.github.com/users/JoshLitt/following{/other_user}", "gists_url": "https://api.github.com/users/JoshLitt/gists{/gist_id}", "starred_url": "https://api.github.com/users/JoshLitt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JoshLitt/subscriptions", "organizations_url": "https://api.github.com/users/JoshLitt/orgs", "repos_url": "https://api.github.com/users/JoshLitt/repos", "events_url": "https://api.github.com/users/JoshLitt/events{/privacy}", "received_events_url": "https://api.github.com/users/JoshLitt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-02-18T03:13:26Z", "updated_at": "2021-04-12T13:47:46Z", "closed_at": "2021-04-12T13:47:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nDissecting a Netflow V10 packet with multiple flowsets, where padding was not used, seems to result in the second flowset being misaligned.  It appears the dissector assumes there must have been padding in the first flowset, though there was not.  I see the dissector beginning the next flowset 3 bytes too deep (where 3 bytes is the amount of padding the packet writer could have used, but did not).\r\n\r\n#### Environment\r\n\r\n-   Scapy version: 2.4.4\r\n-   Python version: 3.7.3\r\n-   Operating System: MacOS Catalina\r\n\r\n<!-- if needed - further information to get a picture of your setup (e.g. a sketch of your network setup) -->\r\n\r\n#### How to reproduce\r\n\r\nThe pcap I have is proprietary, so I will attempt to get a simple 1 record pcap that demonstrates the problem and post it.\r\n\r\nBut, given a pcap  where the first packet has the issue, it can be seen by:\r\n\r\n```\r\nfrom scapy.all import rdpcap, bind_layers\r\nfrom scapy.layers.inet import UDP\r\nfrom scapy.layers.netflow import NetflowHeader\r\n\r\nbind_layers(UDP, NetflowHeader, dport=dest_port)\r\npackets = rdpcap(filename)\r\nfor pkt in packets:\r\n    netflow = pkt['NetflowDataflowsetV9']\r\n    while netflow:\r\n        print(f\"templateID: {netflow.fields['templateID']}\")\r\n        print(f\"length: {netflow.fields['length']}\")\r\n        netflow = netflow.payload\r\n```\r\nIf the length of the first flowset is not a multiple of 4, then the next flowset will start incorrectly and the templateID and length shown will be wrong (compare to wireshark dissection).\r\n\r\n#### Related resources\r\n\r\nI'll come back with a pcap and a bit more code to demonstrate.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3101/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3101/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3094", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3094/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3094/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3094/events", "html_url": "https://github.com/secdev/scapy/pull/3094", "id": 804552925, "node_id": "MDExOlB1bGxSZXF1ZXN0NTcwMzAxMjYy", "number": 3094, "title": "Fix DNS compression", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-02-09T13:30:29Z", "updated_at": "2021-02-16T10:24:51Z", "closed_at": "2021-02-16T09:56:34Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3094", "html_url": "https://github.com/secdev/scapy/pull/3094", "diff_url": "https://github.com/secdev/scapy/pull/3094.diff", "patch_url": "https://github.com/secdev/scapy/pull/3094.patch", "merged_at": "2021-02-16T09:56:34Z"}, "body": "fix https://github.com/secdev/scapy/issues/2989", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3094/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3094/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3093", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3093/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3093/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3093/events", "html_url": "https://github.com/secdev/scapy/issues/3093", "id": 804222107, "node_id": "MDU6SXNzdWU4MDQyMjIxMDc=", "number": 3093, "title": "sniff() with an offline pcap file and BPF filter can fail validation and raise an exception", "user": {"login": "ctenglish", "id": 7412725, "node_id": "MDQ6VXNlcjc0MTI3MjU=", "avatar_url": "https://avatars.githubusercontent.com/u/7412725?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ctenglish", "html_url": "https://github.com/ctenglish", "followers_url": "https://api.github.com/users/ctenglish/followers", "following_url": "https://api.github.com/users/ctenglish/following{/other_user}", "gists_url": "https://api.github.com/users/ctenglish/gists{/gist_id}", "starred_url": "https://api.github.com/users/ctenglish/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ctenglish/subscriptions", "organizations_url": "https://api.github.com/users/ctenglish/orgs", "repos_url": "https://api.github.com/users/ctenglish/repos", "events_url": "https://api.github.com/users/ctenglish/events{/privacy}", "received_events_url": "https://api.github.com/users/ctenglish/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-02-09T05:30:53Z", "updated_at": "2021-04-12T13:54:48Z", "closed_at": "2021-04-12T13:54:48Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nCalling ``sniff()`` using an offline pcap file and also specifying a BPF filter can lead to an exception during validation of the filter as it appears the associated linktype may be guessed incorrectly under some conditions.\r\n\r\nFor example, providing a pcap with raw WiFi packets and using a filter of \"subtype probe-req\" to select only probe request frames should work, but the additional validation performed in ``compile_filter()`` before calling tcpdump with the filter raises an exception.\r\n\r\n#### Environment\r\n\r\n-   Scapy version: 2.4.4\r\n-   Python version: 3.8.5\r\n-   Operating System: Ubuntu 20.04\r\n\r\n#### How to reproduce\r\n\r\n1. capture a WiFi pcap using (for example) tshark, eg ``tshark -i wlan0 -w capture.pcap``\r\n2. using offline mode with a filter, ``scapy.sniff(offline=\"path/to/capture.pcap\", filter=\"subtype probe-req\", ...)``\r\n\r\n#### Actual result\r\n\r\n```python\r\n  File \"<snip>/lib/python3.8/site-packages/scapy/sendrecv.py\", line 1195, in sniff\r\n    sniffer._run(*args, **kwargs)\r\n  File \"<snip>/lib/python3.8/site-packages/scapy/sendrecv.py\", line 987, in _run\r\n    sniff_sockets.update(\r\n  File \"<snip>/lib/python3.8/site-packages/scapy/sendrecv.py\", line 992, in <genexpr>\r\n    else tcpdump(\r\n  File \"<snip>/lib/python3.8/site-packages/scapy/utils.py\", line 1867, in tcpdump\r\n    compile_filter(flt)\r\n  File \"<snip>/lib/python3.8/site-packages/scapy/arch/common.py\", line 123, in compile_filter\r\n    raise Scapy_Exception(\r\nscapy.error.Scapy_Exception: Failed to compile filter expression subtype probe-req (-1)\r\n```\r\n\r\n#### Expected result\r\n\r\nno exception\r\n\r\nnote: This exception isn't always raised, under some conditions it works, possibly the linktype is guessed correctly under some code paths.\r\n\r\n#### Related resources\r\n\r\nThe ``tcpdump`` implementation in scapy/utils.py tries to validate the BPF filter before executing tcpdump by calling ``compile_filter()`` (see https://github.com/secdev/scapy/blob/master/scapy/utils.py#L2079) \r\n\r\nInternally it looks like ``compile_filter()`` makes some educated guesses about the linktype for the filter but if it gets the linktype wrong then the exception is raised. If ``sniff()`` is modified take a linktype that is then passed to ``tcpdump()`` that is then passed to ``compile_filter`` this exception could be avoided.\r\n\r\nFor example in sendrecv.py (AsyncSniff._run()):\r\n\r\n```\r\n857d856\r\n<             linktype = karg.get(\"linktype\")\r\n863c862\r\n<                     tcpdump(fname, args=[\"-w\", \"-\"], flt=flt, linktype=linktype, getfd=True)\r\n---\r\n>                     tcpdump(fname, args=[\"-w\", \"-\"], flt=flt, getfd=True)\r\n868c867\r\n<                     tcpdump(fname, args=[\"-w\", \"-\"], flt=flt, linktype=linktype, getfd=True)\r\n---\r\n>                     tcpdump(fname, args=[\"-w\", \"-\"], flt=flt, getfd=True)\r\n888d886\r\n<                             linktype=linktype,\r\n```\r\n\r\nand in utils.py (tcpdump):\r\n```\r\n1781c1781\r\n<         compile_filter(flt, linktype=linktype)\r\n---\r\n>         compile_filter(flt)\r\n```\r\n\r\nsniff could be invoked with a known linktype, DLT_IEEE802_11 in this case:\r\n\r\n```python\r\nscapy.sniff(offline=\"path/to/capture.pcap\", filter=\"subtype probe-req\", linktype=DLT_IEEE802_11, ...)\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3093/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3093/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3074", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3074/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3074/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3074/events", "html_url": "https://github.com/secdev/scapy/issues/3074", "id": 795579016, "node_id": "MDU6SXNzdWU3OTU1NzkwMTY=", "number": 3074, "title": "Wrong UDP checksum when using IPv4 Source Routing options", "user": {"login": "jmillikin-stripe", "id": 28275929, "node_id": "MDQ6VXNlcjI4Mjc1OTI5", "avatar_url": "https://avatars.githubusercontent.com/u/28275929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jmillikin-stripe", "html_url": "https://github.com/jmillikin-stripe", "followers_url": "https://api.github.com/users/jmillikin-stripe/followers", "following_url": "https://api.github.com/users/jmillikin-stripe/following{/other_user}", "gists_url": "https://api.github.com/users/jmillikin-stripe/gists{/gist_id}", "starred_url": "https://api.github.com/users/jmillikin-stripe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jmillikin-stripe/subscriptions", "organizations_url": "https://api.github.com/users/jmillikin-stripe/orgs", "repos_url": "https://api.github.com/users/jmillikin-stripe/repos", "events_url": "https://api.github.com/users/jmillikin-stripe/events{/privacy}", "received_events_url": "https://api.github.com/users/jmillikin-stripe/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-01-28T01:11:01Z", "updated_at": "2021-02-06T13:24:14Z", "closed_at": "2021-02-06T13:24:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nThe UDP checksum is computed on a pseudo-header that does not appear to take IPv4 header options into account. I think this is a bug in `inet.in4_chksum()`, because the IP layer checksums are correct.\r\n\r\n#### Environment\r\n\r\n-   Scapy version: current master HEAD (e412d2f2877dbebfb8d88d90626406960dc7a559)\r\n-   Python version: 3.7.3\r\n-   Operating System: reproduced on Linux and macOS\r\n\r\n#### How to reproduce\r\n\r\n```python\r\n# LSRR routers=[192.168.1.1]\r\nopt = IPOption(copy_flag=1, optclass=0, option=3, length=7, value=b'\\x04\\xC0\\xA8\\x01\\x01')\r\nip_1 = IP(dst=\"127.0.0.1\") / UDP(sport=0, dport=5555) / b\"payload\"\r\nip_2 = IP(dst=\"127.0.0.1\", options=opt) / UDP(sport=0, dport=5555) / b\"payload\"\r\n```\r\n\r\nThen `show2()` the IP packets. The UDP checksum on `ip_2` is computed incorrectly -- specifically, it is the same as for `ip_1`. \r\n\r\n#### Actual result\r\n\r\n```python\r\n>>> ip_1.show2()\r\n###[ IP ]### \r\n  version   = 4\r\n  ihl       = 5\r\n  tos       = 0x0\r\n  len       = 35\r\n  id        = 1\r\n  flags     = \r\n  frag      = 0\r\n  ttl       = 64\r\n  proto     = udp\r\n  chksum    = 0x7cc7\r\n  src       = 127.0.0.1\r\n  dst       = 127.0.0.1\r\n  \\options   \\\r\n###[ UDP ]### \r\n     sport     = 0\r\n     dport     = personal_agent\r\n     len       = 15\r\n     chksum    = 0x2eeb\r\n###[ Raw ]### \r\n        load      = 'payload'\r\n```\r\n\r\n```python\r\n>>> ip_2.show2()\r\n###[ IP ]### \r\n  version   = 4\r\n  ihl       = 7\r\n  tos       = 0x0\r\n  len       = 43\r\n  id        = 1\r\n  flags     = \r\n  frag      = 0\r\n  ttl       = 64\r\n  proto     = udp\r\n  chksum    = 0x49f6\r\n  src       = 127.0.0.1\r\n  dst       = 127.0.0.1\r\n  \\options   \\\r\n   |###[ IP Option Loose Source and Record Route ]### \r\n   |  copy_flag = 1\r\n   |  optclass  = control\r\n   |  option    = loose_source_route\r\n   |  length    = 7\r\n   |  pointer   = 4\r\n   |  routers   = [192.168.1.1]\r\n   |###[ IP Option End of Options List ]### \r\n   |  copy_flag = 0\r\n   |  optclass  = control\r\n   |  option    = end_of_list\r\n###[ UDP ]### \r\n     sport     = 0\r\n     dport     = personal_agent\r\n     len       = 15\r\n     chksum    = 0x2eeb\r\n###[ Raw ]### \r\n        load      = 'payload'\r\n```\r\n\r\n#### Expected result\r\n\r\nThe UDP checksums for the two packets should be different.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3074/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3074/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3073", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3073/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3073/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3073/events", "html_url": "https://github.com/secdev/scapy/issues/3073", "id": 794458941, "node_id": "MDU6SXNzdWU3OTQ0NTg5NDE=", "number": 3073, "title": "Some TLS notebooks are outdated", "user": {"login": "cs-862", "id": 78041200, "node_id": "MDQ6VXNlcjc4MDQxMjAw", "avatar_url": "https://avatars.githubusercontent.com/u/78041200?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cs-862", "html_url": "https://github.com/cs-862", "followers_url": "https://api.github.com/users/cs-862/followers", "following_url": "https://api.github.com/users/cs-862/following{/other_user}", "gists_url": "https://api.github.com/users/cs-862/gists{/gist_id}", "starred_url": "https://api.github.com/users/cs-862/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cs-862/subscriptions", "organizations_url": "https://api.github.com/users/cs-862/orgs", "repos_url": "https://api.github.com/users/cs-862/repos", "events_url": "https://api.github.com/users/cs-862/events{/privacy}", "received_events_url": "https://api.github.com/users/cs-862/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1317786288, "node_id": "MDU6TGFiZWwxMzE3Nzg2Mjg4", "url": "https://api.github.com/repos/secdev/scapy/labels/tls", "name": "tls", "color": "56088e", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-01-26T18:23:08Z", "updated_at": "2022-06-20T08:10:53Z", "closed_at": "2022-06-20T08:10:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nThe notebooks 1 to 3 in `doc/notebooks/tls` are not working properly. Below more details, where every notebook fails:\r\n\r\n**`notebook1_x509.ipynb`** (first error in [17]):\r\nError message: `AttributeError: 'PrivKeyRSA' object has no attribute 'key'`\r\n\r\n**`notebook2_tls_protected`** (first error in [4]):\r\nError message `AttributeError: certs`\r\n\r\n**`notebook3_tls_compromised`** (first error in [3]):\r\nError message `AttributeError: 'TLS_RSA_WITH_AES_128_CBC_SHA' object has no attribute '_key_block_len_v1_0'`\r\n\r\n**`notebook4_tls13`** (first errror in [6]):\r\nError message `TypeError: 'NoneType' object is not callable`\r\n\r\n#### Environment\r\n\r\n-   Scapy version: `2.4.4.dev275`\r\n-   Python version: `3.9.1`\r\n-   Operating System: `ManjaroLinux 20.2.1`\r\n\r\n#### How to reproduce\r\n\r\nOpen the `.ipynb`-files mentioned above with `jupyter notebook` and run it by restarting the kernel.\r\n\r\nAs I am a new scapy-user I am not sure, if there are problems with the TLS layer or if the simply the notebooks must be updated.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3073/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3073/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3072", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3072/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3072/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3072/events", "html_url": "https://github.com/secdev/scapy/pull/3072", "id": 794260327, "node_id": "MDExOlB1bGxSZXF1ZXN0NTYxODA2ODQ0", "number": 3072, "title": "Set default self.ins on BPF socket", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-01-26T14:08:50Z", "updated_at": "2021-01-26T15:02:07Z", "closed_at": "2021-01-26T15:02:03Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3072", "html_url": "https://github.com/secdev/scapy/pull/3072", "diff_url": "https://github.com/secdev/scapy/pull/3072.diff", "patch_url": "https://github.com/secdev/scapy/pull/3072.patch", "merged_at": "2021-01-26T15:02:03Z"}, "body": "fix https://github.com/secdev/scapy/issues/3065", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3072/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3072/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3071", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3071/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3071/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3071/events", "html_url": "https://github.com/secdev/scapy/pull/3071", "id": 793828033, "node_id": "MDExOlB1bGxSZXF1ZXN0NTYxNDUwMDQ5", "number": 3071, "title": "Zigbee bug fixes", "user": {"login": "akestoridis", "id": 7526092, "node_id": "MDQ6VXNlcjc1MjYwOTI=", "avatar_url": "https://avatars.githubusercontent.com/u/7526092?v=4", "gravatar_id": "", "url": "https://api.github.com/users/akestoridis", "html_url": "https://github.com/akestoridis", "followers_url": "https://api.github.com/users/akestoridis/followers", "following_url": "https://api.github.com/users/akestoridis/following{/other_user}", "gists_url": "https://api.github.com/users/akestoridis/gists{/gist_id}", "starred_url": "https://api.github.com/users/akestoridis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akestoridis/subscriptions", "organizations_url": "https://api.github.com/users/akestoridis/orgs", "repos_url": "https://api.github.com/users/akestoridis/repos", "events_url": "https://api.github.com/users/akestoridis/events{/privacy}", "received_events_url": "https://api.github.com/users/akestoridis/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-01-26T00:39:28Z", "updated_at": "2021-02-03T15:16:13Z", "closed_at": "2021-02-03T15:16:12Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3071", "html_url": "https://github.com/secdev/scapy/pull/3071", "diff_url": "https://github.com/secdev/scapy/pull/3071.diff", "patch_url": "https://github.com/secdev/scapy/pull/3071.patch", "merged_at": "2021-02-03T15:16:12Z"}, "body": "* Fix bug in the dissection of Network Reports (introduced in commit cfe00d5c952e9048a40150390e0025b5ceff7228)\r\n* Rename the ZCL direction subfield\r\n* Add unit tests", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3071/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3071/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3065", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3065/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3065/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3065/events", "html_url": "https://github.com/secdev/scapy/issues/3065", "id": 791418527, "node_id": "MDU6SXNzdWU3OTE0MTg1Mjc=", "number": 3065, "title": "Destructor tries to access `self.ins` when L2bpfSocket failed to be created", "user": {"login": "bdraco", "id": 663432, "node_id": "MDQ6VXNlcjY2MzQzMg==", "avatar_url": "https://avatars.githubusercontent.com/u/663432?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bdraco", "html_url": "https://github.com/bdraco", "followers_url": "https://api.github.com/users/bdraco/followers", "following_url": "https://api.github.com/users/bdraco/following{/other_user}", "gists_url": "https://api.github.com/users/bdraco/gists{/gist_id}", "starred_url": "https://api.github.com/users/bdraco/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bdraco/subscriptions", "organizations_url": "https://api.github.com/users/bdraco/orgs", "repos_url": "https://api.github.com/users/bdraco/repos", "events_url": "https://api.github.com/users/bdraco/events{/privacy}", "received_events_url": "https://api.github.com/users/bdraco/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-01-21T19:07:03Z", "updated_at": "2021-01-26T15:02:03Z", "closed_at": "2021-01-26T15:02:03Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "#### Brief description\r\n\r\n<!-- describe the main issue in one sentence -->\r\n<!-- if possible, describe what components / protocols could be affected by the issue (e.g. wrpcap() + IPv6, it is likely this also affects XXX) -->\r\nThe `_L2bpfSocket` destructor attempts to access `self.ins` before it is created if the socket failed to be created.\r\n\r\n#### Environment\r\n\r\n-   Scapy version: `2.4.4`\r\n-   Python version: `3.8`\r\n-   Operating System: `Mac OS`\r\n\r\n<!-- if needed - further information to get a picture of your setup (e.g. a sketch of your network setup) -->\r\n\r\n#### How to reproduce\r\n\r\n\r\nSmallest replication:\r\n```\r\n>>> from scapy.config import conf\r\n>>> from scapy.sendrecv import AsyncSniffer\r\n>>> conf.L2socket()\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/Users/bdraco/Library/Python/3.8/lib/python/site-packages/scapy/arch/bpf/supersocket.py\", line 242, in __init__\r\n    super(L2bpfListenSocket, self).__init__(*args, **kwargs)\r\n  File \"/Users/bdraco/Library/Python/3.8/lib/python/site-packages/scapy/arch/bpf/supersocket.py\", line 62, in __init__\r\n    (self.ins, self.dev_bpf) = get_dev_bpf()\r\n  File \"/Users/bdraco/Library/Python/3.8/lib/python/site-packages/scapy/arch/bpf/core.py\", line 114, in get_dev_bpf\r\n    raise Scapy_Exception(\"No /dev/bpf handle is available !\")\r\nscapy.error.Scapy_Exception: No /dev/bpf handle is available !\r\n>>> ^D\r\nException ignored in: <function _L2bpfSocket.__del__ at 0x110de31f0>\r\nTraceback (most recent call last):\r\n  File \"/Users/bdraco/Library/Python/3.8/lib/python/site-packages/scapy/arch/bpf/supersocket.py\", line 139, in __del__\r\n    self.close()\r\n  File \"/Users/bdraco/Library/Python/3.8/lib/python/site-packages/scapy/arch/bpf/supersocket.py\", line 211, in close\r\n    if not self.closed and self.ins is not None:\r\nAttributeError: 'L2bpfSocket' object has no attribute 'ins'\r\n```\r\n#### Actual result\r\n\r\n<!-- dump results that outline the issue, please format your code -->\r\n\r\n#### Expected result\r\n\r\nNo exception\r\n\r\n#### Related resources\r\n\r\n<!-- traces / sample pcaps (stripped to the relevant frames), related standards, RFCs or other resources -->\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3065/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3065/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3051", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3051/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3051/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3051/events", "html_url": "https://github.com/secdev/scapy/issues/3051", "id": 785338795, "node_id": "MDU6SXNzdWU3ODUzMzg3OTU=", "number": 3051, "title": "macOS VMWare Fusion with long interface name", "user": {"login": "twodayslate", "id": 1085707, "node_id": "MDQ6VXNlcjEwODU3MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/1085707?v=4", "gravatar_id": "", "url": "https://api.github.com/users/twodayslate", "html_url": "https://github.com/twodayslate", "followers_url": "https://api.github.com/users/twodayslate/followers", "following_url": "https://api.github.com/users/twodayslate/following{/other_user}", "gists_url": "https://api.github.com/users/twodayslate/gists{/gist_id}", "starred_url": "https://api.github.com/users/twodayslate/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/twodayslate/subscriptions", "organizations_url": "https://api.github.com/users/twodayslate/orgs", "repos_url": "https://api.github.com/users/twodayslate/repos", "events_url": "https://api.github.com/users/twodayslate/events{/privacy}", "received_events_url": "https://api.github.com/users/twodayslate/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1265179855, "node_id": "MDU6TGFiZWwxMjY1MTc5ODU1", "url": "https://api.github.com/repos/secdev/scapy/labels/platform-specific", "name": "platform-specific", "color": "14acba", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 15, "created_at": "2021-01-13T18:31:50Z", "updated_at": "2021-03-02T08:54:53Z", "closed_at": "2021-03-02T08:54:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nUnable to get scapy to work on macOS Big Sur when using UDP raw sockets like `sr1(IP(dst=\"192.168.43.5\")/UDP(sport=137, dport=137))` to a VMWare Fusion VM on interface bridge100. The interface is truncated to bridge1 which does not exist.\r\n\r\nThis was discussed in gitter and I am filing an official ticket. It may be a Big Sur/Python error and not related to scapy.\r\n\r\nhttps://gitter.im/secdev/scapy?at=5fff2bbcdc2e4809aa1daa7f\r\n\r\n#### Environment\r\n\r\n```\r\n% pip list | grep scapy\r\nscapy                  2.4.4.dev265\r\n% sudo python --version\r\nPython 3.8.1\r\n% uname -a\r\nDarwin User-MBP 20.2.0 Darwin Kernel Version 20.2.0: Wed Dec  2 20:39:59 PST 2020; root:xnu-7195.60.75~1/RELEASE_X86_64 x86_64\r\n% sw_vers \r\nProductName:\tmacOS\r\nProductVersion:\t11.1\r\nBuildVersion:\t20C69\r\n```\r\n\r\nlibpcap was installed via homebrew\r\n```\r\n% brew list libpcap\r\n/usr/local/Cellar/libpcap/1.9.1/bin/pcap-config\r\n/usr/local/Cellar/libpcap/1.9.1/include/pcap/ (15 files)\r\n/usr/local/Cellar/libpcap/1.9.1/include/ (3 files)\r\n/usr/local/Cellar/libpcap/1.9.1/lib/libpcap.1.9.1.dylib\r\n/usr/local/Cellar/libpcap/1.9.1/lib/pkgconfig/libpcap.pc\r\n/usr/local/Cellar/libpcap/1.9.1/lib/ (3 other files)\r\n/usr/local/Cellar/libpcap/1.9.1/share/man/ (79 files)\r\n% echo $LDFLAGS \r\n-L/usr/local/opt/libffi/lib -L/usr/local/opt/libpcap/lib\r\n% echo $CPPFLAGS\r\n-I/usr/local/opt/libpcap/include\r\n% echo $PATH | awk '{split($0,a,\":\"); print a[1]}'          \r\n/usr/local/opt/libpcap/bin\r\n```\r\n\r\n#### How to reproduce\r\n192.168.43.5 is a Windows XP box on VMWare Fusion with 'Share with my Mac' networking selected\r\n```\r\n% scapy\r\n>>> scapy.__version__\r\n'2.4.4.dev265'\r\n>>> conf.use_pcap\r\nFalse\r\n>>> pkt = sr1(IP(dst=\"192.168.43.5\")/UDP(sport=137, dport=137), timeout=2, verbose=0)\r\nTraceback (most recent call last):\r\n  File \"/Users/user/.pyenv/versions/3.8.1/lib/python3.8/site-packages/scapy/arch/bpf/supersocket.py\", line 73, in __init__\r\n    fcntl.ioctl(self.ins, BIOCSETIF, struct.pack(\"16s16x\", self.iface.encode()))  # noqa: E501\r\nOSError: [Errno 6] Device not configured\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"<console>\", line 1, in <module>\r\n  File \"/Users/user/.pyenv/versions/3.8.1/lib/python3.8/site-packages/scapy/sendrecv.py\", line 541, in sr1\r\n    s = conf.L3socket(promisc=promisc, filter=filter,\r\n  File \"/Users/user/.pyenv/versions/3.8.1/lib/python3.8/site-packages/scapy/arch/bpf/supersocket.py\", line 241, in __init__\r\n    super(L2bpfListenSocket, self).__init__(*args, **kwargs)\r\n  File \"/Users/user/.pyenv/versions/3.8.1/lib/python3.8/site-packages/scapy/arch/bpf/supersocket.py\", line 75, in __init__\r\n    raise Scapy_Exception(\"BIOCSETIF failed on %s\" % self.iface)\r\nscapy.error.Scapy_Exception: BIOCSETIF failed on bridge1\r\n>>> conf.use_pcap = True\r\nWARNING: No libpcap provider available ! pcap won't be used\r\n>>> pkt = sr1(IP(dst=\"192.168.43.5\")/UDP(sport=137, dport=137), timeout=2, verbose=0)\r\nTraceback (most recent call last):\r\n  File \"<console>\", line 1, in <module>\r\n  File \"/Users/user/.pyenv/versions/3.8.1/lib/python3.8/site-packages/scapy/sendrecv.py\", line 541, in sr1\r\n    s = conf.L3socket(promisc=promisc, filter=filter,\r\n  File \"/Users/user/.pyenv/versions/3.8.1/lib/python3.8/site-packages/scapy/supersocket.py\", line 273, in __init__\r\n    self.outs = socket.socket(socket.AF_INET, socket.SOCK_RAW, socket.IPPROTO_RAW)  # noqa: E501\r\n  File \"/Users/user/.pyenv/versions/3.8.1/lib/python3.8/socket.py\", line 231, in __init__\r\n    _socket.socket.__init__(self, family, type, proto, fileno)\r\nPermissionError: [Errno 1] Operation not permitted\r\n```\r\n\r\n```\r\n% sudo scapy\r\n>>> conf.use_pcap\r\nFalse\r\n>>> scapy.__version__\r\n'2.4.4.dev265'\r\n>>> pkt = sr1(IP(pkt = sr1(IP(dst=\"192.168.43.5\")/UDP(sport=137, dport=137), timeout=2, verbose=1)\r\nTraceback (most recent call last):\r\n  File \"/Users/user/.pyenv/versions/3.8.1/lib/python3.8/site-packages/scapy/arch/bpf/supersocket.py\", line 73, in __init__\r\n    fcntl.ioctl(self.ins, BIOCSETIF, struct.pack(\"16s16x\", self.iface.encode()))  # noqa: E501\r\nOSError: [Errno 6] Device not configured\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"<console>\", line 1, in <module>\r\n  File \"/Users/user/.pyenv/versions/3.8.1/lib/python3.8/site-packages/scapy/sendrecv.py\", line 541, in sr1\r\n    s = conf.L3socket(promisc=promisc, filter=filter,\r\n  File \"/Users/user/.pyenv/versions/3.8.1/lib/python3.8/site-packages/scapy/arch/bpf/supersocket.py\", line 241, in __init__\r\n    super(L2bpfListenSocket, self).__init__(*args, **kwargs)\r\n  File \"/Users/user/.pyenv/versions/3.8.1/lib/python3.8/site-packages/scapy/arch/bpf/supersocket.py\", line 75, in __init__\r\n    raise Scapy_Exception(\"BIOCSETIF failed on %s\" % self.iface)\r\nscapy.error.Scapy_Exception: BIOCSETIF failed on bridge1\r\n>>> conf.use_pcap=True\r\nWARNING: No libpcap provider available ! pcap won't be used\r\n>>> pkt = sr1(IP(dst=\"192.168.43.5\")/UDP(sport=137, dport=137), timeout=2, verbose=1)\r\nTraceback (most recent call last):\r\n  File \"<console>\", line 1, in <module>\r\n  File \"/Users/user/.pyenv/versions/3.8.1/lib/python3.8/site-packages/scapy/sendrecv.py\", line 541, in sr1\r\n    s = conf.L3socket(promisc=promisc, filter=filter,\r\n  File \"/Users/user/.pyenv/versions/3.8.1/lib/python3.8/site-packages/scapy/supersocket.py\", line 275, in __init__\r\n    self.ins = socket.socket(socket.AF_PACKET, socket.SOCK_RAW, socket.htons(type))  # noqa: E501\r\nAttributeError: module 'socket' has no attribute 'AF_PACKET'", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3051/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3051/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3016", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3016/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3016/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3016/events", "html_url": "https://github.com/secdev/scapy/pull/3016", "id": 766288528, "node_id": "MDExOlB1bGxSZXF1ZXN0NTM5MzU3MTkw", "number": 3016, "title": "fix SOME/IP transport protocol message types", "user": {"login": "tobibrb", "id": 7139633, "node_id": "MDQ6VXNlcjcxMzk2MzM=", "avatar_url": "https://avatars.githubusercontent.com/u/7139633?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tobibrb", "html_url": "https://github.com/tobibrb", "followers_url": "https://api.github.com/users/tobibrb/followers", "following_url": "https://api.github.com/users/tobibrb/following{/other_user}", "gists_url": "https://api.github.com/users/tobibrb/gists{/gist_id}", "starred_url": "https://api.github.com/users/tobibrb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tobibrb/subscriptions", "organizations_url": "https://api.github.com/users/tobibrb/orgs", "repos_url": "https://api.github.com/users/tobibrb/repos", "events_url": "https://api.github.com/users/tobibrb/events{/privacy}", "received_events_url": "https://api.github.com/users/tobibrb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-12-14T10:55:44Z", "updated_at": "2020-12-15T00:00:08Z", "closed_at": "2020-12-14T23:59:36Z", "author_association": "NONE", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/3016", "html_url": "https://github.com/secdev/scapy/pull/3016", "diff_url": "https://github.com/secdev/scapy/pull/3016.diff", "patch_url": "https://github.com/secdev/scapy/pull/3016.patch", "merged_at": "2020-12-14T23:59:36Z"}, "body": "fixes #3008\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3016/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3016/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/3008", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/3008/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/3008/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/3008/events", "html_url": "https://github.com/secdev/scapy/issues/3008", "id": 761182124, "node_id": "MDU6SXNzdWU3NjExODIxMjQ=", "number": 3008, "title": "Wrong message type for SOME/IP transport protocol responses", "user": {"login": "tobibrb", "id": 7139633, "node_id": "MDQ6VXNlcjcxMzk2MzM=", "avatar_url": "https://avatars.githubusercontent.com/u/7139633?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tobibrb", "html_url": "https://github.com/tobibrb", "followers_url": "https://api.github.com/users/tobibrb/followers", "following_url": "https://api.github.com/users/tobibrb/following{/other_user}", "gists_url": "https://api.github.com/users/tobibrb/gists{/gist_id}", "starred_url": "https://api.github.com/users/tobibrb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tobibrb/subscriptions", "organizations_url": "https://api.github.com/users/tobibrb/orgs", "repos_url": "https://api.github.com/users/tobibrb/repos", "events_url": "https://api.github.com/users/tobibrb/events{/privacy}", "received_events_url": "https://api.github.com/users/tobibrb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-12-10T12:03:36Z", "updated_at": "2020-12-14T23:59:36Z", "closed_at": "2020-12-14T23:59:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!--\r\nThings to consider\r\n\r\n1.  Please check that you are using the latest scapy version, e.g. installed via:\r\n\r\n    `pip install --upgrade git+git://github.com/secdev/scapy`\r\n\r\n2.  If you are here to ask a question - please check previous issues and online resources, and consider using gitter instead: <https://gitter.im/secdev/scapy>\r\n\r\n3.  Please understand that **this is not a forum** but an issue tracker. The following article explains why you should limit questions asked on Github issues: <https://medium.com/@methane/why-you-must-not-ask-questions-on-github-issues-51d741d83fde>\r\n-->\r\n\r\n#### Brief description\r\n\r\nScapy automotive uses wrong message type for SOME/IP transport protocol responses and error messages.\r\n\r\n<!-- describe the main issue in one sentence -->\r\n<!-- if possible, describe what components / protocols could be affected by the issue (e.g. wrpcap() + IPv6, it is likely this also affects XXX) -->\r\n\r\n#### Environment\r\n\r\n-   Scapy version: `2.4.4`\r\n-   Python version: ` 3.8`\r\n-   Operating System: `Win 10`\r\n\r\nI'm trying to receive a SOME/IP transport protocol response. My simulated ECU (using vsomeip) sends the response with a message type of `0xa0`. This is according to the SOME/IP spec correct ([SOME/IP classic transport protocol spec](https://www.autosar.org/fileadmin/user_upload/standards/classic/19-11/AUTOSAR_SWS_SOMEIPTransportProtocol.pdf), [SOME/IP foundation spec](https://www.autosar.org/fileadmin/user_upload/standards/foundation/19-11/AUTOSAR_PRS_SOMEIPProtocol.pdf)).\r\n\r\n<img width=\"456\" alt=\"scapy_bug_spec\" src=\"https://user-images.githubusercontent.com/7139633/101769331-1b037580-3ae7-11eb-9642-e9f60384a809.PNG\">\r\n\r\n\r\nThe problem seems to be in the [SOMEIP](https://github.com/secdev/scapy/blob/master/scapy/contrib/automotive/someip.py) class. The [TYPE_TP_RESPONSE](https://github.com/secdev/scapy/blob/ee21931bbbbe94f801a6e44031cb117eba141e16/scapy/contrib/automotive/someip.py#L67) is wrong (set to `0x23`). It should be `0xa0` instead.\r\n\r\nSame thing for the [TYPE_TP_ERROR ](https://github.com/secdev/scapy/blob/ee21931bbbbe94f801a6e44031cb117eba141e16/scapy/contrib/automotive/someip.py#L68). It is set to `0x24`. This variable should be (according to SOME/IP transport protocol spec) set to `0xa1`.\r\n \r\n<!-- if needed - further information to get a picture of your setup (e.g. a sketch of your network setup) -->\r\n\r\n#### How to reproduce\r\n\r\n<!-- step-by-step explanation or a short script, may reference section 'Related resources' -->\r\nSend a SOME/IP RPC call to a transport protocol enabled service and wait for the response. The response needs to be above the max payload size for SOME/IP messages.\r\n\r\n#### Actual result\r\n\r\n<!-- dump results that outline the issue, please format your code -->\r\nTransport protocol response are not recognized correctly. Therefore the receiving part is not working.\r\nThe defined [conditional fields](https://github.com/secdev/scapy/blob/ee21931bbbbe94f801a6e44031cb117eba141e16/scapy/contrib/automotive/someip.py#L127) are always `None`\r\n\r\n```\r\n        ConditionalField(BitField(\"offset\", 0, 28),\r\n                         lambda pkt: SOMEIP._is_tp(pkt)),\r\n        ConditionalField(BitField(\"res\", 0, 3),\r\n                         lambda pkt: SOMEIP._is_tp(pkt)),\r\n        ConditionalField(BitField(\"more_seg\", 0, 1),\r\n                         lambda pkt: SOMEIP._is_tp(pkt))\r\n```\r\n\r\nDebugging the code, the static `_is_tp()` method inside the `SOMEIP` class returns always `False` for transport protocol responses.\r\n\r\n#### Expected result\r\n\r\n<!-- describe the expected result and outline the difference to the actual one, could also be a screen shot (e.g. wireshark) -->\r\n\r\nThe `_is_tp()` method inside the `SOMEIP` class  should return `True` for transport protocol responses.\r\n\r\n<img width=\"829\" alt=\"scapy_bug_wire\" src=\"https://user-images.githubusercontent.com/7139633/101769536-67e74c00-3ae7-11eb-8984-1745da1eb5da.PNG\">\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/3008/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/3008/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2967", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2967/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2967/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2967/events", "html_url": "https://github.com/secdev/scapy/pull/2967", "id": 747677988, "node_id": "MDExOlB1bGxSZXF1ZXN0NTI0ODU3NTI2", "number": 2967, "title": "Only import tuntap layer on platforms that support it", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1265179855, "node_id": "MDU6TGFiZWwxMjY1MTc5ODU1", "url": "https://api.github.com/repos/secdev/scapy/labels/platform-specific", "name": "platform-specific", "color": "14acba", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-11-20T17:41:10Z", "updated_at": "2020-11-20T22:25:02Z", "closed_at": "2020-11-20T22:16:28Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2967", "html_url": "https://github.com/secdev/scapy/pull/2967", "diff_url": "https://github.com/secdev/scapy/pull/2967.diff", "patch_url": "https://github.com/secdev/scapy/pull/2967.patch", "merged_at": "2020-11-20T22:16:28Z"}, "body": "- minor fix to make sure we don't try to load `tuntap` on windows.\r\n- also took that occasion to reformat `conf.load_layers` so that we don't have to update all 4 lines each time we do a change", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2967/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2967/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2946", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2946/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2946/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2946/events", "html_url": "https://github.com/secdev/scapy/pull/2946", "id": 738131596, "node_id": "MDExOlB1bGxSZXF1ZXN0NTE3MDUyNDA5", "number": 2946, "title": "Clear cache in dns_compress", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-11-07T01:42:22Z", "updated_at": "2020-11-07T19:12:26Z", "closed_at": "2020-11-07T17:38:15Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2946", "html_url": "https://github.com/secdev/scapy/pull/2946", "diff_url": "https://github.com/secdev/scapy/pull/2946.diff", "patch_url": "https://github.com/secdev/scapy/pull/2946.patch", "merged_at": "2020-11-07T17:38:15Z"}, "body": "I realized that if a DNS packet was dissected its compressed form, then recompressed, `dns_compress` could crash because the raw form it would be using was the cached one. The fix is trivial", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2946/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2946/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2945", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2945/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2945/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2945/events", "html_url": "https://github.com/secdev/scapy/pull/2945", "id": 737757881, "node_id": "MDExOlB1bGxSZXF1ZXN0NTE2NzQzNzY2", "number": 2945, "title": "Clear cache in dns_compress", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-11-06T13:28:45Z", "updated_at": "2020-11-07T01:12:59Z", "closed_at": "2020-11-07T01:12:54Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2945", "html_url": "https://github.com/secdev/scapy/pull/2945", "diff_url": "https://github.com/secdev/scapy/pull/2945.diff", "patch_url": "https://github.com/secdev/scapy/pull/2945.patch", "merged_at": null}, "body": "I realized that if a DNS packet was dissected its compressed form, then recompressed, `dns_compress` could crash because the raw form it would be using was the cached one. The fix is trivial", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2945/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2945/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2935", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2935/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2935/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2935/events", "html_url": "https://github.com/secdev/scapy/pull/2935", "id": 734472369, "node_id": "MDExOlB1bGxSZXF1ZXN0NTE0MDMxMTY3", "number": 2935, "title": "Use sock_fprog instead of bpf_program on Linux", "user": {"login": "iii-i", "id": 45998171, "node_id": "MDQ6VXNlcjQ1OTk4MTcx", "avatar_url": "https://avatars.githubusercontent.com/u/45998171?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iii-i", "html_url": "https://github.com/iii-i", "followers_url": "https://api.github.com/users/iii-i/followers", "following_url": "https://api.github.com/users/iii-i/following{/other_user}", "gists_url": "https://api.github.com/users/iii-i/gists{/gist_id}", "starred_url": "https://api.github.com/users/iii-i/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iii-i/subscriptions", "organizations_url": "https://api.github.com/users/iii-i/orgs", "repos_url": "https://api.github.com/users/iii-i/repos", "events_url": "https://api.github.com/users/iii-i/events{/privacy}", "received_events_url": "https://api.github.com/users/iii-i/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1265179855, "node_id": "MDU6TGFiZWwxMjY1MTc5ODU1", "url": "https://api.github.com/repos/secdev/scapy/labels/platform-specific", "name": "platform-specific", "color": "14acba", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-11-02T12:40:09Z", "updated_at": "2020-11-02T14:39:58Z", "closed_at": "2020-11-02T14:38:49Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2935", "html_url": "https://github.com/secdev/scapy/pull/2935", "diff_url": "https://github.com/secdev/scapy/pull/2935.diff", "patch_url": "https://github.com/secdev/scapy/pull/2935.patch", "merged_at": "2020-11-02T14:38:49Z"}, "body": "sock_fprog is different from bpf_program in that its length field is\r\nushort instead of int. This results in a different layout on big-endian\r\nmachines.\r\n\r\nFix by defining sock_fprog and copying field values from bpf_program.\r\n\r\nIn theory sock_filter and bpf_insn could be affected too, but in\r\npractice they are the same.\r\n\r\nSigned-off-by: Ilya Leoshkevich <iii@linux.ibm.com>", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2935/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2935/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2930", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2930/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2930/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2930/events", "html_url": "https://github.com/secdev/scapy/issues/2930", "id": 733238404, "node_id": "MDU6SXNzdWU3MzMyMzg0MDQ=", "number": 2930, "title": "TLS1.3 Extension for SignatureAlgorithmsCert is using wrong Type value", "user": {"login": "GSBhub", "id": 6609059, "node_id": "MDQ6VXNlcjY2MDkwNTk=", "avatar_url": "https://avatars.githubusercontent.com/u/6609059?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GSBhub", "html_url": "https://github.com/GSBhub", "followers_url": "https://api.github.com/users/GSBhub/followers", "following_url": "https://api.github.com/users/GSBhub/following{/other_user}", "gists_url": "https://api.github.com/users/GSBhub/gists{/gist_id}", "starred_url": "https://api.github.com/users/GSBhub/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GSBhub/subscriptions", "organizations_url": "https://api.github.com/users/GSBhub/orgs", "repos_url": "https://api.github.com/users/GSBhub/repos", "events_url": "https://api.github.com/users/GSBhub/events{/privacy}", "received_events_url": "https://api.github.com/users/GSBhub/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1317786288, "node_id": "MDU6TGFiZWwxMzE3Nzg2Mjg4", "url": "https://api.github.com/repos/secdev/scapy/labels/tls", "name": "tls", "color": "56088e", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-10-30T14:39:07Z", "updated_at": "2020-11-02T13:29:56Z", "closed_at": "2020-11-02T13:29:56Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Brief description**\r\n\"Type\" is set to 0x31 (PostHandshakeAuth), should be using 0x32 (SignatureAlgorithmsCert).\r\n\r\nhttps://github.com/secdev/scapy/blob/e79833e46ec33be0880447a1983e3840676302fe/scapy/layers/tls/extensions.py#L658-L667\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2930/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2930/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2904", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2904/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2904/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2904/events", "html_url": "https://github.com/secdev/scapy/pull/2904", "id": 728378698, "node_id": "MDExOlB1bGxSZXF1ZXN0NTA5MDk2NzY2", "number": 2904, "title": "Add GAA_FLAG_INCLUDE_ALL_INTERFACES", "user": {"login": "DuzaBF", "id": 33791465, "node_id": "MDQ6VXNlcjMzNzkxNDY1", "avatar_url": "https://avatars.githubusercontent.com/u/33791465?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DuzaBF", "html_url": "https://github.com/DuzaBF", "followers_url": "https://api.github.com/users/DuzaBF/followers", "following_url": "https://api.github.com/users/DuzaBF/following{/other_user}", "gists_url": "https://api.github.com/users/DuzaBF/gists{/gist_id}", "starred_url": "https://api.github.com/users/DuzaBF/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DuzaBF/subscriptions", "organizations_url": "https://api.github.com/users/DuzaBF/orgs", "repos_url": "https://api.github.com/users/DuzaBF/repos", "events_url": "https://api.github.com/users/DuzaBF/events{/privacy}", "received_events_url": "https://api.github.com/users/DuzaBF/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1265179855, "node_id": "MDU6TGFiZWwxMjY1MTc5ODU1", "url": "https://api.github.com/repos/secdev/scapy/labels/platform-specific", "name": "platform-specific", "color": "14acba", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-10-23T17:05:14Z", "updated_at": "2020-10-23T19:13:20Z", "closed_at": "2020-10-23T17:28:33Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2904", "html_url": "https://github.com/secdev/scapy/pull/2904", "diff_url": "https://github.com/secdev/scapy/pull/2904.diff", "patch_url": "https://github.com/secdev/scapy/pull/2904.patch", "merged_at": "2020-10-23T17:28:33Z"}, "body": "Change flags for the `GetAdapterAdresses` adding `GAA_FLAG_INCLUDE_ALL_INTERFACES` so that it is possible to get and work with all interfaces on Windows.\r\n\r\nfixes #2900\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2904/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2904/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2900", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2900/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2900/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2900/events", "html_url": "https://github.com/secdev/scapy/issues/2900", "id": 728036730, "node_id": "MDU6SXNzdWU3MjgwMzY3MzA=", "number": 2900, "title": "Unable to send L2 packet if TCP/IP is disabled in the adapter", "user": {"login": "DuzaBF", "id": 33791465, "node_id": "MDQ6VXNlcjMzNzkxNDY1", "avatar_url": "https://avatars.githubusercontent.com/u/33791465?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DuzaBF", "html_url": "https://github.com/DuzaBF", "followers_url": "https://api.github.com/users/DuzaBF/followers", "following_url": "https://api.github.com/users/DuzaBF/following{/other_user}", "gists_url": "https://api.github.com/users/DuzaBF/gists{/gist_id}", "starred_url": "https://api.github.com/users/DuzaBF/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DuzaBF/subscriptions", "organizations_url": "https://api.github.com/users/DuzaBF/orgs", "repos_url": "https://api.github.com/users/DuzaBF/repos", "events_url": "https://api.github.com/users/DuzaBF/events{/privacy}", "received_events_url": "https://api.github.com/users/DuzaBF/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1265179855, "node_id": "MDU6TGFiZWwxMjY1MTc5ODU1", "url": "https://api.github.com/repos/secdev/scapy/labels/platform-specific", "name": "platform-specific", "color": "14acba", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-10-23T08:52:03Z", "updated_at": "2020-10-23T17:28:33Z", "closed_at": "2020-10-23T17:28:33Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!--\r\nThings to consider\r\n\r\n1.  Please check that you are using the latest scapy version, e.g. installed via:\r\n\r\n    `pip install --upgrade git+git://github.com/secdev/scapy`\r\n\r\n2.  If you are here to ask a question - please check previous issues and online resources, and consider using gitter instead: <https://gitter.im/secdev/scapy>\r\n\r\n3.  Please understand that **this is not a forum** but an issue tracker. The following article explains why you should limit questions asked on Github issues: <https://medium.com/@methane/why-you-must-not-ask-questions-on-github-issues-51d741d83fde>\r\n-->\r\n\r\n#### Brief description\r\n\r\nScapy does not recognize networks with disabled TCP/IP protocols and unable to send custom L2 packet.\r\n\r\n<!-- describe the main issue in one sentence -->\r\n<!-- if possible, describe what components / protocols could be affected by the issue (e.g. wrpcap() + IPv6, it is likely this also affects XXX) -->\r\n\r\n#### Environment\r\n\r\n-   Scapy version: 2.4.4\r\n-   Python version: 3.7.8\r\n-   Operating System: Windows 10 (also Windows 7 SP1)\r\n\r\n<!-- if needed - further information to get a picture of your setup (e.g. a sketch of your network setup) -->\r\n\r\n#### Problem and workaround\r\n\r\nI have to test a device in a isolated and fully controlled LAN. The Windows PC with LAN adapter itself sends packets into the network, which interferes with tests. Switching to Linux is not possible.\r\n\r\nTo stop Windows from sending packets, all services, the TCP/IPv4 and TCP/IPv6 protocols were disabled. Npcap Packet Driver, Link-Layer Topology Discovery Mapper I/O Driver, Link-Layer Topology Discovery Responder were enabled.\r\n\r\nWith that configuration Scapy does not see those networks in `get_windows_if_list()` and results in `ValueError: Unknown pypcap network interface 'local4'` when `sendp(iface='local4', x=Ether())` is executed. \r\n\r\nTo fix that problem, I've modified the https://github.com/secdev/scapy/blob/master/scapy/arch/windows/structures.py changing the flags of `GetAdapterAddresses` function to include all interfaces `GAA_FLAG_INCLUDE_ALL_INTERFACES`.\r\n\r\n```diff\r\n...\r\n- 244. GAA_FLAG_INCLUDE_PREFIX = ULONG(0x0010)\r\n+ 244.GAA_FLAG = ULONG(0x0010 | 0x0100)\r\n...\r\n- 438. flags = GAA_FLAG_INCLUDE_PREFIX\r\n+ 438. flags = GAA_FLAG\r\n...\r\n```\r\n\r\nWith that fix it is possible to send a L2 packet into the network.\r\n\r\nIs there a better way to do it?\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2900/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2900/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2896", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2896/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2896/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2896/events", "html_url": "https://github.com/secdev/scapy/issues/2896", "id": 727164616, "node_id": "MDU6SXNzdWU3MjcxNjQ2MTY=", "number": 2896, "title": "Issue with DADict hasattr call", "user": {"login": "Matthewar", "id": 18592960, "node_id": "MDQ6VXNlcjE4NTkyOTYw", "avatar_url": "https://avatars.githubusercontent.com/u/18592960?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Matthewar", "html_url": "https://github.com/Matthewar", "followers_url": "https://api.github.com/users/Matthewar/followers", "following_url": "https://api.github.com/users/Matthewar/following{/other_user}", "gists_url": "https://api.github.com/users/Matthewar/gists{/gist_id}", "starred_url": "https://api.github.com/users/Matthewar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Matthewar/subscriptions", "organizations_url": "https://api.github.com/users/Matthewar/orgs", "repos_url": "https://api.github.com/users/Matthewar/repos", "events_url": "https://api.github.com/users/Matthewar/events{/privacy}", "received_events_url": "https://api.github.com/users/Matthewar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-10-22T08:23:52Z", "updated_at": "2020-10-23T19:33:44Z", "closed_at": "2020-10-23T19:33:44Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "#### Brief description\r\n\r\n`DADict` class always returns true for `hasattr` calls, even if the attribute isn't included.\r\n\r\n#### Environment\r\n\r\n-   Scapy version: `2.4.4`\r\n-   Python version: `2.7` (I think the issue is for all versions though)\r\n-   Operating System: `RHEL 7.5`\r\n\r\n#### How to reproduce\r\n\r\nhttps://github.com/secdev/scapy/blob/bfd9c52af61978ac872d3c0bf5eef81168d88ca9/scapy/dadict.py#L109-L115\r\nThere is no check for if the `__getattr__` function reaches the end without returning, I think in those cases it should raise an `AttributeError`", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2896/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2896/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2895", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2895/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2895/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2895/events", "html_url": "https://github.com/secdev/scapy/pull/2895", "id": 727068054, "node_id": "MDExOlB1bGxSZXF1ZXN0NTA4MDMxMDQz", "number": 2895, "title": "Improvements to PCAPNG dissection", "user": {"login": "michaelbrandeis", "id": 4642013, "node_id": "MDQ6VXNlcjQ2NDIwMTM=", "avatar_url": "https://avatars.githubusercontent.com/u/4642013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelbrandeis", "html_url": "https://github.com/michaelbrandeis", "followers_url": "https://api.github.com/users/michaelbrandeis/followers", "following_url": "https://api.github.com/users/michaelbrandeis/following{/other_user}", "gists_url": "https://api.github.com/users/michaelbrandeis/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelbrandeis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelbrandeis/subscriptions", "organizations_url": "https://api.github.com/users/michaelbrandeis/orgs", "repos_url": "https://api.github.com/users/michaelbrandeis/repos", "events_url": "https://api.github.com/users/michaelbrandeis/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelbrandeis/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1000112749, "node_id": "MDU6TGFiZWwxMDAwMTEyNzQ5", "url": "https://api.github.com/repos/secdev/scapy/labels/cleanup", "name": "cleanup", "color": "FF68F6", "default": false, "description": "Performs some code clean-up"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-10-22T05:47:56Z", "updated_at": "2021-02-06T17:29:21Z", "closed_at": "2021-02-06T17:29:21Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2895", "html_url": "https://github.com/secdev/scapy/pull/2895", "diff_url": "https://github.com/secdev/scapy/pull/2895.diff", "patch_url": "https://github.com/secdev/scapy/pull/2895.patch", "merged_at": "2021-02-06T17:29:21Z"}, "body": "- add support for multiple SHB blocks in PCAPNG\r\n- add tail processing for the first SHB block (checking the double length equality) by reusing existing code.\r\n- Bug: the first SHB blocklen was only parsed as big-endian.\r\n\r\nfixes https://github.com/secdev/scapy/issues/2894", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2895/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2895/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2894", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2894/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2894/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2894/events", "html_url": "https://github.com/secdev/scapy/issues/2894", "id": 727054417, "node_id": "MDU6SXNzdWU3MjcwNTQ0MTc=", "number": 2894, "title": "pcapng using wrong blocklen", "user": {"login": "michaelbrandeis", "id": 4642013, "node_id": "MDQ6VXNlcjQ2NDIwMTM=", "avatar_url": "https://avatars.githubusercontent.com/u/4642013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelbrandeis", "html_url": "https://github.com/michaelbrandeis", "followers_url": "https://api.github.com/users/michaelbrandeis/followers", "following_url": "https://api.github.com/users/michaelbrandeis/following{/other_user}", "gists_url": "https://api.github.com/users/michaelbrandeis/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelbrandeis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelbrandeis/subscriptions", "organizations_url": "https://api.github.com/users/michaelbrandeis/orgs", "repos_url": "https://api.github.com/users/michaelbrandeis/repos", "events_url": "https://api.github.com/users/michaelbrandeis/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelbrandeis/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-10-22T05:18:09Z", "updated_at": "2021-02-06T17:29:21Z", "closed_at": "2021-02-06T17:29:21Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Brief description\r\n\r\npcapng blocklen calculated incorrectly\r\n\r\n#### Environment\r\n\r\n-   Scapy version: 2.4.4\r\n-   Python version: 3.8.2\r\n-   Operating System: MacOS 10.15.7\r\n\r\n\r\n#### How to reproduce\r\n\r\n```\r\nsniff(prn=handle_packet, filter='udp', offline=pcap)\r\n```\r\n\r\npass in a filter and passing offline a pcapng fie\r\n\r\n#### Actual result\r\n\r\nBy using offline mode and a pcapng file, and passing in a filter on a Mac it will trigger it to use tcpdump through a subprocess. During initialization the blocklen is calculated incorrectly and it reads the ENTIRE file into memory, and then tries to seek(0) - which is an illegal operation on a PIPE. When it tries to read a packet it is at the end of the file and exits sniff.\r\n\r\nThe result is NO packet output is produced.\r\n\r\nWhen not passing in a filter the code \"appears\" to work because the seek(0) resets to the start of the file - however, since it used the wrong blocklen it will actually read the entire file into memory and then discard it, which could have performance impacts on large pcap files.\r\n\r\n\r\n#### Expected result\r\n\r\nExpected output is any list of packets that pass the filter.\r\n\r\n#### Related resources\r\n\r\nI added some print statements to get a better look at the blocklen, here is what scapy's output is by default:\r\n```\r\npython mojo.py --pcap example.pcap\r\nreading from PCAP-NG file example.pcap\r\nBLOCKLEN 80000000\r\nBLOCKLEN 2147483648\r\n<EOF>\r\n```\r\n\r\nafter replacing unpack(\"!I\", blocklen) with unpack(self.endian + \"I\", blocklen) the blocklen appears correct and the sniff command works\r\n\r\n```\r\n        print(\"BLOCKLEN\", blocklen.hex())\r\n        blocklen = struct.unpack(self.endian + 'I', blocklen)[0]\r\n        print(\"BLOCKLEN\", blocklen)\r\n```\r\n\r\n```\r\npython mojo.py --pcap example.pcap\r\nreading from PCAP-NG file example.pcap\r\nBLOCKLEN 80000000\r\nBLOCKLEN 128\r\nEther / IP / UDP 5.188.125.46:intecom_ps1 > 192.168.8.114:63285 / Raw\r\nEther / IP / UDP 192.168.8.114:63285 > 5.188.125.46:intecom_ps1 / Raw\r\nEther / IP / UDP 192.168.8.114:50190 > 5.188.125.14:unot / Raw\r\n```", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2894/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2894/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2890", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2890/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2890/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2890/events", "html_url": "https://github.com/secdev/scapy/pull/2890", "id": 725155750, "node_id": "MDExOlB1bGxSZXF1ZXN0NTA2NDMxODYw", "number": 2890, "title": "dhcp6: Make prefixes in DHCP6OptIA_PD.iapdopt get parsed as list", "user": {"login": "bavva", "id": 6486355, "node_id": "MDQ6VXNlcjY0ODYzNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/6486355?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bavva", "html_url": "https://github.com/bavva", "followers_url": "https://api.github.com/users/bavva/followers", "following_url": "https://api.github.com/users/bavva/following{/other_user}", "gists_url": "https://api.github.com/users/bavva/gists{/gist_id}", "starred_url": "https://api.github.com/users/bavva/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bavva/subscriptions", "organizations_url": "https://api.github.com/users/bavva/orgs", "repos_url": "https://api.github.com/users/bavva/repos", "events_url": "https://api.github.com/users/bavva/events{/privacy}", "received_events_url": "https://api.github.com/users/bavva/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-10-20T03:22:23Z", "updated_at": "2020-10-20T08:08:34Z", "closed_at": "2020-10-20T08:08:34Z", "author_association": "NONE", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2890", "html_url": "https://github.com/secdev/scapy/pull/2890", "diff_url": "https://github.com/secdev/scapy/pull/2890.diff", "patch_url": "https://github.com/secdev/scapy/pull/2890.patch", "merged_at": "2020-10-20T08:08:34Z"}, "body": "Although DHCP6OptIA_PD.iapdopt is defined as PacketListField, scapy is\r\nparsing one DHCP6OptIAPrefix option as the payload of the previous\r\nprefix option. This patch fixes that by telling scapy that there is no\r\npayload to DHCP6OptIAPrefix option. This is similar to how the same\r\nproblem is handled with DHCP6OptIAAddress options.\r\n\r\nTesting:\r\nAdded unit tests.\r\n\r\nWithout this patch:\r\n```\r\n    \\iapdopt   \\\r\n     |###[ DHCP6 Option - IA_PD Prefix option ]###\r\n     |  optcode   = OPTION_IAPREFIX\r\n     |  optlen    = 25\r\n     |  preflft   = 150\r\n     |  validlft  = 450\r\n     |  plen      = 80\r\n     |  prefix    = ::1:0:0:0\r\n     |  iaprefopts= ''\r\n     |###[ DHCP6 Option - IA_PD Prefix option ]###\r\n     |     optcode   = OPTION_IAPREFIX\r\n     |     optlen    = 25\r\n     |     preflft   = 0\r\n     |     validlft  = 0\r\n     |     plen      = 80\r\n     |     prefix    = ::2:0:0:0\r\n     |     iaprefopts= ''\r\n```\r\nWith this patch:\r\n```\r\n    \\iapdopt   \\\r\n     |###[ DHCP6 Option - IA_PD Prefix option ]###\r\n     |  optcode   = OPTION_IAPREFIX\r\n     |  optlen    = 25\r\n     |  preflft   = 150\r\n     |  validlft  = 450\r\n     |  plen      = 80\r\n     |  prefix    = ::1:0:0:0\r\n     |  iaprefopts= ''\r\n     |###[ DHCP6 Option - IA_PD Prefix option ]###\r\n     |  optcode   = OPTION_IAPREFIX\r\n     |  optlen    = 25\r\n     |  preflft   = 0\r\n     |  validlft  = 0\r\n     |  plen      = 80\r\n     |  prefix    = ::2:0:0:0\r\n     |  iaprefopts= ''\r\n```\r\n\r\nIssue: https://github.com/secdev/scapy/issues/2880\r\nSigned-off-by: Bharadwaj Avva <vv.bharadwaj@gmail.com>\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2890/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2890/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2880", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2880/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2880/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2880/events", "html_url": "https://github.com/secdev/scapy/issues/2880", "id": 722568560, "node_id": "MDU6SXNzdWU3MjI1Njg1NjA=", "number": 2880, "title": "dhcp6: Make prefixes in DHCP6OptIA_PD.iapdopt get parsed as list", "user": {"login": "bavva", "id": 6486355, "node_id": "MDQ6VXNlcjY0ODYzNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/6486355?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bavva", "html_url": "https://github.com/bavva", "followers_url": "https://api.github.com/users/bavva/followers", "following_url": "https://api.github.com/users/bavva/following{/other_user}", "gists_url": "https://api.github.com/users/bavva/gists{/gist_id}", "starred_url": "https://api.github.com/users/bavva/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bavva/subscriptions", "organizations_url": "https://api.github.com/users/bavva/orgs", "repos_url": "https://api.github.com/users/bavva/repos", "events_url": "https://api.github.com/users/bavva/events{/privacy}", "received_events_url": "https://api.github.com/users/bavva/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-10-15T18:27:53Z", "updated_at": "2020-10-20T08:08:34Z", "closed_at": "2020-10-20T08:08:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\nAlthough DHCP6OptIA_PD.iapdopt is defined as PacketListField, scapy is\r\nparsing one DHCP6OptIAPrefix option as the payload of the previous\r\nprefix option. so len(DHCP6OptIA_PD.iapdopt) would just print 1 even when\r\nthere are multiple prefixes.\r\n\r\n#### Environment\r\n-   Scapy version: 2.4.4\r\n-   Python version: 3.6.4\r\n-   Operating System: Amazon Linux AL2012.03\r\n\r\n#### How to reproduce\r\n1. Craft a DHCPv6 reply packet with multiple prefixes in it.\r\n2. Print the length of DHCP6OptIA_PD.iapdopt or just print the packet with show2() and see that the len is 1 even though there are 2 prefixes. The reason is, scapy is parsing one prefix option as payload of previous prefix option.\r\n\r\n#### Actual result\r\nWhen printing DHCPv6 packet with IA_PD option with show2()\r\n```\r\n    \\iapdopt   \\\r\n     |###[ DHCP6 Option - IA_PD Prefix option ]###\r\n     |  optcode   = OPTION_IAPREFIX\r\n     |  optlen    = 25\r\n     |  preflft   = 150\r\n     |  validlft  = 450\r\n     |  plen      = 80\r\n     |  prefix    = ::1:0:0:0\r\n     |  iaprefopts= ''\r\n     |###[ DHCP6 Option - IA_PD Prefix option ]###\r\n     |             optcode   = OPTION_IAPREFIX\r\n     |             optlen    = 25\r\n     |             preflft   = 0\r\n     |             validlft  = 0\r\n     |             plen      = 80\r\n     |             prefix    = ::2:0:0:0\r\n     |             iaprefopts= ''\r\n```\r\n\r\n#### Expected result\r\nWhen printing DHCPv6 packet with IA_PD option with show2()\r\n```\r\n    \\iapdopt   \\\r\n     |###[ DHCP6 Option - IA_PD Prefix option ]###\r\n     |  optcode   = OPTION_IAPREFIX\r\n     |  optlen    = 25\r\n     |  preflft   = 150\r\n     |  validlft  = 450\r\n     |  plen      = 80\r\n     |  prefix    = ::1:0:0:0\r\n     |  iaprefopts= ''\r\n     |###[ DHCP6 Option - IA_PD Prefix option ]###\r\n     |  optcode   = OPTION_IAPREFIX\r\n     |  optlen    = 25\r\n     |  preflft   = 0\r\n     |  validlft  = 0\r\n     |  plen      = 80\r\n     |  prefix    = ::2:0:0:0\r\n     |  iaprefopts= ''\r\n\r\n```\r\n#### Related resources\r\nPrefix Delegation RFC - https://tools.ietf.org/html/rfc8415#section-21.21\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2880/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2880/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2839", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2839/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2839/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2839/events", "html_url": "https://github.com/secdev/scapy/pull/2839", "id": 711757304, "node_id": "MDExOlB1bGxSZXF1ZXN0NDk1MzUyNjk3", "number": 2839, "title": "volatile: add command method to be used in Packet.command()", "user": {"login": "ThomasFaivre", "id": 5682339, "node_id": "MDQ6VXNlcjU2ODIzMzk=", "avatar_url": "https://avatars.githubusercontent.com/u/5682339?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ThomasFaivre", "html_url": "https://github.com/ThomasFaivre", "followers_url": "https://api.github.com/users/ThomasFaivre/followers", "following_url": "https://api.github.com/users/ThomasFaivre/following{/other_user}", "gists_url": "https://api.github.com/users/ThomasFaivre/gists{/gist_id}", "starred_url": "https://api.github.com/users/ThomasFaivre/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ThomasFaivre/subscriptions", "organizations_url": "https://api.github.com/users/ThomasFaivre/orgs", "repos_url": "https://api.github.com/users/ThomasFaivre/repos", "events_url": "https://api.github.com/users/ThomasFaivre/events{/privacy}", "received_events_url": "https://api.github.com/users/ThomasFaivre/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-09-30T08:47:55Z", "updated_at": "2020-10-02T08:34:10Z", "closed_at": "2020-10-01T18:48:07Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2839", "html_url": "https://github.com/secdev/scapy/pull/2839", "diff_url": "https://github.com/secdev/scapy/pull/2839.diff", "patch_url": "https://github.com/secdev/scapy/pull/2839.patch", "merged_at": "2020-10-01T18:48:07Z"}, "body": "When a VolatileValue subclass is used inside a Packet, the command()\r\nmethod returns a string that get a Syntax Error when evaluated, e.g.:\r\n\r\n> ICMPv6NIQueryNOOP(nonce=<RandBin>)\r\n\r\nAdd a command() method to the VolatileValue class so that it can be\r\nhandled properly. The _command_args() method is used to defined the\r\nstring used as argument for a given VolatileValue subclass.\r\n\r\nDefault values are not displayed.\r\n\r\nFixes #2828.\r\n\r\nSigned-off-by: Thomas Faivre <thomas.faivre@6wind.com>", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2839/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2839/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2832", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2832/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2832/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2832/events", "html_url": "https://github.com/secdev/scapy/issues/2832", "id": 708421903, "node_id": "MDU6SXNzdWU3MDg0MjE5MDM=", "number": 2832, "title": "Problem in handling Radius EAP Fragmentation", "user": {"login": "crest42", "id": 10732757, "node_id": "MDQ6VXNlcjEwNzMyNzU3", "avatar_url": "https://avatars.githubusercontent.com/u/10732757?v=4", "gravatar_id": "", "url": "https://api.github.com/users/crest42", "html_url": "https://github.com/crest42", "followers_url": "https://api.github.com/users/crest42/followers", "following_url": "https://api.github.com/users/crest42/following{/other_user}", "gists_url": "https://api.github.com/users/crest42/gists{/gist_id}", "starred_url": "https://api.github.com/users/crest42/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/crest42/subscriptions", "organizations_url": "https://api.github.com/users/crest42/orgs", "repos_url": "https://api.github.com/users/crest42/repos", "events_url": "https://api.github.com/users/crest42/events{/privacy}", "received_events_url": "https://api.github.com/users/crest42/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2020-09-24T19:31:51Z", "updated_at": "2021-01-21T16:34:44Z", "closed_at": "2021-01-21T16:34:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Brief description\r\nWhen handling RADIUS-AVP fragmented EAP packets the fragmentation detection might not work, since random values may be checked.\r\n\r\n#### Environment\r\n\r\n-   Scapy version: latest master branch\r\n-   Python version: `2.8.5`\r\n-   Operating System: `Arch Linux`\r\n\r\n#### How to reproduce\r\n\r\nAttached is a python script and a capture file with a single radius packet. The packet consists of multiple AVP fields, with four of them representing an EAP message, that is fragmented due to AVP length constrains.\r\nWhen parsing this packet, scapy decides if the eap message is fragmented, by checking the third and fourth byte of the EAP fragment. This works if the EAP Packet is only fragmented into two AVP fields, since then these two bytes actually represent the length of the EAP fragment itself. After the second fragment, the decision if the AVP field is a fragment is based on random data in the EAP message. \r\n\r\nThe code in radius.py:\r\n```class _EAPPacketField(PacketLenField):\r\n\r\n    \"\"\"\r\n    Handles EAP-Message attribute value (the actual EAP packet).\r\n    \"\"\"\r\n\r\n    def m2i(self, pkt, m):\r\n        ret = None\r\n        eap_packet_len = struct.unpack(\"!H\", m[2:4])[0]\r\n        if eap_packet_len < 254:\r\n            # If the EAP packet has not been fragmented, build a Scapy EAP\r\n            # packet from the data.\r\n            ret = EAP(m)\r\n        else:\r\n            ret = conf.raw_layer(m)\r\n        return ret\r\n\r\n```\r\nThis could be fixed by using pkt.len as length indicator.\r\n\r\nHowever, if this is done, the last EAP Fragment is considered as an EAP message with size < 256 and therefore parsed as an EAP Packet. This makes no sense, since it is only the last fragment of the whole Packet and therefore the parsing results in random values.\r\n\r\nSorry if the issue may be a bit confusing, since i am rather new to scapy. I try to debug a little bit further and hopefully i can issue a PR with a fix. Any suggestions how this kind of fragmentation is usually handled and where to look further are much appreciated.\r\n\r\n#### Actual result\r\n```\r\n###[ Ethernet ]### \r\n  dst       = 00:00:00:00:00:00\r\n  src       = 00:00:00:00:00:00\r\n  type      = IPv4\r\n###[ IP ]### \r\n     version   = 4\r\n     ihl       = 5\r\n     tos       = 0x0\r\n     len       = 1096\r\n     id        = 34276\r\n     flags     = \r\n     frag      = 0\r\n     ttl       = 64\r\n     proto     = udp\r\n     chksum    = 0xf2be\r\n     src       = 127.0.0.1\r\n     dst       = 127.0.0.1\r\n     \\options   \\\r\n###[ UDP ]### \r\n        sport     = radius\r\n        dport     = 39306\r\n        len       = 1076\r\n        chksum    = 0x248\r\n###[ RADIUS ]### \r\n           code      = Access-Challenge\r\n           id        = 28\r\n           len       = 1068\r\n           authenticator= 255ba5110bdc8f94f2e0018aac4e498e\r\n           \\attributes\\\r\n            |###[ EAP-Message ]### \r\n            |  type      = EAP-Message\r\n            |  len       = 255\r\n            |  \\value     \\\r\n            |   |###[ Raw ]### \r\n            |   |  load      = '\\x01\\x97\\x03\\xec\\r\\xc0\\x00\\x1a\\x15\\xd0`\\xa9P2\\xdd\\x8e\\x1ff\\xbc\\x1f\\x1b\\xb2\\xc3Y~dIF\\xdb;i\\xaf\\x01F\\xa2\\xeb\\x88\\xde\\xbd\\xb1\\xa3SG\\xa7\\xab;\\xf6\\xa9P\\xd7\\x8d\\xfc\\xfb\\xcf\\xf5r\\xf7u\\x15\\x0e\\xc8w^\\n\\xb6\\xe4\\x9b\\xd3[\\xb6\\x10\\xde\\x0b\\x02\\x88\\x98\\xbbJ&\"\\xb5\\x99\\xa6\\xbf(A\"\\xf4\\xaf6\\x82j\\xb3\\xa9=\\xf7\\xb8\\xf9\\xfb\\xe1\\xdf\\x81<U\\x17\\t7\\x0e\\xe9\\xcfg\\xac6p\\x9c\\xb3\\x94Y`\\xdb\\xe4\\x90;G\\xde\\x16=\\x89\\x9b\\x87l=8\\xdd\\xee\\xd1\\xe7e:\\xd3*\\xe7\\xe7\\xd1\\xd83_F\\xf8\\xbeWf\\xd1+\\xa4\\xddS\\x15p\\xa67|Y\\xacgN\\xccr\\xa7\\x99\\xa6=\\x0c\\xd8*^\\xde\\xff\\x12\\xa1\\xe27\\x07\\xbf\\xdf\\x1a\\x88Kem\\x86S\\xf6)(\\xe9\\xc4Q/\\x0f\\xd9\\xc2\\x11\\xcf\\xbcg\\x1c\\x82%\\xa5\\x01\\xb2\\xb9\\xddW\\\\\\xd9\\xf0\\x10\\xe4rO\\xa9op\\xecu\\x1czI,\\x9d}\\xf1\\x00\\x1b\\xef(*Z\\x02\\xbe:\\x0f\\x03,\\xd5iB\\x95{\\r\\xd6'\r\n            |###[ EAP-Message ]### \r\n            |  type      = EAP-Message\r\n            |  len       = 255\r\n            |  \\value     \\\r\n            |   |###[ EAP ]### \r\n            |   |  code      = 120\r\n            |   |  id        = 129\r\n            |   |  len       = 103\r\n            |   |  type      = 75\r\n            |###[ Padding ]### \r\n            |     load      = 'O\\xffc\\x11\\xc4\\xc1\\x11\\x1d\\x9f\\xaf\\x98\\x0475\\xbf\\xd6\\xe0T\\xf9T\\x08R,zF\\xe9\\xf2\\x03\\n*\\x0c?\\x81w \\x91\\xdb\\xf0\\x99\\xe4\\xf1\\xbe\\x95Vs\\x8b|\\x8eP\\xd1[\\xba%\\xe2 \\x9dF<\\xbeJ\\x19\\xcd\\xa9\\xac\\x98\\xb6[x\\xeeU#\\x151\\x1c\\x91\\\\=\\xf0.\\xbc\\xbd7, R\\xda\\xffF\\x94C\\x1e\\x91S\\xb7\\x8f{\\x18\\xbd\\xcce\\xe0\\xfb\\xd1J\\xe0E@\\xa4\\xbc\\xa0\\xccD\\xa3_\\xcfO\\x0b\\xc9sb\"W/\\x8b\"\\xdcl\\xf2\\x87\\x89\\x1c\\xaf\\x0b1}f\\xf9\\x8a\\x02\\x97\\xde\\x0c\\xba\\x9aK\\x1f\\xa3s-\\xc7\\x19(wY\\x10q\\x04\\xd8u\\xc6\\x86^]x\\x90\\x88\\xf9}\\xcc\\xd1Y8\\xd6\\xdd=xy(\\xca\\x85t\\x1a\\xe4\\xff\\x104\\x88(\\x13\\x08\\x82\\'\\x8a\\xd3\\xf4\\x7f+N\\x02e\\x91<\\x84@,\\xd4\\xe7P\\xe9$\\x16L~k`\\x82\\xf9\\xcd\\xffp\\xa4\\xf28VCN\\x05\\tG\\x94\\xbc\\x8a\\xe6\\xf6\\xa2 u\\xac\\xc8\\xe6\\xfd\\xb0\\xc1\\x9e\\xa1S\\x15{\\xabW\\xaf\\x89\\x82\\x90\\xceO\\xf7\\xe5\\xb6=\\x00\\xbc\\x95\\x10A\\xf6\\xd1\\xa2\\x88\\xdat\\x0f%W\\xaa\\x84\\x04Z\\x95x]\\xcc\\xd9\\x16\\xfe\\n\\xc6k\\xcby\\xc2\\',\\xf5\\xb3\\xder-\\x01\\x93\\x0f\\xb6\\n\\xd3\\xed\\x838\\x00<\\xc8/\\xc8\\x1a\\xf6;\\xf2W\\xbd\\xf5\\x04\\xd6\\x9d\\xf2\\xef\\xf7fo\\xae3.\\'Q\\xdb\\xabB\\x94\\x93\\x1bD\\x08\\x13\\x9a\\x13\\xd8\\xbd/\\x14\\x93\\x0et\\xea)\\xe9t\\xa4p5@\\x0e\\xabdD\\xa1\\x9a\\xa6}\\xc6 {\\xf0\\xd3\\xaa)\\x96T^\\xa2#\\x05\\xd5s\\x85?>m\\xd5<\\xd6\\x16.Z6\\xa1KD\\xe4\\x96\\xa5\\xbc\\xc3f\\xb4\\xa7\\xa2\\xd6\\x02\\x99\\xf6\\xc3\\xb2\\x0f*\\xc9\\xa7\\xceH\\xa6\\x9b\\t\\x1b\\xe7\\xbax\\x8f\\xf5\\xf1?\\xfcG,y\\xcd\\xb7\\xaa\\x10\\xe2\\xd8\\t\\xca\\xce\\xd4S\\xe6\\xd7\\x0b\\x91\\x9d\\xeb\\x1f\\x9c\\xd6,Q\\xb3z\\x08\\xb9M\\xf8n\\xe8\\x94o\\xcf\\xcb\\xbe\\xed\\x01\\xa8R\\xe4-\\xbc&\\xf5\\xa1\\xef4\\x87\\xd0\\xdf\\xf4f\\xe6\\x00~\\x10\\xab\\xb4\\xec\\x14\\x12h\\xc2\\xe5~zVFg\\xef\\xb8P\\x12n\\x14\\xd1\\x9f\\xa8\\xf3\\t\\xe4\\xc0\\x82\\xd6\\x07AB\\xd5\\xf5\\x18\\x12\\x19\\xd6\\x9eX\\x05A\\x93jo\\x9a\\t:\\xa9g_\\xc2'\r\n            |###[ Radius Attribute ]### \r\n            |  type      = 247\r\n            |  len       = 178\r\n            |  value     = 'qO\\xf0\\xe5\\xfe\\xc8\\xa3_F\\xfcef\\xfb\\xcc\\xe8\\x14\\xca\\x8d~=\\xe4a\\x92\\x84\\x12\\x005\\x89\\xc8a\"/m]7\\xdf\\xf9n\\xf0\\x01\\xd4\\xc9+B\\xdf\\x03z\\'\\xac\\x19CF\\xd6~\\r\\x8eQ\\xe7\\x02\\x07\\xf1\\xf6\\xac/\\x93\\xa8\\xbfZ\\x10\\xc4\\xc8$\\x08\\xe4\\x0bL0\\xdd\\xef\\xc4)\\xb9\\x88\\xa4\\xad\\xbb\\xa9E\\xa2G&}H\\x031*\\x01I\\x02\\x0e\\xfdK\\x05C|\\xc7\\xbb\\x97\\x15F\\xdd\\xe3\\'u5)\\xde)\\xddGN7\\x05\\x98y\\xa7\\x0c\\rY0\\xbc\\xba\\xfcW\\xa57\\x05\\\\\\xda\\xd4P\\x04\\xd0;t\\x92\\xde\\xbf\\x8c\\xf5\\xb3\\xe6m\\xab\\x1f7\\xbf\\xb6w\\x04\\x99\\x7f\\xb9\\xb0j\\xc1\\x14ZT\\xf1x\\xd9\\x15\\x87M\\xcd'\r\n            |###[ PMIP6-Home-LMA-IPv4-Address ]### \r\n            |  type      = PMIP6-Home-LMA-IPv4-Address\r\n            |  len       = 28\r\n            |  value     = 120.92.212.44\r\n            |###[ Radius Attribute ]### \r\n            |  type      = PMIP6-Visited-IPv4-HoA\r\n            |  len       = 59\r\n            |  value     = 'k\\xb8\\xc0#w\\xa6\\xeft\\xf6\\xcb\\xde\\xfb<_r \\xdc\\xce\\x90\\xaa\\xe5\\x16\\x88\\x1e\\xe1D\\xe4\\xe6\\xce\\x16#\\x9aPG\\xdc\\x0e?{N\\xab\\xb1\\xa5\\x81\\x13\\xf6\\xd8\\xf7\\x13\\xf2\\xcc5.,\\x1eq\\x16\\xe3'\r\n            |###[ Raw ]### \r\n            |  load      = '\\x0c\\x8c\\x1a=\\x07'\r\n\r\n```\r\n#### Expected result\r\n![wireshark](https://user-images.githubusercontent.com/10732757/94190589-96706600-feac-11ea-90c7-dc6f20dd13a4.png)\r\n\r\n\r\n#### Related resources\r\ntest.py.txt: Simple testscript with binary repr. of a packet that triggers the error.\r\ntest.txt: pcap file with the packet\r\n\r\n[test.py.txt](https://github.com/secdev/scapy/files/5278694/test.py.txt)\r\n[test.txt](https://github.com/secdev/scapy/files/5278690/test.txt)\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2832/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2832/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2814", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2814/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2814/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2814/events", "html_url": "https://github.com/secdev/scapy/issues/2814", "id": 702783104, "node_id": "MDU6SXNzdWU3MDI3ODMxMDQ=", "number": 2814, "title": "libpcap filters doesn't work on pypy", "user": {"login": "gkonstantyno", "id": 11300362, "node_id": "MDQ6VXNlcjExMzAwMzYy", "avatar_url": "https://avatars.githubusercontent.com/u/11300362?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gkonstantyno", "html_url": "https://github.com/gkonstantyno", "followers_url": "https://api.github.com/users/gkonstantyno/followers", "following_url": "https://api.github.com/users/gkonstantyno/following{/other_user}", "gists_url": "https://api.github.com/users/gkonstantyno/gists{/gist_id}", "starred_url": "https://api.github.com/users/gkonstantyno/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gkonstantyno/subscriptions", "organizations_url": "https://api.github.com/users/gkonstantyno/orgs", "repos_url": "https://api.github.com/users/gkonstantyno/repos", "events_url": "https://api.github.com/users/gkonstantyno/events{/privacy}", "received_events_url": "https://api.github.com/users/gkonstantyno/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 971730999, "node_id": "MDU6TGFiZWw5NzE3MzA5OTk=", "url": "https://api.github.com/repos/secdev/scapy/labels/dependency-related", "name": "dependency-related", "color": "713be5", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-09-16T13:49:08Z", "updated_at": "2020-09-16T16:09:40Z", "closed_at": "2020-09-16T16:09:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "Socket initialization with filter raises\r\nTypeError: unsupported operand type(s) for +: 'str' and 'StructureMeta'\r\n\r\nThis stopped working with version 2.4.4.\r\nCompiling filters was moved from tcpdump to libpcap\r\n\r\n#### Brief description\r\n\r\n```\r\n>>> s = conf.L2socket(filter=\"udp\")\r\nTraceback (most recent call last):\r\n  File \"<console>\", line 1, in <module>\r\n  File \"/opt/pypy/site-packages/scapy/arch/linux.py\", line 407, in __init__\r\n    attach_filter(self.ins, filter, iface)\r\n  File \"/opt/pypy/site-packages/scapy/arch/linux.py\", line 143, in attach_filter\r\n    sock.setsockopt(socket.SOL_SOCKET, SO_ATTACH_FILTER, bp)\r\n  File \"/opt/pypy/lib_pypy/_ctypes/structure.py\", line 309, in __buffer__\r\n    fmt = get_format_str(self)\r\n  File \"/opt/pypy/lib_pypy/_ctypes/array.py\", line 309, in get_format_str\r\n    ch = get_format_str(obj)[1:]\r\n  File \"/opt/pypy/lib_pypy/_ctypes/array.py\", line 322, in get_format_str\r\n    return byteorder[sys.byteorder] + ch\r\nTypeError: unsupported operand type(s) for +: 'str' and 'StructureMeta'\r\n```\r\n\r\n#### Environment\r\n\r\n-   Scapy version: 2.4.4\r\n-   Python version: PyPy 7.3.1\r\n-   Operating System: Debian buster\r\n\r\n\r\n#### How to reproduce\r\n\r\nThis can be reproduced with docker pypy image\r\n\r\ndocker run --rm -it pypy:3 /bin/bash\r\n> apt update & apt install libpcap-dev\r\n> pip install scapy\r\n> scapy\r\n>>> s = conf.L2socket(filter=\"udp\")\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2814/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2814/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2810", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2810/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2810/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2810/events", "html_url": "https://github.com/secdev/scapy/pull/2810", "id": 699819606, "node_id": "MDExOlB1bGxSZXF1ZXN0NDg1NTI0MDE0", "number": 2810, "title": "Fix UDPServer pipe", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 514033136, "node_id": "MDU6TGFiZWw1MTQwMzMxMzY=", "url": "https://api.github.com/repos/secdev/scapy/labels/tests", "name": "tests", "color": "0e8a16", "default": false, "description": null}, {"id": 1265179855, "node_id": "MDU6TGFiZWwxMjY1MTc5ODU1", "url": "https://api.github.com/repos/secdev/scapy/labels/platform-specific", "name": "platform-specific", "color": "14acba", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-09-11T22:36:14Z", "updated_at": "2020-09-12T11:19:52Z", "closed_at": "2020-09-12T10:10:50Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2810", "html_url": "https://github.com/secdev/scapy/pull/2810", "diff_url": "https://github.com/secdev/scapy/pull/2810.diff", "patch_url": "https://github.com/secdev/scapy/pull/2810.patch", "merged_at": "2020-09-12T10:10:50Z"}, "body": "- `sendto` connects to the addr/port (which was here already done in `connect`), and shouldn't be used here\r\n\r\nplease watch out all unit tests before merging", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2810/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2810/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2801", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2801/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2801/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2801/events", "html_url": "https://github.com/secdev/scapy/issues/2801", "id": 695249895, "node_id": "MDU6SXNzdWU2OTUyNDk4OTU=", "number": 2801, "title": "MultipleTypeField: wrong recognition of the default value", "user": {"login": "audeoudh", "id": 4673728, "node_id": "MDQ6VXNlcjQ2NzM3Mjg=", "avatar_url": "https://avatars.githubusercontent.com/u/4673728?v=4", "gravatar_id": "", "url": "https://api.github.com/users/audeoudh", "html_url": "https://github.com/audeoudh", "followers_url": "https://api.github.com/users/audeoudh/followers", "following_url": "https://api.github.com/users/audeoudh/following{/other_user}", "gists_url": "https://api.github.com/users/audeoudh/gists{/gist_id}", "starred_url": "https://api.github.com/users/audeoudh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/audeoudh/subscriptions", "organizations_url": "https://api.github.com/users/audeoudh/orgs", "repos_url": "https://api.github.com/users/audeoudh/repos", "events_url": "https://api.github.com/users/audeoudh/events{/privacy}", "received_events_url": "https://api.github.com/users/audeoudh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-09-07T16:13:26Z", "updated_at": "2020-09-16T20:03:17Z", "closed_at": "2020-09-16T20:03:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nWhen using a MultipleTypeField, initializing the field with the default type's default value changes the value to the current type's default value.\r\n\r\n\r\n#### Environment\r\n\r\n-   On branch master, on commit `d6ca9d7b99de77`.\r\n-   Python version: `3.8.5`\r\n-   Operating System: `Archlinux`\r\n\r\n\r\n#### How to reproduce\r\n\r\nTwo fields in my layer, the first one selecting the type of the second one.  Note the different default values of the MultipleTypeField.\r\n\r\n    from scapy.fields import ByteField, MultipleTypeField, ShortField, LongField\r\n    from scapy.packet import Packet\r\n\r\n    class T(Packet):\r\n        name = \"Test\"\r\n        fields_desc = [\r\n            ByteField(\"type\", 0),\r\n            MultipleTypeField(\r\n                [\r\n                    (ShortField(\"value\", 7), lambda pkt: pkt.type == 1),\r\n                    (LongField(\"value\", 9), lambda pkt: pkt.type == 2)\r\n                ],\r\n                ByteField(\"value\", 5)\r\n            )\r\n        ]\r\n\r\nThen I initialize a packet.\r\n\r\n    T(type=2, value=5)\r\n\r\n`value=5` is the default value of the default type (`ByteField`); but as with `type=2` (`LongField` type selected), this is no more a special value, but `9` is the default value.\r\n\r\n#### Actual result\r\n\r\n    <T  type=2 value=9 |>\r\n\r\nThe current type's default value is used.\r\n\r\n#### Expected result\r\n\r\n    <T  type=2 value=5 |>\r\n\r\nThe raw value `5` is expected.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2801/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2801/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2798", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2798/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2798/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2798/events", "html_url": "https://github.com/secdev/scapy/pull/2798", "id": 694127389, "node_id": "MDExOlB1bGxSZXF1ZXN0NDgwNTUxMzQx", "number": 2798, "title": "Fix DHCP typo", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-09-05T17:07:59Z", "updated_at": "2020-09-05T18:15:20Z", "closed_at": "2020-09-05T18:00:39Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2798", "html_url": "https://github.com/secdev/scapy/pull/2798", "diff_url": "https://github.com/secdev/scapy/pull/2798.diff", "patch_url": "https://github.com/secdev/scapy/pull/2798.patch", "merged_at": "2020-09-05T18:00:39Z"}, "body": "fixes https://github.com/secdev/scapy/issues/2786", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2798/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2798/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2792", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2792/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2792/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2792/events", "html_url": "https://github.com/secdev/scapy/pull/2792", "id": 690371707, "node_id": "MDExOlB1bGxSZXF1ZXN0NDc3MjcwNzYy", "number": 2792, "title": "Support TLS 1.3 server downgrade", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1317786288, "node_id": "MDU6TGFiZWwxMzE3Nzg2Mjg4", "url": "https://api.github.com/repos/secdev/scapy/labels/tls", "name": "tls", "color": "56088e", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-09-01T18:56:34Z", "updated_at": "2020-09-10T13:03:15Z", "closed_at": "2020-09-10T12:42:34Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2792", "html_url": "https://github.com/secdev/scapy/pull/2792", "diff_url": "https://github.com/secdev/scapy/pull/2792.diff", "patch_url": "https://github.com/secdev/scapy/pull/2792.patch", "merged_at": "2020-09-10T12:42:33Z"}, "body": "- fix #2778", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2792/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2792/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2789", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2789/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2789/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2789/events", "html_url": "https://github.com/secdev/scapy/pull/2789", "id": 689919211, "node_id": "MDExOlB1bGxSZXF1ZXN0NDc2ODk3Nzc1", "number": 2789, "title": "Stop processing a pcapng file when a block is malformed", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-09-01T08:01:43Z", "updated_at": "2020-09-02T07:15:45Z", "closed_at": "2020-09-02T07:15:45Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2789", "html_url": "https://github.com/secdev/scapy/pull/2789", "diff_url": "https://github.com/secdev/scapy/pull/2789.diff", "patch_url": "https://github.com/secdev/scapy/pull/2789.patch", "merged_at": "2020-09-02T07:15:44Z"}, "body": "This PR fixes #2787 ", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2789/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2789/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2786", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2786/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2786/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2786/events", "html_url": "https://github.com/secdev/scapy/issues/2786", "id": 687435020, "node_id": "MDU6SXNzdWU2ODc0MzUwMjA=", "number": 2786, "title": "Bug: layers/dhcp.py  DHCPOptions[33] and DHCPOptions[46] duplicate symbol", "user": {"login": "anr-private", "id": 4354456, "node_id": "MDQ6VXNlcjQzNTQ0NTY=", "avatar_url": "https://avatars.githubusercontent.com/u/4354456?v=4", "gravatar_id": "", "url": "https://api.github.com/users/anr-private", "html_url": "https://github.com/anr-private", "followers_url": "https://api.github.com/users/anr-private/followers", "following_url": "https://api.github.com/users/anr-private/following{/other_user}", "gists_url": "https://api.github.com/users/anr-private/gists{/gist_id}", "starred_url": "https://api.github.com/users/anr-private/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/anr-private/subscriptions", "organizations_url": "https://api.github.com/users/anr-private/orgs", "repos_url": "https://api.github.com/users/anr-private/repos", "events_url": "https://api.github.com/users/anr-private/events{/privacy}", "received_events_url": "https://api.github.com/users/anr-private/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-08-27T18:00:37Z", "updated_at": "2020-09-05T18:00:39Z", "closed_at": "2020-09-05T18:00:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "DHCPOptions[33] and [46] are both called \"static-routes\". I believe [33] is correct but [46] is incorrect. Per RFC-2132 sect 8.7, [46] is \"NetBIOS over TCP/IP Node Type Option\". The error also causes DHCPRevOptions issue (obviously, duplicate symbol/string).", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2786/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2786/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2778", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2778/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2778/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2778/events", "html_url": "https://github.com/secdev/scapy/issues/2778", "id": 684470777, "node_id": "MDU6SXNzdWU2ODQ0NzA3Nzc=", "number": 2778, "title": "Broken TLS session while server choose TLSv1.2 instead of TLSv1.3", "user": {"login": "strayge", "id": 2664578, "node_id": "MDQ6VXNlcjI2NjQ1Nzg=", "avatar_url": "https://avatars.githubusercontent.com/u/2664578?v=4", "gravatar_id": "", "url": "https://api.github.com/users/strayge", "html_url": "https://github.com/strayge", "followers_url": "https://api.github.com/users/strayge/followers", "following_url": "https://api.github.com/users/strayge/following{/other_user}", "gists_url": "https://api.github.com/users/strayge/gists{/gist_id}", "starred_url": "https://api.github.com/users/strayge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/strayge/subscriptions", "organizations_url": "https://api.github.com/users/strayge/orgs", "repos_url": "https://api.github.com/users/strayge/repos", "events_url": "https://api.github.com/users/strayge/events{/privacy}", "received_events_url": "https://api.github.com/users/strayge/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1317786288, "node_id": "MDU6TGFiZWwxMzE3Nzg2Mjg4", "url": "https://api.github.com/repos/secdev/scapy/labels/tls", "name": "tls", "color": "56088e", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-08-24T08:23:55Z", "updated_at": "2020-09-10T12:42:33Z", "closed_at": "2020-09-10T12:42:33Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "<!--\r\nThings to consider\r\n\r\n1.  Please check that you are using the latest scapy version, e.g. installed via:\r\n\r\n    `pip install --upgrade git+git://github.com/secdev/scapy`\r\n\r\n2.  If you are here to ask a question - please check previous issues and online resources, and consider using gitter instead: <https://gitter.im/secdev/scapy>\r\n\r\n3.  Please understand that **this is not a forum** but an issue tracker. The following article explains why you should limit questions asked on Github issues: <https://medium.com/@methane/why-you-must-not-ask-questions-on-github-issues-51d741d83fde>\r\n-->\r\n\r\n#### Brief description\r\n\r\n<!-- describe the main issue in one sentence -->\r\n<!-- if possible, describe what components / protocols could be affected by the issue (e.g. wrpcap() + IPv6, it is likely this also affects XXX) -->\r\nBroken TLS session while parsing dump from server with disabled TLSv1.3.\r\n\r\nClient supports both TLS 1.2 and 1.3:\r\n```\r\n   |   |###[ TLS Extension - Supported Versions (for ClientHello) ]###\r\n   |   |  type      = supported_versions\r\n   |   |  len       = 5\r\n   |   |  versionslen= 4\r\n   |   |  versions  = [TLS 1.3, TLS 1.2]\r\n```\r\nBut server works only with TLS 1.2:\r\n```\r\n   |###[ TLS Handshake - Server Hello ]###\r\n   |  msgtype   = server_hello\r\n   |  msglen    = 81\r\n   |  version   = TLS 1.2\r\n```\r\nLooks like TLSSession saves TLSv1.3 from `ClientHello` and do not downgraded with `ServerHello`.\r\n\r\nIf restrict client to TLSv1.2 (curl `--tls-max 1.2` option) it start works as expected.\r\n\r\n#### Environment\r\n\r\n-   Scapy version: `2.4.4rc2.dev30`\r\n-   Python version: `3.7.5`\r\n-   Operating System: `Ubuntu 18.04.3 LTS`\r\n\r\n<!-- if needed - further information to get a picture of your setup (e.g. a sketch of your network setup) -->\r\n\r\n#### How to reproduce\r\n[scapy_client_tls13_server_tls12.pcap](https://drive.google.com/file/d/1yy0BRSwQKVLSlqnYv9hY0W0GbgoYFCED/view)\r\n```python3\r\nfrom scapy.all import *\r\nload_layer('tls')\r\npcap = rdpcap('scapy_client_tls13_server_tls12.pcap')\r\nr1 = TLS(pcap[0].load)\r\nr2 = TLS(pcap[1].load, tls_session=r1.tls_session.mirror())\r\n```\r\n<!-- step-by-step explanation or a short script, may reference section 'Related resources' -->\r\n\r\n#### Actual result\r\n\r\n```python3\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-5-4c9f13dcdcd8> in <module>\r\n----> 1 r2 = TLS(pcap[1].load, tls_session=r1.tls_session.mirror())\r\n\r\n~/scapy_venv/lib/python3.7/site-packages/scapy/base_classes.py in __call__(cls, *args, **kargs)\r\n    264                 cls = config.conf.raw_layer\r\n    265         i = cls.__new__(cls, cls.__name__, cls.__bases__, cls.__dict__)\r\n--> 266         i.__init__(*args, **kargs)\r\n    267         return i\r\n    268\r\n\r\n~/scapy_venv/lib/python3.7/site-packages/scapy/layers/tls/record.py in __init__(self, *args, **kargs)\r\n    302     def __init__(self, *args, **kargs):\r\n    303         self.deciphered_len = kargs.get(\"deciphered_len\", None)\r\n--> 304         super(TLS, self).__init__(*args, **kargs)\r\n    305\r\n    306     @classmethod\r\n\r\n~/scapy_venv/lib/python3.7/site-packages/scapy/layers/tls/session.py in __init__(self, _pkt, post_transform, _internal, _underlayer, tls_session, **fields)\r\n    902         Packet.__init__(self, _pkt=_pkt, post_transform=post_transform,\r\n    903                         _internal=_internal, _underlayer=_underlayer,\r\n--> 904                         **fields)\r\n    905\r\n    906     def __getattr__(self, attr):\r\n\r\n~/scapy_venv/lib/python3.7/site-packages/scapy/packet.py in __init__(self, _pkt, post_transform, _internal, _underlayer, **fields)\r\n    156         self.sniffed_on = None\r\n    157         if _pkt:\r\n--> 158             self.dissect(_pkt)\r\n    159             if not _internal:\r\n    160                 self.dissection_done(self)\r\n\r\n~/scapy_venv/lib/python3.7/site-packages/scapy/packet.py in dissect(self, s)\r\n    873         s = self.pre_dissect(s)\r\n    874\r\n--> 875         s = self.do_dissect(s)\r\n    876\r\n    877         s = self.post_dissect(s)\r\n\r\n~/scapy_venv/lib/python3.7/site-packages/scapy/packet.py in do_dissect(self, s)\r\n    837             if not s:\r\n    838                 break\r\n--> 839             s, fval = f.getfield(self, s)\r\n    840             # We need to track fields with mutable values to discard\r\n    841             # .raw_packet_cache when needed.\r\n\r\n~/scapy_venv/lib/python3.7/site-packages/scapy/layers/tls/record.py in getfield(self, pkt, s)\r\n    166                 if isinstance(p, _GenericTLSSessionInheritance):\r\n    167                     if not p.tls_session.frozen:\r\n--> 168                         p.post_dissection_tls_session_update(raw_msg)\r\n    169\r\n    170                 lst.append(p)\r\n\r\n~/scapy_venv/lib/python3.7/site-packages/scapy/layers/tls/session.py in post_dissection_tls_session_update(self, msg_str)\r\n    924\r\n    925     def post_dissection_tls_session_update(self, msg_str):\r\n--> 926         self.tls_session_update(msg_str)\r\n    927\r\n    928     def copy(self):\r\n\r\n~/scapy_venv/lib/python3.7/site-packages/scapy/layers/tls/handshake.py in tls_session_update(self, msg_str)\r\n    648             s.prcs = readConnState(ciphersuite=cs_cls,\r\n    649                                    connection_end=connection_end,\r\n--> 650                                    tls_version=s.tls_version)\r\n    651             if not s.middlebox_compatibility:\r\n    652                 s.triggered_prcs_commit = True\r\n\r\n~/scapy_venv/lib/python3.7/site-packages/scapy/layers/tls/session.py in __init__(self, **kargs)\r\n    279 class readConnState(connState):\r\n    280     def __init__(self, **kargs):\r\n--> 281         connState.__init__(self, read_or_write=\"read\", **kargs)\r\n    282\r\n    283\r\n\r\n~/scapy_venv/lib/python3.7/site-packages/scapy/layers/tls/session.py in __init__(self, connection_end, read_or_write, seq_num, compression_alg, ciphersuite, tls_version)\r\n     89             from scapy.layers.tls.crypto.suites import TLS_NULL_WITH_NULL_NULL\r\n     90             ciphersuite = TLS_NULL_WITH_NULL_NULL\r\n---> 91         self.ciphersuite = ciphersuite(tls_version=tls_version)\r\n     92\r\n     93         if not self.ciphersuite.usable:\r\n\r\n~/scapy_venv/lib/python3.7/site-packages/scapy/layers/tls/crypto/suites.py in __init__(self, tls_version)\r\n    140         \"\"\"\r\n    141         super(_GenericCipherSuite, self).__init__()\r\n--> 142         if tls_version <= 0x301:\r\n    143             self.key_block_len = self._key_block_len_v1_0\r\n    144\r\n\r\nTypeError: '<=' not supported between instances of 'NoneType' and 'int'\r\n```\r\n<!-- dump results that outline the issue, please format your code -->\r\n\r\n#### Expected result\r\n\r\nCorrect work of TLSSession (saves TLSv1.2 as `tls_version` on parsing `ServerHello`) in that case.\r\n\r\n<!-- describe the expected result and outline the difference to the actual one, could also be a screen shot (e.g. wireshark) -->\r\n\r\n#### Related resources\r\n\r\n<!-- traces / sample pcaps (stripped to the relevant frames), related standards, RFCs or other resources -->\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2778/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2778/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2771", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2771/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2771/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2771/events", "html_url": "https://github.com/secdev/scapy/pull/2771", "id": 680331439, "node_id": "MDExOlB1bGxSZXF1ZXN0NDY4OTEwNDYw", "number": 2771, "title": "Fix MCS alignment", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-08-17T15:40:39Z", "updated_at": "2020-10-09T13:58:26Z", "closed_at": "2020-08-17T16:33:05Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2771", "html_url": "https://github.com/secdev/scapy/pull/2771", "diff_url": "https://github.com/secdev/scapy/pull/2771.diff", "patch_url": "https://github.com/secdev/scapy/pull/2771.patch", "merged_at": "2020-08-17T16:33:04Z"}, "body": "- fix https://github.com/secdev/scapy/issues/2758\r\n\r\nI dropped `_RadiotapReversePadField` for a simpler `ReversePadField` because it was ugly and not that useful. We now follow precisely the \"Required Alignment\" rules specified on each Radiotap field's page.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2771/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2771/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2767", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2767/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2767/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2767/events", "html_url": "https://github.com/secdev/scapy/pull/2767", "id": 679812467, "node_id": "MDExOlB1bGxSZXF1ZXN0NDY4NDg2MzY4", "number": 2767, "title": "Minor TLS fixes", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1317786288, "node_id": "MDU6TGFiZWwxMzE3Nzg2Mjg4", "url": "https://api.github.com/repos/secdev/scapy/labels/tls", "name": "tls", "color": "56088e", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-08-16T19:34:29Z", "updated_at": "2020-08-18T14:22:45Z", "closed_at": "2020-08-18T14:19:18Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2767", "html_url": "https://github.com/secdev/scapy/pull/2767", "diff_url": "https://github.com/secdev/scapy/pull/2767.diff", "patch_url": "https://github.com/secdev/scapy/pull/2767.patch", "merged_at": "2020-08-18T14:19:17Z"}, "body": "- fix https://github.com/secdev/scapy/issues/2763\r\n- fix https://github.com/secdev/scapy/pull/2527\r\n- minor improvements (TCP TLS session)\r\n- several doc improvements", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2767/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2767/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2763", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2763/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2763/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2763/events", "html_url": "https://github.com/secdev/scapy/issues/2763", "id": 679499037, "node_id": "MDU6SXNzdWU2Nzk0OTkwMzc=", "number": 2763, "title": "Error when getting raw bytes from parsed TLS layer", "user": {"login": "knwng", "id": 26247277, "node_id": "MDQ6VXNlcjI2MjQ3Mjc3", "avatar_url": "https://avatars.githubusercontent.com/u/26247277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/knwng", "html_url": "https://github.com/knwng", "followers_url": "https://api.github.com/users/knwng/followers", "following_url": "https://api.github.com/users/knwng/following{/other_user}", "gists_url": "https://api.github.com/users/knwng/gists{/gist_id}", "starred_url": "https://api.github.com/users/knwng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/knwng/subscriptions", "organizations_url": "https://api.github.com/users/knwng/orgs", "repos_url": "https://api.github.com/users/knwng/repos", "events_url": "https://api.github.com/users/knwng/events{/privacy}", "received_events_url": "https://api.github.com/users/knwng/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1317786288, "node_id": "MDU6TGFiZWwxMzE3Nzg2Mjg4", "url": "https://api.github.com/repos/secdev/scapy/labels/tls", "name": "tls", "color": "56088e", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-08-15T04:41:29Z", "updated_at": "2020-08-18T14:19:17Z", "closed_at": "2020-08-18T14:19:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nHi guys, I'm trying to read and parse a pcap file, find tls record and dump them as raw bytes. But I got exception when dealing with a TLS Handshake - Server Key Exchange with None in params and sig fields.\r\n\r\n#### Environment\r\n\r\n-   Scapy version: 2.4.4rc2.dev20\r\n-   Python version: 3.7.4\r\n-   Operating System: 7.7.1908\r\n\r\n#### How to reproduce\r\n\r\n<!-- step-by-step explanation or a short script, may reference section 'Related resources' -->\r\nYou can get the pcap file from here [192.168.165.217_49183_156.38.206.18_443_1593515552.pcap](https://drive.google.com/file/d/1iyIHMY5tWIuNQjggQMawIliQndh9ojB8/view?usp=sharing)\r\n\r\nYou can run the following file by `python poc.py` to reproduce the bug:\r\n\r\npoc.py:\r\n```\r\nfrom scapy.config import conf\r\nfrom scapy.all import load_layer\r\nfrom scapy.sendrecv import sniff\r\nfrom scapy.sessions import TCPSession\r\nfrom scapy.layers.tls.record import TLS\r\nfrom scapy.layers.tls.record_sslv2 import SSLv2\r\n\r\nload_layer('tls')\r\nconf.tls_session_enable = True\r\n\r\ndef extract_tls_payloads(fn, length):\r\n    tls_pkts = sniff(offline=fn, session=TCPSession, lfilter=lambda x: TLS in x or SSLv2 in x)\r\n    total_length = 0\r\n    payloads = []\r\n    for i, p in enumerate(tls_pkts):\r\n        if p.haslayer(TLS):\r\n            try:\r\n                payload = bytes(p[TLS])\r\n            except BaseException as e:\r\n                print(f'get tls failed {e}')\r\n                p.show()\r\n                raise\r\n        elif p.haslayer(SSLv2):\r\n            try:\r\n                payload = bytes(p[SSLv2])\r\n            except BaseException as e:\r\n                print(f'get ssl failed {e}')\r\n                p.show()\r\n                raise\r\n        else:\r\n            continue\r\n        payload = [int(x) for x in payload]\r\n        valid_length = min(len(payload), length - total_length)\r\n        payload = payload[:valid_length]\r\n        payloads.append(payload)\r\n        total_length += len(payload)\r\n        if total_length >= length:\r\n            break\r\n    return payloads\r\n\r\ndef test_failed_fn():\r\n    data_root = '/data1/wangqian/eta_1_pkt/train/white/'\r\n    fn = '192.168.165.217_49183_156.38.206.18_443_1593515552.pcap'\r\n    extract_tls_payloads(os.path.join(data_root, fn), 900)\r\n\r\nif __name__ == '__main__':\r\n    test_failed_fn()\r\n```\r\n\r\n#### Actual result\r\n\r\nThe poc will raise an exception as following:\r\n```\r\nTraceback (most recent call last):\r\n  File \"utils/poc.py\", line 51, in <module>\r\n    test_failed_fn()\r\n  File \"utils/poc.py\", line 47, in test_failed_fn\r\n    extract_tls_payloads(os.path.join(data_root, fn), 900)\r\n  File \"utils/poc.py\", line 19, in extract_tls_payloads\r\n    payload = bytes(p[TLS])\r\n  File \"/data1/wangqian/venv_py3/lib/python3.7/site-packages/scapy/layers/tls/session.py\", line 966, in __bytes__\r\n    built_packet = super(_GenericTLSSessionInheritance, self).__bytes__()\r\n  File \"/data1/wangqian/venv_py3/lib/python3.7/site-packages/scapy/packet.py\", line 492, in __bytes__\r\n    return self.build()\r\n  File \"/data1/wangqian/venv_py3/lib/python3.7/site-packages/scapy/packet.py\", line 612, in build\r\n    p = self.do_build()\r\n  File \"/data1/wangqian/venv_py3/lib/python3.7/site-packages/scapy/packet.py\", line 594, in do_build\r\n    pkt = self.self_build()\r\n  File \"/data1/wangqian/venv_py3/lib/python3.7/site-packages/scapy/packet.py\", line 575, in self_build\r\n    p = f.addfield(self, p, val)\r\n  File \"/data1/wangqian/venv_py3/lib/python3.7/site-packages/scapy/layers/tls/record.py\", line 207, in addfield\r\n    res += self.i2m(pkt, p)\r\n  File \"/data1/wangqian/venv_py3/lib/python3.7/site-packages/scapy/layers/tls/record.py\", line 194, in i2m\r\n    cur = raw(p)\r\n  File \"/data1/wangqian/venv_py3/lib/python3.7/site-packages/scapy/compat.py\", line 53, in raw\r\n    return bytes(x)\r\n  File \"/data1/wangqian/venv_py3/lib/python3.7/site-packages/scapy/layers/tls/session.py\", line 966, in __bytes__\r\n    built_packet = super(_GenericTLSSessionInheritance, self).__bytes__()\r\n  File \"/data1/wangqian/venv_py3/lib/python3.7/site-packages/scapy/packet.py\", line 492, in __bytes__\r\n    return self.build()\r\n  File \"/data1/wangqian/venv_py3/lib/python3.7/site-packages/scapy/layers/tls/handshake.py\", line 1028, in build\r\n    m = s.client_random + s.server_random + raw(p)\r\n  File \"/data1/wangqian/venv_py3/lib/python3.7/site-packages/scapy/compat.py\", line 53, in raw\r\n    return bytes(x)\r\nTypeError: 'NoneType' object cannot be interpreted as an integer\r\n\r\n```\r\n\r\nand it'll also show the packet detail:\r\n\r\n```\r\n###[ Ethernet ]###\r\n  dst       = 52:55:10:00:02:02\r\n  src       = 52:54:00:12:34:56\r\n  type      = IPv4\r\n###[ IP ]###\r\n     version   = 4\r\n     ihl       = 5\r\n     tos       = 0x0\r\n     len       = 1480\r\n     id        = 3544\r\n     flags     =\r\n     frag      = 0\r\n     ttl       = 64\r\n     proto     = tcp\r\n     chksum    = 0x969d\r\n     src       = 156.38.206.18\r\n     dst       = 192.168.165.217\r\n     \\options   \\\r\n###[ TCP ]###\r\n        sport     = https\r\n        dport     = 49183\r\n        seq       = 7808002\r\n        ack       = 62833955\r\n        dataofs   = 5\r\n        reserved  = 0\r\n        flags     = A\r\n        window    = 9000\r\n        chksum    = 0xb9e\r\n        urgptr    = 0\r\n        options   = []\r\n###[ TLS ]###\r\n           type      = handshake\r\n           version   = TLS 1.2\r\n           len       = 3636    [deciphered_len= 1435]\r\n           iv        = b''\r\n           \\msg       \\\r\n            |###[ TLS Handshake - Server Hello ]###\r\n            |  msgtype   = server_hello\r\n            |  msglen    = 77\r\n            |  version   = TLS 1.2\r\n            |  gmt_unix_time= Tue, 30 Jun 2020 03:46:06 +0000 (1593488766)\r\n            |  random_bytes= 88dfdc237d27a0ffa2e2b5ec0e93a8e0de015b135b4615312078c6cc\r\n            |  sidlen    = 32\r\n            |  sid       = '`)\\x00\\x00\\x8aZ\\x90l\\xda\\x0b\\xe1\\xec[i\\x13\\xa7\\x8e\\xb9a\\x98\"\\x8a7L\\x9d\\x90\\xe0\\x01\\x06c$9'\r\n            |  cipher    = TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\r\n            |  comp      = null\r\n            |  extlen    = 5\r\n            |  \\ext       \\\r\n            |   |###[ TLS Extension - Renegotiation Indication ]###\r\n            |   |  type      = renegotiation_info\r\n            |   |  len       = 1\r\n            |   |  reneg_conn_len= 0\r\n            |   |  renegotiated_connection= ''\r\n            |###[ TLS Handshake - Server Key Exchange ]###\r\n            |  msgtype   = server_key_exchange\r\n            |  msglen    = 9306124\r\n            |  params    = (None, <Raw  load='\\x8b\\x00\\x06n0\\x82\\x06j0\\x82\\x05R\\xa0\\x03\\x02\\x01\\x02\\x02\\x10EY\\xe8\\x1c\\x1e\\x9a\\xe0?X\\xaa\\xc3\\xbc\\xcd`jh0\\r\\x06\\t*\\x86H\\x86\\xf7\\r\\x01\\x01\\x0b\\x05\\x000\\x81\\x8f1\\x0b0\\t\\x06\\x03U\\x04\\x06\\x13\\x02GB1\\x1b0\\x19\\x06\\x03U\\x04\\x08\\x13\\x\r\n12Greater Manchester1\\x100\\x0e\\x06\\x03U\\x04\\x07\\x13\\x07Salford1\\x180\\x16\\x06\\x03U\\x04\\n\\x13\\x0fSectigo Limited1705\\x06\\x03U\\x04\\x03\\x13.Sectigo RSA Domain Validation Secure Server CA0\\x1e\\x17\\r190309000000Z\\x17\\r210308235959Z0W1!0\\x1f\\x06\\x03U\\x04\\x0b\\x13\\x18Domain Contro\r\nl Validated1\\x1d0\\x1b\\x06\\x03U\\x04\\x0b\\x13\\x14PositiveSSL Wildcard1\\x130\\x11\\x06\\x03U\\x04\\x03\\x0c\\n*.mql5.net0\\x82\\x01\"0\\r\\x06\\t*\\x86H\\x86\\xf7\\r\\x01\\x01\\x01\\x05\\x00\\x03\\x82\\x01\\x0f\\x000\\x82\\x01\\n\\x02\\x82\\x01\\x01\\x00\\xcb\\xbcn=\\xbaGd\\xe1XB\\x07\\xc9\\xb1\\xc8/\\x86\\xaa4Z\\xbdNk\\x\r\nfb\\xffR\\x8f\\xe4\\x1c^\\x91m8\\xb9^\\x97\\xa5\\xd3N\\xfb\\x80\\x92\\x8ap\\xda\\x15\\x9f\\xee\\xe7\\xb3\\xc8?\\xb0>~\\xaa\\x07\\x91\\xb1\\x99q\\xe2\\xe5\\xc8\\x9b\\x1d5\\xa0\\x96,\\x98\\xdaW\\x93\\x95\\x8e%\\xe8\\xd4L\\xeb\\xcbSg\\x15\"\\xba\\xb7\\xc7\\x1f\\xe9\\xd6\\x1a\\xe6E\\x1d\\xc8\\x1e%\\xd36\\xe0/r\\xd1\\xce1C\\xce\\x91&\\xa\r\n1\\x08*R\\xbf\\x8cu\\xb0\\xda\\x0e\\x1e2\\xd66\\x1df&3\\x9b\\x03\\x0b\\xcam:\\xf7\\x12\\xd9ud(\\xae\\xdc\\xbci\\x85\\xbd\\xcf\\xeb{\\x15:\\xbd\\x0e\\x11\\x1bi\\xd8\\xff]y~E\\x15\\x95\\xee\\xe9\\xea\\xc6Cr</\\x0b\\xe8\\xc2\\x9d\\xe3\\x83\\x07R\\xeb1\\xf0\\x93<|.\\xf8G\\xab\\xa8=\\xac\\x16\\x1d\\xf9\\x93%\\x1b;)\\xb2FN\\x15\\xc4\\x\r\n17\\xa9}\\xb0\\x80\\xba\\xfb\\xc8\\x15-G\\x9e\\x05\\xe9\\xf6\\xc76\\xc1\\x9af\\xa3\\x91\\n\\xa4\\x80,\\x11=\\x87\\xec\\xf9\\xd6iJ\\xd0\\xbe\\xc3K\\x99J\\xe7&\\xc4\\x86\\x84:W\\xc4/\\x7f\\x02\\x03\\x01\\x00\\x01\\xa3\\x82\\x02\\xf70\\x82\\x02\\xf30\\x1f\\x06\\x03U\\x1d#\\x04\\x180\\x16\\x80\\x14\\x8d\\x8c^\\xc4T\\xad\\x8a\\xe1w\\xe9\\\r\nx9b\\xf9\\x9b\\x05\\xe1\\xb8\\x01\\x8da\\xe10\\x1d\\x06\\x03U\\x1d\\x0e\\x04\\x16\\x04\\x14z\\x87\\xb6T\\xcbt:a\\x03\\xef:\\x1f_\\xad\\xc0\\x1cT\\x15\\x9d\\xe30\\x0e\\x06\\x03U\\x1d\\x0f\\x01\\x01\\xff\\x04\\x04\\x03\\x02\\x05\\xa00\\x0c\\x06\\x03U\\x1d\\x13\\x01\\x01\\xff\\x04\\x020\\x000\\x1d\\x06\\x03U\\x1d%\\x04\\x160\\x14\\x06\\\r\nx08+\\x06\\x01\\x05\\x05\\x07\\x03\\x01\\x06\\x08+\\x06\\x01\\x05\\x05\\x07\\x03\\x020I\\x06\\x03U\\x1d \\x04B0@04\\x06\\x0b+\\x06\\x01\\x04\\x01\\xb21\\x01\\x02\\x02\\x070%0#\\x06\\x08+\\x06\\x01\\x05\\x05\\x07\\x02\\x01\\x16\\x17https://sectigo.com/CPS0\\x08\\x06\\x06g\\x81\\x0c\\x01\\x02\\x010\\x81\\x84\\x06\\x08+\\x06\\x01\r\n\\x05\\x05\\x07\\x01\\x01\\x04x0v0O\\x06\\x08+\\x06\\x01\\x05\\x05\\x070\\x02\\x86Chttp://crt.sectigo.com/SectigoRSADomainValidationSecureServerCA.crt0#\\x06\\x08+\\x06\\x01\\x05\\x05\\x070\\x01\\x86\\x17http://ocsp.sectigo.com0\\x1f\\x06\\x03U\\x1d\\x11\\x04\\x180\\x16\\x82\\n*.mql5.net\\x82\\x08mql5.net0\\x\r\n82\\x01\\x7f\\x06\\n+\\x06\\x01\\x04\\x01\\xd6y\\x02\\x04\\x02\\x04\\x82\\x01o\\x04\\x82\\x01k\\x01i\\x00v\\x00\\xbb\\xd9\\xdf\\xbc\\x1f\\x8aq\\xb5\\x93\\x94#\\x97\\xaa\\x92{G8W\\x95\\n\\xabR\\xe8\\x1a\\x90\\x96d6\\x8e\\x1e\\xd1\\x85\\x00\\x00\\x01icH\\xf8\\x9b\\x00\\x00\\x04\\x03\\x00G0E\\x02 =\\xab\\xac\\xefa \\xc3\\xf3J\\xbb] w8\r\n\\xc1+\\xa9\\x1b8\\xcc\\x94LP,T\\xe0\\x07\\xe8\\x87\\x93s\\xf5\\x02!\\x00\\xf4D\\x0e\\x86a\\xc9M\\x8b\\xc5\\xf8\\xec\\x821\\x9b\\xbf]^\\xacB1p\\xfc\\x8a\\n\\x07\\xefz\\xb6\\x82 \\xe0\\xd5\\x00v\\x00D\\x94e.\\xb0\\xee\\xce\\xaf\\xc4@\\x07\\xd8\\xa8\\xfe(\\xc0\\xda\\xe6\\x82\\xbe\\xd8\\xcb1\\xb5?\\xd33\\x96\\xb5\\xb6\\x81\\xa8\\x00\\x\r\n00\\x01icH\\xf8\\xdb\\x00\\x00\\x04\\x03\\x00G0E\\x02 ]\\x91\\x03.5\\xaaA\\xa82\\xf4Bg\\x08\\xf7\\xf1\\x948N\\x08,\\xf5\\x96\\x01\\x08\\xdcM]&7J\\xebv\\x02!\\x00\\xeb\\x90\\r\\xd5k\\xf9\\xa3L<\\xc67]\\xc5]\\x16\\xb2\\x10\\xed\\xd5\\x9b\\xec\\xdc$\\xe1\\xd5r+\\x99\\x19\\xdbb\\xe4\\x00w\\x00\\\\\\xdcC\\x92\\xfe\\xe6\\xabED\\xb1^\\x9\r\na\\xd4V\\xe6\\x107\\xfb\\xd5\\xfaG\\xdc\\xa1s\\x94\\xb2^\\xe6\\xf6\\xc7\\x0e\\xca\\x00\\x00\\x01icH\\xf8\\xe5\\x00\\x00\\x04\\x03\\x00H0F\\x02!\\x00\\x8f\\xf5W\\xd5 \\xea\\x02\\xc4v\\x1b\\xd0h\\x03\\xe7`\\xec\\xdfp\\xd7\\xb8\\x10\\xd9nb7\\xadDp\\xf6V\\xa0l\\x02!\\x00\\xa9\\x935\\x94\\xe3\\xdb' |<Padding  |>>)\r\n            |  sig       = None\r\n           mac       = b''\r\n           pad       = b''\r\n           padlen    = None\r\n```\r\n\r\nWe can see that TLSServerKeyExchange.params contains a None, which raises the exception.\r\n\r\n#### Expected result\r\n\r\nA bytes string of TLS record is expected.\r\n\r\nI'm willing to provide a PR but it may take some time. Any help is welcome, thanks guys.\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2763/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2763/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2758", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2758/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2758/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2758/events", "html_url": "https://github.com/secdev/scapy/issues/2758", "id": 677911759, "node_id": "MDU6SXNzdWU2Nzc5MTE3NTk=", "number": 2758, "title": "Errror in decoding MCS information in Radiotap header", "user": {"login": "Nischals", "id": 2862842, "node_id": "MDQ6VXNlcjI4NjI4NDI=", "avatar_url": "https://avatars.githubusercontent.com/u/2862842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nischals", "html_url": "https://github.com/Nischals", "followers_url": "https://api.github.com/users/Nischals/followers", "following_url": "https://api.github.com/users/Nischals/following{/other_user}", "gists_url": "https://api.github.com/users/Nischals/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nischals/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nischals/subscriptions", "organizations_url": "https://api.github.com/users/Nischals/orgs", "repos_url": "https://api.github.com/users/Nischals/repos", "events_url": "https://api.github.com/users/Nischals/events{/privacy}", "received_events_url": "https://api.github.com/users/Nischals/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-08-12T19:05:29Z", "updated_at": "2020-08-17T16:33:05Z", "closed_at": "2020-08-17T16:33:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!--\r\nThings to consider\r\n\r\n1.  Please check that you are using the latest scapy version, e.g. installed via:\r\n\r\n    `pip install --upgrade git+git://github.com/secdev/scapy`\r\n\r\n2.  If you are here to ask a question - please check previous issues and online resources, and consider using gitter instead: <https://gitter.im/secdev/scapy>\r\n\r\n3.  Please understand that **this is not a forum** but an issue tracker. The following article explains why you should limit questions asked on Github issues: <https://medium.com/@methane/why-you-must-not-ask-questions-on-github-issues-51d741d83fde>\r\n-->\r\n\r\n#### Brief description\r\n\r\n<!-- describe the main issue in one sentence -->\r\n<!-- if possible, describe what components / protocols could be affected by the issue (e.g. wrpcap() + IPv6, it is likely this also affects XXX) -->\r\nMCS fileds from radiotap header like MCS index, guard interval, BW etc \r\n![packet_screenshot](https://user-images.githubusercontent.com/2862842/90057508-1b892c80-dcfe-11ea-934b-536b11543d15.PNG)\r\nare not decoded correctly while reading the radiotap header from a wireshark capture\r\n#### Environment\r\n\r\n-   Scapy version: Both in 2.4.3 release version and current development version\r\n-   Python version: 3.8.5\r\n-   Operating System: Windows 10\r\n\r\n<!-- if needed - further information to get a picture of your setup (e.g. a sketch of your network setup) -->\r\n\r\n#### How to reproduce\r\n\r\n<!-- step-by-step explanation or a short script, may reference section 'Related resources' -->\r\nLoad a 802.11 pcap/wcap wireshark capture and observe the radiotap header contents\r\n#### Actual result\r\n{'version': 0,\r\n 'pad': 0,\r\n 'len': 44,\r\n 'present': <Flag 1837131 (TSFT+Flags+Channel+dBm_AntNoise+Antenna+ChannelPlus+MCS+A_MPDU)>, \r\n'Ext': None,\r\n 'mac_timestamp': 60187170,\r\n 'Flags': <Flag 16 (FCS)>, \r\n'Rate': None,\r\n 'ChannelFrequency': 2412, \r\n'ChannelFlags': <Flag 1152 (2GHz+Dynamic_CCK_OFDM)>,\r\n 'dBm_AntSignal': None,\r\n 'dBm_AntNoise': -80, \r\n'Lock_Quality': None, \r\n'Antenna': 0, \r\n'RXFlags': None, \r\n'TXFlags': None, \r\n'ChannelPlusFlags': <Flag 66688 (2GHz+Dynamic_CCK_OFDM+20MHz)>, \r\n'ChannelPlusFrequency': 2412,\r\n 'ChannelPlusNumber': 1, \r\n'knownMCS': <Flag 34 (MCS_index+STBC_streams)>,\r\n 'Ness_LSB': 0, \r\n'STBC_streams': 0, \r\n'FEC_type': 1, \r\n'HT_format': 1, \r\n**'guard_interval': 1,\r\n 'MCS_bandwidth': 3, \r\n'MCS_index': 8,**\r\n 'A_MPDU_ref': 1428,\r\n 'A_MPDU_flags': <Flag 4 (KnownLastSubframe)>,\r\n 'KnownVHT': None, \r\n'PresentVHT': None,\r\n 'VHT_bandwidth': None, \r\n'mcs_nss': None,\r\n 'GroupID': None, \r\n'PartialAID': None,\r\n 'timestamp': None,\r\n 'ts_accuracy': None,\r\n 'ts_position': None,\r\n 'ts_flags': None,\r\n 'he_data1': None, \r\n'he_data2': None, \r\n'he_data3': None, \r\n'he_data4': None,\r\n 'he_data5': None,\r\n 'he_data6': None,\r\n 'hemu_flags1': None,\r\n 'hemu_flags2': None, \r\n'RU_channel1': None,\r\n 'RU_channel2': None,\r\n 'hemuou_per_user_1': None, \r\n'hemuou_per_user_2': None, \r\n'hemuou_per_user_position': None,\r\n 'hemuou_per_user_known': None,\r\n 'lsig_data1': None,\r\n 'lsig_length': None,\r\n 'lsig_rate': None, 'notdecoded': b''}\r\n<#### Expected result\r\nMCS information must be decoded correctly\r\n<!-- describe the expected result and outline the difference to the actual one, could also be a screen shot (e.g. wireshark) -->\r\n\r\n#### Related resources\r\n\r\n<!-- traces / sample pcaps (stripped to the relevant frames), related standards, RFCs or other resources -->\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2758/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2758/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2745", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2745/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2745/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2745/events", "html_url": "https://github.com/secdev/scapy/pull/2745", "id": 672008966, "node_id": "MDExOlB1bGxSZXF1ZXN0NDYyMTIyMjA4", "number": 2745, "title": "Minor HTTP improvements", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-08-03T11:30:14Z", "updated_at": "2020-08-07T18:51:29Z", "closed_at": "2020-08-07T18:29:52Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2745", "html_url": "https://github.com/secdev/scapy/pull/2745", "diff_url": "https://github.com/secdev/scapy/pull/2745.diff", "patch_url": "https://github.com/secdev/scapy/pull/2745.patch", "merged_at": "2020-08-07T18:29:52Z"}, "body": "- fix https://github.com/secdev/scapy/issues/2744\r\n- supress brotli warning when not encountered: it's rarely used and the warning is annoying\r\n\r\nI won't add unit tests because we have too many HTTP ones already, and they always end up being giant :/", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2745/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2745/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2744", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2744/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2744/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2744/events", "html_url": "https://github.com/secdev/scapy/issues/2744", "id": 671587444, "node_id": "MDU6SXNzdWU2NzE1ODc0NDQ=", "number": 2744, "title": "when sniff a response used gzip, decompress fail", "user": {"login": "Qnner", "id": 32847418, "node_id": "MDQ6VXNlcjMyODQ3NDE4", "avatar_url": "https://avatars.githubusercontent.com/u/32847418?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Qnner", "html_url": "https://github.com/Qnner", "followers_url": "https://api.github.com/users/Qnner/followers", "following_url": "https://api.github.com/users/Qnner/following{/other_user}", "gists_url": "https://api.github.com/users/Qnner/gists{/gist_id}", "starred_url": "https://api.github.com/users/Qnner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Qnner/subscriptions", "organizations_url": "https://api.github.com/users/Qnner/orgs", "repos_url": "https://api.github.com/users/Qnner/repos", "events_url": "https://api.github.com/users/Qnner/events{/privacy}", "received_events_url": "https://api.github.com/users/Qnner/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-08-02T09:56:51Z", "updated_at": "2020-08-07T18:29:52Z", "closed_at": "2020-08-07T18:29:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "<!--\r\nThings to consider\r\n\r\n1.  Please check that you are using the latest scapy version, e.g. installed via:\r\n\r\n    `pip install --upgrade git+git://github.com/secdev/scapy`\r\n\r\n2.  If you are here to ask a question - please check previous issues and online resources, and consider using gitter instead: <https://gitter.im/secdev/scapy>\r\n\r\n3.  Please understand that **this is not a forum** but an issue tracker. The following article explains why you should limit questions asked on Github issues: <https://medium.com/@methane/why-you-must-not-ask-questions-on-github-issues-51d741d83fde>\r\n-->\r\n\r\n#### Brief description\r\n\r\n<!-- describe the main issue in one sentence -->\r\n<!-- if possible, describe what components / protocols could be affected by the issue (e.g. wrpcap() + IPv6, it is likely this also affects XXX) -->\r\n\r\n#### Environment\r\n\r\n-   Scapy version: `scapy version 2.3.4`\r\n-   Python version: `2.7`\r\n-   Operating System: `Windows and Centos 7.6`\r\n\r\n<!-- if needed - further information to get a picture of your setup (e.g. a sketch of your network setup) -->\r\n\r\n#### How to reproduce\r\n\r\nwhen I sniff a http response which's header, Content_Encoding is gzip, I can not get the json file correctly\uff0c\r\nI noticed that\r\n \"Perform decompression / defragmentation\r\non all TCP streams simultaneously, but\r\nonly acts passively.\" in https://scapy.readthedocs.io/en/latest/layers/http.html\r\n\r\nand \"This will decode HTTP packets using Content_Length or chunks, and will also decompress the packets when needed. Note: on failure, decompression will be ignored.\" in https://scapy.readthedocs.io/en/latest/api/scapy.layers.http.html\r\n\r\nbut I still cannot decompress my response.\r\n\r\nt tried add a new line in scapy.layer.http.py(near line 288 in function 'post_dissect'):\r\nlike this:\r\n```python\r\n        # Decompress\r\n        try:\r\n            if \"deflate\" in encodings:\r\n                import zlib\r\n                s = zlib.decompress(s)\r\n            elif \"gzip\" in encodings:\r\n                print \"======> hit gzip\"\r\n                s = gzip_decompress(s)\r\n            elif \"compress\" in encodings:\r\n                import lzw\r\n                s = lzw.decompress(s)\r\n        except Exception as e:\r\n            print '===> hit Exception'\r\n            print e\r\n            # Cannot decompress - probably incomplete data\r\n            pass\r\n        return s\r\n```\r\n\r\nand I am sure now that my code run this Decompress yet, but not success.\r\n\r\nhere is my original code\uff1a\r\n\r\n```python\r\ndef packet_parse(pkt):\r\n    if pkt.haslayer(HTTPRequest):\r\n        return\r\n    elif pkt.haslayer(HTTPResponse):\r\n        print pkt[HTTPResponse]\r\n\r\n\r\n\r\nif __name__ == '__main__':\r\n    load_layer(\"http\")\r\n    conf.contribs[\"http\"][\"auto_compression\"] = True\r\n    sniff(offline=r'C:\\Users\\test1\\Downloads\\http-chunked-gzip.pcap', prn=packet_parse, session=TCPSession)\r\n```\r\n\r\n#### Actual result\r\n\r\n<!-- dump results that outline the issue, please format your code -->\r\n```\r\nHTTP/1.1 200 OK\r\nServer: cloudflare-nginx\r\nDate: Wed, 06 Jan 2016 20:42:10 GMT\r\nContent-Type: text/html\r\nTransfer-Encoding: chunked\r\nConnection: close\r\nSet-Cookie: __cfduid=d8d37b52eaa3137bdfd7fd67a4ffc8a7a1452112929; expires=Thu, 05-Jan-17 20:42:09 GMT; path=/; domain=.wireshark.org; HttpOnly\r\nX-Frame-Options: SAMEORIGIN\r\nStrict-Transport-Security: max-age=31536000;\r\nX-Slogan: It's a great product with a great story to tell. I'm pumped!\r\nX-Mod-Pagespeed: 1.9.32.11-7550\r\nVary: Accept-Encoding\r\nCache-control: max-age=0, no-cache, no-store\r\nX-Slogan: Go deep.\r\nCF-RAY: 260a3f709d7b0761-AMS\r\nContent-Encoding: gzip\r\n\r\n\u001f      \u0003   \ufffd\ufffd     106c\r\n\ufffdx\ufffd\ufffd}\ufffd}\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdM\ufffdI6\ufffd\u000e\u001e\u0012i\ufffdaw\ufffd\ufffd\u0011bU\u0002\ufffd!/ \ufffd(\ufffd\u001c\ufffd\ufffd\ufffd\ufffdt\ufffd\ufffd\ufffdsHl*z;\ufffd\ufffd\u000f\ufffd\ufffd\ufffdslB\ufffd3\ufffd\ufffd\u077f\ufffd\ufffd^\ufffd\u000f\ufffd\ufffd_\ufffd4\ufffd{7a\u001a\ufffd\ufffd\ufffdw\ufffd2m\ufffd\u001b\u001c^\ufffdi\ufffdzW\ufffd\u0014\u0398\ufffd\u077d='\u0014\u001c\ufffd\ufffd\ufffd\u000e\ufffdO_tNN\ufffd=??k\ufffd\u000e\u039f\ufffd\ufffd4\u001d\ufffde\u0017\ufffda\ufffd\ufffdi\ufffdE\ufffd\t\ufffd\u0010\u0018Z\ufffd\u000f\ufffd\ufffd\ufffdW\ufffd\ufffd*\ufffdh\ufffdP\ufffdM\ufffdL\u000e\ufffd\ufffd\ufffdV\ufffd\ufffd]\u000f\u000f\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd(\ufffd\ufffd\ufffdJ\ufffdRM\ufffdS.#5uDw\ufffd(:\ufffd\ufffd\ufffd\ufffd\ufffdX\ufffd\ufffd\ufffd\ufffd\ufffd\u05b20)\ufffdN\u050dT\ufffd\ufffd\ufffdh\ufffd\ufffdR\u0666c\ufffdM\ufffdX\ufffdtTw\ufffd\ufffd\ufffduw\ufffdJf,\u0184G\ufffd\ufffd\u0012\ufffd{\u000ev\ufffdo\ufffdD3\ufffd\ufffd6\u000f\ufffds\u07cd\ufffdP#\ufffdx.\ufffd\ufffdw\u035e3\ufffdF^\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd,\ufffd]\ufffd\ufffd\ufffd\ufffd?\ufffd\ufffd\ufffdPb\ufffd\ufffdNy\"\ufffdn\ufffd]\ufffd\ufffdHy\u0019\ufffd\ufffd\ufffd\ufffd9\ufffd\u001a\ufffd%:\ufffd\ufffd\u0010G\ufffd\u001d\ufffd]\u045f8\ufffd\ufffd\ufffdG\ufffd\u000b\ufffd\u001as$Y\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd|\ufffd\ufffd7\ufffd\ufffdnY\ufffd\u0017Q\ufffdu\u0004\u0019\ufffdI\ufffd?\u0002\ufffde\\\ufffd\ufffd6\ufffdZ\ufffd\ufffd\ufffd\ufffd\ufffdY\ufffd\ufffdj8\ufffd\ufffd\u02f8\ufffd\ufffd\u0004\ufffd,\ufffd3\u0014hWF\ufffd\ufffd\ufffd\ufffd\u02f0\ufffd>\ufffd\ufffd\ufffd\u000e\ufffdM\ufffd\u0019\ufffd\ufffd\ufffd\ufffd\ufffd/\ufffd\ufffd&\ufffdjjP\ufffdh5\ufffdy\ufffdwo\ufffdG3/c\u001a\ufffd\ufffdV\u0011z\\\u001a\ufffd\ufffd\u0004GJ\ufffd\ufffd3\ufffd;\ufffd]\ufffd\ufffdN\uc8938#&\f\u0016\ufffd\ufffdH\ufffd\ufffd5\ufffd\ufffd{\u0014\u0006\ufffd\ufffdv\u04fdw)y\ufffd\ufffd\u0015:I\u0777\ufffdX\ufffdS\ufffd\ufffd{\ufffd{G\ufffdw \ufffd\ufffd*\ufffdw\ufffdS\ufffd\f\u0012k3\u0017\u007f\ufffd\ufffd\ufffd{\ufffd\ufffdEi\ufffd\ufffd<\u02d7n\ufffd\ufffd\ufffd\ufffd4E\ufffd L\ufffd6h\ufffd?\f_\ufffd\ufffd\u001b\ufffd\ufffdc\u02ed\ufffd\ufffd\u001d\u00191az\f\ufffd\ufffd7\ufffdRp\ufffd\ufffdy\ufffd~\u0678s,\ufffd\u001c\ufffdF\u044d\ufffdq3\ufffd#\ufffda\u0002\ufffd\ufffdQ\ufffd\ufffd\ufffd#%\ufffd\ufffdb\ufffdb\ufffd,\ufffd\ufffd\ufffd\u007f\ufffd\ufffd\u0773\ufffdo\ufffd\u00063\ufffdY\u001e\ufffdJ\u001ecD5\ufffd\ufffd$\u0013s\ufffd\ufffd_;\ufffd\ufffdI\ufffd\ufffd\ufffd0\ufffd\ufffd6\ufffd-\ufffdP\ufffdF\ufffdZ\u0005\u0011Oi\ufffd\ufffd#6\ufffdV\ufffd\ufffd\ufffd\u0001v\ufffda\ufffdQ\ufffd\ufffd3\ufffd\ufffd}\ufffd\ufffd\u0654G6\ufffdF8\ufffd!\ufffd\u014b\u0003\\r\u02d9pM\ufffd\u0004v\ufffd^\ufffd\u0001\ufffd\ufffd\u061dp\ufffdfJ\u06c7 s4e\u0007\ufffde\u0002\ufffdT\u0005\\\ufffd;\ufffd\ufffdeY\ufffd,c\ufffd\ufffd{\ufffd\ufffd\u000b4\t\ufffd}\ufffd\ufffdM0E\ufffd\ufffdj\u001f\ufffd\ufffd1\ufffd\ufffdr\u001b&\ufffd\ufffd\ufffdK/4\ufffd\u0001)F\ufffduM\ufffd\u0011e\ufffdX@47\ufffd\u0007\ufffd|3b)\u0017\ufffd\ufffd@\ufffd:\u012f\u0006L\ufffd\ufffdn\ufffd:\ufffdZ\ufffd~\ufffd\ufffd|\ufffdj9O[-\ufffdY\ufffd\ufffd(i\ufffd2\ufffdCj\ufffd\ufffd\ufffd\ufffdO\u0347\r\nJ\ufffd\ufffdK\ufffdc\ufffd\ufffd\u007f\ufffd\ufffd/\ufffd\ufffd\ufffd\u001c\ufffd:\\\u001a\ufffdJ\u0006\ufffdIr\u0004O\ufffd\ufffd\ufffd\ufffd\ufffd\u06a8\ufffdu&\ufffdF\ufffdXy\ufffd\ufffd\u001b\ufffdB9\u04ef\ufffd\ufffdkgF\ufffd\u04195\ufffd\t\ufffdm\u043e\ufffd3\ufffd\u0013\ufffdIo\ufffdX\ufffd\ufffd\u000b\ufffd\ufffd\ufffd*Q\u0017\ufffd+\ufffd\ufffd\\+\u0644\u01cc\ufffd\ufffd\ufffd\ufffdq.V\ufffdS3\ufffd<j\u001e'\ufffd\u072f\ufffd\ufffd\ufffdVY\ufffd\ufffdkvz\"qj\u001a\ufffdk\ufffd\ufffdJ@\ufffd?\ufffd\ufffd\ufffd\u000e\ufffd\ufffdhX\ufffdB\u000b\ufffd\ufffd\ufffdqi1\ufffd\u0491\u0154\ufffd6h\ufffd\ufffd\ufffd\ufffd\ufffdCh\ufffd\ufffd\ufffdQ\ufffd\ufffd\ufffdY\ufffd\ufffd\ufffd\ufffdl)\ufffdB\ufffd\ufffdx)\u02bc\u0010\ufffd\ufffd\u000bTn\ufffd\u0006\ufffd^\ufffd\u001e\ufffdu\ufffd\ufffdj7\u0002\ufffd2\ufffd\ufffd;\ufffd\ufffd\ufffdt\ufffd\ufffd\ufffd\u001c\ufffd~ T\ufffd-\ufffd\ufffd)\u001d\ufffd\ufffd\u0789P\ufffd\r\n\ufffd\ufffdzl\ufffd\ufffds\ufffd~\ufffd\ufffd\ufffdh\ufffd^\ufffd\ufffdf\ufffdv\ufffdTh|2yY\ufffd\ufffd\u000fb\r\n\ufffd\ufffdy\ufffd\u001f\ufffd\u000e\ufffd\ufffd^\u0007\ufffdHu\ufffd\u001fs;\ufffd\ufffd\ufffd\ufffd\ufffdl\ufffd\ufffd=b]\ufffd\u0011\u001b\ufffd\ufffd\ufffdv\u0007\ufffd \ufffd\ufffd\ufffd\ufffd\ufffdI\ufffdr\ufffd\ufffdYnU\ufffd,F\ufffd\ufffd%\ufffdh,\ufffd\ufffd\\D\ufffd\ufffd8\ufffd\ufffd\ufffdF\ufffd|\ufffd:\ufffd\ufffdH1\u001a\ufffd\ufffd\\\ufffd S\ufffd(\ufffdkW\ufffd\r\n\ufffd\ufffd%\u001a[\u0001\ufffd\ufffdX=K6YnN\ufffdO\ufffd\ufffdT\ufffd\ufffd&\u0002\u04d6\ufffde\ufffd\ufffdiN\ufffd#\u056f\ufffdi0TD\ufffd*2\ufffd$,R\ufffd\u0005\ufffdS\ufffdR\u0011\u001buTg,\ufffd\ufffd\ufffd\u000f\ufffdy+\ufffd5\ufffdr\ufffd\ufffdt\ufffd\ufffd\ufffdj\ufffd\u0015z\ufffd1\u001fB\ufffd\ufffdns\ufffd\ufffd\ufffd\ufffd\u0014].\ufffdV\ufffd}\u00167\ufffd\ufffd`\u0005Bc\ufffd\ufffd\u001e\ufffdT\ufffd\ufffdZk9\ufffdB5A\ufffdF/O\ufffdh\ufffd;\ufffd\u0011\ufffda\ufffd\u059a)\ufffdI\ufffdC8h}qT\ufffdP\ufffdA\ufffd\ufffdn\u0007\ufffd/\ufffdg\ufffd\ufffdY\ufffd\ufffd@7P\u05aat;\u00f3\ufffd\u0017\ufffduGV\ufffdYa \ufffd\u0005\ufffdC\ufffd\ufffd\ufffd\ufffd}\ufffd\u0002J`\u001f\ufffdmN \ufffd\ufffd\ufffd\ufffd\ufffdJ\ufffdi\ufffd;P\ufffd8DiQ7\ufffdcY\ufffdu7,\u000f\u0014]\u02c4(r\u069aP\ufffd\u01a5vt\ufffd\u0011\ufffd\\\u6665\ufffdT\ufffdBn\ufffd\ufffdX\ufffd\ufffd\ufffdn\ufffd\u0669nm\ufffd\ufffd\ufffd\ufffd\u0014*le\\&yZ\ufffdK\ufffd\ufffd\u0006\ufffd\u001b\ufffd`\ufffd2\ufffd{\ufffd\ufffd\ufffd\ufffd\ufffd^kD\ufffd\ufffd\ufffdkJV\ufffdJ\ufffd\u0015C\ufffd\ufffdx\ufffd\ufffd\u001a/\ufffd\u000f\ufffdV\u9f16y\ufffdn5\ufffd@\ufffd\ufffd\ufffd\ufffd\ufffdSib\ufffd\ufffd|\ufffdaV-\u079aH\ufffd3P\ufffd\ufffd(O\ufffd\ufffd\"\\\ufffd\u02a8\ufffd^\ufffd\ufffdv\ufffd>\u001a[&a\u001b\ufffdmU\ufffd\ufffd\u000b\ufffd\u007fD\ufffdrZu\ufffd\ufffdK\u0308\ufffd\ufffd\ufffd\ufffdl\ufffd\ufffd\ufffd\u000fr\uc93dH\ufffdK\ufffd\u0003%:B\ufffd\ufffd\u0007\u05e4r`\ufffd\u0010R\ufffd\ufffd&\ufffd\ufffd\u001a\ufffd\ufffd\u0006\u0007\u0014\ufffd\u0018\ufffd\ufffd\ufffd\u001e\ufffd\ufffd\ufffd\ufffd\u0005\ufffd\ufffd3.\ufffd\u0007\ufffd20>\ufffd\ufffd\u00052-\ufffd\u0006\u007f\ufffd\u0141R\ufffdO\ufffd\ufffdK\u0012h\ufffdo\ufffd\ufffdj*0\ufffd\u0011\ufffd\ufffd[5\ufffd4\ufffd\ufffd\ufffd{\ufffd\ufffd|\ufffd\ufffd\ufffd\ufffd\u001f\ufffd.m\ufffd*\ufffdb\ufffd\ufffd\u0004>~\ufffd\ufffd\u0004\ufffdJn\ufffd\ufffdw\ufffd&\ufffd\u02b6`\ufffda\"\ufffdP\ufffd|\ufffd\ufffd\ufffd\u0179\ufffd\u0003z\ufffdSe.+\ufffd\u000f\ufffd\ufffd\ufffdU\ufffd\ufffdA\u0159M\ufffdm\ufffd\ufffdw\ufffd\ufffdP\ufffd\ufffd\u03baiE\u007f\ufffd\ufffdn\ufffd\ufffd\ufffdQW\ufffd5K\u0007\u0005<\ufffdQC\u00b8.\ufffd\ufffdN\ufffdc\ufffd\ufffd\ufffda\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdv$V\ufffdU\ufffdt\ufffde%\ufffd!t\ufffd\ufffdfa\ufffd\ufffd(\u001fe\ufffd\u000bO\ufffd\ufffd\ufffdf\ufffd\ufffdC\ufffdz\ufffd\ufffd\ufffdp\u0016W\ufffd\ufffd\ufffd\f\ufffd\ufffd\ufffd\ufffdK\u001c\ufffd\u000f[q\ufffd\u04d6\u0005\u0001}\ufffd\u0001\ufffd\u0002a\ufffd \ufffd\ufffd66\ufffd\ufffd\ufffd\ufffd\u0005\ufffd>\ufffdc\ufffd\ufffd\u049f\ufffd:\ufffd\ufffd\ufffdOpY\ufffd<i\ufffdx\ufffd9\ufffd\ufffd\u007f\ufffd\ufffd\ufffdv\ufffd\ufffdX?\ufffd\ufffd,X\u001e\ufffdl\ufffd\ufffdV\ufffd;\ufffd\u04e7\ufffd\ufffd_\"\ufffd\ufffdF\ufffd1\ufffd\ufffdN\ufffdM \ufffd\ufffd<\ufffda\ufffdtd\ufffd\ufffda\ufffd\u0004\ufffd6\u0001>\ufffdZ\f\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd6Q\ufffdl9\ufffdy\u04a6\u007f\ufffdG^+\ufffd\u05aa\ufffd\ufffd{,\u000b\ufffd\ufffdzh\ufffd67c\u0012\ufffd\\\u000e\\Bi\ufffd\u0006-\r\n\ufffd{\ufffd,\uda5d\udebeO\u0015*E|4B\ufffd)\ufffd\ufffd\ufffd\ufffd\u000b\r\n \ufffd2k\u000e\ufffd\ufffdY\ufffd\ufffd\u0019\ufffd\r\n`M_<GZ\ufffd\ufffdp\u0012\ufffd\u0003\u0017\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdm\u0007noo\ufffdo\ufffd.O\u001d\ufffd\u000f\ufffd\u001c8\u00119Z\ufffd\ufffd*\ufffd\u000f\ufffd\u0013\u0007\r\nE\ufffd5\ufffd1\ufffd)\ufffd\"\ufffd\ufffd\ufffd\u0281\ufffdgg\u0017\ufffdN\ufffd:\ufffd\u001ba\ufffd2Z\u0769\ufffdY\ufffd\ufffd\u0014\ufffd\fC=\ufffd\u029c=\ufffd(/\ufffd0-\ufffd\ufffd\u000b\u0019a]\ufffd\u001a\f\u001d\ufffd\u0018\ufffd\ufffd\ufffd\ufffdu\ufffd{*-\ufffd2\u000e\f\ufffd\ufffdn'\ufffd\u000e\f\u0006\ufffd\ufffd\ufffdr\ufffd\ufffd\ufffd\ufffdm)\ufffd\ufffdm\u07ff\ufffd\ufffdwV,L\u0005\u0013\ufffd\ufffd0qi\u001b\ufffd\ufffd\ufffd1\ufffd7\ufffdj\u0005\ufffdo#\ufffdL?\ufffd<\u001c\ufffd(6\ufffdjl\ufffd\ufffd7\ufffd\ufffdr[\ufffd\ufffd\ufffd)\u0001\u007f\ufffd\ufffdt\ufffdV\u0019\r\n\u0013\ufffd2\u0003'\ufffd\ufffd\ufffdp\ufffdWi|B\u0013,\ufffd\ufffd\ufffd\ufffd\ufffdcq\ufffdf\u000b\ufffdi\ufffd\ufffd\ufffdI\\\ufffd\u000b\ufffd\ufffdQ(\ufffdF\ufffdo\ufffd\u000e\ufffd\ufffd\ufffd\u001e\ufffd(L\u0585L\ufffd6\u0002\f\ufffdm\ufffdm\ufffd\ufffd\u0015\u001f#|\u02c4X\ufffdO\ufffd\ufffd\u0010'aB\ufffdU\u0012=\ufffdv\u000b\ufffd\ufffd\r\nf\u010c\ufffdg\u1600\ufffdk\\\ufffd\u00017\ufffd\ud8e2\udcc6\ufffd\u0014]2ZC\ufffd?   \ufffd\ufffd\r\ne1e\r\n\u0001\ufffd\ufffd\u0005\ufffdGs\ufffd\ufffd^9+T\ufffd\ufffdh\ufffd\u001dt\ufffd\ufffd\u0272I\ufffd[\ufffd\r\naz\ufffd+v\ufffd\u0560L\u0425%\ufffdm\ufffd=\ufffd\ufffdm\ufffd\ufffd\ufffd\ufffd\ufffd=P\u024f\ufffd\ufffd\ufffd\u000b\u0007\ufffdx\ufffd\u0015\ufffd\u001b\ufffd\u001cs5\ufffd\ufffd\ufffd\ufffd\ufffd\u0017c\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdb\u7fb7\ufffdx\u0002\u0007;005C \u001d\u001fpM\ufffdFi\u0015p\u0588;\ufffd5v\ufffd.\u0001\ufffd\ufffdE(\ufffd\ufffd\ufffdZ:\u001e\ufffd\uc6a6\ufffd^\ufffd\r\n\ufffd\ufffd\ufffd\ufffdI\u00136\ufffd\u03ab\ufffdJ\u001fKU\ufffd\ufffd\ufffd\ufffdv\ufffd\ufffd}\ufffd\ufffddHb\ufffdx;\ufffdc@Wp\ufffd' \ufffdI<a\ufffdY\ufffd\ufffd\t\ufffd\ufffd\ufffd\ufffd\u001fGW\ufffd\ufffdvT^\ufffdF|\ufffdy\ufffd\t\u001b\u0012\ufffd^\ufffd\ufffd+\ufffd\ufffd]\u0643]\ufffd4\u0006\u000e$\ufffdD\ufffd\ufffd\ufffd\ufffd\r\n;\ufffd\ufffd\r\nq\ufffd\"h\ufffd\ufffd\ufffdl\ufffd\u0007L\ufffd}\ufffd4Q\u0014\u0005\ufffd9@\ufffdKx\u0003\ufffd\ufffd/\ufffdV\ufffdt\u0007S\ufffdu\ufffd\r\nd'\u0015XE\ufffd\ufffd\ufffd\ufffdXx\ufffd\u03a9 n\ufffd\ufffdM\ufffdV&!\ufffdC$\ufffd\ufffd\ufffd]:P\ufffdx\ufffd-f\u0636&EJY=~\ufffd(\ufffdw\r\n;\u0012\ufffd\"\ufffdu#\u001e\u0011Lvo8\ufffd\ufffd\ufffdy\ufffd0\ufffd\ufffd\ufffd\u0002\ufffd\ufffd\ufffd\ufffd\\%\u0019\ufffdr\ufffdiy>\ufffd87\u010f>\ufffd\u001a\ufffd\ufffd\ufffdn\u0650;\ufffdDJ\u0005Ut\ufffd\u001b\ufffd`\ufffd\ufffdO\ufffd\ufffdm;]G3\\wm\ufffd\ufffd\u000f\u001fJ\ufffdn\ufffd\u001e\ufffd\ufffdq\r\n\ufffdg\u0648\ufffd~F\ufffd\ufffdb\u001dN\ufffd\ufffd+j\ufffd\u0017\ufffd\ufffd\ufffd&9\ufffdS\ufffd\u04ba\ufffd\ufffd\ufffd\u0196\ufffdX l\ufffd~\u000f\ufffd=\ufffd\u0010\u0018\ufffd{_\ufffd\ufffdg\ufffd-\ufffd\u0007\ufffdn\ufffd\ufffd\ufffd\ufffdc:\ufffd\ufffd\ufffd\ufffdjZ\r\n\ufffd\ufffd\\T\ufffd\u0012J<\ufffd5\ufffdw\u000e2\ufffdR\u000e\u0007%okP\ufffdum\ufffd\ufffdw0\ufffd\ufffd\ufffdn\ufffd$LuM]<a\u0013\u0135\ufffd|p\u007f\ufffdwJ\ufffd\u000f\ufffd\u001a=\u001a\u0015\ufffdVq\u001e\u001b=[c\u0014\ufffd%\ufffd\u0517\ufffd2\ufffd&\ufffd7\ufffd\ufffd1Py\ufffd\u0003V\ufffd\ufffdF.\ufffd\ufffd\u001e\u0101\u000e\ufffd{\u0013,\ufffd\u0015\ufffd\ufffd\ufffd\\~\ufffd~\ufffd~Z\u02bb\ufffd9\ufffd\ufffd\ufffd\u9285\u00147\ufffd\u073b\ufffd\r\n\ufffd_\ufffd7\ufffd\ufffd*\u000e\ufffd\ufffdr\ufffd\ufffdw\u000f\u000eV`\ufffd\ufffd)\ufffd\ufffd4LO\ufffd\ufffd\u000f\ufffd\u001f\ufffd\ufffd\ufffd\ufffd\u0013\u000fJ\ufffdv\ufffd\ufffd\u001de\ufffdA\ufffdaCs\ufffd\ufffd\ufffd@\ufffd\ufffd\ufffd\u00147\ufffdN\ufffd\ufffd6\ufffd%\ufffd9\ufffdU\u001f\u000bQ\"\ufffdO\ufffd\ufffdSm\u001a\ufffd)\ufffdq_8\u07eaq\ufffd5=\ufffdus\ufffd\u001a\ufffd%\ufffd\u001c85\ufffd\ufffd\ufffdS\ufffd\ufffd\u03ea\f*\ufffd\ufffd\u0014B\ufffd4\ufffd\u0012\ufffdlm\ufffdF\ufffd\ufffd\ufffdQ\ufffd\ufffd\u0013n\u0405l1V\ufffdy\ufffdQ\ufffd\ufffd\u078d\u0109\ufffd,m\ufffd4b\tU\ufffd\ufffd\ufffdj\ufffd-V\ufffd\ufffd+\ufffd\ufffd\ufffd(n+\u0016\u007f\ufffd\ufffd\ufffd\ufffd\ufffd0L\ufffd\u0013\ufffd\u8401E\ufffdJ*\ufffd\ufffdX\ufffd6J\ufffd\ufffdH:\ufffdwqF\ufffdo\ufffd-\ufffd=-\ufffd\ufffd\ufffd\ufffdb\u000f\u03851\u0006\ufffd\u0018\u0019\u000b\ufffdt\ufffd1Mc5\u001a\ufffdk\ufffd\ufffd5\u0004\ufffd\ufffdxD\ufffd\ufffdnU=EPI+\u007fj\u0013E=(8\ufffd%\ufffdu\u063c\ufffd\ufffdI\ufffd\ufffdF\ufffd\ufffd\ufffd\uc8f1q\ufffdp\ufffd$\ufffd'\ufffdd\ufffd\ufffd\ufffd\ufffd\u0011\ufffd\ufffdB\u06695\ufffdJ\ufffd \u007f\ufffd\u000b\ufffd\u0017\ufffd\ufffd\ufffdz\u0010_\ufffdn\ufffd\ufffdY\ufffd\ufffd\ufffd\ufffdfk\ufffdV\u05a8u\ufffd\ufffd$\ufffdHSZE\ufffd\ufffd7\ufffd;\ufffd\ufffd>@\ufffdK\ufffds\u03a9\ufffd<t\u0015f\ufffd\ufffdY\u0001\ufffd\ufffd-d\ufffd\ufffd<\ufffd\ufffd\ufffd\ufffd\ufffd\\\ufffd\ufffdA\ufffd\u007fg\ufffd\u0006\ufffdh\u07a6\u0016_\ufffdN\ufffdt`\ufffd\ufffdk[\ufffd6\u0004\ufffdu\u04d6\ufffd'E\r\n\u001b\ufffd\ufffd\ufffd\ufffdSWoA\u0011=K\u0269\ufffd\ufffd&M\u001a\ufffdXSs\ufffdD\ufffd\ufffd\ufffd\ufffd0\ufffd\ufffd\ufffd.\ufffdB\ufffd\ufffd\ufffd\u052e\ufffd$\ufffd57i\ufffdh6}\u001d\ufffd\ufffdg\ufffd\ufffd\fw\ufffdX\ufffd\ufffd\ufffd\ufffd\ufffdV\ufffd)\ufffd\ufffdZ\ufffd\ufffdp\ufffd\ufffdp\ufffd\ufffd\ufffd\ufffd\ufffdD\u0599\ufffd\ufffd\ufffdcR\ufffd\ufffdx\ufffdB\ufffd9\ufffdlq>\ufffdy\ufffd\r\nL\ufffd9\ufffd/F/\ufffd\ufffd\ufffdm\ufffd{\ufffd\u0010\ufffd<\ufffd\ufffd\u0115\ufffduO\ufffdj\ufffd\ufffd>!\ufffd\u000bty3\ufffdk\ufffd}\ufffd\ufffdEn\ufffd\u0006k\ufffdST\ufffd\ufffd,5\ufffd{]\ufffd=\ufffd\ufffd\ufffd\u001cw\ufffd\ufffdn\ufffd\ufffd\ufffd\u066e\ufffd>\u0003\ufffd8\ufffdtO\ufffd\ufffdA\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdY\ufffd\ufffdc\u033cv\u054e\ufffd3\\i\ufffdP\ufffd\ufffdh\ufffd\ufffd\r\na\ufffd\ufffd\ufffd\u001e\ufffdo\ufffd*\u00055MuP?{e!\ufffd\r\n\ufffdx\u06b5-\u001a\ufffd\ufffd\u001e\ufffd?\ufffd\ufffd\ufffd\u000fNXw\u0001Z\ufffd\ufffd\ufffd\ufffd\u0007\ufffd \ufffd4\ufffd\ufffd\ufffd#\ufffd\u000f\ufffdl\u618b\ufffd\u0014\ufffdz\ufffd\ufffd\u0005\ufffd\ufffdf\ufffd\ufffdJ\ufffd\ufffde\ufffd\u001d\ufffdg\ufffd\ufffdM^(\ufffd\ufffdQ\u001e\u0014|\ufffdc7\ufffd$9\u001f\ufffd\u0003qm\u001a;\ufffd6\ufffd{g%:\ufffd.o\u001ef\ufffd:\ufffd\u0011\ufffd\u001dnsg\ufffdz\ufffd\ufffd)\r\n\ufffd\ufffd)\ufffd\ufffd|\ufffdq\ufffd\ufffd\ufffdU\ufffd\ufffd\ufffd\u00058g1\ufffd\u0006\ufffd\ufffd\ufffdtO\ufffd\ufffd\ufffdJ[\ufffd`l\ufffd+m\ufffd\\\ufffd\ufffd\ufffdvg(\u00014\ufffd~\ufffd8a\u0006o\ufffd<\u0001\u0013\ufffd\ufffd}O\ufffd\ufffd\ufffd\ufffd\ufffdY\ufffd\u000bc\ufffdU\ufffd\ufffd\ufffdY\u05eanbj\ufffd\ufffd\ufffd\ufffd\ufffd0-\ufffd\u0005\ufffd;c3\ufffd*id\ufffdpWI{\ufffd\ufffd\ufffd4\ufffd,h\ufffd8\u001fPkX%\ufffd\ufffdJ\ufffd\u0007\ufffd-lJ-\ufffd\ufffd\u0006F\ufffd\ufffdzTu\u0016\ufffd\ufffdI\ufffd\ufffdn\ufffd\ufffd86\u0005~\ufffd\u0001\ufffd\u0012/J95\ufffdo\ufffd\u000eD\ufffd\ufffd\ufffd\ufffdS\ufffd\ufffd4\ufffdM/\ufffd\ufffd\ufffdl\ufffd\ufffdT\ufffd\\\ufffdPrevf\ufffd{{\ufffdtJ\u001d\ufffd/\ufffd\ufffd\u001e7Y\u0018K\ufffd\ufffdyU\ufffd)\ufffd\u00015ah\ufffd#\ufffdx\ufffd\u001d\ufffd\ufffd\u0016\u0766\ufffd\\\ufffd(\ufffd\ufffd)\ufffd\ufffd\ufffd\ufffd|\ufffd\ufffdK\ufffd<\ufffds-\u0175\u001b\u0006\ufffd\ufffdn\ufffd\u051adU\ufffd.\ufffd\ufffdV4]\ufffdw\ufffdF\ufffdIu\ufffdy\u072bQ,\u0015\ufffdw\ufffd\ufffd\ufffd\ufffd\u051a\ufffd`\ufffd:V~\u04f0\u001a\ufffd\u001c?\ufffd,K\ufffd\ufffdT\ufffdX\ufffd\ufffd`@\\+\ufffd\u0016x\u0219 \u0012\ufffd\ufffd]\ufffd@vv3\ufffd\ufffd4('.-}\u000fp\ufffd\ufffdH\ufffd\ufffd\ufffd`,w}\ufffd\u0010\ufffd^\ufffd\ufffd\u001d\ufffd1o\ufffd%\u0019\u0003\ufffd\ufffdg\ufffdx\ufffd/s\ufffd?   \ufffd\ufffd\r\n1e8f\r\n\ufffd]K\ufffd\ufffd8r\ufffd+\ufffd\ufffd\ufffd(\ufffdgfwg\ufffdX]\u03e9Gw\ufffdU\u04fd\ufffdKG\ufffd\ufffdH\ufffd \ufffd\ufffdC*\ufffd\ufffd\u001f\ufffd\ufffd\u00de|\ufffd\ufffd\ufffdo\ufffd\ufffd\u001c\ufffd\ufffd\ufffd[`\t\ufffd\ufffdz29\f\u0015\t\u0002\ufffd\ufffd\ufffd/o `\u0002\ufffd\ufffdH\u06c39n\ufffd\ufffd\ufffdO\ufffd\ufffdE*%a8>\ufffdk\ufffd[W\ufffd\u0003@\ufffd+!\u001aW$\ufffd\u011e\ufffdm\u0018\ufffd\u001d\ufffd\u001f\u001c\u007f\ufffd\ufffd\ufffd\ufffd\ufffd\u000e\ufffdu(Voe\ufffd\ufffd\u001b\u06fc\u047f\u0015V\ufffd\\G_dqI\ufffdC\ufffd\ufffd{\u0019\u007f\ufffd\ufffd~x\ufffd\ufffd\ufffdt\ufffd\u001c\ufffd\ufffdI\ufffd\ufffd\ufffd_\u0013z%A\ufffd\ufffd6d\u0775\ufffd\ufffd\ufffd$\ufffd\ufffd1}\ufffd-\ufffdRX\ufffd\ufffd\ufffdb\ufffd\ufffd\u0010o_\ufffd\ufffd\ufffdr\t\ufffdo\ufffd\ufffd\u000f\u0345\ufffd8\ufffdO!4H\ufffdo\ufffdI\ufffd\ufffd\ufffd\u001c\u0002\ufffd8*\ufffd\ufffd\u007fJ\ufffd\ufffd\ufffd\ufffd\u0019\ufffd\ufffd*\ufffd\u000e\ufffd\ufffd)\ufffd+\ufffd)\u001c\ufffd\ufffd\ufffd`\ufffd\ufffd\u000f\ufffd>\ufffd\ufffd\ufffd\u0007\u00e6\fB\ufffd\ufffd\ufffdg\u000bDh\ufffd\u001a\ufffdM,[6\ufffd\ufffd\ufffdp\ufffd\ufffd\u0013\ufffd\ufffd\u03f6P:\ufffd\f\ufffdo\ufffdyuh\ufffd]Z\u0011\ufffd\ufffdn\ufffd<\ufffd<\ufffdHW\u00070\ufffd\u0002Wg^\ufffdr\ufffdJ\u0012\ufffd\u001aA\u001aO\ufffd\f\ufffds\u0006V\ufffd\ufffd\ufffd\ufffd\u0006U>hR\ufffd\ufffdF\ufffd\u001a\ufffd\ufffd\u001cj\ufffd\ufffd\u0004\u03a69\u000e\ufffd\ufffd0\ufffd\ufffd@\ufffd#H\ufffd\ufffd\ufffd#\ufffd\ufffd&)\ufffd(l\ufffd\u000fF\ufffd\u0217\ufffd\ufffdRt4\ufffdCS\ufffd\u001f\ufffd?\ufffd~\ufffd\ufffd\ufffd{k\ufffd\ufffd#'\ufffd|M\u001e:>\ufffd\ufffd?\ufffd\ufffd\ufffd1\ufffd\ufffd\ufffd\ud214A\ufffd\ufffd\ufffd\ufffd '\u0017C\ufffd) E\ufffdR\ufffd:\f\ufffd\ufffdUpD\ufffd\u0011\ufffd#it\u0014#Td\ufffd~\u0001\ufffd\u007f\ufffd\u0520KD4\ufffd\ufffd\u0546\ufffdS\ufffd\ufffd\ufffd(\ufffd|\u020f\ufffd\ufffd;~Fk\ufffd\ufffd\ufffdL\ufffd\ufffd\ufffd\ufffdN\ufffd\ufffd\ufffdB\u000e\ufffd]\ufffd`u^\u0004!\u0017?\ufffd\ufffd)\u0005\ufffd\ufffd(\ufffd\ufffd\u0017=\ufffd]\ufffd\ufffd=8\u045d\ufffd\u039f\u001c\r\n{\u001a!\ufffd,\ufffd9\ufffdP\ufffd~\u0007J\ufffd\ufffd] \u0007\ufffd\ufffd\ufffd\ufffd\u001c\ufffdJ\ufffd\ufffd\ufffdM\u001d\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u00059\ufffd\ufffd2y\ufffd\ufffd\ufffd\ufffd\u001cv/\ufffdL\ufffdG%\ufffd\u0005\u0012\u05d1\ufffdp\ufffds*\ufffd]]b\u062e\ufffd\ufffdh\u0003\ufffd+\ufffd~\ufffd\ufffd~\u007f\ufffd\ufffdW\u000emt\ufffd\u001b?Q\ufffd~\ufffd\ufffd@\ufffd\ufffd\ufffd\ufffd\ufffd\u0007\u000f\ufffdu\ufffd\ufffd\u04efg\u0017\ufffd\ufffd*8~yurg\ufffd\u001e\u0013\ufffd\ufffd\ufffd4>,\ufffd\ufffd\ufffd\u0676\ufffdz\ufffd\u0333\ufffd\u0012\u0104\ufffd\ufffd0kVwh\ufffd%-\ufffd-E\ufffd1N\ufffd\u0006\ufffd\ufffd\ufffd\ufffd\u0012\u0012@s2\ufffd\ufffd\ufffd\ufffd\ufffd\u067b\ufffd\ufffd\u001dh\ufffd\ufffdR\ufffdW\ufffd\ufffd\ufffd\ufffd\u001f\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdC\ufffd[G\ufffd\ufffdD\u001c]\ufffd\u000f\ufffd\ufffd\u000bu\ufffd\ufffd\u00a1\ufffd\ufffdd!\ufffd\u007ftqO\ufffdy\ufffd\ufffdO(\ufffd\u0630[AIkV\ufffd\ufffdN\ufffd\ufffd\ufffd[^\ufffdV\ufffd\u001a\ufffd\ufffduq>\ufffdi\ufffdH\ufffd*\ufffd\r\ne\ufffdU,\ufffdS\ufffd\ufffd\u0004\ufffd\u04a8\ufffd\u0018\r\n\u000ey\r\n\ufffd\u03e3\u0012\ufffd70\ufffd\ufffd\ufffd\u0015\ufffd\ufffd`\ufffdPz\ufffd[w\u001b\ufffd\u0142\u04df\ufffd\ufffd\ufffds\ufffdt+\u0654\ufffd\r\n\ufffdi?:xrD,Sg\ufffd\ufffd\ufffd9Y x\u0012(i\ufffd\ufffd\f\ufffd\fW\ufffd>n\u000f\ufffd\ufffd}hZ\ufffd+\ufffd\ufffdg\ufffd^\ufffd\r\n\u001c\ufffdJ\ufffd\u0014j\ufffd\"\ufffd|#-\ufffdR\ufffd\ufffd\u0005vZ \ufffd\ufffd\ufffd0[\ufffd|]S0\u0005\ufffd\\\u02ba|\ufffd\u001d`{\ufffd\"\ufffd\ufffd9\ufffd\ufffd\u0006\ufffd\ufffda\ufffd\ufffd{ \ufffd\ufffd'\ufffd\ufffdM\u0016\ufffd<\u06a7\ufffd\ufffd\ufffd\ufffd\u0003v'\ufffdLKc\ufffd+\ufffd\ufffd\ufffdzo#\ufffdW\ufffd\ufffdh\"\ufffd\ufffd\u0011\ufffd6\ufffdy\ufffd~<\u001a\ufffd[3\ufffdLI\ufffd\u000f\ufffdN\ufffdKV\ufffd\ufffdA\fVd`]\u001b{h\r\n\\W\ufffd\u06ac\ufffd\u053e\ufffd\ufffdp$\ufffd 6\ufffd\ufffd\ufffd\ufffdC\ufffd\f\u0013\ufffdNVs\ufffd\u02b4\u001fl\ufffd\ufffd\ufffdX\ufffd\f\ufffd&\ufffdw\ufffd\ufffd\ufffd\u0005y\ufffd\u000b=\ufffd;\ufffd\u0010\ufffd\u001d\u06d1\ufffd\u0016mM\ufffd\ufffd\ufffd~\ufffd\ufffdC2B\ufffd\ufffd,\ufffd\u001c\ufffdd\ufffd\u0013\ufffd\u0780\ufffd\u001d{\u0017\ufffd!\u001e\u001f\ufffdU4\ufffd\ufffd\ufffd\\\ufffdI\u0014$\ufffdrp\ufffdQV\ufffdA\ufffdXz.]\ufffd\ufffd\r\n\u001a\ufffd[R\ufffd\ufffd:\ufffd\u0006\ufffdAC\u001d\ufffd\ufffdX1\u001c\ufffd'\ufffd\u000f\ufffd\ufffd|\ufffd\"\ufffdP\ufffdE#\ufffd[\ufffd\ufffd\ufffd\ufffd\ufffdT\ufffd\ufffdE\ufffd\ufffd\ufffd\u0014*\ufffd\ufffd\ufffdd\ufffduL\ufffd\u0012\ufffd\ufffd:\u0003\ufffd\ufffd\ufffd\u000f\ufffd\u0018>\u0002\ufffd>\ufffd\ufffdV\ufffd\ufffd7%\ufffd\u0019QY\u0003M\ufffdf\ufffd^\r\n\ufffd\ufffd\ufffd\ufffd\f9o\ufffd\ufffd$\ufffd\ufffd\ufffd\ufffd\ufffd&;\ufffd{\ufffdpm\ufffda\ufffd_2x\ufffdJ+\ufffdj \u001d\ufffd\u0012\ufffd\u0002,\ufffd\ufffdm\ufffdK\u0015n\ufffd\ufffdt\u00192A\ufffd?\t\ufffd\ufffd78n\ufffd\r\n\ufffdL. #\ufffd\"\ufffd\ufffdv\ufffd\ufffd~\ufffd/@\ufffd?c\ufffd\u007f\u0018\ufffd\ufffd\u0018k\ufffd\ufffd\ufffd?\ufffd-R\ufffd\ufffdk\ufffd\ufffd\u049a\u001d\u0010\ufffd\u001cQ[\ufffdEj\ufffd$]\ufffdV\ufffd.\ufffdX\ufffdP'\u001d~{\u0425D\ufffd\ufffd.\ufffd$[\ufffdA\ufffdz\ufffd\u0016]g.~+\ufffd\ufffdt\ufffdL\ufffd\u0005\ufffdV\ufffd\ufffd\ufffd\u0006\ufffd\u0001\u0013\ufffd\ufffd\u0550\ufffd\ufffd\ufffd\u0013_&=\ufffdN\ufffd|e\ufffd\ufffd'O\ufffd\u0018\ufffdt\ufffd,\ufffd\u05b1w \ufffd\ufffd`e\\W\ufffdyV\ufffd\ufffdN(\ufffd\r\n\u007f\u0016V\u001b#WY\ufffd\ufffd\ufffd\u00032\ufffd\ufffd\ufffdI\ufffd\u0005\ufffdV\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd=k\"\ufffd\ufffd\ufffdk\u03fd9\u0019\ufffd!\u001a\ufffd\ufffd\u007f\ufffd\ufffd-\ufffd\u001c\ufffd\ufffd\u007fw~\ufffd\ufffd\ufffd:H\ufffdSW\ufffd\ufffd>\ufffd\u001eUUMolF\ufffd\u001b\ufffd\ufffd_8\ufffd\ufffdP\ufffdP\\\ufffdU\u01b1\ufffd\ufffd\ufffd\ufffd@\ufffd\ufffdh\ufffd\u0007\ufffdj\ufffd\ufffdx\ufffd\u010d\ufffd\ufffd\u000f\ufffd\ufffd\ufffd \u0388p[\ufffd\u0268\ufffd\ufffd0oj~\ufffd\u000b#R\ufffd\ufffd\ufffdR\ufffdq\ufffd\ufffdCY\ufffdw/\u007f\ufffd;8.}UQ\ufffdb\ufffdm\ufffd>M\ufffd=\ufffd\ufffd6\ufffds\ufffd,\ufffd\ufffdS\ufffd\ufffdv\ufffd\ufffd=Q\u0016\u001d\u0004\ufffdP\ufffd.?b\ufffd*\u001a\ufffd|lwF\ufffd\ufffdB'hj\ufffd\ufffd'\u0012\ufffd'\u000e\ufffd\ufffd\u00be\u0015\u001au\f<\ufffd\ufffd\ufffdj\ufffd\ufffd\ufffd\ufffd\ufffd^\ufffd\u00044\ufffd\ufffd\ufffdJb\ufffdC\f\u007f\ufffdJ4\ufffd\ufffd\ufffd\u0007%\ufffdt^\u0017O\ufffdG\ufffd\ufffd<\ufffd\ufffd\u000e~\u0193\u001f\ufffd{\ufffdtuq\ufffd/><\ufffdz\ufffdW\ufffd\ufffd\ufffd\ufffdb\ufffd]\ufffdA\u0462\ufffd:\ufffd<\ufffd\ufffd\ufffd\u0719\ufffd\ufffd\ufffdV\ufffd,a\ufffd\ufffd\ufffdh-\ufffd\u0292\u0017,V[!\ufffd\ufffd<\ufffd\u007f\\\ufffdy\ufffd\ufffd\ufffd}\ufffd^\ufffd\ufffdvl\ufffdmX\ufffd3\ufffd\ufffd\ufffd\ufffd\u0019\ufffdp\ufffd?\ufffd\ufffd\ufffde\u000f\ufffd\ufffdv\ufffd9;b\ufffd^\ufffd\ufffd\ufffd\u0007\ufffdAg\ufffd\ufffd\r\n\ufffd+\ufffd\ufffd9\u007f\ufffdC\ufffd\ufffd]\r\n+s\ufffdPT\ufffd\ufffdf]X\ufffd\ufffd%\ufffd`\ufffd\"\ufffd\u001f\ufffd\u0185\ufffd\ufffdf0\ufffdi@\u07f9\u0012+\ufffd \u0018\ufffd\u0019~\u000b\"[\ufffdp\ufffd\ufffdM\ufffd\u001e\ufffd\u0016fB\ufffd\ufffd\u0016(\ufffdq\ufffdsp\ufffd\ufffd#V\u0017\ufffd\ufffd2\ufffdg\ufffdYX/\u0006\ufffd\u0004\u0003\ufffdD\u0013\u0007#\u000e\ufffdGO\ufffdv&\u0004\r\n\ufffd\ufffd\ufffd\u0011\ufffdQ9\ufffd-\ufffdxt\ufffd,\ufffd~\ufffd\ufffd7\u0016?\u0014\ufffd\ufffd\ufffd\ufffd$\ufffd\u001aK\ufffd\ufffd\u0001\ufffdDp\f\t\ufffd\ufffd<\u0006&\u07eb\ufffd\ufffdf\ufffdx ]\u00025M\u0007@\ufffdO\u001eG\ufffd\u015cH\ufffd\ufffd\ufffdJb\u0013X\u001b}\ufffd\ufffd!\ufffd\u0011ul\ufffd\ufffdy\u0012\u0001\ufffdF\ufffdh\ufffd\ufffd\ufffd(\ufffdM\ufffd\ufffd\u0017\ufffd|\u0018\ufffd\ufffd\u03e6_Ec\f,p\ufffd\ufffdl\u0010c3\ufffd y\u0019dk2\ufffd%\ufffd\ufffdgQ\ufffdWl\ufffd\ufffdLK\ufffdq\ufffd\u0433;\ufffd\ufffd\ufffd+\ufffd\ufffd\ufffd?\ufffd\ufffd\u00dcw\u001e\u07d1\ufffd\ufffd\ufffd\ufffd\u0019\ufffd\u012d\ufffd\ufffd\u001fV\ufffd2q\ufffd^&)2\ufffd\ufffd=\ufffd\ufffd\u0015\ufffd\u0006\ufffd\u001cP\ufffdBdKZ\ufffd\ufffd\u03eb2\u001d\ufffd\ufffd\u000fBCN2\ufffdU4F\ufffd\u051bh\ufffd<A/\ufffdm\ufffd\u001ezp\ufffd\ufffd\ufffd\u035f\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd|gz\u0002\ufffd\u0016#\u001f\ufffdC}\ufffd\u0002\ufffd\\y\u05d1)\u0002Dt\ufffd\ufffd8}@Ae\ufffd3\ufffd\ufffd77ur\ufffd\ufffdr#\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\\d\ufffd$.\ufffd*\ufffd&\ufffd\ufffd\ufffdD\ufffd\ufffdUm*\u0018\ufffd\u0012\u0014J\u00039g\ufffd\ufffd\ufffdc\u001f8\ufffd\ufffd7\ufffd\ufffdq\ufffd]\u001b'\u0014\ufffd8]\ufffdE]\u0017\ufffd\u0002\ufffdp\ufffd_\ufffdq\ufffd\u0004d\ufffd\ufffd\ufffd&i\ufffd\ufffd\ufffd\ufffdW\u001b\ufffdA\ufffd}^\u0005\ufffdS+\u00142\ufffd\ufffd\ufffdL\ufffd\u0019\ufffd\u016b\ufffd\u0007\ufffdF\u0019\u010dd\ufffd\ufffd\ufffdh_\ufffdyV\ufffd,\ufffd\u0018v\ufffd} \ufffd\ufffd\ufffdy\ufffd\u001c\ufffdQ`\u001c\ufffd\u0315\ufffd\ufffd\ufffd`(\ufffd`\ufffd\ufffdp\ufffdd\ufffd\r\nU\ufffdP\ufffd\ufffd.\ufffd\u000e\u0470[#zL\ufffd\ufffd\ufffd!\ufffdE\ufffdaT\ufffd\\\ufffd\ufffd\ufffd\ufffd`\ufffdy\ufffd\"mCe\ufffd\ufffd\u000fQ0Hs\ufffd\ufffd\ufffdDQ\ufffd\ufffd!\ufffd$\ufffd'\ufffd\u027a\ufffdk4\u0348\ufffdH\r\nr\ufffdl\ufffd\u0002h\ufffd&\u000f\ufffdi\ufffd\ufffd\ufffd-(!\ufffdMk\ufffd\ufffdTQ\u0017\ufffd\"G\ufffd\ufffd\r\n5A\ufffd\u0018\u000f\ufffdq;\ufffd\ufffdb\u001d\u0001\ufffd\ufffd^\ufffd\u0595\ufffd\\)\ufffd_\ufffd]3\u0012#\ufffd]\ufffd9\ufffd_\"\u00b2k\ufffd\u0011\ufffd\ufffd\u001a\ufffd\ufffd'\ufffd4\ufffd'\ufffd\ufffd\u001eBV\ufffdH\ufffd/\u0015\ufffd\ufffd\ufffd\ufffd\u0015\u0011\u078fBkCC\ufffd$\ufffd\ufffd\u001d?\ufffd\ufffd\ufffd\ufffds\ufffd\ub7c0k\ufffd\ufffdK}\u001a&%[\ufffdn\ufffd\ufffdV\ufffd\ufffd\fZ\ufffd\ufffdG(\ufffd\\\ufffd\ufffd-\ufffdJ\ufffd;%\ufffd\u001dG\u0018g\ufffd\u0019\ufffdwJ\ufffd\u0015\ufffd\u0411\ufffd\u0017\ufffdb\ufffd\ufffd\ufffd\u029a}\u0011M&\ufffd+\ufffdh:\ufffd\"\ufffd\ufffdE\ufffdL\ufffd\ufffd\u0019p\ufffdE\u06dc=\ufffd~\ufffd-M7<\ufffd\u0005\ufffdy\ufffd\ufffd*\ufffd\ufffd\u001d\ufffd\ufffd\u0471\ufffd#r\ufffd\u0012@6\ufffdAO\ufffd\ufffd_p\u0018$\r\n\ufffd\ufffd<\ufffd\r\n\ufffd\f\u0588\r\n\u0003\u0013\ufffd\ufffd7\ufffd/Ux\ufffd\ufffdxti\ufffd\ufffdF\u007fUC\ufffdH?\u001d\ufffd\ufffd4\ufffdP\r\n\ufffd\ufffd\ufffd\ufffdeZ\ufffdbA\ufffd<\u0382\ufffd\u87d5\u04e1\ufffd\u0003\r\n\ufffd\ufffdX\ufffd\ufffdu\ufffd\ufffd\u0019\u0002\ufffdd!\ufffd^@/p\ufffda\ufffd\ufffd\u0007E\ufffdG1\u051c;\ufffd\ufffd]\u0007\ufffd\u001b\u0014\ufffd=~\ufffdh\ufffd]\u051d\ufffdZA\u007f\t\ufffd\ufffd\u0019v\ufffdK\u0007\ufffd\ufffd\ufffd\u001f]<\ufffd\ufffd\u0017>I\ufffd\ufffd\ufffd\u001bI9\ufffd\u0017\ufffd\ufffd.t\ufffd\u0005\ufffd+\ufffd\u0019v\u05e1\ufffd\ufffd\ufffd\u0013h7Te\ufffd\ufffd\u0007D\ufffd\ufffdK\ufffdJ\ufffd\ufffdh\ufffdJ\ufffd\ufffdM\ufffd\ufffd\ufffd\r\n\ufffd\ufffd\ufffdD\ufffd\ufffdOo\ufffdj\u0011\ufffd\ufffd\ufffdf\ufffd'\ufffdt\ufffdd\ufffd\ufffd\ufffd\r\nm\ufffdsD\ufffd\ufffd.\ufffd0\ufffd)l\ufffd\ufffd4\u0018\ufffd\ufffdN\ufffd\ufffd@\ufffd\ufffdr\ufffdF\ufffdi\ufffd\ufffd~o\ufffdD\ufffdE\ufffd\ufffd\ufffd`m\ufffd\ufffd\ufffd\u0011\ufffd\u001br\u0186\ufffd>\ufffd8\ufffd\ufffdT\u0018\ufffd\ufffd\u0616\ufffd*\ufffd\ufffdy-wf \u001b~\ufffd\ufffdw?\ufffdZ\ufffdq+(E\ufffd\u00f97\t\ufffdP\ufffd\ufffd\ufffd\ufffde\ufffd\ufffdN\u001aa\u001d`\ufffd<\ufffd}\ufffd\ufffd\ufffd\ufffd9\ufffd\ufffd\ufffd\\^_H\ufffdf\ufffd\ufffd\ufffd.\ufffd\ufffd\ufffdx\ufffd\u0307\ufffd\ufffd*\u0019\ufffd(\u0002ip\u001b\ufffd\u001b\ufffd+\u1231,s\ufffd\ufffd5\ufffdl\ufffd\u00b4\r\ng\ufffdms\ufffd6\r\nd\ufffduV\ufffdn4\ufffd#\ufffdR(1R\ufffdn\ufffd\ufffd\ufffd\u0702E\u0356/Be\ufffdG\u0001\u056c\ufffd:^@\t(7\ufffdcxa\\6\ufffd\ufffdj\ufffd\ufffd<S\ufffd\ufffd\f\ufffdh_\ufffd>\r\n\u000e*\ufffd+\u0013\u0003u\ufffd\u02dfm\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdG\ufffd8\u0019\u001c#}\ufffd\ufffd\ufffd\ufffd\u001fPk8\ud8ba\udd0b\ufffd\u000bf\ufffd\u001d\ufffd\ufffd\ufffd\u0018\ufffd\ufffd\u0001\ufffdue\ufffd\u0014\ufffd\ufffd \u0002>\ufffd\ufffd\f\ufffd\ufffd\u0003\ufffd-\ufffd\ufffd\ufffd\u0006y\ufffd\ufffdt(\ufffdX!\ufffdOg\ufffd\r\n\ufffd\ufffd/\ufffd\ufffd\ufffd\ufffd\ufffd5\u001b\u0014\ufffd\ufffdy\ufffd\ufffd\u0013y\ufffdj\ufffdB~T\u0494V\u0014\ufffd\u0016oP\ufffdD7\u0018\ufffd\u001e\ufffd\ufffd\ufffd\u2bee\u00184N0'\ufffd;t\ufffd\ufffdT\u077b\u0011{\ufffdM\ufffd#^D\ufffd'\ufffdYA#\u0007i\ufffdb\ufffd\"/\ufffdn\ufffd\ufffd\ufffd\ufffdU91\u0015\u001e\ufffd\u0616\ufffd\ufffd\ufffdh\ufffd\ufffdd>p\ufffdO35H\ufffd\u0002\ufffd\u06d5\\\ufffdc\ufffd\u000b\ufffdR0r5\ufffd\u0012\ufffdYh\u0004\t\ufffdnKi\u0765\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u0005\ufffd\ufffd\ufffd\u0001\u0013Q\ufffd({d-\ufffdb\ufffd\ufffd\ufffd\ufffdS\ufffd\u00030\ufffd\ufffd\ufffd\ufffdP\ufffd\ufffd^\ufffd\ufffd \ufffd\u001a\ufffdM\ufffd}g\ufffd\u0005\ufffd\ufffd_d>\ufffdp'w\ufffdK]\ufffd\ufffdY\u0010R-mh\ufffd\u000e\ufffdy\ufffd I\ufffdy\ufffdn\f\ufffd\u03f1\ufffd\ufffd+X\ufffd\ufffd+DO<\ufffd\ufffdZ`Y\ufffd+\ufffdE\ufffd\u0012\ufffd\ufffd\u01cb=\ufffdy\u001c\ufffd[ \\\u011e\ufffd\ufffd\u0010\ufffd\ufffd\ufffd\ufffd8\ufffd\ufffd4 \u001eu\ufffd\ufffd8\ufffd1\ufffdZ\ufffdU\u001c\ufffd\ufffd\ufffd }!\ufffdHc\ufffdoM\ufffd\ufffd\u0005\u0011\ufffd\u001e\ufffd\ufffd:\ufffd\ufffd8Q\ufffdZ\ufffdc\u7f96\u078fD\ufffd1Q\ufffd\ufffd\u02bd\u0018\ufffdOI\ufffd}P\ufffd\u0007\ufffd\ufffdOnT\ufffd@'\ufffd\u0012\ufffd7A\ufffd\ufffdu[\ufffd\ufffd\ufffd\ufffd3\ufffd^\u000fb#Q\ufffdw\ufffd1\ufffd\ufffdF\ufffdut\u033a\u04f9\ufffd\ufffd\u001b\ufffd\ufffd=B\ufffd\ufffd\ufffd\ufffd>>\ufffds\u0006\ufffd\ufffd\u01d6-p\ufffd\ufffdq\u0405\ufffdY;\ufffd-wx&\u001e\ufffd[]\ufffd\ufffd\u0002{\ufffd\u001c\ufffd\u001b\u0005M\ufffd\ufffd\ufffd\u001c\ufffd6\ufffd\".\u000bj\ufffd'\ufffd\ufffd\r\n\ufffdS\ufffd0\ufffdj\ufffd\ufffdc\ufffd*9i\ufffdYv\ufffd\ufffd6R\u0001H\u0680V\ufffdF\u000b`/\ufffd\ufffd\ufffd\u0013\r\n\ufffd\u000b\u0015\ufffd7\ufffdB\ufffd\ufffd~V\u0003\ufffd_!\ufffd\ufffd,\ufffdX9\ufffd\ufffdi `T\ufffdd\ufffd\u001a\ufffd\u0094\ufffd\ufffd4\ufffd\ufffd\ufffd\u0004\ufffd\ufffd\ufffd0\ufffd\ufffdB\ufffd9=K0\ufffd\u0007\ufffd\\\u0465\ufffd#\ufffd\ufffd\u0018e\ufffd\ufffdM=\ufffd\ufffdK\ufffd\ufffd5\ufffd\ufffd\ufffd\u0012 \ufffd\ufffd\ufffdy\ufffd\ufffds\ufffd\u001f\ufffdh\ufffd\ufffd<\ufffd\ufffda\":\ufffd3( \ufffd+\u0012\ufffd-aE\ufffd\ufffd\u046aF\ufffd~\ufffdk\ufffd\r\n\u0007\ufffd\ufffdh\ufffd\ufffd\ufffd:'\ufffd\ufffdb*\ufffd\ufffd@l\ufffd\ufffd8\u0710\ufffd\ufffdf\ufffdA\u0005Q\t\ufffd\ufffd\ufffd\u000b\ufffd0~'6\ufffd.`\u0003\ufffd6\ufffd\ufffdDu\ufffd]\ufffdu\ufffds\ufffd\ufffd\ufffd\u0001M\ufffd\ufffdE\"2T\ufffd\ufffdK\ufffd\ufffd\u00167\ufffd\u0018\u07c5\ufffd?:\ufffd\u0006\ufffd*Q\ufffd\u0490\ufffd{\u0018\u05ab,*\ufffd8(\ufffd\ufffd\ufffdY-\ufffd{\u001c\ufffd\u0002\ufffd\ufffdma\ufffd-\ufffd\ufffd\ufffd\ufffd;8\ufffd\ufffd\u000e5\ufffd\ufffd\ufffd(q\ufffd4m\u0014\ufffdwY\ufffd\ufffd\ufffd6\ufffd\ufffdz\ufffd\ufffdD\ufffd\ufffds\ufffd\ufffdQn\u0015}\u0011A\ufffdDF~\ufffd\ufffd\ufffd(\ufffdI\u0002\u0005\ufffd\u0006da\u0016\ufffd\ufffd\ufffd\\\ufffdfj\u001a\ufffd%\u0002\ufffd7\ufffdfj\ufffd\ufffdlsn\ufffdXc\ufffd\u02e2\ufffdlNS\ufffd\u001eT\ufffd\ufffdA\u01dc6\ufffd\ufffd+\u0018\ufffd\ufffd\u0013\ufffd\ufffd~\ufffd@\u04c0]l\ufffdrk\ufffd~[\u001e}u\ufffd\ufffd?\ufffd7&\ufffdY\ufffdT\u0011\u80625\u0754\ufffd\ufffdh\f\ufffd\u0015\ufffd\ufffd\ufffd\ufffd\u007f\u0001T\ufffd\ufffd:\ufffd6H \u001b=\ufffd\ufffd)\ufffd\u0013ep{\ufffd\ufffd\ufffd/\ufffdu\fx5\ufffd5\ufffd!\ufffd\ufffdl\ufffdTL\u007f\ufffd\ufffd5\ufffdQ1\ufffd+\ufffd\u0013\ufffd\ufffd\ufffd\ufffd6+\ufffdg\ufffd\ufffd\ufffdhp\ufffd[\ufffd\ufffd6\ufffd\u000f\ufffd\u001fW\ufffd8\ufffd/Zt\ufffd\ufffd@\ufffdlA\u0556|\ufffd\u000b\ufffd~\u001f\ufffd<E\ufffd\ufffd\u0002\u0014\u000e3 -\ufffd\ufffdz2\u03f8\u02eb\ufffd\u0014\ufffd\ufffd\ufffdq\u001054\ufffd\ufffdsn\u0003\ufffd\ufffd\u001b\"\ufffd\ufffd\ufffdM\u0006g\u0013\ufffdd\ufffd\ufffd\ufffd\ufffd\u063d\ufffdu8\ufffd\ufffd\ufffdojzr\u0338S\ufffdl\ufffd\u001cz\ufffd\ufffd9\u000f\ufffd\ufffd\ufffd\ufffdA\ufffdf\ufffdC\ufffd\u0016\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd@\ufffd\ufffdaO\u0001Il\ufffd\ufffdj\ufffd\ufffd\ufffd\ufffd8\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd7\ufffd\u000b\ufffd\ufffdY5\ufffd\ufffd\u0016\u0007\ufffdJ\ufffd\u0003v>T\ufffd\ufffd\r\n\ufffd\u0018\ufffdy\u0193\ufffd\ufffd5)\ufffd:\ufffd[7\ufffd:^\u0013w\ufffd\to\ufffd\u06b6\u0003\ufffd\ufffdN\ufffd\r\nY\ufffd\u001c\ufffdi\ufffd=\ufffd\u03fdd8\ufffd;\ufffd\u0004(\ufffd\ufffd\u0019?#j 7\ufffd}\ufffd \ufffd\ufffd\u0011\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdtn] \u0014\u0013E\ufffd\ufffdZ\ufffd%\ufffd\ufffd\u000fuz\ufffd\u0017\ufffd\ufffdH\ufffd(U,jS\ufffd\u0010\u0311\ufffd\ufffdJ'\ufffd,\u042et\u001d\ufffd\ufffd\ufffd=\u01d2\ufffd\ufffd \u07dd\ufffd1:\ufffdR\u0016\u001e\ufffd\ufffd\ufffd\ufffdoY\ufffd\ufffd\u001c]1clMjg\ufffd?   \ufffd\ufffd\r\n1ffa\r\n\ufffd\ufffd\ufffd\ufffd\u0018k\ufffd\ufffd\ufffd\ufffd\ufffdlE'\ufffd\ufffd\ufffdg\ufffd\u0006\ufffd\ufffd*\ufffde\ufffd\ufffd\ufffd\ufffd\ufffdt\ufffd\ufffd\u011f\ufffdM\ufffd\ufffdR\ufffdg X\ufffd\u073ee6\ufffd([\ufffd\u0006\u0019\ufffdW\u021b\ufffd\ufffd\u0189w\ufffd\ufffd\u001d\ufffd\u0018\ub42f)\ufffd\ufffd\ufffd\ufffdh\ufffd\ufffd4\ufffd\ufffd>\u0005\u000e8\ufffd\r\nWv6\ufffdbnsn\ufffd\u000f\u0011\ufffd\u00122\ufffd\ufffdpWh\ufffd\u000eTC\u0014d\ufffdj\ufffdr\ufffd?\ufffdW1'h\u000f~\u000f\u0003\ufffd?\ufffdv\u02c9\u0017D\ufffd\ufffd\ufffd\ufffdH\ufffd\ufffd\ufffd\ufffd&\\\ufffd4t\u0002\u0002\u0013}ak\ufffd0\ufffdV\ufffd\ufffdo\u0005X\ufffd\ufffd!>\u0017\ufffd\u0018\ufffd\ufffd\u0002.me\u01202\ufffdm\u001dv~\u001bn\ufffd\u01f5\ufffdT\ufffd\ufffd\u0018DQ\u001e\ufffd.6\ufffd\u0014<e\u001d=\ufffd@\ufffd\ufffd\ufffd @\tC\ufffd\ufc36\ufffd\ufffd\u0014\u0015\ufffd)\ufffd\ufffd\ufffdeNx\ufffdh\ufffd\ufffd\ufffd\ufffd\\\ufffd\u007fF\u0004\ufffd\u0004m\ufffd$\ufffd\r\n\t\ufffd\u000e\ufffd8H@U\u06e2N\ufffd\u03a5u\ufffd!+\ufffd\u481dR\ufffd\ufffd$\"\ufffdo~GJ\ufffd\ufffd\ufffd\ufffdP\u0010\ufffd\u0002\u001c\u000b#Wq\u0005\ufffd{\t\ufffd\ufffdy\ufffd\ufffd\ufffd\u0011 \ufffdj\ufffd|h\ufffd3\ufffd\ufffd\u0012\ufffdh\ufffd\ufffd\ufffd\ufffd`\u001e)W\ufffd<\ufffd\ufffd\t\ufffdP,j\ufffd\ufffdw!=\ufffdGW\u0011\ufffd\ufffdJ\u0006\ufffd\u000f\u000b\ufffd\ufffd\ufffd&8\ufffd\ufffdlXm\ufffd\u0006\ufffdS\ufffdXsJ\u0002\ufffdtf\ufffd+\ufffdU\ufffd\ufffd'N<!/0\ufffd:\ufffd\u000b\ufffd/\ufffd U\ufffd\ufffdW\ufffdp\ufffd\ufffd\ufffd\ufffd\u000b\u0003\r\n\ufffdXgZ\ufffd\ufffdsU\u0013\ufffd\ufffd]{\ufffdi\ufffdz\ufffd\ufffd\u000eu\ufffd\f\ufffd2k!`\u0004\ufffd\r\n\ufffd\\\ufffdXh\ufffd\ufffdj9<\ufffd\u0006(\ufffd\"f.\ufffdv\ufffd\ufffd\ufffd\ufffd\ufffd\u0003\ufffd\ufffd\ufffdx\u0014\ufffd@\u0013Wn7\u07fa\")\u0019\ufffdy^\ufffd^\u2604\u064d,\ufffd\u0004\ufffd\u0004v&5\ufffd\fxB\ufffd\r\n\ufffd\ufffd\u0002;m-|\ufffdu\u0002a\ufffd\f\ufffd\ufffdc\u070a\u0004\ufffd\ufffd@\r\ntD\ufffd'b\ufffd\ufffdI\ufffd\ufffd+q\ufffdSe\u001a9\u001e\ufffd\u0006g\ufffd\u0012\ufffd\u01c4\u000f$\ufffd,\ufffd(\u000b\ufffd\r\nO\ufffd\u0681\ufffd\f\ufffdc\u000eq\ufffd\ufffdm^*\u03b0\ufffd\ufffd\ufffd\u0016\u0012\u0018(\ufffd,\u0002\ufffd\u0018\ufffd\ufffd\u000b\u000f\ufffdm;\ufffdc\t1\ufffd'\u001aX~\u00de\u0010\ufffd\ufffd\ufffd\ufffd\ufffdt4\ufffdl\ufffdZ\ufffd\\\ufffd\u001e\ufffdR\ufffd\ufffdrFv\ufffd\ufffd\ufffdx\ufffd\u00018\ufffd\ufffdCB\ufffd\ufffdT\u0004\ufffd\ufffd4b\ufffd\ufffd\u001eO\ufffd\ufffd\\\u001aV\ufffd\ufffd$\u007fI\ufffd\u03973\ufffd\ufffd\ufffd\u0012-\ufffd\ufffd:\u007fA\u0015#\ufffd=\ufffdd\u001e\ufffd\ufffd\u00012\ufffd\ufffd0\ufffdVX\u0016\ufffdI\ufffd\ufffdQ\ufffd\ufffd\u0006\u001b\ufffd+s\ufffdm\ufffd\ufffdXh\u075a\ufffdc\ufffd\ufffd\ufffdUY.\ufffd\ufffdqA#\ufffd\ufffd\u001d\ufffd7\u001bj`%_mwt\u000b\ufffdY\ufffd>\u0010R\ufffdz9\ufffdgl\ufffd\u06b2BX\ufffd\ufffd\ufffd0fH5\ufffdB\u0019!E\u074fE\ufffdFc,(\ufffd\ufffd\u000b\u001c\u0018#J[\ufffdO\ufffdD\ufffd=\t|x\ufffd9\ufffd?N\ufffd9\u00149\ufffd\u02c5\ufffdE\u056a/R\ufffdL\u001c\u0015\ufffd\ufffd\u000b\ufffd\ufffdTU\ufffdY\ufffd\u0012\ufffdBe \ufffdsxm\ufffd\ufffd\ufffd`\u001b\u0245\ufffd<\ufffd_F\ufffd\u0016m\ufffd\ufffd=PN\ufffd\ufffd:LP\ufffd\ufffd\ufffd.\ufffd\ufffd1\ufffd}\ufffdK\ufffd\f/\ufffd\u0379Fw\ufffdH\u0010 Gp[H%\ufffdK\ufffd#\u001b\ufffd\ufffd\ufffd}\ufffd'AgZ\ufffd\ufffd7&q\ufffd\ufffd%\ufffd\ufffd\u0010Z3l=\ufffd \ufffd\u0010\"\ufffdX8\u0015\\a7\u0016q0\ufffd\u001f\u0019\ufffd\u0001\ufffd>\ufffd\u0001\ufffdG\u04a8\ufffd\u0539l\u0012Ek\ufffd\ufffdcj\ufffd|\ufffd6\ufffd\ufffd\ufffd\ufffd\u0015\u0479\u025b\ufffd\ufffdk\ufffd<\ufffdU\ufffd<!\ufffdl6X\ufffdL\ufffd\u0006\ufffdz\ufffd\u001b\ufffd\u000b\ufffd\u0018We\ufffd\ufffdtVV}l\ufffdD\u0016\ufffdE\ufffd\u001c\u0013H\ufffd\ufffdB\ufffd\u0006[\t\ufffdw\ufffd3\ufffd\ufffd\r\n\ufffd8\ufffdB\u0014\ufffd\ufffd\ufffd\ufffd\ufffdsJ\ufffd4\"\ufffdkR\ufffd1\u000e\ufffd\ufffdc\ufffdO%\ufffd\\+\ufffd\ufffd~\ufffd\ufffd`]\ufffd\u0012\u0019\u0003\ufffdW\u001a\ufffd\ufffd\ufffd\ufffd\u0003\ufffdW\ufffd_2\u0001z\u0016\ufffd\ufffd\\\ufffd\ufffd>\ufffdm\ufffd\ufffd\ufffd9'\ufffd\ufffd\ufffdV\ufffd\ufffd1Ac\u0005@\ufffdX\ufffdy\ufffdp\ufffd\u0004\ufffd\ufffd\ufffd\u0013\td\ufffdd\ufffd\ufffd\ufffdi\u001a\ufffd\ufffd\ufffd\ufffdBh\ufffd\u0003\u057c]\ufffd:\u000e\ufffd\r\n&\ufffd%\ufffd&\ufffd)\\]T\ufffd:\ufffd\ufffd\ufffdT\ufffd\ufffd\ufffdI\ufffd(AN\tb\u035c9-E`\ufffdK\r\n'8\ufffd\ufffd H\ufffd\ufffd\ufffd#{\r\n\ufffd\ufffdw\ufffd\ufffd\ufffd\ufffdu\ufffdw\ufffd\u001a\u0007 >U`\ufffd\u07bbR*\u0011GH\ufffd\ufffd\ufffd\ufffdt4\u0011\ufffd\r\n\ufffd\ufffd^\ufffd\u0016\ufffd\ufffdV\ufffd\\\ufffd\ufffdn'\ufffdF\ufffdA\ufffd\u0013[T\ufffd\ufffd.\u6f43\u0011\u0001\ufffd\u0092\ufffdvI.\ufffdB\ufffd\ufffdv\ufffd\ufffd{\ufffd\ufffd\ufffd\ufffd\u0015\ufffd&E@\ufffd0r\ufffdQ\ufffd+\ufffd\ufffdA\ufffd\ufffd=}-L\ufffd&\u0012\ufffd\ufffd\ufffd\u0016\ufffdR3\ufffd\u0002O\ufffdazY\ufffdf\ufffd\ufffd\u001cn^\ufffdY\ufffd\u001a.\ufffd\fL\ufffd\ufffd\ufffd\ufffd\u007f\ufffd\ufffd?-\ufffd\ufffd\"Km\u0465k6|\ufffd-\u0004\u0018\u0004D\ufffdE\u0002\ufffd\ufffd\u01fb \ufffdn\u0014'=\ufffdV\ufffd\ufffdPt\u0016\ufffd\ufffd\ufffdr\ufffdPv`\ufffd\ufffdk.H\ufffdBh2\ufffd\r\n[\ufffdY\u0663\ufffd\u007fh\ufffd%\u4fa5#\ufffd\ufffd\ufffdb\ufffd8\ufffd\ufffdB\ufffd\ufffd%M\ufffd\u0003\ufffdY\ufffd\ufffd0~#!\ufffd\ufffd\u045d\ufffdBNs!yh\ufffd:\ufffd;==;}\ufffd\ufffd\u075b\u04f7o|\ufffd\ufffd\ufffdY\ufffd\u0005E \u0740\r\nb\ufffd I\u06d7\ufffdd\ufffdl\ufffdK\ufffd\ufffd\ufffd\u0357.\u01f3\ufffd\u0013\"\\\u0002/\u0014\u0516\ufffdN\ufffd\u0018`\ufffd\ufffdI\u0018\u0018\ufffdq\ufffd\u0019\u001d\ufffd\ufffd]\ufffd(z\ufffd\ufffd\u0383o\u0017\u0013Wh\u0005\u001dK\ufffd\ufffd\ufffd[y\ufffd9l\u0002Fj\ufffd\ufffd\u000f\ufffd\ufffd\u0001^T\ufffd*\u0007<\ufffd\ufffd\ufffd\u0005\ufffdT\ufffd\ufffdl\ufffd;\ufffdK\ufffd/\u001cm\ufffd\ufffd8\ufffd\ufffd\ufffd\u04a8\ufffd@\ufffd\ufffdk8J\ufffd!\ufffd\u0218\u0004!\u0007\ufffd\ufffdn\ufffdT\ufffd\ufffd%\ufffd\u0013\ufffdT\u0007\ufffd\ufffd\ufffd\u0004\ufffd(\ufffdr\ufffd|S\ufffd\u0016E\ufffdr\u00c1z\u0013\u001c-\ufffd\ufffd\u0016:}\ufffd\ufffd@\ufffd\ufffd\ufffd}\ufffdj{D\ufffd\u0002\ufffd\ufffd\ufffdD\ufffd\ufffdZ\u0002\r\nM,]\ufffdJ\ufffd\ufffd\u001a\ufffd\ufffdg6\ufffd_(\ufffd\ufffd\ufffd\ufffd\ufffd\u0013<$\ufffdR\ufffd\u0011\u0005\u01fa*<\ufffd0[\ufffdi+0v\ufffd\ufffd0\u058bL\teSj\ufffdZAW\ufffd\ufffd\ufffdu\ufffd\ufffdE.\ufffd^\ufffd2\u0708\u0011\ufffd\ufffd\u05e4Tk\u0016\u067e4e\ufffd\u001b\u0001:Wl\ufffd\u001d\ufffd$Y\ufffd\u04a9HS\ufffd\ufffd\ufffd\ufffd\f-\ufffd4\ufffd\ufffdO\ufffd9\ufffdN`\ufffdG6W@h\ufffdSP\u0015I_e\ufffde\ufffd\u0014\ufffd\ufffd%\ufffd1t\ufffd:\ufffd\f\ufffd\u000b\ufffd\u0004]\ufffdK\ufffd\ufffd\ufffd \ufffd\ufffd\r\n\ufffda\u03e5h\ufffda\tK[\ufffd\ufffd/\ufffdH)r)R\ufffd]\ufffd\ufffdK\ufffd\ufffd\ufffdL\ufffdb\u001f\ufffd\ufffd4\ufffd\ufffdb\ufffd\u0528\ufffdZ\u007f\ufffd \ufffd*ry\ufffd\ufffd_i\ufffd\ufffdh}\u0016\ufffd\u001cc\ufffd\u0006\u3493\ufffd)\u0014G\u0715v;h\ufffd\u00043\ufffdY\ufffd\ufffdW\ufffd*\ufffdh&\u0016\ufffd\ufffd\ufffd\u000bl\ufffdY\u0015j\ufffdR\ufffd\ufffd-\fU\u0011\ufffdoW\ufffd\ufffd4y\ufffd?`.\u0017\ufffd\u054f}\u0014\ufffd\ufffdn\ufffdf%\ufffd5\ufffd\ufffda\ufffdc\udbf7\udc5bg Y\ufffd\ufffd8\ufffdx\ufffd\u001e\ufffd\u06f0\r\n\ufffdJ,\ufffdXdl\r\n\ufffdC\ufffd\u0017\u0003\u001f\ufffd\u06e7^iXg\ufffd\ufffd\ufffd\"@x\u902aSz\ufffddF\ufffd\ufffd\ufffd%]9\ufffdJ\ufffd\ufffd\ufffd9aB\ufffd\ufffd\ufffd\u0622\ufffd)\ufffdN0O\ufffd\u001a\u0018Z+\ufffdCd\ufffd\ufffd\ufffd\ufffd\ufffdNT\ufffd6\ufffdp\ufffdN\ufffd\u0004\ufffd\ufffdP\u001a\ufffd\ufffd\ufffd\ufffd\ufffd\u0011\ufffd,\ufffd\ufffd\u065c?\ufffd\ufffd\ufffd;\ufffd\ufffdl\ufffd\ufffd\ufffd\ufffd^\u0003/,TE\ufffd\ufffd[kX\u029a\u0001\ufffdp\u0016p\ufffdIS\ufffdP\u00028R\ufffdT\ufffd\ufffd l\u0012c\\\ufffd\ufffd|\u04e4\ufffd\ufffd5.we+\u0002\u0016v/Z\r\n\ufffd-\ufffd\ufffdvH\ufffd0\u007fGRDESg%`\ufffd\ufffdqx\ufffd^N\ufffd\u0002\ufffd|aT\u0004\ufffdn\ufffd\ufffdJr ;Y=V\ufffd\u00137\ufffdk\ufffd\ufffd(B\ufffd [\ufffd \ufffdU\u001d7x\ufffd\u000e!\ufffd \ufffd\u0001\ufffdF\ufffd\\q\ufffdP+\ufffd\ufffd\u0017\ufffd\u0010\ufffd\ufffd\u0002N\ufffd`8w_P\ufffd\ufffd\ufffd\ufffd\ufffd4\u001c=c,\ufffd\ufffd9\ufffd\"O'\ufffd\u000e\ufffdw\ufffd\ufffdpJp`t.+\ufffdR\ufffd\ufffd\u007f;E\ufffdP\t\ufffd\u01f3t\ufffd\ufffdFX\ufffd\ufffd\ufffd\ufffd4iQ8\u07dd\uc151=\ufffd`Q\ufffdT7bV0{\u0003y\u0141\ufffd\ufffdH.\ufffd\ufffdx\ufffd\u0006\ufffd\ufffdTtn\ufffd\ufffd\u012c6\ufffdM}M\u0405\u0010y8\u0012\ufffds\ufffd\ufffd\ufffd\ufffd\ufffdb\ufffd\ufffd\u00a9\ufffd\u01d8\ufffdd\t\ufffd2\ufffdl\ufffd\ufffd\ufffd]\ufffdE\u001c\ufffd\ufffd\ufffd\ufffdp_\ufffd\ufffd\ufffd \u0014-\ufffdXz\u007f#\u5b701\u000b\ufffd|\ufffd\ufffd\ufffd\ufffd\ufffd5A\u0010@\ufffd\ufffd:l&G\ufffdw.\ufffd\ufffd\u007fu\ufffdwE%\ufffdj\ufffd\u4036N9z\u000e<\u000e!1\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd_\ufffd\ufffd\u0275\ufffdj\u07fb\ufffd\u00107\ufffd\ufffd\"\u001c\ufffd=U\u001d\ufffdY\ufffd\ufffd\ufffdD/\ufffd`\ufffd\ufffd*\r\n\ufffd\ufffdH \ufffd\u075a\ufffd\ufffd\u001c\ufffd0\ufffd0\ufffd\u001a\ufffd\ufffd\u001cT)&R\ufffdV\ufffd@\ufffd\ufffd\r\nZP\ufffdct\ufffdY`\ufffd\ufffdf\ufffd)\ufffd\ufffd^\ufffdK\ufffd<\ufffd\ufffd\ufffd\u0004\ufffd:\ufffd\u001a\ufffd\ufffd\ufffd4\ufffd\u076dl\ufffd\ufffdh\ufffd\ufffd\ufffd\u0017\u05ea\ufffd\ufffd|\ufffd\ufffd\u0017sBy\t\ufffdKl}\ufffd\\`\ufffd}\r\n\teD\ufffdEU\ufffd\ufffd(\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdH \ufffd\ufffd\u0019\u000f\u000f\ufffd6>\ufffd\"WhFS\ufffd\u0012!\ufffd\ufffdq\ufffdr\ufffd\ufffd\u0306\ufffd\ufffd=E\ufffd\ufffd\u0013\u0017\ufffdA\u000e\ufffdI\ufffd\ufffdr\"5\ufffd\ufffdWwf#{\ufffdj\ufffd\ufffd\u0016a\u0018)k\ufffd;\ufffdy\ufffd\ufffd\\,\ufffd;/\ufffd\u0769\"i\ufffd\ufffd\ufffdZ\ufffdR\u0001\u001cG\ufffd\ufffd0\ufffd\u001cdP\ufffd\u0002o\ufffd\u001bq\ufffd\ufffd\ufffd%6\u0005AG$\u0007l\ufffd\r\n\ufffd\ufffd\u0191\ufffd\ufffd\u001f\ufffd\ufffdP\ufffd\ufffd\ufffd>U Q\ufffd\ufffd\ufffd\u0006\u0017\ufffd/\ufffdn\ufffd|\u000f\ufffd,j\u001eP\ufffdT\u0004\ufffd5k\ufffd\u015b\u000e'<\ufffd^\u0002-\ufffd\u0018-\ufffd\u0003\ufffd\ufffd\ufffd\ufffds^F \ufffd\u00ee\u0275\u0014m\ufffd\ufffd\ufffd\u007f\ufffd\u0002\ufffd\ufffd\u0002\ufffd\ufffd2\ufffd\ufffdTK2\ufffd!\ufffd\ufffdq\f\u0673\ufffd\u0004\ufffd)\u0013\ufffdJ\u0019Bm\ufffd\ufffd\ufffd\ufffd \ufffdD\ufffdZ\ufffd;\ufffd-\ufffd\ufffd\u0012\ufffd\ufffd$w^\ufffd\ufffd\u001cF\\\ufffd\ufffd\ufffdQ\ufffd\u0012\ufffd\ufffdaQ/D*\ufffd\ufffd*\ufffd%\ufffd\ufffd\u0019TY\ufffd(\ufffd\ufffdP\u000fr\ufffd ]\u05b6\ufffdE^\u01a2m\ufffd<\ufffd\ufffdj\ufffd\ufffd#\ufffd\ufffd\u0013\ufffd\ufffd\ufffdUt\u0012K\ufffd\u0014\u001c\ufffd6\u0017!\ufffd\ufffd%\u0014u\ufffd\ufffd-\ufffd\u0018&\ufffd\u0002\ufffd\ufffdy\ufffd\u0004\ufffd\u0005\ufffdx\ufffd\u0017\ufffd\ufffd\ufffdC\ufffd\uf132\ufffd\ufffd\ufffdN\u001b\u001f\ufffd\ufffd\ufffd\ufffd\u0011\ufffd\u0017qB\ufffd-\ufffdt\u03a5\ufffd\ufffdg<#L\ufffd8\ufffd\ufffd <\ufffd\ufffd\u02cer\u07e6\ufffd<4i`\ufffdW\f\ufffd\u001c\ufffd;\ufffd|\u001d\ufffd*V\ufffd\ufffd0\ufffd\u000b\ufffd\ufffd\u0202ts/@\ufffdkthx\ufffd\ufffd\ufffd \ufffdk\ufffd\ufffdE\u011a\u028el\ufffd\u0005zOA\ufffd\ufffd\ufffd\ufffd#[\ufffdX\ufffdpQ\ufffd\u00071\ufffd\ufffd\ufffd!\ufffd\ufffd\u0003\ufffd\ufffd\ufffd^\ufffd\ufffd\ufffdTD\ufffd\u001a\ufffd!Y\u0018\ufffd\u007f\u000e\u0015\u0011\ufffd\u0015n]I\ufffd\ufffdz*\ufffdEj\ufffd<\ufffd\"\ufffdW\ufffd\u0012'&\u016dD\ufffd\tF\u0007\ufffd\ufffd<\u0410M\ufffd\f\u0776\ufffd\ufffd/\ufffd\u0015\ufffdMA\ufffd).\ufffdB\ufffd\ufffd\ufffd\ufffdF\ufffd\ufffdvK\u0006\u0002\ufffd;\ufffd\r\n\u001c\ufffd\ufffd+s\ufffd\r\n<U\ufffd\ufffd\ufffd&n\u0012\u0574<\ufffd\u0001(\ufffd\ufffd\ufffd\u036dh\u040d\ufffd\u0019<\u000f\u00022\ufffd\ufffdL\u0005\ufffd\ufffd\ufffdsW\ufffd\u0278\ufffd[\ufffd\ufffd\u000b\ufffd\ufffdxB\ufffd\u041bK\ufffd\r\n\ufffd0J1\u0013$]b;\ufffd\u6f91\ufffd`&\ufffdn:F\u0634\ufffd\ufffd\u001e\t\ufffd\ufffd=\ufffd*]a\ufffd1\ufffd\ufffd:\f\ufffd\u000b\ufffd\ufffdn\ufffd0O)\u0006\u0010Qk\ufffd\ufffda\ufffd\u0003\ufffd\ufffd\ufffd\ufffdn,:\ufffdb$\ufffd\ufffdL\ufffd-\ufffd\u06af\u0014\ufffdQk\ufffd\u0014\ufffd\u0003H\u001b\ufffd\u0010\ufffd\u000fU\ufffd\ufffdU\ufffd8@\ufffd\u001a\ufffdz\ufffd^\ufffd,'\ufffd\t\ufffd\u001a\ufffdk@\ufffd4\u001a\r\n\ufffdaU\u9da0\u0557\ufffd\ufffdt\u0797\ufffd\u0002\ufffd\ufffdD\ufffd30\ufffd\ufffd!\ufffd\u0472\ua08b#\ufffd)\u0019\ufffd\ufffd\ufffd\u0005@\u0011(t.\ufffdAK\u007f\u0014\ufffd\u0017\ufffd\u0015w\ufffd\ufffd\ufffd\ufffd5\ufffd\ufffd\u001chE\ufffdy[c\u0019W3q,Rd-\u000f\u007f\ufffdx\ufffd\ufffd3\ufffd\ufffd\ufffdw\u0011f\ufffd1U%\ufffd\ufffd\ufffdc\u0002\ufffd\u000b\ufffd\r\n\\\ufffdK\ufffd\ufffd\ufffdq\ufffdH\ufffdh\ufffdOJG(\u00013\uc4de\ufffdq\ufffd\u0002x\ufffd\u0010\ufffd\ufffd\ufffdh\ufffdd\u0013\ufffd7\u007f\u0011\"\ufffd\u0374\ufffdE_\ufffdj\ufffdO`5\u0011e\u000fAz\u07be jdZZ\ufffd\ufffd\u0013.8Y,\ufffdC.\ufffd\ufffd\ufffd@\ufffd\ufffdx\\\ufffd\ufffdx\ufffdQ.\ufffd\ufffdI/\u05faR\u000f76\ufffd\ufffd<$JOUf\ufffd\ufffd=\u023a.\ufffd\ufffd\u0004\ufffdm\ufffd{\ufffd*\ufffd9\u009c\u001b\ufffd\ufffdN?\ufffd5\"\ufffdI\ufffd#0C\ufffd\ufffdC\"\t\u001a\ufffd\ufffd(\ufffd\"\ufffd\u0011\ufffd\u0006q\ufffd`\ufffdc$\ufffd\ufffd\u001dD.,\ufffd\u0011y\r\nb\ufffd4\ufffd\ufffd\ufffd\"\"\r\n\ufffdB\u00e5P\u001a)\u0002\ufffdP$u#\ufffd'O\ufffd<5J\ufffd:z\ufffdQ]\ufffd\u0013=\ufffd<E\ufffdh\u0004\ufffd\ufffd\ufffd\ufffd\ufffd\u02752?\ufffd\ufffd\ufffd\ufffd(\ufffd\u05f0\ufffd\ufffd\u0014f(C\ufffd\ufffd\ufffd\u0014\ufffd:\u0012M&aIRj\u02b9y\ufffd\ufffd\ufffdD\ufffd\ufffdo\ufffdD\ufffd\ufffd\ufffd\ufffd\u007f[\ufffd\ufffd\ufffd\ufffdj\ufffd7\ufffd`\ufffd2\ufffdon\u0355\ufffd\ufffd\ufffd\u0004\u00c7\u067d\ufffd8\u07de\ufffd\ufffdT\ufffdB\u0004uff\u0006i\ufffd\u07901z\ufffd@\ufffd$\ufffdOI\ufffd\ufffd\ufffd\ufffd\ufffd\u0004\ufffdG\ufffdk\ufffd\ufffdT\ufffd\ufffd\u001dd'\ufffdI\ufffdNI\ufffdC\ufffd\ufffd\ufffd\ufffd\ufffdx#\ufffd^=`\ufffdX\ufffd5R6\ufffdf?\ufffd\ufffd\ufffd!\ufffdkF\ufffd\ufffdJ,3\ufffda\ufffd\u001e\ufffd\ufffd\u683ax\ufffdK\u0710=D;P\ufffd\ufffd\ufffdH\ufffd|\ufffd\ufffd\u0015$\r\n\ufffdcF3\ufffd\u0010A\\'\ufffd\ufffd\u000b\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdx<\ufffd\ufffd\u001f\u000b\ufffdy\u001b\ufffd\ufffd\ufffd$ZmX:+\ufffdQb\ufffd\ufffd\ufffd\ufffd\ufffd\u0012\ufffd\ufffd\ufffd\u0001\ufffd/1\u01d9\ufffd\ufffd\ufffdZKabFT.\u0004\u0962\\\ufffd\ufffd\ufffd;\u0019k\ufffd\ufffd_\ufffdB\ufffd\ufffd%\ufffd5R\ufffd\ufffdJ\ufffd\u0005_I1\u0002\ufffd\u0015\u0012F\ufffd\ufffd\ufffd\u000b3B\ufffd9\ufffd\u0011\ufffd\ufffd\ufffd\u0012>y\u0006\u0004&\ufffd\ufffdi\u0004k\ufffd\ufffdF\ufffd\ufffd\u0007x\ufffdW\ufffd\u000b\ufffd??\ufffd\ufffd\ufffd\ufffdx\f\ufffd{@H\u0003y\u001bO\ufffd\ufffdoN\ufffd\ufffd\ufffd\r\n\ufffd\ufffd\ufffd\u001br\u27d4\u00108\ufffd\ufffd p\ufffd&^\u0013\ufffdk\\\ufffd\ufffd\u0015\ufffd\u00046\u0007\ufffd\u0012\\A\ufffd3\u0002\ufffd\ufffd\ufffdf\ufffd\u0019\u000b0\ufffd'\ufffd\ufffd\ufffdV\ufffd\ufffd\ufffd\ufffd\u0007\ufffdI?\ufffd\ufffd\ufffd {\ufffd?s4o\u0004\u001b\u0017\ufffd\u066a\ufffd\u068dsq\ufffdk:\ufffd7\ufffdl\ufffd#\u007fB\ufffd\ufffd\ufffd=%c4\ufffd\ufffdw\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdS\ufffd\ufffd\u0004\ufffdH\ufffd>!\ufffdc?\ufffdY\ufffd\u0018\ufffdY&If\ufffd5\ufffde\ufffd\ufffd\u0012\ufffd+F\u0010Nq\u0005\ufffd\ufffd\u007f\ufffd\ufffd:\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdJ\ufffd*~\u04ab,<\ufffd\ufffd\u000b'\u0018\ufffdo\u001d@c\ufffd\ufffd\t\u0006\ufffd_\ufffd\u0014\ufffdY\ufffd\ufffd*\ufffd~\ufffd\\qF\ufffd'\ufffd\u001e\ufffd\ufffdt\r\nO\ufffdbD$\ufffd5\ufffd$\ufffd\ufffd\ufffd\ufffd\u001a\ufffd\ufffd\ufffdn\ufffd\ufffdD0!\u001f\"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u007f\ufffdu\u001b\u0004\u06921\ufffd\u001a2\u0004\u02b9R)\ufffd\ufffd\u001d\ufffd\u001c\u007f\ufffd\u0015\ufffd\u0004\ufffd\u0678\ufffd&\ufffd\t\ufffd\u001d\ufffd&\u001f\u001e\ufffd\u0006\ufffdg\ufffd\ufffd\ufffd\u001c\ufffdA\r\n\ufffd\ufffd\ufffd\ufffd3\ufffd\ufffd\ufffd\ufffd\ufffdd\ufffd\ufffd\ufffd\ufffdrL!!4A\ufffd\ufffd)\ufffd$\ufffd\ufffd\ufffds\ufffdRY\ufffd|&::\u001c\ufffd\ufffd\ufffd\ufffd\ufffd^kw\ufffdD\ufffd\ufffd\u000b\ufffd/\ufffd\ufffdP\ufffd\u001c\u0016g^\u001c\u001e:7\u0016*\u0017R\ufffd`\ufffd\ufffdA\ufffd\ufffd\ufffda\ufffd\ufffd\u001eQN%\ufffd\ufffd2]\u0670\ufffd\u0017\ufffd\u0014\ufffd.\ufffd\ufffd\u0013+\ufffd\ufffd\ufffd\ufffdr\ufffd\ufffd\ufffd\ufffd\ufffdN\ufffd\ufffd[\u000eR\\Q]?\ufffd0\ufffd3\ufffd\ufffdj\ufffd@\ufffdV`~\ufffd \ufffd\ufffd\u0010\ufffd\u0002\u065c\u0019\ufffd\ufffd(W\u0015\ufffd\ufffda\u0011p\ufffd\ufffd@n\r\n\ufffd}A\ufffd \ufffd\ufffd\f\ufffd\ufffd\ufffd\u00dcM\ufffd\ufffd\ufffd4\ufffd\ufffd\ufffd\u000e\ufffd\u0460\u05b93\ufffd\ufffd\ufffdHM\ufffd^\ufffds\ufffdH\ufffd\ufffd\r\n\ufffdy\u015d\ufffd\ufffd\ufffdp\fn\ufffd\ufffda\ufffdH\u001c\ufffd\ufffd\u0002\ufffdRa\ufffd\ufffdt}q\ufffd\ufffd\\\ufffd\ufffdU\ufffd-\u001e\u1e5b\ufffd%/\u0016\u04d8Q\ufffdI\\\ufffd\u07f9\ufffdg\ufffd\u6eb4/D\ufffd\ufffd \ufffdeD\ufffdA\ufffd\ufffd\t\ufffd\\\ufffd\\h\ufffd\ufffdR\r\no^\ufffd=\ufffd\u007f\ufffd\ufffd\ufffd\ufffd+\ufffd\ufffd\ufffdl\ufffd\u0019/]\ufffd\u0015\ufffd\ufffd\ufffd\ufffd\u064d\\kK\u001eC.\ufffd}\ufffdc\ufffd\ufffd?\ufffd;\ufffd\u0019\ufffd\u0017\u001f\ufffd\ufffd\u0209'*\ufffd\ufffd,\ufffd\ufffd\u001df\ufffd\ufffdm2\ufffdT#<\u001c\ufffdD[\ufffd\ufffd\ufffd'\ufffd\ufffd\ufffd\ufffd\ufffd~\ufffd\u014f\ufffdjq\u0003\ufffd\ufffd9\ufffd\ufffdo\ufffd $\ufffd\ufffd,\ufffd\ufffd\ufffd\u079c\ufffd\u0286\u0004\ufffd-P52\u019b\u062d\u001c\ufffd\u000e|\ufffdk\u0010[\r\n9e5\r\nK\f\ufffd\ufffd\ufffd=\ufffd\u0014\ufffdc#\ufffd\r\ni\u00068\ufffd\u0016\ufffd\ufffd\r\n\ufffd\ufffdC\ufffd\ufffda\ufffd)\ufffdq\ufffd)\ufffd\r\n\ufffd\ufffd\u0003(\u0001H\ufffd\ufffd\ufffd\u001ag`$\ufffdI\f\ufffd\ufffd1V\ufffd\ufffd\ufffdH4N\u01b0\ufffd\u0003\ufffd\u001d)\ufffdh\fE\u07baJy\ufffd\u001c\ufffd\ufffd\ufffd\u001b\ufffd\ufffd\ufffdjA[\ufffd\ufffd\f\ufffd4\ufffdr\ufffd(\u001c8\ufffd\ufffd\ufffd\ufffda\ufffd~\t\u000e\u0005\ufffd)zI\u001a,\ufffd\ufffd_<\ufffdww\ufffd\ufffd\ufffdP\ufffdU\ufffd+\ufffda\ufffd%\u0248\ufffd\ufffdS,\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd?{>\ufffd\ufffdo\ufffd\ufffd\ufffd_\ufffd\ufffd\ufffd\u0002:0\ufffd\u03ac\ufffd\ufffd\ufffd\ufffd*y.$\u0019\u000bi\ufffd\ufffdW\u02f3\ufffd\ufffd\ufffd+\ufffd\ufffd%\u06b3\u00194fN\ufffd~EM\u00014.\u0014\ufffd\u001aua\ufffdL\u0372\u0010P\u0007\ufffd\u037ciV\ufffd\ufffd\ufffd\u0002U\ufffd\ufffd\u0016\ufffd\ufffd8\ufffd\u001cd\ufffd\ufffdVB)\r\nq\u0004\ufffd\ufffd\\\ufffd\u001b\ufffd\u0004 \ufffds\ufffd\u001c#\ufffdA\ufffd=DCzA\u04b9\ufffdJ(\r\n\ufffdW\u0004=\u06ef\u0002\ufffdg;\ufffd\ufffd\ufffd8:\ufffda\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u0007\ufffd\ufffdz\u0018\ufffdl<\ufffd\ufffd+\u000f\ufffdfu\ufffd\ufffd\ufffd\u000b\ufffd\ufffd\u0017\ufffd\ufffd`z\ufffd\u9396\ufffd\ufffd\u0014\ufffd6\ufffdx\ufffd/\u0016B\ufffdo<\ufffdV\ufffdgs\ufffd?hv\u001d\ufffd\u0007m}i<p\u04c5\u001b`\ufffdL\ufffd\ufffd\ufffdu\ufffd\ufffd\u0001\ufffd\u000e\ufffd2\u0007\ufffd\ufffd\r\n\u0014\ufffdh\u0013\ufffd\ufffd\ufffd\u001eb\ufffd\ufffd\ufffds\u0003NR\ufffdT\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd6\u001d\u0004\r\n6\ufffd\ufffd\u072a\ufffdO\ufffdju\ufffd{cvw\u007f\ufffdU\ufffd\u0011&\ufffdV\ufffdxs\ufffd\ufffd\u00be\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u000f?y\ufffd\u0016Y\u01bc\ufffdRa\u0018\ufffd'\ufffd/\ufffd\ufffd\u017f\ufffd\ufffd\u0010lM\fW\ufffd@\ufffdt\u0018\ufffd\u0006Lt\ufffd\u000e\ufffdm\u0004q;\ufffd&\ufffd1\ufffd\ufffd\ufffdS\ufffdX\"\u0005\ufffd\ufffd\ufffd\u000e\u0002\ufffd3/^\ufffd\u000b\ufffd\ufffdO&}\ufffd\ufffd\u001e\ufffds\ufffd\ufffd\u0007\ufffd\ufffd\ufffd\u001e\ufffd\ufffd\u007f1\u0006\ufffd\ufffd\ufffdL\ufffd\u0019\ufffd\u0012\ufffd7\ufffd1\ufffd\ufffdv\ufffd\u0011_\ufffd5t3\ufffd8JY\ufffdQ\u065b6&s\ufffdo\ufffd\ufffd\ufffdKx\ufffd\ufffd\ufffd\u0015\ufffdG\ufffd1\"\u046d{;\ufffd\ufffd\ufffd\ufffd3{\ufffd\ufffd\u001emo]\ufffdG\ufffd[\ufffd=\ufffd\ufffdZ\u04e3\ufffd\u000e=\ufffd\u030e\u001c\ufffd\ufffd.f\ufffd\ufffdu\ufffd\ufffd\ufffd\ufffd\ufffd4\ufffd{U\ufffd\ufffd\ufffd${\u0531[0P%N \ufffd\ufffd]\ufffd\ufffd\tu\ufffd1wn\ufffd6\ufffd+h\r\n^\ufffdj\ufffd!\ufffd1\u0019\u0006?,\ufffdk\u0002m\ufffd\ufffd\ufffd\u001b\ufffdx\ufffd]io\ufffdKt\ufffd\ufffd\ufffd\ufffd\ufffd\u001f\ufffd\u0001\ufffd\ufffd\ufffd\ufffdn\ufffd\ufffd2*\ufffd\ufffd\ufffd\ufffdg\ufffd\ufffd$\u0001O\ufffd\ufffd;\ufffd\ufffd{\ufffd{\ufffd\ufffd\ufffd\ufffd\u001f\ufffd\ufffdn\ufffd\ufffdvp)\ufffd}\r\nX\ufffd\ufffdt\ufffd\ufffd7~ykl\ufffd\ufffd\ufffd\u0011|\ufffd\ufffdY\ufffd`Z\ufffd\ufffd3|\ufffdd\ufffd\ufffd\ufffd\ufffd\u0013j@\ufffd\"\ufffdN\ufffdo\ufffd\ufffd&p\ufffd\fG\ufffd\ufffd\ufffd\ufffd2\ufffd\ufffd\ufffd\ufffd\ufffd\u07e3\u0004R\ufffd<DZ\u001ar\ufffd\r\n\ufffdS\ufffdP\ufffd\ufffdx\u0007\ufffd\u000f\ufffdg\ufffd\ufffd\ufffd\ufffdY6\ufffdg\u0319\ufffdj\u0003hL@\ufffdE%\ufffd\u02e7\u007f\ufffd\ufffd\ufffd\ufffd\ufffd\u076a\ufffd\ufffd&vXv\ufffd\ufffd\ufffd\u00036,\ufffd\ufffd\ufffd\u0002  \ufffd\ufffd\u0003 E\ufffd\ufffd\ufffd5~\u0001 \r\n0\r\n\r\n```\r\n#### Expected result\r\n\r\nconsole will print a html just like:\r\n\r\n```html\r\nGET / HTTP/1.1\r\nHost: www.wireshark.org:8080\r\nUser-Agent: curl/7.46.0\r\nAccept: */*\r\nConnection: close\r\nAccept-Encoding: chunked, gzip\r\n\r\nHTTP/1.1 200 OK\r\nServer: cloudflare-nginx\r\nDate: Wed, 06 Jan 2016 20:42:10 GMT\r\nContent-Type: text/html\r\nTransfer-Encoding: chunked\r\nConnection: close\r\nSet-Cookie: __cfduid=d8d37b52eaa3137bdfd7fd67a4ffc8a7a1452112929; expires=Thu, 05-Jan-17 20:42:09 GMT; path=/; domain=.wireshark.org; HttpOnly\r\nX-Frame-Options: SAMEORIGIN\r\nStrict-Transport-Security: max-age=31536000;\r\nX-Slogan: It's a great product with a great story to tell. I'm pumped!\r\nX-Mod-Pagespeed: 1.9.32.11-7550\r\nVary: Accept-Encoding\r\nCache-control: max-age=0, no-cache, no-store\r\nX-Slogan: Go deep.\r\nCF-RAY: 260a3f709d7b0761-AMS\r\nContent-Encoding: gzip\r\n\r\n\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n```\r\n\r\n#### Related resources\r\n\r\n<!-- traces / sample pcaps (stripped to the relevant frames), related standards, RFCs or other resources -->\r\n[http-chunked-gzip.zip](https://github.com/secdev/scapy/files/5011931/http-chunked-gzip.zip)\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2744/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2744/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2742", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2742/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2742/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2742/events", "html_url": "https://github.com/secdev/scapy/issues/2742", "id": 669750454, "node_id": "MDU6SXNzdWU2Njk3NTA0NTQ=", "number": 2742, "title": "TypeError when opening malformed pcap", "user": {"login": "Google-Autofuzz", "id": 27442508, "node_id": "MDQ6VXNlcjI3NDQyNTA4", "avatar_url": "https://avatars.githubusercontent.com/u/27442508?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Google-Autofuzz", "html_url": "https://github.com/Google-Autofuzz", "followers_url": "https://api.github.com/users/Google-Autofuzz/followers", "following_url": "https://api.github.com/users/Google-Autofuzz/following{/other_user}", "gists_url": "https://api.github.com/users/Google-Autofuzz/gists{/gist_id}", "starred_url": "https://api.github.com/users/Google-Autofuzz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Google-Autofuzz/subscriptions", "organizations_url": "https://api.github.com/users/Google-Autofuzz/orgs", "repos_url": "https://api.github.com/users/Google-Autofuzz/repos", "events_url": "https://api.github.com/users/Google-Autofuzz/events{/privacy}", "received_events_url": "https://api.github.com/users/Google-Autofuzz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-07-31T12:09:38Z", "updated_at": "2020-08-01T12:13:00Z", "closed_at": "2020-08-01T12:13:00Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nScapy crashes when opening a malformed pcap file.\r\n\r\n#### Environment\r\n\r\n-   Scapy version:  scapy-2.4.4rc2.dev6 from a `pip3 install --upgrade git+git://github.com/secdev/scap`\r\n-   Python version: 3.5\r\n-   Operating System: Debian\r\n\r\n#### How to reproduce\r\n\r\n```python\r\n$ cat test.py\r\nimport sys\r\nimport scapy\r\nimport scapy.utils\r\n\r\nscapy.utils.rdpcap(sys.argv[1])\r\n$ python3 test.py sample.pcap\r\nTraceback (most recent call last):\r\n  File \"/home/user/ven/lib/python3.8/site-packages/scapy/utils.py\", line 1139, in read_packet\r\n    p = self.LLcls(s)\r\nTypeError: 'NoneType' object is not callable\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"test.py\", line 6, in <module>\r\n    scapy.utils.rdpcap(sys.argv[1])\r\n  File \"/home/user/ven/lib/python3.8/site-packages/scapy/utils.py\", line 951, in rdpcap\r\n    return fdesc.read_all(count=count)\r\n  File \"/home/user/ven/lib/python3.8/site-packages/scapy/utils.py\", line 1154, in read_all\r\n    res = RawPcapReader.read_all(self, count)\r\n  File \"/home/user/ven/lib/python3.8/site-packages/scapy/utils.py\", line 1094, in read_all\r\n    p = self.read_packet()\r\n  File \"/home/user/ven/lib/python3.8/site-packages/scapy/utils.py\", line 1147, in read_packet\r\n    p = conf.raw_layer(s)\r\nTypeError: 'NoneType' object is not callable\r\n$\r\n```\r\n\r\n#### Actual result\r\n\r\n```python\r\nTraceback (most recent call last):\r\n  File \"/home/user/ven/lib/python3.8/site-packages/scapy/utils.py\", line 1139, in read_packet\r\n    p = self.LLcls(s)\r\nTypeError: 'NoneType' object is not callable\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"test.py\", line 6, in <module>\r\n    scapy.utils.rdpcap(sys.argv[1])\r\n  File \"/home/user/ven/lib/python3.8/site-packages/scapy/utils.py\", line 951, in rdpcap\r\n    return fdesc.read_all(count=count)\r\n  File \"/home/user/ven/lib/python3.8/site-packages/scapy/utils.py\", line 1154, in read_all\r\n    res = RawPcapReader.read_all(self, count)\r\n  File \"/home/user/ven/lib/python3.8/site-packages/scapy/utils.py\", line 1094, in read_all\r\n    p = self.read_packet()\r\n  File \"/home/user/ven/lib/python3.8/site-packages/scapy/utils.py\", line 1147, in read_packet\r\n    p = conf.raw_layer(s)\r\nTypeError: 'NoneType' object is not callable\r\n```\r\n\r\n#### Expected result\r\n\r\nNot a crash.\r\n\r\n#### Related resources\r\n\r\n[sample.pcap.zip](https://github.com/secdev/scapy/files/5006905/sample.pcap.zip)\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2742/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2742/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2736", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2736/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2736/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2736/events", "html_url": "https://github.com/secdev/scapy/issues/2736", "id": 665226537, "node_id": "MDU6SXNzdWU2NjUyMjY1Mzc=", "number": 2736, "title": "isotpscanner.py --help test failing", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 514033136, "node_id": "MDU6TGFiZWw1MTQwMzMxMzY=", "url": "https://api.github.com/repos/secdev/scapy/labels/tests", "name": "tests", "color": "0e8a16", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2020-07-24T14:58:58Z", "updated_at": "2020-07-31T07:44:40Z", "closed_at": "2020-07-31T07:44:40Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This test is failing in some Python 2.7 / PyPy2 tests (it seems to be only on Travis with those two versions): (logs: [Py2.7](https://travis-ci.com/github/secdev/scapy/jobs/364646709), [PyPy2](https://travis-ci.com/github/secdev/scapy/jobs/364646710))\r\n\r\n```\r\n###(007)=[failed] Test show help\r\n\r\n>>> result = subprocess.Popen([sys.executable, \"scapy/tools/automotive/isotpscanner.py\", \"--help\"], stdout=subprocess.PIPE, stderr=subprocess.PIPE)\r\n>>> std_out, std_err = result.communicate()\r\n>>> expected_output = plain_str(b'Scan for open ISOTP-Sockets.')\r\n>>> \r\n>>> assert not std_err\r\nTraceback (most recent call last):\r\n  File \"<input>\", line 2, in <module>\r\nAssertionError\r\n```\r\n\r\n@polybassa Sorry to bother, could you have a look at it ? Thanks !", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2736/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2736/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2716", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2716/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2716/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2716/events", "html_url": "https://github.com/secdev/scapy/issues/2716", "id": 658064414, "node_id": "MDU6SXNzdWU2NTgwNjQ0MTQ=", "number": 2716, "title": "Missing Ethertype for 6loWPAN encapsulation (RFC7973) -> Feature Request", "user": {"login": "Chamaeleon-", "id": 5526614, "node_id": "MDQ6VXNlcjU1MjY2MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5526614?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Chamaeleon-", "html_url": "https://github.com/Chamaeleon-", "followers_url": "https://api.github.com/users/Chamaeleon-/followers", "following_url": "https://api.github.com/users/Chamaeleon-/following{/other_user}", "gists_url": "https://api.github.com/users/Chamaeleon-/gists{/gist_id}", "starred_url": "https://api.github.com/users/Chamaeleon-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Chamaeleon-/subscriptions", "organizations_url": "https://api.github.com/users/Chamaeleon-/orgs", "repos_url": "https://api.github.com/users/Chamaeleon-/repos", "events_url": "https://api.github.com/users/Chamaeleon-/events{/privacy}", "received_events_url": "https://api.github.com/users/Chamaeleon-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-07-16T10:23:48Z", "updated_at": "2020-07-18T13:27:37Z", "closed_at": "2020-07-18T13:27:37Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "#### Brief description\r\nEthertype 0xA0ED from 6loWPAN encapsulation in RFC7973 is missing in scapy\r\n<!-- describe the main issue in one sentence -->\r\n<!-- if possible, describe what components / protocols could be affected by the issue (e.g. wrpcap() + IPv6, it is likely this also affects XXX) -->\r\n\r\n#### Environment\r\n\r\n-   Scapy version: `2.4.3`\r\n-   Python version: `3.7.7`\r\n-   Operating System: `Ubuntu 18.04 LTS`\r\n\r\n<!-- if needed - further information to get a picture of your setup (e.g. a sketch of your network setup) -->\r\n\r\n#### How to reproduce\r\n\r\n<!-- step-by-step explanation or a short script, may reference section 'Related resources' -->\r\nSniff some packets which use RFC7973 6loWPAN encapsulation. e.g. from RIOT-OS native 6loenc enabled networking example (possible setup is described in the testing setup of https://github.com/RIOT-OS/RIOT/pull/10667)\r\n\r\n#### Actual result\r\n\r\n<!-- dump results that outline the issue, please format your code -->\r\nscapys Packet.show() output of a sniffed packet\r\n```\r\n###[ Ethernet ]### \r\n  dst       = ff:ff:ff:ff:ff:ff\r\n  src       = 50:51:52:67:15:69\r\n  type      = 0xa0ed\r\n###[ Raw ]### \r\n     load      = '~;\\x02\\xf0\\x1f\\x90\\x1f\\x90\\x03Qtesttext2'`\r\n```\r\nYou can see scapy don't seem to recognize the Ethernet type and didn't try to decode the 6loWPAN header.\r\n#### Expected result\r\n\r\nWireshark decodes this to:\r\n `Frame(Ethernet(6lowpan(data)))` with 6lowpan decompressed to IPv6 and UDP headers.\r\nIt should be possible to do this in scapy too.\r\n\r\nLong form of the wireshark output:\r\n```\r\nFrame 339: 33 bytes on wire (264 bits), 33 bytes captured (264 bits)\r\nEthernet II, Src: 50:51:52:67:15:69 (50:51:52:67:15:69), Dst: Broadcast (ff:ff:ff:ff:ff:ff)\r\n    Destination: Broadcast (ff:ff:ff:ff:ff:ff)\r\n    Source: 50:51:52:67:15:69 (50:51:52:67:15:69)\r\n    Type: 6LoWPAN (0xa0ed)\r\n6LoWPAN\r\n    IPHC Header\r\n    Source: fe80::5051:52ff:fe67:1569\r\n    Destination: ff02::2\r\n    UDP header compression\r\n    Source port: 8080\r\n    Destination port: 8080\r\n    UDP checksum: 0x0351\r\nInternet Protocol Version 6, Src: fe80::5051:52ff:fe67:1569, Dst: ff02::2\r\nUser Datagram Protocol, Src Port: 8080, Dst Port: 8080\r\nData (9 bytes)\r\n```\r\n\r\n\r\n\r\n<!-- describe the expected result and outline the difference to the actual one, could also be a screen shot (e.g. wireshark) -->\r\n\r\n#### Related resources\r\nhttps://tools.ietf.org/html/rfc7973\r\nhttps://www.iana.org/assignments/ieee-802-numbers/ieee-802-numbers.xhtml#ieee-802-numbers-1\r\n<!-- traces / sample pcaps (stripped to the relevant frames), related standards, RFCs or other resources -->\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2716/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2716/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2714", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2714/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2714/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2714/events", "html_url": "https://github.com/secdev/scapy/pull/2714", "id": 657542370, "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ5NjQwOTI1", "number": 2714, "title": "Avoid mutating globals - rework", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-07-15T17:55:21Z", "updated_at": "2020-07-19T15:26:27Z", "closed_at": "2020-07-19T13:09:56Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2714", "html_url": "https://github.com/secdev/scapy/pull/2714", "diff_url": "https://github.com/secdev/scapy/pull/2714.diff", "patch_url": "https://github.com/secdev/scapy/pull/2714.patch", "merged_at": "2020-07-19T13:09:55Z"}, "body": "fix https://github.com/secdev/scapy/issues/2680\r\nfix https://github.com/secdev/scapy/pull/2681", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2714/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2714/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2713", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2713/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2713/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2713/events", "html_url": "https://github.com/secdev/scapy/pull/2713", "id": 656104888, "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ4NDYyMDMz", "number": 2713, "title": "Support 4 bytes in TLS_Ext_CSR (#1721)", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-07-13T20:06:48Z", "updated_at": "2022-06-18T13:32:37Z", "closed_at": "2020-07-14T13:21:21Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2713", "html_url": "https://github.com/secdev/scapy/pull/2713", "diff_url": "https://github.com/secdev/scapy/pull/2713.diff", "patch_url": "https://github.com/secdev/scapy/pull/2713.patch", "merged_at": null}, "body": "fix https://github.com/secdev/scapy/issues/1721\r\nplease discuss if the fix is correct.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2713/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2713/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2705", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2705/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2705/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2705/events", "html_url": "https://github.com/secdev/scapy/pull/2705", "id": 652103525, "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ1MjM2NjE4", "number": 2705, "title": "Re-use cryptography code", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1000112749, "node_id": "MDU6TGFiZWwxMDAwMTEyNzQ5", "url": "https://api.github.com/repos/secdev/scapy/labels/cleanup", "name": "cleanup", "color": "FF68F6", "default": false, "description": "Performs some code clean-up"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-07-07T08:10:05Z", "updated_at": "2020-07-11T09:07:09Z", "closed_at": "2020-07-09T16:08:59Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2705", "html_url": "https://github.com/secdev/scapy/pull/2705", "diff_url": "https://github.com/secdev/scapy/pull/2705.diff", "patch_url": "https://github.com/secdev/scapy/pull/2705.patch", "merged_at": "2020-07-09T16:08:59Z"}, "body": "x25519 and x448 cryptography calls were present in some parts of the code, but not everywhere. This unifies how we access cryptography to make sure it always works.\r\n\r\nfix https://github.com/secdev/scapy/issues/2698", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2705/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2705/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2680", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2680/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2680/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2680/events", "html_url": "https://github.com/secdev/scapy/issues/2680", "id": 638721913, "node_id": "MDU6SXNzdWU2Mzg3MjE5MTM=", "number": 2680, "title": "builtins mutated after importing scapy.arch", "user": {"login": "graingert", "id": 413772, "node_id": "MDQ6VXNlcjQxMzc3Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/413772?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graingert", "html_url": "https://github.com/graingert", "followers_url": "https://api.github.com/users/graingert/followers", "following_url": "https://api.github.com/users/graingert/following{/other_user}", "gists_url": "https://api.github.com/users/graingert/gists{/gist_id}", "starred_url": "https://api.github.com/users/graingert/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graingert/subscriptions", "organizations_url": "https://api.github.com/users/graingert/orgs", "repos_url": "https://api.github.com/users/graingert/repos", "events_url": "https://api.github.com/users/graingert/events{/privacy}", "received_events_url": "https://api.github.com/users/graingert/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-06-15T10:07:48Z", "updated_at": "2020-07-19T21:20:53Z", "closed_at": "2020-07-19T13:09:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nimporting scapy.layers.inet (or any module that imports scapy.config or scapy.arch) pollutes built-ins with a lot of things:\r\n\r\n#### Environment\r\n\r\n-   Scapy version: 2.4.3\r\n-   Python version: py2.7 and py3.7\r\n-   Operating System: Ubuntu 20.04 LTS\r\n\r\n<!-- if needed - further information to get a picture of your setup (e.g. a sketch of your network setup) -->\r\n\r\n#### How to reproduce\r\n\r\n \r\n```python\r\nfrom six.moves import builtins\r\n\r\nold_keys = set(vars(builtins).keys())\r\nimport scapy.layers.inet\r\nnew_keys = set(vars(builtins).keys())\r\n\r\nprint(sorted(new_keys - old_keys))\r\nprint(six)\r\n```\r\n\r\noutput:\r\n```\r\n['ETH_P_8021Q', 'ETH_P_ALL', 'IFF_BROADCAST', 'IFF_DEBUG', 'IFF_LOOPBACK', 'IFF_NOARP', 'IFF_NOTRAILERS', 'IFF_POINTOPOINT', 'IFF_PROMISC', 'IFF_RUNNING', 'IFF_UP', 'L2ListenSocket', 'L2Socket', 'L3PacketSocket', 'LINUX', 'LOOPBACK_NAME', 'MTU', 'PACKET_ADD_MEMBERSHIP', 'PACKET_AUXDATA', 'PACKET_BROADCAST', 'PACKET_DROP_MEMBERSHIP', 'PACKET_FASTROUTE', 'PACKET_HOST', 'PACKET_KERNEL', 'PACKET_LOOPBACK', 'PACKET_MR_ALLMULTI', 'PACKET_MR_MULTICAST', 'PACKET_MR_PROMISC', 'PACKET_MULTICAST', 'PACKET_OTHERHOST', 'PACKET_OUTGOING', 'PACKET_RECV_OUTPUT', 'PACKET_RX_RING', 'PACKET_STATISTICS', 'PACKET_USER', 'Packet', 'Padding', 'RTF_REJECT', 'RTF_UP', 'SIOCGIFADDR', 'SIOCGIFCONF', 'SIOCGIFCOUNT', 'SIOCGIFFLAGS', 'SIOCGIFHWADDR', 'SIOCGIFINDEX', 'SIOCGIFNAME', 'SIOCGIFNETMASK', 'SIOCGSTAMP', 'SIOCSIFFLAGS', 'SIOCSIFLINK', 'SOL_PACKET', 'SO_ATTACH_FILTER', 'ScapyInvalidPlatformException', 'Scapy_Exception', 'SuperSocket', 'TP_STATUS_VLAN_VALID', 'VEthPair', 'absolute_import', 'array', 'attach_filter', 'compile_filter', 'conf', 'ctypes', 'get_alias_address', 'get_if', 'get_if_index', 'get_if_list', 'get_if_raw_addr', 'get_if_raw_hwaddr', 'get_iface_mode', 'get_last_packet_timestamp', 'get_working_if', 'in6_getifaddr', 'ioctl', 'os', 'plain_str', 'raw', 're', 'read_routes', 'read_routes6', 'scapy', 'select', 'set_iface_monitor', 'set_promisc', 'six', 'socket', 'struct', 'subprocess', 'time', 'tpacket_auxdata', 'warning']\r\n<module 'scapy.modules.six' from '/usr/share/python/osirium-virtualenv/lib/python2.7/site-packages/scapy/modules/six.pyc'>\r\n```\r\n\r\n#### Expected result\r\n```\r\n[]\r\nNameError: name 'six' is not defined\r\n```\r\n\r\n#### Related resources\r\n\r\n<!-- traces / sample pcaps (stripped to the relevant frames), related standards, RFCs or other resources -->\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2680/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2680/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2672", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2672/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2672/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2672/events", "html_url": "https://github.com/secdev/scapy/pull/2672", "id": 633391915, "node_id": "MDExOlB1bGxSZXF1ZXN0NDMwMDQ1NzA4", "number": 2672, "title": "Fix load_mib on duplicated OIDs", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-06-07T12:56:53Z", "updated_at": "2020-06-07T17:48:47Z", "closed_at": "2020-06-07T17:47:53Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2672", "html_url": "https://github.com/secdev/scapy/pull/2672", "diff_url": "https://github.com/secdev/scapy/pull/2672.diff", "patch_url": "https://github.com/secdev/scapy/pull/2672.patch", "merged_at": "2020-06-07T17:47:53Z"}, "body": "fix https://github.com/secdev/scapy/issues/2542\r\n\r\nThe fix in itself is very small (addition of `alias`). But I also added some comments to make this function less cryptic", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2672/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2672/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2610", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2610/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2610/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2610/events", "html_url": "https://github.com/secdev/scapy/pull/2610", "id": 606313363, "node_id": "MDExOlB1bGxSZXF1ZXN0NDA4NTUwOTc5", "number": 2610, "title": "2493 rebase", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 267691054, "node_id": "MDU6TGFiZWwyNjc2OTEwNTQ=", "url": "https://api.github.com/repos/secdev/scapy/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-04-24T13:27:19Z", "updated_at": "2020-05-05T13:49:11Z", "closed_at": "2020-05-05T10:25:43Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2610", "html_url": "https://github.com/secdev/scapy/pull/2610", "diff_url": "https://github.com/secdev/scapy/pull/2610.diff", "patch_url": "https://github.com/secdev/scapy/pull/2610.patch", "merged_at": "2020-05-05T10:25:42Z"}, "body": "fix #2493\r\n\r\nThe pcap size is very hard to reduce because the interesting packet has a payload that takes roughly the whole pcap size. It's small enough that I ignore it", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2610/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2610/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2579", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2579/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2579/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2579/events", "html_url": "https://github.com/secdev/scapy/issues/2579", "id": 597132534, "node_id": "MDU6SXNzdWU1OTcxMzI1MzQ=", "number": 2579, "title": "Wrong FCS checkum in Dot11FCS", "user": {"login": "ash09", "id": 9435297, "node_id": "MDQ6VXNlcjk0MzUyOTc=", "avatar_url": "https://avatars.githubusercontent.com/u/9435297?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ash09", "html_url": "https://github.com/ash09", "followers_url": "https://api.github.com/users/ash09/followers", "following_url": "https://api.github.com/users/ash09/following{/other_user}", "gists_url": "https://api.github.com/users/ash09/gists{/gist_id}", "starred_url": "https://api.github.com/users/ash09/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ash09/subscriptions", "organizations_url": "https://api.github.com/users/ash09/orgs", "repos_url": "https://api.github.com/users/ash09/repos", "events_url": "https://api.github.com/users/ash09/events{/privacy}", "received_events_url": "https://api.github.com/users/ash09/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-04-09T09:00:03Z", "updated_at": "2020-04-16T14:29:46Z", "closed_at": "2020-04-16T14:29:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nChecksum is not calculated properly in Dot11FCS. The payload given to compute_fcs() contains the 4-bytes FCS field initialized with zeros.\r\n\r\n#### Environment\r\n\r\n-   Scapy version: v2.4.3\r\n-   Python version: 3.5\r\n-   Operating System: Debian 9\r\n\r\n#### How to reproduce\r\n\r\n```\r\nIn [19]: pkt = RadioTap() / Dot11FCS() / Dot11Beacon()                                                                  \r\n\r\nIn [20]: pkt.show()                                                                                                     \r\n###[ RadioTap dummy ]### \r\n  version   = 0\r\n  pad       = 0\r\n  len       = None\r\n  present   = Flags\r\n  Flags     = FCS\r\n  notdecoded= ''\r\n###[ 802.11-FCS ]### \r\n     subtype   = 8\r\n     type      = Management\r\n     proto     = 0\r\n     FCfield   = \r\n     ID        = 0\r\n     addr1     = 00:00:00:00:00:00\r\n     addr2     = 00:00:00:00:00:00\r\n     addr3     = 00:00:00:00:00:00\r\n     SC        = 0\r\n     fcs       = None\r\n###[ 802.11 Beacon ]### \r\n        timestamp = 0\r\n        beacon_interval= 100\r\n        cap       = \r\n\r\n\r\nIn [21]: wireshark(Raw(pkt), linktype=DLT_IEEE802_11_RADIO)\r\n```\r\n\r\n#### Actual result\r\n\r\n![capture](https://user-images.githubusercontent.com/9435297/78878076-15cec200-7a52-11ea-9e90-a24068d662ed.png)\r\n\r\n#### Fix\r\n\r\nscapy/layers/dot11.py\r\n```\r\n     def post_build(self, p, pay):\r\n         p += pay\r\n         if self.fcs is None:\r\n-            p = p[:-4] + self.compute_fcs(p)\r\n+            p = p[:-4] + self.compute_fcs(p[:-4])\r\n         return p\r\n```", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2579/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2579/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2577", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2577/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2577/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2577/events", "html_url": "https://github.com/secdev/scapy/pull/2577", "id": 595988668, "node_id": "MDExOlB1bGxSZXF1ZXN0NDAwMzY3Mjg4", "number": 2577, "title": "Fix Conf to support Sphinx 3.0.0", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 972547864, "node_id": "MDU6TGFiZWw5NzI1NDc4NjQ=", "url": "https://api.github.com/repos/secdev/scapy/labels/doc", "name": "doc", "color": "0e8a16", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-04-07T16:14:16Z", "updated_at": "2020-04-07T17:01:54Z", "closed_at": "2020-04-07T17:01:04Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2577", "html_url": "https://github.com/secdev/scapy/pull/2577", "diff_url": "https://github.com/secdev/scapy/pull/2577.diff", "patch_url": "https://github.com/secdev/scapy/pull/2577.patch", "merged_at": "2020-04-07T17:01:04Z"}, "body": "- fixes issue with sphinx 3.0.0\r\n- remove unused file", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2577/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2577/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2573", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2573/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2573/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2573/events", "html_url": "https://github.com/secdev/scapy/issues/2573", "id": 595295663, "node_id": "MDU6SXNzdWU1OTUyOTU2NjM=", "number": 2573, "title": "/etc/service and ipv6 warnings on startup", "user": {"login": "skewty", "id": 9087223, "node_id": "MDQ6VXNlcjkwODcyMjM=", "avatar_url": "https://avatars.githubusercontent.com/u/9087223?v=4", "gravatar_id": "", "url": "https://api.github.com/users/skewty", "html_url": "https://github.com/skewty", "followers_url": "https://api.github.com/users/skewty/followers", "following_url": "https://api.github.com/users/skewty/following{/other_user}", "gists_url": "https://api.github.com/users/skewty/gists{/gist_id}", "starred_url": "https://api.github.com/users/skewty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/skewty/subscriptions", "organizations_url": "https://api.github.com/users/skewty/orgs", "repos_url": "https://api.github.com/users/skewty/repos", "events_url": "https://api.github.com/users/skewty/events{/privacy}", "received_events_url": "https://api.github.com/users/skewty/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-04-06T17:32:15Z", "updated_at": "2020-06-12T10:49:58Z", "closed_at": "2020-06-12T10:49:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nGetting /etc/service and ipv6 warnings on startup\r\n\r\n#### Environment\r\n\r\n-   Scapy version: `2.4.3`\r\n-   Python version: `3.6`\r\n-   Operating System: `Fedora Silverblue`\r\n\r\n\r\n#### How to reproduce\r\n\r\nSimply use scapy in some python code\r\n\r\n#### Actual result\r\n\r\n```\r\n             data.py:228 10:24:02,020 [W] Couldn't parse file [/etc/services]: line [b'x11\\t\\t6000-6063/tcp'] (invalid literal for int() with base 10: b'6000-6063')\r\n             data.py:228 10:24:02,021 [W] Couldn't parse file [/etc/services]: line [b'x11\\t\\t6000-6063/udp'] (invalid literal for int() with base 10: b'6000-6063')\r\n             data.py:228 10:24:02,028 [W] Couldn't parse file [/etc/services]: line [b'ircu\\t\\t6665-6669/tcp'] (invalid literal for int() with base 10: b'6665-6669')\r\n            error.py:097 10:24:02,482 [W] No route found for IPv6 destination :: (no default route?)\r\n```\r\n\r\n#### Expected result\r\n\r\nNo warnings.  My services file is valid and no IPV6 is valid.\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2573/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2573/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2554", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2554/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2554/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2554/events", "html_url": "https://github.com/secdev/scapy/issues/2554", "id": 589877675, "node_id": "MDU6SXNzdWU1ODk4Nzc2NzU=", "number": 2554, "title": "run_scapy tests fail randomly", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-03-29T20:25:34Z", "updated_at": "2020-05-18T13:06:30Z", "closed_at": "2020-05-18T13:06:30Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "```\r\n### Writing output...\r\npy38-linux_non_root run-test: commands[1] | coverage combine\r\n___________________________________ summary ____________________________________\r\n  py38-linux_non_root: commands succeeded\r\n  congratulations :)\r\nERROR: Too many parameters : [/tmp/tmp.t0G30fXRX3]\r\n##[error]Process completed with exit code 1.\r\n```\r\nThis happens randomly. @guedou could you please have a look? thanks", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2554/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2554/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2542", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2542/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2542/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2542/events", "html_url": "https://github.com/secdev/scapy/issues/2542", "id": 586208935, "node_id": "MDU6SXNzdWU1ODYyMDg5MzU=", "number": 2542, "title": "load_mib breaks mib", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-03-23T13:28:50Z", "updated_at": "2020-06-07T17:47:53Z", "closed_at": "2020-06-07T17:47:53Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Calling `load_mib` is supposed to add entries to the current MIB, but it breaks stuff.\r\nIt seems that calling it deduplicates all entries that have the same value (even with different keys). We end up having some keys unresolved..\r\n\r\n**Demo:**\r\n\r\na.txt\r\n```\r\n-- MIB test\r\nscapy       OBJECT IDENTIFIER ::= {test 2807}\r\n```\r\nshell\r\n```python\r\n>>> ASN1_OID(\"2.5.29.19\")\r\n<ASN1_OID['basicConstraints']>\r\n>>> load_mib(\"a.txt\")\r\n>>> ASN1_OID(\"2.5.29.19\")\r\n<ASN1_OID['.2.5.29.19']>\r\n```\r\n\r\nThis is the root of the `AttributeError: 'Cert' object has no attribute 'cA'` bug we had two years ago: https://github.com/secdev/scapy/pull/1571#issuecomment-434651752 . When the `2.5.29.19` oid is unresolved, `cA` is never set.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2542/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2542/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2530", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2530/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2530/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2530/events", "html_url": "https://github.com/secdev/scapy/issues/2530", "id": 583420129, "node_id": "MDU6SXNzdWU1ODM0MjAxMjk=", "number": 2530, "title": "The scappy PPTPStartControlConnectionRequest protocol_version field", "user": {"login": "sei-vsarvepalli", "id": 19911912, "node_id": "MDQ6VXNlcjE5OTExOTEy", "avatar_url": "https://avatars.githubusercontent.com/u/19911912?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sei-vsarvepalli", "html_url": "https://github.com/sei-vsarvepalli", "followers_url": "https://api.github.com/users/sei-vsarvepalli/followers", "following_url": "https://api.github.com/users/sei-vsarvepalli/following{/other_user}", "gists_url": "https://api.github.com/users/sei-vsarvepalli/gists{/gist_id}", "starred_url": "https://api.github.com/users/sei-vsarvepalli/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sei-vsarvepalli/subscriptions", "organizations_url": "https://api.github.com/users/sei-vsarvepalli/orgs", "repos_url": "https://api.github.com/users/sei-vsarvepalli/repos", "events_url": "https://api.github.com/users/sei-vsarvepalli/events{/privacy}", "received_events_url": "https://api.github.com/users/sei-vsarvepalli/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-03-18T02:34:22Z", "updated_at": "2020-03-30T09:17:22Z", "closed_at": "2020-03-30T09:17:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "Looks like the field protocol_version is actually a floating point with two bytes to represent the integer value and two bytes for the decimal portion.  So for the protocol version to be 1.0 this byte value is actually 256, to get PPTP to work properly I have to basically start this \r\n\r\n`     \r\npython shell\r\n>>> send(IP()/TCP()/PPTPStartControlConnectionRequest())\r\n.\r\nSent 1 packets.\r\n>>> send(IP()/TCP()/PPTPStartControlConnectionRequest(protocol_version=256))\r\n.\r\nSent 1 packets.\r\n\r\ntcpdump view \r\n\r\n>>127.0.0.1.20 > 127.0.0.1.1723: Flags [S], cksum 0xdf7e (correct), seq 0:156, win 8192, length 156: pptp Length=156 CTRL-MSG Magic-Cookie=1a2b3c4d CTRL_MSGTYPE=SCCRQ PROTO_VER(0.1) FRAME_CAP() BEARER_CAP() MAX_CHAN(65535) FIRM_REV(256) HOSTNAME(linux) VENDOR()\r\n02:31:30.855945 IP (tos 0x0, ttl 64, id 1, offset 0, flags [none], proto TCP (6), length 196)\r\n\r\n >> 127.0.0.1.20 > 127.0.0.1.1723: Flags [S], cksum 0xde7f (correct), seq 0:156, win 8192, length 156: pptp Length=156 CTRL-MSG Magic-Cookie=1a2b3c4d CTRL_MSGTYPE=SCCRQ PROTO_VER(1.0) FRAME_CAP() BEARER_CAP() MAX_CHAN(65535) FIRM_REV(256) HOSTNAME(linux) VENDOR()`\r\n\r\nCan you please update the protocol_version to be correct by default 256 and be presented to the user as 1.0 to match protocol specs.\r\n\r\nThanks\r\nVijay\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2530/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2530/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2511", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2511/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2511/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2511/events", "html_url": "https://github.com/secdev/scapy/issues/2511", "id": 577492841, "node_id": "MDU6SXNzdWU1Nzc0OTI4NDE=", "number": 2511, "title": "recognition of wpa 3 beacons", "user": {"login": "mstekker", "id": 8531968, "node_id": "MDQ6VXNlcjg1MzE5Njg=", "avatar_url": "https://avatars.githubusercontent.com/u/8531968?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mstekker", "html_url": "https://github.com/mstekker", "followers_url": "https://api.github.com/users/mstekker/followers", "following_url": "https://api.github.com/users/mstekker/following{/other_user}", "gists_url": "https://api.github.com/users/mstekker/gists{/gist_id}", "starred_url": "https://api.github.com/users/mstekker/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mstekker/subscriptions", "organizations_url": "https://api.github.com/users/mstekker/orgs", "repos_url": "https://api.github.com/users/mstekker/repos", "events_url": "https://api.github.com/users/mstekker/events{/privacy}", "received_events_url": "https://api.github.com/users/mstekker/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-03-08T12:24:20Z", "updated_at": "2020-05-20T11:58:01Z", "closed_at": "2020-05-20T11:58:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nI am using Scapy to test the security of APs (kind of encryption) in this way:\r\nnstats = pkt[Dot11Beacon].network_stats()\r\n\r\nWorks great, but it shows WPA3 APs as WPA2. Are there any solutions?\r\n\r\nThanks and with kind regards,\r\n\r\nMart", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2511/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2511/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2485", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2485/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2485/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2485/events", "html_url": "https://github.com/secdev/scapy/issues/2485", "id": 567559571, "node_id": "MDU6SXNzdWU1Njc1NTk1NzE=", "number": 2485, "title": "ValueError: invalid literal for int() with base 16: \"'b\" - while computing length of an IE", "user": {"login": "UmakantKulkarni", "id": 22261931, "node_id": "MDQ6VXNlcjIyMjYxOTMx", "avatar_url": "https://avatars.githubusercontent.com/u/22261931?v=4", "gravatar_id": "", "url": "https://api.github.com/users/UmakantKulkarni", "html_url": "https://github.com/UmakantKulkarni", "followers_url": "https://api.github.com/users/UmakantKulkarni/followers", "following_url": "https://api.github.com/users/UmakantKulkarni/following{/other_user}", "gists_url": "https://api.github.com/users/UmakantKulkarni/gists{/gist_id}", "starred_url": "https://api.github.com/users/UmakantKulkarni/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/UmakantKulkarni/subscriptions", "organizations_url": "https://api.github.com/users/UmakantKulkarni/orgs", "repos_url": "https://api.github.com/users/UmakantKulkarni/repos", "events_url": "https://api.github.com/users/UmakantKulkarni/events{/privacy}", "received_events_url": "https://api.github.com/users/UmakantKulkarni/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2020-02-19T13:11:19Z", "updated_at": "2020-02-23T14:44:58Z", "closed_at": "2020-02-23T14:44:58Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I'm trying to compute the length of IMSI IE; but getting following error:\r\n```\r\n>>> from scapy.contrib.gtp_v2 import IE_IMSI\r\n>>> ie = IE_IMSI(ietype='IMSI', length=8, IMSI='2080112345670000')\r\n>>> ie\r\n<IE_IMSI  ietype=IMSI length=8 IMSI='2080112345670000' |>\r\n>>> len(ie)\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.5/code.py\", line 91, in runcode\r\n    exec(code, self.locals)\r\n  File \"<console>\", line 1, in <module>\r\n  File \"/root/Umakant/gtpv2/scapy-master/scapy/packet.py\", line 527, in __len__\r\n    return len(self.__bytes__())\r\n  File \"/root/Umakant/gtpv2/scapy-master/scapy/packet.py\", line 492, in __bytes__\r\n    return self.build()\r\n  File \"/root/Umakant/gtpv2/scapy-master/scapy/packet.py\", line 612, in build\r\n    p = self.do_build()\r\n  File \"/root/Umakant/gtpv2/scapy-master/scapy/packet.py\", line 594, in do_build\r\n    pkt = self.self_build()\r\n  File \"/root/Umakant/gtpv2/scapy-master/scapy/packet.py\", line 575, in self_build\r\n    p = f.addfield(self, p, val)\r\n  File \"/root/Umakant/gtpv2/scapy-master/scapy/fields.py\", line 1267, in addfield\r\n    return s + struct.pack(\"%is\" % len_pkt, self.i2m(pkt, val))\r\n  File \"/root/Umakant/gtpv2/scapy-master/scapy/contrib/gtp.py\", line 179, in i2m\r\n    ret_string += chr(int(tmp[1] + tmp[0], 16))\r\nValueError: invalid literal for int() with base 16: \"'b\"\r\n```\r\nSame error with IE_ServingNetwork & IE_APN.\r\nThis is from gtpv2 - https://github.com/secdev/scapy/blob/master/scapy/contrib/gtp_v2.py", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2485/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2485/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2464", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2464/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2464/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2464/events", "html_url": "https://github.com/secdev/scapy/pull/2464", "id": 562154911, "node_id": "MDExOlB1bGxSZXF1ZXN0MzcyODEzMTE1", "number": 2464, "title": "Fix NetflowOptionsFlowsetV9 padding #2257", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-02-09T10:24:41Z", "updated_at": "2020-07-19T09:17:35Z", "closed_at": "2020-02-16T08:54:08Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2464", "html_url": "https://github.com/secdev/scapy/pull/2464", "diff_url": "https://github.com/secdev/scapy/pull/2464.diff", "patch_url": "https://github.com/secdev/scapy/pull/2464.patch", "merged_at": "2020-02-16T08:54:08Z"}, "body": "fix #2257", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2464/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2464/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2450", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2450/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2450/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2450/events", "html_url": "https://github.com/secdev/scapy/issues/2450", "id": 557475005, "node_id": "MDU6SXNzdWU1NTc0NzUwMDU=", "number": 2450, "title": "TLS Certificate Verify decoding issue", "user": {"login": "sylvainpelissier", "id": 7047419, "node_id": "MDQ6VXNlcjcwNDc0MTk=", "avatar_url": "https://avatars.githubusercontent.com/u/7047419?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sylvainpelissier", "html_url": "https://github.com/sylvainpelissier", "followers_url": "https://api.github.com/users/sylvainpelissier/followers", "following_url": "https://api.github.com/users/sylvainpelissier/following{/other_user}", "gists_url": "https://api.github.com/users/sylvainpelissier/gists{/gist_id}", "starred_url": "https://api.github.com/users/sylvainpelissier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sylvainpelissier/subscriptions", "organizations_url": "https://api.github.com/users/sylvainpelissier/orgs", "repos_url": "https://api.github.com/users/sylvainpelissier/repos", "events_url": "https://api.github.com/users/sylvainpelissier/events{/privacy}", "received_events_url": "https://api.github.com/users/sylvainpelissier/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1317786288, "node_id": "MDU6TGFiZWwxMzE3Nzg2Mjg4", "url": "https://api.github.com/repos/secdev/scapy/labels/tls", "name": "tls", "color": "56088e", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-01-30T12:54:21Z", "updated_at": "2020-02-11T10:00:15Z", "closed_at": "2020-02-11T10:00:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Description\r\n\r\nWhen decoding a TLS Certificate Verify packet I have the following results:\r\n\r\n```python\r\nfrom scapy.all import rdpcap\r\nfrom scapy.layers.tls.record import TLS\r\n\r\npackets = rdpcap('certificate-verify.pcapng')\r\n\r\nfor packet in packets:\r\n    if packet.haslayer(TLS):\r\n        print(packet[TLS].show())\r\n```\r\n\r\n```\r\n###[ TLS ]### \r\n  type      = handshake\r\n  version   = TLS 1.2\r\n  len       = 80    [deciphered_len= 80]\r\n  iv        = b''\r\n  \\msg       \\\r\n   |###[ Raw ]### \r\n   |  load      = '\\x0f\\x00\\x00L\\x04\\x03\\x00H0F\\x02!\\x00\\xcf\\xf1\\xd0:1\\xb8\\xe4JCU\\x00\\x8c\\xcdg\\xf9=g\\x84\\xa3h;V@\\xfd\\xd1\\\\\\xf0\\xc4f\\xfa\\x18\\xdc\\x02!\\x00\\x82\\x1dF\\xc1\\xd1\\xab\\x86\\xaa\\xb9\"\\x0eA\\xf2\\xc3Rj\\xd7\\xf1\\xe9\\xaf\\x9b\\xa5?R\\n\\xca\\x15\\xfe)\\xa9j\\x84'\r\n  mac       = b''\r\n  pad       = b''\r\n  padlen    = None\r\n\r\nNone\r\n```\r\n\r\nHowever, the class **TLSCertificateVerify** should return a decoded signature not raw bytes.\r\n\r\n#### Environment\r\n\r\n-   Scapy version: `2.4.3.dev259`\r\n-   Python version: `3.7.5`\r\n-   Operating System: `Ubuntu 19.04`\r\n\r\n#### How to reproduce\r\n\r\n> pcap is attached: [certificate-verify.zip](https://github.com/secdev/scapy/files/4134036/certificate-verify.zip)\r\n\r\n\r\n#### Related resources\r\n\r\n>  It seems to be related to #945\r\n\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2450/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2450/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2447", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2447/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2447/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2447/events", "html_url": "https://github.com/secdev/scapy/issues/2447", "id": 556842315, "node_id": "MDU6SXNzdWU1NTY4NDIzMTU=", "number": 2447, "title": "srp is missing response (Centos 5.11)", "user": {"login": "goldbaum", "id": 17685013, "node_id": "MDQ6VXNlcjE3Njg1MDEz", "avatar_url": "https://avatars.githubusercontent.com/u/17685013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/goldbaum", "html_url": "https://github.com/goldbaum", "followers_url": "https://api.github.com/users/goldbaum/followers", "following_url": "https://api.github.com/users/goldbaum/following{/other_user}", "gists_url": "https://api.github.com/users/goldbaum/gists{/gist_id}", "starred_url": "https://api.github.com/users/goldbaum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/goldbaum/subscriptions", "organizations_url": "https://api.github.com/users/goldbaum/orgs", "repos_url": "https://api.github.com/users/goldbaum/repos", "events_url": "https://api.github.com/users/goldbaum/events{/privacy}", "received_events_url": "https://api.github.com/users/goldbaum/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1265179855, "node_id": "MDU6TGFiZWwxMjY1MTc5ODU1", "url": "https://api.github.com/repos/secdev/scapy/labels/platform-specific", "name": "platform-specific", "color": "14acba", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 25, "created_at": "2020-01-29T12:51:50Z", "updated_at": "2020-02-15T12:49:41Z", "closed_at": "2020-02-15T12:49:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Brief description**\r\n\r\nSending a simple TCP SYN packet results in no response according to scapy.\r\n\r\nHow is decided if a packet is a response to another?\r\n\r\n**Environment**\r\n- Python 3.6.1 (default, Jul 19 2019, 17:04:00)\r\n- Scapy Version 2.4.3\r\n- Linux hostname 2.6.18-398.el5 #1 SMP Tue Sep 16 20:50:52 EDT 2014 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n**How to reproduce**\r\n```\r\n>>> tcp_packet = Ether(src=\"00:50:56:AF:A8:83\", dst=\"00:50:56:AF:2F:87\")/IP(src=\"101.100.100.66\", dst=\"201.200.0.64\")/TCP(sport=333, dport=12345, flags=\"S\")\r\n>>> ans, no_ans = srp(tcp_packet, iface=\"eth1\", timeout=5)\r\nBegin emission:\r\nFinished sending 1 packets.\r\n\r\nReceived 0 packets, got 0 answers, remaining 1 packets\r\n>>> ans.show()\r\n>>> no_ans.show()\r\n0000 Ether / IP / TCP 101.100.100.66:texar > 201.200.0.64:italk S\r\n>>>\r\n```\r\n\r\n**Actual result**\r\n- No Answer\r\n\r\n**Expected result**\r\n- Answer\r\n\r\n**Related resources**\r\n[scapy_srp_missing_response.pcap.zip](https://github.com/secdev/scapy/files/4127937/scapy_srp_missing_response.pcap.zip)\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2447/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2447/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2434", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2434/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2434/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2434/events", "html_url": "https://github.com/secdev/scapy/pull/2434", "id": 554096631, "node_id": "MDExOlB1bGxSZXF1ZXN0MzY2MzExNjk5", "number": 2434, "title": "Fix EDecimal<->float arithmetic", "user": {"login": "mimeister", "id": 14336987, "node_id": "MDQ6VXNlcjE0MzM2OTg3", "avatar_url": "https://avatars.githubusercontent.com/u/14336987?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mimeister", "html_url": "https://github.com/mimeister", "followers_url": "https://api.github.com/users/mimeister/followers", "following_url": "https://api.github.com/users/mimeister/following{/other_user}", "gists_url": "https://api.github.com/users/mimeister/gists{/gist_id}", "starred_url": "https://api.github.com/users/mimeister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mimeister/subscriptions", "organizations_url": "https://api.github.com/users/mimeister/orgs", "repos_url": "https://api.github.com/users/mimeister/repos", "events_url": "https://api.github.com/users/mimeister/events{/privacy}", "received_events_url": "https://api.github.com/users/mimeister/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-01-23T11:22:29Z", "updated_at": "2020-02-01T18:32:33Z", "closed_at": "2020-02-01T18:32:33Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2434", "html_url": "https://github.com/secdev/scapy/pull/2434", "diff_url": "https://github.com/secdev/scapy/pull/2434.diff", "patch_url": "https://github.com/secdev/scapy/pull/2434.patch", "merged_at": "2020-02-01T18:32:33Z"}, "body": "### Fix broken arithmetic with Packet.time due to the introduction of `EDecimal` in b3bfc9b (#2352)\r\n\r\nThis pull request fixes arithmetic involving `Packet.time` and `float` values, that broke as a result of #2352, which introduced the class `EDecimal`.\r\nTo fix the problems any other value is converted to `Decimal` before calling the corresponding operator function of `Decimal`. In addition the appropriate functions for right values have been inserted.\r\n\r\n`run_tests_py2` and `run_tests_py3` show the same number of passes/fails as for the commit before (dcfb63d0).\r\n\r\nfixes #2433\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2434/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2434/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2433", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2433/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2433/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2433/events", "html_url": "https://github.com/secdev/scapy/issues/2433", "id": 554085776, "node_id": "MDU6SXNzdWU1NTQwODU3NzY=", "number": 2433, "title": "Broken Packet.time arithmetic involving float", "user": {"login": "mimeister", "id": 14336987, "node_id": "MDQ6VXNlcjE0MzM2OTg3", "avatar_url": "https://avatars.githubusercontent.com/u/14336987?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mimeister", "html_url": "https://github.com/mimeister", "followers_url": "https://api.github.com/users/mimeister/followers", "following_url": "https://api.github.com/users/mimeister/following{/other_user}", "gists_url": "https://api.github.com/users/mimeister/gists{/gist_id}", "starred_url": "https://api.github.com/users/mimeister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mimeister/subscriptions", "organizations_url": "https://api.github.com/users/mimeister/orgs", "repos_url": "https://api.github.com/users/mimeister/repos", "events_url": "https://api.github.com/users/mimeister/events{/privacy}", "received_events_url": "https://api.github.com/users/mimeister/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-01-23T11:00:34Z", "updated_at": "2020-02-01T18:32:33Z", "closed_at": "2020-02-01T18:32:33Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "#### Brief description\r\nThe introduction of `EDecimal` in  b3bfc9b (#2352) broke any arithmetic involving `Packet.time` and `float` values, if the packet was read from a pcap file.\r\n\r\n#### Environment\r\n\r\n-   Scapy version: `2.4.3.dev242`, dcfb63d0\r\n-   Python version: `2.7.17`\r\n-   Operating System: `Ubuntu 18.04`, but affects all\r\n\r\n#### How to reproduce\r\n\r\n```\r\n# Create a packet, write to pcap and read it back in. This creates a packet\r\n# that uses EDecimal as type of its time attribute due to fix #2352.\r\n# Of course one could also directly instantiate an EDecimal object\r\np = Ether()/IP()/TCP()\r\nwrpcap('sample.pcap', p)\r\nps = rdpcap('sample.pcap')\r\n\r\n# Any arithmetic with float results in an exception.\r\n# For EDecimal on the left a TypeError(\"Cannot convert %r to Decimal\" % value) is thrown\r\n# due to Decimal not supporting direct arithmetic with float\r\nx = ps[0].time + 2.5\r\nx = ps[0].time - 2.5\r\nx = ps[0].time * 2.5\r\n\r\n# For EDecimal on the right a 'TypeError: unsupported operand type(s)' is thrown\r\n# due to EDecimal not defining right hand side operators\r\nx = 2.5 + ps[0].time\r\nx = 2.5 - ps[0].time\r\nx = 2.5 * ps[0].time\r\n```\r\n\r\n#### Actual result\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/usr/local/lib/python2.7/dist-packages/scapy-2.4.3.dev227-py2.7.egg/scapy/utils.py\", line 67, in __mul__\r\n    return EDecimal(Decimal.__mul__(self, other, **kwargs))\r\n  File \"/usr/lib/python2.7/decimal.py\", line 657, in __new__\r\n    raise TypeError(\"Cannot convert %r to Decimal\" % value)\r\nTypeError: Cannot convert NotImplemented to Decimal\r\n```\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\nTypeError: unsupported operand type(s) for *: 'float' and 'EDecimal'\r\n```\r\n\r\n#### Expected result\r\n\r\nan `EDecimal` containing the result of the arithmetic operation\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2433/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2433/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2426", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2426/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2426/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2426/events", "html_url": "https://github.com/secdev/scapy/pull/2426", "id": 552829735, "node_id": "MDExOlB1bGxSZXF1ZXN0MzY1MjY1MzI3", "number": 2426, "title": "Fix L3 timestamps", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-01-21T11:53:52Z", "updated_at": "2020-02-02T18:38:52Z", "closed_at": "2020-02-02T17:54:20Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2426", "html_url": "https://github.com/secdev/scapy/pull/2426", "diff_url": "https://github.com/secdev/scapy/pull/2426.diff", "patch_url": "https://github.com/secdev/scapy/pull/2426.patch", "merged_at": "2020-02-02T17:54:20Z"}, "body": "Credits for the timestamp bug to Ron Henderson\r\n\r\nfix #2423\r\nfix #2425 \r\nfix #2277\r\nfix #2429", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2426/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2426/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2425", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2425/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2425/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2425/events", "html_url": "https://github.com/secdev/scapy/issues/2425", "id": 552808816, "node_id": "MDU6SXNzdWU1NTI4MDg4MTY=", "number": 2425, "title": "_recv_raw is breaking ISOTPNativeSockets", "user": {"login": "polybassa", "id": 1676055, "node_id": "MDQ6VXNlcjE2NzYwNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1676055?v=4", "gravatar_id": "", "url": "https://api.github.com/users/polybassa", "html_url": "https://github.com/polybassa", "followers_url": "https://api.github.com/users/polybassa/followers", "following_url": "https://api.github.com/users/polybassa/following{/other_user}", "gists_url": "https://api.github.com/users/polybassa/gists{/gist_id}", "starred_url": "https://api.github.com/users/polybassa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/polybassa/subscriptions", "organizations_url": "https://api.github.com/users/polybassa/orgs", "repos_url": "https://api.github.com/users/polybassa/repos", "events_url": "https://api.github.com/users/polybassa/events{/privacy}", "received_events_url": "https://api.github.com/users/polybassa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2020-01-21T11:11:10Z", "updated_at": "2020-02-02T17:54:20Z", "closed_at": "2020-02-02T17:54:20Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "@gpotter2 \r\nHi, on some hardware in the loop tests, we discovered the following error:\r\n```\r\nWARNING: Socket <scapy.contrib.isotp.ISOTPNativeSocket object at 0x7319dc70> failed with 'unpack requires a buffer of 16 bytes'. It was closed.\r\n```\r\nWe assume this error is fired from this line:\r\nhttps://github.com/secdev/scapy/blob/ae6b93b9263cab4319be463527b92d1edf13ce43/scapy/supersocket.py#L109\r\n\r\nUnfortunately, I don't know exactly whats going on here, but my ISOTPNativeSockets get closed on a receive. \r\n\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2425/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2425/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2423", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2423/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2423/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2423/events", "html_url": "https://github.com/secdev/scapy/issues/2423", "id": 552537012, "node_id": "MDU6SXNzdWU1NTI1MzcwMTI=", "number": 2423, "title": "Packet Timestamps being overwritten - Identified a Solution", "user": {"login": "rwhalb", "id": 12372340, "node_id": "MDQ6VXNlcjEyMzcyMzQw", "avatar_url": "https://avatars.githubusercontent.com/u/12372340?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rwhalb", "html_url": "https://github.com/rwhalb", "followers_url": "https://api.github.com/users/rwhalb/followers", "following_url": "https://api.github.com/users/rwhalb/following{/other_user}", "gists_url": "https://api.github.com/users/rwhalb/gists{/gist_id}", "starred_url": "https://api.github.com/users/rwhalb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rwhalb/subscriptions", "organizations_url": "https://api.github.com/users/rwhalb/orgs", "repos_url": "https://api.github.com/users/rwhalb/repos", "events_url": "https://api.github.com/users/rwhalb/events{/privacy}", "received_events_url": "https://api.github.com/users/rwhalb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1376928488, "node_id": "MDU6TGFiZWwxMzc2OTI4NDg4", "url": "https://api.github.com/repos/secdev/scapy/labels/major", "name": "major", "color": "FF0060", "default": false, "description": "Major changes"}], "state": "closed", "locked": false, "assignee": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-01-20T22:36:27Z", "updated_at": "2023-01-18T23:49:30Z", "closed_at": "2020-02-02T17:54:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\nI have installed the latest commit of scapy with the \"Rework Timestamp Detection\" commit: \r\n[#2401](https://github.com/secdev/scapy/commit/90c8d82070a9edaf0bbfe53b00db8dcf13154eed)\r\n\r\nI have determined that the packet received timestamp is being overwritten.\r\n#### Environment\r\n\r\n-   Scapy version: `v2.4.3-237.g90c8d820`\r\n-   Python version: `e.g. 3.7`\r\n-   Operating System: `e.g. Fedora 30 (NST 30)`\r\n\r\n\r\n#### How to reproduce\r\n\r\nUse the following script to send four (4) TCP sync packets to your default gateway. On a typical LAN you should get sub-milliseconds round-trip-time results. Substitute your default gateway for the 'dest' variable.\r\n\r\n```\r\n#\r\n# Scapy script to compute Round Trip Times (rrt)...\r\nfrom scapy.all import *\r\n\r\ndest = \"Your Gateway IPv4 Address\"\r\n\r\npkt = []\r\npkt_rst = []\r\nfor i in range(1, 5):\r\n    a = IP(dst=dest) / TCP(flags=\"S\", seq=i, sport=65000+i, dport=55556)\r\n    b = IP(dst=dest) / TCP(flags=\"R\", seq=i, sport=65000+i, dport=55556)\r\n    pkt.append(a)\r\n    pkt_rst.append(b)\r\n\r\nans, unans = sr(pkt, filter=\"host {0}\".format(dest), inter=0, timeout=1)\r\nsend(pkt_rst, inter=0)\r\n\r\nprint(\"scapy version: {}\".format(conf.version))\r\n\r\nfor pkt in ans:\r\n    sent = pkt[0]\r\n    received = pkt[1]\r\n    res = (received.time - sent.sent_time) * 1000\r\n    print(res)\r\n    if res < 0:\r\n        breakpoint()\r\n\r\n```\r\n#### Actual result\r\n\r\nMy source address: 10.222.222.10 (shopper2) and my gateway: 10.222.222.1:\r\n\r\n```\r\n[root@shopper2 opt]# python3 ./rrt-scapy.py \r\nBegin emission:\r\nFinished sending 4 packets.\r\n\r\nReceived 5 packets, got 4 answers, remaining 0 packets\r\n....\r\nSent 4 packets.\r\nscapy version: v2.4.3-237.g90c8d820\r\n9.302377700805664\r\n7.546901702880859\r\n5.416631698608398\r\n3.2846927642822266\r\n[root@shopper2 opt]#\r\n```\r\nAs you can see the round-trip-times are way to big.\r\n\r\n#### The Problem Area and Solution\r\n\r\nAfter much debugging I found that the received packet was being overwritten in the \"L3PacketSocket\" class. Normally I would submit a Pull Request. But in this case I am only solving for the Linux platform and I am uncertain if the fix will be the permanent solution.\r\n\r\nIn file \"arch/linux.py\"  I have preserved the received timestamp before assigning the \"pkt\" with the \"pkt.payload\" value:\r\n\r\nBefore:\r\n```\r\nclass L3PacketSocket(L2Socket):\r\n    desc = \"read/write packets at layer 3 using Linux PF_PACKET sockets\"\r\n\r\n    def recv(self, x=MTU):\r\n        pkt = SuperSocket.recv(self, x)\r\n        if pkt and self.lvl == 2:\r\n            pkt = pkt.payload\r\n        return pkt\r\n```\r\nAfter:\r\n```\r\nclass L3PacketSocket(L2Socket):\r\n    desc = \"read/write packets at layer 3 using Linux PF_PACKET sockets\"\r\n\r\n    def recv(self, x=MTU):\r\n        pkt = SuperSocket.recv(self, x)\r\n        if pkt and self.lvl == 2:\r\n            ts = pkt.time\r\n            pkt = pkt.payload\r\n            pkt.time = ts\r\n        return pkt\r\n```\r\n\r\nSuggestion: The \"pkt.time\" may could be renamed to \"pkt.recv_time\"\r\n\r\n#### Expected result\r\n\r\nAfter the modification is in place the following are the results:\r\n\r\n```\r\n[root@shopper2 opt]# python3 ./rrt-scapy.py \r\nBegin emission:\r\nFinished sending 4 packets.\r\n\r\nReceived 5 packets, got 4 answers, remaining 0 packets\r\n....\r\nSent 4 packets.\r\nscapy version: v2.4.3-237.g90c8d820\r\n0.43010711669921875\r\n0.34427642822265625\r\n0.28777122497558594\r\n0.2853870391845703\r\n[root@shopper2 opt]#\r\n```\r\nNow sub-millisecond round-trip-times are measured using TCP Sync packets. To verify lets do a ping to the gateway (10.222.222.1):\r\n\r\n```\r\n[root@shopper2 opt]# ping -c 4 -nv 10.222.222.1\r\nPING 10.222.222.1 (10.222.222.1) 56(84) bytes of data.\r\n64 bytes from 10.222.222.1: icmp_seq=1 ttl=64 time=0.413 ms\r\n64 bytes from 10.222.222.1: icmp_seq=2 ttl=64 time=0.327 ms\r\n64 bytes from 10.222.222.1: icmp_seq=3 ttl=64 time=0.339 ms\r\n64 bytes from 10.222.222.1: icmp_seq=4 ttl=64 time=0.331 ms\r\n\r\n--- 10.222.222.1 ping statistics ---\r\n4 packets transmitted, 4 received, 0% packet loss, time 100ms\r\nrtt min/avg/max/mdev = 0.327/0.352/0.413/0.039 ms\r\n[root@shopper2 opt]# \r\n```\r\nAs you can see the ICMP round-trip-time results agree nicely with the TCP Sync packets.\r\n\r\n#### Scapy Multi-Traceroute Add On: mtraceroute\r\nI will be announcing this scapy Multi-Traceroute add on feature: [mtraceroute](https://github.com/rwhalb/mtraceroute) once we get the packet timestamps corrected.\r\n\r\n---Ron Henderson\r\nCoAuthor of NST (Network Security Toolkit)", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2423/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2423/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2414", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2414/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2414/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2414/events", "html_url": "https://github.com/secdev/scapy/pull/2414", "id": 550700580, "node_id": "MDExOlB1bGxSZXF1ZXN0MzYzNTU4MTY4", "number": 2414, "title": "CDP & VTP - Missing Python3 conversion", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 564414240, "node_id": "MDU6TGFiZWw1NjQ0MTQyNDA=", "url": "https://api.github.com/repos/secdev/scapy/labels/convergence", "name": "convergence", "color": "c2e0c6", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-01-16T10:04:06Z", "updated_at": "2020-01-20T18:39:48Z", "closed_at": "2020-01-20T18:39:48Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2414", "html_url": "https://github.com/secdev/scapy/pull/2414", "diff_url": "https://github.com/secdev/scapy/pull/2414.diff", "patch_url": "https://github.com/secdev/scapy/pull/2414.patch", "merged_at": "2020-01-20T18:39:47Z"}, "body": "This PR fixes #2413.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2414/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2414/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2413", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2413/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2413/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2413/events", "html_url": "https://github.com/secdev/scapy/issues/2413", "id": 550626370, "node_id": "MDU6SXNzdWU1NTA2MjYzNzA=", "number": 2413, "title": "len(pkt) error for some packet like CDP/VTP", "user": {"login": "duychu", "id": 4672625, "node_id": "MDQ6VXNlcjQ2NzI2MjU=", "avatar_url": "https://avatars.githubusercontent.com/u/4672625?v=4", "gravatar_id": "", "url": "https://api.github.com/users/duychu", "html_url": "https://github.com/duychu", "followers_url": "https://api.github.com/users/duychu/followers", "following_url": "https://api.github.com/users/duychu/following{/other_user}", "gists_url": "https://api.github.com/users/duychu/gists{/gist_id}", "starred_url": "https://api.github.com/users/duychu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/duychu/subscriptions", "organizations_url": "https://api.github.com/users/duychu/orgs", "repos_url": "https://api.github.com/users/duychu/repos", "events_url": "https://api.github.com/users/duychu/events{/privacy}", "received_events_url": "https://api.github.com/users/duychu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-01-16T07:31:53Z", "updated_at": "2020-01-20T18:39:47Z", "closed_at": "2020-01-20T18:39:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\nI tried to test len of packet but found that python3.7+scapy does not work and raise below exception\r\n\r\nsome special packet that I have tried: CPD, VTP, \r\n\r\nIt is ok with python2.7\r\n```\r\nroot@trex:/tmp# python\r\nPython 2.7.12 (default, Nov 12 2018, 14:36:49) \r\n[GCC 5.4.0 20160609] on linux2\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> from scapy.contrib.cdp import *\r\n>>> from scapy.all import *\r\n>>> pkt=CDPv2_HDR(vers=2, ttl=180, msg='123')\r\n>>> len(pkt)\r\n7\r\n>>> \r\n```\r\n\r\npython3.7\r\n```\r\nroot@ubuntu:/workspace/_prototype/rtg-avatar# python\r\nPython 3.7.5 (default, Nov  7 2019, 10:50:52) \r\n[GCC 8.3.0] on linux\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> from scapy.all import *\r\n>>> from scapy.contrib import *\r\n>>> pkt=CDPv2_HDR(vers=2, ttl=180, msg='123')\r\n>>> len(pkt)\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/usr/local/lib/python3.7/dist-packages/scapy/packet.py\", line 522, in __len__\r\n    return len(self.__bytes__())\r\n  File \"/usr/local/lib/python3.7/dist-packages/scapy/packet.py\", line 487, in __bytes__\r\n    return self.build()\r\n  File \"/usr/local/lib/python3.7/dist-packages/scapy/packet.py\", line 607, in build\r\n    p = self.do_build()\r\n  File \"/usr/local/lib/python3.7/dist-packages/scapy/packet.py\", line 594, in do_build\r\n    return self.post_build(pkt, pay)\r\n  File \"/usr/local/lib/python3.7/dist-packages/scapy/contrib/cdp.py\", line 371, in post_build\r\n    cksum = checksum(self._check_len(p))\r\n  File \"/usr/local/lib/python3.7/dist-packages/scapy/contrib/cdp.py\", line 361, in _check_len\r\n    if last_chr <= b'\\x80':\r\nTypeError: '<=' not supported between instances of 'int' and 'bytes'\r\nError in sys.excepthook:\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/apport_python_hook.py\", line 63, in apport_excepthook\r\n    from apport.fileutils import likely_packaged, get_recent_crashes\r\n  File \"/usr/lib/python3/dist-packages/apport/__init__.py\", line 5, in <module>\r\n    from apport.report import Report\r\n  File \"/usr/lib/python3/dist-packages/apport/report.py\", line 30, in <module>\r\n    import apport.fileutils\r\n  File \"/usr/lib/python3/dist-packages/apport/fileutils.py\", line 23, in <module>\r\n    from apport.packaging_impl import impl as packaging\r\n  File \"/usr/lib/python3/dist-packages/apport/packaging_impl.py\", line 24, in <module>\r\n    import apt\r\n  File \"/usr/lib/python3/dist-packages/apt/__init__.py\", line 23, in <module>\r\n    import apt_pkg\r\nModuleNotFoundError: No module named 'apt_pkg'\r\n\r\nOriginal exception was:\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/usr/local/lib/python3.7/dist-packages/scapy/packet.py\", line 522, in __len__\r\n    return len(self.__bytes__())\r\n  File \"/usr/local/lib/python3.7/dist-packages/scapy/packet.py\", line 487, in __bytes__\r\n    return self.build()\r\n  File \"/usr/local/lib/python3.7/dist-packages/scapy/packet.py\", line 607, in build\r\n    p = self.do_build()\r\n  File \"/usr/local/lib/python3.7/dist-packages/scapy/packet.py\", line 594, in do_build\r\n    return self.post_build(pkt, pay)\r\n  File \"/usr/local/lib/python3.7/dist-packages/scapy/contrib/cdp.py\", line 371, in post_build\r\n    cksum = checksum(self._check_len(p))\r\n  File \"/usr/local/lib/python3.7/dist-packages/scapy/contrib/cdp.py\", line 361, in _check_len\r\n    if last_chr <= b'\\x80':\r\nTypeError: '<=' not supported between instances of 'int' and 'bytes'\r\n>>> \r\n```\r\n\r\n#### Environment\r\n\r\n-   Scapy version: `2.4.3`\r\n-   Python version: `3.7` and `2.7`\r\n-   Operating System: `Ubuntu18.04`\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2413/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2413/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2411", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2411/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2411/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2411/events", "html_url": "https://github.com/secdev/scapy/pull/2411", "id": 550228187, "node_id": "MDExOlB1bGxSZXF1ZXN0MzYzMTcxNzU0", "number": 2411, "title": "getlayer() logic changed from recursive to iterative", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-01-15T14:42:30Z", "updated_at": "2020-07-14T10:45:46Z", "closed_at": "2020-07-14T10:45:46Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2411", "html_url": "https://github.com/secdev/scapy/pull/2411", "diff_url": "https://github.com/secdev/scapy/pull/2411.diff", "patch_url": "https://github.com/secdev/scapy/pull/2411.patch", "merged_at": null}, "body": "This PR is the second fix for PR 2406. This patch makes it possible the malformed DNS packets that crashed Scapy.\r\n\r\nI did not find a way to easily reproduce the issue, and I am reluctant do add the 1.3KB malformed packet to the repository.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2411/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2411/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2408", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2408/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2408/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2408/events", "html_url": "https://github.com/secdev/scapy/pull/2408", "id": 549438607, "node_id": "MDExOlB1bGxSZXF1ZXN0MzYyNTMwOTUz", "number": 2408, "title": "Make sure that a valid TCP over DNS message can be decoded", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-01-14T09:29:25Z", "updated_at": "2020-01-20T18:38:31Z", "closed_at": "2020-01-20T18:38:31Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2408", "html_url": "https://github.com/secdev/scapy/pull/2408", "diff_url": "https://github.com/secdev/scapy/pull/2408.diff", "patch_url": "https://github.com/secdev/scapy/pull/2408.patch", "merged_at": "2020-01-20T18:38:31Z"}, "body": "This PR partially fixes 2406. It is the root cause of the issue that triggers the recursion loop.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2408/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2408/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2406", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2406/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2406/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2406/events", "html_url": "https://github.com/secdev/scapy/issues/2406", "id": 548200802, "node_id": "MDU6SXNzdWU1NDgyMDA4MDI=", "number": 2406, "title": "Recursion error: maximum recursion depth exceeded with scapy 2.4.3 on Fedora Linux", "user": {"login": "william-stearns", "id": 3538265, "node_id": "MDQ6VXNlcjM1MzgyNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/3538265?v=4", "gravatar_id": "", "url": "https://api.github.com/users/william-stearns", "html_url": "https://github.com/william-stearns", "followers_url": "https://api.github.com/users/william-stearns/followers", "following_url": "https://api.github.com/users/william-stearns/following{/other_user}", "gists_url": "https://api.github.com/users/william-stearns/gists{/gist_id}", "starred_url": "https://api.github.com/users/william-stearns/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/william-stearns/subscriptions", "organizations_url": "https://api.github.com/users/william-stearns/orgs", "repos_url": "https://api.github.com/users/william-stearns/repos", "events_url": "https://api.github.com/users/william-stearns/events{/privacy}", "received_events_url": "https://api.github.com/users/william-stearns/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2020-01-10T17:25:55Z", "updated_at": "2020-07-14T10:46:59Z", "closed_at": "2020-07-14T10:46:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm able to reproduce this with scapy 2.4.3 on Fedora Linux.  I have a pcap file containing ipv4 tcp port 53 packets that when run through passer ( https://github.com/activecm/passer/ ) gives the following: \r\n\r\nTraceback (most recent call last):\r\n  File \"/home/wstearns/med/programming/passer/passer.py\", line 2428, in <module>\r\n    sniff(store=0, offline=work_filename, filter=cl_args['bpf'], prn=lambda x: processpacket(x))\r\n  File \"/usr/lib/python3.5/site-packages/scapy/sendrecv.py\", line 972, in sniff\r\n    sniffer._run(*args, **kwargs)\r\n  File \"/usr/lib/python3.5/site-packages/scapy/sendrecv.py\", line 925, in _run\r\n    session.on_packet_received(p)\r\n  File \"/usr/lib/python3.5/site-packages/scapy/sessions.py\", line 47, in on_packet_received\r\n    result = self.prn(pkt)\r\n  File \"/home/wstearns/med/programming/passer/passer.py\", line 2428, in <lambda>\r\n    sniff(store=0, offline=work_filename, filter=cl_args['bpf'], prn=lambda x: processpacket(x))\r\n  File \"/home/wstearns/med/programming/passer/passer.py\", line 1714, in processpacket\r\n    if p.getlayer(Raw):\r\n  File \"/usr/lib/python3.5/site-packages/scapy/packet.py\", line 1148, in getlayer\r\n    _subclass=_subclass, **flt)\r\n  File \"/usr/lib/python3.5/site-packages/scapy/packet.py\", line 1148, in getlayer\r\n    _subclass=_subclass, **flt)\r\n  File \"/usr/lib/python3.5/site-packages/scapy/packet.py\", line 1148, in getlayer\r\n    _subclass=_subclass, **flt)\r\n...\r\n  File \"/usr/lib/python3.5/site-packages/scapy/packet.py\", line 1148, in getlayer\r\n    _subclass=_subclass, **flt)\r\n  File \"/usr/lib/python3.5/site-packages/scapy/packet.py\", line 1148, in getlayer\r\n    _subclass=_subclass, **flt)\r\n  File \"/usr/lib/python3.5/site-packages/scapy/packet.py\", line 1115, in getlayer\r\n    if isinstance(cls, int):\r\nRecursionError: maximum recursion depth exceeded while calling a Python object\r\n\r\nCommand line used:\r\npasser.py -r scapy243.recursion_issue.notudp.port53.notip6.pcap >/dev/null\r\n\r\n    For reference:\r\n- I also have a second pcap with **ipv6** tcp port 53 packets that causes the same crash.\r\n- Simply feeding that same pcap file into a python/scapy script that does a \"sniff(...)\" of the packets and doesn't do anything with them does _not_ crash scapy with this error.  (Let me know if you'd like a copy of that script)\r\n- To reproduce, you'll need passer.py and passer_lib.py in the same directory - both can be downloaded from https://github.com/activecm/passer/ .  You'll also need the ipaddress and pytz libraries.\r\n    Please let me know if I can provide anything else to reproduce this.\r\n\r\n[scapy243.recursion_issue.notudp.port53.notip6.pcap.zip](https://github.com/secdev/scapy/files/4046795/scapy243.recursion_issue.notudp.port53.notip6.pcap.zip)\r\n\r\n_Originally posted by @william-stearns in https://github.com/secdev/scapy/issues/1552#issuecomment-573126565_", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2406/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2406/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2393", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2393/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2393/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2393/events", "html_url": "https://github.com/secdev/scapy/issues/2393", "id": 543885317, "node_id": "MDU6SXNzdWU1NDM4ODUzMTc=", "number": 2393, "title": "ARP issue", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-12-30T13:44:41Z", "updated_at": "2019-12-31T08:53:08Z", "closed_at": "2019-12-31T08:53:08Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I'm pretty sure this shouldn't crash\r\n\r\n```python\r\na = Ether(dst='64:A2:F9:A9:2E:A9')/ARP(pdst='192.168.178.0/24')\r\na.show()\r\n\r\nAttributeError         \r\nTraceback (most recent call last)<ipython-input-18-97d3136b2c17> in <module>\r\n----> 1 a.show()\r\n\r\n/netdisk/home/gpotter/github/scapy/scapy/packet.py in show(self, dump, indent, lvl, label_lvl)\r\n   1251         :return: return a hierarchical view if dump, else print it\r\n   1252         \"\"\"\r\n-> 1253         return self._show_or_dump(dump, indent, lvl, label_lvl)\r\n   1254 \r\n   1255     def show2(self, dump=False, indent=3, lvl=\"\", label_lvl=\"\"):\r\n\r\n/netdisk/home/gpotter/github/scapy/scapy/packet.py in _show_or_dump(self, dump, indent, lvl, label_lvl, first_call)\r\n   1225                                          ncol(f.name),\r\n   1226                                          ct.punct(\"=\"),)\r\n-> 1227                 reprval = f.i2repr(self, fvalue)   \r\n1228                 if isinstance(reprval, str):\r\n   1229                     reprval = reprval.replace(\"\\n\", \"\\n\" + \" \" * (len(label_lvl) +  # noqa: E501\r\n\r\n/netdisk/home/gpotter/github/scapy/scapy/fields.py in i2repr(self, pkt, x)\r\n    513 \r\n    514     def i2repr(self, pkt, x):\r\n--> 515         x = self.i2h(pkt, x)\r\n    516         if self in conf.resolve:\r\n    517             x = conf.manufdb._resolve_MAC(x)\r\n\r\n/netdisk/home/gpotter/github/scapy/scapy/layers/l2.py in i2h(self, pkt, x)\r\n    140     def i2h(self, pkt, x):\r\n    141         if x is None:\r\n--> 142             iff = self.getif(pkt)\r\n    143             if iff is None:\r\n    144                 iff = conf.iface\r\n\r\n/netdisk/home/gpotter/github/scapy/scapy/layers/l2.py in <lambda>(pkt)\r\n    136     def __init__(self, name, getif=None):\r\n    137         MACField.__init__(self, name, None)\r\n--> 138         self.getif = (lambda pkt: pkt.route()[0]) if getif is None else getif\r\n    139 \r\n    140     def i2h(self, pkt, x):\r\n\r\n/netdisk/home/gpotter/github/scapy/scapy/packet.py in route(self)\r\n   1175 \r\n   1176     def route(self):\r\n-> 1177         return self.payload.route()\r\n   1178 \r\n   1179     def fragment(self, *args, **kargs):\r\n\r\n/netdisk/home/gpotter/github/scapy/scapy/layers/l2.py in route(self)\r\n    411     def route(self):\r\n    412         fld, dst = self.getfield_and_val(\"pdst\")--> 413         fld, dst = fld._find_fld_pkt_val(self, dst)\r\n    414         if isinstance(dst, Gen):\r\n    415             dst = next(iter(dst))\r\n\r\n/netdisk/home/gpotter/github/scapy/scapy/fields.py in _find_fld_pkt_val(self, pkt, val)\r\n    324         # Default ? (in this case, let's make sure it's up-do-date)\r\n    325         dflts_pkt = pkt.default_fields\r\n--> 326         if val == dflts_pkt[self.name] and self.name not in pkt.fields:\r\n    327             dflts_pkt[self.name] = fld.default\r\n    328             val = fld.default\r\n\r\n/netdisk/home/gpotter/github/scapy/scapy/base_classes.py in __eq__(self, other)\r\n    131             p2 = other.parsed\r\n    132         else:\r\n--> 133             p2, nm2 = self._parse_net(other)\r\n    134         return self.parsed == p2\r\n    135 \r\n\r\n/netdisk/home/gpotter/github/scapy/scapy/base_classes.py in _parse_net(cls, net)\r\n     97     @classmethod\r\n     98     def _parse_net(cls, net):\r\n---> 99         tmp = net.split('/') + [\"32\"]\r\n    100         if not cls.ip_regex.match(net):\r\n    101             tmp[0] = socket.gethostbyname(tmp[0])\r\n\r\nAttributeError: 'NoneType' object has no attribute 'split'\r\n```", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2393/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2393/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2364", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2364/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2364/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2364/events", "html_url": "https://github.com/secdev/scapy/pull/2364", "id": 533824261, "node_id": "MDExOlB1bGxSZXF1ZXN0MzQ5ODI4NzA1", "number": 2364, "title": "Do not add an unused conditional field in packet fields", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2019-12-06T08:44:49Z", "updated_at": "2020-12-17T14:38:22Z", "closed_at": "2020-12-17T14:38:22Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2364", "html_url": "https://github.com/secdev/scapy/pull/2364", "diff_url": "https://github.com/secdev/scapy/pull/2364.diff", "patch_url": "https://github.com/secdev/scapy/pull/2364.patch", "merged_at": "2020-12-17T14:38:22Z"}, "body": "This PR fixes #2363.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2364/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2364/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2363", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2363/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2363/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2363/events", "html_url": "https://github.com/secdev/scapy/issues/2363", "id": 533524688, "node_id": "MDU6SXNzdWU1MzM1MjQ2ODg=", "number": 2363, "title": "Error when dissecting packet with conditional fields", "user": {"login": "LRGH", "id": 7622014, "node_id": "MDQ6VXNlcjc2MjIwMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/7622014?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LRGH", "html_url": "https://github.com/LRGH", "followers_url": "https://api.github.com/users/LRGH/followers", "following_url": "https://api.github.com/users/LRGH/following{/other_user}", "gists_url": "https://api.github.com/users/LRGH/gists{/gist_id}", "starred_url": "https://api.github.com/users/LRGH/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LRGH/subscriptions", "organizations_url": "https://api.github.com/users/LRGH/orgs", "repos_url": "https://api.github.com/users/LRGH/repos", "events_url": "https://api.github.com/users/LRGH/events{/privacy}", "received_events_url": "https://api.github.com/users/LRGH/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-12-05T18:39:18Z", "updated_at": "2020-12-17T14:38:22Z", "closed_at": "2020-12-17T14:38:22Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nWhen dissecting a packet, fields that don't fulfill a condition can have the value None.\r\n\r\n#### Environment\r\n\r\n-   Scapy version: last commit 236102447f41f9818a09cde91c83af472b9b7383 but also old scapy such as version 2.3.3\r\n-   Python version: python2 and python3\r\n-   Operating System: independent of th OS\r\n\r\n#### How to reproduce\r\n\r\n```\r\nclass TEST_COND(Packet):\r\n    fields_desc = [\r\n        IntField(\"A\", 0),\r\n        ConditionalField(IntField(\"A0\",0), lambda pkt:pkt.A == 0),\r\n        ConditionalField(IntField(\"A1\",0), lambda pkt:pkt.A != 0),\r\n        IntField(\"B\", 0),\r\n        ConditionalField(IntField(\"B0\",0), lambda pkt:pkt.B == 0),\r\n        ConditionalField(IntField(\"B1\",0), lambda pkt:pkt.B != 0),\r\n        ]\r\n\r\nTEST_COND(TEST_COND().build()).fields\r\n```\r\n\r\n#### Actual result\r\n\r\n```\r\n{'A': 0, 'A0': 0, 'B': 0, 'A1': None, 'B0': 0}\r\n```\r\n\r\n#### Expected result\r\n\r\n```\r\n{'A': 0, 'A0': 0, 'B': 0, 'B0': 0}\r\n```\r\n\r\n#### Related resources\r\n\r\nNone", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2363/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2363/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2356", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2356/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2356/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2356/events", "html_url": "https://github.com/secdev/scapy/pull/2356", "id": 530784650, "node_id": "MDExOlB1bGxSZXF1ZXN0MzQ3MzYzNzAx", "number": 2356, "title": "Select the network interface in send()", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 564414240, "node_id": "MDU6TGFiZWw1NjQ0MTQyNDA=", "url": "https://api.github.com/repos/secdev/scapy/labels/convergence", "name": "convergence", "color": "c2e0c6", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2019-12-01T19:48:21Z", "updated_at": "2020-05-08T16:05:39Z", "closed_at": "2020-05-08T16:05:39Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2356", "html_url": "https://github.com/secdev/scapy/pull/2356", "diff_url": "https://github.com/secdev/scapy/pull/2356.diff", "patch_url": "https://github.com/secdev/scapy/pull/2356.patch", "merged_at": "2020-05-08T16:05:39Z"}, "body": "This PR fixes #2355.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2356/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2356/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2352", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2352/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2352/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2352/events", "html_url": "https://github.com/secdev/scapy/pull/2352", "id": 530431452, "node_id": "MDExOlB1bGxSZXF1ZXN0MzQ3MTE1MDE2", "number": 2352, "title": "Fix #2342", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-11-29T16:49:50Z", "updated_at": "2020-07-19T09:17:32Z", "closed_at": "2019-12-09T08:47:17Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2352", "html_url": "https://github.com/secdev/scapy/pull/2352", "diff_url": "https://github.com/secdev/scapy/pull/2352.diff", "patch_url": "https://github.com/secdev/scapy/pull/2352.patch", "merged_at": "2019-12-09T08:47:17Z"}, "body": "fixed #2342 ", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2352/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2352/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2344", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2344/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2344/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2344/events", "html_url": "https://github.com/secdev/scapy/issues/2344", "id": 528802905, "node_id": "MDU6SXNzdWU1Mjg4MDI5MDU=", "number": 2344, "title": "contrib/cdp.py CDPMsgIPPrefix class has wrong format", "user": {"login": "y0ny0ns0n", "id": 47174372, "node_id": "MDQ6VXNlcjQ3MTc0Mzcy", "avatar_url": "https://avatars.githubusercontent.com/u/47174372?v=4", "gravatar_id": "", "url": "https://api.github.com/users/y0ny0ns0n", "html_url": "https://github.com/y0ny0ns0n", "followers_url": "https://api.github.com/users/y0ny0ns0n/followers", "following_url": "https://api.github.com/users/y0ny0ns0n/following{/other_user}", "gists_url": "https://api.github.com/users/y0ny0ns0n/gists{/gist_id}", "starred_url": "https://api.github.com/users/y0ny0ns0n/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/y0ny0ns0n/subscriptions", "organizations_url": "https://api.github.com/users/y0ny0ns0n/orgs", "repos_url": "https://api.github.com/users/y0ny0ns0n/repos", "events_url": "https://api.github.com/users/y0ny0ns0n/events{/privacy}", "received_events_url": "https://api.github.com/users/y0ny0ns0n/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-11-26T15:34:13Z", "updated_at": "2019-12-04T19:26:30Z", "closed_at": "2019-12-04T19:26:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Things to consider\r\n\r\n#### Brief description\r\n\r\n[CDPMsgIPPrefix class](https://github.com/secdev/scapy/blob/2be23d9/scapy/contrib/cdp.py#L236) has following fields\r\n```python\r\nclass CDPMsgIPPrefix(CDPMsgGeneric):\r\n    name = \"IP Prefix\"\r\n    type = 0x0007\r\n    fields_desc = [XShortEnumField(\"type\", 0x0007, _cdp_tlv_types),\r\n                   ShortField(\"len\", 8),\r\n                   IPField(\"defaultgw\", \"192.168.0.1\")]\r\n```\r\nBut in real CDP(Cisco Discovery Protocol) packet, IP Prefixes has A.B.C.D/netmask format\r\n```\r\nIP Prefix: 20.0.0.0/24\r\n14 00 00 00 18\r\n```\r\nquoted from [wireshark](https://github.com/wireshark/wireshark/blob/e206eb2/epan/dissectors/packet-cdp.c#L471)\r\n\r\n#### Environment\r\n\r\n-   Scapy version: `2.4.3`\r\n-   Python version: `2.7.13`\r\n-   Operating System: `Windows 10 64bit Pro`\r\n\r\n#### How to reproduce\r\n\r\n\r\n#### Actual result\r\n![image](https://user-images.githubusercontent.com/47174372/69647196-66014500-10ac-11ea-9439-34171829bf67.png)\r\n![image](https://user-images.githubusercontent.com/47174372/69647289-8df0a880-10ac-11ea-9d29-2b704afe90c7.png)\r\n\r\n\r\n#### Expected result\r\n\r\n\r\n\r\n#### Related resources\r\n\r\n[test.pcap.zip](https://github.com/secdev/scapy/files/3892593/test.pcap.zip)\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2344/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2344/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2342", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2342/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2342/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2342/events", "html_url": "https://github.com/secdev/scapy/issues/2342", "id": 527568973, "node_id": "MDU6SXNzdWU1Mjc1Njg5NzM=", "number": 2342, "title": "Pcap timestamp nanoseconds not equal to Wireshark", "user": {"login": "m2martin", "id": 58110823, "node_id": "MDQ6VXNlcjU4MTEwODIz", "avatar_url": "https://avatars.githubusercontent.com/u/58110823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/m2martin", "html_url": "https://github.com/m2martin", "followers_url": "https://api.github.com/users/m2martin/followers", "following_url": "https://api.github.com/users/m2martin/following{/other_user}", "gists_url": "https://api.github.com/users/m2martin/gists{/gist_id}", "starred_url": "https://api.github.com/users/m2martin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/m2martin/subscriptions", "organizations_url": "https://api.github.com/users/m2martin/orgs", "repos_url": "https://api.github.com/users/m2martin/repos", "events_url": "https://api.github.com/users/m2martin/events{/privacy}", "received_events_url": "https://api.github.com/users/m2martin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-11-23T15:13:34Z", "updated_at": "2019-12-09T08:47:17Z", "closed_at": "2019-12-09T08:47:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\nThe timestamp of Pcap or PcapNG files read using rdpcap() are interpreted differently to Wireshark.\r\n\r\n#### Environment\r\nScapy Version: 2.4.3.dev170\r\nPython: 3.7.5\r\nOS: Kali 2019.4 (Linux kali 5.3.0-kali2-amd64 #1 SMP Debian 5.3.9-3kali1 (2019-11-20) x86_64 GNU/Linux)\r\nWireshark: 3.0.5-1on Linux\r\nCross-checked timestamp on Windows with Wireshark 3.0.6-0\r\nProfiShark Manager: 2.5.54\r\n\r\n#### How to reproduce\r\n\r\nOpen a Pcap or PcapNG file of your choice with data in nanosecond resolution.\r\nTo reproduce the 10\u00b3 factor error you need a capture from ProfiTAP's ProfiShark.\r\n\r\nExample view in Wireshark:\r\n\r\n![image](https://user-images.githubusercontent.com/58110823/69479871-7abab000-0e02-11ea-957a-475db5ca9e9f.png)\r\n\r\nPlain text timestamp: 2019-11-15 15:00:16.444223380\r\n\r\nCode used in Scapy:\r\n\r\n```python\r\npcap = rdpcap('c1.pcapng', 1)\r\nfor p in pcap:\r\n    print(p.time)\r\n```\r\n\r\n#### Actual result\r\n\r\nOutput displayed:\r\n```\r\n1573830016444.2234\r\n```\r\n\r\nAdding some formatter:\r\n\r\n```python\r\npcap = rdpcap('c1.pcapng', 1)\r\nfor p in pcap:\r\n    print(p.time)\r\n    print(p.time/1000)\r\n    print('%.9f' % (p.time/1000))\r\n```\r\n\r\nResults:\r\n```\r\n1573830016444.2234\r\n1573830016.4442234\r\n1573830016.444223404\r\n```\r\n\r\nActual problems:\r\n* Timestamp is wrong by factor 10\u00b3 (only from ProfiShark files)\r\n* Timestamp is wrong by 24 ns\r\n\r\n#### Expected result\r\n\r\nI expected to get exactly the same timestamp as seen in Wireshark.\r\n\r\n#### Related information\r\n\r\nChanging `read_packet` in `utils.py`\r\n```python\r\np.time = float((tshigh << 32) + tslow) / tsresol\r\n```\r\nto\r\n```python\r\np.time = Decimal((tshigh << 32) + tslow) / tsresol\r\n```\r\nseem to resolve the conversion problem.\r\n\r\nPrinting the `options = block[16:]` variable in `read_block_idb` looks like the following.\r\n\r\n_Wireshark saved capture:_\r\n```\r\nb'\\t\\x00\\x01\\x00\\t\\x00\\x00\\x00\\x0c\\x00\\x17\\x00Linux 5.3.0-kali2-amd64\\x00\\x00\\x00\\x00\\x00'\r\n```\r\n\r\n_ProfiShark saved capture:_\r\n```\r\nb'\\x00\\x00\\x00\\x00'\r\nb'\\x00\\x00\\x00\\x00'\r\nb'\\x00\\x00\\x00\\x00'\r\nb'\\x00\\x00\\x00\\x00'\r\n```\r\n\r\nI think this leads to the default value of `tsresol = 1000000`.\r\n\r\nI don't know if ProfiShark breaks the PcapNG format here or if it's a Scapy issue. Nevertheless, Wireshark does not have any problem to open the ProfiShark files.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2342/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2342/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2331", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2331/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2331/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2331/events", "html_url": "https://github.com/secdev/scapy/issues/2331", "id": 519416241, "node_id": "MDU6SXNzdWU1MTk0MTYyNDE=", "number": 2331, "title": "-OO flag TypeError", "user": {"login": "MVCionOld", "id": 23655312, "node_id": "MDQ6VXNlcjIzNjU1MzEy", "avatar_url": "https://avatars.githubusercontent.com/u/23655312?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MVCionOld", "html_url": "https://github.com/MVCionOld", "followers_url": "https://api.github.com/users/MVCionOld/followers", "following_url": "https://api.github.com/users/MVCionOld/following{/other_user}", "gists_url": "https://api.github.com/users/MVCionOld/gists{/gist_id}", "starred_url": "https://api.github.com/users/MVCionOld/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MVCionOld/subscriptions", "organizations_url": "https://api.github.com/users/MVCionOld/orgs", "repos_url": "https://api.github.com/users/MVCionOld/repos", "events_url": "https://api.github.com/users/MVCionOld/events{/privacy}", "received_events_url": "https://api.github.com/users/MVCionOld/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-11-07T17:43:54Z", "updated_at": "2019-11-11T13:24:18Z", "closed_at": "2019-11-11T13:24:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "https://github.com/secdev/scapy/blob/0712f1efcf6d33ec83bb41488cfdf036bcf5b7b0/scapy/sendrecv.py#L558\r\n\r\nChange\r\n```python\r\n sr_func.__doc__ += _DOC_SNDRCV_PARAMS\r\n```\r\nto\r\n```python\r\n sr_func.__doc__ = __str__(sr_func.__doc__) + _DOC_SNDRCV_PARAMS\r\n```\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2331/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2331/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2322", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2322/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2322/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2322/events", "html_url": "https://github.com/secdev/scapy/issues/2322", "id": 516571058, "node_id": "MDU6SXNzdWU1MTY1NzEwNTg=", "number": 2322, "title": "IPsec GCM padding wrong.", "user": {"login": "choppsv1", "id": 3074665, "node_id": "MDQ6VXNlcjMwNzQ2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/3074665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/choppsv1", "html_url": "https://github.com/choppsv1", "followers_url": "https://api.github.com/users/choppsv1/followers", "following_url": "https://api.github.com/users/choppsv1/following{/other_user}", "gists_url": "https://api.github.com/users/choppsv1/gists{/gist_id}", "starred_url": "https://api.github.com/users/choppsv1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/choppsv1/subscriptions", "organizations_url": "https://api.github.com/users/choppsv1/orgs", "repos_url": "https://api.github.com/users/choppsv1/repos", "events_url": "https://api.github.com/users/choppsv1/events{/privacy}", "received_events_url": "https://api.github.com/users/choppsv1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-11-02T12:01:14Z", "updated_at": "2022-06-07T09:06:08Z", "closed_at": "2022-06-07T09:06:08Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "#### Things to consider\r\n\r\n#### Brief description\r\n\r\nipsec.py incorrectly uses AES block size (16) to pad ESP with GCM (at least). ESP with GCM does not require this padding, and it could result in packets not being delivered (e.g., MTU violation).\r\n\r\nhttps://www.rfc-editor.org/rfc/rfc4106.txt\r\n\r\n```\r\n   Implementations that do not seek to hide the length of the plaintext\r\n   SHOULD use the minimum amount of padding required, which will be less\r\n   than four octets.\r\n```\r\n\r\n#### How to reproduce\r\n\r\nSetup a GCM-256 based IPsec SA and construct a packet with an ipsec payload of 1446 which should result in a IPsec packet of lenth 1500. \r\n\r\n1446 + 20 (iphdr) + 8 (esphdr) + 2 (espfoot) + 8(iv) + 16(icv) = 1500\r\n\r\n#### Actual result\r\n\r\nIPsec packet described above is incorrectly padded 8 bytes resulting in a packet 1508 bytes long.\r\n\r\n#### Expected result\r\n\r\nIPsec packet should be 1500 bytes long.\r\n\r\n#### Related resources\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2322/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2322/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2321", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2321/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2321/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2321/events", "html_url": "https://github.com/secdev/scapy/issues/2321", "id": 516382575, "node_id": "MDU6SXNzdWU1MTYzODI1NzU=", "number": 2321, "title": "on win32 -- AttributeError in open_pcap()", "user": {"login": "skewty", "id": 9087223, "node_id": "MDQ6VXNlcjkwODcyMjM=", "avatar_url": "https://avatars.githubusercontent.com/u/9087223?v=4", "gravatar_id": "", "url": "https://api.github.com/users/skewty", "html_url": "https://github.com/skewty", "followers_url": "https://api.github.com/users/skewty/followers", "following_url": "https://api.github.com/users/skewty/following{/other_user}", "gists_url": "https://api.github.com/users/skewty/gists{/gist_id}", "starred_url": "https://api.github.com/users/skewty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/skewty/subscriptions", "organizations_url": "https://api.github.com/users/skewty/orgs", "repos_url": "https://api.github.com/users/skewty/repos", "events_url": "https://api.github.com/users/skewty/events{/privacy}", "received_events_url": "https://api.github.com/users/skewty/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1265179855, "node_id": "MDU6TGFiZWwxMjY1MTc5ODU1", "url": "https://api.github.com/repos/secdev/scapy/labels/platform-specific", "name": "platform-specific", "color": "14acba", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-11-01T22:40:24Z", "updated_at": "2020-01-13T19:22:59Z", "closed_at": "2020-01-13T19:22:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n#### Brief description\r\n\r\nIn Windows  with SCAPY 2.4.3\r\n\r\n### `scapy/arch/windows/__init__.py`\r\n\r\n```py\r\n    def open_pcap(iface, *args, **kargs):\r\n        \"\"\"open_pcap: Windows routine for creating a pcap from an interface.\r\n        This function is also responsible for detecting monitor mode.\r\n        \"\"\"\r\n        iface_pcap_name = pcapname(iface)\r\n        if not isinstance(iface, NetworkInterface) and \\\r\n           iface_pcap_name is not None:\r\n            iface = IFACES.dev_from_name(iface)\r\n        if iface.is_invalid():\r\n            raise Scapy_Exception(\r\n                \"Interface is invalid (no pcap match found) !\"\r\n            )\r\n\r\ndef pcapname(dev):\r\n    \"\"\"Get the device pcap name by device name or Scapy NetworkInterface\r\n\r\n    \"\"\"\r\n    if isinstance(dev, NetworkInterface):\r\n        if dev.is_invalid():\r\n            return None\r\n        return dev.pcap_name\r\n    try:\r\n        return IFACES.dev_from_name(dev).pcap_name\r\n    except ValueError:\r\n        return IFACES.dev_from_pcapname(dev).pcap_name\r\n```\r\n\r\nWhen `iface` parameter is specified by `if_entry['name']` (from `get_windows_if_list()`) instead of `class NetworkInterface` and the interface name is valid but `pcapname()` returns `None` (because `IFACES.dev_from_name(dev)` worked but `.pcap_name` is `None`) then `if iface.is_invalid()` is called when iface is still just a `str` so `AttributeError` is raised.\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2321/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2321/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2318", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2318/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2318/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2318/events", "html_url": "https://github.com/secdev/scapy/issues/2318", "id": 514051492, "node_id": "MDU6SXNzdWU1MTQwNTE0OTI=", "number": 2318, "title": "Broken sendp(realtime=True)", "user": {"login": "b-x", "id": 3099384, "node_id": "MDQ6VXNlcjMwOTkzODQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3099384?v=4", "gravatar_id": "", "url": "https://api.github.com/users/b-x", "html_url": "https://github.com/b-x", "followers_url": "https://api.github.com/users/b-x/followers", "following_url": "https://api.github.com/users/b-x/following{/other_user}", "gists_url": "https://api.github.com/users/b-x/gists{/gist_id}", "starred_url": "https://api.github.com/users/b-x/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/b-x/subscriptions", "organizations_url": "https://api.github.com/users/b-x/orgs", "repos_url": "https://api.github.com/users/b-x/repos", "events_url": "https://api.github.com/users/b-x/events{/privacy}", "received_events_url": "https://api.github.com/users/b-x/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-10-29T16:23:56Z", "updated_at": "2019-10-30T11:11:59Z", "closed_at": "2019-10-30T11:11:59Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "`sendp(..., realtime=True)` is broken in scapy 2.4.3\r\nIt produces TypeError:\r\n\r\n```\r\nFile \"/usr/local/lib/python3.7/dist-packages/scapy/sendrecv.py\", line 290, in __gen_send\r\n    dt0 = ct - p.time\r\nTypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'\r\n```\r\n\r\nThe issue is introduced by this commit:\r\nebd4e26d - fix double precision for timestamp (4 months ago) <Sergey Platonov>\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2318/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2318/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2308", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2308/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2308/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2308/events", "html_url": "https://github.com/secdev/scapy/pull/2308", "id": 511870081, "node_id": "MDExOlB1bGxSZXF1ZXN0MzMxOTg2NzE4", "number": 2308, "title": "Fix padding byte in Dot11EltCountry", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-10-24T11:00:50Z", "updated_at": "2019-10-24T14:39:44Z", "closed_at": "2019-10-24T13:31:13Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2308", "html_url": "https://github.com/secdev/scapy/pull/2308", "diff_url": "https://github.com/secdev/scapy/pull/2308.diff", "patch_url": "https://github.com/secdev/scapy/pull/2308.patch", "merged_at": "2019-10-24T13:31:12Z"}, "body": "Rebase of https://github.com/secdev/scapy/pull/2251\r\n\r\n- fixes https://github.com/secdev/scapy/issues/2248\r\n- fixes https://github.com/secdev/scapy/pull/2251\r\n- fixes https://github.com/secdev/scapy/issues/2268\r\n\r\nIncludes test by @hennadiy-demchenko", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2308/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2308/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2275", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2275/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2275/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2275/events", "html_url": "https://github.com/secdev/scapy/pull/2275", "id": 505179248, "node_id": "MDExOlB1bGxSZXF1ZXN0MzI2NjYyMTQy", "number": 2275, "title": "fix dissection of ipfix template with enterprise-specific Information Elements.", "user": {"login": "ir193", "id": 1735719, "node_id": "MDQ6VXNlcjE3MzU3MTk=", "avatar_url": "https://avatars.githubusercontent.com/u/1735719?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ir193", "html_url": "https://github.com/ir193", "followers_url": "https://api.github.com/users/ir193/followers", "following_url": "https://api.github.com/users/ir193/following{/other_user}", "gists_url": "https://api.github.com/users/ir193/gists{/gist_id}", "starred_url": "https://api.github.com/users/ir193/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ir193/subscriptions", "organizations_url": "https://api.github.com/users/ir193/orgs", "repos_url": "https://api.github.com/users/ir193/repos", "events_url": "https://api.github.com/users/ir193/events{/privacy}", "received_events_url": "https://api.github.com/users/ir193/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 267691054, "node_id": "MDU6TGFiZWwyNjc2OTEwNTQ=", "url": "https://api.github.com/repos/secdev/scapy/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-10-10T10:27:37Z", "updated_at": "2019-10-22T11:09:35Z", "closed_at": "2019-10-22T11:09:27Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2275", "html_url": "https://github.com/secdev/scapy/pull/2275", "diff_url": "https://github.com/secdev/scapy/pull/2275.diff", "patch_url": "https://github.com/secdev/scapy/pull/2275.patch", "merged_at": "2019-10-22T11:09:27Z"}, "body": "fixes broken dissection of ipfix when template defines enterprise-specific information elements.\r\n\r\nAccording to IPFIX RFC, the first bit of Information Element id indicates whether it is IANA-assigned or enterprise-specific Information Elements.\r\n\r\n```\r\n     |0| Information Element id. 1.2 |        Field Length 1.2       |\r\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\r\n     |             ...               |              ...              |\r\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\r\n     |1| Information Element id. 1.N |        Field Length 1.N       |\r\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\r\n     |                    Enterprise Number  1.N                     |\r\n```\r\n\r\nThis PR added BitField and ConditionalField to NetflowTemplateFieldV9. It adds a test case as well. I can provide a pcap file if needed.\r\n\r\nfixes #2236\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2275/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2275/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2251", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2251/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2251/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2251/events", "html_url": "https://github.com/secdev/scapy/pull/2251", "id": 494458610, "node_id": "MDExOlB1bGxSZXF1ZXN0MzE4MjA1Nzgy", "number": 2251, "title": "Fixing pad byte in Dot11EltCountry", "user": {"login": "yananet", "id": 5201503, "node_id": "MDQ6VXNlcjUyMDE1MDM=", "avatar_url": "https://avatars.githubusercontent.com/u/5201503?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yananet", "html_url": "https://github.com/yananet", "followers_url": "https://api.github.com/users/yananet/followers", "following_url": "https://api.github.com/users/yananet/following{/other_user}", "gists_url": "https://api.github.com/users/yananet/gists{/gist_id}", "starred_url": "https://api.github.com/users/yananet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yananet/subscriptions", "organizations_url": "https://api.github.com/users/yananet/orgs", "repos_url": "https://api.github.com/users/yananet/repos", "events_url": "https://api.github.com/users/yananet/events{/privacy}", "received_events_url": "https://api.github.com/users/yananet/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2019-09-17T07:45:58Z", "updated_at": "2019-10-24T13:31:12Z", "closed_at": "2019-10-24T13:31:12Z", "author_association": "NONE", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2251", "html_url": "https://github.com/secdev/scapy/pull/2251", "diff_url": "https://github.com/secdev/scapy/pull/2251.diff", "patch_url": "https://github.com/secdev/scapy/pull/2251.patch", "merged_at": null}, "body": "More info : #2248\r\nbased on the standard, the length of the field should be an even number, so a pad byte should be included if the length of element is not an even number, but it seems that `pkt.len` is referred from header, `pkt.len` includes the pad byte already.\r\nThis change calculates the length of body and compare it to the `pkt.len` so that the pad will be correctly applied.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2251/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2251/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2241", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2241/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2241/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2241/events", "html_url": "https://github.com/secdev/scapy/issues/2241", "id": 491067928, "node_id": "MDU6SXNzdWU0OTEwNjc5Mjg=", "number": 2241, "title": "explore() function yields AssertionError", "user": {"login": "thehoneypotter", "id": 53850486, "node_id": "MDQ6VXNlcjUzODUwNDg2", "avatar_url": "https://avatars.githubusercontent.com/u/53850486?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thehoneypotter", "html_url": "https://github.com/thehoneypotter", "followers_url": "https://api.github.com/users/thehoneypotter/followers", "following_url": "https://api.github.com/users/thehoneypotter/following{/other_user}", "gists_url": "https://api.github.com/users/thehoneypotter/gists{/gist_id}", "starred_url": "https://api.github.com/users/thehoneypotter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thehoneypotter/subscriptions", "organizations_url": "https://api.github.com/users/thehoneypotter/orgs", "repos_url": "https://api.github.com/users/thehoneypotter/repos", "events_url": "https://api.github.com/users/thehoneypotter/events{/privacy}", "received_events_url": "https://api.github.com/users/thehoneypotter/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-09-09T12:32:52Z", "updated_at": "2019-09-13T09:27:51Z", "closed_at": "2019-09-13T09:27:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have the following environment:\r\n\r\nUbuntu 18.04 LTS (X86_64)\r\nPython2/3: 2.7.15+/ 3.6.8\r\nScapy:  Version 2.4.3\r\n\r\nWhen I try to use explore function, I get the following error. \r\n```\r\n>>> explore()\r\nTraceback (most recent call last):\r\n  File \"<console>\", line 1, in <module>\r\n  File \"/usr/local/lib/python2.7/dist-packages/scapy/packet.py\", line 1845, in explore\r\n    (six.text_type(\"Cancel\"), \"cancel\")\r\n  File \"/usr/local/lib/python2.7/dist-packages/prompt_toolkit/shortcuts/dialogs.py\", line 60, in button_dialog\r\n    with_background=True)\r\n  File \"/usr/local/lib/python2.7/dist-packages/prompt_toolkit/widgets/dialogs.py\", line 32, in __init__\r\n    assert is_formatted_text(title)\r\nAssertionError\r\n```\r\nBesides that I have not found problem with any other modules that I have come across so far.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2241/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2241/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2225", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2225/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2225/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2225/events", "html_url": "https://github.com/secdev/scapy/pull/2225", "id": 482832435, "node_id": "MDExOlB1bGxSZXF1ZXN0MzA5MDI3NDQy", "number": 2225, "title": "Fix tcpdump detection", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-08-20T12:32:21Z", "updated_at": "2019-08-30T23:00:54Z", "closed_at": "2019-08-30T14:12:43Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2225", "html_url": "https://github.com/secdev/scapy/pull/2225", "diff_url": "https://github.com/secdev/scapy/pull/2225.diff", "patch_url": "https://github.com/secdev/scapy/pull/2225.patch", "merged_at": "2019-08-30T14:12:42Z"}, "body": "fixes https://github.com/secdev/scapy/issues/2223", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2225/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2225/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2223", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2223/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2223/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2223/events", "html_url": "https://github.com/secdev/scapy/issues/2223", "id": 482806144, "node_id": "MDU6SXNzdWU0ODI4MDYxNDQ=", "number": 2223, "title": "Exception: tcpdump is not available", "user": {"login": "imperio-wxm", "id": 8111349, "node_id": "MDQ6VXNlcjgxMTEzNDk=", "avatar_url": "https://avatars.githubusercontent.com/u/8111349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/imperio-wxm", "html_url": "https://github.com/imperio-wxm", "followers_url": "https://api.github.com/users/imperio-wxm/followers", "following_url": "https://api.github.com/users/imperio-wxm/following{/other_user}", "gists_url": "https://api.github.com/users/imperio-wxm/gists{/gist_id}", "starred_url": "https://api.github.com/users/imperio-wxm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/imperio-wxm/subscriptions", "organizations_url": "https://api.github.com/users/imperio-wxm/orgs", "repos_url": "https://api.github.com/users/imperio-wxm/repos", "events_url": "https://api.github.com/users/imperio-wxm/events{/privacy}", "received_events_url": "https://api.github.com/users/imperio-wxm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1265179855, "node_id": "MDU6TGFiZWwxMjY1MTc5ODU1", "url": "https://api.github.com/repos/secdev/scapy/labels/platform-specific", "name": "platform-specific", "color": "14acba", "default": false, "description": ""}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2019-08-20T11:34:45Z", "updated_at": "2023-01-11T11:49:26Z", "closed_at": "2019-08-30T14:12:43Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "- Linux version 2.6.32-431.el6.x86_64 (mockbuild@c6b8.bsys.dev.centos.org) (gcc version 4.4.7 20120313 (Red Hat 4.4.7-4) (GCC) ) #1 SMP Fri Nov 22 03:15:09 UTC 2013\r\n- Python 2.7.11\r\n- scapy 2.4.3\r\n- tcpdump-4.0.0-11.20090921gitdf3cb4.2.el6.x86_64\r\n\r\n## MyCode:\r\n```python\r\n#!/usr/bin/python\r\n#coding:utf-8\r\n\r\nimport sys\r\nreload(sys)\r\nsys.setdefaultencoding('utf-8')\r\n\r\nfrom scapy.all import *\r\n\r\ndef pack_callback(packet):\r\n    line = raw(packet[TCP].payload)\r\n    if len(line) != 0 and line.strip() != '':\r\n        print(line)\r\n\r\nif __name__ == '__main__':\r\n    dpkt = sniff(filter='ip dst xx.xx.xx.xx and tcp and tcp port xxx',iface='eth1',prn=pack_callback, count=0)\r\n```\r\n## Get Error\r\n```shell\r\n  File \"/usr/local/Python-2.7.11/lib/python2.7/site-packages/scapy/sendrecv.py\", line 972, in sniff\r\n    sniffer._run(*args, **kwargs)\r\n  File \"/usr/local/Python-2.7.11/lib/python2.7/site-packages/scapy/sendrecv.py\", line 842, in _run\r\n    *arg, **karg)] = iface\r\n  File \"/usr/local/Python-2.7.11/lib/python2.7/site-packages/scapy/arch/linux.py\", line 475, in __init__\r\n    attach_filter(self.ins, filter, iface)\r\n  File \"/usr/local/Python-2.7.11/lib/python2.7/site-packages/scapy/arch/linux.py\", line 160, in attach_filter\r\n    bp = compile_filter(bpf_filter, iface)\r\n  File \"/usr/local/Python-2.7.11/lib/python2.7/site-packages/scapy/arch/common.py\", line 165, in compile_filter\r\n    raise Scapy_Exception(\"tcpdump is not available. Cannot use filter !\")\r\nscapy.error.Scapy_Exception: tcpdump is not available. Cannot use filter !\r\nException socket.error: error(99, 'Cannot assign requested address') in <bound method L2ListenSocket.__del__ of <scapy.arch.linux.L2ListenSocket object at 0x7f2dec32ef90>> ignored\r\n```\r\n**The exception is: tcpdump is not available. Cannot use filter**\r\n\r\nHowever, tcpdump is already installed on the machine.\r\n```shell\r\ntcpdump -v\r\ntcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 65535 bytes\r\n\r\n6 packets captured\r\n597 packets received by filter\r\n561 packets dropped by kernel\r\n```\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2223/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2223/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2219", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2219/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2219/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2219/events", "html_url": "https://github.com/secdev/scapy/pull/2219", "id": 482382852, "node_id": "MDExOlB1bGxSZXF1ZXN0MzA4NjY3NDYx", "number": 2219, "title": "[radius.py] fix  fields** not passes", "user": {"login": "Matheus-Garbelini", "id": 6465668, "node_id": "MDQ6VXNlcjY0NjU2Njg=", "avatar_url": "https://avatars.githubusercontent.com/u/6465668?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Matheus-Garbelini", "html_url": "https://github.com/Matheus-Garbelini", "followers_url": "https://api.github.com/users/Matheus-Garbelini/followers", "following_url": "https://api.github.com/users/Matheus-Garbelini/following{/other_user}", "gists_url": "https://api.github.com/users/Matheus-Garbelini/gists{/gist_id}", "starred_url": "https://api.github.com/users/Matheus-Garbelini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Matheus-Garbelini/subscriptions", "organizations_url": "https://api.github.com/users/Matheus-Garbelini/orgs", "repos_url": "https://api.github.com/users/Matheus-Garbelini/repos", "events_url": "https://api.github.com/users/Matheus-Garbelini/events{/privacy}", "received_events_url": "https://api.github.com/users/Matheus-Garbelini/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-08-19T15:35:45Z", "updated_at": "2019-12-06T11:08:33Z", "closed_at": "2019-12-06T11:08:33Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2219", "html_url": "https://github.com/secdev/scapy/pull/2219", "diff_url": "https://github.com/secdev/scapy/pull/2219.diff", "patch_url": "https://github.com/secdev/scapy/pull/2219.patch", "merged_at": null}, "body": "This commit is to fix the problem related to issue #2095 \r\nSince @lidllohntsich is not responding, I'm just passing on the commit.\r\n\r\nThanks.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2219/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2219/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2209", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2209/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2209/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2209/events", "html_url": "https://github.com/secdev/scapy/issues/2209", "id": 480123175, "node_id": "MDU6SXNzdWU0ODAxMjMxNzU=", "number": 2209, "title": "TCP with fuzz generates packets with too long options", "user": {"login": "tristan-ovh", "id": 13345786, "node_id": "MDQ6VXNlcjEzMzQ1Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/13345786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tristan-ovh", "html_url": "https://github.com/tristan-ovh", "followers_url": "https://api.github.com/users/tristan-ovh/followers", "following_url": "https://api.github.com/users/tristan-ovh/following{/other_user}", "gists_url": "https://api.github.com/users/tristan-ovh/gists{/gist_id}", "starred_url": "https://api.github.com/users/tristan-ovh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tristan-ovh/subscriptions", "organizations_url": "https://api.github.com/users/tristan-ovh/orgs", "repos_url": "https://api.github.com/users/tristan-ovh/repos", "events_url": "https://api.github.com/users/tristan-ovh/events{/privacy}", "received_events_url": "https://api.github.com/users/tristan-ovh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-08-13T12:15:01Z", "updated_at": "2019-08-16T16:58:17Z", "closed_at": "2019-08-16T16:58:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nWhen generating random TCP packets (```Ether()/IP()/fuzz(TCP())```), the packet might have too many TCP options, creating more than 40 bytes of options, which is not valid.\r\nIt causes issues when trying to generate the actual packet.\r\n\r\n#### Environment\r\n\r\n-   Scapy version: `2.4.3`\r\n-   Python version: `3.6.8`\r\n-   Operating System: `CentOS 7`\r\n\r\n#### How to reproduce\r\n\r\nUse this script (test.py):\r\n```python\r\nfrom scapy.all import *\r\n\r\ntest = Ether()/IP()/fuzz(TCP())\r\n\r\nfor i in range(10000):\r\n    bytes(test)\r\n```\r\n\r\n```bash\r\npython3 test.py\r\n```\r\n\r\n#### Actual result\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"../../test.py\", line 6, in <module>\r\n    bytes(test)\r\n  File \"/usr/local/lib/python3.6/site-packages/scapy/packet.py\", line 487, in __bytes__\r\n    return self.build()\r\n  File \"/usr/local/lib/python3.6/site-packages/scapy/packet.py\", line 607, in build\r\n    p = self.do_build()\r\n  File \"/usr/local/lib/python3.6/site-packages/scapy/packet.py\", line 592, in do_build\r\n    pay = self.do_build_payload()\r\n  File \"/usr/local/lib/python3.6/site-packages/scapy/packet.py\", line 579, in do_build_payload\r\n    return self.payload.do_build()\r\n  File \"/usr/local/lib/python3.6/site-packages/scapy/packet.py\", line 592, in do_build\r\n    pay = self.do_build_payload()\r\n  File \"/usr/local/lib/python3.6/site-packages/scapy/packet.py\", line 579, in do_build_payload\r\n    return self.payload.do_build()\r\n  File \"/usr/local/lib/python3.6/site-packages/scapy/packet.py\", line 594, in do_build\r\n    return self.post_build(pkt, pay)\r\n  File \"/usr/local/lib/python3.6/site-packages/scapy/layers/inet.py\", line 629, in post_build\r\n    p = p[:12] + chb((dataofs << 4) | orb(p[12]) & 0x0f) + p[13:]\r\n  File \"/usr/local/lib/python3.6/site-packages/scapy/compat.py\", line 70, in chb\r\n    return struct.pack(\"!B\", x)\r\nstruct.error: ubyte format requires 0 <= number <= 255\r\n```\r\n\r\n#### Expected result\r\n\r\nNo output as packets should be generated properly.\r\n\r\n#### Digging up\r\n\r\nThe issue does not seem to exist in scapy 2.4.0.\r\n\r\nI have checked the cause of the printed exception. The wrong value is the result of a computation based on the TCP options length, which is 44 bytes, more than the 40 specified for TCP.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2209/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2209/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2205", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2205/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2205/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2205/events", "html_url": "https://github.com/secdev/scapy/pull/2205", "id": 479140517, "node_id": "MDExOlB1bGxSZXF1ZXN0MzA2MTE1NDk4", "number": 2205, "title": "Catch tcpdump BPF syntax error", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-08-09T19:47:18Z", "updated_at": "2020-07-31T07:48:07Z", "closed_at": "2020-07-31T07:48:07Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2205", "html_url": "https://github.com/secdev/scapy/pull/2205", "diff_url": "https://github.com/secdev/scapy/pull/2205.diff", "patch_url": "https://github.com/secdev/scapy/pull/2205.patch", "merged_at": null}, "body": "Fixes #2172", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2205/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2205/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2190", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2190/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2190/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2190/events", "html_url": "https://github.com/secdev/scapy/pull/2190", "id": 474310363, "node_id": "MDExOlB1bGxSZXF1ZXN0MzAyMjc5OTIz", "number": 2190, "title": "Critical `PcapReader` issue", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-07-30T00:09:46Z", "updated_at": "2019-07-30T10:20:12Z", "closed_at": "2019-07-30T09:43:58Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2190", "html_url": "https://github.com/secdev/scapy/pull/2190", "diff_url": "https://github.com/secdev/scapy/pull/2190.diff", "patch_url": "https://github.com/secdev/scapy/pull/2190.patch", "merged_at": "2019-07-30T09:43:58Z"}, "body": "fixes https://github.com/secdev/scapy/issues/2189", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2190/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2190/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2189", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2189/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2189/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2189/events", "html_url": "https://github.com/secdev/scapy/issues/2189", "id": 474285514, "node_id": "MDU6SXNzdWU0NzQyODU1MTQ=", "number": 2189, "title": "RawPcapReader next() incompatible with read_packet() in scapy/utils.py", "user": {"login": "pateldt", "id": 742073, "node_id": "MDQ6VXNlcjc0MjA3Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/742073?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pateldt", "html_url": "https://github.com/pateldt", "followers_url": "https://api.github.com/users/pateldt/followers", "following_url": "https://api.github.com/users/pateldt/following{/other_user}", "gists_url": "https://api.github.com/users/pateldt/gists{/gist_id}", "starred_url": "https://api.github.com/users/pateldt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pateldt/subscriptions", "organizations_url": "https://api.github.com/users/pateldt/orgs", "repos_url": "https://api.github.com/users/pateldt/repos", "events_url": "https://api.github.com/users/pateldt/events{/privacy}", "received_events_url": "https://api.github.com/users/pateldt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-07-29T22:29:50Z", "updated_at": "2019-07-30T09:43:58Z", "closed_at": "2019-07-30T09:43:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "The next() iterator method is not compatible with current implementation of read_packet().\r\n\r\nread_packet() raises an EOFError when no more packets are available (previously None was returned).   This needs to be caught in next() and a StopIteration exception needs to be raised.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2189/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2189/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2188", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2188/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2188/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2188/events", "html_url": "https://github.com/secdev/scapy/issues/2188", "id": 474030998, "node_id": "MDU6SXNzdWU0NzQwMzA5OTg=", "number": 2188, "title": "MQTT UNSUBSCRIBE payload", "user": {"login": "alexanderkaiser", "id": 2487708, "node_id": "MDQ6VXNlcjI0ODc3MDg=", "avatar_url": "https://avatars.githubusercontent.com/u/2487708?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexanderkaiser", "html_url": "https://github.com/alexanderkaiser", "followers_url": "https://api.github.com/users/alexanderkaiser/followers", "following_url": "https://api.github.com/users/alexanderkaiser/following{/other_user}", "gists_url": "https://api.github.com/users/alexanderkaiser/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexanderkaiser/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexanderkaiser/subscriptions", "organizations_url": "https://api.github.com/users/alexanderkaiser/orgs", "repos_url": "https://api.github.com/users/alexanderkaiser/repos", "events_url": "https://api.github.com/users/alexanderkaiser/events{/privacy}", "received_events_url": "https://api.github.com/users/alexanderkaiser/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-07-29T12:45:24Z", "updated_at": "2019-09-13T08:06:59Z", "closed_at": "2019-09-13T08:06:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nMQTTUnsubscribe packet treats unsubscribe payload as **StrNullField**. According to the specification, the [unsubscribe payload](http://docs.oasis-open.org/mqtt/mqtt/v3.1.1/os/mqtt-v3.1.1-os.html#_Toc398718075) should be a (list of) **StrLenField**.\r\n\r\n#### Environment\r\n\r\n- Python 3.7\r\n- Scapy 2.4.2\r\n\r\n#### How to reproduce\r\nLet's take the following to packets to go through the scenario shown in [MQTT spec. Table 3.7](http://docs.oasis-open.org/mqtt/mqtt/v3.1.1/os/mqtt-v3.1.1-os.html#_Toc398718075)\r\n\r\n```\r\n# unsubscribe with a single topic a/b\r\nu1 = MQTT(b'\\xA2\\x07\\x00\\x01\\x00\\x03\\x61\\x2F\\x62')\r\n\r\n# unsubscribe with two topics a/b and c/d\r\nu2 = MQTT(b'\\xA2\\x0C\\x00\\x01\\x00\\x03\\x61\\x2F\\x62\\x00\\x03\\x63\\x2F\\x64')\r\n```\r\n#### Actual result\r\n\r\n```\r\n>>> u1\r\n<MQTT  type=UNSUBSCRIBE DUP=Disabled QOS=At least once delivery RETAIN=Disabled len=7 |<MQTTUnsubscribe  msgid=1 payload='' |<MQTT  type=0 DUP=Disabled QOS=At least once delivery RETAIN=Enabled len=97 |<Raw  load='/b' |>>>>\r\n```\r\nWhat happend here? Following assumption for u1 with a single topic:\r\n\r\n> b'**\\xA2\\x07\\x00\\x01**\\x00\\x03\\x61\\x2F\\x62'\r\n\r\nDecodes correctly to a unsubscribe packet with **len=7** and **msgid=1**\r\nNow, the subscribe payload should be decoded. This one contains a length field (`\\x00\\x03`) and the topic (`\\x61\\x2F\\x62`)\r\n\r\n> b'\\x00\\x03\\x61\\x2F\\x62'\r\n\r\nHowever, at this point, the payload is decoded as [StrNullField](https://github.com/secdev/scapy/blob/master/scapy/contrib/mqtt.py#L237) which leads to an empty payload and an early finish of the packet (we parsed so far 3 bytes, while remaining length field stated we will have 7 bytes). So the last 4 bytes are leftover and treated as a new layer, which is definitely wrong. \r\n\r\n#### Expected result\r\n\r\nA first naive solution for this issue would be to treat the payload as length encoded string as practised in other packets like [publish](https://github.com/secdev/scapy/blob/master/scapy/contrib/mqtt.py#L168-L170) and [subscribe](https://github.com/secdev/scapy/blob/master/scapy/contrib/mqtt.py#L212-L214).\r\n\r\n```\r\nclass MQTTUnsubscribe(Packet):\r\n    name = \"MQTT unsubscribe\"\r\n    fields_desc = [\r\n        ShortField(\"msgid\", None),\r\n        FieldLenField(\"length\", None, length_of=\"payload\"),\r\n        StrLenField(\"payload\", \"\",\r\n                    length_from=lambda pkt: pkt.length)\r\n    ]\r\n```\r\n\r\nWith this fix, Unsubscribe with a single topic will work as intended:\r\n\r\n```\r\n>>> u1 = MQTT(b'\\xA2\\x07\\x00\\x01\\x00\\x03\\x61\\x2F\\x62')\r\n>>> u1\r\n<MQTT  type=UNSUBSCRIBE DUP=Disabled QOS=At least once delivery RETAIN=Disabled len=7 |<MQTTUnsubscribe  msgid=1 length=3 payload='a/b' |>>\r\n```\r\n\r\nWhile this works for unsubscribe packets with a single topic within the payload, it still fails on a list of topics (the same issue applies also to the [MQTT Subscribe payload](http://docs.oasis-open.org/mqtt/mqtt/v3.1.1/os/mqtt-v3.1.1-os.html#_Toc398718066) implemented in the [MQTTSubscribe Packet](https://github.com/secdev/scapy/blob/master/scapy/contrib/mqtt.py#L212-L215)).\r\n\r\n```\r\n>>> u2 = MQTT(b'\\xA2\\x0C\\x00\\x01\\x00\\x03\\x61\\x2F\\x62\\x00\\x03\\x63\\x2F\\x64')\r\n>>> u2\r\n<MQTT  type=UNSUBSCRIBE DUP=Disabled QOS=At least once delivery RETAIN=Disabled len=12 |<MQTTUnsubscribe  msgid=1 length=3 payload='a/b' |<MQTT  type=0 DUP=Disabled QOS=At most once delivery RETAIN=Disabled len=3 |<Raw  load='c/d' |>>>>\r\n```\r\n\r\nI assume the first scenario (_u1_) is more common, so the naive fix should satisfy most cases. The second scenario (_u2_) could be still reproduced by repeated independent unsubscribe message.\r\nHowever, the MQTT feature subscribing/unsubscribing to/from multiple topics with one single message would be still missing.  Unfortunately, I couldn't find a way to describe such a structure with Scapy's fields properly.\r\n\r\n#### Related resources\r\n\r\n[MQTT Unsubscribe payload](http://docs.oasis-open.org/mqtt/mqtt/v3.1.1/os/mqtt-v3.1.1-os.html#_Toc398718075)\r\n[MQTT Subscribe payload](http://docs.oasis-open.org/mqtt/mqtt/v3.1.1/os/mqtt-v3.1.1-os.html#_Toc398718066)\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2188/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2188/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2181", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2181/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2181/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2181/events", "html_url": "https://github.com/secdev/scapy/pull/2181", "id": 472952610, "node_id": "MDExOlB1bGxSZXF1ZXN0MzAxMjE0ODA0", "number": 2181, "title": "Always check for len(cmds) <= 1", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 514033136, "node_id": "MDU6TGFiZWw1MTQwMzMxMzY=", "url": "https://api.github.com/repos/secdev/scapy/labels/tests", "name": "tests", "color": "0e8a16", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-07-25T16:11:04Z", "updated_at": "2019-07-29T09:28:48Z", "closed_at": "2019-07-29T09:23:47Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2181", "html_url": "https://github.com/secdev/scapy/pull/2181", "diff_url": "https://github.com/secdev/scapy/pull/2181.diff", "patch_url": "https://github.com/secdev/scapy/pull/2181.patch", "merged_at": null}, "body": "An issue was triggered in rare cases", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2181/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2181/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2179", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2179/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2179/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2179/events", "html_url": "https://github.com/secdev/scapy/pull/2179", "id": 472794961, "node_id": "MDExOlB1bGxSZXF1ZXN0MzAxMDg2MTUx", "number": 2179, "title": "Allow SndRcvList to be written to a PCAP file", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-07-25T10:45:02Z", "updated_at": "2019-07-25T20:12:33Z", "closed_at": "2019-07-25T15:31:35Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2179", "html_url": "https://github.com/secdev/scapy/pull/2179", "diff_url": "https://github.com/secdev/scapy/pull/2179.diff", "patch_url": "https://github.com/secdev/scapy/pull/2179.patch", "merged_at": "2019-07-25T15:31:35Z"}, "body": "Fix a regression introduced since v2.4.0.\r\n\r\nPlease merge it quickly as it blocks my BlackHat demonstration.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2179/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2179/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2172", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2172/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2172/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2172/events", "html_url": "https://github.com/secdev/scapy/issues/2172", "id": 472344588, "node_id": "MDU6SXNzdWU0NzIzNDQ1ODg=", "number": 2172, "title": "Exception raised with bad BPF filter", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-07-24T15:19:55Z", "updated_at": "2020-07-31T07:48:07Z", "closed_at": "2020-07-31T07:48:07Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "The following command raises an exception:\r\n```\r\nsniff(offline=IP()/UDP(), filter=\"bad filter\", quiet=True)\r\n```\r\n\r\nThe `tcpdump()` must detect the error from the `tcpdump` command `(tcpdump: syntax error in filter expression: syntax error`).", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2172/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2172/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2169", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2169/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2169/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2169/events", "html_url": "https://github.com/secdev/scapy/pull/2169", "id": 471677675, "node_id": "MDExOlB1bGxSZXF1ZXN0MzAwMjgwNzQ2", "number": 2169, "title": "Fix fuzzing on MultipleTypeField", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-07-23T12:49:02Z", "updated_at": "2020-07-19T09:20:31Z", "closed_at": "2019-07-25T08:38:04Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2169", "html_url": "https://github.com/secdev/scapy/pull/2169", "diff_url": "https://github.com/secdev/scapy/pull/2169.diff", "patch_url": "https://github.com/secdev/scapy/pull/2169.patch", "merged_at": "2019-07-25T08:38:03Z"}, "body": "This fixes https://github.com/secdev/scapy/issues/2166\r\n\r\nCurrently:\r\n```\r\n>>> fuzz(ARP(pdst=\"127.0.0.1\"))\r\n---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-1-dc0d41f97613> in <module>\r\n----> 1 fuzz(ARP(pdst=\"127.0.0.1\"))\r\n\r\n~\\Documents\\Gabriel\\secdev\\scapy\\scapy\\packet.py in fuzz(p, _inplace)\r\n   2029                     print(\"fuzzing\", repr(r))\r\n   2030                     fuzz(r, _inplace=1)\r\n-> 2031             elif f.default is not None:\r\n   2032                 if not isinstance(f, ConditionalField) or f._evalcond(q):\r\n   2033                     rnd = f.randval()\r\n\r\n~\\Documents\\Gabriel\\secdev\\scapy\\scapy\\fields.py in __getattr__(self, attr)\r\n    382\r\n    383     def __getattr__(self, attr):\r\n--> 384         return getattr(self._find_fld(), attr)\r\n    385\r\n    386\r\n\r\n~\\Documents\\Gabriel\\secdev\\scapy\\scapy\\fields.py in _find_fld(self)\r\n    337                 pass\r\n    338             else:\r\n--> 339                 if not pkt.default_fields:\r\n    340                     # Packet not initialized\r\n    341                     return self.dflt\r\n\r\nAttributeError: 'TerminalInteractiveShell' object has no attribute 'default_fields'\r\n```", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2169/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2169/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2166", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2166/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2166/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2166/events", "html_url": "https://github.com/secdev/scapy/issues/2166", "id": 471381134, "node_id": "MDU6SXNzdWU0NzEzODExMzQ=", "number": 2166, "title": "Cannot fuzz ARP in 2.4.2 (works fine in 2.4.0)", "user": {"login": "anarkiwi", "id": 4725207, "node_id": "MDQ6VXNlcjQ3MjUyMDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4725207?v=4", "gravatar_id": "", "url": "https://api.github.com/users/anarkiwi", "html_url": "https://github.com/anarkiwi", "followers_url": "https://api.github.com/users/anarkiwi/followers", "following_url": "https://api.github.com/users/anarkiwi/following{/other_user}", "gists_url": "https://api.github.com/users/anarkiwi/gists{/gist_id}", "starred_url": "https://api.github.com/users/anarkiwi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/anarkiwi/subscriptions", "organizations_url": "https://api.github.com/users/anarkiwi/orgs", "repos_url": "https://api.github.com/users/anarkiwi/repos", "events_url": "https://api.github.com/users/anarkiwi/events{/privacy}", "received_events_url": "https://api.github.com/users/anarkiwi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-07-22T23:02:31Z", "updated_at": "2019-07-25T08:38:03Z", "closed_at": "2019-07-25T08:38:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "See https://github.com/faucetsdn/faucet/issues/3109\r\n\r\n```\r\nfaucet@faucet:~$ sudo bash\r\nroot@faucet:~# python3\r\nPython 3.6.8 (default, Jan 14 2019, 11:02:34) \r\n[GCC 8.0.1 20180414 (experimental) [trunk revision 259383]] on linux\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> from scapy.all import *\r\n>>> scapy.all.send(fuzz(ARP(pdst='127.0.0.1')))\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.6/dist-packages/scapy/compat.py\", line 117, in raw\r\n    return bytes(x)\r\n  File \"/usr/local/lib/python3.6/dist-packages/scapy/packet.py\", line 441, in __bytes__\r\n    return self.build()\r\n  File \"/usr/local/lib/python3.6/dist-packages/scapy/packet.py\", line 556, in build\r\n    p = self.do_build()\r\n  File \"/usr/local/lib/python3.6/dist-packages/scapy/packet.py\", line 541, in do_build\r\n    pay = self.do_build_payload()\r\n  File \"/usr/local/lib/python3.6/dist-packages/scapy/packet.py\", line 528, in do_build_payload\r\n    return self.payload.do_build()\r\n  File \"/usr/local/lib/python3.6/dist-packages/scapy/packet.py\", line 538, in do_build\r\n    pkt = self.self_build()\r\n  File \"/usr/local/lib/python3.6/dist-packages/scapy/packet.py\", line 519, in self_build\r\n    p = f.addfield(self, p, val)\r\n  File \"/usr/local/lib/python3.6/dist-packages/scapy/fields.py\", line 134, in addfield\r\n    return s + struct.pack(self.fmt, self.i2m(pkt, val))\r\n  File \"/usr/local/lib/python3.6/dist-packages/scapy/fields.py\", line 1314, in i2m\r\n    f = fld.i2len(pkt, fval)\r\n  File \"/usr/local/lib/python3.6/dist-packages/scapy/fields.py\", line 343, in i2len\r\n    return self._find_fld_pkt_val(pkt, val).i2len(pkt, val)\r\n  File \"/usr/local/lib/python3.6/dist-packages/scapy/fields.py\", line 884, in i2len\r\n    return len(i)\r\nTypeError: object of type 'NoneType' has no len()\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/usr/local/lib/python3.6/dist-packages/scapy/sendrecv.py\", line 314, in send\r\n    realtime=realtime, return_packets=return_packets)\r\n  File \"/usr/local/lib/python3.6/dist-packages/scapy/sendrecv.py\", line 287, in __gen_send\r\n    s.send(p)\r\n  File \"/usr/local/lib/python3.6/dist-packages/scapy/arch/linux.py\", line 533, in send\r\n    sx = raw(ll(x))\r\n  File \"/usr/local/lib/python3.6/dist-packages/scapy/compat.py\", line 119, in raw\r\n    return bytes(x, encoding=\"utf8\")\r\nTypeError: encoding without a string argument\r\n```", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2166/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2166/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2159", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2159/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2159/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2159/events", "html_url": "https://github.com/secdev/scapy/pull/2159", "id": 470785523, "node_id": "MDExOlB1bGxSZXF1ZXN0Mjk5NjM4OTE5", "number": 2159, "title": "Fix *args/**kwargs on Sessions", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-07-21T14:07:36Z", "updated_at": "2019-07-21T17:43:13Z", "closed_at": "2019-07-21T17:42:28Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2159", "html_url": "https://github.com/secdev/scapy/pull/2159", "diff_url": "https://github.com/secdev/scapy/pull/2159.diff", "patch_url": "https://github.com/secdev/scapy/pull/2159.patch", "merged_at": "2019-07-21T17:42:28Z"}, "body": "Reverts @polybassa 'a changes.\r\n\r\nIt actually broke things like\r\n`sniff(filter=\"tcp port 80\")`\r\n`sniff(monitor=True)`\r\n\r\nWhat do you think of the new changes ?", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2159/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2159/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2145", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2145/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2145/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2145/events", "html_url": "https://github.com/secdev/scapy/pull/2145", "id": 468163530, "node_id": "MDExOlB1bGxSZXF1ZXN0Mjk3NjQ5OTAy", "number": 2145, "title": "Fix solaris support", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1000112749, "node_id": "MDU6TGFiZWwxMDAwMTEyNzQ5", "url": "https://api.github.com/repos/secdev/scapy/labels/cleanup", "name": "cleanup", "color": "FF68F6", "default": false, "description": "Performs some code clean-up"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2019-07-15T14:33:38Z", "updated_at": "2019-07-25T15:30:14Z", "closed_at": "2019-07-25T15:01:06Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2145", "html_url": "https://github.com/secdev/scapy/pull/2145", "diff_url": "https://github.com/secdev/scapy/pull/2145.diff", "patch_url": "https://github.com/secdev/scapy/pull/2145.patch", "merged_at": "2019-07-25T15:01:06Z"}, "body": "This PR:\r\n- fixes Solaris support: tested on a VM with Solaris 11.1\r\n- cleanup un-required stuff\r\n- **Solaris will only work WITH Libpcap**: it's much easier for us than implement `DLPI`, which is required for Solaris. In fact, according to [this page](https://www.oracle.com/technetwork/server-storage/solaris/solaris-linux-app-139382.html) Solaris doesn't support `AF_PACKET` but rather uses `DLPI`.\r\n\r\nfixes https://github.com/secdev/scapy/pull/2141", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2145/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2145/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2140", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2140/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2140/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2140/events", "html_url": "https://github.com/secdev/scapy/pull/2140", "id": 467812946, "node_id": "MDExOlB1bGxSZXF1ZXN0Mjk3Mzc5Mjk4", "number": 2140, "title": "Net6 format", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-07-14T09:03:33Z", "updated_at": "2019-07-15T11:17:40Z", "closed_at": "2019-07-15T11:17:39Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2140", "html_url": "https://github.com/secdev/scapy/pull/2140", "diff_url": "https://github.com/secdev/scapy/pull/2140.diff", "patch_url": "https://github.com/secdev/scapy/pull/2140.patch", "merged_at": "2019-07-15T11:17:39Z"}, "body": "This PR fixes https://bitbucket.org/secdev/scapy/issues/5089\r\n\r\nThe second commit adds missing UTScapy flags.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2140/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2140/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2139", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2139/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2139/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2139/events", "html_url": "https://github.com/secdev/scapy/pull/2139", "id": 467316803, "node_id": "MDExOlB1bGxSZXF1ZXN0Mjk2OTkyMDg1", "number": 2139, "title": "macOS catalina support", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 564414240, "node_id": "MDU6TGFiZWw1NjQ0MTQyNDA=", "url": "https://api.github.com/repos/secdev/scapy/labels/convergence", "name": "convergence", "color": "c2e0c6", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-07-12T09:33:45Z", "updated_at": "2019-07-23T17:15:05Z", "closed_at": "2019-07-14T15:55:53Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2139", "html_url": "https://github.com/secdev/scapy/pull/2139", "diff_url": "https://github.com/secdev/scapy/pull/2139.diff", "patch_url": "https://github.com/secdev/scapy/pull/2139.patch", "merged_at": "2019-07-14T15:55:53Z"}, "body": "This fixes #2134 and adds mocked test for read_routes on 10.13.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2139/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2139/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2135", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2135/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2135/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2135/events", "html_url": "https://github.com/secdev/scapy/pull/2135", "id": 465636769, "node_id": "MDExOlB1bGxSZXF1ZXN0Mjk1NjM3NjIx", "number": 2135, "title": "updated apt to https://tools.ietf.org/html/rfc8300 January 2018", "user": {"login": "yurekten", "id": 2016667, "node_id": "MDQ6VXNlcjIwMTY2Njc=", "avatar_url": "https://avatars.githubusercontent.com/u/2016667?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yurekten", "html_url": "https://github.com/yurekten", "followers_url": "https://api.github.com/users/yurekten/followers", "following_url": "https://api.github.com/users/yurekten/following{/other_user}", "gists_url": "https://api.github.com/users/yurekten/gists{/gist_id}", "starred_url": "https://api.github.com/users/yurekten/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yurekten/subscriptions", "organizations_url": "https://api.github.com/users/yurekten/orgs", "repos_url": "https://api.github.com/users/yurekten/repos", "events_url": "https://api.github.com/users/yurekten/events{/privacy}", "received_events_url": "https://api.github.com/users/yurekten/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-07-09T08:15:15Z", "updated_at": "2019-12-15T14:06:59Z", "closed_at": "2019-12-15T14:06:59Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2135", "html_url": "https://github.com/secdev/scapy/pull/2135", "diff_url": "https://github.com/secdev/scapy/pull/2135.diff", "patch_url": "https://github.com/secdev/scapy/pull/2135.patch", "merged_at": null}, "body": "I am using NSH protocol form my dissertation tasks. NSH 8300 RFC was updated, In scapy, nsh packet structure and name of field revised. I have updated nsh.py.\r\n\r\n \r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2135/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2135/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2134", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2134/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2134/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2134/events", "html_url": "https://github.com/secdev/scapy/issues/2134", "id": 465519777, "node_id": "MDU6SXNzdWU0NjU1MTk3Nzc=", "number": 2134, "title": "Mac OS Catalina", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2019-07-09T00:58:49Z", "updated_at": "2019-07-14T15:55:53Z", "closed_at": "2019-07-14T15:55:53Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "**From:** https://stackoverflow.com/q/56936549/5459467\r\n\r\n> I'm trying to create a sniffer from the scapy module. I'm running Python 3.7 on macOS Catalina. Assuming that it's something with the macOS Catalina public beta version. I just wanna know what's causing the problem if so. I'm trying hard to understand why scapy throws an index out of bounds trace:\r\n> \r\n> **main.py**\r\n> \r\n> ```\r\n> import scapy.all as scapy\r\n> \r\n> p = scapy.sniff()\r\n> \r\n> p.summary()\r\n> Result:\r\n> \r\n> Traceback (most recent call last):\r\n>   File \"/Users/tom/PycharmProjects/sniffer/main.py\", line 2, in <module>\r\n>     import scapy.all as scapy\r\n>   File \"/Users/tom/PycharmProjects/sniffer/venv/lib/python3.7/site-packages/scapy/sendrecv.py\", line 33, in <module>\r\n>     import scapy.route  # noqa: F401\r\n>   File \"/Users/tom/PycharmProjects/sniffer/venv/lib/python3.7/site-packages/scapy/route.py\", line 194, in <module>\r\n>     conf.route = Route()\r\n>   File \"/Users/tom/PycharmProjects/sniffer/venv/lib/python3.7/site-packages/scapy/route.py\", line 27, in __init__\r\n>     self.resync()\r\n>   File \"/Users/tom/PycharmProjects/sniffer/venv/lib/python3.7/site-packages/scapy/route.py\", line 35, in resync\r\n>     self.routes = read_routes()\r\n>   File \"/Users/tom/PycharmProjects/sniffer/venv/lib/python3.7/site-packages/scapy/arch/unix.py\", line 82, in read_routes\r\n>     netif = rt[4 + mtu_present + prio_present + refs_present + locked]\r\n> IndexError: list index out of range\r\n> ```\r\n\r\nI'd guess it is indeed related to Catalina, but am no expert. @guedou Could you please have a look?", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2134/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2134/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2128", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2128/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2128/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2128/events", "html_url": "https://github.com/secdev/scapy/pull/2128", "id": 464242472, "node_id": "MDExOlB1bGxSZXF1ZXN0Mjk0NTYyNDk0", "number": 2128, "title": "Fix DNS MX & SOA records | Add more DNS one-liners", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 267691054, "node_id": "MDU6TGFiZWwyNjc2OTEwNTQ=", "url": "https://api.github.com/repos/secdev/scapy/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-07-04T12:33:40Z", "updated_at": "2019-07-04T13:01:09Z", "closed_at": "2019-07-04T13:00:41Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2128", "html_url": "https://github.com/secdev/scapy/pull/2128", "diff_url": "https://github.com/secdev/scapy/pull/2128.diff", "patch_url": "https://github.com/secdev/scapy/pull/2128.patch", "merged_at": "2019-07-04T13:00:41Z"}, "body": "This PR:\r\n- adds support for MX records in DNS\r\n- we already had the SOA records but they were not used for dissection. Fix that\r\n- add a few one-liners + a `iterpayloads()` utilitary method to ease the process of DNS results\r\n\r\nfixes https://github.com/secdev/scapy/issues/2127", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2128/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2128/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2127", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2127/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2127/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2127/events", "html_url": "https://github.com/secdev/scapy/issues/2127", "id": 464147317, "node_id": "MDU6SXNzdWU0NjQxNDczMTc=", "number": 2127, "title": "Decoding DNS answer rrdata for MX records", "user": {"login": "RYNEQ", "id": 21159935, "node_id": "MDQ6VXNlcjIxMTU5OTM1", "avatar_url": "https://avatars.githubusercontent.com/u/21159935?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RYNEQ", "html_url": "https://github.com/RYNEQ", "followers_url": "https://api.github.com/users/RYNEQ/followers", "following_url": "https://api.github.com/users/RYNEQ/following{/other_user}", "gists_url": "https://api.github.com/users/RYNEQ/gists{/gist_id}", "starred_url": "https://api.github.com/users/RYNEQ/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RYNEQ/subscriptions", "organizations_url": "https://api.github.com/users/RYNEQ/orgs", "repos_url": "https://api.github.com/users/RYNEQ/repos", "events_url": "https://api.github.com/users/RYNEQ/events{/privacy}", "received_events_url": "https://api.github.com/users/RYNEQ/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-07-04T08:54:44Z", "updated_at": "2019-07-05T16:04:33Z", "closed_at": "2019-07-04T13:00:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm using scapy's sniffer to get DNS packets and it works like a charm  \r\nThe problem is when I receive MX record `rrdata` are coded (struct.pack or something like that)  \r\nHow can I decrypt this data ?\r\n\r\nFor example I sniffed DNS for google MX request:\r\n```python\r\ndef pkt_callback(pkt):\r\n    ip = pkt['IP']\r\n    dns = pkt['DNS']\r\n    for i in range(dns.ancount):\r\n            dnsrr = dns.an[i]\r\n            print(dnsrr.rdata)\r\n\r\nsniff(iface='enp0s25', prn=pkt_callback, filter=\"udp and ( port 53 )\", store=0)\r\n```\r\nI get this:\r\n```python\r\nb'\\x00\\n\\x05aspmx\\x01l\\xc0\\x0c'\r\nb'\\x002\\x04alt4\\xc0*'\r\nb'\\x00\\x1e\\x04alt2\\xc0*'\r\nb'\\x00\\x14\\x04alt1\\xc0*'\r\nb'\\x00(\\x04alt3\\xc0*'\r\n```\r\nWhich should be this:\r\n```python\r\n10 aspmx.l.google.com.\r\n50 alt4.aspmx.l.google.com.\r\n30 alt2.aspmx.l.google.com.\r\n20 alt1.aspmx.l.google.com.\r\n40 alt3.aspmx.l.google.com.\r\n```\r\nI was able to extract \"**perf**\" field with this:\r\n```python\r\nperf = struct.unpack('!h', rrdata[0:2])[0]\r\n```\r\n\r\nBut the rest of data is not that eas; my best afford was this:\r\n```python\r\ndef decode_mx_rdata(rdata):\r\n    perf = struct.unpack('!h', rdata[0:2])[0]\r\n    rdata = rdata[2:]\r\n\r\n    parts = []\r\n    while rdata:\r\n        if len(rdata) % 2 == 0:\r\n            l = rdata[0:2]\r\n            p = 2\r\n        else:\r\n            l = rdata[0:1]+b'\\x00'\r\n            p = 1\r\n        l = int(struct.unpack('h', l)[0])\r\n        parts.append(rdata[p:l+p])\r\n        rdata = rdata[l+p:]\r\n    return perf, parts\r\n```\r\nHow can I correctly decode this data? ", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2127/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2127/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2117", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2117/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2117/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2117/events", "html_url": "https://github.com/secdev/scapy/pull/2117", "id": 462747408, "node_id": "MDExOlB1bGxSZXF1ZXN0MjkzMzY3MDY1", "number": 2117, "title": "fix double precision for timestamp", "user": {"login": "sergey-platonov", "id": 6061213, "node_id": "MDQ6VXNlcjYwNjEyMTM=", "avatar_url": "https://avatars.githubusercontent.com/u/6061213?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sergey-platonov", "html_url": "https://github.com/sergey-platonov", "followers_url": "https://api.github.com/users/sergey-platonov/followers", "following_url": "https://api.github.com/users/sergey-platonov/following{/other_user}", "gists_url": "https://api.github.com/users/sergey-platonov/gists{/gist_id}", "starred_url": "https://api.github.com/users/sergey-platonov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sergey-platonov/subscriptions", "organizations_url": "https://api.github.com/users/sergey-platonov/orgs", "repos_url": "https://api.github.com/users/sergey-platonov/repos", "events_url": "https://api.github.com/users/sergey-platonov/events{/privacy}", "received_events_url": "https://api.github.com/users/sergey-platonov/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-07-01T14:29:42Z", "updated_at": "2019-07-02T07:02:16Z", "closed_at": "2019-07-02T07:02:15Z", "author_association": "NONE", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2117", "html_url": "https://github.com/secdev/scapy/pull/2117", "diff_url": "https://github.com/secdev/scapy/pull/2117.diff", "patch_url": "https://github.com/secdev/scapy/pull/2117.patch", "merged_at": "2019-07-02T07:02:15Z"}, "body": "This fixes #2116\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2117/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2117/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2102", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2102/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2102/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2102/events", "html_url": "https://github.com/secdev/scapy/pull/2102", "id": 460098315, "node_id": "MDExOlB1bGxSZXF1ZXN0MjkxMjk4MTk0", "number": 2102, "title": "Fix race conditions on Init", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2019-06-24T21:12:11Z", "updated_at": "2019-07-12T17:52:16Z", "closed_at": "2019-07-12T14:10:12Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2102", "html_url": "https://github.com/secdev/scapy/pull/2102", "diff_url": "https://github.com/secdev/scapy/pull/2102.diff", "patch_url": "https://github.com/secdev/scapy/pull/2102.patch", "merged_at": "2019-07-12T14:10:12Z"}, "body": "fixes https://github.com/secdev/scapy/issues/1966", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2102/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2102/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2088", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2088/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2088/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2088/events", "html_url": "https://github.com/secdev/scapy/pull/2088", "id": 456194704, "node_id": "MDExOlB1bGxSZXF1ZXN0Mjg4Mjg3NzM5", "number": 2088, "title": "LLDP cleanup", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1000112749, "node_id": "MDU6TGFiZWwxMDAwMTEyNzQ5", "url": "https://api.github.com/repos/secdev/scapy/labels/cleanup", "name": "cleanup", "color": "FF68F6", "default": false, "description": "Performs some code clean-up"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-06-14T11:16:52Z", "updated_at": "2019-06-15T17:57:23Z", "closed_at": "2019-06-15T17:57:19Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2088", "html_url": "https://github.com/secdev/scapy/pull/2088", "diff_url": "https://github.com/secdev/scapy/pull/2088.diff", "patch_url": "https://github.com/secdev/scapy/pull/2088.patch", "merged_at": "2019-06-15T17:57:19Z"}, "body": "- fixes https://github.com/secdev/scapy/issues/2085\r\n- cleanup: use `MultipleTypeField`", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2088/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2088/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2085", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2085/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2085/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2085/events", "html_url": "https://github.com/secdev/scapy/issues/2085", "id": 455418024, "node_id": "MDU6SXNzdWU0NTU0MTgwMjQ=", "number": 2085, "title": "LLDP contrib module doesn't handle address  properly", "user": {"login": "kfir-drivenets", "id": 21293663, "node_id": "MDQ6VXNlcjIxMjkzNjYz", "avatar_url": "https://avatars.githubusercontent.com/u/21293663?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kfir-drivenets", "html_url": "https://github.com/kfir-drivenets", "followers_url": "https://api.github.com/users/kfir-drivenets/followers", "following_url": "https://api.github.com/users/kfir-drivenets/following{/other_user}", "gists_url": "https://api.github.com/users/kfir-drivenets/gists{/gist_id}", "starred_url": "https://api.github.com/users/kfir-drivenets/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kfir-drivenets/subscriptions", "organizations_url": "https://api.github.com/users/kfir-drivenets/orgs", "repos_url": "https://api.github.com/users/kfir-drivenets/repos", "events_url": "https://api.github.com/users/kfir-drivenets/events{/privacy}", "received_events_url": "https://api.github.com/users/kfir-drivenets/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-06-12T20:49:36Z", "updated_at": "2019-06-16T12:33:17Z", "closed_at": "2019-06-15T17:57:19Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "When reviewing the LLDP packet structure as defined by RFC2922 we get the following spec:\r\n```\r\nIf the associated PtopoChassisIdType object has a value of\r\n            'chasIdPtopoGenAddr(5)', then this string identifies a\r\n            particular network address, encoded in network byte order,\r\n            associated with one or more ports on the containing chassis.\r\n            The first octet contains the IANA Address Family Numbers\r\n            enumeration value for the specific address type, and octets\r\n            2 through N contain the PtopoGenAddr address value in\r\n            network byte order.\"\r\n```\r\nThus we need to have an enumeration data, e.g 4 for IPv4 as the first byte and then 4 bytes of address.\r\n\r\nRFC available at https://tools.ietf.org/html/rfc2922\r\n\r\nIn the contrib module the field is defined as such\r\n```python\r\nclass LLDPDUChassisID(LLDPDU):\r\n    \"\"\"\r\n        ieee 802.1ab-2016 - sec. 8.5.2 / p. 26\r\n    \"\"\"\r\n    LLDP_CHASSIS_ID_TLV_SUBTYPES = {\r\n        0x00: 'reserved',\r\n        0x01: 'chassis component',\r\n        0x02: 'interface alias',\r\n        0x03: 'port component',\r\n        0x04: 'MAC address',\r\n        0x05: 'network address',\r\n        0x06: 'interface name',\r\n        0x07: 'locally assigned',\r\n        range(0x08, 0xff): 'reserved'\r\n    }\r\n\r\n    LLDP_CHASSIS_ID_TLV_SUBTYPES_FIELDS = {\r\n        0x04: MACField,\r\n        0x05: IPField,\r\n    }\r\n\r\n    SUBTYPE_RESERVED = 0x00\r\n    SUBTYPE_CHASSIS_COMPONENT = 0x01\r\n    SUBTYPE_INTERFACE_ALIAS = 0x02\r\n    SUBTYPE_PORT_COMPONENT = 0x03\r\n    SUBTYPE_MAC_ADDRESS = 0x04\r\n    SUBTYPE_NETWORK_ADDRESS = 0x05\r\n    SUBTYPE_INTERFACE_NAME = 0x06\r\n    SUBTYPE_LOCALLY_ASSIGNED = 0x07\r\n\r\n    fields_desc = [\r\n        BitEnumField('_type', 0x01, 7, LLDPDU.TYPES),\r\n        BitFieldLenField('_length', None, 9, length_of='id',\r\n                         adjust=lambda pkt, x: _ldp_id_adjustlen(pkt, x)),\r\n        ByteEnumField('subtype', 0x00, LLDP_CHASSIS_ID_TLV_SUBTYPES),\r\n        _LLDPidField('id', '', LLDP_CHASSIS_ID_TLV_SUBTYPES_FIELDS, length_from=lambda pkt: pkt._length - 1)  # noqa: E501\r\n    ]\r\n```\r\n\r\nAs we can see the address is handled by the generic `IPField` which in turn doesn't add the enumeration byte. This results in invalid LLDP packets generated by scapy when setting the subtype as network address.\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2085/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2085/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2071", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2071/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2071/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2071/events", "html_url": "https://github.com/secdev/scapy/issues/2071", "id": 453092598, "node_id": "MDU6SXNzdWU0NTMwOTI1OTg=", "number": 2071, "title": "wrong Beacon's 802.11 Information Element dissection", "user": {"login": "JMbonnamy22", "id": 48909249, "node_id": "MDQ6VXNlcjQ4OTA5MjQ5", "avatar_url": "https://avatars.githubusercontent.com/u/48909249?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JMbonnamy22", "html_url": "https://github.com/JMbonnamy22", "followers_url": "https://api.github.com/users/JMbonnamy22/followers", "following_url": "https://api.github.com/users/JMbonnamy22/following{/other_user}", "gists_url": "https://api.github.com/users/JMbonnamy22/gists{/gist_id}", "starred_url": "https://api.github.com/users/JMbonnamy22/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JMbonnamy22/subscriptions", "organizations_url": "https://api.github.com/users/JMbonnamy22/orgs", "repos_url": "https://api.github.com/users/JMbonnamy22/repos", "events_url": "https://api.github.com/users/JMbonnamy22/events{/privacy}", "received_events_url": "https://api.github.com/users/JMbonnamy22/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-06-06T15:20:15Z", "updated_at": "2019-06-10T17:11:49Z", "closed_at": "2019-06-10T17:11:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "last version do not dissect correctly 802.11 Beacons information elements.\r\nhere after is an extract of .show() of beacon frame \r\n###[ 802.11 Information Element ]### \r\n           ID        = SSID\r\n           len       = 11\r\n           info      = '\\x05\\x00\\x00\\x02\\xff\\xffF\\x05\\x00\\x00\\x00'\r\nThis information element should be dissect as Qbss load as shown in pcap file attached.\r\nso it seems that there is a shift in dissection as len should be the ID\r\n\r\n#### Environment\r\n\r\n-   Scapy version: 'git-archive.dev5d3c7eff3'\r\n-   Python version: `3.7.2`\r\n-   Operating System: `windows 10`\r\n\r\n\r\n[beacon frame.zip](https://github.com/secdev/scapy/files/3262273/beacon.frame.zip)\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2071/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2071/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2062", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2062/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2062/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2062/events", "html_url": "https://github.com/secdev/scapy/pull/2062", "id": 451317001, "node_id": "MDExOlB1bGxSZXF1ZXN0Mjg0NDMyMDk0", "number": 2062, "title": "Fix unit-test of CANSignals, add documentation and minor improvements.", "user": {"login": "polybassa", "id": 1676055, "node_id": "MDQ6VXNlcjE2NzYwNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1676055?v=4", "gravatar_id": "", "url": "https://api.github.com/users/polybassa", "html_url": "https://github.com/polybassa", "followers_url": "https://api.github.com/users/polybassa/followers", "following_url": "https://api.github.com/users/polybassa/following{/other_user}", "gists_url": "https://api.github.com/users/polybassa/gists{/gist_id}", "starred_url": "https://api.github.com/users/polybassa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/polybassa/subscriptions", "organizations_url": "https://api.github.com/users/polybassa/orgs", "repos_url": "https://api.github.com/users/polybassa/repos", "events_url": "https://api.github.com/users/polybassa/events{/privacy}", "received_events_url": "https://api.github.com/users/polybassa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 514033136, "node_id": "MDU6TGFiZWw1MTQwMzMxMzY=", "url": "https://api.github.com/repos/secdev/scapy/labels/tests", "name": "tests", "color": "0e8a16", "default": false, "description": null}, {"id": 972547864, "node_id": "MDU6TGFiZWw5NzI1NDc4NjQ=", "url": "https://api.github.com/repos/secdev/scapy/labels/doc", "name": "doc", "color": "0e8a16", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2019-06-03T06:43:26Z", "updated_at": "2019-09-20T05:49:39Z", "closed_at": "2019-06-06T17:29:46Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2062", "html_url": "https://github.com/secdev/scapy/pull/2062", "diff_url": "https://github.com/secdev/scapy/pull/2062.diff", "patch_url": "https://github.com/secdev/scapy/pull/2062.patch", "merged_at": "2019-06-06T17:29:46Z"}, "body": "This fixes the unit-tests, hopefully.\r\n\r\nhttps://ci.appveyor.com/project/secdev/scapy/builds/25096483/job/btoh71rf5hdbrx8f", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2062/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2062/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2053", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2053/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2053/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2053/events", "html_url": "https://github.com/secdev/scapy/pull/2053", "id": 450733978, "node_id": "MDExOlB1bGxSZXF1ZXN0MjgzOTkzMjc3", "number": 2053, "title": "Resolve import loop", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-05-31T10:39:39Z", "updated_at": "2019-06-01T11:43:47Z", "closed_at": "2019-06-01T11:17:39Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2053", "html_url": "https://github.com/secdev/scapy/pull/2053", "diff_url": "https://github.com/secdev/scapy/pull/2053.diff", "patch_url": "https://github.com/secdev/scapy/pull/2053.patch", "merged_at": "2019-06-01T11:17:39Z"}, "body": "fixes https://github.com/secdev/scapy/issues/2052\r\n**cc @akorb**", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2053/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2053/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2052", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2052/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2052/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2052/events", "html_url": "https://github.com/secdev/scapy/issues/2052", "id": 450701674, "node_id": "MDU6SXNzdWU0NTA3MDE2NzQ=", "number": 2052, "title": "Last commit breaks import", "user": {"login": "akorb", "id": 6689889, "node_id": "MDQ6VXNlcjY2ODk4ODk=", "avatar_url": "https://avatars.githubusercontent.com/u/6689889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/akorb", "html_url": "https://github.com/akorb", "followers_url": "https://api.github.com/users/akorb/followers", "following_url": "https://api.github.com/users/akorb/following{/other_user}", "gists_url": "https://api.github.com/users/akorb/gists{/gist_id}", "starred_url": "https://api.github.com/users/akorb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akorb/subscriptions", "organizations_url": "https://api.github.com/users/akorb/orgs", "repos_url": "https://api.github.com/users/akorb/repos", "events_url": "https://api.github.com/users/akorb/events{/privacy}", "received_events_url": "https://api.github.com/users/akorb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-05-31T09:23:40Z", "updated_at": "2019-06-01T11:17:39Z", "closed_at": "2019-06-01T11:17:39Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "This commit https://github.com/secdev/scapy/commit/67afab41187797d4b240dddaecf4af4b1c934b9d breaks an import:\r\n\r\nIn the scapy folder:\r\n```python\r\n$ ipython3\r\n\r\nIn [1]: from scapy.utils import strxor                                          \r\n---------------------------------------------------------------------------\r\nImportError                               Traceback (most recent call last)\r\n<ipython-input-1-90b66f0baa84> in <module>\r\n----> 1 from scapy.utils import strxor\r\n\r\n~/src/scapy/scapy/utils.py in <module>\r\n     33 from scapy.error import log_runtime, Scapy_Exception, warning\r\n     34 from scapy.pton_ntop import inet_pton\r\n---> 35 from scapy.arch.common import TCPDUMP\r\n     36 \r\n     37 ###########\r\n\r\n~/src/scapy/scapy/arch/__init__.py in <module>\r\n     54 \r\n     55 if LINUX:\r\n---> 56     from scapy.arch.linux import *  # noqa F403\r\n     57 elif BSD:\r\n     58     from scapy.arch.unix import read_routes, read_routes6, in6_getifaddr  # noqa: F401, E501\r\n\r\n~/src/scapy/scapy/arch/linux.py in <module>\r\n     25 from scapy.consts import LOOPBACK_NAME, LINUX\r\n     26 import scapy.utils\r\n---> 27 import scapy.utils6\r\n     28 from scapy.packet import Packet, Padding\r\n     29 from scapy.config import conf\r\n\r\n~/src/scapy/scapy/utils6.py in <module>\r\n     24     IPV6_ADDR_SITELOCAL, IPV6_ADDR_LOOPBACK, IPV6_ADDR_UNICAST,\\\r\n     25     IPV6_ADDR_MULTICAST, IPV6_ADDR_6TO4, IPV6_ADDR_UNSPECIFIED\r\n---> 26 from scapy.utils import strxor\r\n     27 from scapy.compat import orb, chb\r\n     28 from scapy.pton_ntop import inet_pton, inet_ntop\r\n\r\nImportError: cannot import name 'strxor' from 'scapy.utils' (/home/user/src/scapy/scapy/utils.py)\r\n```\r\n\r\nWith `run_scapy` it works.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2052/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2052/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2047", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2047/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2047/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2047/events", "html_url": "https://github.com/secdev/scapy/pull/2047", "id": 450195965, "node_id": "MDExOlB1bGxSZXF1ZXN0MjgzNTY2NDg4", "number": 2047, "title": "Colorama isn't required on non-windows platforms", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-05-30T08:41:37Z", "updated_at": "2019-05-30T13:22:27Z", "closed_at": "2019-05-30T12:47:42Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2047", "html_url": "https://github.com/secdev/scapy/pull/2047", "diff_url": "https://github.com/secdev/scapy/pull/2047.diff", "patch_url": "https://github.com/secdev/scapy/pull/2047.patch", "merged_at": "2019-05-30T12:47:42Z"}, "body": "I forgot this was windows-specific.\r\nThe colored logger wouldn't enable on non-windows platforms.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2047/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2047/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2046", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2046/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2046/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2046/events", "html_url": "https://github.com/secdev/scapy/pull/2046", "id": 450180800, "node_id": "MDExOlB1bGxSZXF1ZXN0MjgzNTU0Nzg4", "number": 2046, "title": "Change IPv4 RADIUS attributes types", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-05-30T07:58:41Z", "updated_at": "2019-05-30T13:31:56Z", "closed_at": "2019-05-30T13:31:56Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2046", "html_url": "https://github.com/secdev/scapy/pull/2046", "diff_url": "https://github.com/secdev/scapy/pull/2046.diff", "patch_url": "https://github.com/secdev/scapy/pull/2046.patch", "merged_at": "2019-05-30T13:31:55Z"}, "body": "This PR fixes #2045.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2046/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2046/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2043", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2043/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2043/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2043/events", "html_url": "https://github.com/secdev/scapy/pull/2043", "id": 448218987, "node_id": "MDExOlB1bGxSZXF1ZXN0MjgyMDUzNTI1", "number": 2043, "title": "randval() for PacketField, to ensure correct length of byte values", "user": {"login": "AlexAshs", "id": 43880051, "node_id": "MDQ6VXNlcjQzODgwMDUx", "avatar_url": "https://avatars.githubusercontent.com/u/43880051?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AlexAshs", "html_url": "https://github.com/AlexAshs", "followers_url": "https://api.github.com/users/AlexAshs/followers", "following_url": "https://api.github.com/users/AlexAshs/following{/other_user}", "gists_url": "https://api.github.com/users/AlexAshs/gists{/gist_id}", "starred_url": "https://api.github.com/users/AlexAshs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AlexAshs/subscriptions", "organizations_url": "https://api.github.com/users/AlexAshs/orgs", "repos_url": "https://api.github.com/users/AlexAshs/repos", "events_url": "https://api.github.com/users/AlexAshs/events{/privacy}", "received_events_url": "https://api.github.com/users/AlexAshs/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-05-24T15:05:17Z", "updated_at": "2019-08-28T11:19:37Z", "closed_at": "2019-05-24T16:24:42Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2043", "html_url": "https://github.com/secdev/scapy/pull/2043", "diff_url": "https://github.com/secdev/scapy/pull/2043.diff", "patch_url": "https://github.com/secdev/scapy/pull/2043.patch", "merged_at": "2019-05-24T16:24:42Z"}, "body": "Fixes #1861\r\n\r\nFixes the problem of the behavior of `randval` in `PacketField`.\r\nIt applies the proposed fix in the mentioned issue and I added unit tests which check whether the correct `Rand*` object has been applied to all fields.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2043/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2043/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2035", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2035/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2035/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2035/events", "html_url": "https://github.com/secdev/scapy/pull/2035", "id": 445802535, "node_id": "MDExOlB1bGxSZXF1ZXN0MjgwMTU3NjQ2", "number": 2035, "title": "Fix FlagsField & dissection improvements", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-05-19T10:12:32Z", "updated_at": "2020-07-19T09:18:56Z", "closed_at": "2019-06-07T06:44:38Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2035", "html_url": "https://github.com/secdev/scapy/pull/2035", "diff_url": "https://github.com/secdev/scapy/pull/2035.diff", "patch_url": "https://github.com/secdev/scapy/pull/2035.patch", "merged_at": "2019-06-07T06:44:38Z"}, "body": "This is a part of https://github.com/secdev/scapy/pull/1999 that can be fast tracked.\r\nThis PR:\r\n- **Small performances boost: consistent 5-10% on dissection (caching improvements & guess_payload_class)**\r\n\r\n```\r\n>>> a = raw(Ether()/IP()/UDP())\r\n>>> %timeit Ether(a)\r\n```\r\n\r\n- Fixes `FlagsField` very weird behavior:\r\n\r\n**before (?!?!)**\r\n```python\r\n>>> EIR_Hdr() / EIR_Flags(flags=[\"general_disc_mode\", \"br_edr_not_supported\"])\r\n<EIR_Hdr  type=flags |<EIR_Flags  flags=['general_disc_mode', 'br_edr_not_supported'] |>>\r\n+ when raw(), flags was wrongly built\r\n```\r\n**after**\r\n```python\r\n>>> EIR_Hdr() / EIR_Flags(flags=[\"general_disc_mode\", \"br_edr_not_supported\"])\r\n<EIR_Hdr  type=flags |<EIR_Flags  flags=general_disc_mode+br_edr_not_supported |>>\r\n```\r\n\r\n- Improve dissection speed by reducing number of calls to `hasattr`\r\n- Makes `clear_cache()` work on subpackets", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2035/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2035/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2032", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2032/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2032/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2032/events", "html_url": "https://github.com/secdev/scapy/pull/2032", "id": 445496649, "node_id": "MDExOlB1bGxSZXF1ZXN0Mjc5OTM2MDY1", "number": 2032, "title": "2 minor bugs", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-05-17T15:25:14Z", "updated_at": "2019-05-17T21:06:05Z", "closed_at": "2019-05-17T21:06:05Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2032", "html_url": "https://github.com/secdev/scapy/pull/2032", "diff_url": "https://github.com/secdev/scapy/pull/2032.diff", "patch_url": "https://github.com/secdev/scapy/pull/2032.patch", "merged_at": "2019-05-17T21:06:05Z"}, "body": "- fixes bug discussed in https://github.com/secdev/scapy/pull/2029\r\n- fixes https://github.com/secdev/scapy/issues/2031", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2032/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2032/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2029", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2029/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2029/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2029/events", "html_url": "https://github.com/secdev/scapy/pull/2029", "id": 444999638, "node_id": "MDExOlB1bGxSZXF1ZXN0Mjc5NTQxNDcy", "number": 2029, "title": "Fix L2CAP_ConnResp comparing incorrect CID fields", "user": {"login": "HorakS", "id": 37438821, "node_id": "MDQ6VXNlcjM3NDM4ODIx", "avatar_url": "https://avatars.githubusercontent.com/u/37438821?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HorakS", "html_url": "https://github.com/HorakS", "followers_url": "https://api.github.com/users/HorakS/followers", "following_url": "https://api.github.com/users/HorakS/following{/other_user}", "gists_url": "https://api.github.com/users/HorakS/gists{/gist_id}", "starred_url": "https://api.github.com/users/HorakS/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HorakS/subscriptions", "organizations_url": "https://api.github.com/users/HorakS/orgs", "repos_url": "https://api.github.com/users/HorakS/repos", "events_url": "https://api.github.com/users/HorakS/events{/privacy}", "received_events_url": "https://api.github.com/users/HorakS/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-05-16T14:48:25Z", "updated_at": "2019-05-17T15:26:19Z", "closed_at": "2019-05-17T15:06:57Z", "author_association": "NONE", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2029", "html_url": "https://github.com/secdev/scapy/pull/2029", "diff_url": "https://github.com/secdev/scapy/pull/2029.diff", "patch_url": "https://github.com/secdev/scapy/pull/2029.patch", "merged_at": "2019-05-17T15:06:57Z"}, "body": "L2CAP Connection Responses were not detected as answers if the DCID field of\r\nthe Request differed from the Response's SCID field. According to the\r\nBluetooth Core specifications, only the SCID fields are identical in Request\r\nand Response.\r\n\r\nFixes #2012.\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2029/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2029/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2015", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2015/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2015/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2015/events", "html_url": "https://github.com/secdev/scapy/pull/2015", "id": 440327228, "node_id": "MDExOlB1bGxSZXF1ZXN0Mjc1OTIzOTU1", "number": 2015, "title": "Implement some more BT ATT fields", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 267691054, "node_id": "MDU6TGFiZWwyNjc2OTEwNTQ=", "url": "https://api.github.com/repos/secdev/scapy/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-05-04T14:13:15Z", "updated_at": "2019-05-29T15:54:39Z", "closed_at": "2019-05-29T11:23:13Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2015", "html_url": "https://github.com/secdev/scapy/pull/2015", "diff_url": "https://github.com/secdev/scapy/pull/2015.diff", "patch_url": "https://github.com/secdev/scapy/pull/2015.patch", "merged_at": "2019-05-29T11:23:13Z"}, "body": "fixes https://github.com/secdev/scapy/issues/1995", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2015/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2015/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2012", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2012/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2012/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2012/events", "html_url": "https://github.com/secdev/scapy/issues/2012", "id": 439960093, "node_id": "MDU6SXNzdWU0Mzk5NjAwOTM=", "number": 2012, "title": "L2CAP_ConnResp answers method is comparing the wrong Channel Identifier fields", "user": {"login": "HorakS", "id": 37438821, "node_id": "MDQ6VXNlcjM3NDM4ODIx", "avatar_url": "https://avatars.githubusercontent.com/u/37438821?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HorakS", "html_url": "https://github.com/HorakS", "followers_url": "https://api.github.com/users/HorakS/followers", "following_url": "https://api.github.com/users/HorakS/following{/other_user}", "gists_url": "https://api.github.com/users/HorakS/gists{/gist_id}", "starred_url": "https://api.github.com/users/HorakS/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HorakS/subscriptions", "organizations_url": "https://api.github.com/users/HorakS/orgs", "repos_url": "https://api.github.com/users/HorakS/repos", "events_url": "https://api.github.com/users/HorakS/events{/privacy}", "received_events_url": "https://api.github.com/users/HorakS/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-05-03T09:22:18Z", "updated_at": "2019-05-17T15:06:57Z", "closed_at": "2019-05-17T15:06:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nThe answers method of L2CAP_ConnResp (scapy/layers/bluetooth.py) is comparing the wrong Channel Identifier fields.\r\n\r\n\r\n#### Actual result\r\n\r\nThe answers method of L2CAP_ConnResp checks whether the _dcid_ field of the Response is the same as the _scid_ field from the Request.\r\nHowever, according to Bluetooth Core spec v4.2 (p. 63):\r\n\r\n> 4.3 CONNECTION RESPONSE (CODE 0x03)\r\n> Source Channel Identifier - SCID (2 octets)\r\n> This field contains the channel endpoint on the device receiving this\r\n> Response packet. This is copied from the SCID field of the connection\r\n> request packet.\r\n\r\nOn the other hand, the Destination Channel Identifier (DCID) of the Response is chosen by the receiver of the Request and is not necessarily related to the SCID of the Request.\r\n\r\nThis leads to L2CAP Connection Responses not getting detected as answers to Connection Requests if SCID and DCID differ.\r\n\r\n#### Expected result\r\n\r\nInstead of:\r\n\r\n> return isinstance(other, L2CAP_ConnReq) and self.dcid == other.scid\r\n\r\nit should be \r\n\r\n> return isinstance(other, L2CAP_ConnReq) and self.scid == other.scid\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2012/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2012/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2011", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2011/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2011/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2011/events", "html_url": "https://github.com/secdev/scapy/pull/2011", "id": 439287756, "node_id": "MDExOlB1bGxSZXF1ZXN0Mjc1MTI3NDcz", "number": 2011, "title": "Improve path detection & Add backup ethertypes", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 267691054, "node_id": "MDU6TGFiZWwyNjc2OTEwNTQ=", "url": "https://api.github.com/repos/secdev/scapy/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}, {"id": 564414240, "node_id": "MDU6TGFiZWw1NjQ0MTQyNDA=", "url": "https://api.github.com/repos/secdev/scapy/labels/convergence", "name": "convergence", "color": "c2e0c6", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-05-01T19:20:42Z", "updated_at": "2019-06-01T19:14:34Z", "closed_at": "2019-06-01T11:37:41Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2011", "html_url": "https://github.com/secdev/scapy/pull/2011", "diff_url": "https://github.com/secdev/scapy/pull/2011.diff", "patch_url": "https://github.com/secdev/scapy/pull/2011.patch", "merged_at": "2019-06-01T11:37:41Z"}, "body": "This PR:\r\n- fixes https://github.com/secdev/scapy/pull/1839\r\n- adds a backup version of `/etc/ethertypes` as it's not available by default on most platforms, and hasn't been for a long time. The warning is currently hidden because of a loading issue (it is uncovered by https://github.com/secdev/scapy/pull/1996)\r\n\r\n#### Where to get /etc/ethertypes?\r\n\r\nThe file's official sources are all down, therefore we have to find an alternative. But the mirrors of the file have outdated versions.\r\n\r\nTherefore this PR uses OpenBSD's version of the file (a C header) converted to the legacy format. I've added the generation script to the `tools` folder.\r\n\r\nThis allow us to keep full compatibility with all platforms, and use the installed file when available.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2011/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2011/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/2010", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/2010/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/2010/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/2010/events", "html_url": "https://github.com/secdev/scapy/pull/2010", "id": 439134748, "node_id": "MDExOlB1bGxSZXF1ZXN0Mjc1MDA3NDMy", "number": 2010, "title": "Fix GTP_U_Header binds", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 16, "created_at": "2019-05-01T11:19:46Z", "updated_at": "2019-05-03T21:47:08Z", "closed_at": "2019-05-03T21:27:50Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/2010", "html_url": "https://github.com/secdev/scapy/pull/2010", "diff_url": "https://github.com/secdev/scapy/pull/2010.diff", "patch_url": "https://github.com/secdev/scapy/pull/2010.patch", "merged_at": "2019-05-03T21:27:50Z"}, "body": "This PR:\r\n- fixes https://github.com/secdev/scapy/issues/2008", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/2010/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/2010/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1995", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1995/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1995/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1995/events", "html_url": "https://github.com/secdev/scapy/issues/1995", "id": 435506038, "node_id": "MDU6SXNzdWU0MzU1MDYwMzg=", "number": 1995, "title": "bluetooth ATT group packetlist parsing question ", "user": {"login": "notmikeb", "id": 9265088, "node_id": "MDQ6VXNlcjkyNjUwODg=", "avatar_url": "https://avatars.githubusercontent.com/u/9265088?v=4", "gravatar_id": "", "url": "https://api.github.com/users/notmikeb", "html_url": "https://github.com/notmikeb", "followers_url": "https://api.github.com/users/notmikeb/followers", "following_url": "https://api.github.com/users/notmikeb/following{/other_user}", "gists_url": "https://api.github.com/users/notmikeb/gists{/gist_id}", "starred_url": "https://api.github.com/users/notmikeb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/notmikeb/subscriptions", "organizations_url": "https://api.github.com/users/notmikeb/orgs", "repos_url": "https://api.github.com/users/notmikeb/repos", "events_url": "https://api.github.com/users/notmikeb/events{/privacy}", "received_events_url": "https://api.github.com/users/notmikeb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-04-21T12:43:00Z", "updated_at": "2019-09-24T13:28:54Z", "closed_at": "2019-05-29T11:23:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\nhow do use a length field with a list of grouped fields for Bluetooth ATT protocol\r\n\r\nI am doing some Bluetooth ATT packet parsing\r\nI don't know to to use PacketListField or FieldListField to do the parsing\r\ncould you get me a hint about dynamic field length?\r\n\r\nI use a fixed value, 7 , to do the att_data_list parsing\r\nbut i should not use a fixed value,7\r\n\r\nregarding ATT \"Read_By_Type_Response\" spec's definition, \r\nlength field is the length of a pair of Handle and Value, aka Attribute_Data_HandleValue.\r\nafter length field , there are a few Attribute_Data_HandleValue Fields\r\nIt is a list grouping fields\r\nuser could use att_data_list[0].handle to access the handle value\r\nuser could use att_data_list[0].data to access the data value\r\n\r\n#### Environment\r\n-   Scapy version: latest\r\n-   Python version: 3.5\r\n-   Operating System: win10\r\n\r\n#### How to reproduce\r\nmy temporary workaround code are shown below\r\nIt only works when length is 7\r\nI wonder how to change it to arbitrary length field\r\n\r\na full sample code\r\n#sample-data\r\n```python\r\nfrom scary.layers.bluetooth import *\r\na1 = HCI_Hdr(bytes.fromhex('0248201b001700040009070200020300002a0400020500012a0600020700042a'))\r\n\r\na1.show()\r\n```\r\n\r\nConsole output as below\r\n###[ ATT header ]###\r\n           opcode    = 0x9\r\n###[ Read By Type Response ]###\r\n              length    = 7\r\n              \\att_data_list\\\r\n               |###[ Attribute_Data_HandleValue ]###\r\n               |  handle    = 0x2\r\n               |  data      = 020300002a\r\n               |###[ Attribute_Data_HandleValue ]###\r\n               |  handle    = 0x4\r\n               |  data      = 020500012a\r\n               |###[ Attribute_Data_HandleValue ]###\r\n               |  handle    = 0x6\r\n               |  data      = 020700042a\r\n\r\nThe code snippet inside scapy/layers/Bluetooth.py\r\n\r\n```python\r\nclass Attribute_Data_HandleValue(Packet):\r\n    name = \"Attribute_Data_HandleValue\"\r\n    fields_desc = [XLEShortField(\"handle\", 0),\r\n                   XStrLenField(\"data\", 0, length_from= lambda x: 5),\r\n                   ]\r\n    def extract_padding(self, p):\r\n        return \"\", p\r\n\r\nclass ATT_Read_By_Type_Response(Packet):\r\n    name = \"Read By Type Response\"\r\n    fields_desc = [\r\n                   ByteField('length', None), \r\n                   PacketListField (\"att_data_list\", None, Attribute_Data_HandleValue), \r\n                    ]\r\n                    \r\n```\r\n\r\n#### Expected result\r\nnot to use a fixed length 7 to do the parsing\r\nThe length field is a arbitrary number\r\n\r\nafter length field, there are a few Attribute_Data_HandleValue Fields\r\nthose Attribute_Data_HandleValue should have the same length of data value\r\n\r\nuser could use att_data_list[0].handle to access the handle value\r\nuser could use att_data_list[0].data to access the data value\r\n\r\n\r\n#### Related resources\r\nthe length is not a fixed value\r\nso the data is a kind of XStrLenField with a 'length_from' value\r\nsince Attribute_Data_HandleValue cannot access the length value, I don't know how to get the length value and create it\r\n\r\n###[ ATT header ]###\r\n           opcode    = 0x9\r\n###[ Read By Type Response ]###\r\n              length    = 6\r\n              \\att_data_list\\\r\n               |###[ Attribute_Data_HandleValue ]###\r\n               |  handle    = 0x2\r\n               |  data      = 02030000\r\n               |###[ Attribute_Data_HandleValue ]###\r\n               |  handle    = 0x4\r\n               |  data      = 02050001\r\n               |###[ Attribute_Data_HandleValue ]###\r\n               |  handle    = 0x6\r\n               |  data      = 02070004", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1995/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1995/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1994", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1994/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1994/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1994/events", "html_url": "https://github.com/secdev/scapy/pull/1994", "id": 435493847, "node_id": "MDExOlB1bGxSZXF1ZXN0MjcyMjA1NjU5", "number": 1994, "title": "Fix MultipleTypeField default values handling", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1000112749, "node_id": "MDU6TGFiZWwxMDAwMTEyNzQ5", "url": "https://api.github.com/repos/secdev/scapy/labels/cleanup", "name": "cleanup", "color": "FF68F6", "default": false, "description": "Performs some code clean-up"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-04-21T09:52:53Z", "updated_at": "2019-04-26T12:53:51Z", "closed_at": "2019-04-26T12:48:45Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1994", "html_url": "https://github.com/secdev/scapy/pull/1994", "diff_url": "https://github.com/secdev/scapy/pull/1994.diff", "patch_url": "https://github.com/secdev/scapy/pull/1994.patch", "merged_at": "2019-04-26T12:48:44Z"}, "body": "This PR:\r\n- fixes https://github.com/secdev/scapy/issues/1955\r\n- this PR led to the discovery of a small ARP bug when using IPv6 addresses (the routing would try to perform IPv4 routing with an IPv6 address)\r\n- merges the two `_find_field` functions together\r\n- add tests", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1994/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1994/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1987", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1987/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1987/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1987/events", "html_url": "https://github.com/secdev/scapy/pull/1987", "id": 432945921, "node_id": "MDExOlB1bGxSZXF1ZXN0MjcwMjgwMjE5", "number": 1987, "title": "Radius EAP-Message fix + message_authentication forced zero filling", "user": {"login": "Matheus-Garbelini", "id": 6465668, "node_id": "MDQ6VXNlcjY0NjU2Njg=", "avatar_url": "https://avatars.githubusercontent.com/u/6465668?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Matheus-Garbelini", "html_url": "https://github.com/Matheus-Garbelini", "followers_url": "https://api.github.com/users/Matheus-Garbelini/followers", "following_url": "https://api.github.com/users/Matheus-Garbelini/following{/other_user}", "gists_url": "https://api.github.com/users/Matheus-Garbelini/gists{/gist_id}", "starred_url": "https://api.github.com/users/Matheus-Garbelini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Matheus-Garbelini/subscriptions", "organizations_url": "https://api.github.com/users/Matheus-Garbelini/orgs", "repos_url": "https://api.github.com/users/Matheus-Garbelini/repos", "events_url": "https://api.github.com/users/Matheus-Garbelini/events{/privacy}", "received_events_url": "https://api.github.com/users/Matheus-Garbelini/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2019-04-14T08:21:48Z", "updated_at": "2019-06-13T15:13:27Z", "closed_at": "2019-06-13T15:13:27Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1987", "html_url": "https://github.com/secdev/scapy/pull/1987", "diff_url": "https://github.com/secdev/scapy/pull/1987.diff", "patch_url": "https://github.com/secdev/scapy/pull/1987.patch", "merged_at": "2019-06-13T15:13:27Z"}, "body": "In response to #1971 and #1973 \r\n\r\n* Fragmented EAP-Messages are now correctly handled by using \"length_from\" property from PacketLenField class\r\n\r\n* When digesting Radius packets with message-authenticator attribute already there, compute_message_authenticator now forces this field to be zero filled. Method `prepare_packed_data` is updated to receive one more argument `clear_message_authenticator` which ensure this check in the attribute loop.\r\n\r\n* Regression test for `compute_message_authenticator` was updated for this changes as the test was being compared to an incorrect expected result. A more precise test could be achieved if we knew the shared secret of this radius server, so the output of this function would be the exact same value from the message-authenticator attribute in the `radius_packet`.\r\n\r\n`./run_tests` was runned to verify if nothing more was affected by this changes.\r\n\r\nPlease, feel free to edit anything as Quality Review has failed due to the use of `type()` function", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1987/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1987/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1985", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1985/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1985/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1985/events", "html_url": "https://github.com/secdev/scapy/issues/1985", "id": 432865611, "node_id": "MDU6SXNzdWU0MzI4NjU2MTE=", "number": 1985, "title": "TLS dissection error", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1317786288, "node_id": "MDU6TGFiZWwxMzE3Nzg2Mjg4", "url": "https://api.github.com/repos/secdev/scapy/labels/tls", "name": "tls", "color": "56088e", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-04-13T16:15:16Z", "updated_at": "2019-06-20T17:23:16Z", "closed_at": "2019-06-20T17:23:16Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Occurred during a sniff on master.\r\n\r\n```\r\nZ:\\Coding\\github\\scapy\\scapy\\layers\\tls\\cert.py in __call__(cls, cert_path)\r\n    574             cert = X509_Cert(obj.der)\r\n    575         except Exception:\r\n--> 576             raise Exception(\"Unable to import certificate\")\r\n    577         obj.import_from_asn1pkt(cert)\r\n    578         return obj\r\n\r\nException: Unable to import certificate\r\n```\r\n\r\nTo reproduce, from `debug.crashed_on`:\r\n```\r\npkt = Ether(b'\\xd0P\\x99V\\xdd\\xf9\\x14\\x0cv\\x8f\\xfe(\\x86\\xdd`\\x0f\\xb1\\xbe\\x04\\xd8\\x06{*\\x00\\x14P@\\x07\\x08\\x16\\x00\\x00\\x00\\x00\\x00\\x00 \\x04*\\x01\\x0e5/\\x17\\xfe`\\x18\\xb5\\x9b\\xfc \\xc8\\xc5\\xa9\\x01\\xbb\\xd7o{\\xc0\\x89\\n\\x91\\xec\\xf2\\x9eP\\x10\\x00\\x8d\\xb3\\x1b\\x00\\x00\\xc00\\x04J<L\\xe3\\xe7la\\x8f\\xf8\\xb8\\xaeC\\xaa\\xfe\\x98\\xd9\\xb3b\\xa3\\xc3\\x04\\x10\\xa0\\xb3\\x19U\\xfaX\\xd3\\x86\\x92D\\xd1Ti\\x07\\x00N\\x9e\\x0b8~\\x1d\\xfa\\xdc\\xfc\\x8dA\\xaf\\x12b\\xbe\\x19\\x8a\\xd8,\\xe4nb2x\\xca\\x0bk\\xd7~\\x07\\x11\\x19\\xe1\\xc5x\\xbf\\xa9C\\xa7[\\x10\\xd2\\xbe\\xd7\\xdf\\x18xh\\xcc6\\x06V\\xfb\\x0e\\xf3\\xdd\\xb3\\x11\\xde,\\xfd\\xc6\\x16\\x04\\xf0MB\\xac\\x05\\xb4f\\xa39*eD\\xdd\\xaa\\t\\x8f\\x99\\x16h\\xa33\\xc71\\xc8\\xeb\\xf7W\\xd1\\xec\\xe6\\x13\\x96XHq~\\x8f\\xf3\\xfcR\\xfc\\x06\\xb9\\r\\xe9\\xe6\\xfa=J\\xb1\\x81\\xfc\\xd2\\xc8\\xec\\xdc\\x93\\x9b%\\x86\\xa7\\\\\\xe3G\\x8d\\x0f\\xab\\xf5b\\x97\\xac\\xe6\\xa6\\xcb\\xdf.e\\x00\\x0cQ\\xf7\\x9c\\xd8e\\xc6\\x06\\x8b\\x9e\\xdbm\\xd8N\\x00\\xc4\\x1f\\x1f\\xeb@\\x12\\xbb`z\\xbcB\\xf5\\x1e\\xf0rJQ\\xd7?\\x9e#_\\t\\x15\\x0c\\n\\xc0\\xc5l\\x14\\xcat\\x8a\\xb7\\x8c\\x9b\\xf49\\x85=\\x0c\\x9e\\xa2\\x87\\x8f\\xb8\\xa5H\\x8e\\xc4;]\\x8e\\xe3\\xaf\\x9e\\xbf(\\xc3\\xed}\\xc2\\x96\\x01\\xf7$\\x04g#\\x93\\xa6\\xbb\\xd5\\xbb0\\xe9\\xabW\\xd6\\xc0,\\x14\\xa0\\xe9\\xb6\\xa5\\xdb\\x8d^\\xdeU}\\n\\xea\\xbe\\xe0~\\xe4\\xd6\\x85\\xa2,x\\x8c\\x02\\xb5\\x84D\\x8c\\xa9\\xb7\\xff\\x14\\xe9$\\xa9n\\xcb\\x95KmTe\\x9a$\\x9a\\xbbH\\xcb\\x80(W\\x8c\\xc4\\x0cw1\\xf4\\xde\\x84\\x8d\\'\\xdf\\x8c\\x83zF\\xf7\\xefl\\x9e\\xa6=\\x85\\x02h\\x16\\x8c\\xe7Z\\x8a\\xc7v\\x84\"v\\x81\\x17.\\xe3\\xa1\\xd9]\\x8as\\xc6\\\\\\x05>\\xa5w\\x9b\\xd2\\xbd`\\xfex\\\\j1J\\\\\\xe8\\xf5\\x90K\\xf8\\x15\\xaa\\xb5D\\x19\\x8c\\xfdR~\\xef\\xde\\r\\xbe\\x93_\\x99 U\\xb6\\xcf\\xf76\\xa0\\xd1\\x9069.\\xe8g|\\x83V\\xf9zsb\\xcd\\x91\\xf8\\x80\\xcfV\\n\\xd6\\x93\\xc1\\xea\\x84\\xe7RC\\x85G\\xf5\\x16@\\x99\\x8d\\xd8\\x04qf;R\\xad\\xe3\\xdc\\xf9\\x9a\\xe7Uii\\xef\\x084\\xfd\\x9e\\xe1\\xe0\\x14\\xf9\\xe5\\xe77\\x9c5\\xa3)\\xe3\\xe8\\x8e\\xb2\\xe5\\xdb:R\"\\x99\\xb3\\xfb\\xc9\\xa2\\x9d+\\x0c\\x83\\x13\\x81-%f\\xbfa\\x8b2\\xeeX\\xfe\\xfb\\xd7d|\\xdfN\\x04\\xe2\\xc3\\x96\\xab\\xebV\\xe2*\\x8aT\\x86\\xea\"?H=\\x9d\\xe5V\\xc1\\x97\\xb1\\xd6P\\xe6m\\xf4\\x088*\\x93B\\xf8\\xf8s\\x90,\\xa7PHh\\x13w\\x97\\x84\\xfdO\\x9a\\x16\\xed\\x883\\x11\\x81\\xcb\\nA\\x0by\\xa7\\xd3a2&*\\xd4\\x97\\r\\xb5^n\\x82b\\xe1\\\\U\\xe7L?\\xbc\\xee\\xd9\\x08\\x9dt\\x18$\\xe5O\\xab\\x87Z\\xe8R%\\xde\\xe1\\x82\\xf8\\x92Z\\x0c\\x83K\\x84\\t\\n\\xb4~HU\\x02_\\xe2\\xb8\\x80\\xdaj\\tg\\x04l\\xf2\\xf6\\xac\\xa2\\x9c\\x0fg\\x1b\\xe1\\x99\\xf6\\x9e\\xdd:\\xde\\x17\\x03\\x03\\x04\\xbf\\x00\\x00\\x00\\x00\\x00\\x00\\x00h+\\x069D\\x81\\x9a\\xa6\\x93\\x1ffn\\xa9\\x87\\xe3d\\x96\\x92\\xd8*\\x15\\xf6G\\xf0\\xf951\\xc9\\xa1\\xc7R\\xe8c\\xa2\\xae\\x9ei$\\x86\\x8f\\xc6\\xbc\\x9f\\xa2!~\\x8dn\\x18\\xb1\\xc5\\x1d\\x01#\\x98 ?\\xa2c{\\xa5XD\\xa1No.Q\\x0c\\xb0\\x14\\x01q\\xba\\xe3\\x97E\\n\\xbdH\\xcb\\x91a\\xf23\\x82P\\x05\\xcaY\\xe0\\x03\\x95\\x85]\\xaf#\\xd5_\\x8e\\x13\\x83ht\\n}\\x934\\xd3\\xe3l\\xf3o$$\\x96}\\x00m\\x08|Il[\\x1f\\x89\\xf1\\x03\\x19?#\\xe3\\xcfJ\\xb6\\x83\\xd9\\xd9\\xdc\\x1a\\xbbd\\xc0;\\x0e*\\x11O\\xa6O\\x9c)\\x10\\r\\x0e\\x89\\xfc\\xb7\\xfa\\\\\\xb4M\\xc5\\xba\\x8d\\xee\\x8f\\x80\\x1f{\\xe9L\\xda\\x95\\xe4%\\xff\\xe73$\\xb47\\xd4\\x97\\x8a\\xec\\x11\\xee\\xa8-<\\xac\\xe8\\xacR\\x84\\xf2\\xcb\\x02\\x02mI\\x94Hy\\xaaFlK\\x11\\xbaf\\xb5CI1\\x9er\\xf7\\x7f\\xa5\\x8bkf@O\\xdd7[\\xed\\x04i\\x93\\xc3\\xde\\xfb\\xdaCf\\xa1\\x8ft\\xf2\\xa4U^[\\xe7\\xff\\x13?\\x90e\\xa1\\xae9\\xd8\\xc0y\\x0f\\xf1\\xf6u\\ro^t\\xc8[*\\xcd\\x00\\xc6\\x87\\xac%4\\xb6\\x98\\xc8\\xc2-\\x97qC3&\\x82\\xdd\\xe2\\x0f\\xd19\\xb9\\xa8\\x90\\x96\\xa3\\xb2\\xe6\\xc8#\\x86\\xdaT\\xa2\\xd6n\\x8f\\xbf\\x91\\x9f\\xeb\\xbd\\xce:J\\xd9aP\\xd4<8p\\x92\\xc2\\x13Eo&\\x85\\xcfu\\xe3\\'D\\t\\xfaM`\\x01x\\xe06\\x18T\\xa4\\xd9\\x858\\xbe\\xa0w\\xa2wq\\x1c\\xf6\\xd43a\\x00\\xbd\\xa0o\\xfd\\x06\\xd90U\\x8e\\xb2V\\x14\\x08 <\\xff\\xa9y:\\xde\\xd1p\\xc9}#\\x0e\\xa5\\xfbA\"7\\x89\\xd5\\xd1\\xaf\\xd6\\x82\\xbe \\x8a\\x92E\\x01\\xb0T\\xea:U\\xa4t\\xbcm><j\\xc3\\xb0\\'\\x19g\\x95S\\x83\\x93\\x12\\x8b\\x1eF;TCJ\\x95n\\x01\\xfdt\\xe8\\x84CM\\xc5\\x01\\x9a\\x8c\\xdf\\x84{\\x96e\\xee\\x83\\xd3>7\\xb3\\x9af\\xc6aQN]\\xf3\\x93b\\x95%q\\xf9\\xe653\\x96I\\xe9FO\\x92\\xa7\\xec\\xb1w\\xbd\\x01.v\\xdb\\x03\\xad\\xa2\\xba\\xb3\\xea\\xfa\\xaf\\xd7L\\xaa\\xb7\\x0eZ\\xba\\x97\\xb8s\\x922\\xf2\\xd8[B\\x8e\\xd5\\xdd$\\xa2\\xac\\xec\\xf4\\xca\\xe0\\xf3\\x18\\xff\\x8c\\x17\\xb4\\xe2K\\xb08)\\xc3\\xcfW\\xc1te\\xb31\\x05,\\xc8\\x03i%{')\r\n```\r\n\r\nAnother one triggered by an [AppVeyor build](https://ci.appveyor.com/project/secdev/scapy/builds/23837282/job/t0k08m71ledk5e32) & thanks to UTscapy analysis:\r\n\r\n```\r\nEther(hex_bytes('00155dfb587a00155dfb58430800450005dc54d3400070065564400410d40a00000d01bb044e8b86744e16063ac45010faf06ba9000016030317c30200005503035cb336a067d53a5d2cedbdfec666ac740afbd0637ddd13eddeab768c3c63abee20981a0000d245f1c905b329323ad67127cd4b907a49f775c331d0794149aca7cdc02800000d0005000000170000ff010001000b000ec6000ec300090530820901308206e9a00302010202132000036e72aded906765595fae000000036e72300d06092a864886f70d01010b050030818b310b3009060355040613025553311330110603550408130a57617368696e67746f6e3110300e060355040713075265646d6f6e64311e301c060355040a13154d6963726f736f667420436f72706f726174696f6e31153013060355040b130c4d6963726f736f6674204954311e301c060355040313154d6963726f736f667420495420544c532043412032301e170d3138303632393139303635355a170d3230303632393139303635355a301b3119301706035504030c102a2e6c6f67696e2e6c6976652e636f6d30820122300d06092a864886f70d01010105000382010f003082010a0282010100bd1d4afe8064b0b1296b6de1b1983ed1a9468770757eea26ff0a2ecde5c789a745becfdc9d07318c113cf8840f57c9379be097563dfbda7d124a4b3c2aea139ab5d9c281e19f74288aa0b33a078bc67ae70fa02083addf4d0a49e36764238d396b718d227cc5965d5f5e22aa40e0d8c6a45595f0ac0b173af5559fc83abf31d16433f29b91b61e5dabad5c8c92110a80209796937cf2836c35815d9d6b5527972a94608e03a24faf2dacc9f17a177e34061e3ef321602bf92809e473bf08ae5a97faae517f7f78e5908aa4c0a278b2ebfb3e15c544d8aa7e12d5e655f9d9bdc02e0b2adcdb3c641d94d04c32ffe10f569bf5ca48cda8b7da14bd7dea95089a210203010001a38204cb308204c7308201f3060a2b06010401d679020402048201e3048201df01dd007500a4b90990b418581487bb13a2cc67700a3c359804f91bdfb8e377cd0ec80ddc10000001644cfa2b4f00000403004630440220638bcbfa1bf0c762296edac11109c8fc53c08b04c5c7e33065467b09dbb1ffb602207c9f0ea8006081f217d8fd1d81ea62589f5a464aa04c9b0bb0c2d67706d3a57d007500ddeb1d2b7a0d4fa6208b81ad8168707e2e8e9d01d55c888d3d11c4cdb6ecbecc000001644cfa2d91000004030046304402200c24fb3b1f4ac6776924568e15d8f57492f7822af4a6cb1a2fce3361634c946802202a24cf48ec44b189700713d95a9237b7b64f067306df29e686eb0e14b285451c0075005ea773f9df56c0e7b536487dd049e0327a919a0c84a112128418759681714558000001644cfa30c90000040300463044022036b8efe060ff0e40d343953e2dcfc5d78126cbc8fa30c6e7c4a5bf3335da29c002207d6002e4f618df32c583af2669da4e16e05b590b622bf89a0a3d3dfdf615e50e007600bc78e1dfc5f63c684649334da10fa15f0979692009c081b4f3f6917f3ed9b8a5000001644cfa2c630000040300473045022027f9b69d95d18a378830b5c2a1b1df0e84d89bf7da52fffe9f7157d624733638022100d65fba5f0e74d63579be1cd5c7a2bce6b4195400539297329911384d7918c72b302706092b060104018237150a041a3018300a06082b06010505070302300a06082b06010505070301303e06092b06010401823715070431302f06272b060104018237150887da867583eed90182c9851b81b59e6185f4eb60815d84d2df4282e7937a02016402011d30818506082b0601050507010104793077305106082b060105050730028645687474703a2f2f7777772e6d6963726f736f66742e636f6d2f706b692f6d73636f72702f4d6963726f736f66742532304954253230544c532532304341253230322e637274302206082b060105050730018616687474703a2f2f6f6373702e6d736f6373702e636f6d301d0603551d0e041604141154417dbc650ff6a11bb27d015e559bce915a6b300b0603551d0f0404030204b030730603551d11046c306a822070'))\r\n```", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1985/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1985/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1984", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1984/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1984/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1984/events", "html_url": "https://github.com/secdev/scapy/pull/1984", "id": 432865105, "node_id": "MDExOlB1bGxSZXF1ZXN0MjcwMjM3MDA3", "number": 1984, "title": "Improve Dot11 backward compatibility", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 564414240, "node_id": "MDU6TGFiZWw1NjQ0MTQyNDA=", "url": "https://api.github.com/repos/secdev/scapy/labels/convergence", "name": "convergence", "color": "c2e0c6", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-04-13T16:11:25Z", "updated_at": "2019-04-15T10:19:24Z", "closed_at": "2019-04-15T06:59:31Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1984", "html_url": "https://github.com/secdev/scapy/pull/1984", "diff_url": "https://github.com/secdev/scapy/pull/1984.diff", "patch_url": "https://github.com/secdev/scapy/pull/1984.patch", "merged_at": "2019-04-15T06:59:31Z"}, "body": "This PR:\r\n- adds `info` to all `Dot11Elt` tags, so that we can introduce new tags without breaking existing implementations that would parse `info` manually (as a lot do today)\r\n- fix `Dot11EltCountry` length handling: fixes https://github.com/secdev/scapy/issues/1981", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1984/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1984/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1981", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1981/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1981/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1981/events", "html_url": "https://github.com/secdev/scapy/issues/1981", "id": 430558807, "node_id": "MDU6SXNzdWU0MzA1NTg4MDc=", "number": 1981, "title": "Messed up SSID display/parse", "user": {"login": "bannsec", "id": 7632864, "node_id": "MDQ6VXNlcjc2MzI4NjQ=", "avatar_url": "https://avatars.githubusercontent.com/u/7632864?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bannsec", "html_url": "https://github.com/bannsec", "followers_url": "https://api.github.com/users/bannsec/followers", "following_url": "https://api.github.com/users/bannsec/following{/other_user}", "gists_url": "https://api.github.com/users/bannsec/gists{/gist_id}", "starred_url": "https://api.github.com/users/bannsec/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bannsec/subscriptions", "organizations_url": "https://api.github.com/users/bannsec/orgs", "repos_url": "https://api.github.com/users/bannsec/repos", "events_url": "https://api.github.com/users/bannsec/events{/privacy}", "received_events_url": "https://api.github.com/users/bannsec/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-04-08T17:01:41Z", "updated_at": "2019-04-15T06:59:31Z", "closed_at": "2019-04-15T06:59:31Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "#### Brief description\r\nSometimes it appears scapy mis-parses the SSID in 802.11 packets. It ends up parsing two fields it believes are SSID, the second of which has a bunch of extra garbage (or unparsed data).\r\n\r\n#### Environment\r\n- `scapy===git-archive.deve44bd373f`\r\n-   Python `3.6`\r\n-   Operating System: `Ubuntu Bionic`\r\n\r\n#### How to reproduce\r\nLoad up the attached pcap. `.show` and `repr` to see the weirdness.\r\n\r\n#### Actual result\r\nIn example:\r\n\r\n```\r\nIn [6]: pkt.summary()\r\nOut[6]: \"RadioTap / Dot11FCS / Dot11ProbeResp / Dot11Elt / Dot11EltRates / Dot11Elt / Dot11EltCountry / SSID='\\\\x8d[ \\\\x01\\\\x03*\\\\x01\\\\x00-\\\\x1a,\\\\x18\\\\x1b\\\\xff\\\\xff\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x000\\\\x18\\\\x01\\\\x00\\\\x00\\\\x0f\\\\xac\\\\x04\\\\x01\\\\x00\\\\x00\\\\x0f\\\\xac\\\\x04\\\\x02\\\\x00\\\\x00\\\\x0f\\\\xac\\\\x01\\\\x00\\\\x0f\\\\xac\\\\x03(\\\\x006\\\\x03*L\\\\x00=\\\\x16\\\\x06\\\\x00\\\\x05\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00F\\\\x05s\\\\xc0\\\\x00\\\\x00\\\\x00\\\\x7f\\\\x06\\\\x00\\\\x10\\\\x00\\\\x04\\\\x01@\\\\x85\\\\x1e\\\\x10\\\\x00\\\\x8f\\\\x00\\\\x0f\\\\x00\\\\xff\\\\x03Y\\\\x001617-AP33-SorcA\\\\x00\\\\n\\\\x00\\\\x00:' / Dot11Elt / Dot11EltVendorSpecific / Dot11EltVendorSpecific / Dot11EltVendorSpecific / Dot11EltVendorSpecific / Dot11EltVendorSpecific\"\r\n\r\n###[ 802.11 Information Element ]###\r\n                       ID        = SSID\r\n                       len       = 138\r\n                       info      = '\\x8d[ \\x01\\x03*\\x01\\x00-\\x1a,\\x18\\x1b\\xff\\xff\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x000\\x18\\x01\\x00\\x00\\x0f\\xac\\x04\\x01\\x00\\x00\\x0f\\xac\\x04\\x02\\x00\\x00\\x0f\\xac\\x01\\x00\\x0f\\xac\\x03(\\x006\\x03*L\\x00=\\x16\\x06\\x00\\x05\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00F\\x05s\\xc0\\x00\\x00\\x00\\x7f\\x06\\x00\\x10\\x00\\x04\\x01@\\x85\\x1e\\x10\\x00\\x8f\\x00\\x0f\\x00\\xff\\x03Y\\x001617-AP33-SorcA\\x00\\n\\x00\\x00:'\r\n```\r\n\r\nThe correct SSID was parsed higher up in the packet:\r\n\r\n```\r\n###[ 802.11 Information Element ]###\r\n           ID        = SSID\r\n           len       = 9\r\n           info      = 'WLAN-TWDC'\r\n```\r\n\r\n#### Expected result\r\nExpecting to see `WLAN-TWDC` as the SSID.\r\n\r\n#### Related resources\r\n[dot11_example.zip](https://github.com/secdev/scapy/files/3055459/dot11_example.zip)\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1981/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1981/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1973", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1973/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1973/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1973/events", "html_url": "https://github.com/secdev/scapy/issues/1973", "id": 428911287, "node_id": "MDU6SXNzdWU0Mjg5MTEyODc=", "number": 1973, "title": "Radius - Incorrect fragmented EAP messages handling", "user": {"login": "Matheus-Garbelini", "id": 6465668, "node_id": "MDQ6VXNlcjY0NjU2Njg=", "avatar_url": "https://avatars.githubusercontent.com/u/6465668?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Matheus-Garbelini", "html_url": "https://github.com/Matheus-Garbelini", "followers_url": "https://api.github.com/users/Matheus-Garbelini/followers", "following_url": "https://api.github.com/users/Matheus-Garbelini/following{/other_user}", "gists_url": "https://api.github.com/users/Matheus-Garbelini/gists{/gist_id}", "starred_url": "https://api.github.com/users/Matheus-Garbelini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Matheus-Garbelini/subscriptions", "organizations_url": "https://api.github.com/users/Matheus-Garbelini/orgs", "repos_url": "https://api.github.com/users/Matheus-Garbelini/repos", "events_url": "https://api.github.com/users/Matheus-Garbelini/events{/privacy}", "received_events_url": "https://api.github.com/users/Matheus-Garbelini/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-04-03T18:26:41Z", "updated_at": "2019-06-18T05:35:38Z", "closed_at": "2019-06-18T05:35:38Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nWhen parsing a Radius packet with fragmented EAP attributes, scapy only shows the first eap attribute in a raw format with wrong length. A simple fix is proposed without disrupting not fragmented EAP messages.\r\n\r\n#### Environment\r\n\r\n-   Scapy version: 2.4.2\r\n-   Python version: 2.7.15+\r\n-   Operating System: Ubuntu 16.04\r\n\r\n#### How to reproduce\r\n\r\n```Python\r\nfrom scapy.layers.radius import Radius\r\n\r\na = '0b02042c65cbacdc0f78c14bc3da5ac09771bc9d4fff010303ec19c00000047a160303003d020000390303d79488b596cd7fa92f514381eeae60e0856dc9b7280e2331444f574e4752440100c02f000011ff01000100000b0004030001020017000016030302d80b0002d40002d10002ce308202ca308201b2a00302010202140633e4442644536db1404ddab002f28556f893c7300d06092a864886f70d01010b0500300f310d300b06035504030c046b616c69301e170d3139303330363034353230375a170d3239303330333034353230375a300f310d300b06035504030c046b616c6930820122300d06092a864886f70d01010105000382010f003082010a0282010100c0bcdc26b71d378901e72353f14fff35bc0e71e8d11c73c8cd2126e2e63759e3bcdc95eb171ec943595580b7ff352e6b5793e5ef77606bd34d9052ed3987db4f2ae1906522ef89548137d12a1ce7e6dee6927a2b97ea3082ed656071ba4dadc0cb033471db8f7c43fbd81df49631bc2ff61739ec6c584ffdb33f864e7f0accd4b4a1cd92baf7638deb060e18fbf7a9719171447698a5b86a5c0c25b8ac1733bfdd61e2efa8cf85a7ce15784611ca1e4fbf1707fa4371761208b46bf148e791be0e049879772d9578ebb759c31e48560e64c5bf406adf4d938c8dce3f52245d6db7628fcd6c7df5900a0172ad737fe70cc08193170d6c0d5dfafe96fc8b04962c46610203010001a31e301c304fff090603551d1304023000300f0603551d110408300682046b616c69300d06092a864886f70d01010b05000382010100b35c5dcd1a4328bfdac5be175ee0ae0a39ccc6a18e81f49aa9a40336d10b17ab95430619a2f86a60aafabb43eaddfee07c52a4e48970d8bb24b7c813a456914c25c86cba8aee0fdbe5b17ca93c377e1f74cc5f242b5eab2fb4d7d37a26f04f0775f30d99cbbf2e5b08d9275e5dc070d563dcf13152e348097417349e00c8dc9d17efae77ae70ba5f4b61aefc271078efb6a6583002a954fa55158ea0f6442e5572e04d496fed8e94fe7816b8f3a0c98282e01eb5b6e1cb0c2c480ce7f4c56a05811b93ab4d0cd6e2178397e449084ff7423c3ce02f6daa1924541fc8369174fca0b3bf808274f093016e0fd94d2610a8bbe55271d74efd523018dd390b726e482ad1160303014d0c0001490300174104553ebc08fa7ffb5301245cb56f2d0e1a7ec9352e9365d4573192d0201ef643c58a692cfac4947a60dd26af40760828584164ea329fbdc44cae898419519e1d700804010085916c0034e785be0ef6cb37a3a5e45ea18ebd3be5ac71a931b70cf0c6d443e58ec7932aeda1b3d2a0b30ab528579382271bf4e91ef395133a3252f3a67a622bfa8208a9940e1e2a13583fb303ddb527d10f6b8cfe54d8b53206fcd056a0131e02d486ed4927ab7e4daa7312ca04b2fad650125b805fe5762de4efd023999bf3a3434f1812b6df2fbbb7dc36a447c52f890ee0ae63'.decode(\r\n    'hex')\r\npkt = Radius(a)\r\npkt.show()\r\n```\r\n\r\n#### Actual result\r\n\r\n```\r\n###[ RADIUS ]### \r\n  code      = Access-Challenge\r\n  id        = 2\r\n  len       = 1068\r\n  authenticator= 65cbacdc0f78c14bc3da5ac09771bc9d\r\n  \\attributes\\\r\n   |###[ EAP-Message ]### \r\n   |  type      = EAP-Message\r\n   |  len       = 255\r\n   |  \\value     \\\r\n   |   |###[ Raw ]### \r\n   |   |  load      = '\\x01\\x03\\x03\\xec\\x19\\xc0\\x00\\x00\\x04z\\x16\\x03\\x03\\x00=\\x02\\x00\\x009\\x03\\x03\\xd7\\x94\\x88\\xb5\\x96\\xcd\\x7f\\xa9/QC\\x81\\xee\\xae`\\xe0\\x85m\\xc9\\xb7(\\x0e#1DOWNGRD\\x01\\x00\\xc0/\\x00\\x00\\x11\\xff\\x01\\x00\\x01\\x00\\x00\\x0b\\x00\\x04\\x03\\x00\\x01\\x02\\x00\\x17\\x00\\x00\\x16\\x03\\x03\\x02\\xd8\\x0b\\x00\\x02\\xd4\\x00\\x02\\xd1\\x00\\x02\\xce0\\x82\\x02\\xca0\\x82\\x01\\xb2\\xa0\\x03\\x02\\x01\\x02\\x02\\x14\\x063\\xe4D&DSm\\xb1@M\\xda\\xb0\\x02\\xf2\\x85V\\xf8\\x93\\xc70\\r\\x06\\t*\\x86H\\x86\\xf7\\r\\x01\\x01\\x0b\\x05\\x000\\x0f1\\r0\\x0b\\x06\\x03U\\x04\\x03\\x0c\\x04kali0\\x1e\\x17\\r190306045207Z\\x17\\r290303045207Z0\\x0f1\\r0\\x0b\\x06\\x03U\\x04\\x03\\x0c\\x04kali0\\x82\\x01\"0\\r\\x06\\t*\\x86H\\x86\\xf7\\r\\x01\\x01\\x01\\x05\\x00\\x03\\x82\\x01\\x0f\\x000\\x82\\x01\\n\\x02\\x82\\x01\\x01\\x00\\xc0\\xbc\\xdc&\\xb7\\x1d7\\x89\\x01\\xe7#S\\xf1O\\xff5\\xbc\\x0eq\\xe8\\xd1\\x1cs\\xc8\\xcd!&\\xe2\\xe67Y\\xe3\\xbc\\xdc\\x95\\xeb\\x17\\x1e\\xc9CYU\\x80\\xb7\\xff5.kW\\x93\\xe5\\xefw`k\\xd3M\\x90R\\xed9\\x87\\xdbO*\\xe1\\x90e\"\\xef\\x89T\\x817\\xd1*\\x1c\\xe7\\xe6\\xde\\xe6\\x92z+\\x97\\xea0\\x82\\xede`q\\xbaM\\xad\\xc0\\xcb\\x034q\\xdb\\x8f|C\\xfb\\xd8\\x1d\\xf4\\x961\\xbc/\\xf6\\x179\\xeclXO\\xfd\\xb3?\\x86N\\x7f\\n\\xcc\\xd4\\xb4\\xa1\\xcd\\x92\\xba\\xf7c\\x8d\\xeb\\x06\\x0e\\x18\\xfb\\xf7\\xa9q\\x91qDv\\x98\\xa5\\xb8j\\\\\\x0c%\\xb8\\xac\\x173\\xbf\\xdda\\xe2\\xef\\xa8\\xcf\\x85\\xa7\\xce\\x15xF\\x11\\xca\\x1eO\\xbf\\x17\\x07\\xfaCqv\\x12\\x08\\xb4k\\xf1H\\xe7\\x91\\xbe\\x0e\\x04\\x98yw-\\x95x\\xeb\\xb7Y\\xc3\\x1eHV\\x0ed\\xc5\\xbf@j\\xdfM\\x93\\x8c\\x8d\\xce?R$]m\\xb7b\\x8f\\xcdl}\\xf5\\x90\\n\\x01r\\xads\\x7f\\xe7\\x0c\\xc0\\x81\\x93\\x17\\rl\\r]\\xfa\\xfe\\x96\\xfc\\x8b\\x04\\x96,Fa\\x02\\x03\\x01\\x00\\x01\\xa3\\x1e0\\x1c0O\\xff\\t\\x06\\x03U\\x1d\\x13\\x04\\x020\\x000\\x0f\\x06\\x03U\\x1d\\x11\\x04\\x080\\x06\\x82\\x04kali0\\r\\x06\\t*\\x86H\\x86\\xf7\\r\\x01\\x01\\x0b\\x05\\x00\\x03\\x82\\x01\\x01\\x00\\xb3\\\\]\\xcd\\x1aC(\\xbf\\xda\\xc5\\xbe\\x17^\\xe0\\xae\\n9\\xcc\\xc6\\xa1\\x8e\\x81\\xf4\\x9a\\xa9\\xa4\\x036\\xd1\\x0b\\x17\\xab\\x95C\\x06\\x19\\xa2\\xf8j`\\xaa\\xfa\\xbbC\\xea\\xdd\\xfe\\xe0|R\\xa4\\xe4\\x89p\\xd8\\xbb$\\xb7\\xc8\\x13\\xa4V\\x91L%\\xc8l\\xba\\x8a\\xee\\x0f\\xdb\\xe5\\xb1|\\xa9<7~\\x1ft\\xcc_$+^\\xab/\\xb4\\xd7\\xd3z&\\xf0O\\x07u\\xf3\\r\\x99\\xcb\\xbf.[\\x08\\xd9\\'^]\\xc0p\\xd5c\\xdc\\xf11R\\xe3H\\tt\\x174\\x9e\\x00\\xc8\\xdc\\x9d\\x17\\xef\\xaew\\xaep\\xba_Ka\\xae\\xfc\\'\\x10x\\xef\\xb6\\xa6X0\\x02\\xa9T\\xfaU\\x15\\x8e\\xa0\\xf6D.Ur\\xe0MIo\\xed\\x8e\\x94\\xfex\\x16\\xb8\\xf3\\xa0\\xc9\\x82\\x82\\xe0\\x1e\\xb5\\xb6\\xe1\\xcb\\x0c,H\\x0c\\xe7\\xf4\\xc5j\\x05\\x81\\x1b\\x93\\xabM\\x0c\\xd6\\xe2\\x17\\x83\\x97\\xe4I\\x08O\\xf7B<<\\xe0/m\\xaa\\x19$T\\x1f\\xc86\\x91t\\xfc\\xa0\\xb3\\xbf\\x80\\x82t\\xf0\\x93\\x01n\\x0f\\xd9M&\\x10\\xa8\\xbb\\xe5Rq\\xd7N\\xfdR0\\x18\\xdd9\\x0brnH*\\xd1\\x16\\x03\\x03\\x01M\\x0c\\x00\\x01I\\x03\\x00\\x17A\\x04U>\\xbc\\x08\\xfa\\x7f\\xfbS\\x01$\\\\\\xb5o-\\x0e\\x1a~\\xc95.\\x93e\\xd4W1\\x92\\xd0 \\x1e\\xf6C\\xc5\\x8ai,\\xfa\\xc4\\x94z`\\xdd&\\xaf@v\\x08(XAd\\xea2\\x9f\\xbd\\xc4L\\xae\\x89\\x84\\x19Q\\x9e\\x1dp\\x08\\x04\\x01\\x00\\x85\\x91l\\x004\\xe7\\x85\\xbe\\x0e\\xf6\\xcb7\\xa3\\xa5\\xe4^\\xa1\\x8e\\xbd;\\xe5\\xacq\\xa91\\xb7\\x0c\\xf0\\xc6\\xd4C\\xe5\\x8e\\xc7\\x93*\\xed\\xa1\\xb3\\xd2\\xa0\\xb3\\n\\xb5(W\\x93\\x82\\'\\x1b\\xf4\\xe9\\x1e\\xf3\\x95\\x13:2R\\xf3\\xa6zb+\\xfa\\x82\\x08\\xa9\\x94\\x0e\\x1e*\\x13X?\\xb3\\x03\\xdd\\xb5\\'\\xd1\\x0fk\\x8c\\xfeT\\xd8\\xb52\\x06\\xfc\\xd0V\\xa0\\x13\\x1e\\x02\\xd4\\x86\\xedI\\'\\xab~M\\xaas\\x12\\xca\\x04\\xb2\\xfa\\xd6P\\x12[\\x80_\\xe5v-\\xe4\\xef\\xd0#\\x99\\x9b\\xf3\\xa3CO\\x18\\x12\\xb6\\xdf/\\xbb\\xb7\\xdc6\\xa4G\\xc5/\\x89\\x0e\\xe0\\xaec'\r\n\r\n\r\n```\r\n\r\n#### Expected result\r\n\r\n```\r\n###[ RADIUS ]### \r\n  code      = Access-Challenge\r\n  id        = 2\r\n  len       = 1068\r\n  authenticator= 65cbacdc0f78c14bc3da5ac09771bc9d\r\n  \\attributes\\\r\n   |###[ EAP-Message ]### \r\n   |  type      = EAP-Message\r\n   |  len       = 255\r\n   |  \\value     \\\r\n   |   |###[ Raw ]### \r\n   |   |  load      = '\\x01\\x03\\x03\\xec\\x19\\xc0\\x00\\x00\\x04z\\x16\\x03\\x03\\x00=\\x02\\x00\\x009\\x03\\x03\\xd7\\x94\\x88\\xb5\\x96\\xcd\\x7f\\xa9/QC\\x81\\xee\\xae`\\xe0\\x85m\\xc9\\xb7(\\x0e#1DOWNGRD\\x01\\x00\\xc0/\\x00\\x00\\x11\\xff\\x01\\x00\\x01\\x00\\x00\\x0b\\x00\\x04\\x03\\x00\\x01\\x02\\x00\\x17\\x00\\x00\\x16\\x03\\x03\\x02\\xd8\\x0b\\x00\\x02\\xd4\\x00\\x02\\xd1\\x00\\x02\\xce0\\x82\\x02\\xca0\\x82\\x01\\xb2\\xa0\\x03\\x02\\x01\\x02\\x02\\x14\\x063\\xe4D&DSm\\xb1@M\\xda\\xb0\\x02\\xf2\\x85V\\xf8\\x93\\xc70\\r\\x06\\t*\\x86H\\x86\\xf7\\r\\x01\\x01\\x0b\\x05\\x000\\x0f1\\r0\\x0b\\x06\\x03U\\x04\\x03\\x0c\\x04kali0\\x1e\\x17\\r190306045207Z\\x17\\r290303045207Z0\\x0f1\\r0\\x0b\\x06\\x03U\\x04\\x03\\x0c\\x04kali0\\x82\\x01\"0\\r\\x06\\t*\\x86H\\x86\\xf7\\r\\x01\\x01\\x01\\x05\\x00\\x03\\x82\\x01\\x0f\\x000\\x82\\x01\\n\\x02\\x82\\x01\\x01\\x00\\xc0\\xbc\\xdc&\\xb7\\x1d7\\x89\\x01\\xe7#S\\xf1'\r\n   |###[ EAP-Message ]### \r\n   |  type      = EAP-Message\r\n   |  len       = 255\r\n   |  \\value     \\\r\n   |   |###[ Raw ]### \r\n   |   |  load      = '5\\xbc\\x0eq\\xe8\\xd1\\x1cs\\xc8\\xcd!&\\xe2\\xe67Y\\xe3\\xbc\\xdc\\x95\\xeb\\x17\\x1e\\xc9CYU\\x80\\xb7\\xff5.kW\\x93\\xe5\\xefw`k\\xd3M\\x90R\\xed9\\x87\\xdbO*\\xe1\\x90e\"\\xef\\x89T\\x817\\xd1*\\x1c\\xe7\\xe6\\xde\\xe6\\x92z+\\x97\\xea0\\x82\\xede`q\\xbaM\\xad\\xc0\\xcb\\x034q\\xdb\\x8f|C\\xfb\\xd8\\x1d\\xf4\\x961\\xbc/\\xf6\\x179\\xeclXO\\xfd\\xb3?\\x86N\\x7f\\n\\xcc\\xd4\\xb4\\xa1\\xcd\\x92\\xba\\xf7c\\x8d\\xeb\\x06\\x0e\\x18\\xfb\\xf7\\xa9q\\x91qDv\\x98\\xa5\\xb8j\\\\\\x0c%\\xb8\\xac\\x173\\xbf\\xdda\\xe2\\xef\\xa8\\xcf\\x85\\xa7\\xce\\x15xF\\x11\\xca\\x1eO\\xbf\\x17\\x07\\xfaCqv\\x12\\x08\\xb4k\\xf1H\\xe7\\x91\\xbe\\x0e\\x04\\x98yw-\\x95x\\xeb\\xb7Y\\xc3\\x1eHV\\x0ed\\xc5\\xbf@j\\xdfM\\x93\\x8c\\x8d\\xce?R$]m\\xb7b\\x8f\\xcdl}\\xf5\\x90\\n\\x01r\\xads\\x7f\\xe7\\x0c\\xc0\\x81\\x93\\x17\\rl\\r]\\xfa\\xfe\\x96\\xfc\\x8b\\x04\\x96,Fa\\x02\\x03\\x01\\x00\\x01\\xa3\\x1e0\\x1c0'\r\n   |###[ EAP-Message ]### \r\n   |  type      = EAP-Message\r\n   |  len       = 255\r\n   |  \\value     \\\r\n   |   |###[ Raw ]### \r\n   |   |  load      = \"\\t\\x06\\x03U\\x1d\\x13\\x04\\x020\\x000\\x0f\\x06\\x03U\\x1d\\x11\\x04\\x080\\x06\\x82\\x04kali0\\r\\x06\\t*\\x86H\\x86\\xf7\\r\\x01\\x01\\x0b\\x05\\x00\\x03\\x82\\x01\\x01\\x00\\xb3\\\\]\\xcd\\x1aC(\\xbf\\xda\\xc5\\xbe\\x17^\\xe0\\xae\\n9\\xcc\\xc6\\xa1\\x8e\\x81\\xf4\\x9a\\xa9\\xa4\\x036\\xd1\\x0b\\x17\\xab\\x95C\\x06\\x19\\xa2\\xf8j`\\xaa\\xfa\\xbbC\\xea\\xdd\\xfe\\xe0|R\\xa4\\xe4\\x89p\\xd8\\xbb$\\xb7\\xc8\\x13\\xa4V\\x91L%\\xc8l\\xba\\x8a\\xee\\x0f\\xdb\\xe5\\xb1|\\xa9<7~\\x1ft\\xcc_$+^\\xab/\\xb4\\xd7\\xd3z&\\xf0O\\x07u\\xf3\\r\\x99\\xcb\\xbf.[\\x08\\xd9'^]\\xc0p\\xd5c\\xdc\\xf11R\\xe3H\\tt\\x174\\x9e\\x00\\xc8\\xdc\\x9d\\x17\\xef\\xaew\\xaep\\xba_Ka\\xae\\xfc'\\x10x\\xef\\xb6\\xa6X0\\x02\\xa9T\\xfaU\\x15\\x8e\\xa0\\xf6D.Ur\\xe0MIo\\xed\\x8e\\x94\\xfex\\x16\\xb8\\xf3\\xa0\\xc9\\x82\\x82\\xe0\\x1e\\xb5\\xb6\\xe1\\xcb\\x0c,H\\x0c\\xe7\\xf4\\xc5j\\x05\\x81\\x1b\\x93\\xabM\\x0c\\xd6\\xe2\\x17\\x83\\x97\\xe4I\\x08\"\r\n   |###[ EAP-Message ]### \r\n   |  type      = EAP-Message\r\n   |  len       = 247\r\n   |  \\value     \\\r\n   |   |###[ Raw ]### \r\n   |   |  load      = \"B<<\\xe0/m\\xaa\\x19$T\\x1f\\xc86\\x91t\\xfc\\xa0\\xb3\\xbf\\x80\\x82t\\xf0\\x93\\x01n\\x0f\\xd9M&\\x10\\xa8\\xbb\\xe5Rq\\xd7N\\xfdR0\\x18\\xdd9\\x0brnH*\\xd1\\x16\\x03\\x03\\x01M\\x0c\\x00\\x01I\\x03\\x00\\x17A\\x04U>\\xbc\\x08\\xfa\\x7f\\xfbS\\x01$\\\\\\xb5o-\\x0e\\x1a~\\xc95.\\x93e\\xd4W1\\x92\\xd0 \\x1e\\xf6C\\xc5\\x8ai,\\xfa\\xc4\\x94z`\\xdd&\\xaf@v\\x08(XAd\\xea2\\x9f\\xbd\\xc4L\\xae\\x89\\x84\\x19Q\\x9e\\x1dp\\x08\\x04\\x01\\x00\\x85\\x91l\\x004\\xe7\\x85\\xbe\\x0e\\xf6\\xcb7\\xa3\\xa5\\xe4^\\xa1\\x8e\\xbd;\\xe5\\xacq\\xa91\\xb7\\x0c\\xf0\\xc6\\xd4C\\xe5\\x8e\\xc7\\x93*\\xed\\xa1\\xb3\\xd2\\xa0\\xb3\\n\\xb5(W\\x93\\x82'\\x1b\\xf4\\xe9\\x1e\\xf3\\x95\\x13:2R\\xf3\\xa6zb+\\xfa\\x82\\x08\\xa9\\x94\\x0e\\x1e*\\x13X?\\xb3\\x03\\xdd\\xb5'\\xd1\\x0fk\\x8c\\xfeT\\xd8\\xb52\\x06\\xfc\\xd0V\\xa0\\x13\\x1e\\x02\\xd4\\x86\\xedI'\\xab~M\\xaas\\x12\\xca\\x04\\xb2\\xfa\\xd6\"\r\n   |###[ Message-Authenticator ]### \r\n   |  type      = Message-Authenticator\r\n   |  len       = 18\r\n   |  value     = 5b805fe5762de4efd023999bf3a3434f\r\n   |###[ State ]### \r\n   |  type      = State\r\n   |  len       = 18\r\n   |  value     = b6df2fbbb7dc36a447c52f890ee0ae63\r\n```\r\n\r\n#### Possible Fix\r\n\r\n```Diff\r\n--- layers/radius.py\t2019-04-03 18:02:16.913650460 +0800\r\n+++ radius.py\t2019-04-04 03:43:05.108983174 +0800\r\n@@ -14,7 +14,7 @@\r\n from scapy.compat import orb, raw\r\n from scapy.packet import Packet, Padding, bind_layers\r\n from scapy.fields import ByteField, ByteEnumField, IntField, StrLenField,\\\r\n-    XStrLenField, XStrFixedLenField, FieldLenField, PacketField,\\\r\n+    XStrLenField, XStrFixedLenField, FieldLenField, PacketField, PacketLenField,\\\r\n     PacketListField, IPField, MultiEnumField\r\n from scapy.layers.inet import UDP\r\n from scapy.layers.eap import EAP\r\n@@ -992,7 +992,7 @@\r\n     val = 61\r\n \r\n \r\n-class _EAPPacketField(PacketField):\r\n+class _EAPPacketField(PacketLenField):\r\n \r\n     \"\"\"\r\n     Handles EAP-Message attribute value (the actual EAP packet).\r\n@@ -1025,7 +1025,7 @@\r\n             \"B\",\r\n             adjust=lambda pkt, x: len(pkt.value) + 2\r\n         ),\r\n-        _EAPPacketField(\"value\", \"\", EAP)\r\n+        _EAPPacketField(\"value\", \"\", EAP, length_from=lambda p: p.len - 2)\r\n     ]\r\n\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1973/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1973/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1967", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1967/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1967/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1967/events", "html_url": "https://github.com/secdev/scapy/issues/1967", "id": 428233763, "node_id": "MDU6SXNzdWU0MjgyMzM3NjM=", "number": 1967, "title": "DNS RR encodes 8-bit rname incorrectly", "user": {"login": "arnout", "id": 282697, "node_id": "MDQ6VXNlcjI4MjY5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/282697?v=4", "gravatar_id": "", "url": "https://api.github.com/users/arnout", "html_url": "https://github.com/arnout", "followers_url": "https://api.github.com/users/arnout/followers", "following_url": "https://api.github.com/users/arnout/following{/other_user}", "gists_url": "https://api.github.com/users/arnout/gists{/gist_id}", "starred_url": "https://api.github.com/users/arnout/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/arnout/subscriptions", "organizations_url": "https://api.github.com/users/arnout/orgs", "repos_url": "https://api.github.com/users/arnout/repos", "events_url": "https://api.github.com/users/arnout/events{/privacy}", "received_events_url": "https://api.github.com/users/arnout/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 15, "created_at": "2019-04-02T13:40:10Z", "updated_at": "2019-07-03T13:58:54Z", "closed_at": "2019-07-03T13:58:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nDNS should support 8-bit characters in names. However, DNSRR does not convert a correctly UTF-8 encoded rname correctly into a DNS path.\r\n\r\n#### Environment\r\n\r\n-   Scapy version: `5c9a7789`\r\n\r\n#### How to reproduce\r\n\r\nCreate a DNSRR with an 8-bit character in the rrname (e.g. a valid non-ASCII UTF-8 character).\r\n\r\n`bytes(DNSRR(rrname='a\\u0080b.'))`\r\n\r\n#### Actual result\r\n\r\n```\r\nb'a\\xc2\\x80b.\\x00\\x01\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00'\r\n  ^ Not correctly path/length encoded\r\n```\r\n\r\n#### Expected result\r\n\r\n```\r\nb'\\x04a\\xc2\\x80b\\x00\\x00\\x01\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00'\r\n       ^^^^^^^^ UTF-8 encoding of U+0080\r\n  ^^^^ 4 bytes in path component\r\n```\r\n\r\n#### Proposed fix\r\n\r\nI believe the following patch solves the issue.\r\n\r\n```\r\ndiff --git a/scapy/layers/dns.py b/scapy/layers/dns.py\r\nindex 48453867..31b897b4 100755\r\n--- a/scapy/layers/dns.py\r\n+++ b/scapy/layers/dns.py\r\n@@ -194,7 +194,7 @@ class DNSStrField(StrField):\r\n         return x\r\n \r\n     def i2m(self, pkt, x):\r\n-        if any((orb(y) >= 0xc0) for y in x):\r\n+        if b'.' not in x and x[-1] == b\"\\x00\":\r\n             # The value has already been processed. Do not process it again\r\n             return x\r\n```\r\n\r\nThe check was introduced by fdae9df \"DNS improvements & compression\". Compression is indeed indicated by a length byte with a value >= 0xc0. However, such characters may actually occur in the name so it's not a good check. Since the conversion removes all dots (path splitting), it is a much more reliable marker.\r\n\r\nHowever, I think the check might even be removed entirely. AFAIU, the result of i2m is not saved.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1967/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1967/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1956", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1956/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1956/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1956/events", "html_url": "https://github.com/secdev/scapy/pull/1956", "id": 427214137, "node_id": "MDExOlB1bGxSZXF1ZXN0MjY1ODkzOTc0", "number": 1956, "title": "Fix Wireshark choco install", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 514033136, "node_id": "MDU6TGFiZWw1MTQwMzMxMzY=", "url": "https://api.github.com/repos/secdev/scapy/labels/tests", "name": "tests", "color": "0e8a16", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-03-29T23:36:19Z", "updated_at": "2019-03-30T11:26:42Z", "closed_at": "2019-03-30T11:26:22Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1956", "html_url": "https://github.com/secdev/scapy/pull/1956", "diff_url": "https://github.com/secdev/scapy/pull/1956.diff", "patch_url": "https://github.com/secdev/scapy/pull/1956.patch", "merged_at": "2019-03-30T11:26:22Z"}, "body": "- This PR followed tips provided by Chocolatey\r\n\r\nSee https://github.com/mkevenaar/chocolatey-packages/issues/16", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1956/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1956/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1955", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1955/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1955/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1955/events", "html_url": "https://github.com/secdev/scapy/issues/1955", "id": 426992890, "node_id": "MDU6SXNzdWU0MjY5OTI4OTA=", "number": 1955, "title": " MultipleTypeField: wrong default applied", "user": {"login": "avekceeb", "id": 3075149, "node_id": "MDQ6VXNlcjMwNzUxNDk=", "avatar_url": "https://avatars.githubusercontent.com/u/3075149?v=4", "gravatar_id": "", "url": "https://api.github.com/users/avekceeb", "html_url": "https://github.com/avekceeb", "followers_url": "https://api.github.com/users/avekceeb/followers", "following_url": "https://api.github.com/users/avekceeb/following{/other_user}", "gists_url": "https://api.github.com/users/avekceeb/gists{/gist_id}", "starred_url": "https://api.github.com/users/avekceeb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/avekceeb/subscriptions", "organizations_url": "https://api.github.com/users/avekceeb/orgs", "repos_url": "https://api.github.com/users/avekceeb/repos", "events_url": "https://api.github.com/users/avekceeb/events{/privacy}", "received_events_url": "https://api.github.com/users/avekceeb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-03-29T13:43:32Z", "updated_at": "2019-04-26T12:48:45Z", "closed_at": "2019-04-26T12:48:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi guys,\r\n\r\n#### Brief description\r\nMultipleTypeField  doesn't  apply default values for its `flds`, but uses default of `dflt` instead.\r\nPer my understanding this is a bug.\r\n\r\n#### Environment\r\n-   Scapy version: 2.4.2\r\n-   Python version: `3.5`\r\n\r\n#### How to reproduce\r\n```python\r\nfrom scapy.all import *\r\n\r\nclass MyPack(Packet):\r\n    name = 'MY'\r\n    fields_desc = [\r\n        IntField('switch', 0),\r\n        MultipleTypeField([\r\n            (XShortField('myfield', 0xDEAD), lambda pkt: pkt.switch == 1),\r\n            (XIntField('myfield',  0xBEEFBEEF), lambda pkt: pkt.switch == 2)],\r\n            XByteField('myfield', 0x88)\r\n        )\r\n    ]\r\n\r\no = MyPack()\r\no.show()\r\n\r\no = MyPack(b'\\x00\\x00\\x00\\x02\\x77\\x77\\x77\\x77')\r\no.show()\r\n\r\no = MyPack(switch=2, myfield=0xBEEFBEEF)\r\no.show()\r\n\r\no = MyPack(switch=1)\r\no.show()\r\n```\r\n\r\n#### Actual result\r\n```\r\n###[ MY ]### \r\n  switch    = 0\r\n  myfield   = 0x88\r\n\r\n###[ MY ]### \r\n  switch    = 2\r\n  myfield   = 0x77777777\r\n\r\n###[ MY ]### \r\n  switch    = 2\r\n  myfield   = 0xbeefbeef\r\n\r\n###[ MY ]### \r\n  switch    = 1\r\n  myfield   = 0x88 <--- problem. should be 0xDEAD\r\n```\r\n#### Expected result\r\nFirst three ctors are OK, but the last one MyPack(switch=1) doesn't apply XShortField('myfield', 0xDEAD) using given `switch`\r\n\r\nEven worse things happen when using larger field for `dflt`:\r\n```python\r\nclass MyPack(Packet):\r\n    name = 'MY'\r\n    fields_desc = [\r\n        IntField('switch', 0),\r\n        MultipleTypeField([\r\n            (XByteField('myfield', 0x88), lambda pkt: pkt.switch == 1),\r\n            (XIntField('myfield',  0xBEEFBEEF), lambda pkt: pkt.switch == 2)],\r\n            XShortField('myfield', 0xDEAD)\r\n        )\r\n    ]\r\no = MyPack(switch=1)\r\no.show2()\r\n```\r\n```\r\n  File \"/usr/local/lib/python3.5/dist-packages/scapy/fields.py\", line 134, in addfield\r\n    return s + struct.pack(self.fmt, self.i2m(pkt, val))\r\nstruct.error: ubyte format requires 0 <= number <= 255\r\n```\r\n\r\nThanks in advance,\r\n--Dmitry", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1955/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1955/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1954", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1954/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1954/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1954/events", "html_url": "https://github.com/secdev/scapy/pull/1954", "id": 426942983, "node_id": "MDExOlB1bGxSZXF1ZXN0MjY1NjgwODQ4", "number": 1954, "title": "Fix duplicated names in RadioTap", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-03-29T11:31:01Z", "updated_at": "2020-07-19T09:19:11Z", "closed_at": "2019-04-01T07:23:43Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1954", "html_url": "https://github.com/secdev/scapy/pull/1954", "diff_url": "https://github.com/secdev/scapy/pull/1954.diff", "patch_url": "https://github.com/secdev/scapy/pull/1954.patch", "merged_at": "2019-04-01T07:23:43Z"}, "body": "- Fixes the order of the BitField fields in MCS option\r\n- fix duplicated `bandwitdth` field shared between MCS and VHT, by renaming them\r\n\r\nfixes https://github.com/secdev/scapy/issues/1933", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1954/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1954/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1950", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1950/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1950/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1950/events", "html_url": "https://github.com/secdev/scapy/pull/1950", "id": 426499043, "node_id": "MDExOlB1bGxSZXF1ZXN0MjY1MzM2OTI0", "number": 1950, "title": "Expect bytes in TCPOptions", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-03-28T13:42:18Z", "updated_at": "2019-03-30T11:55:22Z", "closed_at": "2019-03-30T11:55:22Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1950", "html_url": "https://github.com/secdev/scapy/pull/1950", "diff_url": "https://github.com/secdev/scapy/pull/1950.diff", "patch_url": "https://github.com/secdev/scapy/pull/1950.patch", "merged_at": "2019-03-30T11:55:22Z"}, "body": "Fix #1665.\r\n\r\nIt is a missing check in Python3.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1950/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1950/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1949", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1949/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1949/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1949/events", "html_url": "https://github.com/secdev/scapy/pull/1949", "id": 426488937, "node_id": "MDExOlB1bGxSZXF1ZXN0MjY1MzI4ODQx", "number": 1949, "title": "Add missing import of ASN.1 conf to x509 module", "user": {"login": "fsch2", "id": 24391243, "node_id": "MDQ6VXNlcjI0MzkxMjQz", "avatar_url": "https://avatars.githubusercontent.com/u/24391243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fsch2", "html_url": "https://github.com/fsch2", "followers_url": "https://api.github.com/users/fsch2/followers", "following_url": "https://api.github.com/users/fsch2/following{/other_user}", "gists_url": "https://api.github.com/users/fsch2/gists{/gist_id}", "starred_url": "https://api.github.com/users/fsch2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fsch2/subscriptions", "organizations_url": "https://api.github.com/users/fsch2/orgs", "repos_url": "https://api.github.com/users/fsch2/repos", "events_url": "https://api.github.com/users/fsch2/events{/privacy}", "received_events_url": "https://api.github.com/users/fsch2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-03-28T13:21:59Z", "updated_at": "2019-03-28T14:38:55Z", "closed_at": "2019-03-28T14:26:13Z", "author_association": "NONE", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1949", "html_url": "https://github.com/secdev/scapy/pull/1949", "diff_url": "https://github.com/secdev/scapy/pull/1949.diff", "patch_url": "https://github.com/secdev/scapy/pull/1949.patch", "merged_at": "2019-03-28T14:26:13Z"}, "body": "This fixes the issue #1948\r\n\r\nThis is just a checklist to guide you. You can remove it safely.\r\n\r\n**Checklist:**\r\n\r\n-   [x] If you are new to Scapy: I have checked <https://github.com/secdev/scapy/blob/master/CONTRIBUTING.md> (esp. section submitting-pull-requests)\r\n-   [x] I squashed commits belonging together\r\n-   [ ] I added unit tests or explained why they are not relevant\r\n-   [ ] I executed the regression tests for Python2 and Python3 (using `tox` or, `cd test && ./run_tests_py2, cd test && ./run_tests_py3`)\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1949/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1949/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1948", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1948/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1948/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1948/events", "html_url": "https://github.com/secdev/scapy/issues/1948", "id": 426448038, "node_id": "MDU6SXNzdWU0MjY0NDgwMzg=", "number": 1948, "title": "Missing import in layer/x509.py?", "user": {"login": "fsch2", "id": 24391243, "node_id": "MDQ6VXNlcjI0MzkxMjQz", "avatar_url": "https://avatars.githubusercontent.com/u/24391243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fsch2", "html_url": "https://github.com/fsch2", "followers_url": "https://api.github.com/users/fsch2/followers", "following_url": "https://api.github.com/users/fsch2/following{/other_user}", "gists_url": "https://api.github.com/users/fsch2/gists{/gist_id}", "starred_url": "https://api.github.com/users/fsch2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fsch2/subscriptions", "organizations_url": "https://api.github.com/users/fsch2/orgs", "repos_url": "https://api.github.com/users/fsch2/repos", "events_url": "https://api.github.com/users/fsch2/events{/privacy}", "received_events_url": "https://api.github.com/users/fsch2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2019-03-28T11:45:57Z", "updated_at": "2019-03-28T14:26:27Z", "closed_at": "2019-03-28T14:26:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nwhen I import things from the x509 module directly, this fails in scapy 2.4.1, 2.4.2 and in the latest master. Importing all from layers works, so I think there is an import missing in x509.py. This is related to the ASN.1 part, see below.\r\n \r\n```\r\nuser@host MINGW64 /c/workspace_local/scapy (master)\r\n$ ipython -c \"from scapy.layers.x509 import *; exit()\"\r\n---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-1-b0a95ade3859> in <module>\r\n----> 1 from scapy.layers.x509 import *; exit()\r\n\r\nC:\\workspace_local\\scapy\\scapy\\layers\\x509.py in <module>\r\n     29\r\n     30\r\n---> 31 class ASN1P_OID(ASN1_Packet):\r\n     32     ASN1_codec = ASN1_Codecs.BER\r\n     33     ASN1_root = ASN1F_OID(\"oid\", \"0\")\r\n\r\nC:\\workspace_local\\scapy\\scapy\\layers\\x509.py in ASN1P_OID()\r\n     31 class ASN1P_OID(ASN1_Packet):\r\n     32     ASN1_codec = ASN1_Codecs.BER\r\n---> 33     ASN1_root = ASN1F_OID(\"oid\", \"0\")\r\n     34\r\n     35\r\n\r\nC:\\workspace_local\\scapy\\scapy\\asn1fields.py in __init__(self, name, default, context, implicit_tag, explicit_tag, fle\r\nxible_tag)\r\n     53             self.default = default\r\n     54         else:\r\n---> 55             self.default = self.ASN1_tag.asn1_object(default)\r\n     56         self.flexible_tag = flexible_tag\r\n     57         if (implicit_tag is not None) and (explicit_tag is not None):\r\n\r\nC:\\workspace_local\\scapy\\scapy\\asn1\\asn1.py in asn1_object(self, val)\r\n    118     def asn1_object(self, val):\r\n    119         if hasattr(self, \"_asn1_obj\"):\r\n--> 120             return self._asn1_obj(val)\r\n    121         raise ASN1_Error(\"%r does not have any assigned ASN1 object\" % self)\r\n    122\r\n\r\nC:\\workspace_local\\scapy\\scapy\\asn1\\asn1.py in __init__(self, val)\r\n    397\r\n    398     def __init__(self, val):\r\n--> 399         val = conf.mib._oid(plain_str(val))\r\n    400         ASN1_Object.__init__(self, val)\r\n    401         self.oidname = conf.mib._oidname(val)\r\n\r\nAttributeError: 'Conf' object has no attribute 'mib'\r\n\r\nuser@host MINGW64 /c/workspace_local/scapy (master)\r\n$ ipython -c \"from scapy.layers.all import *; exit()\"\r\n```\r\n\r\nA temporary workaround is to `import scapy.asn1.mib` before importing things from the x509 module.\r\n\r\nHow could this be fixed in general?", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1948/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1948/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1934", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1934/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1934/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1934/events", "html_url": "https://github.com/secdev/scapy/pull/1934", "id": 425105216, "node_id": "MDExOlB1bGxSZXF1ZXN0MjY0Mjc5NzIx", "number": 1934, "title": "Check if tcpdump binary exists", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-03-25T20:40:12Z", "updated_at": "2019-05-30T18:51:42Z", "closed_at": "2019-05-30T18:51:42Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1934", "html_url": "https://github.com/secdev/scapy/pull/1934", "diff_url": "https://github.com/secdev/scapy/pull/1934.diff", "patch_url": "https://github.com/secdev/scapy/pull/1934.patch", "merged_at": "2019-05-30T18:51:42Z"}, "body": "This PR fixes issues discovered while investigating #1929.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1934/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1934/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1933", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1933/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1933/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1933/events", "html_url": "https://github.com/secdev/scapy/issues/1933", "id": 425039562, "node_id": "MDU6SXNzdWU0MjUwMzk1NjI=", "number": 1933, "title": "Wifi radiotap not well dissected (bandwidth and SGI)", "user": {"login": "JMbonnamy22", "id": 48909249, "node_id": "MDQ6VXNlcjQ4OTA5MjQ5", "avatar_url": "https://avatars.githubusercontent.com/u/48909249?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JMbonnamy22", "html_url": "https://github.com/JMbonnamy22", "followers_url": "https://api.github.com/users/JMbonnamy22/followers", "following_url": "https://api.github.com/users/JMbonnamy22/following{/other_user}", "gists_url": "https://api.github.com/users/JMbonnamy22/gists{/gist_id}", "starred_url": "https://api.github.com/users/JMbonnamy22/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JMbonnamy22/subscriptions", "organizations_url": "https://api.github.com/users/JMbonnamy22/orgs", "repos_url": "https://api.github.com/users/JMbonnamy22/repos", "events_url": "https://api.github.com/users/JMbonnamy22/events{/privacy}", "received_events_url": "https://api.github.com/users/JMbonnamy22/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-03-25T17:57:42Z", "updated_at": "2019-04-01T07:23:43Z", "closed_at": "2019-04-01T07:23:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "some wifi frames are not well dissected especially bandwidth and Short Guard Interval fields for HT frames.\r\nEnvirronnement \ud83d\udc4d\r\n-   Scapy version: '2.4.3rc1.dev17'\r\n-   Python version: `e.g. 3.7.2`\r\n-   Operating System: windows 10\r\n![scapy_wifi_dissection](https://user-images.githubusercontent.com/48909249/54942271-035d1580-4f2f-11e9-819a-3db369457356.png)\r\n\r\npkt.bandwidth is always None, should be 0, 1 or 4 (20, 40, 80 MHz)\r\npkt.guard_interval is always 0 (should be 1 for short guard interval)\r\nyou can test on the four frames given in the attached pcap file\r\n[scapy_error.zip](https://github.com/secdev/scapy/files/3004789/scapy_error.zip)\r\n\r\nbest regards\r\nJean-Michel\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1933/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1933/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1930", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1930/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1930/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1930/events", "html_url": "https://github.com/secdev/scapy/pull/1930", "id": 424642976, "node_id": "MDExOlB1bGxSZXF1ZXN0MjYzOTI1MTc3", "number": 1930, "title": "Fix SNMP infinite recursion & type detection", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-03-24T18:13:33Z", "updated_at": "2019-03-30T16:00:45Z", "closed_at": "2019-03-30T14:25:01Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1930", "html_url": "https://github.com/secdev/scapy/pull/1930", "diff_url": "https://github.com/secdev/scapy/pull/1930.diff", "patch_url": "https://github.com/secdev/scapy/pull/1930.patch", "merged_at": "2019-03-30T14:25:00Z"}, "body": "- fixes https://github.com/secdev/scapy/issues/1639\r\n- fixes https://github.com/secdev/scapy/issues/1901", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1930/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1930/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1929", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1929/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1929/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1929/events", "html_url": "https://github.com/secdev/scapy/issues/1929", "id": 424556020, "node_id": "MDU6SXNzdWU0MjQ1NTYwMjA=", "number": 1929, "title": "sniff(offline=...) call blocks when output is large", "user": {"login": "alirez", "id": 806984, "node_id": "MDQ6VXNlcjgwNjk4NA==", "avatar_url": "https://avatars.githubusercontent.com/u/806984?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alirez", "html_url": "https://github.com/alirez", "followers_url": "https://api.github.com/users/alirez/followers", "following_url": "https://api.github.com/users/alirez/following{/other_user}", "gists_url": "https://api.github.com/users/alirez/gists{/gist_id}", "starred_url": "https://api.github.com/users/alirez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alirez/subscriptions", "organizations_url": "https://api.github.com/users/alirez/orgs", "repos_url": "https://api.github.com/users/alirez/repos", "events_url": "https://api.github.com/users/alirez/events{/privacy}", "received_events_url": "https://api.github.com/users/alirez/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-03-23T23:28:07Z", "updated_at": "2019-06-28T10:03:26Z", "closed_at": "2019-06-28T10:03:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nWhen using `sniff()` with `offline` set to a packet list, and the expected output is fairly large, then the call blocks.\r\n\r\nThis seems to be related to how `scapy.utils.tcpdump()` writes the entire pcap to `tcpdump`'s `stdin` synchronously, and then reads the entire output from `stdout`.\r\n\r\n#### Environment\r\n\r\n-   Scapy version: `2.4.2`\r\n-   Python version: `3.7.2`\r\n-   Operating System: `Linux (Debian buster)`\r\n\r\n#### How to reproduce\r\n\r\nWhen the size of the returned packet is small, there is no problem:\r\n\r\n```\r\n>>> sniff(offline=IP()/UDP(sport=(10000, 20000), dport=30000), filter='port 10500')\r\nreading from file -, link-type IPV4 (Raw IPv4)\r\n<Sniffed: TCP:0 UDP:1 ICMP:0 Other:0>\r\n>>> \r\n```\r\n\r\nBut with the same input, when the output is expected to be fairly large the function call never returns:\r\n```\r\n>>> sniff(offline=IP()/UDP(sport=(10000, 20000), dport=30000), filter='udp')\r\nreading from file -, link-type IPV4 (Raw IPv4)\r\n```\r\n\r\n```\r\n$ ps xa | grep tcpdump\r\n24212 pts/2    S+     0:00 tcpdump -r - -w - udp\r\n```\r\n\r\n```\r\n(gdb) bt\r\n#0  0x00007f44e3701804 in __GI___libc_write (fd=1, buf=0x55962e536de0, nbytes=4096) at ../sysdeps/unix/sysv/linux/write.c:26\r\n#1  0x00007f44e369262d in _IO_new_file_write (f=0x7f44e37d3760 <_IO_2_1_stdout_>, data=0x55962e536de0, n=4096) at fileops.c:1183\r\n#2  0x00007f44e36919cf in new_do_write (fp=0x7f44e37d3760 <_IO_2_1_stdout_>, data=0x55962e536de0 \"\", to_do=to_do@entry=4096) at libioP.h:839\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1929/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1929/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1928", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1928/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1928/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1928/events", "html_url": "https://github.com/secdev/scapy/pull/1928", "id": 424501889, "node_id": "MDExOlB1bGxSZXF1ZXN0MjYzODMzNjE0", "number": 1928, "title": "Fix ttl setting in IGMP.igmpize()", "user": {"login": "grzegorzsn", "id": 22011977, "node_id": "MDQ6VXNlcjIyMDExOTc3", "avatar_url": "https://avatars.githubusercontent.com/u/22011977?v=4", "gravatar_id": "", "url": "https://api.github.com/users/grzegorzsn", "html_url": "https://github.com/grzegorzsn", "followers_url": "https://api.github.com/users/grzegorzsn/followers", "following_url": "https://api.github.com/users/grzegorzsn/following{/other_user}", "gists_url": "https://api.github.com/users/grzegorzsn/gists{/gist_id}", "starred_url": "https://api.github.com/users/grzegorzsn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/grzegorzsn/subscriptions", "organizations_url": "https://api.github.com/users/grzegorzsn/orgs", "repos_url": "https://api.github.com/users/grzegorzsn/repos", "events_url": "https://api.github.com/users/grzegorzsn/events{/privacy}", "received_events_url": "https://api.github.com/users/grzegorzsn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-03-23T13:41:00Z", "updated_at": "2019-03-23T14:01:33Z", "closed_at": "2019-03-23T14:01:25Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1928", "html_url": "https://github.com/secdev/scapy/pull/1928", "diff_url": "https://github.com/secdev/scapy/pull/1928.diff", "patch_url": "https://github.com/secdev/scapy/pull/1928.patch", "merged_at": "2019-03-23T14:01:25Z"}, "body": "Just fix for issue 1920 :) \r\n\r\nfixes #1920 ", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1928/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1928/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1920", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1920/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1920/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1920/events", "html_url": "https://github.com/secdev/scapy/issues/1920", "id": 423330212, "node_id": "MDU6SXNzdWU0MjMzMzAyMTI=", "number": 1920, "title": "TTL setting in IGMP.igmpize method", "user": {"login": "grzegorzsn", "id": 22011977, "node_id": "MDQ6VXNlcjIyMDExOTc3", "avatar_url": "https://avatars.githubusercontent.com/u/22011977?v=4", "gravatar_id": "", "url": "https://api.github.com/users/grzegorzsn", "html_url": "https://github.com/grzegorzsn", "followers_url": "https://api.github.com/users/grzegorzsn/followers", "following_url": "https://api.github.com/users/grzegorzsn/following{/other_user}", "gists_url": "https://api.github.com/users/grzegorzsn/gists{/gist_id}", "starred_url": "https://api.github.com/users/grzegorzsn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/grzegorzsn/subscriptions", "organizations_url": "https://api.github.com/users/grzegorzsn/orgs", "repos_url": "https://api.github.com/users/grzegorzsn/repos", "events_url": "https://api.github.com/users/grzegorzsn/events{/privacy}", "received_events_url": "https://api.github.com/users/grzegorzsn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-03-20T15:51:16Z", "updated_at": "2019-03-23T14:01:25Z", "closed_at": "2019-03-23T14:01:25Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nIGMP.igmpize method in Scapy 2.3.3 was setting IP.ttl value to 1. Currently ttl is not modified by this function. \r\n\r\nI consider this a bug as in docstring one can read: \r\n> 4. ttl = 1 (RFC 2236, section 2)\r\n\r\nThe new behaviour has been introduced in revision 8329256dcaefb0aa7e1c9ec95e15abdd7607362a\r\n\r\nIf you agree it is actually a bug, then I can provide fix :) \r\n\r\n#### Environment\r\n\r\n-   Scapy version: 2.4.2\r\n-   Python 2.7\r\n\r\n#### How to reproduce\r\n\r\n**Scapy 2.4.2**\r\n\r\n```\r\n>>> p = Ether() / IP(ttl=64) / IGMP()\r\n>>> p.ttl\r\n64\r\n>>> p[IGMP].igmpize()\r\nTrue\r\n>>> p.ttl\r\n64\r\n```\r\n\r\n**Scapy 2.3.3**\r\n\r\n```\r\n>>> p = Ether() / IP(ttl=64) / IGMP()\r\n>>> p.ttl\r\n64\r\n>>> p[IGMP].igmpize(p[IP], p[Ether])\r\nTrue\r\n>>> p.ttl\r\n1\r\n```\r\n\r\n\r\n#### Actual result\r\n\r\n```\r\n>>> p[IGMP].igmpize()\r\nTrue\r\n>>> p.ttl\r\n64\r\n```\r\n\r\n#### Expected result\r\n\r\n```\r\n>>> p[IGMP].igmpize()\r\nTrue\r\n>>> p.ttl\r\n1\r\n```\r\n\r\n#### Related resources\r\n\r\nFull docstring of igmpize:\r\n\r\n```\r\n        \"\"\"Called to explicitly fixup the packet according to the IGMP RFC\r\n\r\n        The rules are:\r\n        General:\r\n            1.  the Max Response time is meaningful only in Membership Queries and should be zero\r\n        IP:\r\n            1. Send General Group Query to 224.0.0.1 (all systems)\r\n            2. Send Leave Group to 224.0.0.2 (all routers)\r\n            3a.Otherwise send the packet to the group address\r\n            3b.Send reports/joins to the group address\r\n            4. ttl = 1 (RFC 2236, section 2)\r\n            5. send the packet with the router alert IP option (RFC 2236, section 2)\r\n        Ether:\r\n            1. Recalculate destination\r\n\r\n        Returns:\r\n            True    The tuple ether/ip/self passed all check and represents\r\n                    a proper IGMP packet.\r\n            False   One of more validation checks failed and no fields\r\n                    were adjusted.\r\n\r\n        The function will examine the IGMP message to assure proper format.\r\n        Corrections will be attempted if possible. The IP header is then properly\r\n        adjusted to ensure correct formatting and assignment. The Ethernet header\r\n        is then adjusted to the proper IGMP packet format.\r\n        \"\"\"\r\n```", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1920/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1920/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1918", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1918/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1918/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1918/events", "html_url": "https://github.com/secdev/scapy/issues/1918", "id": 422559018, "node_id": "MDU6SXNzdWU0MjI1NTkwMTg=", "number": 1918, "title": "stop_filter is causing memory leaks", "user": {"login": "AhmedWas", "id": 48707557, "node_id": "MDQ6VXNlcjQ4NzA3NTU3", "avatar_url": "https://avatars.githubusercontent.com/u/48707557?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AhmedWas", "html_url": "https://github.com/AhmedWas", "followers_url": "https://api.github.com/users/AhmedWas/followers", "following_url": "https://api.github.com/users/AhmedWas/following{/other_user}", "gists_url": "https://api.github.com/users/AhmedWas/gists{/gist_id}", "starred_url": "https://api.github.com/users/AhmedWas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AhmedWas/subscriptions", "organizations_url": "https://api.github.com/users/AhmedWas/orgs", "repos_url": "https://api.github.com/users/AhmedWas/repos", "events_url": "https://api.github.com/users/AhmedWas/events{/privacy}", "received_events_url": "https://api.github.com/users/AhmedWas/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-03-19T06:07:30Z", "updated_at": "2019-03-24T18:40:11Z", "closed_at": "2019-03-24T18:40:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "The issue is described clearly in this [stackoverflow question ](https://stackoverflow.com/questions/55234510/scapy-stop-filter-is-causing-huge-memory-leak) with simple repro steps.\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1918/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1918/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1907", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1907/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1907/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1907/events", "html_url": "https://github.com/secdev/scapy/pull/1907", "id": 421733045, "node_id": "MDExOlB1bGxSZXF1ZXN0MjYxNzIxNjg0", "number": 1907, "title": "Send IP packet on OpenBSD Loopback with correct address family.", "user": {"login": "bluhm", "id": 4907572, "node_id": "MDQ6VXNlcjQ5MDc1NzI=", "avatar_url": "https://avatars.githubusercontent.com/u/4907572?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bluhm", "html_url": "https://github.com/bluhm", "followers_url": "https://api.github.com/users/bluhm/followers", "following_url": "https://api.github.com/users/bluhm/following{/other_user}", "gists_url": "https://api.github.com/users/bluhm/gists{/gist_id}", "starred_url": "https://api.github.com/users/bluhm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bluhm/subscriptions", "organizations_url": "https://api.github.com/users/bluhm/orgs", "repos_url": "https://api.github.com/users/bluhm/repos", "events_url": "https://api.github.com/users/bluhm/events{/privacy}", "received_events_url": "https://api.github.com/users/bluhm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1265179855, "node_id": "MDU6TGFiZWwxMjY1MTc5ODU1", "url": "https://api.github.com/repos/secdev/scapy/labels/platform-specific", "name": "platform-specific", "color": "14acba", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-03-15T22:58:03Z", "updated_at": "2019-04-28T11:47:22Z", "closed_at": "2019-04-27T19:14:56Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1907", "html_url": "https://github.com/secdev/scapy/pull/1907", "diff_url": "https://github.com/secdev/scapy/pull/1907.diff", "patch_url": "https://github.com/secdev/scapy/pull/1907.patch", "merged_at": "2019-04-27T19:14:56Z"}, "body": "Sending packets via bpf requires the address family.  Instead of\r\nbinding the internet layer to loopback with multiple values, only\r\nuse the correct one for each inet and inet6.  This fixes send()\r\nIPv6 on OpenBSD.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1907/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1907/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1901", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1901/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1901/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1901/events", "html_url": "https://github.com/secdev/scapy/issues/1901", "id": 420311806, "node_id": "MDU6SXNzdWU0MjAzMTE4MDY=", "number": 1901, "title": "BER encoding error on Python 3", "user": {"login": "cq674350529", "id": 13868458, "node_id": "MDQ6VXNlcjEzODY4NDU4", "avatar_url": "https://avatars.githubusercontent.com/u/13868458?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cq674350529", "html_url": "https://github.com/cq674350529", "followers_url": "https://api.github.com/users/cq674350529/followers", "following_url": "https://api.github.com/users/cq674350529/following{/other_user}", "gists_url": "https://api.github.com/users/cq674350529/gists{/gist_id}", "starred_url": "https://api.github.com/users/cq674350529/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cq674350529/subscriptions", "organizations_url": "https://api.github.com/users/cq674350529/orgs", "repos_url": "https://api.github.com/users/cq674350529/repos", "events_url": "https://api.github.com/users/cq674350529/events{/privacy}", "received_events_url": "https://api.github.com/users/cq674350529/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-03-13T04:27:26Z", "updated_at": "2019-03-30T14:25:00Z", "closed_at": "2019-03-30T14:25:00Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "\r\n#### Brief description\r\n\r\nWhen making up `SNMP` packets using `scapy` and call `packet.build()`, an `ValueError` occurred.\r\n\r\n```python\r\n\r\nIn [1]: from scapy.all import *                                                                                           \r\n\r\nIn [2]: snmp_set_packet = SNMP(version=0, community='public', PDU=SNMPset(varbindlist=[SNMPvarbind(oid=ASN1_OID(\"1.3.6.1.2\r\n   ...: .1.1.4.0\"), value=RandBin())]))                                                                                   \r\n\r\nIn [3]: snmp_set_packet.build() \r\n\r\n# ... something omitted\r\n\r\n/usr/local/lib/python3.5/dist-packages/scapy/asn1/ber.py in enc(cls, s)\r\n    295     @classmethod\r\n    296     def enc(cls, s):\r\n    297         if isinstance(s, six.string_types):\r\n    298             return BERcodec_STRING.enc(s)\r\n    299         else:\r\n--> 300             return BERcodec_INTEGER.enc(int(s))\r\n    301 \r\n    302 \r\n\r\nValueError: invalid literal for int() with base 10: b'(U\\x1f\\xe1t\\xe7\\xc0\\xec\\x8f9\\x96<\\xce~\\r\\xe8\\x8eh\\xb5\\x1atq\\x10}Q\\x8a\\x9d\\x96\\\\\\xeeq\\xe7\\xfb*\\x8b\\x98\\xa1]\\x06\\xc1\\x93\\x9d\\x06\\x1d\\x87\\x83)\\x88\\xd8\\x9eOxj\\x19\\xdd\\xce\\xd5\\xa1\\x03my\\x81\\xe9\\xfa\\x07\\x\r\n\r\n```\r\nthe `string_types` in `six` module is as follows. In py3 env, the type of data is `bytes` instead of `str`. So maybe use `if isinstance(s, six.binary_type)` instead, or add another condition?\r\n```python\r\nif PY3:\r\n    string_types = str,\r\n    integer_types = int,\r\n    class_types = type,\r\n    text_type = str\r\n    binary_type = bytes\r\n\r\n    MAXSIZE = sys.maxsize\r\nelse:\r\n    string_types = basestring,\r\n    integer_types = (int, long)\r\n    class_types = (type, types.ClassType)\r\n    text_type = unicode\r\n    binary_type = str\r\n```\r\n\r\n\r\n#### Environment\r\n\r\n-   Scapy version: 2.4.2\r\n-   Python version: 3.5\r\n-   Operating System: Ubuntu 16.04\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1901/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1901/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1899", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1899/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1899/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1899/events", "html_url": "https://github.com/secdev/scapy/pull/1899", "id": 419997471, "node_id": "MDExOlB1bGxSZXF1ZXN0MjYwMzcxNzEz", "number": 1899, "title": "Do not check IP source addresses when conf.checkIPsrc is False", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-03-12T13:51:13Z", "updated_at": "2019-03-30T13:05:01Z", "closed_at": "2019-03-30T13:05:01Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1899", "html_url": "https://github.com/secdev/scapy/pull/1899", "diff_url": "https://github.com/secdev/scapy/pull/1899.diff", "patch_url": "https://github.com/secdev/scapy/pull/1899.patch", "merged_at": "2019-03-30T13:05:01Z"}, "body": "This PR fixes #1894.\r\n\r\nI rewrote the whole test as it was quite difficult to understand.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1899/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1899/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1897", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1897/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1897/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1897/events", "html_url": "https://github.com/secdev/scapy/issues/1897", "id": 419511946, "node_id": "MDU6SXNzdWU0MTk1MTE5NDY=", "number": 1897, "title": "Scapy 2.4.2 uses too much memory when sending packets", "user": {"login": "aligh993", "id": 48443743, "node_id": "MDQ6VXNlcjQ4NDQzNzQz", "avatar_url": "https://avatars.githubusercontent.com/u/48443743?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aligh993", "html_url": "https://github.com/aligh993", "followers_url": "https://api.github.com/users/aligh993/followers", "following_url": "https://api.github.com/users/aligh993/following{/other_user}", "gists_url": "https://api.github.com/users/aligh993/gists{/gist_id}", "starred_url": "https://api.github.com/users/aligh993/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aligh993/subscriptions", "organizations_url": "https://api.github.com/users/aligh993/orgs", "repos_url": "https://api.github.com/users/aligh993/repos", "events_url": "https://api.github.com/users/aligh993/events{/privacy}", "received_events_url": "https://api.github.com/users/aligh993/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2019-03-11T14:52:04Z", "updated_at": "2019-03-24T18:40:11Z", "closed_at": "2019-03-24T18:40:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nScapy 2.4.2 uses too much memory (or misuses memory!) when sending  packets. It can easily be verified when you are sending packets in sequence inside a loop. In my testing, sending 1000 packet in Scapy consumes about 1GB of memory.  The problem persists in Scapy 2.4.1 and 2.4.2, but Scapy 2.4.0 works fine.\r\n\r\n\r\n#### Environment\r\n\r\n-   Scapy version: 2.4.2\r\n-   Python version: 3.7.0\r\n-   Operating System: Windows 10\r\n\r\n\r\n#### How to reproduce\r\n\r\n>you can test it by:\r\n\r\n```\r\nfrom scapy.all import *\r\n\r\nfor i in range(1000):\r\n\tsr1(IP(dst=\"172.17.41.146\")/TCP(), timeout=0.01, verbose=0)\r\n```\r\n*(code edited by gpotter2, to reproduce the issue more accurately)*\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1897/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1897/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1895", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1895/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1895/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1895/events", "html_url": "https://github.com/secdev/scapy/issues/1895", "id": 419338303, "node_id": "MDU6SXNzdWU0MTkzMzgzMDM=", "number": 1895, "title": "Perhaps a small Bug for scapy 2.4.2 python3.6", "user": {"login": "jiohb", "id": 47553373, "node_id": "MDQ6VXNlcjQ3NTUzMzcz", "avatar_url": "https://avatars.githubusercontent.com/u/47553373?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jiohb", "html_url": "https://github.com/jiohb", "followers_url": "https://api.github.com/users/jiohb/followers", "following_url": "https://api.github.com/users/jiohb/following{/other_user}", "gists_url": "https://api.github.com/users/jiohb/gists{/gist_id}", "starred_url": "https://api.github.com/users/jiohb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jiohb/subscriptions", "organizations_url": "https://api.github.com/users/jiohb/orgs", "repos_url": "https://api.github.com/users/jiohb/repos", "events_url": "https://api.github.com/users/jiohb/events{/privacy}", "received_events_url": "https://api.github.com/users/jiohb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2019-03-11T08:02:33Z", "updated_at": "2019-05-09T22:37:18Z", "closed_at": "2019-03-15T09:40:48Z", "author_association": "NONE", "active_lock_reason": "resolved", "body": "code:\r\nscapy/layers/dns.py: 346\r\n```python\r\n        elif pkt.type == 16:  # TXT\r\n            ret_s = b\"\"\r\n            for text in s:\r\n                # The initial string must be split into a list of strings\r\n                # prepended with theirs sizes.\r\n                while len(text) >= 255:\r\n                    ret_s += b\"\\xff\" + text[:255]\r\n                    text = text[255:]\r\n                # The remaining string is less than 255 bytes long\r\n                if len(text):\r\n                    ret_s += struct.pack(\"!B\", len(text)) + raw(text)\r\n            s = ret_s\r\n```\r\nIf I choose dns type=16: text in below will always be int() , so it would's have len() method. here is my error output:\r\n\r\n```python\r\n  File \"/home/hio/.local/lib/python3.6/site-packages/scapy/layers/dns.py\", line 371, in i2m\r\n    x = len(rdataf.i2m(pkt, pkt.rdata))\r\n  File \"/home/hio/.local/lib/python3.6/site-packages/scapy/layers/dns.py\", line 351, in i2m\r\n    while len(text) >= 255:\r\nTypeError: object of type 'int' has no len()\r\n\r\nProcess finished with exit code 1\r\n\r\n```\r\n\r\nYou can test it by:\r\n\r\n```python\r\n\u279c  github sudo python3\r\nPython 3.6.7 (default, Oct 22 2018, 11:32:17) \r\n[GCC 8.2.0] on linux\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> from scapy.all import *\r\n>>> an = DNSRR(rrname='aaa', type='TXT', rdata=\"niceday\", ttl=1)\r\n>>> send(DNS(id=1,ra=1,an=an))\r\nTraceback (most recent call last):\r\n  File \"/home//.local/lib/python3.6/site-packages/scapy/compat.py\", line 117, in raw\r\n    return bytes(x)\r\n  File \"/home//.local/lib/python3.6/site-packages/scapy/packet.py\", line 441, in __bytes__\r\n    return self.build()\r\n  File \"/home//.local/lib/python3.6/site-packages/scapy/packet.py\", line 556, in build\r\n    p = self.do_build()\r\n  File \"/home//.local/lib/python3.6/site-packages/scapy/packet.py\", line 538, in do_build\r\n    pkt = self.self_build()\r\n  File \"/home//.local/lib/python3.6/site-packages/scapy/packet.py\", line 519, in self_build\r\n    p = f.addfield(self, p, val)\r\n  File \"/home//.local/lib/python3.6/site-packages/scapy/fields.py\", line 134, in addfield\r\n    return s + struct.pack(self.fmt, self.i2m(pkt, val))\r\n  File \"/home//.local/lib/python3.6/site-packages/scapy/layers/dns.py\", line 371, in i2m\r\n    x = len(rdataf.i2m(pkt, pkt.rdata))\r\n  File \"/home//.local/lib/python3.6/site-packages/scapy/layers/dns.py\", line 351, in i2m\r\n    while len(text) >= 255:\r\nTypeError: object of type 'int' has no len()\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home//.local/lib/python3.6/site-packages/scapy/compat.py\", line 117, in raw\r\n    return bytes(x)\r\n  File \"/home//.local/lib/python3.6/site-packages/scapy/packet.py\", line 441, in __bytes__\r\n    return self.build()\r\n  File \"/home//.local/lib/python3.6/site-packages/scapy/packet.py\", line 556, in build\r\n    p = self.do_build()\r\n  File \"/home//.local/lib/python3.6/site-packages/scapy/packet.py\", line 541, in do_build\r\n    pay = self.do_build_payload()\r\n  File \"/home//.local/lib/python3.6/site-packages/scapy/packet.py\", line 528, in do_build_payload\r\n    return self.payload.do_build()\r\n  File \"/home//.local/lib/python3.6/site-packages/scapy/packet.py\", line 538, in do_build\r\n    pkt = self.self_build()\r\n  File \"/home//.local/lib/python3.6/site-packages/scapy/packet.py\", line 519, in self_build\r\n    p = f.addfield(self, p, val)\r\n  File \"/home//.local/lib/python3.6/site-packages/scapy/fields.py\", line 905, in addfield\r\n    return s + self.i2m(pkt, val)\r\n  File \"/home//.local/lib/python3.6/site-packages/scapy/layers/dns.py\", line 255, in i2m\r\n    return raw(x)\r\n  File \"/home//.local/lib/python3.6/site-packages/scapy/compat.py\", line 119, in raw\r\n    return bytes(x, encoding=\"utf8\")\r\nTypeError: encoding without a string argument\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/home//.local/lib/python3.6/site-packages/scapy/sendrecv.py\", line 314, in send\r\n    realtime=realtime, return_packets=return_packets)\r\n  File \"/home//.local/lib/python3.6/site-packages/scapy/sendrecv.py\", line 287, in __gen_send\r\n    s.send(p)\r\n  File \"/home//.local/lib/python3.6/site-packages/scapy/arch/linux.py\", line 533, in send\r\n    sx = raw(ll(x))\r\n  File \"/home//.local/lib/python3.6/site-packages/scapy/compat.py\", line 119, in raw\r\n    return bytes(x, encoding=\"utf8\")\r\nTypeError: encoding without a string argument\r\n>>> \r\n\r\n```", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1895/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1895/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1894", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1894/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1894/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1894/events", "html_url": "https://github.com/secdev/scapy/issues/1894", "id": 419231247, "node_id": "MDU6SXNzdWU0MTkyMzEyNDc=", "number": 1894, "title": "conf.checkIPsrc Is not working as intended.", "user": {"login": "ghost", "id": 10137, "node_id": "MDQ6VXNlcjEwMTM3", "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ghost", "html_url": "https://github.com/ghost", "followers_url": "https://api.github.com/users/ghost/followers", "following_url": "https://api.github.com/users/ghost/following{/other_user}", "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}", "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ghost/subscriptions", "organizations_url": "https://api.github.com/users/ghost/orgs", "repos_url": "https://api.github.com/users/ghost/repos", "events_url": "https://api.github.com/users/ghost/events{/privacy}", "received_events_url": "https://api.github.com/users/ghost/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-03-10T20:55:55Z", "updated_at": "2019-03-30T13:05:01Z", "closed_at": "2019-03-30T13:05:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "Greetings,\r\n\r\nWe believe we've found a bug, which still occurs in the latest version and can be seen on the master branch, where conf.checkIPsrc is not working properly. We've been running into issues where running the send receive function was not returning responses on packets sent to the destination. To us it appeared as if Scapy was not ignoring the inner packet source and that's when we found the conf.checkIPsrc option and proceeded to set it to 0 from its default of 1. We continued to get the same issue where we were not getting any responses except for the destination hop. We searched around in the source and we believe we've located a bug where you have src and dst mixed up in the following:\r\n\r\n```\r\n--- a/scapy/layers/inet.py\r\n+++ b/scapy/layers/inet.py\r\n@@ -726,8 +726,8 @@\r\n     def answers(self, other):\r\n         if not isinstance(other, IP):\r\n             return 0\r\n-        if not ( ((conf.checkIPsrc == 0) or (self.dst == other.dst)) and\r\n-                 (self.src == other.src) and\r\n+        if not ( ((conf.checkIPsrc == 0) or (self.src == other.src)) and\r\n+                 (self.dst == other.dst) and\r\n                  ( ((conf.checkIPID == 0)\r\n                     or (self.id == other.id)\r\n                     or (conf.checkIPID == 1 and self.id == socket.htons(other.id)))) and\r\n```\r\n\r\nAfter modifying the above locally within our container we no longer had any issues when passing conf.checkIPsrc=0.\r\n\r\nHere's an example of running the sr function before we update the code:\r\n```\r\n>>> res,un=sr(IP(dst=\"4.2.2.2\",ttl=2,flags='DF',id=RandShort())/ICMP(id=os.getpid()), timeout=2)\r\nBegin emission:\r\n.Finished sending 1 packets.\r\n..............................\r\nReceived 31 packets, got 0 answers, remaining 1 packets\r\n>>> res.summary()\r\n>>> un.summary()\r\nIP / ICMP 10.128.0.7 > 4.2.2.2 echo-request 0\r\n>>> conf.checkIPsrc=0\r\n>>> res,un=sr(IP(dst=\"4.2.2.2\",ttl=2,flags='DF',id=RandShort())/ICMP(id=os.getpid()), timeout=2)\r\nBegin emission:\r\nFinished sending 1 packets.\r\n..............................\r\nReceived 30 packets, got 0 answers, remaining 1 packets\r\n>>> res.summary()\r\n>>> un.summary()\r\nIP / ICMP 10.128.0.7 > 4.2.2.2 echo-request 0\r\n```\r\n\r\nAnd after the fact:\r\n```\r\n>>> conf.checkIPsrc=0\r\n>>> res,un=sr(IP(dst=\"4.2.2.2\",ttl=2,flags='DF',id=RandShort())/ICMP(id=os.getpid()), timeout=2)\r\nBegin emission:\r\n.Finished sending 1 packets.\r\n*\r\nReceived 2 packets, got 1 answers, remaining 0 packets\r\n>>> res.summary()\r\nIP / ICMP 10.128.0.7 > 4.2.2.2 echo-request 0 ==> IP / ICMP W.X.Y.Z > 10.128.0.7 time-exceeded ttl-zero-during-transit / IPerror / ICMPerror\r\n>>> un.summary()\r\n```\r\n\r\nWould it be possible to have someone look into this and possibly update? Here's some additional info about the system I'm on:\r\n```\r\n# cat /etc/os-release\r\nNAME=\"Alpine Linux\"\r\nID=alpine\r\nVERSION_ID=3.5.2\r\nPRETTY_NAME=\"Alpine Linux v3.5\"\r\nHOME_URL=\"http://alpinelinux.org\"\r\nBUG_REPORT_URL=\"http://bugs.alpinelinux.org\"\r\n\r\n# python --version\r\nPython 3.5.6\r\n```\r\nMy Scapy version is Version 2.4.3rc1.dev7\r\n\r\nPlease let me know if any additional information is required.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1894/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1894/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1890", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1890/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1890/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1890/events", "html_url": "https://github.com/secdev/scapy/pull/1890", "id": 418253281, "node_id": "MDExOlB1bGxSZXF1ZXN0MjU5MDY4ODc3", "number": 1890, "title": "OpenBSD Loopback provides address family.", "user": {"login": "bluhm", "id": 4907572, "node_id": "MDQ6VXNlcjQ5MDc1NzI=", "avatar_url": "https://avatars.githubusercontent.com/u/4907572?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bluhm", "html_url": "https://github.com/bluhm", "followers_url": "https://api.github.com/users/bluhm/followers", "following_url": "https://api.github.com/users/bluhm/following{/other_user}", "gists_url": "https://api.github.com/users/bluhm/gists{/gist_id}", "starred_url": "https://api.github.com/users/bluhm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bluhm/subscriptions", "organizations_url": "https://api.github.com/users/bluhm/orgs", "repos_url": "https://api.github.com/users/bluhm/repos", "events_url": "https://api.github.com/users/bluhm/events{/privacy}", "received_events_url": "https://api.github.com/users/bluhm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1265179855, "node_id": "MDU6TGFiZWwxMjY1MTc5ODU1", "url": "https://api.github.com/repos/secdev/scapy/labels/platform-specific", "name": "platform-specific", "color": "14acba", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-03-07T11:08:37Z", "updated_at": "2019-03-15T12:29:03Z", "closed_at": "2019-03-15T12:27:39Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1890", "html_url": "https://github.com/secdev/scapy/pull/1890", "diff_url": "https://github.com/secdev/scapy/pull/1890.diff", "patch_url": "https://github.com/secdev/scapy/pull/1890.patch", "merged_at": "2019-03-15T12:27:38Z"}, "body": "Unlike other BSD systems, OpenBSD DLT_LOOP provides a 32 bit value\r\nin network byte order.  This is the address family of the encapsulated\r\npacket.  Use a simple EnumField in the Loopback layer.\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1890/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1890/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1884", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1884/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1884/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1884/events", "html_url": "https://github.com/secdev/scapy/pull/1884", "id": 417008310, "node_id": "MDExOlB1bGxSZXF1ZXN0MjU4MTAxODYw", "number": 1884, "title": "Fix FCSField computation on already dissected packet", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-03-04T21:49:40Z", "updated_at": "2019-03-05T16:02:20Z", "closed_at": "2019-03-05T15:37:32Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1884", "html_url": "https://github.com/secdev/scapy/pull/1884", "diff_url": "https://github.com/secdev/scapy/pull/1884.diff", "patch_url": "https://github.com/secdev/scapy/pull/1884.patch", "merged_at": "2019-03-05T15:37:32Z"}, "body": "- fixes https://github.com/secdev/scapy/issues/1880\r\n- add test\r\n\r\nThis issue only happened when building a dissected packet (one with already a cache set). That's why I missed it", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1884/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1884/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1872", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1872/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1872/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1872/events", "html_url": "https://github.com/secdev/scapy/issues/1872", "id": 414222926, "node_id": "MDU6SXNzdWU0MTQyMjI5MjY=", "number": 1872, "title": "Dot11Beacon network_stats bugs with Python3", "user": {"login": "1earch", "id": 1888635, "node_id": "MDQ6VXNlcjE4ODg2MzU=", "avatar_url": "https://avatars.githubusercontent.com/u/1888635?v=4", "gravatar_id": "", "url": "https://api.github.com/users/1earch", "html_url": "https://github.com/1earch", "followers_url": "https://api.github.com/users/1earch/followers", "following_url": "https://api.github.com/users/1earch/following{/other_user}", "gists_url": "https://api.github.com/users/1earch/gists{/gist_id}", "starred_url": "https://api.github.com/users/1earch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/1earch/subscriptions", "organizations_url": "https://api.github.com/users/1earch/orgs", "repos_url": "https://api.github.com/users/1earch/repos", "events_url": "https://api.github.com/users/1earch/events{/privacy}", "received_events_url": "https://api.github.com/users/1earch/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-02-25T17:37:24Z", "updated_at": "2019-04-23T16:51:06Z", "closed_at": "2019-02-26T00:17:34Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Getting network statistics from Dot11Beacon packets thanks to `network_stats` with Python3 raises an error.\r\n\r\n#### Environment\r\n\r\n- Scapy version: 2.4.2\r\n- Python version: 3.7.2\r\n- Operating system : Arch Linux\r\n\r\n#### How to reproduce\r\n\r\nPut your wireless card in monitor mode then listen for beacon frames:\r\n\r\n```python\r\nfrom scapy.all import *\r\nimport six\r\n\r\n\r\ndef filter_beacon(p):\r\n    \"\"\" Filter WiFi beacon and probe response packets. \"\"\"\r\n    return p.haslayer(Dot11Beacon)\r\n\r\n\r\ndef print_ap(p):\r\n    \"\"\" Print access point. \"\"\"\r\n    netstats = p[Dot11Beacon].network_stats()\r\n\r\n    # Get AP details\r\n    bssid    = p.addr3\r\n    ssid     = netstats['ssid']\r\n    channel  = netstats['channel']\r\n    crypto   = '/'.join(netstats['crypto'])\r\n\r\n    # Print discovered AP\r\n    print(ssid + \" (\" + bssid + \") on channel \" + str(channel) + \" with crypto \" + crypto)\r\n\r\n\r\n\"\"\" Refresh APs list. \"\"\"\r\nsniff(iface=\"mon0\", lfilter=filter_beacon, prn=print_ap)\r\n```\r\n#### Actual result with Python2\r\n\r\n```\r\nLivebox-1B23 (a4:3e:51:0b:1b:23) on channel 6 with crypto WPA2/WPA\r\nLivebox-1B23 (a4:3e:51:0b:1b:23) on channel 6 with crypto WPA2/WPA\r\n...\r\n```\r\n\r\n#### Actual result with Python3\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"min_script.py\", line 25, in <module>\r\n    sniff(iface=\"mon0\", lfilter=filter_beacon, prn=print_ap)\r\n  File \"/usr/lib/python3.7/site-packages/scapy/sendrecv.py\", line 886, in sniff\r\n    r = prn(p)\r\n  File \"min_script.py\", line 12, in print_ap\r\n    netstats = p[Dot11Beacon].network_stats()\r\n  File \"/usr/lib/python3.7/site-packages/scapy/layers/dot11.py\", line 430, in network_stats\r\n    p.info.startswith('\\x00P\\xf2\\x01\\x01\\x00'):\r\nTypeError: startswith first arg must be bytes or a tuple of bytes, not str\r\n```\r\n\r\n#### Expected result\r\n\r\nAs in Python2\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1872/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1872/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1870", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1870/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1870/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1870/events", "html_url": "https://github.com/secdev/scapy/pull/1870", "id": 413878122, "node_id": "MDExOlB1bGxSZXF1ZXN0MjU1NzE5MTg3", "number": 1870, "title": "Fix Krack module & cleanup RadioTap", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1000112749, "node_id": "MDU6TGFiZWwxMDAwMTEyNzQ5", "url": "https://api.github.com/repos/secdev/scapy/labels/cleanup", "name": "cleanup", "color": "FF68F6", "default": false, "description": "Performs some code clean-up"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-02-24T22:43:30Z", "updated_at": "2020-07-19T09:18:48Z", "closed_at": "2019-03-04T13:58:46Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1870", "html_url": "https://github.com/secdev/scapy/pull/1870", "diff_url": "https://github.com/secdev/scapy/pull/1870.diff", "patch_url": "https://github.com/secdev/scapy/pull/1870.patch", "merged_at": "2019-03-04T13:58:45Z"}, "body": "This PR is a rebase of the old `fixkrack` branch I made some times ago to fix #1828\r\n\r\n- fixes https://github.com/secdev/scapy/issues/1828\r\n- improves Dot11TKIP/Dot11CCMP support (and adapt the krack module for it)\r\n- cleanup `RadioTap` once and for all (remove all #noqa)\r\n- add all remaining `RadioTap` fields (so that we stop getting PRs for them)\r\n- fixes krack for Python 3\r\n- add tests for Dot11TKIP/Dot11CCMP\r\n- minor windows improvements (better monitor cache handling)", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1870/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1870/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1849", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1849/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1849/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1849/events", "html_url": "https://github.com/secdev/scapy/pull/1849", "id": 410529487, "node_id": "MDExOlB1bGxSZXF1ZXN0MjUzMjUxNjMz", "number": 1849, "title": "Cleanup DNS decompression + fix warning messages being shown", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1000112749, "node_id": "MDU6TGFiZWwxMDAwMTEyNzQ5", "url": "https://api.github.com/repos/secdev/scapy/labels/cleanup", "name": "cleanup", "color": "FF68F6", "default": false, "description": "Performs some code clean-up"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-02-14T22:54:23Z", "updated_at": "2019-04-03T22:24:20Z", "closed_at": "2019-04-03T22:19:04Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1849", "html_url": "https://github.com/secdev/scapy/pull/1849", "diff_url": "https://github.com/secdev/scapy/pull/1849.diff", "patch_url": "https://github.com/secdev/scapy/pull/1849.patch", "merged_at": "2019-04-03T22:19:04Z"}, "body": "- fixes https://github.com/secdev/scapy/issues/1846\r\n- cleanup dns\r\n- fixes some warnings\r\n- make UTscapy display raw data of the packets that have made the dissector crash, to be able to debug it externally", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1849/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1849/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1847", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1847/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1847/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1847/events", "html_url": "https://github.com/secdev/scapy/pull/1847", "id": 410481592, "node_id": "MDExOlB1bGxSZXF1ZXN0MjUzMjE0Mjk5", "number": 1847, "title": "Fix various memory leaks when receiving packets", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1000112749, "node_id": "MDU6TGFiZWwxMDAwMTEyNzQ5", "url": "https://api.github.com/repos/secdev/scapy/labels/cleanup", "name": "cleanup", "color": "FF68F6", "default": false, "description": "Performs some code clean-up"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2019-02-14T20:37:51Z", "updated_at": "2020-07-19T09:19:14Z", "closed_at": "2019-03-24T18:40:12Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1847", "html_url": "https://github.com/secdev/scapy/pull/1847", "diff_url": "https://github.com/secdev/scapy/pull/1847.diff", "patch_url": "https://github.com/secdev/scapy/pull/1847.patch", "merged_at": "2019-03-24T18:40:11Z"}, "body": "This PR:\r\n- removes threaded mode: it was a pretty poor idea. What really makes the difference is the use of generators, not the multi threading on sending\r\n- unify docs\r\n- fix randomSixLoWPAN bug\r\n- fixes https://github.com/secdev/scapy/issues/1897 => close all created pcap objects, to avoid a memory overflow\r\n- fixes https://github.com/secdev/scapy/issues/1918 => correctly close sockets when `count` or `stop_filter` conditions are triggered in `sniff`", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1847/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1847/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1846", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1846/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1846/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1846/events", "html_url": "https://github.com/secdev/scapy/issues/1846", "id": 410452741, "node_id": "MDU6SXNzdWU0MTA0NTI3NDE=", "number": 1846, "title": "DNS RR - prematured end", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-02-14T19:22:40Z", "updated_at": "2019-04-03T22:19:04Z", "closed_at": "2019-04-03T22:19:04Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "The \u201cDNS RR prematured end / dns decompression loop\u201d bug is back since https://github.com/secdev/scapy/pull/1722\r\n\r\nI had already spotted it while sniffing, and https://stackoverflow.com/q/54692813/5459467 seems to confirm it\r\n\r\nReproduce with:\r\n\r\n```python\r\npacket =\r\nEther(b'33\\x00\\x00\\x00\\xfb\\xa0\\x10\\x81\\xd9\\xd3y\\x86\\xdd`\\x00\\x00\\x00\\x01\\x00\\x11\\xff\\xfe\\x80\\x00\\x00\\x00\\x00\\x00\\x00\\xa2\\x10\\x81\\xff\\xfe\\xd9\\xd3y\\xff\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xfb\\x14\\xe9\\x14\\xe9\\x01\\x00;\\xed\\x00\\x00\\x84\\x00\\x00\\x00\\x00\\x04\\x00\\x00\\x00\\x03\\x03188\\x0270\\x03168\\x03192\\x07in-addr\\x04arpa\\x00\\x00\\x0c\\x80\\x01\\x00\\x00\\x00x\\x00\\x0f\\x07Android\\x05local\\x00\\x019\\x017\\x013\\x01D\\x019\\x01D\\x01E\\x01F\\x01F\\x01F\\x011\\x018\\x010\\x011\\x012\\x01A\\x010\\x010\\x010\\x010\\x010\\x010\\x010\\x010\\x010\\x010\\x010\\x010\\x010\\x018\\x01E\\x01F\\x03ip6\\xc0#\\x00\\x0c\\x80\\x01\\x00\\x00\\x00x\\x00\\x02\\xc03\\xc03\\x00\\x01\\x80\\x01\\x00\\x00\\x00x\\x00\\x04\\xc0\\xa8F\\xbc\\xc03\\x00\\x1c\\x80\\x01\\x00\\x00\\x00x\\x00\\x10\\xfe\\x80\\x00\\x00\\x00\\x00\\x00\\x00\\xa2\\x10\\x81\\xff\\xfe\\xd9\\xd3y\\xc0\\x0c\\x00/\\x80\\x01\\x00\\x00\\x00x\\x00\\x06\\xc0\\x0c\\x00\\x02\\x00\\x08\\xc0B\\x00/\\x80\\x01\\x00\\x00\\x00x\\x00\\x06\\xc0B\\x00\\x02\\x00\\x08\\xc03\\x00/\\x80\\x01\\x00\\x00\\x00x\\x00\\x08\\xc03\\x00\\x04@\\x00\\x00\\x08')\r\n```", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1846/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1846/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1833", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1833/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1833/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1833/events", "html_url": "https://github.com/secdev/scapy/pull/1833", "id": 406109387, "node_id": "MDExOlB1bGxSZXF1ZXN0MjQ5ODkwMzUy", "number": 1833, "title": "Improve Windows support", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 564414240, "node_id": "MDU6TGFiZWw1NjQ0MTQyNDA=", "url": "https://api.github.com/repos/secdev/scapy/labels/convergence", "name": "convergence", "color": "c2e0c6", "default": false, "description": null}, {"id": 1000112749, "node_id": "MDU6TGFiZWwxMDAwMTEyNzQ5", "url": "https://api.github.com/repos/secdev/scapy/labels/cleanup", "name": "cleanup", "color": "FF68F6", "default": false, "description": "Performs some code clean-up"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-02-03T17:17:25Z", "updated_at": "2019-02-08T10:27:17Z", "closed_at": "2019-02-08T10:27:11Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1833", "html_url": "https://github.com/secdev/scapy/pull/1833", "diff_url": "https://github.com/secdev/scapy/pull/1833.diff", "patch_url": "https://github.com/secdev/scapy/pull/1833.patch", "merged_at": "2019-02-08T10:27:11Z"}, "body": "This PR fixes small bugs introduced by the recent overhaul, reported by various users:\r\n- improves interface detection on Windows (actually, interfaces with duplicated names were ignored. That lead to trouble when using Monitor mode)\r\n- Restores Winpcap compatibility (+ added a Winpcap test to appveyor to avoid future regressions) : fix https://github.com/secdev/scapy/issues/1719\r\n- fixes https://github.com/secdev/scapy/issues/1819", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1833/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1833/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1832", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1832/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1832/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1832/events", "html_url": "https://github.com/secdev/scapy/pull/1832", "id": 406108642, "node_id": "MDExOlB1bGxSZXF1ZXN0MjQ5ODg5ODY1", "number": 1832, "title": "Better FCS handling & Support other 802.11 encryption", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 267691054, "node_id": "MDU6TGFiZWwyNjc2OTEwNTQ=", "url": "https://api.github.com/repos/secdev/scapy/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}, {"id": 780561688, "node_id": "MDU6TGFiZWw3ODA1NjE2ODg=", "url": "https://api.github.com/repos/secdev/scapy/labels/needs%20testing", "name": "needs testing", "color": "fbca04", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-02-03T17:08:38Z", "updated_at": "2020-07-19T09:18:45Z", "closed_at": "2019-02-14T15:46:47Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1832", "html_url": "https://github.com/secdev/scapy/pull/1832", "diff_url": "https://github.com/secdev/scapy/pull/1832.diff", "patch_url": "https://github.com/secdev/scapy/pull/1832.patch", "merged_at": "2019-02-14T15:46:47Z"}, "body": "- fixes https://github.com/secdev/scapy/issues/1811\r\n- introduces `FCSField`, which is applied on the end of a packet\r\n- adds WPA/TKIP/CCMP support for 802.11 packets => not always WEP", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1832/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1832/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1828", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1828/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1828/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1828/events", "html_url": "https://github.com/secdev/scapy/issues/1828", "id": 405773777, "node_id": "MDU6SXNzdWU0MDU3NzM3Nzc=", "number": 1828, "title": "krack module error", "user": {"login": "Matheus-Garbelini", "id": 6465668, "node_id": "MDQ6VXNlcjY0NjU2Njg=", "avatar_url": "https://avatars.githubusercontent.com/u/6465668?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Matheus-Garbelini", "html_url": "https://github.com/Matheus-Garbelini", "followers_url": "https://api.github.com/users/Matheus-Garbelini/followers", "following_url": "https://api.github.com/users/Matheus-Garbelini/following{/other_user}", "gists_url": "https://api.github.com/users/Matheus-Garbelini/gists{/gist_id}", "starred_url": "https://api.github.com/users/Matheus-Garbelini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Matheus-Garbelini/subscriptions", "organizations_url": "https://api.github.com/users/Matheus-Garbelini/orgs", "repos_url": "https://api.github.com/users/Matheus-Garbelini/repos", "events_url": "https://api.github.com/users/Matheus-Garbelini/events{/privacy}", "received_events_url": "https://api.github.com/users/Matheus-Garbelini/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 27, "created_at": "2019-02-01T16:24:28Z", "updated_at": "2019-03-13T07:47:28Z", "closed_at": "2019-03-04T13:58:46Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hello, I'm using the latest version of Scapy (2.4.2) and i'm having problems when using the kracken module as suggested in it's files.\r\n\r\n* Scapy version: 2.4.2\r\n* Python version: 2.7.13\r\n\r\nHere's my code:\r\n```Python\r\nfrom scapy.main import load_module\r\nfrom scapy.modules.krack.automaton import KrackAP\r\n\r\nload_module(\"krack\")\r\nKrackAP(\r\n    iface=\"wlp3s0mon\",               # A monitor interface\r\n    ap_mac='ac:cb:12:ad:58:27', # MAC (BSSID) to use\r\n    ssid=\"TEST_KRA\",          # SSID\r\n    passphrase=\"testtest\",      # Associated passphrase\r\n    channel=9,\r\n).run()\r\n```\r\nThe code runs fine and I can see the access point \"TEST_KRA\" in my smarphone but for some reason it always gives me this error below:\r\n\r\n```Bash\r\nWARNING:scapy.runtime:AP started with ESSID: TEST_KRA, BSSID: ac:cb:12:ad:58:27\r\nWARNING:scapy.runtime:Client dc:bf:e9:87:07:77 connected!\r\nWARNING:scapy.interactive:run() method deprecated. The instance is now callable\r\nTraceback (most recent call last):\r\n  File \"main.py\", line 30, in <module>\r\n    channel=9,\r\n  File \"/usr/lib/pypy/site-packages/scapy/modules/krack/automaton.py\", line 160, in run\r\n    super(KrackAP, self).run(*args, **kwargs)\r\n  File \"/usr/lib/pypy/site-packages/scapy/automaton.py\", line 951, in run\r\n    six.reraise(c.exc_info[0], c.exc_info[1], c.exc_info[2])\r\n  File \"/usr/lib/pypy/site-packages/scapy/automaton.py\", line 793, in _do_control\r\n    state = next(iterator)\r\n  File \"/usr/lib/pypy/site-packages/scapy/automaton.py\", line 889, in _do_iter\r\n    self._run_condition(rcvcond, pkt, *state_output)  # noqa: E501\r\n  File \"/usr/lib/pypy/site-packages/scapy/automaton.py\", line 736, in _run_condition\r\n    cond(self, *args, **kargs)\r\n  File \"/usr/lib/pypy/site-packages/scapy/modules/krack/automaton.py\", line 682, in get_data\r\n    if pkt[Dot11].FCfield.retry:\r\n  File \"/usr/lib/pypy/site-packages/scapy/packet.py\", line 1079, in __getitem__\r\n    raise IndexError(\"Layer [%s] not found\" % lname)\r\nIndexError: Layer [Dot11] not found\r\n```\r\n\r\nWhy I'm receiving this error if this module seems well integrated according to some earlier merges in this repo? could it be some inclusion problem within the `automaton.py` code?\r\n\r\nI Also tested with my secondary wifi trying to connect to this ap and the code stops in the same place as if I tested with the android device.\r\n\r\nThank you.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1828/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1828/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1824", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1824/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1824/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1824/events", "html_url": "https://github.com/secdev/scapy/issues/1824", "id": 405313084, "node_id": "MDU6SXNzdWU0MDUzMTMwODQ=", "number": 1824, "title": "VXLAN: different behavior between 2.4.0 and 2.4.2", "user": {"login": "mcorbin", "id": 4451204, "node_id": "MDQ6VXNlcjQ0NTEyMDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4451204?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mcorbin", "html_url": "https://github.com/mcorbin", "followers_url": "https://api.github.com/users/mcorbin/followers", "following_url": "https://api.github.com/users/mcorbin/following{/other_user}", "gists_url": "https://api.github.com/users/mcorbin/gists{/gist_id}", "starred_url": "https://api.github.com/users/mcorbin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mcorbin/subscriptions", "organizations_url": "https://api.github.com/users/mcorbin/orgs", "repos_url": "https://api.github.com/users/mcorbin/repos", "events_url": "https://api.github.com/users/mcorbin/events{/privacy}", "received_events_url": "https://api.github.com/users/mcorbin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-01-31T15:57:28Z", "updated_at": "2019-02-05T08:09:39Z", "closed_at": "2019-02-05T08:09:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nThe VXLAN() constructor doesn't have the same behavior in 2.4.2 than in 2.4.0.\r\n\r\n#### Environment\r\n\r\n-   Scapy version: master (6865162a1062d91b0189bf962cbc7af76d330d87)\r\n-   Python version: `3.7.2`\r\n-   Operating System: `Debian testing`\r\n\r\n#### How to reproduce\r\n\r\nBuild a VXLAN packet from raw bytes (cf the example).\r\n\r\n#### Actual result\r\n\r\nScapy 2.4.2/master:\r\n\r\n```python\r\n>>> a = VXLAN(b'\\x08\\x00\\x00\\x00\\x00\"H\\x00\\xcaF\\xae\\x10\\xed\\x0f\\x0c\\x00\\x00\\x00\\x00\\x00\\x08\\x06\\x00\\x01\\x08\\x00\\x06\\x04\\x00\\x02\\x0c\\x00\\x00\\x00\\x00\\x00\\x7f\\xff\\xff\\xfe\\x11\"3DUf\\x7f\\x00\\x00\\x02')\r\n>>> a\r\n<VXLAN  flags=Instance reserved1=0 vni=0x2248 reserved2=0x0 |<Raw  load='\\xcaF\\xae\\x10\\xed\\x0f\\x0c\\x00\\x00\\x00\\x00\\x00\\x08\\x06\\x00\\x01\\x08\\x00\\x06\\x04\\x00\\x02\\x0c\\x00\\x00\\x00\\x00\\x00\\x7f\\xff\\xff\\xfe\\x11\"3DUf\\x7f\\x00\\x00\\x02' |>>\r\n```\r\n\r\n#### Expected result\r\n\r\nScapy 2.4.0:\r\n\r\n```python\r\n>>> a = VXLAN(b'\\x08\\x00\\x00\\x00\\x00\"H\\x00\\xcaF\\xae\\x10\\xed\\x0f\\x0c\\x00\\x00\\x00\\x00\\x00\\x08\\x06\\x00\\x01\\x08\\x00\\x06\\x04\\x00\\x02\\x0c\\x00\\x00\\x00\\x00\\x00\\x7f\\xff\\xff\\xfe\\x11\"3DUf\\x7f\\x00\\x00\\x02')\r\n>>> a\r\n<VXLAN  flags=Instance reserved1=0 vni=0x2248 reserved2=0x0 |<Ether  dst=ca:46:ae:10:ed:0f src=0c:00:00:00:00:00 type=ARP |<ARP  hwtype=0x1 ptype=0x800 hwlen=6 plen=4 op=is-at hwsrc=0c:00:00:00:00:00 psrc=127.255.255.254 hwdst=11:22:33:44:55:66 pdst=127.0.0.2 |>>>\r\n```\r\n\r\nAs you can see, I have a `Ether` field in 2.4.0 but a `Raw` field in 2.4.2.\r\n\r\n3dd5817a789f3d4767e64d309b9b8ecb790e8e15 introduced the issue (found using `git bisect`).\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1824/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1824/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1818", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1818/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1818/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1818/events", "html_url": "https://github.com/secdev/scapy/issues/1818", "id": 403476848, "node_id": "MDU6SXNzdWU0MDM0NzY4NDg=", "number": 1818, "title": "ZigbeeAppDataPayload wrongly expects block_number ", "user": {"login": "hgbstu", "id": 18686294, "node_id": "MDQ6VXNlcjE4Njg2Mjk0", "avatar_url": "https://avatars.githubusercontent.com/u/18686294?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hgbstu", "html_url": "https://github.com/hgbstu", "followers_url": "https://api.github.com/users/hgbstu/followers", "following_url": "https://api.github.com/users/hgbstu/following{/other_user}", "gists_url": "https://api.github.com/users/hgbstu/gists{/gist_id}", "starred_url": "https://api.github.com/users/hgbstu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hgbstu/subscriptions", "organizations_url": "https://api.github.com/users/hgbstu/orgs", "repos_url": "https://api.github.com/users/hgbstu/repos", "events_url": "https://api.github.com/users/hgbstu/events{/privacy}", "received_events_url": "https://api.github.com/users/hgbstu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-01-26T19:54:34Z", "updated_at": "2019-02-14T08:30:52Z", "closed_at": "2019-02-14T08:30:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nIf the `ConditionalField` `pkt.fragmentation` is not set, `block_number` is still read from the packet.\r\n\r\n#### Environment\r\n\r\n-   Scapy version: 2.4.0.dev653\r\n-   Python version: Python 2.7.13 \r\n-   Operating System: Debian 9.5\r\n\r\n#### How to reproduce\r\n\r\n```\r\n#!/usr/bin/env python\r\n\r\nfrom scapy.all import *\r\n\r\nconf.dot15d4_protocol = \"zigbee\"\r\n\r\nif __name__ == '__main__':\r\n    payload = '@\\x01\\x00\\x00\\x04\\x01\\x01\\r\\x18 \\x01\\x00\\x00\\x00 \\x01\\x04\\x00\\x00B\\x07sengled'\r\n    obj = ZigbeeAppDataPayload(payload)\r\n    print '  ', repr(obj)\r\n    print(obj.show2())\r\n```\r\n\r\n#### Incorrect result\r\n\r\n```\r\n   <ZigbeeAppDataPayload  frame_control=ack_req delivery_mode=unicast aps_frametype=data dst_endpoint=1 cluster=basic profile=HA_Home_Automation src_endpoint=1 counter=13 block_number=24 |<ZigbeeClusterLibrary  reserved=1 disable_default_response=0 direction=0 manufacturer_specific=0 zcl_frametype=profile-wide transaction_sequence=1 command_identifier=read_attributes |<ZCLGeneralReadAttributes  attribute_identifiers=[0x0, 0x120, 0x4, 0x4200, 0x7307, 0x6e65, 0x6c67, 0x6465] |>>>\r\n###[ Zigbee Application Layer Data Payload (General APS Frame Format) ]### \r\n  frame_control= ack_req\r\n  delivery_mode= unicast\r\n  aps_frametype= data\r\n  dst_endpoint= 1\r\n  cluster   = basic\r\n  profile   = HA_Home_Automation\r\n  src_endpoint= 1\r\n  counter   = 13\r\n  block_number= 24\r\n###[ Zigbee Cluster Library (ZCL) Frame ]### \r\n     reserved  = 1\r\n     disable_default_response= 0\r\n     direction = 0\r\n     manufacturer_specific= 0\r\n     zcl_frametype= profile-wide\r\n     transaction_sequence= 1\r\n     command_identifier= read_attributes\r\n###[ General Domain: Command Frame Payload: read_attributes ]### \r\n        attribute_identifiers= [0x0, 0x120, 0x4, 0x4200, 0x7307, 0x6e65, 0x6c67, 0x6465]\r\n```\r\n#### Expected result\r\n```\r\n[ Zigbee Application Layer Data Payload (General APS Frame Format) ]### \r\n  frame_control= ack_req\r\n  delivery_mode= unicast\r\n  aps_frametype= data\r\n  dst_endpoint= 1\r\n  cluster   = basic\r\n  profile   = HA_Home_Automation\r\n  src_endpoint= 1\r\n  counter   = 13\r\n###[ Zigbee Cluster Library (ZCL) Frame ]### \r\n     reserved  = 0\r\n     disable_default_response= 1\r\n     direction = 1\r\n     manufacturer_specific= 0\r\n     zcl_frametype= profile-wide\r\n     transaction_sequence= 32\r\n     command_identifier= read_attributes_response\r\n...\r\n```\r\n\r\n![grafik](https://user-images.githubusercontent.com/18686294/51792029-48253400-21ac-11e9-9177-2a6be45bed29.png)\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1818/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1818/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1816", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1816/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1816/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1816/events", "html_url": "https://github.com/secdev/scapy/pull/1816", "id": 403466155, "node_id": "MDExOlB1bGxSZXF1ZXN0MjQ3OTA0MDk5", "number": 1816, "title": "Improve ZigbeeAppDataPayload & ZigbeeAppCommandPayload", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 267691054, "node_id": "MDU6TGFiZWwyNjc2OTEwNTQ=", "url": "https://api.github.com/repos/secdev/scapy/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-01-26T18:05:14Z", "updated_at": "2020-07-19T09:18:43Z", "closed_at": "2019-02-14T08:30:52Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1816", "html_url": "https://github.com/secdev/scapy/pull/1816", "diff_url": "https://github.com/secdev/scapy/pull/1816.diff", "patch_url": "https://github.com/secdev/scapy/pull/1816.patch", "merged_at": "2019-02-14T08:30:51Z"}, "body": "- fixes https://github.com/secdev/scapy/issues/1815\r\n- fixes https://github.com/secdev/scapy/issues/1818\r\n- fixes some definitions (especially ZigbeeAppCommandPayload)", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1816/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1816/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1815", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1815/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1815/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1815/events", "html_url": "https://github.com/secdev/scapy/issues/1815", "id": 403334977, "node_id": "MDU6SXNzdWU0MDMzMzQ5Nzc=", "number": 1815, "title": "ZCLReadAttributeStatusRecord incorrect parsing", "user": {"login": "hgbstu", "id": 18686294, "node_id": "MDQ6VXNlcjE4Njg2Mjk0", "avatar_url": "https://avatars.githubusercontent.com/u/18686294?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hgbstu", "html_url": "https://github.com/hgbstu", "followers_url": "https://api.github.com/users/hgbstu/followers", "following_url": "https://api.github.com/users/hgbstu/following{/other_user}", "gists_url": "https://api.github.com/users/hgbstu/gists{/gist_id}", "starred_url": "https://api.github.com/users/hgbstu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hgbstu/subscriptions", "organizations_url": "https://api.github.com/users/hgbstu/orgs", "repos_url": "https://api.github.com/users/hgbstu/repos", "events_url": "https://api.github.com/users/hgbstu/events{/privacy}", "received_events_url": "https://api.github.com/users/hgbstu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2019-01-25T21:13:32Z", "updated_at": "2019-02-14T08:30:51Z", "closed_at": "2019-02-14T08:30:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nIf there are multiple entries of ZCLReadAttributeStatusRecord in a packet scapy returns only the first one, the rest is interpreted as RAW.\r\n\r\n#### Environment\r\n\r\n-   Scapy version: 2.4.0.dev653\r\n-   Python version: Python 2.7.13 \r\n-   Operating System: Debian 9.5\r\n\r\n#### How to reproduce\r\n\r\n```\r\nclass ZCLGeneralReadAttributesResponse(Packet):\r\n    name = \"General Domain: Command Frame Payload: read_attributes_response\"\r\n    fields_desc = [\r\n        PacketListField(\"read_attribute_status_record\", [], ZCLReadAttributeStatusRecord),  # noqa: E501\r\n    ]\r\n```\r\n I added the `extract_padding(...)` line to `ZCLReadAttributeStatusRecord(Packet)` (this is needed as far as I understand correctly for `PacketListField` to work)\r\n\r\n```\r\nclass ZCLReadAttributeStatusRecord(Packet):\r\n    name = \"ZCL Read Attribute Status Record\"\r\n    fields_desc = [\r\n        # Attribute Identifier\r\n        XLEShortField(\"attribute_identifier\", 0),\r\n        # Status\r\n        ByteEnumField(\"status\", 0, _zcl_enumerated_status_values),\r\n        # Attribute data type (0/1 octet), only included if status == 0x00 (SUCCESS)  # noqa: E501\r\n        ConditionalField(\r\n            ByteEnumField(\"attribute_data_type\", 0, _zcl_attribute_data_types),\r\n            lambda pkt:pkt.status == 0x00\r\n        ),\r\n        # Attribute data (0/variable in size), only included if status == 0x00 (SUCCESS)  # noqa: E501\r\n        ConditionalField(\r\n            StrLenField(\"attribute_value\", \"\", length_from=lambda pkt:util_zcl_attribute_value_len(pkt)),  # noqa: E501\r\n            lambda pkt:pkt.status == 0x00\r\n        ),\r\n    ]\r\n    \r\n    def extract_padding(self, p):\r\n        return \"\", p\r\n```\r\nThe function `util_zcl_attribute_value_len()` returns the length for `attribute_value`. However if `pkt.attribute_data_type == 0x42` (I assume it's the same also for 0x43, 0x44) accessing `pkt.attribute_value[0]` results in the following error message. \r\n\r\n>   File \"/usr/local/lib/python2.7/dist-packages/scapy/layers/zigbee.py\", line 1503, in util_zcl_attribute_value_len\r\n>     return int(pkt.attribute_value[0])  # defined in first octet\r\n> IndexError: string index out of range\r\n\r\n\r\n```\r\ndef util_zcl_attribute_value_len(pkt):\r\n    # Calculate the length of the attribute value field\r\n    if (pkt.attribute_data_type == 0x00):  # no data\r\n        return 0\r\n...\r\n    elif (pkt.attribute_data_type == 0x42):  # Character string\r\n        return int(pkt.attribute_value[0])  # defined in first octet\r\n    elif (pkt.attribute_data_type == 0x43):  # Long octet string\r\n        return int(pkt.attribute_value[0:2])  # defined in first two octets\r\n    elif (pkt.attribute_data_type == 0x44):  # Long character string\r\n        return int(pkt.attribute_value[0:2])  # defined in first two octets\r\n```\r\nI think this is because `pkt.attribute_value` is not initialized yet. How can I access the \"next\" byte to return the correct length?\r\n\r\n#### Incorrect result\r\n![grafik](https://user-images.githubusercontent.com/18686294/51772976-b1923d80-20ed-11e9-9ca7-850ea30e2489.png)\r\n\r\n#### Expected result\r\n![grafik](https://user-images.githubusercontent.com/18686294/51772878-7132bf80-20ed-11e9-93b1-24bf5f09d368.png)\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1815/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1815/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1814", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1814/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1814/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1814/events", "html_url": "https://github.com/secdev/scapy/issues/1814", "id": 403314153, "node_id": "MDU6SXNzdWU0MDMzMTQxNTM=", "number": 1814, "title": "Health checks (Deprecation/Garbage) failing", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 514033136, "node_id": "MDU6TGFiZWw1MTQwMzMxMzY=", "url": "https://api.github.com/repos/secdev/scapy/labels/tests", "name": "tests", "color": "0e8a16", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-01-25T20:06:32Z", "updated_at": "2019-02-04T18:42:53Z", "closed_at": "2019-02-04T18:42:53Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "The python-garbage-warning test seems to be failing on all PRs\r\n\r\nhttps://travis-ci.org/secdev/scapy/jobs/484493211\r\n\r\nThe test is doing its job: encode_point was deprecated on IPython.\r\n\r\nfixed in https://github.com/secdev/scapy/pull/1735", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1814/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1814/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1811", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1811/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1811/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1811/events", "html_url": "https://github.com/secdev/scapy/issues/1811", "id": 401633238, "node_id": "MDU6SXNzdWU0MDE2MzMyMzg=", "number": 1811, "title": "802.11-FCS: addr3, SC, fcs seem to be messed up in data frames (type=2)", "user": {"login": "m6c7l", "id": 14283383, "node_id": "MDQ6VXNlcjE0MjgzMzgz", "avatar_url": "https://avatars.githubusercontent.com/u/14283383?v=4", "gravatar_id": "", "url": "https://api.github.com/users/m6c7l", "html_url": "https://github.com/m6c7l", "followers_url": "https://api.github.com/users/m6c7l/followers", "following_url": "https://api.github.com/users/m6c7l/following{/other_user}", "gists_url": "https://api.github.com/users/m6c7l/gists{/gist_id}", "starred_url": "https://api.github.com/users/m6c7l/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/m6c7l/subscriptions", "organizations_url": "https://api.github.com/users/m6c7l/orgs", "repos_url": "https://api.github.com/users/m6c7l/repos", "events_url": "https://api.github.com/users/m6c7l/events{/privacy}", "received_events_url": "https://api.github.com/users/m6c7l/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2019-01-22T07:33:49Z", "updated_at": "2019-02-14T15:46:47Z", "closed_at": "2019-02-14T15:46:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "During sniffing I noticed sn's and fn's not changing over time which are supposed to change. This happens as far as I can tell to data packets (type=2) only, regardless of their subtype. It seems that 4 bytes of addr3 (source address) are replaced with the frame check sequence (fcs) and vice versa. A simple show() of the 802.11-FCS layer shows the issue due to wrong decoding as well.\r\n\r\nTo be more explicit and in order to describe the issue more precise, here an example to correct raw bytes of a ScaPy-sniffed packet (actual state) to a packet assumed to be correct (desired state):\r\n\r\n```python\r\n# 802.11-FCS raw bytes (textual representation)\r\n#    fcf  d    addr1        addr2        addr3?        sc?   qc   payload        fcs?\r\ns = \"8826|d000|969609eb76aa|96961fc38c50|9696*c1574fc3|1fc3*|0000|aaaa03..68b261|*8c50b000*\"\r\ns = re.sub('[|\\*]', '', s)\r\ns = re.findall('..', s)\r\nl = ['|'] \r\ns = ''.join(s[:2] + l + s[2:4] + l + s[4:10] + l + s[10:16] + l +\r\n            s[16:18] + s[22:24] + s[-4:-2] + l + s[-2:] + l + s[24:26] + l +\r\n            s[26:-4] + l + s[18:22])\r\nprint(s)\r\n# 8826|d000|969609eb76aa|96961fc38c50|96961fc38c50|b000|0000|aaaa03..68b261|c1574fc3\r\n```\r\n\r\nIn the example above sn becomes 11, fn becomes 0 and addr2 becomes equal to addr3, which would be correct.\r\n\r\nI am using Scapy 2.4.2 and Python 3.6.8 on GNU/Linux 4.20 to sniff kind of regular traffic on 802.11bgn physical layers, whereby I need to get  the (correct) sequence (sn) and fragment numbers (fn). ", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1811/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1811/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1805", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1805/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1805/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1805/events", "html_url": "https://github.com/secdev/scapy/pull/1805", "id": 401028077, "node_id": "MDExOlB1bGxSZXF1ZXN0MjQ2MDY3MDEy", "number": 1805, "title": "Fix sendpfast() for Python 2 & 3", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-01-19T19:42:54Z", "updated_at": "2019-01-23T22:07:59Z", "closed_at": "2019-01-23T22:07:44Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1805", "html_url": "https://github.com/secdev/scapy/pull/1805", "diff_url": "https://github.com/secdev/scapy/pull/1805.diff", "patch_url": "https://github.com/secdev/scapy/pull/1805.patch", "merged_at": "2019-01-23T22:07:44Z"}, "body": "`with subprocess.Popen()` is not supported in Python 2 (fixes #1798).\r\n\r\nOutput from `sendpfast()` was not converted from `bytes` to `str` in Python 3.\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1805/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1805/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1804", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1804/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1804/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1804/events", "html_url": "https://github.com/secdev/scapy/pull/1804", "id": 401026920, "node_id": "MDExOlB1bGxSZXF1ZXN0MjQ2MDY2MzM2", "number": 1804, "title": "Fix sr() with debug_match", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-01-19T19:28:22Z", "updated_at": "2019-01-20T13:22:26Z", "closed_at": "2019-01-20T13:13:22Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1804", "html_url": "https://github.com/secdev/scapy/pull/1804", "diff_url": "https://github.com/secdev/scapy/pull/1804.diff", "patch_url": "https://github.com/secdev/scapy/pull/1804.patch", "merged_at": "2019-01-20T13:13:22Z"}, "body": "Fixes #1799. Fix provided by @godfryd, test by @gpotter2.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1804/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1804/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1802", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1802/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1802/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1802/events", "html_url": "https://github.com/secdev/scapy/pull/1802", "id": 400892276, "node_id": "MDExOlB1bGxSZXF1ZXN0MjQ1OTc1MDc2", "number": 1802, "title": "Fix PYX detection", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-01-18T21:17:54Z", "updated_at": "2019-01-19T11:40:50Z", "closed_at": "2019-01-19T08:37:51Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1802", "html_url": "https://github.com/secdev/scapy/pull/1802", "diff_url": "https://github.com/secdev/scapy/pull/1802.diff", "patch_url": "https://github.com/secdev/scapy/pull/1802.patch", "merged_at": "2019-01-19T08:37:51Z"}, "body": "fixes https://github.com/secdev/scapy/issues/1801\r\n\r\nFTR tho only happens when:\r\n- pyx is installed without its dependencies (it I unusable)", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1802/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1802/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1801", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1801/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1801/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1801/events", "html_url": "https://github.com/secdev/scapy/issues/1801", "id": 400867391, "node_id": "MDU6SXNzdWU0MDA4NjczOTE=", "number": 1801, "title": "Catch OSError exceptions when pdflatex is not installed", "user": {"login": "martingalloar", "id": 3941628, "node_id": "MDQ6VXNlcjM5NDE2Mjg=", "avatar_url": "https://avatars.githubusercontent.com/u/3941628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/martingalloar", "html_url": "https://github.com/martingalloar", "followers_url": "https://api.github.com/users/martingalloar/followers", "following_url": "https://api.github.com/users/martingalloar/following{/other_user}", "gists_url": "https://api.github.com/users/martingalloar/gists{/gist_id}", "starred_url": "https://api.github.com/users/martingalloar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/martingalloar/subscriptions", "organizations_url": "https://api.github.com/users/martingalloar/orgs", "repos_url": "https://api.github.com/users/martingalloar/repos", "events_url": "https://api.github.com/users/martingalloar/events{/privacy}", "received_events_url": "https://api.github.com/users/martingalloar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-01-18T19:55:50Z", "updated_at": "2019-01-19T08:37:51Z", "closed_at": "2019-01-19T08:37:51Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "#### Brief description\r\n\r\n`OSError` exceptions are not being catched in `v2.4.2` if `pdflatex` is not available.\r\n\r\nI think this was properly solved in https://github.com/secdev/scapy/commit/0f799ca889078ae8ff1b719777f5fb450a613409 but #1740 brought it back to the code in v2.4.1/v2.4.2.\r\n\r\n#### Environment\r\n\r\n-   Scapy version: `v2.4.2`\r\n-   Python version: `2.7.15rc1`\r\n-   Operating System: `Ubuntu 18.04.1`\r\n\r\nRunning in an environment without `pdflatex` installed.\r\n\r\n#### How to reproduce\r\n\r\n1. `pip install scapy==2.4.2`\r\n2. `python -c \"from scapy.packet import Packet\"`\r\n\r\n#### Actual result\r\n\r\n```\r\n$ python -c \"from scapy.packet import Packet\"\r\nTraceback (most recent call last):\r\n  File \"<string>\", line 1, in <module>\r\n  File \"/home/martin/.virtualenvs/pysap2/local/lib/python2.7/site-packages/scapy/packet.py\", line 28, in <module>\r\n    from scapy.extlib import PYX\r\n  File \"/home/martin/.virtualenvs/pysap2/local/lib/python2.7/site-packages/scapy/extlib.py\", line 54, in <module>\r\n    if _test_pyx():\r\n  File \"/home/martin/.virtualenvs/pysap2/local/lib/python2.7/site-packages/scapy/extlib.py\", line 45, in _test_pyx\r\n    stdout=devnull, stderr=subprocess.STDOUT)\r\n  File \"/usr/lib/python2.7/subprocess.py\", line 185, in check_call\r\n    retcode = call(*popenargs, **kwargs)\r\n  File \"/usr/lib/python2.7/subprocess.py\", line 172, in call\r\n    return Popen(*popenargs, **kwargs).wait()\r\n  File \"/usr/lib/python2.7/subprocess.py\", line 394, in __init__\r\n    errread, errwrite)\r\n  File \"/usr/lib/python2.7/subprocess.py\", line 1047, in _execute_child\r\n    raise child_exception\r\nOSError: [Errno 2] No such file or directory\r\n$\r\n```\r\n\r\n#### Expected result\r\n\r\n```\r\n$ python -c \"from scapy.packet import Packet\"\r\n$\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1801/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1801/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1800", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1800/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1800/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1800/events", "html_url": "https://github.com/secdev/scapy/pull/1800", "id": 400809288, "node_id": "MDExOlB1bGxSZXF1ZXN0MjQ1OTExMjg5", "number": 1800, "title": "*BSD fixes", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 564414240, "node_id": "MDU6TGFiZWw1NjQ0MTQyNDA=", "url": "https://api.github.com/repos/secdev/scapy/labels/convergence", "name": "convergence", "color": "c2e0c6", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-01-18T16:59:11Z", "updated_at": "2019-02-05T14:40:20Z", "closed_at": "2019-02-05T14:40:20Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1800", "html_url": "https://github.com/secdev/scapy/pull/1800", "diff_url": "https://github.com/secdev/scapy/pull/1800.diff", "patch_url": "https://github.com/secdev/scapy/pull/1800.patch", "merged_at": "2019-02-05T14:40:19Z"}, "body": "This PR adds fixes for FreeBSD, OpenBSD & NetBSD.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1800/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1800/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1795", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1795/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1795/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1795/events", "html_url": "https://github.com/secdev/scapy/pull/1795", "id": 400033256, "node_id": "MDExOlB1bGxSZXF1ZXN0MjQ1MzE5Mjc1", "number": 1795, "title": "NetflowV9 overhaul", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 514033136, "node_id": "MDU6TGFiZWw1MTQwMzMxMzY=", "url": "https://api.github.com/repos/secdev/scapy/labels/tests", "name": "tests", "color": "0e8a16", "default": false, "description": null}, {"id": 1000112749, "node_id": "MDU6TGFiZWwxMDAwMTEyNzQ5", "url": "https://api.github.com/repos/secdev/scapy/labels/cleanup", "name": "cleanup", "color": "FF68F6", "default": false, "description": "Performs some code clean-up"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-01-16T22:50:41Z", "updated_at": "2019-01-28T11:46:28Z", "closed_at": "2019-01-28T10:25:38Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1795", "html_url": "https://github.com/secdev/scapy/pull/1795", "diff_url": "https://github.com/secdev/scapy/pull/1795.diff", "patch_url": "https://github.com/secdev/scapy/pull/1795.patch", "merged_at": "2019-01-28T10:25:38Z"}, "body": "- fixes https://github.com/secdev/scapy/issues/1758\r\n- finally make `netflowv9_defragment` something actually good (previous one was terrible \ud83d\ude1e )\r\n- small bug fixes\r\n- tests", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1795/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1795/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1794", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1794/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1794/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1794/events", "html_url": "https://github.com/secdev/scapy/pull/1794", "id": 400031187, "node_id": "MDExOlB1bGxSZXF1ZXN0MjQ1MzE3Njcx", "number": 1794, "title": "Fix *BSD bpf detection", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-01-16T22:43:32Z", "updated_at": "2019-01-17T15:31:35Z", "closed_at": "2019-01-17T11:58:20Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1794", "html_url": "https://github.com/secdev/scapy/pull/1794", "diff_url": "https://github.com/secdev/scapy/pull/1794.diff", "patch_url": "https://github.com/secdev/scapy/pull/1794.patch", "merged_at": "2019-01-17T11:58:20Z"}, "body": "fixes https://github.com/secdev/scapy/issues/1793", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1794/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 1, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1794/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1793", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1793/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1793/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1793/events", "html_url": "https://github.com/secdev/scapy/issues/1793", "id": 399892239, "node_id": "MDU6SXNzdWUzOTk4OTIyMzk=", "number": 1793, "title": "Scapy all import fails on FreeBSD", "user": {"login": "ykvch", "id": 6299601, "node_id": "MDQ6VXNlcjYyOTk2MDE=", "avatar_url": "https://avatars.githubusercontent.com/u/6299601?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ykvch", "html_url": "https://github.com/ykvch", "followers_url": "https://api.github.com/users/ykvch/followers", "following_url": "https://api.github.com/users/ykvch/following{/other_user}", "gists_url": "https://api.github.com/users/ykvch/gists{/gist_id}", "starred_url": "https://api.github.com/users/ykvch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ykvch/subscriptions", "organizations_url": "https://api.github.com/users/ykvch/orgs", "repos_url": "https://api.github.com/users/ykvch/repos", "events_url": "https://api.github.com/users/ykvch/events{/privacy}", "received_events_url": "https://api.github.com/users/ykvch/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-01-16T16:31:51Z", "updated_at": "2019-01-17T11:58:20Z", "closed_at": "2019-01-17T11:58:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "scapy version initially reproduced: 2.4.1\r\nOS: FreeBSD 12\r\n\r\n**Steps:**\r\n1. Run code `from scapy.all import *`\r\n\r\n**Expected:**\r\n1. Modules imported\r\n\r\n**Actual:**  \r\nException:\r\n```\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/home/user/venv/lib/python3.6/site-packages/scapy/all.py\", line 18, in <module>\r\n    from scapy.arch import *\r\n  File \"/home/user/venv/lib/python3.6/site-packages/scapy/arch/__init__.py\", line 63, in <module>\r\n    conf.use_bpf = True\r\n  File \"/home/user/venv/lib/python3.6/site-packages/scapy/config.py\", line 75, in __set__\r\n    self.hook(self.name, val, *self.args, **self.kargs)\r\n  File \"/home/user/venv/lib/python3.6/site-packages/scapy/config.py\", line 491, in _socket_changer\r\n    _set_conf_sockets()\r\n  File \"/home/user/venv/lib/python3.6/site-packages/scapy/config.py\", line 436, in _set_conf_sockets\r\n    raise ScapyInvalidPlatformException(\"Darwin (OSX) only !\")\r\nscapy.error.ScapyInvalidPlatformException: Darwin (OSX) only !\r\n```\r\n\r\n**Note:** probably caused by check here:\r\nhttps://github.com/secdev/scapy/blob/v2.4.1/scapy/config.py#L434\r\nWhich appears to assume that BPF is exclusively used on OSX.\r\n**Note:** FreeBSD (not sure about other *BSD OSes) also uses _/dev/bpf_", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1793/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1793/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1791", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1791/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1791/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1791/events", "html_url": "https://github.com/secdev/scapy/issues/1791", "id": 399745586, "node_id": "MDU6SXNzdWUzOTk3NDU1ODY=", "number": 1791, "title": "Higher latency calculation (using time and sent_time)", "user": {"login": "kpetremann", "id": 13746171, "node_id": "MDQ6VXNlcjEzNzQ2MTcx", "avatar_url": "https://avatars.githubusercontent.com/u/13746171?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kpetremann", "html_url": "https://github.com/kpetremann", "followers_url": "https://api.github.com/users/kpetremann/followers", "following_url": "https://api.github.com/users/kpetremann/following{/other_user}", "gists_url": "https://api.github.com/users/kpetremann/gists{/gist_id}", "starred_url": "https://api.github.com/users/kpetremann/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kpetremann/subscriptions", "organizations_url": "https://api.github.com/users/kpetremann/orgs", "repos_url": "https://api.github.com/users/kpetremann/repos", "events_url": "https://api.github.com/users/kpetremann/events{/privacy}", "received_events_url": "https://api.github.com/users/kpetremann/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 26, "created_at": "2019-01-16T10:35:41Z", "updated_at": "2020-09-04T22:11:51Z", "closed_at": "2019-06-14T12:38:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "## EDIT AS OF 05/09/20: Scapy > 2.4.4 fixes this issue. See https://github.com/secdev/scapy/issues/2277\r\n\r\n#### Brief description\r\n\r\nSince 2.4.1 version of scapy, latency reported is 10 times higher than 2.4.0.\r\n\r\n#### Environment\r\n\r\n-   Scapy version: `Scapy 2.4.0`\r\n-   Python version: `3.4.5`\r\n-   Operating System: `centos 7.4`\r\n\r\n#### How to reproduce\r\n\r\nDestination is internal servers running on Datacenter. So traffic is intra DC.\r\n\r\n```from scapy.all import *\r\n\r\ndest = \"10.0.0.1\"\r\n\r\npkt = []\r\nfor i in range(1,50):\r\n    a = IP(dst=dest) / TCP(flags=\"S\", seq=i, sport=65000, dport=55556)\r\n    pkt.append(a)\r\n\r\nans, unans = sr(pkt, filter=\"host {0}\".format(dest), inter=0, timeout=1)\r\n\r\nprint(\"scapy version: {}\".format(conf.version))\r\n\r\nfor pkt in ans:\r\n    sent = pkt[0]\r\n    received = pkt[1]\r\n    res = (received.time - sent.sent_time) * 1000\r\n    print(res)\r\n\r\n```\r\n\r\n#### Actual result\r\n\r\nThe target is at less than 1ms of latency. Reported the same for traffic between datacenters in different countries.\r\n\r\nExample of results in scapy 2.4.0:\r\n```\r\nBegin emission:\r\n*********************************Finished sending 49 packets.\r\n****************\r\nReceived 49 packets, got 49 answers, remaining 0 packets\r\nscapy version: 2.4.0\r\n4.350900650024414\r\n0.2079010009765625\r\n0.1971721649169922\r\n0.2334117889404297\r\n0.1659393310546875\r\n0.20956993103027344\r\n0.21123886108398438\r\n0.19788742065429688\r\n0.15878677368164062\r\n0.15211105346679688\r\n0.15401840209960938\r\n0.16045570373535156\r\n0.15544891357421875\r\n0.14519691467285156\r\n0.14662742614746094\r\n0.15163421630859375\r\n0.14638900756835938\r\n0.1544952392578125\r\n0.1499652862548828\r\n0.1659393310546875\r\n0.15854835510253906\r\n0.18978118896484375\r\n0.2117156982421875\r\n0.1952648162841797\r\n0.1842975616455078\r\n0.18072128295898438\r\n0.15878677368164062\r\n0.1537799835205078\r\n0.19860267639160156\r\n0.16117095947265625\r\n0.1442432403564453\r\n0.14972686767578125\r\n0.19240379333496094\r\n0.20503997802734375\r\n0.16236305236816406\r\n0.1850128173828125\r\n0.16832351684570312\r\n0.19311904907226562\r\n0.1888275146484375\r\n0.17499923706054688\r\n0.14281272888183594\r\n0.15091896057128906\r\n0.1442432403564453\r\n0.22530555725097656\r\n0.2033710479736328\r\n0.2231597900390625\r\n0.20885467529296875\r\n0.23102760314941406\r\n0.1971721649169922\r\n```\r\n\r\nExample of results in scapy 2.4.2:\r\n```\r\nBegin emission:\r\n************************************Finished sending 49 packets.\r\n*************\r\nReceived 49 packets, got 49 answers, remaining 0 packets\r\nscapy version: 2.4.2\r\n5.141973495483398\r\n4.551172256469727\r\n5.909204483032227\r\n4.38380241394043\r\n8.071660995483398\r\n8.111000061035156\r\n10.76817512512207\r\n11.934280395507812\r\n11.676311492919922\r\n14.704227447509766\r\n15.71202278137207\r\n15.697956085205078\r\n16.704320907592773\r\n15.500307083129883\r\n15.828371047973633\r\n17.41957664489746\r\n17.516613006591797\r\n16.1285400390625\r\n17.355918884277344\r\n17.473220825195312\r\n19.101381301879883\r\n20.766496658325195\r\n19.442319869995117\r\n18.988847732543945\r\n19.248485565185547\r\n19.159793853759766\r\n20.247936248779297\r\n21.417856216430664\r\n23.09250831604004\r\n25.787830352783203\r\n27.456998825073242\r\n28.298139572143555\r\n29.371976852416992\r\n29.3734073638916\r\n29.6783447265625\r\n29.912233352661133\r\n29.05869483947754\r\n28.344154357910156\r\n26.66330337524414\r\n25.910377502441406\r\n24.534940719604492\r\n23.717164993286133\r\n22.020816802978516\r\n21.22044563293457\r\n19.37270164489746\r\n17.622709274291992\r\n15.846014022827148\r\n13.768911361694336\r\n11.74163818359375\r\n\r\n```", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1791/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1791/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1774", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1774/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1774/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1774/events", "html_url": "https://github.com/secdev/scapy/pull/1774", "id": 397337284, "node_id": "MDExOlB1bGxSZXF1ZXN0MjQzMzA2NDE0", "number": 1774, "title": "Fix (Ether() / ARP()).show()", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-01-09T11:53:01Z", "updated_at": "2019-01-09T13:40:55Z", "closed_at": "2019-01-09T13:27:12Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1774", "html_url": "https://github.com/secdev/scapy/pull/1774", "diff_url": "https://github.com/secdev/scapy/pull/1774.diff", "patch_url": "https://github.com/secdev/scapy/pull/1774.patch", "merged_at": "2019-01-09T13:27:12Z"}, "body": "Bug introduced in 435918e3d8e95b7374fadd8c6d962ee9b5032fcb\r\n\r\nTest added.\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1774/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1774/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1772", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1772/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1772/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1772/events", "html_url": "https://github.com/secdev/scapy/pull/1772", "id": 396286267, "node_id": "MDExOlB1bGxSZXF1ZXN0MjQyNTEyMDU4", "number": 1772, "title": "Fix ASN1_BIT_STRING", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1000112749, "node_id": "MDU6TGFiZWwxMDAwMTEyNzQ5", "url": "https://api.github.com/repos/secdev/scapy/labels/cleanup", "name": "cleanup", "color": "FF68F6", "default": false, "description": "Performs some code clean-up"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-01-06T19:22:58Z", "updated_at": "2019-02-06T16:52:21Z", "closed_at": "2019-02-06T16:49:26Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1772", "html_url": "https://github.com/secdev/scapy/pull/1772", "diff_url": "https://github.com/secdev/scapy/pull/1772.diff", "patch_url": "https://github.com/secdev/scapy/pull/1772.patch", "merged_at": "2019-02-06T16:49:26Z"}, "body": "- fixes #1761\r\n- fixes #1765\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1772/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1772/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1761", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1761/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1761/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1761/events", "html_url": "https://github.com/secdev/scapy/issues/1761", "id": 394024071, "node_id": "MDU6SXNzdWUzOTQwMjQwNzE=", "number": 1761, "title": "ASN1_BIT_STRING : return value of __bytes__() is incorrect", "user": {"login": "ziffusion", "id": 341389, "node_id": "MDQ6VXNlcjM0MTM4OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/341389?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ziffusion", "html_url": "https://github.com/ziffusion", "followers_url": "https://api.github.com/users/ziffusion/followers", "following_url": "https://api.github.com/users/ziffusion/following{/other_user}", "gists_url": "https://api.github.com/users/ziffusion/gists{/gist_id}", "starred_url": "https://api.github.com/users/ziffusion/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ziffusion/subscriptions", "organizations_url": "https://api.github.com/users/ziffusion/orgs", "repos_url": "https://api.github.com/users/ziffusion/repos", "events_url": "https://api.github.com/users/ziffusion/events{/privacy}", "received_events_url": "https://api.github.com/users/ziffusion/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-12-25T14:01:45Z", "updated_at": "2019-02-06T16:49:26Z", "closed_at": "2019-02-06T16:49:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nASN1_BIT_STRING.\\_\\_bytes__() and ASN1_BIT_STRING.\\_\\_str__() should return BER encoded TLV, but returns self.val_readable instead.\r\n\r\nCompare with behavior of ASN1_BOOLEAN.\\_\\_bytes__() and ASN1_BOOLEAN.\\_\\_str__().\r\n\r\n#### Environment\r\n\r\n-   Scapy version: `Version 2.4.0.dev650 03f4176ab711fbf5e49e905cd285f7df7913f105`\r\n-   Python version: `2.7.15rc1`\r\n-   Operating System: `Linux 4.15.0-43-generic`\r\n\r\n#### How to reproduce\r\n\\>>> a = ASN1_BIT_STRING(\"10101\", \"value\")\r\n\\>>> raw(a)\r\n\\>>> str(a)\r\n\\>>> a = ASN1_BOOLEAN(1)\r\n\\>>> raw(a)\r\n\\>>> str(a)\r\n\r\n#### Actual result\r\n'10101'\r\n'10101'\r\n'\\x01\\x01\\x00'  \r\n'\\x01\\x01\\x00'                             ..\r\n\r\n#### Expected result\r\n'\\x03\\x06\\x0010101'\r\n'\\x03\\x06\\x0010101'\r\n'\\x01\\x01\\x00'\r\n'\\x01\\x01\\x00'    \r\n\r\n#### Suggestion\r\nRemove \\_\\_bytes__() and \\_\\_str__() from ASN1_BIT_STRING. Use inherited one from the base ASN1_Object.\r\nOr I can send a pull request.\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1761/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1761/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1758", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1758/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1758/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1758/events", "html_url": "https://github.com/secdev/scapy/issues/1758", "id": 393775083, "node_id": "MDU6SXNzdWUzOTM3NzUwODM=", "number": 1758, "title": "netflow v9 DataFlowSet length with padding", "user": {"login": "preet", "id": 144571, "node_id": "MDQ6VXNlcjE0NDU3MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/144571?v=4", "gravatar_id": "", "url": "https://api.github.com/users/preet", "html_url": "https://github.com/preet", "followers_url": "https://api.github.com/users/preet/followers", "following_url": "https://api.github.com/users/preet/following{/other_user}", "gists_url": "https://api.github.com/users/preet/gists{/gist_id}", "starred_url": "https://api.github.com/users/preet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/preet/subscriptions", "organizations_url": "https://api.github.com/users/preet/orgs", "repos_url": "https://api.github.com/users/preet/repos", "events_url": "https://api.github.com/users/preet/events{/privacy}", "received_events_url": "https://api.github.com/users/preet/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2018-12-23T19:28:37Z", "updated_at": "2019-01-28T10:25:38Z", "closed_at": "2019-01-28T10:25:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "The current implementation of NetflowDataflowsetV9 in the netflow layer does not seem to take padding bytes into account as is recommended by the spec (https://www.ietf.org/rfc/rfc3954.txt):\r\n\r\n>    Padding\r\n>          The Exporter SHOULD insert some padding bytes so that the\r\n>          subsequent FlowSet starts at a 4-byte aligned boundary.  It is\r\n>          important to note that the Length field includes the padding\r\n>          bytes.  Padding SHOULD be using zeros.\r\n\r\nIn scapy/layers/netflow.py:\r\n```python\r\nclass NetflowDataflowsetV9(Packet):\r\n    name = \"Netflow DataFlowSet V9\"\r\n    fields_desc = [ShortField(\"templateID\", 255),\r\n                   FieldLenField(\"length\", None, length_of=\"records\", adjust=lambda pkt, x:x + 4),  # noqa: E501\r\n                   PadField(PacketListField(\"records\", [], NetflowRecordV9,\r\n                                            length_from=lambda pkt: pkt.length - 4),  # noqa: E501\r\n4, padwith=b\"\\x00\")]\r\n```\r\n\r\nI'm not sure what the best way to set the length to include padding bytes is. I think one way is to set the 'adjust' function in FieldLenField to be something like:\r\n\r\n```python\r\ndef adj_len(pkt, x):\r\n    x += 4\r\n    if (x % 4) > 0:\r\n        x = (x/4 + 1)*4\r\n    return x\r\n```", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1758/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1758/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1755", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1755/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1755/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1755/events", "html_url": "https://github.com/secdev/scapy/pull/1755", "id": 393678400, "node_id": "MDExOlB1bGxSZXF1ZXN0MjQwNjM4MzAw", "number": 1755, "title": "DADict: improvement + fix Manuf format", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1000112749, "node_id": "MDU6TGFiZWwxMDAwMTEyNzQ5", "url": "https://api.github.com/repos/secdev/scapy/labels/cleanup", "name": "cleanup", "color": "FF68F6", "default": false, "description": "Performs some code clean-up"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-12-22T14:39:35Z", "updated_at": "2018-12-27T22:48:58Z", "closed_at": "2018-12-27T19:13:09Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1755", "html_url": "https://github.com/secdev/scapy/pull/1755", "diff_url": "https://github.com/secdev/scapy/pull/1755.diff", "patch_url": "https://github.com/secdev/scapy/pull/1755.patch", "merged_at": "2018-12-27T19:13:09Z"}, "body": "This PR:\r\n- fixes MANUF format\r\n- cleanup DADict\r\n\r\nfixes https://github.com/secdev/scapy/issues/1754", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1755/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1755/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1754", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1754/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1754/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1754/events", "html_url": "https://github.com/secdev/scapy/issues/1754", "id": 393414730, "node_id": "MDU6SXNzdWUzOTM0MTQ3MzA=", "number": 1754, "title": "Wireshark updated the format of manuf", "user": {"login": "fishilico", "id": 1040594, "node_id": "MDQ6VXNlcjEwNDA1OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1040594?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fishilico", "html_url": "https://github.com/fishilico", "followers_url": "https://api.github.com/users/fishilico/followers", "following_url": "https://api.github.com/users/fishilico/following{/other_user}", "gists_url": "https://api.github.com/users/fishilico/gists{/gist_id}", "starred_url": "https://api.github.com/users/fishilico/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fishilico/subscriptions", "organizations_url": "https://api.github.com/users/fishilico/orgs", "repos_url": "https://api.github.com/users/fishilico/repos", "events_url": "https://api.github.com/users/fishilico/events{/privacy}", "received_events_url": "https://api.github.com/users/fishilico/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-12-21T10:51:32Z", "updated_at": "2018-12-27T19:13:09Z", "closed_at": "2018-12-27T19:13:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\nCurrently, scapy (2.4.0 and master) does not load the long name of manufacturers from `/usr/share/wireshark/manuf`. This is caused by Wireshark commit https://github.com/wireshark/wireshark/commit/274bbd5fab970c5a2048f9d00bb4e441cd68d04a#diff-f053a42108c73528b4e5e3957e94893e , which changed the format of this file from `prefix shortName # long name` to `prefix shortName long name`.\r\n\r\nCould you please update function `load_manuf` in order to support this new format? The current implementation is: https://github.com/secdev/scapy/blob/ae348f8611529fe20dcd703e2bd37f20322c4535/scapy/data.py#L214-L232", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1754/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1754/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1746", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1746/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1746/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1746/events", "html_url": "https://github.com/secdev/scapy/issues/1746", "id": 391617112, "node_id": "MDU6SXNzdWUzOTE2MTcxMTI=", "number": 1746, "title": "Version comparison not tolerant for development package version.", "user": {"login": "mmajche", "id": 45933866, "node_id": "MDQ6VXNlcjQ1OTMzODY2", "avatar_url": "https://avatars.githubusercontent.com/u/45933866?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mmajche", "html_url": "https://github.com/mmajche", "followers_url": "https://api.github.com/users/mmajche/followers", "following_url": "https://api.github.com/users/mmajche/following{/other_user}", "gists_url": "https://api.github.com/users/mmajche/gists{/gist_id}", "starred_url": "https://api.github.com/users/mmajche/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mmajche/subscriptions", "organizations_url": "https://api.github.com/users/mmajche/orgs", "repos_url": "https://api.github.com/users/mmajche/repos", "events_url": "https://api.github.com/users/mmajche/events{/privacy}", "received_events_url": "https://api.github.com/users/mmajche/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-12-17T09:10:15Z", "updated_at": "2019-01-18T15:49:38Z", "closed_at": "2019-01-18T15:49:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "https://github.com/secdev/scapy/blob/0cd9b58d04b9c2ec7b65c9e8f73a89d095c39913/scapy/config.py#L368\r\nIt results in following error: ` ValueError: invalid literal for int() with base 10: ''` when used for package with not standardized version, such as `2.4.dev0` because splitting by \".\" returns last element as an empty string: `''`. One way of fixing that is by adding `version_tags = filter(None, version_tags)` before mentioned line, but I am not sure if it's right thing to do as I am not fluent in regular expressions, maybe it could be altered instead.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1746/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1746/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1727", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1727/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1727/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1727/events", "html_url": "https://github.com/secdev/scapy/issues/1727", "id": 386650437, "node_id": "MDU6SXNzdWUzODY2NTA0Mzc=", "number": 1727, "title": "IndexError on import in NetworkInterfaceDict.load_from_powershell() arch/windows", "user": {"login": "jimmbelll", "id": 6282184, "node_id": "MDQ6VXNlcjYyODIxODQ=", "avatar_url": "https://avatars.githubusercontent.com/u/6282184?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jimmbelll", "html_url": "https://github.com/jimmbelll", "followers_url": "https://api.github.com/users/jimmbelll/followers", "following_url": "https://api.github.com/users/jimmbelll/following{/other_user}", "gists_url": "https://api.github.com/users/jimmbelll/gists{/gist_id}", "starred_url": "https://api.github.com/users/jimmbelll/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jimmbelll/subscriptions", "organizations_url": "https://api.github.com/users/jimmbelll/orgs", "repos_url": "https://api.github.com/users/jimmbelll/repos", "events_url": "https://api.github.com/users/jimmbelll/events{/privacy}", "received_events_url": "https://api.github.com/users/jimmbelll/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-12-03T03:57:50Z", "updated_at": "2018-12-03T21:42:31Z", "closed_at": "2018-12-03T21:30:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "My environment produced https://github.com/secdev/scapy/issues/1718\r\n\r\nTrying the latest commit. I now get this crash.\r\n\r\n```\r\n>>> from scapy.all import *\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"scapy\\all.py\", line 18, in <module>\r\n    from scapy.arch import *\r\n  File \"scapy\\arch\\__init__.py\", line 73, in <module>\r\n    from scapy.arch.windows import *  # noqa F403\r\n  File \"scapy\\arch\\windows\\__init__.py\", line 953, in <module>\r\n    IFACES.load_from_powershell()\r\n  File \"scapy\\arch\\windows\\__init__.py\", line 843, in load_from_powershell\r\n    interface.ip = ifaces_ips.get(interface.name, \"\")[0]\r\nIndexError: string index out of range\r\n```\r\n\r\n#### Environment\r\n\r\nWindows 7\r\nSee: https://github.com/secdev/scapy/issues/1718\r\n\r\n\r\n#### Detail\r\n\r\nI think that line 843 should have a different default, since it's looking for an interface name that's not in ifaces_ips and I think shouldn't be:\r\n```\r\n    interface.ip = ifaces_ips.get(interface.name, [\"\"])[0]\r\n```\r\n\r\n**With this change, the import works and show_interfaces() returns what appears to be correct.**\r\n\r\nRelevant values at this point in the code: \r\n\r\nifaces_ips: {'Realtek PCIe GBE Family Controller': ['10.0.0.2'], 'VMware Virtual Ethe\r\nrnet Adapter for VMnet8': ['192.168.171.1'], 'TAP-Windows Adapter V9': ['172.21.\r\n30.100'], 'VMware Virtual Ethernet Adapter for VMnet1': ['192.168.234.1'], 'Micr\r\nosoft Loopback Adapter': ['127.0.0.1'], 'Intel(R) PRO/1000 GT Desktop Adapter':\r\n['192.168.0.240']}\r\n\r\ninterface: {'name': 'Bluetooth Device (Personal Area Network)', 'netid': 'Bluetooth Network\r\n Connection', 'mac': '5C:F3:70:7E:01:85', 'win_index': '24', 'guid': '{F9E79680-\r\nC325-4D94-B8EC-1425C940D457}', 'description': ''}\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1727/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1727/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1725", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1725/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1725/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1725/events", "html_url": "https://github.com/secdev/scapy/pull/1725", "id": 386584844, "node_id": "MDExOlB1bGxSZXF1ZXN0MjM1Mjc1MjIy", "number": 1725, "title": "Better handling of cropped lines in PS", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-12-02T18:18:51Z", "updated_at": "2018-12-02T22:40:54Z", "closed_at": "2018-12-02T21:52:57Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1725", "html_url": "https://github.com/secdev/scapy/pull/1725", "diff_url": "https://github.com/secdev/scapy/pull/1725.diff", "patch_url": "https://github.com/secdev/scapy/pull/1725.patch", "merged_at": "2018-12-02T21:52:57Z"}, "body": "fixes https://github.com/secdev/scapy/issues/1718", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1725/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1725/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1722", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1722/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1722/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1722/events", "html_url": "https://github.com/secdev/scapy/pull/1722", "id": 386545712, "node_id": "MDExOlB1bGxSZXF1ZXN0MjM1MjQ5NzQ4", "number": 1722, "title": "commit cabeb broke dissection of some real DNS payloads", "user": {"login": "LRGH", "id": 7622014, "node_id": "MDQ6VXNlcjc2MjIwMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/7622014?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LRGH", "html_url": "https://github.com/LRGH", "followers_url": "https://api.github.com/users/LRGH/followers", "following_url": "https://api.github.com/users/LRGH/following{/other_user}", "gists_url": "https://api.github.com/users/LRGH/gists{/gist_id}", "starred_url": "https://api.github.com/users/LRGH/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LRGH/subscriptions", "organizations_url": "https://api.github.com/users/LRGH/orgs", "repos_url": "https://api.github.com/users/LRGH/repos", "events_url": "https://api.github.com/users/LRGH/events{/privacy}", "received_events_url": "https://api.github.com/users/LRGH/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-12-02T10:10:08Z", "updated_at": "2018-12-05T18:41:31Z", "closed_at": "2018-12-05T18:41:04Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1722", "html_url": "https://github.com/secdev/scapy/pull/1722", "diff_url": "https://github.com/secdev/scapy/pull/1722.diff", "patch_url": "https://github.com/secdev/scapy/pull/1722.patch", "merged_at": "2018-12-05T18:41:04Z"}, "body": "Fixes a bug introduced by commit cabeb471c57dc501ffb2e002be2272cc8d9a4f96\r\nI have reverted the modification introduced by this commit (but kept the new variable names, which did not break anything)\r\nI have added a non-regression test with a DNS payload captured on my network.\r\nI have removed a non-regression test that does not correspond to a real DNS payload.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1722/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1722/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1718", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1718/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1718/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1718/events", "html_url": "https://github.com/secdev/scapy/issues/1718", "id": 385373870, "node_id": "MDU6SXNzdWUzODUzNzM4NzA=", "number": 1718, "title": "IndexError on import in _exec_query_ps() for interface description with newline", "user": {"login": "jimmbelll", "id": 6282184, "node_id": "MDQ6VXNlcjYyODIxODQ=", "avatar_url": "https://avatars.githubusercontent.com/u/6282184?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jimmbelll", "html_url": "https://github.com/jimmbelll", "followers_url": "https://api.github.com/users/jimmbelll/followers", "following_url": "https://api.github.com/users/jimmbelll/following{/other_user}", "gists_url": "https://api.github.com/users/jimmbelll/gists{/gist_id}", "starred_url": "https://api.github.com/users/jimmbelll/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jimmbelll/subscriptions", "organizations_url": "https://api.github.com/users/jimmbelll/orgs", "repos_url": "https://api.github.com/users/jimmbelll/repos", "events_url": "https://api.github.com/users/jimmbelll/events{/privacy}", "received_events_url": "https://api.github.com/users/jimmbelll/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-11-28T17:17:35Z", "updated_at": "2018-12-03T04:11:38Z", "closed_at": "2018-12-02T21:52:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "`from scapy.all import *`  fails with:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"<string>\", line 1, in <module>\r\n  File \"scapy\\all.py\", line 18, in <module>\r\n    from scapy.arch import *\r\n  File \"scapy\\arch\\__init__.py\", line 73, in <module>\r\n    from scapy.arch.windows import *  # noqa F403\r\n  File \"scapy\\arch\\windows\\__init__.py\", line 946, in <module>\r\n    IFACES.load_from_powershell()\r\n  File \"scapy\\arch\\windows\\__init__.py\", line 834, in load_from_powershell\r\n    ifaces_ips = get_ips()\r\n  File \"scapy\\arch\\windows\\__init__.py\", line 544, in get_ips\r\n    ['Description', 'IPAddress']):\r\n  File \"scapy\\arch\\windows\\__init__.py\", line 243, in _exec_query_ps\r\n    lines[-1] += sl[0].strip()\r\nIndexError: list index out of range\r\n\r\n```\r\nThe lines list is empty, raising the IndexError.\r\n\r\n#### Environment\r\n\r\n-   Scapy version: latest master (zip) pulled today (2018-11-28)\r\n-   Python version: `2.7.15`\r\n-   Operating System: `Windows 7: platform.platform() == 'Windows-7-6.1.7601-SP1'`\r\n-   Powershell `$PSVersionTable.PSVersion`\r\n```\r\nMajor  Minor  Build  Revision\r\n-----  -----  -----  --------\r\n2      0      -1     -1\r\n```\r\n\r\n#### Detail\r\nAt the iteration raising IndexError, local variable `line` is `\"for Windows x64\"`. The previous line of windows powershell output has already yielded `['', 'Cisco AnyConnect Secure Mobility Client Virtual Miniport Adapter']`  on row 248 and cleared `lines` on row 249.\r\n\r\nOddly enough, the powershell command being sent:\r\n```\r\nGet-WmiObject Win32_NetworkAdapterConfiguration | select Description, IPAddress | fl | out-string -Width 4096\r\n```\r\nseems not produce a newline here.\r\n\r\n> ...\r\n> Description : Cisco AnyConnect Secure Mobility Client Virtual Miniport Adapter for Windows x64\r\n> IPAddress   :\r\n> ...\r\n> \r\n\r\nThis fix seems to work: replace row 243 `lines[-1] += sl[0].strip()` with `if lines: lines[-1] += sl[0].strip()`\r\n\r\n\r\n#### See Also\r\nhttps://github.com/secdev/scapy/issues/400\r\nhttps://github.com/secdev/scapy/issues/781\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1718/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1718/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1710", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1710/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1710/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1710/events", "html_url": "https://github.com/secdev/scapy/pull/1710", "id": 382536282, "node_id": "MDExOlB1bGxSZXF1ZXN0MjMyMjE4Mzky", "number": 1710, "title": "PPP: protocol field can be limited to one byte", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1000112749, "node_id": "MDU6TGFiZWwxMDAwMTEyNzQ5", "url": "https://api.github.com/repos/secdev/scapy/labels/cleanup", "name": "cleanup", "color": "FF68F6", "default": false, "description": "Performs some code clean-up"}], "state": "closed", "locked": false, "assignee": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-11-20T07:37:53Z", "updated_at": "2018-11-20T15:23:59Z", "closed_at": "2018-11-20T15:14:43Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1710", "html_url": "https://github.com/secdev/scapy/pull/1710", "diff_url": "https://github.com/secdev/scapy/pull/1710.diff", "patch_url": "https://github.com/secdev/scapy/pull/1710.patch", "merged_at": "2018-11-20T15:14:43Z"}, "body": "This bug has been reported by @yeoman313 on Gitter.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1710/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1710/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1674", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1674/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1674/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1674/events", "html_url": "https://github.com/secdev/scapy/issues/1674", "id": 376200799, "node_id": "MDU6SXNzdWUzNzYyMDA3OTk=", "number": 1674, "title": "VXLAN Binding to IPv6 or IPv4 doesn't work", "user": {"login": "RodolfoPiedraC", "id": 23481669, "node_id": "MDQ6VXNlcjIzNDgxNjY5", "avatar_url": "https://avatars.githubusercontent.com/u/23481669?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RodolfoPiedraC", "html_url": "https://github.com/RodolfoPiedraC", "followers_url": "https://api.github.com/users/RodolfoPiedraC/followers", "following_url": "https://api.github.com/users/RodolfoPiedraC/following{/other_user}", "gists_url": "https://api.github.com/users/RodolfoPiedraC/gists{/gist_id}", "starred_url": "https://api.github.com/users/RodolfoPiedraC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RodolfoPiedraC/subscriptions", "organizations_url": "https://api.github.com/users/RodolfoPiedraC/orgs", "repos_url": "https://api.github.com/users/RodolfoPiedraC/repos", "events_url": "https://api.github.com/users/RodolfoPiedraC/events{/privacy}", "received_events_url": "https://api.github.com/users/RodolfoPiedraC/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2018-10-31T23:42:54Z", "updated_at": "2018-11-20T19:53:26Z", "closed_at": "2018-11-20T19:53:26Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "#### Brief description\r\nWhen doing a VXLAN()/IP or VXLAN()/IPv6 the binding does not work properly. Both IP layers are interpreted as Ethernet Layers.\r\n\r\n#### Environment\r\n\r\n-   Scapy version: `2.4.0`\r\n-   Python version: `3.5.2`\r\n-   Operating System: `Ubuntu 16.04`\r\n\r\n#### How to reproduce\r\n```python\r\n>>> issue = Ether()/IP()/UDP()/VXLAN(flags=4, NextProtocol=1)/IP()\r\n>>> issue.show2()\r\n###[ Ethernet ]### \r\n  dst= ff:ff:ff:ff:ff:ff\r\n  src= 00:00:00:00:00:00\r\n  type= 0x800\r\n###[ IP ]### \r\n     version= 4\r\n     ihl= 5\r\n     tos= 0x0\r\n     len= 56\r\n     id= 1\r\n     flags= \r\n     frag= 0\r\n     ttl= 64\r\n     proto= udp\r\n     chksum= 0x7cb2\r\n     src= 127.0.0.1\r\n     dst= 127.0.0.1\r\n     \\options\\\r\n###[ UDP ]### \r\n        sport= 4789\r\n        dport= 4789\r\n        len= 36\r\n        chksum= 0xd838\r\n###[ VXLAN ]### \r\n           flags= NextProtocol\r\n           reserved0= 0\r\n           NextProtocol= IPv4\r\n           vni= 0x0\r\n           reserved2= 0x0\r\n###[ Ethernet ]### \r\n              dst= 45:00:00:14:00:01\r\n              src= 00:00:40:00:7c:e7\r\n              type= 0x7f00\r\n###[ Raw ]### \r\n                 load= '\\x00\\x01\\x7f\\x00\\x00\\x01'\r\n```\r\n\r\n#### Actual result\r\n```python\r\n###[ Ethernet ]### \r\n  dst= ff:ff:ff:ff:ff:ff\r\n  src= 00:00:00:00:00:00\r\n  type= 0x800\r\n###[ IP ]### \r\n     version= 4\r\n     ihl= 5\r\n     tos= 0x0\r\n     len= 56\r\n     id= 1\r\n     flags= \r\n     frag= 0\r\n     ttl= 64\r\n     proto= udp\r\n     chksum= 0x7cb2\r\n     src= 127.0.0.1\r\n     dst= 127.0.0.1\r\n     \\options\\\r\n###[ UDP ]### \r\n        sport= 4789\r\n        dport= 4789\r\n        len= 36\r\n        chksum= 0xd838\r\n###[ VXLAN ]### \r\n           flags= NextProtocol\r\n           reserved0= 0\r\n           NextProtocol= IPv4\r\n           vni= 0x0\r\n           reserved2= 0x0\r\n###[ Ethernet ]### \r\n              dst= 45:00:00:14:00:01\r\n              src= 00:00:40:00:7c:e7\r\n              type= 0x7f00\r\n###[ Raw ]### \r\n                 load= '\\x00\\x01\\x7f\\x00\\x00\\x01'\r\n```\r\n\r\n#### Expected result\r\n```python\r\n###[ Ethernet ]### \r\n  dst= ff:ff:ff:ff:ff:ff\r\n  src= 00:00:00:00:00:00\r\n  type= 0x800\r\n###[ IP ]### \r\n     version= 4\r\n     ihl= 5\r\n     tos= 0x0\r\n     len= 56\r\n     id= 1\r\n     flags= \r\n     frag= 0\r\n     ttl= 64\r\n     proto= udp\r\n     chksum= 0x7cb2\r\n     src= 127.0.0.1\r\n     dst= 127.0.0.1\r\n     \\options\\\r\n###[ UDP ]### \r\n        sport= 4789\r\n        dport= 4789\r\n        len= 36\r\n        chksum= 0xd838\r\n###[ VXLAN ]### \r\n           flags= NextProtocol\r\n           reserved0= 0\r\n           NextProtocol= IPv4\r\n           vni= 0x0\r\n           reserved2= 0x0\r\n###[ IP ]### \r\n              version= 4\r\n              ihl= 5\r\n              tos= 0x0\r\n              len= 20\r\n              id= 1\r\n              flags= \r\n              frag= 0\r\n              ttl= 64\r\n              proto= hopopt\r\n              chksum= 0x7ce7\r\n              src= 127.0.0.1\r\n              dst= 127.0.0.1\r\n              \\options\\\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1674/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1674/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1668", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1668/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1668/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1668/events", "html_url": "https://github.com/secdev/scapy/issues/1668", "id": 374527193, "node_id": "MDU6SXNzdWUzNzQ1MjcxOTM=", "number": 1668, "title": "Unable to parse TLS 1.3 Server Hello", "user": {"login": "bbayles", "id": 1922815, "node_id": "MDQ6VXNlcjE5MjI4MTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1922815?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bbayles", "html_url": "https://github.com/bbayles", "followers_url": "https://api.github.com/users/bbayles/followers", "following_url": "https://api.github.com/users/bbayles/following{/other_user}", "gists_url": "https://api.github.com/users/bbayles/gists{/gist_id}", "starred_url": "https://api.github.com/users/bbayles/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bbayles/subscriptions", "organizations_url": "https://api.github.com/users/bbayles/orgs", "repos_url": "https://api.github.com/users/bbayles/repos", "events_url": "https://api.github.com/users/bbayles/events{/privacy}", "received_events_url": "https://api.github.com/users/bbayles/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1317786288, "node_id": "MDU6TGFiZWwxMzE3Nzg2Mjg4", "url": "https://api.github.com/repos/secdev/scapy/labels/tls", "name": "tls", "color": "56088e", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2018-10-26T19:59:01Z", "updated_at": "2019-07-25T08:16:35Z", "closed_at": "2019-07-25T08:16:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "I found that I wasn't able to parse a Server Hello from the TLS 1.3 testing site https://enabled.tls13.com/ with the current development version of scapy (87916fda3b7d2de503cafd81623d0a7814ba5679 , Python 3, Linux).\r\n\r\n---\r\n\r\nHere's a snippet that reproduces the issue:\r\n\r\n<details><summary>Code to reproduce</summary>\r\n\r\n```python\r\nfrom scapy.all import load_layer\r\nload_layer('tls')\r\n\r\ndata = bytes.fromhex(\r\n    '160303007a02000076030354d872a960290781a55827539ab607abe2ba8db77a212053ad'\r\n    '7e98c92598ba462033d562b393540c7520405833f06e8c84d0dfb0e8e09f2ea9d4e7b854'\r\n    '81b989ac130100002e00330024001d0020100b726fd77a0fd0e6a00228579d5e649f4105'\r\n    '1a9b2b59f5afb09fe72f793410002b000203041403030001011703030943359c1d734183'\r\n    '288f4c6141d07109241fde952af155d9b6162cf0db7a890322b650f66c54212d93d9bf2f'\r\n    'ac78bb2872e29a89b6ff3ef85d777f3dcb773ccaed62900908a2d310903cf22897d97ed9'\r\n    'e175596d78d4beb061ac6ed885f165ed443696c0ee6d9b5116ed09237e3f5beda2c1ff9f'\r\n    'f33e755ad84450ae9cf7763d3c6aec98eb6dff9c9753cb5a0c60d6f7b20bb7a45ae1e639'\r\n    'ae8a07c73db8db26b37c992f4d4ea7bec54715b696b463dbd5904b6d38bf69f9b4379d2a'\r\n    'bc101cdd5da07a21e4b1913ef5484c3d9b61b5c0abe6cb6dbaa9fbee0a81a4b3bd2aa744'\r\n    '9a4d3127f137b42191a635d8ec2b09a48f659656dae6ed246c1d8d9c8fced1b2a0a610d3'\r\n    '124410f32e9a4000b451a28ca3f1c02f705466bf8f6356cdec497471d78e4f785379ec71'\r\n    '468e8ac9dbce8bb29d249030929f4442003e3a67d4581d97f540e3309a2d8b3eb84b36ca'\r\n    'e9f9e78fb14e5401ff57cdcae2029e62875bc9d5bd9140ce8fae77dbf54495ef4cb4a0af'\r\n    'f591ad6f69eafab106db663adcc183722b62f03b1e273d17438a18be0880fab1c443d7b6'\r\n    '4746f33a5c57bf8f8ac3881ad47400b40f9d1b27e0c86012f2d3b18a5555610e772d3b51'\r\n    '711f591eaa1d5a6826a6390caa537d7db9511c208b668ea88b88c578a5b85cd8862e22b1'\r\n    '7b535156bd9093315b9cd0b47f76f1193d6e27440486dce42316dd342d942aad68e4b35e'\r\n    '31cf7a272a50a35f9fa00dc8f700a2ca981a32757dfa2a1ba0778c3308229e96b74ae350'\r\n    '751945c0286d35924b79763835a4bd05e8a6d2a632fff649615c8d8a1f73ad39b5c3478b'\r\n    'b6b4b4b6b21f26f4526ce710148d2ec37125de1ad72bada016c92c438a2d404a2ed0d246'\r\n    '21606509b8736cd3f99e387667dd23e15d56dc7ffbc3ec61825af7f08d633c7740655ea9'\r\n    '8fb0587a800fc74951b0a28b1724215c877a58a3f9b164edfd09b84508d8b3620413cdcc'\r\n    '2f88be147ff5c393fd2322b516547aae2e6dfcdd7d5ea36ef12b4f11c57c99ccde69d84a'\r\n    '3e08c85f57e1c907b1d9ba2cb011b05a518471d6484d5caddbb34070a7b720d561dec167'\r\n    '1f623e7f16f99897b7bc3f08f24ab00ece158e4bef897d3aca77d87c7fef27dd736fcd6c'\r\n    '8f0cfa7e42db6722bed9d88015afbe5ccdf4d17ce76122971fa4270d443eab4046724d79'\r\n    '1fca2355ca5aeba11f6881c05d4e47b55023aec41d297f744f2b0c23fe02ad1c245ebc78'\r\n    '972e3f6da0792911c793d0132327761e68758c3b5ce49f834de08e46c2c0284ffa2c7c6c'\r\n    '1ec20edfecd04872adba4bf046698e62361235ffc91738f7933bb7dbb65e6d206e747e9e'\r\n    'da02ddfcb1576a55c4a876df38b283aeb9cc965af8e67afa3bc19a66d208ee7fb1018f04'\r\n    '77ad6920bbafe294eb492c86af594adcef0b238a46f11f7c0e3a9c4b8f8db2feb8566f3f'\r\n    '87d9280a03b040fed551ebfeec95a6b7a163f043a209c16571893d61081afb797f3dff90'\r\n    'cd1261b086f64d2bbaaf80eff511d3b40549389d288827f758a620bf2dd7cd1e7ac1fa1d'\r\n    '08810fa595b12204286109b34b662d81759e6b36b300b56bb866b6bc4f9bc725f06d3aa2'\r\n)\r\nparsed = TLS(data)\r\nrepresentation = parsed.show()\r\nprint(representation)\r\n```\r\n\r\n</details>\r\n\r\n---\r\n\r\nWireshark knows that the first part of this is a Server Hello Handshake:\r\n\r\n![image](https://user-images.githubusercontent.com/1922815/47589626-50609f80-d92f-11e8-9e9c-3ad3b1959a4f.png)\r\n\r\nUnfortunately, Scapy doesn't:\r\n\r\n```\r\n###[ TLS ]### \r\n  type      = application_data\r\n  version   = TLS 1.2\r\n  len       = 122\r\n  iv        = b''\r\n  \\msg       \\\r\n   |###[ Raw ]### \r\n   |  load      = \"\\x02\\x00\\x00v\\x03\\x03T\\xd8r\\xa9`)\\x07\\x81\\xa5X'S\\x9a\\xb6\\x07\\xab\\xe2\\xba\\x8d\\xb7z! S\\xad~\\x98\\xc9%\\x98\\xbaF 3\\xd5b\\xb3\\x93T\\x0cu @X3\\xf0n\\x8c\\x84\\xd0\\xdf\\xb0\\xe8\\xe0\\x9f.\\xa9\\xd4\\xe7\\xb8T\\x81\\xb9\\x89\\xac\\x13\\x01\\x00\\x00.\\x003\\x00$\\x00\\x1d\\x00 \\x10\\x0bro\\xd7z\\x0f\\xd0\\xe6\\xa0\\x02(W\\x9d^d\\x9fA\\x05\\x1a\\x9b+Y\\xf5\\xaf\\xb0\\x9f\\xe7/y4\\x10\\x00+\\x00\\x02\\x03\\x04\"\r\n  mac       = b''\r\n  pad       = b''\r\n  padlen    = None\r\n```\r\n\r\nIt's getting the `version` and `len`, but not recognizing anything past that.\r\n\r\n---\r\n\r\nI can provide other captures if it helps?", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1668/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1668/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1659", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1659/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1659/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1659/events", "html_url": "https://github.com/secdev/scapy/issues/1659", "id": 373493228, "node_id": "MDU6SXNzdWUzNzM0OTMyMjg=", "number": 1659, "title": "[Travis] flake8 was updated to 3.6.0", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 875741964, "node_id": "MDU6TGFiZWw4NzU3NDE5NjQ=", "url": "https://api.github.com/repos/secdev/scapy/labels/PEPin", "name": "PEPin", "color": "9fa1e0", "default": false, "description": "Apply PEP08 rules"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-10-24T13:49:36Z", "updated_at": "2019-02-07T10:28:14Z", "closed_at": "2019-02-07T10:28:13Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "flake8 tests are broken thanks to 'W504 line break after binary operator' and ' W605 invalid escape sequence'.\r\n\r\nSee https://travis-ci.org/secdev/scapy/jobs/445176377", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1659/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1659/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1649", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1649/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1649/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1649/events", "html_url": "https://github.com/secdev/scapy/issues/1649", "id": 370617095, "node_id": "MDU6SXNzdWUzNzA2MTcwOTU=", "number": 1649, "title": "HTTP2 does not support Python 3.7", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-10-16T13:38:57Z", "updated_at": "2018-11-11T12:18:31Z", "closed_at": "2018-11-11T12:18:31Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Loading `http2` will result in a https://bugs.python.org/issue33188\r\n\r\nIt needs to be updated ", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1649/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1649/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1642", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1642/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1642/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1642/events", "html_url": "https://github.com/secdev/scapy/issues/1642", "id": 369607747, "node_id": "MDU6SXNzdWUzNjk2MDc3NDc=", "number": 1642, "title": "[Travis] OSX & pcapdnet tests deactivated", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 514033136, "node_id": "MDU6TGFiZWw1MTQwMzMxMzY=", "url": "https://api.github.com/repos/secdev/scapy/labels/tests", "name": "tests", "color": "0e8a16", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-10-12T15:46:46Z", "updated_at": "2019-03-27T08:23:07Z", "closed_at": "2019-03-27T08:23:07Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This issue is a reminder that #1630 disabled pcapdnet tests on osx.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1642/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1642/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1639", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1639/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1639/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1639/events", "html_url": "https://github.com/secdev/scapy/issues/1639", "id": 368748102, "node_id": "MDU6SXNzdWUzNjg3NDgxMDI=", "number": 1639, "title": "Infinite recurision in ans1/ber decoding", "user": {"login": "bsloane1650", "id": 1839120, "node_id": "MDQ6VXNlcjE4MzkxMjA=", "avatar_url": "https://avatars.githubusercontent.com/u/1839120?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bsloane1650", "html_url": "https://github.com/bsloane1650", "followers_url": "https://api.github.com/users/bsloane1650/followers", "following_url": "https://api.github.com/users/bsloane1650/following{/other_user}", "gists_url": "https://api.github.com/users/bsloane1650/gists{/gist_id}", "starred_url": "https://api.github.com/users/bsloane1650/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bsloane1650/subscriptions", "organizations_url": "https://api.github.com/users/bsloane1650/orgs", "repos_url": "https://api.github.com/users/bsloane1650/repos", "events_url": "https://api.github.com/users/bsloane1650/events{/privacy}", "received_events_url": "https://api.github.com/users/bsloane1650/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-10-10T16:25:37Z", "updated_at": "2019-03-30T14:25:00Z", "closed_at": "2019-03-30T14:25:00Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nDecoding some invalid ans/ber input results in infinite recursion instead of appropriate exception\r\n\r\n#### Environment\r\n\r\n- Scapy version: 6d41839db39b2365bfeb84170df6e626d76c7e73\r\n- Python version: 2.7.15rc1\r\n- Operating System: Ubuntu 18.04.1 LTS\r\n\r\n#### How to reproduce\r\n\r\n```python\r\nSNMP('0a\\x02\\x01\\x00\\x04\\x06public\\xa3T\\x02\\x02D\\xd0\\x02\\x01\\x00\\x02\\x01\\x000H0F\\x06\\x08+\\x06\\x01\\x02\\x01\\x01\\x05\\x00\\x00\\x03\\x01\\x02D\\x00\\x03\\x01\\x02D\\x00\\x03\\x01\\x02D\\x00\\x03\\x01\\x02D\\x00\\x03\\x01\\x02D\\x00\\x03\\x01\\x02D\\x00\\x03\\x01\\x02D\\x00\\x03\\x01\\x02D\\x00\\x03\\x01\\x02D\\x00\\x03\\x01\\x02D\\x00\\x03\\x01\\x02D\\x00\\x03\\x01\\x02D')\r\n```\r\n\r\n(This is test case 00017616 from the req-enc segment of the PROTOS SNMPv1 test suite https://www.ee.oulu.fi/roles/ouspg/PROTOS_Test-Suite_c06-snmpv1 ) There are other cases in that suite that trigger what appears to be the same bug.\r\n\r\n#### Actual result\r\nTraceback (most recent call last):\r\n  File \"<console>\", line 1, in <module>\r\n  File \"scapy/base_classes.py\", line 252, in __call__\r\n    i.__init__(*args, **kargs)\r\n  File \"scapy/packet.py\", line 138, in __init__\r\n    self.dissect(_pkt)\r\n  File \"scapy/packet.py\", line 806, in dissect\r\n    s = self.do_dissect(s)\r\n  File \"scapy/asn1packet.py\", line 33, in do_dissect\r\n    return self.ASN1_root.dissect(self, x)\r\n  File \"scapy/asn1fields.py\", line 378, in dissect\r\n    _, x = self.m2i(pkt, s)\r\n  File \"scapy/asn1fields.py\", line 370, in m2i\r\n    s = obj.dissect(pkt, s)\r\n  File \"scapy/asn1fields.py\", line 138, in dissect\r\n    v, s = self.m2i(pkt, s)\r\n  File \"scapy/asn1fields.py\", line 549, in m2i\r\n    return self.extract_packet(choice, s)\r\n  File \"scapy/asn1fields.py\", line 122, in extract_packet\r\n    c = cls(s)\r\n  File \"scapy/base_classes.py\", line 252, in __call__\r\n    i.__init__(*args, **kargs)\r\n  File \"scapy/packet.py\", line 138, in __init__\r\n    self.dissect(_pkt)\r\n  File \"scapy/packet.py\", line 806, in dissect\r\n    s = self.do_dissect(s)\r\n  File \"scapy/asn1packet.py\", line 33, in do_dissect\r\n    return self.ASN1_root.dissect(self, x)\r\n  File \"scapy/asn1fields.py\", line 378, in dissect\r\n    _, x = self.m2i(pkt, s)\r\n  File \"scapy/asn1fields.py\", line 370, in m2i\r\n    s = obj.dissect(pkt, s)\r\n  File \"scapy/asn1fields.py\", line 138, in dissect\r\n    v, s = self.m2i(pkt, s)\r\n  File \"scapy/asn1fields.py\", line 419, in m2i\r\n    c, s = self.extract_packet(self.cls, s)\r\n  File \"scapy/asn1fields.py\", line 122, in extract_packet\r\n    c = cls(s)\r\n  File \"scapy/base_classes.py\", line 252, in __call__\r\n    i.__init__(*args, **kargs)\r\n  File \"scapy/packet.py\", line 138, in __init__\r\n    self.dissect(_pkt)\r\n  File \"scapy/packet.py\", line 806, in dissect\r\n    s = self.do_dissect(s)\r\n  File \"scapy/asn1packet.py\", line 33, in do_dissect\r\n    return self.ASN1_root.dissect(self, x)\r\n  File \"scapy/asn1fields.py\", line 378, in dissect\r\n    _, x = self.m2i(pkt, s)\r\n  File \"scapy/asn1fields.py\", line 370, in m2i\r\n    s = obj.dissect(pkt, s)\r\n  File \"scapy/asn1fields.py\", line 138, in dissect\r\n    v, s = self.m2i(pkt, s)\r\n  File \"scapy/asn1fields.py\", line 101, in m2i\r\n    return codec.dec(s, context=self.context)\r\n  File \"scapy/asn1/ber.py\", line 266, in dec\r\n    return cls.do_dec(s, context, safe)\r\n  File \"scapy/asn1/ber.py\", line 261, in do_dec\r\n    return codec.dec(s, context, safe)\r\n ...\r\n  File \"scapy/asn1/ber.py\", line 261, in do_dec\r\n    return codec.dec(s, context, safe)\r\n  File \"scapy/asn1/ber.py\", line 266, in dec\r\n    return cls.do_dec(s, context, safe)\r\n  File \"scapy/asn1/ber.py\", line 261, in do_dec\r\n    return codec.dec(s, context, safe)\r\n  File \"scapy/asn1/ber.py\", line 266, in dec\r\n    return cls.do_dec(s, context, safe)\r\n  File \"scapy/asn1/ber.py\", line 255, in do_dec\r\n    if p not in context:\r\n  File \"scapy/utils.py\", line 734, in __contains__\r\n    return val in self.__rdict__\r\n  File \"scapy/utils.py\", line 711, in __eq__\r\n    return self._value == int(other)\r\nRuntimeError: maximum recursion depth exceeded while calling a Python object\r\n#### Expected result\r\n\r\nDomain specific exception\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1639/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1639/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1630", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1630/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1630/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1630/events", "html_url": "https://github.com/secdev/scapy/pull/1630", "id": 367469504, "node_id": "MDExOlB1bGxSZXF1ZXN0MjIwODk0NDE4", "number": 1630, "title": "Fix Windows imports", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 517497389, "node_id": "MDU6TGFiZWw1MTc0OTczODk=", "url": "https://api.github.com/repos/secdev/scapy/labels/coverage", "name": "coverage", "color": "c2e0c6", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2018-10-06T15:52:13Z", "updated_at": "2018-10-13T11:15:57Z", "closed_at": "2018-10-13T10:36:12Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1630", "html_url": "https://github.com/secdev/scapy/pull/1630", "diff_url": "https://github.com/secdev/scapy/pull/1630.diff", "patch_url": "https://github.com/secdev/scapy/pull/1630.patch", "merged_at": "2018-10-13T10:36:12Z"}, "body": "This is the reason why coverage was so low.\r\nhttps://github.com/secdev/scapy/pull/1621 contained a few wrong imports that were not triggered in the tests.\r\n\r\nThis PR:\r\n- fixes the imports\r\n- fix UTscapy to report correctly such failures", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1630/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1630/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1623", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1623/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1623/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1623/events", "html_url": "https://github.com/secdev/scapy/issues/1623", "id": 365775439, "node_id": "MDU6SXNzdWUzNjU3NzU0Mzk=", "number": 1623, "title": "sniff enables PROMISC mode temporarily when sniff_promisc is False (SOLUTION INCLUDED)", "user": {"login": "brandonpoc", "id": 584097, "node_id": "MDQ6VXNlcjU4NDA5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/584097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brandonpoc", "html_url": "https://github.com/brandonpoc", "followers_url": "https://api.github.com/users/brandonpoc/followers", "following_url": "https://api.github.com/users/brandonpoc/following{/other_user}", "gists_url": "https://api.github.com/users/brandonpoc/gists{/gist_id}", "starred_url": "https://api.github.com/users/brandonpoc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brandonpoc/subscriptions", "organizations_url": "https://api.github.com/users/brandonpoc/orgs", "repos_url": "https://api.github.com/users/brandonpoc/repos", "events_url": "https://api.github.com/users/brandonpoc/events{/privacy}", "received_events_url": "https://api.github.com/users/brandonpoc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-10-02T07:38:28Z", "updated_at": "2018-10-19T15:51:35Z", "closed_at": "2018-10-19T15:51:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "OS: Linux (other UNIXes too?)\r\nNOTE: I'm too lazy to clone it, make the mods, issue a pull request etc; the fix is quick.\r\n\r\nThe problem: calls to sniff() enter promiscuous mode very shortly even if conf.sniff_promisc is disabled, when 'filter' is given to sniff(). This is because the call to the L2 socket routines call attach_filter in arch/linux.py, which is calling os.popen() with tcpdump in order to open the tcpdump process and get some information for the rest of the function. As a result, the desired device(s) go into promiscuous mode very shortly until tcpdump exits.  This is seen simply by tail'ing the kernel log and executing the sniff(iface='whatever', filter='dst port 1000') function.\r\n\r\nThe fix: In the call to os.popen() that executes tcpdump, add the argument \"-p\" to the parameters if sniff_promisc is disabled. '-p' tells tcpdump to not go into PROMISC mode. NOTE: the position of the promisc setting in 'conf' might need to be changed too.\r\n\r\nThey generate the same output, except with -p promiscuous mode is never entered and has the programmer's desired intention translated over to that short tcpdump execution.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1623/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1623/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1619", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1619/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1619/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1619/events", "html_url": "https://github.com/secdev/scapy/pull/1619", "id": 365138333, "node_id": "MDExOlB1bGxSZXF1ZXN0MjE5MTUxNTE3", "number": 1619, "title": "Minor UTscapy fixes", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 514033136, "node_id": "MDU6TGFiZWw1MTQwMzMxMzY=", "url": "https://api.github.com/repos/secdev/scapy/labels/tests", "name": "tests", "color": "0e8a16", "default": false, "description": null}, {"id": 1000112749, "node_id": "MDU6TGFiZWwxMDAwMTEyNzQ5", "url": "https://api.github.com/repos/secdev/scapy/labels/cleanup", "name": "cleanup", "color": "FF68F6", "default": false, "description": "Performs some code clean-up"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-09-29T14:46:20Z", "updated_at": "2020-07-19T09:19:47Z", "closed_at": "2018-09-29T18:10:48Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1619", "html_url": "https://github.com/secdev/scapy/pull/1619", "diff_url": "https://github.com/secdev/scapy/pull/1619.diff", "patch_url": "https://github.com/secdev/scapy/pull/1619.patch", "merged_at": "2018-09-29T18:10:48Z"}, "body": "- A few minor UTscapy fixes for Python 2.7\r\n- Re-ordering a few messy .utsc files (so that the keyword are OK + in the same order)", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1619/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1619/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1598", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1598/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1598/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1598/events", "html_url": "https://github.com/secdev/scapy/pull/1598", "id": 360201633, "node_id": "MDExOlB1bGxSZXF1ZXN0MjE1NTE0OTgw", "number": 1598, "title": "Fixed an ISOTPSoftSocket padding issue", "user": {"login": "epozzobon", "id": 5781229, "node_id": "MDQ6VXNlcjU3ODEyMjk=", "avatar_url": "https://avatars.githubusercontent.com/u/5781229?v=4", "gravatar_id": "", "url": "https://api.github.com/users/epozzobon", "html_url": "https://github.com/epozzobon", "followers_url": "https://api.github.com/users/epozzobon/followers", "following_url": "https://api.github.com/users/epozzobon/following{/other_user}", "gists_url": "https://api.github.com/users/epozzobon/gists{/gist_id}", "starred_url": "https://api.github.com/users/epozzobon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/epozzobon/subscriptions", "organizations_url": "https://api.github.com/users/epozzobon/orgs", "repos_url": "https://api.github.com/users/epozzobon/repos", "events_url": "https://api.github.com/users/epozzobon/events{/privacy}", "received_events_url": "https://api.github.com/users/epozzobon/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-09-14T08:14:28Z", "updated_at": "2020-01-23T12:15:44Z", "closed_at": "2018-09-15T09:29:18Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1598", "html_url": "https://github.com/secdev/scapy/pull/1598", "diff_url": "https://github.com/secdev/scapy/pull/1598.diff", "patch_url": "https://github.com/secdev/scapy/pull/1598.patch", "merged_at": "2018-09-15T09:29:18Z"}, "body": "ISOTPSoftSocket: Fixed a bug that included the passing of the last CAN frame in the ISOTP message", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1598/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1598/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1585", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1585/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1585/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1585/events", "html_url": "https://github.com/secdev/scapy/pull/1585", "id": 357702475, "node_id": "MDExOlB1bGxSZXF1ZXN0MjEzNjU0MjEy", "number": 1585, "title": "Fix FlagsField volatile values", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-09-06T15:11:44Z", "updated_at": "2018-09-07T16:14:51Z", "closed_at": "2018-09-07T11:25:01Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1585", "html_url": "https://github.com/secdev/scapy/pull/1585", "diff_url": "https://github.com/secdev/scapy/pull/1585.diff", "patch_url": "https://github.com/secdev/scapy/pull/1585.patch", "merged_at": "2018-09-07T11:25:01Z"}, "body": "Should fix #1576.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1585/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1585/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1576", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1576/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1576/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1576/events", "html_url": "https://github.com/secdev/scapy/issues/1576", "id": 354160198, "node_id": "MDU6SXNzdWUzNTQxNjAxOTg=", "number": 1576, "title": "Exception raised when ._fix() is called on fuzzed TCP flags", "user": {"login": "Kkevsterrr", "id": 3198973, "node_id": "MDQ6VXNlcjMxOTg5NzM=", "avatar_url": "https://avatars.githubusercontent.com/u/3198973?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Kkevsterrr", "html_url": "https://github.com/Kkevsterrr", "followers_url": "https://api.github.com/users/Kkevsterrr/followers", "following_url": "https://api.github.com/users/Kkevsterrr/following{/other_user}", "gists_url": "https://api.github.com/users/Kkevsterrr/gists{/gist_id}", "starred_url": "https://api.github.com/users/Kkevsterrr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Kkevsterrr/subscriptions", "organizations_url": "https://api.github.com/users/Kkevsterrr/orgs", "repos_url": "https://api.github.com/users/Kkevsterrr/repos", "events_url": "https://api.github.com/users/Kkevsterrr/events{/privacy}", "received_events_url": "https://api.github.com/users/Kkevsterrr/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2018-08-27T02:37:43Z", "updated_at": "2018-09-07T16:15:48Z", "closed_at": "2018-09-07T11:25:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "#### Brief description\r\n\r\nAn exception raised when ._fix() is called on fuzzed TCP flags. \r\n\r\nTCP is affected by this. \r\n\r\n#### Environment\r\n\r\n- Scapy version: 2.4.0.dev115\r\n- Python version: Python 3.6.5rc1\r\n- Operating System: Kali Linux\r\n\r\n#### How to reproduce\r\n\r\n```\r\nubuntu:/$ scapy\r\n... (welcome info omitted)\r\n>>> p = IP()/TCP()\r\n>>> p = fuzz(p)\r\n>>> p[\"IP\"].show()\r\n###[ IP ]###\r\n  version= <RandNum>\r\n  ihl= None\r\n  tos= 98\r\n  len= None\r\n  id= <RandShort>\r\n  flags= DF+evil\r\n  frag= 0\r\n  ttl= <RandByte>\r\n  proto= tcp\r\n  chksum= None\r\n  src= 127.0.0.1\r\n  dst= 127.0.0.1\r\n  \\options\\\r\n###[ TCP ]###\r\n     sport= <RandShort>\r\n     dport= <RandShort>\r\n     seq= <RandInt>\r\n     ack= <RandInt>\r\n     dataofs= None\r\n     reserved= <RandNum>\r\n     flags= SAUC\r\n     window= <RandShort>\r\n     chksum= None\r\n     urgptr= <RandShort>\r\n     options= []\r\n# You can query flags repeatedly to see that it's indeed a random value\r\n>>> p[\"TCP\"].flags\r\n<Flag 163 (FSUC)>\r\n>>> p[\"TCP\"].flags\r\n<Flag 414 (SRPACN)>\r\n# But if you try to _fix() it, like you can with other parts of the packet:\r\n>>> p[\"TCP\"].flags._fix()\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.6/dist-packages/scapy/fields.py\", line 1497, in __getattr__\r\n    for flag in attr)\r\n  File \"/usr/local/lib/python3.6/dist-packages/scapy/fields.py\", line 1497, in <genexpr>\r\n    for flag in attr)\r\nValueError: substring not found\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"<console>\", line 1, in <module>\r\n  File \"/usr/local/lib/python3.6/dist-packages/scapy/fields.py\", line 1499, in __getattr__\r\n    return super(FlagValue, self).__getattr__(attr)\r\nAttributeError: 'super' object has no attribute '__getattr__'\r\n```\r\n\r\n#### Actual result\r\n\r\nAttributeError/ValueError is raised.\r\n\r\n#### Expected result\r\n\r\nThe expected result is just a fixed integer or string value, representing what a random flag value is. \r\n\r\nLet me know if I'm just doing something stupid, or if there's any other info I can provide!", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1576/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1576/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1573", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1573/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1573/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1573/events", "html_url": "https://github.com/secdev/scapy/pull/1573", "id": 353176402, "node_id": "MDExOlB1bGxSZXF1ZXN0MjEwMzAxNTc4", "number": 1573, "title": "Linux: fix read_routes() when an interface has no IP address", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2018-08-23T00:43:57Z", "updated_at": "2018-09-12T03:06:30Z", "closed_at": "2018-09-11T15:11:21Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1573", "html_url": "https://github.com/secdev/scapy/pull/1573", "diff_url": "https://github.com/secdev/scapy/pull/1573.diff", "patch_url": "https://github.com/secdev/scapy/pull/1573.patch", "merged_at": "2018-09-11T15:11:21Z"}, "body": "Fixes #1567.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1573/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1573/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1571", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1571/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1571/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1571/events", "html_url": "https://github.com/secdev/scapy/pull/1571", "id": 352974307, "node_id": "MDExOlB1bGxSZXF1ZXN0MjEwMTQ5NjMw", "number": 1571, "title": "Python 3.7 support", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 514033136, "node_id": "MDU6TGFiZWw1MTQwMzMxMzY=", "url": "https://api.github.com/repos/secdev/scapy/labels/tests", "name": "tests", "color": "0e8a16", "default": false, "description": null}, {"id": 564414240, "node_id": "MDU6TGFiZWw1NjQ0MTQyNDA=", "url": "https://api.github.com/repos/secdev/scapy/labels/convergence", "name": "convergence", "color": "c2e0c6", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 19, "created_at": "2018-08-22T14:17:19Z", "updated_at": "2018-11-11T12:19:56Z", "closed_at": "2018-11-11T12:18:31Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1571", "html_url": "https://github.com/secdev/scapy/pull/1571", "diff_url": "https://github.com/secdev/scapy/pull/1571.diff", "patch_url": "https://github.com/secdev/scapy/pull/1571.patch", "merged_at": "2018-11-11T12:18:30Z"}, "body": "This PR:\r\n- adds Travis tests (because Python 3.7 is not available by default in Travis yet, it is specifying the distro)\r\n- fixes windows on 3.7\r\n- fixes http2 on 3.7\r\n- stabilize some tests (networking + ppi_geotag)\r\n\r\nWatching https://github.com/travis-ci/travis-ci/issues/9815\r\n\r\nfixes https://github.com/secdev/scapy/issues/1570\r\nfixes https://github.com/secdev/scapy/issues/1649", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1571/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1571/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1570", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1570/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1570/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1570/events", "html_url": "https://github.com/secdev/scapy/issues/1570", "id": 352457187, "node_id": "MDU6SXNzdWUzNTI0NTcxODc=", "number": 1570, "title": "Scapy does not supports Python 3.7", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 564414240, "node_id": "MDU6TGFiZWw1NjQ0MTQyNDA=", "url": "https://api.github.com/repos/secdev/scapy/labels/convergence", "name": "convergence", "color": "c2e0c6", "default": false, "description": null}, {"id": 1000112749, "node_id": "MDU6TGFiZWwxMDAwMTEyNzQ5", "url": "https://api.github.com/repos/secdev/scapy/labels/cleanup", "name": "cleanup", "color": "FF68F6", "default": false, "description": "Performs some code clean-up"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-08-21T09:27:12Z", "updated_at": "2018-11-11T12:18:30Z", "closed_at": "2018-11-11T12:18:30Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "`StopIteration` has been deprecated in generators for a little while, and is now completely suppressed in Python 3.7\r\n\r\nSee https://www.python.org/dev/peps/pep-0479/\r\n\r\nWe need to update all the generators using it in scapy, then remote it\u2019s exclusion in the Warning tests", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1570/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1570/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1553", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1553/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1553/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1553/events", "html_url": "https://github.com/secdev/scapy/pull/1553", "id": 349751268, "node_id": "MDExOlB1bGxSZXF1ZXN0MjA3Nzg1MDc5", "number": 1553, "title": "Catch errors when using _encapsulate_admin", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 267691054, "node_id": "MDU6TGFiZWwyNjc2OTEwNTQ=", "url": "https://api.github.com/repos/secdev/scapy/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-08-11T17:41:26Z", "updated_at": "2020-07-19T09:19:49Z", "closed_at": "2018-08-14T14:12:34Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1553", "html_url": "https://github.com/secdev/scapy/pull/1553", "diff_url": "https://github.com/secdev/scapy/pull/1553.diff", "patch_url": "https://github.com/secdev/scapy/pull/1553.patch", "merged_at": "2018-08-14T14:12:34Z"}, "body": "Errors were not catched when calling `setmonitor()`", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1553/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1553/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1551", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1551/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1551/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1551/events", "html_url": "https://github.com/secdev/scapy/pull/1551", "id": 349413242, "node_id": "MDExOlB1bGxSZXF1ZXN0MjA3NTM0Mjc2", "number": 1551, "title": "Minor fixes and refactoring for UDS (automotive)", "user": {"login": "akorb", "id": 6689889, "node_id": "MDQ6VXNlcjY2ODk4ODk=", "avatar_url": "https://avatars.githubusercontent.com/u/6689889?v=4", "gravatar_id": "", "url": "https://api.github.com/users/akorb", "html_url": "https://github.com/akorb", "followers_url": "https://api.github.com/users/akorb/followers", "following_url": "https://api.github.com/users/akorb/following{/other_user}", "gists_url": "https://api.github.com/users/akorb/gists{/gist_id}", "starred_url": "https://api.github.com/users/akorb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akorb/subscriptions", "organizations_url": "https://api.github.com/users/akorb/orgs", "repos_url": "https://api.github.com/users/akorb/repos", "events_url": "https://api.github.com/users/akorb/events{/privacy}", "received_events_url": "https://api.github.com/users/akorb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2018-08-10T07:57:11Z", "updated_at": "2018-08-18T19:06:37Z", "closed_at": "2018-08-16T12:16:22Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1551", "html_url": "https://github.com/secdev/scapy/pull/1551", "diff_url": "https://github.com/secdev/scapy/pull/1551.diff", "patch_url": "https://github.com/secdev/scapy/pull/1551.patch", "merged_at": "2018-08-16T12:16:22Z"}, "body": "- fixed import path for UDS\r\nUDS.py has been moved to `contrib/automotive` some time ago but one import hasn't been updated\r\n\r\n- fixed binding between TCP and DoIP\r\nOnly one binding between two layers is possible. Thus only the last defined `bind_layers` call will have effect, as previous ones are overwritten.\r\n\r\n- underlaying -> underlying\r\n\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1551/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1551/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1550", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1550/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1550/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1550/events", "html_url": "https://github.com/secdev/scapy/pull/1550", "id": 348642304, "node_id": "MDExOlB1bGxSZXF1ZXN0MjA2OTQyNTQx", "number": 1550, "title": "Fix MultipleTypeField initialization", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-08-08T09:18:18Z", "updated_at": "2018-08-15T19:59:45Z", "closed_at": "2018-08-15T19:55:22Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1550", "html_url": "https://github.com/secdev/scapy/pull/1550", "diff_url": "https://github.com/secdev/scapy/pull/1550.diff", "patch_url": "https://github.com/secdev/scapy/pull/1550.patch", "merged_at": "2018-08-15T19:55:22Z"}, "body": "This PR is a second (and cleaner) attempt to fix https://github.com/secdev/scapy/issues/1484\r\n\r\nfixes https://github.com/secdev/scapy/issues/1484", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1550/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1550/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1538", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1538/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1538/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1538/events", "html_url": "https://github.com/secdev/scapy/pull/1538", "id": 344898953, "node_id": "MDExOlB1bGxSZXF1ZXN0MjA0MTg0OTc5", "number": 1538, "title": "Calculate BIOCSETF ioctl constant for 32 bit architectures.", "user": {"login": "bluhm", "id": 4907572, "node_id": "MDQ6VXNlcjQ5MDc1NzI=", "avatar_url": "https://avatars.githubusercontent.com/u/4907572?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bluhm", "html_url": "https://github.com/bluhm", "followers_url": "https://api.github.com/users/bluhm/followers", "following_url": "https://api.github.com/users/bluhm/following{/other_user}", "gists_url": "https://api.github.com/users/bluhm/gists{/gist_id}", "starred_url": "https://api.github.com/users/bluhm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bluhm/subscriptions", "organizations_url": "https://api.github.com/users/bluhm/orgs", "repos_url": "https://api.github.com/users/bluhm/repos", "events_url": "https://api.github.com/users/bluhm/events{/privacy}", "received_events_url": "https://api.github.com/users/bluhm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-07-26T15:41:34Z", "updated_at": "2018-09-23T09:40:33Z", "closed_at": "2018-09-23T09:40:33Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1538", "html_url": "https://github.com/secdev/scapy/pull/1538", "diff_url": "https://github.com/secdev/scapy/pull/1538.diff", "patch_url": "https://github.com/secdev/scapy/pull/1538.patch", "merged_at": "2018-09-23T09:40:33Z"}, "body": "The size of the ioctl(2) argument is embeded in the constant.  Struct\r\nbpf_program is 16 bytes on 64 bit architectures but only 8 bytes\r\non 32 bit architectures.  Use ctypes to calculate the size dynamically\r\nin Python and adjust BIOCSETF.  Fixes sniff(filter=\"ip\") on\r\nOpenBSD/i386.\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1538/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1538/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1522", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1522/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1522/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1522/events", "html_url": "https://github.com/secdev/scapy/pull/1522", "id": 341319344, "node_id": "MDExOlB1bGxSZXF1ZXN0MjAxNDk3MTA0", "number": 1522, "title": "Scapy.commands improvement + doc", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 267691054, "node_id": "MDU6TGFiZWwyNjc2OTEwNTQ=", "url": "https://api.github.com/repos/secdev/scapy/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}, {"id": 1000112749, "node_id": "MDU6TGFiZWwxMDAwMTEyNzQ5", "url": "https://api.github.com/repos/secdev/scapy/labels/cleanup", "name": "cleanup", "color": "FF68F6", "default": false, "description": "Performs some code clean-up"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-07-15T13:01:15Z", "updated_at": "2018-07-21T23:31:37Z", "closed_at": "2018-07-21T08:59:13Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1522", "html_url": "https://github.com/secdev/scapy/pull/1522", "diff_url": "https://github.com/secdev/scapy/pull/1522.diff", "patch_url": "https://github.com/secdev/scapy/pull/1522.patch", "merged_at": "2018-07-21T08:59:12Z"}, "body": "This PR:\r\n- fixes `lsc()` printing by adding extra docs to the commands listed\r\n- improves a few of those commands / remove duplicated code\r\n- fixes a small bug in `__iterlen__` that could result on some layers (e.g. DHCP) to the `sr()` suite never ending\r\n\r\nfixes https://github.com/secdev/scapy/issues/1478", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1522/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1522/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1521", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1521/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1521/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1521/events", "html_url": "https://github.com/secdev/scapy/pull/1521", "id": 341312367, "node_id": "MDExOlB1bGxSZXF1ZXN0MjAxNDkyNjE4", "number": 1521, "title": "Export-subst util: change format", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2018-07-15T11:04:34Z", "updated_at": "2021-03-04T22:22:01Z", "closed_at": "2018-08-14T14:53:06Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1521", "html_url": "https://github.com/secdev/scapy/pull/1521", "diff_url": "https://github.com/secdev/scapy/pull/1521.diff", "patch_url": "https://github.com/secdev/scapy/pull/1521.patch", "merged_at": "2018-08-14T14:53:06Z"}, "body": "This PR:\r\n- moves VERSION from `scapy/scapy/` to `scapy/` which sounds more logical\r\n- replaces `'$Format:%h %d$'` (exported as `c32159d45 (HEAD -> master)`) by `'$Format:%h$'` (exported as `c32159d45`), so that we only depend on the commit state\r\n\r\nfixes https://github.com/secdev/scapy/issues/1520", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1521/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1521/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1515", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1515/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1515/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1515/events", "html_url": "https://github.com/secdev/scapy/pull/1515", "id": 339780252, "node_id": "MDExOlB1bGxSZXF1ZXN0MjAwMzQ3NjU1", "number": 1515, "title": "MQTT VariableFieldLenField", "user": {"login": "ramsaut", "id": 9454652, "node_id": "MDQ6VXNlcjk0NTQ2NTI=", "avatar_url": "https://avatars.githubusercontent.com/u/9454652?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ramsaut", "html_url": "https://github.com/ramsaut", "followers_url": "https://api.github.com/users/ramsaut/followers", "following_url": "https://api.github.com/users/ramsaut/following{/other_user}", "gists_url": "https://api.github.com/users/ramsaut/gists{/gist_id}", "starred_url": "https://api.github.com/users/ramsaut/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ramsaut/subscriptions", "organizations_url": "https://api.github.com/users/ramsaut/orgs", "repos_url": "https://api.github.com/users/ramsaut/repos", "events_url": "https://api.github.com/users/ramsaut/events{/privacy}", "received_events_url": "https://api.github.com/users/ramsaut/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-07-10T10:17:45Z", "updated_at": "2018-07-20T19:31:32Z", "closed_at": "2018-07-20T19:31:32Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1515", "html_url": "https://github.com/secdev/scapy/pull/1515", "diff_url": "https://github.com/secdev/scapy/pull/1515.diff", "patch_url": "https://github.com/secdev/scapy/pull/1515.patch", "merged_at": "2018-07-20T19:31:32Z"}, "body": "**Checklist:**\r\n- [x] If you are new to Scapy: I have checked https://github.com/secdev/scapy/blob/master/CONTRIBUTING.md (esp. section submitting-pull-requests)\r\n- [x] I squashed commits belonging together\r\n- [x] I added unit tests or explained why they are not relevant\r\n- [x] I executed the regression tests for Python2 and Python3 (using `tox` or, `cd test && ./run_tests_py2, cd test && ./run_tests_py3`)\r\n\r\nThe added test case demonstrates the bug:\r\n```\r\n-- Run Thu Jul  5 22:06:04 2018 from [scapy/contrib/mqtt.uts] by UTscapy\r\n\r\nPassed=14\r\nFailed=1\r\n\r\n\r\n######\r\n## MQTT protocol test\r\n######\r\n\r\n\r\n###(014)=[failed] MQTT without payload\r\n\r\n>>> p = MQTT()\r\n>>> assert(bytes(p) == b'\\x10\\x00')\r\nTraceback (most recent call last):\r\n  File \"<input>\", line 2, in <module>\r\n  File \"scapy/packet.py\", line 354, in __str__\r\n    return str(self.build())\r\n  File \"scapy/packet.py\", line 464, in build\r\n    p = self.do_build()\r\n  File \"scapy/packet.py\", line 451, in do_build\r\n    return self.post_build(pkt, pay)\r\n  File \"scapy/packet.py\", line 477, in post_build\r\n    return pkt + pay\r\nTypeError: unsupported operand type(s) for +: 'NoneType' and 'str'\r\n```\r\nIf an MQTT packet has no payload and the length is therefore 0, the method addfield did return None.\r\n\r\nThe PR fixes the method addfield to return `s + b\"\\x00`, when the length is 0.\r\n\r\nThe PR additionally changes the VariableFieldLenField to return a randval() according to MQTT [specification](http://docs.oasis-open.org/mqtt/mqtt/v3.1.1/os/mqtt-v3.1.1-os.html#_Toc398718023).", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1515/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1515/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1511", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1511/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1511/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1511/events", "html_url": "https://github.com/secdev/scapy/pull/1511", "id": 339185163, "node_id": "MDExOlB1bGxSZXF1ZXN0MTk5OTE5MTE4", "number": 1511, "title": "DNS improvements (add compression & cleanup) + Fix DNSRRSRV + tests", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 267691054, "node_id": "MDU6TGFiZWwyNjc2OTEwNTQ=", "url": "https://api.github.com/repos/secdev/scapy/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}, {"id": 514033136, "node_id": "MDU6TGFiZWw1MTQwMzMxMzY=", "url": "https://api.github.com/repos/secdev/scapy/labels/tests", "name": "tests", "color": "0e8a16", "default": false, "description": null}, {"id": 1000112749, "node_id": "MDU6TGFiZWwxMDAwMTEyNzQ5", "url": "https://api.github.com/repos/secdev/scapy/labels/cleanup", "name": "cleanup", "color": "FF68F6", "default": false, "description": "Performs some code clean-up"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2018-07-08T00:20:02Z", "updated_at": "2018-11-11T16:42:02Z", "closed_at": "2018-09-08T08:56:12Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1511", "html_url": "https://github.com/secdev/scapy/pull/1511", "diff_url": "https://github.com/secdev/scapy/pull/1511.diff", "patch_url": "https://github.com/secdev/scapy/pull/1511.patch", "merged_at": "2018-09-08T08:56:12Z"}, "body": "This PR is an attempt of adding DNS compression to scapy.\r\n\r\n- Remove duplicated code\r\n- Add DNS compression support: `dns_compress(pkt)` function\r\n- Fix DNSRRSRV\r\n- Rename DNSgetstr into dns_get_str (with deprecated old DNSgetstr)\r\n- Adds `clear_cache` function, required to test DNS compression", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1511/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1511/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1484", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1484/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1484/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1484/events", "html_url": "https://github.com/secdev/scapy/issues/1484", "id": 334459210, "node_id": "MDU6SXNzdWUzMzQ0NTkyMTA=", "number": 1484, "title": "MultipleTypeField: wrong initialization", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-06-21T11:52:22Z", "updated_at": "2018-08-15T19:55:22Z", "closed_at": "2018-08-15T19:55:22Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "There is a bug with MultipleTypeField: when a packet containing it is initialized with a value set to MultipleTypeField, the `any2i` function is executed to set the value to the field before other fields of the same packet are initialized.\r\n\r\nIn the case where `any2i` changes the type of the input, it creates a bug. See demo below.\r\n\r\n```python\r\nclass DebugPacket(Packet):\r\n    fields_desc = [\r\n        ByteEnumField(\"atyp\", 0x1, {0x1: \"IPv4\", 0x3: \"DNS\", 0x4: \"IPv6\"}),\r\n        MultipleTypeField(\r\n            [\r\n                # IPv4\r\n                (IPField(\"addr\", \"0.0.0.0\"), lambda pkt: pkt.atyp == 0x1),\r\n                # DNS\r\n                (DNSStrField(\"addr\", \"\"), lambda pkt: pkt.atyp == 0x3),\r\n                # IPv6\r\n                (IP6Field(\"addr\", \"::\"), lambda pkt: pkt.atyp == 0x4),\r\n            ],\r\n            StrField(\"addr\", \"\")\r\n        ),\r\n    ]\r\n```\r\n\r\n- First test (OK)\r\n```python\r\na = DebugPacket(atyp=0x3, addr=\"scapy.net\")\r\na = DebugPacket(raw(a))\r\na.addr\r\n```\r\nReturns:\r\n`b'scapy.net.'`\r\n\r\n- Second test (Fails)\r\n```python\r\na = DebugPacket(addr=\"scapy.net\", atyp=0x3)\r\na.addr\r\n```\r\nReturns:\r\n`Net('scapy.net')`\r\n\r\n### Ways of fixing this\r\n\r\n- Adding some complicated extra metric (see the PR)\r\n- Throwing an error on building when we detect a wrong order of the init fields\r\n\r\n@p-l- ", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1484/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1484/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1482", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1482/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1482/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1482/events", "html_url": "https://github.com/secdev/scapy/issues/1482", "id": 334433804, "node_id": "MDU6SXNzdWUzMzQ0MzM4MDQ=", "number": 1482, "title": "sendpfast parse_results error", "user": {"login": "ob1ank", "id": 8855703, "node_id": "MDQ6VXNlcjg4NTU3MDM=", "avatar_url": "https://avatars.githubusercontent.com/u/8855703?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ob1ank", "html_url": "https://github.com/ob1ank", "followers_url": "https://api.github.com/users/ob1ank/followers", "following_url": "https://api.github.com/users/ob1ank/following{/other_user}", "gists_url": "https://api.github.com/users/ob1ank/gists{/gist_id}", "starred_url": "https://api.github.com/users/ob1ank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ob1ank/subscriptions", "organizations_url": "https://api.github.com/users/ob1ank/orgs", "repos_url": "https://api.github.com/users/ob1ank/repos", "events_url": "https://api.github.com/users/ob1ank/events{/privacy}", "received_events_url": "https://api.github.com/users/ob1ank/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-06-21T10:32:46Z", "updated_at": "2019-03-17T18:02:12Z", "closed_at": "2019-03-17T18:02:12Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "```\r\n>>> a\r\n<Ether  |>\r\n>>> sendpfast(a, parse_results=True)\r\nWARNING: Mac address to reach destination not found. Using broadcast.\r\nINFO: ['tcpreplay', '--intf1=enp3s0f0', '--topspeed', '/tmp/scapyWn1Ynj']\r\nINFO: Actual: 1 packets (14 bytes) sent in 0.04 seconds.                Rated: 350.0 bps, 0.00 Mbps, 25.00 pps\r\nStatistics for network device: enp3s0f0\r\n        Attempted packets:         1\r\n        Successful packets:        1\r\n        Failed packets:            0\r\n        Retried packets (ENOBUFS): 0\r\n        Retried packets (EAGAIN):  0\r\n\r\nWARNING: sending out enp3s0f0 \r\nprocessing file: /tmp/scapyWn1Ynj\r\n\r\nERROR: more Error parsing output: could not convert string to float: bps,\r\n{}\r\n>>> \r\n\r\n```\r\n#### Environment\r\n\r\n- Scapy version: 2.4 `but I updated sendrecv.py to latest`\r\n- Python version: 2.7.14\r\n- Operating System: ubuntu16.04.4\r\n```\r\ntcpreplay version: 3.4.4 (build 2450) (debug)\r\nCopyright 2000-2010 by Aaron Turner <aturner at synfin dot net>\r\nCache file supported: 04\r\nNot compiled with libdnet.\r\nCompiled against libpcap: 1.7.4\r\n64 bit packet counters: enabled\r\nVerbose printing via tcpdump: enabled\r\nPacket editing: disabled\r\nFragroute engine: disabled\r\nInjection method: PF_PACKET send()\r\n```", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1482/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1482/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1476", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1476/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1476/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1476/events", "html_url": "https://github.com/secdev/scapy/issues/1476", "id": 332173045, "node_id": "MDU6SXNzdWUzMzIxNzMwNDU=", "number": 1476, "title": "manpage fixes proposititions from doclifter", "user": {"login": "phil777", "id": 1108574, "node_id": "MDQ6VXNlcjExMDg1NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1108574?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phil777", "html_url": "https://github.com/phil777", "followers_url": "https://api.github.com/users/phil777/followers", "following_url": "https://api.github.com/users/phil777/following{/other_user}", "gists_url": "https://api.github.com/users/phil777/gists{/gist_id}", "starred_url": "https://api.github.com/users/phil777/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phil777/subscriptions", "organizations_url": "https://api.github.com/users/phil777/orgs", "repos_url": "https://api.github.com/users/phil777/repos", "events_url": "https://api.github.com/users/phil777/events{/privacy}", "received_events_url": "https://api.github.com/users/phil777/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-06-13T21:35:08Z", "updated_at": "2018-08-08T09:58:07Z", "closed_at": "2018-07-19T13:40:53Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "This is automatically generated email about markup problems in a man\r\npage for which you appear to be responsible.  If you are not the right\r\nperson or list, please tell me so I can correct my database.\r\n\r\nSee http://catb.org/~esr/doclifter/bugs.html for details on how and\r\nwhy these patches were generated.  Feel free to email me with any\r\nquestions.  Note: These patches do not change the modification date of\r\nany manual page.  You may wish to do that by hand.\r\n\r\nI apologize if this message seems spammy or impersonal. The volume of\r\nmarkup bugs I am tracking is over five hundred - there is no real\r\nalternative to generating bugmail from a database and template.\r\n\r\n--\r\n                             Eric S. Raymond\r\n\r\nProblems with scapy.1:\r\n\r\nInvalid or unterminated font escape.\r\n\r\n```\r\n--- scapy.1-unpatched\t2018-04-17 20:07:54.884035979 -0400\r\n+++ scapy.1\t2018-04-17 20:12:07.243538518 -0400\r\n@@ -73,7 +73,7 @@\r\n \r\n .SH FILES\r\n \\fB$HOME/.scapy_prestart.py\\fR\r\n-This file is run before scapy core is loaded. Only the \\fb\\conf\\fP object \r\n+This file is run before scapy core is loaded. Only the \\fBconf\\fP object \r\n is available. This file can be used to manipulate \\fBconf.load_layers\\fP \r\n list to choose which layers will be loaded:\r\n \r\n@@ -100,11 +100,11 @@\r\n .LP\r\n Test the robustness of a network stack with invalid packets:\r\n .nf\r\n-sr(IP(dst=\"172.16.1.1\", ihl=2, options=\"\\verb$\\x02$\", version=3)/ICMP())\r\n+sr(IP(dst=\"172.16.1.1\", ihl=2, options=\"\\everb$\\ex02$\", version=3)/ICMP())\r\n .fi\r\n \r\n .LP\r\n-Packet sniffing and dissection (with a bpf filter or thetereal-like output):\r\n+Packet sniffing and dissection (with a bpf filter or tshark-like output):\r\n .nf\r\n a=sniff(filter=\"tcp port 110\")\r\n a=sniff(prn = lambda x: x.display) \r\n```", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1476/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1476/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1409", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1409/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1409/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1409/events", "html_url": "https://github.com/secdev/scapy/pull/1409", "id": 322207305, "node_id": "MDExOlB1bGxSZXF1ZXN0MTg3Mzk1MzMx", "number": 1409, "title": "Remove useless _RADIUSAttrPacketListField class", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-05-11T08:11:10Z", "updated_at": "2018-05-11T08:52:47Z", "closed_at": "2018-05-11T08:47:39Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1409", "html_url": "https://github.com/secdev/scapy/pull/1409", "diff_url": "https://github.com/secdev/scapy/pull/1409.diff", "patch_url": "https://github.com/secdev/scapy/pull/1409.patch", "merged_at": "2018-05-11T08:47:39Z"}, "body": "This class was useless since PacketListField does the job, moreover it\r\nwas buggy and could cause Scapy to go in a infinite loop. Test case\r\nadded.\r\n\r\nFixes #1407.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1409/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1409/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1407", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1407/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1407/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1407/events", "html_url": "https://github.com/secdev/scapy/issues/1407", "id": 321839376, "node_id": "MDU6SXNzdWUzMjE4MzkzNzY=", "number": 1407, "title": "Pcapreader() does not work at specific packets and memory usage continues to increase", "user": {"login": "no-okui", "id": 16395395, "node_id": "MDQ6VXNlcjE2Mzk1Mzk1", "avatar_url": "https://avatars.githubusercontent.com/u/16395395?v=4", "gravatar_id": "", "url": "https://api.github.com/users/no-okui", "html_url": "https://github.com/no-okui", "followers_url": "https://api.github.com/users/no-okui/followers", "following_url": "https://api.github.com/users/no-okui/following{/other_user}", "gists_url": "https://api.github.com/users/no-okui/gists{/gist_id}", "starred_url": "https://api.github.com/users/no-okui/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/no-okui/subscriptions", "organizations_url": "https://api.github.com/users/no-okui/orgs", "repos_url": "https://api.github.com/users/no-okui/repos", "events_url": "https://api.github.com/users/no-okui/events{/privacy}", "received_events_url": "https://api.github.com/users/no-okui/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 13, "created_at": "2018-05-10T07:38:55Z", "updated_at": "2019-07-25T09:31:52Z", "closed_at": "2018-05-11T08:47:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "Scary version: scapy-2.4.0.dev149\r\nPython version: Python 3.6.5\r\nOS: Ubuntu 16.04.03 LTS\r\n\r\nI try to read the attached pcap file using Pcapreader(), but Pcapreader() does not work after read a packet which timestamp is 1523958716.205101, and memory usage increases, finally, the process forcibly terminates. \r\n\r\n```\r\nfrom scapy.all import *\r\nwith PcapReader('test.pcap') as pkts:\r\n    for pkt in pkts:\r\n        print(str(pkt.time) + ': ' + str(len(pkt)))\r\n```\r\n\r\noutput\r\n```\r\n1523958716.093239: 82\r\n1523958716.14647: 82\r\n1523958716.159972: 98\r\n1523958716.18894: 90\r\n1523958716.201178: 90\r\n1523958716.205101: 90\r\n```\r\n\r\nI also try to read the attached pcap file using dpkt and dpkt succeed in read the file.\r\n```\r\nimport dpkt\r\nwith open('test.pcap', \"rb\") as f:\r\n    pcr = dpkt.pcap.Reader(f)\r\n    for t, buf in pcr:\r\n        print(str(t) + ': ' + str(len(buf)))\r\n        eth = dpkt.ethernet.Ethernet(buf)\r\n\r\n        ip = eth.data\r\n        src = ip.src\r\n        dst = ip.dst\r\n        src_a = socket.inet_ntoa(src)\r\n        dst_a = socket.inet_ntoa(dst)\r\n        print(\"Sorce IP :%s\" % src_a)\r\n        print(\"Dest IP :%s\" % dst_a)\r\n```\r\n\r\noutput\r\n```\r\n1523958716.093239: 82\r\nSorce IP :210.196.129.140\r\nDest IP :8.8.8.8\r\n1523958716.14647: 82\r\nSorce IP :210.196.129.140\r\nDest IP :8.8.8.8\r\n1523958716.159972: 98\r\nSorce IP :8.8.8.8\r\nDest IP :210.196.129.140\r\n1523958716.18894: 90\r\nSorce IP :210.196.129.140\r\nDest IP :13.113.26.230\r\n1523958716.201178: 90\r\nSorce IP :210.196.129.140\r\nDest IP :13.113.26.230\r\n1523958716.205101: 90\r\nSorce IP :210.196.129.140\r\nDest IP :13.113.26.230\r\n1523958716.209078: 90\r\nSorce IP :210.196.129.140\r\nDest IP :13.113.26.230\r\n1523958716.213085: 90\r\nSorce IP :210.196.129.140\r\nDest IP :13.113.26.230\r\n\r\n\r\n1523958716.453802: 114\r\nSorce IP :121.40.147.12\r\nDest IP :210.196.129.140\r\n```\r\n\r\n\r\n\r\n[test.pcap.zip](https://github.com/secdev/scapy/files/1990677/test.pcap.zip)\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1407/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1407/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1399", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1399/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1399/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1399/events", "html_url": "https://github.com/secdev/scapy/pull/1399", "id": 320613375, "node_id": "MDExOlB1bGxSZXF1ZXN0MTg2MjE3ODE5", "number": 1399, "title": "Add StrLenField.max_length attribute to prevent crashes", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2018-05-06T17:57:28Z", "updated_at": "2018-05-07T12:34:35Z", "closed_at": "2018-05-07T09:30:37Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1399", "html_url": "https://github.com/secdev/scapy/pull/1399", "diff_url": "https://github.com/secdev/scapy/pull/1399.diff", "patch_url": "https://github.com/secdev/scapy/pull/1399.patch", "merged_at": "2018-05-07T09:30:37Z"}, "body": "This attribute is used for random values maximum length.\r\n\r\n`.max_length` will be set on other `StrLenField()` (and subclasses) uses. This can be done in other PRs.\r\n\r\nFixes #1398.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1399/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1399/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1398", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1398/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1398/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1398/events", "html_url": "https://github.com/secdev/scapy/issues/1398", "id": 320575773, "node_id": "MDU6SXNzdWUzMjA1NzU3NzM=", "number": 1398, "title": "Scapy fuzz() wrong length", "user": {"login": "wihack", "id": 37645554, "node_id": "MDQ6VXNlcjM3NjQ1NTU0", "avatar_url": "https://avatars.githubusercontent.com/u/37645554?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wihack", "html_url": "https://github.com/wihack", "followers_url": "https://api.github.com/users/wihack/followers", "following_url": "https://api.github.com/users/wihack/following{/other_user}", "gists_url": "https://api.github.com/users/wihack/gists{/gist_id}", "starred_url": "https://api.github.com/users/wihack/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wihack/subscriptions", "organizations_url": "https://api.github.com/users/wihack/orgs", "repos_url": "https://api.github.com/users/wihack/repos", "events_url": "https://api.github.com/users/wihack/events{/privacy}", "received_events_url": "https://api.github.com/users/wihack/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2018-05-06T09:08:26Z", "updated_at": "2018-05-07T10:53:17Z", "closed_at": "2018-05-07T09:30:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "Brief description\r\n\r\nBefore following your advice, upgrade scapy to scapy2.4, but if I execute the fuzz() function I still get a length error:\r\n\r\n\r\n\r\nEnvironment\r\nscapy version 2.4.0\r\npython 2.7\r\n\r\nHow to reproduce\r\n\r\n victim=\"11:22:33:44:55:66\"\r\nAttacker=\"22:33:44:55:66:77\"\r\nFrame = Dot11 (proto=0, FCfield=0, ID=0, addr1=victim, addr2=attacker,\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Addr3=attacker,SC=0,addr4=None)/Dot11Beacon(beacon_interval=100,cap=\"ESS\")/Dot11Elt(ID=0)\r\nSendp(fuzz(frame), loop=1)\r\n\r\n\r\nActual result\r\n\r\n    return s+struct.pack(self.fmt, self.i2m(pkt,val))\r\nstruct.error: ubyte format requires 0 <= number <= 255\r\n\r\n\r\nExpected result\r\n\r\nThere should be no error", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1398/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1398/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1318", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1318/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1318/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1318/events", "html_url": "https://github.com/secdev/scapy/issues/1318", "id": 311356754, "node_id": "MDU6SXNzdWUzMTEzNTY3NTQ=", "number": 1318, "title": "L2ListenTcpdump fail", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-04-04T19:16:49Z", "updated_at": "2019-06-22T09:37:55Z", "closed_at": "2019-06-22T09:37:55Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "The `FIXME_py3` flag was lost during tox migration, explaining why we see such failures\r\n\r\n```\r\n= Test L2ListenTcpdump socket\r\n~ netaccess FIXME_py3\r\n\r\n# Often (but not always) fails with Python 3\r\nimport time\r\nfor i in range(10):\r\n    read_s = L2ListenTcpdump(iface=conf.iface)\r\n    out_s = conf.L2socket(iface=conf.iface)\r\n    time.sleep(5)  # wait for read_s to be ready\r\n    icmp_r = Ether()/IP(dst=\"secdev.org\")/ICMP()\r\n    res = sndrcv(out_s, icmp_r, timeout=5, rcv_pks=read_s)[0]\r\n    read_s.close()\r\n    out_s.close()\r\n    time.sleep(5)\r\n    if res:\r\n        break\r\n\r\nresponse = res[0][1]\r\nassert response[ICMP].type == 0\r\n```\r\n\r\nCompletly forgot about it, this ages from python 3 migration.\r\n\r\nI cannot reproduce it on my Windows machine :/ Should be able to in a week.\r\nWould be great if someone could investigate in the mean time", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1318/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1318/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1280", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1280/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1280/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1280/events", "html_url": "https://github.com/secdev/scapy/issues/1280", "id": 307586574, "node_id": "MDU6SXNzdWUzMDc1ODY1NzQ=", "number": 1280, "title": "TLS notebook does not support Python3", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-03-22T10:32:25Z", "updated_at": "2018-03-27T09:51:02Z", "closed_at": "2018-03-27T09:51:02Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "In https://github.com/secdev/scapy/blob/master/doc/notebooks/tls/notebook3_tls_compromised.ipynb, the `rb` flag must be passed to `open()`. Moreover, `load_layer(\"tls\")`  must be added after loading Scapy.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1280/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1280/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1207", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1207/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1207/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1207/events", "html_url": "https://github.com/secdev/scapy/pull/1207", "id": 302028958, "node_id": "MDExOlB1bGxSZXF1ZXN0MTcyNjg1NDg1", "number": 1207, "title": "[Travis] Python 3.6 osx builds are broken", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-03-03T20:19:17Z", "updated_at": "2018-03-05T13:19:05Z", "closed_at": "2018-03-05T13:16:23Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1207", "html_url": "https://github.com/secdev/scapy/pull/1207", "diff_url": "https://github.com/secdev/scapy/pull/1207.diff", "patch_url": "https://github.com/secdev/scapy/pull/1207.patch", "merged_at": "2018-03-05T13:16:23Z"}, "body": "See https://travis-ci.org/secdev/scapy/jobs/348646654\r\n\r\nThis PR attempts to fix Python3.* installation with homebrew.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1207/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1207/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1186", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1186/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1186/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1186/events", "html_url": "https://github.com/secdev/scapy/pull/1186", "id": 300161417, "node_id": "MDExOlB1bGxSZXF1ZXN0MTcxMzE5MjAy", "number": 1186, "title": "Fixed a TypeError that triggered when reading a pcap file containing a NTP packet.", "user": {"login": "Neurocinetics", "id": 9076328, "node_id": "MDQ6VXNlcjkwNzYzMjg=", "avatar_url": "https://avatars.githubusercontent.com/u/9076328?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Neurocinetics", "html_url": "https://github.com/Neurocinetics", "followers_url": "https://api.github.com/users/Neurocinetics/followers", "following_url": "https://api.github.com/users/Neurocinetics/following{/other_user}", "gists_url": "https://api.github.com/users/Neurocinetics/gists{/gist_id}", "starred_url": "https://api.github.com/users/Neurocinetics/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Neurocinetics/subscriptions", "organizations_url": "https://api.github.com/users/Neurocinetics/orgs", "repos_url": "https://api.github.com/users/Neurocinetics/repos", "events_url": "https://api.github.com/users/Neurocinetics/events{/privacy}", "received_events_url": "https://api.github.com/users/Neurocinetics/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2018-02-26T09:22:16Z", "updated_at": "2018-03-08T19:19:59Z", "closed_at": "2018-03-08T11:44:45Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1186", "html_url": "https://github.com/secdev/scapy/pull/1186", "diff_url": "https://github.com/secdev/scapy/pull/1186.diff", "patch_url": "https://github.com/secdev/scapy/pull/1186.patch", "merged_at": "2018-03-08T11:44:45Z"}, "body": "Fixed an error (TypeError) that triggered when reading a pcap file that contained ntp packets. The type of variable \"cls\" was string not a class type (invalid argument for method: issubclass()). By importing the type 'TCP' from 'scapy.layers.inet' and by converting cls to a classtype by reading the key from globals, the TypeError is mitigated.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1186/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1186/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1178", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1178/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1178/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1178/events", "html_url": "https://github.com/secdev/scapy/issues/1178", "id": 299974855, "node_id": "MDU6SXNzdWUyOTk5NzQ4NTU=", "number": 1178, "title": "IKEv2 : wrong key_length transform attribute encoding", "user": {"login": "Spinlogic", "id": 5713270, "node_id": "MDQ6VXNlcjU3MTMyNzA=", "avatar_url": "https://avatars.githubusercontent.com/u/5713270?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Spinlogic", "html_url": "https://github.com/Spinlogic", "followers_url": "https://api.github.com/users/Spinlogic/followers", "following_url": "https://api.github.com/users/Spinlogic/following{/other_user}", "gists_url": "https://api.github.com/users/Spinlogic/gists{/gist_id}", "starred_url": "https://api.github.com/users/Spinlogic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Spinlogic/subscriptions", "organizations_url": "https://api.github.com/users/Spinlogic/orgs", "repos_url": "https://api.github.com/users/Spinlogic/repos", "events_url": "https://api.github.com/users/Spinlogic/events{/privacy}", "received_events_url": "https://api.github.com/users/Spinlogic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-02-24T21:37:21Z", "updated_at": "2018-06-11T11:43:35Z", "closed_at": "2018-06-11T11:43:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "In current version 2.4.0rc4.dev109 of scapy (also tested with 2.3.3) , the key_length attribute for transform_type = 'Encryption' is wrongly encoded in the transmitted IKEv2 packet. \r\ntransform_1 in the following code\r\n\r\n```\r\nimport binascii\r\nimport logging\r\nlogging.getLogger(\"scapy.runtime\").setLevel(logging.ERROR)\r\nfrom scapy.all import *\r\nload_contrib('ikev2')\r\n\r\ndef ikelookup(server_address):\r\n    key_exchange = binascii.unhexlify('bb41bb41cfaf34e3b3209672aef1c51b9d52919f1781d0b4cd889d4aafe261688776000c3d9031505aefc0186967eaf5a7663725fb102c59c39b7a70d8d9161c3bd0eb445888b5028ea063ba0ae01f5b3f30808a6b6710dc9bab601e4116157d7f58cf835cb633c64abcb3a5c61c223e9332538bfc9f282cb62d1f00f4ee8802')\r\n    nonce = binascii.unhexlify('8dfcf8384c5c32f1b294c64eab69f98e9d8cf7e7f352971a91ff6777d47dffed')\r\n    nat_detection_source_ip = binascii.unhexlify('e64c81c4152ad83bd6e035009fbb900406be371f')\r\n    nat_detection_destination_ip = binascii.unhexlify('28cd99b9fa1267654b53f60887c9c35bcf67a8ff')\r\n    transform_1 = IKEv2_payload_Transform(next_payload = 'Transform', transform_type = 'Encryption', transform_id = 12, length = 12, key_length = 0x80)\r\n    transform_2 = IKEv2_payload_Transform(next_payload = 'Transform', transform_type = 'PRF', transform_id = 2)\r\n    transform_3 = IKEv2_payload_Transform(next_payload = 'Transform', transform_type = 'Integrity', transform_id = 2)\r\n    transform_4 = IKEv2_payload_Transform(next_payload = 'last', transform_type = 'GroupDesc', transform_id = 2)\r\n    if(':' in server_address):\r\n        packet = IPv6(dst = server_address)\r\n    else:\r\n        packet = IP(dst = server_address, proto = 'udp')\r\n    packet = packet /\\\r\n           UDP(dport = 500) /\\\r\n           IKEv2(init_SPI = RandString(8), next_payload = 'SA', exch_type = 'IKE_SA_INIT', flags='Initiator') /\\\r\n           IKEv2_payload_SA(next_payload = 'KE', prop = IKEv2_payload_Proposal(trans_nb = 4, trans = transform_1 / transform_2 / transform_3 / transform_4, )) /\\\r\n           IKEv2_payload_KE(next_payload = 'Nonce', group = '1024MODPgr', load = key_exchange) /\\\r\n           IKEv2_payload_Nonce(next_payload = 'Notify', load = nonce) /\\\r\n           IKEv2_payload_Notify(next_payload = 'Notify', type = 16388, load = nat_detection_source_ip) /\\\r\n           IKEv2_payload_Notify(next_payload = 'None', type = 16389, load = nat_detection_destination_ip)\r\n    #print(packet.show())\r\n    print('\\n\\n----------------------------------------------------------------------------\\n\\n')\r\n    ans = sr1(packet, timeout = 3, verbose = 0)\r\n    if ans == None:\r\n        print('No answer received.')\r\n    else:\r\n        print('Length of answer received: {}'.format(len(ans)))\r\n        print(ans.summary())\r\n\r\nikelookup('XXX.XX.XXX.XX')\r\n```\r\nis sent as \r\n\r\n![transform1_wrong](https://user-images.githubusercontent.com/5713270/36635233-f04b73f0-19b1-11e8-83fe-22ae5b98c690.PNG)\r\n\r\nThe same code with scapy3k (phaeton fork of scapy repo) is doing the correct encoding with the same code as above:\r\n\r\n![transform1_correct](https://user-images.githubusercontent.com/5713270/36635259-2c19ab04-19b2-11e8-9abf-c98119bdcdd6.PNG)\r\n\r\nI tested on Windows 10 and on Kali linux (both on VBox and native), with identical results.\r\n\r\nI am very much willing to help in fixing this, but need some guidance (I am not an expert in scapy).", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1178/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1178/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1171", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1171/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1171/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1171/events", "html_url": "https://github.com/secdev/scapy/issues/1171", "id": 299262230, "node_id": "MDU6SXNzdWUyOTkyNjIyMzA=", "number": 1171, "title": "[IPv6] Wrong link-local address selection with multiple interfaces", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-02-22T08:36:04Z", "updated_at": "2018-03-24T18:22:56Z", "closed_at": "2018-03-24T18:22:56Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "It seems that Scapy does not correctly handle multiple interfaces with IPv6. The following script must not fail:\r\n```python\r\nimport os\r\nimport time\r\n\r\nos.system(\"ip link add name scapy0 type dummy\")\r\nos.system(\"ip link set scapy0 up\")\r\n\r\nfrom scapy.all import *\r\n\r\nconf.iface = \"scapy0\"\r\n\r\np = Ether()/IPv6(dst=\"ff02::1\")/ICMPv6NIQueryName(data=\"ff02::1\")\r\nprint p.sprintf(\"%Ether.src% > %Ether.dst%\\n%IPv6.src% > %IPv6.dst%\")\r\n\r\nip6_ll_address = [a[0] for a in in6_getifaddr() if a[2] == conf.iface and\r\n                                                   a[0].startswith(\"fe80\")][0]\r\nprint p[IPv6].src, ip6_ll_address\r\nassert p[IPv6].src == ip6_ll_address\r\n\r\nmac_address =  get_if_hwaddr(conf.iface)\r\nprint p[Ether].src, mac_address\r\nassert p[Ether].src == get_if_hwaddr(conf.iface)\r\n\r\np = Ether(raw(p))\r\nprint p.sprintf(\"%Ether.src% > %Ether.dst%\\n%IPv6.src% > %IPv6.dst%\")\r\n\r\nip6_ll_address = [a[0] for a in in6_getifaddr() if a[2] == conf.iface and\r\n                                                   a[0].startswith(\"fe80\")][0]\r\nprint p[IPv6].src, ip6_ll_address\r\nassert p[IPv6].src == ip6_ll_address\r\n\r\nmac_address =  get_if_hwaddr(conf.iface)\r\nprint p[Ether].src, mac_address\r\nassert p[Ether].src == get_if_hwaddr(conf.iface)\r\n\r\nos.system(\"ip link del name dev scapy0\")\r\n```\r\n\r\nFiltering unneeded routes works as a temporary workaround:\r\n```python\r\nconf.route6.routes = [r6 for r6 in conf.route6.routes if r6[3] == conf.iface\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1171/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1171/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1166", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1166/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1166/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1166/events", "html_url": "https://github.com/secdev/scapy/issues/1166", "id": 298863952, "node_id": "MDU6SXNzdWUyOTg4NjM5NTI=", "number": 1166, "title": "Interactive console: global variables (including functions) cannot be used in functions", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2018-02-21T07:16:03Z", "updated_at": "2018-02-21T16:35:28Z", "closed_at": "2018-02-21T16:35:28Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "How to reproduce:\r\n```\r\n>>> y = 1\r\n>>> def mytest(): print(y)\r\n---------------------------------------------------------------------------\r\nNameError                                 Traceback (most recent call last)\r\n<ipython-input-6-2d51dd513d71> in <module>()\r\n----> 1 mytest()\r\n\r\n<ipython-input-5-9edb5753faac> in mytest()\r\n----> 1 def mytest(): print(y)\r\n\r\nNameError: global name 'y' is not defined\r\n```\r\n\r\nWith a function:\r\n```\r\n>>> def test(x): print(x)\r\n>>> def mytest(x): test(x)\r\n>>> mytest(12)\r\n---------------------------------------------------------------------------\r\nNameError                                 Traceback (most recent call last)\r\n<ipython-input-3-7175042db3ff> in <module>()\r\n----> 1 mytest(12)\r\n\r\n<ipython-input-2-481b5742c96d> in mytest(x)\r\n----> 1 def mytest(x): test(x)\r\n\r\nNameError: global name 'test' is not defined\r\n```\r\n\r\nAccording to `git bissect`, this issue has been introduced in 887a9676436a3ed03419497b454b457ecbd13938.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1166/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1166/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1126", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1126/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1126/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1126/events", "html_url": "https://github.com/secdev/scapy/pull/1126", "id": 294369476, "node_id": "MDExOlB1bGxSZXF1ZXN0MTY3MTI2Nzcw", "number": 1126, "title": "Fix implicit packets with tuple in lists", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-02-05T12:03:35Z", "updated_at": "2018-02-05T13:37:27Z", "closed_at": "2018-02-05T12:37:44Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1126", "html_url": "https://github.com/secdev/scapy/pull/1126", "diff_url": "https://github.com/secdev/scapy/pull/1126.diff", "patch_url": "https://github.com/secdev/scapy/pull/1126.patch", "merged_at": "2018-02-05T12:37:44Z"}, "body": "Fixes #1118", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1126/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1126/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1125", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1125/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1125/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1125/events", "html_url": "https://github.com/secdev/scapy/pull/1125", "id": 294364535, "node_id": "MDExOlB1bGxSZXF1ZXN0MTY3MTIzMTM3", "number": 1125, "title": "Utils: fix do_graph() (proc.stdin was not closed)", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2018-02-05T11:45:07Z", "updated_at": "2018-02-05T13:37:53Z", "closed_at": "2018-02-05T13:17:17Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1125", "html_url": "https://github.com/secdev/scapy/pull/1125", "diff_url": "https://github.com/secdev/scapy/pull/1125.diff", "patch_url": "https://github.com/secdev/scapy/pull/1125.patch", "merged_at": "2018-02-05T13:17:17Z"}, "body": "Graphs were broken, at least under Linux when using direct display (i.e., when not target is specified).", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1125/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1125/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1118", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1118/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1118/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1118/events", "html_url": "https://github.com/secdev/scapy/issues/1118", "id": 293800732, "node_id": "MDU6SXNzdWUyOTM4MDA3MzI=", "number": 1118, "title": "\"Generating sets of packets\" (as explained in the documentation) does not work for mixed sequence and range (e.g. IP(ttl=[1,2,(5,9)]))", "user": {"login": "qupfer", "id": 2614431, "node_id": "MDQ6VXNlcjI2MTQ0MzE=", "avatar_url": "https://avatars.githubusercontent.com/u/2614431?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qupfer", "html_url": "https://github.com/qupfer", "followers_url": "https://api.github.com/users/qupfer/followers", "following_url": "https://api.github.com/users/qupfer/following{/other_user}", "gists_url": "https://api.github.com/users/qupfer/gists{/gist_id}", "starred_url": "https://api.github.com/users/qupfer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qupfer/subscriptions", "organizations_url": "https://api.github.com/users/qupfer/orgs", "repos_url": "https://api.github.com/users/qupfer/repos", "events_url": "https://api.github.com/users/qupfer/events{/privacy}", "received_events_url": "https://api.github.com/users/qupfer/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-02-02T07:48:04Z", "updated_at": "2018-02-05T12:37:44Z", "closed_at": "2018-02-05T12:37:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\nas explained in the [tutorial](http://scapy.readthedocs.io/en/latest/usage.html#generating-sets-of-packets)  \r\nthese two lines \r\n`b=IP(ttl=[1,2,(5,9)])`\r\n`[p for p in b]` \r\nshould create a set of 7 packets, like\r\n`[<IP ttl=1 |>, <IP ttl=2 |>, <IP ttl=5 |>, <IP ttl=6 |>, <IP ttl=7 |>, <IP ttl=8 |>, <IP ttl=9 |>]`.\r\n\r\nBut the result is just:\r\n`[<IP  ttl=1 |>, <IP  ttl=2 |>, <IP  ttl=(5, 9) |>]`\r\n\r\nIf I just use a \"sequence\" (`IP(ttl=[1,2,5,7,9])`) or \"range\" (`IP(ttl=(1,9)`), the result is that I expected. \r\n\r\nSo, there are recent changesin scpay and the documentation is outdated or Is this a bug or I'm just stupid ;) ?\r\n\r\nThanks!", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1118/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1118/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1101", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1101/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1101/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1101/events", "html_url": "https://github.com/secdev/scapy/pull/1101", "id": 292819280, "node_id": "MDExOlB1bGxSZXF1ZXN0MTY2MDA4NDc0", "number": 1101, "title": "Store and use wirelen value for packets read from PCAP(NG) files ", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-01-30T15:13:48Z", "updated_at": "2018-01-31T12:03:20Z", "closed_at": "2018-01-31T08:02:01Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1101", "html_url": "https://github.com/secdev/scapy/pull/1101", "diff_url": "https://github.com/secdev/scapy/pull/1101.diff", "patch_url": "https://github.com/secdev/scapy/pull/1101.patch", "merged_at": "2018-01-31T08:02:00Z"}, "body": "Fixes #1083.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1101/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1101/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1098", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1098/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1098/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1098/events", "html_url": "https://github.com/secdev/scapy/pull/1098", "id": 292221465, "node_id": "MDExOlB1bGxSZXF1ZXN0MTY1NTc3MTc5", "number": 1098, "title": "Do not use '_' in unit tests", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2018-01-28T17:20:24Z", "updated_at": "2018-01-30T12:51:53Z", "closed_at": "2018-01-30T12:51:06Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1098", "html_url": "https://github.com/secdev/scapy/pull/1098", "diff_url": "https://github.com/secdev/scapy/pull/1098.diff", "patch_url": "https://github.com/secdev/scapy/pull/1098.patch", "merged_at": "2018-01-30T12:51:06Z"}, "body": "This PR removes '_' in unit tests. I add some issues on Python 3.6 on osx.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1098/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1098/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1097", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1097/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1097/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1097/events", "html_url": "https://github.com/secdev/scapy/pull/1097", "id": 292213519, "node_id": "MDExOlB1bGxSZXF1ZXN0MTY1NTcyMjk1", "number": 1097, "title": "Use the key argument with sort()", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2018-01-28T15:35:04Z", "updated_at": "2018-01-30T14:31:49Z", "closed_at": "2018-01-30T14:27:58Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1097", "html_url": "https://github.com/secdev/scapy/pull/1097", "diff_url": "https://github.com/secdev/scapy/pull/1097.diff", "patch_url": "https://github.com/secdev/scapy/pull/1097.patch", "merged_at": "2018-01-30T14:27:58Z"}, "body": "Long story short: this PR fixes an issue with Python3 on osx. It was discovered during the first _successful_ automated tests on osx!\r\n\r\nI am not happy with the indentation. Ideas are welcome.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1097/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1097/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1083", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1083/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1083/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1083/events", "html_url": "https://github.com/secdev/scapy/issues/1083", "id": 290925212, "node_id": "MDU6SXNzdWUyOTA5MjUyMTI=", "number": 1083, "title": "on-the-wire packet length lost", "user": {"login": "jonesrick", "id": 35042652, "node_id": "MDQ6VXNlcjM1MDQyNjUy", "avatar_url": "https://avatars.githubusercontent.com/u/35042652?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonesrick", "html_url": "https://github.com/jonesrick", "followers_url": "https://api.github.com/users/jonesrick/followers", "following_url": "https://api.github.com/users/jonesrick/following{/other_user}", "gists_url": "https://api.github.com/users/jonesrick/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonesrick/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonesrick/subscriptions", "organizations_url": "https://api.github.com/users/jonesrick/orgs", "repos_url": "https://api.github.com/users/jonesrick/repos", "events_url": "https://api.github.com/users/jonesrick/events{/privacy}", "received_events_url": "https://api.github.com/users/jonesrick/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-01-23T17:24:09Z", "updated_at": "2018-01-31T08:02:01Z", "closed_at": "2018-01-31T08:02:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n[scapyd.pcap.gz](https://github.com/secdev/scapy/files/1656955/scapyd.pcap.gz)\r\n\r\n[orig.pcap.gz](https://github.com/secdev/scapy/files/1656954/orig.pcap.gz)\r\nIf one reads-in a pcap and then writes it out again, the on-the-wire packet length field of the per-packet pcap header gets set to the snaplen.  This causes issues with other utilities which sanity check packet headers against the on-the-wire length.\r\n\r\nFor example, reading the original capture in tcpdump:\r\n$ tcpdump -n -r orig.pcap \r\nreading from file orig.pcap, link-type EN10MB (Ethernet)\r\n11:26:29.212874 IP 10.138.0.5.54902 > 10.138.0.6.65432: Flags [S], seq 2786883070, win 28400, options [mss 1420,sackOK,TS val 2037739231 ecr 0,nop,wscale 7], length 0\r\n11:26:29.212936 IP 10.138.0.6.65432 > 10.138.0.5.54902: Flags [S.], seq 358205320, ack 2786883071, win 28160, options [mss 1420,sackOK,TS val 480578934 ecr 2037739231,nop,wscale 7], length 0\r\n11:26:29.212944 IP 10.138.0.5.54902 > 10.138.0.6.65432: Flags [.], ack 1, win 222, options [nop,nop,TS val 2037739231 ecr 480578934], length 0\r\n11:26:29.212958 IP 10.138.0.5.54902 > 10.138.0.6.65432: Flags [.], seq 1:7041, ack 1, win 222, options [nop,nop,TS val 2037739231 ecr 480578934], length 7040\r\n11:26:29.212962 IP 10.138.0.5.54902 > 10.138.0.6.65432: Flags [.], seq 7041:14081, ack 1, win 222, options [nop,nop,TS val 2037739231 ecr 480578934], length 7040\r\n\r\n\r\nAnd then after that pcap was read-in by scapy and written-out to another file:\r\n\r\n$ tcpdump -n -r scapyd.pcap \r\nreading from file scapyd.pcap, link-type EN10MB (Ethernet)\r\n11:26:29.212874 IP 10.138.0.5.54902 > 10.138.0.6.65432: Flags [S], seq 2786883070, win 28400, options [mss 1420,sackOK,TS val 2037739231 ecr 0,nop,wscale 7], length 0\r\n11:26:29.212936 IP 10.138.0.6.65432 > 10.138.0.5.54902: Flags [S.], seq 358205320, ack 2786883071, win 28160, options [mss 1420,sackOK,TS val 480578934 ecr 2037739231,nop,wscale 7], length 0\r\n11:26:29.212944 IP 10.138.0.5.54902 > 10.138.0.6.65432: Flags [.], ack 1, win 222, options [nop,nop,TS val 2037739231 ecr 480578934], length 0\r\n11:26:29.212958 IP truncated-ip - 7010 bytes missing! 10.138.0.5.54902 > 10.138.0.6.65432: Flags [.], seq 1:7041, ack 1, win 222, options [nop,nop,TS val 2037739231 ecr 480578934], length 7040\r\n11:26:29.212962 IP truncated-ip - 7010 bytes missing! 10.138.0.5.54902 > 10.138.0.6.65432: Flags [.], seq 7041:14081, ack 1, win 222, options [nop,nop,TS val 2037739231 ecr 480578934], length 7040\r\n\r\nThis also affects the willingness of utilities such as tshark to compute RTTs because the on-the-wire length stored in the per-packet pcap header does not match the packet lengths in the packet headers themselves.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1083/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1083/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1053", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1053/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1053/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1053/events", "html_url": "https://github.com/secdev/scapy/pull/1053", "id": 288632004, "node_id": "MDExOlB1bGxSZXF1ZXN0MTYyOTc5NjUw", "number": 1053, "title": "Python 3: fix make_table() sort with integers & IPs", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-01-15T15:29:01Z", "updated_at": "2018-01-16T14:28:23Z", "closed_at": "2018-01-16T13:42:50Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1053", "html_url": "https://github.com/secdev/scapy/pull/1053", "diff_url": "https://github.com/secdev/scapy/pull/1053.diff", "patch_url": "https://github.com/secdev/scapy/pull/1053.patch", "merged_at": "2018-01-16T13:42:50Z"}, "body": "Fixes #1052.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1053/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1053/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1040", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1040/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1040/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1040/events", "html_url": "https://github.com/secdev/scapy/pull/1040", "id": 288062243, "node_id": "MDExOlB1bGxSZXF1ZXN0MTYyNTg3NTgz", "number": 1040, "title": "Windows: fix version detection from git", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-01-12T09:49:15Z", "updated_at": "2018-01-13T18:20:12Z", "closed_at": "2018-01-13T17:32:25Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1040", "html_url": "https://github.com/secdev/scapy/pull/1040", "diff_url": "https://github.com/secdev/scapy/pull/1040.diff", "patch_url": "https://github.com/secdev/scapy/pull/1040.patch", "merged_at": "2018-01-13T17:32:25Z"}, "body": "Fixes #1039. Patch provided by @karpierz.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1040/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1040/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1033", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1033/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1033/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1033/events", "html_url": "https://github.com/secdev/scapy/pull/1033", "id": 287688009, "node_id": "MDExOlB1bGxSZXF1ZXN0MTYyMzEwMTY1", "number": 1033, "title": "Dot11: fix .summary() with a binary SSID", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2018-01-11T07:29:00Z", "updated_at": "2018-01-13T18:20:21Z", "closed_at": "2018-01-13T09:25:18Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1033", "html_url": "https://github.com/secdev/scapy/pull/1033", "diff_url": "https://github.com/secdev/scapy/pull/1033.diff", "patch_url": "https://github.com/secdev/scapy/pull/1033.patch", "merged_at": "2018-01-13T09:25:18Z"}, "body": "", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1033/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1033/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/1005", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/1005/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/1005/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/1005/events", "html_url": "https://github.com/secdev/scapy/pull/1005", "id": 284332983, "node_id": "MDExOlB1bGxSZXF1ZXN0MTU5OTgzMzk2", "number": 1005, "title": "Load startup files after init_session()", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2017-12-23T23:47:01Z", "updated_at": "2017-12-24T12:03:01Z", "closed_at": "2017-12-24T10:29:51Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/1005", "html_url": "https://github.com/secdev/scapy/pull/1005", "diff_url": "https://github.com/secdev/scapy/pull/1005.diff", "patch_url": "https://github.com/secdev/scapy/pull/1005.patch", "merged_at": "2017-12-24T10:29:51Z"}, "body": "Currently Scapy is not really loaded when the startup files are run, which makes it impossible to use Scapy functions in it.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/1005/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/1005/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/937", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/937/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/937/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/937/events", "html_url": "https://github.com/secdev/scapy/pull/937", "id": 271542282, "node_id": "MDExOlB1bGxSZXF1ZXN0MTUwOTAxNzU5", "number": 937, "title": "Python 2/3: replace .next() method calls with next() built-in calls", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 564414240, "node_id": "MDU6TGFiZWw1NjQ0MTQyNDA=", "url": "https://api.github.com/repos/secdev/scapy/labels/convergence", "name": "convergence", "color": "c2e0c6", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2017-11-06T16:45:01Z", "updated_at": "2017-11-07T09:08:27Z", "closed_at": "2017-11-07T09:08:24Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/937", "html_url": "https://github.com/secdev/scapy/pull/937", "diff_url": "https://github.com/secdev/scapy/pull/937.diff", "patch_url": "https://github.com/secdev/scapy/pull/937.patch", "merged_at": "2017-11-07T09:08:24Z"}, "body": "Fixes #936", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/937/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/937/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/935", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/935/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/935/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/935/events", "html_url": "https://github.com/secdev/scapy/pull/935", "id": 271138523, "node_id": "MDExOlB1bGxSZXF1ZXN0MTUwNjQzNDY0", "number": 935, "title": "Fix sr*() functions with retry parameter", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 517497389, "node_id": "MDU6TGFiZWw1MTc0OTczODk=", "url": "https://api.github.com/repos/secdev/scapy/labels/coverage", "name": "coverage", "color": "c2e0c6", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2017-11-03T22:46:57Z", "updated_at": "2017-11-04T10:15:42Z", "closed_at": "2017-11-04T10:15:38Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/935", "html_url": "https://github.com/secdev/scapy/pull/935", "diff_url": "https://github.com/secdev/scapy/pull/935.diff", "patch_url": "https://github.com/secdev/scapy/pull/935.patch", "merged_at": "2017-11-04T10:15:38Z"}, "body": "The functions sr*(), when used with a `retry=` parameter, only return answers received during the last try.\r\n\r\nThis bug has been introduced in 730c47b (merged in #845). A new test has been added to trigger it.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/935/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/935/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/907", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/907/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/907/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/907/events", "html_url": "https://github.com/secdev/scapy/pull/907", "id": 267957724, "node_id": "MDExOlB1bGxSZXF1ZXN0MTQ4MzQwODg2", "number": 907, "title": "Fix DADict objects", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2017-10-24T09:21:57Z", "updated_at": "2017-10-25T06:16:12Z", "closed_at": "2017-10-25T06:16:06Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/907", "html_url": "https://github.com/secdev/scapy/pull/907", "diff_url": "https://github.com/secdev/scapy/pull/907.diff", "patch_url": "https://github.com/secdev/scapy/pull/907.patch", "merged_at": "2017-10-25T06:16:06Z"}, "body": "Particularly, this fixes `ls(Ether, verbose=1)` (regression test added).", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/907/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/907/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/898", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/898/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/898/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/898/events", "html_url": "https://github.com/secdev/scapy/pull/898", "id": 266472515, "node_id": "MDExOlB1bGxSZXF1ZXN0MTQ3Mjg1MTU1", "number": 898, "title": "Fix IPython: check for old versions", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2017-10-18T12:21:52Z", "updated_at": "2017-10-19T21:04:27Z", "closed_at": "2017-10-19T21:04:22Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/898", "html_url": "https://github.com/secdev/scapy/pull/898", "diff_url": "https://github.com/secdev/scapy/pull/898.diff", "patch_url": "https://github.com/secdev/scapy/pull/898.patch", "merged_at": "2017-10-19T21:04:21Z"}, "body": "With old versions of IPython (FYI, Ubuntu 16.04.3 LTS packages IPython 2.4.1), Scapy tries to use IPython but fails, making Scapy unusable. Also, this PR makes `traitlets` a soft dependency when IPython is used.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/898/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/898/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/873", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/873/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/873/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/873/events", "html_url": "https://github.com/secdev/scapy/pull/873", "id": 264554826, "node_id": "MDExOlB1bGxSZXF1ZXN0MTQ1OTI2MTk5", "number": 873, "title": "Dot11: code cleaning, fixes and unit test", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 517497389, "node_id": "MDU6TGFiZWw1MTc0OTczODk=", "url": "https://api.github.com/repos/secdev/scapy/labels/coverage", "name": "coverage", "color": "c2e0c6", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2017-10-11T11:44:30Z", "updated_at": "2017-10-18T12:27:14Z", "closed_at": "2017-10-18T12:27:14Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/873", "html_url": "https://github.com/secdev/scapy/pull/873", "diff_url": "https://github.com/secdev/scapy/pull/873.diff", "patch_url": "https://github.com/secdev/scapy/pull/873.patch", "merged_at": "2017-10-18T12:27:14Z"}, "body": "This PR does the following:\r\n - it removes the useless `airpwn()` function\r\n - it fixes `WiFi_am`\r\n- it adds a unit test for `WiFi_am`", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/873/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/873/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/871", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/871/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/871/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/871/events", "html_url": "https://github.com/secdev/scapy/pull/871", "id": 263907284, "node_id": "MDExOlB1bGxSZXF1ZXN0MTQ1NDYyMTM4", "number": 871, "title": "Fix more specific routes processing", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2017-10-09T14:05:26Z", "updated_at": "2017-10-19T21:05:07Z", "closed_at": "2017-10-19T21:05:07Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/871", "html_url": "https://github.com/secdev/scapy/pull/871", "diff_url": "https://github.com/secdev/scapy/pull/871.diff", "patch_url": "https://github.com/secdev/scapy/pull/871.patch", "merged_at": "2017-10-19T21:05:07Z"}, "body": "This PR attempts to fix #614 and provides a unit test.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/871/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/871/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/869", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/869/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/869/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/869/events", "html_url": "https://github.com/secdev/scapy/pull/869", "id": 263108751, "node_id": "MDExOlB1bGxSZXF1ZXN0MTQ0OTAzNjA4", "number": 869, "title": "Close handles opened using pcapy", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2017-10-05T12:35:57Z", "updated_at": "2017-10-06T12:17:20Z", "closed_at": "2017-10-06T12:17:17Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/869", "html_url": "https://github.com/secdev/scapy/pull/869", "diff_url": "https://github.com/secdev/scapy/pull/869.diff", "patch_url": "https://github.com/secdev/scapy/pull/869.patch", "merged_at": "2017-10-06T12:17:17Z"}, "body": "The .close() method has been recently added to pcapy objects (see\r\nhttps://github.com/CoreSecurity/pcapy/issues/30 &\r\nhttps://github.com/CoreSecurity/pcapy/pull/35).", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/869/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/869/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/868", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/868/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/868/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/868/events", "html_url": "https://github.com/secdev/scapy/pull/868", "id": 263088023, "node_id": "MDExOlB1bGxSZXF1ZXN0MTQ0ODg4OTQz", "number": 868, "title": "Some Python 3 fixes", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2017-10-05T11:18:37Z", "updated_at": "2017-10-05T19:33:31Z", "closed_at": "2017-10-05T15:27:21Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/868", "html_url": "https://github.com/secdev/scapy/pull/868", "diff_url": "https://github.com/secdev/scapy/pull/868.diff", "patch_url": "https://github.com/secdev/scapy/pull/868.patch", "merged_at": "2017-10-05T15:27:21Z"}, "body": "", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/868/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/868/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/866", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/866/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/866/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/866/events", "html_url": "https://github.com/secdev/scapy/pull/866", "id": 262861597, "node_id": "MDExOlB1bGxSZXF1ZXN0MTQ0NzI0NzMz", "number": 866, "title": "Python 3: fix sndrcv", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2017-10-04T17:05:45Z", "updated_at": "2017-10-04T21:01:08Z", "closed_at": "2017-10-04T21:01:08Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/866", "html_url": "https://github.com/secdev/scapy/pull/866", "diff_url": "https://github.com/secdev/scapy/pull/866.diff", "patch_url": "https://github.com/secdev/scapy/pull/866.patch", "merged_at": "2017-10-04T21:01:08Z"}, "body": "A test introduced in #838 catches a bug with Python 3. Good job @guedou!", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/866/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/866/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/863", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/863/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/863/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/863/events", "html_url": "https://github.com/secdev/scapy/pull/863", "id": 262687963, "node_id": "MDExOlB1bGxSZXF1ZXN0MTQ0NTk2Mjc0", "number": 863, "title": "Fix get_temp_file() to use NamedTemporaryFile() properly", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2017-10-04T07:11:35Z", "updated_at": "2017-10-04T16:13:31Z", "closed_at": "2017-10-04T15:55:33Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/863", "html_url": "https://github.com/secdev/scapy/pull/863", "diff_url": "https://github.com/secdev/scapy/pull/863.diff", "patch_url": "https://github.com/secdev/scapy/pull/863.patch", "merged_at": "2017-10-04T15:55:33Z"}, "body": "", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/863/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/863/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/841", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/841/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/841/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/841/events", "html_url": "https://github.com/secdev/scapy/issues/841", "id": 260741534, "node_id": "MDU6SXNzdWUyNjA3NDE1MzQ=", "number": 841, "title": "Sockets are always beeing closed", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2017-09-26T19:28:00Z", "updated_at": "2019-01-30T21:00:22Z", "closed_at": "2019-01-30T21:00:22Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "In `sendrecv.py`, we are always closing the sockets after use. This can result in strange behaviors:\r\n\r\n```\r\n>>> a = conf.L2socket()\r\n>>> send(IP(), socket=a) # Works but closes socket at the end\r\n>>> send(IP(), socket=a) # Fails\r\nWindowsError: exception.....\r\n```", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/841/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/841/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/840", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/840/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/840/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/840/events", "html_url": "https://github.com/secdev/scapy/issues/840", "id": 260654000, "node_id": "MDU6SXNzdWUyNjA2NTQwMDA=", "number": 840, "title": "AttributeError: 'StreamSocket' object has no attribute 'nonblock_recv'", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2017-09-26T14:50:11Z", "updated_at": "2017-10-04T18:35:36Z", "closed_at": "2017-10-04T18:35:36Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "It seems that PR #838 discovered a bug =)\r\n\r\n@p-l- can you have a look at https://travis-ci.org/secdev/scapy/jobs/279841738 and https://github.com/secdev/scapy/blob/master/scapy/sendrecv.py#L116 ?\r\n\r\nI believe that the `or` should me an `and`.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/840/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/840/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/812", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/812/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/812/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/812/events", "html_url": "https://github.com/secdev/scapy/pull/812", "id": 258044964, "node_id": "MDExOlB1bGxSZXF1ZXN0MTQxMzE0NjU2", "number": 812, "title": "Fix #791 - Throw an exception when tcpreplay can not be executed", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2017-09-15T13:45:38Z", "updated_at": "2018-01-11T16:16:35Z", "closed_at": "2018-01-11T16:16:35Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/812", "html_url": "https://github.com/secdev/scapy/pull/812", "diff_url": "https://github.com/secdev/scapy/pull/812.diff", "patch_url": "https://github.com/secdev/scapy/pull/812.patch", "merged_at": "2018-01-11T16:16:34Z"}, "body": "After discussions with @rjarry and @p-l- an exception is now raised when `tcpreplay` can not be executed. Other use of `log_interactive` in Scapy are indeed not similar.\r\n\r\nOLD TEXT\r\nAfter discussuions with @p-l- and @rjarry \r\n\r\nThis should fix #791 i.e. no log messages are displayed when using Scapy as a module.\r\n\r\nThe patch detects a previously acquired logger in order to add a StreamHandler or not.\r\n\r\n@rjarry does this look ok ?", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/812/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/812/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/805", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/805/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/805/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/805/events", "html_url": "https://github.com/secdev/scapy/pull/805", "id": 256291948, "node_id": "MDExOlB1bGxSZXF1ZXN0MTQwMDY1OTI5", "number": 805, "title": "Make FlagValue objects hashable", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2017-09-08T15:34:04Z", "updated_at": "2017-09-10T20:35:04Z", "closed_at": "2017-09-10T19:58:18Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/805", "html_url": "https://github.com/secdev/scapy/pull/805", "diff_url": "https://github.com/secdev/scapy/pull/805.diff", "patch_url": "https://github.com/secdev/scapy/pull/805.patch", "merged_at": "2017-09-10T19:58:18Z"}, "body": "This will make them usable as set elements or dict or Counter keys.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/805/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/805/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/789", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/789/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/789/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/789/events", "html_url": "https://github.com/secdev/scapy/pull/789", "id": 253736097, "node_id": "MDExOlB1bGxSZXF1ZXN0MTM4MjM0NTA1", "number": 789, "title": "Fix layers import", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 267691054, "node_id": "MDU6TGFiZWwyNjc2OTEwNTQ=", "url": "https://api.github.com/repos/secdev/scapy/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2017-08-29T17:00:25Z", "updated_at": "2017-09-01T12:26:23Z", "closed_at": "2017-09-01T12:23:25Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/789", "html_url": "https://github.com/secdev/scapy/pull/789", "diff_url": "https://github.com/secdev/scapy/pull/789.diff", "patch_url": "https://github.com/secdev/scapy/pull/789.patch", "merged_at": "2017-09-01T12:23:25Z"}, "body": "This PR simplifies the way layers are loaded when running Scapy. It fixes Scapy under OpenBSD at least (currently broken). I also had to clean-up the imports in DHCPv6 layer.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/789/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/789/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/758", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/758/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/758/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/758/events", "html_url": "https://github.com/secdev/scapy/pull/758", "id": 249448654, "node_id": "MDExOlB1bGxSZXF1ZXN0MTM1MjAxMjY5", "number": 758, "title": "Linux/sniff: warn instead of crash when we fail to create a valid filter", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2017-08-10T19:17:25Z", "updated_at": "2017-08-11T13:10:08Z", "closed_at": "2017-08-11T11:36:46Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/758", "html_url": "https://github.com/secdev/scapy/pull/758", "diff_url": "https://github.com/secdev/scapy/pull/758.diff", "patch_url": "https://github.com/secdev/scapy/pull/758.patch", "merged_at": "2017-08-11T11:36:46Z"}, "body": "Fixes #722.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/758/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/758/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/757", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/757/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/757/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/757/events", "html_url": "https://github.com/secdev/scapy/pull/757", "id": 249429825, "node_id": "MDExOlB1bGxSZXF1ZXN0MTM1MTg3MDUz", "number": 757, "title": "srloop(): remove unwanted output when verbose=0", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2017-08-10T18:05:23Z", "updated_at": "2017-08-11T13:10:18Z", "closed_at": "2017-08-11T11:32:55Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/757", "html_url": "https://github.com/secdev/scapy/pull/757", "diff_url": "https://github.com/secdev/scapy/pull/757.diff", "patch_url": "https://github.com/secdev/scapy/pull/757.patch", "merged_at": "2017-08-11T11:32:55Z"}, "body": "Fixes #750.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/757/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/757/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/694", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/694/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/694/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/694/events", "html_url": "https://github.com/secdev/scapy/pull/694", "id": 238822787, "node_id": "MDExOlB1bGxSZXF1ZXN0MTI3NjczNDg5", "number": 694, "title": "Don't call randval() on unused ConditionalField", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-06-27T11:41:27Z", "updated_at": "2017-07-20T12:45:18Z", "closed_at": "2017-07-20T12:45:18Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/694", "html_url": "https://github.com/secdev/scapy/pull/694", "diff_url": "https://github.com/secdev/scapy/pull/694.diff", "patch_url": "https://github.com/secdev/scapy/pull/694.patch", "merged_at": "2017-07-20T12:45:18Z"}, "body": "This PR attempts to fix #529.\r\n\r\nWhen a packet uses `ConditionalField`, the `randval()` method can be called when the field is not currently used. Concerning ICMP, there are two fields defined as \"unused\". During the first iteration, the first `unused` field stores a short and the second an integer. Scapy will try to fit an integer into a short and crash.\r\n\r\nThe following script crashes Scapy in ~2 seconds\r\n```python\r\nfrom scapy.all import *\r\n\r\nimport random\r\nrandom.seed(0x2807)\r\nwhile 1:\r\n    p = IP()/ICMP(type=11)\r\n    f = fuzz(p)\r\n    f.show()\r\n    str(f)\r\n```", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/694/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/694/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/636", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/636/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/636/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/636/events", "html_url": "https://github.com/secdev/scapy/pull/636", "id": 225195694, "node_id": "MDExOlB1bGxSZXF1ZXN0MTE4MjM2NzQw", "number": 636, "title": "Cleanup Nmap module, add tests", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 267691054, "node_id": "MDU6TGFiZWwyNjc2OTEwNTQ=", "url": "https://api.github.com/repos/secdev/scapy/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}, {"id": 517497389, "node_id": "MDU6TGFiZWw1MTc0OTczODk=", "url": "https://api.github.com/repos/secdev/scapy/labels/coverage", "name": "coverage", "color": "c2e0c6", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2017-04-28T21:19:11Z", "updated_at": "2017-09-17T10:16:02Z", "closed_at": "2017-05-02T09:34:33Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/636", "html_url": "https://github.com/secdev/scapy/pull/636", "diff_url": "https://github.com/secdev/scapy/pull/636.diff", "patch_url": "https://github.com/secdev/scapy/pull/636.patch", "merged_at": "2017-05-02T09:34:33Z"}, "body": "After #633, I though it might be a good idea to fix and cleanup the Nmap module.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/636/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/636/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/604", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/604/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/604/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/604/events", "html_url": "https://github.com/secdev/scapy/pull/604", "id": 221230846, "node_id": "MDExOlB1bGxSZXF1ZXN0MTE1NTE5MzU5", "number": 604, "title": "[coverage] Fix codecov results", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 517497389, "node_id": "MDU6TGFiZWw1MTc0OTczODk=", "url": "https://api.github.com/repos/secdev/scapy/labels/coverage", "name": "coverage", "color": "c2e0c6", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2017-04-12T11:21:16Z", "updated_at": "2017-09-11T14:03:55Z", "closed_at": "2017-04-12T15:21:46Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/604", "html_url": "https://github.com/secdev/scapy/pull/604", "diff_url": "https://github.com/secdev/scapy/pull/604.diff", "patch_url": "https://github.com/secdev/scapy/pull/604.patch", "merged_at": "2017-04-12T15:21:46Z"}, "body": "Code coverage percent reported by codecov was surprisingly low and incorrect. This was cause by filenames conflicts (such as core.py). between Scapy and Pyhon standard library.\r\n\r\nThis PR adds a .coveragerc do exclude some paths from coverage reports and adapts AppVeyor and Travis config files. Moreover it renames appveyor.yml to .appveyor.yml to make it consistent with Travis.\r\n\r\nThe coverage percent will be ~77% !", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/604/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/604/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/601", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/601/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/601/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/601/events", "html_url": "https://github.com/secdev/scapy/pull/601", "id": 220636838, "node_id": "MDExOlB1bGxSZXF1ZXN0MTE1MDk1Mzk3", "number": 601, "title": "Smaller unit tests results", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2017-04-10T13:00:56Z", "updated_at": "2017-09-11T14:03:58Z", "closed_at": "2017-04-10T15:34:18Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/601", "html_url": "https://github.com/secdev/scapy/pull/601", "diff_url": "https://github.com/secdev/scapy/pull/601.diff", "patch_url": "https://github.com/secdev/scapy/pull/601.patch", "merged_at": "2017-04-10T15:34:18Z"}, "body": "Dumping `conf.manufdb` could result in a very large file (+2MB) while performing unit tests. The resulting HTML file takes ages to load on a browser.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/601/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/601/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/582", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/582/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/582/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/582/events", "html_url": "https://github.com/secdev/scapy/issues/582", "id": 217190581, "node_id": "MDU6SXNzdWUyMTcxOTA1ODE=", "number": 582, "title": "Can't get correct length with BitField", "user": {"login": "dark-lbp", "id": 3477662, "node_id": "MDQ6VXNlcjM0Nzc2NjI=", "avatar_url": "https://avatars.githubusercontent.com/u/3477662?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dark-lbp", "html_url": "https://github.com/dark-lbp", "followers_url": "https://api.github.com/users/dark-lbp/followers", "following_url": "https://api.github.com/users/dark-lbp/following{/other_user}", "gists_url": "https://api.github.com/users/dark-lbp/gists{/gist_id}", "starred_url": "https://api.github.com/users/dark-lbp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dark-lbp/subscriptions", "organizations_url": "https://api.github.com/users/dark-lbp/orgs", "repos_url": "https://api.github.com/users/dark-lbp/repos", "events_url": "https://api.github.com/users/dark-lbp/events{/privacy}", "received_events_url": "https://api.github.com/users/dark-lbp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-03-27T09:45:07Z", "updated_at": "2017-04-19T09:04:16Z", "closed_at": "2017-04-19T09:04:16Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "This is the code.\r\n```python\r\nfrom scapy.all import *\r\n\r\n\r\nclass Test(Packet):\r\n    name = \"Test\"\r\n    fields_desc = [\r\n        FieldLenField(\"BitCount\", None, fmt=\"H\", count_of=\"Values\"),\r\n        FieldLenField(\"ByteCount\", None, fmt=\"B\", length_of=\"Values\"),\r\n        FieldListField(\"Values\", [], BitField(\"data\", 0x0, size=1), count_from=lambda pkt: pkt.BitCount)\r\n    ]\r\n\r\n>>>packet = Test(Values=[0, 0, 0, 0, 1, 1, 1, 1])\r\n>>>packet.show2()\r\n###[ Test ]###\r\n  BitCount  = 8\r\n  ByteCount = 16\r\n  Values    = [0L, 0L, 0L, 0L, 1L, 1L, 1L, 1L]\r\n```\r\n\r\nI think `ByteCount` should not be 16. So i try to direct get size from `BitField`. But the size of `BitField` is always return 2.\r\n\r\n```python\r\nfrom scapy.all import *\r\n\r\n>>>packet = BitField(\"data\", 0x0, size=0x8)\r\n>>>packet.sz\r\n2\r\n>>>packet.i2len(packet,0x0)\r\n2\r\n>>>\r\n>>>packet = BitField(\"data\", 0x01020304, size=0x32)\r\n>>>packet.sz\r\n2\r\n>>>packet.i2len(packet,0x01020304)\r\n2\r\n```\r\n\r\nThis is the source code of `Field` object.\r\n```python\r\nclass Field(object):\r\n    \"\"\"For more informations on how this work, please refer to\r\n       http://www.secdev.org/projects/scapy/files/scapydoc.pdf\r\n       chapter ``Adding a New Field''\"\"\"\r\n    __slots__ = [\"name\", \"fmt\", \"default\", \"sz\", \"owners\"]\r\n    __metaclass__ = Field_metaclass\r\n    islist = 0\r\n    ismutable = False\r\n    holds_packets = 0\r\n    def __init__(self, name, default, fmt=\"H\"):\r\n        self.name = name\r\n        if fmt[0] in \"@=<>!\":\r\n            self.fmt = fmt\r\n        else:\r\n            self.fmt = \"!\"+fmt\r\n        self.default = self.any2i(None,default)\r\n        self.sz = struct.calcsize(self.fmt)\r\n        self.owners = []\r\n       ...\r\n       ...\r\n       ...\r\n    def i2len(self, pkt, x):\r\n        \"\"\"Convert internal value to a length usable by a FieldLenField\"\"\"\r\n        return self.sz\r\n```\r\nSince `BitField` didn't overwrite `i2len` method and \"fmt\", so it's will always return `struct.calcsize(\"!H\")`\r\n\r\nSo how can i get the correct length with BitField in bit or byte? ", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/582/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/582/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/554", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/554/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/554/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/554/events", "html_url": "https://github.com/secdev/scapy/pull/554", "id": 213720044, "node_id": "MDExOlB1bGxSZXF1ZXN0MTEwMzcxMDY1", "number": 554, "title": "[rewritten] PR #280", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2017-03-13T10:01:02Z", "updated_at": "2017-09-11T14:03:51Z", "closed_at": "2017-04-15T18:01:25Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/554", "html_url": "https://github.com/secdev/scapy/pull/554", "diff_url": "https://github.com/secdev/scapy/pull/554.diff", "patch_url": "https://github.com/secdev/scapy/pull/554.patch", "merged_at": "2017-04-15T18:01:24Z"}, "body": "Due to no recent activity from the author, I decided to fix the conflict and modify the patch. It is a good candidate for squashing.\r\n\r\nAs interface aliases tend to be an old Linux mechanism, I moved the logic from @prxyg3n into the `get_alias_address()`. Compared to the PR #280, this PR maintains the current Scapy behavior and only try to fix alias errors when needed.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/554/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/554/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/550", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/550/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/550/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/550/events", "html_url": "https://github.com/secdev/scapy/pull/550", "id": 212547317, "node_id": "MDExOlB1bGxSZXF1ZXN0MTA5NTYyNjI4", "number": 550, "title": "Improve TCP.answers()", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2017-03-07T20:20:43Z", "updated_at": "2017-03-09T20:53:41Z", "closed_at": "2017-03-09T13:18:28Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/550", "html_url": "https://github.com/secdev/scapy/pull/550", "diff_url": "https://github.com/secdev/scapy/pull/550.diff", "patch_url": "https://github.com/secdev/scapy/pull/550.patch", "merged_at": "2017-03-09T13:18:28Z"}, "body": "Without this code, when an out of connection TCP packet receives a\r\nTCP answer with flag RST and the ack set to 0, it is not seen as an\r\nanswer.\r\n\r\nThis comes without online regression tests because I have been unable to\r\nfind a reliable machine without firewall on the Internet.\r\n\r\nSimple test, if 192.168.0.1 has no firewall:\r\n\r\n```\r\n>>> sr(IP(dst=\"192.168.0.1\")/TCP(sport=80, dport=12345, flags='SA'),\r\n...    timeout=2)\r\n```\r\n\r\nThis test will not terminate without this patch.\r\n\r\nThis PR also adds more tests on flags and seq/ack values.\r\n\r\nNew tests have been added to check `TCP.answers()`.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/550/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/550/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/495", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/495/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/495/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/495/events", "html_url": "https://github.com/secdev/scapy/pull/495", "id": 203870199, "node_id": "MDExOlB1bGxSZXF1ZXN0MTAzNjQ2MTIx", "number": 495, "title": "inet_{pton,ntop}: reorganize, cleanup and improve tests", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 267691054, "node_id": "MDU6TGFiZWwyNjc2OTEwNTQ=", "url": "https://api.github.com/repos/secdev/scapy/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}, {"id": 514033136, "node_id": "MDU6TGFiZWw1MTQwMzMxMzY=", "url": "https://api.github.com/repos/secdev/scapy/labels/tests", "name": "tests", "color": "0e8a16", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2017-01-29T13:39:03Z", "updated_at": "2017-01-30T15:28:21Z", "closed_at": "2017-01-30T15:28:21Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/495", "html_url": "https://github.com/secdev/scapy/pull/495", "diff_url": "https://github.com/secdev/scapy/pull/495.diff", "patch_url": "https://github.com/secdev/scapy/pull/495.patch", "merged_at": "2017-01-30T15:28:21Z"}, "body": "The separated commits are meaningful and may help reviewing this PR.\r\n  - When `socket.inet_{pton,ntop}` functions exist, Scapy's `inet_{pton,ntop}` will support any address family supported by the `socket` module function.\r\n  - Addresses like `\"1234:5678:9abc:def0:1234:5678:9abc:def0:\"` will no longer erroneously be accepted by Scapy's `inet_pton` implementation.\r\n  - Exceptions raised by Scapy's implementations mimic those from the `socket` module.\r\n  - Some more test cases have been added.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/495/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/495/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/491", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/491/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/491/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/491/events", "html_url": "https://github.com/secdev/scapy/pull/491", "id": 203185046, "node_id": "MDExOlB1bGxSZXF1ZXN0MTAzMTc2OTYy", "number": 491, "title": "Enhance and fix ls()", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 267691054, "node_id": "MDU6TGFiZWwyNjc2OTEwNTQ=", "url": "https://api.github.com/repos/secdev/scapy/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}, {"id": 514033136, "node_id": "MDU6TGFiZWw1MTQwMzMxMzY=", "url": "https://api.github.com/repos/secdev/scapy/labels/tests", "name": "tests", "color": "0e8a16", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2017-01-25T18:32:58Z", "updated_at": "2017-09-17T10:16:04Z", "closed_at": "2017-01-28T07:33:47Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/491", "html_url": "https://github.com/secdev/scapy/pull/491", "diff_url": "https://github.com/secdev/scapy/pull/491.diff", "patch_url": "https://github.com/secdev/scapy/pull/491.patch", "merged_at": "2017-01-28T07:33:47Z"}, "body": "This PR:\r\n  - Fixes short flags display (when `verbose=1`).\r\n  - No longer displays \"(Emph)\" (for example in `ls(IP)` for `src` and `dst` fields).\r\n  - Fixes tuple values display (for example `ls(IP(ttl=(1, 10)))`).\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/491/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/491/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/490", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/490/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/490/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/490/events", "html_url": "https://github.com/secdev/scapy/pull/490", "id": 203174704, "node_id": "MDExOlB1bGxSZXF1ZXN0MTAzMTY5NTQx", "number": 490, "title": "Fix typo in tests", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2017-01-25T17:49:26Z", "updated_at": "2017-01-25T17:51:24Z", "closed_at": "2017-01-25T17:51:24Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/490", "html_url": "https://github.com/secdev/scapy/pull/490", "diff_url": "https://github.com/secdev/scapy/pull/490.diff", "patch_url": "https://github.com/secdev/scapy/pull/490.patch", "merged_at": "2017-01-25T17:51:24Z"}, "body": "", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/490/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/490/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/484", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/484/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/484/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/484/events", "html_url": "https://github.com/secdev/scapy/pull/484", "id": 202915890, "node_id": "MDExOlB1bGxSZXF1ZXN0MTAyOTg2NDMy", "number": 484, "title": "Fix 64 bits architectures detection", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2017-01-24T19:27:09Z", "updated_at": "2017-01-25T12:33:09Z", "closed_at": "2017-01-25T12:33:08Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/484", "html_url": "https://github.com/secdev/scapy/pull/484", "diff_url": "https://github.com/secdev/scapy/pull/484.diff", "patch_url": "https://github.com/secdev/scapy/pull/484.patch", "merged_at": "2017-01-25T12:33:08Z"}, "body": "Fixes #392.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/484/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/484/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/477", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/477/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/477/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/477/events", "html_url": "https://github.com/secdev/scapy/pull/477", "id": 201949037, "node_id": "MDExOlB1bGxSZXF1ZXN0MTAyMzI5NTYx", "number": 477, "title": "Make SourceIPField() .i2m() and i2h() methods consistent", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 514033136, "node_id": "MDU6TGFiZWw1MTQwMzMxMzY=", "url": "https://api.github.com/repos/secdev/scapy/labels/tests", "name": "tests", "color": "0e8a16", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2017-01-19T19:12:36Z", "updated_at": "2017-01-21T09:57:41Z", "closed_at": "2017-01-21T09:57:41Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/477", "html_url": "https://github.com/secdev/scapy/pull/477", "diff_url": "https://github.com/secdev/scapy/pull/477.diff", "patch_url": "https://github.com/secdev/scapy/pull/477.patch", "merged_at": "2017-01-21T09:57:41Z"}, "body": "Tests added. This fixes this bug:\r\n```\r\n>>> class Test(Packet): fields_desc = [SourceIPField(\"sourceip\", None)]\r\n... \r\n>>> Test(str(Test())).sourceip\r\n'0.0.0.0'\r\n>>> Test().sourceip\r\n'192.168.0.1'\r\n\r\n```", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/477/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/477/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/470", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/470/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/470/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/470/events", "html_url": "https://github.com/secdev/scapy/issues/470", "id": 200897219, "node_id": "MDU6SXNzdWUyMDA4OTcyMTk=", "number": 470, "title": "PicklingError with scapy 2.3.3", "user": {"login": "vapniks", "id": 174330, "node_id": "MDQ6VXNlcjE3NDMzMA==", "avatar_url": "https://avatars.githubusercontent.com/u/174330?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vapniks", "html_url": "https://github.com/vapniks", "followers_url": "https://api.github.com/users/vapniks/followers", "following_url": "https://api.github.com/users/vapniks/following{/other_user}", "gists_url": "https://api.github.com/users/vapniks/gists{/gist_id}", "starred_url": "https://api.github.com/users/vapniks/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vapniks/subscriptions", "organizations_url": "https://api.github.com/users/vapniks/orgs", "repos_url": "https://api.github.com/users/vapniks/repos", "events_url": "https://api.github.com/users/vapniks/events{/privacy}", "received_events_url": "https://api.github.com/users/vapniks/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2017-01-15T21:52:11Z", "updated_at": "2017-03-15T14:02:29Z", "closed_at": "2017-03-15T14:02:29Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\r\nme@mycomputer:tmp/> scapy -s scapysession1                                                                                  [21:25:30 17-01-15]!10077\r\nWARNING: No route found for IPv6 destination :: (no default route?)\r\nINFO: New session [scapysession1]\r\nWelcome to Scapy (2.3.3)\r\n>>> ip=IP(dst=\"192.168.0.10\")\r\n>>> ip\r\n<IP  dst=192.168.0.10 |>\r\n>>> \r\nTraceback (most recent call last):\r\n  File \"/usr/local/bin/scapy\", line 25, in <module>\r\n    interact()\r\n  File \"/usr/local/lib/python2.7/dist-packages/scapy/main.py\", line 385, in interact\r\n    save_session(conf.session, session)\r\n  File \"/usr/local/lib/python2.7/dist-packages/scapy/main.py\", line 146, in save_session\r\n    cPickle.dump(to_be_saved, f, pickleProto)\r\ncPickle.PicklingError: Can't pickle <type 'function'>: attribute lookup __builtin__.function failed\r\n\r\n```", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/470/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/470/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/466", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/466/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/466/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/466/events", "html_url": "https://github.com/secdev/scapy/pull/466", "id": 200804137, "node_id": "MDExOlB1bGxSZXF1ZXN0MTAxNTYxNTg5", "number": 466, "title": "Fix & improve source fields", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 267691054, "node_id": "MDU6TGFiZWwyNjc2OTEwNTQ=", "url": "https://api.github.com/repos/secdev/scapy/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}, {"id": 514033136, "node_id": "MDU6TGFiZWw1MTQwMzMxMzY=", "url": "https://api.github.com/repos/secdev/scapy/labels/tests", "name": "tests", "color": "0e8a16", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2017-01-14T13:39:35Z", "updated_at": "2017-01-16T19:15:30Z", "closed_at": "2017-01-16T19:15:30Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/466", "html_url": "https://github.com/secdev/scapy/pull/466", "diff_url": "https://github.com/secdev/scapy/pull/466.diff", "patch_url": "https://github.com/secdev/scapy/pull/466.patch", "merged_at": "2017-01-16T19:15:30Z"}, "body": "This PR brings a new feature to IP/IPv6 source fields (using `None` as destination means \"use the interface that has the default route\") and fixes a bug in all the source fields (`packet[layer].field` could return a different value than `packet.field`, an example has been added to the tests).", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/466/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/466/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/464", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/464/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/464/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/464/events", "html_url": "https://github.com/secdev/scapy/pull/464", "id": 200624512, "node_id": "MDExOlB1bGxSZXF1ZXN0MTAxNDQyNzgz", "number": 464, "title": "[coverage] VRRP, L2TP, HSRP, RIP, & Radius tests", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 517497389, "node_id": "MDU6TGFiZWw1MTc0OTczODk=", "url": "https://api.github.com/repos/secdev/scapy/labels/coverage", "name": "coverage", "color": "c2e0c6", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2017-01-13T12:58:08Z", "updated_at": "2017-09-11T14:03:11Z", "closed_at": "2017-01-20T07:30:22Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/464", "html_url": "https://github.com/secdev/scapy/pull/464", "diff_url": "https://github.com/secdev/scapy/pull/464.diff", "patch_url": "https://github.com/secdev/scapy/pull/464.patch", "merged_at": "2017-01-20T07:30:22Z"}, "body": "Here are some fixes and tests for VRRP, L2TP, HSRP, RIP, & Radius.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/464/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/464/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/459", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/459/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/459/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/459/events", "html_url": "https://github.com/secdev/scapy/pull/459", "id": 200144736, "node_id": "MDExOlB1bGxSZXF1ZXN0MTAxMTAyOTMz", "number": 459, "title": "Fix empty LLTDAttribute build & dissect", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 514033136, "node_id": "MDU6TGFiZWw1MTQwMzMxMzY=", "url": "https://api.github.com/repos/secdev/scapy/labels/tests", "name": "tests", "color": "0e8a16", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2017-01-11T16:42:07Z", "updated_at": "2017-01-11T20:09:44Z", "closed_at": "2017-01-11T20:09:44Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/459", "html_url": "https://github.com/secdev/scapy/pull/459", "diff_url": "https://github.com/secdev/scapy/pull/459.diff", "patch_url": "https://github.com/secdev/scapy/pull/459.patch", "merged_at": "2017-01-11T20:09:44Z"}, "body": "  - LLTDAttribute() produces a Raw instance (or crashes, when\r\n    conf.debug_dissector is set).\r\n  - str(LLTDAttribute(type=18)) crashes.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/459/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/459/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/448", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/448/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/448/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/448/events", "html_url": "https://github.com/secdev/scapy/pull/448", "id": 198831258, "node_id": "MDExOlB1bGxSZXF1ZXN0MTAwMjAzNjA0", "number": 448, "title": "Fix ls(): fix layer names and handle tuple default values (test added)", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2017-01-04T22:49:19Z", "updated_at": "2017-01-05T12:08:32Z", "closed_at": "2017-01-05T12:08:32Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/448", "html_url": "https://github.com/secdev/scapy/pull/448", "diff_url": "https://github.com/secdev/scapy/pull/448.diff", "patch_url": "https://github.com/secdev/scapy/pull/448.patch", "merged_at": "2017-01-05T12:08:32Z"}, "body": "Current output of `ls()` is bogus, and `ls(ICMPv6NIQueryIPv6)` crashes.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/448/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/448/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/426", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/426/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/426/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/426/events", "html_url": "https://github.com/secdev/scapy/pull/426", "id": 197885862, "node_id": "MDExOlB1bGxSZXF1ZXN0OTk1NzE4MzY=", "number": 426, "title": "[coverage] More unit tests for scapy/*.py files", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 517497389, "node_id": "MDU6TGFiZWw1MTc0OTczODk=", "url": "https://api.github.com/repos/secdev/scapy/labels/coverage", "name": "coverage", "color": "c2e0c6", "default": false, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2016-12-28T17:11:13Z", "updated_at": "2017-09-11T14:03:12Z", "closed_at": "2017-01-22T13:12:45Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/426", "html_url": "https://github.com/secdev/scapy/pull/426", "diff_url": "https://github.com/secdev/scapy/pull/426.diff", "patch_url": "https://github.com/secdev/scapy/pull/426.patch", "merged_at": "2017-01-22T13:12:45Z"}, "body": "This PR add systematic unit tests to `scapy/*.py` files. It also fixes one issue and removes a useless function.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/426/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/426/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/422", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/422/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/422/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/422/events", "html_url": "https://github.com/secdev/scapy/pull/422", "id": 197624436, "node_id": "MDExOlB1bGxSZXF1ZXN0OTkzOTMxNDA=", "number": 422, "title": "Fix Windows bat files to work with spaces in paths (@gpotter2)", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2016-12-26T22:42:17Z", "updated_at": "2016-12-27T08:01:38Z", "closed_at": "2016-12-27T08:01:38Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/422", "html_url": "https://github.com/secdev/scapy/pull/422", "diff_url": "https://github.com/secdev/scapy/pull/422.diff", "patch_url": "https://github.com/secdev/scapy/pull/422.patch", "merged_at": "2016-12-27T08:01:38Z"}, "body": "Fixes #420", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/422/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/422/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/417", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/417/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/417/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/417/events", "html_url": "https://github.com/secdev/scapy/pull/417", "id": 197353357, "node_id": "MDExOlB1bGxSZXF1ZXN0OTkyMzA2ODE=", "number": 417, "title": "Fixed a bug in the sendrecv method when using multi-threading", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2016-12-23T11:20:38Z", "updated_at": "2016-12-23T13:59:31Z", "closed_at": "2016-12-23T13:59:31Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/417", "html_url": "https://github.com/secdev/scapy/pull/417", "diff_url": "https://github.com/secdev/scapy/pull/417.diff", "patch_url": "https://github.com/secdev/scapy/pull/417.patch", "merged_at": "2016-12-23T13:59:31Z"}, "body": "This is #267 with conflicts fixed + cleanup.\r\nFixes #267.\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/417/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/417/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/416", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/416/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/416/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/416/events", "html_url": "https://github.com/secdev/scapy/pull/416", "id": 197293023, "node_id": "MDExOlB1bGxSZXF1ZXN0OTkxODkzODY=", "number": 416, "title": "Preserve .overloaded_fields in .clone_with()", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2016-12-23T00:17:17Z", "updated_at": "2016-12-23T13:59:54Z", "closed_at": "2016-12-23T13:59:54Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/416", "html_url": "https://github.com/secdev/scapy/pull/416", "diff_url": "https://github.com/secdev/scapy/pull/416.diff", "patch_url": "https://github.com/secdev/scapy/pull/416.patch", "merged_at": "2016-12-23T13:59:54Z"}, "body": "This fixes at least #415 (for which a new test has been added)", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/416/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/416/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/415", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/415/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/415/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/415/events", "html_url": "https://github.com/secdev/scapy/issues/415", "id": 197239938, "node_id": "MDU6SXNzdWUxOTcyMzk5Mzg=", "number": 415, "title": "regression in fragment function", "user": {"login": "b-x", "id": 3099384, "node_id": "MDQ6VXNlcjMwOTkzODQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3099384?v=4", "gravatar_id": "", "url": "https://api.github.com/users/b-x", "html_url": "https://github.com/b-x", "followers_url": "https://api.github.com/users/b-x/followers", "following_url": "https://api.github.com/users/b-x/following{/other_user}", "gists_url": "https://api.github.com/users/b-x/gists{/gist_id}", "starred_url": "https://api.github.com/users/b-x/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/b-x/subscriptions", "organizations_url": "https://api.github.com/users/b-x/orgs", "repos_url": "https://api.github.com/users/b-x/repos", "events_url": "https://api.github.com/users/b-x/events{/privacy}", "received_events_url": "https://api.github.com/users/b-x/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2016-12-22T18:39:19Z", "updated_at": "2016-12-24T02:31:56Z", "closed_at": "2016-12-24T02:31:55Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The fragment function is broken since v2.3.3.\r\nTest case:\r\n```python\r\np = fragment(Ether() / IP() / UDP())[0]\r\nassert p[IP].proto == 17\r\nassert Ether(str(p))[IP].proto == 17  # bug!\r\n```", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/415/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/415/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/412", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/412/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/412/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/412/events", "html_url": "https://github.com/secdev/scapy/pull/412", "id": 196992965, "node_id": "MDExOlB1bGxSZXF1ZXN0OTg5NzYwODI=", "number": 412, "title": "Improve Pcap & PcapNg support (particularly timestamps)", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 267691054, "node_id": "MDU6TGFiZWwyNjc2OTEwNTQ=", "url": "https://api.github.com/repos/secdev/scapy/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2016-12-21T17:46:41Z", "updated_at": "2016-12-22T12:07:06Z", "closed_at": "2016-12-22T12:07:06Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/412", "html_url": "https://github.com/secdev/scapy/pull/412", "diff_url": "https://github.com/secdev/scapy/pull/412.diff", "patch_url": "https://github.com/secdev/scapy/pull/412.patch", "merged_at": "2016-12-22T12:07:06Z"}, "body": "This fixes #195 (support for Pcap files with nanosecond precision timestamp) + another (unreported) issue: timestamps are wrong in PcapNg format, discovered when writing new tests.\r\n\r\nThis also add support for arbitrary time precision in PcapNg, and for two (less common but sometimes found) more packet blocks.\r\n\r\nNew tests have been added to prevent regressions.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/412/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/412/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/409", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/409/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/409/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/409/events", "html_url": "https://github.com/secdev/scapy/pull/409", "id": 196915713, "node_id": "MDExOlB1bGxSZXF1ZXN0OTg5MjA2MDM=", "number": 409, "title": "Fix tiny bugs", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2016-12-21T12:00:07Z", "updated_at": "2016-12-21T13:20:27Z", "closed_at": "2016-12-21T13:20:27Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/409", "html_url": "https://github.com/secdev/scapy/pull/409", "diff_url": "https://github.com/secdev/scapy/pull/409.diff", "patch_url": "https://github.com/secdev/scapy/pull/409.patch", "merged_at": "2016-12-21T13:20:27Z"}, "body": "This fixes several tiny bugs (some with no effect) and adds some tests where possible and appropriate (the added tests fail with the current code).", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/409/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/409/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/408", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/408/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/408/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/408/events", "html_url": "https://github.com/secdev/scapy/issues/408", "id": 196897751, "node_id": "MDU6SXNzdWUxOTY4OTc3NTE=", "number": 408, "title": "Undefined method in ASN1 code", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2016-12-21T10:29:59Z", "updated_at": "2017-02-14T11:44:32Z", "closed_at": "2017-02-14T11:44:32Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Simple test to trigger the bug: `ASN1F_SEQUENCE_OF(\"test\", [], ASN1_INTEGER).randval()`\r\n```\r\n>>> ASN1F_SEQUENCE_OF(\"test\", [], ASN1_INTEGER).randval()\r\nTraceback (most recent call last):\r\n  File \"<console>\", line 1, in <module>\r\n  File \"scapy/asn1fields.py\", line 370, in randval\r\n    return packet.fuzz(self.asn1pkt())\r\nAttributeError: 'ASN1F_SEQUENCE_OF' object has no attribute 'asn1pkt'\r\n```", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/408/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/408/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/393", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/393/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/393/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/393/events", "html_url": "https://github.com/secdev/scapy/issues/393", "id": 195814293, "node_id": "MDU6SXNzdWUxOTU4MTQyOTM=", "number": 393, "title": "Scapy ignoring filter argument to sniff() function", "user": {"login": "nyov", "id": 438293, "node_id": "MDQ6VXNlcjQzODI5Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/438293?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nyov", "html_url": "https://github.com/nyov", "followers_url": "https://api.github.com/users/nyov/followers", "following_url": "https://api.github.com/users/nyov/following{/other_user}", "gists_url": "https://api.github.com/users/nyov/gists{/gist_id}", "starred_url": "https://api.github.com/users/nyov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nyov/subscriptions", "organizations_url": "https://api.github.com/users/nyov/orgs", "repos_url": "https://api.github.com/users/nyov/repos", "events_url": "https://api.github.com/users/nyov/events{/privacy}", "received_events_url": "https://api.github.com/users/nyov/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2016-12-15T14:08:15Z", "updated_at": "2022-05-19T12:38:22Z", "closed_at": "2016-12-20T06:46:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "Reopening bitbucket issue nr. 747, https://bitbucket.org/secdev/scapy/issues/747/scapy-ignoring-filter-argument-to-sniff\r\n\r\nScapy seems to ignore the `filter` argument to `sniff()` in my installation, scapy 2.3.2 on debian.\r\n\r\nI believe I can exclude tcpdump from being the issue as I moved it out of the way for this test, using an offline pcap file:\r\n```py\r\nIn [1]: from scapy.all import *\r\nWARNING: Failed to execute tcpdump. Check it is installed and in the PATH\r\n\r\nIn [2]: pkts = sniff(offline=\"/tmp/some.pcap\", filter=\"udp and host 7.7.7.7\", prn=lambda x: x.summary())\r\nEther / IP / TCP 192.5.XXX.XXX:33658 > 85.XX.XX.XX:8020 S\r\nEther / IP / TCP 85.XX.XX.XX:8020 > 192.5.XXX.XXX:33658 SA\r\n...\r\n```\r\nAs can be seen, the `udp` filter is ignored while listing all kinds of other packets (tcp, icmp etc., any source or destination).", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/393/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/393/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/392", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/392/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/392/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/392/events", "html_url": "https://github.com/secdev/scapy/issues/392", "id": 195753389, "node_id": "MDU6SXNzdWUxOTU3NTMzODk=", "number": 392, "title": "X86_64 is incorrect when running a 32bit binary under 64bit machine", "user": {"login": "weyou", "id": 5524708, "node_id": "MDQ6VXNlcjU1MjQ3MDg=", "avatar_url": "https://avatars.githubusercontent.com/u/5524708?v=4", "gravatar_id": "", "url": "https://api.github.com/users/weyou", "html_url": "https://github.com/weyou", "followers_url": "https://api.github.com/users/weyou/followers", "following_url": "https://api.github.com/users/weyou/following{/other_user}", "gists_url": "https://api.github.com/users/weyou/gists{/gist_id}", "starred_url": "https://api.github.com/users/weyou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/weyou/subscriptions", "organizations_url": "https://api.github.com/users/weyou/orgs", "repos_url": "https://api.github.com/users/weyou/repos", "events_url": "https://api.github.com/users/weyou/events{/privacy}", "received_events_url": "https://api.github.com/users/weyou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-12-15T09:17:18Z", "updated_at": "2017-01-25T12:33:08Z", "closed_at": "2017-01-25T12:33:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "I packed my program by PyInstaller under 32bit python.  When run it under 64bit machine. Got the following error:\r\n```\r\n  File \"scapy/sendrecv.py\", line 593, in sniff\r\n  File \"scapy/arch/linux.py\", line 496, in __init__\r\n  File \"scapy/arch/linux.py\", line 157, in attach_filter\r\n  File \"socket.py\", line 224, in meth\r\nsocket.error: [Errno 22] Invalid argument\r\n```\r\nI checked the source code of scapy,  the X86_64 is set to True, cause a wrong offset for the BPF in attach_filter is set .  \r\n\r\nIn this case,  I think the program should treat the runtime platform totally as a 32bit platform.\r\n\r\nI googled this issue and find some old issues are filed several years ago. But obviously, it has not get resolved.\r\nhttps://bitbucket.org/secdev/scapy/issues/486/scapy-misdetects-the-current-architecture\r\nhttps://bugs.debian.org/cgi-bin/bugreport.cgi?bug=594261\r\n\r\nHere is the patch for X86 platform:\r\n```\r\nfile: scapy/arch/consts.py\r\n@@ -5,6 +5,7 @@\r\n\r\n import os\r\n from sys import platform\r\n+import platform as pf\r\n\r\n LINUX = platform.startswith(\"linux\")\r\n OPENBSD = platform.startswith(\"openbsd\")\r\n@@ -20,7 +21,8 @@\r\n     ARM_64 = False\r\n else:\r\n     uname = os.uname()\r\n-    X86_64 = uname[4] == 'x86_64'\r\n+    X86_64 = pf.architecture()[0] == '64bit'\r\n     ARM_64 = uname[4] == 'aarch64'\r\n\r\n LOOPBACK_NAME = \"lo\" if LINUX else \"lo0\"\r\n```\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/392/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/392/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/370", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/370/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/370/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/370/events", "html_url": "https://github.com/secdev/scapy/pull/370", "id": 193298517, "node_id": "MDExOlB1bGxSZXF1ZXN0OTY0MDI0MTU=", "number": 370, "title": "setup: add scapy.arch.bpf module", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2016-12-03T16:27:21Z", "updated_at": "2016-12-05T21:03:03Z", "closed_at": "2016-12-05T21:03:03Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/370", "html_url": "https://github.com/secdev/scapy/pull/370", "diff_url": "https://github.com/secdev/scapy/pull/370.diff", "patch_url": "https://github.com/secdev/scapy/pull/370.patch", "merged_at": "2016-12-05T21:03:02Z"}, "body": "", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/370/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/370/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/369", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/369/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/369/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/369/events", "html_url": "https://github.com/secdev/scapy/pull/369", "id": 193071067, "node_id": "MDExOlB1bGxSZXF1ZXN0OTYyNDY5MjM=", "number": 369, "title": "Fix broken import on Windows", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2016-12-02T09:31:29Z", "updated_at": "2017-09-11T14:02:11Z", "closed_at": "2016-12-03T15:56:03Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/369", "html_url": "https://github.com/secdev/scapy/pull/369", "diff_url": "https://github.com/secdev/scapy/pull/369.diff", "patch_url": "https://github.com/secdev/scapy/pull/369.patch", "merged_at": "2016-12-03T15:56:03Z"}, "body": "The BPF patch breaks windows support. The issue was spotted thanks to the upcoming AppVeyor support.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/369/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/369/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/368", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/368/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/368/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/368/events", "html_url": "https://github.com/secdev/scapy/issues/368", "id": 192894018, "node_id": "MDU6SXNzdWUxOTI4OTQwMTg=", "number": 368, "title": "bluetooth.HCI_ACL_Hdr fields parsed incorrectly", "user": {"login": "tkuester", "id": 6379955, "node_id": "MDQ6VXNlcjYzNzk5NTU=", "avatar_url": "https://avatars.githubusercontent.com/u/6379955?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tkuester", "html_url": "https://github.com/tkuester", "followers_url": "https://api.github.com/users/tkuester/followers", "following_url": "https://api.github.com/users/tkuester/following{/other_user}", "gists_url": "https://api.github.com/users/tkuester/gists{/gist_id}", "starred_url": "https://api.github.com/users/tkuester/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tkuester/subscriptions", "organizations_url": "https://api.github.com/users/tkuester/orgs", "repos_url": "https://api.github.com/users/tkuester/repos", "events_url": "https://api.github.com/users/tkuester/events{/privacy}", "received_events_url": "https://api.github.com/users/tkuester/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2016-12-01T16:25:59Z", "updated_at": "2017-10-31T22:53:46Z", "closed_at": "2017-10-31T22:53:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "The Bluetooth HCI ACL Header has a nasty little field that scapy currently fails to parse correctly. From my brief understanding of code, it seems that the problem stems from not being able to handle little endian short bitfields.\r\n\r\n### Reference Material\r\nFrom page 676 of the Bluetooth 4.0 Core Spec PDF:\r\n\r\n![acl_hdr](https://cloud.githubusercontent.com/assets/6379955/20801250/41e9c2f2-b7b6-11e6-8666-3cadb6b7e809.png)\r\n\r\nA live packet captured from Wireshark:\r\n\r\n![wireshark_hci_acl](https://cloud.githubusercontent.com/assets/6379955/20801401/bdda5d40-b7b6-11e6-8f36-8b82db12e44f.png)\r\n\r\nIn this instance, the field has the char buffer value `[0x4c, 0x00]`, which as a short would be `0x004c`. You can parse the sub fields like so.\r\n\r\n```python\r\n(val, ) = struct.unpack('<H', '\\x4c\\x00')\r\nhandle = val & 0x0fff\r\npb_flag = (val & 0x3000) >> 12\r\nbc_flag = (val & 0xc000) >> 14\r\n```\r\n\r\n### Scapy's Current Handling\r\nThis incorrectly treats the handle and flags as 8-bit values.\r\n\r\n```python\r\nclass HCI_ACL_Hdr(Packet):\r\n    name = \"HCI ACL header\"\r\n    fields_desc = [ ByteField(\"handle\",0), # Actually, handle is 12 bits and flags is 4.\r\n                    ByteField(\"flags\",0),  # I wait to write a LEBitField\r\n                    LEShortField(\"len\",None), ]\r\n    def post_build(self, p, pay):\r\n        p += pay \r\n        if self.len is None:\r\n            l = len(p)-4\r\n            p = p[:2]+chr(l&0xff)+chr((l>>8)&0xff)+p[4:]\r\n        return p\r\n```\r\n\r\nInterestingly enough, the pb/bc_flags are treated differently depending on whether the packet is going Host -> Device or Device -> Host.\r\n\r\n### Temporary Fix\r\nI first tried using `fields.BitField` and `BitEnumField`, but I learned these work left to right. Since the field is a little endian short, the pb/bc flags split up the handle, rendering this approach useless.\r\n\r\nThe current method provides incorrect information for both fields, and only preserves the length field. This method lets us access the field as a unit, and delegates separating the sub-fields to the user. Not very scapy-like, but it restores some functionality to the code.\r\n\r\n```python\r\n    # ...\r\n    fields_desc = [ LEShortField(\"hflags\",0), # Mask with 0x0fff to get handle\r\n                    LEShortField(\"len\",None), ]\r\n    # ...\r\n```\r\n\r\n### Proposal\r\nCould you make a custom `class ACLHandleFlags(LEShortField)` under `layers.bluetooth` that handles this using `__slots__`?\r\n\r\nOr perhaps something like this?\r\n```python\r\nfields_desc = [LEBitField(width=16, {'pb_flag': (15, 14, {0: 'first flushable...'}),\r\n                                     'bc_flag': (13, 12, {0: 'more enum stuff...'),\r\n                                     'handle':  (11, 0, int)}),\r\n               LEShortField(\"len\", None)]\r\n```\r\n\r\nUnfortunately, I don't quite understand scapy's meta-programming to contribute!", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/368/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/368/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/365", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/365/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/365/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/365/events", "html_url": "https://github.com/secdev/scapy/issues/365", "id": 191853561, "node_id": "MDU6SXNzdWUxOTE4NTM1NjE=", "number": 365, "title": "[Windows] Scapy does not launch when wpcap.dll is not found", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2016-11-27T10:17:00Z", "updated_at": "2017-02-26T05:37:09Z", "closed_at": "2016-12-21T08:29:42Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "The following script could be used to reproduce the issue:\r\n```\r\nfrom scapy.all import *\r\nprint conf\r\n```\r\n\r\nThe resulting trace is the following:\r\n```\r\nTraceback (most recent call last):\r\n  File \"test/dump_conf.py\", line 1, in <module>\r\n    from scapy.all import *\r\n  File \"C:\\projects\\scapy-appveyor\\scapy\\all.py\", line 16, in <module>\r\n    from scapy.arch import *\r\n  File \"C:\\projects\\scapy-appveyor\\scapy\\arch\\__init__.py\", line 83, in <module>\r\n    from scapy.arch.windows import *\r\n  File \"C:\\projects\\scapy-appveyor\\scapy\\arch\\windows\\__init__.py\", line 37, in <module>\r\n    from scapy.arch import pcapdnet\r\n  File \"C:\\projects\\scapy-appveyor\\scapy\\arch\\pcapdnet.py\", line 26, in <module>\r\n    from .winpcapy import *\r\n  File \"C:\\projects\\scapy-appveyor\\scapy\\arch\\winpcapy.py\", line 26, in <module>\r\n    _lib=CDLL('wpcap.dll')\r\n  File \"C:\\Python27\\lib\\ctypes\\__init__.py\", line 362, in __init__\r\n    self._handle = _dlopen(self._name, mode)\r\nWindowsError: [Error 126] The specified module could not be found\r\n\r\n```", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/365/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/365/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/356", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/356/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/356/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/356/events", "html_url": "https://github.com/secdev/scapy/pull/356", "id": 190577280, "node_id": "MDExOlB1bGxSZXF1ZXN0OTQ1Mjg4MTU=", "number": 356, "title": "Fix .trace3D()", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2016-11-20T19:21:41Z", "updated_at": "2016-11-21T14:54:29Z", "closed_at": "2016-11-21T14:54:28Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/356", "html_url": "https://github.com/secdev/scapy/pull/356", "diff_url": "https://github.com/secdev/scapy/pull/356.diff", "patch_url": "https://github.com/secdev/scapy/pull/356.patch", "merged_at": "2016-11-21T14:54:28Z"}, "body": "Should fix #353.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/356/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/356/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/351", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/351/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/351/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/351/events", "html_url": "https://github.com/secdev/scapy/issues/351", "id": 190393125, "node_id": "MDU6SXNzdWUxOTAzOTMxMjU=", "number": 351, "title": "Problem with socket recv/send buffer options", "user": {"login": "tebuch", "id": 3813303, "node_id": "MDQ6VXNlcjM4MTMzMDM=", "avatar_url": "https://avatars.githubusercontent.com/u/3813303?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tebuch", "html_url": "https://github.com/tebuch", "followers_url": "https://api.github.com/users/tebuch/followers", "following_url": "https://api.github.com/users/tebuch/following{/other_user}", "gists_url": "https://api.github.com/users/tebuch/gists{/gist_id}", "starred_url": "https://api.github.com/users/tebuch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tebuch/subscriptions", "organizations_url": "https://api.github.com/users/tebuch/orgs", "repos_url": "https://api.github.com/users/tebuch/repos", "events_url": "https://api.github.com/users/tebuch/events{/privacy}", "received_events_url": "https://api.github.com/users/tebuch/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2016-11-18T18:48:15Z", "updated_at": "2018-05-15T04:39:59Z", "closed_at": "2018-05-15T04:39:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am currently using version `2.3.3.dev22`. I am attempting to sniff some packets on one of the interfaces. It is currently hanging (does not receive any packets). I dug a bit into the code and these were my findings.\r\nThe actual hang occurs in the `select` call within the sniff  function (`sendrecv.py`)\r\n```python\r\nsel = select(sniff_sockets, [], [], remain)\r\n```\r\nThe cause of the hang as far as I can tell is because when the socket is created, it is given a large receive buffer size (2<sup>30</sup>) when it is initalized. This happens, I believe, at the end of the `L2ListenSocket` \\_\\_init\\_\\_ function.\r\n```python\r\nself.ins.setsockopt(socket.SOL_SOCKET, socket.SO_RCVBUF, 2**30)\r\n```\r\nI was playing around and decided to change that number to `2**30 - 1` only to discover that the `select` function __did not__ hang anymore. Any idea why this might be happening? What's the reason for using a large number for the buffer sizes?\r\n\r\nMy machine information:\r\n- CentOS 6.4\r\n- `/proc/sys/net/core/rmem_max` reports 1073741824 (2<sup>30</sup>)\r\n- `/proc/sys/net/core/wmem_max` reports 1073741824\r\n\r\nI also tried increasing those values with `sysctl -w` but that didn't help.\r\n\r\nAny help appreciated!", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/351/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/351/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/342", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/342/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/342/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/342/events", "html_url": "https://github.com/secdev/scapy/pull/342", "id": 188438100, "node_id": "MDExOlB1bGxSZXF1ZXN0OTMwOTk2Njc=", "number": 342, "title": "Travis CI: fix install & tests", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2016-11-10T07:25:45Z", "updated_at": "2016-11-10T16:09:22Z", "closed_at": "2016-11-10T16:08:50Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/342", "html_url": "https://github.com/secdev/scapy/pull/342", "diff_url": "https://github.com/secdev/scapy/pull/342.diff", "patch_url": "https://github.com/secdev/scapy/pull/342.patch", "merged_at": "2016-11-10T16:08:50Z"}, "body": "For some reason, `TRAVIS_SUDO` gets set to `\"false\"`, instead of `\"\"`, which was breaking \"regular\" (i.e., Linux, non-root) tests.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/342/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/342/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/335", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/335/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/335/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/335/events", "html_url": "https://github.com/secdev/scapy/pull/335", "id": 188204372, "node_id": "MDExOlB1bGxSZXF1ZXN0OTI5MzE2Nzk=", "number": 335, "title": "Fix ICMPv6MLQuery().hashret()", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2016-11-09T09:47:39Z", "updated_at": "2016-11-14T10:46:22Z", "closed_at": "2016-11-14T10:46:22Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/335", "html_url": "https://github.com/secdev/scapy/pull/335", "diff_url": "https://github.com/secdev/scapy/pull/335.diff", "patch_url": "https://github.com/secdev/scapy/pull/335.patch", "merged_at": "2016-11-14T10:46:22Z"}, "body": "This should fix #334.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/335/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/335/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/334", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/334/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/334/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/334/events", "html_url": "https://github.com/secdev/scapy/issues/334", "id": 188086989, "node_id": "MDU6SXNzdWUxODgwODY5ODk=", "number": 334, "title": "RFC error (from stack over flow)", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-11-08T19:51:50Z", "updated_at": "2016-11-14T10:46:22Z", "closed_at": "2016-11-14T10:46:22Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "What do you guys think of this:\r\nhttp://stackoverflow.com/a/39439585/5459467\r\n\r\n> That struct.pack has no chance of working, it at least should be:\r\n> \r\n> return struct.pack(\"HH\", *self.mladdr)+self.payload.hashnet()\r\n> So that struct.pack has no chance of receiving the two arguments needed for \"HH\". That is a bug.", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/334/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/334/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/326", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/326/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/326/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/326/events", "html_url": "https://github.com/secdev/scapy/pull/326", "id": 186511199, "node_id": "MDExOlB1bGxSZXF1ZXN0OTE3NjcyNjM=", "number": 326, "title": "setup.py: ensure __import__('scapy').VERSION uses the current directory", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-11-01T11:20:33Z", "updated_at": "2016-11-02T18:56:35Z", "closed_at": "2016-11-02T18:56:35Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/326", "html_url": "https://github.com/secdev/scapy/pull/326", "diff_url": "https://github.com/secdev/scapy/pull/326.diff", "patch_url": "https://github.com/secdev/scapy/pull/326.patch", "merged_at": null}, "body": "Unrelated to #321 (won't fix it). But I'm not sure whether this could be useful or not. @guedou @robin-jarry what do you think?", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/326/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/326/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/301", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/301/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/301/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/301/events", "html_url": "https://github.com/secdev/scapy/issues/301", "id": 182008316, "node_id": "MDU6SXNzdWUxODIwMDgzMTY=", "number": 301, "title": "Travis fails on OS X with pcap & dnet modules", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2016-10-10T12:57:52Z", "updated_at": "2016-12-14T10:08:46Z", "closed_at": "2016-12-14T10:08:46Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Travis tests fail on OS X.\n\nHere is a quick fix that must be investigated:\n\n``` python\n$ git diff --no-ext-diff scapy/layers/l2.py \ndiff --git a/scapy/layers/l2.py b/scapy/layers/l2.py\nindex eca516b..28bd2b9 100644\n--- a/scapy/layers/l2.py\n+++ b/scapy/layers/l2.py\n@@ -19,6 +19,7 @@ from scapy.fields import *\n from scapy.sendrecv import *\n from scapy.arch import get_if_hwaddr\n from scapy.utils import inet_ntoa, inet_aton\n+from scapy.arch.consts import LOOPBACK_NAME\n if conf.route is None:\n     # unused import, only to initialize conf.route\n     import scapy.route\n@@ -61,7 +62,7 @@ def getmacbyip(ip, chainCC=0):\n     if (tmp[0] & 0xf0) == 0xe0: # mcast @\n         return \"01:00:5e:%.2x:%.2x:%.2x\" % (tmp[1]&0x7f,tmp[2],tmp[3])\n     iff,a,gw = conf.route.route(ip)\n-    if ( (iff == \"lo\") or (ip == conf.route.get_if_bcast(iff)) ):\n+    if ( (iff == LOOPBACK_NAME) or (ip == conf.route.get_if_bcast(iff)) ):\n         return \"ff:ff:ff:ff:ff:ff\"\n     if gw != \"0.0\n```\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/301/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/301/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/296", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/296/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/296/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/296/events", "html_url": "https://github.com/secdev/scapy/pull/296", "id": 179291559, "node_id": "MDExOlB1bGxSZXF1ZXN0ODY3ODYyOTg=", "number": 296, "title": "Arch: move constant values to a new submodule", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2016-09-26T17:40:31Z", "updated_at": "2016-09-27T12:23:07Z", "closed_at": "2016-09-27T12:23:07Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/296", "html_url": "https://github.com/secdev/scapy/pull/296", "diff_url": "https://github.com/secdev/scapy/pull/296.diff", "patch_url": "https://github.com/secdev/scapy/pull/296.patch", "merged_at": "2016-09-27T12:23:07Z"}, "body": "This avoids a circular import issues affecting Windows platforms.\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/296/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/296/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/277", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/277/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/277/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/277/events", "html_url": "https://github.com/secdev/scapy/issues/277", "id": 173657820, "node_id": "MDU6SXNzdWUxNzM2NTc4MjA=", "number": 277, "title": "Scapy crashing on start Windows", "user": {"login": "gpotter2", "id": 10530980, "node_id": "MDQ6VXNlcjEwNTMwOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/10530980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gpotter2", "html_url": "https://github.com/gpotter2", "followers_url": "https://api.github.com/users/gpotter2/followers", "following_url": "https://api.github.com/users/gpotter2/following{/other_user}", "gists_url": "https://api.github.com/users/gpotter2/gists{/gist_id}", "starred_url": "https://api.github.com/users/gpotter2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gpotter2/subscriptions", "organizations_url": "https://api.github.com/users/gpotter2/orgs", "repos_url": "https://api.github.com/users/gpotter2/repos", "events_url": "https://api.github.com/users/gpotter2/events{/privacy}", "received_events_url": "https://api.github.com/users/gpotter2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 19, "created_at": "2016-08-28T17:37:50Z", "updated_at": "2018-04-17T19:08:42Z", "closed_at": "2016-10-20T10:02:10Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Hi,\nI'm having this issue with the last (dev) scapy version on windows 7 (all depedencies are installed)\n\n```\nC:\\Users\\Utilisateur\\Desktop\\scapy-master>scapy\nINFO: Can't import matplotlib. Won't be able to plot.\nINFO: Can't import PyX. Won't be able to use psdump() or pdfdump().\nTraceback (most recent call last):\n  File \"C:\\Python27\\Scripts\\\\scapy\", line 25, in <module>\n    interact()\n  File \"C:\\Python27\\lib\\site-packages\\scapy\\main.py\", line 300, in interact\n    scapy_builtins = __import__(\"all\",globals(),locals(),\".\").__dict__\n  File \"C:\\Python27\\lib\\site-packages\\scapy\\all.py\", line 16, in <module>\n    from scapy.arch import *\n  File \"C:\\Python27\\lib\\site-packages\\scapy\\arch\\__init__.py\", line 96, in <module>\n    from scapy.arch.windows import *\n  File \"C:\\Python27\\lib\\site-packages\\scapy\\arch\\windows\\__init__.py\", line 21, in <module>\n    from scapy.sendrecv import debug, srp1\n  File \"C:\\Python27\\lib\\site-packages\\scapy\\sendrecv.py\", line 15, in <module>\n    from scapy import arch\nImportError: cannot import name arch\n```\n\nI'll be happy to answer any of you questions :)\n\nBTW great soft !\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/277/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/277/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/267", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/267/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/267/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/267/events", "html_url": "https://github.com/secdev/scapy/pull/267", "id": 171262274, "node_id": "MDExOlB1bGxSZXF1ZXN0ODEzNzU2ODY=", "number": 267, "title": "Fixed a bug in the sendrecv method when using multi-threading", "user": {"login": "Rcarnus", "id": 8790185, "node_id": "MDQ6VXNlcjg3OTAxODU=", "avatar_url": "https://avatars.githubusercontent.com/u/8790185?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Rcarnus", "html_url": "https://github.com/Rcarnus", "followers_url": "https://api.github.com/users/Rcarnus/followers", "following_url": "https://api.github.com/users/Rcarnus/following{/other_user}", "gists_url": "https://api.github.com/users/Rcarnus/gists{/gist_id}", "starred_url": "https://api.github.com/users/Rcarnus/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Rcarnus/subscriptions", "organizations_url": "https://api.github.com/users/Rcarnus/orgs", "repos_url": "https://api.github.com/users/Rcarnus/repos", "events_url": "https://api.github.com/users/Rcarnus/events{/privacy}", "received_events_url": "https://api.github.com/users/Rcarnus/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2016-08-15T21:07:49Z", "updated_at": "2016-12-23T13:59:31Z", "closed_at": "2016-12-23T13:59:31Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/267", "html_url": "https://github.com/secdev/scapy/pull/267", "diff_url": "https://github.com/secdev/scapy/pull/267.diff", "patch_url": "https://github.com/secdev/scapy/pull/267.patch", "merged_at": null}, "body": "Like other people on the Internet I used to have troubles with the sr1 method, when using multi-threading (and pyqt4 in my case).\nTo reproduce the bug, start a simple Qt application, then try to send and receive any packet using the sr1 method wherever you want and it will result in something like the following:\n\n```\n      File \"TestCase.py\", line 123, in sendSYNnRecACK\n        synackpkt = sr1(pck, verbose=0, timeout=1, retry=-2)\n      File \"/usr/local/lib/python2.7/dist-packages/scapy/sendrecv.py\", line 354, in sr1 \n        a,b=sndrcv(s,x,*args,**kargs)\n      File \"/usr/local/lib/python2.7/dist-packages/scapy/sendrecv.py\", line 135, in sndrcv\n        inp, out, err = select(inmask,[],[], remaintime)\n    select.error: (4, 'Appel syst\\xc3\\xa8me interrompu')\n```\n\nThe last error meaning \"System call interrupted\".\n\nAs I am not a good developer it may be awful code (I let you judge of that) but it allowed me to solve my issue.\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/267/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/267/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/258", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/258/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/258/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/258/events", "html_url": "https://github.com/secdev/scapy/pull/258", "id": 169896161, "node_id": "MDExOlB1bGxSZXF1ZXN0ODA0MzE3Mzc=", "number": 258, "title": "Travis CI improvements", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 267691054, "node_id": "MDU6TGFiZWwyNjc2OTEwNTQ=", "url": "https://api.github.com/repos/secdev/scapy/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2016-08-08T10:58:20Z", "updated_at": "2017-09-11T14:02:01Z", "closed_at": "2016-08-12T11:36:08Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/258", "html_url": "https://github.com/secdev/scapy/pull/258", "diff_url": "https://github.com/secdev/scapy/pull/258.diff", "patch_url": "https://github.com/secdev/scapy/pull/258.patch", "merged_at": "2016-08-12T11:36:08Z"}, "body": "Here are some Travis CI changes:\n1. dump the conf `variable` before starting a test. That's useful to debug Travis CI runs;\n2. use the pcap/dnet modules. On Linux, the typo (`true` instead of `yes`) prevented such tests to run as expected;\n3. install the correct `pcap` Python module. As `pcapy` does not expose the file number, it is not the best candidate;\n4. get the whole output: do not run UTScapy with the `-q` and `-F` parameters.\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/258/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/258/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/214", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/214/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/214/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/214/events", "html_url": "https://github.com/secdev/scapy/pull/214", "id": 164093952, "node_id": "MDExOlB1bGxSZXF1ZXN0NzY0NDQ4MDI=", "number": 214, "title": "IPv4 mDNS support", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2016-07-06T14:47:21Z", "updated_at": "2016-07-11T08:21:22Z", "closed_at": "2016-07-11T08:21:22Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/214", "html_url": "https://github.com/secdev/scapy/pull/214", "diff_url": "https://github.com/secdev/scapy/pull/214.diff", "patch_url": "https://github.com/secdev/scapy/pull/214.patch", "merged_at": "2016-07-11T08:21:22Z"}, "body": "As a followup to PR #203, here is a small patch that makes mDNS works in IPv4.\n\nWe could try to add a generic multicast test as done with IPv6. However, I wonder if this will break protocols other than mDNS.\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/214/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/214/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/212", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/212/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/212/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/212/events", "html_url": "https://github.com/secdev/scapy/pull/212", "id": 164066939, "node_id": "MDExOlB1bGxSZXF1ZXN0NzY0MjU5MDk=", "number": 212, "title": "Missing import in packet.py", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2016-07-06T12:44:37Z", "updated_at": "2017-09-11T14:02:00Z", "closed_at": "2016-07-06T13:02:16Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/212", "html_url": "https://github.com/secdev/scapy/pull/212", "diff_url": "https://github.com/secdev/scapy/pull/212.diff", "patch_url": "https://github.com/secdev/scapy/pull/212.patch", "merged_at": "2016-07-06T13:02:16Z"}, "body": "Some regression tests are failing due to a missing import in packet.py\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/212/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/212/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/203", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/203/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/203/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/203/events", "html_url": "https://github.com/secdev/scapy/pull/203", "id": 162281582, "node_id": "MDExOlB1bGxSZXF1ZXN0NzUyMDQ5MTU=", "number": 203, "title": "mDNS support", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2016-06-25T13:39:36Z", "updated_at": "2017-09-11T14:01:59Z", "closed_at": "2016-07-08T08:14:19Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/203", "html_url": "https://github.com/secdev/scapy/pull/203", "diff_url": "https://github.com/secdev/scapy/pull/203.diff", "patch_url": "https://github.com/secdev/scapy/pull/203.patch", "merged_at": null}, "body": "This PR provides two different yet related patches:\n1. mDNS support added for IPv4\n2. fix IPv6.hashret() that was not working as expected (i.e. IPv6 addresses were never involved in hashret() results). It might break some behaviours, therefore I wonder if I could be better to create a separated PR\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/203/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/203/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/193", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/193/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/193/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/193/events", "html_url": "https://github.com/secdev/scapy/pull/193", "id": 159737480, "node_id": "MDExOlB1bGxSZXF1ZXN0NzM0NDYzMDM=", "number": 193, "title": "Bluetooth: fix socket close (fixes #191)", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2016-06-10T22:47:02Z", "updated_at": "2016-06-10T23:34:35Z", "closed_at": "2016-06-10T23:34:35Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/193", "html_url": "https://github.com/secdev/scapy/pull/193", "diff_url": "https://github.com/secdev/scapy/pull/193.diff", "patch_url": "https://github.com/secdev/scapy/pull/193.patch", "merged_at": null}, "body": "WIP / not tested yet, **do not merge**.\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/193/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/193/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/191", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/191/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/191/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/191/events", "html_url": "https://github.com/secdev/scapy/issues/191", "id": 159686206, "node_id": "MDU6SXNzdWUxNTk2ODYyMDY=", "number": 191, "title": "Cannot Open BluetoothUserSocket After Opening/Closing One Beforehand", "user": {"login": "1nc1n3rat0r", "id": 7519066, "node_id": "MDQ6VXNlcjc1MTkwNjY=", "avatar_url": "https://avatars.githubusercontent.com/u/7519066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/1nc1n3rat0r", "html_url": "https://github.com/1nc1n3rat0r", "followers_url": "https://api.github.com/users/1nc1n3rat0r/followers", "following_url": "https://api.github.com/users/1nc1n3rat0r/following{/other_user}", "gists_url": "https://api.github.com/users/1nc1n3rat0r/gists{/gist_id}", "starred_url": "https://api.github.com/users/1nc1n3rat0r/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/1nc1n3rat0r/subscriptions", "organizations_url": "https://api.github.com/users/1nc1n3rat0r/orgs", "repos_url": "https://api.github.com/users/1nc1n3rat0r/repos", "events_url": "https://api.github.com/users/1nc1n3rat0r/events{/privacy}", "received_events_url": "https://api.github.com/users/1nc1n3rat0r/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2016-06-10T17:44:24Z", "updated_at": "2021-08-19T14:18:28Z", "closed_at": "2017-08-12T13:30:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am working on a program that creates a BluetoothUserSocket with a local Bluetooth adapter, does some stuff, closes the socket, then creates a new BluetoothUserSocket with the same adapter. When I do this, I get an error: \"IOError: [Errno 16] Device or resource busy\". Is there some proper way to close down the socket and free the resource that I'm missing?\n\nThe following is some sample code I'm using to test this (based on code from PyBT https://github.com/mikeryan/PyBT/tree/master/PyBT):\n\n``` python\nimport os\nimport sys\nfrom fcntl import ioctl\nimport logging\nimport time\nimport socket as s\nfrom scapy.layers.bluetooth import *\nfrom select import select\n\nclass HCIConfig(object):\n    @staticmethod\n    def down(iface):\n        #31 => PF_BLUETOOTH\n        #0 => HCI_CHANNEL_USER\n        # 0x400448ca => HCIDEVDOWN\n        sock = s.socket(31, s.SOCK_RAW, 1)\n        ioctl(sock.fileno(), 0x400448ca, iface)\n        sock.close()\n        return True\n\n    @staticmethod\n    def up(iface):\n        sock = s.socket(31, s.SOCK_RAW, iface)\n        # TODO\n        # ioctl(sock.fileno(), HCIDEVUP, 0)\n        sock.close()\n        return False\n\n\ndef get_socket(adapter):\n    try:\n        return BluetoothUserSocket(adapter)\n    except BluetoothSocketError as e:\n\n        log.debug(\"[!] Creating socket failed: %s\\n\" % (repr(e)))\n        if os.getuid() > 0:\n            log.error(\"[!] Are you definitely root? detected uid: %d\\n\" % (os.getuid()))\n        else:\n            log.debug(\"[+] have root, attempting to take iface down\\n\")\n            HCIConfig.down(adapter)\n            try:\n                return BluetoothUserSocket(adapter)\n            except BluetoothSocketError as e:\n                log.error(\"[!] Failed to create socket: %s\" % repr(e))\n                log.error(\"[!] Giving up.\\n\")\n    sys.exit(1)\n\n\nprint \"First time getting socket\"\nsock = get_socket(0)\nprint \"About to flush\"\nsock.flush()\nprint \"About to close\"\nsock.close()\nprint \"Sleeping...2 seconds\"\ntime.sleep(2)\nprint \"Second time getting socket\"\nsock = get_socket(0)\nprint \"About to flush\"\nsock.flush()\nprint \"About to close\"\nsock.close()\n```\n\nThe following is the output from this program:\n\n```\n$ sudo python bt.py\nFirst time getting socket\nAbout to flush\nAbout to close\nSleeping...2 seconds\nSecond time getting socket\nTraceback (most recent call last):\n  File \"bt.py\", line 60, in <module>\n    sock = get_socket(0)\n  File \"bt.py\", line 42, in get_socket\n    HCIConfig.down(adapter)\n  File \"bt.py\", line 19, in down\n    ioctl(sock.fileno(), 0x400448ca, iface)\nIOError: [Errno 16] Device or resource busy\n```\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/191/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/191/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/185", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/185/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/185/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/185/events", "html_url": "https://github.com/secdev/scapy/pull/185", "id": 157844950, "node_id": "MDExOlB1bGxSZXF1ZXN0NzIxMzcwMjA=", "number": 185, "title": "Traceroute: fix graph", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2016-06-01T07:56:05Z", "updated_at": "2016-06-06T13:03:27Z", "closed_at": "2016-06-06T13:03:27Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/185", "html_url": "https://github.com/secdev/scapy/pull/185", "diff_url": "https://github.com/secdev/scapy/pull/185.diff", "patch_url": "https://github.com/secdev/scapy/pull/185.patch", "merged_at": "2016-06-06T13:03:27Z"}, "body": "Fixes #184.\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/185/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/185/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/173", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/173/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/173/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/173/events", "html_url": "https://github.com/secdev/scapy/pull/173", "id": 155946926, "node_id": "MDExOlB1bGxSZXF1ZXN0NzA4NDMwNjc=", "number": 173, "title": "HomePlugAVuts fixed", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2016-05-20T11:56:11Z", "updated_at": "2016-05-22T21:54:02Z", "closed_at": "2016-05-22T21:54:02Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/173", "html_url": "https://github.com/secdev/scapy/pull/173", "diff_url": "https://github.com/secdev/scapy/pull/173.diff", "patch_url": "https://github.com/secdev/scapy/pull/173.patch", "merged_at": "2016-05-22T21:54:02Z"}, "body": "Some HomePlugAV unit tests can not work without dedicated test environment. I chose to comment them over deleting to keep the examples.\n\n@p-l- it is likely to be the last PR that modifies unit tests\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/173/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/173/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/172", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/172/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/172/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/172/events", "html_url": "https://github.com/secdev/scapy/pull/172", "id": 155923135, "node_id": "MDExOlB1bGxSZXF1ZXN0NzA4MjYwMDA=", "number": 172, "title": "Fix EDNS0 live unit tests", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2016-05-20T09:32:28Z", "updated_at": "2017-09-11T14:01:51Z", "closed_at": "2016-05-20T10:28:07Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/172", "html_url": "https://github.com/secdev/scapy/pull/172", "diff_url": "https://github.com/secdev/scapy/pull/172.diff", "patch_url": "https://github.com/secdev/scapy/pull/172.patch", "merged_at": "2016-05-20T10:28:07Z"}, "body": "Live EDNS0 unit tests are broken.\n\nIt could not find a host that responds to EDNS-PING. I preferred to comment this test rather than deleting it, as this packet construction is useful for reference.\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/172/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/172/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/171", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/171/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/171/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/171/events", "html_url": "https://github.com/secdev/scapy/pull/171", "id": 155921561, "node_id": "MDExOlB1bGxSZXF1ZXN0NzA4MjQ4MzU=", "number": 171, "title": "IPv6 unit tests now work when IPv6 is not available", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2016-05-20T09:24:36Z", "updated_at": "2017-09-11T14:01:50Z", "closed_at": "2016-05-20T10:28:36Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/171", "html_url": "https://github.com/secdev/scapy/pull/171", "diff_url": "https://github.com/secdev/scapy/pull/171.diff", "patch_url": "https://github.com/secdev/scapy/pull/171.patch", "merged_at": "2016-05-20T10:28:36Z"}, "body": "This is a fix to issue #170. See the results below:\n\nWithout IPv6:\n\n``` shell\necho 1 > /proc/sys/net/ipv6/conf/all/disable_ipv6\n./run_tests -q -t regression.uts\n/run_tests -t regression.uts -o /dev/null\n[..]\nPASSED=789 FAILED=0\n```\n\nWith IPv6:\n\n``` shell\necho 0 > /proc/sys/net/ipv6/conf/all/disable_ipv6\n./run_tests -q -t regression.uts\n/run_tests -t regression.uts -o /dev/null\n[..]\nPASSED=789 FAILED=0\n```\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/171/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/171/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/170", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/170/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/170/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/170/events", "html_url": "https://github.com/secdev/scapy/issues/170", "id": 155762758, "node_id": "MDU6SXNzdWUxNTU3NjI3NTg=", "number": 170, "title": "IPv6 unit tests when IPv6 is not available", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2016-05-19T15:15:58Z", "updated_at": "2016-05-20T14:51:54Z", "closed_at": "2016-05-20T14:51:54Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "This can be reproduced by disabling IPv6:\n\n``` shell\necho 1 > /proc/sys/net/ipv6/conf/all/disable_ipv6\n./run_tests -q -t regression.uts\n[..]\nPassed=776\nFailed=13\n```\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/170/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/170/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/149", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/149/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/149/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/149/events", "html_url": "https://github.com/secdev/scapy/pull/149", "id": 153659155, "node_id": "MDExOlB1bGxSZXF1ZXN0NjkyNzA0MjA=", "number": 149, "title": "Workaround to ignore interfaces whose name got truncated by netstat", "user": {"login": "hellais", "id": 424620, "node_id": "MDQ6VXNlcjQyNDYyMA==", "avatar_url": "https://avatars.githubusercontent.com/u/424620?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hellais", "html_url": "https://github.com/hellais", "followers_url": "https://api.github.com/users/hellais/followers", "following_url": "https://api.github.com/users/hellais/following{/other_user}", "gists_url": "https://api.github.com/users/hellais/gists{/gist_id}", "starred_url": "https://api.github.com/users/hellais/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hellais/subscriptions", "organizations_url": "https://api.github.com/users/hellais/orgs", "repos_url": "https://api.github.com/users/hellais/repos", "events_url": "https://api.github.com/users/hellais/events{/privacy}", "received_events_url": "https://api.github.com/users/hellais/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2016-05-08T14:39:11Z", "updated_at": "2016-08-09T13:49:46Z", "closed_at": "2016-08-09T13:49:46Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/149", "html_url": "https://github.com/secdev/scapy/pull/149", "diff_url": "https://github.com/secdev/scapy/pull/149.diff", "patch_url": "https://github.com/secdev/scapy/pull/149.patch", "merged_at": null}, "body": "When interface names are longer than 7 characters netstat will truncate\nthem to the first 7 chars which leads to looking up an invalid interface\nname.\n\nThis workaround ignores interfaces that are too long.\n\nThis fixes #147\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/149/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/149/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/137", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/137/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/137/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/137/events", "html_url": "https://github.com/secdev/scapy/pull/137", "id": 151559461, "node_id": "MDExOlB1bGxSZXF1ZXN0NjgxNzAwMjc=", "number": 137, "title": "Fix NTP TimeStampField.any2i()", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 267691054, "node_id": "MDU6TGFiZWwyNjc2OTEwNTQ=", "url": "https://api.github.com/repos/secdev/scapy/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2016-04-28T06:28:11Z", "updated_at": "2016-05-04T12:29:10Z", "closed_at": "2016-05-04T12:29:10Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/137", "html_url": "https://github.com/secdev/scapy/pull/137", "diff_url": "https://github.com/secdev/scapy/pull/137.diff", "patch_url": "https://github.com/secdev/scapy/pull/137.patch", "merged_at": "2016-05-04T12:29:10Z"}, "body": "Fixes #135.\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/137/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/137/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/135", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/135/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/135/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/135/events", "html_url": "https://github.com/secdev/scapy/issues/135", "id": 151466433, "node_id": "MDU6SXNzdWUxNTE0NjY0MzM=", "number": 135, "title": "Unable to Accurately Set Time Fields in NTP Layer", "user": {"login": "colleen15", "id": 17882157, "node_id": "MDQ6VXNlcjE3ODgyMTU3", "avatar_url": "https://avatars.githubusercontent.com/u/17882157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/colleen15", "html_url": "https://github.com/colleen15", "followers_url": "https://api.github.com/users/colleen15/followers", "following_url": "https://api.github.com/users/colleen15/following{/other_user}", "gists_url": "https://api.github.com/users/colleen15/gists{/gist_id}", "starred_url": "https://api.github.com/users/colleen15/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/colleen15/subscriptions", "organizations_url": "https://api.github.com/users/colleen15/orgs", "repos_url": "https://api.github.com/users/colleen15/repos", "events_url": "https://api.github.com/users/colleen15/events{/privacy}", "received_events_url": "https://api.github.com/users/colleen15/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 267691057, "node_id": "MDU6TGFiZWwyNjc2OTEwNTc=", "url": "https://api.github.com/repos/secdev/scapy/labels/discussion", "name": "discussion", "color": "cc317c", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-04-27T19:07:11Z", "updated_at": "2016-05-04T12:29:10Z", "closed_at": "2016-05-04T12:29:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm trying to modify the time fields in the NTP layer, and not having any luck. I've tried setting packet.recv to an integer value and a string representation of time, but no matter what I try, when I send the packet, this field is always set to the default 0. Is there any example code that I just missed that would show me how to do this? Thank you in advance.\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/135/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/135/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/127", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/127/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/127/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/127/events", "html_url": "https://github.com/secdev/scapy/pull/127", "id": 147804816, "node_id": "MDExOlB1bGxSZXF1ZXN0NjYxODc2NTc=", "number": 127, "title": "New read_routes6() function and unit tests", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2016-04-12T16:27:31Z", "updated_at": "2017-09-11T14:01:51Z", "closed_at": "2016-05-18T09:36:35Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/127", "html_url": "https://github.com/secdev/scapy/pull/127", "diff_url": "https://github.com/secdev/scapy/pull/127.diff", "patch_url": "https://github.com/secdev/scapy/pull/127.patch", "merged_at": "2016-05-18T09:36:35Z"}, "body": "Here is an attempt at fixing Issue #109 by rewriting scapy.unix.read_routes6().\n\nThis patch provides mocked tests that ease reproducing outputs on several\noperating systems. Scapy tests from regression.uts were also tested on real OS. I can not swear that this patch does not introduce any regressions or bugs by itself, but I tried my best not to.\n\n`read_routes6()` can be tested as follows:\n\n``` shell\n$ PYTHONPATH=. py.test test/mocked_functions.py -vx\n```\n\nIt could be interesting to extend the idea mocked_functions.py to other part of\nScapy, and to run this tests with Travis along with the classic regression tests.\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/127/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/127/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/120", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/120/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/120/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/120/events", "html_url": "https://github.com/secdev/scapy/pull/120", "id": 146520452, "node_id": "MDExOlB1bGxSZXF1ZXN0NjU1Nzk4NDQ=", "number": 120, "title": "Python 2.5: fallback implementation for gcd() without pycrypto", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2016-04-07T06:28:00Z", "updated_at": "2016-04-07T11:09:27Z", "closed_at": "2016-04-07T11:09:27Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/120", "html_url": "https://github.com/secdev/scapy/pull/120", "diff_url": "https://github.com/secdev/scapy/pull/120.diff", "patch_url": "https://github.com/secdev/scapy/pull/120.patch", "merged_at": "2016-04-07T11:09:27Z"}, "body": "This was reported by @AmedeoSapio in #68\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/120/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/120/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/118", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/118/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/118/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/118/events", "html_url": "https://github.com/secdev/scapy/pull/118", "id": 146233080, "node_id": "MDExOlB1bGxSZXF1ZXN0NjU0MjgwMDg=", "number": 118, "title": "Fix Issue #115", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2016-04-06T08:32:01Z", "updated_at": "2017-09-11T14:01:44Z", "closed_at": "2016-04-06T10:41:26Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/118", "html_url": "https://github.com/secdev/scapy/pull/118", "diff_url": "https://github.com/secdev/scapy/pull/118.diff", "patch_url": "https://github.com/secdev/scapy/pull/118.patch", "merged_at": "2016-04-06T10:41:25Z"}, "body": "This patch fix Issue #115. It was tested on Debian and FreeBSD 10.\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/118/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/118/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/117", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/117/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/117/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/117/events", "html_url": "https://github.com/secdev/scapy/pull/117", "id": 145947947, "node_id": "MDExOlB1bGxSZXF1ZXN0NjUyODE0NzM=", "number": 117, "title": "Scapy can now use dumbnet", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2016-04-05T10:26:58Z", "updated_at": "2017-09-11T14:01:44Z", "closed_at": "2016-04-05T11:52:49Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/117", "html_url": "https://github.com/secdev/scapy/pull/117", "diff_url": "https://github.com/secdev/scapy/pull/117.diff", "patch_url": "https://github.com/secdev/scapy/pull/117.patch", "merged_at": "2016-04-05T11:52:49Z"}, "body": "This patch fixes #116. I choose to add some dummy calls to some important internal functions as I had to patch them, because they were failing.\n\nIt was tested on Debian (root and non-root regressions tests / with and without pcapdnet). Travis will do it on Ubuntu.\n\nIt can be tested easily with:\n\n``` python\nfrom scapy.config import conf\nconf.use_pcap = True\nconf.use_dnet = True\n\nfrom scapy.all import *\n\np = sr1(IP(dst=\"www.kame.net\")/ICMP())\nprint p.summary()\n```\n\nAs of today, there is no easy way to launch the regressions tests using pcapdnet. It could be interesting to trigger the use of pcapdnet using a environment variable (such as SCAPY_USE_PCAPDNET). I can modify this patch to implement this behavior.\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/117/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/117/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/116", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/116/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/116/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/116/events", "html_url": "https://github.com/secdev/scapy/issues/116", "id": 145417219, "node_id": "MDU6SXNzdWUxNDU0MTcyMTk=", "number": 116, "title": "dnet module renamed", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2016-04-02T21:00:14Z", "updated_at": "2016-04-05T11:52:49Z", "closed_at": "2016-04-05T11:52:49Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "On Debian/Ubuntu, the dnet module was renamed dumbnet. This makes Scapy dnet related code unusable ... Their behavior is also slightly different ...\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/116/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/116/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/115", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/115/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/115/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/115/events", "html_url": "https://github.com/secdev/scapy/issues/115", "id": 144602122, "node_id": "MDU6SXNzdWUxNDQ2MDIxMjI=", "number": 115, "title": "in6_getLocalUniquePrefix() can't be called from a Python script", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2016-03-30T14:00:28Z", "updated_at": "2016-04-06T17:02:15Z", "closed_at": "2016-04-06T14:07:12Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "The following code does not work:\n\n```\n$ cat test.py\nfrom scapy.all import *\n\nin6_getLocalUniquePrefix()\n\n$ python test.py \nWARNING: Failed to execute tcpdump. Check it is installed and in the PATH\nWARNING: No route found for IPv6 destination :: (no default route?)\nTraceback (most recent call last):\n  File \"test.py\", line 3, in <module>\n    in6_getLocalUniquePrefix()\n  File \"/home/guedou/prog/python/scapy/github/scapy-issues.git/scapy/utils6.py\", line 393, in in6_getLocalUniquePrefix\n    rawmac = get_if_raw_hwaddr(conf.iface6)[1]\nNameError: global name 'get_if_raw_hwaddr' is not defined\n```\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/115/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/115/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/114", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/114/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/114/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/114/events", "html_url": "https://github.com/secdev/scapy/pull/114", "id": 144595473, "node_id": "MDExOlB1bGxSZXF1ZXN0NjQ2Mjc5MDA=", "number": 114, "title": "Issue #110 fixes", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2016-03-30T13:34:54Z", "updated_at": "2017-09-11T14:01:45Z", "closed_at": "2016-03-30T15:26:09Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/114", "html_url": "https://github.com/secdev/scapy/pull/114", "diff_url": "https://github.com/secdev/scapy/pull/114.diff", "patch_url": "https://github.com/secdev/scapy/pull/114.patch", "merged_at": "2016-03-30T15:26:09Z"}, "body": "Here are the fixes discussed in Issue #110 !\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/114/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/114/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/111", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/111/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/111/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/111/events", "html_url": "https://github.com/secdev/scapy/issues/111", "id": 144408198, "node_id": "MDU6SXNzdWUxNDQ0MDgxOTg=", "number": 111, "title": "Import from scapy.sendrecv in Windows fails", "user": {"login": "martingalloar", "id": 3941628, "node_id": "MDQ6VXNlcjM5NDE2Mjg=", "avatar_url": "https://avatars.githubusercontent.com/u/3941628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/martingalloar", "html_url": "https://github.com/martingalloar", "followers_url": "https://api.github.com/users/martingalloar/followers", "following_url": "https://api.github.com/users/martingalloar/following{/other_user}", "gists_url": "https://api.github.com/users/martingalloar/gists{/gist_id}", "starred_url": "https://api.github.com/users/martingalloar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/martingalloar/subscriptions", "organizations_url": "https://api.github.com/users/martingalloar/orgs", "repos_url": "https://api.github.com/users/martingalloar/repos", "events_url": "https://api.github.com/users/martingalloar/events{/privacy}", "received_events_url": "https://api.github.com/users/martingalloar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2016-03-29T22:32:59Z", "updated_at": "2016-10-19T21:55:56Z", "closed_at": "2016-09-26T13:14:20Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Importing from `scapy.sendrecv` fails in Windows:\n\n```\nPS Microsoft.PowerShell.Core\\FileSystem::\\\\vboxsrv\\workspace\\pysap> ipython\nPython 2.7.11 (v2.7.11:6d1b6a68f775, Dec  5 2015, 20:40:30) [MSC v.1500 64 bit (AMD64)]\nType \"copyright\", \"credits\" or \"license\" for more information.\n\nIPython 4.1.1 -- An enhanced Interactive Python.\n?         -> Introduction and overview of IPython's features.\n%quickref -> Quick reference.\nhelp      -> Python's own help system.\nobject?   -> Details about 'object', use 'object??' for extra details.\n\nIn [1]: from scapy.sendrecv import sniff\n---------------------------------------------------------------------------\nImportError                               Traceback (most recent call last)\n<ipython-input-1-56f9d4ea2ee6> in <module>()\n----> 1 from scapy.sendrecv import sniff\n\nC:\\tools\\python2\\lib\\site-packages\\scapy\\sendrecv.py in <module>()\n     11 from select import select\n     12 from data import *\n---> 13 import arch\n     14 from config import conf\n     15 from packet import Gen\n\nC:\\tools\\python2\\lib\\site-packages\\scapy\\arch\\__init__.pyc in <module>()\n     78     from solaris import *\n     79 elif WINDOWS:\n---> 80     from windows import *\n     81\n     82 if scapy.config.conf.iface is None:\n\nC:\\tools\\python2\\lib\\site-packages\\scapy\\arch\\windows\\__init__.py in <module>()\n     15 from scapy.base_classes import Gen, Net, SetGen\n     16 import scapy.plist as plist\n---> 17 from scapy.sendrecv import debug, srp1\n     18 from scapy.layers.l2 import Ether, ARP\n     19 from scapy.data import MTU, ETHER_BROADCAST, ETH_P_ARP\n\nImportError: cannot import name debug\n```\n\nI think there's some kind of import cycle, as `sendrecv` is architecture-dependent but the Windows arch requires to import `sendrecv` module at the same time. In the past we've fixed a [similar issue](https://bitbucket.org/secdev/scapy/pull-requests/56/fixed-import-of-supersocket-module-on-non/diff) in `supersocket`, but I'm not sure what's the best approach to fix this case.\n\nAny idea on this?\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/111/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/111/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/110", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/110/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/110/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/110/events", "html_url": "https://github.com/secdev/scapy/issues/110", "id": 144326062, "node_id": "MDU6SXNzdWUxNDQzMjYwNjI=", "number": 110, "title": "sniff() is broken on Linux", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2016-03-29T17:02:26Z", "updated_at": "2016-03-31T07:05:35Z", "closed_at": "2016-03-31T07:05:35Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "I ran into two different sniff() related bugs today. I am not confident in my fixes, so I prefer to open this issue to discuss them.\n\nThe first one occurs when pressing CTRL+C during sniff():\n\n``` python\n>>> sniff()\n^CTraceback (most recent call last):\n  File \"<console>\", line 1, in <module>\n  File \"scapy/sendrecv.py\", line 621, in sniff\n    s.close()\nUnboundLocalError: local variable 's' referenced before assignment\n```\n\nThe following patch fixes the issue:\n\n``` diff\n--- a/scapy/sendrecv.py\n+++ b/scapy/sendrecv.py\n@@ -618,7 +618,7 @@ interfaces)\n     except KeyboardInterrupt:\n         pass\n     if opened_socket is None:\n-        s.close()\n+        [s.close() for s in sniff_sockets]\n     return plist.PacketList(lst,\"Sniffed\")\n```\n\nAfter applying this patch, the second issue occurs during sniff():\n\n``` python\n>>> sniff()\nTraceback (most recent call last):\n  File \"<console>\", line 1, in <module>\n  File \"scapy/sendrecv.py\", line 599, in sniff\n    p = s.recv()\n  File \"scapy/arch/linux.py\", line 539, in recv\n    pkt.direction = sa_ll[2]\n  File \"scapy/packet.py\", line 217, in __setattr__\n    return object.__setattr__(self, attr, val)\nAttributeError: 'Ether' object has no attribute 'direction'\n```\n\nAdding the direction variable to **slots** fixes the issue. However, I wonder if this is the best way to fix this second issue.\n\n``` diff\n--- a/scapy/layers/l2.py\n+++ b/scapy/layers/l2.py\n@@ -141,6 +141,7 @@ class ARPSourceMACField(MACField):\n\n class Ether(Packet):\n     name = \"Ethernet\"\n+    __slots__ = [\"direction\"]\n     fields_desc = [ DestMACField(\"dst\"),\n                     SourceMACField(\"src\"),\n                     XShortEnumField(\"type\", 0x9000, ETHER_TYPES) ]\n\n```\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/110/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/110/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/108", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/108/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/108/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/108/events", "html_url": "https://github.com/secdev/scapy/pull/108", "id": 144051483, "node_id": "MDExOlB1bGxSZXF1ZXN0NjQzNTgwMDQ=", "number": 108, "title": "Fix TCP & UDP checksums when IP layer has options", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2016-03-28T18:52:11Z", "updated_at": "2016-03-30T17:02:35Z", "closed_at": "2016-03-30T17:02:35Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/108", "html_url": "https://github.com/secdev/scapy/pull/108", "diff_url": "https://github.com/secdev/scapy/pull/108.diff", "patch_url": "https://github.com/secdev/scapy/pull/108.patch", "merged_at": "2016-03-30T17:02:35Z"}, "body": "Reported by [Runa Barik on Scapy ML](http://permalink.gmane.org/gmane.comp.security.scapy.general/5342).\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/108/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/108/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/106", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/106/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/106/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/106/events", "html_url": "https://github.com/secdev/scapy/pull/106", "id": 143693678, "node_id": "MDExOlB1bGxSZXF1ZXN0NjQyMzYxMDU=", "number": 106, "title": "python --version may output to stderr (fixes #101)", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2016-03-26T11:40:14Z", "updated_at": "2016-03-29T08:44:34Z", "closed_at": "2016-03-29T08:44:34Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/106", "html_url": "https://github.com/secdev/scapy/pull/106", "diff_url": "https://github.com/secdev/scapy/pull/106.diff", "patch_url": "https://github.com/secdev/scapy/pull/106.patch", "merged_at": "2016-03-29T08:44:34Z"}, "body": "", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/106/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/106/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/101", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/101/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/101/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/101/events", "html_url": "https://github.com/secdev/scapy/issues/101", "id": 143488187, "node_id": "MDU6SXNzdWUxNDM0ODgxODc=", "number": 101, "title": "run_scapy odd behavior", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2016-03-25T12:18:18Z", "updated_at": "2016-03-29T08:44:35Z", "closed_at": "2016-03-29T08:44:35Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "On Debian stretch, run_scapy outputs the string `Python 2.7.11` (aka Python version). It seems that `python --version` prints the version on stderr =/\n\nSame behavior on OS X.\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/101/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/101/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/100", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/100/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/100/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/100/events", "html_url": "https://github.com/secdev/scapy/issues/100", "id": 143462970, "node_id": "MDU6SXNzdWUxNDM0NjI5NzA=", "number": 100, "title": "Importing scapy.arch.linux on other OS", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2016-03-25T09:23:22Z", "updated_at": "2016-03-25T10:02:38Z", "closed_at": "2016-03-25T10:02:21Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "For the native BPF support, I need to call the function scapy.arch.linux.get_if() in Mac OS X (and other BSD derivatives). This function works fine on OS X, however the test at [Line 73](https://github.com/secdev/scapy/blob/master/scapy/arch/linux.py#L73) prevents the module from loading.\n\nI can imagine several ways to fix this:\n1. suppress this test as well as the one at  [line 120](https://github.com/secdev/scapy/blob/master/scapy/arch/linux.py#L120)\n2. move this test to the Linux specific part of scapy/arch/**init**.py at [line 80](https://github.com/secdev/scapy/blob/master/scapy/arch/__init__.py#L80)\n3. create scapy/arch/common.py and move get_if() into it\n\nWhat solution should I implement ?\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/100/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/100/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/91", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/91/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/91/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/91/events", "html_url": "https://github.com/secdev/scapy/pull/91", "id": 142178986, "node_id": "MDExOlB1bGxSZXF1ZXN0NjM0OTk5NzE=", "number": 91, "title": "Pad packet when needed", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2016-03-20T16:29:59Z", "updated_at": "2016-03-24T08:33:57Z", "closed_at": "2016-03-24T08:33:57Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/91", "html_url": "https://github.com/secdev/scapy/pull/91", "diff_url": "https://github.com/secdev/scapy/pull/91.diff", "patch_url": "https://github.com/secdev/scapy/pull/91.patch", "merged_at": "2016-03-24T08:33:57Z"}, "body": "This fixes #90.\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/91/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/91/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/90", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/90/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/90/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/90/events", "html_url": "https://github.com/secdev/scapy/issues/90", "id": 142174866, "node_id": "MDU6SXNzdWUxNDIxNzQ4NjY=", "number": 90, "title": "Linux: (ethernet) padding no longer automatically added", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2016-03-20T15:42:53Z", "updated_at": "2016-03-24T08:33:57Z", "closed_at": "2016-03-24T08:33:57Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Commit [9c7077622dd917457ced680a23b7f175769471d9](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=9c7077622dd917457ced680a23b7f175769471d9) in the Linux kernel introduces a check to reject too short packets.\n\nScapy currently hopes that the underlying driver will add a payload if needed, but that is no longer the case, at least under Linux, so we might have to add the payload if needed.\n\nThis bug prevents Scapy from working correctly at least under ArchLinux with an Ethernet connexion.\n\nOn most Ethernet drivers, the value for `net->hard_header_len` seem to be 14, which only prevent Scapy from sending frames smaller than the Ethernet header (which is an uncommon use case), so the bug is hard to trigger.\n\nOn some drivers however, the value for `net->hard_header_len` can be (much) higher.\n\nFor example, on RNDIS-based links (when sharing a smartphone's Internet connection via USB), this value is [set to 58](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/tree/drivers/net/usb/rndis_host.c#n344) (14 + 11 \\* 4) bytes. In such cases, the bug will be triggered when trying to send an ARP request (`len(Ether()/ARP()) == 42 < 58`) (this prevents Scapy from updating its ARP cache and hence from sending layer 3 packets) or when trying to send a simple ICMP packet (`len(Ether()/IP()/ICMP()) == 42 < 58`), making Scapy effectively unusable.\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/90/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/90/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/82", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/82/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/82/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/82/events", "html_url": "https://github.com/secdev/scapy/pull/82", "id": 140527251, "node_id": "MDExOlB1bGxSZXF1ZXN0NjI2ODI1NzQ=", "number": 82, "title": "Packet.getlayer() method can work with string layer name", "user": {"login": "vorotnikovdk", "id": 17539100, "node_id": "MDQ6VXNlcjE3NTM5MTAw", "avatar_url": "https://avatars.githubusercontent.com/u/17539100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vorotnikovdk", "html_url": "https://github.com/vorotnikovdk", "followers_url": "https://api.github.com/users/vorotnikovdk/followers", "following_url": "https://api.github.com/users/vorotnikovdk/following{/other_user}", "gists_url": "https://api.github.com/users/vorotnikovdk/gists{/gist_id}", "starred_url": "https://api.github.com/users/vorotnikovdk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vorotnikovdk/subscriptions", "organizations_url": "https://api.github.com/users/vorotnikovdk/orgs", "repos_url": "https://api.github.com/users/vorotnikovdk/repos", "events_url": "https://api.github.com/users/vorotnikovdk/events{/privacy}", "received_events_url": "https://api.github.com/users/vorotnikovdk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2016-03-13T20:40:52Z", "updated_at": "2016-03-14T10:32:14Z", "closed_at": "2016-03-14T09:50:13Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/82", "html_url": "https://github.com/secdev/scapy/pull/82", "diff_url": "https://github.com/secdev/scapy/pull/82.diff", "patch_url": "https://github.com/secdev/scapy/pull/82.patch", "merged_at": "2016-03-14T09:50:13Z"}, "body": "I found that Packet.getlayer() can't work when _cls_ param is string. For example, Packet.haslayer() can do it.\nI created the fix, review it, please\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/82/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/82/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/80", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/80/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/80/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/80/events", "html_url": "https://github.com/secdev/scapy/pull/80", "id": 139842229, "node_id": "MDExOlB1bGxSZXF1ZXN0NjIzNjU2NjE=", "number": 80, "title": "IKEv2: fix fields overload (fixes #79)", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2016-03-10T10:07:50Z", "updated_at": "2016-03-10T15:47:35Z", "closed_at": "2016-03-10T12:15:50Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/80", "html_url": "https://github.com/secdev/scapy/pull/80", "diff_url": "https://github.com/secdev/scapy/pull/80.diff", "patch_url": "https://github.com/secdev/scapy/pull/80.patch", "merged_at": "2016-03-10T12:15:50Z"}, "body": "I'm not adding regression tests with this one since I'm not an expert of that protocol... If someone wants to submit another PR (cc @guedou ;-) ).\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/80/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/80/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/74", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/74/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/74/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/74/events", "html_url": "https://github.com/secdev/scapy/issues/74", "id": 137155496, "node_id": "MDU6SXNzdWUxMzcxNTU0OTY=", "number": 74, "title": "Timeout doesn't work when no sniffing results with L2pcapListenSocket", "user": {"login": "vorotnikovdk", "id": 17539100, "node_id": "MDQ6VXNlcjE3NTM5MTAw", "avatar_url": "https://avatars.githubusercontent.com/u/17539100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vorotnikovdk", "html_url": "https://github.com/vorotnikovdk", "followers_url": "https://api.github.com/users/vorotnikovdk/followers", "following_url": "https://api.github.com/users/vorotnikovdk/following{/other_user}", "gists_url": "https://api.github.com/users/vorotnikovdk/gists{/gist_id}", "starred_url": "https://api.github.com/users/vorotnikovdk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vorotnikovdk/subscriptions", "organizations_url": "https://api.github.com/users/vorotnikovdk/orgs", "repos_url": "https://api.github.com/users/vorotnikovdk/repos", "events_url": "https://api.github.com/users/vorotnikovdk/events{/privacy}", "received_events_url": "https://api.github.com/users/vorotnikovdk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-02-29T05:26:28Z", "updated_at": "2016-03-11T09:33:25Z", "closed_at": "2016-03-11T09:33:19Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "OS Ubuntu 14.04.3 LTS\nScapy 2.3.2-dev\npython-libpcap 0.6.4-1\n\nI am using pylibpcap for sniffing and I notice, that timeout parameter for sniff function doesnt work if there are no recieved packets.\n\nExample:\n\n```\nIn [4]: conf.use_pcap\nOut[4]: True\n\nIn [5]: conf.L2listen\nOut[5]: scapy.arch.pcapdnet.L2pcapListenSocket\n\nIn [6]: sniff(iface=\"eth1\", filter=\"vlan 554\", timeout=3)\n```\n\nand in freezes forever if there are no packets with vlan 554.\n\nI checked the code and found, that after this line \nhttps://github.com/secdev/scapy/blob/master/scapy/sendrecv.py#L584\n`sel = select([s],[],[],remain)`\nscapy has \n`sel[0] = [<scapy.arch.pcapdnet.L2pcapListenSocket object at 0x7f228072a310>]`\n in selected list. So function doesnt finish.\n\nIf I use `scapy.arch.linux.L2ListenSocket` everything is ok, selected list is empty.\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/74/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/74/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/61", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/61/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/61/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/61/events", "html_url": "https://github.com/secdev/scapy/pull/61", "id": 133536962, "node_id": "MDExOlB1bGxSZXF1ZXN0NTkyOTQ3NDQ=", "number": 61, "title": "LLTD: remove class decorators (not supported by Python 2.5)", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2016-02-14T12:57:04Z", "updated_at": "2016-02-15T19:35:38Z", "closed_at": "2016-02-15T07:44:27Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/61", "html_url": "https://github.com/secdev/scapy/pull/61", "diff_url": "https://github.com/secdev/scapy/pull/61.diff", "patch_url": "https://github.com/secdev/scapy/pull/61.patch", "merged_at": "2016-02-15T07:44:27Z"}, "body": "This makes the code less readable, but we have to keep it that way as long as we want to maintain Python 2.5 support.\n\nThis PR also includes minor fixes.\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/61/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/61/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/55", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/55/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/55/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/55/events", "html_url": "https://github.com/secdev/scapy/issues/55", "id": 132414100, "node_id": "MDU6SXNzdWUxMzI0MTQxMDA=", "number": 55, "title": "Problem with capture filter", "user": {"login": "9maf4you", "id": 3724879, "node_id": "MDQ6VXNlcjM3MjQ4Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/3724879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/9maf4you", "html_url": "https://github.com/9maf4you", "followers_url": "https://api.github.com/users/9maf4you/followers", "following_url": "https://api.github.com/users/9maf4you/following{/other_user}", "gists_url": "https://api.github.com/users/9maf4you/gists{/gist_id}", "starred_url": "https://api.github.com/users/9maf4you/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/9maf4you/subscriptions", "organizations_url": "https://api.github.com/users/9maf4you/orgs", "repos_url": "https://api.github.com/users/9maf4you/repos", "events_url": "https://api.github.com/users/9maf4you/events{/privacy}", "received_events_url": "https://api.github.com/users/9maf4you/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 11, "created_at": "2016-02-09T13:01:48Z", "updated_at": "2017-08-12T13:28:47Z", "closed_at": "2017-08-12T13:28:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello!\nI try to catch DHCPv6 packet by port. I use this filter:\n`sn = sniff(filter=\"port 546 or 547\")`\nBut what i see every time:\n\n```\n0000 Ether / IPv6 / TCP src_ipv_6:ssh > dest_ipv_6:49553 PA / Raw\n0001 Ether / IPv6 / UDP src_ipv_6:dhcpv6_server > dest_ipv_6:dhcpv6_server / DHCP6_RelayReply / DHCP6OptUnknown\n0002 Ether / IPv6 / UDP src_ipv_6:dhcpv6_server > dest_ipv_6:dhcpv6_server / DHCP6_RelayReply / DHCP6OptUnknown\n\n```\n\nThere is one tcp-packet with different port.\n\n```\n>>> sn[0].sport\n22\n>>> sn[0].dport\n49553\n```\n\nand i see only replyes.\n\n```\n>>> sn[2].msgtype\n13\n>>> sn[1].msgtype\n13\n```\n\nBut if i run tcpdump with same filter i will see that suppose and without the tcp-packet :)\n\n```\ntcpdump -n -i any -w /tmp/git.pcap port '(546 or 547)'\n```\n\n```\n15:37:59.472643 IP6 src_ipv_6.547 > dest_ipv_6.547: dhcp6 relay-fwd\n15:37:59.472897 IP6 src_ipv_6.547 > dest_ipv_6.547: dhcp6 relay-reply\n15:37:59.830144 IP6 src_ipv_6.547 > dest_ipv_6.547: dhcp6 relay-fwd\n15:37:59.830357 IP6 src_ipv_6.547 > dest_ipv_6.547: dhcp6 relay-reply\n```\n\n```\ndpkg -l python-scapy | grep ii\nii  python-scapy                            2.2.0-1                              all          Packet generator/sniffer and network scanner/discovery\n```\n\n```\npython --version\nPython 2.7.6\n```\n\n```\nlsb_release -dc\nDescription:    Ubuntu 14.04.3 LTS\nCodename:       trusty\n\n```\n\nis it not a bug?\n\nThank you.\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/55/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/55/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/46", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/46/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/46/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/46/events", "html_url": "https://github.com/secdev/scapy/pull/46", "id": 131865994, "node_id": "MDExOlB1bGxSZXF1ZXN0NTg1MjIzNDY=", "number": 46, "title": "Fix conf.debug_dissector in regression tests", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2016-02-06T15:22:37Z", "updated_at": "2016-02-07T17:51:12Z", "closed_at": "2016-02-07T17:07:29Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/46", "html_url": "https://github.com/secdev/scapy/pull/46", "diff_url": "https://github.com/secdev/scapy/pull/46.diff", "patch_url": "https://github.com/secdev/scapy/pull/46.patch", "merged_at": "2016-02-07T17:07:29Z"}, "body": "", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/46/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/46/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/44", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/44/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/44/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/44/events", "html_url": "https://github.com/secdev/scapy/pull/44", "id": 131724268, "node_id": "MDExOlB1bGxSZXF1ZXN0NTg0Njg3Mjc=", "number": 44, "title": "Fix Num2Layer.__repr__() (broken after PR #11)", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2016-02-05T18:52:05Z", "updated_at": "2016-02-07T17:51:41Z", "closed_at": "2016-02-07T16:58:06Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/44", "html_url": "https://github.com/secdev/scapy/pull/44", "diff_url": "https://github.com/secdev/scapy/pull/44.diff", "patch_url": "https://github.com/secdev/scapy/pull/44.patch", "merged_at": "2016-02-07T16:58:06Z"}, "body": "", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/44/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/44/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/42", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/42/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/42/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/42/events", "html_url": "https://github.com/secdev/scapy/pull/42", "id": 130455770, "node_id": "MDExOlB1bGxSZXF1ZXN0NTc4ODU4NTU=", "number": 42, "title": "Fix ipsec for Python 2.5 (fractions module does not exist)", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2016-02-01T19:18:07Z", "updated_at": "2016-02-03T18:24:41Z", "closed_at": "2016-02-02T21:23:50Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/42", "html_url": "https://github.com/secdev/scapy/pull/42", "diff_url": "https://github.com/secdev/scapy/pull/42.diff", "patch_url": "https://github.com/secdev/scapy/pull/42.patch", "merged_at": "2016-02-02T21:23:50Z"}, "body": "", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/42/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/42/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/41", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/41/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/41/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/41/events", "html_url": "https://github.com/secdev/scapy/pull/41", "id": 130176108, "node_id": "MDExOlB1bGxSZXF1ZXN0NTc3Nzg2ODM=", "number": 41, "title": "Fix TracerouteResult.world_trace() and set new defaults for matplotlib graphs", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 267691054, "node_id": "MDU6TGFiZWwyNjc2OTEwNTQ=", "url": "https://api.github.com/repos/secdev/scapy/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2016-01-31T20:12:02Z", "updated_at": "2016-02-09T16:34:01Z", "closed_at": "2016-02-08T09:39:49Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/41", "html_url": "https://github.com/secdev/scapy/pull/41", "diff_url": "https://github.com/secdev/scapy/pull/41.diff", "patch_url": "https://github.com/secdev/scapy/pull/41.patch", "merged_at": "2016-02-08T09:39:49Z"}, "body": "Fix `TracerouteResult.world_trace()` (fixes #28) using Matplotlib and [GeoIP](https://pypi.python.org/pypi/GeoIP/) (instead of the internal geoip sub-module, which has been removed), and set new defaults for Matplotlib graphs (see [updated notebook](https://github.com/p-l-/scapy/blob/fix-geoip/doc/notebooks/graphs-ipids.ipynb)).\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/41/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/41/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/31", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/31/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/31/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/31/events", "html_url": "https://github.com/secdev/scapy/issues/31", "id": 128347559, "node_id": "MDU6SXNzdWUxMjgzNDc1NTk=", "number": 31, "title": "Automaton (tests) broken", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2016-01-23T19:31:34Z", "updated_at": "2016-01-24T11:50:58Z", "closed_at": "2016-01-24T11:50:58Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "For some reason, even basic automaton test fail. At least:\n- under Linux, when run as simple user.\n- under OpenBSD, even when run as root (reported by @danieljakots, see #29).\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/31/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/31/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/29", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/29/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/29/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/29/events", "html_url": "https://github.com/secdev/scapy/pull/29", "id": 128336117, "node_id": "MDExOlB1bGxSZXF1ZXN0NTY5Nzk0NTQ=", "number": 29, "title": "Fix IPv6 support on OpenBSD", "user": {"login": "danieljakots", "id": 11314261, "node_id": "MDQ6VXNlcjExMzE0MjYx", "avatar_url": "https://avatars.githubusercontent.com/u/11314261?v=4", "gravatar_id": "", "url": "https://api.github.com/users/danieljakots", "html_url": "https://github.com/danieljakots", "followers_url": "https://api.github.com/users/danieljakots/followers", "following_url": "https://api.github.com/users/danieljakots/following{/other_user}", "gists_url": "https://api.github.com/users/danieljakots/gists{/gist_id}", "starred_url": "https://api.github.com/users/danieljakots/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/danieljakots/subscriptions", "organizations_url": "https://api.github.com/users/danieljakots/orgs", "repos_url": "https://api.github.com/users/danieljakots/repos", "events_url": "https://api.github.com/users/danieljakots/events{/privacy}", "received_events_url": "https://api.github.com/users/danieljakots/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2016-01-23T16:11:07Z", "updated_at": "2016-01-23T19:29:22Z", "closed_at": "2016-01-23T19:28:54Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/29", "html_url": "https://github.com/secdev/scapy/pull/29", "diff_url": "https://github.com/secdev/scapy/pull/29.diff", "patch_url": "https://github.com/secdev/scapy/pull/29.patch", "merged_at": "2016-01-23T19:28:54Z"}, "body": "Hi,\n\nBefore\n\n$ scapy\nINFO: Can't import PyX. Won't be able to use psdump() or pdfdump().\nusage: ifconfig [-AaC] [interface] [address_family] [address [dest_address]]\n                [parameters]\nINFO: No IPv6 support in kernel\nWARNING: No route found for IPv6 destination :: (no default route?)\nWelcome to Scapy (2.3.2)\n\n$ python2.7 scapy/tools/UTscapy.py -t test/regression.uts -f html -l -o /tmp/scapy_regression_test.html\n[...]\nPASSED=739 FAILED=28\n\nAfter\n\n$ scapy\nINFO: Can't import PyX. Won't be able to use psdump() or pdfdump().\nWelcome to Scapy (2.3.2)\n\n$ python2.7 scapy/tools/UTscapy.py -t test/regression.uts -f html -l -o /tmp/scapy_regression_test.html\n[...]\nPASSED=750 FAILED=17\n\nIt seems to start normally on FreeBSD.\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/29/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/29/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/28", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/28/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/28/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/28/events", "html_url": "https://github.com/secdev/scapy/issues/28", "id": 128162539, "node_id": "MDU6SXNzdWUxMjgxNjI1Mzk=", "number": 28, "title": "TracerouteResult.world_trace() is broken", "user": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2016-01-22T14:02:53Z", "updated_at": "2016-02-08T09:39:49Z", "closed_at": "2016-02-08T09:39:49Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "TracerouteResult.world_trace() is broken since 2008, according to git blame.\n\n``` python\n>>> tr, _ = traceroute([\"github.com\"], minttl=4, maxttl=6)\n[..] \n>>> tr.world_trace()\nTraceback (most recent call last):\n  File \"<console>\", line 1, in <module>\n  File \"scapy/layers/inet.py\", line 1078, in world_trace\n    from modules.geo import locate_ip\nImportError: No module named modules.geo\n```\n\n Fixing the import won't make it work, yet you will open the gate of tricky & historical Scapy internals:\n- this code uses specific databases for geographic and IP addresses locations that are either impossible/difficult to build today\n- a function is missing in geoip.py. It is likely that it was never imported from Scapy 1\n- gnuplot uses a file called world.dat to draw the world map. This file is also hard to retrieve today\n- ...\n\nThe best solution seems to rewrite it using the geoip module from maxmind, and the matplotlib map extension. However, it introduces two new modules dependencies.\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/28/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/28/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/secdev/scapy/issues/20", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/20/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/20/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/20/events", "html_url": "https://github.com/secdev/scapy/pull/20", "id": 127873644, "node_id": "MDExOlB1bGxSZXF1ZXN0NTY3MTkzNDQ=", "number": 20, "title": "Linux: L2Socket can set promiscuous mode (fixes #17)", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": {"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guedou", "id": 11683796, "node_id": "MDQ6VXNlcjExNjgzNzk2", "avatar_url": "https://avatars.githubusercontent.com/u/11683796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guedou", "html_url": "https://github.com/guedou", "followers_url": "https://api.github.com/users/guedou/followers", "following_url": "https://api.github.com/users/guedou/following{/other_user}", "gists_url": "https://api.github.com/users/guedou/gists{/gist_id}", "starred_url": "https://api.github.com/users/guedou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guedou/subscriptions", "organizations_url": "https://api.github.com/users/guedou/orgs", "repos_url": "https://api.github.com/users/guedou/repos", "events_url": "https://api.github.com/users/guedou/events{/privacy}", "received_events_url": "https://api.github.com/users/guedou/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2016-01-21T08:45:40Z", "updated_at": "2016-01-29T14:29:15Z", "closed_at": "2016-01-29T13:25:26Z", "author_association": "MEMBER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/secdev/scapy/pulls/20", "html_url": "https://github.com/secdev/scapy/pull/20", "diff_url": "https://github.com/secdev/scapy/pull/20.diff", "patch_url": "https://github.com/secdev/scapy/pull/20.patch", "merged_at": "2016-01-29T13:25:26Z"}, "body": "", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/20/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/20/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/secdev/scapy/issues/17", "repository_url": "https://api.github.com/repos/secdev/scapy", "labels_url": "https://api.github.com/repos/secdev/scapy/issues/17/labels{/name}", "comments_url": "https://api.github.com/repos/secdev/scapy/issues/17/comments", "events_url": "https://api.github.com/repos/secdev/scapy/issues/17/events", "html_url": "https://github.com/secdev/scapy/issues/17", "id": 127748879, "node_id": "MDU6SXNzdWUxMjc3NDg4Nzk=", "number": 17, "title": "L2socket does not set the promiscuous mode", "user": {"login": "p-l-", "id": 5064814, "node_id": "MDQ6VXNlcjUwNjQ4MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5064814?v=4", "gravatar_id": "", "url": "https://api.github.com/users/p-l-", "html_url": "https://github.com/p-l-", "followers_url": "https://api.github.com/users/p-l-/followers", "following_url": "https://api.github.com/users/p-l-/following{/other_user}", "gists_url": "https://api.github.com/users/p-l-/gists{/gist_id}", "starred_url": "https://api.github.com/users/p-l-/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/p-l-/subscriptions", "organizations_url": "https://api.github.com/users/p-l-/orgs", "repos_url": "https://api.github.com/users/p-l-/repos", "events_url": "https://api.github.com/users/p-l-/events{/privacy}", "received_events_url": "https://api.github.com/users/p-l-/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 267691052, "node_id": "MDU6TGFiZWwyNjc2OTEwNTI=", "url": "https://api.github.com/repos/secdev/scapy/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2016-01-20T18:10:15Z", "updated_at": "2016-01-29T13:25:27Z", "closed_at": "2016-01-29T13:25:27Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "`conf.L2socket` (at least on Linux) has no option to set the promiscuous \n\nThis prevents `srp()` from getting answers when a sent packet has a source MAC address set to a value different from the device MAC address.\n", "reactions": {"url": "https://api.github.com/repos/secdev/scapy/issues/17/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/secdev/scapy/issues/17/timeline", "performed_via_github_app": null, "state_reason": "completed"}]