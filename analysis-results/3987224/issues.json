[{"url": "https://api.github.com/repos/flairNLP/flair/issues/3209", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/3209/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/3209/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/3209/events", "html_url": "https://github.com/flairNLP/flair/issues/3209", "id": 1677389285, "node_id": "I_kwDOCCkmXM5j-u3l", "number": 3209, "title": "[Bug]: Broken links, weird link, lack of syntax highlighting", "user": {"login": "SolsticeProjekt", "id": 23191574, "node_id": "MDQ6VXNlcjIzMTkxNTc0", "avatar_url": "https://avatars.githubusercontent.com/u/23191574?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SolsticeProjekt", "html_url": "https://github.com/SolsticeProjekt", "followers_url": "https://api.github.com/users/SolsticeProjekt/followers", "following_url": "https://api.github.com/users/SolsticeProjekt/following{/other_user}", "gists_url": "https://api.github.com/users/SolsticeProjekt/gists{/gist_id}", "starred_url": "https://api.github.com/users/SolsticeProjekt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SolsticeProjekt/subscriptions", "organizations_url": "https://api.github.com/users/SolsticeProjekt/orgs", "repos_url": "https://api.github.com/users/SolsticeProjekt/repos", "events_url": "https://api.github.com/users/SolsticeProjekt/events{/privacy}", "received_events_url": "https://api.github.com/users/SolsticeProjekt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-04-20T20:34:08Z", "updated_at": "2023-04-21T08:14:08Z", "closed_at": "2023-04-21T08:14:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\n\nThought I'd point these out. The fact that there even ARE tutorials here is greatly appreciated, btw.\r\n\r\n\r\n\"This is the entity tagging tutorial. It assumes that you're familiar with the [base types](https://github.com/flairNLP/flair/blob/master/resources/docs/TUTORIAL_1_BASICS.md) of this library.\"\r\n\r\nIt points to a 404, apparently everywhere it's linked.\r\n\r\nI guess the actual link should be:\r\nhttps://github.com/flairNLP/flair/blob/master/resources/docs/TUTORIAL_FLAIR_BASICS.md\r\n\r\n-----------------------------------------\r\n\r\nIn https://github.com/flairNLP/flair/blob/master/resources/docs/TUTORIAL_TAGGING_LINKING.md\r\n\r\nOr learn how to train your own sentiment analysis model in our [text classifier training tutorial]/resources/docs/TUTORIAL_TRAINING_TEXT_CLASSIFIER.md).\r\n\r\n-----------------------------------------\r\n\r\nhttps://github.com/flairNLP/flair/blob/master/resources/docs/TUTORIAL_12_CLUSTERING.md\r\n\r\nThe code isn't coloured.\r\n\r\n-----------------------------------------\r\n\r\n\r\n\r\n\n\n### To Reproduce\n\n```python\nlol read your tutorials, I guess. :-)\n```\n\n\n### Expected behavior\n\n... uh ...\n\n### Logs and Stack traces\n\n_No response_\n\n### Screenshots\n\n_No response_\n\n### Additional Context\n\n_No response_\n\n### Environment\n\nYour github.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/3209/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/3209/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/3207", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/3207/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/3207/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/3207/events", "html_url": "https://github.com/flairNLP/flair/issues/3207", "id": 1676990435, "node_id": "I_kwDOCCkmXM5j9Nfj", "number": 3207, "title": "[Bug]: TarsModels do redownload embeddings", "user": {"login": "helpmefindaname", "id": 26192135, "node_id": "MDQ6VXNlcjI2MTkyMTM1", "avatar_url": "https://avatars.githubusercontent.com/u/26192135?v=4", "gravatar_id": "", "url": "https://api.github.com/users/helpmefindaname", "html_url": "https://github.com/helpmefindaname", "followers_url": "https://api.github.com/users/helpmefindaname/followers", "following_url": "https://api.github.com/users/helpmefindaname/following{/other_user}", "gists_url": "https://api.github.com/users/helpmefindaname/gists{/gist_id}", "starred_url": "https://api.github.com/users/helpmefindaname/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/helpmefindaname/subscriptions", "organizations_url": "https://api.github.com/users/helpmefindaname/orgs", "repos_url": "https://api.github.com/users/helpmefindaname/repos", "events_url": "https://api.github.com/users/helpmefindaname/events{/privacy}", "received_events_url": "https://api.github.com/users/helpmefindaname/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2023-04-20T15:48:45Z", "updated_at": "2023-04-21T15:41:55Z", "closed_at": "2023-04-21T15:41:55Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "### Describe the bug\n\nrelated but not the same as: https://github.com/flairNLP/flair/issues/3167\r\n\r\nLocally saving a TarsModel won't save the huggingface config and therefore requires internet connection & a longer loading time when loading it on a new machine without hf-cache.\r\nThis happens due to tars pickeling the internal SequenceTagger/TextClassifier instead of just seralizing their embeddings.\n\n### To Reproduce\n\n```python\nfrom flair.models import TARSClassifier\r\n\r\nmodel = TARSClassifier.load(\"tars-base\")\r\nmodel.tars_embeddings.model.config._name_or_path = \"bert-base-uncased\"\r\nmodel.tars_embeddings.base_model_name = \"bert-base-uncased\"\r\nmodel.tars_embeddings.name = \"transformer-bert-base-uncased\"\r\nmodel.save(\"local-tars-base.pt\")\r\n\r\n# clear huggingface cache or copy `local-tars-base.pt` to another machine or docker container.\r\n\r\nmodel.load(\"local-tars-base.pt\")\n```\n\n\n### Expected behavior\n\nThe model should load without the need of internet and it shouldn't require me to wait until the embedding config and weights are downloaded.\n\n### Logs and Stack traces\n\n```stacktrace\nDownloading (\u2026)okenizer_config.json: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 28.0/28.0 [00:00<00:00, 17.2kB/s]\r\nDownloading (\u2026)lve/main/config.json: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 570/570 [00:00<00:00, 517kB/s]\r\nDownloading (\u2026)solve/main/vocab.txt: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 232k/232k [00:00<00:00, 2.12MB/s]\r\nDownloading (\u2026)/main/tokenizer.json: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 466k/466k [00:00<00:00, 3.61MB/s]\r\nDownloading pytorch_model.bin: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 440M/440M [00:35<00:00, 12.5MB/s]\n```\n\n\n### Screenshots\n\n_No response_\n\n### Additional Context\n\n_No response_\n\n### Environment\n\n#### Versions:\r\n##### Flair\r\n0.12.2 (master branch)\r\n##### Pytorch\r\n2.0.0+cu117\r\n##### Transformers\r\n4.28.1\r\n#### GPU\r\nTrue\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/3207/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/3207/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/3199", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/3199/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/3199/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/3199/events", "html_url": "https://github.com/flairNLP/flair/issues/3199", "id": 1673374592, "node_id": "I_kwDOCCkmXM5jvauA", "number": 3199, "title": "[Bug]: ModuleNotFoundError: 'flair.trainers.plugins.functional' on git-installed master", "user": {"login": "helpmefindaname", "id": 26192135, "node_id": "MDQ6VXNlcjI2MTkyMTM1", "avatar_url": "https://avatars.githubusercontent.com/u/26192135?v=4", "gravatar_id": "", "url": "https://api.github.com/users/helpmefindaname", "html_url": "https://github.com/helpmefindaname", "followers_url": "https://api.github.com/users/helpmefindaname/followers", "following_url": "https://api.github.com/users/helpmefindaname/following{/other_user}", "gists_url": "https://api.github.com/users/helpmefindaname/gists{/gist_id}", "starred_url": "https://api.github.com/users/helpmefindaname/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/helpmefindaname/subscriptions", "organizations_url": "https://api.github.com/users/helpmefindaname/orgs", "repos_url": "https://api.github.com/users/helpmefindaname/repos", "events_url": "https://api.github.com/users/helpmefindaname/events{/privacy}", "received_events_url": "https://api.github.com/users/helpmefindaname/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-04-18T15:28:44Z", "updated_at": "2023-04-19T20:12:44Z", "closed_at": "2023-04-19T20:12:44Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "### Describe the bug\n\nWhen installing the flair master branch via pypi & git, we get an ModuleNotFound error.\n\n### To Reproduce\n\n```python\nexec(\"pip install git+https://github.com/flairNLP/flair.git\")\r\nfrom flair.models import TARSClassifier\n```\n\n\n### Expected behavior\n\nI can import any module and use flair normally.\n\n### Logs and Stack traces\n\n```stacktrace\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"C:\\Users\\bened\\anaconda3\\envs\\steepmc_clf\\lib\\site-packages\\flair\\__init__.py\", line 28, in <module>\r\n    from . import (  # noqa: E402 import after setting device\r\n  File \"C:\\Users\\bened\\anaconda3\\envs\\steepmc_clf\\lib\\site-packages\\flair\\trainers\\__init__.py\", line 2, in <module>\r\n    from .trainer import ModelTrainer\r\n  File \"C:\\Users\\bened\\anaconda3\\envs\\steepmc_clf\\lib\\site-packages\\flair\\trainers\\trainer.py\", line 19, in <module>\r\n    from flair.trainers.plugins import (\r\n  File \"C:\\Users\\bened\\anaconda3\\envs\\steepmc_clf\\lib\\site-packages\\flair\\trainers\\plugins\\__init__.py\", line 2, in <module>\r\n    from .functional.amp import AmpPlugin\r\nModuleNotFoundError: No module named 'flair.trainers.plugins.functional'\n```\n\n\n### Screenshots\n\n_No response_\n\n### Additional Context\n\nI suppose this happens due to missing `__init__.py` files in https://github.com/flairNLP/flair/tree/master/flair/trainers/plugins/functional and https://github.com/flairNLP/flair/tree/master/flair/trainers/plugins/loggers \r\n\r\nleading to those folders not being recognized as modules and therefore won't be found/installed as code.\n\n### Environment\n\n#### Versions:\r\n##### Pytorch\r\n2.0.0+cu117\r\n##### flair\r\n`ModuleNotFoundError`\r\n##### Transformers\r\n4.28.1\r\n#### GPU\r\nTrue\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/3199/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/3199/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/3167", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/3167/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/3167/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/3167/events", "html_url": "https://github.com/flairNLP/flair/issues/3167", "id": 1643561833, "node_id": "I_kwDOCCkmXM5h9sNp", "number": 3167, "title": "[Bug]: Training a Model Results in an OSError Related to Model Loading", "user": {"login": "ynusinovich", "id": 61306479, "node_id": "MDQ6VXNlcjYxMzA2NDc5", "avatar_url": "https://avatars.githubusercontent.com/u/61306479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ynusinovich", "html_url": "https://github.com/ynusinovich", "followers_url": "https://api.github.com/users/ynusinovich/followers", "following_url": "https://api.github.com/users/ynusinovich/following{/other_user}", "gists_url": "https://api.github.com/users/ynusinovich/gists{/gist_id}", "starred_url": "https://api.github.com/users/ynusinovich/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ynusinovich/subscriptions", "organizations_url": "https://api.github.com/users/ynusinovich/orgs", "repos_url": "https://api.github.com/users/ynusinovich/repos", "events_url": "https://api.github.com/users/ynusinovich/events{/privacy}", "received_events_url": "https://api.github.com/users/ynusinovich/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2023-03-28T09:34:18Z", "updated_at": "2023-04-21T15:41:56Z", "closed_at": "2023-04-21T15:41:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\n\nWhen I am creating a few shot learning model by finetuning tars-base, the model crashes after training without saving to my local drive like it's supposed to.\n\n### To Reproduce\n\n```python\n# 1. what label do you want to predict?\r\nlabel_type = 'label'\r\n\r\n# 2. make a label dictionary\r\nlabel_dict = corpus.make_label_dictionary(label_type=label_type)\r\n\r\n# 3. start from our existing TARS base model for English\r\ntars = TARSClassifier.load(\"tars-base\")\r\n\r\n# 4. switch to a new task (TARS can do multiple tasks so you must define one)\r\ntars.add_and_switch_to_new_task(task_name=\"classification\",\r\n                                label_dictionary=label_dict,\r\n                                label_type=label_type,\r\n                                )\r\n\r\n# 5. initialize the text classifier trainer\r\ntrainer = ModelTrainer(tars, corpus)\r\n\r\n# 6. start the training\r\ntrainer.train(base_path='../example_data/models/few_shot_model_flair',  # path to store the model artifacts\r\n              learning_rate=0.02,  # use very small learning rate\r\n              mini_batch_size=1,\r\n              max_epochs=20,  # terminate after 20 epochs\r\n              patience=1\r\n              )\n```\n\n\n### Expected behaivor\n\nI would expect the model to save to the folder.\n\n### Logs and Stack traces\n\n```stacktrace\nHTTPError                                 Traceback (most recent call last)\r\nFile ~/Documents/env/lib/python3.9/site-packages/huggingface_hub/utils/_errors.py:213, in hf_raise_for_status(response, endpoint_name)\r\n    212 try:\r\n--> 213     response.raise_for_status()\r\n    214 except HTTPError as e:\r\n\r\nFile ~/Documents/env/lib/python3.9/site-packages/requests/models.py:1021, in Response.raise_for_status(self)\r\n   1020 if http_error_msg:\r\n-> 1021     raise HTTPError(http_error_msg, response=self)\r\n\r\nHTTPError: 401 Client Error: Unauthorized for url: https://huggingface.co/None/resolve/main/tokenizer_config.json\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nRepositoryNotFoundError                   Traceback (most recent call last)\r\nFile ~/Documents/env/lib/python3.9/site-packages/transformers/utils/hub.py:409, in cached_file(path_or_repo_id, filename, cache_dir, force_download, resume_download, proxies, use_auth_token, revision, local_files_only, subfolder, user_agent, _raise_exceptions_for_missing_entries, _raise_exceptions_for_connection_errors, _commit_hash)\r\n    407 try:\r\n    408     # Load from URL or cache if already cached\r\n--> 409     resolved_file = hf_hub_download(\r\n    410         path_or_repo_id,\r\n    411         filename,\r\n    412         subfolder=None if len(subfolder) == 0 else subfolder,\r\n    413         revision=revision,\r\n    414         cache_dir=cache_dir,\r\n...\r\n    434         f\"'https://huggingface.co/{path_or_repo_id}' for available revisions.\"\r\n    435     )\r\n\r\nOSError: None is not a local folder and is not a valid model identifier listed on 'https://huggingface.co/models'\r\nIf this is a private repository, make sure to pass a token having permission to this repo with `use_auth_token` or log in with `huggingface-cli login` and pass `use_auth_token=True`.\n```\n\n\n### Screenshots\n\n_No response_\n\n### Additional Context\n\nThe training completed all epochs before crashing.\r\nThe code I used was from your tutorial page. It has worked in the past.\n\n### Environment\n\n#### Versions:\r\n##### Flair\r\n0.12.1\r\n##### Pytorch\r\n1.13.1\r\n##### Transformers\r\n4.25.1\r\n#### GPU\r\nFalse", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/3167/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/3167/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/3160", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/3160/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/3160/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/3160/events", "html_url": "https://github.com/flairNLP/flair/issues/3160", "id": 1637043502, "node_id": "I_kwDOCCkmXM5hk00u", "number": 3160, "title": "[Bug]: GPT2 finetune error", "user": {"login": "shrimonmuke0202", "id": 71223690, "node_id": "MDQ6VXNlcjcxMjIzNjkw", "avatar_url": "https://avatars.githubusercontent.com/u/71223690?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shrimonmuke0202", "html_url": "https://github.com/shrimonmuke0202", "followers_url": "https://api.github.com/users/shrimonmuke0202/followers", "following_url": "https://api.github.com/users/shrimonmuke0202/following{/other_user}", "gists_url": "https://api.github.com/users/shrimonmuke0202/gists{/gist_id}", "starred_url": "https://api.github.com/users/shrimonmuke0202/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shrimonmuke0202/subscriptions", "organizations_url": "https://api.github.com/users/shrimonmuke0202/orgs", "repos_url": "https://api.github.com/users/shrimonmuke0202/repos", "events_url": "https://api.github.com/users/shrimonmuke0202/events{/privacy}", "received_events_url": "https://api.github.com/users/shrimonmuke0202/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-03-23T08:10:41Z", "updated_at": "2023-03-23T08:40:19Z", "closed_at": "2023-03-23T08:40:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\n\nWhen I trying to fine tune GPT2-medium on our NER task, I got an error \"ValueError: Asking to pad but the tokenizer does not have a padding token. Please select a token to use as `pad_token` `(tokenizer.pad_token = tokenizer.eos_token e.g.)` or add a new pad token via `tokenizer.add_special_tokens({'pad_token': '[PAD]'})`.\"\n\n### To Reproduce\n\n```python\nimport flair\r\nfrom flair import set_seed\r\nfrom flair.embeddings import TransformerWordEmbeddings\r\nfrom flair.models import SequenceTagger\r\nfrom flair.trainers import ModelTrainer\r\nfrom flair.datasets import ColumnCorpus\r\n\r\nPlease load any train.txt, dev.txt, test.txt in CoNLL\r\n\r\ncolumns = {0: 'text', 1: 'ner'}\r\n\r\n\r\ncorpus: Corpus = ColumnCorpus(./, columns,\r\n                              train_file=train.txt,\r\n                              test_file=test.txt,\r\n                              dev_file=dev\r\n                              )\r\n    \r\n    logger.info(corpus)\r\n    \r\n    tag_type: str = \"ner\"\r\n    \r\n    label_dict = corpus.make_label_dictionary(label_type=tag_type)\r\n    logger.info(label_dict)\r\n\r\nembeddings = TransformerWordEmbeddings(\r\n        gpt2-medium,\r\n        layers=-1,\r\n        subtoken_pooling=first_last,\r\n        fine_tune=True,\r\n        allow_long_sentences=True,\r\n        use_context=True,\r\n        respect_document_boundaries=flert_args.respect_document_boundaries,\r\n    )\r\n    \r\n    tagger = SequenceTagger(\r\n        hidden_size=256,\r\n        embeddings=embeddings,\r\n        tag_dictionary=label_dict,\r\n        tag_type=tag_type,\r\n        use_crf=model_args.use_crf,\r\n        use_rnn=True,\r\n        rnn_layers=2,\r\n        bidirectional=True,\r\n        allow_unk_predictions=False,\r\n        reproject_embeddings=True,\r\n    )\r\n    \r\n    trainer = ModelTrainer(tagger, corpus)\r\n    \r\n    trainer.fine_tune(\r\n        model,\r\n        learning_rate=0.0005,\r\n        mini_batch_size=8,\r\n        mini_batch_chunk_size=training_args.mini_batch_chunk_size,\r\n        max_epochs=10,\r\n        embeddings_storage_mode=training_args.embeddings_storage_mode,\r\n        param_selection_mode=False,\r\n        use_final_model_for_eval=False,\r\n        save_final_model=False,\r\n        checkpoint=False\r\n    )\n```\n\n\n### Expected behaivor\n\nIf the error is solved then the training will start.\r\n\r\n2023-03-23 07:05:20,876 epoch 1 - iter 511/5117 - loss 2.30516337 - time (sec): 232.76 - samples/sec: 446.66 - lr: 0.000005\r\n2023-03-23 07:09:10,437 epoch 1 - iter 1022/5117 - loss 1.86657456 - time (sec): 462.32 - samples/sec: 443.36 - lr: 0.000010\n\n### Logs and Stack traces\n\n```stacktrace\nTraceback (most recent call last):\r\n  File \"/notebooks/cocharne/Blink/train.py\", line 147, in <module>\r\n    main()\r\n  File \"/notebooks/cocharne/Blink/train.py\", line 133, in main\r\n    trainer.fine_tune(\r\n  File \"/usr/local/lib/python3.9/dist-packages/flair/trainers/trainer.py\", line 971, in fine_tune\r\n    return self.train(\r\n  File \"/usr/local/lib/python3.9/dist-packages/flair/trainers/trainer.py\", line 541, in train\r\n    loss, datapoint_count = self.model.forward_loss(batch_step)\r\n  File \"/usr/local/lib/python3.9/dist-packages/flair/models/sequence_tagger_model.py\", line 274, in forward_loss\r\n    sentence_tensor, lengths = self._prepare_tensors(sentences)\r\n  File \"/usr/local/lib/python3.9/dist-packages/flair/models/sequence_tagger_model.py\", line 287, in _prepare_tensors\r\n    self.embeddings.embed(sentences)\r\n  File \"/usr/local/lib/python3.9/dist-packages/flair/embeddings/base.py\", line 49, in embed\r\n    self._add_embeddings_internal(data_points)\r\n  File \"/usr/local/lib/python3.9/dist-packages/flair/embeddings/transformer.py\", line 653, in _add_embeddings_internal\r\n    tensors = self.prepare_tensors(sentences, device=self.force_device)\r\n  File \"/usr/local/lib/python3.9/dist-packages/flair/embeddings/transformer.py\", line 467, in prepare_tensors\r\n    return self.__build_transformer_model_inputs(sentences, offsets, lengths, flair_tokens, device)\r\n  File \"/usr/local/lib/python3.9/dist-packages/flair/embeddings/transformer.py\", line 483, in __build_transformer_model_inputs\r\n    batch_encoding = self.tokenizer(\r\n  File \"/usr/local/lib/python3.9/dist-packages/transformers/tokenization_utils_base.py\", line 2530, in __call__\r\n    encodings = self._call_one(text=text, text_pair=text_pair, **all_kwargs)\r\n  File \"/usr/local/lib/python3.9/dist-packages/transformers/tokenization_utils_base.py\", line 2616, in _call_one\r\n    return self.batch_encode_plus(\r\n  File \"/usr/local/lib/python3.9/dist-packages/transformers/tokenization_utils_base.py\", line 2798, in batch_encode_plus\r\n    padding_strategy, truncation_strategy, max_length, kwargs = self._get_padding_truncation_strategies(\r\n  File \"/usr/local/lib/python3.9/dist-packages/transformers/tokenization_utils_base.py\", line 2435, in _get_padding_truncation_strategies\r\n    raise ValueError(\r\nValueError: Asking to pad but the tokenizer does not have a padding token. Please select a token to use as `pad_token` `(tokenizer.pad_token = tokenizer.eos_token e.g.)` or add a new pad token via `tokenizer.add_special_tokens({'pad_token': '[PAD]'})`.\n```\n\n\n### Screenshots\n\n_No response_\n\n### Additional Context\n\n_No response_\n\n### Environment\n\n#### Versions:\r\n##### Flair\r\n0.12.1\r\n##### Pytorch\r\n1.12.1+cu116\r\n##### Transformers\r\n4.27.0\r\n#### GPU\r\nTrue", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/3160/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/3160/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/3156", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/3156/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/3156/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/3156/events", "html_url": "https://github.com/flairNLP/flair/issues/3156", "id": 1635342269, "node_id": "I_kwDOCCkmXM5heVe9", "number": 3156, "title": "[Bug]: Caching bugs when accessing context in Sentence", "user": {"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-03-22T09:07:11Z", "updated_at": "2023-03-22T16:18:39Z", "closed_at": "2023-03-22T16:18:38Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "### Describe the bug\r\n\r\nThe `right_context` and `left_context` functions of the `Sentence` are used to calculate the context for all our best models. However, the behavior of the context expansion is inconsistent due to two bugs.\r\n\r\n### To Reproduce\r\n\r\n```python\r\nfrom flair.data import Sentence\r\n\r\n# make a sentence without context\r\nsentence = Sentence(\"Luke and Leia destroyed the Death Star.\")\r\nprint(sentence)\r\n# print right context: There is none - CORRECT!\r\nprint(sentence.right_context(4))\r\n\r\n# now make a second sentence and set it as context\r\nother_sentence = Sentence(\"The Death Star then exploded.\")\r\nSentence.set_context_for_sentences([sentence, other_sentence])\r\n# print(sentence.next_sentence()) # verify that next sentence is correctly set (it is: CORRECT)\r\n\r\n# now print right context. Even though context is set, right_context returns '[]': ERROR!\r\nprint(sentence.right_context(4))\r\n\r\n# now calculate right context for some other random sentence\r\nSentence(\"Why am I here?\").right_context(4)\r\n\r\n# print right context again. Now suddenly, the correct context is returned. (ERROR because inconsistent behavior)\r\nprint(sentence.right_context(4))\r\n```\r\n\r\n\r\n### Expected behaivor\r\n\r\nThe correct context should always be returned.\r\n\r\n### Additional Context\r\n\r\nThere are likely two reasons for this: \r\n- We set the `lru_cache` of `right_context` to 1 (https://github.com/flairNLP/flair/blob/857337d4c93b5985f498c6ab7389c53a9024c122/flair/data.py#L830). This is because I assumed that caching is computed here per-instance. But it turns out that caching is computed globally, even though the method is part of `Sentence`. This is why computing the right_context for some random sentence as in the snippet above results in a different context being computed: The original cache is already lost. -> to fix, set much higher cache size here\r\n- The main error is likely a problem with the equality definition of `Sentence`. Equality is considered only using features of the sentence itself, not its context. This is why setting a context belately and then calling `right_context` again gives the same result as before -> to fix this, the quality definition of `Sentence` needs to be changed\r\n\r\n### Environment\r\n\r\nPython 3.8, master branch", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/3156/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/3156/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/3152", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/3152/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/3152/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/3152/events", "html_url": "https://github.com/flairNLP/flair/issues/3152", "id": 1627494070, "node_id": "I_kwDOCCkmXM5hAZa2", "number": 3152, "title": "SSL certificate issue with Flair - https://flair.informatik.hu-berlin.de/", "user": {"login": "alexechoi", "id": 64334999, "node_id": "MDQ6VXNlcjY0MzM0OTk5", "avatar_url": "https://avatars.githubusercontent.com/u/64334999?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexechoi", "html_url": "https://github.com/alexechoi", "followers_url": "https://api.github.com/users/alexechoi/followers", "following_url": "https://api.github.com/users/alexechoi/following{/other_user}", "gists_url": "https://api.github.com/users/alexechoi/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexechoi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexechoi/subscriptions", "organizations_url": "https://api.github.com/users/alexechoi/orgs", "repos_url": "https://api.github.com/users/alexechoi/repos", "events_url": "https://api.github.com/users/alexechoi/events{/privacy}", "received_events_url": "https://api.github.com/users/alexechoi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2023-03-16T13:38:22Z", "updated_at": "2023-03-16T15:32:31Z", "closed_at": "2023-03-16T15:32:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\n\r\nSSL issue on https://flair.informatik.hu-berlin.de/\r\n\r\n### To Reproduce\r\n\r\nI am trying to use GLoVe with Flair and I get an SSL error\r\n\r\nhttps://flair.informatik.hu-berlin.de/\r\n\r\nSSLError: HTTPSConnectionPool(host='flair.informatik.hu-berlin.de', port=443): Max retries exceeded with url: /resources/embeddings/token/glove.gensim.vectors.npy (Caused by SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: certificate has expired (_ssl.c:1129)')))\r\n\r\nSpecifically I am running glove_embedding = WordEmbeddings('glove') using WordEmbeddings from Flair.\r\n\r\nDoes anyone know how I could bypass this while the SSL issue is present as the certificate is out of date for this domain?\r\n\r\n\r\n### Expected behaivour\r\n\r\nUsually would not have any SSL issues when running this.\r\n\r\n### Logs and Stack traces\r\n\r\n```stacktrace\r\n---------------------------------------------------------------------------\r\nSSLCertVerificationError                  Traceback (most recent call last)\r\n/usr/local/lib/python3.9/dist-packages/urllib3/connectionpool.py in urlopen(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, **response_kw)\r\n    702             # Make the request on the httplib connection object.\r\n--> 703             httplib_response = self._make_request(\r\n    704                 conn,\r\n\r\n19 frames\r\n/usr/local/lib/python3.9/dist-packages/urllib3/connectionpool.py in _make_request(self, conn, method, url, timeout, chunked, **httplib_request_kw)\r\n    385         try:\r\n--> 386             self._validate_conn(conn)\r\n    387         except (SocketTimeout, BaseSSLError) as e:\r\n\r\n/usr/local/lib/python3.9/dist-packages/urllib3/connectionpool.py in _validate_conn(self, conn)\r\n   1041         if not getattr(conn, \"sock\", None):  # AppEngine might not have  `.sock`\r\n-> 1042             conn.connect()\r\n   1043 \r\n\r\n/usr/local/lib/python3.9/dist-packages/urllib3/connection.py in connect(self)\r\n    418 \r\n--> 419         self.sock = ssl_wrap_socket(\r\n    420             sock=conn,\r\n\r\n/usr/local/lib/python3.9/dist-packages/urllib3/util/ssl_.py in ssl_wrap_socket(sock, keyfile, certfile, cert_reqs, ca_certs, server_hostname, ssl_version, ciphers, ssl_context, ca_cert_dir, key_password, ca_cert_data, tls_in_tls)\r\n    448     if send_sni:\r\n--> 449         ssl_sock = _ssl_wrap_socket_impl(\r\n    450             sock, context, tls_in_tls, server_hostname=server_hostname\r\n\r\n/usr/local/lib/python3.9/dist-packages/urllib3/util/ssl_.py in _ssl_wrap_socket_impl(sock, ssl_context, tls_in_tls, server_hostname)\r\n    492     if server_hostname:\r\n--> 493         return ssl_context.wrap_socket(sock, server_hostname=server_hostname)\r\n    494     else:\r\n\r\n/usr/lib/python3.9/ssl.py in wrap_socket(self, sock, server_side, do_handshake_on_connect, suppress_ragged_eofs, server_hostname, session)\r\n    500         # ctx._wrap_socket()\r\n--> 501         return self.sslsocket_class._create(\r\n    502             sock=sock,\r\n\r\n/usr/lib/python3.9/ssl.py in _create(cls, sock, server_side, do_handshake_on_connect, suppress_ragged_eofs, server_hostname, context, session)\r\n   1040                         raise ValueError(\"do_handshake_on_connect should not be specified for non-blocking sockets\")\r\n-> 1041                     self.do_handshake()\r\n   1042             except (OSError, ValueError):\r\n\r\n/usr/lib/python3.9/ssl.py in do_handshake(self, block)\r\n   1309                 self.settimeout(None)\r\n-> 1310             self._sslobj.do_handshake()\r\n   1311         finally:\r\n\r\nSSLCertVerificationError: [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: certificate has expired (_ssl.c:1129)\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nMaxRetryError                             Traceback (most recent call last)\r\n/usr/local/lib/python3.9/dist-packages/requests/adapters.py in send(self, request, stream, timeout, verify, cert, proxies)\r\n    438             if not chunked:\r\n--> 439                 resp = conn.urlopen(\r\n    440                     method=request.method,\r\n\r\n/usr/local/lib/python3.9/dist-packages/urllib3/connectionpool.py in urlopen(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, **response_kw)\r\n    786 \r\n--> 787             retries = retries.increment(\r\n    788                 method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]\r\n\r\n/usr/local/lib/python3.9/dist-packages/urllib3/util/retry.py in increment(self, method, url, response, error, _pool, _stacktrace)\r\n    591         if new_retry.is_exhausted():\r\n--> 592             raise MaxRetryError(_pool, url, error or ResponseError(cause))\r\n    593 \r\n\r\nMaxRetryError: HTTPSConnectionPool(host='flair.informatik.hu-berlin.de', port=443): Max retries exceeded with url: /resources/embeddings/token/glove.gensim.vectors.npy (Caused by SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: certificate has expired (_ssl.c:1129)')))\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nSSLError                                  Traceback (most recent call last)\r\n<ipython-input-18-aa3207283302> in <module>\r\n      9 \r\n     10 # create GloVe embeddings\r\n---> 11 glove_embedding = WordEmbeddings('glove')\r\n     12 \r\n     13 # create Sentence objects\r\n\r\n/usr/local/lib/python3.9/dist-packages/flair/embeddings/token.py in __init__(self, embeddings, field, fine_tune, force_cpu, stable)\r\n    143         # GLOVE embeddings\r\n    144         if embeddings.lower() == \"glove\" or embeddings.lower() == \"en-glove\":\r\n--> 145             cached_path(f\"{hu_path}/glove.gensim.vectors.npy\", cache_dir=cache_dir)\r\n    146             embeddings = cached_path(f\"{hu_path}/glove.gensim\", cache_dir=cache_dir)\r\n    147 \r\n\r\n/usr/local/lib/python3.9/dist-packages/flair/file_utils.py in cached_path(url_or_filename, cache_dir)\r\n     89     if parsed.scheme in (\"http\", \"https\"):\r\n     90         # URL, so get it from the cache (downloading if necessary)\r\n---> 91         return get_from_cache(url_or_filename, dataset_cache)\r\n     92     elif parsed.scheme == \"\" and Path(url_or_filename).exists():\r\n     93         # File, and it exists.\r\n\r\n/usr/local/lib/python3.9/dist-packages/flair/file_utils.py in get_from_cache(url, cache_dir)\r\n    215 \r\n    216     # make HEAD request to check ETag\r\n--> 217     response = requests.head(url, headers={\"User-Agent\": \"Flair\"}, allow_redirects=True)\r\n    218     if response.status_code != 200:\r\n    219         raise IOError(\r\n\r\n/usr/local/lib/python3.9/dist-packages/requests/api.py in head(url, **kwargs)\r\n    102 \r\n    103     kwargs.setdefault('allow_redirects', False)\r\n--> 104     return request('head', url, **kwargs)\r\n    105 \r\n    106 \r\n\r\n/usr/local/lib/python3.9/dist-packages/requests/api.py in request(method, url, **kwargs)\r\n     59     # cases, and look like a memory leak in others.\r\n     60     with sessions.Session() as session:\r\n---> 61         return session.request(method=method, url=url, **kwargs)\r\n     62 \r\n     63 \r\n\r\n/usr/local/lib/python3.9/dist-packages/requests/sessions.py in request(self, method, url, params, data, headers, cookies, files, auth, timeout, allow_redirects, proxies, hooks, stream, verify, cert, json)\r\n    540         }\r\n    541         send_kwargs.update(settings)\r\n--> 542         resp = self.send(prep, **send_kwargs)\r\n    543 \r\n    544         return resp\r\n\r\n/usr/local/lib/python3.9/dist-packages/requests/sessions.py in send(self, request, **kwargs)\r\n    653 \r\n    654         # Send the request\r\n--> 655         r = adapter.send(request, **kwargs)\r\n    656 \r\n    657         # Total elapsed time of the request (approximately)\r\n\r\n/usr/local/lib/python3.9/dist-packages/requests/adapters.py in send(self, request, stream, timeout, verify, cert, proxies)\r\n    512             if isinstance(e.reason, _SSLError):\r\n    513                 # This branch is for urllib3 v1.22 and later.\r\n--> 514                 raise SSLError(e, request=request)\r\n    515 \r\n    516             raise ConnectionError(e, request=request)\r\n\r\nSSLError: HTTPSConnectionPool(host='flair.informatik.hu-berlin.de', port=443): Max retries exceeded with url: /resources/embeddings/token/glove.gensim.vectors.npy (Caused by SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: certificate has expired (_ssl.c:1129)')))\r\n```\r\n\r\n\r\n### Screenshots\r\n\r\n_No response_\r\n\r\n### Additional Context\r\n\r\n_No response_\r\n\r\n### Environment\r\n\r\nGoogle Colab", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/3152/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/3152/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/3122", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/3122/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/3122/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/3122/events", "html_url": "https://github.com/flairNLP/flair/issues/3122", "id": 1597138484, "node_id": "I_kwDOCCkmXM5fMmY0", "number": 3122, "title": "[Bug]: Avg Pooling in the Entity Linker", "user": {"login": "aynetdia", "id": 65453386, "node_id": "MDQ6VXNlcjY1NDUzMzg2", "avatar_url": "https://avatars.githubusercontent.com/u/65453386?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aynetdia", "html_url": "https://github.com/aynetdia", "followers_url": "https://api.github.com/users/aynetdia/followers", "following_url": "https://api.github.com/users/aynetdia/following{/other_user}", "gists_url": "https://api.github.com/users/aynetdia/gists{/gist_id}", "starred_url": "https://api.github.com/users/aynetdia/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aynetdia/subscriptions", "organizations_url": "https://api.github.com/users/aynetdia/orgs", "repos_url": "https://api.github.com/users/aynetdia/repos", "events_url": "https://api.github.com/users/aynetdia/events{/privacy}", "received_events_url": "https://api.github.com/users/aynetdia/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "aynetdia", "id": 65453386, "node_id": "MDQ6VXNlcjY1NDUzMzg2", "avatar_url": "https://avatars.githubusercontent.com/u/65453386?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aynetdia", "html_url": "https://github.com/aynetdia", "followers_url": "https://api.github.com/users/aynetdia/followers", "following_url": "https://api.github.com/users/aynetdia/following{/other_user}", "gists_url": "https://api.github.com/users/aynetdia/gists{/gist_id}", "starred_url": "https://api.github.com/users/aynetdia/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aynetdia/subscriptions", "organizations_url": "https://api.github.com/users/aynetdia/orgs", "repos_url": "https://api.github.com/users/aynetdia/repos", "events_url": "https://api.github.com/users/aynetdia/events{/privacy}", "received_events_url": "https://api.github.com/users/aynetdia/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aynetdia", "id": 65453386, "node_id": "MDQ6VXNlcjY1NDUzMzg2", "avatar_url": "https://avatars.githubusercontent.com/u/65453386?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aynetdia", "html_url": "https://github.com/aynetdia", "followers_url": "https://api.github.com/users/aynetdia/followers", "following_url": "https://api.github.com/users/aynetdia/following{/other_user}", "gists_url": "https://api.github.com/users/aynetdia/gists{/gist_id}", "starred_url": "https://api.github.com/users/aynetdia/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aynetdia/subscriptions", "organizations_url": "https://api.github.com/users/aynetdia/orgs", "repos_url": "https://api.github.com/users/aynetdia/repos", "events_url": "https://api.github.com/users/aynetdia/events{/privacy}", "received_events_url": "https://api.github.com/users/aynetdia/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2023-02-23T16:09:34Z", "updated_at": "2023-03-03T08:58:40Z", "closed_at": "2023-03-03T08:58:40Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "### Describe the bug\r\n\r\nA runtime error is raised upon prediction when using \"average\" as the pooling operation in the Entity Linker\r\n\r\n### To Reproduce\r\n\r\n```python\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import NEL_ENGLISH_TWEEKI\r\nfrom flair.embeddings import TransformerWordEmbeddings\r\nfrom flair.models import EntityLinker\r\n\r\ncorpus: Corpus = NEL_ENGLISH_TWEEKI(sample_missing_splits=False)\r\n\r\nembeddings = TransformerWordEmbeddings(\r\n    model=\"distilbert-base-uncased\",\r\n    fine_tune=True,\r\n)\r\n\r\nentity_linker = EntityLinker(\r\n    embeddings=embeddings,\r\n    label_dictionary=corpus.make_label_dictionary(label_type=\"nel\"),\r\n    label_type=\"nel\",\r\n    pooling_operation=\"average\",\r\n)\r\n\r\nentity_linker.predict(corpus.train[0])\r\n```\r\n\r\n\r\n### Expected behaivor\r\n\r\nThe Entity Linker should be able to perform average pooling without any issues, like in the case of other pooling options.\r\n\r\n### Logs and Stack traces\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\nCell In [1], line 20\r\n      8 embeddings = TransformerWordEmbeddings(\r\n      9     model=\"distilbert-base-uncased\",\r\n     10     fine_tune=True,\r\n     11 )\r\n     13 entity_linker = EntityLinker(\r\n     14     embeddings=embeddings,\r\n     15     label_dictionary=corpus.make_label_dictionary(label_type=\"nel\"),\r\n     16     label_type=\"nel\",\r\n     17     pooling_operation=\"average\",\r\n     18 )\r\n---> 20 entity_linker.predict(corpus.train[0])\r\n\r\nFile ~/projects/flair_forked/flair/nn/model.py:826, in DefaultClassifier.predict(self, sentences, mini_batch_size, return_probabilities_for_all_classes, verbose, label_name, return_loss, embedding_storage_mode)\r\n    824 # pass data points through network and decode\r\n    825 data_point_tensor = self._encode_data_points(batch, data_points)\r\n--> 826 scores = self.decoder(data_point_tensor)\r\n    827 scores = self._mask_scores(scores, data_points)\r\n    829 # if anything could possibly be predicted\r\n\r\nFile ~/miniforge3/envs/flair/lib/python3.9/site-packages/torch/nn/modules/module.py:1190, in Module._call_impl(self, *input, **kwargs)\r\n   1186 # If we don't have any hooks, we want to skip the rest of the logic in\r\n   1187 # this function, and just call forward.\r\n   1188 if not (self._backward_hooks or self._forward_hooks or self._forward_pre_hooks or _global_backward_hooks\r\n   1189         or _global_forward_hooks or _global_forward_pre_hooks):\r\n-> 1190     return forward_call(*input, **kwargs)\r\n   1191 # Do not call functions when jit is used\r\n   1192 full_backward_hooks, non_full_backward_hooks = [], []\r\n\r\nFile ~/miniforge3/envs/flair/lib/python3.9/site-packages/torch/nn/modules/linear.py:114, in Linear.forward(self, input)\r\n    113 def forward(self, input: Tensor) -> Tensor:\r\n--> 114     return F.linear(input, self.weight, self.bias)\r\n\r\nRuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 768x650)\r\n```\r\n\r\n### Screenshots\r\n\r\n_No response_\r\n\r\n### Additional Context\r\n\r\n_No response_\r\n\r\n### Environment\r\n\r\n#### Versions:\r\n##### Flair\r\n0.11.3\r\n##### Pytorch\r\n1.13.0\r\n##### Transformers\r\n4.24.0\r\n#### GPU\r\nFalse", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/3122/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/3122/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/3120", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/3120/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/3120/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/3120/events", "html_url": "https://github.com/flairNLP/flair/issues/3120", "id": 1592193798, "node_id": "I_kwDOCCkmXM5e5vMG", "number": 3120, "title": "[Bug]: No such file or directory: conll_03", "user": {"login": "AugustasMacys", "id": 13801804, "node_id": "MDQ6VXNlcjEzODAxODA0", "avatar_url": "https://avatars.githubusercontent.com/u/13801804?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AugustasMacys", "html_url": "https://github.com/AugustasMacys", "followers_url": "https://api.github.com/users/AugustasMacys/followers", "following_url": "https://api.github.com/users/AugustasMacys/following{/other_user}", "gists_url": "https://api.github.com/users/AugustasMacys/gists{/gist_id}", "starred_url": "https://api.github.com/users/AugustasMacys/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AugustasMacys/subscriptions", "organizations_url": "https://api.github.com/users/AugustasMacys/orgs", "repos_url": "https://api.github.com/users/AugustasMacys/repos", "events_url": "https://api.github.com/users/AugustasMacys/events{/privacy}", "received_events_url": "https://api.github.com/users/AugustasMacys/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-02-20T16:56:15Z", "updated_at": "2023-02-20T22:22:25Z", "closed_at": "2023-02-20T22:22:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\n\nSeems that I cannot download dataset while following tutorial 13\n\n### To Reproduce\n\n```python\nfrom flair.datasets import CONLL_03\r\nCONLL_03()\n```\n\n\n### Expected behaivor\n\nDataset is downloaded\n\n### Logs and Stack traces\n\n```stacktrace\n2023-02-20 16:49:06,547 ----------------------------------------------------------------------------------------------------\r\n2023-02-20 16:49:06,551 WARNING: CoNLL-03 dataset not found at \"/Users/augustas/.flair/datasets/conll_03\".\r\n2023-02-20 16:49:06,552 Instructions for obtaining the data can be found here: https://www.clips.uantwerpen.be/conll2003/ner/\"\r\n2023-02-20 16:49:06,553 ----------------------------------------------------------------------------------------------------\n```\n\n\n### Screenshots\n\n_No response_\n\n### Additional Context\n\n_No response_\n\n### Environment\n\npython 3.7.11", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/3120/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/3120/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/3117", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/3117/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/3117/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/3117/events", "html_url": "https://github.com/flairNLP/flair/issues/3117", "id": 1591615826, "node_id": "I_kwDOCCkmXM5e3iFS", "number": 3117, "title": "[Bug]: DataPair main tag after classification sometime does not equal the tag with the biggest score", "user": {"login": "dchaplinsky", "id": 131186, "node_id": "MDQ6VXNlcjEzMTE4Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/131186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dchaplinsky", "html_url": "https://github.com/dchaplinsky", "followers_url": "https://api.github.com/users/dchaplinsky/followers", "following_url": "https://api.github.com/users/dchaplinsky/following{/other_user}", "gists_url": "https://api.github.com/users/dchaplinsky/gists{/gist_id}", "starred_url": "https://api.github.com/users/dchaplinsky/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dchaplinsky/subscriptions", "organizations_url": "https://api.github.com/users/dchaplinsky/orgs", "repos_url": "https://api.github.com/users/dchaplinsky/repos", "events_url": "https://api.github.com/users/dchaplinsky/events{/privacy}", "received_events_url": "https://api.github.com/users/dchaplinsky/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2023-02-20T10:59:31Z", "updated_at": "2023-03-06T15:14:24Z", "closed_at": "2023-03-06T15:14:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\n\nDataPair.tag sometime returns not the top-score label\n\n### To Reproduce\n\n```python\nfrom flair.models import TextPairClassifier\r\nfrom flair.data import Sentence, DataPair\r\nimport json\r\n\r\nclassifier = TextPairClassifier.load('experiments/first_run/model/best-model.pt')\r\ndef predict_pair(left_word: str, right_word: str)-> None:\r\n    sentence_pair = DataPair(\r\n        first=Sentence(left_word),\r\n        second=Sentence(right_word)\r\n    )\r\n\r\n    classifier.predict(sentence_pair)\r\n    \r\n    return sentence_pair.tag, \"\\n\".join(f\"{label.value}: {label.score:.3f}\" for label in sentence_pair.get_labels())\r\n\r\nprint(predict_pair(\"\u0431\u0430\u0440\u0432\u043d\u0438\u0439\", \"\u0446\u0438\u0442\u0440\u0438\u043d\u043e\u0432\u0438\u0439\"))\r\n\r\nreturns\r\n('antonym', 'antonym: 0.886\\nhypernym-hyponym: 1.000')\r\nIn [35]:\n```\n\n\n### Expected behaivor\n\nsentence_pair.tag will return the label with the biggest confidence (`hypernym-hyponym` rather than `antonym `)\n\n### Logs and Stack traces\n\n_No response_\n\n### Screenshots\n\n_No response_\n\n### Additional Context\n\n_No response_\n\n### Environment\n\n#### Versions:\r\n##### Flair\r\n0.11.3\r\n##### Pytorch\r\n1.13.0+cu117\r\n##### Transformers\r\n4.24.0\r\n#### GPU\r\nTrue", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/3117/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/3117/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/3097", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/3097/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/3097/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/3097/events", "html_url": "https://github.com/flairNLP/flair/issues/3097", "id": 1579710261, "node_id": "I_kwDOCCkmXM5eKHc1", "number": 3097, "title": "[Bug]: Multitask evaluation (and therefore training) fails on current master.", "user": {"login": "helpmefindaname", "id": 26192135, "node_id": "MDQ6VXNlcjI2MTkyMTM1", "avatar_url": "https://avatars.githubusercontent.com/u/26192135?v=4", "gravatar_id": "", "url": "https://api.github.com/users/helpmefindaname", "html_url": "https://github.com/helpmefindaname", "followers_url": "https://api.github.com/users/helpmefindaname/followers", "following_url": "https://api.github.com/users/helpmefindaname/following{/other_user}", "gists_url": "https://api.github.com/users/helpmefindaname/gists{/gist_id}", "starred_url": "https://api.github.com/users/helpmefindaname/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/helpmefindaname/subscriptions", "organizations_url": "https://api.github.com/users/helpmefindaname/orgs", "repos_url": "https://api.github.com/users/helpmefindaname/repos", "events_url": "https://api.github.com/users/helpmefindaname/events{/privacy}", "received_events_url": "https://api.github.com/users/helpmefindaname/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2023-02-10T13:45:48Z", "updated_at": "2023-02-14T09:56:12Z", "closed_at": "2023-02-14T09:56:12Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "### Describe the bug\n\nThe Multitask training fails when evaluating, as it now gets a `str` for the label_type, while still expecting a dictionary.\n\n### To Reproduce\n\n```python\nfrom flair.embeddings import TransformerWordEmbeddings\r\nfrom flair.trainers import ModelTrainer\r\nfrom flair.models import SequenceTagger, RelationExtractor, MultitaskModel\r\n\r\ncorpus = create_corpus()  # any corpus with multiple tasks annotated should work.\r\n\r\nembeddings = TransformerWordEmbeddings(\r\n        model=\"bert-base-cased\",\r\n    )\r\n\r\nner_model = SequenceTagger(\r\n    embeddings=embeddings,\r\n    tag_dictionary=corpus.make_label_dictionary(\"ner\", add_unk=False),\r\n    tag_type=\"ner\",\r\n)\r\nrel_model = RelationExtractor(\r\n    embeddings=embeddings,\r\n    label_dictionary=corpus.make_label_dictionary(\"rel\", add_unk=True),\r\n    entity_label_type=\"ner\",\r\n    label_type=\"rel\",\r\n)\r\n\r\nmodel = MultitaskModel([ner_model, rel_model])\r\n\r\ntrainer = ModelTrainer(model, corpus)\r\n\r\ntrainer.train(\"training-path\")\n```\n\n\n### Expected behaivor\n\nA training should run trough without any issues and produce a trained model\n\n### Logs and Stack traces\n\n```stacktrace\nFile \"/mnt/raid/bfuchs/.cache/pypoetry/virtualenvs/xDHSzyCG-py3.8/lib/python3.8/site-packages/clearml/binding/hydra_bind.py\", line 173, in _patched_task_function\r\n    return task_function(a_config, *a_args, **a_kwargs)\r\n  File \"/mnt/raid/bfuchs/train.py\", line 203, in main\r\n    results = trainer.fine_tune(\r\n  File \"/mnt/raid/bfuchs/.cache/pypoetry/virtualenvs/xDHSzyCG-py3.8/lib/python3.8/site-packages/flair/trainers/trainer.py\", line 946, in fine_tune\r\n    return self.train(\r\n  File \"/mnt/raid/bfuchs/.cache/pypoetry/virtualenvs/xDHSzyCG-py3.8/lib/python3.8/site-packages/flair/trainers/trainer.py\", line 643, in train\r\n    dev_eval_result = self.model.evaluate(\r\n  File \"/mnt/raid/bfuchs/.cache/pypoetry/virtualenvs/xDHSzyCG-py3.8/lib/python3.8/site-packages/flair/models/multitask_model.py\", line 160, in evaluate\r\n    + self.label_type.get(task_id)\n```\n\n\n### Screenshots\n\n_No response_\n\n### Additional Context\n\nA simple hotfix is to go to the `evaluate` method in the `multitask_model.py` and replace all occurances of `gold_label_type[task_id]` with `self.tasks[task_id].label_type`. However this might not be the cleanest solution, as this lead to the `gold_label_type` parameter to be ignored.\n\n### Environment\n\n#### Versions:\r\n##### Flair\r\n0.11.3\r\n##### Pytorch\r\n1.12.0+cu113\r\n##### Transformers\r\n4.21.1\r\n#### GPU\r\nTrue", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/3097/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 1, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/3097/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/3091", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/3091/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/3091/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/3091/events", "html_url": "https://github.com/flairNLP/flair/issues/3091", "id": 1576104059, "node_id": "I_kwDOCCkmXM5d8XB7", "number": 3091, "title": "[Bug]: Missing dev dependency pre-commit ", "user": {"login": "HallerPatrick", "id": 22773355, "node_id": "MDQ6VXNlcjIyNzczMzU1", "avatar_url": "https://avatars.githubusercontent.com/u/22773355?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HallerPatrick", "html_url": "https://github.com/HallerPatrick", "followers_url": "https://api.github.com/users/HallerPatrick/followers", "following_url": "https://api.github.com/users/HallerPatrick/following{/other_user}", "gists_url": "https://api.github.com/users/HallerPatrick/gists{/gist_id}", "starred_url": "https://api.github.com/users/HallerPatrick/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HallerPatrick/subscriptions", "organizations_url": "https://api.github.com/users/HallerPatrick/orgs", "repos_url": "https://api.github.com/users/HallerPatrick/repos", "events_url": "https://api.github.com/users/HallerPatrick/events{/privacy}", "received_events_url": "https://api.github.com/users/HallerPatrick/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-02-08T13:14:31Z", "updated_at": "2023-02-14T15:39:18Z", "closed_at": "2023-02-14T15:39:18Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### Describe the bug\n\nThe contributor documentation states that after installing all dev dependencies the command `pre-commit install` installs all pre-commit hook. This will fail due to missing dependency\n\n### To Reproduce\n\n```python\nFollow the instructions in the [documentation](https://github.com/flairNLP/flair/blob/master/CONTRIBUTING.md#developing-locally).\r\n\r\nAn error at the command line will tell that the command `pre-commit` is unknown.\n```\n\n\n### Expected behaivor\n\nInstallation of pre-commit hooks\n\n### Logs and Stack traces\n\n_No response_\n\n### Screenshots\n\n_No response_\n\n### Additional Context\n\n_No response_\n\n### Environment\n\n#### Versions:\r\n##### Flair\r\n0.11.3\r\n##### Pytorch\r\n1.13.1\r\n##### Transformers\r\n4.26.0\r\n#### GPU\r\nFalse", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/3091/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/3091/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/3090", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/3090/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/3090/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/3090/events", "html_url": "https://github.com/flairNLP/flair/issues/3090", "id": 1576101701, "node_id": "I_kwDOCCkmXM5d8WdF", "number": 3090, "title": "[Bug]: Pre-commit hooks fails due to updated isort version", "user": {"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2023-02-08T13:12:57Z", "updated_at": "2023-02-15T08:55:20Z", "closed_at": "2023-02-15T08:55:20Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "### Describe the bug\n\nsee above\n\n### To Reproduce\n\n```python\nwhen executing 'pre-commit' following error arises:\r\n\r\nRuntimeError: The Poetry configuration is invalid:\r\n            - [extras.pipfile_deprecated_finder.2] 'pip-shims<=0.3.4' does not match '^[a-zA-Z-_.0-9]+$'\n```\n\n\n### Expected behaivor\n\nSee [issue](https://github.com/PyCQA/isort/issues?q=is%3Aissue+is%3Aopen+isort) here. Upgrade to isort 5.12.0 is required, however, this required python 3.8. for everything lower than 3.8, this issue occurs.\n\n### Logs and Stack traces\n\n```stacktrace\nRuntimeError: The Poetry configuration is invalid:\r\n            - [extras.pipfile_deprecated_finder.2] 'pip-shims<=0.3.4' does not match '^[a-zA-Z-_.0-9]+$'\n```\n\n\n### Screenshots\n\n_No response_\n\n### Additional Context\n\n_No response_\n\n### Environment\n\n#### Versions:\r\n##### Flair\r\n0.11.3\r\n##### Pytorch\r\n1.12.1\r\n##### Transformers\r\n4.23.1\r\n#### GPU\r\nTrue\r\n\r\nPython 3.7", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/3090/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/3090/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/3077", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/3077/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/3077/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/3077/events", "html_url": "https://github.com/flairNLP/flair/issues/3077", "id": 1563992104, "node_id": "I_kwDOCCkmXM5dOKAo", "number": 3077, "title": "[Bug]: Loaded TransformerEmbeddings no longer have context_length set", "user": {"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2023-01-31T09:56:18Z", "updated_at": "2023-02-03T11:46:08Z", "closed_at": "2023-02-03T11:46:08Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "### Describe the bug\n\nWhen loading a saved TransformerEmbeddings in master branch, we lose the context_length variable. This leads to much reduced accuracy for loaded models.\n\n### To Reproduce\n\n```python\nfrom flair.data import Dictionary\r\nfrom flair.embeddings import TransformerDocumentEmbeddings\r\nfrom flair.models import TextClassifier\r\n\r\nmodel = TextClassifier(label_type='ner', label_dictionary=Dictionary(),\r\n                       embeddings=TransformerDocumentEmbeddings('distilbert-base-uncased', use_context=True))\r\n\r\nprint(model.embeddings.context_length)\r\n\r\nmodel.save('tmp/single.pt')\r\nloaded_single_task = TextClassifier.load('tmp/single.pt')\r\n\r\nprint(loaded_single_task.embeddings.context_length)\n```\n\n\n### Expected behaivor\n\nIt should twice print 64 as the `context_length`. However, after loading, it prints 0.\n\n### Logs and Stack traces\n\n_No response_\n\n### Screenshots\n\n_No response_\n\n### Additional Context\n\n_No response_\n\n### Environment\n\nRun in current master branch.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/3077/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/3077/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/3072", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/3072/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/3072/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/3072/events", "html_url": "https://github.com/flairNLP/flair/issues/3072", "id": 1559642136, "node_id": "I_kwDOCCkmXM5c9kAY", "number": 3072, "title": "[Bug]: RuntimeError when do onnx export", "user": {"login": "OleksandrKorovii", "id": 107404835, "node_id": "U_kgDOBmbeIw", "avatar_url": "https://avatars.githubusercontent.com/u/107404835?v=4", "gravatar_id": "", "url": "https://api.github.com/users/OleksandrKorovii", "html_url": "https://github.com/OleksandrKorovii", "followers_url": "https://api.github.com/users/OleksandrKorovii/followers", "following_url": "https://api.github.com/users/OleksandrKorovii/following{/other_user}", "gists_url": "https://api.github.com/users/OleksandrKorovii/gists{/gist_id}", "starred_url": "https://api.github.com/users/OleksandrKorovii/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/OleksandrKorovii/subscriptions", "organizations_url": "https://api.github.com/users/OleksandrKorovii/orgs", "repos_url": "https://api.github.com/users/OleksandrKorovii/repos", "events_url": "https://api.github.com/users/OleksandrKorovii/events{/privacy}", "received_events_url": "https://api.github.com/users/OleksandrKorovii/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2023-01-27T12:00:08Z", "updated_at": "2023-02-01T10:55:13Z", "closed_at": "2023-02-01T10:55:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\r\n\r\nI try reproduce Tutorial 13 and get next error RuntimeError\r\n\r\n### To Reproduce\r\n\r\n```python\r\nfrom flair.models import SequenceTagger\r\nfrom flair.embeddings import TransformerWordEmbeddings, TransformerDocumentEmbeddings\r\n\r\nmodel = SequenceTagger.load(\"ner_model.pt\")\r\nassert isinstance(model.embeddings, (TransformerWordEmbeddings, TransformerDocumentEmbeddings))\r\n\r\nfrom flair.datasets import CONLL_03\r\nsentences = list(CONLL_03().test)[:5]\r\n\r\nmodel.embeddings = model.embeddings.export_onnx(\"Ner-Model-Embeddings.onnx\", sentences, providers=[\"CUDAExecutionProvider\", \"CPUExecutionProvider\"])\r\n```\r\n\r\n\r\n### Expected behaivor\r\n\r\nThe embeddings convert into onnx format\r\n\r\n### Logs and Stack traces\r\n\r\n```stacktrace\r\nFile ~/ELL/flair-venv/lib/python3.10/site-packages/flair/embeddings/transformer.py:1279, in TransformerEmbeddings.forward(self, input_ids, sub_token_lengths, token_lengths, attention_mask, overflow_to_sample_mapping, word_ids, langs, bbox, pixel_values)\r\n   1271     all_token_embeddings[:, :, sentence_hidden_states.shape[2] :] = fill_masked_elements(\r\n   1272         all_token_embeddings[:, :, sentence_hidden_states.shape[2] :],\r\n   1273         sentence_hidden_states,\r\n   (...)\r\n   1276         token_lengths,\r\n   1277     )\r\n   1278 elif self.subtoken_pooling == \"mean\":\r\n-> 1279     all_token_embeddings = fill_mean_token_embeddings(\r\n   1280         all_token_embeddings, sentence_hidden_states, word_ids, token_lengths\r\n   1281     )\r\n   1282 else:\r\n   1283     raise ValueError(f\"subtoken pooling method: `{self.subtoken_pooling}` is not implemented\")\r\n\r\nFile ~/ELL/flair-venv/lib/python3.10/site-packages/torch/jit/_trace.py:1139, in _script_if_tracing.<locals>.wrapper(*args, **kwargs)\r\n   1136     return fn(*args, **kwargs)\r\n   1138 compiled_fn = script(wrapper.__original_fn)  # type: ignore[attr-defined]\r\n-> 1139 return compiled_fn(*args, **kwargs)\r\n\r\nRuntimeError: fill_mean_token_embeddings() expected at most 3 argument(s) but received 4 argument(s). Declaration: fill_mean_token_embeddings(Tensor all_token_embeddings, Tensor sentence_hidden_states, Tensor word_ids) -> Tensor\r\n\r\n\u200b\r\n```\r\n\r\n\r\n### Screenshots\r\n\r\n_No response_\r\n\r\n### Additional Context\r\n\r\n_No response_\r\n\r\n### Environment\r\n\r\n#### Versions:\r\n##### Flair\r\n0.11.3 (installed from GitHub)\r\n##### Pytorch\r\n1.13.1+cu117\r\n##### Transformers\r\n4.25.1\r\n#### GPU\r\nTrue", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/3072/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/3072/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/3064", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/3064/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/3064/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/3064/events", "html_url": "https://github.com/flairNLP/flair/issues/3064", "id": 1553248053, "node_id": "I_kwDOCCkmXM5clK81", "number": 3064, "title": "[Bug]: package training are 60 times slower", "user": {"login": "cjing1", "id": 31779053, "node_id": "MDQ6VXNlcjMxNzc5MDUz", "avatar_url": "https://avatars.githubusercontent.com/u/31779053?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cjing1", "html_url": "https://github.com/cjing1", "followers_url": "https://api.github.com/users/cjing1/followers", "following_url": "https://api.github.com/users/cjing1/following{/other_user}", "gists_url": "https://api.github.com/users/cjing1/gists{/gist_id}", "starred_url": "https://api.github.com/users/cjing1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cjing1/subscriptions", "organizations_url": "https://api.github.com/users/cjing1/orgs", "repos_url": "https://api.github.com/users/cjing1/repos", "events_url": "https://api.github.com/users/cjing1/events{/privacy}", "received_events_url": "https://api.github.com/users/cjing1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "lukasgarbas", "id": 33124203, "node_id": "MDQ6VXNlcjMzMTI0MjAz", "avatar_url": "https://avatars.githubusercontent.com/u/33124203?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lukasgarbas", "html_url": "https://github.com/lukasgarbas", "followers_url": "https://api.github.com/users/lukasgarbas/followers", "following_url": "https://api.github.com/users/lukasgarbas/following{/other_user}", "gists_url": "https://api.github.com/users/lukasgarbas/gists{/gist_id}", "starred_url": "https://api.github.com/users/lukasgarbas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lukasgarbas/subscriptions", "organizations_url": "https://api.github.com/users/lukasgarbas/orgs", "repos_url": "https://api.github.com/users/lukasgarbas/repos", "events_url": "https://api.github.com/users/lukasgarbas/events{/privacy}", "received_events_url": "https://api.github.com/users/lukasgarbas/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "lukasgarbas", "id": 33124203, "node_id": "MDQ6VXNlcjMzMTI0MjAz", "avatar_url": "https://avatars.githubusercontent.com/u/33124203?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lukasgarbas", "html_url": "https://github.com/lukasgarbas", "followers_url": "https://api.github.com/users/lukasgarbas/followers", "following_url": "https://api.github.com/users/lukasgarbas/following{/other_user}", "gists_url": "https://api.github.com/users/lukasgarbas/gists{/gist_id}", "starred_url": "https://api.github.com/users/lukasgarbas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lukasgarbas/subscriptions", "organizations_url": "https://api.github.com/users/lukasgarbas/orgs", "repos_url": "https://api.github.com/users/lukasgarbas/repos", "events_url": "https://api.github.com/users/lukasgarbas/events{/privacy}", "received_events_url": "https://api.github.com/users/lukasgarbas/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2023-01-23T15:00:08Z", "updated_at": "2023-01-28T04:42:09Z", "closed_at": "2023-01-28T04:42:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Describe the bug\n\nI have been using the package for text classification a long time, and I noticed that since last Dec, the package is been much (60 times) slower than before. \n\n### To Reproduce\n\n```python\ndocument_embeddings = TransformerDocumentEmbeddings('vinai/bertweet-large', fine_tune=True)\r\n\r\nclf = TextClassifier(document_embeddings, label_dictionary = label_dict_csv, label_type = 'labels')\r\n\r\ntrainer = ModelTrainer(clf,corpus)\r\n\r\n\r\ntrainer.train('data/',learning_rate=5.0e-5,\r\n                 mini_batch_size=4,\r\n                 max_epochs=50)\n```\n\n\n### Expected behaivor\n\nI have been using the package for text classification for a long time, and I noticed that since last Dec, the package had been much (60 times) slower than before. I test the same training dataset and code on different devices. \r\n\r\nI am using version 0.11.3. \r\n\r\nThe following are the logs for the training, one set of iter previous take less than 10 sec now take more than 10 mins. \n\n### Logs and Stack traces\n\n```stacktrace\nBefore: \r\n2022-10-09 21:31:30,315 epoch 49 - iter 290/1459 - loss 0.10741235 - samples/sec: 62.43 - lr: 0.000025\r\n2022-10-09 21:31:39,495 epoch 49 - iter 435/1459 - loss 0.10389860 - samples/sec: 63.60 - lr: 0.000025\r\n\r\nNow: \r\n\r\n2023-01-01 18:04:44,396 epoch 9 - iter 290/1459 - loss 0.13797347 - samples/sec: 0.86 - lr: 0.000050\r\n2023-01-01 18:15:55,733 epoch 9 - iter 435/1459 - loss 0.13327860 - samples/sec: 0.86 - lr: 0.000050\n```\n\n\n### Screenshots\n\n_No response_\n\n### Additional Context\n\nThank you so much for your help. \n\n### Environment\n\n#### Versions:\r\n##### Flair\r\n0.11.3\r\n##### Pytorch\r\n1.13.1+cpu\r\n##### Transformers\r\n4.25.1\r\n#### GPU\r\nFalse", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/3064/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/3064/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/3061", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/3061/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/3061/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/3061/events", "html_url": "https://github.com/flairNLP/flair/issues/3061", "id": 1551103196, "node_id": "I_kwDOCCkmXM5cc_Tc", "number": 3061, "title": "[Bug]: train() fails if corpus without dev split, even with train_with_dev=False", "user": {"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2023-01-20T16:04:40Z", "updated_at": "2023-02-21T04:30:11Z", "closed_at": "2023-02-21T04:30:11Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "### Describe the bug\n\nLine 717 in trainer.py: I do not want anneal against some dev loss since i do not have a dev split\n\n### To Reproduce\n\n```python\nfrom flair.datasets import ColumnCorpus\r\n\r\nmain():\r\nsupport_set = ColumnCorpus(data_folder=\"data/fewshot/conll03/\", train_file=f\"{split}.txt\", sample_missing_splits=False, column_format={0: \"text\", 1: \"ner\"})\r\n\r\n...\r\n\r\ntrainer.fine_tune(train_with_dev=False)\r\n\r\n\r\nif __name__ == \"__main__\":\r\nmain()\n```\n\n\n### Expected behaivor\n\ntraining should run through and ignore dev split / score\n\n### Logs and Stack traces\n\n```stacktrace\nTraceback (most recent call last):\r\n  File \"/vol/fob-vol7/mi18/goldejon/flair/flair/trainers/trainer.py\", line 717, in train\r\n    if dev_score > best_validation_score:\r\nUnboundLocalError: local variable 'dev_score' referenced before assignment\n```\n\n\n### Screenshots\n\n_No response_\n\n### Additional Context\n\n_No response_\n\n### Environment\n\n#### Versions:\r\n##### Flair\r\n0.11.3\r\n##### Pytorch\r\n1.12.1\r\n##### Transformers\r\n4.23.1\r\n#### GPU\r\nTrue\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/3061/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/3061/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/3050", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/3050/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/3050/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/3050/events", "html_url": "https://github.com/flairNLP/flair/issues/3050", "id": 1530707702, "node_id": "I_kwDOCCkmXM5bPL72", "number": 3050, "title": "Loading gpt2 in TransformerWordEmbeddings causes a error: \"Using pad_token, but it is not set yet.\"", "user": {"login": "iliaNecrov", "id": 96539972, "node_id": "U_kgDOBcEVRA", "avatar_url": "https://avatars.githubusercontent.com/u/96539972?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iliaNecrov", "html_url": "https://github.com/iliaNecrov", "followers_url": "https://api.github.com/users/iliaNecrov/followers", "following_url": "https://api.github.com/users/iliaNecrov/following{/other_user}", "gists_url": "https://api.github.com/users/iliaNecrov/gists{/gist_id}", "starred_url": "https://api.github.com/users/iliaNecrov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iliaNecrov/subscriptions", "organizations_url": "https://api.github.com/users/iliaNecrov/orgs", "repos_url": "https://api.github.com/users/iliaNecrov/repos", "events_url": "https://api.github.com/users/iliaNecrov/events{/privacy}", "received_events_url": "https://api.github.com/users/iliaNecrov/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2023-01-12T13:23:31Z", "updated_at": "2023-01-17T21:31:27Z", "closed_at": "2023-01-17T21:31:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello, flair team. Recently wanted to try using `gpt` models for ner fine-tuning task. I looked through issues and have seen some examples, which allowed to load `gpt2` from Hugging Face and decided to try it by myself.\r\n\r\nStarted with loading libraries\r\n```\r\nfrom flair.embeddings import TransformerWordEmbeddings\r\nfrom flair.data import Sentence\r\n```\r\n\r\nInitialized `TransformerWordEmbeddings` with `gpt2` model\r\n`embeddings = TransformerWordEmbeddings('gpt2')`\r\nwhich had this output\r\n`2023-01-12 18:16:59,252 Could not determine the begin offset of the tokenizer for transformer model transformer-gpt2, assuming 0`\r\n\r\nAfter tried to embed each word in sentence:\r\n```\r\ns = Sentence('Hello, my name is Mark')\r\nembeddings.embed(s)\r\n```\r\nAnd after that I got **this**:\r\n```\r\nUsing pad_token, but it is not set yet.\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-17-f7c3f4e5508d> in <module>\r\n      1 s = Sentence('Hello, my name is Mark')\r\n----> 2 embeddings.embed(s)\r\n\r\n~\\Anaconda3\\lib\\site-packages\\flair\\embeddings\\base.py in embed(self, data_points)\r\n     60 \r\n     61         if not self._everything_embedded(data_points) or not self.static_embeddings:\r\n---> 62             self._add_embeddings_internal(data_points)\r\n     63 \r\n     64         return data_points\r\n\r\n~\\Anaconda3\\lib\\site-packages\\flair\\embeddings\\base.py in _add_embeddings_internal(self, sentences)\r\n    764             expanded_sentences.extend(sentences)\r\n    765 \r\n--> 766         self._add_embeddings_to_sentences(expanded_sentences)\r\n    767 \r\n    768         # move embeddings from context back to original sentence (if using context)\r\n\r\n~\\Anaconda3\\lib\\site-packages\\flair\\embeddings\\base.py in _add_embeddings_to_sentences(self, sentences)\r\n    676 \r\n    677         # encode inputs\r\n--> 678         batch_encoding = self.tokenizer(\r\n    679             tokenized_sentences,\r\n    680             stride=self.stride,\r\n\r\n~\\Anaconda3\\lib\\site-packages\\transformers\\tokenization_utils_base.py in __call__(self, text, text_pair, text_target, text_pair_target, add_special_tokens, padding, truncation, max_length, stride, is_split_into_words, pad_to_multiple_of, return_tensors, return_token_type_ids, return_attention_mask, return_overflowing_tokens, return_special_tokens_mask, return_offsets_mapping, return_length, verbose, **kwargs)\r\n   2518             if not self._in_target_context_manager:\r\n   2519                 self._switch_to_input_mode()\r\n-> 2520             encodings = self._call_one(text=text, text_pair=text_pair, **all_kwargs)\r\n   2521         if text_target is not None:\r\n   2522             self._switch_to_target_mode()\r\n\r\n~\\Anaconda3\\lib\\site-packages\\transformers\\tokenization_utils_base.py in _call_one(self, text, text_pair, add_special_tokens, padding, truncation, max_length, stride, is_split_into_words, pad_to_multiple_of, return_tensors, return_token_type_ids, return_attention_mask, return_overflowing_tokens, return_special_tokens_mask, return_offsets_mapping, return_length, verbose, **kwargs)\r\n   2604                 )\r\n   2605             batch_text_or_text_pairs = list(zip(text, text_pair)) if text_pair is not None else text\r\n-> 2606             return self.batch_encode_plus(\r\n   2607                 batch_text_or_text_pairs=batch_text_or_text_pairs,\r\n   2608                 add_special_tokens=add_special_tokens,\r\n\r\n~\\Anaconda3\\lib\\site-packages\\transformers\\tokenization_utils_base.py in batch_encode_plus(self, batch_text_or_text_pairs, add_special_tokens, padding, truncation, max_length, stride, is_split_into_words, pad_to_multiple_of, return_tensors, return_token_type_ids, return_attention_mask, return_overflowing_tokens, return_special_tokens_mask, return_offsets_mapping, return_length, verbose, **kwargs)\r\n   2786 \r\n   2787         # Backward compatibility for 'truncation_strategy', 'pad_to_max_length'\r\n-> 2788         padding_strategy, truncation_strategy, max_length, kwargs = self._get_padding_truncation_strategies(\r\n   2789             padding=padding,\r\n   2790             truncation=truncation,\r\n\r\n~\\Anaconda3\\lib\\site-packages\\transformers\\tokenization_utils_base.py in _get_padding_truncation_strategies(self, padding, truncation, max_length, pad_to_multiple_of, verbose, **kwargs)\r\n   2423         # Test if we have a padding token\r\n   2424         if padding_strategy != PaddingStrategy.DO_NOT_PAD and (not self.pad_token or self.pad_token_id < 0):\r\n-> 2425             raise ValueError(\r\n   2426                 \"Asking to pad but the tokenizer does not have a padding token. \"\r\n   2427                 \"Please select a token to use as `pad_token` `(tokenizer.pad_token = tokenizer.eos_token e.g.)` \"\r\n\r\nValueError: Asking to pad but the tokenizer does not have a padding token. Please select a token to use as `pad_token` `(tokenizer.pad_token = tokenizer.eos_token e.g.)` or add a new pad token via `tokenizer.add_special_tokens({'pad_token': '[PAD]'})`.\r\n```\r\n\r\nCould you please explain what I did wrong?", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/3050/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/3050/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/3045", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/3045/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/3045/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/3045/events", "html_url": "https://github.com/flairNLP/flair/issues/3045", "id": 1520191451, "node_id": "I_kwDOCCkmXM5anEfb", "number": 3045, "title": "SequenceTagger.load error -> 'embeddings.model.embeddings.position_ids'", "user": {"login": "shahafp", "id": 42303078, "node_id": "MDQ6VXNlcjQyMzAzMDc4", "avatar_url": "https://avatars.githubusercontent.com/u/42303078?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shahafp", "html_url": "https://github.com/shahafp", "followers_url": "https://api.github.com/users/shahafp/followers", "following_url": "https://api.github.com/users/shahafp/following{/other_user}", "gists_url": "https://api.github.com/users/shahafp/gists{/gist_id}", "starred_url": "https://api.github.com/users/shahafp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shahafp/subscriptions", "organizations_url": "https://api.github.com/users/shahafp/orgs", "repos_url": "https://api.github.com/users/shahafp/repos", "events_url": "https://api.github.com/users/shahafp/events{/privacy}", "received_events_url": "https://api.github.com/users/shahafp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2023-01-05T06:52:58Z", "updated_at": "2023-01-11T06:57:45Z", "closed_at": "2023-01-11T06:57:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nI have trained the NER model using SequenceTagger with longformer as an embedding 'allenai/longformer-base-4096'\r\nThe train was finished successfully on sageMaker (amazon Linux 2)\r\n\r\nWhen I'm trying to load the model on a different machine I get the missing keys error 'embeddings.model.embeddings.position_ids'\r\n\r\nWould you happen to know how I can prevent this?\r\n\r\nThis is the training script\r\n`\r\n\r\n    embeddings = TransformerWordEmbeddings(model='allenai/longformer-base-4096',\r\n                                           layers=\"-1\",\r\n                                           subtoken_pooling=\"first\",\r\n                                           fine_tune=True,\r\n                                           use_context=True,\r\n                                           )\r\n    \r\n    # 5. initialize bare-bones sequence tagger (no CRF, no RNN, no projection)\r\n    tagger = SequenceTagger(hidden_size=256,\r\n                            embeddings=embeddings,\r\n                            tag_dictionary=label_dict,\r\n                            tag_type='ner',\r\n                            use_crf=False,\r\n                            use_rnn=False,\r\n                            reproject_embeddings=False,\r\n                            )\r\n\r\n    torch.cuda.empty_cache()\r\n\r\n    # 6. initialize trainer\r\n    trainer = ModelTrainer(tagger, corpus)\r\n    model_path = f'round_{round_num}_full_address'\r\n    # 7. run fine-tuning\r\n    trainer.fine_tune(model_path,\r\n                      learning_rate=learning_rate,\r\n                      mini_batch_size=batch_size,\r\n                      mini_batch_chunk_size=1,  # remove this parameter to speed up computation if you have a big GPU\r\n                      embeddings_storage_mode='gpu',\r\n                      )\r\n`\r\n\r\nThank you", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/3045/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/3045/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/3035", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/3035/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/3035/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/3035/events", "html_url": "https://github.com/flairNLP/flair/issues/3035", "id": 1503061365, "node_id": "I_kwDOCCkmXM5ZluV1", "number": 3035, "title": "Cannot export Onnx-Embeddings", "user": {"login": "helpmefindaname", "id": 26192135, "node_id": "MDQ6VXNlcjI2MTkyMTM1", "avatar_url": "https://avatars.githubusercontent.com/u/26192135?v=4", "gravatar_id": "", "url": "https://api.github.com/users/helpmefindaname", "html_url": "https://github.com/helpmefindaname", "followers_url": "https://api.github.com/users/helpmefindaname/followers", "following_url": "https://api.github.com/users/helpmefindaname/following{/other_user}", "gists_url": "https://api.github.com/users/helpmefindaname/gists{/gist_id}", "starred_url": "https://api.github.com/users/helpmefindaname/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/helpmefindaname/subscriptions", "organizations_url": "https://api.github.com/users/helpmefindaname/orgs", "repos_url": "https://api.github.com/users/helpmefindaname/repos", "events_url": "https://api.github.com/users/helpmefindaname/events{/privacy}", "received_events_url": "https://api.github.com/users/helpmefindaname/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "helpmefindaname", "id": 26192135, "node_id": "MDQ6VXNlcjI2MTkyMTM1", "avatar_url": "https://avatars.githubusercontent.com/u/26192135?v=4", "gravatar_id": "", "url": "https://api.github.com/users/helpmefindaname", "html_url": "https://github.com/helpmefindaname", "followers_url": "https://api.github.com/users/helpmefindaname/followers", "following_url": "https://api.github.com/users/helpmefindaname/following{/other_user}", "gists_url": "https://api.github.com/users/helpmefindaname/gists{/gist_id}", "starred_url": "https://api.github.com/users/helpmefindaname/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/helpmefindaname/subscriptions", "organizations_url": "https://api.github.com/users/helpmefindaname/orgs", "repos_url": "https://api.github.com/users/helpmefindaname/repos", "events_url": "https://api.github.com/users/helpmefindaname/events{/privacy}", "received_events_url": "https://api.github.com/users/helpmefindaname/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "helpmefindaname", "id": 26192135, "node_id": "MDQ6VXNlcjI2MTkyMTM1", "avatar_url": "https://avatars.githubusercontent.com/u/26192135?v=4", "gravatar_id": "", "url": "https://api.github.com/users/helpmefindaname", "html_url": "https://github.com/helpmefindaname", "followers_url": "https://api.github.com/users/helpmefindaname/followers", "following_url": "https://api.github.com/users/helpmefindaname/following{/other_user}", "gists_url": "https://api.github.com/users/helpmefindaname/gists{/gist_id}", "starred_url": "https://api.github.com/users/helpmefindaname/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/helpmefindaname/subscriptions", "organizations_url": "https://api.github.com/users/helpmefindaname/orgs", "repos_url": "https://api.github.com/users/helpmefindaname/repos", "events_url": "https://api.github.com/users/helpmefindaname/events{/privacy}", "received_events_url": "https://api.github.com/users/helpmefindaname/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-12-19T14:32:03Z", "updated_at": "2023-01-16T15:04:39Z", "closed_at": "2023-01-16T15:04:39Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nAt first, there is an issue with the parameters not being correct, this can easily solved by converting the list to a tuple at https://github.com/flairNLP/flair/blob/master/flair/embeddings/transformer.py#L780 : `embedding, (example_tensors,), ...`\r\nHowever then I get an exception\r\n```\r\nRuntimeError: r INTERNAL ASSERT FAILED at \"C:\\\\actions-runner\\\\_work\\\\pytorch\\\\pytorch\\\\builder\\\\windows\\\\pytorch\\\\aten\\\\src\\\\ATen/core/jit_type_base.h\":545, please report a bug to PyTorch\r\n```\r\nThat error is created at line `input.type().scalarType() is not None` where `input.type()` is of type `List[Tensor]`.\r\nI suppose that this is due to an invalid variable that is currently not supported and requires some serve debugging.\r\n\r\n**To Reproduce**\r\nFollow [the onnx tutorial](https://github.com/flairNLP/flair/blob/master/resources/docs/TUTORIAL_13_TRANSFORMERS_PRODUCTION.md) on https://github.com/flairNLP/flair/commit/117e14e5d821a1a4a655ccbbe495fc380ecebb7a (current master)\r\n\r\n**Expected behavior**\r\nOnnx export works as expected and won't throw any exception.\r\n\r\n**Environment (please complete the following information):**\r\nOS: Windows\r\nflair on https://github.com/flairNLP/flair/commit/117e14e5d821a1a4a655ccbbe495fc380ecebb7a\r\ntransformers on 4.20.1\r\ntorch on 1.12.0+cu116\r\nonnxruntime on 1.11.1\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/3035/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/3035/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/3034", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/3034/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/3034/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/3034/events", "html_url": "https://github.com/flairNLP/flair/issues/3034", "id": 1502487174, "node_id": "I_kwDOCCkmXM5ZjiKG", "number": 3034, "title": "Corpus incorrectly aligning spans from Flair 0.11", "user": {"login": "Guust-Franssens", "id": 89594420, "node_id": "MDQ6VXNlcjg5NTk0NDIw", "avatar_url": "https://avatars.githubusercontent.com/u/89594420?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Guust-Franssens", "html_url": "https://github.com/Guust-Franssens", "followers_url": "https://api.github.com/users/Guust-Franssens/followers", "following_url": "https://api.github.com/users/Guust-Franssens/following{/other_user}", "gists_url": "https://api.github.com/users/Guust-Franssens/gists{/gist_id}", "starred_url": "https://api.github.com/users/Guust-Franssens/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Guust-Franssens/subscriptions", "organizations_url": "https://api.github.com/users/Guust-Franssens/orgs", "repos_url": "https://api.github.com/users/Guust-Franssens/repos", "events_url": "https://api.github.com/users/Guust-Franssens/events{/privacy}", "received_events_url": "https://api.github.com/users/Guust-Franssens/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-12-19T08:06:44Z", "updated_at": "2023-01-16T20:06:27Z", "closed_at": "2023-01-16T20:06:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\n\r\nFirst of all, thanks for making this library publicly available!\r\n\r\n**Description of the bug**\r\nWhen using Flair 0.11 and higher, I noticed that in some documents my spans were not aligned as to how they are represented in the data. Downgrading to Flair 0.10 or lower seemed to fixed that issue.\r\n\r\n**How to Reproduce**\r\nI created an example txt where the issue is prevalent. Using the following example and code snippet should allow you to reproduce the issue.\r\n\r\nCreate some fake ner data:\r\n```python\r\nexample_txt = \"George B-NAME\\n\"\r\nexample_txt += \"Washington I-NAME\\n\"\r\nexample_txt += \"went O\\n\"\r\nexample_txt += \"\\t O\\n\"\r\nexample_txt += \"Washington B-CITY\\n\"\r\nexample_txt += \"and O\\n\"\r\nexample_txt += \"enjoyed O\\n\"\r\nexample_txt += \"some O\\n\"\r\nexample_txt += \"coffee B-BEVERAGE\\n\"\r\nwith open(\"notebooks/example.txt\", \"w\", encoding=\"utf-8\") as file_out:\r\n    file_out.write(example_txt)\r\n```\r\nThis creates the following file:\r\n![image](https://user-images.githubusercontent.com/89594420/208373001-4c287ed8-acf9-4bf0-a876-4e43862b2eab.png)\r\n\r\nLoad in the generated data.\r\n```python\r\nfrom flair.data import Corpus, Sentence\r\nfrom flair.datasets import ColumnCorpus\r\ncolumns: dict = {0: \"text\", 1: \"ner\"}\r\ncorpus: Corpus = ColumnCorpus(data_folder=\"data\", column_format=columns, train_file=\"example.txt\")\r\n\r\nsentence: Sentence = corpus.train[0]\r\nfor span in sentence.get_spans(\"ner\"):\r\n    print(span)\r\n\r\n>>>Span[0:2]: \"George Washington\" \u2192 NAME (1.0)\r\n>>>Span[5:6]: \"and\" \u2192 CITY (1.0)\r\n```\r\n\"And\" incorrectly received the CITY span, coffee is not listed as an entity.\r\nI assume this is due to the \\t being matched as a column seperator.\r\n\r\n**Expected behavior**\r\nUsing the exact same code snippet in Flair 0.10 or lower I get the following (which is also what I expect to have).\r\n\r\n```python\r\nfor span in sentence.get_spans(\"ner\"):\r\n    print(span)\r\n\r\n>>>[<NAME-span (1,2): \"George Washington\">,\r\n>>> <CITY-span (5): \"Washington\">,\r\n>>> <BEVERAGE-span (9): \"Coffee\">]\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - Flair >= 0.11:\r\n\r\n**How I managed to load in my data correctly**\r\nThis issue is fixable by specifying the column delimiter.\r\n```python\r\nfrom flair.data import Corpus, Sentence\r\nfrom flair.datasets import ColumnCorpus\r\ncolumns: dict = {0: \"text\", 1: \"ner\"}\r\ncorpus: Corpus = ColumnCorpus(data_folder=\"data\", column_format=columns, train_file=\"example.txt\", column_delimiter = \" \")\r\n\r\nsentence: Sentence = corpus.train[0]\r\nfor span in sentence.get_spans(\"ner\"):\r\n    print(span)\r\n\r\n>>>Span[0:2]: \"George Washington\" \u2192 NAME (1.0)\r\n>>>Span[4:5]: \"Washington\" \u2192 CITY (1.0)\r\n>>>Span[8:9]: \"coffee\" \u2192 BEVERAGE (1.0)\r\n```\r\n\r\n**Why am I listing it as a bug if it's fixable?**\r\nI spent over a week debugging this issue. The code runs, the model \"seems\" to learn, loss decreases but F1 stays 0, the data seems correct. It's very difficult to spot this almost \"invisible\" issue that I believe others will overlook as well. Moreover, Flair <= 0.10 gracefully resolves this issue (I assume there is a failsafe check somewhere). \r\n\r\nIf you have any questions, please shoot and I will get back to you quickly.\r\n\r\nKind regards,\r\nGuust", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/3034/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/3034/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/3018", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/3018/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/3018/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/3018/events", "html_url": "https://github.com/flairNLP/flair/issues/3018", "id": 1489958179, "node_id": "I_kwDOCCkmXM5YzvUj", "number": 3018, "title": "ValueError When Loading TACRED", "user": {"login": "dobbersc", "id": 29147025, "node_id": "MDQ6VXNlcjI5MTQ3MDI1", "avatar_url": "https://avatars.githubusercontent.com/u/29147025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dobbersc", "html_url": "https://github.com/dobbersc", "followers_url": "https://api.github.com/users/dobbersc/followers", "following_url": "https://api.github.com/users/dobbersc/following{/other_user}", "gists_url": "https://api.github.com/users/dobbersc/gists{/gist_id}", "starred_url": "https://api.github.com/users/dobbersc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dobbersc/subscriptions", "organizations_url": "https://api.github.com/users/dobbersc/orgs", "repos_url": "https://api.github.com/users/dobbersc/repos", "events_url": "https://api.github.com/users/dobbersc/events{/privacy}", "received_events_url": "https://api.github.com/users/dobbersc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-12-11T13:04:09Z", "updated_at": "2023-02-20T22:55:54Z", "closed_at": "2023-02-20T22:55:54Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhen loading TACRED the following ValueError will be thrown:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/glusterfs/dfs-gfs-dist/dobbersc/.local/bin/miniconda3/envs/flair/lib/python3.9/code.py\", line 90, in runcode\r\n    exec(code, self.locals)\r\n  File \"<input>\", line 1, in <module>\r\n  File \"/glusterfs/dfs-gfs-dist/dobbersc/PyCharmProjects/flair/flair/datasets/relation_extraction.py\", line 260, in __init__\r\n    super(RE_ENGLISH_TACRED, self).__init__(\r\n  File \"/glusterfs/dfs-gfs-dist/dobbersc/PyCharmProjects/flair/flair/datasets/sequence_labeling.py\", line 403, in __init__\r\n    super(ColumnCorpus, self).__init__(\r\n  File \"/glusterfs/dfs-gfs-dist/dobbersc/PyCharmProjects/flair/flair/datasets/sequence_labeling.py\", line 296, in __init__\r\n    [\r\n  File \"/glusterfs/dfs-gfs-dist/dobbersc/PyCharmProjects/flair/flair/datasets/sequence_labeling.py\", line 297, in <listcomp>\r\n    ColumnDataset(\r\n  File \"/glusterfs/dfs-gfs-dist/dobbersc/PyCharmProjects/flair/flair/datasets/sequence_labeling.py\", line 501, in __init__\r\n    sentence = self._convert_lines_to_sentence(\r\n  File \"/glusterfs/dfs-gfs-dist/dobbersc/PyCharmProjects/flair/flair/datasets/sequence_labeling.py\", line 696, in _convert_lines_to_sentence\r\n    key, value = comment_row.split(\"=\", 2)\r\nValueError: too many values to unpack (expected 2)\r\n```\r\n\r\n**To Reproduce**\r\n\r\n```python\r\nfrom flair.datasets import RE_ENGLISH_TACRED\r\nRE_ENGLISH_TACRED()\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS: openSUSE Leap 15.3\r\n - Version: flair on master\r\n\r\n**Additional context**\r\nThe cause of this error is from the changes in #3006 on how comments are handled in the `ColumnDataset`.\r\nhttps://github.com/flairNLP/flair/blob/5a13598ef5c20fdb79e441720b82250c0881094e/flair/datasets/sequence_labeling.py#L694\r\n\r\nThe generated `.conllu` files from the original TACRED corpus contain comments not supported by the currently implemented comment parser. Example (since TACRED is a private dataset):\r\n\r\n```\r\n# text = `` Market conditions became more challenging through November and December , '' said Sir Stuart Rose , the company 's chief executive .\r\n# sentence_id = e7798fb926d91a16cd93\r\n# relations = 15;16;22;22;per:title\r\n1       ``      O\r\n2       Market  O\r\n3       conditions      O\r\n4       became  O\r\n5       more    O\r\n6       challenging     O\r\n7       through O\r\n8       November        B-DATE\r\n9       and     O\r\n10      December        B-DATE\r\n11      ,       O\r\n12      ''      O\r\n13      said    O\r\n14      Sir     O\r\n15      Stuart  B-PERSON\r\n16      Rose    I-PERSON\r\n17      ,       O\r\n18      the     O\r\n19      company O\r\n20      's      O\r\n21      chief   O\r\n22      executive       B-TITLE\r\n23      .       O\r\n```\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/3018/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/3018/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/3008", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/3008/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/3008/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/3008/events", "html_url": "https://github.com/flairNLP/flair/issues/3008", "id": 1476162463, "node_id": "I_kwDOCCkmXM5X_HOf", "number": 3008, "title": "Problem loading fasttext with ngram features", "user": {"login": "DanrunFR", "id": 108009695, "node_id": "U_kgDOBnAY3w", "avatar_url": "https://avatars.githubusercontent.com/u/108009695?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DanrunFR", "html_url": "https://github.com/DanrunFR", "followers_url": "https://api.github.com/users/DanrunFR/followers", "following_url": "https://api.github.com/users/DanrunFR/following{/other_user}", "gists_url": "https://api.github.com/users/DanrunFR/gists{/gist_id}", "starred_url": "https://api.github.com/users/DanrunFR/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DanrunFR/subscriptions", "organizations_url": "https://api.github.com/users/DanrunFR/orgs", "repos_url": "https://api.github.com/users/DanrunFR/repos", "events_url": "https://api.github.com/users/DanrunFR/events{/privacy}", "received_events_url": "https://api.github.com/users/DanrunFR/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-12-05T09:57:57Z", "updated_at": "2022-12-06T09:10:14Z", "closed_at": "2022-12-06T09:10:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello, \r\n\r\nI trained a fasttext model on a custom corpus with ngram features, but I can't seem to load it with flair whereas the same .bin file works with gensim. \r\n\r\nMore precisely, I do this on gensim and I can get a vector out of a total random word.\r\n```\r\nfrom gensim.models.fasttext import FastText\r\nmodel = FastText.load('embeddings/fasttext_fr_wac/ft_frwac.300.bin')\r\nmodel.wv['qqqqqfds']\r\n# some vector\r\n```\r\nThen I try to load the same file with FastTextEmbeddings:\r\n```\r\nfrom flair.embeddings import FastTextEmbeddings\r\nembeddings = FastTextEmbeddings('embeddings/fasttext_fr_wac/ft_frwac.300.bin')\r\n```\r\n\r\nAnd there would be a NotImplementedError message:\r\n```\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/share/home/cao/.conda/envs/bilstm_crf_Study/lib/python3.8/site-packages/flair/embeddings/token.py\", line 945, in __init__\r\n    self.precomputed_word_embeddings: gensim.models.FastText = gensim.models.FastText.load_fasttext_format(\r\n  File \"/share/home/cao/.conda/envs/bilstm_crf_Study/lib/python3.8/site-packages/gensim/utils.py\", line 1522, in new_func1\r\n    return func(*args, **kwargs)\r\n  File \"/share/home/cao/.conda/envs/bilstm_crf_Study/lib/python3.8/site-packages/gensim/models/fasttext.py\", line 580, in load_fasttext_format\r\n    return load_facebook_model(model_file, encoding=encoding)\r\n  File \"/share/home/cao/.conda/envs/bilstm_crf_Study/lib/python3.8/site-packages/gensim/models/fasttext.py\", line 728, in load_facebook_model\r\n    return _load_fasttext_format(path, encoding=encoding, full_model=True)\r\n  File \"/share/home/cao/.conda/envs/bilstm_crf_Study/lib/python3.8/site-packages/gensim/models/fasttext.py\", line 808, in _load_fasttext_format\r\n    m = gensim.models._fasttext_bin.load(fin, encoding=encoding, full_model=full_model)\r\n  File \"/share/home/cao/.conda/envs/bilstm_crf_Study/lib/python3.8/site-packages/gensim/models/_fasttext_bin.py\", line 345, in load\r\n    raw_vocab, vocab_size, nwords, ntokens = _load_vocab(fin, new_format, encoding=encoding)\r\n  File \"/share/home/cao/.conda/envs/bilstm_crf_Study/lib/python3.8/site-packages/gensim/models/_fasttext_bin.py\", line 198, in _load_vocab\r\n    raise NotImplementedError(\"Supervised fastText models are not supported\")\r\nNotImplementedError: Supervised fastText models are not supported\r\n```\r\nI also tried with WordEmbeddings just in case, and it didn't work, as expected:\r\n```\r\nembeddings = WordEmbeddings('embeddings/fasttext_fr_wac/ft_frwac.300.bin')\r\n\r\n# output\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/share/home/cao/.conda/envs/bilstm_crf_Study/lib/python3.8/site-packages/flair/embeddings/token.py\", line 213, in __init__\r\n    precomputed_word_embeddings = gensim.models.KeyedVectors.load_word2vec_format(\r\n  File \"/share/home/cao/.conda/envs/bilstm_crf_Study/lib/python3.8/site-packages/gensim/models/keyedvectors.py\", line 1723, in load_word2vec_format\r\n    return _load_word2vec_format(\r\n  File \"/share/home/cao/.conda/envs/bilstm_crf_Study/lib/python3.8/site-packages/gensim/models/keyedvectors.py\", line 2062, in _load_word2vec_format\r\n    header = utils.to_unicode(fin.readline(), encoding=encoding)\r\n  File \"/share/home/cao/.conda/envs/bilstm_crf_Study/lib/python3.8/site-packages/gensim/utils.py\", line 365, in any2unicode\r\n    return str(text, encoding, errors=errors)\r\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Linux Debian 5.10.149-2\r\n - Version [e.g. flair-0.3.2]: flair 0.11.3, gensim 4.2.0\r\n\r\nBoth libraries are in the same virtual environment so there shouldn't be conflicts. Is there something I'm doing wrong ? Maybe I missed a parameter or something ?\r\n\r\nThank you in advance for your help.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/3008/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/3008/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2988", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2988/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2988/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2988/events", "html_url": "https://github.com/flairNLP/flair/issues/2988", "id": 1442439496, "node_id": "I_kwDOCCkmXM5V-eFI", "number": 2988, "title": "Error When Loading in Fine-Tuned Tars Model", "user": {"login": "ajaklevs", "id": 10690432, "node_id": "MDQ6VXNlcjEwNjkwNDMy", "avatar_url": "https://avatars.githubusercontent.com/u/10690432?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ajaklevs", "html_url": "https://github.com/ajaklevs", "followers_url": "https://api.github.com/users/ajaklevs/followers", "following_url": "https://api.github.com/users/ajaklevs/following{/other_user}", "gists_url": "https://api.github.com/users/ajaklevs/gists{/gist_id}", "starred_url": "https://api.github.com/users/ajaklevs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ajaklevs/subscriptions", "organizations_url": "https://api.github.com/users/ajaklevs/orgs", "repos_url": "https://api.github.com/users/ajaklevs/repos", "events_url": "https://api.github.com/users/ajaklevs/events{/privacy}", "received_events_url": "https://api.github.com/users/ajaklevs/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-11-09T17:00:29Z", "updated_at": "2023-04-02T16:54:15Z", "closed_at": "2023-04-02T16:54:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "Starting with the Tars classifier base, I fine tuned the tars model on my own dataset. At first the training loop was running smoothly, and a best-model.pt and final-model.pt were saved. However in the training loop, while calculating the final metrics, the line self.model.load_state_dict(self.model.load(base_path / \"best-model.pt\").state_dict()) errored. I had the same error occur when I tried to load in best-model.pt in a separate cell with the code model = TARSClassifier.load(\"output/tars/best-model.pt\"). I am running locally through a Jupyter Notebook on a mac book pro, using Flair version 0.11.3.\r\n\r\nThe error message was as follows:\r\n\r\nOSError: Can't load config for '/var/folders/20/4p5k_m8d5kn_wp1xx1fy39rc80krp9/T/tmpprvqafzm'. Make sure that:\r\n\r\n- '/var/folders/20/4p5k_m8d5kn_wp1xx1fy39rc80krp9/T/tmpprvqafzm' is a correct model identifier listed on 'https://huggingface.co/models'\r\n\r\n- or '/var/folders/20/4p5k_m8d5kn_wp1xx1fy39rc80krp9/T/tmpprvqafzm' is the correct path to a directory containing a config.json file\r\n\r\nThe complete error message (the error message during the training loop) is copy and pasted below: \r\n\r\nOSError                                   Traceback (most recent call last)\r\n/opt/anaconda3/lib/python3.8/site-packages/transformers/configuration_utils.py in get_config_dict(cls, pretrained_model_name_or_path, **kwargs)\r\n    379             # Load from URL or cache if already cached\r\n--> 380             resolved_config_file = cached_path(\r\n    381                 config_file,\r\n\r\n/opt/anaconda3/lib/python3.8/site-packages/transformers/file_utils.py in cached_path(url_or_filename, cache_dir, force_download, proxies, resume_download, user_agent, extract_compressed_file, force_extract, local_files_only)\r\n   1013         # File, but it doesn't exist.\r\n-> 1014         raise EnvironmentError(\"file {} not found\".format(url_or_filename))\r\n   1015     else:\r\n\r\nOSError: file /var/folders/20/4p5k_m8d5kn_wp1xx1fy39rc80krp9/T/tmpul4gwhkc/config.json not found\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nOSError                                   Traceback (most recent call last)\r\n<ipython-input-12-48f70865afeb> in <module>\r\n----> 1 trainer.train(base_path='./output/' + 'tars' ,  # path to store the model artifacts\r\n      2                 learning_rate=0.02,  # use very small learning rate\r\n      3                 mini_batch_size = 16,\r\n      4                 mini_batch_chunk_size=1,  # optionally set this if transformer is too much for your machine\r\n      5                 max_epochs= 1,  # terminate after 1 epoch\r\n\r\n/opt/anaconda3/lib/python3.8/site-packages/flair/trainers/trainer.py in train(self, base_path, learning_rate, mini_batch_size, eval_batch_size, mini_batch_chunk_size, max_epochs, train_with_dev, train_with_test, monitor_train, monitor_test, main_evaluation_metric, scheduler, anneal_factor, patience, min_learning_rate, initial_extra_patience, optimizer, cycle_momentum, warmup_fraction, embeddings_storage_mode, checkpoint, save_final_model, anneal_with_restarts, anneal_with_prestarts, anneal_against_dev_loss, batch_growth_annealing, shuffle, param_selection_mode, write_weights, num_workers, sampler, use_amp, amp_opt_level, eval_on_train_fraction, eval_on_train_shuffle, save_model_each_k_epochs, tensorboard_comment, use_swa, use_final_model_for_eval, gold_label_dictionary_for_eval, create_file_logs, create_loss_file, epoch, use_tensorboard, tensorboard_log_dir, metrics_for_tensorboard, optimizer_state_dict, scheduler_state_dict, save_optimizer_state, **kwargs)\r\n    829         # test best model if test data is present\r\n    830         if self.corpus.test and not train_with_test:\r\n--> 831             final_score = self.final_test(\r\n    832                 base_path=base_path,\r\n    833                 eval_mini_batch_size=eval_batch_size,\r\n\r\n/opt/anaconda3/lib/python3.8/site-packages/flair/trainers/trainer.py in final_test(self, base_path, eval_mini_batch_size, main_evaluation_metric, num_workers, gold_label_dictionary_for_eval)\r\n    920 \r\n    921         if (base_path / \"best-model.pt\").exists():\r\n--> 922             self.model.load_state_dict(self.model.load(base_path / \"best-model.pt\").state_dict())\r\n    923         else:\r\n    924             log.info(\"Testing using last state of model ...\")\r\n\r\n/opt/anaconda3/lib/python3.8/site-packages/flair/nn/model.py in load(cls, model_path)\r\n    140             # see https://github.com/zalandoresearch/flair/issues/351\r\n    141             f = file_utils.load_big_file(str(model_file))\r\n--> 142             state = torch.load(f, map_location=\"cpu\")\r\n    143 \r\n    144         model = cls._init_model_with_state_dict(state)\r\n\r\n/opt/anaconda3/lib/python3.8/site-packages/torch/serialization.py in load(f, map_location, pickle_module, **pickle_load_args)\r\n    582                     opened_file.seek(orig_position)\r\n    583                     return torch.jit.load(opened_file)\r\n--> 584                 return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)\r\n    585         return _legacy_load(opened_file, map_location, pickle_module, **pickle_load_args)\r\n    586 \r\n\r\n/opt/anaconda3/lib/python3.8/site-packages/torch/serialization.py in _load(zip_file, map_location, pickle_module, **pickle_load_args)\r\n    840     unpickler = pickle_module.Unpickler(data_file, **pickle_load_args)\r\n    841     unpickler.persistent_load = persistent_load\r\n--> 842     result = unpickler.load()\r\n    843 \r\n    844     return result\r\n\r\n/opt/anaconda3/lib/python3.8/site-packages/flair/embeddings/base.py in __setstate__(self, state)\r\n    443             config = config_class.from_dict(config_state_dict)\r\n    444 \r\n--> 445         embedding = self.create_from_state(saved_config=config, **state)\r\n    446 \r\n    447         # copy values from new embedding\r\n\r\n/opt/anaconda3/lib/python3.8/site-packages/flair/embeddings/document.py in create_from_state(cls, **state)\r\n     56         # this parameter is fixed\r\n     57         del state[\"is_document_embedding\"]\r\n---> 58         return cls(**state)\r\n     59 \r\n     60 \r\n\r\n/opt/anaconda3/lib/python3.8/site-packages/flair/embeddings/document.py in __init__(self, model, layers, layer_mean, is_token_embedding, **kwargs)\r\n     42         :param fine_tune: If True, allows transformers to be fine-tuned during training\r\n     43         \"\"\"\r\n---> 44         TransformerEmbedding.__init__(\r\n     45             self,\r\n     46             model=model,\r\n\r\n/opt/anaconda3/lib/python3.8/site-packages/flair/embeddings/base.py in __init__(self, model, fine_tune, layers, layer_mean, subtoken_pooling, cls_pooling, is_token_embedding, is_document_embedding, allow_long_sentences, use_context, respect_document_boundaries, context_dropout, saved_config, tokenizer_data, name, **kwargs)\r\n    205         else:\r\n    206             # load tokenizer from inmemory zip-file\r\n--> 207             self.tokenizer = self._tokenizer_from_bytes(tokenizer_data)\r\n    208 \r\n    209         if saved_config is None:\r\n\r\n/opt/anaconda3/lib/python3.8/site-packages/flair/embeddings/base.py in _tokenizer_from_bytes(self, zip_data)\r\n    337         with tempfile.TemporaryDirectory() as temp_dir:\r\n    338             zip_obj.extractall(temp_dir)\r\n--> 339             return AutoTokenizer.from_pretrained(temp_dir)\r\n    340 \r\n    341     def _tokenizer_bytes(self):\r\n\r\n/opt/anaconda3/lib/python3.8/site-packages/transformers/models/auto/tokenization_auto.py in from_pretrained(cls, pretrained_model_name_or_path, *inputs, **kwargs)\r\n    308         config = kwargs.pop(\"config\", None)\r\n    309         if not isinstance(config, PretrainedConfig):\r\n--> 310             config = AutoConfig.from_pretrained(pretrained_model_name_or_path, **kwargs)\r\n    311 \r\n    312         if \"bert-base-japanese\" in str(pretrained_model_name_or_path):\r\n\r\n/opt/anaconda3/lib/python3.8/site-packages/transformers/models/auto/configuration_auto.py in from_pretrained(cls, pretrained_model_name_or_path, **kwargs)\r\n    339             {'foo': False}\r\n    340         \"\"\"\r\n--> 341         config_dict, _ = PretrainedConfig.get_config_dict(pretrained_model_name_or_path, **kwargs)\r\n    342 \r\n    343         if \"model_type\" in config_dict:\r\n\r\n/opt/anaconda3/lib/python3.8/site-packages/transformers/configuration_utils.py in get_config_dict(cls, pretrained_model_name_or_path, **kwargs)\r\n    396                 f\"- or '{pretrained_model_name_or_path}' is the correct path to a directory containing a {CONFIG_NAME} file\\n\\n\"\r\n    397             )\r\n--> 398             raise EnvironmentError(msg)\r\n    399 \r\n    400         except json.JSONDecodeError:\r\n\r\nOSError: Can't load config for '/var/folders/20/4p5k_m8d5kn_wp1xx1fy39rc80krp9/T/tmpul4gwhkc'. Make sure that:\r\n\r\n- '/var/folders/20/4p5k_m8d5kn_wp1xx1fy39rc80krp9/T/tmpul4gwhkc' is a correct model identifier listed on 'https://huggingface.co/models'\r\n\r\n- or '/var/folders/20/4p5k_m8d5kn_wp1xx1fy39rc80krp9/T/tmpul4gwhkc' is the correct path to a directory containing a config.json file\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2988/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2988/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2984", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2984/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2984/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2984/events", "html_url": "https://github.com/flairNLP/flair/issues/2984", "id": 1440795881, "node_id": "I_kwDOCCkmXM5V4Mzp", "number": 2984, "title": "CUBLAS_STATUS_INVALID_VALUE", "user": {"login": "11Alexei11", "id": 49404761, "node_id": "MDQ6VXNlcjQ5NDA0NzYx", "avatar_url": "https://avatars.githubusercontent.com/u/49404761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/11Alexei11", "html_url": "https://github.com/11Alexei11", "followers_url": "https://api.github.com/users/11Alexei11/followers", "following_url": "https://api.github.com/users/11Alexei11/following{/other_user}", "gists_url": "https://api.github.com/users/11Alexei11/gists{/gist_id}", "starred_url": "https://api.github.com/users/11Alexei11/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/11Alexei11/subscriptions", "organizations_url": "https://api.github.com/users/11Alexei11/orgs", "repos_url": "https://api.github.com/users/11Alexei11/repos", "events_url": "https://api.github.com/users/11Alexei11/events{/privacy}", "received_events_url": "https://api.github.com/users/11Alexei11/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-11-08T19:39:38Z", "updated_at": "2023-04-02T16:54:07Z", "closed_at": "2023-04-02T16:54:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nError: RuntimeError: CUDA error: CUBLAS_STATUS_INVALID_VALUE when calling `cublasSgemmStridedBatched( handle, opa, opb, m, n, k, &alpha, a, lda, stridea, b, ldb, strideb, &beta, c, ldc, stridec, num_batches)` occures when i run code below\r\n\r\nfrom flair.embeddings import FlairEmbeddings, TransformerWordEmbeddings\r\nfrom flair.embeddings import StackedEmbeddings\r\n\r\n# init Flair embeddings\r\nflair_forward_embedding = FlairEmbeddings('multi-forward-fast')\r\nflair_backward_embedding = FlairEmbeddings('multi-backward-fast')\r\n\r\n# init multilingual BERT\r\nbert_embedding = TransformerWordEmbeddings('bert-base-multilingual-cased')\r\n\r\n\r\n# now create the StackedEmbedding object that combines all embeddings\r\nstacked_embeddings = StackedEmbeddings(\r\n    embeddings=[flair_forward_embedding, flair_backward_embedding, bert_embedding])\r\n\r\nwhats wrong?", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2984/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2984/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2982", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2982/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2982/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2982/events", "html_url": "https://github.com/flairNLP/flair/issues/2982", "id": 1439469162, "node_id": "I_kwDOCCkmXM5VzI5q", "number": 2982, "title": "'TextClassifier' object has no attribute 'embeddings'", "user": {"login": "pranavan-rbg", "id": 97009919, "node_id": "U_kgDOBchA_w", "avatar_url": "https://avatars.githubusercontent.com/u/97009919?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pranavan-rbg", "html_url": "https://github.com/pranavan-rbg", "followers_url": "https://api.github.com/users/pranavan-rbg/followers", "following_url": "https://api.github.com/users/pranavan-rbg/following{/other_user}", "gists_url": "https://api.github.com/users/pranavan-rbg/gists{/gist_id}", "starred_url": "https://api.github.com/users/pranavan-rbg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pranavan-rbg/subscriptions", "organizations_url": "https://api.github.com/users/pranavan-rbg/orgs", "repos_url": "https://api.github.com/users/pranavan-rbg/repos", "events_url": "https://api.github.com/users/pranavan-rbg/events{/privacy}", "received_events_url": "https://api.github.com/users/pranavan-rbg/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2022-11-08T04:36:58Z", "updated_at": "2022-11-09T15:51:44Z", "closed_at": "2022-11-09T14:57:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "TARSClassifier.load error \r\n\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-13-710c2b4d40e4> in <module>\r\n----> 1 tars = TARSClassifier.load('/content/drive/MyDrive/Text_classification/final-model.pt')\r\n\r\n2 frames\r\n/usr/local/lib/python3.7/dist-packages/flair/nn/model.py in load(cls, model_path)\r\n    147             state = torch.load(f, map_location=\"cpu\")\r\n    148 \r\n--> 149         model = cls._init_model_with_state_dict(state)\r\n    150 \r\n    151         if \"model_card\" in state:\r\n\r\n/usr/local/lib/python3.7/dist-packages/flair/models/tars_model.py in _init_model_with_state_dict(cls, state, **kwargs)\r\n    739             label_dictionary=state.get(\"label_dictionary\"),\r\n    740             label_type=state.get(\"label_type\", \"default_label\"),\r\n--> 741             embeddings=state.get(\"tars_model\").embeddings,\r\n    742             num_negative_labels_to_sample=state.get(\"num_negative_labels_to_sample\"),\r\n    743             **kwargs,\r\n\r\n/usr/local/lib/python3.7/dist-packages/torch/nn/modules/module.py in __getattr__(self, name)\r\n   1206                 return modules[name]\r\n   1207         raise AttributeError(\"'{}' object has no attribute '{}'\".format(\r\n-> 1208             type(self).__name__, name))\r\n   1209 \r\n   1210     def __setattr__(self, name: str, value: Union[Tensor, 'Module']) -> None:\r\n\r\nAttributeError: 'TextClassifier' object has no attribute 'embeddings'", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2982/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2982/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2977", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2977/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2977/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2977/events", "html_url": "https://github.com/flairNLP/flair/issues/2977", "id": 1433966399, "node_id": "I_kwDOCCkmXM5VeJc_", "number": 2977, "title": "No BIO tags when loading external dataset (eg., Conll2003)", "user": {"login": "aoezdemir", "id": 62874306, "node_id": "MDQ6VXNlcjYyODc0MzA2", "avatar_url": "https://avatars.githubusercontent.com/u/62874306?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aoezdemir", "html_url": "https://github.com/aoezdemir", "followers_url": "https://api.github.com/users/aoezdemir/followers", "following_url": "https://api.github.com/users/aoezdemir/following{/other_user}", "gists_url": "https://api.github.com/users/aoezdemir/gists{/gist_id}", "starred_url": "https://api.github.com/users/aoezdemir/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aoezdemir/subscriptions", "organizations_url": "https://api.github.com/users/aoezdemir/orgs", "repos_url": "https://api.github.com/users/aoezdemir/repos", "events_url": "https://api.github.com/users/aoezdemir/events{/privacy}", "received_events_url": "https://api.github.com/users/aoezdemir/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-11-03T01:00:32Z", "updated_at": "2023-01-16T10:56:26Z", "closed_at": "2023-01-16T10:56:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\n\r\nwhen I load the Conll2003 dataset (NER tags are in BIO-Format) manually, the BIO tags disappear. \r\nMy Implementation:\r\n```\r\n# define columns\r\ncolumns = {0: 'text', 3:'ner'}\r\n\r\n# this is the folder in which train, test and dev files reside\r\ndata_folder = '/data/conll2003NER/'\r\n\r\n# init a corpus using column format, data folder and the names of the train, dev and test files\r\ncorpus: Corpus = ColumnCorpus(data_folder, columns,\r\n                              train_file='train.txt',\r\n                              test_file='test.txt',\r\n                              dev_file='valid.txt',\r\n                              )\r\n```\r\nand when I do this:\r\n\r\n`print(corpus.train[0].to_tagged_string('ner'))`\r\n\r\nwhich only outputs:\r\n`Sentence: \"EU rejects German call to boycott British lamb .\" \u2192 [\"EU\"/ORG, \"German\"/MISC, \"British\"/MISC]`\r\n\r\nInstead it should be like this:\r\n`Sentence: \"EU rejects German call to boycott British lamb .\" \u2192 [\"EU\"/B-ORG, \"German\"/B-MISC, \"British\"/B-MISC]`\r\n\r\n**Why are the BIO tags missing? I really need help. \r\nThanks in advance!**\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2977/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2977/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2973", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2973/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2973/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2973/events", "html_url": "https://github.com/flairNLP/flair/issues/2973", "id": 1424550896, "node_id": "I_kwDOCCkmXM5U6Ovw", "number": 2973, "title": "flair is not a package", "user": {"login": "mghasemizade", "id": 74173811, "node_id": "MDQ6VXNlcjc0MTczODEx", "avatar_url": "https://avatars.githubusercontent.com/u/74173811?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mghasemizade", "html_url": "https://github.com/mghasemizade", "followers_url": "https://api.github.com/users/mghasemizade/followers", "following_url": "https://api.github.com/users/mghasemizade/following{/other_user}", "gists_url": "https://api.github.com/users/mghasemizade/gists{/gist_id}", "starred_url": "https://api.github.com/users/mghasemizade/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mghasemizade/subscriptions", "organizations_url": "https://api.github.com/users/mghasemizade/orgs", "repos_url": "https://api.github.com/users/mghasemizade/repos", "events_url": "https://api.github.com/users/mghasemizade/events{/privacy}", "received_events_url": "https://api.github.com/users/mghasemizade/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-10-26T18:56:24Z", "updated_at": "2022-11-02T10:32:04Z", "closed_at": "2022-11-02T10:32:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nAfter trying to run examples of the Doc Word Embedding in the docs, this is what I get:\r\nModuleNotFoundError: No module named 'flair.embeddings'; 'flair' is not a package\r\n\r\n**To Reproduce**\r\nfrom flair.embeddings import TransformerDocumentEmbeddings\r\n\r\n# init embedding\r\nembedding = TransformerDocumentEmbeddings('bert-base-uncased')\r\n\r\n# create a sentence\r\nsentence = Sentence('The grass is green .')\r\n\r\n# embed the sentence\r\nembedding.embed(sentence)**Expected behavior**\r\nA clear and concise description of what you expected to happen.\r\n\r\n**Screenshots**\r\n![image](https://user-images.githubusercontent.com/74173811/198111529-30238cc8-60e1-4e5c-866e-a830cd658736.png)\r\n\r\n**Environment (please complete the following information):**\r\nUbuntu 20.04.05 LTS\r\nPython 3.8.10\r\n\r\n**Additional context**\r\nI have tried on Ubuntu 22, 20, 18, and 16.  I couldn't install flair in Ubuntu 22 and 18, though the default python version of ubuntu 18 is 3.6. I made a python 3.6 environment in ubuntu 16 like mentioned in the README.md file but I still failed to run anything with flair.\r\nI have tried installing pytorch before running, changing the environment, updating the pip and also this new comment I found in here:\r\n https://github.com/flairNLP/flair/issues/2969#issuecomment-1290778864\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2973/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2973/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2969", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2969/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2969/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2969/events", "html_url": "https://github.com/flairNLP/flair/issues/2969", "id": 1422676700, "node_id": "I_kwDOCCkmXM5UzFLc", "number": 2969, "title": "Unable to pip3 install flair --error on sentencepiece", "user": {"login": "MariaLuisaCroci", "id": 44378167, "node_id": "MDQ6VXNlcjQ0Mzc4MTY3", "avatar_url": "https://avatars.githubusercontent.com/u/44378167?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MariaLuisaCroci", "html_url": "https://github.com/MariaLuisaCroci", "followers_url": "https://api.github.com/users/MariaLuisaCroci/followers", "following_url": "https://api.github.com/users/MariaLuisaCroci/following{/other_user}", "gists_url": "https://api.github.com/users/MariaLuisaCroci/gists{/gist_id}", "starred_url": "https://api.github.com/users/MariaLuisaCroci/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MariaLuisaCroci/subscriptions", "organizations_url": "https://api.github.com/users/MariaLuisaCroci/orgs", "repos_url": "https://api.github.com/users/MariaLuisaCroci/repos", "events_url": "https://api.github.com/users/MariaLuisaCroci/events{/privacy}", "received_events_url": "https://api.github.com/users/MariaLuisaCroci/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2022-10-25T15:38:14Z", "updated_at": "2023-04-02T16:53:56Z", "closed_at": "2023-04-02T16:53:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "I tried in a jupyter notebook to install the library as ```!pip3 install flair```. \r\n\r\nHowever, after several requirements already satisfied, this error is returned:\r\n\r\n```Building wheels for collected packages: sentencepiece\r\n  Building wheel for sentencepiece (setup.py) ... error\r\n  error: subprocess-exited-with-error\r\n  \r\n  \u00d7 python setup.py bdist_wheel did not run successfully.\r\n  \u2502 exit code: 1\r\n  \u2570\u2500> [37 lines of output]\r\n      /Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/setuptools/dist.py:771: UserWarning: Usage of dash-separated 'description-file' will not be supported in future versions. Please use the underscore name 'description_file' instead\r\n        warnings.warn(\r\n      running bdist_wheel\r\n      running build\r\n      running build_py\r\n      creating build\r\n      creating build/lib.macosx-10.9-universal2-cpython-310\r\n      creating build/lib.macosx-10.9-universal2-cpython-310/sentencepiece\r\n      copying src/sentencepiece/__init__.py -> build/lib.macosx-10.9-universal2-cpython-310/sentencepiece\r\n      copying src/sentencepiece/sentencepiece_model_pb2.py -> build/lib.macosx-10.9-universal2-cpython-310/sentencepiece\r\n      copying src/sentencepiece/sentencepiece_pb2.py -> build/lib.macosx-10.9-universal2-cpython-310/sentencepiece\r\n      running build_ext\r\n      /bin/sh: pkg-config: command not found\r\n      Cloning into 'sentencepiece'...\r\n      Note: switching to '0e6dfbf86e2fa6d86a3d9a8a08a628da71c073e0'.\r\n      \r\n      You are in 'detached HEAD' state. You can look around, make experimental\r\n      changes and commit them, and you can discard any commits you make in this\r\n      state without impacting any branches by switching back to a branch.\r\n      \r\n      If you want to create a new branch to retain commits you create, you may\r\n      do so (now or later) by using -c with the switch command. Example:\r\n      \r\n        git switch -c <new-branch-name>\r\n      \r\n      Or undo this operation with:\r\n      \r\n        git switch -\r\n      \r\n      Turn off this advice by setting config variable advice.detachedHead to false\r\n      \r\n      ./build_bundled.sh: line 15: cmake: command not found\r\n      ./build_bundled.sh: line 16: nproc: command not found\r\n      make: *** No targets specified and no makefile found.  Stop.\r\n      make: *** No rule to make target 'install'.  Stop.\r\n      env: pkg-config: No such file or directory\r\n      Failed to find sentencepiece pkg-config\r\n      [end of output]\r\n  \r\n  note: This error originates from a subprocess, and is likely not a problem with pip.\r\n  ERROR: Failed building wheel for sentencepiece\r\n  Running setup.py clean for sentencepiece\r\nFailed to build sentencepiece\r\nInstalling collected packages: sentencepiece, pptree, more-itertools, conllu, wikipedia-api, gdown, flair\r\n  Attempting uninstall: sentencepiece\r\n    Found existing installation: sentencepiece 0.1.97\r\n    Uninstalling sentencepiece-0.1.97:\r\n      Successfully uninstalled sentencepiece-0.1.97\r\n  Running setup.py install for sentencepiece ... error\r\n  error: subprocess-exited-with-error\r\n  \r\n  \u00d7 Running setup.py install for sentencepiece did not run successfully.\r\n  \u2502 exit code: 1\r\n  \u2570\u2500> [25 lines of output]\r\n      /Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/setuptools/dist.py:771: UserWarning: Usage of dash-separated 'description-file' will not be supported in future versions. Please use the underscore name 'description_file' instead\r\n        warnings.warn(\r\n      running install\r\n      /Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/setuptools/command/install.py:34: SetuptoolsDeprecationWarning: setup.py install is deprecated. Use build and pip and other standards-based tools.\r\n        warnings.warn(\r\n      running build\r\n      running build_py\r\n      creating build\r\n      creating build/lib.macosx-10.9-universal2-cpython-310\r\n      creating build/lib.macosx-10.9-universal2-cpython-310/sentencepiece\r\n      copying src/sentencepiece/__init__.py -> build/lib.macosx-10.9-universal2-cpython-310/sentencepiece\r\n      copying src/sentencepiece/sentencepiece_model_pb2.py -> build/lib.macosx-10.9-universal2-cpython-310/sentencepiece\r\n      copying src/sentencepiece/sentencepiece_pb2.py -> build/lib.macosx-10.9-universal2-cpython-310/sentencepiece\r\n      running build_ext\r\n      /bin/sh: pkg-config: command not found\r\n      mkdir: bundled: File exists\r\n      fatal: destination path 'sentencepiece' already exists and is not an empty directory.\r\n      fatal: destination path 'sentencepiece' already exists and is not an empty directory.\r\n      mkdir: build: File exists\r\n      ./build_bundled.sh: line 15: cmake: command not found\r\n      ./build_bundled.sh: line 16: nproc: command not found\r\n      make: *** No targets specified and no makefile found.  Stop.\r\n      make: *** No rule to make target 'install'.  Stop.\r\n      env: pkg-config: No such file or directory\r\n      Failed to find sentencepiece pkg-config\r\n      [end of output]\r\n  \r\n  note: This error originates from a subprocess, and is likely not a problem with pip.\r\n  Rolling back uninstall of sentencepiece\r\n  Moving to /Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/sentencepiece-0.1.97.dist-info/\r\n   from /Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/~entencepiece-0.1.97.dist-info\r\n  Moving to /Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/sentencepiece/\r\n   from /Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/~entencepiece\r\nerror: legacy-install-failure\r\n\r\n\u00d7 Encountered error while trying to install package.\r\n\u2570\u2500> sentencepiece\r\n\r\nnote: This is an issue with the package mentioned above, not pip.\r\nhint: See above for output from the failure.\r\n\r\n```\r\n\r\n\r\n\r\nI'm working on Mac OS, python version '3.10.7'.\r\n\r\nI also tried to ```pip3 install sentencepiece``` and this works fine, but flair library doesn't work yet.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2969/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2969/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2967", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2967/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2967/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2967/events", "html_url": "https://github.com/flairNLP/flair/issues/2967", "id": 1418692646, "node_id": "I_kwDOCCkmXM5Uj4gm", "number": 2967, "title": "Unable to load Embeddings due to Connection Error", "user": {"login": "aoezdemir", "id": 62874306, "node_id": "MDQ6VXNlcjYyODc0MzA2", "avatar_url": "https://avatars.githubusercontent.com/u/62874306?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aoezdemir", "html_url": "https://github.com/aoezdemir", "followers_url": "https://api.github.com/users/aoezdemir/followers", "following_url": "https://api.github.com/users/aoezdemir/following{/other_user}", "gists_url": "https://api.github.com/users/aoezdemir/gists{/gist_id}", "starred_url": "https://api.github.com/users/aoezdemir/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aoezdemir/subscriptions", "organizations_url": "https://api.github.com/users/aoezdemir/orgs", "repos_url": "https://api.github.com/users/aoezdemir/repos", "events_url": "https://api.github.com/users/aoezdemir/events{/privacy}", "received_events_url": "https://api.github.com/users/aoezdemir/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2022-10-21T18:08:37Z", "updated_at": "2022-10-25T15:38:21Z", "closed_at": "2022-10-25T15:38:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\n\r\nI am trying to load WordEmbeddings as described in your Tutorial in Google Cola, as well as in my own virtual environment in PyCharm:\r\n\r\n```\r\nfrom flair.embeddings import TokenEmbeddings, WordEmbeddings, StackedEmbeddings, FlairEmbeddings\r\ngloveEmbeddings = WordEmbeddings(\"glove\")\r\n```\r\nAnd get the following Error in both:\r\n`ConnectionError: HTTPSConnectionPool(host='flair.informatik.hu-berlin.de', port=443): Max retries exceeded with url: /resources/embeddings/token/glove.gensim.vectors.npy (Caused by NewConnectionError('<urllib3.connection.VerifiedHTTPSConnection object at 0x7f33727bf1d0>: Failed to establish a new connection: [Errno 110] Connection timed out'))`\r\n\r\nflair-version: 0.11.3\t\r\n\r\nHow can I solve this problem?", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2967/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2967/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2965", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2965/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2965/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2965/events", "html_url": "https://github.com/flairNLP/flair/issues/2965", "id": 1414110982, "node_id": "I_kwDOCCkmXM5USZ8G", "number": 2965, "title": "flair/pos-english on Hugging Face reports \"No token was detected\"", "user": {"login": "ToonTalk", "id": 2138696, "node_id": "MDQ6VXNlcjIxMzg2OTY=", "avatar_url": "https://avatars.githubusercontent.com/u/2138696?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ToonTalk", "html_url": "https://github.com/ToonTalk", "followers_url": "https://api.github.com/users/ToonTalk/followers", "following_url": "https://api.github.com/users/ToonTalk/following{/other_user}", "gists_url": "https://api.github.com/users/ToonTalk/gists{/gist_id}", "starred_url": "https://api.github.com/users/ToonTalk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ToonTalk/subscriptions", "organizations_url": "https://api.github.com/users/ToonTalk/orgs", "repos_url": "https://api.github.com/users/ToonTalk/repos", "events_url": "https://api.github.com/users/ToonTalk/events{/privacy}", "received_events_url": "https://api.github.com/users/ToonTalk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-10-19T01:43:15Z", "updated_at": "2023-04-02T16:53:32Z", "closed_at": "2023-04-02T16:53:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n\"No token was detected\" reported\r\n\r\n**To Reproduce**\r\nVisit https://huggingface.co/flair/pos-english and click on Compute button\r\n\r\n**Expected behavior**\r\nparts of speech displayed\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2965/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2965/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2964", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2964/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2964/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2964/events", "html_url": "https://github.com/flairNLP/flair/issues/2964", "id": 1413369482, "node_id": "I_kwDOCCkmXM5UPk6K", "number": 2964, "title": "Can't reproduce export_onnx example from TUTORIAL_13", "user": {"login": "klimentij", "id": 3247669, "node_id": "MDQ6VXNlcjMyNDc2Njk=", "avatar_url": "https://avatars.githubusercontent.com/u/3247669?v=4", "gravatar_id": "", "url": "https://api.github.com/users/klimentij", "html_url": "https://github.com/klimentij", "followers_url": "https://api.github.com/users/klimentij/followers", "following_url": "https://api.github.com/users/klimentij/following{/other_user}", "gists_url": "https://api.github.com/users/klimentij/gists{/gist_id}", "starred_url": "https://api.github.com/users/klimentij/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/klimentij/subscriptions", "organizations_url": "https://api.github.com/users/klimentij/orgs", "repos_url": "https://api.github.com/users/klimentij/repos", "events_url": "https://api.github.com/users/klimentij/events{/privacy}", "received_events_url": "https://api.github.com/users/klimentij/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2022-10-18T14:52:09Z", "updated_at": "2023-02-20T13:14:56Z", "closed_at": "2023-02-20T13:14:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhen I try to export `ner-large` transformer embeddings to ONNX, I see an error `TypeError: forward() missing 1 required positional argument: 'lengths'`\r\n\r\n**To Reproduce**\r\n\r\n1. Install Flair==0.11.3 from git repo: `pip install git+https://github.com/flairNLP/flair.git` (`TransformerOnnxEmbeddings` class is not available when installed from pip)\r\n2. Run code from the tutorial 13 with my own sentences:  \r\n```\r\nfrom flair.models import SequenceTagger\r\nfrom flair.embeddings import TransformerWordEmbeddings, TransformerDocumentEmbeddings\r\n\r\nmodel = SequenceTagger.load(\"ner-large\")\r\nassert isinstance(model.embeddings, (TransformerWordEmbeddings, TransformerDocumentEmbeddings))\r\n\r\n\r\nsentences = [Sentence(s) for s in ['short sentence', 'this is very long sentence']]\r\nmodel = SequenceTagger.load(\"ner-large\")\r\nmodel.embeddings = model.embeddings.export_onnx(\"flert-embeddings.onnx\", sentences, providers=[\"CUDAExecutionProvider\", \"CPUExecutionProvider\"])\r\n```\r\n3. I get the error `TypeError: forward() missing 1 required positional argument: 'lengths'`\r\n\r\n**Expected behavior**\r\nThis creates a file `flert-embeddings.onnx` which stores the exported Onnx Model.\r\n\r\n**Screenshots**\r\n<img width=\"689\" alt=\"image\" src=\"https://user-images.githubusercontent.com/3247669/196463874-61339c71-08f9-4524-921e-92dc59f7a3e2.png\">\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - Deep Learning AMI GPU PyTorch 1.12.1 (Amazon Linux 2) \r\n - NVIDIA driver version: 510.73.08\r\n - CUDA version: 11.6 \r\n - Flair 0.11.3\r\n - onnx 1.12.0\r\n - onnxruntime 1.12.1\r\n - Pytorch 1.12.1.post201\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2964/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2964/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2960", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2960/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2960/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2960/events", "html_url": "https://github.com/flairNLP/flair/issues/2960", "id": 1407817329, "node_id": "I_kwDOCCkmXM5T6ZZx", "number": 2960, "title": "Missing docstring parameters for ModelTrainer.train()", "user": {"login": "thlor", "id": 6570020, "node_id": "MDQ6VXNlcjY1NzAwMjA=", "avatar_url": "https://avatars.githubusercontent.com/u/6570020?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thlor", "html_url": "https://github.com/thlor", "followers_url": "https://api.github.com/users/thlor/followers", "following_url": "https://api.github.com/users/thlor/following{/other_user}", "gists_url": "https://api.github.com/users/thlor/gists{/gist_id}", "starred_url": "https://api.github.com/users/thlor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thlor/subscriptions", "organizations_url": "https://api.github.com/users/thlor/orgs", "repos_url": "https://api.github.com/users/thlor/repos", "events_url": "https://api.github.com/users/thlor/events{/privacy}", "received_events_url": "https://api.github.com/users/thlor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-10-13T13:33:44Z", "updated_at": "2022-10-31T09:09:34Z", "closed_at": "2022-10-26T10:12:42Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "While most of the parameters of `ModelTrainer` class' `train()` method are documented, the following (keyworded) parameters have no docstring documentations:\r\n\r\n- ~~`eval_batch_size`~~ resolved\r\n- ~~`initial_extra_patience`~~ resolved\r\n- ~~`anneal_with_prestarts`~~ resolved\r\n- ~~`anneal_against_dev_loss`~~ resolved\r\n- ~~`batch_growth_annealing`~~ resolved\r\n- ~~`write_weights`~~ resolved\r\n- `use_amp`\r\n- `amp_opt_level`\r\n- `use_swa`\r\n- `use_final_model_for_eval`\r\n- `gold_label_dictionary_for_eval`\r\n- `exclude_labels`\r\n- `optimizer_state_dict`\r\n- `scheduler_state_dict`\r\n- `save_optimizer_state`", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2960/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2960/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2959", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2959/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2959/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2959/events", "html_url": "https://github.com/flairNLP/flair/issues/2959", "id": 1407597692, "node_id": "I_kwDOCCkmXM5T5jx8", "number": 2959, "title": "Export ONNX failed", "user": {"login": "ZeusFSX", "id": 22007867, "node_id": "MDQ6VXNlcjIyMDA3ODY3", "avatar_url": "https://avatars.githubusercontent.com/u/22007867?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ZeusFSX", "html_url": "https://github.com/ZeusFSX", "followers_url": "https://api.github.com/users/ZeusFSX/followers", "following_url": "https://api.github.com/users/ZeusFSX/following{/other_user}", "gists_url": "https://api.github.com/users/ZeusFSX/gists{/gist_id}", "starred_url": "https://api.github.com/users/ZeusFSX/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ZeusFSX/subscriptions", "organizations_url": "https://api.github.com/users/ZeusFSX/orgs", "repos_url": "https://api.github.com/users/ZeusFSX/repos", "events_url": "https://api.github.com/users/ZeusFSX/events{/privacy}", "received_events_url": "https://api.github.com/users/ZeusFSX/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-10-13T11:02:00Z", "updated_at": "2023-02-20T13:10:53Z", "closed_at": "2023-02-20T13:10:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI try export NER model by the [tutorial](https://github.com/flairNLP/flair/blob/master/resources/docs/TUTORIAL_13_TRANSFORMERS_PRODUCTION.md)  and it failed with error \r\n`TypeError: TransformerEmbeddings.forward() missing 1 required positional argument: 'lengths'`\r\n\r\n\r\n**To Reproduce**\r\n[tutorial](https://github.com/flairNLP/flair/blob/master/resources/docs/TUTORIAL_13_TRANSFORMERS_PRODUCTION.md)\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - OS : Ubuntu 22.04\r\n - Python: 3.10.7\r\n - Version flair: 0.11.3\r\n\r\n**Additional context**\r\nI've installed flair from GitHub. Because if you install via pip, it will rise the exception `AttributeError: TransformerWordEmbeddings object has no attribute 'export_onnx'`", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2959/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2959/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2940", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2940/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2940/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2940/events", "html_url": "https://github.com/flairNLP/flair/issues/2940", "id": 1376170990, "node_id": "I_kwDOCCkmXM5SBrPu", "number": 2940, "title": "Tokenizer inserting spaces", "user": {"login": "rxjx", "id": 8461845, "node_id": "MDQ6VXNlcjg0NjE4NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/8461845?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rxjx", "html_url": "https://github.com/rxjx", "followers_url": "https://api.github.com/users/rxjx/followers", "following_url": "https://api.github.com/users/rxjx/following{/other_user}", "gists_url": "https://api.github.com/users/rxjx/gists{/gist_id}", "starred_url": "https://api.github.com/users/rxjx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rxjx/subscriptions", "organizations_url": "https://api.github.com/users/rxjx/orgs", "repos_url": "https://api.github.com/users/rxjx/repos", "events_url": "https://api.github.com/users/rxjx/events{/privacy}", "received_events_url": "https://api.github.com/users/rxjx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-09-16T16:32:16Z", "updated_at": "2022-09-20T16:05:56Z", "closed_at": "2022-09-20T16:05:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "Spaces seem to get added when converting strings into Sentences.\r\n\r\n\r\n```\r\nfrom flair.data import Corpus, Sentence\r\n\r\ntxt = [\"X only has $7k USD, can't buy any GOOGL\",\r\n       'MSFT +6% after market again on strong cloud',\r\n       \"I'm expecting a jump in GOOGL\"]\r\ns = [Sentence(t) for t in txt]\r\ns\r\n```\r\n\r\n\r\nExpected:\r\n[Sentence: \"X only has $7k USD, can't buy any GOOGL\",\r\n Sentence: \"MSFT + 6% after market again on strong cloud\",\r\n Sentence: \"I'm expecting a jump in GOOGL\"]\r\n\r\nGot:\r\n[Sentence: \"X only has $ 7k USD , ca n't buy any GOOGL\",\r\n Sentence: \"MSFT + 6 % after market again on strong cloud\",\r\n Sentence: \"I 'm expecting a jump in GOOGL\"]\r\n\r\nGoogle Colab\r\nFlair 0.11.3\r\n\r\nThis insertion of spaces does not happen when reading in the same data as a ColumnCorpus from BIO annotated files.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2940/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2940/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2930", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2930/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2930/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2930/events", "html_url": "https://github.com/flairNLP/flair/issues/2930", "id": 1358586934, "node_id": "I_kwDOCCkmXM5Q-mQ2", "number": 2930, "title": "RuntimeError while saving embedding model in ONNX format", "user": {"login": "kobiche", "id": 56874660, "node_id": "MDQ6VXNlcjU2ODc0NjYw", "avatar_url": "https://avatars.githubusercontent.com/u/56874660?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kobiche", "html_url": "https://github.com/kobiche", "followers_url": "https://api.github.com/users/kobiche/followers", "following_url": "https://api.github.com/users/kobiche/following{/other_user}", "gists_url": "https://api.github.com/users/kobiche/gists{/gist_id}", "starred_url": "https://api.github.com/users/kobiche/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kobiche/subscriptions", "organizations_url": "https://api.github.com/users/kobiche/orgs", "repos_url": "https://api.github.com/users/kobiche/repos", "events_url": "https://api.github.com/users/kobiche/events{/privacy}", "received_events_url": "https://api.github.com/users/kobiche/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-09-01T10:07:08Z", "updated_at": "2023-01-17T00:53:40Z", "closed_at": "2023-01-17T00:53:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nThe model cannot be saved in ONNX format as shown in the flair/resources/docs/TUTORIAL_13_TRANSFORMERS_PRODUCTION.md tutorial. The export raises the following error: \r\n`RuntimeError: Dynamic shape axis should be no more than the shape dimension for sequ_length`\r\n\r\n**To Reproduce**\r\n```python\r\nfrom flair.data import Sentence\r\nfrom flair.models import SequenceTagger\r\nfrom flair.embeddings import TransformerWordEmbeddings, TransformerDocumentEmbeddings\r\nimport flair.datasets\r\n\r\nif __name__ == '__main__':\r\n    model = SequenceTagger.load(\"ner-large\")\r\n    assert isinstance(model.embeddings, (TransformerWordEmbeddings, TransformerDocumentEmbeddings))\r\n\r\n    # Serialize the model (use sample sentences)\r\n    sentences = list(flair.datasets.CONLL_03_SPANISH().test)[:5]\r\n    model.embeddings = model.embeddings.export_onnx(\"flert-embeddings.onnx\", sentences, providers=[\"CUDAExecutionProvider\", \"CPUExecutionProvider\"])\r\n```\r\n\r\n**Expected behavior**\r\nModel saved in ONNX format\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Linux\r\n - Flair version: master (last commit: [ee7e619](https://github.com/flairNLP/flair/commit/ee7e6191ff4b9bf55d9ea3caf480c6a3fd975cba))\r\n - ONNX runtime version: 1.12.0\r\n\r\n**Additional context**\r\nI found out that this problem arises when the `torch.onnx.export` is [called](https://github.com/flairNLP/flair/blob/master/flair/embeddings/transformer.py#L674). While debugging, I found out that this comes from the order of `example_tensors`. The model expects the following order `['input_ids', 'lengths', 'attention_mask', 'overflow_to_sample_mapping', 'word_ids']` so I suggest that the `example_tensors` is reordered accordingly (quick fix):\r\n```python\r\ndesired_order = ['input_ids', 'lengths', 'attention_mask', 'overflow_to_sample_mapping', 'word_ids']\r\nexample_tensors = {k: example_tensors[k] for k in desired_order}\r\n```\r\nAnd while we are at it, I would suggest to fix the expected type of the `args` argument of `torch.onnx.export` (should be a tuple)\r\n```python\r\n        torch.onnx.export(\r\n            embedding,\r\n            tuple(example_tensors.values()),\r\n            ...\r\n        )\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2930/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2930/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2912", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2912/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2912/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2912/events", "html_url": "https://github.com/flairNLP/flair/issues/2912", "id": 1342223131, "node_id": "I_kwDOCCkmXM5QALMb", "number": 2912, "title": "Spacing injected by Flair into Named Entities skewing reported metrics", "user": {"login": "None-Such", "id": 4958599, "node_id": "MDQ6VXNlcjQ5NTg1OTk=", "avatar_url": "https://avatars.githubusercontent.com/u/4958599?v=4", "gravatar_id": "", "url": "https://api.github.com/users/None-Such", "html_url": "https://github.com/None-Such", "followers_url": "https://api.github.com/users/None-Such/followers", "following_url": "https://api.github.com/users/None-Such/following{/other_user}", "gists_url": "https://api.github.com/users/None-Such/gists{/gist_id}", "starred_url": "https://api.github.com/users/None-Such/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/None-Such/subscriptions", "organizations_url": "https://api.github.com/users/None-Such/orgs", "repos_url": "https://api.github.com/users/None-Such/repos", "events_url": "https://api.github.com/users/None-Such/events{/privacy}", "received_events_url": "https://api.github.com/users/None-Such/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-08-17T19:50:02Z", "updated_at": "2023-01-07T13:48:26Z", "closed_at": "2023-01-07T13:48:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "When doing sequence tagging for Named Entities, Flair is injecting spaces around punctuation inside the Span itself (which I suspect this is due to the tokenization being applied). I previously reported this as a question (https://github.com/flairNLP/flair/issues/2908), but have since learned it is also skewing reported metrics as it causes a string comparison of the Entity to NOT match, and thus falsely penalizes the metrics reported.\r\n\r\nFor example,\r\n\r\nwhen tagging people:\r\n`Peter T. Pan Jr.`\r\nFlair alters the string to:\r\n`Peter T . Pan Jr .`\r\n\r\nwhen tagging user Organizations:\r\n`A+Flying`\r\nFlair alters the string to:\r\n`A + Flying`\r\n\r\nwhen tagging user handles:\r\n`@__peterpan__`\r\nFlair alters the string to:\r\n`@ __ peterpan __`", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2912/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2912/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2903", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2903/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2903/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2903/events", "html_url": "https://github.com/flairNLP/flair/issues/2903", "id": 1338159912, "node_id": "I_kwDOCCkmXM5PwrMo", "number": 2903, "title": "token.get_label return wrong tags", "user": {"login": "BrambleXu", "id": 10768193, "node_id": "MDQ6VXNlcjEwNzY4MTkz", "avatar_url": "https://avatars.githubusercontent.com/u/10768193?v=4", "gravatar_id": "", "url": "https://api.github.com/users/BrambleXu", "html_url": "https://github.com/BrambleXu", "followers_url": "https://api.github.com/users/BrambleXu/followers", "following_url": "https://api.github.com/users/BrambleXu/following{/other_user}", "gists_url": "https://api.github.com/users/BrambleXu/gists{/gist_id}", "starred_url": "https://api.github.com/users/BrambleXu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/BrambleXu/subscriptions", "organizations_url": "https://api.github.com/users/BrambleXu/orgs", "repos_url": "https://api.github.com/users/BrambleXu/repos", "events_url": "https://api.github.com/users/BrambleXu/events{/privacy}", "received_events_url": "https://api.github.com/users/BrambleXu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-08-14T07:31:31Z", "updated_at": "2023-01-07T13:48:23Z", "closed_at": "2023-01-07T13:48:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n`token.get_label` return wrong tags\r\n\r\n**To Reproduce**\r\nFirst we have a corpus to read, the training data `train_datapool_sample.txt` is like below.\r\n```\r\nGermany\tNNP\tB-NP\tB-LOC\r\nimported\tVBD\tB-VP\tO\r\n47,600\tCD\tB-NP\tO\r\nsheep\tNN\tI-NP\tO\r\nfrom\tIN\tB-PP\tO\r\nBritain\tNNP\tB-NP\tB-LOC\r\nlast\tJJ\tB-NP\tO\r\nyear\tNN\tI-NP\tO\r\n,\t,\tO\tO\r\nnearly\tRB\tB-NP\tO\r\nhalf\tNN\tI-NP\tO\r\nof\tIN\tB-PP\tO\r\ntotal\tJJ\tB-NP\tO\r\nimports\tNNS\tI-NP\tO\r\n.\t.\tO\tO\r\n```\r\n\r\nRead the dataset.\r\n```\r\nfrom flair.datasets import ColumnCorpus\r\n\r\ncolumns = {0: \"text\", 3: \"ner\"}\r\ndata_folder = \"./conll\"\r\ncorpus = ColumnCorpus(\r\n    data_folder,\r\n    columns,\r\n    train_file=\"train_datapool_sample.txt\",\r\n    dev_file=\"valid.txt\",\r\n    test_file=\"test.txt\",\r\n)\r\n\r\nsent = corpus.train[0]\r\n```\r\n\r\nThen we use `token.get_label()` to get each label.\r\n\r\n```\r\nIn [28]: for token in sent:\r\n    ...:     print(token.get_label('ner'))\r\n    ...: \r\nToken[0]: \"Germany\" \u2192 O (1.0)\r\nToken[1]: \"imported\" \u2192 O (1.0)\r\nToken[2]: \"47,600\" \u2192 O (1.0)\r\nToken[3]: \"sheep\" \u2192 O (1.0)\r\nToken[4]: \"from\" \u2192 O (1.0)\r\nToken[5]: \"Britain\" \u2192 O (1.0)\r\nToken[6]: \"last\" \u2192 O (1.0)\r\nToken[7]: \"year\" \u2192 O (1.0)\r\nToken[8]: \",\" \u2192 O (1.0)\r\nToken[9]: \"nearly\" \u2192 O (1.0)\r\nToken[10]: \"half\" \u2192 O (1.0)\r\nToken[11]: \"of\" \u2192 O (1.0)\r\nToken[12]: \"total\" \u2192 O (1.0)\r\nToken[13]: \"imports\" \u2192 O (1.0)\r\nToken[14]: \".\" \u2192 O (1.0)\r\n```\r\n\r\n\r\n**Expected behavior**\r\n\r\nAccording to the dataset, 'Germany' and 'Britain' should like below.\r\n\r\n```\r\nToken[0]: \"Germany\" \u2192 B-LOC (1.0)\r\nToken[5]: \"Britain\" \u2192 B-LOC (1.0)\r\n```\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: MacOS 10.15.7\r\n - Version [e.g. flair-0.3.2]: flair v0.11\r\n\r\n\r\n\r\n**Additional context**\r\n\r\nThis problem is not existed on fliar v0.10\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2903/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2903/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2901", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2901/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2901/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2901/events", "html_url": "https://github.com/flairNLP/flair/issues/2901", "id": 1336559981, "node_id": "I_kwDOCCkmXM5Pqklt", "number": 2901, "title": "Missing import in tutorial 5", "user": {"login": "pleonova", "id": 6027401, "node_id": "MDQ6VXNlcjYwMjc0MDE=", "avatar_url": "https://avatars.githubusercontent.com/u/6027401?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pleonova", "html_url": "https://github.com/pleonova", "followers_url": "https://api.github.com/users/pleonova/followers", "following_url": "https://api.github.com/users/pleonova/following{/other_user}", "gists_url": "https://api.github.com/users/pleonova/gists{/gist_id}", "starred_url": "https://api.github.com/users/pleonova/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pleonova/subscriptions", "organizations_url": "https://api.github.com/users/pleonova/orgs", "repos_url": "https://api.github.com/users/pleonova/repos", "events_url": "https://api.github.com/users/pleonova/events{/privacy}", "received_events_url": "https://api.github.com/users/pleonova/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-08-11T22:29:17Z", "updated_at": "2022-08-16T21:24:09Z", "closed_at": "2022-08-16T21:24:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "In this tutorial: [Tutorial 5: Document Embeddings](https://github.com/flairNLP/flair/blob/master/resources/docs/TUTORIAL_5_DOCUMENT_EMBEDDINGS.md#tutorial-5-document-embeddings), the following is missing\r\n`from flair.data import Sentence`", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2901/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2901/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2900", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2900/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2900/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2900/events", "html_url": "https://github.com/flairNLP/flair/issues/2900", "id": 1335521910, "node_id": "I_kwDOCCkmXM5PmnJ2", "number": 2900, "title": "not able to use glove embeddings in the sequence tagger after the last pr", "user": {"login": "sujaymad", "id": 110400599, "node_id": "U_kgDOBpSUVw", "avatar_url": "https://avatars.githubusercontent.com/u/110400599?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sujaymad", "html_url": "https://github.com/sujaymad", "followers_url": "https://api.github.com/users/sujaymad/followers", "following_url": "https://api.github.com/users/sujaymad/following{/other_user}", "gists_url": "https://api.github.com/users/sujaymad/gists{/gist_id}", "starred_url": "https://api.github.com/users/sujaymad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sujaymad/subscriptions", "organizations_url": "https://api.github.com/users/sujaymad/orgs", "repos_url": "https://api.github.com/users/sujaymad/repos", "events_url": "https://api.github.com/users/sujaymad/events{/privacy}", "received_events_url": "https://api.github.com/users/sujaymad/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-08-11T06:23:04Z", "updated_at": "2023-01-07T13:48:21Z", "closed_at": "2023-01-07T13:48:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nA clear and concise description of what the bug is.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior (e.g. which model did you train? what parameters did you use? etc.).\r\n\r\n**Expected behavior**\r\nA clear and concise description of what you expected to happen.\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]:\r\n - Version [e.g. flair-0.3.2]:\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2900/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2900/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2899", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2899/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2899/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2899/events", "html_url": "https://github.com/flairNLP/flair/issues/2899", "id": 1334236312, "node_id": "I_kwDOCCkmXM5PhtSY", "number": 2899, "title": "ValueError: Connection error, and we cannot find the requested files in the cached path. Please try again or make sure your Internet connection is on.", "user": {"login": "pli29-ctrip", "id": 110014849, "node_id": "U_kgDOBo6xgQ", "avatar_url": "https://avatars.githubusercontent.com/u/110014849?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pli29-ctrip", "html_url": "https://github.com/pli29-ctrip", "followers_url": "https://api.github.com/users/pli29-ctrip/followers", "following_url": "https://api.github.com/users/pli29-ctrip/following{/other_user}", "gists_url": "https://api.github.com/users/pli29-ctrip/gists{/gist_id}", "starred_url": "https://api.github.com/users/pli29-ctrip/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pli29-ctrip/subscriptions", "organizations_url": "https://api.github.com/users/pli29-ctrip/orgs", "repos_url": "https://api.github.com/users/pli29-ctrip/repos", "events_url": "https://api.github.com/users/pli29-ctrip/events{/privacy}", "received_events_url": "https://api.github.com/users/pli29-ctrip/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-08-10T08:03:25Z", "updated_at": "2023-01-07T13:48:18Z", "closed_at": "2023-01-07T13:48:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n`from hyperopt import hp\r\nfrom flair.hyperparameter.param_selection import SearchSpace, Parameter\r\n\r\nsearch_space = SearchSpace()\r\n\r\n# define training hyperparameters\r\nsearch_space.add(Parameter.EMBEDDINGS, hp.choice, options=[document_embeddings])\r\nsearch_space.add(Parameter.LEARNING_RATE, hp.choice, options=[0.01, 0.05, 0.1, 0.15, 0.2])\r\nsearch_space.add(Parameter.MINI_BATCH_SIZE, hp.choice, options=[8, 16, 32, 64, 128, 256])\r\n\r\n# define transformer embedding hyperparameters\r\n# search_space.add(Parameter.TRANSFORMER_MODEL, hp.choice, options=['gru', `'lstm'])``\r\n`from flair.hyperparameter.param_selection import TextClassifierParamSelector, OptimizationValue\r\n\r\n# what label do we want to predict?\r\nlabel_type = 'nation'\r\n\r\n# create the parameter selector\r\nparam_selector = TextClassifierParamSelector(\r\n    corpus,\r\n    label_type,\r\n    False,\r\n    'resources/result',\r\n    max_epochs=50,\r\n    fine_tune=True,\r\n    training_runs=3,\r\n    optimization_value=OptimizationValue.DEV_SCORE\r\n)\r\n\r\n# start the optimization\r\nparam_selector.optimize(search_space, max_evals=100)`\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2899/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2899/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2894", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2894/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2894/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2894/events", "html_url": "https://github.com/flairNLP/flair/issues/2894", "id": 1330979975, "node_id": "I_kwDOCCkmXM5PVSSH", "number": 2894, "title": "Conll_03 Corpus", "user": {"login": "taghreed34", "id": 45762603, "node_id": "MDQ6VXNlcjQ1NzYyNjAz", "avatar_url": "https://avatars.githubusercontent.com/u/45762603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/taghreed34", "html_url": "https://github.com/taghreed34", "followers_url": "https://api.github.com/users/taghreed34/followers", "following_url": "https://api.github.com/users/taghreed34/following{/other_user}", "gists_url": "https://api.github.com/users/taghreed34/gists{/gist_id}", "starred_url": "https://api.github.com/users/taghreed34/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/taghreed34/subscriptions", "organizations_url": "https://api.github.com/users/taghreed34/orgs", "repos_url": "https://api.github.com/users/taghreed34/repos", "events_url": "https://api.github.com/users/taghreed34/events{/privacy}", "received_events_url": "https://api.github.com/users/taghreed34/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-08-07T10:49:09Z", "updated_at": "2022-09-06T05:48:42Z", "closed_at": "2022-08-07T11:29:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "When I try to create an instance of Conll_03 corpus the following error shows up:\r\n\r\nNo such file or directory: '/root/.flair/datasets/conll_03'", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2894/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2894/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2886", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2886/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2886/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2886/events", "html_url": "https://github.com/flairNLP/flair/issues/2886", "id": 1329247415, "node_id": "I_kwDOCCkmXM5POrS3", "number": 2886, "title": "Error resuming training of a NER model", "user": {"login": "fmafelipe", "id": 50722626, "node_id": "MDQ6VXNlcjUwNzIyNjI2", "avatar_url": "https://avatars.githubusercontent.com/u/50722626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fmafelipe", "html_url": "https://github.com/fmafelipe", "followers_url": "https://api.github.com/users/fmafelipe/followers", "following_url": "https://api.github.com/users/fmafelipe/following{/other_user}", "gists_url": "https://api.github.com/users/fmafelipe/gists{/gist_id}", "starred_url": "https://api.github.com/users/fmafelipe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fmafelipe/subscriptions", "organizations_url": "https://api.github.com/users/fmafelipe/orgs", "repos_url": "https://api.github.com/users/fmafelipe/repos", "events_url": "https://api.github.com/users/fmafelipe/events{/privacy}", "received_events_url": "https://api.github.com/users/fmafelipe/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2022-08-04T22:50:43Z", "updated_at": "2023-01-07T13:48:20Z", "closed_at": "2023-01-07T13:48:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "I want to resume training a NER model as shown in the tutorials, loading the model checkpoint but running it with :\r\n\r\n`trainer.resume(trained_model,\r\n               base_path=path + '-resume',\r\n               max_epochs=25,\r\n               )`\r\n\r\nIt simply shows me the metrics of the loaded model and does not perform any training.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2886/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2886/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2879", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2879/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2879/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2879/events", "html_url": "https://github.com/flairNLP/flair/issues/2879", "id": 1323550127, "node_id": "I_kwDOCCkmXM5O48Wv", "number": 2879, "title": "Tagger complains - some input tokens are not in the dictionary (despite add_unk=True)  - Still a problem", "user": {"login": "None-Such", "id": 4958599, "node_id": "MDQ6VXNlcjQ5NTg1OTk=", "avatar_url": "https://avatars.githubusercontent.com/u/4958599?v=4", "gravatar_id": "", "url": "https://api.github.com/users/None-Such", "html_url": "https://github.com/None-Such", "followers_url": "https://api.github.com/users/None-Such/followers", "following_url": "https://api.github.com/users/None-Such/following{/other_user}", "gists_url": "https://api.github.com/users/None-Such/gists{/gist_id}", "starred_url": "https://api.github.com/users/None-Such/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/None-Such/subscriptions", "organizations_url": "https://api.github.com/users/None-Such/orgs", "repos_url": "https://api.github.com/users/None-Such/repos", "events_url": "https://api.github.com/users/None-Such/events{/privacy}", "received_events_url": "https://api.github.com/users/None-Such/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-07-31T19:12:14Z", "updated_at": "2023-01-07T13:48:10Z", "closed_at": "2023-01-07T13:48:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "As per **#2407** (https://github.com/flairNLP/flair/issues/2407) the Tagger complains that some input tokens are not in the dictionary (despite add_unk=True).\r\n\r\nThis can easily be recreated by having a tag exist in your Dev or Test set that does NOT exist in your Training set. Which will raise the same error with no indication of what the real problem is.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2879/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2879/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2860", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2860/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2860/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2860/events", "html_url": "https://github.com/flairNLP/flair/issues/2860", "id": 1303230853, "node_id": "I_kwDOCCkmXM5NrbmF", "number": 2860, "title": "Dependency package conllu version issue", "user": {"login": "lilsgit", "id": 48336265, "node_id": "MDQ6VXNlcjQ4MzM2MjY1", "avatar_url": "https://avatars.githubusercontent.com/u/48336265?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lilsgit", "html_url": "https://github.com/lilsgit", "followers_url": "https://api.github.com/users/lilsgit/followers", "following_url": "https://api.github.com/users/lilsgit/following{/other_user}", "gists_url": "https://api.github.com/users/lilsgit/gists{/gist_id}", "starred_url": "https://api.github.com/users/lilsgit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lilsgit/subscriptions", "organizations_url": "https://api.github.com/users/lilsgit/orgs", "repos_url": "https://api.github.com/users/lilsgit/repos", "events_url": "https://api.github.com/users/lilsgit/events{/privacy}", "received_events_url": "https://api.github.com/users/lilsgit/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-07-13T10:24:33Z", "updated_at": "2022-11-23T06:58:07Z", "closed_at": "2022-11-23T06:58:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "We were using Flair in our corn job pipeline for the sentiment. Yesterday the pipeline just broke, I checked and the error shows, \r\n\r\n`conllu.TokenList:\r\nAttributeError: module 'conllu' has no attribute 'TokenList'\r\n`\r\n\r\nIt turns out conllu package version just got updated yesterday to 4.4.3 which has compatibility issue with Flair...\r\n\r\nI rolled conllu version back to 4.4.2 for now and it's all working fine.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2860/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2860/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2859", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2859/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2859/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2859/events", "html_url": "https://github.com/flairNLP/flair/issues/2859", "id": 1302444357, "node_id": "I_kwDOCCkmXM5NoblF", "number": 2859, "title": "module 'conllu' has no attribute TokenList", "user": {"login": "yash-rathore", "id": 63536277, "node_id": "MDQ6VXNlcjYzNTM2Mjc3", "avatar_url": "https://avatars.githubusercontent.com/u/63536277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yash-rathore", "html_url": "https://github.com/yash-rathore", "followers_url": "https://api.github.com/users/yash-rathore/followers", "following_url": "https://api.github.com/users/yash-rathore/following{/other_user}", "gists_url": "https://api.github.com/users/yash-rathore/gists{/gist_id}", "starred_url": "https://api.github.com/users/yash-rathore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yash-rathore/subscriptions", "organizations_url": "https://api.github.com/users/yash-rathore/orgs", "repos_url": "https://api.github.com/users/yash-rathore/repos", "events_url": "https://api.github.com/users/yash-rathore/events{/privacy}", "received_events_url": "https://api.github.com/users/yash-rathore/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2022-07-12T18:03:37Z", "updated_at": "2022-11-14T15:03:52Z", "closed_at": "2022-11-14T15:03:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n![image](https://user-images.githubusercontent.com/63536277/178562229-5b6595c0-218b-4db9-978b-fafbfd1508ed.png)\r\n\r\nThis did not happen till today . I have been using this basic code for 6 months and this bug is new and did not appear anytime before today. \r\nPlease resolve quickly", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2859/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2859/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2848", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2848/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2848/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2848/events", "html_url": "https://github.com/flairNLP/flair/issues/2848", "id": 1289750158, "node_id": "I_kwDOCCkmXM5M4AaO", "number": 2848, "title": "ModelTrainer fails when training with tensorboard option", "user": {"login": "GuiGel", "id": 44615205, "node_id": "MDQ6VXNlcjQ0NjE1MjA1", "avatar_url": "https://avatars.githubusercontent.com/u/44615205?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuiGel", "html_url": "https://github.com/GuiGel", "followers_url": "https://api.github.com/users/GuiGel/followers", "following_url": "https://api.github.com/users/GuiGel/following{/other_user}", "gists_url": "https://api.github.com/users/GuiGel/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuiGel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuiGel/subscriptions", "organizations_url": "https://api.github.com/users/GuiGel/orgs", "repos_url": "https://api.github.com/users/GuiGel/repos", "events_url": "https://api.github.com/users/GuiGel/events{/privacy}", "received_events_url": "https://api.github.com/users/GuiGel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-06-30T08:00:39Z", "updated_at": "2022-11-13T08:45:58Z", "closed_at": "2022-11-13T08:45:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n\r\n`ModelTrainer.train` method fails with error ```UnboundLocalError: local variable 'train_part_eval_result' referenced before assignment``` when used with tensorboard.\r\n\r\nThis error is simply due to a forgotten tab in the `flair.trainers.trainer` module line 614 and can be easily corrected.\r\n\r\n**To Reproduce**\r\n\r\n```python\r\nfrom pathlib import Path\r\n\r\nfrom flair.datasets import CONLL_03\r\nfrom flair.embeddings import WordEmbeddings, FlairEmbeddings, StackedEmbeddings\r\nfrom flair.models import SequenceTagger\r\nfrom flair.trainers import ModelTrainer\r\n\r\n# 1. get the corpus\r\ncorpus = CONLL_03()\r\ncorpus.downsample(0.05)\r\nprint(corpus)\r\n\r\n# 2. what label do we want to predict?\r\nlabel_type = 'ner'\r\n\r\n# 3. make the label dictionary from the corpus\r\nlabel_dict = corpus.make_label_dictionary(label_type=label_type)\r\nprint(label_dict)\r\n\r\n# 4. initialize embedding stack with Flair and GloVe\r\nembedding_types = [\r\n    FlairEmbeddings('news-forward'),\r\n    FlairEmbeddings('news-backward'),\r\n]\r\n\r\nembeddings = StackedEmbeddings(embeddings=embedding_types)\r\n\r\n# 5. initialize sequence tagger\r\ntagger = SequenceTagger(hidden_size=256,\r\n                        embeddings=embeddings,\r\n                        tag_dictionary=label_dict,\r\n                        tag_type=label_type,\r\n                        use_crf=True)\r\n\r\n# 6. initialize trainer\r\ntrainer = ModelTrainer(tagger, corpus)\r\n\r\n# 7. start training\r\ntrainer.train(\r\n    Path(__file__).parent / \"bug\",\r\n    learning_rate=0.1,\r\n    mini_batch_size=32,\r\n    max_epochs=150,\r\n    use_tensorboard=True,\r\n    tensorboard_log_dir=Path(__file__).parent / \"bug\",\r\n    metrics_for_tensorboard=[(\"macro avg\", 'f1-score')],\r\n)\r\n```\r\n\r\n**Expected behavior**\r\n\r\nNo error appears.\r\n\r\n**Screenshots**\r\n\r\n```console\r\n$ python experiments/bug.py\r\n2022-06-30 09:41:49,513 Reading data from /path/to/datasets/conll_03\r\n2022-06-30 09:41:49,514 Train: /path/to/datasets/conll_03/train.txt\r\n2022-06-30 09:41:49,514 Dev: /path/to/datasets/conll_03/dev.txt\r\n2022-06-30 09:41:49,514 Test: /path/to/datasets/conll_03/test.txt\r\nCorpus: 749 train + 173 dev + 184 test sentences\r\n2022-06-30 09:41:57,585 Computing label dictionary. Progress:\r\n749it [00:00, 43064.79it/s]\r\n2022-06-30 09:41:57,604 Dictionary created for label 'ner' with 5 values: LOC (seen 334 times), ORG (seen 301 times), PER (seen 277 times), MISC (seen 182 times)\r\nDictionary with 5 tags: <unk>, LOC, ORG, PER, MISC\r\n2022-06-30 09:41:59,732 SequenceTagger predicts: Dictionary with 17 tags: O, S-LOC, B-LOC, E-LOC, I-LOC, S-ORG, B-ORG, E-ORG, I-ORG, S-PER, B-PER, E-PER, I-PER, S-MISC, B-MISC, E-MISC, I-MISC\r\n2022-06-30 09:41:59,981 tensorboard logging path is experiments/bug\r\n2022-06-30 09:41:59,982 ----------------------------------------------------------------------------------------------------\r\n2022-06-30 09:41:59,982 Model: \"SequenceTagger(\r\n  (embeddings): StackedEmbeddings(\r\n    (list_embedding_0): FlairEmbeddings(\r\n      (lm): LanguageModel(\r\n        (drop): Dropout(p=0.05, inplace=False)\r\n        (encoder): Embedding(300, 100)\r\n        (rnn): LSTM(100, 2048)\r\n        (decoder): Linear(in_features=2048, out_features=300, bias=True)\r\n      )\r\n    )\r\n    (list_embedding_1): FlairEmbeddings(\r\n      (lm): LanguageModel(\r\n        (drop): Dropout(p=0.05, inplace=False)\r\n        (encoder): Embedding(300, 100)\r\n        (rnn): LSTM(100, 2048)\r\n        (decoder): Linear(in_features=2048, out_features=300, bias=True)\r\n      )\r\n    )\r\n  )\r\n  (word_dropout): WordDropout(p=0.05)\r\n  (locked_dropout): LockedDropout(p=0.5)\r\n  (embedding2nn): Linear(in_features=4096, out_features=4096, bias=True)\r\n  (rnn): LSTM(4096, 256, batch_first=True, bidirectional=True)\r\n  (linear): Linear(in_features=512, out_features=19, bias=True)\r\n  (loss_function): ViterbiLoss()\r\n  (crf): CRF()\r\n)\"\r\n2022-06-30 09:41:59,983 ----------------------------------------------------------------------------------------------------\r\n2022-06-30 09:41:59,983 Corpus: \"Corpus: 749 train + 173 dev + 184 test sentences\"\r\n2022-06-30 09:41:59,983 ----------------------------------------------------------------------------------------------------\r\n2022-06-30 09:41:59,983 Parameters:\r\n2022-06-30 09:41:59,983  - learning_rate: \"0.100000\"\r\n2022-06-30 09:41:59,983  - mini_batch_size: \"32\"\r\n2022-06-30 09:41:59,983  - patience: \"3\"\r\n2022-06-30 09:41:59,983  - anneal_factor: \"0.5\"\r\n2022-06-30 09:41:59,983  - max_epochs: \"150\"\r\n2022-06-30 09:41:59,983  - shuffle: \"True\"\r\n2022-06-30 09:41:59,983  - train_with_dev: \"False\"\r\n2022-06-30 09:41:59,983  - batch_growth_annealing: \"False\"\r\n2022-06-30 09:41:59,983 ----------------------------------------------------------------------------------------------------\r\n2022-06-30 09:41:59,983 Model training base path: \"experiments/bug\"\r\n2022-06-30 09:41:59,984 ----------------------------------------------------------------------------------------------------\r\n2022-06-30 09:41:59,984 Device: cuda:0\r\n2022-06-30 09:41:59,984 ----------------------------------------------------------------------------------------------------\r\n2022-06-30 09:41:59,984 Embeddings storage mode: cpu\r\n2022-06-30 09:41:59,984 ----------------------------------------------------------------------------------------------------\r\n2022-06-30 09:42:00,560 epoch 1 - iter 2/24 - loss 4.06095307 - samples/sec: 111.28 - lr: 0.100000\r\n2022-06-30 09:42:01,133 epoch 1 - iter 4/24 - loss 3.38150115 - samples/sec: 111.65 - lr: 0.100000\r\n2022-06-30 09:42:01,717 epoch 1 - iter 6/24 - loss 2.64457018 - samples/sec: 109.78 - lr: 0.100000\r\n2022-06-30 09:42:02,213 epoch 1 - iter 8/24 - loss 2.29768349 - samples/sec: 128.95 - lr: 0.100000\r\n2022-06-30 09:42:02,580 epoch 1 - iter 10/24 - loss 2.02568397 - samples/sec: 174.88 - lr: 0.100000\r\n2022-06-30 09:42:03,167 epoch 1 - iter 12/24 - loss 1.79615879 - samples/sec: 109.02 - lr: 0.100000\r\n2022-06-30 09:42:03,745 epoch 1 - iter 14/24 - loss 1.62863061 - samples/sec: 110.84 - lr: 0.100000\r\n2022-06-30 09:42:04,381 epoch 1 - iter 16/24 - loss 1.46143820 - samples/sec: 100.69 - lr: 0.100000\r\n2022-06-30 09:42:04,896 epoch 1 - iter 18/24 - loss 1.37829819 - samples/sec: 124.43 - lr: 0.100000\r\n2022-06-30 09:42:05,578 epoch 1 - iter 20/24 - loss 1.24339454 - samples/sec: 93.86 - lr: 0.100000\r\n2022-06-30 09:42:06,198 epoch 1 - iter 22/24 - loss 1.17003827 - samples/sec: 103.35 - lr: 0.100000\r\n2022-06-30 09:42:06,849 epoch 1 - iter 24/24 - loss 1.12595830 - samples/sec: 98.26 - lr: 0.100000\r\n2022-06-30 09:42:06,850 ----------------------------------------------------------------------------------------------------\r\n2022-06-30 09:42:06,850 EPOCH 1 done: loss 1.1260 - lr 0.100000\r\nTraceback (most recent call last):\r\n  File \"experiments/bug.py\", line 39, in <module>\r\n    trainer.train(\r\n  File \"/path/to/project/.venv/lib/python3.8/site-packages/flair/trainers/trainer.py\", line 618, in train\r\n    train_part_eval_result.classification_report[metric_class_avg_type][metric_type],\r\nUnboundLocalError: local variable 'train_part_eval_result' referenced before assignment\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Linux\r\n - Version :Flair 0.11.3", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2848/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2848/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2830", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2830/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2830/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2830/events", "html_url": "https://github.com/flairNLP/flair/issues/2830", "id": 1279866625, "node_id": "I_kwDOCCkmXM5MSTcB", "number": 2830, "title": "Can't export ner-large to pth", "user": {"login": "ledniy", "id": 1562848, "node_id": "MDQ6VXNlcjE1NjI4NDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1562848?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ledniy", "html_url": "https://github.com/ledniy", "followers_url": "https://api.github.com/users/ledniy/followers", "following_url": "https://api.github.com/users/ledniy/following{/other_user}", "gists_url": "https://api.github.com/users/ledniy/gists{/gist_id}", "starred_url": "https://api.github.com/users/ledniy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ledniy/subscriptions", "organizations_url": "https://api.github.com/users/ledniy/orgs", "repos_url": "https://api.github.com/users/ledniy/repos", "events_url": "https://api.github.com/users/ledniy/events{/privacy}", "received_events_url": "https://api.github.com/users/ledniy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-06-22T09:43:58Z", "updated_at": "2022-11-01T15:04:43Z", "closed_at": "2022-11-01T15:04:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nCan't export `ner-large` model to pth, getting small file (19mb), but when I'm doing the same with `ner` model I'm getting 400+ mb pth file\r\n\r\n**To Reproduce**\r\n```\r\nfrom flair.models import SequenceTagger\r\nimport torch\r\n\r\n# Will download the model with pre-trained weights\r\nmodel = SequenceTagger.load('ner-large')\r\n\r\n# Saving the model to disk\r\ntorch.save(model, \"flair_model_large.pth\")\r\n```\r\n\r\n**Expected behavior**\r\npth file with size ~2gb\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Amazon Linux , ml.c4.4xlarge\r\n - Version: flair-0.11.3\r\n\r\n**Additional context**\r\nI'm doing it for deploying the model to SageMaker, I wasn't able to find an up-to-date guide, so mb there are some other options to do it?\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2830/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2830/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2826", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2826/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2826/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2826/events", "html_url": "https://github.com/flairNLP/flair/issues/2826", "id": 1276651117, "node_id": "I_kwDOCCkmXM5MGCZt", "number": 2826, "title": "TypeError: object of type 'Token' has no len()", "user": {"login": "Ihebzayen", "id": 88541984, "node_id": "MDQ6VXNlcjg4NTQxOTg0", "avatar_url": "https://avatars.githubusercontent.com/u/88541984?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ihebzayen", "html_url": "https://github.com/Ihebzayen", "followers_url": "https://api.github.com/users/Ihebzayen/followers", "following_url": "https://api.github.com/users/Ihebzayen/following{/other_user}", "gists_url": "https://api.github.com/users/Ihebzayen/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ihebzayen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ihebzayen/subscriptions", "organizations_url": "https://api.github.com/users/Ihebzayen/orgs", "repos_url": "https://api.github.com/users/Ihebzayen/repos", "events_url": "https://api.github.com/users/Ihebzayen/events{/privacy}", "received_events_url": "https://api.github.com/users/Ihebzayen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 13, "created_at": "2022-06-20T09:40:02Z", "updated_at": "2023-03-29T12:52:21Z", "closed_at": "2022-06-21T12:31:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\n\r\n2022-06-20 09:29:33,975 Reading data from input_data\r\n2022-06-20 09:29:33,975 Train: input_data/train.txt\r\n2022-06-20 09:29:33,975 Dev: input_data/valid.txt\r\n2022-06-20 09:29:33,975 Test: input_data/test.txt\r\n2022-06-20 09:29:45,152 Computing label dictionary. Progress:\r\n14987it [00:00, 20715.78it/s]\r\n2022-06-20 09:29:45,877 Dictionary created for label 'ner' with 21 values: I-NP (seen 66645 times), B-NP (seen 57387 times), B-PP (seen 18843 times), B-VP (seen 18047 times), I-VP (seen 8818 times), B-ADVP (seen 2637 times), B-SBAR (seen 1269 times), B-ADJP (seen 1165 times), -X- (seen 946 times), B-PRT (seen 527 times), I-ADJP (seen 211 times), I-ADVP (seen 138 times), I-PP (seen 103 times), B-INTJ (seen 59 times), I-CONJP (seen 39 times), B-LST (seen 32 times), B-CONJP (seen 31 times), I-SBAR (seen 19 times), I-LST (seen 4 times), I-INTJ (seen 1 times)\r\n2022-06-20 09:29:47,038 https://flair.informatik.hu-berlin.de/resources/embeddings/token/glove.gensim.vectors.npy not found in cache, downloading to /tmp/tmpoa5zhn91\r\n100% 160000128/160000128 [00:18<00:00, 8862868.93B/s]\r\n2022-06-20 09:30:05,919 copying /tmp/tmpoa5zhn91 to cache at /root/.flair/embeddings/glove.gensim.vectors.npy\r\n2022-06-20 09:30:06,267 removing temp file /tmp/tmpoa5zhn91\r\n2022-06-20 09:30:07,115 https://flair.informatik.hu-berlin.de/resources/embeddings/token/glove.gensim not found in cache, downloading to /tmp/tmp0niqrwy0\r\n100% 21494764/21494764 [00:04<00:00, 5228142.84B/s]\r\n\r\n\r\n\r\n\r\n\r\n2022-06-20 09:30:12,086 copying /tmp/tmp0niqrwy0 to cache at /root/.flair/embeddings/glove.gensim\r\n2022-06-20 09:30:12,112 removing temp file /tmp/tmp0niqrwy0\r\n2022-06-20 09:30:16,237 https://flair.informatik.hu-berlin.de/resources/embeddings/flair/news-forward-0.4.1.pt not found in cache, downloading to /tmp/tmprrm89brb\r\n100% 73034624/73034624 [00:08<00:00, 8139073.33B/s] \r\n2022-06-20 09:30:26,037 copying /tmp/tmprrm89brb to cache at /root/.flair/embeddings/news-forward-0.4.1.pt\r\n2022-06-20 09:30:26,150 removing temp file /tmp/tmprrm89brb\r\n2022-06-20 09:30:27,858 https://flair.informatik.hu-berlin.de/resources/embeddings/flair/news-backward-0.4.1.pt not found in cache, downloading to /tmp/tmpil1w_c93\r\n100% 73034575/73034575 [00:08<00:00, 8283917.66B/s] \r\n2022-06-20 09:30:37,530 copying /tmp/tmpil1w_c93 to cache at /root/.flair/embeddings/news-backward-0.4.1.pt\r\n2022-06-20 09:30:37,663 removing temp file /tmp/tmpil1w_c93\r\n2022-06-20 09:30:37,940 SequenceTagger predicts: Dictionary with 21 tags: <unk>, I-NP, B-NP, B-PP, B-VP, I-VP, B-ADVP, B-SBAR, B-ADJP, -X-, B-PRT, I-ADJP, I-ADVP, I-PP, B-INTJ, I-CONJP, B-LST, B-CONJP, I-SBAR, I-LST, I-INTJ\r\n2022-06-20 09:30:38,153 ----------------------------------------------------------------------------------------------------\r\n2022-06-20 09:30:38,154 Model: \"SequenceTagger(\r\n  (embeddings): StackedEmbeddings(\r\n    (list_embedding_0): WordEmbeddings(\r\n      'glove'\r\n      (embedding): Embedding(400001, 100)\r\n    )\r\n    (list_embedding_1): FlairEmbeddings(\r\n      (lm): LanguageModel(\r\n        (drop): Dropout(p=0.05, inplace=False)\r\n        (encoder): Embedding(300, 100)\r\n        (rnn): LSTM(100, 2048)\r\n        (decoder): Linear(in_features=2048, out_features=300, bias=True)\r\n      )\r\n    )\r\n    (list_embedding_2): FlairEmbeddings(\r\n      (lm): LanguageModel(\r\n        (drop): Dropout(p=0.05, inplace=False)\r\n        (encoder): Embedding(300, 100)\r\n        (rnn): LSTM(100, 2048)\r\n        (decoder): Linear(in_features=2048, out_features=300, bias=True)\r\n      )\r\n    )\r\n  )\r\n  (word_dropout): WordDropout(p=0.05)\r\n  (locked_dropout): LockedDropout(p=0.5)\r\n  (embedding2nn): Linear(in_features=4196, out_features=4196, bias=True)\r\n  (rnn): LSTM(4196, 256, batch_first=True, bidirectional=True)\r\n  (linear): Linear(in_features=512, out_features=23, bias=True)\r\n  (loss_function): ViterbiLoss()\r\n  (crf): CRF()\r\n)\"\r\n2022-06-20 09:30:38,154 ----------------------------------------------------------------------------------------------------\r\n2022-06-20 09:30:38,154 Corpus: \"Corpus: 14987 train + 3466 dev + 3684 test sentences\"\r\n2022-06-20 09:30:38,155 ----------------------------------------------------------------------------------------------------\r\n2022-06-20 09:30:38,155 Parameters:\r\n2022-06-20 09:30:38,155  - learning_rate: \"0.010000\"\r\n2022-06-20 09:30:38,155  - mini_batch_size: \"64\"\r\n2022-06-20 09:30:38,155  - patience: \"3\"\r\n2022-06-20 09:30:38,156  - anneal_factor: \"0.5\"\r\n2022-06-20 09:30:38,156  - max_epochs: \"150\"\r\n2022-06-20 09:30:38,156  - shuffle: \"True\"\r\n2022-06-20 09:30:38,156  - train_with_dev: \"False\"\r\n2022-06-20 09:30:38,156  - batch_growth_annealing: \"False\"\r\n2022-06-20 09:30:38,157 ----------------------------------------------------------------------------------------------------\r\n2022-06-20 09:30:38,157 Model training base path: \"output_folder\"\r\n2022-06-20 09:30:38,157 ----------------------------------------------------------------------------------------------------\r\n2022-06-20 09:30:38,157 Device: cpu\r\n2022-06-20 09:30:38,157 ----------------------------------------------------------------------------------------------------\r\n2022-06-20 09:30:38,158 Embeddings storage mode: cpu\r\n2022-06-20 09:30:38,158 ----------------------------------------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"flair_train.py\", line 67, in <module>\r\n    max_epochs=150)\r\n  File \"/usr/local/lib/python3.7/dist-packages/flair/trainers/trainer.py\", line 500, in train\r\n    loss = self.model.forward_loss(batch_step)\r\n  File \"/usr/local/lib/python3.7/dist-packages/flair/models/sequence_tagger_model.py\", line 270, in forward_loss\r\n    scores, gold_labels = self.forward(sentences)  # type: ignore\r\n  File \"/usr/local/lib/python3.7/dist-packages/flair/models/sequence_tagger_model.py\", line 326, in forward\r\n    gold_labels = self._get_gold_labels(sentences)\r\n  File \"/usr/local/lib/python3.7/dist-packages/flair/models/sequence_tagger_model.py\", line 402, in _get_gold_labels\r\n    if len(span) == 1:\r\nTypeError: object of type 'Token' has no len()\r\n\r\n\r\nhello guys, when i tried to train my model on conll2003 i faced this problem. can anyone help me.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2826/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2826/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2824", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2824/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2824/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2824/events", "html_url": "https://github.com/flairNLP/flair/issues/2824", "id": 1276089595, "node_id": "I_kwDOCCkmXM5MD5T7", "number": 2824, "title": "Slow inference using TARSClassifier base model on GPU", "user": {"login": "akshaykekuda", "id": 22128902, "node_id": "MDQ6VXNlcjIyMTI4OTAy", "avatar_url": "https://avatars.githubusercontent.com/u/22128902?v=4", "gravatar_id": "", "url": "https://api.github.com/users/akshaykekuda", "html_url": "https://github.com/akshaykekuda", "followers_url": "https://api.github.com/users/akshaykekuda/followers", "following_url": "https://api.github.com/users/akshaykekuda/following{/other_user}", "gists_url": "https://api.github.com/users/akshaykekuda/gists{/gist_id}", "starred_url": "https://api.github.com/users/akshaykekuda/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akshaykekuda/subscriptions", "organizations_url": "https://api.github.com/users/akshaykekuda/orgs", "repos_url": "https://api.github.com/users/akshaykekuda/repos", "events_url": "https://api.github.com/users/akshaykekuda/events{/privacy}", "received_events_url": "https://api.github.com/users/akshaykekuda/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-06-19T15:11:22Z", "updated_at": "2022-11-01T15:04:44Z", "closed_at": "2022-11-01T15:04:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "The inference time during evaluation using dev/test set is very slow. While training happens very fast as expected the evaluation time is too large for GPU. Running the same experiments using TransformerDocumentEmbeddings model results in the expected lightning training and inference speed using the same datasets(I understand that the embedding model is much smaller than that of tars base)\r\n\r\n**Screenshots**\r\nThe below image is for training and evaluation using TransformerDocumentEmbeddings:\r\n![image](https://user-images.githubusercontent.com/22128902/174487754-81445f1a-0842-4de3-8116-17ed953de3ba.png)\r\nThe below image is for training and evaluation using tars-base model:\r\n![image](https://user-images.githubusercontent.com/22128902/174487810-d8435a13-0adc-4837-8f22-d8e0534e7fbc.png)\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2824/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2824/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2803", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2803/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2803/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2803/events", "html_url": "https://github.com/flairNLP/flair/issues/2803", "id": 1263049106, "node_id": "I_kwDOCCkmXM5LSJmS", "number": 2803, "title": "Saving and copying of labeled data from a dataset raises error message.", "user": {"login": "ghontolux", "id": 87199298, "node_id": "MDQ6VXNlcjg3MTk5Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/87199298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ghontolux", "html_url": "https://github.com/ghontolux", "followers_url": "https://api.github.com/users/ghontolux/followers", "following_url": "https://api.github.com/users/ghontolux/following{/other_user}", "gists_url": "https://api.github.com/users/ghontolux/gists{/gist_id}", "starred_url": "https://api.github.com/users/ghontolux/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ghontolux/subscriptions", "organizations_url": "https://api.github.com/users/ghontolux/orgs", "repos_url": "https://api.github.com/users/ghontolux/repos", "events_url": "https://api.github.com/users/ghontolux/events{/privacy}", "received_events_url": "https://api.github.com/users/ghontolux/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-06-07T10:06:48Z", "updated_at": "2022-11-01T15:04:51Z", "closed_at": "2022-11-01T15:04:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI wanted to extend the `NER_GERMAN_LEGAL` dataset for knowledge distillation. But I was unable to store the data after loading from the flair datasets.\r\n\r\n**To Reproduce**\r\n\r\n```python\r\nimport pickle\r\nfrom flair.datasets import NER_GERMAN_LEGAL\r\n\r\ncorpus = NER_GERMAN_LEGAL()\r\n\r\ntrain_sents_orig_corp = []\r\nfor sent in corpus.train:\r\n    train_sents_orig_corp.append(sent)\r\n\r\nwith open(\"data/legal_entity_rec_labeled_54k.pickle\", \"wb\") as handle:\r\n    pickle.dump(train_sents_orig_corp, handle, protocol=pickle.HIGHEST_PROTOCOL)\r\n```\r\n\r\nGives the following error message:\r\n\r\n```\r\nRecursionError                            Traceback (most recent call last)\r\nInput In [4], in <cell line: 1>()\r\n      1 with open(\"data/legal_entity_rec_labeled_54k.pickle\", \"wb\") as handle:\r\n----> 2     pickle.dump(train_sents_orig_corp[-1], handle, protocol=pickle.HIGHEST_PROTOCOL)\r\n\r\nRecursionError: maximum recursion depth exceeded while pickling an object\r\n```\r\n\r\nThe error is raised also if the list contains only one element. When the list object is copied with `deepcopy` this error is raised too.\r\n\r\nTo avoid `RecursionError`s it is possible to set the max recursion depth up:\r\n\r\n```python\r\nimport sys\r\nprint(sys.getrecursionlimit())\r\nprint(sys.setrecursionlimit(SOME_HIGH_VALUE))\r\n```\r\n\r\nBut this does not work here \u2013 I set the limit from 3000 to 20000 with the same result. In contrast, creating new sentences, predict their label and saving the labeled sentences works well.\r\n\r\nI suspect there is some cyclic structure, but I could not find anything yet. \r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Ubuntu\r\n - Version [e.g. flair-0.3.2]: 0.10\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2803/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2803/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2802", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2802/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2802/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2802/events", "html_url": "https://github.com/flairNLP/flair/issues/2802", "id": 1262647140, "node_id": "I_kwDOCCkmXM5LQndk", "number": 2802, "title": "How to store TARSTagger NEr output to CSV file in Azure Databricks", "user": {"login": "SamtaBalpande2593", "id": 107016048, "node_id": "U_kgDOBmDvcA", "avatar_url": "https://avatars.githubusercontent.com/u/107016048?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SamtaBalpande2593", "html_url": "https://github.com/SamtaBalpande2593", "followers_url": "https://api.github.com/users/SamtaBalpande2593/followers", "following_url": "https://api.github.com/users/SamtaBalpande2593/following{/other_user}", "gists_url": "https://api.github.com/users/SamtaBalpande2593/gists{/gist_id}", "starred_url": "https://api.github.com/users/SamtaBalpande2593/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SamtaBalpande2593/subscriptions", "organizations_url": "https://api.github.com/users/SamtaBalpande2593/orgs", "repos_url": "https://api.github.com/users/SamtaBalpande2593/repos", "events_url": "https://api.github.com/users/SamtaBalpande2593/events{/privacy}", "received_events_url": "https://api.github.com/users/SamtaBalpande2593/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-06-07T02:41:16Z", "updated_at": "2022-11-01T15:04:51Z", "closed_at": "2022-11-01T15:04:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "How should I store TARSTagger entity output to csv file from Azure Databricks notebook", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2802/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2802/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2800", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2800/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2800/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2800/events", "html_url": "https://github.com/flairNLP/flair/issues/2800", "id": 1256850590, "node_id": "I_kwDOCCkmXM5K6gSe", "number": 2800, "title": "BIO format error", "user": {"login": "matirojasg", "id": 56651055, "node_id": "MDQ6VXNlcjU2NjUxMDU1", "avatar_url": "https://avatars.githubusercontent.com/u/56651055?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matirojasg", "html_url": "https://github.com/matirojasg", "followers_url": "https://api.github.com/users/matirojasg/followers", "following_url": "https://api.github.com/users/matirojasg/following{/other_user}", "gists_url": "https://api.github.com/users/matirojasg/gists{/gist_id}", "starred_url": "https://api.github.com/users/matirojasg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matirojasg/subscriptions", "organizations_url": "https://api.github.com/users/matirojasg/orgs", "repos_url": "https://api.github.com/users/matirojasg/repos", "events_url": "https://api.github.com/users/matirojasg/events{/privacy}", "received_events_url": "https://api.github.com/users/matirojasg/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-06-01T19:29:59Z", "updated_at": "2022-07-05T08:39:47Z", "closed_at": "2022-07-05T08:39:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, I noticed that when I run NER experiments, by default, in the sequence tagger, the following tag_format=\"BIOES\" format is used. However, my dataset follows the \"BIO\" format. \r\n\r\nWhen I set this option, I get the following error:\r\n\r\n```\r\n  File \"/home/x/livingner-subtask1/venv/lib/python3.8/site-packages/flair/models/sequence_tagger_model.py\", line 273, in forward_loss\r\n    return self._calculate_loss(scores, gold_labels)\r\n  File \"/home/x/livingner-subtask1/venv/lib/python3.8/site-packages/flair/models/sequence_tagger_model.py\", line 336, in _calculate_loss\r\n    [\r\n  File \"/home/x/livingner-subtask1/venv/lib/python3.8/site-packages/flair/models/sequence_tagger_model.py\", line 337, in <listcomp>\r\n    self.label_dictionary.get_idx_for_item(label[0])\r\n  File \"/home/x/livingner-subtask1/venv/lib/python3.8/site-packages/flair/data.py\", line 90, in get_idx_for_item\r\n    raise IndexError\r\nIndexError\r\n```\r\nWhen leaving that parameter by default, that error does not appear. Is the parameter working correctly with the BIO option? I checked my data, and I don't see any error", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2800/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2800/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2797", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2797/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2797/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2797/events", "html_url": "https://github.com/flairNLP/flair/issues/2797", "id": 1253642215, "node_id": "I_kwDOCCkmXM5KuQ_n", "number": 2797, "title": "TARSclassifier returning no label", "user": {"login": "rafaeloliveirabd", "id": 104515040, "node_id": "U_kgDOBjrF4A", "avatar_url": "https://avatars.githubusercontent.com/u/104515040?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rafaeloliveirabd", "html_url": "https://github.com/rafaeloliveirabd", "followers_url": "https://api.github.com/users/rafaeloliveirabd/followers", "following_url": "https://api.github.com/users/rafaeloliveirabd/following{/other_user}", "gists_url": "https://api.github.com/users/rafaeloliveirabd/gists{/gist_id}", "starred_url": "https://api.github.com/users/rafaeloliveirabd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rafaeloliveirabd/subscriptions", "organizations_url": "https://api.github.com/users/rafaeloliveirabd/orgs", "repos_url": "https://api.github.com/users/rafaeloliveirabd/repos", "events_url": "https://api.github.com/users/rafaeloliveirabd/events{/privacy}", "received_events_url": "https://api.github.com/users/rafaeloliveirabd/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-05-31T10:10:34Z", "updated_at": "2022-11-01T15:04:49Z", "closed_at": "2022-11-01T15:04:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI'm trying to make a predict_zero_shot in data with over 1000 rows and when I do `sentence.labels` it returns an empy list. I'm using the following labels `classes [\"positive\",\"neutral\",\"negative\"]\r\n\r\n\r\n**Expected behavior**\r\nIt should output at least one of the three labels above mentioned\r\n\r\nIn the code I just have an if statement that does try to overcome so that when the tags are empty the prediction made is simply labeled as \"empty\". \r\n\r\n```\r\n    for index in tqdm(range(0,len(data.index))):\r\n        sentence = Sentence(data.loc[index,cleanedCol])\r\n        analyzer.predict_zero_shot(sentence, classes)\r\n\r\n        if sentence.labels == []:\r\n            list_result.append(\"empty\")\r\n            sentence.tag\r\n        else:\r\n            list_result.append(sentence.tag)\r\n```\r\n\r\n\r\n**Screenshots**\r\n<img width=\"211\" alt=\"image\" src=\"https://user-images.githubusercontent.com/104515040/171149987-245d29ce-5e25-4c6e-a61d-46b5389c0868.png\">\r\n\r\n**Environment (please complete the following information):**\r\n - Windows\r\n - flair-0.11\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2797/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2797/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2791", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2791/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2791/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2791/events", "html_url": "https://github.com/flairNLP/flair/issues/2791", "id": 1248046418, "node_id": "I_kwDOCCkmXM5KY61S", "number": 2791, "title": "Train with flair==0.11 cause Tensor RuntimeError", "user": {"login": "asm-cygu", "id": 61332073, "node_id": "MDQ6VXNlcjYxMzMyMDcz", "avatar_url": "https://avatars.githubusercontent.com/u/61332073?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asm-cygu", "html_url": "https://github.com/asm-cygu", "followers_url": "https://api.github.com/users/asm-cygu/followers", "following_url": "https://api.github.com/users/asm-cygu/following{/other_user}", "gists_url": "https://api.github.com/users/asm-cygu/gists{/gist_id}", "starred_url": "https://api.github.com/users/asm-cygu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asm-cygu/subscriptions", "organizations_url": "https://api.github.com/users/asm-cygu/orgs", "repos_url": "https://api.github.com/users/asm-cygu/repos", "events_url": "https://api.github.com/users/asm-cygu/events{/privacy}", "received_events_url": "https://api.github.com/users/asm-cygu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-05-25T12:48:10Z", "updated_at": "2022-11-01T15:04:54Z", "closed_at": "2022-11-01T15:04:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello !\r\n\r\n**Describe the bug**\r\nI'm trying to reproduce experiments from \r\n- https://huggingface.co/flair/ner-english-ontonotes-large#training-script-to-train-this-model\r\n- https://github.com/flairNLP/flair/blob/master/resources/docs/EXPERIMENTS.md#ontonotes-named-entity-recognition-english\r\n\r\n**To Reproduce**\r\ndownload official archive from LDC, etc ... and launch the training script\r\n\r\n**Expected behavior**\r\nI expected than everythings running, and finally produce my model\r\n\r\n**Screenshots**\r\nbut I have...\r\nRuntimeError: The expanded size of the tensor (570) must match the existing size (514) at non-singleton dimension 1. \u200b\r\nTarget sizes: [4, 570]. Tensor sizes: [1, 514]\u200b\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Oracle Linux 7\r\n - Version [e.g. flair-0.3.2]: Flair == 0.11\r\n\r\n\r\nI can complete informations if needed", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2791/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2791/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2784", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2784/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2784/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2784/events", "html_url": "https://github.com/flairNLP/flair/issues/2784", "id": 1242250219, "node_id": "I_kwDOCCkmXM5KCzvr", "number": 2784, "title": "BIO tag format crashes with IndexError", "user": {"login": "cpalenmichel", "id": 25189540, "node_id": "MDQ6VXNlcjI1MTg5NTQw", "avatar_url": "https://avatars.githubusercontent.com/u/25189540?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cpalenmichel", "html_url": "https://github.com/cpalenmichel", "followers_url": "https://api.github.com/users/cpalenmichel/followers", "following_url": "https://api.github.com/users/cpalenmichel/following{/other_user}", "gists_url": "https://api.github.com/users/cpalenmichel/gists{/gist_id}", "starred_url": "https://api.github.com/users/cpalenmichel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cpalenmichel/subscriptions", "organizations_url": "https://api.github.com/users/cpalenmichel/orgs", "repos_url": "https://api.github.com/users/cpalenmichel/repos", "events_url": "https://api.github.com/users/cpalenmichel/events{/privacy}", "received_events_url": "https://api.github.com/users/cpalenmichel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2022-05-19T19:51:01Z", "updated_at": "2022-11-01T17:33:21Z", "closed_at": "2022-06-27T09:02:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nTraining an NER model with tag_format=\"BIO\" fails with `The string 'S-ORG' is not in dictionary! Dictionary contains only: ['O', 'B-DATE', 'I-DATE', 'B-LOC', 'I-LOC', 'B-ORG', 'I-ORG', 'B-PER', 'I-PER']` and an IndexError.\r\nIt looks like the issue comes from `_get_gold_labels` only converting to BIOES. \r\n\r\n**To Reproduce**\r\nI'm using conll03 English data and my tagger is setup as follows \r\n```\r\nembeddings = TransformerWordEmbeddings(\r\n                \"xlm-roberta-base\",\r\n                layers=\"-1\",\r\n                layer_mean=False,\r\n                fine_tune=True\r\n            )\r\ntagger: SequenceTagger = SequenceTagger(\r\n        embeddings=embeddings,\r\n        tag_dictionary=tag_dictionary,\r\n        tag_type=tag_type,\r\n        reproject_embeddings=True,\r\n        use_crf=False,\r\n        use_rnn=False,\r\n        word_dropout=0.0,\r\n        locked_dropout=0.0,\r\n        tag_format=\"BIO\"\r\n    )\r\n\r\n```\r\n\r\n**Expected behavior**\r\nI expect it to train a model using BIO tags without crashing.\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Linux 5.4.0-100-generic x86_64\r\n - Version [e.g. flair-0.3.2]: flair==0.11.2\r\n\r\n**Additional context**\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2784/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2784/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2783", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2783/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2783/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2783/events", "html_url": "https://github.com/flairNLP/flair/issues/2783", "id": 1241935158, "node_id": "I_kwDOCCkmXM5KBm02", "number": 2783, "title": "POS span returns empty list on Colab", "user": {"login": "PhilWicke", "id": 22796637, "node_id": "MDQ6VXNlcjIyNzk2NjM3", "avatar_url": "https://avatars.githubusercontent.com/u/22796637?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PhilWicke", "html_url": "https://github.com/PhilWicke", "followers_url": "https://api.github.com/users/PhilWicke/followers", "following_url": "https://api.github.com/users/PhilWicke/following{/other_user}", "gists_url": "https://api.github.com/users/PhilWicke/gists{/gist_id}", "starred_url": "https://api.github.com/users/PhilWicke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PhilWicke/subscriptions", "organizations_url": "https://api.github.com/users/PhilWicke/orgs", "repos_url": "https://api.github.com/users/PhilWicke/repos", "events_url": "https://api.github.com/users/PhilWicke/events{/privacy}", "received_events_url": "https://api.github.com/users/PhilWicke/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-05-19T15:11:33Z", "updated_at": "2022-05-19T16:40:03Z", "closed_at": "2022-05-19T16:40:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "Thank you for your dedicated work.\r\nI've been trying to run the POS example from [HuggingFace](https://huggingface.co/flair/pos-english) in a Google Colab. Yet, I cannot retrieve the spans for POS. I've tried various different things, but it always seems to return an empty list and I have used the exact same code as in your tutorial.\r\n\r\nI've set up a colab with my issue:\r\nhttps://colab.research.google.com/drive/1K1NvP8Qg6nM8mVmDr_vNZdE5fQ7aZGdj?usp=sharing\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2783/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2783/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2765", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2765/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2765/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2765/events", "html_url": "https://github.com/flairNLP/flair/issues/2765", "id": 1234908553, "node_id": "I_kwDOCCkmXM5JmzWJ", "number": 2765, "title": "Transformers Update", "user": {"login": "hmiche", "id": 63804608, "node_id": "MDQ6VXNlcjYzODA0NjA4", "avatar_url": "https://avatars.githubusercontent.com/u/63804608?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hmiche", "html_url": "https://github.com/hmiche", "followers_url": "https://api.github.com/users/hmiche/followers", "following_url": "https://api.github.com/users/hmiche/following{/other_user}", "gists_url": "https://api.github.com/users/hmiche/gists{/gist_id}", "starred_url": "https://api.github.com/users/hmiche/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hmiche/subscriptions", "organizations_url": "https://api.github.com/users/hmiche/orgs", "repos_url": "https://api.github.com/users/hmiche/repos", "events_url": "https://api.github.com/users/hmiche/events{/privacy}", "received_events_url": "https://api.github.com/users/hmiche/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-05-13T08:30:12Z", "updated_at": "2022-10-15T21:06:38Z", "closed_at": "2022-10-15T21:06:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "When trying to call \ud83d\udc4d \r\nfrom flair.data import Sentence\r\nfrom flair.models import SequenceTagger\r\n\r\ngot this Error\r\n\r\nFailed to import transformers.models.transfo_xl.tokenization_transfo_xl because of the following error (look up to see its traceback):\r\nNo module named 'sacremoses'\r\n\r\nQuick Solution : Use pip install transformers==4.18.0", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2765/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2765/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2763", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2763/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2763/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2763/events", "html_url": "https://github.com/flairNLP/flair/issues/2763", "id": 1234370380, "node_id": "I_kwDOCCkmXM5Jkv9M", "number": 2763, "title": "New huggingface/transformers update (4.19.0) breaks imports", "user": {"login": "vigenere23", "id": 32545895, "node_id": "MDQ6VXNlcjMyNTQ1ODk1", "avatar_url": "https://avatars.githubusercontent.com/u/32545895?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vigenere23", "html_url": "https://github.com/vigenere23", "followers_url": "https://api.github.com/users/vigenere23/followers", "following_url": "https://api.github.com/users/vigenere23/following{/other_user}", "gists_url": "https://api.github.com/users/vigenere23/gists{/gist_id}", "starred_url": "https://api.github.com/users/vigenere23/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vigenere23/subscriptions", "organizations_url": "https://api.github.com/users/vigenere23/orgs", "repos_url": "https://api.github.com/users/vigenere23/repos", "events_url": "https://api.github.com/users/vigenere23/events{/privacy}", "received_events_url": "https://api.github.com/users/vigenere23/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-05-12T18:59:24Z", "updated_at": "2022-05-15T11:09:50Z", "closed_at": "2022-05-15T11:09:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n\r\n`sacremoses` was made optional in the newest `transformers` version 4.19.0 (https://github.com/huggingface/transformers/releases/tag/v4.19.0), more specifically with the PR https://github.com/huggingface/transformers/pull/17049. From the PR's description, `sacremoses` is supposed to be an \"artifact of the past\", which means we maybe no longer (or should not) need it. \r\n\r\nIn the meantime, a quick solution would be to include the lib as a dependency of `flair`.\r\n\r\n**Screenshots**\r\n\r\n```shell\r\n../.venv/<private-filename>\r\n    from flair.data import Sentence\r\n../.venv/doc_geolocation/lib/python3.9/site-packages/flair/__init__.py:20: in <module>\r\n    from . import models\r\n../.venv/doc_geolocation/lib/python3.9/site-packages/flair/models/__init__.py:1: in <module>\r\n    from .sequence_tagger_model import SequenceTagger, MultiTagger\r\n../.venv/doc_geolocation/lib/python3.9/site-packages/flair/models/sequence_tagger_model.py:20: in <module>\r\n    from flair.embeddings import TokenEmbeddings, StackedEmbeddings, Embeddings\r\n../.venv/doc_geolocation/lib/python3.9/site-packages/flair/embeddings/__init__.py:40: in <module>\r\n    from .legacy import CharLMEmbeddings\r\n../.venv/doc_geolocation/lib/python3.9/site-packages/flair/embeddings/legacy.py:16: in <module>\r\n    from transformers import (\r\n<frozen importlib._bootstrap>:1055: in _handle_fromlist\r\n    ???\r\n../.venv/doc_geolocation/lib/python3.9/site-packages/transformers/utils/import_utils.py:863: in __getattr__\r\n    value = getattr(module, name)\r\n../.venv/doc_geolocation/lib/python3.9/site-packages/transformers/utils/import_utils.py:862: in __getattr__\r\n    module = self._get_module(self._class_to_module[name])\r\n../.venv/doc_geolocation/lib/python3.9/site-packages/transformers/utils/import_utils.py:874: in _get_module\r\n    raise RuntimeError(\r\nE   RuntimeError: Failed to import transformers.models.transfo_xl.tokenization_transfo_xl because of the following error (look up to see its traceback):\r\nE   No module named 'sacremoses'\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS : Ubuntu 20.04\r\n - Version : 0.11", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2763/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2763/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2762", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2762/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2762/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2762/events", "html_url": "https://github.com/flairNLP/flair/issues/2762", "id": 1234361683, "node_id": "I_kwDOCCkmXM5Jkt1T", "number": 2762, "title": "All settings the same, but using \"make_label_dictionary\" and \"make_tag_dictionary\" to create \"tag_dictionary\" for NER model give completely different results.", "user": {"login": "lixiu911", "id": 16153200, "node_id": "MDQ6VXNlcjE2MTUzMjAw", "avatar_url": "https://avatars.githubusercontent.com/u/16153200?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lixiu911", "html_url": "https://github.com/lixiu911", "followers_url": "https://api.github.com/users/lixiu911/followers", "following_url": "https://api.github.com/users/lixiu911/following{/other_user}", "gists_url": "https://api.github.com/users/lixiu911/gists{/gist_id}", "starred_url": "https://api.github.com/users/lixiu911/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lixiu911/subscriptions", "organizations_url": "https://api.github.com/users/lixiu911/orgs", "repos_url": "https://api.github.com/users/lixiu911/repos", "events_url": "https://api.github.com/users/lixiu911/events{/privacy}", "received_events_url": "https://api.github.com/users/lixiu911/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2022-05-12T18:50:02Z", "updated_at": "2022-11-13T08:46:14Z", "closed_at": "2022-11-13T08:46:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "All other settings are the same (same data, same code etc), but using \"make_label_dictionary\" and \"make_tag_dictionary\" to create \"tag_dictionary\" for NER model give completely different results. \r\n\r\nI am training a Swedish NER model, I first trained the model using  \"make_tag_dictionary\" and got the results but then noticed that \"make_tag_dictionary\" will be deprecated and it is recommended to use \"make_label_dictionary\" so I changed to \"make_label_dictionary\". B-U-T they output completely different results. \r\nThe code and output are as below. Is it a bug or is it something I missunderstand? Thanks!\r\n\r\nWith \"make_tag_dictionary\":\r\n![8FC7240F-B2DF-4409-A8B9-D3909612287D](https://user-images.githubusercontent.com/16153200/168145401-45af2921-39f7-476b-a855-d9e0777c5579.png)\r\n\r\nResults:\r\n- F-score (micro) 0.4605\r\n- F-score (macro) 0.4535\r\n- Accuracy 0.3011\r\n\r\nBy class:\r\n              precision    recall  f1-score   support\r\n\r\n           B     0.5789    0.3894    0.4656       999\r\n           I     0.6849    0.3257    0.4415       307\r\n\r\n   micro avg     0.5978    0.3744    0.4605      1306\r\n   macro avg     0.6319    0.3576    0.4535      1306\r\nweighted avg     0.6038    0.3744    0.4599      1306\r\n samples avg     0.3011    0.3011    0.3011      1306\r\n\r\nWith \"make_label_dictionary\":\r\n![5D0A5C6E-1370-410D-855C-626032F8BEB6](https://user-images.githubusercontent.com/16153200/168145670-0b6fba1a-4852-44ca-9bda-49d91dc4631c.png)\r\n\r\nResults:\r\n- F-score (micro) 0.0302\r\n- F-score (macro) 0.2986\r\n- Accuracy 0.0156\r\n\r\nBy class:\r\n              precision    recall  f1-score   support\r\n\r\n       <unk>     0.0000    0.0000    0.0000         0\r\n           B     0.4382    0.4965    0.4655       999\r\n           I     0.5000    0.3779    0.4304       307\r\n\r\n   micro avg     0.0156    0.4686    0.0302      1306\r\n   macro avg     0.3127    0.2914    0.2986      1306\r\nweighted avg     0.4527    0.4686    0.4573      1306\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2762/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2762/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2759", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2759/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2759/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2759/events", "html_url": "https://github.com/flairNLP/flair/issues/2759", "id": 1233566035, "node_id": "I_kwDOCCkmXM5JhrlT", "number": 2759, "title": "requirements.txt missing from PyPI source tarball", "user": {"login": "boegel", "id": 620876, "node_id": "MDQ6VXNlcjYyMDg3Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/620876?v=4", "gravatar_id": "", "url": "https://api.github.com/users/boegel", "html_url": "https://github.com/boegel", "followers_url": "https://api.github.com/users/boegel/followers", "following_url": "https://api.github.com/users/boegel/following{/other_user}", "gists_url": "https://api.github.com/users/boegel/gists{/gist_id}", "starred_url": "https://api.github.com/users/boegel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/boegel/subscriptions", "organizations_url": "https://api.github.com/users/boegel/orgs", "repos_url": "https://api.github.com/users/boegel/repos", "events_url": "https://api.github.com/users/boegel/events{/privacy}", "received_events_url": "https://api.github.com/users/boegel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2022-05-12T07:31:07Z", "updated_at": "2023-04-20T16:31:11Z", "closed_at": "2023-04-20T16:31:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n\r\n`requirements.txt` is missing from the source tarball that is available via PyPI (https://pypi.org/project/flair/0.11.2/#files).\r\n\r\nThat's a problem because `requirements.txt` is required by `setup.py`, see https://github.com/flairNLP/flair/blob/7491f4b4f3aa6e6c2832ddb67adb1243cbc15488/setup.py#L3-L4\r\n\r\n**To Reproduce**\r\n\r\nDownload source tarball from PyPI, unpack it, try installing it with `pip install .`\r\n\r\n**Expected behavior**\r\n\r\nInstalling with `pip install .` using source tarball from PyPI works.\r\n\r\n**Screenshots**\r\n*(not relevant)*\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Linux\r\n - Version: flair 0.11.2\r\n\r\n**Additional context**\r\n\r\nError message produced by `pip install .`:\r\n\r\n```\r\n    Traceback (most recent call last):\r\n      File \"/software/Python/3.9.5-GCCcore-10.3.0/lib/python3.9/site-packages/pip/_vendor/pep517/in_process/_in_process.py\", line 280, in <module>\r\n        main()\r\n      File \"/software/Python/3.9.5-GCCcore-10.3.0/lib/python3.9/site-packages/pip/_vendor/pep517/in_process/_in_process.py\", line 263, in main\r\n        json_out['return_val'] = hook(**hook_input['kwargs'])\r\n      File \"/software/Python/3.9.5-GCCcore-10.3.0/lib/python3.9/site-packages/pip/_vendor/pep517/in_process/_in_process.py\", line 133, in prepare_metadata_for_build_wheel\r\n        return hook(metadata_directory, config_settings)\r\n      File \"/software/Python/3.9.5-GCCcore-10.3.0/lib/python3.9/site-packages/setuptools/build_meta.py\", line 166, in prepare_metadata_for_build_wheel\r\n        self.run_setup()\r\n      File \"/software/Python/3.9.5-GCCcore-10.3.0/lib/python3.9/site-packages/setuptools/build_meta.py\", line 258, in run_setup\r\n        super(_BuildMetaLegacyBackend,\r\n      File \"/software/Python/3.9.5-GCCcore-10.3.0/lib/python3.9/site-packages/setuptools/build_meta.py\", line 150, in run_setup\r\n        exec(compile(code, __file__, 'exec'), locals())\r\n      File \"setup.py\", line 3, in <module>\r\n        with open(\"requirements.txt\") as f:\r\n    FileNotFoundError: [Errno 2] No such file or directory: 'requirements.txt'\r\n    Preparing wheel metadata: finished with status 'error'\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2759/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2759/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2751", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2751/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2751/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2751/events", "html_url": "https://github.com/flairNLP/flair/issues/2751", "id": 1228558729, "node_id": "I_kwDOCCkmXM5JOlGJ", "number": 2751, "title": "Iterating over the cuda-devices fails with a Type-Error ", "user": {"login": "Weyaaron", "id": 52529582, "node_id": "MDQ6VXNlcjUyNTI5NTgy", "avatar_url": "https://avatars.githubusercontent.com/u/52529582?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Weyaaron", "html_url": "https://github.com/Weyaaron", "followers_url": "https://api.github.com/users/Weyaaron/followers", "following_url": "https://api.github.com/users/Weyaaron/following{/other_user}", "gists_url": "https://api.github.com/users/Weyaaron/gists{/gist_id}", "starred_url": "https://api.github.com/users/Weyaaron/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Weyaaron/subscriptions", "organizations_url": "https://api.github.com/users/Weyaaron/orgs", "repos_url": "https://api.github.com/users/Weyaaron/repos", "events_url": "https://api.github.com/users/Weyaaron/events{/privacy}", "received_events_url": "https://api.github.com/users/Weyaaron/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-05-07T07:42:31Z", "updated_at": "2022-05-08T06:12:48Z", "closed_at": "2022-05-08T06:12:47Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhile iterating over the cuda-devices, flair fails to load the device properly.  This method of iteration is analogous to the method described in this issue: https://github.com/flairNLP/flair/issues/464\r\n\r\n**To Reproduce**\r\n```\r\nimport flair\r\nimport torch\r\n\r\nfor i in range(0,torch.cuda.device_count()):\r\n    current_device = torch.cuda.device(i)\r\n    print(current_device)\r\n    flair.device = torch.cuda.device(i)\r\n\r\n# Actually use flair, this is cut from the example for brevity \r\n```\r\n**Expected behavior**\r\nThat the code snipped changes the flair device properly. Instead, the programm crashes with the following error:\r\n\r\n```\r\n<torch.cuda.device object at 0x7f8fd0eee880>\r\n2022-05-07 09:24:41,338 loading file /vol/fob-vol4/mi17/weyaaron/.flair/models/ner-german-large/6b8de9edd73722050be2547acf64c037b2df833c6e8f0e88934de08385e26c1e.4b0797effcc6ebb1889d5d29784b97f0a099c1569b319d87d7c387e44e2bba48\r\nTraceback (most recent call last):\r\n  File \"/vol/fob-vol4/mi17/weyaaron/Zitatsuchmaschine/main.py\", line 54, in <module>\r\n    main()\r\n  File \"/vol/fob-vol4/mi17/weyaaron/Zitatsuchmaschine/main.py\", line 50, in main\r\n    active_mode.execute_full_cycle()\r\n  File \"/vol/fob-vol4/mi17/weyaaron/Zitatsuchmaschine/src/modes/nlp_mode.py\", line 14, in execute_full_cycle\r\n    self.setup()\r\n  File \"/vol/fob-vol4/mi17/weyaaron/Zitatsuchmaschine/src/modes/impl/extraction_mode.py\", line 14, in setup\r\n    self.quote_extractor = QuoteExtractor(\r\n  File \"<string>\", line 16, in __init__\r\n  File \"/vol/fob-vol4/mi17/weyaaron/Zitatsuchmaschine/src/nlp/quote_extraction/quote_extraction.py\", line 94, in __post_init__\r\n    self.__tagger = MultiTagger.load([self.__ner_model, self.__quote_model, self.__quotee_model])\r\n  File \"/glusterfs/dfs-gfs-dist/qse-common/miniconda-common/envs/qse-dev-system/lib/python3.9/site-packages/flair/models/sequence_tagger_model.py\", line 1330, in load\r\n    model = SequenceTagger.load(model_name)\r\n  File \"/glusterfs/dfs-gfs-dist/qse-common/miniconda-common/envs/qse-dev-system/lib/python3.9/site-packages/flair/nn.py\", line 88, in load\r\n    state = torch.load(f, map_location='cpu')\r\n  File \"/glusterfs/dfs-gfs-dist/qse-common/miniconda-common/envs/qse-dev-system/lib/python3.9/site-packages/torch/serialization.py\", line 607, in load\r\n    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)\r\n  File \"/glusterfs/dfs-gfs-dist/qse-common/miniconda-common/envs/qse-dev-system/lib/python3.9/site-packages/torch/serialization.py\", line 882, in _load\r\n    result = unpickler.load()\r\n  File \"/glusterfs/dfs-gfs-dist/qse-common/miniconda-common/envs/qse-dev-system/lib/python3.9/site-packages/flair/embeddings/token.py\", line 1284, in __setstate__\r\n    embedding = TransformerWordEmbeddings(\r\n  File \"/glusterfs/dfs-gfs-dist/qse-common/miniconda-common/envs/qse-dev-system/lib/python3.9/site-packages/flair/embeddings/token.py\", line 856, in __init__\r\n    self.model.to(flair.device)\r\n  File \"/glusterfs/dfs-gfs-dist/qse-common/miniconda-common/envs/qse-dev-system/lib/python3.9/site-packages/torch/nn/modules/module.py\", line 880, in to\r\n    device, dtype, non_blocking, convert_to_format = torch._C._nn._parse_to(*args, **kwargs)\r\nTypeError: to() received an invalid combination of arguments - got (device), but expected one of:\r\n * (torch.device device, torch.dtype dtype, bool non_blocking, bool copy, *, torch.memory_format memory_format)\r\n * (torch.dtype dtype, bool non_blocking, bool copy, *, torch.memory_format memory_format)\r\n * (Tensor tensor, bool non_blocking, bool copy, *, torch.memory_format memory_format)\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - Linux\r\n - Version 0.8.0.post1\r\n\r\n\r\n**Additional context**\r\nThis is my naive attempt at iterating over all cuda devices. If there is another approach, let me know. \r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2751/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2751/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2745", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2745/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2745/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2745/events", "html_url": "https://github.com/flairNLP/flair/issues/2745", "id": 1217738149, "node_id": "I_kwDOCCkmXM5IlTWl", "number": 2745, "title": "Loading models saved with flair < 0.11 fails with flair 0.11", "user": {"login": "yosipk", "id": 7121191, "node_id": "MDQ6VXNlcjcxMjExOTE=", "avatar_url": "https://avatars.githubusercontent.com/u/7121191?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yosipk", "html_url": "https://github.com/yosipk", "followers_url": "https://api.github.com/users/yosipk/followers", "following_url": "https://api.github.com/users/yosipk/following{/other_user}", "gists_url": "https://api.github.com/users/yosipk/gists{/gist_id}", "starred_url": "https://api.github.com/users/yosipk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yosipk/subscriptions", "organizations_url": "https://api.github.com/users/yosipk/orgs", "repos_url": "https://api.github.com/users/yosipk/repos", "events_url": "https://api.github.com/users/yosipk/events{/privacy}", "received_events_url": "https://api.github.com/users/yosipk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-04-27T18:34:03Z", "updated_at": "2022-10-15T21:07:12Z", "closed_at": "2022-10-15T21:07:12Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nThe [` TextClassifier`](https://github.com/flairNLP/flair/blob/master/flair/models/text_classification_model.py#L15) model that uses [`TransformerDocumentEmbeddings`](https://github.com/flairNLP/flair/blob/master/flair/embeddings/document.py#L26) trained and saved with Flair 0.10 can not be loaded with Flair 0.11.\r\n\r\n**To Reproduce**\r\nSave the `TextClassifier` that uses `TransformerDocumentEmbeddings` with Flair 0.10 and load with Flair 0.11.\r\n\r\n**Expected behavior**\r\nModel loading should be backward compatible.\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Linux\r\n - Version: flair 0.11.1 / flair 0.10\r\n\r\n**Additional context**\r\nThe bug is caused by renaming the argument of the `TransformerDocumentEmbeddings` from [`pooling`](https://github.com/flairNLP/flair/blob/45700cb61869b25c9c08c06a26298b805c0c66dc/flair/embeddings/document.py#L40) to [`cls_pooling`](https://github.com/flairNLP/flair/blob/d20c3fd07474e6103780fbe2b65302871f8db33d/flair/embeddings/document.py#L40). As a result the Flair 0.10 model is serialized with `pooling`, which is not getting recognized by Flair 0.11, and `pooling` gets propagated all the way to Transformers model constructor causing error.\r\n\r\nPossible fix is to detect in deserialization if the state dict of model to be loaded contains the key `pooling` instead of `cls_pooling` and rename the key from `pooling` to `cls_pooling`, so the `TransformerDocumentEmbeddings` constructor can be called with the correct argument name.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2745/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2745/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2742", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2742/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2742/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2742/events", "html_url": "https://github.com/flairNLP/flair/issues/2742", "id": 1214525521, "node_id": "I_kwDOCCkmXM5IZDBR", "number": 2742, "title": "StackedEmbeddings with PooledFlairEmbeddings returning TypeError", "user": {"login": "Nuveyla", "id": 37611243, "node_id": "MDQ6VXNlcjM3NjExMjQz", "avatar_url": "https://avatars.githubusercontent.com/u/37611243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nuveyla", "html_url": "https://github.com/Nuveyla", "followers_url": "https://api.github.com/users/Nuveyla/followers", "following_url": "https://api.github.com/users/Nuveyla/following{/other_user}", "gists_url": "https://api.github.com/users/Nuveyla/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nuveyla/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nuveyla/subscriptions", "organizations_url": "https://api.github.com/users/Nuveyla/orgs", "repos_url": "https://api.github.com/users/Nuveyla/repos", "events_url": "https://api.github.com/users/Nuveyla/events{/privacy}", "received_events_url": "https://api.github.com/users/Nuveyla/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "susannaruecker", "id": 51824728, "node_id": "MDQ6VXNlcjUxODI0NzI4", "avatar_url": "https://avatars.githubusercontent.com/u/51824728?v=4", "gravatar_id": "", "url": "https://api.github.com/users/susannaruecker", "html_url": "https://github.com/susannaruecker", "followers_url": "https://api.github.com/users/susannaruecker/followers", "following_url": "https://api.github.com/users/susannaruecker/following{/other_user}", "gists_url": "https://api.github.com/users/susannaruecker/gists{/gist_id}", "starred_url": "https://api.github.com/users/susannaruecker/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/susannaruecker/subscriptions", "organizations_url": "https://api.github.com/users/susannaruecker/orgs", "repos_url": "https://api.github.com/users/susannaruecker/repos", "events_url": "https://api.github.com/users/susannaruecker/events{/privacy}", "received_events_url": "https://api.github.com/users/susannaruecker/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "susannaruecker", "id": 51824728, "node_id": "MDQ6VXNlcjUxODI0NzI4", "avatar_url": "https://avatars.githubusercontent.com/u/51824728?v=4", "gravatar_id": "", "url": "https://api.github.com/users/susannaruecker", "html_url": "https://github.com/susannaruecker", "followers_url": "https://api.github.com/users/susannaruecker/followers", "following_url": "https://api.github.com/users/susannaruecker/following{/other_user}", "gists_url": "https://api.github.com/users/susannaruecker/gists{/gist_id}", "starred_url": "https://api.github.com/users/susannaruecker/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/susannaruecker/subscriptions", "organizations_url": "https://api.github.com/users/susannaruecker/orgs", "repos_url": "https://api.github.com/users/susannaruecker/repos", "events_url": "https://api.github.com/users/susannaruecker/events{/privacy}", "received_events_url": "https://api.github.com/users/susannaruecker/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2022-04-25T13:36:46Z", "updated_at": "2022-05-04T11:45:41Z", "closed_at": "2022-05-04T11:45:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhile running the given code for the best configuration for CONLL-03 NER on English at the following page: [link](https://github.com/flairNLP/flair/blob/b3797096742699997e77d12a66c82310361990a4/resources/docs/EXPERIMENTS.md) I get a TypeError (see screenshot). I have tested out several embeddings (Word and Flair) and saw that this TypeError is only occurring when running with PooledFlair. I have controlled the source code where the error is (token.py), but could not come up with a possible solution.\r\n\r\n**Screenshots**\r\n![image](https://user-images.githubusercontent.com/37611243/165096669-942b2c80-7454-4198-a2a4-e22f76535fc1.png)\r\n![image](https://user-images.githubusercontent.com/37611243/165096805-345579fb-c965-4d44-8da9-fde66773db4a.png)\r\n\r\n**Environment:**\r\n - Windows\r\n - python 3.10\r\n - flair -0.11\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2742/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2742/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2740", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2740/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2740/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2740/events", "html_url": "https://github.com/flairNLP/flair/issues/2740", "id": 1213566590, "node_id": "I_kwDOCCkmXM5IVY5-", "number": 2740, "title": "Issue using tars.predict in UDF", "user": {"login": "xfgavin", "id": 134871, "node_id": "MDQ6VXNlcjEzNDg3MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/134871?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xfgavin", "html_url": "https://github.com/xfgavin", "followers_url": "https://api.github.com/users/xfgavin/followers", "following_url": "https://api.github.com/users/xfgavin/following{/other_user}", "gists_url": "https://api.github.com/users/xfgavin/gists{/gist_id}", "starred_url": "https://api.github.com/users/xfgavin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xfgavin/subscriptions", "organizations_url": "https://api.github.com/users/xfgavin/orgs", "repos_url": "https://api.github.com/users/xfgavin/repos", "events_url": "https://api.github.com/users/xfgavin/events{/privacy}", "received_events_url": "https://api.github.com/users/xfgavin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-04-24T06:55:02Z", "updated_at": "2022-11-01T15:04:55Z", "closed_at": "2022-11-01T15:04:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "I got very different result when using tars.predict in a function in python with an udf wrapping the function and using it in spark sql. Here is the code:\r\n\r\n```\r\npip install flair\r\nfrom flair.data import Sentence\r\nfrom flair.models import SequenceTagger\r\nfrom pyspark.sql.functions import *\r\nfrom pyspark.sql.types import *\r\nfrom flair.datasets import GO_EMOTIONS\r\nfrom flair.models import TARSClassifier\r\nfrom flair.trainers import ModelTrainer\r\ntars = TARSClassifier.load('tars-base')\r\ntars.switch_to_task(\"GO_EMOTIONS\")\r\n\r\ndef getEmotion(text):\r\n\r\n    sentence = Sentence(text)\r\n\r\n    tars.predict(sentence)\r\n\r\n    result = sentence.to_dict()\r\n\r\n    return result\r\n\r\nspark.udf.register(\"getEmotionUDF\", getEmotion,StringType())\r\n```\r\n\r\nIn spark sql via databricks:\r\n```\r\n%sql\r\n\r\nselect getEmotionUDF('i am happy');\r\n```\r\n\r\nI got:\r\n\r\n`\r\n{all labels=[{value=NEUTRAL, confidence=0.7152036428451538}, {value=ANGER, confidence=0.7273235321044922}, {value=FEAR, confidence=0.6826728582382202}, {value=ANNOYANCE, confidence=0.7781732678413391}, {value=SURPRISE, confidence=0.6873858571052551}, {value=GRATITUDE, confidence=0.7292483448982239}, {value=DESIRE, confidence=0.7011390328407288}, {value=OPTIMISM, confidence=0.7458798885345459}, {value=ADMIRATION, confidence=0.7463255524635315}, {value=CONFUSION, confidence=0.7086165547370911}, {value=AMUSEMENT, confidence=0.676873505115509}, {value=APPROVAL, confidence=0.7240709662437439}, {value=CARING, confidence=0.7137355208396912}, {value=EMBARRASSMENT, confidence=0.6914198398590088}, {value=REALIZATION, confidence=0.7595157027244568}, {value=DISAPPOINTMENT, confidence=0.7149665355682373}, {value=GRIEF, confidence=0.7443049550056458}, {value=SADNESS, confidence=0.7657970786094666}, {value=CURIOSITY, confidence=0.75248783826828}, {value=JOY, confidence=0.7151253819465637}, {value=LOVE, confidence=0.7284602522850037}, {value=EXCITEMENT, confidence=0.7087971568107605}, {value=DISAPPROVAL, confidence=0.7449938058853149}, {value=REMORSE, confidence=0.6994790434837341}, {value=DISGUST, confidence=0.7635707259178162}, {value=RELIEF, confidence=0.760797381401062}, {value=PRIDE, confidence=0.7652835249900818}, {value=NERVOUSNESS, confidence=0.7355543971061707}], text=i am happy}\r\n`\r\n\r\nWhen using the function directly in python as below:\r\n```\r\ngetEmotion(\"I am happy\")\r\n```\r\nI got:\r\n`\r\n{'text': 'I am happy', 'all labels': [{'value': 'JOY', 'confidence': 0.9816395044326782}]}\r\n`", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2740/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2740/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2737", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2737/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2737/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2737/events", "html_url": "https://github.com/flairNLP/flair/issues/2737", "id": 1212249794, "node_id": "I_kwDOCCkmXM5IQXbC", "number": 2737, "title": "PyTorch sampler is mutually exclusive with shuffle ", "user": {"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2022-04-22T11:35:23Z", "updated_at": "2022-06-27T13:39:48Z", "closed_at": "2022-06-27T13:39:48Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "**Describe the bug**\r\nUsing default settings, a custom sampler will raise an error since shuffle and a custom sampler a mutually exclusive in torch.\r\n\r\n**Expected behavior**\r\nDataLoader needs to check whether a sampler is given and thus overwrite shuffle default param.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2737/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2737/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2728", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2728/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2728/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2728/events", "html_url": "https://github.com/flairNLP/flair/issues/2728", "id": 1202188242, "node_id": "I_kwDOCCkmXM5Hp-_S", "number": 2728, "title": "Loss of Label/Score for NER in tokens", "user": {"login": "jenortonfirstam", "id": 103527111, "node_id": "U_kgDOBiuyxw", "avatar_url": "https://avatars.githubusercontent.com/u/103527111?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jenortonfirstam", "html_url": "https://github.com/jenortonfirstam", "followers_url": "https://api.github.com/users/jenortonfirstam/followers", "following_url": "https://api.github.com/users/jenortonfirstam/following{/other_user}", "gists_url": "https://api.github.com/users/jenortonfirstam/gists{/gist_id}", "starred_url": "https://api.github.com/users/jenortonfirstam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jenortonfirstam/subscriptions", "organizations_url": "https://api.github.com/users/jenortonfirstam/orgs", "repos_url": "https://api.github.com/users/jenortonfirstam/repos", "events_url": "https://api.github.com/users/jenortonfirstam/events{/privacy}", "received_events_url": "https://api.github.com/users/jenortonfirstam/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-04-12T17:37:38Z", "updated_at": "2022-05-06T06:41:03Z", "closed_at": "2022-05-06T06:41:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm not sure if this was intentional or a bug, but as of 0.11, tokens no longer have NER labels (meaning we are losing the BIOES labels) and scores assigned to tokens in a span. Our usage was dependent on having NER labels and scores in the tokens.\r\n\r\nIt must be an omission because I can see in the code that you are assigning Omit tags.\r\n\r\n**To Reproduce**\r\nRun any NER model and inspect the tokens in the span for labels or scores. The labels were not inserted by the prediction method into the tokens (details and fix outlined below)\r\n\r\n**Expected behavior**\r\nThe NER label with BIOES tag and score should be added to tokens in the span.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Linux\r\n - Version [e.g. flair-0.3.2]: flair >= 0.11\r\n\r\n**Additional context**\r\nThe lost functionality (or error) can be traced into the predict function for the sequence tagger. Take a look starting at line 504 of https://github.com/flairNLP/flair/blob/master/flair/models/sequence_tagger_model.py. If this block were written as follows, the lost functionality would be restored.\r\n\r\n```python\r\n                for sentence, sentence_predictions in zip(batch, predictions):\r\n\r\n                    # BIOES-labels need to be converted to spans\r\n                    if self.predict_spans:\r\n                            begin_index = predicted_span[0][0]\r\n                            end_index = predicted_span[0][-1]+1\r\n                            span_token_tags = sentence_tags[begin_index: end_index]\r\n                            span_token_scores = sentence_scores[begin_index: end_index]\r\n                            span: Span = sentence[begin_index: end_index]\r\n                            span.add_label(label_name, value=predicted_span[2], score=predicted_span[1])\r\n                            for span_token, token_tag, token_score in zip(span.tokens, span_token_tags, span_token_scores):\r\n                                    span_token.add_label(label_name, token_tag, token_score)\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2728/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2728/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2722", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2722/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2722/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2722/events", "html_url": "https://github.com/flairNLP/flair/issues/2722", "id": 1199717420, "node_id": "I_kwDOCCkmXM5Hgjws", "number": 2722, "title": "Issue with custom dataset after updating to flair 0.11", "user": {"login": "stefanobranco", "id": 45937322, "node_id": "MDQ6VXNlcjQ1OTM3MzIy", "avatar_url": "https://avatars.githubusercontent.com/u/45937322?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefanobranco", "html_url": "https://github.com/stefanobranco", "followers_url": "https://api.github.com/users/stefanobranco/followers", "following_url": "https://api.github.com/users/stefanobranco/following{/other_user}", "gists_url": "https://api.github.com/users/stefanobranco/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefanobranco/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefanobranco/subscriptions", "organizations_url": "https://api.github.com/users/stefanobranco/orgs", "repos_url": "https://api.github.com/users/stefanobranco/repos", "events_url": "https://api.github.com/users/stefanobranco/events{/privacy}", "received_events_url": "https://api.github.com/users/stefanobranco/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2022-04-11T09:58:39Z", "updated_at": "2022-11-01T15:05:05Z", "closed_at": "2022-11-01T15:05:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nWe're using flair to perform named entity recognition to identify specific parts of a document as part of a citation to a different documents. Our dataset consists of space separated tokens and labels, like this: \r\n\r\n```\r\nVgl. O\r\nRundschreiben O\r\nRAB PARTA\r\n1/2010 YEAR\r\nRz MISC\r\n8. MISC\r\n```\r\n\r\nI'm reading in the dataset with a columncorups like this:\r\n\r\n```\r\n# define columns\r\ncolumns = {0: 'text', 1: 'ner'}\r\n\r\n# this is the folder in which train, test and dev files reside\r\ndata_folder = '../Data/Flair/Regex_Tagging_Full'\r\n\r\n# init a corpus using column format, data folder and the names of the train, dev and test files\r\ncorpus: Corpus = ColumnCorpus(data_folder, columns,\r\n                              in_memory=True,\r\n                              document_separator_token=\"-DOCSTART-\")\r\n```\r\n\r\nFrom my understanding, the expected corpus would be something like this:\r\n\r\n![image](https://user-images.githubusercontent.com/45937322/162714181-64b987f9-e813-4b67-a674-864abcab504c.png)\r\n\r\nThis is also the way it has worked in 0.10. However, every since upgrading to 0.11, our dataset is being ripped apart, and our labels are cut down in weird ways (looks like the first two characters are replaced with a forward slash?):\r\n![image](https://user-images.githubusercontent.com/45937322/162713759-539f2c0d-2ff8-45e9-ab1b-48a9ae314ca0.png)\r\n\r\nI understand the labeling logic has been refactored, but I don't assume the change in behaviour is intended, or is there a setting about labels that I'm missing?\r\n\r\nThis also doesn't just seem to be a display issue in the dataset, since this causes an entirely incorrect label dictionary to be created full of broken labels.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2722/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2722/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2710", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2710/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2710/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2710/events", "html_url": "https://github.com/flairNLP/flair/issues/2710", "id": 1196462976, "node_id": "I_kwDOCCkmXM5HUJOA", "number": 2710, "title": "SciSpacyTokenizer.tokenize() function is broken", "user": {"login": "tadejmagajna", "id": 1088423, "node_id": "MDQ6VXNlcjEwODg0MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/1088423?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tadejmagajna", "html_url": "https://github.com/tadejmagajna", "followers_url": "https://api.github.com/users/tadejmagajna/followers", "following_url": "https://api.github.com/users/tadejmagajna/following{/other_user}", "gists_url": "https://api.github.com/users/tadejmagajna/gists{/gist_id}", "starred_url": "https://api.github.com/users/tadejmagajna/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tadejmagajna/subscriptions", "organizations_url": "https://api.github.com/users/tadejmagajna/orgs", "repos_url": "https://api.github.com/users/tadejmagajna/repos", "events_url": "https://api.github.com/users/tadejmagajna/events{/privacy}", "received_events_url": "https://api.github.com/users/tadejmagajna/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-04-07T19:10:42Z", "updated_at": "2022-04-10T11:37:55Z", "closed_at": "2022-04-10T11:37:55Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nTwo minor bugs were introduced to Flair's `SciSpacyTokenizer` as part of #2645\r\nThe bugs prevent usage of `SciSpacyTokenizer` and tokenizers that leverage it.\r\n\r\n**To Reproduce**\r\nAny use of classes that leverage `SciSpacyTokenizer` will raise errors. For example:\r\n\r\n```python\r\nfrom flair.tokenization import SciSpacySentenceSplitter\r\n\r\nsplitter = SciSpacySentenceSplitter()\r\n\r\nsentences = splitter.split(\"abcd\")\r\n```\r\n\r\nCauses\r\n```\r\n[/usr/local/lib/python3.7/dist-packages/flair/tokenization.py](https://localhost:8080/#) in tokenize(self, text)\r\n    257         words: List[str] = []\r\n    258         for word in sentence:\r\n--> 259             word.append(word)\r\n    260         return words\r\n    261 \r\n\r\nAttributeError: 'spacy.tokens.token.Token' object has no attribute 'append'\r\n```\r\n\r\n**To Fix**\r\n\r\n***First issue***\r\nThe first problem is that there is a typo here: https://github.com/flairNLP/flair/blob/480d2c9afd66ab8d3bf40a676917e84dba3c4cee/flair/tokenization.py#L259\r\nIt should be `words.append`, not `word.append`.\r\n\r\n***Second issue***\r\nthe `SciSpacyTokenizer.tokenize()` is supposed to return a list of `str` , but instad it returns a list of Spacy `Token` objects.\r\n\r\n\r\nHappy to open a PR shortly", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2710/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2710/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2706", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2706/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2706/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2706/events", "html_url": "https://github.com/flairNLP/flair/issues/2706", "id": 1194517185, "node_id": "I_kwDOCCkmXM5HMuLB", "number": 2706, "title": "corpus.make_tag_dictionary(tag_type=tag_type) NOT working when trying to train custom Dataset", "user": {"login": "hmiche", "id": 63804608, "node_id": "MDQ6VXNlcjYzODA0NjA4", "avatar_url": "https://avatars.githubusercontent.com/u/63804608?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hmiche", "html_url": "https://github.com/hmiche", "followers_url": "https://api.github.com/users/hmiche/followers", "following_url": "https://api.github.com/users/hmiche/following{/other_user}", "gists_url": "https://api.github.com/users/hmiche/gists{/gist_id}", "starred_url": "https://api.github.com/users/hmiche/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hmiche/subscriptions", "organizations_url": "https://api.github.com/users/hmiche/orgs", "repos_url": "https://api.github.com/users/hmiche/repos", "events_url": "https://api.github.com/users/hmiche/events{/privacy}", "received_events_url": "https://api.github.com/users/hmiche/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-04-06T12:05:48Z", "updated_at": "2022-09-09T02:02:27Z", "closed_at": "2022-09-09T02:02:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nmy code was working fine before but now when i try ti execute the command corpus.make_tag_dictionary(tag_type=tag_type) i got an error says  :  1522         for sentence in _iter_dataset(self.get_all_sentences()):\r\n   1523             for token in sentence.tokens:\r\n-> 1524                 tag_dictionary.add_item(token.get_tag(tag_type).value)\r\n   1525         tag_dictionary.add_item(\"<START>\")\r\n   1526         tag_dictionary.add_item(\"<STOP>\")\r\n\r\nAttributeError: 'Token' object has no attribute 'get_tag'\r\n\r\n**To Reproduce**\r\nI'm trying to train flair with my custom Dataset\r\n\r\n**Expected behavior**\r\nthe command should work like before without any problem\r\n\r\n**Screenshots**\r\n![image](https://user-images.githubusercontent.com/63804608/161970484-b519d949-8e32-44ce-8a1a-b2c1c29bf61d.png)\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - OS [ Colab]:\r\n - Version [e.g. flair-0.3.2]:\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2706/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2706/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2701", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2701/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2701/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2701/events", "html_url": "https://github.com/flairNLP/flair/issues/2701", "id": 1191040978, "node_id": "I_kwDOCCkmXM5G_dfS", "number": 2701, "title": "UnboundLocalError: local variable 'dev_score' referenced before assignment", "user": {"login": "githubmilind", "id": 925481, "node_id": "MDQ6VXNlcjkyNTQ4MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/925481?v=4", "gravatar_id": "", "url": "https://api.github.com/users/githubmilind", "html_url": "https://github.com/githubmilind", "followers_url": "https://api.github.com/users/githubmilind/followers", "following_url": "https://api.github.com/users/githubmilind/following{/other_user}", "gists_url": "https://api.github.com/users/githubmilind/gists{/gist_id}", "starred_url": "https://api.github.com/users/githubmilind/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/githubmilind/subscriptions", "organizations_url": "https://api.github.com/users/githubmilind/orgs", "repos_url": "https://api.github.com/users/githubmilind/repos", "events_url": "https://api.github.com/users/githubmilind/events{/privacy}", "received_events_url": "https://api.github.com/users/githubmilind/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-04-03T20:45:18Z", "updated_at": "2023-03-16T15:59:24Z", "closed_at": "2022-09-09T02:02:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI am creating the classifier with own corpus and when I train the model, after 1st epoch get the error.\r\n\r\n**To Reproduce**\r\nfrom flair.trainers import ModelTrainer\r\ntrainer = ModelTrainer(clf2, corpus_fst)\r\n\r\ntrainer.train('data_fst/',max_epochs=2)\r\n\r\n**Expected behavior**\r\nexpected to training to complete successfully but getting error\r\nUnboundLocalError: local variable 'dev_score' referenced before assignment\r\n\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n![image](https://user-images.githubusercontent.com/925481/161447834-dd8a43fd-38e7-4f59-b0d7-da357aadbe7e.png)\r\n\r\n**Environment (please complete the following information):**\r\nwindows, using in Google Colab\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2701/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2701/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2694", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2694/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2694/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2694/events", "html_url": "https://github.com/flairNLP/flair/issues/2694", "id": 1187460108, "node_id": "I_kwDOCCkmXM5GxzQM", "number": 2694, "title": "Large dataset trianing gets stuck at epoch 1 (tired so many times) ", "user": {"login": "selva221724", "id": 8901901, "node_id": "MDQ6VXNlcjg5MDE5MDE=", "avatar_url": "https://avatars.githubusercontent.com/u/8901901?v=4", "gravatar_id": "", "url": "https://api.github.com/users/selva221724", "html_url": "https://github.com/selva221724", "followers_url": "https://api.github.com/users/selva221724/followers", "following_url": "https://api.github.com/users/selva221724/following{/other_user}", "gists_url": "https://api.github.com/users/selva221724/gists{/gist_id}", "starred_url": "https://api.github.com/users/selva221724/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/selva221724/subscriptions", "organizations_url": "https://api.github.com/users/selva221724/orgs", "repos_url": "https://api.github.com/users/selva221724/repos", "events_url": "https://api.github.com/users/selva221724/events{/privacy}", "received_events_url": "https://api.github.com/users/selva221724/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-03-31T03:56:25Z", "updated_at": "2022-04-01T07:30:40Z", "closed_at": "2022-04-01T07:21:29Z", "author_association": "NONE", "active_lock_reason": null, "body": "This is my code:\r\n\r\n```\r\nembedding_types = [CharacterEmbeddings(), BytePairEmbeddings('multi')]\r\n\r\nembeddings = StackedEmbeddings(embeddings=embedding_types)\r\ntagger = SequenceTagger(hidden_size=256,\r\n                        embeddings=embeddings,\r\n                        tag_dictionary=tag_dictionary,\r\n                        tag_type=tag_type,\r\n                        use_crf=True)\r\n\r\ntrainer = ModelTrainer(tagger, corpus)\r\ntrainer.train(f'{data_folder}/model/',\r\n              learning_rate=0.1,\r\n              mini_batch_size=32,\r\n              max_epochs=5)\r\n\r\n```\r\n\r\nThis is the output:\r\n\r\n```\r\n2022-03-30 19:35:48,882 ----------------------------------------------------------------------------------------------------\r\n2022-03-30 19:35:48,883 Model: \"SequenceTagger(\r\n  (embeddings): StackedEmbeddings(\r\n    (list_embedding_0): CharacterEmbeddings(\r\n      (char_embedding): Embedding(275, 25)\r\n      (char_rnn): LSTM(25, 25, bidirectional=True)\r\n    )\r\n    (list_embedding_1): BytePairEmbeddings(model=1-bpe-multi-100000-50)\r\n  )\r\n  (word_dropout): WordDropout(p=0.05)\r\n  (locked_dropout): LockedDropout(p=0.5)\r\n  (embedding2nn): Linear(in_features=650, out_features=650, bias=True)\r\n  (rnn): LSTM(650, 256, batch_first=True, bidirectional=True)\r\n  (linear): Linear(in_features=512, out_features=23, bias=True)\r\n  (beta): 1.0\r\n  (weights): None\r\n  (weight_tensor) None\r\n)\"\r\n2022-03-30 19:35:48,885 ----------------------------------------------------------------------------------------------------\r\n2022-03-30 19:35:48,886 Corpus: \"Corpus: 2466313 train + 704682 dev + 352396 test sentences\"\r\n2022-03-30 19:35:48,886 ----------------------------------------------------------------------------------------------------\r\n2022-03-30 19:35:48,887 Parameters:\r\n2022-03-30 19:35:48,888  - learning_rate: \"0.1\"\r\n2022-03-30 19:35:48,889  - mini_batch_size: \"32\"\r\n2022-03-30 19:35:48,889  - patience: \"3\"\r\n2022-03-30 19:35:48,890  - anneal_factor: \"0.5\"\r\n2022-03-30 19:35:48,891  - max_epochs: \"5\"\r\n2022-03-30 19:35:48,892  - shuffle: \"True\"\r\n2022-03-30 19:35:48,893  - train_with_dev: \"False\"\r\n2022-03-30 19:35:48,894  - batch_growth_annealing: \"False\"\r\n2022-03-30 19:35:48,894 ----------------------------------------------------------------------------------------------------\r\n2022-03-30 19:35:48,895 Model training base path: \"addressparser_data\\100000\\model\"\r\n2022-03-30 19:35:48,896 ----------------------------------------------------------------------------------------------------\r\n2022-03-30 19:35:48,897 Device: cuda:0\r\n2022-03-30 19:35:48,897 ----------------------------------------------------------------------------------------------------\r\n2022-03-30 19:35:48,898 Embeddings storage mode: cpu\r\n2022-03-30 19:35:48,900 ----------------------------------------------------------------------------------------------------\r\n2022-03-30 20:08:34,931 epoch 1 - iter 7707/77073 - loss 0.14301676 - samples/sec: 125.50 - lr: 0.100000\r\n2022-03-30 20:34:06,560 epoch 1 - iter 15414/77073 - loss 0.12915638 - samples/sec: 161.11 - lr: 0.100000\r\n2022-03-30 20:58:47,463 epoch 1 - iter 23121/77073 - loss 0.11769705 - samples/sec: 166.62 - lr: 0.100000\r\n2022-03-30 21:24:51,573 epoch 1 - iter 30828/77073 - loss 0.11941916 - samples/sec: 157.75 - lr: 0.100000\r\n2022-03-30 21:51:24,452 epoch 1 - iter 38535/77073 - loss 0.11532775 - samples/sec: 154.91 - lr: 0.100000\r\n2022-03-30 22:18:56,208 epoch 1 - iter 46242/77073 - loss 0.11347954 - samples/sec: 149.39 - lr: 0.100000\r\n2022-03-30 22:45:46,143 epoch 1 - iter 53949/77073 - loss 0.11719864 - samples/sec: 153.26 - lr: 0.100000\r\n2022-03-30 23:10:53,478 epoch 1 - iter 61656/77073 - loss 0.12133641 - samples/sec: 163.70 - lr: 0.100000\r\n2022-03-30 23:37:21,818 epoch 1 - iter 69363/77073 - loss 0.12793721 - samples/sec: 155.35 - lr: 0.100000\r\n2022-03-31 00:04:42,721 epoch 1 - iter 77070/77073 - loss 0.15024475 - samples/sec: 150.37 - lr: 0.100000\r\n2022-03-31 00:04:43,215 ----------------------------------------------------------------------------------------------------\r\n2022-03-31 00:04:43,217 EPOCH 1 done: loss 0.1503 - lr 0.1000000\r\n```\r\n\r\nI tried changing the `Embeddings storage mode: cpu` to `Embeddings storage mode: none`. still, nothing works. \r\n\r\nFlair version== `0.10`\r\ntorch==`1.11.0`\r\ntorchaudio==`0.11.0`\r\ntorchvision==`0.12.0`\r\n\r\n<img src = \"https://c.tenor.com/LkIWQbsQxyMAAAAM/waiting-skeleton.gif\" >", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2694/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2694/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2692", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2692/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2692/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2692/events", "html_url": "https://github.com/flairNLP/flair/issues/2692", "id": 1185384651, "node_id": "I_kwDOCCkmXM5Gp4jL", "number": 2692, "title": "OneHotEmbeddings - RecursionError: maximum recursion depth exceeded", "user": {"login": "shabnam-b", "id": 30550801, "node_id": "MDQ6VXNlcjMwNTUwODAx", "avatar_url": "https://avatars.githubusercontent.com/u/30550801?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shabnam-b", "html_url": "https://github.com/shabnam-b", "followers_url": "https://api.github.com/users/shabnam-b/followers", "following_url": "https://api.github.com/users/shabnam-b/following{/other_user}", "gists_url": "https://api.github.com/users/shabnam-b/gists{/gist_id}", "starred_url": "https://api.github.com/users/shabnam-b/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shabnam-b/subscriptions", "organizations_url": "https://api.github.com/users/shabnam-b/orgs", "repos_url": "https://api.github.com/users/shabnam-b/repos", "events_url": "https://api.github.com/users/shabnam-b/events{/privacy}", "received_events_url": "https://api.github.com/users/shabnam-b/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2022-03-29T20:36:12Z", "updated_at": "2022-04-04T22:26:55Z", "closed_at": "2022-04-04T22:26:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nAfter the first epoch of training, when trying to save the model, the code crashes with the following error:\r\n\r\n> 2022-03-29 14:42:36,561 EPOCH 1 done: loss 2.2471 - lr 0.1000000\r\n2022-03-29 14:42:47,611 DEV : loss 0.8668829202651978 - f1-score (micro avg)  0.7597\r\n2022-03-29 14:42:47,665 BAD EPOCHS (no improvement): 0\r\n2022-03-29 14:42:47,666 saving best model\r\nTraceback (most recent call last):\r\n  File \"my_main.py\", line 271, in <module>\r\n    train(tag=opts.tag, tag2=opts.tag2, corpus=opts.corpus)\r\n  File \"my_main.py\", line 164, in train\r\n    max_epochs=100)\r\n  File \"/lib/python3.7/site-packages/flair/trainers/trainer.py\", line 672, in train\r\n    self.model.save(base_path / \"best-model.pt\")\r\n  File \"/lib/python3.7/site-packages/flair/nn/model.py\", line 85, in save\r\n    torch.save(model_state, str(model_file), pickle_protocol=4)\r\n  File \"/lib/python3.7/site-packages/torch/serialization.py\", line 379, in save\r\n    _save(obj, opened_zipfile, pickle_module, pickle_protocol)\r\n  File \"/lib/python3.7/site-packages/torch/serialization.py\", line 484, in _save\r\n    pickler.dump(obj)\r\n  File \"/lib/python3.7/site-packages/torch/serialization.py\", line 467, in persistent_id\r\n    if torch.is_storage(obj):\r\nRecursionError: maximum recursion depth exceeded\r\n\r\n\r\n**The issue seems to be with OneHotEmbeddings, alone or stacked...both cause issues. When I remove OneHotEmbeddings, it works fine.**\r\n\r\n**To Reproduce**\r\n\r\nMy code is very similar to the tutorial on training a model:\r\n\r\n```\r\n# 4. initialize embeddings\r\n    embeddings_1 = TransformerWordEmbeddings('roberta-large')\r\n    embeddings_2 = OneHotEmbeddings(corpus=corpus, field='xml', embedding_length=8)\r\n\r\n    embedding_types = [\r\n        embeddings_1,\r\n        embeddings_2\r\n    ]\r\n\r\n    embeddings = StackedEmbeddings(embeddings=embedding_types)\r\n\r\n    # 5. initialize sequence tagger\r\n    tagger = SequenceTagger(hidden_size=256,\r\n                            embeddings=embeddings,\r\n                            tag_dictionary=tag_dictionary,\r\n                            tag_type=tag_type,\r\n                            use_crf=True,\r\n                            use_rnn=True)\r\n\r\n    # 6. initialize trainer\r\n    trainer = ModelTrainer(tagger, corpus)\r\n\r\n    # 7. start training\r\n    trainer.train('trained_taggers/v1-march28/',\r\n                  learning_rate=0.1,\r\n                  mini_batch_size=32,\r\n                  max_epochs=100)\r\n```\r\n\r\n**Expected behavior**\r\nSave the checkpoint, continue training\r\n\r\n**Environment:**\r\n - OS: Linux\r\n - python3.7\r\n - Lib version:\r\n flair: 0.9\r\n torch: 1.10.0\r\ntransformers: 4.17.0\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2692/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2692/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2687", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2687/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2687/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2687/events", "html_url": "https://github.com/flairNLP/flair/issues/2687", "id": 1178639265, "node_id": "I_kwDOCCkmXM5GQJuh", "number": 2687, "title": "The model can be loaded only with a certain version of torch (ModuleNotFoundError: No module named 'torch.torch_version')", "user": {"login": "iliaNecrov", "id": 96539972, "node_id": "U_kgDOBcEVRA", "avatar_url": "https://avatars.githubusercontent.com/u/96539972?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iliaNecrov", "html_url": "https://github.com/iliaNecrov", "followers_url": "https://api.github.com/users/iliaNecrov/followers", "following_url": "https://api.github.com/users/iliaNecrov/following{/other_user}", "gists_url": "https://api.github.com/users/iliaNecrov/gists{/gist_id}", "starred_url": "https://api.github.com/users/iliaNecrov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iliaNecrov/subscriptions", "organizations_url": "https://api.github.com/users/iliaNecrov/orgs", "repos_url": "https://api.github.com/users/iliaNecrov/repos", "events_url": "https://api.github.com/users/iliaNecrov/events{/privacy}", "received_events_url": "https://api.github.com/users/iliaNecrov/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "aynetdia", "id": 65453386, "node_id": "MDQ6VXNlcjY1NDUzMzg2", "avatar_url": "https://avatars.githubusercontent.com/u/65453386?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aynetdia", "html_url": "https://github.com/aynetdia", "followers_url": "https://api.github.com/users/aynetdia/followers", "following_url": "https://api.github.com/users/aynetdia/following{/other_user}", "gists_url": "https://api.github.com/users/aynetdia/gists{/gist_id}", "starred_url": "https://api.github.com/users/aynetdia/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aynetdia/subscriptions", "organizations_url": "https://api.github.com/users/aynetdia/orgs", "repos_url": "https://api.github.com/users/aynetdia/repos", "events_url": "https://api.github.com/users/aynetdia/events{/privacy}", "received_events_url": "https://api.github.com/users/aynetdia/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aynetdia", "id": 65453386, "node_id": "MDQ6VXNlcjY1NDUzMzg2", "avatar_url": "https://avatars.githubusercontent.com/u/65453386?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aynetdia", "html_url": "https://github.com/aynetdia", "followers_url": "https://api.github.com/users/aynetdia/followers", "following_url": "https://api.github.com/users/aynetdia/following{/other_user}", "gists_url": "https://api.github.com/users/aynetdia/gists{/gist_id}", "starred_url": "https://api.github.com/users/aynetdia/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aynetdia/subscriptions", "organizations_url": "https://api.github.com/users/aynetdia/orgs", "repos_url": "https://api.github.com/users/aynetdia/repos", "events_url": "https://api.github.com/users/aynetdia/events{/privacy}", "received_events_url": "https://api.github.com/users/aynetdia/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2022-03-23T20:38:40Z", "updated_at": "2022-03-25T08:35:09Z", "closed_at": "2022-03-25T08:35:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have trained a NER model with using\r\n```\r\nflair==0.10\r\ntorch==1.10.0\r\n```\r\nThen I tried:\r\n```\r\nmodel = SequenceTagger.load('model.pt')\r\n```\r\n\r\n> 2022-03-23 23:20:30,810 loading file model.pt\r\n\r\nIt worked okay, but...\r\n\r\nAfter I tried to load it from another device, where I had\r\n```\r\nflair==0.10\r\ntorch==1.9.1 or torch==1.7.0\r\n```\r\n```\r\nmodel = SequenceTagger.load('model.pt')\r\n```\r\n\r\n\r\n> ---------------------------------------------------------------------------\r\n> ModuleNotFoundError                       Traceback (most recent call last)\r\n> <ipython-input-6-fbd7ba4c5096> in <module>\r\n> ----> 1 model = SequenceTagger.load('model.pt')\r\n> \r\n> ~\\anaconda3\\lib\\site-packages\\flair\\nn\\model.py in load(cls, model)\r\n>     131             # see https://github.com/zalandoresearch/flair/issues/351\r\n>     132             f = file_utils.load_big_file(str(model_file))\r\n> --> 133             state = torch.load(f, map_location='cpu')\r\n>     134 \r\n>     135         model = cls._init_model_with_state_dict(state)\r\n> \r\n> ~\\anaconda3\\lib\\site-packages\\torch\\serialization.py in load(f, map_location, pickle_module, **pickle_load_args)\r\n>     605                     opened_file.seek(orig_position)\r\n>     606                     return torch.jit.load(opened_file)\r\n> --> 607                 return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)\r\n>     608         return _legacy_load(opened_file, map_location, pickle_module, **pickle_load_args)\r\n>     609 \r\n> \r\n> ~\\anaconda3\\lib\\site-packages\\torch\\serialization.py in _load(zip_file, map_location, pickle_module, pickle_file, **pickle_load_args)\r\n>     880     unpickler = UnpicklerWrapper(data_file, **pickle_load_args)\r\n>     881     unpickler.persistent_load = persistent_load\r\n> --> 882     result = unpickler.load()\r\n>     883 \r\n>     884     torch._utils._validate_loaded_sparse_tensors()\r\n> \r\n> ~\\anaconda3\\lib\\site-packages\\torch\\serialization.py in find_class(self, mod_name, name)\r\n>     873         def find_class(self, mod_name, name):\r\n>     874             mod_name = load_module_mapping.get(mod_name, mod_name)\r\n> --> 875             return super().find_class(mod_name, name)\r\n>     876 \r\n>     877     # Load the data (which may in turn use `persistent_load` to load tensors)\r\n> \r\n> ModuleNotFoundError: No module named 'torch.torch_version'\r\n\r\n\r\nI don\u2019t know if this is normal, but I would like to clarify if I made a mistake somewhere or if this is a bug.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2687/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2687/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2683", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2683/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2683/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2683/events", "html_url": "https://github.com/flairNLP/flair/issues/2683", "id": 1175046141, "node_id": "I_kwDOCCkmXM5GCcf9", "number": 2683, "title": "Wrong Detection - person entity", "user": {"login": "karthicknarasimhan98", "id": 55129453, "node_id": "MDQ6VXNlcjU1MTI5NDUz", "avatar_url": "https://avatars.githubusercontent.com/u/55129453?v=4", "gravatar_id": "", "url": "https://api.github.com/users/karthicknarasimhan98", "html_url": "https://github.com/karthicknarasimhan98", "followers_url": "https://api.github.com/users/karthicknarasimhan98/followers", "following_url": "https://api.github.com/users/karthicknarasimhan98/following{/other_user}", "gists_url": "https://api.github.com/users/karthicknarasimhan98/gists{/gist_id}", "starred_url": "https://api.github.com/users/karthicknarasimhan98/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/karthicknarasimhan98/subscriptions", "organizations_url": "https://api.github.com/users/karthicknarasimhan98/orgs", "repos_url": "https://api.github.com/users/karthicknarasimhan98/repos", "events_url": "https://api.github.com/users/karthicknarasimhan98/events{/privacy}", "received_events_url": "https://api.github.com/users/karthicknarasimhan98/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-03-21T08:22:26Z", "updated_at": "2022-09-09T02:02:36Z", "closed_at": "2022-09-09T02:02:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nFor any person entity, the prediction are added along with \"hey\"\r\nEg: \"Hey Karthick\"\r\n\r\n**To Reproduce**\r\nModel name - ner-english-fast, ner-english\r\nSteps to reproduce the behavior (e.g. which model did you train? what parameters did you use? etc.).\r\n\r\n**Expected behavior**\r\nEg: \"Hey Karthick\"\r\nPredicitons from model: Hey Karthick PER\r\nExpected predictions: Karthick PER\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n<img width=\"701\" alt=\"Screenshot 2022-03-21 at 1 47 22 PM\" src=\"https://user-images.githubusercontent.com/55129453/159224981-41008757-4646-42b4-9814-029fdb235e85.png\">\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2683/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2683/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2682", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2682/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2682/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2682/events", "html_url": "https://github.com/flairNLP/flair/issues/2682", "id": 1174463277, "node_id": "I_kwDOCCkmXM5GAOMt", "number": 2682, "title": "Flair is using GPU space on multiple GPUs ", "user": {"login": "kashtabhanjan", "id": 101965771, "node_id": "U_kgDOBhPfyw", "avatar_url": "https://avatars.githubusercontent.com/u/101965771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kashtabhanjan", "html_url": "https://github.com/kashtabhanjan", "followers_url": "https://api.github.com/users/kashtabhanjan/followers", "following_url": "https://api.github.com/users/kashtabhanjan/following{/other_user}", "gists_url": "https://api.github.com/users/kashtabhanjan/gists{/gist_id}", "starred_url": "https://api.github.com/users/kashtabhanjan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kashtabhanjan/subscriptions", "organizations_url": "https://api.github.com/users/kashtabhanjan/orgs", "repos_url": "https://api.github.com/users/kashtabhanjan/repos", "events_url": "https://api.github.com/users/kashtabhanjan/events{/privacy}", "received_events_url": "https://api.github.com/users/kashtabhanjan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-03-20T07:33:49Z", "updated_at": "2022-09-09T02:02:34Z", "closed_at": "2022-09-09T02:02:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nFlair is not working as expected with multiple GPUs. I have two GPUs and I'm using multiprocessing to parallelize the flair NER tagging on my data. When I create a subprocess to initialize a GPU, I specify the device to be used for `flair.device`. This works for a few seconds (5-10 seconds), but after that time, all GPU instances start using `cuda:0`. Ideally, flair instances should keep running on devices specified earlier. \r\n\r\n**Screenshots**\r\n\r\nInitially: \r\n<img width=\"482\" alt=\"image\" src=\"https://user-images.githubusercontent.com/101965771/159152546-8c69ce14-e794-4c42-83a2-92936dc51483.png\">\r\n\r\nAfter few seconds: \r\n<img width=\"484\" alt=\"image\" src=\"https://user-images.githubusercontent.com/101965771/159152556-3a44d949-fb80-4724-b301-86d44157f09b.png\">\r\n\r\nHowever, this works as expected when we specify the default GPU 0 to use. \r\n\r\n**To Reproduce**\r\nHere is my code: \r\n\r\n```python\r\nimport re\r\nimport time\r\nimport uuid\r\nfrom datetime import datetime, timedelta\r\nfrom torch.multiprocessing import Pool, RLock\r\nfrom torch.multiprocessing import current_process, freeze_support, Manager, set_start_method\r\nfrom queue import Empty\r\n\r\nimport numpy as np\r\nimport pandas as pd \r\n\r\nfrom flair.data import Sentence\r\nfrom flair.models import SequenceTagger\r\nimport stanza\r\n\r\nimport gc\r\nimport torch\r\n\r\n\r\n\r\nimport unidecode\r\nfrom tqdm import tqdm, tqdm_pandas\r\n\r\nimport logging\r\n\r\nlogger = logging.getLogger('flair')\r\nlogger.setLevel(logging.ERROR)\r\n\r\n            \r\ndef flair_tag(args):  \r\n    import flair\r\n    \r\n    (consumer_queue, producer_queue), device = args\r\n    flair.device = torch.device(f\"cuda:{device}\")\r\n    \r\n    tagger = SequenceTagger.load(\"ner\") \r\n    gc.collect()\r\n    torch.cuda.empty_cache()\r\n    \r\n    while True:\r\n        try:\r\n            mini_batch = consumer_queue.get_nowait()\r\n            mini_batch_processed = []\r\n            for row in mini_batch:\r\n                text, uuid = row\r\n\r\n                sentence = Sentence(text)\r\n                tagger.predict(sentence)\r\n                \r\n                mini_batch_processed.append([uuid, sentence.get_spans('ner')])\r\n            producer_queue.put(mini_batch_processed)\r\n        except Empty as e:\r\n            return \r\n            \r\n\r\nif __name__ == '__main__':\r\n    set_start_method('spawn')\r\n    print(\"Reading data for tokenization\")\r\n    df = pd.read_csv(\"data_sample_for_testing.csv.gz\", compression=\"gzip\")\r\n    \r\n    print(\"Enqueueing data in a shared queue\")\r\n    sub_df = df[['text', 'uuid']]\r\n    mini_batch_size = 128\r\n    mini_batches = np.array_split(sub_df, len(df)//mini_batch_size)\r\n    \r\n    manager = Manager()\r\n    consumer_queue = manager.Queue()\r\n    producer_queue = manager.Queue()  \r\n    \r\n    for mini_batch in tqdm(mini_batches, desc=\"Enqueueing data: \"):\r\n        consumer_queue.put(mini_batch.values)\r\n    \r\n    print(\"data enqueued\")\r\n    \r\n    nprocesses = 8\r\n    data = [(consumer_queue, producer_queue)]*nprocesses\r\n    gpu_mappings = [0]*(nprocesses//2) + [1]*(nprocesses//2)\r\n    data = list(zip(data, gpu_mappings))\r\n\r\n    pool = Pool(nprocesses)\r\n    results = pool.map_async(flair_tag, data)\r\n\r\n    pool.close()\r\n    pool.join()\r\n\r\n    res_vals = []\r\n    print(\"Dequeueing produced results\")\r\n    for _ in tqdm(range(len(mini_batches))):\r\n        res_vals.extend(producer_queue.get())\r\n\r\n    df_res = pd.DataFrame(res_vals, columns=['uuid', 'flair_spans'])\r\n    df_tokenized = pd.merge(df, df_res, how='left', on=['uuid'])\r\n    df_tokenized.to_pickle(\"sample_v3.csv.gz.pkl\", header=True, index=False, compression=\"gzip\")\r\n    \r\n    print(\"Data dumped\")\r\n```\r\n\r\n**Expected behavior**\r\nThe instances should be run on the specified device during the entire runtime. \r\n\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Linux\r\n - Version 0.10:", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2682/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2682/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2670", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2670/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2670/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2670/events", "html_url": "https://github.com/flairNLP/flair/issues/2670", "id": 1167452792, "node_id": "I_kwDOCCkmXM5Flep4", "number": 2670, "title": "Cannot load TransformerWordEmbeddings as part of StackedEmbeddings", "user": {"login": "why-in-Shanghaitech", "id": 43395692, "node_id": "MDQ6VXNlcjQzMzk1Njky", "avatar_url": "https://avatars.githubusercontent.com/u/43395692?v=4", "gravatar_id": "", "url": "https://api.github.com/users/why-in-Shanghaitech", "html_url": "https://github.com/why-in-Shanghaitech", "followers_url": "https://api.github.com/users/why-in-Shanghaitech/followers", "following_url": "https://api.github.com/users/why-in-Shanghaitech/following{/other_user}", "gists_url": "https://api.github.com/users/why-in-Shanghaitech/gists{/gist_id}", "starred_url": "https://api.github.com/users/why-in-Shanghaitech/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/why-in-Shanghaitech/subscriptions", "organizations_url": "https://api.github.com/users/why-in-Shanghaitech/orgs", "repos_url": "https://api.github.com/users/why-in-Shanghaitech/repos", "events_url": "https://api.github.com/users/why-in-Shanghaitech/events{/privacy}", "received_events_url": "https://api.github.com/users/why-in-Shanghaitech/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "plonerma", "id": 34100829, "node_id": "MDQ6VXNlcjM0MTAwODI5", "avatar_url": "https://avatars.githubusercontent.com/u/34100829?v=4", "gravatar_id": "", "url": "https://api.github.com/users/plonerma", "html_url": "https://github.com/plonerma", "followers_url": "https://api.github.com/users/plonerma/followers", "following_url": "https://api.github.com/users/plonerma/following{/other_user}", "gists_url": "https://api.github.com/users/plonerma/gists{/gist_id}", "starred_url": "https://api.github.com/users/plonerma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/plonerma/subscriptions", "organizations_url": "https://api.github.com/users/plonerma/orgs", "repos_url": "https://api.github.com/users/plonerma/repos", "events_url": "https://api.github.com/users/plonerma/events{/privacy}", "received_events_url": "https://api.github.com/users/plonerma/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "plonerma", "id": 34100829, "node_id": "MDQ6VXNlcjM0MTAwODI5", "avatar_url": "https://avatars.githubusercontent.com/u/34100829?v=4", "gravatar_id": "", "url": "https://api.github.com/users/plonerma", "html_url": "https://github.com/plonerma", "followers_url": "https://api.github.com/users/plonerma/followers", "following_url": "https://api.github.com/users/plonerma/following{/other_user}", "gists_url": "https://api.github.com/users/plonerma/gists{/gist_id}", "starred_url": "https://api.github.com/users/plonerma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/plonerma/subscriptions", "organizations_url": "https://api.github.com/users/plonerma/orgs", "repos_url": "https://api.github.com/users/plonerma/repos", "events_url": "https://api.github.com/users/plonerma/events{/privacy}", "received_events_url": "https://api.github.com/users/plonerma/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2022-03-13T01:49:32Z", "updated_at": "2022-03-24T02:12:25Z", "closed_at": "2022-03-24T02:12:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nEverything is fine unless I load the model from `best-model.pt`. The result is totally different from what I've seen during training (the model behaves like it is never ever trained).\r\nIn my case, any model built with a `StackedEmbeddings` embedding containing `TransformerWordEmbeddings` and any other unstatic embeddings will cause the bug.\r\n\r\n**To Reproduce**\r\nThis bug is only related to embeddings. Create the embeddings using this code:\r\n\r\n```python\r\nword_embedding = WordEmbeddings(...)\r\ncharacter_embedding = CharacterEmbeddings(...)\r\ntrans_embedding = TransformerWordEmbeddings(model = \"roberta-large\")\r\nembeddings: StackedEmbeddings = StackedEmbeddings(embeddings=[word_embedding, character_embedding ,trans_embedding])\r\n```\r\n\r\nThen train with any model you like. The final result would just like the result from a randomly initialized model.\r\n\r\n**Expected behavior**\r\nThe final result should at least look like it is trained...\r\n\r\n**Screenshots**\r\nAsk me to provide a screenshot if needed.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Linux\r\n - Version [e.g. flair-0.3.2]: flair-0.8.0.post1, flair-0.10\r\n\r\n**Additional context**\r\nI think the problem lies in the codes here:\r\n\r\nhttps://github.com/flairNLP/flair/blob/da7c12b08f377f7e66e9593af7b740351819d7d0/flair/embeddings/base.py#L449\r\n\r\nThe name of this embedding is overridden unexpectedly. In `StackedEmbeddings`, we rename all the child embeddings by adding a number in front of it.\r\n\r\nI'm not sure whether this is fixed in the main branch. I fixed this bug just by adding this line of code:\r\n\r\n```python\r\nif key != 'name':\r\n    self.__dict__[key] = embedding.__dict__[key]\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2670/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2670/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2668", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2668/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2668/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2668/events", "html_url": "https://github.com/flairNLP/flair/issues/2668", "id": 1166599270, "node_id": "I_kwDOCCkmXM5FiORm", "number": 2668, "title": "ModelTrainer doesn't seem to be supporting tensorboard", "user": {"login": "tanujjain", "id": 9531254, "node_id": "MDQ6VXNlcjk1MzEyNTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/9531254?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanujjain", "html_url": "https://github.com/tanujjain", "followers_url": "https://api.github.com/users/tanujjain/followers", "following_url": "https://api.github.com/users/tanujjain/following{/other_user}", "gists_url": "https://api.github.com/users/tanujjain/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanujjain/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanujjain/subscriptions", "organizations_url": "https://api.github.com/users/tanujjain/orgs", "repos_url": "https://api.github.com/users/tanujjain/repos", "events_url": "https://api.github.com/users/tanujjain/events{/privacy}", "received_events_url": "https://api.github.com/users/tanujjain/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "lukasgarbas", "id": 33124203, "node_id": "MDQ6VXNlcjMzMTI0MjAz", "avatar_url": "https://avatars.githubusercontent.com/u/33124203?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lukasgarbas", "html_url": "https://github.com/lukasgarbas", "followers_url": "https://api.github.com/users/lukasgarbas/followers", "following_url": "https://api.github.com/users/lukasgarbas/following{/other_user}", "gists_url": "https://api.github.com/users/lukasgarbas/gists{/gist_id}", "starred_url": "https://api.github.com/users/lukasgarbas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lukasgarbas/subscriptions", "organizations_url": "https://api.github.com/users/lukasgarbas/orgs", "repos_url": "https://api.github.com/users/lukasgarbas/repos", "events_url": "https://api.github.com/users/lukasgarbas/events{/privacy}", "received_events_url": "https://api.github.com/users/lukasgarbas/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "lukasgarbas", "id": 33124203, "node_id": "MDQ6VXNlcjMzMTI0MjAz", "avatar_url": "https://avatars.githubusercontent.com/u/33124203?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lukasgarbas", "html_url": "https://github.com/lukasgarbas", "followers_url": "https://api.github.com/users/lukasgarbas/followers", "following_url": "https://api.github.com/users/lukasgarbas/following{/other_user}", "gists_url": "https://api.github.com/users/lukasgarbas/gists{/gist_id}", "starred_url": "https://api.github.com/users/lukasgarbas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lukasgarbas/subscriptions", "organizations_url": "https://api.github.com/users/lukasgarbas/orgs", "repos_url": "https://api.github.com/users/lukasgarbas/repos", "events_url": "https://api.github.com/users/lukasgarbas/events{/privacy}", "received_events_url": "https://api.github.com/users/lukasgarbas/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2022-03-11T16:09:54Z", "updated_at": "2022-03-21T06:10:35Z", "closed_at": "2022-03-21T06:10:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n`ModelTrainer` should be able to support tensorboard through parameters: `use_tensorboard` and `tensorboard_log_dir`, but trying to use these parameters throws a `TypeError: __init__() got an unexpected keyword argument 'use_tensorboard' `error. Looking at https://github.com/flairNLP/flair/blob/04901216e817e9df77adc92d4c37a2fffd398c73/flair/trainers/trainer.py#L119 I expect these parameters to be supported.\r\n\r\n**To Reproduce**\r\n```\r\nfrom flair.trainers import ModelTrainer\r\n## initialize tagger and corpus\r\n\r\ntrainer: ModelTrainer = ModelTrainer(tagger, corpus)\r\ntrainer.train(use_tensorboard=True, tensorboard_log_dir='path/to/dir')\r\n```\r\n\r\n**Expected behavior**\r\nThe training runs through and tensorboard is accessible with `tensorboard --logdir=tensorboard_log_dir`\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - OS : macOS Catalina\r\n - Version: flair==0.9\r\n\r\nAny other way to include tensorboard logging with ModelTrainer?\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2668/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2668/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2665", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2665/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2665/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2665/events", "html_url": "https://github.com/flairNLP/flair/pull/2665", "id": 1165013859, "node_id": "PR_kwDOCCkmXM40Oh6c", "number": 2665, "title": "GH-2654: Fixed printing and logging inconsistencies.", "user": {"login": "Xabilahu", "id": 13916396, "node_id": "MDQ6VXNlcjEzOTE2Mzk2", "avatar_url": "https://avatars.githubusercontent.com/u/13916396?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Xabilahu", "html_url": "https://github.com/Xabilahu", "followers_url": "https://api.github.com/users/Xabilahu/followers", "following_url": "https://api.github.com/users/Xabilahu/following{/other_user}", "gists_url": "https://api.github.com/users/Xabilahu/gists{/gist_id}", "starred_url": "https://api.github.com/users/Xabilahu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Xabilahu/subscriptions", "organizations_url": "https://api.github.com/users/Xabilahu/orgs", "repos_url": "https://api.github.com/users/Xabilahu/repos", "events_url": "https://api.github.com/users/Xabilahu/events{/privacy}", "received_events_url": "https://api.github.com/users/Xabilahu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2022-03-10T10:08:29Z", "updated_at": "2022-03-14T07:58:32Z", "closed_at": "2022-03-14T07:58:32Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/flairNLP/flair/pulls/2665", "html_url": "https://github.com/flairNLP/flair/pull/2665", "diff_url": "https://github.com/flairNLP/flair/pull/2665.diff", "patch_url": "https://github.com/flairNLP/flair/pull/2665.patch", "merged_at": "2022-03-14T07:58:32Z"}, "body": "This PR closes https://github.com/flairNLP/flair/issues/2654.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2665/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2665/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2663", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2663/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2663/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2663/events", "html_url": "https://github.com/flairNLP/flair/issues/2663", "id": 1163844728, "node_id": "I_kwDOCCkmXM5FXtx4", "number": 2663, "title": "CUDA oom with embeddings_storage_mode=\"cpu\"", "user": {"login": "philipp-kohl", "id": 82207307, "node_id": "MDQ6VXNlcjgyMjA3MzA3", "avatar_url": "https://avatars.githubusercontent.com/u/82207307?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philipp-kohl", "html_url": "https://github.com/philipp-kohl", "followers_url": "https://api.github.com/users/philipp-kohl/followers", "following_url": "https://api.github.com/users/philipp-kohl/following{/other_user}", "gists_url": "https://api.github.com/users/philipp-kohl/gists{/gist_id}", "starred_url": "https://api.github.com/users/philipp-kohl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philipp-kohl/subscriptions", "organizations_url": "https://api.github.com/users/philipp-kohl/orgs", "repos_url": "https://api.github.com/users/philipp-kohl/repos", "events_url": "https://api.github.com/users/philipp-kohl/events{/privacy}", "received_events_url": "https://api.github.com/users/philipp-kohl/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-03-09T11:54:51Z", "updated_at": "2022-08-01T05:53:17Z", "closed_at": "2022-08-01T05:53:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nHi everyone,\r\nI try to train a classification model with flair. Due to long documents I wanted to store the embeddings in RAM. Hence, I set embeddings_storage_mode=\"cpu\". But I faced the issue that my GPU memory is allocated linearly until no more memory is available (48GB). Setting embeddings_storage_mode=\"none\" fixed the issue for me. I understand the documentation in the way that in every batch the embeddings will be transferred to the mentioned device. But it seems that this is not happening in this case. The computation fails in the first epoch. Surprisingly (for me) this can also be fixed with a higher batch size.\r\n\r\nFYI: My corpus is not that big: ~ 3000 documents.\r\n\r\n```\r\n2022-03-09 12:38:06,332 ----------------------------------------------------------------------------------------------------\r\n2022-03-09 12:38:06,332 Corpus: \"Corpus: 2131 train + 457 dev + 456 test sentences\"\r\n2022-03-09 12:38:06,332 ----------------------------------------------------------------------------------------------------\r\n2022-03-09 12:38:06,333 Parameters:\r\n2022-03-09 12:38:06,333  - learning_rate: \"0.003\"\r\n2022-03-09 12:38:06,333  - mini_batch_size: \"1\"\r\n2022-03-09 12:38:06,333  - patience: \"2\"\r\n2022-03-09 12:38:06,333  - anneal_factor: \"0.5\"\r\n2022-03-09 12:38:06,333  - max_epochs: \"400\"\r\n2022-03-09 12:38:06,333  - shuffle: \"True\"\r\n2022-03-09 12:38:06,333  - train_with_dev: \"False\"\r\n2022-03-09 12:38:06,333  - batch_growth_annealing: \"False\"\r\n2022-03-09 12:38:06,333 ----------------------------------------------------------------------------------------------------\r\n2022-03-09 12:38:06,333 Model training base path: \"models/textcat_flair_trf/model\"\r\n2022-03-09 12:38:06,333 ----------------------------------------------------------------------------------------------------\r\n2022-03-09 12:38:06,333 Device: cuda:0\r\n2022-03-09 12:38:06,333 ----------------------------------------------------------------------------------------------------\r\n2022-03-09 12:38:06,333 Embeddings storage mode: cpu\r\n2022-03-09 12:38:06,336 ----------------------------------------------------------------------------------------------------\r\n2022-03-09 12:38:16,887 epoch 1 - iter 213/2131 - loss 0.18355409 - samples/sec: 20.20 - lr: 0.003000                                \r\n2022-03-09 12:38:27,849 epoch 1 - iter 426/2131 - loss 0.16106707 - samples/sec: 19.45 - lr: 0.003000                                \r\n2022-03-09 12:38:37,837 epoch 1 - iter 639/2131 - loss 0.14019156 - samples/sec: 21.34 - lr: 0.003000                                \r\n2022-03-09 12:38:48,250 epoch 1 - iter 852/2131 - loss 0.13683440 - samples/sec: 20.47 - lr: 0.003000                                \r\n2022-03-09 12:38:58,480 epoch 1 - iter 1065/2131 - loss 0.12751414 - samples/sec: 20.84 - lr: 0.003000                               \r\n2022-03-09 12:39:08,909 epoch 1 - iter 1278/2131 - loss 0.12958945 - samples/sec: 20.44 - lr: 0.003000                               \r\n2022-03-09 12:39:19,564 epoch 1 - iter 1491/2131 - loss 0.12343366 - samples/sec: 20.01 - lr: 0.003000                               \r\n2022-03-09 12:39:30,485 epoch 1 - iter 1704/2131 - loss 0.11901164 - samples/sec: 19.52 - lr: 0.003000                               \r\n2022-03-09 12:39:41,196 epoch 1 - iter 1917/2131 - loss 0.11457392 - samples/sec: 19.90 - lr: 0.003000\r\nTraceback (most recent call last):                                                                                                      \r\n  File \"trainer.py\", line 62, in <module>                                                                     \r\n    cmd_train()                                                                                                                         \r\n  File \".../lib/python3.8/site-packages/click/core.py\", line 829, in __call__              \r\n    return self.main(*args, **kwargs)                                                                                                   \r\n  File \".../lib/python3.8/site-packages/click/core.py\", line 782, in main                  \r\n    rv = self.invoke(ctx)                                                                                                               \r\n  File \".../lib/python3.8/site-packages/click/core.py\", line 1066, in invoke               \r\n    return ctx.invoke(self.callback, **ctx.params)                                                                                      \r\n  File \".../lib/python3.8/site-packages/click/core.py\", line 610, in invoke                \r\n    return callback(*args, **kwargs)                                                                                                    \r\n  File \"./iorder4you/models/flair/trainer.py\", line 45, in cmd_train                                                                    \r\n    trainer.train(                                                                                                                      \r\n  File \".../lib/python3.8/site-packages/flair/trainers/trainer.py\", line 467, in train     \r\n    loss = self.model.forward_loss(batch_step)                                                                                          \r\n  File \".../lib/python3.8/site-packages/flair/nn/model.py\", line 489, in forward_loss      \r\n    scores, labels = self.forward_pass(sentences)                                                                                       \r\n  File \".../lib/python3.8/site-packages/flair/models/text_classification_model.py\", line 60\r\n, in forward_pass                                                                                                                       \r\n    self.document_embeddings.embed(sentences)                                                                                           \r\n  File \".../lib/python3.8/site-packages/flair/embeddings/base.py\", line 60, in embed       \r\n    self._add_embeddings_internal(sentences)                                                                                            \r\n  File \".../lib/python3.8/site-packages/flair/embeddings/document.py\", line 158, in _add_em\r\nbeddings_internal                                                                                                                       \r\n    else self.model(input_ids)[-1]                                                                                                      \r\n  File \".../lib/python3.8/site-packages/torch/nn/modules/module.py\", line 1102, in _call_impl \r\n    return forward_call(*input, **kwargs)                                                                                               \r\n  File \".../lib/python3.8/site-packages/transformers/models/bert/modeling_bert.py\", line 99\r\n6, in forward                                                                                                                           \r\n    encoder_outputs = self.encoder(                                                                                                     \r\n  File \".../lib/python3.8/site-packages/torch/nn/modules/module.py\", line 1102, in _call_im\r\npl                                                                                                                                      \r\n    return forward_call(*input, **kwargs)                                                                                               \r\n  File \".../lib/python3.8/site-packages/transformers/models/bert/modeling_bert.py\", line 58\r\n5, in forward                                                                                                                           \r\n    layer_outputs = layer_module(                                                                                                       \r\n  File \".../lib/python3.8/site-packages/torch/nn/modules/module.py\", line 1102, in _call_im\r\npl                                                                                                                                      \r\n    return forward_call(*input, **kwargs)                                                                                               \r\n  File \".../lib/python3.8/site-packages/transformers/models/bert/modeling_bert.py\", line 47\r\n2, in forward                                                                                                                           \r\n    self_attention_outputs = self.attention(                                                                                            \r\n  File \".../lib/python3.8/site-packages/torch/nn/modules/module.py\", line 1102, in _call_im\r\npl                                                                                                                                      \r\n    return forward_call(*input, **kwargs)                                                                                               \r\n  File \".../lib/python3.8/site-packages/transformers/models/bert/modeling_bert.py\", line 40\r\n2, in forward                                                                                                                           \r\n    self_outputs = self.self(                                                                                                           \r\n  File \".../lib/python3.8/site-packages/torch/nn/modules/module.py\", line 1102, in _call_im\r\npl                                                                                                                                      \r\n    return forward_call(*input, **kwargs)                                                                                               \r\n  File \".../lib/python3.8/site-packages/transformers/models/bert/modeling_bert.py\", line 34\r\n2, in forward                                                                                                                           \r\n    context_layer = context_layer.permute(0, 2, 1, 3).contiguous()                                                                      \r\nRuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 47.54 GiB total capacity; 45.49 GiB already allocated; 7.25 MiB fr\r\nee; 45.50 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentati\r\non.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF\r\n```\r\n\r\n**To Reproduce**\r\nMy corpus is not public. \r\n```\r\n# 1. get the corpus\r\n    corpus: Corpus = JsonlCorpus(train_path, \"train.jsonl\", \"test.jsonl\", \"dev.jsonl\") # https://github.com/flairNLP/flair/pull/2653\r\n\r\n    # 2. what label do we want to predict?\r\n    label_type = \"category\"\r\n\r\n    # 3. create the label dictionary\r\n    label_dict = corpus.make_label_dictionary(label_type=label_type)\r\n\r\n    # 4. initialize transformer document embeddings (many models are available)\r\n    document_embeddings = TransformerDocumentEmbeddings(\"deepset/gbert-base\", fine_tune=True)\r\n\r\n    # 5. create the text classifier\r\n    classifier = TextClassifier(\r\n        document_embeddings, multi_label=True, label_dictionary=label_dict, label_type=label_type\r\n    )\r\n\r\n    # 6. initialize trainer\r\n    trainer = ModelTrainer(classifier, corpus)\r\n\r\n    # 7. run training with fine-tuning\r\n    trainer.train(\r\n        model_path,\r\n        learning_rate=0.003,\r\n        mini_batch_size=1,\r\n        max_epochs=400,\r\n        min_learning_rate=1e-7,\r\n        #optimizer=AdamW,\r\n        patience=2,\r\n        main_evaluation_metric=(\"macro avg\", \"f1-score\"),\r\n        embeddings_storage_mode=\"cpu\",\r\n    )\r\n```\r\n\r\n**Expected behavior**\r\nNot allocating more and more GPU memory, due to transferring the embeddings to RAM.\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - Linux:\r\n - flair:0.10:\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2663/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2663/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2661", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2661/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2661/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2661/events", "html_url": "https://github.com/flairNLP/flair/issues/2661", "id": 1162418063, "node_id": "I_kwDOCCkmXM5FSReP", "number": 2661, "title": "URL endpoints within flair to fetch model/files not working", "user": {"login": "thekeshavgoel", "id": 12809675, "node_id": "MDQ6VXNlcjEyODA5Njc1", "avatar_url": "https://avatars.githubusercontent.com/u/12809675?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thekeshavgoel", "html_url": "https://github.com/thekeshavgoel", "followers_url": "https://api.github.com/users/thekeshavgoel/followers", "following_url": "https://api.github.com/users/thekeshavgoel/following{/other_user}", "gists_url": "https://api.github.com/users/thekeshavgoel/gists{/gist_id}", "starred_url": "https://api.github.com/users/thekeshavgoel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thekeshavgoel/subscriptions", "organizations_url": "https://api.github.com/users/thekeshavgoel/orgs", "repos_url": "https://api.github.com/users/thekeshavgoel/repos", "events_url": "https://api.github.com/users/thekeshavgoel/events{/privacy}", "received_events_url": "https://api.github.com/users/thekeshavgoel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-03-08T09:25:33Z", "updated_at": "2022-03-09T09:55:42Z", "closed_at": "2022-03-09T09:55:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nFailing to execute `TARSClassifier.load(model=\"tars-base\")` when running first time, i.e. the `tars-base-v8.pt` file isn't already downloaded and cached locally.\r\nWhen trying to load the model for first time, getting following error:\r\n```\r\n raise IOError(\r\nOSError: HEAD request failed for url https://nlp.informatik.hu-berlin.de/resources/models/tars-base/tars-base-v8.pt with status code 503.\r\n```\r\n\r\n**To Reproduce**\r\nClear the `~/.flair/model/tars-base-v8.pt`, and try executing `TARSClassifier.load(model=\"tars-base\")`\r\n\r\n**Expected behavior**\r\nThe file should have downloaded and model loaded successfully.\r\n\r\n**Environment (please complete the following information):**\r\n - OS : Linux and OSX\r\n - Version : flair >= 0.10\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2661/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2661/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2660", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2660/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2660/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2660/events", "html_url": "https://github.com/flairNLP/flair/issues/2660", "id": 1162349928, "node_id": "I_kwDOCCkmXM5FSA1o", "number": 2660, "title": "503 WordEmbeddings error", "user": {"login": "laura-barkauskaite", "id": 41318074, "node_id": "MDQ6VXNlcjQxMzE4MDc0", "avatar_url": "https://avatars.githubusercontent.com/u/41318074?v=4", "gravatar_id": "", "url": "https://api.github.com/users/laura-barkauskaite", "html_url": "https://github.com/laura-barkauskaite", "followers_url": "https://api.github.com/users/laura-barkauskaite/followers", "following_url": "https://api.github.com/users/laura-barkauskaite/following{/other_user}", "gists_url": "https://api.github.com/users/laura-barkauskaite/gists{/gist_id}", "starred_url": "https://api.github.com/users/laura-barkauskaite/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/laura-barkauskaite/subscriptions", "organizations_url": "https://api.github.com/users/laura-barkauskaite/orgs", "repos_url": "https://api.github.com/users/laura-barkauskaite/repos", "events_url": "https://api.github.com/users/laura-barkauskaite/events{/privacy}", "received_events_url": "https://api.github.com/users/laura-barkauskaite/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2022-03-08T08:13:41Z", "updated_at": "2022-03-09T09:55:39Z", "closed_at": "2022-03-09T09:55:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am trying to load embeddings and I keep getting the following error:\r\n\r\n  File \"/root/.local/lib/python3.7/site-packages/trainer/train.py\", line 194, in <module>\r\n    embedding = WordEmbeddings('en')\r\n  File \"/root/.local/lib/python3.7/site-packages/flair/embeddings/token.py\", line 163, in __init__\r\n    cached_path(f\"{hu_path}/en-fasttext-news-300d-1M.vectors.npy\", cache_dir=cache_dir)\r\n  File \"/root/.local/lib/python3.7/site-packages/flair/file_utils.py\", line 91, in cached_path\r\n    return get_from_cache(url_or_filename, dataset_cache)\r\n  File \"/root/.local/lib/python3.7/site-packages/flair/file_utils.py\", line 220, in get_from_cache\r\n    f\"HEAD request failed for url {url} with status code {response.status_code}.\"\r\nOSError: HEAD request failed for url https://flair.informatik.hu-berlin.de/resources/embeddings/token/en-fasttext-news-300d-1M.vectors.npy with status code 503.\r\n\r\nWhen I try to manually reach https://nlp.informatik.hu-berlin.de/resources/ I also get 503.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2660/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2660/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2655", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2655/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2655/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2655/events", "html_url": "https://github.com/flairNLP/flair/issues/2655", "id": 1159591142, "node_id": "I_kwDOCCkmXM5FHfTm", "number": 2655, "title": "broken link", "user": {"login": "thomashallam", "id": 10573663, "node_id": "MDQ6VXNlcjEwNTczNjYz", "avatar_url": "https://avatars.githubusercontent.com/u/10573663?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thomashallam", "html_url": "https://github.com/thomashallam", "followers_url": "https://api.github.com/users/thomashallam/followers", "following_url": "https://api.github.com/users/thomashallam/following{/other_user}", "gists_url": "https://api.github.com/users/thomashallam/gists{/gist_id}", "starred_url": "https://api.github.com/users/thomashallam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thomashallam/subscriptions", "organizations_url": "https://api.github.com/users/thomashallam/orgs", "repos_url": "https://api.github.com/users/thomashallam/repos", "events_url": "https://api.github.com/users/thomashallam/events{/privacy}", "received_events_url": "https://api.github.com/users/thomashallam/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-03-04T12:24:12Z", "updated_at": "2022-03-09T14:32:16Z", "closed_at": "2022-03-09T14:32:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nBroken link on line 108 in the file https://github.com/flairNLP/flair/tree/master/examples/ner\r\nreferences paper \r\n[FLERT](ttps://arxiv.org/abs/2011.06993) paper.\r\n\r\n**To Reproduce**\r\nOpen page Github or Vscode or R can see the link is broken\r\n\r\n**Expected behavior**\r\nLink to correct page: https://arxiv.org/abs/2011.06993\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2655/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2655/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2654", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2654/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2654/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2654/events", "html_url": "https://github.com/flairNLP/flair/issues/2654", "id": 1158777992, "node_id": "I_kwDOCCkmXM5FEYyI", "number": 2654, "title": "printing and logging inconsistencies", "user": {"login": "Xabilahu", "id": 13916396, "node_id": "MDQ6VXNlcjEzOTE2Mzk2", "avatar_url": "https://avatars.githubusercontent.com/u/13916396?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Xabilahu", "html_url": "https://github.com/Xabilahu", "followers_url": "https://api.github.com/users/Xabilahu/followers", "following_url": "https://api.github.com/users/Xabilahu/following{/other_user}", "gists_url": "https://api.github.com/users/Xabilahu/gists{/gist_id}", "starred_url": "https://api.github.com/users/Xabilahu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Xabilahu/subscriptions", "organizations_url": "https://api.github.com/users/Xabilahu/orgs", "repos_url": "https://api.github.com/users/Xabilahu/repos", "events_url": "https://api.github.com/users/Xabilahu/events{/privacy}", "received_events_url": "https://api.github.com/users/Xabilahu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "Weyaaron", "id": 52529582, "node_id": "MDQ6VXNlcjUyNTI5NTgy", "avatar_url": "https://avatars.githubusercontent.com/u/52529582?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Weyaaron", "html_url": "https://github.com/Weyaaron", "followers_url": "https://api.github.com/users/Weyaaron/followers", "following_url": "https://api.github.com/users/Weyaaron/following{/other_user}", "gists_url": "https://api.github.com/users/Weyaaron/gists{/gist_id}", "starred_url": "https://api.github.com/users/Weyaaron/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Weyaaron/subscriptions", "organizations_url": "https://api.github.com/users/Weyaaron/orgs", "repos_url": "https://api.github.com/users/Weyaaron/repos", "events_url": "https://api.github.com/users/Weyaaron/events{/privacy}", "received_events_url": "https://api.github.com/users/Weyaaron/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "Weyaaron", "id": 52529582, "node_id": "MDQ6VXNlcjUyNTI5NTgy", "avatar_url": "https://avatars.githubusercontent.com/u/52529582?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Weyaaron", "html_url": "https://github.com/Weyaaron", "followers_url": "https://api.github.com/users/Weyaaron/followers", "following_url": "https://api.github.com/users/Weyaaron/following{/other_user}", "gists_url": "https://api.github.com/users/Weyaaron/gists{/gist_id}", "starred_url": "https://api.github.com/users/Weyaaron/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Weyaaron/subscriptions", "organizations_url": "https://api.github.com/users/Weyaaron/orgs", "repos_url": "https://api.github.com/users/Weyaaron/repos", "events_url": "https://api.github.com/users/Weyaaron/events{/privacy}", "received_events_url": "https://api.github.com/users/Weyaaron/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2022-03-03T18:45:54Z", "updated_at": "2022-03-14T07:58:32Z", "closed_at": "2022-03-14T07:58:32Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nThere are several inconsistencies between printing with the native `print` python function and printing with `logging.getLogger('flair')`.\r\n\r\nFor example:\r\nhttps://github.com/flairNLP/flair/blob/9697dc29c03ba7e5513be5a0c4f9902626917616/flair/trainers/trainer.py#L542-L543\r\n\r\nhttps://github.com/flairNLP/flair/blob/9697dc29c03ba7e5513be5a0c4f9902626917616/flair/training_utils.py#L303-L304\r\n\r\n**To Reproduce**\r\n\r\n```\r\nfrom flair.datasets import UD_ENGLISH\r\nfrom flair.embeddings import WordEmbeddings\r\nfrom flair.models import SequenceTagger\r\nfrom flair.trainers import ModelTrainer\r\n\r\n# 1. get the corpus\r\ncorpus = UD_ENGLISH().downsample(0.1)\r\n\r\n# 2. what label do we want to predict?\r\nlabel_type = 'upos'\r\n\r\n# 3. make the label dictionary from the corpus\r\nlabel_dict = corpus.make_label_dictionary(label_type=label_type)\r\n\r\n# 4. initialize embeddings\r\nembeddings = WordEmbeddings('glove')\r\n\r\n# 5. initialize sequence tagger\r\ntagger = SequenceTagger(hidden_size=256,\r\n                        embeddings=embeddings,\r\n                        tag_dictionary=label_dict,\r\n                        tag_type=label_type,\r\n                        use_crf=True\r\n)\r\n\r\n# 6. initialize trainer\r\ntrainer = ModelTrainer(tagger, corpus)\r\n\r\n# 7. start training\r\ntrainer.train('resources/taggers/example-upos',\r\n              learning_rate=0.1,\r\n              mini_batch_size=32,\r\n              max_epochs=10,\r\n              save_model_each_k_epochs=1,\r\n)\r\n```\r\n\r\n**Expected behavior**\r\n\r\nAll messages should be logged using `logger.getLogger('flair')`.\r\n\r\n**Screenshots**\r\n\r\nCheck that the message where learning rate is reduced is not being logged.\r\n\r\n```\r\n2022-03-03 15:49:45,287 ----------------------------------------------------------------------------------------------------\r\n2022-03-03 15:49:49,655 epoch 19 - iter 14/141 - loss 0.02138027 - samples/sec: 57.27 - lr: 0.100000\r\n2022-03-03 15:49:53,916 epoch 19 - iter 28/141 - loss 0.02371238 - samples/sec: 53.10 - lr: 0.100000\r\n2022-03-03 15:49:57,994 epoch 19 - iter 42/141 - loss 0.02502675 - samples/sec: 55.68 - lr: 0.100000\r\n2022-03-03 15:50:02,287 epoch 19 - iter 56/141 - loss 0.02439726 - samples/sec: 52.46 - lr: 0.100000\r\n2022-03-03 15:50:06,238 epoch 19 - iter 70/141 - loss 0.02427097 - samples/sec: 57.13 - lr: 0.100000\r\n2022-03-03 15:50:09,520 epoch 19 - iter 84/141 - loss 0.02436758 - samples/sec: 68.99 - lr: 0.100000\r\n2022-03-03 15:50:12,905 epoch 19 - iter 98/141 - loss 0.02479929 - samples/sec: 66.81 - lr: 0.100000\r\n2022-03-03 15:50:17,367 epoch 19 - iter 112/141 - loss 0.02456275 - samples/sec: 54.21 - lr: 0.100000\r\n2022-03-03 15:50:20,890 epoch 19 - iter 126/141 - loss 0.02462007 - samples/sec: 64.00 - lr: 0.100000\r\n2022-03-03 15:50:24,996 epoch 19 - iter 140/141 - loss 0.02425031 - samples/sec: 54.84 - lr: 0.100000\r\n2022-03-03 15:50:25,464 ----------------------------------------------------------------------------------------------------\r\n2022-03-03 15:50:25,466 EPOCH 19 done: loss 0.0241 - lr 0.1000000\r\n2022-03-03 15:50:30,838 DEV : loss 0.031227365136146545 - f1-score (micro avg)  0.8247\r\nEpoch    19: reducing learning rate of group 0 to 5.0000e-02.\r\n2022-03-03 15:50:31,099 BAD EPOCHS (no improvement): 4\r\n2022-03-03 15:50:31,102 ----------------------------------------------------------------------------------------------------\r\n2022-03-03 15:50:34,923 epoch 20 - iter 14/141 - loss 0.02504787 - samples/sec: 65.37 - lr: 0.050000\r\n2022-03-03 15:50:39,327 epoch 20 - iter 28/141 - loss 0.02588841 - samples/sec: 51.29 - lr: 0.050000\r\n2022-03-03 15:50:43,880 epoch 20 - iter 42/141 - loss 0.02613723 - samples/sec: 49.67 - lr: 0.050000\r\n2022-03-03 15:50:47,592 epoch 20 - iter 56/141 - loss 0.02546627 - samples/sec: 60.97 - lr: 0.050000\r\n2022-03-03 15:50:51,840 epoch 20 - iter 70/141 - loss 0.02415541 - samples/sec: 53.63 - lr: 0.050000\r\n2022-03-03 15:50:55,439 epoch 20 - iter 84/141 - loss 0.02404081 - samples/sec: 62.85 - lr: 0.050000\r\n2022-03-03 15:51:00,323 epoch 20 - iter 98/141 - loss 0.02341436 - samples/sec: 51.17 - lr: 0.050000\r\n2022-03-03 15:51:04,282 epoch 20 - iter 112/141 - loss 0.02350316 - samples/sec: 56.94 - lr: 0.050000\r\n2022-03-03 15:51:07,867 epoch 20 - iter 126/141 - loss 0.02345933 - samples/sec: 62.84 - lr: 0.050000\r\n2022-03-03 15:51:11,720 epoch 20 - iter 140/141 - loss 0.02359901 - samples/sec: 58.54 - lr: 0.050000\r\n2022-03-03 15:51:12,204 ----------------------------------------------------------------------------------------------------\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Arch Linux x86_64\r\n - Version: flair==0.10\r\n\r\n**Additional context**\r\n\r\nPrinting with `print` in testing is ok, but it should not be like that in production ready code.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2654/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2654/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2652", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2652/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2652/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2652/events", "html_url": "https://github.com/flairNLP/flair/issues/2652", "id": 1158209903, "node_id": "I_kwDOCCkmXM5FCOFv", "number": 2652, "title": "Model push to Hugging Face, Torch Error", "user": {"login": "amtam0", "id": 17755198, "node_id": "MDQ6VXNlcjE3NzU1MTk4", "avatar_url": "https://avatars.githubusercontent.com/u/17755198?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amtam0", "html_url": "https://github.com/amtam0", "followers_url": "https://api.github.com/users/amtam0/followers", "following_url": "https://api.github.com/users/amtam0/following{/other_user}", "gists_url": "https://api.github.com/users/amtam0/gists{/gist_id}", "starred_url": "https://api.github.com/users/amtam0/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amtam0/subscriptions", "organizations_url": "https://api.github.com/users/amtam0/orgs", "repos_url": "https://api.github.com/users/amtam0/repos", "events_url": "https://api.github.com/users/amtam0/events{/privacy}", "received_events_url": "https://api.github.com/users/amtam0/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-03-03T10:05:38Z", "updated_at": "2022-10-03T09:57:10Z", "closed_at": "2022-08-01T05:51:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nwidget showing : No module named 'torch.torch_version'\r\n\r\n**To Reproduce**\r\nClick compute to test example on widget\r\n\r\n**Expected behavior**\r\nShould show NER tags when computing the widget\r\n\r\n**Screenshots**\r\n![widget](https://user-images.githubusercontent.com/17755198/156541954-182d3778-49f7-4d11-8c7f-48f161c5f09f.png)\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: ubuntu 20.04.03\r\n - Version [e.g. flair-0.3.2]: torch-1.10.0+cu102, flair-0.10\r\n\r\n**Additional context**\r\nmodel link in HF :  https://huggingface.co/amtam0/timer-ner-fr\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2652/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2652/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2647", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2647/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2647/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2647/events", "html_url": "https://github.com/flairNLP/flair/issues/2647", "id": 1150458143, "node_id": "I_kwDOCCkmXM5Ekpkf", "number": 2647, "title": "Dependency Issue with AllenNLP", "user": {"login": "ap-mannion", "id": 43643182, "node_id": "MDQ6VXNlcjQzNjQzMTgy", "avatar_url": "https://avatars.githubusercontent.com/u/43643182?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ap-mannion", "html_url": "https://github.com/ap-mannion", "followers_url": "https://api.github.com/users/ap-mannion/followers", "following_url": "https://api.github.com/users/ap-mannion/following{/other_user}", "gists_url": "https://api.github.com/users/ap-mannion/gists{/gist_id}", "starred_url": "https://api.github.com/users/ap-mannion/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ap-mannion/subscriptions", "organizations_url": "https://api.github.com/users/ap-mannion/orgs", "repos_url": "https://api.github.com/users/ap-mannion/repos", "events_url": "https://api.github.com/users/ap-mannion/events{/privacy}", "received_events_url": "https://api.github.com/users/ap-mannion/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-02-25T13:41:20Z", "updated_at": "2022-07-10T14:44:58Z", "closed_at": "2022-07-10T14:44:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm using Flair 0.10 in a virtualenv environment, and I'm having an issue with its dependencies as related to AllenNLP - I just installed flair today, and the first thing I'm doing is to experiment with ELMo embeddings in a notebook. At first, initialising the ```ELMoEmbeddings``` object throws the following:\r\n```ModuleNotFoundError: ATTENTION! The library \"allennlp\" is not installed! To use ELMoEmbeddings, please first install with \"pip install allennlp==0.9.0\"```\r\n\r\nHowever, on installing the requested version of ```allennlp```, I get the following dependency mismatch error from ```pip```:\r\n```ERROR: flair 0.10 has requirement conllu>=4.0, but you'll have conllu 1.3.1 which is incompatible.```\r\nas apparently v0.9.0 of AllenNLP uses CoNLLU v1.3.1, but flair uses v4.0. This results in the following internal AttributeError when I try to import the embeddings with ```from flair.embeddings import ELMoEmbeddings```;\r\n```\r\nAttributeError                            Traceback (most recent call last)\r\nInput In [1], in <module>\r\n----> 1 from flair.embeddings import ELMoEmbeddings\r\n\r\nFile ~/somelog-nlp/somelog-nlp-venv/lib/python3.8/site-packages/flair/__init__.py:20, in <module>\r\n     17 embedding_storage_mode = \"default\"\r\n     19 from . import data\r\n---> 20 from . import models\r\n     21 from . import visual\r\n     22 from . import trainers\r\n\r\nFile ~/somelog-nlp/somelog-nlp-venv/lib/python3.8/site-packages/flair/models/__init__.py:1, in <module>\r\n----> 1 from .sequence_tagger_model import SequenceTagger, MultiTagger\r\n      2 from .language_model import LanguageModel\r\n      3 from .text_classification_model import TextClassifier\r\n\r\nFile ~/somelog-nlp/somelog-nlp-venv/lib/python3.8/site-packages/flair/models/sequence_tagger_model.py:17, in <module>\r\n     14 from torch.nn.parameter import Parameter\r\n     15 from tqdm import tqdm\r\n---> 17 import flair.nn\r\n     18 from flair.data import Dictionary, Sentence, Label\r\n     19 from flair.datasets import SentenceDataset, DataLoader\r\n\r\nFile ~/somelog-nlp/somelog-nlp-venv/lib/python3.8/site-packages/flair/nn/__init__.py:2, in <module>\r\n      1 from .dropout import LockedDropout, WordDropout\r\n----> 2 from .model import Model, Classifier, DefaultClassifier\r\n\r\nFile ~/somelog-nlp/somelog-nlp-venv/lib/python3.8/site-packages/flair/nn/model.py:16, in <module>\r\n     14 from flair import file_utils\r\n     15 from flair.data import DataPoint, Sentence, Dictionary, SpanLabel\r\n---> 16 from flair.datasets import DataLoader, SentenceDataset\r\n     17 from flair.training_utils import Result, store_embeddings\r\n     19 log = logging.getLogger(\"flair\")\r\n\r\nFile ~/somelog-nlp/somelog-nlp-venv/lib/python3.8/site-packages/flair/datasets/__init__.py:277, in <module>\r\n    274 from .biomedical import BIOBERT_GENE_JNLPBA\r\n    276 # Expose all relation extraction datasets\r\n--> 277 from .relation_extraction import RE_ENGLISH_SEMEVAL2010\r\n    278 from .relation_extraction import RE_ENGLISH_TACRED\r\n    279 from .relation_extraction import RE_ENGLISH_CONLL04\r\n\r\nFile ~/somelog-nlp/somelog-nlp-venv/lib/python3.8/site-packages/flair/datasets/relation_extraction.py:16, in <module>\r\n     14 import flair\r\n     15 from flair.data import Sentence\r\n---> 16 from flair.datasets.conllu import CoNLLUCorpus\r\n     17 from flair.file_utils import cached_path\r\n     18 from flair.tokenization import (\r\n     19     SentenceSplitter,\r\n     20     SegtokSentenceSplitter,\r\n     21 )\r\n\r\nFile ~/somelog-nlp/somelog-nlp-venv/lib/python3.8/site-packages/flair/datasets/conllu.py:19, in <module>\r\n     15 DEFAULT_TOKEN_ANNOTATION_FIELDS: Tuple[str, ...] = (\"lemma\", \"upos\", \"xpos\", \"feats\", \"head\", \"deprel\")\r\n     17 # noinspection PyProtectedMember\r\n     18 DEFAULT_METADATA_PARSERS: Dict[str, conllu._MetadataParserType] = {\r\n---> 19     **conllu.parser.DEFAULT_METADATA_PARSERS,\r\n     20     **{\"relations\": lambda key, value: parse_relation_tuple_list(key, value, list_sep=\"|\", value_sep=\";\")}\r\n     21 }\r\n     24 def parse_relation_tuple_list(key: str,\r\n     25                               value: Optional[str] = None,\r\n     26                               list_sep: str = \"|\",\r\n     27                               value_sep: str = \";\") -> Optional[Tuple[str, List[Tuple[int, int, int, int, str]]]]:\r\n     28     if value is None:\r\n\r\nAttributeError: module 'conllu.parser' has no attribute 'DEFAULT_METADATA_PARSERS'\r\n\r\n```\r\n\r\nI tried installing the latest version of AllenNLP, v2.9.0, but that results in the same error.\r\n\r\n**Environment:**\r\n - OS: Ubuntu 20.04.3 LTS focal\r\n - Python 3.8.10\r\n - flair v0.10\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2647/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2647/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2644", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2644/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2644/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2644/events", "html_url": "https://github.com/flairNLP/flair/issues/2644", "id": 1146345395, "node_id": "I_kwDOCCkmXM5EU9ez", "number": 2644, "title": "bad result: \"man was shot several times\"= 99.6% POSITIVE sentiment ", "user": {"login": "ldmtwo", "id": 7573669, "node_id": "MDQ6VXNlcjc1NzM2Njk=", "avatar_url": "https://avatars.githubusercontent.com/u/7573669?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ldmtwo", "html_url": "https://github.com/ldmtwo", "followers_url": "https://api.github.com/users/ldmtwo/followers", "following_url": "https://api.github.com/users/ldmtwo/following{/other_user}", "gists_url": "https://api.github.com/users/ldmtwo/gists{/gist_id}", "starred_url": "https://api.github.com/users/ldmtwo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ldmtwo/subscriptions", "organizations_url": "https://api.github.com/users/ldmtwo/orgs", "repos_url": "https://api.github.com/users/ldmtwo/repos", "events_url": "https://api.github.com/users/ldmtwo/events{/privacy}", "received_events_url": "https://api.github.com/users/ldmtwo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-02-22T01:04:20Z", "updated_at": "2022-09-09T02:02:34Z", "closed_at": "2022-09-09T02:02:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "I've been debugging bad output from the pretrained model. What corpus is this trained on? How to make it not overfit.\r\n\r\n```\r\nimport flair\r\n# !pip install GIT+https://github.com/flairNLP/flair.git\r\n\r\nflair_sentiment = flair.models.TextClassifier.load('en-sentiment')\r\n\r\ndef sentiment(text):\r\n    s = flair.data.Sentence(text)\r\n    flair_sentiment.predict(s)\r\n    ret = {obj.value:obj.score for obj in s.labels}\r\n    return ret\r\n\r\n# sentence = 'Texas good samaritan shot several times while saving woman from suspect' \r\n# sentence = 'Art ran really well, but died.'\r\nsentence = 'man was shot several times'\r\n{'POSITIVE': 0.9961583018302917}\r\n\r\nsentiment('I went to Palestine')\r\n{'NEGATIVE': 0.9425508379936218}\r\n\r\nsentiment('Black people in the South')\r\n{'NEGATIVE': 0.8325328826904297}\r\n```", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2644/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2644/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2637", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2637/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2637/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2637/events", "html_url": "https://github.com/flairNLP/flair/issues/2637", "id": 1141175430, "node_id": "I_kwDOCCkmXM5EBPSG", "number": 2637, "title": "AttributeError: 'TransformerWordEmbeddings' object has no attribute 'embedding_length'", "user": {"login": "niedakh", "id": 291663, "node_id": "MDQ6VXNlcjI5MTY2Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/291663?v=4", "gravatar_id": "", "url": "https://api.github.com/users/niedakh", "html_url": "https://github.com/niedakh", "followers_url": "https://api.github.com/users/niedakh/followers", "following_url": "https://api.github.com/users/niedakh/following{/other_user}", "gists_url": "https://api.github.com/users/niedakh/gists{/gist_id}", "starred_url": "https://api.github.com/users/niedakh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/niedakh/subscriptions", "organizations_url": "https://api.github.com/users/niedakh/orgs", "repos_url": "https://api.github.com/users/niedakh/repos", "events_url": "https://api.github.com/users/niedakh/events{/privacy}", "received_events_url": "https://api.github.com/users/niedakh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-02-17T10:51:00Z", "updated_at": "2022-07-10T14:44:44Z", "closed_at": "2022-07-10T14:44:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI have a model I trained with some version of flair - I don't remember which one - and now with flair 0.10 I'm getting: \r\n`AttributeError: 'TransformerWordEmbeddings' object has no attribute 'embedding_length'` when running SequenceTagger.load()\r\n\r\n```---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-19-e9a50f12a435> in <module>\r\n      1 from flair.models import SequenceTagger\r\n----> 2 model = SequenceTagger.load(model_path)\r\n\r\n~/venv38/lib64/python3.8/site-packages/flair/nn.py in load(cls, model)\r\n\r\n~/venv38/lib64/python3.8/site-packages/flair/models/sequence_tagger_model.py in _init_model_with_state_dict(state)\r\n    270 \r\n    271         model = SequenceTagger(\r\n--> 272             hidden_size=state[\"hidden_size\"],\r\n    273             embeddings=state[\"embeddings\"],\r\n    274             tag_dictionary=state[\"tag_dictionary\"],\r\n\r\n~/venv38/lib64/python3.8/site-packages/flair/models/sequence_tagger_model.py in __init__(self, hidden_size, embeddings, tag_dictionary, tag_type, use_crf, use_rnn, rnn_layers, dropout, word_dropout, locked_dropout, reproject_to, train_initial_hidden_state, rnn_type, pickle_module, beta, loss_weights)\r\n    157         if locked_dropout > 0.0:\r\n    158             self.locked_dropout = flair.nn.LockedDropout(locked_dropout)\r\n--> 159 \r\n    160         embedding_dim: int = self.embeddings.embedding_length\r\n    161         rnn_input_dim: int = embedding_dim\r\n\r\n~/venv38/lib64/python3.8/site-packages/torch/nn/modules/module.py in __getattr__(self, name)\r\n   1175             if name in modules:\r\n   1176                 return modules[name]\r\n-> 1177         raise AttributeError(\"'{}' object has no attribute '{}'\".format(\r\n   1178             type(self).__name__, name))\r\n   1179 \r\n\r\nAttributeError: 'TransformerWordEmbeddings' object has no attribute 'embedding_length'\r\n\r\n```", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2637/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2637/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2631", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2631/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2631/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2631/events", "html_url": "https://github.com/flairNLP/flair/issues/2631", "id": 1135324373, "node_id": "I_kwDOCCkmXM5Dq6zV", "number": 2631, "title": "AttributeError: 'TransformerDocumentEmbeddings' object has no attribute 'init_hidden'", "user": {"login": "yrahul3910", "id": 8930954, "node_id": "MDQ6VXNlcjg5MzA5NTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/8930954?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yrahul3910", "html_url": "https://github.com/yrahul3910", "followers_url": "https://api.github.com/users/yrahul3910/followers", "following_url": "https://api.github.com/users/yrahul3910/following{/other_user}", "gists_url": "https://api.github.com/users/yrahul3910/gists{/gist_id}", "starred_url": "https://api.github.com/users/yrahul3910/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yrahul3910/subscriptions", "organizations_url": "https://api.github.com/users/yrahul3910/orgs", "repos_url": "https://api.github.com/users/yrahul3910/repos", "events_url": "https://api.github.com/users/yrahul3910/events{/privacy}", "received_events_url": "https://api.github.com/users/yrahul3910/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-02-13T06:37:22Z", "updated_at": "2022-11-07T19:42:31Z", "closed_at": "2022-06-29T12:32:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI am trying to fine-tune a language model, and my log is as follows:\r\n\r\n```\r\nryedida@deeplearning-9-vm:~/src$ python3 train_lm.py\r\n2022-02-13 06:13:58,163 read text file with 17612887 lines\r\n2022-02-13 06:27:08,040 read text file with 8800340 lines\r\n2022-02-13 06:33:19,149 read text file with 83656 lines\r\n2022-02-13 06:33:19,160 read text file with 83382 lines\r\n2022-02-13 06:33:19,203 shuffled\r\n2022-02-13 06:33:19,214 shuffled\r\n2022-02-13 06:33:22,574 Sequence length is 100\r\n2022-02-13 06:33:22,653 Split 1\t - (06:33:22)\r\n2022-02-13 06:33:23,049 read text file with 83519 lines\r\n2022-02-13 06:33:23,076 read text file with 83821 lines\r\n2022-02-13 06:33:23,105 shuffled\r\n2022-02-13 06:33:23,131 shuffled\r\nTraceback (most recent call last):\r\n  File \"train_lm.py\", line 13, in <module>\r\n    trainer.train('../models/', sequence_length=100, mini_batch_size=2)\r\n  File \"/opt/conda/lib/python3.7/site-packages/flair/trainers/language_model_trainer.py\", line 293, in train\r\n    hidden = self.model.init_hidden(mini_batch_size)\r\n  File \"/opt/conda/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 1178, in __getattr__\r\n    type(self).__name__, name))\r\nAttributeError: 'TransformerDocumentEmbeddings' object has no attribute 'init_hidden'\r\n```\r\n\r\n**To Reproduce**\r\n\r\nMy code in `train_lm.py` is:\r\n\r\n```\r\nfrom flair.embeddings import TransformerDocumentEmbeddings\r\nfrom flair.data import Dictionary\r\nfrom flair.trainers.language_model_trainer import LanguageModelTrainer, TextCorpus\r\n\r\n\r\nmodel = TransformerDocumentEmbeddings('bert-base-uncased',\r\n                                  fine_tune=True)\r\ndictionary = Dictionary.load('chars')\r\ncorpus = TextCorpus('../data/',\r\n                    dictionary)\r\n\r\ntrainer = LanguageModelTrainer(model, corpus)\r\ntrainer.train('../models/', sequence_length=100, mini_batch_size=2)\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Debian\r\n - Version [e.g. flair-0.3.2]: flair-0.10\r\n\r\nHow do I solve this?\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2631/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2631/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2626", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2626/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2626/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2626/events", "html_url": "https://github.com/flairNLP/flair/issues/2626", "id": 1128050869, "node_id": "I_kwDOCCkmXM5DPLC1", "number": 2626, "title": "I am not able load a module from my local disk after download from huggingface", "user": {"login": "wassimsuleiman", "id": 233202, "node_id": "MDQ6VXNlcjIzMzIwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/233202?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wassimsuleiman", "html_url": "https://github.com/wassimsuleiman", "followers_url": "https://api.github.com/users/wassimsuleiman/followers", "following_url": "https://api.github.com/users/wassimsuleiman/following{/other_user}", "gists_url": "https://api.github.com/users/wassimsuleiman/gists{/gist_id}", "starred_url": "https://api.github.com/users/wassimsuleiman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wassimsuleiman/subscriptions", "organizations_url": "https://api.github.com/users/wassimsuleiman/orgs", "repos_url": "https://api.github.com/users/wassimsuleiman/repos", "events_url": "https://api.github.com/users/wassimsuleiman/events{/privacy}", "received_events_url": "https://api.github.com/users/wassimsuleiman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 14, "created_at": "2022-02-09T04:50:46Z", "updated_at": "2022-09-30T12:25:23Z", "closed_at": "2022-09-09T02:02:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "i downloaded the module from huggingface \r\nhttps://huggingface.co/flair/ner-english-ontonotes-large/tree/main\r\n\r\ni am trying to load the SequenceTagger\r\ntagger = SequenceTagger.load('./pytorch_model.bin')\r\n\r\ni got:\r\nValueError: Connection error ? \r\nAny idea", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2626/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2626/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2624", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2624/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2624/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2624/events", "html_url": "https://github.com/flairNLP/flair/issues/2624", "id": 1126170051, "node_id": "I_kwDOCCkmXM5DH_3D", "number": 2624, "title": "Given and found data, got \"RuntimeError: No data provided when initializing corpus object.\"", "user": {"login": "ChessMateK", "id": 48825535, "node_id": "MDQ6VXNlcjQ4ODI1NTM1", "avatar_url": "https://avatars.githubusercontent.com/u/48825535?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ChessMateK", "html_url": "https://github.com/ChessMateK", "followers_url": "https://api.github.com/users/ChessMateK/followers", "following_url": "https://api.github.com/users/ChessMateK/following{/other_user}", "gists_url": "https://api.github.com/users/ChessMateK/gists{/gist_id}", "starred_url": "https://api.github.com/users/ChessMateK/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ChessMateK/subscriptions", "organizations_url": "https://api.github.com/users/ChessMateK/orgs", "repos_url": "https://api.github.com/users/ChessMateK/repos", "events_url": "https://api.github.com/users/ChessMateK/events{/privacy}", "received_events_url": "https://api.github.com/users/ChessMateK/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-02-07T15:50:05Z", "updated_at": "2022-11-01T15:04:48Z", "closed_at": "2022-11-01T15:04:48Z", "author_association": "NONE", "active_lock_reason": null, "body": "**PLEASE NOTE**: This issue is strictly related to flair-0.10. Using flair-0.9 this problem is solved, but #2526 arise (see my post).\r\n\r\n**Describe the bug**\r\nAlthough the data is provided and found as reported by the print embedded in the code with the path to the data, the following error is returned \"RuntimeError: No data provided when initializing corpus object.\"\r\n\r\n**To Reproduce**\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import CSVClassificationCorpus\r\n\r\ndata_folder = '/path/to/folder/train_dev_test'\r\ncolumn_name_map = {0: \"Original Index\", 1:\"Labelset\", 2: \"Text\", 3: \"Label1\", 4: \"Label2\"} \r\ncorpus: Corpus = CSVClassificationCorpus(data_folder, column_name_map, skip_header=True, delimiter=\",\", label_type=\"Label1\") \r\n\r\n**Expected behavior**\r\nCorpus correctly loaded.\r\n\r\n**Screenshots**\r\n![Screenshot](https://user-images.githubusercontent.com/48825535/152822452-9f5bfd12-fe7e-4fbb-89d2-63c0b0eff3bf.png)\r\n\r\n**Environment:**\r\n - OS: Google Colab\r\n - Version: flair-0.10\r\n\r\n**Additional context**\r\nData are loaded from Google Drive.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2624/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2624/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2623", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2623/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2623/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2623/events", "html_url": "https://github.com/flairNLP/flair/issues/2623", "id": 1126016861, "node_id": "I_kwDOCCkmXM5DHadd", "number": 2623, "title": "Windows : cannot instantiate 'PosixPath' on your system", "user": {"login": "RansSelected", "id": 43318715, "node_id": "MDQ6VXNlcjQzMzE4NzE1", "avatar_url": "https://avatars.githubusercontent.com/u/43318715?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RansSelected", "html_url": "https://github.com/RansSelected", "followers_url": "https://api.github.com/users/RansSelected/followers", "following_url": "https://api.github.com/users/RansSelected/following{/other_user}", "gists_url": "https://api.github.com/users/RansSelected/gists{/gist_id}", "starred_url": "https://api.github.com/users/RansSelected/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RansSelected/subscriptions", "organizations_url": "https://api.github.com/users/RansSelected/orgs", "repos_url": "https://api.github.com/users/RansSelected/repos", "events_url": "https://api.github.com/users/RansSelected/events{/privacy}", "received_events_url": "https://api.github.com/users/RansSelected/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-02-07T13:45:14Z", "updated_at": "2022-06-29T12:32:46Z", "closed_at": "2022-06-29T12:32:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\ncannot instantiate 'PosixPath' on Windows\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior :\r\nRun the code:\r\n\r\n`\r\nfrom flair.data import Sentence\r\nfrom flair.models import SequenceTagger\r\n\r\nsentence = Sentence('Machine learning is a field of AI')\r\n\r\nmodel = SequenceTagger.load('frame')\r\n\r\nmodel.predict(sentence)\r\n`\r\n\r\n\r\n**Expected behavior**\r\nExpected to download and load SRL(frame) model\r\n\r\n**Screenshots**\r\n![image](https://user-images.githubusercontent.com/43318715/152799342-b158a238-a211-4553-8f5e-536781c2c43b.png)\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - OS Windows 10:\r\n - Version [e.g. flair-0.10, python 3.7.11]:\r\n\r\n**Additional context**\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2623/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2623/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2614", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2614/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2614/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2614/events", "html_url": "https://github.com/flairNLP/flair/issues/2614", "id": 1121042882, "node_id": "I_kwDOCCkmXM5C0cHC", "number": 2614, "title": "Loading a model that uses TransformerWordEmbeddings as embeddings\uff0cretraining it and saving will encounter a save error", "user": {"login": "87302380", "id": 16351048, "node_id": "MDQ6VXNlcjE2MzUxMDQ4", "avatar_url": "https://avatars.githubusercontent.com/u/16351048?v=4", "gravatar_id": "", "url": "https://api.github.com/users/87302380", "html_url": "https://github.com/87302380", "followers_url": "https://api.github.com/users/87302380/followers", "following_url": "https://api.github.com/users/87302380/following{/other_user}", "gists_url": "https://api.github.com/users/87302380/gists{/gist_id}", "starred_url": "https://api.github.com/users/87302380/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/87302380/subscriptions", "organizations_url": "https://api.github.com/users/87302380/orgs", "repos_url": "https://api.github.com/users/87302380/repos", "events_url": "https://api.github.com/users/87302380/events{/privacy}", "received_events_url": "https://api.github.com/users/87302380/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2022-02-01T18:12:30Z", "updated_at": "2022-02-08T14:12:25Z", "closed_at": "2022-02-08T14:12:25Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "hey guys,  \r\nI am testing my model with the latest development version. I used the following TransformerWordEmbeddings as the embedding layer of the model.\r\n```\r\nfrom flair.embeddings import TransformerWordEmbeddings\r\n\r\nembeddings = TransformerWordEmbeddings(\r\n    model='xlm-roberta-large',\r\n    layers=\"-1\",\r\n    subtoken_pooling=\"first\",\r\n    fine_tune=True,\r\n    use_context=True,\r\n)\r\n```\r\nThe training of the initial model everything is in order\uff0c until I load the saved model, and try to continue training, at the end of the training save the model, I get the error.\r\n```\r\n/usr/local/lib/python3.7/dist-packages/flair/nn/model.py in save(self, model_file, checkpoint)\r\n    117 \r\n    118         # save model\r\n--> 119         torch.save(model_state, str(model_file), pickle_protocol=4)\r\n    120 \r\n    121         # restore optimizer and scheduler to model card if set\r\n\r\n/usr/local/lib/python3.7/dist-packages/torch/serialization.py in save(obj, f, pickle_module, pickle_protocol, _use_new_zipfile_serialization)\r\n    377         if _use_new_zipfile_serialization:\r\n    378             with _open_zipfile_writer(opened_file) as opened_zipfile:\r\n--> 379                 _save(obj, opened_zipfile, pickle_module, pickle_protocol)\r\n    380                 return\r\n    381         _legacy_save(obj, opened_file, pickle_module, pickle_protocol)\r\n\r\n/usr/local/lib/python3.7/dist-packages/torch/serialization.py in _save(obj, zip_file, pickle_module, pickle_protocol)\r\n    482     pickler = pickle_module.Pickler(data_buf, protocol=pickle_protocol)\r\n    483     pickler.persistent_id = persistent_id\r\n--> 484     pickler.dump(obj)\r\n    485     data_value = data_buf.getvalue()\r\n    486     zip_file.write_record('data.pkl', data_value, len(data_value))\r\n\r\n/usr/local/lib/python3.7/dist-packages/flair/embeddings/base.py in __getstate__(self)\r\n    374         config_dict = self.model.config.to_dict()\r\n    375 \r\n--> 376         tokenizer_data = self._tokenizer_bytes()\r\n    377 \r\n    378         model_state = {\r\n\r\n/usr/local/lib/python3.7/dist-packages/flair/embeddings/base.py in _tokenizer_bytes(self)\r\n    343     def _tokenizer_bytes(self):\r\n    344         with tempfile.TemporaryDirectory() as temp_dir:\r\n--> 345             files = self.tokenizer.save_pretrained(temp_dir)\r\n    346             zip_data = BytesIO()\r\n    347             zip_obj = zipfile.ZipFile(zip_data, \"w\")\r\n\r\n/usr/local/lib/python3.7/dist-packages/transformers/tokenization_utils_base.py in save_pretrained(self, save_directory, legacy_format, filename_prefix, push_to_hub, **kwargs)\r\n   2086             file_names=file_names,\r\n   2087             legacy_format=legacy_format,\r\n-> 2088             filename_prefix=filename_prefix,\r\n   2089         )\r\n   2090 \r\n\r\n/usr/local/lib/python3.7/dist-packages/transformers/tokenization_utils_fast.py in _save_pretrained(self, save_directory, file_names, legacy_format, filename_prefix)\r\n    588                     f.write(out_str)\r\n    589 \r\n--> 590             vocab_files = self.save_vocabulary(save_directory, filename_prefix=filename_prefix)\r\n    591             file_names = file_names + vocab_files + (added_tokens_file,)\r\n    592 \r\n\r\n/usr/local/lib/python3.7/dist-packages/transformers/models/xlm_roberta/tokenization_xlm_roberta_fast.py in save_vocabulary(self, save_directory, filename_prefix)\r\n    220 \r\n    221         if os.path.abspath(self.vocab_file) != os.path.abspath(out_vocab_file):\r\n--> 222             copyfile(self.vocab_file, out_vocab_file)\r\n    223 \r\n    224         return (out_vocab_file,)\r\n\r\n/usr/lib/python3.7/shutil.py in copyfile(src, dst, follow_symlinks)\r\n    118         os.symlink(os.readlink(src), dst)\r\n    119     else:\r\n--> 120         with open(src, 'rb') as fsrc:\r\n    121             with open(dst, 'wb') as fdst:\r\n    122                 copyfileobj(fsrc, fdst)\r\n\r\nFileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpgmeag52c/sentencepiece.bpe.model'\r\n```\r\nI'm using the SequenceTagger model, I don't know if it will appear on other models as well. If the problem is in Transformer, it may also occur on other models. I found that loading the saved model, saving the model again, the error is triggered.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2614/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2614/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2612", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2612/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2612/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2612/events", "html_url": "https://github.com/flairNLP/flair/issues/2612", "id": 1118536069, "node_id": "I_kwDOCCkmXM5Cq4GF", "number": 2612, "title": "find_learning_rate is not saving the data as the header indicated", "user": {"login": "symeneses", "id": 12284951, "node_id": "MDQ6VXNlcjEyMjg0OTUx", "avatar_url": "https://avatars.githubusercontent.com/u/12284951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/symeneses", "html_url": "https://github.com/symeneses", "followers_url": "https://api.github.com/users/symeneses/followers", "following_url": "https://api.github.com/users/symeneses/following{/other_user}", "gists_url": "https://api.github.com/users/symeneses/gists{/gist_id}", "starred_url": "https://api.github.com/users/symeneses/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/symeneses/subscriptions", "organizations_url": "https://api.github.com/users/symeneses/orgs", "repos_url": "https://api.github.com/users/symeneses/repos", "events_url": "https://api.github.com/users/symeneses/events{/privacy}", "received_events_url": "https://api.github.com/users/symeneses/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-01-30T13:20:44Z", "updated_at": "2022-06-29T12:32:41Z", "closed_at": "2022-06-29T12:32:41Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nPloting the learning rate is creating an empty plot as the data is not what is expected from the `plot_learning_rate` function.\r\nThe **TUTORIAL_8_MODEL_OPTIMIZATION** is also missing in the v0.10 documentation.\r\n\r\n**To Reproduce**\r\nExample form [tutorial](https://github.com/flairNLP/flair/blob/v0.9/resources/docs/TUTORIAL_8_MODEL_OPTIMIZATION.md) modified.\r\n```python\r\nfrom flair.datasets import WNUT_17\r\nfrom flair.embeddings import TokenEmbeddings, WordEmbeddings, StackedEmbeddings\r\nfrom flair.trainers import ModelTrainer\r\nfrom typing import List\r\nfrom torch.optim.adam import Adam\r\n\r\n# 1. get the corpus\r\ncorpus = WNUT_17().downsample(0.1)\r\nprint(corpus)\r\n\r\n# 2. what tag do we want to predict?\r\ntag_type = 'ner'\r\n\r\n# 3. make the tag dictionary from the corpus\r\ntag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\nprint(tag_dictionary.idx2item)\r\n\r\n# 4. initialize embeddings\r\nembedding_types: List[TokenEmbeddings] = [\r\n    WordEmbeddings('glove'),\r\n]\r\n\r\nembeddings: StackedEmbeddings = StackedEmbeddings(embeddings=embedding_types)\r\n\r\n# 5. initialize sequence tagger\r\nfrom flair.models import SequenceTagger\r\n\r\ntagger: SequenceTagger = SequenceTagger(hidden_size=256,\r\n                                        embeddings=embeddings,\r\n                                        tag_dictionary=tag_dictionary,\r\n                                        tag_type=tag_type,\r\n                                        use_crf=True)\r\n\r\n# 6. initialize trainer\r\ntrainer: ModelTrainer = ModelTrainer(tagger, corpus)\r\n\r\n# 7. find learning rate\r\nlearning_rate_tsv = trainer.find_learning_rate('resources/taggers/example-ner', optimizer=Adam, iterations=10)\r\n\r\n# 8. plot the learning rate finder curve\r\nfrom flair.visual.training_curves import Plotter\r\nplotter = Plotter()\r\nplotter.plot_learning_rate(learning_rate_tsv)\r\n```\r\n\r\n**Expected behavior**\r\nThe loss vs learning plot according to the data saved in `resources/taggers/example-ner/learning_rate.tsv`.\r\n\r\n**Screenshots**\r\n![grafik](https://user-images.githubusercontent.com/12284951/151701064-b8ab469d-26aa-4ff2-bff6-eecc549f1e55.png)\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - Flair v 0.10\r\n\r\nI could create a PR to fix this and add the documentation. I would like to confirm first if the tutorial is missing for a different reason.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2612/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2612/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2603", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2603/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2603/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2603/events", "html_url": "https://github.com/flairNLP/flair/issues/2603", "id": 1111871302, "node_id": "I_kwDOCCkmXM5CRc9G", "number": 2603, "title": "UnknownExtra: requests 2.20.0 has no such extra feature 'socks'", "user": {"login": "YoussefSultan", "id": 89711840, "node_id": "MDQ6VXNlcjg5NzExODQw", "avatar_url": "https://avatars.githubusercontent.com/u/89711840?v=4", "gravatar_id": "", "url": "https://api.github.com/users/YoussefSultan", "html_url": "https://github.com/YoussefSultan", "followers_url": "https://api.github.com/users/YoussefSultan/followers", "following_url": "https://api.github.com/users/YoussefSultan/following{/other_user}", "gists_url": "https://api.github.com/users/YoussefSultan/gists{/gist_id}", "starred_url": "https://api.github.com/users/YoussefSultan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/YoussefSultan/subscriptions", "organizations_url": "https://api.github.com/users/YoussefSultan/orgs", "repos_url": "https://api.github.com/users/YoussefSultan/repos", "events_url": "https://api.github.com/users/YoussefSultan/events{/privacy}", "received_events_url": "https://api.github.com/users/YoussefSultan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-01-23T13:28:24Z", "updated_at": "2022-10-23T05:53:37Z", "closed_at": "2022-06-29T12:32:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "When loading a sequence tagger an unknown extra error occurs.\r\n\r\n**To Reproduce**\r\nPython 3.9\r\n```from flair.models import SequenceTagger\r\n\r\ntagger = SequenceTagger.load(\"flair/ner-english\")```", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2603/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2603/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2601", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2601/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2601/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2601/events", "html_url": "https://github.com/flairNLP/flair/issues/2601", "id": 1108037222, "node_id": "I_kwDOCCkmXM5CC05m", "number": 2601, "title": "RuntimeError: Already borrowed", "user": {"login": "jroakes", "id": 10191545, "node_id": "MDQ6VXNlcjEwMTkxNTQ1", "avatar_url": "https://avatars.githubusercontent.com/u/10191545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jroakes", "html_url": "https://github.com/jroakes", "followers_url": "https://api.github.com/users/jroakes/followers", "following_url": "https://api.github.com/users/jroakes/following{/other_user}", "gists_url": "https://api.github.com/users/jroakes/gists{/gist_id}", "starred_url": "https://api.github.com/users/jroakes/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jroakes/subscriptions", "organizations_url": "https://api.github.com/users/jroakes/orgs", "repos_url": "https://api.github.com/users/jroakes/repos", "events_url": "https://api.github.com/users/jroakes/events{/privacy}", "received_events_url": "https://api.github.com/users/jroakes/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-01-19T12:22:41Z", "updated_at": "2023-01-07T19:47:55Z", "closed_at": "2023-01-07T19:47:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nTransformers tokenizers has a bug (not a bug?) detailed [here](https://github.com/huggingface/tokenizers/issues/537) where truncation causes a `RuntimeError: Already borrowed` error when processing the across threads.\r\n\r\n**To Reproduce**\r\nHere is a minimal example of the error in Colab:\r\nhttps://colab.research.google.com/drive/1GCr4nuasc6I2GeYbeNt6eaE6JPUcfGav#scrollTo=F2g965a5LSk_\r\n\r\n**Expected behavior**\r\nExpected predictions to be thread safe.\r\n\r\n**Screenshots**\r\nN/A\r\n\r\n**Environment (please complete the following information):**\r\n - Windows / Colab\r\n\r\n**Additional context**\r\nOriginally reported [here](https://github.com/flairNLP/flair/issues/2258)\r\nOne solution is to pass `use_fast = False` but this fails due to dependency in the flair code on `return_offsets_mapping`.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2601/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2601/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2600", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2600/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2600/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2600/events", "html_url": "https://github.com/flairNLP/flair/issues/2600", "id": 1107323354, "node_id": "I_kwDOCCkmXM5CAGna", "number": 2600, "title": "StackedEmbeddings modifies original embeddings' name which causes unwanted behaviour and potential crashes", "user": {"login": "tadejmagajna", "id": 1088423, "node_id": "MDQ6VXNlcjEwODg0MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/1088423?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tadejmagajna", "html_url": "https://github.com/tadejmagajna", "followers_url": "https://api.github.com/users/tadejmagajna/followers", "following_url": "https://api.github.com/users/tadejmagajna/following{/other_user}", "gists_url": "https://api.github.com/users/tadejmagajna/gists{/gist_id}", "starred_url": "https://api.github.com/users/tadejmagajna/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tadejmagajna/subscriptions", "organizations_url": "https://api.github.com/users/tadejmagajna/orgs", "repos_url": "https://api.github.com/users/tadejmagajna/repos", "events_url": "https://api.github.com/users/tadejmagajna/events{/privacy}", "received_events_url": "https://api.github.com/users/tadejmagajna/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-01-18T20:16:14Z", "updated_at": "2022-06-29T12:32:43Z", "closed_at": "2022-06-29T12:32:43Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "**Description**\r\nWhen `StackedEmbeddings` are initialised, they modify the input embeddings by renaming their `name` property as part of this code:\r\n\r\nhttps://github.com/flairNLP/flair/blob/579c7b70dfcc1d184bd47069f722d7a9ae8b78d7/flair/embeddings/token.py#L49-L50\r\n\r\nThe above code modifies the original embeddings object's name. But several parts of Flair rely on embedding names being consistent.\r\n\r\nFor example the [`_everything_embedded()`](https://github.com/flairNLP/flair/blob/b774774752c8338aab3d620f7e5062f66ec7a69d/flair/embeddings/base.py#L67) method relies on embedding names when checking whether all embeddings were applied. When an embedding's name changes, its methods like `_everything_embedded()` become broken and this potentially results in the same embedding being added twice to the same token.\r\n\r\nThe adverse consequences of this bug and the consequences follow this pattern:\r\n\r\n1. The original embeddding's (let's call it `Char`) gets renamed to `0-Char` the first time we call StackedEmbeddings. If we pass the same embedding object to another StackedEmbeddings class it'll be renamed to `0-0-Char` and so on...\r\n2. `_everything_embedded()` method breaks and **even if all tokens in a `Sentence` are embedded, the method will think they aren't** because the embedding now has a new name and no tokens were embedded with an embedding that has this new name. This results in the token being embedded again the next time we call `.embed()` on the same token resulting in duplicated embedding dimensionality.\r\n3. The tokens are now embedded with double embedding dimensionality which causes a number of downstream issues and crashes\r\n\r\n**How the bug was introduced**\r\n\r\nThe bug was introduced as part of issue #1092 PR #1114. The problem was that on different platforms, the ordering of embeddings was different because Python 3.6 doesn't respect dict insertion order on some platforms.\r\n\r\n**To Reproduce**\r\n```python\r\nfrom flair.embeddings import StackedEmbeddings, CharacterEmbeddings\r\nfrom flair.data import Sentence\r\n\r\n# setup\r\ns = Sentence('a')\r\ne = CharacterEmbeddings(hidden_size_char=2)\r\ne.embed(s)\r\nprint(\"name of the embedding is\", e.name)  # name is \"Char\"\r\nprint(\"embedding len is:\", len(s[0].embedding))  # embedding is 4-dimentional\r\ne.embed(s)\r\nprint(\"embedding len is:\", len(s[0].embedding))  # embedding is 4-dimentional regardless of how many times we call embed()\r\n\r\n# trigger the bug\r\nstack = StackedEmbeddings([e])\r\ne.embed(s)\r\n\r\n# unwanted results\r\nprint(\"name of the embedding is now:\", e.name)  # name is \"0-Char\"\r\nprint(\"embedding len is now:\", len(s[0].embedding))  # embedding is now 8-dimentional\r\n```\r\n\r\n**Expected behaviour**\r\nThe way `StackedEmbeddings` modifies the original embeddings' name can cause a number of issues (like double-added embeddings) when we use the original embedding object later.\r\n\r\nIdeally, I think `StackedEmbeddings` should not modify the embeddings object that it gets as input. There should be a better way of retaining order of embeddings. Possible solutions I can think of right now would be:\r\n\r\n- we could, instead of prefixing embedding names, retain the embedding order by using an OrderedDict data structure to hold `._embeddings`\r\n- we could, instead of prefixing embedding names, simply wait for Flair to start using Python 3.7+ ([that ensures dict keys are insertion ordered by default on all platforms](https://stackoverflow.com/a/39980744/953674))\r\n\r\nThe above two solutions should be feasible, but maybe there's an even easier solution, though I can't think of it.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2600/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2600/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2598", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2598/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2598/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2598/events", "html_url": "https://github.com/flairNLP/flair/issues/2598", "id": 1105751427, "node_id": "I_kwDOCCkmXM5B6G2D", "number": 2598, "title": "RuntimeError: mat1 dim 1 must match mat2 dim 0", "user": {"login": "FahriBilici", "id": 28020526, "node_id": "MDQ6VXNlcjI4MDIwNTI2", "avatar_url": "https://avatars.githubusercontent.com/u/28020526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/FahriBilici", "html_url": "https://github.com/FahriBilici", "followers_url": "https://api.github.com/users/FahriBilici/followers", "following_url": "https://api.github.com/users/FahriBilici/following{/other_user}", "gists_url": "https://api.github.com/users/FahriBilici/gists{/gist_id}", "starred_url": "https://api.github.com/users/FahriBilici/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/FahriBilici/subscriptions", "organizations_url": "https://api.github.com/users/FahriBilici/orgs", "repos_url": "https://api.github.com/users/FahriBilici/repos", "events_url": "https://api.github.com/users/FahriBilici/events{/privacy}", "received_events_url": "https://api.github.com/users/FahriBilici/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-01-17T11:44:05Z", "updated_at": "2022-01-18T11:34:41Z", "closed_at": "2022-01-18T11:34:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello i am training text classifier with my fasttext embeddings. but it throws me \r\n\"RuntimeError: mat1 dim 1 must match mat2 dim 0\" error. how can i solve it? I followed tutorial with using fasttext embeddings instead of using transformer embeddings\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2598/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2598/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2595", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2595/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2595/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2595/events", "html_url": "https://github.com/flairNLP/flair/issues/2595", "id": 1102125886, "node_id": "I_kwDOCCkmXM5BsRs-", "number": 2595, "title": "zero shot classification when using TARSClassifier bug", "user": {"login": "yananchen1989", "id": 26405281, "node_id": "MDQ6VXNlcjI2NDA1Mjgx", "avatar_url": "https://avatars.githubusercontent.com/u/26405281?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yananchen1989", "html_url": "https://github.com/yananchen1989", "followers_url": "https://api.github.com/users/yananchen1989/followers", "following_url": "https://api.github.com/users/yananchen1989/following{/other_user}", "gists_url": "https://api.github.com/users/yananchen1989/gists{/gist_id}", "starred_url": "https://api.github.com/users/yananchen1989/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yananchen1989/subscriptions", "organizations_url": "https://api.github.com/users/yananchen1989/orgs", "repos_url": "https://api.github.com/users/yananchen1989/repos", "events_url": "https://api.github.com/users/yananchen1989/events{/privacy}", "received_events_url": "https://api.github.com/users/yananchen1989/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-01-13T18:13:54Z", "updated_at": "2022-01-17T20:30:12Z", "closed_at": "2022-01-17T20:30:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\r\nfrom flair.models import TARSClassifier\r\nfrom flair.data import Sentence\r\n\r\n# 1. Load our pre-trained TARS model for English\r\ntars = TARSClassifier.load('tars-base')\r\n```\r\n\r\n\r\nError message:\r\n\r\n> ImportError                               Traceback (most recent call last)\r\n> <ipython-input-1-aab449690509> in <module>\r\n> ----> 1 from flair.models import TARSClassifier\r\n>       2 from flair.data import Sentence\r\n>       3\r\n>       4 # 1. Load our pre-trained TARS model for English\r\n>       5 tars = TARSClassifier.load('tars-base')\r\n> \r\n> ~/anaconda3/lib/python3.8/site-packages/flair/__init__.py in <module>\r\n>      18\r\n>      19 from . import data\r\n> ---> 20 from . import models\r\n>      21 from . import visual\r\n>      22 from . import trainers\r\n> \r\n> ~/anaconda3/lib/python3.8/site-packages/flair/models/__init__.py in <module>\r\n> ----> 1 from .sequence_tagger_model import SequenceTagger, MultiTagger\r\n>       2 from .language_model import LanguageModel\r\n>       3 from .text_classification_model import TextClassifier\r\n>       4 from .pairwise_classification_model import TextPairClassifier\r\n>       5 from .relation_extractor_model import RelationExtractor\r\n> \r\n> ~/anaconda3/lib/python3.8/site-packages/flair/models/sequence_tagger_model.py in <module>\r\n>      18 from flair.data import Dictionary, Sentence, Label\r\n>      19 from flair.datasets import SentenceDataset, DataLoader\r\n> ---> 20 from flair.embeddings import TokenEmbeddings, StackedEmbeddings, Embeddings\r\n>      21 from flair.file_utils import cached_path, unzip_file\r\n>      22 from flair.training_utils import store_embeddings\r\n> \r\n> ~/anaconda3/lib/python3.8/site-packages/flair/embeddings/__init__.py in <module>\r\n>       4\r\n>       5 # Expose token embedding classes\r\n> ----> 6 from .token import TokenEmbeddings\r\n>       7 from .token import StackedEmbeddings\r\n>       8 from .token import WordEmbeddings\r\n> \r\n> ~/anaconda3/lib/python3.8/site-packages/flair/embeddings/token.py in <module>\r\n>      15 from gensim.models import KeyedVectors\r\n>      16 from torch import nn\r\n> ---> 17 from transformers import AutoTokenizer, AutoConfig, AutoModel, CONFIG_MAPPING, PreTrainedTokenizer, XLNetModel, \\\r\n>      18     TransfoXLModel\r\n>      19\r\n> \r\n> ImportError: cannot import name 'AutoModel' from 'transformers' (unknown location)\r\n\r\n\r\ntransformers version: 4.8.2\r\nflair version: 0.10", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2595/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2595/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2594", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2594/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2594/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2594/events", "html_url": "https://github.com/flairNLP/flair/issues/2594", "id": 1101712244, "node_id": "I_kwDOCCkmXM5Bqst0", "number": 2594, "title": "\"Not Found for url:\" when loading trained TextClassifier model", "user": {"login": "andreybondarb", "id": 53795493, "node_id": "MDQ6VXNlcjUzNzk1NDkz", "avatar_url": "https://avatars.githubusercontent.com/u/53795493?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andreybondarb", "html_url": "https://github.com/andreybondarb", "followers_url": "https://api.github.com/users/andreybondarb/followers", "following_url": "https://api.github.com/users/andreybondarb/following{/other_user}", "gists_url": "https://api.github.com/users/andreybondarb/gists{/gist_id}", "starred_url": "https://api.github.com/users/andreybondarb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andreybondarb/subscriptions", "organizations_url": "https://api.github.com/users/andreybondarb/orgs", "repos_url": "https://api.github.com/users/andreybondarb/repos", "events_url": "https://api.github.com/users/andreybondarb/events{/privacy}", "received_events_url": "https://api.github.com/users/andreybondarb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-01-13T13:16:52Z", "updated_at": "2022-01-13T23:22:05Z", "closed_at": "2022-01-13T22:00:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi guys,\r\nthe library is really cool and I enjoy using it.\r\n\r\nI'm facing a problem with loading fine-tuned flair **TextClassifier** model which uses **TransformerDocumentEmbeddings**  namely pretrained **DistilBertForMaskedLM** language model from **transformers** library. Everything was going fine, the model was able to evaluate test and dev samples during training (the results was awesome), and flair saved it to the specified folder. But the problem arised when loading the model. The code I used to load the model is as follows:\r\n\r\n```\r\nfrom flair.models import TextClassifier\r\nimport torch\r\nimport os\r\nimport flair\r\nflair.device = torch.device('cuda') \r\n\r\nos.chdir('/drive/My Drive/Colab Notebooks_new/Datanomica/three_distilberts/flair')\r\nmodel = TextClassifier.load('models/model_3/final-model.pt')\r\n```\r\n\r\n**It seems like it messes something up and fails loading a tokenizer file. The error it gives is as below:**\r\n\r\n```\r\n2022-01-13 12:38:15,696 loading file models/model_3/final-model.pt\r\n---------------------------------------------------------------------------\r\nHTTPError                                 Traceback (most recent call last)\r\n<ipython-input-6-bc1ab3bbc969> in <module>()\r\n      7 \r\n      8 os.chdir('/drive/My Drive/Colab Notebooks_new/Datanomica/three_distilberts/flair')\r\n----> 9 model = TextClassifier.load('models/model_3/final-model.pt')\r\n\r\n11 frames\r\n/usr/local/lib/python3.7/dist-packages/flair/nn/model.py in load(cls, model)\r\n    131             # see https://github.com/zalandoresearch/flair/issues/351\r\n    132             f = file_utils.load_big_file(str(model_file))\r\n--> 133             state = torch.load(f, map_location='cpu')\r\n    134 \r\n    135         model = cls._init_model_with_state_dict(state)\r\n\r\n/usr/local/lib/python3.7/dist-packages/torch/serialization.py in load(f, map_location, pickle_module, **pickle_load_args)\r\n    605                     opened_file.seek(orig_position)\r\n    606                     return torch.jit.load(opened_file)\r\n--> 607                 return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)\r\n    608         return _legacy_load(opened_file, map_location, pickle_module, **pickle_load_args)\r\n    609 \r\n\r\n/usr/local/lib/python3.7/dist-packages/torch/serialization.py in _load(zip_file, map_location, pickle_module, pickle_file, **pickle_load_args)\r\n    880     unpickler = UnpicklerWrapper(data_file, **pickle_load_args)\r\n    881     unpickler.persistent_load = persistent_load\r\n--> 882     result = unpickler.load()\r\n    883 \r\n    884     torch._utils._validate_loaded_sparse_tensors()\r\n\r\n/usr/local/lib/python3.7/dist-packages/flair/embeddings/document.py in __setstate__(self, d)\r\n    254                 config=loaded_config,\r\n    255                 state_dict=d[\"model_state_dict\"],\r\n--> 256                 pooling=self.__dict__['pooling'] if 'pooling' in self.__dict__ else 'cls',\r\n    257                 # for backward compatibility with previous models\r\n    258             )\r\n\r\n/usr/local/lib/python3.7/dist-packages/flair/embeddings/document.py in __init__(self, model, fine_tune, layers, layer_mean, pooling, **kwargs)\r\n     67 \r\n     68         # load tokenizer and transformer model\r\n---> 69         self.tokenizer: PreTrainedTokenizer = AutoTokenizer.from_pretrained(model, **kwargs)\r\n     70         if self.tokenizer.model_max_length > 1000000000:\r\n     71             self.tokenizer.model_max_length = 512\r\n\r\n/usr/local/lib/python3.7/dist-packages/transformers/models/auto/tokenization_auto.py in from_pretrained(cls, pretrained_model_name_or_path, *inputs, **kwargs)\r\n    548             tokenizer_class_py, tokenizer_class_fast = TOKENIZER_MAPPING[type(config)]\r\n    549             if tokenizer_class_fast and (use_fast or tokenizer_class_py is None):\r\n--> 550                 return tokenizer_class_fast.from_pretrained(pretrained_model_name_or_path, *inputs, **kwargs)\r\n    551             else:\r\n    552                 if tokenizer_class_py is not None:\r\n\r\n/usr/local/lib/python3.7/dist-packages/transformers/tokenization_utils_base.py in from_pretrained(cls, pretrained_model_name_or_path, *init_inputs, **kwargs)\r\n   1656                 revision=revision,\r\n   1657                 use_auth_token=use_auth_token,\r\n-> 1658                 local_files_only=local_files_only,\r\n   1659             )\r\n   1660             additional_files_names = {\r\n\r\n/usr/local/lib/python3.7/dist-packages/transformers/tokenization_utils_base.py in get_fast_tokenizer_file(path_or_repo, revision, use_auth_token, local_files_only)\r\n   3485     # Inspect all files from the repo/folder.\r\n   3486     all_files = get_list_of_files(\r\n-> 3487         path_or_repo, revision=revision, use_auth_token=use_auth_token, local_files_only=local_files_only\r\n   3488     )\r\n   3489     tokenizer_files_map = {}\r\n\r\n/usr/local/lib/python3.7/dist-packages/transformers/file_utils.py in get_list_of_files(path_or_repo, revision, use_auth_token, local_files_only)\r\n   2101     else:\r\n   2102         token = None\r\n-> 2103     return list_repo_files(path_or_repo, revision=revision, token=token)\r\n   2104 \r\n   2105 \r\n\r\n/usr/local/lib/python3.7/dist-packages/huggingface_hub/hf_api.py in list_repo_files(self, repo_id, revision, repo_type, token, timeout)\r\n    883         if repo_type is None:\r\n    884             info = self.model_info(\r\n--> 885                 repo_id, revision=revision, token=token, timeout=timeout\r\n    886             )\r\n    887         elif repo_type == \"dataset\":\r\n\r\n/usr/local/lib/python3.7/dist-packages/huggingface_hub/hf_api.py in model_info(self, repo_id, revision, token, timeout)\r\n    866         headers = {\"authorization\": f\"Bearer {token}\"} if token is not None else None\r\n    867         r = requests.get(path, headers=headers, timeout=timeout)\r\n--> 868         r.raise_for_status()\r\n    869         d = r.json()\r\n    870         return ModelInfo(**d)\r\n\r\n/usr/local/lib/python3.7/dist-packages/requests/models.py in raise_for_status(self)\r\n    958 \r\n    959         if http_error_msg:\r\n--> 960             raise HTTPError(http_error_msg, response=self)\r\n    961 \r\n    962     def close(self):\r\n\r\n**HTTPError: 404 Client Error: Not Found for url: https://huggingface.co/api/models/data/lm_models/distilbert_lm_wordpiece_70k/final**\r\n```\r\n\r\n**The code I used to train the model:**\r\n\r\n```\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import CSVClassificationCorpus\r\nfrom flair.embeddings import TransformerDocumentEmbeddings\r\nfrom flair.models import TextClassifier\r\nfrom flair.trainers import ModelTrainer\r\nimport flair\r\nimport pickle\r\nimport os\r\n\r\nflair.device = 'cuda'\r\n\r\nos.chdir('/drive/My Drive/Colab Notebooks_new/Datanomica/three_distilberts/flair')\r\n\r\n# column format indicating which columns hold the text and label(s)\r\ncolumn_name_map = {1: \"text\", 0: \"label_topic\"}\r\n\r\n# load corpus containing training, test and dev data and if CSV has a header, you can skip it\r\ncorpus: Corpus = CSVClassificationCorpus('./',\r\n                                         column_name_map,\r\n                                         label_type = 'label_topic',\r\n                                         skip_header=True,\r\n                                         delimiter='\\t',    # tab-separated files\r\n)\r\n\r\n\r\nos.chdir('/drive/My Drive/Colab Notebooks_new/Datanomica/three_distilberts')\r\n# init embedding\r\ntransformer_embedding = TransformerDocumentEmbeddings('data/lm_models/distilbert_lm_wordpiece_70k/final', fine_tune=True)\r\n\r\nos.chdir('/drive/My Drive/Colab Notebooks_new/Datanomica/three_distilberts/flair')\r\nlabel_dict = pickle.load(open('label_dict.pkl', 'rb'))\r\n\r\n# 5. create the text classifier\r\nclassifier = TextClassifier(transformer_embedding, label_dictionary=label_dict, label_type='label_topic', multi_label=True)\r\n\r\n# 6. initialize trainer\r\ntrainer = ModelTrainer(classifier, corpus)\r\n\r\n# 7. run training with fine-tuning\r\ntrainer.fine_tune('/models/model_3',\r\n                  learning_rate=1e-5,\r\n                  embeddings_storage_mode='none',\r\n                  mini_batch_size=10,\r\n                  #save_model_each_k_epochs=1,\r\n                  max_epochs=1,\r\n                  )\r\n```\r\n\r\nAlso, it seems like there already occurred the same issue which is described [here](https://github.com/flairNLP/flair/issues/2021) and it hasn't been solved yet. Interesting part is that the url path it gives an error on, is exactly the same path I used to load  **TransformerDocumentEmbeddings** for flair **TextClassifier**:\r\n`https://huggingface.co/api/models/**data/lm_models/distilbert_lm_wordpiece_70k/final**`\r\nSeems like it tries loading a tokenizer file from the hugging face repository, that's one problem, but another question is: how it remembers that I was loading distilbert embeddings from that exact path and why it uses it while I'm loading my fine-tuned model from the different path: '/drive/My Drive/Colab Notebooks_new/Datanomica/three_distilberts/flair/models/model_3'\r\n\r\nI'm using **Google Colab**\r\n\r\n**Update: SequenceTagger trained with exatly the same embeddings loads just fine**", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2594/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2594/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2593", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2593/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2593/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2593/events", "html_url": "https://github.com/flairNLP/flair/issues/2593", "id": 1098943429, "node_id": "I_kwDOCCkmXM5BgIvF", "number": 2593, "title": "NEWSGROUPS corpora not working", "user": {"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-01-11T10:07:28Z", "updated_at": "2022-01-12T15:04:55Z", "closed_at": "2022-01-12T15:04:55Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "**Describe the bug**\r\nNEWSGROUPS corpus is not working when using default settings. Runtime Error occurs when iterating over batch_loader in train method of Trainer class.\r\n\r\n**To Reproduce**\r\n```\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import NEWSGROUPS\r\nfrom flair.embeddings import TransformerDocumentEmbeddings\r\nfrom flair.models import TextClassifier\r\nfrom flair.trainers import ModelTrainer\r\n\r\n# 1. get the corpus\r\ncorpus: Corpus = NEWSGROUPS()\r\n\r\n# 2. what label do we want to predict?\r\nlabel_type = 'class'\r\n\r\n# 3. create the label dictionary\r\nlabel_dict = corpus.make_label_dictionary(label_type=label_type)\r\n\r\n# 4. initialize transformer document embeddings (many models are available)\r\ndocument_embeddings = TransformerDocumentEmbeddings('distilbert-base-uncased', fine_tune=True)\r\n\r\n# 5. create the text classifier\r\nclassifier = TextClassifier(document_embeddings, label_dictionary=label_dict, label_type=label_type)\r\n\r\n# 6. initialize trainer\r\ntrainer = ModelTrainer(classifier, corpus)\r\n\r\n# 7. run training with fine-tuning\r\ntrainer.fine_tune('resources/taggers/question-classification-with-transformer',\r\n                  learning_rate=5.0e-5,\r\n                  mini_batch_size=4,\r\n                  max_epochs=10,\r\n                  )\r\n```\r\n\r\n**Expected behavior**\r\nModel can be trained.\r\n\r\n**Screenshots**\r\n```\r\n  File \"/Users/jgolde/PycharmProjects/flair/flair/trainers/trainer.py\", line 462, in train\r\n    for batch_no, batch in enumerate(batch_loader):\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2593/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2593/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2588", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2588/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2588/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2588/events", "html_url": "https://github.com/flairNLP/flair/issues/2588", "id": 1094926837, "node_id": "I_kwDOCCkmXM5BQ0H1", "number": 2588, "title": "Training with `SequenceTagger(beta=2.0)` does not seem to use f2 but always f1", "user": {"login": "ciaochiaociao", "id": 13917478, "node_id": "MDQ6VXNlcjEzOTE3NDc4", "avatar_url": "https://avatars.githubusercontent.com/u/13917478?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ciaochiaociao", "html_url": "https://github.com/ciaochiaociao", "followers_url": "https://api.github.com/users/ciaochiaociao/followers", "following_url": "https://api.github.com/users/ciaochiaociao/following{/other_user}", "gists_url": "https://api.github.com/users/ciaochiaociao/gists{/gist_id}", "starred_url": "https://api.github.com/users/ciaochiaociao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ciaochiaociao/subscriptions", "organizations_url": "https://api.github.com/users/ciaochiaociao/orgs", "repos_url": "https://api.github.com/users/ciaochiaociao/repos", "events_url": "https://api.github.com/users/ciaochiaociao/events{/privacy}", "received_events_url": "https://api.github.com/users/ciaochiaociao/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2022-01-06T03:15:50Z", "updated_at": "2022-06-18T21:43:07Z", "closed_at": "2022-06-18T21:43:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have tried to use beta=2 to adopt f2, which should allow me to select model using f2 score. But from the source code, it seems to always use f1 (either micro or macro) as the `main_evaluation_metric`.\r\n\r\nAfter taking a look at your source code, I found it is because the calling of the sklearn API `classification_report()` from your `Classifier.evaluate()` does not allow passing argument to propagate to its low-level function `precision_recall_fscore_support()`'s `beta` argument. \r\n\r\nsee https://github.com/flairNLP/flair/blob/master/flair/nn/model.py#L354-L359\r\n\r\n**To Reproduce**\r\n```\r\n...\r\ntagger: SequenceTagger = SequenceTagger(...beta=2.0,...)\r\n\r\n# initialize trainer\r\ntrainer: ModelTrainer = ModelTrainer(tagger, corpus)\r\n\r\ntrainer.train(output_dir)\r\n```\r\nAt the end of the training, it shows\r\n\r\nBy class:\r\n              precision    recall  f1-score   support\r\n\r\n           O     0.9617    0.9888    0.9750     21651\r\n.....\r\n\r\nwithout using beta=2.0\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2588/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2588/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2581", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2581/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2581/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2581/events", "html_url": "https://github.com/flairNLP/flair/issues/2581", "id": 1092804970, "node_id": "I_kwDOCCkmXM5BIuFq", "number": 2581, "title": "No gold tags and gold arcs for new final_test() of dependency parser", "user": {"login": "Tarotis", "id": 73231722, "node_id": "MDQ6VXNlcjczMjMxNzIy", "avatar_url": "https://avatars.githubusercontent.com/u/73231722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Tarotis", "html_url": "https://github.com/Tarotis", "followers_url": "https://api.github.com/users/Tarotis/followers", "following_url": "https://api.github.com/users/Tarotis/following{/other_user}", "gists_url": "https://api.github.com/users/Tarotis/gists{/gist_id}", "starred_url": "https://api.github.com/users/Tarotis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Tarotis/subscriptions", "organizations_url": "https://api.github.com/users/Tarotis/orgs", "repos_url": "https://api.github.com/users/Tarotis/repos", "events_url": "https://api.github.com/users/Tarotis/events{/privacy}", "received_events_url": "https://api.github.com/users/Tarotis/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-01-03T20:41:52Z", "updated_at": "2022-06-18T21:42:06Z", "closed_at": "2022-06-18T21:42:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI have currently two problems with respect to the gold input to the DependencyParser model:\r\n\r\n- the training loads no gold arc input\r\n- If I want to run a final_test() of my model, the newly created test data not only has no gold arc input, but also misses the gold tags. The tags are simply empty, not `None` like the arcs.\r\n\r\nIn both cases, I used a MultiCorpus ColumnCorpus of structure `columns = {0: 'text', 1: 'deprel', 2:'head'}`.\r\n\r\nIf I use a single ColumnCorpus, I receive additional errors in the evaluation run for all `micro avg` scores:\r\n```\r\nmodels/dependency_parser_model.py\", line 329, in evaluate\r\n    precision_score = round(classification_report_dict[\"micro avg\"][\"precision\"], 4)\r\nKeyError: 'micro avg'\r\n```\r\nAfter commenting setting all scores to 0, the same error results as in the MultiCorpus setting. \r\n\r\nThe problem persists when setting `final_test` to the same corpus and base path as in the training setting.\r\n\r\n**To Reproduce**\r\n```\r\nfrom flair.data import MultiCorpus\r\nfrom flair.datasets import ColumnCorpus\r\nfrom flair.embeddings import FlairEmbeddings\r\nfrom flair.models import DependencyParser\r\nfrom flair.trainers import ModelTrainer\r\n\r\ncolumns = {0: 'text', 1: 'deprel', 2:'arc'}\r\nguajajara = ColumnCorpus('data/Guajajara/deprel', columns, train_file = 'train.txt', test_file = 'test.txt', dev_file = 'dev.txt')\r\nakuntsu = ColumnCorpus('data/Akuntsu/deprel', columns, train_file = 'train.txt', test_file = 'test.txt', dev_file = 'dev.txt')\r\n\r\nlabel_type = 'deprel'\r\ndictionary = guajajara.make_label_dictionary(label_type=label_type)\r\n\r\nflair_embedding_forward = FlairEmbeddings('multi-forward')\r\n\r\ntagger = DependencyParser(lstm_hidden_size=32, token_embeddings=flair_embedding_forward, relations_dictionary=dictionary, tag_type=label_type)\r\ntrainer = ModelTrainer(tagger, guajajara)\r\ntrainer.train('models/resources/taggers/dep_tupi', max_epochs=1)\r\n\r\ntagger = DependencyParser.load('models/resources/taggers/dep_tupi/best-model.pt')\r\ntrainer = ModelTrainer(tagger, akuntsu)\r\ntrainer.final_test('models/resources/taggers/eval_deprel', main_evaluation_metric = (\"micro avg\", \"f1-score\"))\r\n```\r\n\r\n**Expected behavior**\r\n- The parser should be able to take the gold arcs available in the data as input to compute the evaluation scores\r\n- evaluation errors should not prompt errors\r\n- new test data implemented in final_test() should come with gold tags\r\n\r\n**Environment (please complete the following information):**\r\n - flair master branch\r\n\r\n**Test-data format**\r\nTraining data format `test.tsv`:\r\n| token | gold_tag | gold_arc | predicted_tag | predicted_arc |\r\n| --- | --- | --- | --- | --- |\r\n| \u0294Aromo | advmod | None | root | 0 |\r\n| uker | root | None | root | 1 |\r\n| . | punct | None | punct | 0 |\r\n\r\nNew final_test (empty gold tag):\r\n| token | gold_tag | gold_arc | predicted_tag | predicted_arc |\r\n| --- | --- | --- | --- | --- |\r\n| Ajojot |  | None | root | 0 |\r\n| jekobe |  | None | obl | 1 |\r\n| cum |  | None | obl | 0 |", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2581/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2581/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2577", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2577/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2577/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2577/events", "html_url": "https://github.com/flairNLP/flair/issues/2577", "id": 1090609147, "node_id": "I_kwDOCCkmXM5BAV_7", "number": 2577, "title": "'Expected all tensors to be on the same device' while training LanguageModel", "user": {"login": "Tarotis", "id": 73231722, "node_id": "MDQ6VXNlcjczMjMxNzIy", "avatar_url": "https://avatars.githubusercontent.com/u/73231722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Tarotis", "html_url": "https://github.com/Tarotis", "followers_url": "https://api.github.com/users/Tarotis/followers", "following_url": "https://api.github.com/users/Tarotis/following{/other_user}", "gists_url": "https://api.github.com/users/Tarotis/gists{/gist_id}", "starred_url": "https://api.github.com/users/Tarotis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Tarotis/subscriptions", "organizations_url": "https://api.github.com/users/Tarotis/orgs", "repos_url": "https://api.github.com/users/Tarotis/repos", "events_url": "https://api.github.com/users/Tarotis/events{/privacy}", "received_events_url": "https://api.github.com/users/Tarotis/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-12-29T15:56:39Z", "updated_at": "2022-02-02T09:44:38Z", "closed_at": "2022-02-02T09:44:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhile training my own FlairEmbeddings, I receive the error message that not all tensors are on the same device. This is both for custom and loaded dictionaries.\r\n\r\n**Expected behavior**\r\nAll tensors are on the same device.\r\n\r\n**The training script:**\r\n```\r\nfrom flair.data import Dictionary\r\nfrom flair.models import LanguageModel\r\nfrom flair.trainers.language_model_trainer import LanguageModelTrainer, TextCorpus\r\nfrom helper_functions import make_dictionary\r\n\r\ndictionary: Dictionary = make_dictionary('data/Shipibo/embeddings/train/train.txt')\r\n# dictionary: Dictionary = Dictionary.load('chars')\r\n\r\nis_forward_lm = True\r\n\r\ncorpus = TextCorpus('data/Shipibo/embeddings', dictionary, is_forward_lm, character_level=True)\r\n\r\nlanguage_model = LanguageModel(dictionary, is_forward_lm, hidden_size=512,nlayers=1)\r\n\r\ntrainer = LanguageModelTrainer(language_model, corpus)\r\ntrainer.train('models/resources/embeddings/sk_word', sequence_length=11, learning_rate=0.3, mini_batch_size=2, max_epochs=30)\r\n```\r\n\r\n**The error message:**\r\n```\r\n2021-12-29 16:43:52,094 Sequence length is 11\r\n2021-12-29 16:43:52,107 Split 1  - (16:43:52)\r\n2021-12-29 16:43:52,536 | split   1 /  1 |   100/65123 batches | ms/batch  4.28 | loss  3.46 | ppl    31.66\r\nTraceback (most recent call last):\r\n  File \"models/flair_embeddings.py\", line 38, in <module>\r\n    max_epochs=30)\r\n  File \"~/flair/trainers/language_model_trainer.py\", line 324, in train\r\n    total_loss += loss.data\r\nRuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!\r\n```\r\n**Environment (please complete the following information):**\r\n - flair master branch\r\n \r\nThe error does **not** reproduce with the most recent published version.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2577/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2577/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2572", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2572/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2572/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2572/events", "html_url": "https://github.com/flairNLP/flair/issues/2572", "id": 1088053251, "node_id": "I_kwDOCCkmXM5A2mAD", "number": 2572, "title": "Getting an \"unk\" tag in 0.10 flair version", "user": {"login": "iliaNecrov", "id": 96539972, "node_id": "U_kgDOBcEVRA", "avatar_url": "https://avatars.githubusercontent.com/u/96539972?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iliaNecrov", "html_url": "https://github.com/iliaNecrov", "followers_url": "https://api.github.com/users/iliaNecrov/followers", "following_url": "https://api.github.com/users/iliaNecrov/following{/other_user}", "gists_url": "https://api.github.com/users/iliaNecrov/gists{/gist_id}", "starred_url": "https://api.github.com/users/iliaNecrov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iliaNecrov/subscriptions", "organizations_url": "https://api.github.com/users/iliaNecrov/orgs", "repos_url": "https://api.github.com/users/iliaNecrov/repos", "events_url": "https://api.github.com/users/iliaNecrov/events{/privacy}", "received_events_url": "https://api.github.com/users/iliaNecrov/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-12-24T00:08:24Z", "updated_at": "2022-05-01T04:07:32Z", "closed_at": "2022-05-01T04:07:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "**In new version of flair I am getting new tag: 'UNK'**\r\nIn previous version it was okay and I got the tags, that I needed\r\n\r\n`flair.__version__\r\n`\r\n- 0.10\r\n\r\n```\r\ncolumns = {0 : 'text', 1 : 'ner'}\r\ndata_folder = \"train\"\r\ncorpus: Corpus = ColumnCorpus(data_folder, columns)\r\nlabel_type = 'ner'\r\nlabel_dict = corpus.make_label_dictionary(label_type=label_type)\r\nprint(label_dict)\r\n```\r\n\r\n**Dictionary with 4 tags: unk, O, B-GPE, I-GPE**\r\n\r\n`flair.__version__\r\n`\r\n- 0.9\r\n\r\n```\r\ncolumns = {0 : 'text', 1 : 'ner'}\r\ndata_folder = \"train\"\r\ncorpus: Corpus = ColumnCorpus(data_folder, columns)\r\nlabel_type = 'ner'\r\nlabel_dict = corpus.make_label_dictionary(label_type=label_type)\r\nprint(label_dict)\r\n```\r\n\r\n**Dictionary with 3 tags: O, B-GPE, I-GPE**\r\n\r\n[train.txt](https://github.com/flairNLP/flair/files/7771865/train.txt)\r\n\r\n\r\nI will be grateful if you can help solve the problem.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2572/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2572/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2566", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2566/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2566/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2566/events", "html_url": "https://github.com/flairNLP/flair/issues/2566", "id": 1085634304, "node_id": "I_kwDOCCkmXM5AtXcA", "number": 2566, "title": "Larger NER is giving 2 different results for same text", "user": {"login": "UdiBhaskar", "id": 23260749, "node_id": "MDQ6VXNlcjIzMjYwNzQ5", "avatar_url": "https://avatars.githubusercontent.com/u/23260749?v=4", "gravatar_id": "", "url": "https://api.github.com/users/UdiBhaskar", "html_url": "https://github.com/UdiBhaskar", "followers_url": "https://api.github.com/users/UdiBhaskar/followers", "following_url": "https://api.github.com/users/UdiBhaskar/following{/other_user}", "gists_url": "https://api.github.com/users/UdiBhaskar/gists{/gist_id}", "starred_url": "https://api.github.com/users/UdiBhaskar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/UdiBhaskar/subscriptions", "organizations_url": "https://api.github.com/users/UdiBhaskar/orgs", "repos_url": "https://api.github.com/users/UdiBhaskar/repos", "events_url": "https://api.github.com/users/UdiBhaskar/events{/privacy}", "received_events_url": "https://api.github.com/users/UdiBhaskar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-12-21T09:45:16Z", "updated_at": "2022-05-25T23:35:22Z", "closed_at": "2022-05-25T23:35:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n\r\nIf we give only one sentence(\"Amazon settles with fired tech workers who criticized company\"), it was predicting Amazon as ORG. If we give the batch input( [\"Amazon settles with fired tech workers who criticized company\", \"I am working at Google\"]), it was predictiong amazon as LOC.\r\n\r\n**To Reproduce**\r\n```\r\nfrom flair.data import Sentence\r\nfrom flair.models import SequenceTagger\r\ntagger = SequenceTagger.load(\"flair/ner-english-large\")\r\nbasic_text1 = \"Amazon settles with fired tech workers who criticized company\"\r\nprint('With only one sentence -->')\r\nsent1 = Sentence(basic_text1)\r\ntagger.predict(sent1)\r\nprint(sent1.get_spans('ner'))\r\nbasic_text1 = \"Amazon settles with fired tech workers who criticized company\"\r\nbasic_text2 = \"I am working at Google\"\r\nprint()\r\nprint('With 2 sents sentence -->')\r\nsents = [Sentence(text) for text in [basic_text1, basic_text2]]\r\ntagger.predict(sents)\r\nprint(sents[0].get_spans('ner'))\r\nprint(sents[1].get_spans('ner'))\r\n```\r\n\r\n```\r\nWith only one sentence -->\r\n[<ORG-span (1): \"Amazon\">]\r\n\r\nWith 2 sents sentence -->\r\n[<LOC-span (1): \"Amazon\">]\r\n[<ORG-span (5): \"Google\">]\r\n```\r\n\r\n\r\n**Expected behavior**\r\nIn the both cases, amazon has to be ORG\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Linux\r\n - Version : 0.10\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2566/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2566/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2563", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2563/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2563/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2563/events", "html_url": "https://github.com/flairNLP/flair/issues/2563", "id": 1083107014, "node_id": "I_kwDOCCkmXM5AjubG", "number": 2563, "title": "loading TARSTagger receives multiple arguments", "user": {"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-12-17T10:24:00Z", "updated_at": "2021-12-20T13:24:29Z", "closed_at": "2021-12-20T13:24:29Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "**Describe the bug**\r\nThe refactored SequenceTagger has a changed signature. This raises during load following error:\r\n`TypeError: __init__() got multiple values for argument 'tag_dictionary'`\r\n\r\n**To Reproduce**\r\nTrain TARSTagger Model with stable flair v0.10 and load with refactored SequenceTagger.\r\n\r\n**Expected behavior**\r\nCorrect load of model.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2563/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2563/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2560", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2560/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2560/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2560/events", "html_url": "https://github.com/flairNLP/flair/issues/2560", "id": 1082804843, "node_id": "I_kwDOCCkmXM5Aikpr", "number": 2560, "title": "predict method in SequenceTagger cannot read flair Dataset", "user": {"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2021-12-17T02:03:39Z", "updated_at": "2021-12-17T13:26:35Z", "closed_at": "2021-12-17T13:26:35Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "**Describe the bug**\r\nNew version of SequenceTagger only accept list of sentences. If you pass a flair dataset such as corpus.test, this will be understood as a sentence.\r\n\r\n**To Reproduce**\r\nLoad any tagger, call tagger.predict() with a flair.dataset object.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2560/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2560/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2557", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2557/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2557/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2557/events", "html_url": "https://github.com/flairNLP/flair/issues/2557", "id": 1082631119, "node_id": "I_kwDOCCkmXM5Ah6PP", "number": 2557, "title": "Error :module 'flair' has no attribute 'nn'", "user": {"login": "Astudnew", "id": 68174083, "node_id": "MDQ6VXNlcjY4MTc0MDgz", "avatar_url": "https://avatars.githubusercontent.com/u/68174083?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Astudnew", "html_url": "https://github.com/Astudnew", "followers_url": "https://api.github.com/users/Astudnew/followers", "following_url": "https://api.github.com/users/Astudnew/following{/other_user}", "gists_url": "https://api.github.com/users/Astudnew/gists{/gist_id}", "starred_url": "https://api.github.com/users/Astudnew/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Astudnew/subscriptions", "organizations_url": "https://api.github.com/users/Astudnew/orgs", "repos_url": "https://api.github.com/users/Astudnew/repos", "events_url": "https://api.github.com/users/Astudnew/events{/privacy}", "received_events_url": "https://api.github.com/users/Astudnew/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-12-16T20:50:07Z", "updated_at": "2022-08-17T10:54:10Z", "closed_at": "2022-04-27T12:09:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm working on kaggel and  flair works fine but suddenly today I got this error \" \"AttributeError: module 'flair' has no attribute 'nn'\r\n \" with the following  :\r\n\r\nfrom flair.data import Sentence\r\nfrom flair.embeddings import FlairEmbeddings, TransformerWordEmbeddings\r\n\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import ColumnCorpus\r\nfrom flair.embeddings import TransformerWordEmbeddings, TokenEmbeddings, StackedEmbeddings, BertEmbeddings, CharacterEmbeddings, BytePairEmbeddings, WordEmbeddings\r\n#from flair.visual.training_curves import Plotter\r\nfrom flair.models import SequenceTagger\r\nfrom flair.trainers import ModelTrainer\r\nfrom typing import List\r\nfrom torch.optim.adam import Adam\r\nimport sys\r\nimport flair, torch\r\nflair.set_seed(42)\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2557/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2557/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2555", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2555/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2555/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2555/events", "html_url": "https://github.com/flairNLP/flair/issues/2555", "id": 1081915322, "node_id": "I_kwDOCCkmXM5AfLe6", "number": 2555, "title": "Current training.log does not store model information + evaluate information", "user": {"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-12-16T08:39:27Z", "updated_at": "2021-12-16T15:35:13Z", "closed_at": "2021-12-16T15:35:13Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "**Describe the bug**\r\nLog during runtime shows all desired information while final training.log does not store it.\r\n\r\n**To Reproduce**\r\nUse any Sequence tagger and train from scratch\r\n\r\nExample log:\r\n[training.log](https://github.com/flairNLP/flair/files/7725679/training.log)", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2555/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2555/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2543", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2543/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2543/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2543/events", "html_url": "https://github.com/flairNLP/flair/issues/2543", "id": 1072569520, "node_id": "I_kwDOCCkmXM4_7hyw", "number": 2543, "title": "loss_weight parameter causes exception for TextPairClassifier", "user": {"login": "nitinlkoin1984", "id": 16309871, "node_id": "MDQ6VXNlcjE2MzA5ODcx", "avatar_url": "https://avatars.githubusercontent.com/u/16309871?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nitinlkoin1984", "html_url": "https://github.com/nitinlkoin1984", "followers_url": "https://api.github.com/users/nitinlkoin1984/followers", "following_url": "https://api.github.com/users/nitinlkoin1984/following{/other_user}", "gists_url": "https://api.github.com/users/nitinlkoin1984/gists{/gist_id}", "starred_url": "https://api.github.com/users/nitinlkoin1984/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nitinlkoin1984/subscriptions", "organizations_url": "https://api.github.com/users/nitinlkoin1984/orgs", "repos_url": "https://api.github.com/users/nitinlkoin1984/repos", "events_url": "https://api.github.com/users/nitinlkoin1984/events{/privacy}", "received_events_url": "https://api.github.com/users/nitinlkoin1984/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "lukasgarbas", "id": 33124203, "node_id": "MDQ6VXNlcjMzMTI0MjAz", "avatar_url": "https://avatars.githubusercontent.com/u/33124203?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lukasgarbas", "html_url": "https://github.com/lukasgarbas", "followers_url": "https://api.github.com/users/lukasgarbas/followers", "following_url": "https://api.github.com/users/lukasgarbas/following{/other_user}", "gists_url": "https://api.github.com/users/lukasgarbas/gists{/gist_id}", "starred_url": "https://api.github.com/users/lukasgarbas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lukasgarbas/subscriptions", "organizations_url": "https://api.github.com/users/lukasgarbas/orgs", "repos_url": "https://api.github.com/users/lukasgarbas/repos", "events_url": "https://api.github.com/users/lukasgarbas/events{/privacy}", "received_events_url": "https://api.github.com/users/lukasgarbas/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "lukasgarbas", "id": 33124203, "node_id": "MDQ6VXNlcjMzMTI0MjAz", "avatar_url": "https://avatars.githubusercontent.com/u/33124203?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lukasgarbas", "html_url": "https://github.com/lukasgarbas", "followers_url": "https://api.github.com/users/lukasgarbas/followers", "following_url": "https://api.github.com/users/lukasgarbas/following{/other_user}", "gists_url": "https://api.github.com/users/lukasgarbas/gists{/gist_id}", "starred_url": "https://api.github.com/users/lukasgarbas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lukasgarbas/subscriptions", "organizations_url": "https://api.github.com/users/lukasgarbas/orgs", "repos_url": "https://api.github.com/users/lukasgarbas/repos", "events_url": "https://api.github.com/users/lukasgarbas/events{/privacy}", "received_events_url": "https://api.github.com/users/lukasgarbas/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2021-12-06T20:15:13Z", "updated_at": "2021-12-29T15:56:10Z", "closed_at": "2021-12-29T15:56:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nUsing loss_weight parameter for TextPairClassier causes the trainer to fail when it is doing a final evaluation at the end of training\r\n\r\n**To Reproduce**\r\n```\r\ntagger = TextPairClassifier(\r\n    document_embeddings=embedding,\r\n    label_dictionary=label_dictionary,\r\n    label_type='similar', loss_weights = {'1': 5., '0': 0.25 }\r\n)\r\n\r\n\r\ntrainer = ModelTrainer(tagger, corpus)\r\n\r\ntrainer.train('./mod',\r\n              learning_rate=2e-4,\r\n              mini_batch_chunk_size=16, # this can be removed if you hae a big GPU\r\n              train_with_dev=False,\r\n              max_epochs=1, embeddings_storage_mode='cpu', checkpoint=True, num_workers=12, scheduler=OneCycleLR, optimizer=torch.optim.AdamW)\r\n```\r\n\r\n\r\n**Expected behavior**\r\nThe model should train without exception\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]:\r\n - Version [e.g. flair-0.3.2]:\r\n\r\n**Additional context**\r\nstacktrace\r\n```\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-9-59bda6c3483a> in <module>\r\n      9               mini_batch_chunk_size=16, # this can be removed if you hae a big GPU\r\n     10               train_with_dev=False,\r\n---> 11               max_epochs=1, embeddings_storage_mode='cpu', checkpoint=True, num_workers=12, scheduler=OneCycleLR, optimizer=torch.optim.AdamW)\r\n\r\n~\\.conda\\envs\\knlu\\lib\\site-packages\\flair\\trainers\\trainer.py in train(self, base_path, learning_rate, mini_batch_size, mini_batch_chunk_size, max_epochs, train_with_dev, train_with_test, monitor_train, monitor_test, main_evaluation_metric, scheduler, anneal_factor, patience, min_learning_rate, initial_extra_patience, optimizer, cycle_momentum, warmup_fraction, embeddings_storage_mode, checkpoint, save_final_model, anneal_with_restarts, anneal_with_prestarts, anneal_against_dev_loss, batch_growth_annealing, shuffle, param_selection_mode, write_weights, num_workers, sampler, use_amp, amp_opt_level, eval_on_train_fraction, eval_on_train_shuffle, save_model_each_k_epochs, tensorboard_comment, use_swa, use_final_model_for_eval, gold_label_dictionary_for_eval, create_file_logs, create_loss_file, epoch, use_tensorboard, tensorboard_log_dir, metrics_for_tensorboard, optimizer_state_dict, scheduler_state_dict, save_optimizer_state, **kwargs)\r\n    748                 num_workers=num_workers,\r\n    749                 main_evaluation_metric=main_evaluation_metric,\r\n--> 750                 gold_label_dictionary_for_eval=gold_label_dictionary_for_eval,\r\n    751             )\r\n    752         else:\r\n\r\n~\\.conda\\envs\\knlu\\lib\\site-packages\\flair\\trainers\\trainer.py in final_test(self, base_path, eval_mini_batch_size, main_evaluation_metric, num_workers, gold_label_dictionary_for_eval)\r\n    836 \r\n    837         if (base_path / \"best-model.pt\").exists():\r\n--> 838             self.model.load_state_dict(self.model.load(base_path / \"best-model.pt\").state_dict())\r\n    839         else:\r\n    840             log.info(\"Testing using last state of model ...\")\r\n\r\n~\\.conda\\envs\\knlu\\lib\\site-packages\\flair\\nn\\model.py in load(cls, model)\r\n    133             state = torch.load(f, map_location='cpu')\r\n    134 \r\n--> 135         model = cls._init_model_with_state_dict(state)\r\n    136 \r\n    137         if 'model_card' in state:\r\n\r\n~\\.conda\\envs\\knlu\\lib\\site-packages\\flair\\models\\pairwise_classification_model.py in _init_model_with_state_dict(state)\r\n    149             multi_label_threshold=0.5 if \"multi_label_threshold\" not in state.keys() else state[\"multi_label_threshold\"],\r\n    150             loss_weights=state[\"loss_weights\"],\r\n--> 151             embed_separately=state[\"embed_separately\"],\r\n    152         )\r\n    153         model.load_state_dict(state[\"state_dict\"])\r\n\r\n~\\.conda\\envs\\knlu\\lib\\site-packages\\flair\\models\\pairwise_classification_model.py in __init__(self, document_embeddings, label_type, embed_separately, **classifierargs)\r\n     34         (if any label's weight is unspecified it will default to 1.0)\r\n     35         \"\"\"\r\n---> 36         super().__init__(**classifierargs)\r\n     37 \r\n     38         self.document_embeddings: flair.embeddings.DocumentEmbeddings = document_embeddings\r\n\r\n~\\.conda\\envs\\knlu\\lib\\site-packages\\flair\\nn\\model.py in __init__(self, label_dictionary, multi_label, multi_label_threshold, loss_weights)\r\n    461             weight_list = [1.0 for i in range(n_classes)]\r\n    462             for i, tag in enumerate(self.label_dictionary.get_items()):\r\n--> 463                 if tag in loss_weights.keys():\r\n    464                     weight_list[i] = loss_weights[tag]\r\n    465             self.loss_weights = torch.FloatTensor(weight_list).to(flair.device)\r\n\r\nAttributeError: 'Tensor' object has no attribute 'keys'\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2543/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2543/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2530", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2530/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2530/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2530/events", "html_url": "https://github.com/flairNLP/flair/issues/2530", "id": 1062817584, "node_id": "I_kwDOCCkmXM4_WU8w", "number": 2530, "title": "Stream is closed for Bert & Sentence Transformer Embedding", "user": {"login": "abdalimran", "id": 5567760, "node_id": "MDQ6VXNlcjU1Njc3NjA=", "avatar_url": "https://avatars.githubusercontent.com/u/5567760?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abdalimran", "html_url": "https://github.com/abdalimran", "followers_url": "https://api.github.com/users/abdalimran/followers", "following_url": "https://api.github.com/users/abdalimran/following{/other_user}", "gists_url": "https://api.github.com/users/abdalimran/gists{/gist_id}", "starred_url": "https://api.github.com/users/abdalimran/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abdalimran/subscriptions", "organizations_url": "https://api.github.com/users/abdalimran/orgs", "repos_url": "https://api.github.com/users/abdalimran/repos", "events_url": "https://api.github.com/users/abdalimran/events{/privacy}", "received_events_url": "https://api.github.com/users/abdalimran/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-11-24T19:19:21Z", "updated_at": "2022-04-03T16:53:34Z", "closed_at": "2022-04-03T16:53:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/ubuntu/miniconda3/envs/text_clustering/lib/python3.8/site-packages/tornado/websocket.py\", line 1104, in wrapper\r\n    raise WebSocketClosedError()\r\ntornado.websocket.WebSocketClosedError\r\n2021-11-24 18:17:20.479 Task exception was never retrieved\r\nfuture: <Task finished name='Task-3416' coro=<WebSocketProtocol13.write_message.<locals>.wrapper() done, defined at /home/ubuntu/miniconda3/envs/text_clustering/lib/python3.8/site-packages/tornado/websocket.py:1100> exception=WebSocketClosedError()>\r\nTraceback (most recent call last):\r\n  File \"/home/ubuntu/miniconda3/envs/text_clustering/lib/python3.8/site-packages/tornado/websocket.py\", line 1102, in wrapper\r\n    await fut\r\ntornado.iostream.StreamClosedError: Stream is closed\r\n```\r\n\r\n**To Reproduce**\r\n```\r\nfrom flair.data import Sentence\r\nfrom flair.embeddings import TransformerDocumentEmbeddings\r\nfrom flair.embeddings import SentenceTransformerDocumentEmbeddings\r\n\r\ndef get_embedding(pretrained_embeddings, sentence):\r\n  sentence = Sentence(sentence)\r\n  pretrained_embeddings.embed(sentence)\r\n  return sentence.embedding.unsqueeze(0).detach().numpy()[0]\r\n\r\ndef get_embedding_data(data, embedding_model, feature):    \r\n    if embedding_model=='glove':\r\n        emb_model = WordEmbeddings(embedding_model)\r\n        embeddings = DocumentPoolEmbeddings([emb_model])\r\n    elif embedding_model=='bert-base-uncased':\r\n        embeddings = TransformerDocumentEmbeddings('bert-base-uncased')\r\n    elif embedding_model=='bert-base-nli-mean-tokens':\r\n        embeddings = SentenceTransformerDocumentEmbeddings('bert-base-nli-mean-tokens')\r\n    data_embd = data.apply(lambda x: get_embedding(embeddings, x[feature]), axis='columns', result_type='expand')\r\n    data_embd = data_embd.set_index(data[feature])\r\n    return data_embd\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Ubuntu 18.04.3 LTS\r\n - Version [e.g. flair-0.3.2]:  flair-0.10\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2530/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2530/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2529", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2529/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2529/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2529/events", "html_url": "https://github.com/flairNLP/flair/issues/2529", "id": 1062197636, "node_id": "I_kwDOCCkmXM4_T9mE", "number": 2529, "title": "Requirements.txt need updates?", "user": {"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2021-11-24T09:35:06Z", "updated_at": "2022-05-20T03:39:24Z", "closed_at": "2022-05-20T03:39:23Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "**Describe the bug**\r\nRequirements.txt is missing some packages. pip install -r requirements.txt aborts since following packages are not installed.\r\n\r\n- six\r\n- appdirs\r\n- packaging\r\n- ordered_set\r\n\r\n**Environment (please complete the following information):**\r\n - Python 3.6\r\n - pip 20.3\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2529/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2529/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2526", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2526/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2526/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2526/events", "html_url": "https://github.com/flairNLP/flair/issues/2526", "id": 1057721268, "node_id": "I_kwDOCCkmXM4_C4u0", "number": 2526, "title": "missing 1 required positional argument: 'label_type'", "user": {"login": "cjing1", "id": 31779053, "node_id": "MDQ6VXNlcjMxNzc5MDUz", "avatar_url": "https://avatars.githubusercontent.com/u/31779053?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cjing1", "html_url": "https://github.com/cjing1", "followers_url": "https://api.github.com/users/cjing1/followers", "following_url": "https://api.github.com/users/cjing1/following{/other_user}", "gists_url": "https://api.github.com/users/cjing1/gists{/gist_id}", "starred_url": "https://api.github.com/users/cjing1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cjing1/subscriptions", "organizations_url": "https://api.github.com/users/cjing1/orgs", "repos_url": "https://api.github.com/users/cjing1/repos", "events_url": "https://api.github.com/users/cjing1/events{/privacy}", "received_events_url": "https://api.github.com/users/cjing1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 16, "created_at": "2021-11-18T19:28:42Z", "updated_at": "2022-06-29T12:32:46Z", "closed_at": "2022-06-29T12:32:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "Thank you for this amazing package for NLP. I am new to flair, and I am trying to use flair to build a text classification model. I tried multiple tutorials from various sources, however, I always got the same error reported. May I ask how to fix it? Or would you mind pointing me to some helpful resources? \r\n\r\nhttps://towardsdatascience.com/text-classification-with-state-of-the-art-nlp-library-flair-b541d7add21f\r\nhttps://www.geeksforgeeks.org/flair-a-framework-for-nlp/\r\n\r\n**Describe the bug**\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-53-8af13eee6597> in <module>\r\n         9 \r\n        10 # create a label dictionary\r\n---> 11 label_Dictionary = corpus.make_label_dictionary()\r\n        12 \r\n        13 # list of word embeddings to be used\r\n\r\nTypeError: make_label_dictionary() missing 1 required positional argument: 'label_type'\r\n\r\n**To Reproduce**\r\n\r\n```python\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import TREC_6\r\nfrom flair.embeddings import WordEmbeddings, FlairEmbeddings, DocumentRNNEmbeddings\r\nfrom flair.models import TextClassifier\r\nfrom flair.trainers import ModelTrainer\r\n  \r\n\r\ncorpus = TREC_6()\r\n  \r\nlabel_Dictionary = corpus.make_label_dictionary()\r\n  \r\nword_embeddings = [WordEmbeddings('glove'),FlairEmbeddings('news-forward-fast')]\r\n  \r\ndoc_embeddings = DocumentRNNEmbeddings(word_embeddings,hidden_size = 250)\r\n  \r\ntext_classifier = TextClassifier(doc_embeddings,label_dictionary = label_Dictionary)\r\n  \r\nmodel_trainer = ModelTrainer(text_classifier,corpus)\r\n  \r\nmodel_trainer.train('resources/taggers/trec',learning_rate=0.1,mini_batch_size=40,anneal_factor=0.5,patience=5,max_epochs=200)\r\n```\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2526/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2526/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2520", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2520/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2520/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2520/events", "html_url": "https://github.com/flairNLP/flair/issues/2520", "id": 1053860184, "node_id": "I_kwDOCCkmXM4-0KFY", "number": 2520, "title": "Error with PyTorch 1.10", "user": {"login": "AdirRahamim", "id": 41895358, "node_id": "MDQ6VXNlcjQxODk1MzU4", "avatar_url": "https://avatars.githubusercontent.com/u/41895358?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AdirRahamim", "html_url": "https://github.com/AdirRahamim", "followers_url": "https://api.github.com/users/AdirRahamim/followers", "following_url": "https://api.github.com/users/AdirRahamim/following{/other_user}", "gists_url": "https://api.github.com/users/AdirRahamim/gists{/gist_id}", "starred_url": "https://api.github.com/users/AdirRahamim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AdirRahamim/subscriptions", "organizations_url": "https://api.github.com/users/AdirRahamim/orgs", "repos_url": "https://api.github.com/users/AdirRahamim/repos", "events_url": "https://api.github.com/users/AdirRahamim/events{/privacy}", "received_events_url": "https://api.github.com/users/AdirRahamim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-11-15T16:27:29Z", "updated_at": "2022-04-16T12:50:47Z", "closed_at": "2022-04-16T12:50:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nI'm working with PyTorch version 1.10, flair version 0.9, and allenNLP version2.8, However, when I try to import Elmo model and initialize it using the following code:\r\n'from flair.embeddings import ELMoEmbeddings\r\nembedding = ELMoEmbeddings()`\r\nIt arises the following error:\r\nTraceback (most recent call last):\r\n  File \"/lib/python3.8/site-packages/IPython/core/interactiveshell.py\", line 3444, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-19-378cb53b2e8d>\", line 1, in <module>\r\n    embedding = ELMoEmbeddings()\r\n  File \"/lib/python3.8/site-packages/flair/embeddings/token.py\", line 1834, in __init__\r\n    import allennlp.commands.elmo\r\n  File \"/Applications/PyCharm.app/Contents/plugins/python/helpers/pydev/_pydev_bundle/pydev_import_hook.py\", line 21, in do_import\r\n    module = self._system_import(name, *args, **kwargs)\r\n  File \"/lib/python3.8/site-packages/allennlp/commands/__init__.py\", line 9, in <module>\r\n    from allennlp.commands.build_vocab import BuildVocab\r\n  File \"/Applications/PyCharm.app/Contents/plugins/python/helpers/pydev/_pydev_bundle/pydev_import_hook.py\", line 21, in do_import\r\n    module = self._system_import(name, *args, **kwargs)\r\n  File \"/lib/python3.8/site-packages/allennlp/commands/build_vocab.py\", line 17, in <module>\r\n    from allennlp.training.util import make_vocab_from_params\r\n  File \"/Applications/PyCharm.app/Contents/plugins/python/helpers/pydev/_pydev_bundle/pydev_import_hook.py\", line 21, in do_import\r\n    module = self._system_import(name, *args, **kwargs)\r\n  File \"/python3.8/site-packages/allennlp/training/__init__.py\", line 2, in <module>\r\n    from allennlp.training.no_op_trainer import NoOpTrainer\r\n  File \"/Applications/PyCharm.app/Contents/plugins/python/helpers/pydev/_pydev_bundle/pydev_import_hook.py\", line 21, in do_import\r\n    module = self._system_import(name, *args, **kwargs)\r\n  File \"/lib/python3.8/site-packages/allennlp/training/no_op_trainer.py\", line 6, in <module>\r\n    from allennlp.models import Model\r\n  File \"/Applications/PyCharm.app/Contents/plugins/python/helpers/pydev/_pydev_bundle/pydev_import_hook.py\", line 21, in do_import\r\n    module = self._system_import(name, *args, **kwargs)\r\n  File \"/lib/python3.8/site-packages/allennlp/models/__init__.py\", line 6, in <module>\r\n    from allennlp.models.model import Model\r\n  File \"/Applications/PyCharm.app/Contents/plugins/python/helpers/pydev/_pydev_bundle/pydev_import_hook.py\", line 21, in do_import\r\n    module = self._system_import(name, *args, **kwargs)\r\n  File \"/lib/python3.8/site-packages/allennlp/models/model.py\", line 22, in <module>\r\n    from allennlp.nn.parallel import DdpAccelerator\r\n  File \"/Applications/PyCharm.app/Contents/plugins/python/helpers/pydev/_pydev_bundle/pydev_import_hook.py\", line 21, in do_import\r\n    module = self._system_import(name, *args, **kwargs)\r\n  File \"/lib/python3.8/site-packages/allennlp/nn/parallel/__init__.py\", line 7, in <module>\r\n    from allennlp.nn.parallel.fairscale_fsdp_accelerator import (\r\n  File \"/Applications/PyCharm.app/Contents/plugins/python/helpers/pydev/_pydev_bundle/pydev_import_hook.py\", line 21, in do_import\r\n    module = self._system_import(name, *args, **kwargs)\r\n  File \"/lib/python3.8/site-packages/allennlp/nn/parallel/fairscale_fsdp_accelerator.py\", line 4, in <module>\r\n    from fairscale.nn import FullyShardedDataParallel as FS_FSDP\r\n  File \"/Applications/PyCharm.app/Contents/plugins/python/helpers/pydev/_pydev_bundle/pydev_import_hook.py\", line 21, in do_import\r\n    module = self._system_import(name, *args, **kwargs)\r\n  File \"/lib/python3.8/site-packages/fairscale/__init__.py\", line 15, in <module>\r\n    from . import nn\r\n  File \"/Applications/PyCharm.app/Contents/plugins/python/helpers/pydev/_pydev_bundle/pydev_import_hook.py\", line 21, in do_import\r\n    module = self._system_import(name, *args, **kwargs)\r\n  File \"/lib/python3.8/site-packages/fairscale/nn/__init__.py\", line 9, in <module>\r\n    from .data_parallel import FullyShardedDataParallel, ShardedDataParallel\r\n  File \"/Applications/PyCharm.app/Contents/plugins/python/helpers/pydev/_pydev_bundle/pydev_import_hook.py\", line 21, in do_import\r\n    module = self._system_import(name, *args, **kwargs)\r\n  File \"/lib/python3.8/site-packages/fairscale/nn/data_parallel/__init__.py\", line 8, in <module>\r\n    from .fully_sharded_data_parallel import FullyShardedDataParallel, TrainingState, auto_wrap_bn\r\n  File \"/Applications/PyCharm.app/Contents/plugins/python/helpers/pydev/_pydev_bundle/pydev_import_hook.py\", line 21, in do_import\r\n    module = self._system_import(name, *args, **kwargs)\r\n  File \"/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py\", line 34, in <module>\r\n    from torch.distributed import ProcessGroup\r\nImportError: cannot import name 'ProcessGroup' from 'torch.distributed' (/lib/python3.8/site-packages/torch/distributed/__init__.py)\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2520/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2520/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2503", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2503/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2503/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2503/events", "html_url": "https://github.com/flairNLP/flair/issues/2503", "id": 1044887312, "node_id": "I_kwDOCCkmXM4-R7cQ", "number": 2503, "title": "AttributeError: 'LanguageModel' object has no attribute 'document_delimiter'", "user": {"login": "sgraaf", "id": 8904453, "node_id": "MDQ6VXNlcjg5MDQ0NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/8904453?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sgraaf", "html_url": "https://github.com/sgraaf", "followers_url": "https://api.github.com/users/sgraaf/followers", "following_url": "https://api.github.com/users/sgraaf/following{/other_user}", "gists_url": "https://api.github.com/users/sgraaf/gists{/gist_id}", "starred_url": "https://api.github.com/users/sgraaf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sgraaf/subscriptions", "organizations_url": "https://api.github.com/users/sgraaf/orgs", "repos_url": "https://api.github.com/users/sgraaf/repos", "events_url": "https://api.github.com/users/sgraaf/events{/privacy}", "received_events_url": "https://api.github.com/users/sgraaf/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-11-04T15:26:03Z", "updated_at": "2022-03-15T10:30:46Z", "closed_at": "2022-03-15T10:30:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nHi! I am trying to \"fine-tune\" an existing, pre-trained `SequenceTagger` model (specifically `flair/ner-english-ontonotes-fast`) on a proprietary, custom `ColumnCorpus` with completely different entity labels. Inspired by a comment in #1540, for this I manipulate the pre-trained model's `state`, after which I run the training using the custom `Corpus`. \r\n\r\nAfter training for `X` epochs (I set `X` to 10), when the trainer saves the `final-model.pt`, I am faced with the following error:\r\n```\r\n[...]\r\n2021-11-04 16:10:35,817 EPOCH 10 done: loss 0.2134 - lr 0.0100000\r\n2021-11-04 16:10:36,329 DEV : loss 0.2844020426273346 - f1-score (micro avg)  0.0\r\n2021-11-04 16:10:36,338 BAD EPOCHS (no improvement): 0\r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\sgraaf\\Documents\\GitHub\\NER-Project\\src\\fine-tune.py\", line 116, in <module>\r\n    main()\r\n  File \"C:\\Users\\sgraaf\\Documents\\GitHub\\NER-Project\\src\\fine-tune.py\", line 107, in main\r\n    trainer.train(\r\n  File \"C:\\Users\\sgraaf\\Documents\\GitHub\\NER-Project\\.venv\\lib\\site-packages\\flair\\trainers\\trainer.py\", line 690, in train\r\n    self.model.save(base_path / \"final-model.pt\")\r\n  File \"C:\\Users\\sgraaf\\Documents\\GitHub\\NER-Project\\.venv\\lib\\site-packages\\flair\\nn\\model.py\", line 85, in save\r\n    torch.save(model_state, str(model_file), pickle_protocol=4)\r\n  File \"C:\\Users\\sgraaf\\Documents\\GitHub\\NER-Project\\.venv\\lib\\site-packages\\torch\\serialization.py\", line 379, in save\r\n    _save(obj, opened_zipfile, pickle_module, pickle_protocol)\r\n  File \"C:\\Users\\sgraaf\\Documents\\GitHub\\NER-Project\\.venv\\lib\\site-packages\\torch\\serialization.py\", line 484, in _save\r\n    pickler.dump(obj)\r\n  File \"C:\\Users\\sgraaf\\Documents\\GitHub\\NER-Project\\.venv\\lib\\site-packages\\flair\\models\\language_model.py\", line 414, in __getstate__\r\n    \"document_delimiter\": self.document_delimiter,\r\n  File \"C:\\Users\\sgraaf\\Documents\\GitHub\\NER-Project\\.venv\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 1130, in __getattr__\r\n    raise AttributeError(\"'{}' object has no attribute '{}'\".format(\r\nAttributeError: 'LanguageModel' object has no attribute 'document_delimiter'\r\n```\r\n\r\n**To Reproduce**\r\nUsing the following script:...\r\n```Python\r\nfrom argparse import ArgumentParser\r\nfrom pathlib import Path\r\n\r\nimport torch\r\nfrom flair.datasets import ColumnCorpus\r\nfrom flair.models import SequenceTagger\r\nfrom flair.models.sequence_tagger_model import START_TAG, STOP_TAG\r\nfrom flair.trainers import ModelTrainer\r\n\r\nTAG_TYPE = \"ner\"\r\n\r\n\r\ndef main():\r\n    parser = ArgumentParser(description=\"Parse annotation data\")\r\n    parser.add_argument(\r\n        \"-i\",\r\n        \"--input_file\",\r\n        type=Path,\r\n        required=True,\r\n        help=\"Path to the input file containing the (raw) annotations.\",\r\n        metavar=\"PATH\",\r\n    )\r\n    parser.add_argument(\r\n        \"-m\",\r\n        \"--model\",\r\n        type=str,\r\n        required=True,\r\n        help=\"The `flair` model to fine-tune on the input file.\",\r\n        metavar=\"MODEL\",\r\n    )\r\n    parser.add_argument(\r\n        \"-o\",\r\n        \"--output_dir\",\r\n        type=Path,\r\n        required=True,\r\n        help=\"The output directory where all output (logs, weights, etc.) will be saved.\",\r\n        metavar=\"PATH\",\r\n    )\r\n\r\n    args = parser.parse_args()\r\n\r\n    # create the output directory\r\n    args.output_dir.mkdir(parents=True, exist_ok=True)\r\n\r\n    # load the corpus\r\n    corpus = ColumnCorpus(\r\n        data_folder=args.input_file.parent,\r\n        column_format={0: \"text\", 1: \"ner\"},\r\n        train_file=args.input_file.name,\r\n        tag_to_bioes=\"ner\",\r\n    )\r\n\r\n    # make the tag dictionary from the corpus\r\n    tag_dictionary = corpus.make_tag_dictionary(tag_type=TAG_TYPE)\r\n    tagset_size = len(tag_dictionary)\r\n\r\n    # load the tagger model to fine-tune\r\n    tagger_ = SequenceTagger.load(args.model)\r\n\r\n    # manipulate the tagger's `state`\r\n    # see: https://github.com/flairNLP/flair/issues/1540#issuecomment-619287834\r\n    state = tagger_._get_state_dict()\r\n\r\n    # update `tag_dictionary`\r\n    state[\"tag_dictionary\"] = tag_dictionary\r\n\r\n    # randomly initialize transitions\r\n    state[\"state_dict\"][\"transitions\"] = torch.nn.Parameter(\r\n        torch.randn(tagset_size, tagset_size)\r\n    )\r\n    state[\"state_dict\"][\"transitions\"].detach()[\r\n        tag_dictionary.get_idx_for_item(START_TAG), :\r\n    ] = -10000\r\n    state[\"state_dict\"][\"transitions\"].detach()[\r\n        :, tag_dictionary.get_idx_for_item(STOP_TAG)\r\n    ] = -10000\r\n\r\n    # randomly initialize linear layer\r\n    num_directions = 2 if tagger_.bidirectional else 1\r\n    linear_layer = torch.nn.Linear(\r\n        tagger_.hidden_size * num_directions, len(tag_dictionary)\r\n    )\r\n    state[\"state_dict\"][\"linear.weight\"] = linear_layer.weight\r\n    state[\"state_dict\"][\"linear.bias\"] = linear_layer.bias\r\n\r\n    # re-initialize the tagger with the manipulated `state`\r\n    tagger = SequenceTagger._init_model_with_state_dict(state)\r\n\r\n    # initialize the trainer\r\n    trainer = ModelTrainer(tagger, corpus)\r\n\r\n    # run training\r\n    trainer.train(\r\n        base_path=args.output_dir,\r\n        learning_rate=0.01,\r\n        mini_batch_size=32,\r\n        max_epochs=10,\r\n    )\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    main()\r\n```\r\n\r\n... with the following arguments:...\r\n```\r\n--input_file path/to/custom/iob_formatted_file.txt \\\r\n--model \"flair/ner-english-ontonotes-fast\" \\\r\n--output_dir path/to/output/directory\r\n```\r\n\r\n.. procudes the above error.\r\n\r\n**Expected behavior**\r\nSimply put, I did not expect any errors.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Windows 10, build 19043.1288\r\n - Version [e.g. flair-0.3.2]: `flair-0.9`", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2503/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2503/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2500", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2500/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2500/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2500/events", "html_url": "https://github.com/flairNLP/flair/issues/2500", "id": 1042332781, "node_id": "I_kwDOCCkmXM4-ILxt", "number": 2500, "title": "using `TransformerWordEmbeddings`", "user": {"login": "zingxy", "id": 28285708, "node_id": "MDQ6VXNlcjI4Mjg1NzA4", "avatar_url": "https://avatars.githubusercontent.com/u/28285708?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zingxy", "html_url": "https://github.com/zingxy", "followers_url": "https://api.github.com/users/zingxy/followers", "following_url": "https://api.github.com/users/zingxy/following{/other_user}", "gists_url": "https://api.github.com/users/zingxy/gists{/gist_id}", "starred_url": "https://api.github.com/users/zingxy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zingxy/subscriptions", "organizations_url": "https://api.github.com/users/zingxy/orgs", "repos_url": "https://api.github.com/users/zingxy/repos", "events_url": "https://api.github.com/users/zingxy/events{/privacy}", "received_events_url": "https://api.github.com/users/zingxy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-11-02T13:18:15Z", "updated_at": "2021-11-03T01:08:59Z", "closed_at": "2021-11-03T01:08:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nwhen I used Huggingface model ''dmis-lab/biobert-base-cased-v1.2'' to embed a sentence, it raises  `OverflowError: int too big to convert`. And model `bert-base-cased`  works.\r\n\r\n**To Reproduce**\r\n\r\n```\r\nbert = TransformerWordEmbeddings('bert-base-cased')\r\n# biobert was trained on pubmed and pmc corpus.\r\nbiobert = TransformerWordEmbeddings('dmis-lab/biobert-base-cased-v1.2')\r\nbert.embed(Sentence('hello'))\r\nbiobert.embed(Sentence('hello'))\r\n```\r\n\r\n**Expected behavior**\r\nA clear and concise description of what you expected to happen.\r\n\r\n**Screenshots**\r\n```\r\n>>>bert.tokenizer\r\nPreTrainedTokenizerFast(name_or_path='bert-base-cased', vocab_size=28996, model_max_len=512, is_fast=True, padding_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'})\r\n>>>biobert.tokenizer\r\nPreTrainedTokenizerFast(name_or_path='dmis-lab/biobert-base-cased-v1.2', vocab_size=28996, **model_max_len=1000000000000000019884624838656**, is_fast=True, padding_side='right', special_tokens={\r\n```\r\nThe biobert tokenizer's **model_max_len** may  cause this error, but I don't know how to fix this bug.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2500/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2500/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2495", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2495/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2495/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2495/events", "html_url": "https://github.com/flairNLP/flair/issues/2495", "id": 1041504826, "node_id": "I_kwDOCCkmXM4-FBo6", "number": 2495, "title": "TARS modell training doesn't proceed after first epoch (1000+ labels in dictionary)", "user": {"login": "MattesR", "id": 42345537, "node_id": "MDQ6VXNlcjQyMzQ1NTM3", "avatar_url": "https://avatars.githubusercontent.com/u/42345537?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MattesR", "html_url": "https://github.com/MattesR", "followers_url": "https://api.github.com/users/MattesR/followers", "following_url": "https://api.github.com/users/MattesR/following{/other_user}", "gists_url": "https://api.github.com/users/MattesR/gists{/gist_id}", "starred_url": "https://api.github.com/users/MattesR/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MattesR/subscriptions", "organizations_url": "https://api.github.com/users/MattesR/orgs", "repos_url": "https://api.github.com/users/MattesR/repos", "events_url": "https://api.github.com/users/MattesR/events{/privacy}", "received_events_url": "https://api.github.com/users/MattesR/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-11-01T19:14:35Z", "updated_at": "2021-11-02T08:03:57Z", "closed_at": "2021-11-02T08:03:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI want to find out whether pre-training the TARS model for an argument aspect classification task with other data improves our scores. For that, I'm training with the [Webis Dataset](https://webis.de/data/webis-argument-framing-19.html), using their frames as classes. There are 1493 labels in the dictionary which is a lot. Is that a problem?\r\n\r\nAfter the first epoch, the training just stops. Or does it take over half an hour to start the second epoch? I'd assume no\r\n\r\n**To Reproduce**\r\nHere's the Code I use for creating the dataset. My GPU has 8GB of RAM, after the first epoch, roughly 6 GB are allocated.\r\n\r\n```\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import CSVClassificationCorpus\r\nfrom flair.models import TARSClassifier\r\nfrom flair.trainers import ModelTrainer\r\nimport torch\r\n\r\nlabel_type = 'question_class'\r\n\r\ndef get_corpus_from_path(path): # creating the corpus works\r\n    column_name_map = {1: \"text\", 2: \"label_topic\"}\r\n    return CSVClassificationCorpus(\r\n        path,\r\n        column_name_map,\r\n        label_type=label_type,\r\n        skip_header=True\r\n    )\r\n\r\ndef train_model(path_tuple):\r\n    torch.cuda.empty_cache()  # just for making sure nothing hogs memory\r\n    tars = TARSClassifier.load(\"tars-base\")\r\n    corpus = get_corpus_from_path(path_tuple[0]) # path_tuple[0] just has the path\r\n    label_dict = corpus.make_label_dictionary(label_type=label_type)\r\n    tars.add_and_switch_to_new_task(\r\n        f\"WEBIS_{path_tuple[1]}\", # path_tuple[1] contains a code for the test run\r\n        label_dictionary=label_dict,\r\n        label_type=label_type\r\n    )\r\n    trainer = ModelTrainer(tars, corpus)\r\n    trainer.train(\r\n        base_path=f'{OUTPUT_PATH}/models/{path_tuple[1]}', # path to store the model artifacts\r\n        learning_rate=0.02, # use very small learning rate\r\n        mini_batch_size=16,\r\n        mini_batch_chunk_size=4,\r\n        max_epochs=10, # terminate after 10 epochs\r\n    )\r\n```\r\nThe log ends with `2021-11-01 19:51:22,653 EPOCH 1 done: loss 0.0314 - lr 0.0200000`\r\n\r\nThe program is still running right now (20:10) but nothing happens.\r\n\r\n**Expected behavior**\r\nThe model finishing training.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Linux Kubuntu 20.04\r\n - Version [e.g. flair-0.3.2]: flair==0.9\r\n\r\n\r\n**Additional context**\r\nDo you think pre-training with that many classes is useful? I would like to just see with the task at hand but alas, I don't get the pre-training working.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2495/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2495/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2489", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2489/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2489/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2489/events", "html_url": "https://github.com/flairNLP/flair/issues/2489", "id": 1034118532, "node_id": "I_kwDOCCkmXM49o2WE", "number": 2489, "title": "Error with saving OneHotEmbeddings with CoNLLUCorpus", "user": {"login": "djstrong", "id": 1849959, "node_id": "MDQ6VXNlcjE4NDk5NTk=", "avatar_url": "https://avatars.githubusercontent.com/u/1849959?v=4", "gravatar_id": "", "url": "https://api.github.com/users/djstrong", "html_url": "https://github.com/djstrong", "followers_url": "https://api.github.com/users/djstrong/followers", "following_url": "https://api.github.com/users/djstrong/following{/other_user}", "gists_url": "https://api.github.com/users/djstrong/gists{/gist_id}", "starred_url": "https://api.github.com/users/djstrong/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/djstrong/subscriptions", "organizations_url": "https://api.github.com/users/djstrong/orgs", "repos_url": "https://api.github.com/users/djstrong/repos", "events_url": "https://api.github.com/users/djstrong/events{/privacy}", "received_events_url": "https://api.github.com/users/djstrong/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-10-23T09:00:59Z", "updated_at": "2021-11-02T03:06:07Z", "closed_at": "2021-11-02T03:06:07Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nSaving model with OneHotEmbeddings and corpus CoNLLUCorpus causes `_pickle.PicklingError: Can't pickle <function <lambda> at 0x7fa069ae2f28>: attribute lookup <lambda> on conllu.parser failed`.\r\n\r\n**To Reproduce**\r\nhttps://colab.research.google.com/drive/1tAQcAGkdJSApCcW-DxTbx_kGHQtdenUD?usp=sharing", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2489/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2489/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2488", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2488/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2488/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2488/events", "html_url": "https://github.com/flairNLP/flair/issues/2488", "id": 1033770518, "node_id": "I_kwDOCCkmXM49nhYW", "number": 2488, "title": "TARS classifier returns no label", "user": {"login": "rxjx", "id": 8461845, "node_id": "MDQ6VXNlcjg0NjE4NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/8461845?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rxjx", "html_url": "https://github.com/rxjx", "followers_url": "https://api.github.com/users/rxjx/followers", "following_url": "https://api.github.com/users/rxjx/following{/other_user}", "gists_url": "https://api.github.com/users/rxjx/gists{/gist_id}", "starred_url": "https://api.github.com/users/rxjx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rxjx/subscriptions", "organizations_url": "https://api.github.com/users/rxjx/orgs", "repos_url": "https://api.github.com/users/rxjx/repos", "events_url": "https://api.github.com/users/rxjx/events{/privacy}", "received_events_url": "https://api.github.com/users/rxjx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-10-22T16:41:38Z", "updated_at": "2022-03-06T03:16:55Z", "closed_at": "2022-03-06T03:16:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "I tuned the TARS base classifier on a single dataset of sentences for a binary classification using 2 labels (belongs to class, does not belong to class). The dataset is unbalanced with 88 positive sentences and 2443 negatives. Training ran fine and sampled results looked reasonable. When I did a sanity check to see which parts of the training data were mis-classified I noticed that there were 4 sentences that got no classification, i.e. get_labels returns an empty list on these sentences. Is that valid behavior? If so, what does it indicate?\r\n\r\nI cannot post my data but all of these 4 sentences had spelling errors or unusual abbreviations.\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2488/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2488/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2483", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2483/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2483/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2483/events", "html_url": "https://github.com/flairNLP/flair/issues/2483", "id": 1030482275, "node_id": "I_kwDOCCkmXM49a-lj", "number": 2483, "title": "Label cleaning heuristic does not consider `Sentence` labels", "user": {"login": "DeNeutoy", "id": 16001974, "node_id": "MDQ6VXNlcjE2MDAxOTc0", "avatar_url": "https://avatars.githubusercontent.com/u/16001974?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DeNeutoy", "html_url": "https://github.com/DeNeutoy", "followers_url": "https://api.github.com/users/DeNeutoy/followers", "following_url": "https://api.github.com/users/DeNeutoy/following{/other_user}", "gists_url": "https://api.github.com/users/DeNeutoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/DeNeutoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DeNeutoy/subscriptions", "organizations_url": "https://api.github.com/users/DeNeutoy/orgs", "repos_url": "https://api.github.com/users/DeNeutoy/repos", "events_url": "https://api.github.com/users/DeNeutoy/events{/privacy}", "received_events_url": "https://api.github.com/users/DeNeutoy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-10-19T15:55:04Z", "updated_at": "2021-11-02T14:33:47Z", "closed_at": "2021-11-02T14:33:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\nIn #2472 , a change was introduced that replaces the internal label dictionary with one that replaces underscores in labels.\r\n\r\nThis causes crashes if you use labels with underscores, because here:\r\nhttps://github.com/flairNLP/flair/blob/master/flair/models/tars_model.py#L61\r\n\r\nwhen the sentences are prepared in the tars format, using the labels as keys does not exist.\r\n\r\nstack trace:\r\n\r\n```\r\n  File \"finetune.py\", line 130, in main\r\n    finetune_tars(tars_format_sampled, tars_format_sampled_dev, tars_format_test, dataset, output_dir)\r\n  File \"finetune.py\", line 46, in finetune_tars\r\n    results = trainer.train(base_path=output_path,\r\n  File \"/Users/markn/anaconda3/envs/annotate/lib/python3.8/site-packages/flair/trainers/trainer.py\", line 467, in train\r\n    loss = self.model.forward_loss(batch_step)\r\n  File \"/Users/markn/anaconda3/envs/annotate/lib/python3.8/site-packages/flair/models/tars_model.py\", line 41, in forward_loss\r\n    sentences = self._get_tars_formatted_sentences(data_points)\r\n  File \"/Users/markn/anaconda3/envs/annotate/lib/python3.8/site-packages/flair/models/tars_model.py\", line 64, in _get_tars_formatted_sentences\r\n    sampled_negative_labels = self._get_nearest_labels_for(positive_labels)\r\n  File \"/Users/markn/anaconda3/envs/annotate/lib/python3.8/site-packages/flair/models/tars_model.py\", line 95, in _get_nearest_labels_for\r\n    for plausible_label in self.label_nearest_map[label]:\r\nKeyError: 'search_creative_work'\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2483/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2483/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2478", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2478/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2478/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2478/events", "html_url": "https://github.com/flairNLP/flair/issues/2478", "id": 1026146348, "node_id": "I_kwDOCCkmXM49KcAs", "number": 2478, "title": "Split possessive markers in SegtokTokenizer", "user": {"login": "AStenco", "id": 82942480, "node_id": "MDQ6VXNlcjgyOTQyNDgw", "avatar_url": "https://avatars.githubusercontent.com/u/82942480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AStenco", "html_url": "https://github.com/AStenco", "followers_url": "https://api.github.com/users/AStenco/followers", "following_url": "https://api.github.com/users/AStenco/following{/other_user}", "gists_url": "https://api.github.com/users/AStenco/gists{/gist_id}", "starred_url": "https://api.github.com/users/AStenco/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AStenco/subscriptions", "organizations_url": "https://api.github.com/users/AStenco/orgs", "repos_url": "https://api.github.com/users/AStenco/repos", "events_url": "https://api.github.com/users/AStenco/events{/privacy}", "received_events_url": "https://api.github.com/users/AStenco/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-10-14T09:03:09Z", "updated_at": "2022-02-20T15:41:14Z", "closed_at": "2022-02-20T15:41:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nI'm working on entity extraction and I've noticed that the tokenizer doesn't split possessive markers with the result that I have different outputs for the same entity. Looking the code it seems that it could be added in the SegtokTokenizer, which already splits contractions. Segtok.tokenizer already has the function 'split_possessive_markers' which would be easy to add.\r\n\r\nThank you!", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2478/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2478/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2476", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2476/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2476/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2476/events", "html_url": "https://github.com/flairNLP/flair/issues/2476", "id": 1023797022, "node_id": "I_kwDOCCkmXM49Bece", "number": 2476, "title": "OverflowError: int too big to convert", "user": {"login": "MelaniaNitu", "id": 6719664, "node_id": "MDQ6VXNlcjY3MTk2NjQ=", "avatar_url": "https://avatars.githubusercontent.com/u/6719664?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MelaniaNitu", "html_url": "https://github.com/MelaniaNitu", "followers_url": "https://api.github.com/users/MelaniaNitu/followers", "following_url": "https://api.github.com/users/MelaniaNitu/following{/other_user}", "gists_url": "https://api.github.com/users/MelaniaNitu/gists{/gist_id}", "starred_url": "https://api.github.com/users/MelaniaNitu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MelaniaNitu/subscriptions", "organizations_url": "https://api.github.com/users/MelaniaNitu/orgs", "repos_url": "https://api.github.com/users/MelaniaNitu/repos", "events_url": "https://api.github.com/users/MelaniaNitu/events{/privacy}", "received_events_url": "https://api.github.com/users/MelaniaNitu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-10-12T13:02:30Z", "updated_at": "2021-11-02T17:40:32Z", "closed_at": "2021-11-02T16:27:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI'm using flair to import existing embedding from Huggingface to train BERTopic as described [here](https://maartengr.github.io/BERTopic/tutorial/embeddings/embeddings.html#flair). As per documentation, we should be able to select any transformer model available on [huggingface](https://huggingface.co/models). For some of the pre-trained models I get this error: **\"OverflowError: int too big to convert\"**.\r\n\r\n**To Reproduce**\r\n```\r\nfrom flair.embeddings import TransformerDocumentEmbeddings\r\nrobert = TransformerDocumentEmbeddings('readerbench/RoBERT-base')\r\nmodel = BERTopic(embedding_model=robert,verbose=True) \r\ndocs = df.text.to_list()\r\ntopics, probabilities = model.fit_transform(docs)\r\n```\r\nOutput:\r\n```\r\n0it [00:00, ?it/s]\r\n---------------------------------------------------------------------------\r\nOverflowError                             Traceback (most recent call last)\r\n<ipython-input-17-4da31a0e0fc5> in <module>()\r\n      9 \r\n     10 #train model\r\n---> 11 topics, probabilities = model.fit_transform(docs)\r\n\r\n10 frames\r\n/usr/local/lib/python3.7/dist-packages/transformers/tokenization_utils_fast.py in set_truncation_and_padding(self, padding_strategy, truncation_strategy, max_length, stride, pad_to_multiple_of)\r\n    352             target = {\"max_length\": max_length, \"stride\": stride, \"strategy\": truncation_strategy.value}\r\n    353             if _truncation != target:\r\n--> 354                 self._tokenizer.enable_truncation(**target)\r\n    355 \r\n    356         if padding_strategy == PaddingStrategy.DO_NOT_PAD:\r\n\r\n**OverflowError: int too big to convert**\r\n```\r\n\r\n**Expected behavior**\r\n\r\nSimilar issue was reported for TransformerWordEmbeddings. Solution for that one is described here: https://githubmemory.com/repo/flairNLP/flair/issues/2210 \r\n\r\nclass TransformerWordEmbeddings(TokenEmbeddings):\r\n--->    NO_MAX_SEQ_LENGTH_MODELS=[XLNetModel, TransfoXLModel, **BertModel**]\r\n\r\n**Environment**\r\nGoogle Colab (Jupyter Notebook)\r\n\r\n**Additional context**\r\nSimilar issue was reported for **TransformerWordEmbedding** for XLNet model which was fixed by @tiagokv. It looks like the PR fix made by @tiagokv is needed as well for the other transformers models besides XLNet so TransformerWordEmbeddings can work properly. \r\n\r\nNow, in the case of **TransformerDocumentEmbeddings**, I guess we would have to \"port\" that fix to make it work with TransformerDocumentEmbeddings as well.\r\n\r\nAny help with publishing this fix is highly appreciated, at least for a multilingual model such as 'bert-base-multilingual-cased' as this will cover 100+ languages.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2476/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2476/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2466", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2466/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2466/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2466/events", "html_url": "https://github.com/flairNLP/flair/issues/2466", "id": 1015261705, "node_id": "I_kwDOCCkmXM48g6oJ", "number": 2466, "title": "AttributeError: 'tuple' object has no attribute 'get_labels'", "user": {"login": "ydennisy", "id": 10243849, "node_id": "MDQ6VXNlcjEwMjQzODQ5", "avatar_url": "https://avatars.githubusercontent.com/u/10243849?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ydennisy", "html_url": "https://github.com/ydennisy", "followers_url": "https://api.github.com/users/ydennisy/followers", "following_url": "https://api.github.com/users/ydennisy/following{/other_user}", "gists_url": "https://api.github.com/users/ydennisy/gists{/gist_id}", "starred_url": "https://api.github.com/users/ydennisy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ydennisy/subscriptions", "organizations_url": "https://api.github.com/users/ydennisy/orgs", "repos_url": "https://api.github.com/users/ydennisy/repos", "events_url": "https://api.github.com/users/ydennisy/events{/privacy}", "received_events_url": "https://api.github.com/users/ydennisy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-10-04T14:34:02Z", "updated_at": "2021-10-26T10:33:28Z", "closed_at": "2021-10-26T10:33:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n`sentences` is a tuple rather than the expected sentence class instance.\r\n\r\nThis can happen training or using the corpus:\r\n\r\n```\r\ntrainer.train(base_path='resources/taggers/xxx'\r\n              learning_rate=0.02, \r\n              mini_batch_size=1, \r\n              max_epochs=1, \r\n              )\r\n```\r\nor\r\n```\r\nlabel_type = 'topic'\r\nlabel_dict = corpus.make_label_dictionary(label_type=label_type)\r\n```\r\n\r\n**Screenshots**\r\n```\r\n---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-16-cc65ae3de96c> in <module>\r\n     22               learning_rate=0.02,\r\n     23               mini_batch_size=1,\r\n---> 24               max_epochs=1,\r\n     25               )\r\n     26 # 5. Load few-shot TARS model\r\n\r\n~/.pyenv/versions/3.7.8/lib/python3.7/site-packages/flair/trainers/trainer.py in train(self, base_path, learning_rate, mini_batch_size, mini_batch_chunk_size, max_epochs, scheduler, cycle_momentum, anneal_factor, patience, initial_extra_patience, min_learning_rate, train_with_dev, train_with_test, monitor_train, monitor_test, embeddings_storage_mode, checkpoint, save_final_model, anneal_with_restarts, anneal_with_prestarts, anneal_against_dev_loss, batch_growth_annealing, shuffle, param_selection_mode, write_weights, num_workers, sampler, use_amp, amp_opt_level, eval_on_train_fraction, eval_on_train_shuffle, save_model_each_k_epochs, main_evaluation_metric, tensorboard_comment, save_best_checkpoints, use_swa, use_final_model_for_eval, gold_label_dictionary_for_eval, **kwargs)\r\n    421 \r\n    422                         # forward pass\r\n--> 423                         loss = self.model.forward_loss(batch_step)\r\n    424                         if isinstance(loss, Tuple):\r\n    425                             average_over += loss[1]\r\n\r\n~/.pyenv/versions/3.7.8/lib/python3.7/site-packages/flair/models/tars_model.py in forward_loss(self, data_points)\r\n     38 \r\n     39         # Transform input data into TARS format\r\n---> 40         sentences = self._get_tars_formatted_sentences(data_points)\r\n     41 \r\n     42         loss = self.tars_model.forward_loss(sentences)\r\n\r\n~/.pyenv/versions/3.7.8/lib/python3.7/site-packages/flair/models/tars_model.py in _get_tars_formatted_sentences(self, sentences)\r\n     59 \r\n     60                 positive_labels = list(OrderedDict.fromkeys(\r\n---> 61                     [label.value for label in sentence.get_labels(self.label_type)]))\r\n     62 \r\n     63                 sampled_negative_labels = self._get_nearest_labels_for(positive_labels)\r\n\r\nAttributeError: 'tuple' object has no attribute 'get_labels'\r\n```\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2466/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2466/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2463", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2463/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2463/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2463/events", "html_url": "https://github.com/flairNLP/flair/issues/2463", "id": 1014442939, "node_id": "I_kwDOCCkmXM48dyu7", "number": 2463, "title": "Tutorial 7 cannot load trained model - ", "user": {"login": "shinchan75034", "id": 34718678, "node_id": "MDQ6VXNlcjM0NzE4Njc4", "avatar_url": "https://avatars.githubusercontent.com/u/34718678?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shinchan75034", "html_url": "https://github.com/shinchan75034", "followers_url": "https://api.github.com/users/shinchan75034/followers", "following_url": "https://api.github.com/users/shinchan75034/following{/other_user}", "gists_url": "https://api.github.com/users/shinchan75034/gists{/gist_id}", "starred_url": "https://api.github.com/users/shinchan75034/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shinchan75034/subscriptions", "organizations_url": "https://api.github.com/users/shinchan75034/orgs", "repos_url": "https://api.github.com/users/shinchan75034/repos", "events_url": "https://api.github.com/users/shinchan75034/events{/privacy}", "received_events_url": "https://api.github.com/users/shinchan75034/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-10-03T16:03:53Z", "updated_at": "2022-02-20T15:41:13Z", "closed_at": "2022-02-20T15:41:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "I followed Tutorial 7 and was able to train the model, but when loading it (model path and presence are verified), I get error: \r\n\r\n```\r\n# load the model you trained\r\nmodel = SequenceTagger.load('resources/taggers/example-pos/final-model.pt')\r\n2021-10-02 22:10:32,722 --------------------------------------------------------------------------------\r\n2021-10-02 22:10:32,723 ACHTUNG: The key 'resources/taggers/example-pos/final-model.pt' was neither found on the ModelHub nor is this a valid path to a file on your system!\r\n2021-10-02 22:10:32,724  -> Please check https://huggingface.co/models?filter=flair for all available models.\r\n2021-10-02 22:10:32,724  -> Alternatively, point to a model file on your local drive.\r\n2021-10-02 22:10:32,724 --------------------------------------------------------------------------------\r\n---------------------------------------------------------------------------\r\nUnboundLocalError                         Traceback (most recent call last)\r\n/tmp/ipykernel_4099/36011077.py in <module>\r\n      1 # load the model you trained\r\n----> 2 model = SequenceTagger.load('resources/taggers/example-pos/final-model.pt')\r\n      3 # create example sentence\r\n      4 sentence = Sentence('I love Berlin')\r\n      5 \r\n\r\n~/anaconda3/envs/pytorch_p37/lib/python3.7/site-packages/flair/nn/model.py in load(cls, model)\r\n     92         :return: the loaded text classifier model\r\n     93         \"\"\"\r\n---> 94         model_file = cls._fetch_model(str(model))\r\n     95 \r\n     96         with warnings.catch_warnings():\r\n\r\n~/anaconda3/envs/pytorch_p37/lib/python3.7/site-packages/flair/models/sequence_tagger_model.py in _fetch_model(model_name)\r\n    998                 Path(flair.cache_root / 'models' / model_folder).rmdir()  # remove folder again if not valid\r\n    999 \r\n-> 1000         return model_path\r\n   1001 \r\n   1002     def get_transition_matrix(self):\r\n\r\nUnboundLocalError: local variable 'model_path' referenced before assignment\r\n\r\nlocal variable 'model_path' referenced before assignment```\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2463/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2463/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2460", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2460/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2460/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2460/events", "html_url": "https://github.com/flairNLP/flair/issues/2460", "id": 1014100179, "node_id": "I_kwDOCCkmXM48cfDT", "number": 2460, "title": "Cuda out of memory issue", "user": {"login": "debjyoti003", "id": 71597840, "node_id": "MDQ6VXNlcjcxNTk3ODQw", "avatar_url": "https://avatars.githubusercontent.com/u/71597840?v=4", "gravatar_id": "", "url": "https://api.github.com/users/debjyoti003", "html_url": "https://github.com/debjyoti003", "followers_url": "https://api.github.com/users/debjyoti003/followers", "following_url": "https://api.github.com/users/debjyoti003/following{/other_user}", "gists_url": "https://api.github.com/users/debjyoti003/gists{/gist_id}", "starred_url": "https://api.github.com/users/debjyoti003/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/debjyoti003/subscriptions", "organizations_url": "https://api.github.com/users/debjyoti003/orgs", "repos_url": "https://api.github.com/users/debjyoti003/repos", "events_url": "https://api.github.com/users/debjyoti003/events{/privacy}", "received_events_url": "https://api.github.com/users/debjyoti003/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-10-02T16:28:30Z", "updated_at": "2022-02-20T15:41:15Z", "closed_at": "2022-02-20T15:41:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have a list of text files on which I want to extract named entities. I am using SequenceTagger.load('ner-ontonotes-fast'). \u200bAfter running for few files I am getting the error \"RuntimeError: CUDA out of memory. Tried to allocate 32.00 MiB (GPU 0; 15.90 GiB total capacity; 14.81 GiB already allocated; 29.75 MiB free; 14.96 GiB reserved in total by PyTorch)\".  Someone, please suggest how to solve this issue.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2460/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2460/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2459", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2459/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2459/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2459/events", "html_url": "https://github.com/flairNLP/flair/issues/2459", "id": 1014058497, "node_id": "I_kwDOCCkmXM48cU4B", "number": 2459, "title": "AttributeError: 'tuple' object has no attribute 'get_labels'", "user": {"login": "ydennisy", "id": 10243849, "node_id": "MDQ6VXNlcjEwMjQzODQ5", "avatar_url": "https://avatars.githubusercontent.com/u/10243849?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ydennisy", "html_url": "https://github.com/ydennisy", "followers_url": "https://api.github.com/users/ydennisy/followers", "following_url": "https://api.github.com/users/ydennisy/following{/other_user}", "gists_url": "https://api.github.com/users/ydennisy/gists{/gist_id}", "starred_url": "https://api.github.com/users/ydennisy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ydennisy/subscriptions", "organizations_url": "https://api.github.com/users/ydennisy/orgs", "repos_url": "https://api.github.com/users/ydennisy/repos", "events_url": "https://api.github.com/users/ydennisy/events{/privacy}", "received_events_url": "https://api.github.com/users/ydennisy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178842, "node_id": "MDU6TGFiZWw5NjExNzg4NDI=", "url": "https://api.github.com/repos/flairNLP/flair/labels/duplicate", "name": "duplicate", "color": "cfd3d7", "default": true, "description": "This issue or pull request already exists"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-10-02T13:59:05Z", "updated_at": "2021-10-13T18:36:40Z", "closed_at": "2021-10-07T08:54:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nThere are multiple code paths where `sentences` is a tuple.\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-16-cc65ae3de96c> in <module>\r\n     22               learning_rate=0.02,\r\n     23               mini_batch_size=1,\r\n---> 24               max_epochs=1,\r\n     25               )\r\n     26 # 5. Load few-shot TARS model\r\n\r\n~/.pyenv/versions/3.7.8/lib/python3.7/site-packages/flair/trainers/trainer.py in train(self, base_path, learning_rate, mini_batch_size, mini_batch_chunk_size, max_epochs, scheduler, cycle_momentum, anneal_factor, patience, initial_extra_patience, min_learning_rate, train_with_dev, train_with_test, monitor_train, monitor_test, embeddings_storage_mode, checkpoint, save_final_model, anneal_with_restarts, anneal_with_prestarts, anneal_against_dev_loss, batch_growth_annealing, shuffle, param_selection_mode, write_weights, num_workers, sampler, use_amp, amp_opt_level, eval_on_train_fraction, eval_on_train_shuffle, save_model_each_k_epochs, main_evaluation_metric, tensorboard_comment, save_best_checkpoints, use_swa, use_final_model_for_eval, gold_label_dictionary_for_eval, **kwargs)\r\n    421 \r\n    422                         # forward pass\r\n--> 423                         loss = self.model.forward_loss(batch_step)\r\n    424                         if isinstance(loss, Tuple):\r\n    425                             average_over += loss[1]\r\n\r\n~/.pyenv/versions/3.7.8/lib/python3.7/site-packages/flair/models/tars_model.py in forward_loss(self, data_points)\r\n     38 \r\n     39         # Transform input data into TARS format\r\n---> 40         sentences = self._get_tars_formatted_sentences(data_points)\r\n     41 \r\n     42         loss = self.tars_model.forward_loss(sentences)\r\n\r\n~/.pyenv/versions/3.7.8/lib/python3.7/site-packages/flair/models/tars_model.py in _get_tars_formatted_sentences(self, sentences)\r\n     59 \r\n     60                 positive_labels = list(OrderedDict.fromkeys(\r\n---> 61                     [label.value for label in sentence.get_labels(self.label_type)]))\r\n     62 \r\n     63                 sampled_negative_labels = self._get_nearest_labels_for(positive_labels)\r\n\r\nAttributeError: 'tuple' object has no attribute 'get_labels'\r\n```\r\n\r\n**To Reproduce**\r\nOne option:\r\n```\r\nlabel_dict = corpus.make_label_dictionary(label_type=label_type)\r\n```\r\nAnother:\r\n`trainer.train()`\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2459/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2459/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2448", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2448/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2448/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2448/events", "html_url": "https://github.com/flairNLP/flair/issues/2448", "id": 1005516602, "node_id": "I_kwDOCCkmXM477vc6", "number": 2448, "title": "AttributeError: 'str' object has no attribute 'remove_labels' ", "user": {"login": "mjoy296-zz", "id": 32390612, "node_id": "MDQ6VXNlcjMyMzkwNjEy", "avatar_url": "https://avatars.githubusercontent.com/u/32390612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mjoy296-zz", "html_url": "https://github.com/mjoy296-zz", "followers_url": "https://api.github.com/users/mjoy296-zz/followers", "following_url": "https://api.github.com/users/mjoy296-zz/following{/other_user}", "gists_url": "https://api.github.com/users/mjoy296-zz/gists{/gist_id}", "starred_url": "https://api.github.com/users/mjoy296-zz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mjoy296-zz/subscriptions", "organizations_url": "https://api.github.com/users/mjoy296-zz/orgs", "repos_url": "https://api.github.com/users/mjoy296-zz/repos", "events_url": "https://api.github.com/users/mjoy296-zz/events{/privacy}", "received_events_url": "https://api.github.com/users/mjoy296-zz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-09-23T14:40:10Z", "updated_at": "2021-10-07T08:58:35Z", "closed_at": "2021-10-07T08:58:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "When using the following code: \r\n\r\n```\r\nfrom flair.models import TextClassifier\r\nfrom flair.data import Sentence\r\n\r\nclassifier = TextClassifier.load('en-sentiment')\r\n\r\nclassifier.predict('this is a test sentence.')\r\n\r\n```\r\nI get the error \r\n\r\n```\r\n---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\n/var/folders/36/j_203fcj42q9bvnlt1sl3j640000gp/T/ipykernel_93456/2587258433.py in <module>\r\n----> 1 classifier.predict('this is a test sentence')\r\n\r\n~/.pyenv/versions/3.8.3/lib/python3.8/site-packages/flair/nn/model.py in predict(self, sentences, mini_batch_size, return_probabilities_for_all_classes, verbose, label_name, return_loss, embedding_storage_mode)\r\n    511                 # remove previously predicted labels of this type\r\n    512                 for sentence in batch:\r\n--> 513                     sentence.remove_labels(label_name)\r\n    514 \r\n    515                 scores, gold_labels, sentences, label_candidates = self.forward_pass(batch,\r\n\r\nAttributeError: 'str' object has no attribute 'remove_labels'\r\n\r\nI am not sure what is going on here. Thanks\r\n\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2448/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2448/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2437", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2437/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2437/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2437/events", "html_url": "https://github.com/flairNLP/flair/issues/2437", "id": 996864174, "node_id": "I_kwDOCCkmXM47avCu", "number": 2437, "title": "Multi-label issues", "user": {"login": "Doug-Hatfield", "id": 90759991, "node_id": "MDQ6VXNlcjkwNzU5OTkx", "avatar_url": "https://avatars.githubusercontent.com/u/90759991?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Doug-Hatfield", "html_url": "https://github.com/Doug-Hatfield", "followers_url": "https://api.github.com/users/Doug-Hatfield/followers", "following_url": "https://api.github.com/users/Doug-Hatfield/following{/other_user}", "gists_url": "https://api.github.com/users/Doug-Hatfield/gists{/gist_id}", "starred_url": "https://api.github.com/users/Doug-Hatfield/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Doug-Hatfield/subscriptions", "organizations_url": "https://api.github.com/users/Doug-Hatfield/orgs", "repos_url": "https://api.github.com/users/Doug-Hatfield/repos", "events_url": "https://api.github.com/users/Doug-Hatfield/events{/privacy}", "received_events_url": "https://api.github.com/users/Doug-Hatfield/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-09-15T09:32:58Z", "updated_at": "2021-09-15T17:38:32Z", "closed_at": "2021-09-15T16:18:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "In v0.8 the multi_label=True and multi_label_threshold=0.0 could be set on the model at inference to get comprehensive and consistent output. In v0.9 it can be set on the label_dict but that does nothing. Inspection of the source appears to confirm that this is a bug. \r\n\r\nAside: an arbitrary threshold of 0.5 for acceptance of a label is illogical to me. Inconsistent outputs are vastly harder to handle downstream and thresholding is trivial for the user. IMO, this is throwing away information to pander to the ignorance of the least knowledgeable user.\r\n\r\n**Reproducing**\r\nlabel_dict.multi_label = True\r\nlabel_dict.multi_label_threshold = 0.0\r\n\r\ntars.add_and_switch_to_new_task(TASK_NAME, \r\n                                label_dictionary=label_dict, \r\n                                label_type = 'XYZ')\r\n\r\nOutput\r\n'XYZ': {'label_dictionary': <flair.data.Dictionary object at 0x7f2b8a9d1a60>, 'label_type': 'XYZ}\r\n\r\n**Expected behavior**\r\n'XYZ': {'label_dictionary': <flair.data.Dictionary object at 0x7f2b7f53dee0>, 'multi_label': True, 'multi_label_threshold': 0.0, 'label_type': 'XYZ', 'beta': 1.0}\r\n\r\n**Environment**\r\n - Databricks notebook\r\n - flair==0.9:", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2437/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2437/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2436", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2436/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2436/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2436/events", "html_url": "https://github.com/flairNLP/flair/issues/2436", "id": 996819880, "node_id": "I_kwDOCCkmXM47akOo", "number": 2436, "title": "Sentence is called with labels argument", "user": {"login": "meghdadFar", "id": 17052992, "node_id": "MDQ6VXNlcjE3MDUyOTky", "avatar_url": "https://avatars.githubusercontent.com/u/17052992?v=4", "gravatar_id": "", "url": "https://api.github.com/users/meghdadFar", "html_url": "https://github.com/meghdadFar", "followers_url": "https://api.github.com/users/meghdadFar/followers", "following_url": "https://api.github.com/users/meghdadFar/following{/other_user}", "gists_url": "https://api.github.com/users/meghdadFar/gists{/gist_id}", "starred_url": "https://api.github.com/users/meghdadFar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/meghdadFar/subscriptions", "organizations_url": "https://api.github.com/users/meghdadFar/orgs", "repos_url": "https://api.github.com/users/meghdadFar/repos", "events_url": "https://api.github.com/users/meghdadFar/events{/privacy}", "received_events_url": "https://api.github.com/users/meghdadFar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-09-15T08:48:15Z", "updated_at": "2021-10-13T10:33:30Z", "closed_at": "2021-10-07T09:17:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nDataFetcher.py:516 initializes a Sentence object with labels argument which does not seem to be a valid argument (anymore). See data.py:598\r\n\r\n**To Reproduce**\r\ncorpus = NLPTaskDataFetcher.load_classification_corpus(Path('./'), test_file='test.tsv', dev_file='val.tsv', train_file='train.tsv')\r\n\r\n\r\n**Error**\r\n```\r\n  File \"../python3.8/site-packages/flair/data_fetcher.py\", line 516, in read_text_classification_file\r\n    sentence = Sentence(text, labels=labels, use_tokenizer=tokenizer)\r\nTypeError: __init__() got an unexpected keyword argument 'labels'\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2436/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2436/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2434", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2434/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2434/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2434/events", "html_url": "https://github.com/flairNLP/flair/issues/2434", "id": 995877454, "node_id": "I_kwDOCCkmXM47W-JO", "number": 2434, "title": "start_pos and end_pos attributes print 'None'", "user": {"login": "rohitjajee", "id": 90690865, "node_id": "MDQ6VXNlcjkwNjkwODY1", "avatar_url": "https://avatars.githubusercontent.com/u/90690865?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rohitjajee", "html_url": "https://github.com/rohitjajee", "followers_url": "https://api.github.com/users/rohitjajee/followers", "following_url": "https://api.github.com/users/rohitjajee/following{/other_user}", "gists_url": "https://api.github.com/users/rohitjajee/gists{/gist_id}", "starred_url": "https://api.github.com/users/rohitjajee/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rohitjajee/subscriptions", "organizations_url": "https://api.github.com/users/rohitjajee/orgs", "repos_url": "https://api.github.com/users/rohitjajee/repos", "events_url": "https://api.github.com/users/rohitjajee/events{/privacy}", "received_events_url": "https://api.github.com/users/rohitjajee/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-09-14T10:55:41Z", "updated_at": "2021-12-30T14:20:10Z", "closed_at": "2021-12-30T14:20:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI am trying to get the start position and end position of the entities in the craft dataset, but the start_pos and end_pos atrribites of the entity object print \u201cNone\u201d. \r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\nimport flair \r\nfrom flair.datasets import biomedical \r\ncraft = biomedical.CRAFT_V4() \r\n\r\nfor sentence  in craft.get_all_sentences(): \r\n\tfor entity in sentence.get_spans(): \r\n\t\tprint(entity.text, entity.labels, entity.start_pos, entity.end_pos) \r\n\r\n**Expected behavior**\r\nIt should the start position and end positions of the entity\r\n\r\n**Output**\r\nDRG [uberon (1.0)] None None  \r\nNeurons [cl (1.0)] None None  \r\nPea3 [pr (1.0)] None None  \r\ndorsal root ganglion [uberon (1.0)] None None  \r\nDRG [uberon (1.0)] None None \r\n. \r\n. \r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]:\r\n - Version [e.g. flair-0.3.2]:\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2434/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2434/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2428", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2428/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2428/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2428/events", "html_url": "https://github.com/flairNLP/flair/issues/2428", "id": 994123675, "node_id": "MDU6SXNzdWU5OTQxMjM2NzU=", "number": 2428, "title": "Segmentation Fault: 11, when Spacy is installed on the same environment", "user": {"login": "Purefekt", "id": 62992224, "node_id": "MDQ6VXNlcjYyOTkyMjI0", "avatar_url": "https://avatars.githubusercontent.com/u/62992224?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Purefekt", "html_url": "https://github.com/Purefekt", "followers_url": "https://api.github.com/users/Purefekt/followers", "following_url": "https://api.github.com/users/Purefekt/following{/other_user}", "gists_url": "https://api.github.com/users/Purefekt/gists{/gist_id}", "starred_url": "https://api.github.com/users/Purefekt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Purefekt/subscriptions", "organizations_url": "https://api.github.com/users/Purefekt/orgs", "repos_url": "https://api.github.com/users/Purefekt/repos", "events_url": "https://api.github.com/users/Purefekt/events{/privacy}", "received_events_url": "https://api.github.com/users/Purefekt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-09-12T10:40:56Z", "updated_at": "2022-01-20T01:39:45Z", "closed_at": "2022-01-20T01:39:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhen i install spacy and flair dependencies on the same virtual environment, the spacy script works normally but the flair script gives 'Segmentation Fault: 11'\r\n\r\n**To Reproduce**\r\nInstall Flask with -> conda install -c anaconda flask\r\nInstall Flair with -> pip install flair\r\nRun flair basic NER script, it works\r\nInstall Spacy -> conda install -c conda-forge spacy\r\nRun spacy basic NER script, it works\r\nRun flair now and it gives this error\r\n\r\n**Expected behavior**\r\nSegmentation Fault: 11\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: macOS Big Sur 11.5.2\r\n - Version [e.g. flair-0.3.2]: flair-0.9\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2428/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2428/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2422", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2422/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2422/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2422/events", "html_url": "https://github.com/flairNLP/flair/issues/2422", "id": 993481879, "node_id": "MDU6SXNzdWU5OTM0ODE4Nzk=", "number": 2422, "title": "TextRegressor, AttributeError: 'list' object has no attribute 'labels'", "user": {"login": "vwoloszyn", "id": 3843367, "node_id": "MDQ6VXNlcjM4NDMzNjc=", "avatar_url": "https://avatars.githubusercontent.com/u/3843367?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vwoloszyn", "html_url": "https://github.com/vwoloszyn", "followers_url": "https://api.github.com/users/vwoloszyn/followers", "following_url": "https://api.github.com/users/vwoloszyn/following{/other_user}", "gists_url": "https://api.github.com/users/vwoloszyn/gists{/gist_id}", "starred_url": "https://api.github.com/users/vwoloszyn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vwoloszyn/subscriptions", "organizations_url": "https://api.github.com/users/vwoloszyn/orgs", "repos_url": "https://api.github.com/users/vwoloszyn/repos", "events_url": "https://api.github.com/users/vwoloszyn/events{/privacy}", "received_events_url": "https://api.github.com/users/vwoloszyn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-09-10T18:23:42Z", "updated_at": "2021-09-12T07:48:50Z", "closed_at": "2021-09-11T20:02:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "from flair.datasets import WASSA_JOY\r\ncorpus = WASSA_JOY()\r\n\r\nembeddings = DocumentPoolEmbeddings([WordEmbeddings('glove')], fine_tune_mode='linear')\r\n\r\nmodel = TextRegressor(embeddings, label_name='happiness')\r\n\r\noutput_folder = 'resources/taggers/regression_test/'\r\n\r\ntrainer = ModelTrainer(model, corpus)\r\ntrainer.train(\r\n    output_folder,\r\n    mini_batch_size=16,\r\n    max_epochs=10,\r\n)\r\n\r\nmodel = TextRegressor.load(output_folder + 'best-model.pt')\r\n\r\nsentence = Sentence('I am so happy')\r\nmodel.predict(sentence)\r\n\r\nprint(sentence)\r\n\r\n\r\n########################\r\ngot the following error\r\n\r\n---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-17-b98a96006f68> in <module>()\r\n     17     output_folder,\r\n     18     mini_batch_size=16,\r\n---> 19     max_epochs=10,\r\n     20 )\r\n     21 \r\n\r\n4 frames\r\n/usr/local/lib/python3.7/dist-packages/flair/models/text_regression_model.py in <listcomp>(.0)\r\n     36                 [float(label.value) for label in sentence.labels], dtype=torch.float\r\n     37             )\r\n---> 38             for sentence in sentences\r\n     39         ]\r\n     40 \r\n\r\nAttributeError: 'list' object has no attribute 'labels'", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2422/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2422/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2407", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2407/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2407/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2407/events", "html_url": "https://github.com/flairNLP/flair/issues/2407", "id": 982915672, "node_id": "MDU6SXNzdWU5ODI5MTU2NzI=", "number": 2407, "title": "Tagger complains that some input tokens are not in the dictionary (despite add_unk=True)", "user": {"login": "dchaplinsky", "id": 131186, "node_id": "MDQ6VXNlcjEzMTE4Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/131186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dchaplinsky", "html_url": "https://github.com/dchaplinsky", "followers_url": "https://api.github.com/users/dchaplinsky/followers", "following_url": "https://api.github.com/users/dchaplinsky/following{/other_user}", "gists_url": "https://api.github.com/users/dchaplinsky/gists{/gist_id}", "starred_url": "https://api.github.com/users/dchaplinsky/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dchaplinsky/subscriptions", "organizations_url": "https://api.github.com/users/dchaplinsky/orgs", "repos_url": "https://api.github.com/users/dchaplinsky/repos", "events_url": "https://api.github.com/users/dchaplinsky/events{/privacy}", "received_events_url": "https://api.github.com/users/dchaplinsky/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "marcelmmm", "id": 39297204, "node_id": "MDQ6VXNlcjM5Mjk3MjA0", "avatar_url": "https://avatars.githubusercontent.com/u/39297204?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marcelmmm", "html_url": "https://github.com/marcelmmm", "followers_url": "https://api.github.com/users/marcelmmm/followers", "following_url": "https://api.github.com/users/marcelmmm/following{/other_user}", "gists_url": "https://api.github.com/users/marcelmmm/gists{/gist_id}", "starred_url": "https://api.github.com/users/marcelmmm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marcelmmm/subscriptions", "organizations_url": "https://api.github.com/users/marcelmmm/orgs", "repos_url": "https://api.github.com/users/marcelmmm/repos", "events_url": "https://api.github.com/users/marcelmmm/events{/privacy}", "received_events_url": "https://api.github.com/users/marcelmmm/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "marcelmmm", "id": 39297204, "node_id": "MDQ6VXNlcjM5Mjk3MjA0", "avatar_url": "https://avatars.githubusercontent.com/u/39297204?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marcelmmm", "html_url": "https://github.com/marcelmmm", "followers_url": "https://api.github.com/users/marcelmmm/followers", "following_url": "https://api.github.com/users/marcelmmm/following{/other_user}", "gists_url": "https://api.github.com/users/marcelmmm/gists{/gist_id}", "starred_url": "https://api.github.com/users/marcelmmm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marcelmmm/subscriptions", "organizations_url": "https://api.github.com/users/marcelmmm/orgs", "repos_url": "https://api.github.com/users/marcelmmm/repos", "events_url": "https://api.github.com/users/marcelmmm/events{/privacy}", "received_events_url": "https://api.github.com/users/marcelmmm/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2021-08-30T15:24:03Z", "updated_at": "2021-09-13T13:54:15Z", "closed_at": "2021-09-13T13:54:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI've trained flair vectors for Ukrainian Language and POS model on UD data using following embeddings:\r\n```python\r\nembedding_types = [\r\n    FastTextEmbeddings('/gdrive/MyDrive/WordVectors/FastText/binary/cc.uk.300.bin'),\r\n\r\n    # comment in this line to use character embeddings\r\n    CharacterEmbeddings(\"/gdrive/MyDrive/ubertext1.0/flair_dictionary.pkl\"),\r\n\r\n    # comment in these lines to use flair embeddings\r\n    FlairEmbeddings('/gdrive/MyDrive/ubertext1.0/resources/language_model_forward2/best-lm.pt'),\r\n    FlairEmbeddings('/gdrive/MyDrive/ubertext1.0/resources/language_model_backward2/best-lm.pt'),\r\n]\r\n```\r\n\r\nBut when I'm trying to tag a sentence using that model it raises following error:\r\n```\r\n2021-08-30 14:13:51,839 The string '\u00ab' is not in dictionary! Dictionary contains only: ['<unk>', ' ', '\u043e', '\u0430', '\u043d', '\u0456', '\u0438', '\u0440', '\u0432', '\u0442', '\u0435', '\u0441', '\u043a', '\u043b', '\u0443', '\u0434', '\u043c', '\u043f', '\u0437', '\u044f', '\u044c', '\u0433', '\u0431', '\\n', '\u0439', '\u0447', '\u0446', '\u0445', '\u0457', '\u0436', '\u044e', '\u0448', '\u0454', '1', \"'\", '0', '\u0449', '2', '\u041f', '\u041a', '\u0444', '\u0423', '\u0421', '\u0412', '-', '\u041d', '\u0410', '\u041c', '9', 'e', '\u0420', 'i', 'a', '\u0414', '\u0422', '5', '3', '\u041e', '\u0417', '4', '\u0411', 'o', '8', 'r', '6', 'n', '\u0406', '7', 't', '\u0413', '\u041b', 's', '.', 'l', '\u042f', '\u0424', 'u', 'c', ',', '\u0427', 'h', 'd', '\u0428', '\u0404', '\u0415', '\u0425', 'm', '\u0426', 'p', '%', 'g', 'I', 'S', '\u042e', 'A', 'y', 'C', 'b', ':', 'k', 'B', 'T', 'M', 'P', 'D', 'f', 'v', '\u0418', 'w', 'F', '\u0416', 'R', '\u044b', 'E', 'L', 'N', 'G', '\u0429', 'V', 'H', '\u0419', '=', 'x', 'X', 'z', 'W', '\u2013', 'O', '_', '\u2014', 'U', 'j', '\u0491', 'K', '+', 'J', '\u042c', '\u0407', '\u2116', '\u00b0', 'Z', 'Y', '\\xad', '\u044d', '$', '\u0490', 'q', '&', 'Q', '*', '\u042d', '#', '\u00b2', '(', ')', '\u00fc', '\u00bd', '\u044a', '\u2212', '\u00e4', '\u0451', '\u0142', '@', '\u00f6', '\u2020', '\u042a', '\u00e8', '\u0103', '\u00b3', '\u00d7', '\u0105', '\u0119', '\u00e2', '\u017c', '\u0219', '\u0161', '\u0101', '\u20ac', '\u00e7', '\u045e', '\u010d', '\u00e0', '\u20b4', '\u0131', '\u00df', '~', '\u00eb', '\u017e', '\u00b7', '\u2022', '\u0463', '\u00e5', '\u00f1', '\u3001', '\u042b', '\u0160', '\u014d', '\u00d6', '\u011b', '\u012b', '\u00e6', '\u015f', '^', '\u00f4', '\u00ea', '\u00e9', '\u00ba', '\u021b', '\u0259', '\u00b1', '\u016b', '\u0458', '\u03b1', '\u0141', '\u00f8', '\u00e3', '\u00ee']\r\n2021-08-30 14:13:51,841 You can create a Dictionary that handles unknown items with an <unk>-key by setting add_unk = True in the construction.\r\n```\r\n\r\nI've double checked how I instantiate dicts:\r\n```python\r\nfrom flair.data import Dictionary\r\ndictionary = Dictionary.load(\"/gdrive/MyDrive/ubertext1.0/flair_dictionary.pkl\")\r\nprint(dictionary.add_unk)\r\n\r\nfrom flair.embeddings import CharacterEmbeddings\r\n\r\ncm = CharacterEmbeddings(\"/gdrive/MyDrive/ubertext1.0/flair_dictionary.pkl\")\r\nprint(cm.char_dictionary.add_unk)\r\n```\r\nand it says `True` both times.\r\n\r\n**To Reproduce**\r\nHere is the model\r\nhttps://drive.google.com/drive/folders/1fQdLsgmdCtle5sCShtqYZjB9ERWL0jbe?usp=sharing\r\nTry tagging sentence like this:\r\n```python\r\nfrom flair.data import Sentence\r\nfrom flair.models import SequenceTagger\r\n\r\ntagger = SequenceTagger.load('/gdrive/MyDrive/FlairResults/POS/ukrainian.fasttext.fbvecs.tokenized.plusdev.plusflairemb.uk_charemb.300d/final-model.pt')\r\n\r\nsentence = Sentence(['\u00ab', '!'])\r\ntagger.predict(sentence)\r\n```\r\n\r\n**Expected behavior**\r\nWell, it should respect unknown tokens/characters\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\nflair==0.9\r\nPython 3.7.11\r\nGoogle Colab Pro Plus\r\n\r\n**Additional context**\r\nI'm really keen to publish my flair models for Ukrainian Language (flair embeddings, NER and POS) but I don't really want to publish something, that might be not usable by others.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2407/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2407/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2390", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2390/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2390/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2390/events", "html_url": "https://github.com/flairNLP/flair/issues/2390", "id": 976799532, "node_id": "MDU6SXNzdWU5NzY3OTk1MzI=", "number": 2390, "title": "Tokenization mismatch and RuntimeError (invalid shape)", "user": {"login": "philfuchs", "id": 88037858, "node_id": "MDQ6VXNlcjg4MDM3ODU4", "avatar_url": "https://avatars.githubusercontent.com/u/88037858?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philfuchs", "html_url": "https://github.com/philfuchs", "followers_url": "https://api.github.com/users/philfuchs/followers", "following_url": "https://api.github.com/users/philfuchs/following{/other_user}", "gists_url": "https://api.github.com/users/philfuchs/gists{/gist_id}", "starred_url": "https://api.github.com/users/philfuchs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philfuchs/subscriptions", "organizations_url": "https://api.github.com/users/philfuchs/orgs", "repos_url": "https://api.github.com/users/philfuchs/repos", "events_url": "https://api.github.com/users/philfuchs/events{/privacy}", "received_events_url": "https://api.github.com/users/philfuchs/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-08-23T09:03:09Z", "updated_at": "2021-08-31T09:29:53Z", "closed_at": "2021-08-31T09:29:52Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nI'm embedding text using `TransformerWordEmbeddings('bert-base-german-cased')` and performing NER using a `SequenceTagger` without rnn and crf afterwards. The embeddings seem to fail when encountering certain unicode symbols.\r\n\r\n**To Reproduce**\r\nI used the tutorials in this repository for named entity recognition, so it's very simple code. The data, however, is proprietary so I cannot provide samples besides the one in the error message.\r\n\r\n```\r\n    embeddings = TransformerWordEmbeddings('bert-base-german-cased')\r\n    tagger: SequenceTagger = SequenceTagger(hidden_size=256,\r\n                                        embeddings=embeddings,\r\n                                        tag_dictionary=tag_dictionary,\r\n                                        tag_type=tag_type,\r\n                                        use_rnn=False,\r\n                                        use_crf=False)\r\n```\r\n\r\n**Error:**\r\n```\r\n2021-08-23 10:20:57,775 Device: cuda:0\r\n2021-08-23 10:20:57,775 ----------------------------------------------------------------------------------------------------\r\n2021-08-23 10:20:57,775 Embeddings storage mode: cpu\r\n2021-08-23 10:20:57,776 ----------------------------------------------------------------------------------------------------\r\n2021-08-23 10:21:18,137 epoch 1 - iter 34/340 - loss 0.78756023 - samples/sec: 53.44 - lr: 0.100000\r\n2021-08-23 10:21:38,630 epoch 1 - iter 68/340 - loss 0.68339882 - samples/sec: 53.35 - lr: 0.100000\r\n2021-08-23 10:21:58,865 epoch 1 - iter 102/340 - loss 0.65048363 - samples/sec: 53.98 - lr: 0.100000\r\n2021-08-23 10:22:19,286 epoch 1 - iter 136/340 - loss 0.61642147 - samples/sec: 53.49 - lr: 0.100000\r\n2021-08-23 10:22:40,070 epoch 1 - iter 170/340 - loss 0.59570234 - samples/sec: 52.55 - lr: 0.100000\r\n2021-08-23 10:22:58,696 Tokenization MISMATCH in sentence '[REDACTED] C / C++ Python ETL Tools Informatica Pentaho DI Big Data / Frameworks \uf06c\uf06c\uf06c\uf06c Microsoft Azure \uf06c\uf06c\uf06c\uf06c Apache Avro \uf06c\uf06c\uf06c\uf06c \uf06c\uf06c\uf06c\uf06c \uf06c\uf06c\uf06c\uf06c \uf06c\uf06c\uf06c\uf06c \uf06c\uf06c\uf06c\uf06c \uf06c\uf06c\uf06c\uf06c \uf06c\uf06c\uf06c\uf06c'\r\n2021-08-23 10:22:58,696 Last matched: 'Token: 43 \uf06c\uf06c\uf06c\uf06c'\r\n2021-08-23 10:22:58,696 Last sentence: 'Token: 49 \uf06c\uf06c\uf06c\uf06c'\r\n2021-08-23 10:22:58,696 subtokenized: '[[REDACTED] 'C', '/', 'C', '+', '+', 'Py', '##th', '##on', 'E', '##TL', 'To', '##ols', 'Inform', '##ati', '##ca', 'Pent', '##ah', '##o', 'D', '##I', 'Big', 'Dat', '##a', '/', 'Fra', '##me', '##work', '##s', 'Microsoft', 'Az', '##ure', 'Ap', '##ache', 'Av', '##ro']'\r\nTraceback (most recent call last):\r\n  File \"train_transformer.py\", line 56, in <module>\r\n    trainer.train(path,\r\n  File \"/home/phil.fuchs/anaconda3/envs/flairtest/lib/python3.8/site-packages/flair/trainers/trainer.py\", line 381, in train\r\n    loss = self.model.forward_loss(batch_step)\r\n  File \"/home/phil.fuchs/anaconda3/envs/flairtest/lib/python3.8/site-packages/flair/models/sequence_tagger_model.py\", line 637, in forward_loss\r\n    features = self.forward(data_points)\r\n  File \"/home/phil.fuchs/anaconda3/envs/flairtest/lib/python3.8/site-packages/flair/models/sequence_tagger_model.py\", line 668, in forward\r\n    sentence_tensor = torch.cat(all_embs).view(\r\nRuntimeError: shape '[32, 109, 768]' is invalid for input of size 2673408\r\n```\r\n\r\n![image](https://user-images.githubusercontent.com/88037858/130417435-0ab1cd63-1ebc-4266-9e26-3c85f6800f8b.png)\r\n\r\n```\r\njulia> '\uf06c'\r\n'\\uf06c': Unicode U+F06C (category Co: Other, private use)\r\n```\r\n\r\nThis seems to trip up the subword tokeniser. Is this behaviour expected for characters like these and I need to filter, or does this issue persist in the current version? This could very well be a case of \"you're holding it wrong\". :smile: \r\n\r\nSimilar issues: \r\n- https://github.com/flairNLP/flair/issues/1699\r\n- https://github.com/flairNLP/flair/issues?q=is%3Aissue+tokenization+mismatch\r\n\r\n**Environment:**\r\n - OS: Ubuntu 20.04\r\n - Version: flair==0.8.0.post1\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2390/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2390/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2387", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2387/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2387/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2387/events", "html_url": "https://github.com/flairNLP/flair/issues/2387", "id": 976318557, "node_id": "MDU6SXNzdWU5NzYzMTg1NTc=", "number": 2387, "title": "Flair NER model RuntimeError", "user": {"login": "scarlettllc", "id": 43486512, "node_id": "MDQ6VXNlcjQzNDg2NTEy", "avatar_url": "https://avatars.githubusercontent.com/u/43486512?v=4", "gravatar_id": "", "url": "https://api.github.com/users/scarlettllc", "html_url": "https://github.com/scarlettllc", "followers_url": "https://api.github.com/users/scarlettllc/followers", "following_url": "https://api.github.com/users/scarlettllc/following{/other_user}", "gists_url": "https://api.github.com/users/scarlettllc/gists{/gist_id}", "starred_url": "https://api.github.com/users/scarlettllc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/scarlettllc/subscriptions", "organizations_url": "https://api.github.com/users/scarlettllc/orgs", "repos_url": "https://api.github.com/users/scarlettllc/repos", "events_url": "https://api.github.com/users/scarlettllc/events{/privacy}", "received_events_url": "https://api.github.com/users/scarlettllc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-08-22T08:24:36Z", "updated_at": "2021-12-28T02:30:37Z", "closed_at": "2021-12-28T02:30:37Z", "author_association": "NONE", "active_lock_reason": null, "body": " OS Ubuntu 18.04.3 LTS\r\n Version 0.6.1\r\n\r\n```\r\n(blink37) jjyu@4210GPU:~$ python\r\nPython 3.7.10 (default, Jun  4 2021, 14:48:32)\r\n[GCC 7.5.0] :: Anaconda, Inc. on linux\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> from flair.data import Sentence\r\n>>> from flair.models import SequenceTagger\r\n>>> sentence = Sentence('what is the capital city of montana usa')\r\n>>> tagger = SequenceTagger.load('ner')\r\n2021-08-22 16:28:33,100 loading file /home/jjyu/.flair/models/en-ner-conll03-v0.4.pt\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/home/jjyu/.conda/envs/blink37/lib/python3.7/site-packages/flair/nn.py\", line 88, in load\r\n    state = torch.load(f, map_location='cpu')\r\n  File \"/home/jjyu/.conda/envs/blink37/lib/python3.7/site-packages/torch/serialization.py\", line 585, in load\r\n    return _legacy_load(opened_file, map_location, pickle_module, **pickle_load_args)\r\n  File \"/home/jjyu/.conda/envs/blink37/lib/python3.7/site-packages/torch/serialization.py\", line 772, in _legacy_load\r\n    deserialized_objects[key]._set_from_file(f, offset, f_should_read_directly)\r\nRuntimeError: unexpected EOF, expected 8228835 more bytes. The file might be corrupted.\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2387/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2387/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2386", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2386/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2386/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2386/events", "html_url": "https://github.com/flairNLP/flair/issues/2386", "id": 976212036, "node_id": "MDU6SXNzdWU5NzYyMTIwMzY=", "number": 2386, "title": "Split/Epoch stats for flair embeddings training are incorrect?", "user": {"login": "dchaplinsky", "id": 131186, "node_id": "MDQ6VXNlcjEzMTE4Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/131186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dchaplinsky", "html_url": "https://github.com/dchaplinsky", "followers_url": "https://api.github.com/users/dchaplinsky/followers", "following_url": "https://api.github.com/users/dchaplinsky/following{/other_user}", "gists_url": "https://api.github.com/users/dchaplinsky/gists{/gist_id}", "starred_url": "https://api.github.com/users/dchaplinsky/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dchaplinsky/subscriptions", "organizations_url": "https://api.github.com/users/dchaplinsky/orgs", "repos_url": "https://api.github.com/users/dchaplinsky/repos", "events_url": "https://api.github.com/users/dchaplinsky/events{/privacy}", "received_events_url": "https://api.github.com/users/dchaplinsky/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178847, "node_id": "MDU6TGFiZWw5NjExNzg4NDc=", "url": "https://api.github.com/repos/flairNLP/flair/labels/question", "name": "question", "color": "2936ad", "default": true, "description": "Further information is requested"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-08-21T20:05:50Z", "updated_at": "2022-01-03T20:24:21Z", "closed_at": "2022-01-03T20:24:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello.\r\n\r\nI'm trying to train flair embeddings for Ukrainian language using Google Colab Pro Plus and checkpoints using the tutorial.\r\n\r\nAnd it looks like it's stuck on epoch 1 forever:\r\n```\r\n2021-08-21 19:55:31,125 -----------------------------------------------------------------------------------------\r\n2021-08-21 19:55:31,130 | end of split 192 / 80 | epoch   1 | time: 1416.35s | valid loss  1.06 | valid ppl     2.89 | learning rate 5.0000\r\n2021-08-21 19:55:31,132 -----------------------------------------------------------------------------------------\r\n2021-08-21 19:55:31,184 Sequence length is 250\r\n2021-08-21 19:55:31,712 Split 193\t - (19:55:31)\r\n2021-08-21 19:55:34,216 read text file with 485230 lines\r\n2021-08-21 19:55:34,732 shuffled\r\n2021-08-21 19:55:47,627 | split 193 / 80 |   100/ 1868 batches | ms/batch 159.12 | loss  1.12 | ppl     3.05\r\n2021-08-21 19:56:03,370 | split 193 / 80 |   200/ 1868 batches | ms/batch 157.41 | loss  1.10 | ppl     3.01\r\n2021-08-21 19:56:19,083 | split 193 / 80 |   300/ 1868 batches | ms/batch 157.10 | loss  1.10 | ppl     3.00\r\n2021-08-21 19:56:34,790 | split 193 / 80 |   400/ 1868 batches | ms/batch 157.04 | loss  1.09 | ppl     2.99\r\n2021-08-21 19:56:50,480 | split 193 / 80 |   500/ 1868 batches | ms/batch 156.89 | loss  1.10 | ppl     3.01\r\n2021-08-21 19:57:06,207 | split 193 / 80 |   600/ 1868 batches | ms/batch 157.24 | loss  1.10 | ppl     3.01\r\n2021-08-21 19:57:21,954 | split 193 / 80 |   700/ 1868 batches | ms/batch 157.45 | loss  1.10 | ppl     2.99\r\n2021-08-21 19:57:37,720 | split 193 / 80 |   800/ 1868 batches | ms/batch 157.64 | loss  1.10 | ppl     3.01\r\n2021-08-21 19:57:53,468 | split 193 / 80 |   900/ 1868 batches | ms/batch 157.46 | loss  1.10 | ppl     3.00\r\n2021-08-21 19:58:09,226 | split 193 / 80 |  1000/ 1868 batches | ms/batch 157.56 | loss  1.11 | ppl     3.02\r\n2021-08-21 19:58:24,991 | split 193 / 80 |  1100/ 1868 batches | ms/batch 157.63 | loss  1.10 | ppl     3.00\r\n2021-08-21 19:58:40,746 | split 193 / 80 |  1200/ 1868 batches | ms/batch 157.52 | loss  1.10 | ppl     3.01\r\n2021-08-21 19:58:56,502 | split 193 / 80 |  1300/ 1868 batches | ms/batch 157.54 | loss  1.10 | ppl     3.02\r\n2021-08-21 19:59:12,258 | split 193 / 80 |  1400/ 1868 batches | ms/batch 157.54 | loss  1.10 | ppl     3.00\r\n2021-08-21 19:59:28,034 | split 193 / 80 |  1500/ 1868 batches | ms/batch 157.74 | loss  1.10 | ppl     3.02\r\n```\r\nSplit **193/80** is a bit confusing. Is that a correct behavior and I need to wait longer?", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2386/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2386/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2381", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2381/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2381/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2381/events", "html_url": "https://github.com/flairNLP/flair/issues/2381", "id": 975564838, "node_id": "MDU6SXNzdWU5NzU1NjQ4Mzg=", "number": 2381, "title": "Flair not working with torch -1.8", "user": {"login": "Harshit1011", "id": 43184379, "node_id": "MDQ6VXNlcjQzMTg0Mzc5", "avatar_url": "https://avatars.githubusercontent.com/u/43184379?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Harshit1011", "html_url": "https://github.com/Harshit1011", "followers_url": "https://api.github.com/users/Harshit1011/followers", "following_url": "https://api.github.com/users/Harshit1011/following{/other_user}", "gists_url": "https://api.github.com/users/Harshit1011/gists{/gist_id}", "starred_url": "https://api.github.com/users/Harshit1011/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Harshit1011/subscriptions", "organizations_url": "https://api.github.com/users/Harshit1011/orgs", "repos_url": "https://api.github.com/users/Harshit1011/repos", "events_url": "https://api.github.com/users/Harshit1011/events{/privacy}", "received_events_url": "https://api.github.com/users/Harshit1011/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-08-20T12:27:08Z", "updated_at": "2021-08-31T20:44:53Z", "closed_at": "2021-08-31T07:48:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "Please add support for torch 1.8", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2381/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2381/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2376", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2376/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2376/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2376/events", "html_url": "https://github.com/flairNLP/flair/issues/2376", "id": 972837050, "node_id": "MDU6SXNzdWU5NzI4MzcwNTA=", "number": 2376, "title": "Different classification scores when using multi_class_prob", "user": {"login": "yosipk", "id": 7121191, "node_id": "MDQ6VXNlcjcxMjExOTE=", "avatar_url": "https://avatars.githubusercontent.com/u/7121191?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yosipk", "html_url": "https://github.com/yosipk", "followers_url": "https://api.github.com/users/yosipk/followers", "following_url": "https://api.github.com/users/yosipk/following{/other_user}", "gists_url": "https://api.github.com/users/yosipk/gists{/gist_id}", "starred_url": "https://api.github.com/users/yosipk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yosipk/subscriptions", "organizations_url": "https://api.github.com/users/yosipk/orgs", "repos_url": "https://api.github.com/users/yosipk/repos", "events_url": "https://api.github.com/users/yosipk/events{/privacy}", "received_events_url": "https://api.github.com/users/yosipk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-08-17T15:54:37Z", "updated_at": "2021-08-19T15:19:21Z", "closed_at": "2021-08-19T15:19:21Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhen using the multi-class classifier's `predict` method with `multi_class_prob` argument set to `True` I would expect that the model behaves the same as with this flag set to `False` except that instead of probabilities for all classes it writes into the predicted labels only the label with highest score. However, that is not the case. \r\n\r\nIn [L493](https://github.com/flairNLP/flair/blob/288f7ce4a0680ac8b3ab27d252f217d2bbd5a73c/flair/nn/model.py#L493) we check if the `multi_class_prob` is set, and if it is the scores are computed by pulling logits through the sigmoid in [L494](https://github.com/flairNLP/flair/blob/288f7ce4a0680ac8b3ab27d252f217d2bbd5a73c/flair/nn/model.py#L494), while if `multi_class_prob` is not set the scores are computed by pulling logits through the softmax in [L507](https://github.com/flairNLP/flair/blob/288f7ce4a0680ac8b3ab27d252f217d2bbd5a73c/flair/nn/model.py#L507). \r\n\r\n**To Reproduce**\r\nRun the model that inherits from `DefaultClassifier` with and without `multi_class_prob` set and compare the scores for the highest scoring class. They scores are different. The sum of scores with `multi_class_prob` is not 1. \r\n\r\n**Expected behavior**\r\nThe scores should be the same. The sum of scores with `multi_class_prob` should be 1 (up to numerical error).\r\n\r\n**Environment (please complete the following information):**\r\n - OS: MacOS (20.5.0 Darwin Kernel)\r\n - Version: 0.8.1 ", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2376/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2376/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2374", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2374/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2374/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2374/events", "html_url": "https://github.com/flairNLP/flair/issues/2374", "id": 972549407, "node_id": "MDU6SXNzdWU5NzI1NDk0MDc=", "number": 2374, "title": "Current documentation not aligned with current release 0.8: Wrong strings for downloading FlairEmbedding LMs", "user": {"login": "repodiac", "id": 53218201, "node_id": "MDQ6VXNlcjUzMjE4MjAx", "avatar_url": "https://avatars.githubusercontent.com/u/53218201?v=4", "gravatar_id": "", "url": "https://api.github.com/users/repodiac", "html_url": "https://github.com/repodiac", "followers_url": "https://api.github.com/users/repodiac/followers", "following_url": "https://api.github.com/users/repodiac/following{/other_user}", "gists_url": "https://api.github.com/users/repodiac/gists{/gist_id}", "starred_url": "https://api.github.com/users/repodiac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/repodiac/subscriptions", "organizations_url": "https://api.github.com/users/repodiac/orgs", "repos_url": "https://api.github.com/users/repodiac/repos", "events_url": "https://api.github.com/users/repodiac/events{/privacy}", "received_events_url": "https://api.github.com/users/repodiac/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-08-17T10:44:19Z", "updated_at": "2021-08-23T12:15:59Z", "closed_at": "2021-08-23T12:15:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nIn `token.py` there are the static URL strings for downloading `FlairEmbedding`-based language models. However, the [documentation](https://github.com/flairNLP/flair/blob/master/resources/docs/embeddings/FLAIR_EMBEDDINGS.md) states at least in the case of `multi-X-fast` that this is the proper string.\r\n\r\nI always got an error that the model did not exist or could not be retrieved. By having a glimpse into the current release's version, I found this:\r\n\r\n```\r\n\"multi-v0-forward-fast\": f\"{hu_path}/lm-multi-forward-fast-v0.1.pt\",\r\n\"multi-v0-backward-fast\": f\"{hu_path}/lm-multi-backward-fast-v0.1.pt\",\r\n```\r\n\r\nSo, your documentation seems to be aligned to the current branch/master but not to the current release (0.8)! Sorry, but this is highly annoying for anyone simply wanting to use your framework and not fiddling with it via git etc.\r\n\r\n**Environment (please complete the following information):**\r\n - flair 0.8 (pypi)\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2374/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2374/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2362", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2362/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2362/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2362/events", "html_url": "https://github.com/flairNLP/flair/issues/2362", "id": 958820855, "node_id": "MDU6SXNzdWU5NTg4MjA4NTU=", "number": 2362, "title": "Adapt pretrained sequence tagger models for refactoring", "user": {"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178843, "node_id": "MDU6TGFiZWw5NjExNzg4NDM=", "url": "https://api.github.com/repos/flairNLP/flair/labels/enhancement", "name": "enhancement", "color": "f9f195", "default": true, "description": "Improving of an existing feature"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}, {"id": 1079291265, "node_id": "MDU6TGFiZWwxMDc5MjkxMjY1", "url": "https://api.github.com/repos/flairNLP/flair/labels/sequence%20tagger", "name": "sequence tagger", "color": "bfd4f2", "default": false, "description": "Related to sequence tagger"}], "state": "closed", "locked": false, "assignee": {"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2021-08-03T07:33:34Z", "updated_at": "2021-12-11T05:21:07Z", "closed_at": "2021-12-11T05:21:07Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "**Describe the bug**\r\nIntegration tests of PR #2361 fail due to unmatching state dicts. Refactoring of load procedure required.\r\n\r\n**To Reproduce**\r\nCheck integration tests of PR #2361.\r\n\r\n**Expected behavior**\r\nCurrent pretrained models load properly.\r\n\r\n**Additional context**\r\nLinked to #2361.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2362/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2362/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2359", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2359/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2359/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2359/events", "html_url": "https://github.com/flairNLP/flair/issues/2359", "id": 957084763, "node_id": "MDU6SXNzdWU5NTcwODQ3NjM=", "number": 2359, "title": "Can't load NER model: 'LanguageModel' object has no attribute '_modules'", "user": {"login": "daniellebitt", "id": 56556467, "node_id": "MDQ6VXNlcjU2NTU2NDY3", "avatar_url": "https://avatars.githubusercontent.com/u/56556467?v=4", "gravatar_id": "", "url": "https://api.github.com/users/daniellebitt", "html_url": "https://github.com/daniellebitt", "followers_url": "https://api.github.com/users/daniellebitt/followers", "following_url": "https://api.github.com/users/daniellebitt/following{/other_user}", "gists_url": "https://api.github.com/users/daniellebitt/gists{/gist_id}", "starred_url": "https://api.github.com/users/daniellebitt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/daniellebitt/subscriptions", "organizations_url": "https://api.github.com/users/daniellebitt/orgs", "repos_url": "https://api.github.com/users/daniellebitt/repos", "events_url": "https://api.github.com/users/daniellebitt/events{/privacy}", "received_events_url": "https://api.github.com/users/daniellebitt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-07-30T21:57:07Z", "updated_at": "2021-09-01T17:11:55Z", "closed_at": "2021-08-03T18:36:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nNER model fails to load after download inside torch nn\r\n\r\n**To Reproduce**\r\n```\r\nfrom flair.models import SequenceTagger\r\nfrom flair.data import Sentence\r\n\r\n# load the model you trained\r\nmodel = SequenceTagger.load('X:/Public/Danielle/RadOncFlairExpts/Files/ner_2021/Output/best-model.pt')\r\n\r\n# create example sentence\r\nsentence = Sentence('I love 30 Gy Berlin with a boost')\r\n\r\n# predict tags and print\r\nmodel.predict(sentence)\r\n\r\nprint(sentence.to_tagged_string())\r\n```\r\n\r\n**Expected behavior**\r\nTagged sentence\r\n\r\n**Output**\r\n```\r\n2021-07-30 17:26:57,318 loading file X:/Public/Danielle/RadOncFlairExpts/Files/ner_2021/Output/best-model.pt\r\nTraceback (most recent call last):\r\n  File \"evaluate-tester2.py\", line 5, in <module>\r\n    model = SequenceTagger.load('X:/Public/Danielle/RadOncFlairExpts/Files/ner_2021/Output/best-model.pt')\r\n  File \"X:\\Public\\Danielle\\RadOncFlairExpts\\Files\\ner_2021\\.venv\\lib\\site-packages\\flair\\nn.py\", line 90, in load\r\n    model = cls._init_model_with_state_dict(state)\r\n  File \"X:\\Public\\Danielle\\RadOncFlairExpts\\Files\\ner_2021\\.venv\\lib\\site-packages\\flair\\models\\sequence_tagger_model.py\", line 295, in _init_model_with_state_dict\r\n    reproject_embeddings=reproject_embeddings,\r\n  File \"X:\\Public\\Danielle\\RadOncFlairExpts\\Files\\ner_2021\\.venv\\lib\\site-packages\\flair\\models\\sequence_tagger_model.py\", line 233, in __init__\r\n    self.to(flair.device)\r\n  File \"X:\\Public\\Danielle\\RadOncFlairExpts\\Files\\ner_2021\\.venv\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 612, in to\r\n    return self._apply(convert)\r\n  File \"X:\\Public\\Danielle\\RadOncFlairExpts\\Files\\ner_2021\\.venv\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 359, in _apply\r\n    module._apply(fn)\r\n  File \"X:\\Public\\Danielle\\RadOncFlairExpts\\Files\\ner_2021\\.venv\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 359, in _apply\r\n    module._apply(fn)\r\n  File \"X:\\Public\\Danielle\\RadOncFlairExpts\\Files\\ner_2021\\.venv\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 359, in _apply\r\n    module._apply(fn)\r\n  File \"X:\\Public\\Danielle\\RadOncFlairExpts\\Files\\ner_2021\\.venv\\lib\\site-packages\\flair\\models\\language_model.py\", line 406, in _apply\r\n    for child_module in self.children():\r\n  File \"X:\\Public\\Danielle\\RadOncFlairExpts\\Files\\ner_2021\\.venv\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 1172, in children\r\n    for name, module in self.named_children():\r\n  File \"X:\\Public\\Danielle\\RadOncFlairExpts\\Files\\ner_2021\\.venv\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 1190, in named_children\r\n    for name, module in self._modules.items():\r\n  File \"X:\\Public\\Danielle\\RadOncFlairExpts\\Files\\ner_2021\\.venv\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 779, in __getattr__\r\n    type(self).__name__, name))\r\ntorch.nn.modules.module.ModuleAttributeError: 'LanguageModel' object has no attribute '_modules'\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Windows 10\r\n - Version [e.g. flair-0.3.2]: flair 0.8.0.post1 (pip installed)\r\n - Torch 1.7.1\r\n - Python 3.6.8\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2359/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2359/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2354", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2354/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2354/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2354/events", "html_url": "https://github.com/flairNLP/flair/issues/2354", "id": 953890593, "node_id": "MDU6SXNzdWU5NTM4OTA1OTM=", "number": 2354, "title": "Error and solution when calling self.model.evaluate in trainer.py line 500", "user": {"login": "lfdharo", "id": 3659963, "node_id": "MDQ6VXNlcjM2NTk5NjM=", "avatar_url": "https://avatars.githubusercontent.com/u/3659963?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lfdharo", "html_url": "https://github.com/lfdharo", "followers_url": "https://api.github.com/users/lfdharo/followers", "following_url": "https://api.github.com/users/lfdharo/following{/other_user}", "gists_url": "https://api.github.com/users/lfdharo/gists{/gist_id}", "starred_url": "https://api.github.com/users/lfdharo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lfdharo/subscriptions", "organizations_url": "https://api.github.com/users/lfdharo/orgs", "repos_url": "https://api.github.com/users/lfdharo/repos", "events_url": "https://api.github.com/users/lfdharo/events{/privacy}", "received_events_url": "https://api.github.com/users/lfdharo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-07-27T13:33:38Z", "updated_at": "2021-12-03T06:15:32Z", "closed_at": "2021-12-03T06:15:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "Line 500 in trainer.py should be changed from:\r\n                  train_part_eval_result, train_part_eval_loss = self.model.evaluate(\r\nto\r\n\r\n                    train_part_eval_result = self.model.evaluate(\r\n                        train_part,\r\n                        gold_label_type=self.model.label_type,\r\n                        mini_batch_size=mini_batch_chunk_size,\r\n                        num_workers=num_workers,\r\n                        embedding_storage_mode=embeddings_storage_mode,\r\n                        main_evaluation_metric=main_evaluation_metric\r\n                    )\r\n\r\nthen, for the rest of things to work they should also be changed to:\r\n\r\n                    result_line += (\r\n                        f\"\\t{train_part_eval_result.loss}\\t{train_part_eval_result.log_line}\"\r\n                    )\r\n                    log.info(\r\n                        f\"TRAIN_SPLIT : loss {train_part_eval_result.loss} - {main_evaluation_metric[1]} ({main_evaluation_metric[0]}) {round(train_part_eval_result.main_score, 4)}\"\r\n                    )", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2354/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2354/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2353", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2353/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2353/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2353/events", "html_url": "https://github.com/flairNLP/flair/issues/2353", "id": 953846535, "node_id": "MDU6SXNzdWU5NTM4NDY1MzU=", "number": 2353, "title": "RuntimeError: There were no tensor arguments to this function", "user": {"login": "LarsFied", "id": 88038325, "node_id": "MDQ6VXNlcjg4MDM4MzI1", "avatar_url": "https://avatars.githubusercontent.com/u/88038325?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LarsFied", "html_url": "https://github.com/LarsFied", "followers_url": "https://api.github.com/users/LarsFied/followers", "following_url": "https://api.github.com/users/LarsFied/following{/other_user}", "gists_url": "https://api.github.com/users/LarsFied/gists{/gist_id}", "starred_url": "https://api.github.com/users/LarsFied/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LarsFied/subscriptions", "organizations_url": "https://api.github.com/users/LarsFied/orgs", "repos_url": "https://api.github.com/users/LarsFied/repos", "events_url": "https://api.github.com/users/LarsFied/events{/privacy}", "received_events_url": "https://api.github.com/users/LarsFied/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-07-27T12:47:01Z", "updated_at": "2021-07-27T14:56:58Z", "closed_at": "2021-07-27T14:56:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhile training a model with Textclassifier a pytorch-function throws an RuntimeError. For me it seems to be an incompatibility of the flair and pytorch versions. Is it a bug or am I doing something wrong? \r\nHere is the console output:\r\n\r\n2021-07-27 13:50:47,744 Computing label dictionary. Progress:\r\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 514/514 [00:06<00:00, 82.85it/s]\r\n2021-07-27 13:50:53,964 [b'5', b'2', b'8', b'0', b'6', b'9', b'4', b'7', b'3', b'1']\r\n2021-07-27 13:50:57,605 ----------------------------------------------------------------------------------------------------\r\n2021-07-27 13:50:57,605 Model: \"TextClassifier(\r\n  (document_embeddings): DocumentPoolEmbeddings(\r\n    fine_tune_mode=none, pooling=mean\r\n    (embeddings): StackedEmbeddings(\r\n      (list_embedding_0): WordEmbeddings('D:\\Transfer\\flair\\de-wiki-fasttext-300d-1M')\r\n    )\r\n  )\r\n  (decoder): Linear(in_features=300, out_features=10, bias=True)\r\n  (loss_function): CrossEntropyLoss()\r\n  (beta): 1.0\r\n  (weights): None\r\n  (weight_tensor) None\r\n)\"\r\n2021-07-27 13:50:57,605 ----------------------------------------------------------------------------------------------------\r\n2021-07-27 13:50:57,605 Corpus: \"Corpus: 385 train + 129 dev + 129 test sentences\"\r\n2021-07-27 13:50:57,605 ----------------------------------------------------------------------------------------------------\r\n2021-07-27 13:50:57,605 Parameters:\r\n2021-07-27 13:50:57,605  - learning_rate: \"0.1\"\r\n2021-07-27 13:50:57,605  - mini_batch_size: \"10\"\r\n2021-07-27 13:50:57,605  - patience: \"5\"\r\n2021-07-27 13:50:57,605  - anneal_factor: \"0.5\"\r\n2021-07-27 13:50:57,605  - max_epochs: \"10\"\r\n2021-07-27 13:50:57,605  - shuffle: \"True\"\r\n2021-07-27 13:50:57,605  - train_with_dev: \"False\"\r\n2021-07-27 13:50:57,605  - batch_growth_annealing: \"False\"\r\n2021-07-27 13:50:57,605 ----------------------------------------------------------------------------------------------------\r\n2021-07-27 13:50:57,605 Model training base path: \"model\"\r\n2021-07-27 13:50:57,605 ----------------------------------------------------------------------------------------------------\r\n2021-07-27 13:50:57,605 Device: cpu\r\n2021-07-27 13:50:57,605 ----------------------------------------------------------------------------------------------------\r\n2021-07-27 13:50:57,605 Embeddings storage mode: cpu\r\n2021-07-27 13:50:57,605 ----------------------------------------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"C:/ADVANDS_Workspaces/Fiedler/test/mytest/flair/main.py\", line 52, in <module>\r\n    max_epochs=10)\r\n  File \"C:\\ADVANDS_Workspaces\\Fiedler\\envs\\ano\\lib\\site-packages\\flair\\trainers\\trainer.py\", line 381, in train\r\n    loss = self.model.forward_loss(batch_step)\r\n  File \"C:\\ADVANDS_Workspaces\\Fiedler\\envs\\ano\\lib\\site-packages\\flair\\models\\text_classification_model.py\", line 144, in forward_loss\r\n    scores = self.forward(data_points)\r\n  File \"C:\\ADVANDS_Workspaces\\Fiedler\\envs\\ano\\lib\\site-packages\\flair\\models\\text_classification_model.py\", line 97, in forward\r\n    self.document_embeddings.embed(sentences)\r\n  File \"C:\\ADVANDS_Workspaces\\Fiedler\\envs\\ano\\lib\\site-packages\\flair\\embeddings\\document.py\", line 313, in embed\r\n    word_embeddings = torch.cat(word_embeddings, dim=0).to(flair.device)\r\nRuntimeError: There were no tensor arguments to this function (e.g., you passed an empty list of Tensors), but no fallback function is registered for schema aten::_cat.  This usually means that this function requires a non-empty list of Tensors.  Available functions are [CPU, QuantizedCPU, BackendSelect, Named, AutogradOther, AutogradCPU, AutogradCUDA, AutogradXLA, AutogradPrivateUse1, AutogradPrivateUse2, AutogradPrivateUse3, Tracer, Autocast, Batched, VmapMode].\r\n\r\nCPU: registered at aten\\src\\ATen\\CPUType.cpp:2127 [kernel]\r\nQuantizedCPU: registered at aten\\src\\ATen\\QuantizedCPUType.cpp:297 [kernel]\r\nBackendSelect: fallthrough registered at ..\\aten\\src\\ATen\\core\\BackendSelectFallbackKernel.cpp:3 [backend fallback]\r\nNamed: registered at ..\\aten\\src\\ATen\\core\\NamedRegistrations.cpp:7 [backend fallback]\r\nAutogradOther: registered at ..\\torch\\csrc\\autograd\\generated\\VariableType_2.cpp:8078 [autograd kernel]\r\nAutogradCPU: registered at ..\\torch\\csrc\\autograd\\generated\\VariableType_2.cpp:8078 [autograd kernel]\r\nAutogradCUDA: registered at ..\\torch\\csrc\\autograd\\generated\\VariableType_2.cpp:8078 [autograd kernel]\r\nAutogradXLA: registered at ..\\torch\\csrc\\autograd\\generated\\VariableType_2.cpp:8078 [autograd kernel]\r\nAutogradPrivateUse1: registered at ..\\torch\\csrc\\autograd\\generated\\VariableType_2.cpp:8078 [autograd kernel]\r\nAutogradPrivateUse2: registered at ..\\torch\\csrc\\autograd\\generated\\VariableType_2.cpp:8078 [autograd kernel]\r\nAutogradPrivateUse3: registered at ..\\torch\\csrc\\autograd\\generated\\VariableType_2.cpp:8078 [autograd kernel]\r\nTracer: registered at ..\\torch\\csrc\\autograd\\generated\\TraceType_2.cpp:9654 [kernel]\r\nAutocast: registered at ..\\aten\\src\\ATen\\autocast_mode.cpp:258 [kernel]\r\nBatched: registered at ..\\aten\\src\\ATen\\BatchingRegistrations.cpp:511 [backend fallback]\r\nVmapMode: fallthrough registered at ..\\aten\\src\\ATen\\VmapModeRegistrations.cpp:33 [backend fallback]\r\nProcess finished with exit code 1\r\n\r\n**Code**\r\ncolumn_name_map = {4: \"text\", 3: \"label_topic\"}\r\ncorpus: Corpus = CSVClassificationCorpus(r\"D:\\Projekte\\_Lieferungen\\mails\\flair_training\",\r\n                                         column_name_map,\r\n                                         skip_header=True,\r\n                                         delimiter=',',\r\n                                         encoding='utf-8',\r\n                                         doublequote=True\r\n                                        )\r\nlabel_dict = corpus.make_label_dictionary()\r\nword_embedding = WordEmbeddings(r'D:\\Transfer\\flair\\de-wiki-fasttext-300d-1M')\r\ndocument_embeddings = DocumentPoolEmbeddings([word_embedding])\r\nclassifier = TextClassifier(document_embeddings, label_dictionary=label_dict)\r\ntrainer = ModelTrainer(classifier, corpus)\r\ntrainer.train('model',\r\n              num_workers=0,\r\n              learning_rate=0.1,\r\n              mini_batch_size=10,\r\n              anneal_factor=0.5,\r\n              patience=5,\r\n              max_epochs=10)\r\n\r\n**Environment:**\r\nOS: Microsoft Windows Server 2016, Version 1607 (OS Build 14393.4225)\r\nflair==0.8.0.post1\r\ntoolz==0.9.0\r\ntorch==1.7.1+cu101\r\ntorchaudio==0.7.2\r\ntorchcontrib==0.0.2\r\ntorchvision==0.8.2+cu101\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2353/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2353/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2344", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2344/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2344/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2344/events", "html_url": "https://github.com/flairNLP/flair/issues/2344", "id": 948140041, "node_id": "MDU6SXNzdWU5NDgxNDAwNDE=", "number": 2344, "title": "Unable to read in TARS model on AWS Lambda", "user": {"login": "jrpresta", "id": 40158959, "node_id": "MDQ6VXNlcjQwMTU4OTU5", "avatar_url": "https://avatars.githubusercontent.com/u/40158959?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jrpresta", "html_url": "https://github.com/jrpresta", "followers_url": "https://api.github.com/users/jrpresta/followers", "following_url": "https://api.github.com/users/jrpresta/following{/other_user}", "gists_url": "https://api.github.com/users/jrpresta/gists{/gist_id}", "starred_url": "https://api.github.com/users/jrpresta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jrpresta/subscriptions", "organizations_url": "https://api.github.com/users/jrpresta/orgs", "repos_url": "https://api.github.com/users/jrpresta/repos", "events_url": "https://api.github.com/users/jrpresta/events{/privacy}", "received_events_url": "https://api.github.com/users/jrpresta/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-07-20T00:43:39Z", "updated_at": "2021-07-22T15:35:37Z", "closed_at": "2021-07-22T15:35:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n\r\nUsing the `from flair.models.text_classification_model import TARSClassifier` sub-package:\r\n\r\nOne of my DS interns built a great Flair model, and we'd like to put it into use. Our runtime system works well with AWS Lambda, so I've been working to get her work onto a Lambda. When calling `TARSClassifier.load()` on the model's file path, I'm met with the following error: `OSError: [Errno 30] Read-only file system: '/home/sbx_user1051'`\r\n\r\nIn the Lambda, I only have write permission to the `/tmp` directory. From what I can tell, there is no way to specify where the model is being cached, and so the model eventually calls `os.makedir` in a directory where it doesn't have access.\r\n\r\nI'll post the entire error log at the bottom of this.\r\n\r\n**To Reproduce**\r\nCall `TARSClassifier.load()` on a pre-trained model in AWS Lambda.\r\n\r\n**Expected behavior**\r\nI would like the API to have the ability to specify the directory, so that the model values can be cached in the `/tmp` directory.\r\n\r\n**Screenshots**\r\n![Screen Shot 2021-07-19 at 5 40 55 PM](https://user-images.githubusercontent.com/40158959/126245006-f685009f-553c-40b1-aefe-f4883b36532c.png)\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - AWS Lambda (Ubuntu?)\r\n - Version 0.8.0.post1\r\n\r\n**Additional context**\r\nI haven't 100% ruled out that the model is unexpectedly downloading some model file from the internet. However, the model is all pre-trained by my intern and should be all that is needed to set up inference.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2344/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2344/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2338", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2338/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2338/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2338/events", "html_url": "https://github.com/flairNLP/flair/issues/2338", "id": 944611440, "node_id": "MDU6SXNzdWU5NDQ2MTE0NDA=", "number": 2338, "title": "Error loading flair/ner-english-ontonotes-large", "user": {"login": "anetschka", "id": 17731067, "node_id": "MDQ6VXNlcjE3NzMxMDY3", "avatar_url": "https://avatars.githubusercontent.com/u/17731067?v=4", "gravatar_id": "", "url": "https://api.github.com/users/anetschka", "html_url": "https://github.com/anetschka", "followers_url": "https://api.github.com/users/anetschka/followers", "following_url": "https://api.github.com/users/anetschka/following{/other_user}", "gists_url": "https://api.github.com/users/anetschka/gists{/gist_id}", "starred_url": "https://api.github.com/users/anetschka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/anetschka/subscriptions", "organizations_url": "https://api.github.com/users/anetschka/orgs", "repos_url": "https://api.github.com/users/anetschka/repos", "events_url": "https://api.github.com/users/anetschka/events{/privacy}", "received_events_url": "https://api.github.com/users/anetschka/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-07-14T16:40:02Z", "updated_at": "2021-11-23T03:21:07Z", "closed_at": "2021-11-23T03:21:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhen loading the model, I get the following error:\r\n\r\n`from flair.data import Sentence`\r\n`from flair.models import SequenceTagger`\r\n`tagger = SequenceTagger.load(\"flair/ner-english-ontonotes-large\")`\r\n\r\n![image](https://user-images.githubusercontent.com/17731067/125659601-e4db68bf-dba8-41e7-9184-5c2492bd90e9.png)\r\n\r\nI have also tried telling flair explicitly to use the GPU, but to no avail. I installed flair through pip. Is there a way to install a version that will use the GPU or is this unrelated?\r\n\r\n**To Reproduce**\r\nI am doing this on Windows 10. I have torch 1.7,1+cu101 installed and my GPU is available.\r\n\r\n**Expected behavior**\r\nI have earlier successfully loaded the standard NER model.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2338/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2338/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2328", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2328/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2328/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2328/events", "html_url": "https://github.com/flairNLP/flair/issues/2328", "id": 935977656, "node_id": "MDU6SXNzdWU5MzU5Nzc2NTY=", "number": 2328, "title": "Flair en-sentiment model loading fails when not connected to the internet", "user": {"login": "rahul3", "id": 6377625, "node_id": "MDQ6VXNlcjYzNzc2MjU=", "avatar_url": "https://avatars.githubusercontent.com/u/6377625?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rahul3", "html_url": "https://github.com/rahul3", "followers_url": "https://api.github.com/users/rahul3/followers", "following_url": "https://api.github.com/users/rahul3/following{/other_user}", "gists_url": "https://api.github.com/users/rahul3/gists{/gist_id}", "starred_url": "https://api.github.com/users/rahul3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rahul3/subscriptions", "organizations_url": "https://api.github.com/users/rahul3/orgs", "repos_url": "https://api.github.com/users/rahul3/repos", "events_url": "https://api.github.com/users/rahul3/events{/privacy}", "received_events_url": "https://api.github.com/users/rahul3/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-07-02T18:20:56Z", "updated_at": "2021-11-07T09:24:43Z", "closed_at": "2021-11-07T09:24:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nThe `en-sentiment` model loading fails for me when I do not have a working internet connection, with the error message that I have detailed below. I have tried a lot of things including configuring and checking the .flair folder and the .cache folder that the transformers package uses. I also checked that distilbert-base-uncased is a current model identifier on https://huggingface.co/models as the error message suggested.\r\n\r\n**Code that fails:**\r\n\r\n    from flair.models import TextClassifier\r\n    en_classifier = TextClassifier.load('en-sentiment')\r\n\r\n**Error:**\r\n\r\n*Can't load tokenizer for 'distilbert-base-uncased'. Make sure that:*\r\n\r\n*'distilbert-base-uncased' is a correct model identifier listed on 'https://huggingface.co/models'*\r\n\r\n*or 'distilbert-base-uncased' is the correct path to a directory containing relevant tokenizer files*\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior (e.g. which model did you train? what parameters did you use? etc.).\r\n\r\nUse without internet connection\r\n\r\nEnvironment variables that I used because my app needs to run standalone with no internet connection:\r\n\r\n    TRANSFORMERS_OFFLINE=1\r\n    HF_DATASETS_OFFLINE=1\r\n\r\n**Expected behavior**\r\nThe model is supposed to load just like the `sentiment-fast` model loads.\r\n\r\n**Screenshots**\r\nNA\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]:Windows and Linux\r\n - Version [e.g. flair-0.3.2]:0.8.0.post1\r\n\r\n**Additional context**\r\n\r\nI have the model files located in the `.flair` directory that is configured by `flair.cache_root`. The code that works for me when I load other models is:\r\n\r\n    from flair.models import TextClassifier\r\n    rnn_classifier = TextClassifier.load('sentiment-fast')\r\n\r\neven this works:\r\n\r\n    from flair.models import SequenceTagger\r\n    tagger = SequenceTagger.load('ner')\r\n\r\n\r\n\r\n`.flair` directory has:\r\n\r\n - `sentiment-en-mix-distillbert_4.pt`\r\n - `sentiment-en-mix-ft-rnn.pt`\r\n - `ner-english` (folder)\r\n - `pos-english` (folder)\r\n\r\n`~/.cache/huggingface/transformers` directory has:\r\n\r\n - `0e1bbfda7f63a99bb52e3915dcf10c3c92122b827d92eb2d34ce94ee79ba486c.d789d64ebfe299b0e416afc4a169632f903f693095b4629a7ea271d5a0cf2c99`\r\n - `0e1bbfda7f63a99bb52e3915dcf10c3c92122b827d92eb2d34ce94ee79ba486c.d789d64ebfe299b0e416afc4a169632f903f693095b4629a7ea271d5a0cf2c99.json`\r\n - `75abb59d7a06f4f640158a9bfcde005264e59e8d566781ab1415b139d2e4c603.7f2721073f19841be16f41b0a70b600ca6b880c8f3df6f3535cbc704371bdfa4`\r\n -   `75abb59d7a06f4f640158a9bfcde005264e59e8d566781ab1415b139d2e4c603.7f2721073f19841be16f41b0a70b600ca6b880c8f3df6f3535cbc704371bdfa4.json`\r\n - `8c8624b8ac8aa99c60c912161f8332de003484428c47906d7ff7eb7f73eecdbb.20430bd8e10ef77a7d2977accefe796051e01bc2fc4aa146bc862997a1a15e79`\r\n -  `8c8624b8ac8aa99c60c912161f8332de003484428c47906d7ff7eb7f73eecdbb.20430bd8e10ef77a7d2977accefe796051e01bc2fc4aa146bc862997a1a15e79.json`\r\n\r\nI also asked this question on StackOverflow here: https://stackoverflow.com/questions/68214370/flair-en-sentiment-model-loading-fails-when-not-connected-to-the-internet", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2328/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2328/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2325", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2325/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2325/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2325/events", "html_url": "https://github.com/flairNLP/flair/issues/2325", "id": 934973537, "node_id": "MDU6SXNzdWU5MzQ5NzM1Mzc=", "number": 2325, "title": "Error While loading \"flair/ner-english-large\" model", "user": {"login": "desairahul49", "id": 39995416, "node_id": "MDQ6VXNlcjM5OTk1NDE2", "avatar_url": "https://avatars.githubusercontent.com/u/39995416?v=4", "gravatar_id": "", "url": "https://api.github.com/users/desairahul49", "html_url": "https://github.com/desairahul49", "followers_url": "https://api.github.com/users/desairahul49/followers", "following_url": "https://api.github.com/users/desairahul49/following{/other_user}", "gists_url": "https://api.github.com/users/desairahul49/gists{/gist_id}", "starred_url": "https://api.github.com/users/desairahul49/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/desairahul49/subscriptions", "organizations_url": "https://api.github.com/users/desairahul49/orgs", "repos_url": "https://api.github.com/users/desairahul49/repos", "events_url": "https://api.github.com/users/desairahul49/events{/privacy}", "received_events_url": "https://api.github.com/users/desairahul49/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-07-01T15:36:06Z", "updated_at": "2021-07-02T11:28:25Z", "closed_at": "2021-07-02T11:28:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi All,\r\nI'm getting below error while loading \"flair/ner-english-large\" model.\r\npytorch version : 1.7.1\r\nflair version: 0.7\r\nI have tried with multiple versions of pytorch (1.8.0 & 1.9.0) as well but still same issue. \r\n\r\n![image](https://user-images.githubusercontent.com/39995416/124150359-1fa57080-daaf-11eb-8e8c-31e00eeac1a2.png)\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2325/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2325/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2320", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2320/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2320/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2320/events", "html_url": "https://github.com/flairNLP/flair/issues/2320", "id": 930816870, "node_id": "MDU6SXNzdWU5MzA4MTY4NzA=", "number": 2320, "title": "corpus fail shuffle", "user": {"login": "humblemat810", "id": 67593116, "node_id": "MDQ6VXNlcjY3NTkzMTE2", "avatar_url": "https://avatars.githubusercontent.com/u/67593116?v=4", "gravatar_id": "", "url": "https://api.github.com/users/humblemat810", "html_url": "https://github.com/humblemat810", "followers_url": "https://api.github.com/users/humblemat810/followers", "following_url": "https://api.github.com/users/humblemat810/following{/other_user}", "gists_url": "https://api.github.com/users/humblemat810/gists{/gist_id}", "starred_url": "https://api.github.com/users/humblemat810/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/humblemat810/subscriptions", "organizations_url": "https://api.github.com/users/humblemat810/orgs", "repos_url": "https://api.github.com/users/humblemat810/repos", "events_url": "https://api.github.com/users/humblemat810/events{/privacy}", "received_events_url": "https://api.github.com/users/humblemat810/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-06-27T00:05:56Z", "updated_at": "2021-11-01T22:46:56Z", "closed_at": "2021-11-01T22:46:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\ncan be solved by using \r\ntrain_part_indices = list(range(len(self.corpus.train)))\r\nor directly\r\nself.corpus.train.indices\r\ninstead of \r\ntrain_part_indices = list(range(self.corpus.train))\r\n![image](https://user-images.githubusercontent.com/67593116/123528901-005cbb00-d71e-11eb-89f5-2d68068b7b00.png)\r\n\r\n**To Reproduce**\r\nshuffle data using \r\ncorpus = Corpus(train=train, test=test)\r\n\r\ntars.add_and_switch_to_new_task('myTask', label_dictionary=corpus.make_label_dictionary())\r\n\r\ntrainer = ModelTrainer(tars, corpus)\r\n\r\n\r\ntrainer.train(base_path='resources/taggers/temp4', # path to store the model artifacts\r\n              learning_rate=0.02, # use very small learning rate\r\n              mini_batch_size=1, # small mini-batch size since corpus is tiny\r\n              max_epochs=10, # terminate after 10 epochs\r\n              train_with_dev=True,\r\n              eval_on_train_fraction = 0.1,\r\n              eval_on_train_shuffle=True\r\n              )\r\n\r\n**Expected behavior**\r\nA clear and concise description of what you expected to happen.\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]:\r\n - Version [e.g. flair-0.3.2]:\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2320/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2320/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2315", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2315/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2315/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2315/events", "html_url": "https://github.com/flairNLP/flair/issues/2315", "id": 929092759, "node_id": "MDU6SXNzdWU5MjkwOTI3NTk=", "number": 2315, "title": "RuntimeError: CUDA error: device-side assert triggered", "user": {"login": "yananchen1989", "id": 26405281, "node_id": "MDQ6VXNlcjI2NDA1Mjgx", "avatar_url": "https://avatars.githubusercontent.com/u/26405281?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yananchen1989", "html_url": "https://github.com/yananchen1989", "followers_url": "https://api.github.com/users/yananchen1989/followers", "following_url": "https://api.github.com/users/yananchen1989/following{/other_user}", "gists_url": "https://api.github.com/users/yananchen1989/gists{/gist_id}", "starred_url": "https://api.github.com/users/yananchen1989/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yananchen1989/subscriptions", "organizations_url": "https://api.github.com/users/yananchen1989/orgs", "repos_url": "https://api.github.com/users/yananchen1989/repos", "events_url": "https://api.github.com/users/yananchen1989/events{/privacy}", "received_events_url": "https://api.github.com/users/yananchen1989/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-06-24T10:40:55Z", "updated_at": "2021-10-30T05:36:02Z", "closed_at": "2021-10-30T05:36:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "flair version: 0.8.0.post1\r\ntorch: 1.7.1\r\n\r\nwhen I try to load the ner model as below,\r\n`tagger = SequenceTagger.load(\"ner-large\")`\r\n\r\nThere comes the error:\r\n\r\n> ----> 1 tagger = SequenceTagger.load(\"ner-large\")\r\n> \r\n> /usr/local/lib/python3.6/dist-packages/flair/nn.py in load(cls, model)\r\n>      86             # see https://github.com/zalandoresearch/flair/issues/351\r\n>      87             f = file_utils.load_big_file(str(model_file))\r\n> ---> 88             state = torch.load(f, map_location='cpu')\r\n>      89\r\n>      90         model = cls._init_model_with_state_dict(state)\r\n> \r\n> /usr/local/lib/python3.6/dist-packages/torch/serialization.py in load(f, map_location, pickle_module, **pickle_load_args)\r\n>     592                     opened_file.seek(orig_position)\r\n>     593                     return torch.jit.load(opened_file)\r\n> --> 594                 return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)\r\n>     595         return _legacy_load(opened_file, map_location, pickle_module, **pickle_load_args)\r\n>     596\r\n> \r\n> /usr/local/lib/python3.6/dist-packages/torch/serialization.py in _load(zip_file, map_location, pickle_module, pickle_file, **pickle_load_args)\r\n>     851     unpickler = pickle_module.Unpickler(data_file, **pickle_load_args)\r\n>     852     unpickler.persistent_load = persistent_load\r\n> --> 853     result = unpickler.load()\r\n>     854\r\n>     855     torch._utils._validate_loaded_sparse_tensors()\r\n> \r\n> /usr/local/lib/python3.6/dist-packages/flair/embeddings/token.py in __setstate__(self, d)\r\n>    1295\r\n>    1296                 config=loaded_config,\r\n> -> 1297                 state_dict=d[\"model_state_dict\"],\r\n>    1298             )\r\n>    1299\r\n> \r\n> /usr/local/lib/python3.6/dist-packages/flair/embeddings/token.py in __init__(self, model, layers, subtoken_pooling, layer_mean, fine_tune, allow_long_sentences, use_context, memory_effective_training, respect_document_boundaries, context_dropout, **kwargs)\r\n>     854         # when initializing, embeddings are in eval mode by default\r\n>     855         self.model.eval()\r\n> --> 856         self.model.to(flair.device)\r\n>     857\r\n>     858         # embedding parameters\r\n> \r\n> /usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py in to(self, *args, **kwargs)\r\n>     610             return t.to(device, dtype if t.is_floating_point() else None, non_blocking)\r\n>     611\r\n> --> 612         return self._apply(convert)\r\n>     613\r\n>     614     def register_backward_hook(\r\n> \r\n> /usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py in _apply(self, fn)\r\n>     357     def _apply(self, fn):\r\n>     358         for module in self.children():\r\n> --> 359             module._apply(fn)\r\n>     360\r\n>     361         def compute_should_use_set_data(tensor, tensor_applied):\r\n> \r\n> /usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py in _apply(self, fn)\r\n>     357     def _apply(self, fn):\r\n>     358         for module in self.children():\r\n> --> 359             module._apply(fn)\r\n>     360\r\n>     361         def compute_should_use_set_data(tensor, tensor_applied):\r\n> \r\n> /usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py in _apply(self, fn)\r\n>     379                 # `with torch.no_grad():`\r\n>     380                 with torch.no_grad():\r\n> --> 381                     param_applied = fn(param)\r\n>     382                 should_use_set_data = compute_should_use_set_data(param, param_applied)\r\n>     383                 if should_use_set_data:\r\n> \r\n> /usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py in convert(t)\r\n>     608             if convert_to_format is not None and t.dim() == 4:\r\n>     609                 return t.to(device, dtype if t.is_floating_point() else None, non_blocking, memory_format=convert_to_format)\r\n> --> 610             return t.to(device, dtype if t.is_floating_point() else None, non_blocking)\r\n>     611\r\n>     612         return self._apply(convert)\r\n> \r\n> RuntimeError: CUDA error: device-side assert triggered", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2315/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2315/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2314", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2314/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2314/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2314/events", "html_url": "https://github.com/flairNLP/flair/issues/2314", "id": 929072355, "node_id": "MDU6SXNzdWU5MjkwNzIzNTU=", "number": 2314, "title": "AttributeError: 'str' object has no attribute 'is_context_set'", "user": {"login": "yananchen1989", "id": 26405281, "node_id": "MDQ6VXNlcjI2NDA1Mjgx", "avatar_url": "https://avatars.githubusercontent.com/u/26405281?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yananchen1989", "html_url": "https://github.com/yananchen1989", "followers_url": "https://api.github.com/users/yananchen1989/followers", "following_url": "https://api.github.com/users/yananchen1989/following{/other_user}", "gists_url": "https://api.github.com/users/yananchen1989/gists{/gist_id}", "starred_url": "https://api.github.com/users/yananchen1989/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yananchen1989/subscriptions", "organizations_url": "https://api.github.com/users/yananchen1989/orgs", "repos_url": "https://api.github.com/users/yananchen1989/repos", "events_url": "https://api.github.com/users/yananchen1989/events{/privacy}", "received_events_url": "https://api.github.com/users/yananchen1989/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-06-24T10:15:06Z", "updated_at": "2021-06-24T10:21:33Z", "closed_at": "2021-06-24T10:21:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "```\r\ncontent = \"The video will start in 8 Cancel\\nClick to play Tap to play\\nGet daily updates directly to your inbox + Subscribe Thank you for subscribing! Could not subscribe, try again later Invalid Email\\nSeveral schools will remain closed on Tuesday as a weather warning for ice continues into the morning.\\nMore than 200 schools in North Wales were closed today after snow and ice caused chaos over the weekend.\\nThe vast majority are expected to re-open but some closures are still expected.\\nThis story will be updated as more information becomes available.\\nTemperatures are not expected to be above 0C until midday.\\n(Image: Robert Parry-Jones)\\nAs of 7.55pm, the schools which will be closed on Tuesday in Wrexham are:\\nSt Christopher's School, Wrexham, Ysgol y Waun, Chirk, Froncysyllte CP and Garth CP. All the others are expected to re-open although this information is subject to change.\\nIn Denbighshire, Denbigh High School will be open tomorrow but Ysgol Plas Brondyffryn, Ysgol Carreg Emlyn and Ysgol Dinas Bran will be shut.\\nYsgol Tir Morfa will be open but transport from Denbigh and further south will not operate.\\nFor full details on school transport in Denbighshire click here.\\nFlintshire Council currently say there are no planned closures tomorrow although that could change.\\nColeg Cambria will be shut entirely on Tuesday.\\nGlyndwr University will be open and lectures are expected to take place.\"\r\n\r\nfrom flair.data import Sentence # ver: 0.8\r\nfrom flair.models import SequenceTagger\r\ntagger = SequenceTagger.load(\"ner-large\")\r\ntagger.predict(content)\r\n```\r\n\r\n\r\n\r\nerror:\r\n\r\n> /usr/local/lib/python3.6/dist-packages/flair/models/sequence_tagger_model.py in predict(self, sentences, mini_batch_size, all_tag_prob, verbose, label_name, return_loss, embedding_storage_mode)\r\n>     335             previous_sentence = None\r\n>     336             for sentence in sentences:\r\n> --> 337                 if sentence.is_context_set(): continue\r\n>     338                 sentence._previous_sentence = previous_sentence\r\n>     339                 sentence._next_sentence = None\r\n> \r\n> AttributeError: 'str' object has no attribute 'is_context_set'", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2314/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2314/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2311", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2311/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2311/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2311/events", "html_url": "https://github.com/flairNLP/flair/issues/2311", "id": 925623720, "node_id": "MDU6SXNzdWU5MjU2MjM3MjA=", "number": 2311, "title": "SegtokSentenceSplitter Incorrect Sentence Position Attributes", "user": {"login": "dobbersc", "id": 29147025, "node_id": "MDQ6VXNlcjI5MTQ3MDI1", "avatar_url": "https://avatars.githubusercontent.com/u/29147025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dobbersc", "html_url": "https://github.com/dobbersc", "followers_url": "https://api.github.com/users/dobbersc/followers", "following_url": "https://api.github.com/users/dobbersc/following{/other_user}", "gists_url": "https://api.github.com/users/dobbersc/gists{/gist_id}", "starred_url": "https://api.github.com/users/dobbersc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dobbersc/subscriptions", "organizations_url": "https://api.github.com/users/dobbersc/orgs", "repos_url": "https://api.github.com/users/dobbersc/repos", "events_url": "https://api.github.com/users/dobbersc/events{/privacy}", "received_events_url": "https://api.github.com/users/dobbersc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-06-20T15:29:12Z", "updated_at": "2021-06-29T11:08:13Z", "closed_at": "2021-06-29T11:08:13Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nFlair's implementation of the segtok splitter poorly handles input texts with whitespaces before and between the sentences and produces incorrect `start_pos` and `end_pos` attributes of the split sentences.\r\n\r\n**To Reproduce**\r\nThe following script runs some test cases, reproduces the bug and illustrates the bug's occurrences. For a more in-depth explanation, please see the \"Additional context\" section.\r\n\r\nHuge thanks to @weyaaron for helping me debug this issue.\r\n\r\n```python\r\nfrom typing import List\r\n\r\nfrom flair.data import Sentence\r\nfrom flair.tokenization import SegtokSentenceSplitter\r\n\r\n\r\ndef test_sentence_splitter(text: str, test_case_header: str) -> None:\r\n    print(f'{test_case_header:-^30}')\r\n    print(f'{text=}')\r\n\r\n    sentences: List[Sentence] = SegtokSentenceSplitter().split(text)\r\n\r\n    last_start_pos: int = -1\r\n    for i, sentence in enumerate(sentences, start=1):\r\n        print('----')\r\n        print(f'{sentence=}')\r\n        print(f'\\tStart of sentence {i}: {sentence.start_pos}')\r\n        print(f'\\tEnd of sentence {i}: {sentence.end_pos}')\r\n        if last_start_pos == sentence.start_pos:\r\n            print(f'\\t{last_start_pos=} equals {sentence.start_pos=}. They should be unique!')\r\n        last_start_pos = sentence.start_pos\r\n\r\n    print()\r\n\r\n\r\nif __name__ == '__main__':\r\n\r\n    # Test-Case 1: No Error\r\n    input_text: str = 'Frau Schmidt hatte den Namen immer gemocht und nie Gelegenheit gehabt, ihn auszusprechen. Ozelot. Ozelot. Ozelot.'\r\n    test_sentence_splitter(input_text, test_case_header='Test-Case 1: No Error')\r\n\r\n    # Test-Case 2: Error\r\n    input_text: str = \"      Frau Schmidt hatte den Namen immer gemocht und nie Gelegenheit gehabt, ihn auszusprechen. Ozelot. Ozelot. Ozelot.\"\r\n    test_sentence_splitter(input_text, test_case_header='Test-Case 2: Error')\r\n\r\n    # Test-Case 3: Error\r\n    input_text: str = \"Frau Schmidt hatte den Namen immer gemocht und nie Gelegenheit gehabt, ihn auszusprechen.      Ozelot. Ozelot. Ozelot.\"\r\n    test_sentence_splitter(input_text, test_case_header='Test-Case 3: Error')\r\n\r\n    # Test-Case 4: Error\r\n    input_text: str = \"   Frau Schmidt hatte den Namen immer gemocht und nie Gelegenheit gehabt, ihn auszusprechen.   Ozelot. Ozelot. Ozelot.\"\r\n    test_sentence_splitter(input_text, test_case_header='Test-Case 4: Error')\r\n\r\n    # Test-Case 5: No Error\r\n    input_text: str = \"      Frau Schmidt hatte den Namen immer gemocht und nie Gelegenheit gehabt, ihn auszusprechen. Ozelott. Ozelott. Ozelott.\"\r\n    test_sentence_splitter(input_text, test_case_header='Test-Case 5: No Error')\r\n\r\n    # Test-Case 6: No Error\r\n    input_text: str = \"Frau Schmidt hatte den Namen immer gemocht und nie Gelegenheit gehabt, ihn auszusprechen. Ozelot. Ja, Ozelot. Oh, Ozelot.\"\r\n    test_sentence_splitter(input_text, test_case_header='Test-Case 6: No Error')\r\n\r\n```\r\n\r\nOutput: [output.txt](https://github.com/flairNLP/flair/files/6682579/output.txt)\r\n\r\n**Expected behavior**\r\nAs an example, consider test case two. Here, the second and third sentence have the same sentence positions. The expected behaviour is that the third sentence has greater sentence positions than the second.\r\n\r\n**Environment:**\r\n - OS: Windows 10\r\n - Version: flair-0.8\r\n\r\n**Additional context**\r\nThe function of interest is the `split` function from the `SegtokSentenceSplitter` [here](https://github.com/flairNLP/flair/blob/092499760fa7a95267cebb566105ea375ed18d16/flair/tokenization.py#L419).\r\n\r\nFor reference, the first test case with no redundant whitespaces is split with the correct sentence positions.\r\n\r\nNow, consider the second test case. Keep in mind that we inserted six whitespaces in front of the first sentence. Therefore, the value of the first sentence's `sentence_offset`, returned by the `find` function, will be six. No problems so far. The culprit lies in [line 439](https://github.com/flairNLP/flair/blob/092499760fa7a95267cebb566105ea375ed18d16/flair/tokenization.py#L439), where the `offset` is incremented by the length of the current sentence. It is not sufficient to increment the offset by `len(sentence)`! Because of the prefixed whitespaces of the first sentence, `offset=89` holds after the first sentence has been processed. This is seven chars too early: \r\n\r\n```python\r\n>>> text[89:]\r\n'echen. Ozelot. Ozelot. Ozelot.'\r\n```\r\n\r\nNevertheless, for the second sentence, the call of `sentence_offset = text.find(sentence, offset)` results in the correct value of 96, since no previous occurrence of `Ozelot.` exists. But remember, the offset calculated from the previous iteration is still 89. Since at the end of the second iteration the offset is incremented by the length of the sentence `Ozelot.`, i.e. seven, we enter the next iteration with `offset=96` again. This is exactly the start of the first `Ozelot.` sentence. Note that the string `Ozelot.` is exactly seven characters in length. Moreover, `echen.\u23b5` is of length seven as well. \r\n\r\n```python\r\n>>> text[96:]\r\n'Ozelot. Ozelot. Ozelot.'\r\n```\r\n\r\nWith the continual shifting offset, the shift accumulates to a value such that the second occurrence of `Ozelot.` is registered as the first occurrence in terms of its position. Thus, the second `Ozelot.` has the same sentence position attribute as the first one. This behaviour is incorrect.\r\n\r\nSimilarly, this is the case if the whitespaces are more spread out, such as in test case three and four.\r\n\r\nTest case six has the same input text as test case two, besides an extra `t` for each `Ozelot.`. Since the sentences with duplicates are now one character longer, the shifted offset of the `split` function is not sufficient to bring the bug to light.\r\n\r\nIn test case six the bug does not occur, since the text is free of duplicates, such as `Ozelot.`.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2311/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2311/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2310", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2310/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2310/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2310/events", "html_url": "https://github.com/flairNLP/flair/issues/2310", "id": 925571390, "node_id": "MDU6SXNzdWU5MjU1NzEzOTA=", "number": 2310, "title": "can't load transformer models", "user": {"login": "alilotfy", "id": 50414343, "node_id": "MDQ6VXNlcjUwNDE0MzQz", "avatar_url": "https://avatars.githubusercontent.com/u/50414343?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alilotfy", "html_url": "https://github.com/alilotfy", "followers_url": "https://api.github.com/users/alilotfy/followers", "following_url": "https://api.github.com/users/alilotfy/following{/other_user}", "gists_url": "https://api.github.com/users/alilotfy/gists{/gist_id}", "starred_url": "https://api.github.com/users/alilotfy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alilotfy/subscriptions", "organizations_url": "https://api.github.com/users/alilotfy/orgs", "repos_url": "https://api.github.com/users/alilotfy/repos", "events_url": "https://api.github.com/users/alilotfy/events{/privacy}", "received_events_url": "https://api.github.com/users/alilotfy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-06-20T10:49:31Z", "updated_at": "2021-06-25T16:06:47Z", "closed_at": "2021-06-25T16:06:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nmodel in this link can't be loaded \r\nhttps://huggingface.co/aubmindlab/bert-base-arabert\r\n\r\n**To Reproduce**\r\nput  >>>aubmindlab/bert-large-arabertv01>>> , for example, in the stacked embedding array\r\n\r\n\r\n**Expected behavior**\r\nIt is worth mentioning that I used theses models before and they worked fine. For now, only aubmindlab/bert-base-arabertv01\r\nworks and the rest gives the following error:\r\n\r\n Can't load config for 'bert-large-arabertv02'. Make sure that:\r\n\r\n- 'bert-large-arabertv02' is a correct model identifier listed on 'https://huggingface.co/models'\r\n\r\n- or 'bert-large-arabertv02' is the correct path to a directory containing a config.json file\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2310/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2310/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2305", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2305/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2305/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2305/events", "html_url": "https://github.com/flairNLP/flair/issues/2305", "id": 919751058, "node_id": "MDU6SXNzdWU5MTk3NTEwNTg=", "number": 2305, "title": "TransformerWordEmbeddings - OverflowError: int too big to convert", "user": {"login": "mahak13", "id": 37860453, "node_id": "MDQ6VXNlcjM3ODYwNDUz", "avatar_url": "https://avatars.githubusercontent.com/u/37860453?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mahak13", "html_url": "https://github.com/mahak13", "followers_url": "https://api.github.com/users/mahak13/followers", "following_url": "https://api.github.com/users/mahak13/following{/other_user}", "gists_url": "https://api.github.com/users/mahak13/gists{/gist_id}", "starred_url": "https://api.github.com/users/mahak13/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mahak13/subscriptions", "organizations_url": "https://api.github.com/users/mahak13/orgs", "repos_url": "https://api.github.com/users/mahak13/repos", "events_url": "https://api.github.com/users/mahak13/events{/privacy}", "received_events_url": "https://api.github.com/users/mahak13/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-06-13T08:53:36Z", "updated_at": "2021-11-02T12:02:48Z", "closed_at": "2021-11-02T12:02:48Z", "author_association": "NONE", "active_lock_reason": null, "body": "**The Issue**\r\nWhen I try to embed any sentence using the BERT model \"allenai/scibert_scivocab_uncased\", I get this error where it shows Overflow Error: int too big to convert. I did some googling and ended up here #2181 . See below for steps to reproduce\r\n\r\n**To Reproduce**\r\n```\r\nfrom flair.data import Sentence\r\nfrom flair.embeddings import TransformerWordEmbeddings\r\n\r\nembedding = TransformerWordEmbeddings(\"allenai/scibert_scivocab_uncased\")\r\ns = Sentence('This is a sentence')\r\n\r\nembedding.embed(s)\r\n```\r\n\r\nThe error:\r\n`OverflowError: int too big to convert`\r\n\r\n**Question**\r\nI understand where the problem lies. When I use the normal huggingface library to check model_max_length, I get this.\r\n```\r\n>>> from transformers import AutoTokenizer\r\n>>> tokenizer = AutoTokenizer.from_pretrained(\"allenai/scibert_scivocab_uncased\")\r\n>>> tokenizer.model_max_length\r\n1000000000000000019884624838656\r\n\r\n>>> tokenizer = AutoTokenizer.from_pretrained(\"bert-base-uncased\")\r\n>>> tokenizer.model_max_length\r\n512\r\n```\r\n\r\nHere the model_max_length is not set in the pretained model that I am using but if we use huggingface we can manually set it using \r\n``` tokenizer.model_max_length = 512 ``` \r\nbut I was not able to find any way to manually set this attribute using flair's TransformerWordEmbeddings class. Is there any workaround to this? Any method to manually set the model_max_length in flair?\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Windows\r\n - Version:  0.8.0.post1\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2305/reactions", "total_count": 4, "+1": 4, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2305/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2302", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2302/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2302/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2302/events", "html_url": "https://github.com/flairNLP/flair/issues/2302", "id": 916790290, "node_id": "MDU6SXNzdWU5MTY3OTAyOTA=", "number": 2302, "title": "install error-requirement numpy", "user": {"login": "humblemat810", "id": 67593116, "node_id": "MDQ6VXNlcjY3NTkzMTE2", "avatar_url": "https://avatars.githubusercontent.com/u/67593116?v=4", "gravatar_id": "", "url": "https://api.github.com/users/humblemat810", "html_url": "https://github.com/humblemat810", "followers_url": "https://api.github.com/users/humblemat810/followers", "following_url": "https://api.github.com/users/humblemat810/following{/other_user}", "gists_url": "https://api.github.com/users/humblemat810/gists{/gist_id}", "starred_url": "https://api.github.com/users/humblemat810/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/humblemat810/subscriptions", "organizations_url": "https://api.github.com/users/humblemat810/orgs", "repos_url": "https://api.github.com/users/humblemat810/repos", "events_url": "https://api.github.com/users/humblemat810/events{/privacy}", "received_events_url": "https://api.github.com/users/humblemat810/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-06-10T01:07:45Z", "updated_at": "2021-10-17T12:03:11Z", "closed_at": "2021-10-17T12:03:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "I find that there is a site package check, if my /env/sitepackages contains numpy1.16 1.18 and 1.19\r\nit sees it as error. however, if I import numpy as np, print(np.__version__) it is 1.19\r\nI can only manually bypass the buggy check by removing 1.16 in my folder", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2302/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2302/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2294", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2294/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2294/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2294/events", "html_url": "https://github.com/flairNLP/flair/issues/2294", "id": 911657100, "node_id": "MDU6SXNzdWU5MTE2NTcxMDA=", "number": 2294, "title": "PermissionError: [Errno 13] Permission denied: '/root/.cache'", "user": {"login": "Jason-Naix", "id": 78373148, "node_id": "MDQ6VXNlcjc4MzczMTQ4", "avatar_url": "https://avatars.githubusercontent.com/u/78373148?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Jason-Naix", "html_url": "https://github.com/Jason-Naix", "followers_url": "https://api.github.com/users/Jason-Naix/followers", "following_url": "https://api.github.com/users/Jason-Naix/following{/other_user}", "gists_url": "https://api.github.com/users/Jason-Naix/gists{/gist_id}", "starred_url": "https://api.github.com/users/Jason-Naix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Jason-Naix/subscriptions", "organizations_url": "https://api.github.com/users/Jason-Naix/orgs", "repos_url": "https://api.github.com/users/Jason-Naix/repos", "events_url": "https://api.github.com/users/Jason-Naix/events{/privacy}", "received_events_url": "https://api.github.com/users/Jason-Naix/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-06-04T16:12:52Z", "updated_at": "2021-06-07T11:54:10Z", "closed_at": "2021-06-07T11:54:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am calling the python script with the `flair` package with a `www-data`user (no `sudo` rights). The models are in path for which that user has access rights, which I have set `flair.cache_root = Path(\"tools/flair\")`\r\n\r\nHowever, when I run the script with that user I get a Permission Error:\r\n\r\n```\r\ntagger = MultiTagger.load([\\\\\\\"flair/ner-german-large\\\\\\\", \\\\\\\"de-pos\\\\\\\"])\\\r\nFile \\\\\\\"/usr/local/lib/python3.7/dist-packages/flair/models/sequence_tagger_model.py\\\\\\\", line 1330, in load\\\r\nmodel = SequenceTagger.load(model_name)\\\r\nFile \\\\\\\"/usr/local/lib/python3.7/dist-packages/flair/nn.py\\\\\\\", line 88, in load\\\r\nstate = torch.load(f, map_location='cpu')\\\r\nFile \\\\\\\"/usr/local/lib/python3.7/dist-packages/torch/serialization.py\\\\\\\", line 594, in load\\\r\nreturn _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)\\\r\nFile \\\\\\\"/usr/local/lib/python3.7/dist-packages/torch/serialization.py\\\\\\\", line 853, in _load\\\r\nresult = unpickler.load()\\\r\nFile \\\\\\\"/usr/local/lib/python3.7/dist-packages/flair/embeddings/token.py\\\\\\\", line 1297, in __setstate__\\\r\nstate_dict=d[\\\\\\\"model_state_dict\\\\\\\"],\\\r\nFile \\\\\\\"/usr/local/lib/python3.7/dist-packages/flair/embeddings/token.py\\\\\\\", line 818, in __init__\\\r\nself.tokenizer: PreTrainedTokenizer = AutoTokenizer.from_pretrained(model, **kwargs)\\\r\nFile \\\\\\\"/usr/local/lib/python3.7/dist-packages/transformers/models/auto/tokenization_auto.py\\\\\\\", line 435, in from_pretrained\\\r\nreturn tokenizer_class_fast.from_pretrained(pretrained_model_name_or_path, *inputs, **kwargs)\\\r\nFile \\\\\\\"/usr/local/lib/python3.7/dist-packages/transformers/tokenization_utils_base.py\\\\\\\", line 1680, in from_pretrained\\\r\nuser_agent=user_agent,\\\r\nFile \\\\\\\"/usr/local/lib/python3.7/dist-packages/transformers/file_utils.py\\\\\\\", line 1279, in cached_path\\\r\nlocal_files_only=local_files_only,\\\r\nFile \\\\\\\"/usr/local/lib/python3.7/dist-packages/transformers/file_utils.py\\\\\\\", line 1426, in get_from_cache\\\r\nos.makedirs(cache_dir, exist_ok=True)\\\r\nFile \\\\\\\"/usr/lib/python3.7/os.py\\\\\\\", line 211, in makedirs\\\r\nmakedirs(head, exist_ok=exist_ok)\\\r\nFile \\\\\\\"/usr/lib/python3.7/os.py\\\\\\\", line 211, in makedirs\\\r\nmakedirs(head, exist_ok=exist_ok)\\\r\nFile \\\\\\\"/usr/lib/python3.7/os.py\\\\\\\", line 221, in makedirs\\\r\nmkdir(name, mode)\\\r\nPermissionError: [Errno 13] Permission denied: '/root/.cache'\\\r\n```\r\n\r\nCan I avoid using `/root/.cache`? I don't want to edit the read-write rights of that directory. If I run the script as `root` it works fine. How do I run it as the other user? I am running it on Ubuntu.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2294/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2294/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2293", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2293/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2293/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2293/events", "html_url": "https://github.com/flairNLP/flair/issues/2293", "id": 911430141, "node_id": "MDU6SXNzdWU5MTE0MzAxNDE=", "number": 2293, "title": "Docker flair", "user": {"login": "codechannel", "id": 67317792, "node_id": "MDQ6VXNlcjY3MzE3Nzky", "avatar_url": "https://avatars.githubusercontent.com/u/67317792?v=4", "gravatar_id": "", "url": "https://api.github.com/users/codechannel", "html_url": "https://github.com/codechannel", "followers_url": "https://api.github.com/users/codechannel/followers", "following_url": "https://api.github.com/users/codechannel/following{/other_user}", "gists_url": "https://api.github.com/users/codechannel/gists{/gist_id}", "starred_url": "https://api.github.com/users/codechannel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/codechannel/subscriptions", "organizations_url": "https://api.github.com/users/codechannel/orgs", "repos_url": "https://api.github.com/users/codechannel/repos", "events_url": "https://api.github.com/users/codechannel/events{/privacy}", "received_events_url": "https://api.github.com/users/codechannel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-06-04T12:01:57Z", "updated_at": "2021-10-29T17:29:09Z", "closed_at": "2021-10-29T17:29:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nflair docker build torch dependencies not found. \r\n\r\nto install locally in a conda env. everything works fine if I follow the steps at\r\nhttps://github.com/flairNLP/flair/issues/2137#issuecomment-793127609\r\n\r\nbut throws `torch error` when used in a Docker file.\r\n\r\nSuggestions to solve are welcomed and appreciated.\r\n\r\n**To Reproduce**\r\nDocker file consists of:\r\n\r\n```\r\n...<some-other code>\r\n\r\n# create virtualenv\r\nRUN python -m venv /opt/venv\r\n\r\n# Make sure we use the virtualenv\r\nENV PATH=\"/opt/venv/bin:$PATH\"\r\n\r\n# install dependencies\r\nRUN python -m pip install --upgrade pip\r\n\r\nRUN apk add --update --no-cache --virtual .tmp gcc libc-dev linux-headers\r\nRUN apk add --no-cache jpeg-dev zlib-dev\r\nRUN apk del .tmp\r\n\r\nRUN python -m pip install -r requirements.txt\r\nRUN pip install flair==0.8\r\nRUN pip uninstall torch\r\nRUN pip install torch==1.7.1\r\n\r\nRUN python -m pip install --upgrade pillow\r\n\r\nCOPY . . \r\n\r\n# install setup.py\r\nRUN python -m pip install -e .\r\n\r\nFROM python:3.7-alpine AS production\r\n\r\nRUN apk add --no-cache --virtual --update openblas g++ llvm\r\n\r\nCOPY --from=build /opt/venv /opt/venv\r\n\r\nCOPY . . \r\n\r\n# Make sure we use the virtualenv:\r\nENV PATH=\"/opt/venv/bin:$PATH\"\r\n\r\n...\r\n```\r\n\r\n\r\n**Error**\r\n```\r\nERROR: Could not find a version that satisfies the requirement torch>=1.5.0 (from flair) (from versions: 0.1.2, 0.1.2.post1, 0.1.2.post2)\r\nERROR: No matching distribution found for torch>=1.5.0\r\n```\r\n\r\n**Environment**\r\n- \r\n - Ubuntu 18.04\r\n - Version [e.g. flair-0.8]:\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2293/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2293/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2284", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2284/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2284/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2284/events", "html_url": "https://github.com/flairNLP/flair/issues/2284", "id": 902072949, "node_id": "MDU6SXNzdWU5MDIwNzI5NDk=", "number": 2284, "title": "The code in \"Training a Text Classification Model with Transformer\" seems incorrect", "user": {"login": "sankaran45", "id": 8388863, "node_id": "MDQ6VXNlcjgzODg4NjM=", "avatar_url": "https://avatars.githubusercontent.com/u/8388863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sankaran45", "html_url": "https://github.com/sankaran45", "followers_url": "https://api.github.com/users/sankaran45/followers", "following_url": "https://api.github.com/users/sankaran45/following{/other_user}", "gists_url": "https://api.github.com/users/sankaran45/gists{/gist_id}", "starred_url": "https://api.github.com/users/sankaran45/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sankaran45/subscriptions", "organizations_url": "https://api.github.com/users/sankaran45/orgs", "repos_url": "https://api.github.com/users/sankaran45/repos", "events_url": "https://api.github.com/users/sankaran45/events{/privacy}", "received_events_url": "https://api.github.com/users/sankaran45/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-05-26T09:15:36Z", "updated_at": "2021-05-27T02:26:31Z", "closed_at": "2021-05-27T02:26:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "https://github.com/flairNLP/flair/blob/master/resources/docs/TUTORIAL_7_TRAINING_A_MODEL.md\r\n\r\nMy student tried this code and compared it against a vanilla Flair + DocumentLSTMEmbedding model. The Transformer code surprisingly gave poor results. We find that the learning rate hardly changes from 3E-5 probably because of the default anneal on plateau scheduler. Normally, we will expect learning rate to get annealed at the end of each batch so that by the end of 3 epochs it has reduced significantly to a small value (which i think is how HuggingFace transformer library examples work).\r\n\r\nHow can I get a similar behavior ? I can use a different StepLR scheduler - but these schedulers require the .step() function to be invoked at the end of each batch.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2284/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2284/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2279", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2279/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2279/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2279/events", "html_url": "https://github.com/flairNLP/flair/issues/2279", "id": 895429296, "node_id": "MDU6SXNzdWU4OTU0MjkyOTY=", "number": 2279, "title": "can't load ner-multi : 'LanguageModel' object has no attribute '_load_state_dict_pre_hooks'", "user": {"login": "alexisbenichoux", "id": 54935845, "node_id": "MDQ6VXNlcjU0OTM1ODQ1", "avatar_url": "https://avatars.githubusercontent.com/u/54935845?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexisbenichoux", "html_url": "https://github.com/alexisbenichoux", "followers_url": "https://api.github.com/users/alexisbenichoux/followers", "following_url": "https://api.github.com/users/alexisbenichoux/following{/other_user}", "gists_url": "https://api.github.com/users/alexisbenichoux/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexisbenichoux/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexisbenichoux/subscriptions", "organizations_url": "https://api.github.com/users/alexisbenichoux/orgs", "repos_url": "https://api.github.com/users/alexisbenichoux/repos", "events_url": "https://api.github.com/users/alexisbenichoux/events{/privacy}", "received_events_url": "https://api.github.com/users/alexisbenichoux/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-05-19T13:11:35Z", "updated_at": "2021-06-29T13:34:16Z", "closed_at": "2021-06-29T13:34:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nMulti lingual models (both ner or pos) fails to load after download inside torch nn.\r\nI don't have any problems with other ner packages\r\n\r\n**To Reproduce**\r\n\r\n> from flair.data import Sentence\r\n> from flair.models import SequenceTagger\r\n> tagger = SequenceTagger.load(\"flair/ner-multi-fast\")\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/home/flair/flair/nn.py\", line 93, in load\r\n    model = cls._init_model_with_state_dict(state)\r\n  File \"/home/flair/flair/models/sequence_tagger_model.py\", line 297, in _init_model_with_state_dict\r\n    model.load_state_dict(state[\"state_dict\"])\r\n  File \"/root/anaconda3/envs/flair/lib/python3.9/site-packages/torch/nn/modules/module.py\", line 1037, in load_state_dict\r\n    load(self)\r\n  File \"/root/anaconda3/envs/flair/lib/python3.9/site-packages/torch/nn/modules/module.py\", line 1035, in load\r\n    load(child, prefix + name + '.')\r\n  File \"/root/anaconda3/envs/flair/lib/python3.9/site-packages/torch/nn/modules/module.py\", line 1035, in load\r\n    load(child, prefix + name + '.')\r\n  File \"/root/anaconda3/envs/flair/lib/python3.9/site-packages/torch/nn/modules/module.py\", line 1035, in load\r\n    load(child, prefix + name + '.')\r\n  File \"/root/anaconda3/envs/flair/lib/python3.9/site-packages/torch/nn/modules/module.py\", line 1031, in load\r\n    module._load_from_state_dict(\r\n  File \"/root/anaconda3/envs/flair/lib/python3.9/site-packages/torch/nn/modules/module.py\", line 957, in _load_from_state_dict\r\n    for hook in self._load_state_dict_pre_hooks.values():\r\n  File \"/root/anaconda3/envs/flair/lib/python3.9/site-packages/torch/nn/modules/module.py\", line 778, in __getattr__\r\n    raise ModuleAttributeError(\"'{}' object has no attribute '{}'\".format(\r\ntorch.nn.modules.module.ModuleAttributeError: 'LanguageModel' object has no attribute '_load_state_dict_pre_hooks'\r\n```\r\n - tried on macos 11.1, python 3.8 and python 3.6 and 3.9.4\r\n - torch 1.7.1 (conda env from requirements)\r\n - Version flair 0.8.2 (I tried both pip install and pip from github repo)\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2279/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2279/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2278", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2278/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2278/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2278/events", "html_url": "https://github.com/flairNLP/flair/issues/2278", "id": 892210604, "node_id": "MDU6SXNzdWU4OTIyMTA2MDQ=", "number": 2278, "title": "illegal hardware instruction", "user": {"login": "jianglong-he-Infrrd", "id": 77416863, "node_id": "MDQ6VXNlcjc3NDE2ODYz", "avatar_url": "https://avatars.githubusercontent.com/u/77416863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jianglong-he-Infrrd", "html_url": "https://github.com/jianglong-he-Infrrd", "followers_url": "https://api.github.com/users/jianglong-he-Infrrd/followers", "following_url": "https://api.github.com/users/jianglong-he-Infrrd/following{/other_user}", "gists_url": "https://api.github.com/users/jianglong-he-Infrrd/gists{/gist_id}", "starred_url": "https://api.github.com/users/jianglong-he-Infrrd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jianglong-he-Infrrd/subscriptions", "organizations_url": "https://api.github.com/users/jianglong-he-Infrrd/orgs", "repos_url": "https://api.github.com/users/jianglong-he-Infrrd/repos", "events_url": "https://api.github.com/users/jianglong-he-Infrrd/events{/privacy}", "received_events_url": "https://api.github.com/users/jianglong-he-Infrrd/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-05-14T20:16:52Z", "updated_at": "2021-12-14T17:32:04Z", "closed_at": "2021-12-14T17:32:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "When I try to run prediction on a trained flair SequenceTagging model it give illegal hardware instruction. I am using a Mac with M1. Does Flair support M1?", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2278/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2278/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2270", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2270/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2270/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2270/events", "html_url": "https://github.com/flairNLP/flair/issues/2270", "id": 890488123, "node_id": "MDU6SXNzdWU4OTA0ODgxMjM=", "number": 2270, "title": "Unable to Load models", "user": {"login": "jaypal17", "id": 26333643, "node_id": "MDQ6VXNlcjI2MzMzNjQz", "avatar_url": "https://avatars.githubusercontent.com/u/26333643?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaypal17", "html_url": "https://github.com/jaypal17", "followers_url": "https://api.github.com/users/jaypal17/followers", "following_url": "https://api.github.com/users/jaypal17/following{/other_user}", "gists_url": "https://api.github.com/users/jaypal17/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaypal17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaypal17/subscriptions", "organizations_url": "https://api.github.com/users/jaypal17/orgs", "repos_url": "https://api.github.com/users/jaypal17/repos", "events_url": "https://api.github.com/users/jaypal17/events{/privacy}", "received_events_url": "https://api.github.com/users/jaypal17/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-05-12T21:05:31Z", "updated_at": "2022-01-25T05:37:31Z", "closed_at": "2022-01-25T05:37:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI am trying to run a simple example just to test out however I cannot load the model. The error I see is:\r\nrequests.exceptions.SSLError: HTTPSConnectionPool(host='nlp.informatik.hu-berlin.de', port=443): Max retries exceeded with url: /resources/models/sentiment-curated-distilbert/sentiment-en-mix-distillbert_4.pt (Caused by SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1131)')))\r\n\r\n**To Reproduce**\r\nMy code:\r\nfrom flair.models import TextClassifier\r\nfrom flair.data import Sentence\r\nclassifier = TextClassifier.load('en-sentiment')\r\nsentence = Sentence('Flair is pretty neat!')\r\nclassifier.predict(sentence)\r\n\r\nprint('Sentence above is: ', sentence.labels)\r\n\r\n**Expected behavior**\r\nA positive or negative score\r\n\r\n**Environment (please complete the following information):**\r\nWindows 10\r\nFlair 0.8\r\nPython 3.9.5\r\n\r\n**Additional context**\r\nI saw in similar issues you can download the models directly however, the links I tried below do not work. Where can I go to download the models?\r\nhttps://alan-nlp.s3.eu-central-1.amazonaws.com/resources/models-v0.4/NER-conll03-english/en-ner-conll03-v0.4.pt", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2270/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2270/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2258", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2258/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2258/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2258/events", "html_url": "https://github.com/flairNLP/flair/issues/2258", "id": 872049370, "node_id": "MDU6SXNzdWU4NzIwNDkzNzA=", "number": 2258, "title": "RuntimeError: Already borrowed ", "user": {"login": "chandrashekar3792", "id": 11002668, "node_id": "MDQ6VXNlcjExMDAyNjY4", "avatar_url": "https://avatars.githubusercontent.com/u/11002668?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chandrashekar3792", "html_url": "https://github.com/chandrashekar3792", "followers_url": "https://api.github.com/users/chandrashekar3792/followers", "following_url": "https://api.github.com/users/chandrashekar3792/following{/other_user}", "gists_url": "https://api.github.com/users/chandrashekar3792/gists{/gist_id}", "starred_url": "https://api.github.com/users/chandrashekar3792/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chandrashekar3792/subscriptions", "organizations_url": "https://api.github.com/users/chandrashekar3792/orgs", "repos_url": "https://api.github.com/users/chandrashekar3792/repos", "events_url": "https://api.github.com/users/chandrashekar3792/events{/privacy}", "received_events_url": "https://api.github.com/users/chandrashekar3792/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-04-30T05:48:58Z", "updated_at": "2022-08-23T11:28:13Z", "closed_at": "2021-11-04T06:01:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "root - ERROR - Exception occurred\r\nTraceback (most recent call last):\r\n  File \"/home/social/ner-tagging/social-ner.py\", line 27, in predictNER\r\n    tagger.predict(sentence)\r\n  File \"/home/social/ner-tagging/lib64/python3.6/site-packages/flair/models/sequence_tagger_model.py\", line 379, in predict\r\n    feature = self.forward(batch)\r\n  File \"/home/social/ner-tagging/lib64/python3.6/site-packages/flair/models/sequence_tagger_model.py\", line 642, in forward\r\n    self.embeddings.embed(sentences)\r\n  File \"/home/social/ner-tagging/lib64/python3.6/site-packages/flair/embeddings/base.py\", line 60, in embed\r\n    self._add_embeddings_internal(sentences)\r\n  File \"/home/social/ner-tagging/lib64/python3.6/site-packages/flair/embeddings/token.py\", line 923, in _add_embeddings_internal\r\n    self._add_embeddings_to_sentence(sentence)\r\n  File \"/home/social/ner-tagging/lib64/python3.6/site-packages/flair/embeddings/token.py\", line 957, in _add_embeddings_to_sentence\r\n    subtokenized_sentence = self.tokenizer.tokenize(tokenized_string)\r\n  File \"/home/social/ner-tagging/lib64/python3.6/site-packages/transformers/tokenization_utils_fast.py\", line 302, in tokenize\r\n    return self.encode_plus(text=text, text_pair=pair, add_special_tokens=add_special_tokens, **kwargs).tokens()\r\n  File \"/home/social/ner-tagging/lib64/python3.6/site-packages/transformers/tokenization_utils_base.py\", line 2362, in encode_plus\r\n    **kwargs,\r\n  File \"/home/social/ner-tagging/lib64/python3.6/site-packages/transformers/tokenization_utils_fast.py\", line 475, in _encode_plus\r\n    **kwargs,\r\n  File \"/home/social/ner-tagging/lib64/python3.6/site-packages/transformers/tokenization_utils_fast.py\", line 382, in _batch_encode_plus\r\n    pad_to_multiple_of=pad_to_multiple_of,\r\n  File \"/home/social/ner-tagging/lib64/python3.6/site-packages/transformers/tokenization_utils_fast.py\", line 337, in set_truncation_and_padding\r\n    self._tokenizer.no_truncation()\r\nRuntimeError: Already borrowed\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2258/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2258/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2255", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2255/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2255/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2255/events", "html_url": "https://github.com/flairNLP/flair/issues/2255", "id": 867796326, "node_id": "MDU6SXNzdWU4Njc3OTYzMjY=", "number": 2255, "title": "cannot import name 'set_seed' from 'transformers'", "user": {"login": "andy311p", "id": 68938613, "node_id": "MDQ6VXNlcjY4OTM4NjEz", "avatar_url": "https://avatars.githubusercontent.com/u/68938613?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andy311p", "html_url": "https://github.com/andy311p", "followers_url": "https://api.github.com/users/andy311p/followers", "following_url": "https://api.github.com/users/andy311p/following{/other_user}", "gists_url": "https://api.github.com/users/andy311p/gists{/gist_id}", "starred_url": "https://api.github.com/users/andy311p/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andy311p/subscriptions", "organizations_url": "https://api.github.com/users/andy311p/orgs", "repos_url": "https://api.github.com/users/andy311p/repos", "events_url": "https://api.github.com/users/andy311p/events{/privacy}", "received_events_url": "https://api.github.com/users/andy311p/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-04-26T14:56:06Z", "updated_at": "2021-09-02T03:46:02Z", "closed_at": "2021-09-02T03:46:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "I installed flair==0.8 and i try to run your example but get the following error:\r\n![image](https://user-images.githubusercontent.com/68938613/116103655-79a54680-a6b8-11eb-994f-8c51f6f49d0a.png)\r\n\r\ni run with transformers==4.5.1\r\n\r\nit runs just fine with flair==0.7 but not with 0.8.\r\ncan you help?", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2255/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2255/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2228", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2228/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2228/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2228/events", "html_url": "https://github.com/flairNLP/flair/issues/2228", "id": 860650132, "node_id": "MDU6SXNzdWU4NjA2NTAxMzI=", "number": 2228, "title": "The class STACKOVERFLOW_NER is taking some metadata in the corpus", "user": {"login": "symeneses", "id": 12284951, "node_id": "MDQ6VXNlcjEyMjg0OTUx", "avatar_url": "https://avatars.githubusercontent.com/u/12284951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/symeneses", "html_url": "https://github.com/symeneses", "followers_url": "https://api.github.com/users/symeneses/followers", "following_url": "https://api.github.com/users/symeneses/following{/other_user}", "gists_url": "https://api.github.com/users/symeneses/gists{/gist_id}", "starred_url": "https://api.github.com/users/symeneses/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/symeneses/subscriptions", "organizations_url": "https://api.github.com/users/symeneses/orgs", "repos_url": "https://api.github.com/users/symeneses/repos", "events_url": "https://api.github.com/users/symeneses/events{/privacy}", "received_events_url": "https://api.github.com/users/symeneses/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-04-18T12:17:18Z", "updated_at": "2021-04-19T14:35:51Z", "closed_at": "2021-04-19T14:35:51Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nThe class `STACKOVERFLOW_NER` is taking lines that are used to identify questions and answers into the corpus. Also, the entities used need some cleaning to be the same as in the author's paper.\r\n\r\n**To Reproduce**\r\n```py\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import STACKOVERFLOW_NER\r\n\r\ncorpus: Corpus = STACKOVERFLOW_NER()\r\nprint(corpus)\r\n```\r\nCorpus: 14545 train + 4607 dev + 4940 test sentences\r\n\r\nThe corpus has fewer sentences as reported in the paper. Looking inside the datasets in the corpus, we can see it has metadata.\r\n```py\r\ncorpus.train[0:3]\r\n```\r\n[Sentence: \"Question_ID : 37985879\"   [\u2212 Tokens: 3],\r\n Sentence: \"Question_URL : https://stackoverflow.com/questions/37985879/\"   [\u2212 Tokens: 3],\r\n Sentence: \"If I would have 2 tables\"   [\u2212 Tokens: 6  \u2212 Token-Labels: \"If I would have 2 tables <S-Data_Structure>\"]]\r\n\r\n**Expected behavior**\r\nThe summary of the corpus should be:\r\n```py\r\nprint(corpus)\r\n```\r\nCorpus: 9263 train + 2896 dev + 3108 test sentences\r\n\r\nThe above values are the same number of sentences processed with the paper authors code.\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Debian GNU/Linux 10 (buster)\r\n - Version: 0.8\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2228/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2228/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2224", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2224/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2224/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2224/events", "html_url": "https://github.com/flairNLP/flair/issues/2224", "id": 860533439, "node_id": "MDU6SXNzdWU4NjA1MzM0Mzk=", "number": 2224, "title": "<unk> label in ner training", "user": {"login": "helpmefindaname", "id": 26192135, "node_id": "MDQ6VXNlcjI2MTkyMTM1", "avatar_url": "https://avatars.githubusercontent.com/u/26192135?v=4", "gravatar_id": "", "url": "https://api.github.com/users/helpmefindaname", "html_url": "https://github.com/helpmefindaname", "followers_url": "https://api.github.com/users/helpmefindaname/followers", "following_url": "https://api.github.com/users/helpmefindaname/following{/other_user}", "gists_url": "https://api.github.com/users/helpmefindaname/gists{/gist_id}", "starred_url": "https://api.github.com/users/helpmefindaname/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/helpmefindaname/subscriptions", "organizations_url": "https://api.github.com/users/helpmefindaname/orgs", "repos_url": "https://api.github.com/users/helpmefindaname/repos", "events_url": "https://api.github.com/users/helpmefindaname/events{/privacy}", "received_events_url": "https://api.github.com/users/helpmefindaname/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-04-17T23:16:32Z", "updated_at": "2021-04-19T14:36:32Z", "closed_at": "2021-04-19T14:36:32Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nThe `corpus.make_tag_dictionary(tag_type)` method adds the default `<unk>` label to the dictionary, \r\n\r\n**To Reproduce**\r\n```\r\nfrom flair.datasets import BIOFID\r\ncorpus = BIOFID() # it doesn't matter which coprus to load, as long is it uses ner.\r\ndictionary = corpus.make_tag_dictionary(\"ner\")\r\nprint(dictionary.get_items())\r\n# ['<unk>', 'O', 'S-TME', 'S-LOC', 'S-TAX', 'B-OTHER', 'E-OTHER', 'B-TAX', 'E-TAX', 'I-OTHER', 'B-LOC', 'I-LOC', 'E-LOC', 'S-OTHER', 'B-ORG', 'I-ORG', 'E-ORG', 'B-PER', 'I-PER', 'E-PER', 'B-TME', 'E-TME', 'I-TME', 'S-ORG', 'S-PER', 'I-TAX', '<START>', '<STOP>']\r\n```\r\nnotice, `<START>` and `<STOP>` won't be tagged due to the way the viterbi encoding works, however `<unk>` has no purpose and there is no mechanism to exclude it. \r\n\r\n**Expected behavior**\r\nI'd expect the output to be\r\n`['O', 'S-TME', 'S-LOC', 'S-TAX', 'B-OTHER', 'E-OTHER', 'B-TAX', 'E-TAX', 'I-OTHER', 'B-LOC', 'I-LOC', 'E-LOC', 'S-OTHER', 'B-ORG', 'I-ORG', 'E-ORG', 'B-PER', 'I-PER', 'E-PER', 'B-TME', 'E-TME', 'I-TME', 'S-ORG', 'S-PER', 'I-TAX', '<START>', '<STOP>']`\r\n\r\n**Environment (please complete the following information):**\r\n - Windows 10 \r\n - flair 0.8.0.post1\r\n\r\n**Additional context**\r\nWe noticed the problem, when we trained a model with few examples and only a single epoch. That lead to the first token being tagged as `<unk>` which is then interpreted as it's own entity when using the `sentence.to_dict(tag_type=tag_type)` method and our automated evaluation script cannot handle unspecified entities.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2224/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2224/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2218", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2218/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2218/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2218/events", "html_url": "https://github.com/flairNLP/flair/issues/2218", "id": 859884195, "node_id": "MDU6SXNzdWU4NTk4ODQxOTU=", "number": 2218, "title": "Error when running model optimization tutorial: RuntimeError: shape '[32, 13, 300]' is invalid for input of size 208200", "user": {"login": "hp52", "id": 79057427, "node_id": "MDQ6VXNlcjc5MDU3NDI3", "avatar_url": "https://avatars.githubusercontent.com/u/79057427?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hp52", "html_url": "https://github.com/hp52", "followers_url": "https://api.github.com/users/hp52/followers", "following_url": "https://api.github.com/users/hp52/following{/other_user}", "gists_url": "https://api.github.com/users/hp52/gists{/gist_id}", "starred_url": "https://api.github.com/users/hp52/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hp52/subscriptions", "organizations_url": "https://api.github.com/users/hp52/orgs", "repos_url": "https://api.github.com/users/hp52/repos", "events_url": "https://api.github.com/users/hp52/events{/privacy}", "received_events_url": "https://api.github.com/users/hp52/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-04-16T14:48:43Z", "updated_at": "2021-08-22T01:48:56Z", "closed_at": "2021-08-22T01:48:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n\r\nWhile trying the code in the [optimization tutorial](https://github.com/flairNLP/flair/blob/master/resources/docs/TUTORIAL_8_MODEL_OPTIMIZATION.md), I get this error\r\n`RuntimeError: shape '[32, 13, 300]' is invalid for input of size 208200`\r\nin the second training run.\r\n\r\n**To Reproduce**\r\n\r\n\r\n```\r\nfrom flair.datasets import TREC_6\r\n# load your corpus\r\ncorpus = TREC_6()\r\n\r\nfrom hyperopt import hp\r\nfrom flair.hyperparameter.param_selection import SearchSpace, Parameter\r\nfrom flair.embeddings import WordEmbeddings, FlairEmbeddings\r\n\r\n# define your search space\r\nsearch_space = SearchSpace()\r\nsearch_space.add(Parameter.EMBEDDINGS, hp.choice, options=[\r\n    [ WordEmbeddings('en') ], \r\n    [ FlairEmbeddings('news-forward'), FlairEmbeddings('news-backward') ]\r\n])\r\nsearch_space.add(Parameter.HIDDEN_SIZE, hp.choice, options=[32, 64, 128])\r\nsearch_space.add(Parameter.RNN_LAYERS, hp.choice, options=[1, 2])\r\nsearch_space.add(Parameter.DROPOUT, hp.uniform, low=0.0, high=0.5)\r\nsearch_space.add(Parameter.LEARNING_RATE, hp.choice, options=[0.05, 0.1, 0.15, 0.2])\r\nsearch_space.add(Parameter.MINI_BATCH_SIZE, hp.choice, options=[8, 16, 32])\r\n\r\nfrom flair.hyperparameter.param_selection import TextClassifierParamSelector, OptimizationValue\r\n\r\n# create the parameter selector\r\nparam_selector = TextClassifierParamSelector(\r\n    corpus, \r\n    False, \r\n    'resources/results', \r\n    'lstm',\r\n    max_epochs=50, \r\n    training_runs=3,\r\n    optimization_value=OptimizationValue.DEV_SCORE\r\n)\r\n\r\n# start the optimization\r\nparam_selector.optimize(search_space, max_evals=100)\r\n\r\n```\r\n\r\nThe first training run does fine, but when the second training run starts, I get this error:\r\n\r\n```\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-8-abc0f9c54892> in <module>()\r\n     13 \r\n     14 # start the optimization\r\n---> 15 param_selector.optimize(search_space, max_evals=100)\r\n\r\n11 frames\r\n/usr/local/lib/python3.7/dist-packages/flair/embeddings/document.py in _add_embeddings_internal(self, sentences)\r\n    514                 len(sentences),\r\n    515                 longest_token_sequence_in_batch,\r\n--> 516                 self.embeddings.embedding_length,\r\n    517             ]\r\n    518         )\r\n\r\nRuntimeError: shape '[32, 13, 300]' is invalid for input of size 208200\r\n\r\n```\r\n\r\n**Expected behavior**\r\n\r\nSince I copied the code exactly as it is from the tutorial, I expect it to run fine and output the best hyperparameters.\r\n\r\n\r\n**Environment (please complete the following information):**\r\n\r\nGoogle Colab\r\nVersion: 0.8.0.post1\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2218/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2218/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2207", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2207/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2207/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2207/events", "html_url": "https://github.com/flairNLP/flair/issues/2207", "id": 857271084, "node_id": "MDU6SXNzdWU4NTcyNzEwODQ=", "number": 2207, "title": "Issue with cache root", "user": {"login": "Narsil", "id": 204321, "node_id": "MDQ6VXNlcjIwNDMyMQ==", "avatar_url": "https://avatars.githubusercontent.com/u/204321?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Narsil", "html_url": "https://github.com/Narsil", "followers_url": "https://api.github.com/users/Narsil/followers", "following_url": "https://api.github.com/users/Narsil/following{/other_user}", "gists_url": "https://api.github.com/users/Narsil/gists{/gist_id}", "starred_url": "https://api.github.com/users/Narsil/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Narsil/subscriptions", "organizations_url": "https://api.github.com/users/Narsil/orgs", "repos_url": "https://api.github.com/users/Narsil/repos", "events_url": "https://api.github.com/users/Narsil/events{/privacy}", "received_events_url": "https://api.github.com/users/Narsil/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-04-13T19:48:36Z", "updated_at": "2021-05-05T08:12:09Z", "closed_at": "2021-05-05T08:12:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nA clear and concise description of what the bug is.\r\n\r\nIt seems the cache root is wrong if it is defined in the environment instead of the default\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior (e.g. which model did you train? what parameters did you use? etc.).\r\n\r\nCreate `test.py`:\r\n\r\n```python\r\nfrom flair.data import Sentence\r\nfrom flair.models import SequenceTagger\r\n\r\n# make a sentence\r\nsentence = Sentence('I love Berlin .')\r\n\r\n# load the NER tagger\r\ntagger = SequenceTagger.load('ner')\r\n\r\n# run NER over sentence\r\ntagger.predict(sentence)\r\n```\r\nand run \r\n`FLAIR_CACHE_ROOT=$HOME/.cache/ python test.py`\r\n\r\n**Expected behavior**\r\nA clear and concise description of what you expected to happen.\r\n\r\nExample should work out of th  box\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: ubuntu\r\n - Version [e.g. flair-0.3.2]: 0.8.1 (or master)\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n\r\nSimple fix is to cast to Path too when coming from env.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2207/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2207/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2205", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2205/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2205/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2205/events", "html_url": "https://github.com/flairNLP/flair/issues/2205", "id": 855391864, "node_id": "MDU6SXNzdWU4NTUzOTE4NjQ=", "number": 2205, "title": "How to display other curve lines together like validation-loss, train-loss, and F1", "user": {"login": "Tadesse-Destaw", "id": 75490713, "node_id": "MDQ6VXNlcjc1NDkwNzEz", "avatar_url": "https://avatars.githubusercontent.com/u/75490713?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Tadesse-Destaw", "html_url": "https://github.com/Tadesse-Destaw", "followers_url": "https://api.github.com/users/Tadesse-Destaw/followers", "following_url": "https://api.github.com/users/Tadesse-Destaw/following{/other_user}", "gists_url": "https://api.github.com/users/Tadesse-Destaw/gists{/gist_id}", "starred_url": "https://api.github.com/users/Tadesse-Destaw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Tadesse-Destaw/subscriptions", "organizations_url": "https://api.github.com/users/Tadesse-Destaw/orgs", "repos_url": "https://api.github.com/users/Tadesse-Destaw/repos", "events_url": "https://api.github.com/users/Tadesse-Destaw/events{/privacy}", "received_events_url": "https://api.github.com/users/Tadesse-Destaw/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-04-11T19:46:45Z", "updated_at": "2021-08-17T01:38:45Z", "closed_at": "2021-08-17T01:38:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "my flair plotter from loss.tsv plots only training-loss, what is the error to display other curve lines together like validation-loss, test-loss, and F1 accuracy\r\n![image](https://user-images.githubusercontent.com/75490713/114318654-b13bbc80-9b16-11eb-90c3-5709efb09f24.png)\r\n\r\nThanks", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2205/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2205/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2196", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2196/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2196/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2196/events", "html_url": "https://github.com/flairNLP/flair/issues/2196", "id": 848628585, "node_id": "MDU6SXNzdWU4NDg2Mjg1ODU=", "number": 2196, "title": "AttributeError: 'KeyedVectors' object has no attribute 'key_to_index'", "user": {"login": "Alea4jacta6est", "id": 26580860, "node_id": "MDQ6VXNlcjI2NTgwODYw", "avatar_url": "https://avatars.githubusercontent.com/u/26580860?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Alea4jacta6est", "html_url": "https://github.com/Alea4jacta6est", "followers_url": "https://api.github.com/users/Alea4jacta6est/followers", "following_url": "https://api.github.com/users/Alea4jacta6est/following{/other_user}", "gists_url": "https://api.github.com/users/Alea4jacta6est/gists{/gist_id}", "starred_url": "https://api.github.com/users/Alea4jacta6est/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Alea4jacta6est/subscriptions", "organizations_url": "https://api.github.com/users/Alea4jacta6est/orgs", "repos_url": "https://api.github.com/users/Alea4jacta6est/repos", "events_url": "https://api.github.com/users/Alea4jacta6est/events{/privacy}", "received_events_url": "https://api.github.com/users/Alea4jacta6est/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-04-01T16:49:07Z", "updated_at": "2021-04-01T16:49:16Z", "closed_at": "2021-04-01T16:49:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "When I try to load a custom fastext model using Flair classifier I get an error:\r\n`AttributeError: 'KeyedVectors' object has no attribute 'key_to_index'`\r\n\r\n(I use flair 0.5 on mac. )\r\n### Solution\r\nThe source of this problem is in gensim version that is not specified in flair but should be gensim==3.8.3 (not 4.0 or newer)\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2196/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2196/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2195", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2195/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2195/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2195/events", "html_url": "https://github.com/flairNLP/flair/issues/2195", "id": 848127442, "node_id": "MDU6SXNzdWU4NDgxMjc0NDI=", "number": 2195, "title": "TransformerWordEmbeddings wrong arguments in README: batch_size not working", "user": {"login": "ugm2", "id": 25923343, "node_id": "MDQ6VXNlcjI1OTIzMzQz", "avatar_url": "https://avatars.githubusercontent.com/u/25923343?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ugm2", "html_url": "https://github.com/ugm2", "followers_url": "https://api.github.com/users/ugm2/followers", "following_url": "https://api.github.com/users/ugm2/following{/other_user}", "gists_url": "https://api.github.com/users/ugm2/gists{/gist_id}", "starred_url": "https://api.github.com/users/ugm2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ugm2/subscriptions", "organizations_url": "https://api.github.com/users/ugm2/orgs", "repos_url": "https://api.github.com/users/ugm2/repos", "events_url": "https://api.github.com/users/ugm2/events{/privacy}", "received_events_url": "https://api.github.com/users/ugm2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-04-01T07:30:16Z", "updated_at": "2021-04-01T13:05:39Z", "closed_at": "2021-04-01T13:05:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI was following [TRANSFORMER_EMBEDDINGS.md](https://github.com/flairNLP/flair/blob/master/resources/docs/embeddings/TRANSFORMER_EMBEDDINGS.md) tutorial and tried assigning a `batch_size` for multiple sentences inference at once, and I got an error saying that batch_size is an unexpected keyword argument.\r\n\r\nIn the [Arguments Section](https://github.com/flairNLP/flair/blob/master/resources/docs/embeddings/TRANSFORMER_EMBEDDINGS.md#arguments) it says that I can use `batch_size`, but I was unable to.\r\n\r\n**_It seems in Flair==0.7 works_**\r\n\r\n**To Reproduce**\r\n```\r\nfrom flair.embeddings import TransformerWordEmbeddings\r\nmodel = TransformerWordEmbeddings('bert-base-uncased', batch_size=2)\r\n```\r\nTraceback:\r\n```\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/home/unai/miniconda3/envs/li_encoding/lib/python3.7/site-packages/flair/embeddings/token.py\", line 821, in __init__\r\n    self.model = AutoModel.from_pretrained(model, config=config, **kwargs)\r\n  File \"/home/unai/miniconda3/envs/li_encoding/lib/python3.7/site-packages/transformers/models/auto/modeling_auto.py\", line 815, in from_pretrained\r\n    pretrained_model_name_or_path, *model_args, config=config, **kwargs\r\n  File \"/home/unai/miniconda3/envs/li_encoding/lib/python3.7/site-packages/transformers/modeling_utils.py\", line 1058, in from_pretrained\r\n    model = cls(config, *model_args, **model_kwargs)\r\nTypeError: __init__() got an unexpected keyword argument 'batch_size'\r\n```\r\n\r\n**Expected behavior**\r\nI would expect a normal initialization of model, and then being able to embed sentences in chunks\r\n\r\n**Environment:**\r\n - OS: Linux (Ubuntu 18.04.5 LTS)\r\n - Flair Version: 0.8\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2195/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2195/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2194", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2194/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2194/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2194/events", "html_url": "https://github.com/flairNLP/flair/issues/2194", "id": 846848257, "node_id": "MDU6SXNzdWU4NDY4NDgyNTc=", "number": 2194, "title": "ModuleAttributeError: 'TransformerDocumentEmbeddings' object has no attribute 'name'", "user": {"login": "melothegoodfellow", "id": 12998594, "node_id": "MDQ6VXNlcjEyOTk4NTk0", "avatar_url": "https://avatars.githubusercontent.com/u/12998594?v=4", "gravatar_id": "", "url": "https://api.github.com/users/melothegoodfellow", "html_url": "https://github.com/melothegoodfellow", "followers_url": "https://api.github.com/users/melothegoodfellow/followers", "following_url": "https://api.github.com/users/melothegoodfellow/following{/other_user}", "gists_url": "https://api.github.com/users/melothegoodfellow/gists{/gist_id}", "starred_url": "https://api.github.com/users/melothegoodfellow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/melothegoodfellow/subscriptions", "organizations_url": "https://api.github.com/users/melothegoodfellow/orgs", "repos_url": "https://api.github.com/users/melothegoodfellow/repos", "events_url": "https://api.github.com/users/melothegoodfellow/events{/privacy}", "received_events_url": "https://api.github.com/users/melothegoodfellow/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-03-31T15:17:38Z", "updated_at": "2021-08-05T20:09:07Z", "closed_at": "2021-08-05T20:09:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have flair==0.7 installed,\r\nwhen I try to load a finetuned TARSClassifier on my local system\r\n\r\nfrom flair.models.text_classification_model import TARSClassifier\r\nfrom flair.data import Sentence as FLAIRSentence\r\ntars = TARSClassifier.load(\"./models/flairFSL/trainedModel.pt\") \r\n\r\n**Describe the bug**\r\nFile \"<stdin>\", line 1, in <module>\r\n  File \"/home/sa/workspace/FastAPI/FinalModel/venv/lib/python3.7/site-packages/flair/nn.py\", line 88, in load\r\n    state = torch.load(f, map_location='cpu')\r\n  File \"/home/saurabh/workspace/FastAPI/FinalModel/venv/lib/python3.7/site-packages/torch/serialization.py\", line 594, in load\r\n    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)\r\n  File \"/home/sa/workspace/FastAPI/FinalModel/venv/lib/python3.7/site-packages/torch/serialization.py\", line 853, in _load\r\n    result = unpickler.load()\r\n  File \"/home/sa/workspace/FastAPI/FinalModel/venv/lib/python3.7/site-packages/flair/embeddings/document.py\", line 184, in __setstate__\r\n    model_name = self.name.split('transformer-document-')[-1]\r\n  File \"/home/sa/workspace/FastAPI/FinalModel/venv/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 779, in __getattr__\r\n    type(self).__name__, name))\r\ntorch.nn.modules.module.ModuleAttributeError: 'TransformerDocumentEmbeddings' object has no attribute 'name'\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2194/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2194/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2192", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2192/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2192/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2192/events", "html_url": "https://github.com/flairNLP/flair/issues/2192", "id": 843807404, "node_id": "MDU6SXNzdWU4NDM4MDc0MDQ=", "number": 2192, "title": "pip install error on Google colab", "user": {"login": "Gary3321", "id": 31748641, "node_id": "MDQ6VXNlcjMxNzQ4NjQx", "avatar_url": "https://avatars.githubusercontent.com/u/31748641?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Gary3321", "html_url": "https://github.com/Gary3321", "followers_url": "https://api.github.com/users/Gary3321/followers", "following_url": "https://api.github.com/users/Gary3321/following{/other_user}", "gists_url": "https://api.github.com/users/Gary3321/gists{/gist_id}", "starred_url": "https://api.github.com/users/Gary3321/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Gary3321/subscriptions", "organizations_url": "https://api.github.com/users/Gary3321/orgs", "repos_url": "https://api.github.com/users/Gary3321/repos", "events_url": "https://api.github.com/users/Gary3321/events{/privacy}", "received_events_url": "https://api.github.com/users/Gary3321/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-03-29T21:02:47Z", "updated_at": "2021-08-04T22:44:45Z", "closed_at": "2021-08-04T22:44:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhen I performed **pip install flair** in google colab, I got the following errors:\r\n\r\nERROR: torchvision 0.9.0+cu101 has requirement torch==1.8.0, but you'll have torch 1.7.1 which is incompatible.\r\nERROR: torchtext 0.9.0 has requirement torch==1.8.0, but you'll have torch 1.7.1 which is incompatible.\r\nERROR: google-colab 1.0.0 has requirement requests~=2.23.0, but you'll have requests 2.25.1 which is incompatible.\r\nERROR: datascience 0.10.6 has requirement folium==0.2.1, but you'll have folium 0.8.3 which is incompatible.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2192/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2192/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2187", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2187/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2187/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2187/events", "html_url": "https://github.com/flairNLP/flair/issues/2187", "id": 841393310, "node_id": "MDU6SXNzdWU4NDEzOTMzMTA=", "number": 2187, "title": "Very low test score - train and dev is fine v0.8.0 (v0.7.0 works well on same code)", "user": {"login": "ma7555", "id": 7144929, "node_id": "MDQ6VXNlcjcxNDQ5Mjk=", "avatar_url": "https://avatars.githubusercontent.com/u/7144929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ma7555", "html_url": "https://github.com/ma7555", "followers_url": "https://api.github.com/users/ma7555/followers", "following_url": "https://api.github.com/users/ma7555/following{/other_user}", "gists_url": "https://api.github.com/users/ma7555/gists{/gist_id}", "starred_url": "https://api.github.com/users/ma7555/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ma7555/subscriptions", "organizations_url": "https://api.github.com/users/ma7555/orgs", "repos_url": "https://api.github.com/users/ma7555/repos", "events_url": "https://api.github.com/users/ma7555/events{/privacy}", "received_events_url": "https://api.github.com/users/ma7555/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-03-25T22:54:08Z", "updated_at": "2021-08-03T10:16:33Z", "closed_at": "2021-08-03T10:16:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nv0.8.0 provides extremely low test scores. the model can't be used to detect anything\r\nv0.7.0 works well - no problems at all on the same notebook.\r\n```\r\n{'dev_loss_history': [2.7514843940734863, 2.424471855163574],\r\n 'dev_score_history': [0.8079748163693599, 0.8428093645484951],\r\n 'test_score': 0.0014947683109118085,\r\n 'train_loss_history': [7.417086522102356, 3.4130817494392396]}\r\n```\r\n\r\n\r\n**To Reproduce**\r\nhttps://colab.research.google.com/drive/1GI0lIraZwzVD1hRhhDTg4JKh8hRvH7u9?usp=sharing\r\ninstalling v0.7.0 works well using the same notebook\r\n\r\n**Expected behavior**\r\nsame behaviour between both versions\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - Linux, Google Colab\r\n - v0.8.0\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2187/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2187/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2186", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2186/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2186/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2186/events", "html_url": "https://github.com/flairNLP/flair/issues/2186", "id": 840906044, "node_id": "MDU6SXNzdWU4NDA5MDYwNDQ=", "number": 2186, "title": "Size of corpus different from when upgrading from 0.7 to 0.8.0.post1", "user": {"login": "albertovilla", "id": 1217687, "node_id": "MDQ6VXNlcjEyMTc2ODc=", "avatar_url": "https://avatars.githubusercontent.com/u/1217687?v=4", "gravatar_id": "", "url": "https://api.github.com/users/albertovilla", "html_url": "https://github.com/albertovilla", "followers_url": "https://api.github.com/users/albertovilla/followers", "following_url": "https://api.github.com/users/albertovilla/following{/other_user}", "gists_url": "https://api.github.com/users/albertovilla/gists{/gist_id}", "starred_url": "https://api.github.com/users/albertovilla/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/albertovilla/subscriptions", "organizations_url": "https://api.github.com/users/albertovilla/orgs", "repos_url": "https://api.github.com/users/albertovilla/repos", "events_url": "https://api.github.com/users/albertovilla/events{/privacy}", "received_events_url": "https://api.github.com/users/albertovilla/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-03-25T13:03:03Z", "updated_at": "2021-08-06T15:40:10Z", "closed_at": "2021-08-06T15:40:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nThe number of values in training / test corpus is different when upgrading from 0.7 to 0.8.0.post1 version of Flair library.\r\n\r\n**To Reproduce**\r\nWhen using the version 0.7 of Flair library for training there were 14632 values in training corpus and 4314 values in the test one. However, after upgrading the version to 0.8.0.post1 using the same code 364 values are detected in training corpus and 827 in the testing one.\r\n\r\n**Expected behavior**\r\nI would expect the same number of values identified in both versions\r\n\r\n**Screenshots**\r\nN/A\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Redhat 7\r\n - Version [e.g. flair-0.3.2]: flair 0.7 / flair 0.8.0.post1\r\n\r\n**Additional context**\r\nUnfortunately,  I cannot share the train and test BIOES files I'm using but my best guess is that something has changed in the code which process these files and with the later version the data reader is assuming the file has \"ended\" before reaching the real end of the file.\r\n\r\nI can share the code I'm using but I guess the problem is somewhere else because I'm executing the same code with the same data just the change of the library version is causing the issue.\r\n\r\n```python\r\nfrom pathlib import Path\r\n\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import ColumnCorpus, DataLoader\r\nfrom flair.models import SequenceTagger\r\n\r\n# Folder where training and test files are located\r\ndata_folder = 'data'\r\n\r\n# Filenames of the training and testing files\r\nfilepath_train = 'train.bioes'\r\nfilepath_test = 'test.bioes'\r\n\r\n# Definition of columns for the ColumnCorpus\r\ncolumns = {0: 'text', 1: 'ner'}\r\n\r\n# Initializing the corpus\r\ncorpus: Corpus = ColumnCorpus(data_folder, \r\n                              columns, \r\n                              train_file = filepath_train, \r\n                              test_file = filepath_test)\r\n\r\n# Make tag dictionary\r\ntag_type = 'ner'\r\ntag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\n\r\nprint(f'We have {len(corpus.train)} values in training corpus and {len(corpus.test)} in testing corpus')\r\n\r\nMODEL_FOLDER = 'resources/taggers/distilbert-l2-g-ner'\r\n\r\n# load best model from the corresponding model folder\r\ntagger: SequenceTagger = SequenceTagger.load(Path(MODEL_FOLDER) / 'best-model.pt')\r\n\r\n# create DataLoader using corpus.test\r\nvalidation_data_loader = DataLoader(corpus.test, batch_size=32)\r\n\r\n# run evaluation procedure\r\nresult, score = tagger.evaluate(validation_data_loader.dataset, out_path=f\"predictions.txt\")\r\n\r\n# print detailed results\r\nprint(result.detailed_results)\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2186/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2186/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2182", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2182/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2182/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2182/events", "html_url": "https://github.com/flairNLP/flair/issues/2182", "id": 838878579, "node_id": "MDU6SXNzdWU4Mzg4Nzg1Nzk=", "number": 2182, "title": "TransformerWordEmbeddings tutorial bug", "user": {"login": "matirojasg", "id": 56651055, "node_id": "MDQ6VXNlcjU2NjUxMDU1", "avatar_url": "https://avatars.githubusercontent.com/u/56651055?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matirojasg", "html_url": "https://github.com/matirojasg", "followers_url": "https://api.github.com/users/matirojasg/followers", "following_url": "https://api.github.com/users/matirojasg/following{/other_user}", "gists_url": "https://api.github.com/users/matirojasg/gists{/gist_id}", "starred_url": "https://api.github.com/users/matirojasg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matirojasg/subscriptions", "organizations_url": "https://api.github.com/users/matirojasg/orgs", "repos_url": "https://api.github.com/users/matirojasg/repos", "events_url": "https://api.github.com/users/matirojasg/events{/privacy}", "received_events_url": "https://api.github.com/users/matirojasg/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-03-23T16:01:10Z", "updated_at": "2021-07-28T17:41:09Z", "closed_at": "2021-07-28T17:41:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "In this tutorial: https://github.com/flairNLP/flair/blob/master/resources/docs/embeddings/TRANSFORMER_EMBEDDINGS.md.\r\n\r\nI tried the following code:\r\n\r\n```\r\nfrom flair.data import Sentence\r\nfrom flair.embeddings import TransformerWordEmbeddings\r\n\r\nsentence = Sentence('The grass is green.')\r\n\r\n# use only last layers\r\nembeddings = TransformerWordEmbeddings('bert-base-uncased', layers='-1')\r\nembeddings.embed(sentence)\r\nprint(sentence[0].embedding.size())\r\n\r\nsentence.clear_embeddings()\r\n\r\n# use last two layers\r\nembeddings = TransformerWordEmbeddings('bert-base-uncased', layers='-1,-2')\r\nembeddings.embed(sentence)\r\nprint(sentence[0].embedding.size())\r\n\r\nsentence.clear_embeddings()\r\n\r\n# use ALL layers\r\nembeddings = TransformerWordEmbeddings('bert-base-uncased', layers='all')\r\nembeddings.embed(sentence)\r\nprint(sentence[0].embedding.size())\r\n```\r\n\r\nThis should print:\r\n\r\ntorch.Size([768])\r\ntorch.Size([1536])\r\ntorch.Size([9984])\r\n\r\nBut it actually print:\r\n\r\ntorch.Size([768])\r\ntorch.Size([768])\r\ntorch.Size([768])\r\n\r\nWhy is the code not doing the concatenation?", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2182/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2182/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2181", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2181/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2181/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2181/events", "html_url": "https://github.com/flairNLP/flair/issues/2181", "id": 838825590, "node_id": "MDU6SXNzdWU4Mzg4MjU1OTA=", "number": 2181, "title": "TransformerWordEmbeddings using Spanish BERT doesn't work", "user": {"login": "matirojasg", "id": 56651055, "node_id": "MDQ6VXNlcjU2NjUxMDU1", "avatar_url": "https://avatars.githubusercontent.com/u/56651055?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matirojasg", "html_url": "https://github.com/matirojasg", "followers_url": "https://api.github.com/users/matirojasg/followers", "following_url": "https://api.github.com/users/matirojasg/following{/other_user}", "gists_url": "https://api.github.com/users/matirojasg/gists{/gist_id}", "starred_url": "https://api.github.com/users/matirojasg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matirojasg/subscriptions", "organizations_url": "https://api.github.com/users/matirojasg/orgs", "repos_url": "https://api.github.com/users/matirojasg/repos", "events_url": "https://api.github.com/users/matirojasg/events{/privacy}", "received_events_url": "https://api.github.com/users/matirojasg/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2021-03-23T15:06:13Z", "updated_at": "2021-09-28T10:41:20Z", "closed_at": "2021-09-28T10:41:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello. I have found that I cannot use the `TransformerWordEmbeddings` class for the Spanish BERT model.\r\n\r\nThis is the code:\r\n\r\n```\r\nfrom flair.data import Sentence\r\nfrom flair.embeddings import TransformerWordEmbeddings\r\n\r\nsentence = Sentence('El pasto es verde.')\r\n\r\n# use only last layers\r\nembeddings = TransformerWordEmbeddings('dccuchile/bert-base-spanish-wwm-uncased')\r\nembeddings.embed(sentence)\r\nprint(sentence[0].embedding.size())\r\n```\r\n\r\nThis is the error:\r\n\r\n```\r\n    324         # Set truncation and padding on the backend tokenizer\r\n    325         if truncation_strategy != TruncationStrategy.DO_NOT_TRUNCATE:\r\n--> 326             self._tokenizer.enable_truncation(max_length, stride=stride, strategy=truncation_strategy.value)\r\n    327         else:\r\n    328             self._tokenizer.no_truncation()\r\n\r\nOverflowError: int too big to convert\r\n```\r\n\r\nWhat should I do? ", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2181/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2181/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2174", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2174/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2174/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2174/events", "html_url": "https://github.com/flairNLP/flair/issues/2174", "id": 837519150, "node_id": "MDU6SXNzdWU4Mzc1MTkxNTA=", "number": 2174, "title": "IMDB class does not return original splits with `rebalance_corpus=False`", "user": {"login": "kishaloyhalder", "id": 16892172, "node_id": "MDQ6VXNlcjE2ODkyMTcy", "avatar_url": "https://avatars.githubusercontent.com/u/16892172?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kishaloyhalder", "html_url": "https://github.com/kishaloyhalder", "followers_url": "https://api.github.com/users/kishaloyhalder/followers", "following_url": "https://api.github.com/users/kishaloyhalder/following{/other_user}", "gists_url": "https://api.github.com/users/kishaloyhalder/gists{/gist_id}", "starred_url": "https://api.github.com/users/kishaloyhalder/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kishaloyhalder/subscriptions", "organizations_url": "https://api.github.com/users/kishaloyhalder/orgs", "repos_url": "https://api.github.com/users/kishaloyhalder/repos", "events_url": "https://api.github.com/users/kishaloyhalder/events{/privacy}", "received_events_url": "https://api.github.com/users/kishaloyhalder/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-03-22T09:33:05Z", "updated_at": "2021-03-22T20:36:06Z", "closed_at": "2021-03-22T20:36:06Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nIMDB class does not return original splits with `rebalance_corpus=False`. It always splits the data in 90-10 between train and test.\r\n\r\n**To Reproduce**\r\nUse the following to reproduce:\r\n\r\n`\r\nfrom flair.datasets import IMDB\r\ncorpus = IMDB(rebalance_corpus=False)\r\n\r\nprint(corpus.train)\r\nprint(corpus.dev)\r\nprint(corpus.test)\r\n`\r\n\r\n**Expected behavior**\r\nIt should have 25K point in `train` and `dev` combined and the same in test.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2174/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2174/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2169", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2169/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2169/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2169/events", "html_url": "https://github.com/flairNLP/flair/issues/2169", "id": 835611633, "node_id": "MDU6SXNzdWU4MzU2MTE2MzM=", "number": 2169, "title": "Close log_handler after training is complete.", "user": {"login": "parakalan", "id": 17947485, "node_id": "MDQ6VXNlcjE3OTQ3NDg1", "avatar_url": "https://avatars.githubusercontent.com/u/17947485?v=4", "gravatar_id": "", "url": "https://api.github.com/users/parakalan", "html_url": "https://github.com/parakalan", "followers_url": "https://api.github.com/users/parakalan/followers", "following_url": "https://api.github.com/users/parakalan/following{/other_user}", "gists_url": "https://api.github.com/users/parakalan/gists{/gist_id}", "starred_url": "https://api.github.com/users/parakalan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/parakalan/subscriptions", "organizations_url": "https://api.github.com/users/parakalan/orgs", "repos_url": "https://api.github.com/users/parakalan/repos", "events_url": "https://api.github.com/users/parakalan/events{/privacy}", "received_events_url": "https://api.github.com/users/parakalan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-03-19T06:26:09Z", "updated_at": "2021-04-07T13:34:53Z", "closed_at": "2021-04-07T13:34:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nWe are removing the log_handler [here](https://github.com/flairNLP/flair/blob/master/flair/trainers/trainer.py#L633) but not closing the handler leading to  `ResourceWarning: unclosed file <_io.BufferedReader name='training.log`. Hence we are not able to programatically access the training.log (For ex - Unable to upload the file to s3 using botocore)\r\n\r\n**To Reproduce**\r\nTraining just any model leads to this Warning. \r\n\r\n**Expected behavior**\r\nThe `log_handler` to be closed before training exits\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - MacOS 10.15.6\r\n - Version: flair-0.8\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2169/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2169/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2159", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2159/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2159/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2159/events", "html_url": "https://github.com/flairNLP/flair/issues/2159", "id": 833237525, "node_id": "MDU6SXNzdWU4MzMyMzc1MjU=", "number": 2159, "title": "Slovenian word embeddings ID is incorrect in the documentation", "user": {"login": "tadejmagajna", "id": 1088423, "node_id": "MDQ6VXNlcjEwODg0MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/1088423?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tadejmagajna", "html_url": "https://github.com/tadejmagajna", "followers_url": "https://api.github.com/users/tadejmagajna/followers", "following_url": "https://api.github.com/users/tadejmagajna/following{/other_user}", "gists_url": "https://api.github.com/users/tadejmagajna/gists{/gist_id}", "starred_url": "https://api.github.com/users/tadejmagajna/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tadejmagajna/subscriptions", "organizations_url": "https://api.github.com/users/tadejmagajna/orgs", "repos_url": "https://api.github.com/users/tadejmagajna/repos", "events_url": "https://api.github.com/users/tadejmagajna/events{/privacy}", "received_events_url": "https://api.github.com/users/tadejmagajna/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-03-16T22:14:41Z", "updated_at": "2021-03-23T09:35:03Z", "closed_at": "2021-03-23T09:35:03Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "The [documentation](https://github.com/flairNLP/flair/blob/master/resources/docs/embeddings/CLASSIC_WORD_EMBEDDINGS.md) suggests we should use `si` as the ID for the Slovenian FastText embeddings. But if we use the `si` ID we get the following results:\r\n\r\nWhen running:\r\n```python\r\nfrom flair.embeddings import WordEmbeddings\r\nWordEmbeddings('si')\r\n```\r\nWe get:\r\n`OSError: HEAD request failed for url https://flair.informatik.hu-berlin.de/resources/embeddings/token/si-wiki-fasttext-300d-1M.vectors.npy with status code 404.`\r\n\r\nHowever, if we instead use the `sl` ID, the embeddings will load correctly. I also manually verified the `sl` embeddings are indeed the Slovene.\r\n\r\nThe documentation says that the IDs are language codes, but the ID used for Slovene (`si`) is actually a country code for Slovenia. Whereas the language code for Slovenian language is actualy `sl` (the ID that actually works right now).\r\n\r\nThe fix involves simply updating `si` to `sl` in the [documentation](https://github.com/flairNLP/flair/blob/master/resources/docs/embeddings/CLASSIC_WORD_EMBEDDINGS.md).\r\n\r\nHappy to open a PR for this 1 character change", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2159/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2159/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2143", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2143/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2143/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2143/events", "html_url": "https://github.com/flairNLP/flair/issues/2143", "id": 826104641, "node_id": "MDU6SXNzdWU4MjYxMDQ2NDE=", "number": 2143, "title": "Please do not use post releases to fix bugs", "user": {"login": "schelv", "id": 13403863, "node_id": "MDQ6VXNlcjEzNDAzODYz", "avatar_url": "https://avatars.githubusercontent.com/u/13403863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/schelv", "html_url": "https://github.com/schelv", "followers_url": "https://api.github.com/users/schelv/followers", "following_url": "https://api.github.com/users/schelv/following{/other_user}", "gists_url": "https://api.github.com/users/schelv/gists{/gist_id}", "starred_url": "https://api.github.com/users/schelv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/schelv/subscriptions", "organizations_url": "https://api.github.com/users/schelv/orgs", "repos_url": "https://api.github.com/users/schelv/repos", "events_url": "https://api.github.com/users/schelv/events{/privacy}", "received_events_url": "https://api.github.com/users/schelv/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-03-09T15:27:39Z", "updated_at": "2021-03-15T09:18:01Z", "closed_at": "2021-03-15T09:18:01Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "A while ago I encountered a strange error while building a docker container.\r\n\r\nIt was caused by a post release of flair causing a dependency version conflict.\r\n\r\nPlease do not use post releases to fix bugs. It is [bad](https://www.python.org/dev/peps/pep-0440/#post-releases), mmkay\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2143/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2143/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2140", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2140/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2140/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2140/events", "html_url": "https://github.com/flairNLP/flair/issues/2140", "id": 825125545, "node_id": "MDU6SXNzdWU4MjUxMjU1NDU=", "number": 2140, "title": "The `multi-X-fast` embeddings appear to be missing", "user": {"login": "tadejmagajna", "id": 1088423, "node_id": "MDQ6VXNlcjEwODg0MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/1088423?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tadejmagajna", "html_url": "https://github.com/tadejmagajna", "followers_url": "https://api.github.com/users/tadejmagajna/followers", "following_url": "https://api.github.com/users/tadejmagajna/following{/other_user}", "gists_url": "https://api.github.com/users/tadejmagajna/gists{/gist_id}", "starred_url": "https://api.github.com/users/tadejmagajna/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tadejmagajna/subscriptions", "organizations_url": "https://api.github.com/users/tadejmagajna/orgs", "repos_url": "https://api.github.com/users/tadejmagajna/repos", "events_url": "https://api.github.com/users/tadejmagajna/events{/privacy}", "received_events_url": "https://api.github.com/users/tadejmagajna/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-03-09T01:03:17Z", "updated_at": "2021-03-14T19:29:10Z", "closed_at": "2021-03-14T19:29:10Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "While reviewing [documentation](https://github.com/flairNLP/flair/blob/master/resources/docs/embeddings/FLAIR_EMBEDDINGS.md) I noticed that `multi-X-fast` should be one of the available `FlairEmbeddings `, but they appear to be missing.\r\n\r\nFor example, when running:\r\n```python\r\nfrom flair.embeddings import FlairEmbeddings\r\nFlairEmbeddings(\"multi-forward-fast\")\r\n```\r\nI get:\r\n```\r\nValueError: The given model \"multi-forward-fast\" is not available or is not a valid path.\r\n```\r\nThis happened both on 0.7 and 0.8 versions of Flair.\r\n\r\nGiven that [here](https://github.com/flairNLP/flair/blob/69d7c7d523b9111956d6fecd781d0b4654a4b13a/flair/embeddings/token.py#L412) a version called `multi-v0-forward-fast` does exist, but no other similar versions exist in Flair's [model index](https://flair.informatik.hu-berlin.de/resources/embeddings/flair/), I would presume the model dictionary key simply needs to be renamed in the code from `multi-v0-forward-fast` to `multi-forward-fast`. Unless there is a v1 version that was never uploaded.\r\n\r\nHappy to open a PR for this.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2140/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2140/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2138", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2138/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2138/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2138/events", "html_url": "https://github.com/flairNLP/flair/issues/2138", "id": 824518904, "node_id": "MDU6SXNzdWU4MjQ1MTg5MDQ=", "number": 2138, "title": "RuntimeError when using flair 0.8 with Python 3.9", "user": {"login": "b2m", "id": 135298, "node_id": "MDQ6VXNlcjEzNTI5OA==", "avatar_url": "https://avatars.githubusercontent.com/u/135298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/b2m", "html_url": "https://github.com/b2m", "followers_url": "https://api.github.com/users/b2m/followers", "following_url": "https://api.github.com/users/b2m/following{/other_user}", "gists_url": "https://api.github.com/users/b2m/gists{/gist_id}", "starred_url": "https://api.github.com/users/b2m/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/b2m/subscriptions", "organizations_url": "https://api.github.com/users/b2m/orgs", "repos_url": "https://api.github.com/users/b2m/repos", "events_url": "https://api.github.com/users/b2m/events{/privacy}", "received_events_url": "https://api.github.com/users/b2m/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-03-08T12:36:30Z", "updated_at": "2021-03-14T20:46:02Z", "closed_at": "2021-03-14T20:46:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n\r\nRuntimeError when trying to use `flair==0.8` with Python 3.9.\r\n\r\n**To Reproduce**\r\n\r\nOn Windows using Powershell:\r\n\r\n```powershell\r\n$ python -m venv venv\r\n$ .\\venv\\Scripts\\activate\r\n$ python --version\r\n> Python 3.9.2\r\n$ pip install --no-cache-dir flair==0.8\r\n> ...\r\n$ python\r\n>>> from flair.data import Sentence\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"E:\\code\\flair\\venv\\lib\\site-packages\\flair\\__init__.py\", line 2, in <module>\r\n    import torch\r\n  File \"E:\\code\\flair\\venv\\lib\\site-packages\\torch\\__init__.py\", line 196, in <module>\r\n    from torch._C import *\r\nRuntimeError: module compiled against API version 0xe but this version of numpy is 0xd\r\n```\r\n\r\nOn Docker using bash in the `python:3.9` image:\r\n\r\n```bash\r\n$ python --version\r\n> 3.9.2\r\n$ pip install flair==0.8\r\n> ...\r\n$ python\r\n>>> from flair.data import Sentence\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/usr/local/lib/python3.9/site-packages/flair/__init__.py\", line 20, in <module>\r\n    from . import models\r\n  File \"/usr/local/lib/python3.9/site-packages/flair/models/__init__.py\", line 1, in <module>\r\n    from .sequence_tagger_model import SequenceTagger, MultiTagger\r\n  File \"/usr/local/lib/python3.9/site-packages/flair/models/sequence_tagger_model.py\", line 21, in <module>\r\n    from flair.embeddings import TokenEmbeddings, StackedEmbeddings, Embeddings\r\n  File \"/usr/local/lib/python3.9/site-packages/flair/embeddings/__init__.py\", line 6, in <module>\r\n    from .token import TokenEmbeddings\r\n  File \"/usr/local/lib/python3.9/site-packages/flair/embeddings/token.py\", line 13, in <module>\r\n    import gensim\r\n  File \"/usr/local/lib/python3.9/site-packages/gensim/__init__.py\", line 5, in <module>\r\n    from gensim import parsing, corpora, matutils, interfaces, models, similarities, summarization, utils  # noqa:F401\r\n  File \"/usr/local/lib/python3.9/site-packages/gensim/corpora/__init__.py\", line 6, in <module>\r\n    from .indexedcorpus import IndexedCorpus  # noqa:F401 must appear before the other classes\r\n  File \"/usr/local/lib/python3.9/site-packages/gensim/corpora/indexedcorpus.py\", line 15, in <module>\r\n    from gensim import interfaces, utils\r\n  File \"/usr/local/lib/python3.9/site-packages/gensim/interfaces.py\", line 21, in <module>\r\n    from gensim import utils, matutils\r\n  File \"/usr/local/lib/python3.9/site-packages/gensim/matutils.py\", line 1104, in <module>\r\n    from gensim._matutils import logsumexp, mean_absolute_difference, dirichlet_expectation\r\n  File \".eggs/Cython-0.29.14-py2.7-linux-x86_64.egg/Cython/Includes/numpy/__init__.pxd\", line 242, in init gensim._matutils\r\nValueError: numpy.ndarray size changed, may indicate binary incompatibility. Expected 88 from C header, got 80 from PyObject\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Windows 10 and Docker with `python:3.9` image.\r\n - Version: flair-0.8\r\n\r\n**Additional context**\r\n\r\n - I fixed this problem locally by installing `numpy==1.20.0` (instead of the required `1.19.0`).\r\n - Not reproducible with the Docker images `python:3.8`, `python:3.7` and `python:3.6`.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2138/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2138/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2137", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2137/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2137/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2137/events", "html_url": "https://github.com/flairNLP/flair/issues/2137", "id": 824384770, "node_id": "MDU6SXNzdWU4MjQzODQ3NzA=", "number": 2137, "title": "NER tagger error \"AttributeError: 'LSTM' object has no attribute 'proj_size' \"", "user": {"login": "codechannel", "id": 67317792, "node_id": "MDQ6VXNlcjY3MzE3Nzky", "avatar_url": "https://avatars.githubusercontent.com/u/67317792?v=4", "gravatar_id": "", "url": "https://api.github.com/users/codechannel", "html_url": "https://github.com/codechannel", "followers_url": "https://api.github.com/users/codechannel/followers", "following_url": "https://api.github.com/users/codechannel/following{/other_user}", "gists_url": "https://api.github.com/users/codechannel/gists{/gist_id}", "starred_url": "https://api.github.com/users/codechannel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/codechannel/subscriptions", "organizations_url": "https://api.github.com/users/codechannel/orgs", "repos_url": "https://api.github.com/users/codechannel/repos", "events_url": "https://api.github.com/users/codechannel/events{/privacy}", "received_events_url": "https://api.github.com/users/codechannel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 23, "created_at": "2021-03-08T09:47:36Z", "updated_at": "2021-11-14T05:59:07Z", "closed_at": "2021-07-21T08:46:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n`AttributeError: 'LSTM' object has no attribute 'proj_size'` while using NER tagger\r\n\r\n**To Reproduce**\r\nCreated new conda environment to test the new update.\r\n`pip install flair`\r\n\r\nTaking the example code:\r\n```\r\nfrom flair.data import Sentence\r\nfrom flair.models import SequenceTagger\r\n\r\n# make a sentence\r\nsentence = Sentence('I love Berlin .')\r\n\r\n# load the NER tagger\r\ntagger = SequenceTagger.load('ner')\r\n\r\n# run NER over sentence\r\ntagger.predict(sentence)\r\n```\r\n\r\n**Expected behavior**\r\nShould result in tags as explained in: https://github.com/flairNLP/flair instead throws an error\r\n\r\n**Environment (please complete the following information):**\r\n - OS [Ubuntu 18.04.]:\r\n - Version [flair-0.8]:\r\n\r\n\r\nThe update kinda broke my environment i.e. plenty of errors with tensorflow, torch, flair, etc. I had to create a new env to get started again. Got attribute error on trying with the fresh installation.\r\n\r\nAny suggestion on how to solve it?\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2137/reactions", "total_count": 5, "+1": 5, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2137/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2133", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2133/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2133/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2133/events", "html_url": "https://github.com/flairNLP/flair/issues/2133", "id": 821194634, "node_id": "MDU6SXNzdWU4MjExOTQ2MzQ=", "number": 2133, "title": "Logging to stderr instead of stdout", "user": {"login": "compwiztobe", "id": 6405013, "node_id": "MDQ6VXNlcjY0MDUwMTM=", "avatar_url": "https://avatars.githubusercontent.com/u/6405013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compwiztobe", "html_url": "https://github.com/compwiztobe", "followers_url": "https://api.github.com/users/compwiztobe/followers", "following_url": "https://api.github.com/users/compwiztobe/following{/other_user}", "gists_url": "https://api.github.com/users/compwiztobe/gists{/gist_id}", "starred_url": "https://api.github.com/users/compwiztobe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compwiztobe/subscriptions", "organizations_url": "https://api.github.com/users/compwiztobe/orgs", "repos_url": "https://api.github.com/users/compwiztobe/repos", "events_url": "https://api.github.com/users/compwiztobe/events{/privacy}", "received_events_url": "https://api.github.com/users/compwiztobe/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-03-03T15:05:16Z", "updated_at": "2021-07-09T00:24:17Z", "closed_at": "2021-07-09T00:24:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "Importing Flair code, and loading and applying, for example, tagging models, expecting to be able to read from stdin and write to stdout like a good Unix tool runs into issues with Flair's default logging interrupting stdout.\r\n\r\nhttps://github.com/flairNLP/flair/blob/master/flair/__init__.py#L40 sets the default logger to write to stdout, but should this not be `ext://sys.stderr` instead?\r\n\r\nTo reproduce:\r\n\r\ntag.py\r\n```\r\nfrom flair.models import SequenceTagger\r\n\r\nimport sys\r\n\r\ntagger = SequenceTagger.load([model path])\r\n\r\nfor line in sys.stdin:\r\n  sentence = Sentence(line.strip())\r\n  tagger.predict(sentence)\r\n  print(sentence.to_tagged_string())\r\n```\r\n\r\nThen\r\n```\r\npython tag.py < input > output\r\n```\r\nor similar with Unix pipes includes the logging line in the output file, instead of printing to stderr on console (or to file as redirected by `2>`).\r\n\r\nThis can be fixed by calling\r\n```\r\nimport logging\r\nlogging.getLogger('flair').handlers[0].stream = sys.stderr\r\n```\r\nafter importing flair, but it seems that maybe this should be the default behavior?", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2133/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2133/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2122", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2122/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2122/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2122/events", "html_url": "https://github.com/flairNLP/flair/issues/2122", "id": 817438848, "node_id": "MDU6SXNzdWU4MTc0Mzg4NDg=", "number": 2122, "title": "Runing the TARS classifier fails with Attempted to read a PyTorch file with version 3, but the maximum supported version for reading is 2.", "user": {"login": "eddsalkield", "id": 30939717, "node_id": "MDQ6VXNlcjMwOTM5NzE3", "avatar_url": "https://avatars.githubusercontent.com/u/30939717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eddsalkield", "html_url": "https://github.com/eddsalkield", "followers_url": "https://api.github.com/users/eddsalkield/followers", "following_url": "https://api.github.com/users/eddsalkield/following{/other_user}", "gists_url": "https://api.github.com/users/eddsalkield/gists{/gist_id}", "starred_url": "https://api.github.com/users/eddsalkield/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eddsalkield/subscriptions", "organizations_url": "https://api.github.com/users/eddsalkield/orgs", "repos_url": "https://api.github.com/users/eddsalkield/repos", "events_url": "https://api.github.com/users/eddsalkield/events{/privacy}", "received_events_url": "https://api.github.com/users/eddsalkield/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-02-26T15:15:54Z", "updated_at": "2021-02-26T21:17:01Z", "closed_at": "2021-02-26T21:17:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhen running the [zero-shot TARS example](https://github.com/flairNLP/flair/blob/master/resources/docs/TUTORIAL_10_TRAINING_ZERO_SHOT_MODEL.md#use-case-1-classify-text-without-training-data-zero-shot), flair fails with the following output:\r\n\r\n```\r\n2021-02-26 15:03:56,837 https://nlp.informatik.hu-berlin.de/resources/models/tars-base/tars-base.pt not found in cache, downloading to /tmp/tmpq6sg4qze\r\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 438079177/438079177 [00:14<00:00, 30639589.46B/s]\r\n2021-02-26 15:04:11,232 copying /tmp/tmpq6sg4qze to cache at /home/edd/.flair/models/tars-base.pt\r\n2021-02-26 15:04:11,916 removing temp file /tmp/tmpq6sg4qze\r\n2021-02-26 15:04:12,013 loading file /home/edd/.flair/models/tars-base.pt\r\nTraceback (most recent call last):\r\n  File \"tars_classifier.py\", line 5, in <module>\r\n    tars = TARSClassifier.load('tars-base')\r\n  File \"/home/edd/.cache/pypoetry/virtualenvs/atc-processing--a3Jf3Pl-py3.6/lib/python3.6/site-packages/flair/nn.py\", line 88, in load\r\n    state = torch.load(f, map_location='cpu')\r\n  File \"/home/edd/.cache/pypoetry/virtualenvs/atc-processing--a3Jf3Pl-py3.6/lib/python3.6/site-packages/torch/serialization.py\", line 527, in load\r\n    with _open_zipfile_reader(f) as opened_zipfile:\r\n  File \"/home/edd/.cache/pypoetry/virtualenvs/atc-processing--a3Jf3Pl-py3.6/lib/python3.6/site-packages/torch/serialization.py\", line 224, in __init__\r\n    super(_open_zipfile_reader, self).__init__(torch._C.PyTorchFileReader(name_or_buffer))\r\nRuntimeError: version_ <= kMaxSupportedFileFormatVersion INTERNAL ASSERT FAILED at /pytorch/caffe2/serialize/inline_container.cc:132, please report a bug to PyTorch. Attempted to read a PyTorch file with version 3, but the maximum supported version for reading is 2. Your PyTorch installation may be too old. (init at /pytorch/caffe2/serialize/inline_container.cc:132)\r\nframe #0: c10::Error::Error(c10::SourceLocation, std::string const&) + 0x33 (0x7f79d2e56193 in /home/edd/.cache/pypoetry/virtualenvs/atc-processing--a3Jf3Pl-py3.6/lib/python3.6/site-packages/torch/lib/libc10.so)\r\nframe #1: caffe2::serialize::PyTorchStreamReader::init() + 0x1f5b (0x7f783e1e89eb in /home/edd/.cache/pypoetry/virtualenvs/atc-processing--a3Jf3Pl-py3.6/lib/python3.6/site-packages/torch/lib/libtorch.so)\r\nframe #2: caffe2::serialize::PyTorchStreamReader::PyTorchStreamReader(std::unique_ptr<caffe2::serialize::ReadAdapterInterface, std::default_delete<caffe2::serialize::ReadAdapterInterface> >) + 0x57 (0x7f783e1e9b37 in /home/edd/.cache/pypoetry/virtualenvs/atc-processing--a3Jf3Pl-py3.6/lib/python3.6/site-packages/torch/lib/libtorch.so)\r\nframe #3: <unknown function> + 0x6a7685 (0x7f79d3ee1685 in /home/edd/.cache/pypoetry/virtualenvs/atc-processing--a3Jf3Pl-py3.6/lib/python3.6/site-packages/torch/lib/libtorch_python.so)\r\nframe #4: <unknown function> + 0x2961c4 (0x7f79d3ad01c4 in /home/edd/.cache/pypoetry/virtualenvs/atc-processing--a3Jf3Pl-py3.6/lib/python3.6/site-packages/torch/lib/libtorch_python.so)\r\n<omitting python frames>\r\nframe #6: python3() [0x595291]\r\nframe #7: python3() [0x549ce5]\r\nframe #8: python3() [0x551391]\r\nframe #10: python3() [0x50a533]\r\nframe #12: python3() [0x507cd4]\r\nframe #14: python3() [0x595221]\r\nframe #15: python3() [0x549b3f]\r\nframe #16: python3() [0x551391]\r\nframe #18: python3() [0x50a533]\r\nframe #20: python3() [0x507cd4]\r\nframe #21: python3() [0x509a00]\r\nframe #22: python3() [0x50a3fd]\r\nframe #24: python3() [0x5096c8]\r\nframe #25: python3() [0x50a3fd]\r\nframe #27: python3() [0x507cd4]\r\nframe #29: python3() [0x635262]\r\nframe #34: __libc_start_main + 0xe7 (0x7f79d983cb97 in /lib/x86_64-linux-gnu/libc.so.6)\r\n```\r\n\r\n**To Reproduce**\r\nInstall flair 0.7 in a venv (I used poetry), and run the example code from the docs.\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Ubuntu 18.04.4 LTS, kernel 5.4.0\r\n - Version: flair-0.7", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2122/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2122/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2111", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2111/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2111/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2111/events", "html_url": "https://github.com/flairNLP/flair/issues/2111", "id": 812953102, "node_id": "MDU6SXNzdWU4MTI5NTMxMDI=", "number": 2111, "title": "Training stalls after 4 splits ", "user": {"login": "eh-93", "id": 10990339, "node_id": "MDQ6VXNlcjEwOTkwMzM5", "avatar_url": "https://avatars.githubusercontent.com/u/10990339?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eh-93", "html_url": "https://github.com/eh-93", "followers_url": "https://api.github.com/users/eh-93/followers", "following_url": "https://api.github.com/users/eh-93/following{/other_user}", "gists_url": "https://api.github.com/users/eh-93/gists{/gist_id}", "starred_url": "https://api.github.com/users/eh-93/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eh-93/subscriptions", "organizations_url": "https://api.github.com/users/eh-93/orgs", "repos_url": "https://api.github.com/users/eh-93/repos", "events_url": "https://api.github.com/users/eh-93/events{/privacy}", "received_events_url": "https://api.github.com/users/eh-93/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-02-21T21:17:13Z", "updated_at": "2021-02-21T23:59:01Z", "closed_at": "2021-02-21T23:58:48Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nTraining stalls after 4 splits, if I stop the training and resume, it'll pick up from where it last left off for another 4 splits then stop. My training data is split into 1000 files, each is ~2MB. I've tried playing around with the batch size but that doesn't seem to help. Any ideas on how I can debug this further anything from the below script that might be causing it? \r\n\r\n**To Reproduce**\r\n```\r\n# Params\r\nis_forward_lm = True\r\nhidden_size = 1028\r\nnlayers = 2\r\nsequence_length = 250\r\nmini_batch_size = 256\r\nmax_epochs = 1\r\n\r\n# Inputs\r\ncorpus_path = \"./corpus\"\r\nchar_file = \"corpus/char_mappings\"\r\nmodel_name = \"forward_model\" if is_forward_lm else \"backward_model\"\r\noutput_path = f\"models/{model_name}\"\r\nnew_model = False if os.path.exists(output_path) else True\r\n\r\n# Character embeddings\r\ndictionary = Dictionary.load_from_file(char_file)\r\n\r\n# get your corpus, process forward and at the character level\r\ncorpus = TextCorpus(\r\n    Path(corpus_path), \r\n    dictionary, \r\n    is_forward_lm, \r\n    character_level=True\r\n).downsample(0.1)\r\n\r\n# instantiate your language model, set hidden size and number of layers\r\nlanguage_model = LanguageModel(\r\n    dictionary, a\r\n    is_forward_lm, \r\n    hidden_size=hidden_size, \r\n    nlayers=nlayers\r\n)\r\n\r\n# train your language model\r\ntrainer = LanguageModelTrainer(language_model, corpus)\r\n\r\nif new_model:\r\n    print(\"Training new model\")\r\n    trainer.train(\r\n        output_path,\r\n        sequence_length=sequence_length,\r\n        mini_batch_size=mini_batch_size,\r\n        max_epochs=max_epochs,\r\n        checkpoint=True,\r\n    )\r\nelse:\r\n    print(\"Resuming Training\")\r\n    checkpoint_path = Path(f\"{output_path}/checkpoint.pt\")\r\n    trainer = LanguageModelTrainer.load_from_checkpoint(checkpoint_path, corpus)\r\n    trainer.train(\r\n        output_path,\r\n        sequence_length=sequence_length,\r\n        mini_batch_size=mini_batch_size,\r\n        max_epochs=max_epochs,\r\n        checkpoint=True,\r\n    )\r\n```\r\n**Logs**\r\n\r\n```\r\n2021-02-21 21:05:01,374 read text file with 100000 lines\r\n2021-02-21 21:05:54,639 read text file with 100000 lines\r\nResuming Training\r\n2021-02-21 21:06:51,287 read text file with 89544 lines\r\n2021-02-21 21:06:51,317 shuffled\r\n2021-02-21 21:06:51,364 read text file with 271791 lines\r\n2021-02-21 21:06:51,463 shuffled\r\n2021-02-21 21:07:08,570 read text file with 560 lines\r\n2021-02-21 21:07:08,571 shuffled\r\n2021-02-21 21:07:40,580 read text file with 1896 lines\r\n2021-02-21 21:07:40,584 shuffled\r\n2021-02-21 21:07:40,589 Sequence length is 250\r\n2021-02-21 21:07:40,627 Split 17\t - (21:07:40)\r\n2021-02-21 21:07:45,253 read text file with 2739287 lines\r\n2021-02-21 21:07:46,552 shuffled\r\n2021-02-21 21:08:36,726 56 seconds for train split 17\r\n2021-02-21 21:08:53,530 best loss so far  2.39\r\n2021-02-21 21:08:54,481 -----------------------------------------------------------------------------------------\r\n2021-02-21 21:08:54,482 | end of split  17 /1000 | epoch   1 | time: 73.89s | valid loss  2.43 | valid ppl    11.38 | learning rate 20.0000\r\n2021-02-21 21:08:54,482 -----------------------------------------------------------------------------------------\r\n2021-02-21 21:08:54,488 Sequence length is 250\r\n2021-02-21 21:08:54,502 Split 18\t - (21:08:54)\r\n2021-02-21 21:09:01,169 read text file with 6189067 lines\r\n2021-02-21 21:09:04,315 shuffled\r\n2021-02-21 21:09:14,479 19 seconds for train split 18\r\n2021-02-21 21:09:31,425 best loss so far  2.39\r\n2021-02-21 21:09:32,366 -----------------------------------------------------------------------------------------\r\n2021-02-21 21:09:32,367 | end of split  18 /1000 | epoch   1 | time: 37.88s | valid loss  2.41 | valid ppl    11.17 | learning rate 20.0000\r\n2021-02-21 21:09:32,367 -----------------------------------------------------------------------------------------\r\n2021-02-21 21:09:32,400 Sequence length is 250\r\n2021-02-21 21:09:32,402 Split 19\t - (21:09:32)\r\n2021-02-21 21:09:33,722 1 seconds for train split 19\r\n2021-02-21 21:09:50,690 best loss so far  2.39\r\n2021-02-21 21:09:51,782 -----------------------------------------------------------------------------------------\r\n2021-02-21 21:09:51,782 | end of split  19 /1000 | epoch   1 | time: 19.38s | valid loss  2.38 | valid ppl    10.85 | learning rate 20.0000\r\n2021-02-21 21:09:51,783 -----------------------------------------------------------------------------------------\r\n2021-02-21 21:09:51,783 Sequence length is 250\r\n2021-02-21 21:09:51,784 Split 20\t - (21:09:51)\r\n2021-02-21 21:09:52,291 0 seconds for train split 20\r\n2021-02-21 21:10:09,282 best loss so far  2.38\r\n2021-02-21 21:10:10,222 -----------------------------------------------------------------------------------------\r\n2021-02-21 21:10:10,223 | end of split  20 /1000 | epoch   1 | time: 18.44s | valid loss  2.47 | valid ppl    11.81 | learning rate 20.0000\r\n2021-02-21 21:10:10,223 -----------------------------------------------------------------------------------------\r\n\r\nFrom this point training just hangs - RAM is at 17/32 GB and the GPU Ram is 23/24 GB, no errors or signs of any issues in terms of the system performance.\r\n\r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 460.39       Driver Version: 460.39       CUDA Version: 11.2     |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|                               |                      |               MIG M. |\r\n|===============================+======================+======================|\r\n|   0  GeForce RTX 3090    Off  | 00000000:08:00.0 Off |                  N/A |\r\n| 54%   47C    P8    37W / 390W |  23859MiB / 24265MiB |      0%      Default |\r\n|                               |                      |                  N/A |\r\n+-------------------------------+----------------------+----------------------+\r\n\r\n```\r\n\r\nIf I stop the script, it shuts down gracefully with a message: \"Exiting from training early\"\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - Linux Ubuntu 20\r\n - Python 3.8.5\r\n - Flair 0.7\r\n - Nvidia RTX 3090 - 32 GB RAM - AMD 3090X\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2111/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2111/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2109", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2109/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2109/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2109/events", "html_url": "https://github.com/flairNLP/flair/issues/2109", "id": 810201746, "node_id": "MDU6SXNzdWU4MTAyMDE3NDY=", "number": 2109, "title": "Error when using 'sentiment': ModuleNotFoundError: No module named 'transformers.modeling_distilbert'", "user": {"login": "ftrias", "id": 6515618, "node_id": "MDQ6VXNlcjY1MTU2MTg=", "avatar_url": "https://avatars.githubusercontent.com/u/6515618?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ftrias", "html_url": "https://github.com/ftrias", "followers_url": "https://api.github.com/users/ftrias/followers", "following_url": "https://api.github.com/users/ftrias/following{/other_user}", "gists_url": "https://api.github.com/users/ftrias/gists{/gist_id}", "starred_url": "https://api.github.com/users/ftrias/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ftrias/subscriptions", "organizations_url": "https://api.github.com/users/ftrias/orgs", "repos_url": "https://api.github.com/users/ftrias/repos", "events_url": "https://api.github.com/users/ftrias/events{/privacy}", "received_events_url": "https://api.github.com/users/ftrias/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2021-02-17T13:50:05Z", "updated_at": "2021-11-29T00:57:41Z", "closed_at": "2021-11-29T00:57:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have a clean install (Feb 16) of Flair. Using this code directly from  the tutorial:\r\n\r\n```python\r\nfrom flair.models import TextClassifier\r\nclassifier = TextClassifier.load('sentiment')\r\nsentence = Sentence(\"enormously entertaining for moviegoers of any age .\")\r\nclassifier.predict(sentence)\r\nprint(sentence)\r\n```\r\n\r\nI get the following error:\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nModuleNotFoundError                       Traceback (most recent call last)\r\n<ipython-input-9-bf2c8f4f80e8> in <module>\r\n      2 # import transformers.models.distilbert\r\n      3 \r\n----> 4 classifier = TextClassifier.load('sentiment')\r\n      5 \r\n      6 # predict for example sentence\r\n\r\n~/opt/anaconda3/envs/thesis/lib/python3.9/site-packages/flair/nn.py in load(cls, model)\r\n     86             # see https://github.com/zalandoresearch/flair/issues/351\r\n     87             f = file_utils.load_big_file(str(model_file))\r\n---> 88             state = torch.load(f, map_location='cpu')\r\n     89 \r\n     90         model = cls._init_model_with_state_dict(state)\r\n\r\n~/opt/anaconda3/envs/thesis/lib/python3.9/site-packages/torch/serialization.py in load(f, map_location, pickle_module, **pickle_load_args)\r\n    592                     opened_file.seek(orig_position)\r\n    593                     return torch.jit.load(opened_file)\r\n--> 594                 return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)\r\n    595         return _legacy_load(opened_file, map_location, pickle_module, **pickle_load_args)\r\n    596 \r\n\r\n~/opt/anaconda3/envs/thesis/lib/python3.9/site-packages/torch/serialization.py in _load(zip_file, map_location, pickle_module, pickle_file, **pickle_load_args)\r\n    851     unpickler = pickle_module.Unpickler(data_file, **pickle_load_args)\r\n    852     unpickler.persistent_load = persistent_load\r\n--> 853     result = unpickler.load()\r\n    854 \r\n    855     torch._utils._validate_loaded_sparse_tensors()\r\n\r\nModuleNotFoundError: No module named 'transformers.modeling_distilbert'\r\n```\r\n\r\nUsing MacOS 11.2.1 with Anaconda Python 3.9.1\r\n\r\nIt appears that the `transfomers` module was reorganized on  16 Nov 2020 #8580 (https://github.com/huggingface/transformers/commit/c89bdfbe720bc8f41c7dc6db5473a2cb0955f224#diff-550edeb1fa88e111752fd13ba725609f25858d5729dfe10b9773918bc1e974a1) but the downloaded model pickle files use the previous module organization.\r\n\r\nI tried installing the previous version of transformers (3.5.0) but it fails with a dependency error:\r\n\r\n```\r\n$ pip install -Iv transformers==3.5.0\r\n...\r\nERROR: Could not find a version that satisfies the requirement sentencepiece==0.1.91 (from transformers)\r\nERROR: No matching distribution found for sentencepiece==0.1.91\r\n```\r\n\r\nInstalling 3.4.0 of `transformers` fails when compiling `tokenizers` with `rustc`. Installing 3.3.0 of `transformers` succeeds in compiling, but executing the code at the top generates:\r\n\r\n```\r\nImportError: cannot import name '_BaseLazyModule' from 'transformers.file_utils' (/Users/ftrias/opt/anaconda3/envs/thesis/lib/python3.9/site-packages/transformers/file_utils.py)\r\n```", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2109/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2109/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2081", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2081/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2081/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2081/events", "html_url": "https://github.com/flairNLP/flair/issues/2081", "id": 793441917, "node_id": "MDU6SXNzdWU3OTM0NDE5MTc=", "number": 2081, "title": "The size of tensor a (759) must match the size of tensor b (512) at non-singleton dimension 1", "user": {"login": "abeermohamed1", "id": 20182641, "node_id": "MDQ6VXNlcjIwMTgyNjQx", "avatar_url": "https://avatars.githubusercontent.com/u/20182641?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abeermohamed1", "html_url": "https://github.com/abeermohamed1", "followers_url": "https://api.github.com/users/abeermohamed1/followers", "following_url": "https://api.github.com/users/abeermohamed1/following{/other_user}", "gists_url": "https://api.github.com/users/abeermohamed1/gists{/gist_id}", "starred_url": "https://api.github.com/users/abeermohamed1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abeermohamed1/subscriptions", "organizations_url": "https://api.github.com/users/abeermohamed1/orgs", "repos_url": "https://api.github.com/users/abeermohamed1/repos", "events_url": "https://api.github.com/users/abeermohamed1/events{/privacy}", "received_events_url": "https://api.github.com/users/abeermohamed1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-01-25T14:44:59Z", "updated_at": "2021-06-04T07:53:32Z", "closed_at": "2021-06-04T07:53:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nerror after finishing the learning, that The size of tensor a (759) must match the size of tensor b (512) at non-singleton dimension 1\r\n**To Reproduce**\r\nfrom flair.data import Corpus\r\nimport gensim\r\n\r\nfrom flair.embeddings import FastTextEmbeddings,TokenEmbeddings, CharacterEmbeddings,  WordEmbeddings, StackedEmbeddings, PooledFlairEmbeddings,FlairEmbeddings,DocumentPoolEmbeddings,XLNetEmbeddings, TransformerWordEmbeddings\r\nfrom typing import List\r\nfrom flair.data import Dictionary\r\nfrom flair.models import LanguageModel\r\nfrom flair.trainers.language_model_trainer import LanguageModelTrainer, TextCorpus\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import ColumnCorpus\r\nfrom flair.embeddings import BertEmbeddings\r\nimport re\r\nimport numpy as np\r\nfrom nltk import ngrams\r\n\r\n# define columns\r\ncolumns = {0: 'text', 1: 'ner'}\r\n\r\n# this is the folder in which train, test and dev files reside\r\n#data_folder = '/content/gdrive/My Drive/resources/tasks/conll_03'\r\n\r\n#Mohamed Hosny drive\r\ndata_folder = '/content/gdrive/My Drive/conll_03'\r\n\r\n\r\n# init a corpus using column format, data folder and the names of the train, dev and test files\r\ncorpus: Corpus = ColumnCorpus(data_folder, columns,\r\n                              train_file='train.txt',\r\n                              test_file='ANERCorp1.txt',\r\n                              dev_file='dev.txt', document_separator_token='.')\r\n    \r\n    #document_separator_token\r\n\r\n# 2. what tag do we want to predict?\r\ntag_type = 'ner'\r\n\r\n# 3. make the tag dictionary from the corpus\r\ntag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\n\r\nembedding_types: List[TokenEmbeddings] = [\r\n\r\n       BertEmbeddings(bert_model_or_path = data_folder),\r\n    \r\n    WordEmbeddings('ar'),\r\n    # contextual string embeddings, forward\r\n    PooledFlairEmbeddings('ar-forward',  pooling= 'mean'),\r\n    # contextual string embeddings, backward\r\n    PooledFlairEmbeddings('ar-backward' ,  pooling= 'mean'),\r\n]\r\n\r\nembeddings: StackedEmbeddings = StackedEmbeddings(embeddings=embedding_types)\r\n\r\n\r\n# initialize sequence tagger\r\nfrom flair.models import SequenceTagger\r\n\r\ntagger: SequenceTagger = SequenceTagger(hidden_size=256,\r\n                                        embeddings=embeddings,\r\n                                        tag_dictionary=tag_dictionary,\r\n                                        tag_type=tag_type  )\r\n\r\n# initialize trainer\r\nfrom flair.trainers import ModelTrainer\r\nfrom torch.optim.adam import Adam\r\ntrainer: ModelTrainer = ModelTrainer(tagger, corpus)\r\n                                        \r\n                            \r\nimport pickle\r\n\r\ntrainer.train('/content/gdrive/My Drive/resources/taggers/example-ner',\r\n              train_with_dev=True, \r\n              learning_rate=0.1,   \r\n              mini_batch_size=16,\r\n              max_epochs=150,\r\n              checkpoint=True)\r\n\r\n\r\n\r\n**Expected behavior**\r\nA clear and concise description of what you expected to happen.\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]:\r\n - Version [e.g. flair-0.3.2]:\r\n\r\n**Additional context**\r\n2021-01-25 10:20:06,873 Reading data from /content/gdrive/My Drive/conll_03\r\n2021-01-25 10:20:06,874 Train: /content/gdrive/My Drive/conll_03/train.txt\r\n2021-01-25 10:20:06,875 Dev: /content/gdrive/My Drive/conll_03/dev.txt\r\n2021-01-25 10:20:06,877 Test: /content/gdrive/My Drive/conll_03/ANERCorp1.txt\r\n/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:51: DeprecationWarning: Call to deprecated method __init__. (Use 'TransformerWordEmbeddings' for all transformer-based word embeddings) -- Deprecated since version 0.4.5.\r\n2021-01-25 10:20:23,186 https://flair.informatik.hu-berlin.de/resources/embeddings/token/ar-wiki-fasttext-300d-1M.vectors.npy not found in cache, downloading to /tmp/tmpczjlv6g1\r\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 733171328/733171328 [00:39<00:00, 18608720.99B/s]2021-01-25 10:21:03,151 copying /tmp/tmpczjlv6g1 to cache at /root/.flair/embeddings/ar-wiki-fasttext-300d-1M.vectors.npy\r\n\r\n2021-01-25 10:21:04,898 removing temp file /tmp/tmpczjlv6g1\r\n2021-01-25 10:21:05,622 https://flair.informatik.hu-berlin.de/resources/embeddings/token/ar-wiki-fasttext-300d-1M not found in cache, downloading to /tmp/tmp080tb_mh\r\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 26704903/26704903 [00:02<00:00, 9476531.62B/s]2021-01-25 10:21:08,904 copying /tmp/tmp080tb_mh to cache at /root/.flair/embeddings/ar-wiki-fasttext-300d-1M\r\n2021-01-25 10:21:08,939 removing temp file /tmp/tmp080tb_mh\r\n\r\n2021-01-25 10:21:12,601 https://flair.informatik.hu-berlin.de/resources/embeddings/flair/lm-ar-opus-large-forward-v0.1.pt not found in cache, downloading to /tmp/tmp3m378k3p\r\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 131796801/131796801 [00:08<00:00, 16369873.12B/s]2021-01-25 10:21:21,166 copying /tmp/tmp3m378k3p to cache at /root/.flair/embeddings/lm-ar-opus-large-forward-v0.1.pt\r\n\r\n2021-01-25 10:21:21,322 removing temp file /tmp/tmp3m378k3p\r\n2021-01-25 10:21:41,045 https://flair.informatik.hu-berlin.de/resources/embeddings/flair/lm-ar-opus-large-backward-v0.1.pt not found in cache, downloading to /tmp/tmplcvwbl5h\r\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 131796811/131796811 [00:08<00:00, 16242622.50B/s]2021-01-25 10:21:49,763 copying /tmp/tmplcvwbl5h to cache at /root/.flair/embeddings/lm-ar-opus-large-backward-v0.1.pt\r\n\r\n2021-01-25 10:21:49,912 removing temp file /tmp/tmplcvwbl5h\r\n2021-01-25 10:21:56,225 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 10:21:56,229 Model: \"SequenceTagger(\r\n  (embeddings): StackedEmbeddings(\r\n    (list_embedding_0): BertEmbeddings(\r\n      (model): BertModel(\r\n        (embeddings): BertEmbeddings(\r\n          (word_embeddings): Embedding(64000, 768, padding_idx=0)\r\n          (position_embeddings): Embedding(512, 768)\r\n          (token_type_embeddings): Embedding(2, 768)\r\n          (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\r\n          (dropout): Dropout(p=0.1, inplace=False)\r\n        )\r\n        (encoder): BertEncoder(\r\n          (layer): ModuleList(\r\n            (0): BertLayer(\r\n              (attention): BertAttention(\r\n                (self): BertSelfAttention(\r\n                  (query): Linear(in_features=768, out_features=768, bias=True)\r\n                  (key): Linear(in_features=768, out_features=768, bias=True)\r\n                  (value): Linear(in_features=768, out_features=768, bias=True)\r\n                  (dropout): Dropout(p=0.1, inplace=False)\r\n                )\r\n                (output): BertSelfOutput(\r\n                  (dense): Linear(in_features=768, out_features=768, bias=True)\r\n                  (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\r\n                  (dropout): Dropout(p=0.1, inplace=False)\r\n                )\r\n              )\r\n              (intermediate): BertIntermediate(\r\n                (dense): Linear(in_features=768, out_features=3072, bias=True)\r\n              )\r\n              (output): BertOutput(\r\n                (dense): Linear(in_features=3072, out_features=768, bias=True)\r\n                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\r\n                (dropout): Dropout(p=0.1, inplace=False)\r\n              )\r\n            )\r\n            (1): BertLayer(\r\n              (attention): BertAttention(\r\n                (self): BertSelfAttention(\r\n                  (query): Linear(in_features=768, out_features=768, bias=True)\r\n                  (key): Linear(in_features=768, out_features=768, bias=True)\r\n                  (value): Linear(in_features=768, out_features=768, bias=True)\r\n                  (dropout): Dropout(p=0.1, inplace=False)\r\n                )\r\n                (output): BertSelfOutput(\r\n                  (dense): Linear(in_features=768, out_features=768, bias=True)\r\n                  (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\r\n                  (dropout): Dropout(p=0.1, inplace=False)\r\n                )\r\n              )\r\n              (intermediate): BertIntermediate(\r\n                (dense): Linear(in_features=768, out_features=3072, bias=True)\r\n              )\r\n              (output): BertOutput(\r\n                (dense): Linear(in_features=3072, out_features=768, bias=True)\r\n                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\r\n                (dropout): Dropout(p=0.1, inplace=False)\r\n              )\r\n            )\r\n            (2): BertLayer(\r\n              (attention): BertAttention(\r\n                (self): BertSelfAttention(\r\n                  (query): Linear(in_features=768, out_features=768, bias=True)\r\n                  (key): Linear(in_features=768, out_features=768, bias=True)\r\n                  (value): Linear(in_features=768, out_features=768, bias=True)\r\n                  (dropout): Dropout(p=0.1, inplace=False)\r\n                )\r\n                (output): BertSelfOutput(\r\n                  (dense): Linear(in_features=768, out_features=768, bias=True)\r\n                  (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\r\n                  (dropout): Dropout(p=0.1, inplace=False)\r\n                )\r\n              )\r\n              (intermediate): BertIntermediate(\r\n                (dense): Linear(in_features=768, out_features=3072, bias=True)\r\n              )\r\n              (output): BertOutput(\r\n                (dense): Linear(in_features=3072, out_features=768, bias=True)\r\n                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\r\n                (dropout): Dropout(p=0.1, inplace=False)\r\n              )\r\n            )\r\n            (3): BertLayer(\r\n              (attention): BertAttention(\r\n                (self): BertSelfAttention(\r\n                  (query): Linear(in_features=768, out_features=768, bias=True)\r\n                  (key): Linear(in_features=768, out_features=768, bias=True)\r\n                  (value): Linear(in_features=768, out_features=768, bias=True)\r\n                  (dropout): Dropout(p=0.1, inplace=False)\r\n                )\r\n                (output): BertSelfOutput(\r\n                  (dense): Linear(in_features=768, out_features=768, bias=True)\r\n                  (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\r\n                  (dropout): Dropout(p=0.1, inplace=False)\r\n                )\r\n              )\r\n              (intermediate): BertIntermediate(\r\n                (dense): Linear(in_features=768, out_features=3072, bias=True)\r\n              )\r\n              (output): BertOutput(\r\n                (dense): Linear(in_features=3072, out_features=768, bias=True)\r\n                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\r\n                (dropout): Dropout(p=0.1, inplace=False)\r\n              )\r\n            )\r\n            (4): BertLayer(\r\n              (attention): BertAttention(\r\n                (self): BertSelfAttention(\r\n                  (query): Linear(in_features=768, out_features=768, bias=True)\r\n                  (key): Linear(in_features=768, out_features=768, bias=True)\r\n                  (value): Linear(in_features=768, out_features=768, bias=True)\r\n                  (dropout): Dropout(p=0.1, inplace=False)\r\n                )\r\n                (output): BertSelfOutput(\r\n                  (dense): Linear(in_features=768, out_features=768, bias=True)\r\n                  (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\r\n                  (dropout): Dropout(p=0.1, inplace=False)\r\n                )\r\n              )\r\n              (intermediate): BertIntermediate(\r\n                (dense): Linear(in_features=768, out_features=3072, bias=True)\r\n              )\r\n              (output): BertOutput(\r\n                (dense): Linear(in_features=3072, out_features=768, bias=True)\r\n                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\r\n                (dropout): Dropout(p=0.1, inplace=False)\r\n              )\r\n            )\r\n            (5): BertLayer(\r\n              (attention): BertAttention(\r\n                (self): BertSelfAttention(\r\n                  (query): Linear(in_features=768, out_features=768, bias=True)\r\n                  (key): Linear(in_features=768, out_features=768, bias=True)\r\n                  (value): Linear(in_features=768, out_features=768, bias=True)\r\n                  (dropout): Dropout(p=0.1, inplace=False)\r\n                )\r\n                (output): BertSelfOutput(\r\n                  (dense): Linear(in_features=768, out_features=768, bias=True)\r\n                  (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\r\n                  (dropout): Dropout(p=0.1, inplace=False)\r\n                )\r\n              )\r\n              (intermediate): BertIntermediate(\r\n                (dense): Linear(in_features=768, out_features=3072, bias=True)\r\n              )\r\n              (output): BertOutput(\r\n                (dense): Linear(in_features=3072, out_features=768, bias=True)\r\n                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\r\n                (dropout): Dropout(p=0.1, inplace=False)\r\n              )\r\n            )\r\n            (6): BertLayer(\r\n              (attention): BertAttention(\r\n                (self): BertSelfAttention(\r\n                  (query): Linear(in_features=768, out_features=768, bias=True)\r\n                  (key): Linear(in_features=768, out_features=768, bias=True)\r\n                  (value): Linear(in_features=768, out_features=768, bias=True)\r\n                  (dropout): Dropout(p=0.1, inplace=False)\r\n                )\r\n                (output): BertSelfOutput(\r\n                  (dense): Linear(in_features=768, out_features=768, bias=True)\r\n                  (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\r\n                  (dropout): Dropout(p=0.1, inplace=False)\r\n                )\r\n              )\r\n              (intermediate): BertIntermediate(\r\n                (dense): Linear(in_features=768, out_features=3072, bias=True)\r\n              )\r\n              (output): BertOutput(\r\n                (dense): Linear(in_features=3072, out_features=768, bias=True)\r\n                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\r\n                (dropout): Dropout(p=0.1, inplace=False)\r\n              )\r\n            )\r\n            (7): BertLayer(\r\n              (attention): BertAttention(\r\n                (self): BertSelfAttention(\r\n                  (query): Linear(in_features=768, out_features=768, bias=True)\r\n                  (key): Linear(in_features=768, out_features=768, bias=True)\r\n                  (value): Linear(in_features=768, out_features=768, bias=True)\r\n                  (dropout): Dropout(p=0.1, inplace=False)\r\n                )\r\n                (output): BertSelfOutput(\r\n                  (dense): Linear(in_features=768, out_features=768, bias=True)\r\n                  (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\r\n                  (dropout): Dropout(p=0.1, inplace=False)\r\n                )\r\n              )\r\n              (intermediate): BertIntermediate(\r\n                (dense): Linear(in_features=768, out_features=3072, bias=True)\r\n              )\r\n              (output): BertOutput(\r\n                (dense): Linear(in_features=3072, out_features=768, bias=True)\r\n                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\r\n                (dropout): Dropout(p=0.1, inplace=False)\r\n              )\r\n            )\r\n            (8): BertLayer(\r\n              (attention): BertAttention(\r\n                (self): BertSelfAttention(\r\n                  (query): Linear(in_features=768, out_features=768, bias=True)\r\n                  (key): Linear(in_features=768, out_features=768, bias=True)\r\n                  (value): Linear(in_features=768, out_features=768, bias=True)\r\n                  (dropout): Dropout(p=0.1, inplace=False)\r\n                )\r\n                (output): BertSelfOutput(\r\n                  (dense): Linear(in_features=768, out_features=768, bias=True)\r\n                  (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\r\n                  (dropout): Dropout(p=0.1, inplace=False)\r\n                )\r\n              )\r\n              (intermediate): BertIntermediate(\r\n                (dense): Linear(in_features=768, out_features=3072, bias=True)\r\n              )\r\n              (output): BertOutput(\r\n                (dense): Linear(in_features=3072, out_features=768, bias=True)\r\n                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\r\n                (dropout): Dropout(p=0.1, inplace=False)\r\n              )\r\n            )\r\n            (9): BertLayer(\r\n              (attention): BertAttention(\r\n                (self): BertSelfAttention(\r\n                  (query): Linear(in_features=768, out_features=768, bias=True)\r\n                  (key): Linear(in_features=768, out_features=768, bias=True)\r\n                  (value): Linear(in_features=768, out_features=768, bias=True)\r\n                  (dropout): Dropout(p=0.1, inplace=False)\r\n                )\r\n                (output): BertSelfOutput(\r\n                  (dense): Linear(in_features=768, out_features=768, bias=True)\r\n                  (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\r\n                  (dropout): Dropout(p=0.1, inplace=False)\r\n                )\r\n              )\r\n              (intermediate): BertIntermediate(\r\n                (dense): Linear(in_features=768, out_features=3072, bias=True)\r\n              )\r\n              (output): BertOutput(\r\n                (dense): Linear(in_features=3072, out_features=768, bias=True)\r\n                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\r\n                (dropout): Dropout(p=0.1, inplace=False)\r\n              )\r\n            )\r\n            (10): BertLayer(\r\n              (attention): BertAttention(\r\n                (self): BertSelfAttention(\r\n                  (query): Linear(in_features=768, out_features=768, bias=True)\r\n                  (key): Linear(in_features=768, out_features=768, bias=True)\r\n                  (value): Linear(in_features=768, out_features=768, bias=True)\r\n                  (dropout): Dropout(p=0.1, inplace=False)\r\n                )\r\n                (output): BertSelfOutput(\r\n                  (dense): Linear(in_features=768, out_features=768, bias=True)\r\n                  (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\r\n                  (dropout): Dropout(p=0.1, inplace=False)\r\n                )\r\n              )\r\n              (intermediate): BertIntermediate(\r\n                (dense): Linear(in_features=768, out_features=3072, bias=True)\r\n              )\r\n              (output): BertOutput(\r\n                (dense): Linear(in_features=3072, out_features=768, bias=True)\r\n                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\r\n                (dropout): Dropout(p=0.1, inplace=False)\r\n              )\r\n            )\r\n            (11): BertLayer(\r\n              (attention): BertAttention(\r\n                (self): BertSelfAttention(\r\n                  (query): Linear(in_features=768, out_features=768, bias=True)\r\n                  (key): Linear(in_features=768, out_features=768, bias=True)\r\n                  (value): Linear(in_features=768, out_features=768, bias=True)\r\n                  (dropout): Dropout(p=0.1, inplace=False)\r\n                )\r\n                (output): BertSelfOutput(\r\n                  (dense): Linear(in_features=768, out_features=768, bias=True)\r\n                  (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\r\n                  (dropout): Dropout(p=0.1, inplace=False)\r\n                )\r\n              )\r\n              (intermediate): BertIntermediate(\r\n                (dense): Linear(in_features=768, out_features=3072, bias=True)\r\n              )\r\n              (output): BertOutput(\r\n                (dense): Linear(in_features=3072, out_features=768, bias=True)\r\n                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\r\n                (dropout): Dropout(p=0.1, inplace=False)\r\n              )\r\n            )\r\n          )\r\n        )\r\n        (pooler): BertPooler(\r\n          (dense): Linear(in_features=768, out_features=768, bias=True)\r\n          (activation): Tanh()\r\n        )\r\n      )\r\n    )\r\n    (list_embedding_1): WordEmbeddings('ar')\r\n    (list_embedding_2): PooledFlairEmbeddings(\r\n      (context_embeddings): FlairEmbeddings(\r\n        (lm): LanguageModel(\r\n          (drop): Dropout(p=0.1, inplace=False)\r\n          (encoder): Embedding(7125, 100)\r\n          (rnn): LSTM(100, 2048)\r\n          (decoder): Linear(in_features=2048, out_features=7125, bias=True)\r\n        )\r\n      )\r\n    )\r\n    (list_embedding_3): PooledFlairEmbeddings(\r\n      (context_embeddings): FlairEmbeddings(\r\n        (lm): LanguageModel(\r\n          (drop): Dropout(p=0.1, inplace=False)\r\n          (encoder): Embedding(7125, 100)\r\n          (rnn): LSTM(100, 2048)\r\n          (decoder): Linear(in_features=2048, out_features=7125, bias=True)\r\n        )\r\n      )\r\n    )\r\n  )\r\n  (word_dropout): WordDropout(p=0.05)\r\n  (locked_dropout): LockedDropout(p=0.5)\r\n  (embedding2nn): Linear(in_features=11564, out_features=11564, bias=True)\r\n  (rnn): LSTM(11564, 256, batch_first=True, bidirectional=True)\r\n  (linear): Linear(in_features=512, out_features=31, bias=True)\r\n  (beta): 1.0\r\n  (weights): None\r\n  (weight_tensor) None\r\n)\"\r\n2021-01-25 10:21:56,231 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 10:21:56,232 Corpus: \"Corpus: 1148 train + 613 dev + 4686 test sentences\"\r\n2021-01-25 10:21:56,233 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 10:21:56,239 Parameters:\r\n2021-01-25 10:21:56,242  - learning_rate: \"0.1\"\r\n2021-01-25 10:21:56,243  - mini_batch_size: \"16\"\r\n2021-01-25 10:21:56,246  - patience: \"3\"\r\n2021-01-25 10:21:56,248  - anneal_factor: \"0.5\"\r\n2021-01-25 10:21:56,252  - max_epochs: \"150\"\r\n2021-01-25 10:21:56,253  - shuffle: \"True\"\r\n2021-01-25 10:21:56,254  - train_with_dev: \"True\"\r\n2021-01-25 10:21:56,256  - batch_growth_annealing: \"False\"\r\n2021-01-25 10:21:56,258 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 10:21:56,260 Model training base path: \"/content/gdrive/My Drive/resources/taggers/example-ner\"\r\n2021-01-25 10:21:56,262 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 10:21:56,263 Device: cuda:0\r\n2021-01-25 10:21:56,264 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 10:21:56,266 Embeddings storage mode: cpu\r\n2021-01-25 10:21:56,569 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 10:22:14,292 epoch 1 - iter 11/111 - loss 54.08059033 - samples/sec: 9.93 - lr: 0.100000\r\n2021-01-25 10:22:30,838 epoch 1 - iter 22/111 - loss 41.13435294 - samples/sec: 10.64 - lr: 0.100000\r\n2021-01-25 10:22:48,765 epoch 1 - iter 33/111 - loss 34.84662836 - samples/sec: 9.82 - lr: 0.100000\r\n2021-01-25 10:23:04,655 epoch 1 - iter 44/111 - loss 30.89554373 - samples/sec: 11.08 - lr: 0.100000\r\n2021-01-25 10:23:22,280 epoch 1 - iter 55/111 - loss 28.54707994 - samples/sec: 9.99 - lr: 0.100000\r\n2021-01-25 10:23:37,139 epoch 1 - iter 66/111 - loss 26.31969578 - samples/sec: 11.85 - lr: 0.100000\r\n2021-01-25 10:23:52,624 epoch 1 - iter 77/111 - loss 24.63814312 - samples/sec: 11.37 - lr: 0.100000\r\n2021-01-25 10:24:08,028 epoch 1 - iter 88/111 - loss 23.34882317 - samples/sec: 11.43 - lr: 0.100000\r\n2021-01-25 10:24:24,155 epoch 1 - iter 99/111 - loss 22.30208344 - samples/sec: 10.91 - lr: 0.100000\r\n2021-01-25 10:24:40,544 epoch 1 - iter 110/111 - loss 21.48262499 - samples/sec: 10.74 - lr: 0.100000\r\n2021-01-25 10:24:40,849 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 10:24:40,850 EPOCH 1 done: loss 21.3975 - lr 0.1000000\r\n2021-01-25 10:24:40,851 BAD EPOCHS (no improvement): 0\r\n2021-01-25 10:25:57,186 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 10:26:03,185 epoch 2 - iter 11/111 - loss 10.18805027 - samples/sec: 29.88 - lr: 0.100000\r\n2021-01-25 10:26:09,759 epoch 2 - iter 22/111 - loss 10.30833953 - samples/sec: 26.78 - lr: 0.100000\r\n2021-01-25 10:26:15,238 epoch 2 - iter 33/111 - loss 10.55462659 - samples/sec: 32.14 - lr: 0.100000\r\n2021-01-25 10:26:20,959 epoch 2 - iter 44/111 - loss 10.55391189 - samples/sec: 30.78 - lr: 0.100000\r\n2021-01-25 10:26:28,486 epoch 2 - iter 55/111 - loss 11.07268034 - samples/sec: 23.39 - lr: 0.100000\r\n2021-01-25 10:26:35,605 epoch 2 - iter 66/111 - loss 10.69464526 - samples/sec: 24.73 - lr: 0.100000\r\n2021-01-25 10:26:41,533 epoch 2 - iter 77/111 - loss 10.97407639 - samples/sec: 29.70 - lr: 0.100000\r\n2021-01-25 10:26:48,341 epoch 2 - iter 88/111 - loss 10.84447764 - samples/sec: 25.86 - lr: 0.100000\r\n2021-01-25 10:26:54,238 epoch 2 - iter 99/111 - loss 10.78961229 - samples/sec: 29.86 - lr: 0.100000\r\n2021-01-25 10:27:00,189 epoch 2 - iter 110/111 - loss 10.77094948 - samples/sec: 29.58 - lr: 0.100000\r\n2021-01-25 10:27:00,244 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 10:27:00,246 EPOCH 2 done: loss 10.6942 - lr 0.1000000\r\n2021-01-25 10:27:00,247 BAD EPOCHS (no improvement): 0\r\n2021-01-25 10:27:32,723 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 10:27:48,364 epoch 3 - iter 11/111 - loss 9.19014961 - samples/sec: 27.02 - lr: 0.100000\r\n2021-01-25 10:27:54,107 epoch 3 - iter 22/111 - loss 10.33909940 - samples/sec: 30.66 - lr: 0.100000\r\n2021-01-25 10:28:00,251 epoch 3 - iter 33/111 - loss 9.59317412 - samples/sec: 28.66 - lr: 0.100000\r\n2021-01-25 10:28:06,546 epoch 3 - iter 44/111 - loss 9.39935520 - samples/sec: 27.97 - lr: 0.100000\r\n2021-01-25 10:28:12,817 epoch 3 - iter 55/111 - loss 9.47141300 - samples/sec: 28.08 - lr: 0.100000\r\n2021-01-25 10:28:18,610 epoch 3 - iter 66/111 - loss 9.18817192 - samples/sec: 30.39 - lr: 0.100000\r\n2021-01-25 10:28:23,990 epoch 3 - iter 77/111 - loss 8.91675316 - samples/sec: 32.73 - lr: 0.100000\r\n2021-01-25 10:28:29,217 epoch 3 - iter 88/111 - loss 8.72033167 - samples/sec: 33.68 - lr: 0.100000\r\n2021-01-25 10:28:36,200 epoch 3 - iter 99/111 - loss 8.84041737 - samples/sec: 25.21 - lr: 0.100000\r\n2021-01-25 10:28:42,426 epoch 3 - iter 110/111 - loss 8.67852450 - samples/sec: 28.28 - lr: 0.100000\r\n2021-01-25 10:28:42,612 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 10:28:42,614 EPOCH 3 done: loss 8.6985 - lr 0.1000000\r\n2021-01-25 10:28:42,615 BAD EPOCHS (no improvement): 0\r\n2021-01-25 10:29:23,268 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 10:29:29,888 epoch 4 - iter 11/111 - loss 6.79467323 - samples/sec: 26.94 - lr: 0.100000\r\n2021-01-25 10:29:36,591 epoch 4 - iter 22/111 - loss 6.96387667 - samples/sec: 26.26 - lr: 0.100000\r\n2021-01-25 10:29:42,767 epoch 4 - iter 33/111 - loss 7.02527775 - samples/sec: 28.51 - lr: 0.100000\r\n2021-01-25 10:29:48,930 epoch 4 - iter 44/111 - loss 7.16199169 - samples/sec: 28.57 - lr: 0.100000\r\n2021-01-25 10:29:54,445 epoch 4 - iter 55/111 - loss 6.97783715 - samples/sec: 31.93 - lr: 0.100000\r\n2021-01-25 10:30:00,205 epoch 4 - iter 66/111 - loss 7.18816653 - samples/sec: 30.57 - lr: 0.100000\r\n2021-01-25 10:30:05,510 epoch 4 - iter 77/111 - loss 7.00425652 - samples/sec: 33.19 - lr: 0.100000\r\n2021-01-25 10:30:11,261 epoch 4 - iter 88/111 - loss 6.98279506 - samples/sec: 30.61 - lr: 0.100000\r\n2021-01-25 10:30:16,854 epoch 4 - iter 99/111 - loss 7.10576206 - samples/sec: 31.48 - lr: 0.100000\r\n2021-01-25 10:30:24,373 epoch 4 - iter 110/111 - loss 7.01915045 - samples/sec: 23.42 - lr: 0.100000\r\n2021-01-25 10:30:24,459 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 10:30:24,460 EPOCH 4 done: loss 6.9768 - lr 0.1000000\r\n2021-01-25 10:30:24,462 BAD EPOCHS (no improvement): 0\r\n2021-01-25 10:31:06,044 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 10:31:13,480 epoch 5 - iter 11/111 - loss 7.12273786 - samples/sec: 23.88 - lr: 0.100000\r\n2021-01-25 10:31:19,017 epoch 5 - iter 22/111 - loss 6.78446281 - samples/sec: 31.80 - lr: 0.100000\r\n2021-01-25 10:31:26,232 epoch 5 - iter 33/111 - loss 6.65425849 - samples/sec: 24.40 - lr: 0.100000\r\n2021-01-25 10:31:32,082 epoch 5 - iter 44/111 - loss 6.80952236 - samples/sec: 30.10 - lr: 0.100000\r\n2021-01-25 10:31:38,110 epoch 5 - iter 55/111 - loss 7.03379300 - samples/sec: 29.21 - lr: 0.100000\r\n2021-01-25 10:31:44,252 epoch 5 - iter 66/111 - loss 7.01593109 - samples/sec: 28.66 - lr: 0.100000\r\n2021-01-25 10:31:50,285 epoch 5 - iter 77/111 - loss 6.78503151 - samples/sec: 29.19 - lr: 0.100000\r\n2021-01-25 10:31:56,528 epoch 5 - iter 88/111 - loss 6.68158661 - samples/sec: 28.20 - lr: 0.100000\r\n2021-01-25 10:32:02,192 epoch 5 - iter 99/111 - loss 6.57793334 - samples/sec: 31.09 - lr: 0.100000\r\n2021-01-25 10:32:08,272 epoch 5 - iter 110/111 - loss 6.51472998 - samples/sec: 28.96 - lr: 0.100000\r\n2021-01-25 10:32:08,437 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 10:32:08,439 EPOCH 5 done: loss 6.5798 - lr 0.1000000\r\n2021-01-25 10:32:08,440 BAD EPOCHS (no improvement): 0\r\n2021-01-25 10:32:45,837 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 10:32:54,629 epoch 6 - iter 11/111 - loss 5.72094809 - samples/sec: 32.25 - lr: 0.100000\r\n2021-01-25 10:33:00,130 epoch 6 - iter 22/111 - loss 5.98198058 - samples/sec: 32.01 - lr: 0.100000\r\n2021-01-25 10:33:07,003 epoch 6 - iter 33/111 - loss 6.39245874 - samples/sec: 25.62 - lr: 0.100000\r\n2021-01-25 10:33:12,270 epoch 6 - iter 44/111 - loss 5.99628868 - samples/sec: 33.43 - lr: 0.100000\r\n2021-01-25 10:33:18,420 epoch 6 - iter 55/111 - loss 5.95702457 - samples/sec: 28.63 - lr: 0.100000\r\n2021-01-25 10:33:24,818 epoch 6 - iter 66/111 - loss 6.05384102 - samples/sec: 27.52 - lr: 0.100000\r\n2021-01-25 10:33:30,321 epoch 6 - iter 77/111 - loss 5.79583566 - samples/sec: 32.00 - lr: 0.100000\r\n2021-01-25 10:33:37,268 epoch 6 - iter 88/111 - loss 5.77474942 - samples/sec: 25.34 - lr: 0.100000\r\n2021-01-25 10:33:43,563 epoch 6 - iter 99/111 - loss 5.75745162 - samples/sec: 27.97 - lr: 0.100000\r\n2021-01-25 10:33:50,255 epoch 6 - iter 110/111 - loss 5.89956489 - samples/sec: 26.31 - lr: 0.100000\r\n2021-01-25 10:33:50,368 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 10:33:50,370 EPOCH 6 done: loss 5.8923 - lr 0.1000000\r\n2021-01-25 10:33:50,371 BAD EPOCHS (no improvement): 0\r\n2021-01-25 10:34:21,739 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 10:34:27,150 epoch 7 - iter 11/111 - loss 5.71705688 - samples/sec: 32.98 - lr: 0.100000\r\n2021-01-25 10:34:36,615 epoch 7 - iter 22/111 - loss 6.48266622 - samples/sec: 24.78 - lr: 0.100000\r\n2021-01-25 10:34:43,626 epoch 7 - iter 33/111 - loss 6.74974753 - samples/sec: 25.11 - lr: 0.100000\r\n2021-01-25 10:34:49,860 epoch 7 - iter 44/111 - loss 6.39683523 - samples/sec: 28.24 - lr: 0.100000\r\n2021-01-25 10:34:55,808 epoch 7 - iter 55/111 - loss 6.05628885 - samples/sec: 29.60 - lr: 0.100000\r\n2021-01-25 10:35:01,487 epoch 7 - iter 66/111 - loss 5.87755394 - samples/sec: 31.01 - lr: 0.100000\r\n2021-01-25 10:35:07,559 epoch 7 - iter 77/111 - loss 5.69736838 - samples/sec: 29.00 - lr: 0.100000\r\n2021-01-25 10:35:14,293 epoch 7 - iter 88/111 - loss 5.60839416 - samples/sec: 26.14 - lr: 0.100000\r\n2021-01-25 10:35:20,886 epoch 7 - iter 99/111 - loss 5.64187315 - samples/sec: 26.70 - lr: 0.100000\r\n2021-01-25 10:35:26,770 epoch 7 - iter 110/111 - loss 5.51890169 - samples/sec: 29.93 - lr: 0.100000\r\n2021-01-25 10:35:26,939 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 10:35:26,941 EPOCH 7 done: loss 5.4743 - lr 0.1000000\r\n2021-01-25 10:35:26,943 BAD EPOCHS (no improvement): 0\r\n2021-01-25 10:36:04,765 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 10:36:11,157 epoch 8 - iter 11/111 - loss 4.83452242 - samples/sec: 27.81 - lr: 0.100000\r\n2021-01-25 10:36:17,406 epoch 8 - iter 22/111 - loss 4.57567427 - samples/sec: 28.18 - lr: 0.100000\r\n2021-01-25 10:36:24,121 epoch 8 - iter 33/111 - loss 4.59209776 - samples/sec: 26.22 - lr: 0.100000\r\n2021-01-25 10:36:29,858 epoch 8 - iter 44/111 - loss 4.95231758 - samples/sec: 30.69 - lr: 0.100000\r\n2021-01-25 10:36:35,865 epoch 8 - iter 55/111 - loss 4.92243188 - samples/sec: 29.31 - lr: 0.100000\r\n2021-01-25 10:36:42,722 epoch 8 - iter 66/111 - loss 4.97758638 - samples/sec: 25.68 - lr: 0.100000\r\n2021-01-25 10:36:48,853 epoch 8 - iter 77/111 - loss 4.96645152 - samples/sec: 28.72 - lr: 0.100000\r\n2021-01-25 10:36:53,957 epoch 8 - iter 88/111 - loss 4.87177904 - samples/sec: 34.50 - lr: 0.100000\r\n2021-01-25 10:37:00,283 epoch 8 - iter 99/111 - loss 4.99280324 - samples/sec: 27.83 - lr: 0.100000\r\n2021-01-25 10:37:07,721 epoch 8 - iter 110/111 - loss 4.97948530 - samples/sec: 23.67 - lr: 0.100000\r\n2021-01-25 10:37:07,829 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 10:37:07,830 EPOCH 8 done: loss 4.9616 - lr 0.1000000\r\n2021-01-25 10:37:07,831 BAD EPOCHS (no improvement): 0\r\n2021-01-25 10:37:48,631 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 10:37:54,758 epoch 9 - iter 11/111 - loss 4.03332498 - samples/sec: 28.96 - lr: 0.100000\r\n2021-01-25 10:38:00,884 epoch 9 - iter 22/111 - loss 4.12423093 - samples/sec: 28.75 - lr: 0.100000\r\n2021-01-25 10:38:06,179 epoch 9 - iter 33/111 - loss 3.96145048 - samples/sec: 33.25 - lr: 0.100000\r\n2021-01-25 10:38:12,600 epoch 9 - iter 44/111 - loss 4.27605110 - samples/sec: 27.42 - lr: 0.100000\r\n2021-01-25 10:38:19,267 epoch 9 - iter 55/111 - loss 4.75408689 - samples/sec: 26.41 - lr: 0.100000\r\n2021-01-25 10:38:26,074 epoch 9 - iter 66/111 - loss 5.00143290 - samples/sec: 25.87 - lr: 0.100000\r\n2021-01-25 10:38:32,395 epoch 9 - iter 77/111 - loss 4.87554965 - samples/sec: 27.85 - lr: 0.100000\r\n2021-01-25 10:38:38,356 epoch 9 - iter 88/111 - loss 4.95585848 - samples/sec: 29.54 - lr: 0.100000\r\n2021-01-25 10:38:44,373 epoch 9 - iter 99/111 - loss 4.92190668 - samples/sec: 29.26 - lr: 0.100000\r\n2021-01-25 10:38:50,575 epoch 9 - iter 110/111 - loss 4.84930390 - samples/sec: 28.39 - lr: 0.100000\r\n2021-01-25 10:38:50,674 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 10:38:50,675 EPOCH 9 done: loss 4.8162 - lr 0.1000000\r\n2021-01-25 10:38:50,677 BAD EPOCHS (no improvement): 0\r\n2021-01-25 10:39:30,572 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 10:39:36,829 epoch 10 - iter 11/111 - loss 4.69822099 - samples/sec: 28.33 - lr: 0.100000\r\n2021-01-25 10:39:43,649 epoch 10 - iter 22/111 - loss 5.36886237 - samples/sec: 25.82 - lr: 0.100000\r\n2021-01-25 10:39:50,021 epoch 10 - iter 33/111 - loss 4.81391519 - samples/sec: 27.63 - lr: 0.100000\r\n2021-01-25 10:39:56,348 epoch 10 - iter 44/111 - loss 4.79041301 - samples/sec: 27.83 - lr: 0.100000\r\n2021-01-25 10:40:03,125 epoch 10 - iter 55/111 - loss 4.67135966 - samples/sec: 25.98 - lr: 0.100000\r\n2021-01-25 10:40:10,932 epoch 10 - iter 66/111 - loss 4.70814198 - samples/sec: 22.55 - lr: 0.100000\r\n2021-01-25 10:40:16,611 epoch 10 - iter 77/111 - loss 4.64808380 - samples/sec: 31.01 - lr: 0.100000\r\n2021-01-25 10:40:22,158 epoch 10 - iter 88/111 - loss 4.64051295 - samples/sec: 31.74 - lr: 0.100000\r\n2021-01-25 10:40:28,254 epoch 10 - iter 99/111 - loss 4.56246087 - samples/sec: 28.88 - lr: 0.100000\r\n2021-01-25 10:40:33,677 epoch 10 - iter 110/111 - loss 4.61198434 - samples/sec: 32.47 - lr: 0.100000\r\n2021-01-25 10:40:33,770 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 10:40:33,772 EPOCH 10 done: loss 4.5847 - lr 0.1000000\r\n2021-01-25 10:40:33,774 BAD EPOCHS (no improvement): 0\r\n2021-01-25 10:41:06,168 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 10:41:12,392 epoch 11 - iter 11/111 - loss 4.56382496 - samples/sec: 28.49 - lr: 0.100000\r\n2021-01-25 10:41:21,588 epoch 11 - iter 22/111 - loss 4.40316660 - samples/sec: 27.02 - lr: 0.100000\r\n2021-01-25 10:41:27,786 epoch 11 - iter 33/111 - loss 4.20600127 - samples/sec: 28.41 - lr: 0.100000\r\n2021-01-25 10:41:33,650 epoch 11 - iter 44/111 - loss 4.13510584 - samples/sec: 30.02 - lr: 0.100000\r\n2021-01-25 10:41:40,178 epoch 11 - iter 55/111 - loss 4.18275395 - samples/sec: 26.97 - lr: 0.100000\r\n2021-01-25 10:41:46,411 epoch 11 - iter 66/111 - loss 4.46802516 - samples/sec: 28.25 - lr: 0.100000\r\n2021-01-25 10:41:52,223 epoch 11 - iter 77/111 - loss 4.53560302 - samples/sec: 30.30 - lr: 0.100000\r\n2021-01-25 10:41:57,900 epoch 11 - iter 88/111 - loss 4.39049167 - samples/sec: 31.02 - lr: 0.100000\r\n2021-01-25 10:42:04,240 epoch 11 - iter 99/111 - loss 4.37021638 - samples/sec: 27.77 - lr: 0.100000\r\n2021-01-25 10:42:10,404 epoch 11 - iter 110/111 - loss 4.53993713 - samples/sec: 28.56 - lr: 0.100000\r\n2021-01-25 10:42:10,496 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 10:42:10,498 EPOCH 11 done: loss 4.5023 - lr 0.1000000\r\n2021-01-25 10:42:10,499 BAD EPOCHS (no improvement): 0\r\n2021-01-25 10:42:41,977 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 10:42:47,948 epoch 12 - iter 11/111 - loss 5.90833831 - samples/sec: 29.72 - lr: 0.100000\r\n2021-01-25 10:42:54,814 epoch 12 - iter 22/111 - loss 4.99683451 - samples/sec: 33.32 - lr: 0.100000\r\n2021-01-25 10:43:00,703 epoch 12 - iter 33/111 - loss 4.87504964 - samples/sec: 29.90 - lr: 0.100000\r\n2021-01-25 10:43:06,928 epoch 12 - iter 44/111 - loss 4.67687361 - samples/sec: 28.29 - lr: 0.100000\r\n2021-01-25 10:43:13,530 epoch 12 - iter 55/111 - loss 4.54725967 - samples/sec: 26.67 - lr: 0.100000\r\n2021-01-25 10:43:19,080 epoch 12 - iter 66/111 - loss 4.61625748 - samples/sec: 31.72 - lr: 0.100000\r\n2021-01-25 10:43:25,690 epoch 12 - iter 77/111 - loss 4.88363346 - samples/sec: 26.64 - lr: 0.100000\r\n2021-01-25 10:43:32,796 epoch 12 - iter 88/111 - loss 4.97682306 - samples/sec: 24.78 - lr: 0.100000\r\n2021-01-25 10:43:38,314 epoch 12 - iter 99/111 - loss 4.99162579 - samples/sec: 31.91 - lr: 0.100000\r\n2021-01-25 10:43:43,992 epoch 12 - iter 110/111 - loss 4.87017690 - samples/sec: 31.01 - lr: 0.100000\r\n2021-01-25 10:43:44,166 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 10:43:44,167 EPOCH 12 done: loss 4.9315 - lr 0.1000000\r\n2021-01-25 10:43:44,169 BAD EPOCHS (no improvement): 1\r\n2021-01-25 10:44:24,274 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 10:44:32,223 epoch 13 - iter 11/111 - loss 4.49722214 - samples/sec: 22.29 - lr: 0.100000\r\n2021-01-25 10:44:39,436 epoch 13 - iter 22/111 - loss 4.24567978 - samples/sec: 24.41 - lr: 0.100000\r\n2021-01-25 10:44:45,070 epoch 13 - iter 33/111 - loss 4.07326443 - samples/sec: 31.25 - lr: 0.100000\r\n2021-01-25 10:44:50,669 epoch 13 - iter 44/111 - loss 4.08721220 - samples/sec: 31.45 - lr: 0.100000\r\n2021-01-25 10:44:56,673 epoch 13 - iter 55/111 - loss 4.13151048 - samples/sec: 29.33 - lr: 0.100000\r\n2021-01-25 10:45:02,068 epoch 13 - iter 66/111 - loss 4.30481188 - samples/sec: 32.64 - lr: 0.100000\r\n2021-01-25 10:45:08,192 epoch 13 - iter 77/111 - loss 4.50275675 - samples/sec: 28.75 - lr: 0.100000\r\n2021-01-25 10:45:14,369 epoch 13 - iter 88/111 - loss 4.42745535 - samples/sec: 28.50 - lr: 0.100000\r\n2021-01-25 10:45:19,504 epoch 13 - iter 99/111 - loss 4.38588194 - samples/sec: 34.29 - lr: 0.100000\r\n2021-01-25 10:45:26,292 epoch 13 - iter 110/111 - loss 4.41341555 - samples/sec: 25.94 - lr: 0.100000\r\n2021-01-25 10:45:26,421 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 10:45:26,424 EPOCH 13 done: loss 4.4409 - lr 0.1000000\r\n2021-01-25 10:45:26,425 BAD EPOCHS (no improvement): 0\r\n2021-01-25 10:46:03,627 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 10:46:09,385 epoch 14 - iter 11/111 - loss 3.34990287 - samples/sec: 30.81 - lr: 0.100000\r\n2021-01-25 10:46:14,989 epoch 14 - iter 22/111 - loss 3.77477489 - samples/sec: 31.42 - lr: 0.100000\r\n2021-01-25 10:46:21,424 epoch 14 - iter 33/111 - loss 4.09334437 - samples/sec: 27.36 - lr: 0.100000\r\n2021-01-25 10:46:27,488 epoch 14 - iter 44/111 - loss 3.97580681 - samples/sec: 29.04 - lr: 0.100000\r\n2021-01-25 10:46:33,044 epoch 14 - iter 55/111 - loss 3.98205665 - samples/sec: 31.69 - lr: 0.100000\r\n2021-01-25 10:46:39,999 epoch 14 - iter 66/111 - loss 4.15114326 - samples/sec: 25.31 - lr: 0.100000\r\n2021-01-25 10:46:46,613 epoch 14 - iter 77/111 - loss 4.07458371 - samples/sec: 26.62 - lr: 0.100000\r\n2021-01-25 10:46:53,154 epoch 14 - iter 88/111 - loss 4.09190993 - samples/sec: 26.91 - lr: 0.100000\r\n2021-01-25 10:46:59,415 epoch 14 - iter 99/111 - loss 4.33675907 - samples/sec: 28.12 - lr: 0.100000\r\n2021-01-25 10:47:05,512 epoch 14 - iter 110/111 - loss 4.24677618 - samples/sec: 28.88 - lr: 0.100000\r\n2021-01-25 10:47:05,604 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 10:47:05,605 EPOCH 14 done: loss 4.2480 - lr 0.1000000\r\n2021-01-25 10:47:05,607 BAD EPOCHS (no improvement): 0\r\n2021-01-25 10:47:39,266 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 10:47:45,746 epoch 15 - iter 11/111 - loss 4.84905434 - samples/sec: 27.40 - lr: 0.100000\r\n2021-01-25 10:47:52,518 epoch 15 - iter 22/111 - loss 4.42149465 - samples/sec: 26.00 - lr: 0.100000\r\n2021-01-25 10:47:58,257 epoch 15 - iter 33/111 - loss 4.35310003 - samples/sec: 30.68 - lr: 0.100000\r\n2021-01-25 10:48:04,382 epoch 15 - iter 44/111 - loss 4.08566290 - samples/sec: 28.75 - lr: 0.100000\r\n2021-01-25 10:48:10,112 epoch 15 - iter 55/111 - loss 4.01557928 - samples/sec: 30.73 - lr: 0.100000\r\n2021-01-25 10:48:16,130 epoch 15 - iter 66/111 - loss 4.15357811 - samples/sec: 29.26 - lr: 0.100000\r\n2021-01-25 10:48:22,464 epoch 15 - iter 77/111 - loss 4.31850308 - samples/sec: 27.80 - lr: 0.100000\r\n2021-01-25 10:48:29,213 epoch 15 - iter 88/111 - loss 4.32283522 - samples/sec: 26.09 - lr: 0.100000\r\n2021-01-25 10:48:34,778 epoch 15 - iter 99/111 - loss 4.25586665 - samples/sec: 31.64 - lr: 0.100000\r\n2021-01-25 10:48:40,845 epoch 15 - iter 110/111 - loss 4.18545671 - samples/sec: 29.02 - lr: 0.100000\r\n2021-01-25 10:48:40,913 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 10:48:40,915 EPOCH 15 done: loss 4.1483 - lr 0.1000000\r\n2021-01-25 10:48:40,916 BAD EPOCHS (no improvement): 0\r\n2021-01-25 10:49:23,213 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 10:49:29,388 epoch 16 - iter 11/111 - loss 4.67221058 - samples/sec: 28.76 - lr: 0.100000\r\n2021-01-25 10:49:34,753 epoch 16 - iter 22/111 - loss 4.13016958 - samples/sec: 32.81 - lr: 0.100000\r\n2021-01-25 10:49:41,447 epoch 16 - iter 33/111 - loss 3.81629994 - samples/sec: 26.31 - lr: 0.100000\r\n2021-01-25 10:49:46,595 epoch 16 - iter 44/111 - loss 3.72972661 - samples/sec: 34.20 - lr: 0.100000\r\n2021-01-25 10:49:53,267 epoch 16 - iter 55/111 - loss 3.82915365 - samples/sec: 26.39 - lr: 0.100000\r\n2021-01-25 10:49:59,078 epoch 16 - iter 66/111 - loss 4.01950283 - samples/sec: 30.30 - lr: 0.100000\r\n2021-01-25 10:50:03,771 epoch 16 - iter 77/111 - loss 3.97010807 - samples/sec: 37.53 - lr: 0.100000\r\n2021-01-25 10:50:10,556 epoch 16 - iter 88/111 - loss 4.07479574 - samples/sec: 25.95 - lr: 0.100000\r\n2021-01-25 10:50:17,219 epoch 16 - iter 99/111 - loss 4.07658210 - samples/sec: 26.43 - lr: 0.100000\r\n2021-01-25 10:50:23,340 epoch 16 - iter 110/111 - loss 4.07201452 - samples/sec: 28.76 - lr: 0.100000\r\n2021-01-25 10:50:23,425 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 10:50:23,427 EPOCH 16 done: loss 4.0881 - lr 0.1000000\r\n2021-01-25 10:50:23,429 BAD EPOCHS (no improvement): 0\r\n2021-01-25 10:50:55,720 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 10:51:09,863 epoch 17 - iter 11/111 - loss 3.91294293 - samples/sec: 30.55 - lr: 0.100000\r\n2021-01-25 10:51:15,941 epoch 17 - iter 22/111 - loss 3.95785974 - samples/sec: 28.97 - lr: 0.100000\r\n2021-01-25 10:51:21,702 epoch 17 - iter 33/111 - loss 4.18957638 - samples/sec: 30.56 - lr: 0.100000\r\n2021-01-25 10:51:28,507 epoch 17 - iter 44/111 - loss 4.22830299 - samples/sec: 25.87 - lr: 0.100000\r\n2021-01-25 10:51:34,804 epoch 17 - iter 55/111 - loss 4.08225724 - samples/sec: 27.96 - lr: 0.100000\r\n2021-01-25 10:51:40,796 epoch 17 - iter 66/111 - loss 4.08138589 - samples/sec: 29.39 - lr: 0.100000\r\n2021-01-25 10:51:47,087 epoch 17 - iter 77/111 - loss 3.95975426 - samples/sec: 27.99 - lr: 0.100000\r\n2021-01-25 10:51:54,381 epoch 17 - iter 88/111 - loss 4.03049670 - samples/sec: 24.14 - lr: 0.100000\r\n2021-01-25 10:52:00,314 epoch 17 - iter 99/111 - loss 4.04535589 - samples/sec: 29.68 - lr: 0.100000\r\n2021-01-25 10:52:05,885 epoch 17 - iter 110/111 - loss 3.98108125 - samples/sec: 31.61 - lr: 0.100000\r\n2021-01-25 10:52:05,992 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 10:52:05,993 EPOCH 17 done: loss 3.9852 - lr 0.1000000\r\n2021-01-25 10:52:05,995 BAD EPOCHS (no improvement): 0\r\n2021-01-25 10:52:41,921 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 10:52:47,916 epoch 18 - iter 11/111 - loss 4.47138399 - samples/sec: 29.58 - lr: 0.100000\r\n2021-01-25 10:52:53,928 epoch 18 - iter 22/111 - loss 4.02970250 - samples/sec: 29.29 - lr: 0.100000\r\n2021-01-25 10:52:59,772 epoch 18 - iter 33/111 - loss 3.72331607 - samples/sec: 30.13 - lr: 0.100000\r\n2021-01-25 10:53:05,842 epoch 18 - iter 44/111 - loss 3.81717015 - samples/sec: 29.01 - lr: 0.100000\r\n2021-01-25 10:53:12,043 epoch 18 - iter 55/111 - loss 3.94470713 - samples/sec: 28.40 - lr: 0.100000\r\n2021-01-25 10:53:19,594 epoch 18 - iter 66/111 - loss 3.94664986 - samples/sec: 23.32 - lr: 0.100000\r\n2021-01-25 10:53:25,908 epoch 18 - iter 77/111 - loss 4.00742454 - samples/sec: 27.89 - lr: 0.100000\r\n2021-01-25 10:53:32,544 epoch 18 - iter 88/111 - loss 4.13232218 - samples/sec: 26.53 - lr: 0.100000\r\n2021-01-25 10:53:39,192 epoch 18 - iter 99/111 - loss 4.02311627 - samples/sec: 26.48 - lr: 0.100000\r\n2021-01-25 10:53:44,978 epoch 18 - iter 110/111 - loss 3.94061089 - samples/sec: 30.43 - lr: 0.100000\r\n2021-01-25 10:53:45,044 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 10:53:45,046 EPOCH 18 done: loss 3.9053 - lr 0.1000000\r\n2021-01-25 10:53:45,050 BAD EPOCHS (no improvement): 0\r\n2021-01-25 10:54:18,998 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 10:54:25,784 epoch 19 - iter 11/111 - loss 3.36324605 - samples/sec: 26.09 - lr: 0.100000\r\n2021-01-25 10:54:33,028 epoch 19 - iter 22/111 - loss 3.85746611 - samples/sec: 24.30 - lr: 0.100000\r\n2021-01-25 10:54:39,061 epoch 19 - iter 33/111 - loss 3.68025916 - samples/sec: 29.19 - lr: 0.100000\r\n2021-01-25 10:54:44,841 epoch 19 - iter 44/111 - loss 3.57081627 - samples/sec: 30.46 - lr: 0.100000\r\n2021-01-25 10:54:50,816 epoch 19 - iter 55/111 - loss 3.79188262 - samples/sec: 29.47 - lr: 0.100000\r\n2021-01-25 10:54:57,148 epoch 19 - iter 66/111 - loss 3.74162868 - samples/sec: 27.80 - lr: 0.100000\r\n2021-01-25 10:55:03,228 epoch 19 - iter 77/111 - loss 3.80293375 - samples/sec: 28.96 - lr: 0.100000\r\n2021-01-25 10:55:09,269 epoch 19 - iter 88/111 - loss 3.83735181 - samples/sec: 29.15 - lr: 0.100000\r\n2021-01-25 10:55:14,984 epoch 19 - iter 99/111 - loss 3.78604484 - samples/sec: 30.81 - lr: 0.100000\r\n2021-01-25 10:55:21,006 epoch 19 - iter 110/111 - loss 3.78007814 - samples/sec: 29.24 - lr: 0.100000\r\n2021-01-25 10:55:21,349 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 10:55:21,350 EPOCH 19 done: loss 3.9585 - lr 0.1000000\r\n2021-01-25 10:55:21,352 BAD EPOCHS (no improvement): 1\r\n2021-01-25 10:56:01,430 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 10:56:08,691 epoch 20 - iter 11/111 - loss 3.34550040 - samples/sec: 24.43 - lr: 0.100000\r\n2021-01-25 10:56:15,795 epoch 20 - iter 22/111 - loss 3.64379755 - samples/sec: 24.78 - lr: 0.100000\r\n2021-01-25 10:56:21,410 epoch 20 - iter 33/111 - loss 3.58633875 - samples/sec: 31.36 - lr: 0.100000\r\n2021-01-25 10:56:26,894 epoch 20 - iter 44/111 - loss 3.54973823 - samples/sec: 32.10 - lr: 0.100000\r\n2021-01-25 10:56:33,383 epoch 20 - iter 55/111 - loss 3.67109567 - samples/sec: 27.13 - lr: 0.100000\r\n2021-01-25 10:56:38,796 epoch 20 - iter 66/111 - loss 3.66164948 - samples/sec: 32.53 - lr: 0.100000\r\n2021-01-25 10:56:44,968 epoch 20 - iter 77/111 - loss 3.62982319 - samples/sec: 28.52 - lr: 0.100000\r\n2021-01-25 10:56:51,072 epoch 20 - iter 88/111 - loss 3.64661483 - samples/sec: 28.85 - lr: 0.100000\r\n2021-01-25 10:56:56,235 epoch 20 - iter 99/111 - loss 3.60557880 - samples/sec: 34.11 - lr: 0.100000\r\n2021-01-25 10:57:02,160 epoch 20 - iter 110/111 - loss 3.74337495 - samples/sec: 29.72 - lr: 0.100000\r\n2021-01-25 10:57:02,205 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 10:57:02,207 EPOCH 20 done: loss 3.7098 - lr 0.1000000\r\n2021-01-25 10:57:02,208 BAD EPOCHS (no improvement): 0\r\n2021-01-25 10:57:40,962 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 10:57:47,285 epoch 21 - iter 11/111 - loss 3.86662451 - samples/sec: 27.97 - lr: 0.100000\r\n2021-01-25 10:57:52,470 epoch 21 - iter 22/111 - loss 3.40074368 - samples/sec: 33.96 - lr: 0.100000\r\n2021-01-25 10:57:58,417 epoch 21 - iter 33/111 - loss 3.58548474 - samples/sec: 29.60 - lr: 0.100000\r\n2021-01-25 10:58:04,761 epoch 21 - iter 44/111 - loss 3.54917274 - samples/sec: 27.75 - lr: 0.100000\r\n2021-01-25 10:58:10,414 epoch 21 - iter 55/111 - loss 3.48718619 - samples/sec: 31.14 - lr: 0.100000\r\n2021-01-25 10:58:16,269 epoch 21 - iter 66/111 - loss 3.43532407 - samples/sec: 30.07 - lr: 0.100000\r\n2021-01-25 10:58:22,342 epoch 21 - iter 77/111 - loss 3.56432442 - samples/sec: 28.99 - lr: 0.100000\r\n2021-01-25 10:58:28,219 epoch 21 - iter 88/111 - loss 3.45780471 - samples/sec: 29.96 - lr: 0.100000\r\n2021-01-25 10:58:33,373 epoch 21 - iter 99/111 - loss 3.47687646 - samples/sec: 34.16 - lr: 0.100000\r\n2021-01-25 10:58:39,868 epoch 21 - iter 110/111 - loss 3.59270786 - samples/sec: 27.11 - lr: 0.100000\r\n2021-01-25 10:58:39,916 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 10:58:39,918 EPOCH 21 done: loss 3.5603 - lr 0.1000000\r\n2021-01-25 10:58:39,919 BAD EPOCHS (no improvement): 0\r\n2021-01-25 10:59:17,498 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 10:59:22,994 epoch 22 - iter 11/111 - loss 3.60258175 - samples/sec: 32.21 - lr: 0.100000\r\n2021-01-25 10:59:28,617 epoch 22 - iter 22/111 - loss 3.33457632 - samples/sec: 31.32 - lr: 0.100000\r\n2021-01-25 10:59:34,673 epoch 22 - iter 33/111 - loss 3.52667694 - samples/sec: 29.07 - lr: 0.100000\r\n2021-01-25 10:59:41,549 epoch 22 - iter 44/111 - loss 3.61057627 - samples/sec: 25.60 - lr: 0.100000\r\n2021-01-25 10:59:47,770 epoch 22 - iter 55/111 - loss 3.58373189 - samples/sec: 28.30 - lr: 0.100000\r\n2021-01-25 10:59:54,099 epoch 22 - iter 66/111 - loss 3.81865191 - samples/sec: 27.83 - lr: 0.100000\r\n2021-01-25 10:59:59,891 epoch 22 - iter 77/111 - loss 3.72697158 - samples/sec: 30.40 - lr: 0.100000\r\n2021-01-25 11:00:05,045 epoch 22 - iter 88/111 - loss 3.59734723 - samples/sec: 34.16 - lr: 0.100000\r\n2021-01-25 11:00:11,190 epoch 22 - iter 99/111 - loss 3.58061069 - samples/sec: 28.65 - lr: 0.100000\r\n2021-01-25 11:00:16,912 epoch 22 - iter 110/111 - loss 3.63909051 - samples/sec: 30.77 - lr: 0.100000\r\n2021-01-25 11:00:17,020 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:00:17,022 EPOCH 22 done: loss 3.6081 - lr 0.1000000\r\n2021-01-25 11:00:17,022 BAD EPOCHS (no improvement): 1\r\n2021-01-25 11:00:51,480 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:00:56,588 epoch 23 - iter 11/111 - loss 3.05639503 - samples/sec: 34.66 - lr: 0.100000\r\n2021-01-25 11:01:02,612 epoch 23 - iter 22/111 - loss 3.19333094 - samples/sec: 29.23 - lr: 0.100000\r\n2021-01-25 11:01:08,102 epoch 23 - iter 33/111 - loss 3.29475918 - samples/sec: 32.07 - lr: 0.100000\r\n2021-01-25 11:01:13,807 epoch 23 - iter 44/111 - loss 3.27113770 - samples/sec: 30.86 - lr: 0.100000\r\n2021-01-25 11:01:19,332 epoch 23 - iter 55/111 - loss 3.23012321 - samples/sec: 31.86 - lr: 0.100000\r\n2021-01-25 11:01:24,790 epoch 23 - iter 66/111 - loss 3.30221744 - samples/sec: 32.26 - lr: 0.100000\r\n2021-01-25 11:01:30,897 epoch 23 - iter 77/111 - loss 3.34762002 - samples/sec: 28.83 - lr: 0.100000\r\n2021-01-25 11:01:36,896 epoch 23 - iter 88/111 - loss 3.35990208 - samples/sec: 29.35 - lr: 0.100000\r\n2021-01-25 11:01:42,995 epoch 23 - iter 99/111 - loss 3.52005647 - samples/sec: 28.87 - lr: 0.100000\r\n2021-01-25 11:01:49,448 epoch 23 - iter 110/111 - loss 3.53163481 - samples/sec: 27.29 - lr: 0.100000\r\n2021-01-25 11:01:49,772 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:01:49,773 EPOCH 23 done: loss 3.6030 - lr 0.1000000\r\n2021-01-25 11:01:49,775 BAD EPOCHS (no improvement): 2\r\n2021-01-25 11:02:29,377 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:02:35,758 epoch 24 - iter 11/111 - loss 3.31554187 - samples/sec: 27.71 - lr: 0.100000\r\n2021-01-25 11:02:42,291 epoch 24 - iter 22/111 - loss 3.24008038 - samples/sec: 26.95 - lr: 0.100000\r\n2021-01-25 11:02:48,284 epoch 24 - iter 33/111 - loss 3.22429945 - samples/sec: 29.38 - lr: 0.100000\r\n2021-01-25 11:02:54,930 epoch 24 - iter 44/111 - loss 3.17169051 - samples/sec: 26.49 - lr: 0.100000\r\n2021-01-25 11:03:01,096 epoch 24 - iter 55/111 - loss 3.30037483 - samples/sec: 28.55 - lr: 0.100000\r\n2021-01-25 11:03:06,742 epoch 24 - iter 66/111 - loss 3.34624892 - samples/sec: 31.18 - lr: 0.100000\r\n2021-01-25 11:03:12,677 epoch 24 - iter 77/111 - loss 3.50012274 - samples/sec: 29.67 - lr: 0.100000\r\n2021-01-25 11:03:18,594 epoch 24 - iter 88/111 - loss 3.51464304 - samples/sec: 29.75 - lr: 0.100000\r\n2021-01-25 11:03:23,317 epoch 24 - iter 99/111 - loss 3.46995135 - samples/sec: 37.28 - lr: 0.100000\r\n2021-01-25 11:03:29,304 epoch 24 - iter 110/111 - loss 3.43061742 - samples/sec: 29.41 - lr: 0.100000\r\n2021-01-25 11:03:29,384 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:03:29,385 EPOCH 24 done: loss 3.4215 - lr 0.1000000\r\n2021-01-25 11:03:29,387 BAD EPOCHS (no improvement): 0\r\n2021-01-25 11:04:04,860 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:04:10,901 epoch 25 - iter 11/111 - loss 2.49696062 - samples/sec: 29.27 - lr: 0.100000\r\n2021-01-25 11:04:15,997 epoch 25 - iter 22/111 - loss 2.89337932 - samples/sec: 34.56 - lr: 0.100000\r\n2021-01-25 11:04:21,767 epoch 25 - iter 33/111 - loss 3.31816685 - samples/sec: 30.51 - lr: 0.100000\r\n2021-01-25 11:04:28,760 epoch 25 - iter 44/111 - loss 3.49047833 - samples/sec: 25.18 - lr: 0.100000\r\n2021-01-25 11:04:35,541 epoch 25 - iter 55/111 - loss 3.45313112 - samples/sec: 25.96 - lr: 0.100000\r\n2021-01-25 11:04:40,781 epoch 25 - iter 66/111 - loss 3.42519531 - samples/sec: 33.60 - lr: 0.100000\r\n2021-01-25 11:04:46,016 epoch 25 - iter 77/111 - loss 3.33971619 - samples/sec: 33.64 - lr: 0.100000\r\n2021-01-25 11:04:51,549 epoch 25 - iter 88/111 - loss 3.34791419 - samples/sec: 31.82 - lr: 0.100000\r\n2021-01-25 11:04:58,537 epoch 25 - iter 99/111 - loss 3.50522223 - samples/sec: 25.19 - lr: 0.100000\r\n2021-01-25 11:05:04,809 epoch 25 - iter 110/111 - loss 3.47983645 - samples/sec: 28.07 - lr: 0.100000\r\n2021-01-25 11:05:04,891 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:05:04,892 EPOCH 25 done: loss 3.4488 - lr 0.1000000\r\n2021-01-25 11:05:04,893 BAD EPOCHS (no improvement): 1\r\n2021-01-25 11:05:45,636 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:05:51,515 epoch 26 - iter 11/111 - loss 3.10320271 - samples/sec: 30.09 - lr: 0.100000\r\n2021-01-25 11:05:57,019 epoch 26 - iter 22/111 - loss 3.01847404 - samples/sec: 31.99 - lr: 0.100000\r\n2021-01-25 11:06:02,514 epoch 26 - iter 33/111 - loss 3.25418358 - samples/sec: 32.04 - lr: 0.100000\r\n2021-01-25 11:06:07,925 epoch 26 - iter 44/111 - loss 3.15338173 - samples/sec: 32.54 - lr: 0.100000\r\n2021-01-25 11:06:13,548 epoch 26 - iter 55/111 - loss 3.22959855 - samples/sec: 31.31 - lr: 0.100000\r\n2021-01-25 11:06:20,368 epoch 26 - iter 66/111 - loss 3.21547249 - samples/sec: 25.82 - lr: 0.100000\r\n2021-01-25 11:06:26,915 epoch 26 - iter 77/111 - loss 3.33247595 - samples/sec: 26.89 - lr: 0.100000\r\n2021-01-25 11:06:33,496 epoch 26 - iter 88/111 - loss 3.27858888 - samples/sec: 26.75 - lr: 0.100000\r\n2021-01-25 11:06:39,607 epoch 26 - iter 99/111 - loss 3.46542293 - samples/sec: 28.81 - lr: 0.100000\r\n2021-01-25 11:06:45,602 epoch 26 - iter 110/111 - loss 3.43672350 - samples/sec: 29.37 - lr: 0.100000\r\n2021-01-25 11:06:45,644 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:06:45,645 EPOCH 26 done: loss 3.4065 - lr 0.1000000\r\n2021-01-25 11:06:45,647 BAD EPOCHS (no improvement): 0\r\n2021-01-25 11:07:20,171 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:07:26,335 epoch 27 - iter 11/111 - loss 3.98224313 - samples/sec: 28.69 - lr: 0.100000\r\n2021-01-25 11:07:31,866 epoch 27 - iter 22/111 - loss 3.56279709 - samples/sec: 31.83 - lr: 0.100000\r\n2021-01-25 11:07:36,922 epoch 27 - iter 33/111 - loss 3.45221030 - samples/sec: 34.82 - lr: 0.100000\r\n2021-01-25 11:07:42,692 epoch 27 - iter 44/111 - loss 3.36433793 - samples/sec: 30.51 - lr: 0.100000\r\n2021-01-25 11:07:49,062 epoch 27 - iter 55/111 - loss 3.26470423 - samples/sec: 27.64 - lr: 0.100000\r\n2021-01-25 11:07:56,099 epoch 27 - iter 66/111 - loss 3.23170023 - samples/sec: 25.02 - lr: 0.100000\r\n2021-01-25 11:08:02,565 epoch 27 - iter 77/111 - loss 3.20683398 - samples/sec: 27.23 - lr: 0.100000\r\n2021-01-25 11:08:08,627 epoch 27 - iter 88/111 - loss 3.15380178 - samples/sec: 29.05 - lr: 0.100000\r\n2021-01-25 11:08:14,552 epoch 27 - iter 99/111 - loss 3.45005764 - samples/sec: 29.71 - lr: 0.100000\r\n2021-01-25 11:08:19,726 epoch 27 - iter 110/111 - loss 3.46309766 - samples/sec: 34.03 - lr: 0.100000\r\n2021-01-25 11:08:19,866 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:08:19,868 EPOCH 27 done: loss 3.4552 - lr 0.1000000\r\n2021-01-25 11:08:19,869 BAD EPOCHS (no improvement): 1\r\n2021-01-25 11:08:59,806 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:09:05,855 epoch 28 - iter 11/111 - loss 2.89055541 - samples/sec: 29.24 - lr: 0.100000\r\n2021-01-25 11:09:11,744 epoch 28 - iter 22/111 - loss 2.84430294 - samples/sec: 29.90 - lr: 0.100000\r\n2021-01-25 11:09:17,793 epoch 28 - iter 33/111 - loss 2.93531159 - samples/sec: 29.10 - lr: 0.100000\r\n2021-01-25 11:09:23,659 epoch 28 - iter 44/111 - loss 3.14092332 - samples/sec: 30.01 - lr: 0.100000\r\n2021-01-25 11:09:28,983 epoch 28 - iter 55/111 - loss 3.12229096 - samples/sec: 33.07 - lr: 0.100000\r\n2021-01-25 11:09:35,243 epoch 28 - iter 66/111 - loss 3.18796567 - samples/sec: 28.13 - lr: 0.100000\r\n2021-01-25 11:09:42,254 epoch 28 - iter 77/111 - loss 3.14619401 - samples/sec: 25.11 - lr: 0.100000\r\n2021-01-25 11:09:47,960 epoch 28 - iter 88/111 - loss 3.09235497 - samples/sec: 30.86 - lr: 0.100000\r\n2021-01-25 11:09:53,263 epoch 28 - iter 99/111 - loss 3.08971684 - samples/sec: 33.20 - lr: 0.100000\r\n2021-01-25 11:09:59,032 epoch 28 - iter 110/111 - loss 3.16876111 - samples/sec: 30.52 - lr: 0.100000\r\n2021-01-25 11:09:59,090 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:09:59,091 EPOCH 28 done: loss 3.1404 - lr 0.1000000\r\n2021-01-25 11:09:59,092 BAD EPOCHS (no improvement): 0\r\n2021-01-25 11:10:37,935 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:10:44,074 epoch 29 - iter 11/111 - loss 3.22099484 - samples/sec: 28.82 - lr: 0.100000\r\n2021-01-25 11:10:49,804 epoch 29 - iter 22/111 - loss 3.05376521 - samples/sec: 30.73 - lr: 0.100000\r\n2021-01-25 11:10:55,385 epoch 29 - iter 33/111 - loss 2.97911998 - samples/sec: 31.55 - lr: 0.100000\r\n2021-01-25 11:11:00,865 epoch 29 - iter 44/111 - loss 2.89637794 - samples/sec: 32.13 - lr: 0.100000\r\n2021-01-25 11:11:05,908 epoch 29 - iter 55/111 - loss 2.89810633 - samples/sec: 34.91 - lr: 0.100000\r\n2021-01-25 11:11:11,582 epoch 29 - iter 66/111 - loss 2.88006197 - samples/sec: 31.03 - lr: 0.100000\r\n2021-01-25 11:11:17,157 epoch 29 - iter 77/111 - loss 3.04843036 - samples/sec: 31.59 - lr: 0.100000\r\n2021-01-25 11:11:23,679 epoch 29 - iter 88/111 - loss 3.12833392 - samples/sec: 26.99 - lr: 0.100000\r\n2021-01-25 11:11:30,000 epoch 29 - iter 99/111 - loss 3.12368597 - samples/sec: 27.85 - lr: 0.100000\r\n2021-01-25 11:11:36,775 epoch 29 - iter 110/111 - loss 3.18379832 - samples/sec: 25.99 - lr: 0.100000\r\n2021-01-25 11:11:36,951 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:11:36,952 EPOCH 29 done: loss 3.1957 - lr 0.1000000\r\n2021-01-25 11:11:36,954 BAD EPOCHS (no improvement): 1\r\n2021-01-25 11:12:17,596 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:12:24,477 epoch 30 - iter 11/111 - loss 3.46531834 - samples/sec: 25.68 - lr: 0.100000\r\n2021-01-25 11:12:30,704 epoch 30 - iter 22/111 - loss 3.06817406 - samples/sec: 28.28 - lr: 0.100000\r\n2021-01-25 11:12:37,324 epoch 30 - iter 33/111 - loss 3.18402290 - samples/sec: 26.59 - lr: 0.100000\r\n2021-01-25 11:12:43,955 epoch 30 - iter 44/111 - loss 3.13363074 - samples/sec: 26.55 - lr: 0.100000\r\n2021-01-25 11:12:50,451 epoch 30 - iter 55/111 - loss 3.26960817 - samples/sec: 27.10 - lr: 0.100000\r\n2021-01-25 11:12:55,731 epoch 30 - iter 66/111 - loss 3.23844153 - samples/sec: 33.35 - lr: 0.100000\r\n2021-01-25 11:13:01,505 epoch 30 - iter 77/111 - loss 3.31905947 - samples/sec: 30.49 - lr: 0.100000\r\n2021-01-25 11:13:06,276 epoch 30 - iter 88/111 - loss 3.28804243 - samples/sec: 36.90 - lr: 0.100000\r\n2021-01-25 11:13:10,826 epoch 30 - iter 99/111 - loss 3.17421255 - samples/sec: 38.70 - lr: 0.100000\r\n2021-01-25 11:13:16,399 epoch 30 - iter 110/111 - loss 3.14507711 - samples/sec: 31.60 - lr: 0.100000\r\n2021-01-25 11:13:16,459 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:13:16,460 EPOCH 30 done: loss 3.1245 - lr 0.1000000\r\n2021-01-25 11:13:16,461 BAD EPOCHS (no improvement): 0\r\n2021-01-25 11:13:48,323 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:13:54,302 epoch 31 - iter 11/111 - loss 2.79689815 - samples/sec: 29.61 - lr: 0.100000\r\n2021-01-25 11:14:02,827 epoch 31 - iter 22/111 - loss 3.26084276 - samples/sec: 32.70 - lr: 0.100000\r\n2021-01-25 11:14:08,369 epoch 31 - iter 33/111 - loss 3.10742700 - samples/sec: 31.77 - lr: 0.100000\r\n2021-01-25 11:14:14,760 epoch 31 - iter 44/111 - loss 3.27269035 - samples/sec: 27.55 - lr: 0.100000\r\n2021-01-25 11:14:20,358 epoch 31 - iter 55/111 - loss 3.21613452 - samples/sec: 31.45 - lr: 0.100000\r\n2021-01-25 11:14:27,100 epoch 31 - iter 66/111 - loss 3.29908703 - samples/sec: 26.11 - lr: 0.100000\r\n2021-01-25 11:14:32,671 epoch 31 - iter 77/111 - loss 3.16357533 - samples/sec: 31.61 - lr: 0.100000\r\n2021-01-25 11:14:37,746 epoch 31 - iter 88/111 - loss 3.26563977 - samples/sec: 34.69 - lr: 0.100000\r\n2021-01-25 11:14:44,277 epoch 31 - iter 99/111 - loss 3.23845681 - samples/sec: 26.96 - lr: 0.100000\r\n2021-01-25 11:14:49,849 epoch 31 - iter 110/111 - loss 3.24399293 - samples/sec: 31.60 - lr: 0.100000\r\n2021-01-25 11:14:49,914 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:14:49,915 EPOCH 31 done: loss 3.2158 - lr 0.1000000\r\n2021-01-25 11:14:49,917 BAD EPOCHS (no improvement): 1\r\n2021-01-25 11:15:32,153 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:15:37,308 epoch 32 - iter 11/111 - loss 3.74671636 - samples/sec: 34.38 - lr: 0.100000\r\n2021-01-25 11:15:42,566 epoch 32 - iter 22/111 - loss 3.52645666 - samples/sec: 33.48 - lr: 0.100000\r\n2021-01-25 11:15:48,879 epoch 32 - iter 33/111 - loss 3.48688529 - samples/sec: 27.89 - lr: 0.100000\r\n2021-01-25 11:15:56,774 epoch 32 - iter 44/111 - loss 3.64896190 - samples/sec: 22.30 - lr: 0.100000\r\n2021-01-25 11:16:02,925 epoch 32 - iter 55/111 - loss 3.50396811 - samples/sec: 28.63 - lr: 0.100000\r\n2021-01-25 11:16:08,170 epoch 32 - iter 66/111 - loss 3.53260714 - samples/sec: 33.57 - lr: 0.100000\r\n2021-01-25 11:16:13,181 epoch 32 - iter 77/111 - loss 3.36382006 - samples/sec: 35.14 - lr: 0.100000\r\n2021-01-25 11:16:18,659 epoch 32 - iter 88/111 - loss 3.27387298 - samples/sec: 32.14 - lr: 0.100000\r\n2021-01-25 11:16:24,095 epoch 32 - iter 99/111 - loss 3.20687566 - samples/sec: 32.39 - lr: 0.100000\r\n2021-01-25 11:16:29,952 epoch 32 - iter 110/111 - loss 3.18156727 - samples/sec: 30.06 - lr: 0.100000\r\n2021-01-25 11:16:30,028 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:16:30,030 EPOCH 32 done: loss 3.1845 - lr 0.1000000\r\n2021-01-25 11:16:30,032 BAD EPOCHS (no improvement): 2\r\n2021-01-25 11:17:02,234 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:17:08,194 epoch 33 - iter 11/111 - loss 3.03868398 - samples/sec: 29.68 - lr: 0.100000\r\n2021-01-25 11:17:13,556 epoch 33 - iter 22/111 - loss 2.92616935 - samples/sec: 32.84 - lr: 0.100000\r\n2021-01-25 11:17:19,336 epoch 33 - iter 33/111 - loss 2.80745126 - samples/sec: 30.46 - lr: 0.100000\r\n2021-01-25 11:17:25,547 epoch 33 - iter 44/111 - loss 2.89847333 - samples/sec: 28.34 - lr: 0.100000\r\n2021-01-25 11:17:31,706 epoch 33 - iter 55/111 - loss 2.86311074 - samples/sec: 28.59 - lr: 0.100000\r\n2021-01-25 11:17:37,953 epoch 33 - iter 66/111 - loss 2.88540350 - samples/sec: 28.18 - lr: 0.100000\r\n2021-01-25 11:17:43,600 epoch 33 - iter 77/111 - loss 2.81552082 - samples/sec: 31.18 - lr: 0.100000\r\n2021-01-25 11:17:49,715 epoch 33 - iter 88/111 - loss 2.95309269 - samples/sec: 28.79 - lr: 0.100000\r\n2021-01-25 11:17:54,904 epoch 33 - iter 99/111 - loss 2.96507429 - samples/sec: 33.93 - lr: 0.100000\r\n2021-01-25 11:18:01,023 epoch 33 - iter 110/111 - loss 2.95499291 - samples/sec: 28.77 - lr: 0.100000\r\n2021-01-25 11:18:01,097 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:18:01,098 EPOCH 33 done: loss 2.9287 - lr 0.1000000\r\n2021-01-25 11:18:01,100 BAD EPOCHS (no improvement): 0\r\n2021-01-25 11:18:33,120 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:18:38,560 epoch 34 - iter 11/111 - loss 3.07879266 - samples/sec: 32.54 - lr: 0.100000\r\n2021-01-25 11:18:44,164 epoch 34 - iter 22/111 - loss 2.81848154 - samples/sec: 31.41 - lr: 0.100000\r\n2021-01-25 11:18:50,296 epoch 34 - iter 33/111 - loss 3.11980985 - samples/sec: 28.71 - lr: 0.100000\r\n2021-01-25 11:18:55,684 epoch 34 - iter 44/111 - loss 3.13238976 - samples/sec: 32.69 - lr: 0.100000\r\n2021-01-25 11:19:01,449 epoch 34 - iter 55/111 - loss 3.16149788 - samples/sec: 30.54 - lr: 0.100000\r\n2021-01-25 11:19:08,616 epoch 34 - iter 66/111 - loss 3.13348814 - samples/sec: 24.56 - lr: 0.100000\r\n2021-01-25 11:19:14,294 epoch 34 - iter 77/111 - loss 3.11406816 - samples/sec: 31.01 - lr: 0.100000\r\n2021-01-25 11:19:21,730 epoch 34 - iter 88/111 - loss 3.18820072 - samples/sec: 23.68 - lr: 0.100000\r\n2021-01-25 11:19:26,916 epoch 34 - iter 99/111 - loss 3.10712424 - samples/sec: 33.95 - lr: 0.100000\r\n2021-01-25 11:19:32,893 epoch 34 - iter 110/111 - loss 3.03698263 - samples/sec: 29.46 - lr: 0.100000\r\n2021-01-25 11:19:32,970 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:19:32,971 EPOCH 34 done: loss 3.0097 - lr 0.1000000\r\n2021-01-25 11:19:32,972 BAD EPOCHS (no improvement): 1\r\n2021-01-25 11:20:10,650 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:20:17,062 epoch 35 - iter 11/111 - loss 3.51922204 - samples/sec: 27.58 - lr: 0.100000\r\n2021-01-25 11:20:22,803 epoch 35 - iter 22/111 - loss 3.35290692 - samples/sec: 30.67 - lr: 0.100000\r\n2021-01-25 11:20:28,408 epoch 35 - iter 33/111 - loss 3.12284018 - samples/sec: 31.42 - lr: 0.100000\r\n2021-01-25 11:20:34,268 epoch 35 - iter 44/111 - loss 3.06114052 - samples/sec: 30.05 - lr: 0.100000\r\n2021-01-25 11:20:39,727 epoch 35 - iter 55/111 - loss 2.91180301 - samples/sec: 32.25 - lr: 0.100000\r\n2021-01-25 11:20:45,826 epoch 35 - iter 66/111 - loss 2.98474466 - samples/sec: 28.87 - lr: 0.100000\r\n2021-01-25 11:20:52,335 epoch 35 - iter 77/111 - loss 2.96009049 - samples/sec: 27.05 - lr: 0.100000\r\n2021-01-25 11:20:57,955 epoch 35 - iter 88/111 - loss 2.97090394 - samples/sec: 31.33 - lr: 0.100000\r\n2021-01-25 11:21:03,663 epoch 35 - iter 99/111 - loss 2.96750320 - samples/sec: 30.85 - lr: 0.100000\r\n2021-01-25 11:21:09,346 epoch 35 - iter 110/111 - loss 2.93056582 - samples/sec: 30.98 - lr: 0.100000\r\n2021-01-25 11:21:09,429 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:21:09,430 EPOCH 35 done: loss 2.9119 - lr 0.1000000\r\n2021-01-25 11:21:09,431 BAD EPOCHS (no improvement): 0\r\n2021-01-25 11:21:49,619 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:21:55,855 epoch 36 - iter 11/111 - loss 2.72645469 - samples/sec: 28.36 - lr: 0.100000\r\n2021-01-25 11:22:01,716 epoch 36 - iter 22/111 - loss 2.69821284 - samples/sec: 30.04 - lr: 0.100000\r\n2021-01-25 11:22:07,199 epoch 36 - iter 33/111 - loss 2.89728564 - samples/sec: 32.11 - lr: 0.100000\r\n2021-01-25 11:22:13,290 epoch 36 - iter 44/111 - loss 2.90264571 - samples/sec: 28.91 - lr: 0.100000\r\n2021-01-25 11:22:19,946 epoch 36 - iter 55/111 - loss 2.78748222 - samples/sec: 26.45 - lr: 0.100000\r\n2021-01-25 11:22:26,139 epoch 36 - iter 66/111 - loss 2.74974000 - samples/sec: 28.43 - lr: 0.100000\r\n2021-01-25 11:22:31,414 epoch 36 - iter 77/111 - loss 2.79338780 - samples/sec: 33.38 - lr: 0.100000\r\n2021-01-25 11:22:36,547 epoch 36 - iter 88/111 - loss 2.83762308 - samples/sec: 34.30 - lr: 0.100000\r\n2021-01-25 11:22:42,755 epoch 36 - iter 99/111 - loss 2.87280162 - samples/sec: 28.36 - lr: 0.100000\r\n2021-01-25 11:22:48,190 epoch 36 - iter 110/111 - loss 2.94247575 - samples/sec: 32.39 - lr: 0.100000\r\n2021-01-25 11:22:48,275 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:22:48,276 EPOCH 36 done: loss 2.9494 - lr 0.1000000\r\n2021-01-25 11:22:48,278 BAD EPOCHS (no improvement): 1\r\n2021-01-25 11:23:21,739 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:23:28,153 epoch 37 - iter 11/111 - loss 3.16743422 - samples/sec: 27.57 - lr: 0.100000\r\n2021-01-25 11:23:34,343 epoch 37 - iter 22/111 - loss 2.86954344 - samples/sec: 28.45 - lr: 0.100000\r\n2021-01-25 11:23:40,250 epoch 37 - iter 33/111 - loss 2.88924729 - samples/sec: 29.81 - lr: 0.100000\r\n2021-01-25 11:23:46,142 epoch 37 - iter 44/111 - loss 2.83907682 - samples/sec: 29.88 - lr: 0.100000\r\n2021-01-25 11:23:51,894 epoch 37 - iter 55/111 - loss 2.90263764 - samples/sec: 30.61 - lr: 0.100000\r\n2021-01-25 11:25:47,261 epoch 37 - iter 66/111 - loss 2.91293082 - samples/sec: 30.21 - lr: 0.100000\r\n2021-01-25 11:25:52,068 epoch 37 - iter 77/111 - loss 2.94032987 - samples/sec: 36.63 - lr: 0.100000\r\n2021-01-25 11:25:58,409 epoch 37 - iter 88/111 - loss 3.03329203 - samples/sec: 27.77 - lr: 0.100000\r\n2021-01-25 11:26:04,372 epoch 37 - iter 99/111 - loss 2.92551837 - samples/sec: 29.53 - lr: 0.100000\r\n2021-01-25 11:26:10,677 epoch 37 - iter 110/111 - loss 2.90970864 - samples/sec: 27.92 - lr: 0.100000\r\n2021-01-25 11:26:10,722 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:26:10,723 EPOCH 37 done: loss 2.9066 - lr 0.1000000\r\n2021-01-25 11:26:10,724 BAD EPOCHS (no improvement): 0\r\n2021-01-25 11:26:43,034 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:26:57,593 epoch 38 - iter 11/111 - loss 2.89960952 - samples/sec: 27.43 - lr: 0.100000\r\n2021-01-25 11:27:03,764 epoch 38 - iter 22/111 - loss 2.87588685 - samples/sec: 28.53 - lr: 0.100000\r\n2021-01-25 11:27:10,100 epoch 38 - iter 33/111 - loss 2.99533075 - samples/sec: 27.79 - lr: 0.100000\r\n2021-01-25 11:27:15,235 epoch 38 - iter 44/111 - loss 3.05135858 - samples/sec: 34.29 - lr: 0.100000\r\n2021-01-25 11:27:21,292 epoch 38 - iter 55/111 - loss 3.06756002 - samples/sec: 29.07 - lr: 0.100000\r\n2021-01-25 11:27:27,636 epoch 38 - iter 66/111 - loss 3.15773214 - samples/sec: 27.75 - lr: 0.100000\r\n2021-01-25 11:27:33,665 epoch 38 - iter 77/111 - loss 3.07934983 - samples/sec: 29.20 - lr: 0.100000\r\n2021-01-25 11:27:38,549 epoch 38 - iter 88/111 - loss 3.04182896 - samples/sec: 36.05 - lr: 0.100000\r\n2021-01-25 11:27:44,612 epoch 38 - iter 99/111 - loss 2.98516604 - samples/sec: 29.04 - lr: 0.100000\r\n2021-01-25 11:27:49,900 epoch 38 - iter 110/111 - loss 2.92953254 - samples/sec: 33.30 - lr: 0.100000\r\n2021-01-25 11:27:49,963 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:27:49,965 EPOCH 38 done: loss 2.9575 - lr 0.1000000\r\n2021-01-25 11:27:49,968 BAD EPOCHS (no improvement): 1\r\n2021-01-25 11:28:24,985 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:28:31,325 epoch 39 - iter 11/111 - loss 2.43373463 - samples/sec: 27.90 - lr: 0.100000\r\n2021-01-25 11:28:36,511 epoch 39 - iter 22/111 - loss 2.33439837 - samples/sec: 33.95 - lr: 0.100000\r\n2021-01-25 11:28:42,453 epoch 39 - iter 33/111 - loss 2.55580492 - samples/sec: 29.63 - lr: 0.100000\r\n2021-01-25 11:28:48,638 epoch 39 - iter 44/111 - loss 2.69147430 - samples/sec: 28.47 - lr: 0.100000\r\n2021-01-25 11:28:54,154 epoch 39 - iter 55/111 - loss 2.66834773 - samples/sec: 31.92 - lr: 0.100000\r\n2021-01-25 11:29:00,444 epoch 39 - iter 66/111 - loss 2.74799052 - samples/sec: 27.99 - lr: 0.100000\r\n2021-01-25 11:29:06,221 epoch 39 - iter 77/111 - loss 2.77623356 - samples/sec: 30.48 - lr: 0.100000\r\n2021-01-25 11:29:12,615 epoch 39 - iter 88/111 - loss 2.76129756 - samples/sec: 27.54 - lr: 0.100000\r\n2021-01-25 11:29:19,051 epoch 39 - iter 99/111 - loss 2.85527288 - samples/sec: 27.35 - lr: 0.100000\r\n2021-01-25 11:29:24,608 epoch 39 - iter 110/111 - loss 2.81097984 - samples/sec: 31.69 - lr: 0.100000\r\n2021-01-25 11:29:24,723 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:29:24,724 EPOCH 39 done: loss 2.8238 - lr 0.1000000\r\n2021-01-25 11:29:24,726 BAD EPOCHS (no improvement): 0\r\n2021-01-25 11:30:00,733 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:30:06,753 epoch 40 - iter 11/111 - loss 3.48423505 - samples/sec: 29.38 - lr: 0.100000\r\n2021-01-25 11:30:12,671 epoch 40 - iter 22/111 - loss 3.41717418 - samples/sec: 29.75 - lr: 0.100000\r\n2021-01-25 11:30:17,946 epoch 40 - iter 33/111 - loss 3.23930618 - samples/sec: 33.38 - lr: 0.100000\r\n2021-01-25 11:30:24,660 epoch 40 - iter 44/111 - loss 2.97311551 - samples/sec: 26.22 - lr: 0.100000\r\n2021-01-25 11:30:31,169 epoch 40 - iter 55/111 - loss 3.17618476 - samples/sec: 27.05 - lr: 0.100000\r\n2021-01-25 11:30:36,598 epoch 40 - iter 66/111 - loss 3.07176837 - samples/sec: 32.43 - lr: 0.100000\r\n2021-01-25 11:30:42,171 epoch 40 - iter 77/111 - loss 3.03386935 - samples/sec: 31.60 - lr: 0.100000\r\n2021-01-25 11:30:48,842 epoch 40 - iter 88/111 - loss 2.95677129 - samples/sec: 26.39 - lr: 0.100000\r\n2021-01-25 11:30:54,059 epoch 40 - iter 99/111 - loss 2.93549863 - samples/sec: 33.75 - lr: 0.100000\r\n2021-01-25 11:31:00,560 epoch 40 - iter 110/111 - loss 2.89542588 - samples/sec: 27.08 - lr: 0.100000\r\n2021-01-25 11:31:00,737 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:31:00,738 EPOCH 40 done: loss 2.8951 - lr 0.1000000\r\n2021-01-25 11:31:00,740 BAD EPOCHS (no improvement): 1\r\n2021-01-25 11:31:41,609 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:31:47,751 epoch 41 - iter 11/111 - loss 2.90424699 - samples/sec: 28.79 - lr: 0.100000\r\n2021-01-25 11:31:53,675 epoch 41 - iter 22/111 - loss 2.57281015 - samples/sec: 29.72 - lr: 0.100000\r\n2021-01-25 11:31:59,731 epoch 41 - iter 33/111 - loss 2.72727507 - samples/sec: 29.07 - lr: 0.100000\r\n2021-01-25 11:32:05,693 epoch 41 - iter 44/111 - loss 2.71146367 - samples/sec: 29.53 - lr: 0.100000\r\n2021-01-25 11:32:10,952 epoch 41 - iter 55/111 - loss 2.68553722 - samples/sec: 33.48 - lr: 0.100000\r\n2021-01-25 11:32:16,759 epoch 41 - iter 66/111 - loss 2.65014202 - samples/sec: 30.32 - lr: 0.100000\r\n2021-01-25 11:32:22,723 epoch 41 - iter 77/111 - loss 2.65167695 - samples/sec: 29.52 - lr: 0.100000\r\n2021-01-25 11:32:28,376 epoch 41 - iter 88/111 - loss 2.62132972 - samples/sec: 31.15 - lr: 0.100000\r\n2021-01-25 11:32:34,829 epoch 41 - iter 99/111 - loss 2.77568768 - samples/sec: 27.28 - lr: 0.100000\r\n2021-01-25 11:32:40,653 epoch 41 - iter 110/111 - loss 2.77192337 - samples/sec: 30.23 - lr: 0.100000\r\n2021-01-25 11:32:40,698 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:32:40,699 EPOCH 41 done: loss 2.7549 - lr 0.1000000\r\n2021-01-25 11:32:40,701 BAD EPOCHS (no improvement): 0\r\n2021-01-25 11:33:21,873 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:33:27,380 epoch 42 - iter 11/111 - loss 3.18380791 - samples/sec: 32.33 - lr: 0.100000\r\n2021-01-25 11:33:33,526 epoch 42 - iter 22/111 - loss 3.05797781 - samples/sec: 28.65 - lr: 0.100000\r\n2021-01-25 11:33:39,224 epoch 42 - iter 33/111 - loss 2.81637545 - samples/sec: 30.90 - lr: 0.100000\r\n2021-01-25 11:33:45,605 epoch 42 - iter 44/111 - loss 2.86018511 - samples/sec: 27.59 - lr: 0.100000\r\n2021-01-25 11:33:51,446 epoch 42 - iter 55/111 - loss 2.74580269 - samples/sec: 30.14 - lr: 0.100000\r\n2021-01-25 11:33:58,656 epoch 42 - iter 66/111 - loss 2.91552790 - samples/sec: 24.42 - lr: 0.100000\r\n2021-01-25 11:34:04,366 epoch 42 - iter 77/111 - loss 2.94514490 - samples/sec: 30.83 - lr: 0.100000\r\n2021-01-25 11:34:09,585 epoch 42 - iter 88/111 - loss 2.88403995 - samples/sec: 33.74 - lr: 0.100000\r\n2021-01-25 11:34:15,681 epoch 42 - iter 99/111 - loss 2.84163353 - samples/sec: 28.88 - lr: 0.100000\r\n2021-01-25 11:34:22,679 epoch 42 - iter 110/111 - loss 2.82954320 - samples/sec: 25.16 - lr: 0.100000\r\n2021-01-25 11:34:22,767 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:34:22,769 EPOCH 42 done: loss 2.8226 - lr 0.1000000\r\n2021-01-25 11:34:22,771 BAD EPOCHS (no improvement): 1\r\n2021-01-25 11:35:00,539 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:35:07,219 epoch 43 - iter 11/111 - loss 2.36389663 - samples/sec: 26.47 - lr: 0.100000\r\n2021-01-25 11:35:13,165 epoch 43 - iter 22/111 - loss 2.36934274 - samples/sec: 29.61 - lr: 0.100000\r\n2021-01-25 11:35:19,465 epoch 43 - iter 33/111 - loss 2.49502711 - samples/sec: 27.95 - lr: 0.100000\r\n2021-01-25 11:35:26,508 epoch 43 - iter 44/111 - loss 2.50396190 - samples/sec: 25.00 - lr: 0.100000\r\n2021-01-25 11:35:31,971 epoch 43 - iter 55/111 - loss 2.59746035 - samples/sec: 32.23 - lr: 0.100000\r\n2021-01-25 11:35:38,015 epoch 43 - iter 66/111 - loss 2.54767620 - samples/sec: 29.13 - lr: 0.100000\r\n2021-01-25 11:35:43,363 epoch 43 - iter 77/111 - loss 2.62820696 - samples/sec: 32.92 - lr: 0.100000\r\n2021-01-25 11:35:49,198 epoch 43 - iter 88/111 - loss 2.68061659 - samples/sec: 30.17 - lr: 0.100000\r\n2021-01-25 11:35:55,319 epoch 43 - iter 99/111 - loss 2.67624498 - samples/sec: 28.76 - lr: 0.100000\r\n2021-01-25 11:36:01,492 epoch 43 - iter 110/111 - loss 2.73217012 - samples/sec: 28.52 - lr: 0.100000\r\n2021-01-25 11:36:01,876 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:36:01,877 EPOCH 43 done: loss 3.1642 - lr 0.1000000\r\n2021-01-25 11:36:01,878 BAD EPOCHS (no improvement): 2\r\n2021-01-25 11:36:37,325 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:36:42,873 epoch 44 - iter 11/111 - loss 2.01169826 - samples/sec: 31.89 - lr: 0.100000\r\n2021-01-25 11:36:48,819 epoch 44 - iter 22/111 - loss 1.95144150 - samples/sec: 29.61 - lr: 0.100000\r\n2021-01-25 11:36:54,726 epoch 44 - iter 33/111 - loss 2.61340152 - samples/sec: 29.80 - lr: 0.100000\r\n2021-01-25 11:37:01,965 epoch 44 - iter 44/111 - loss 2.59197275 - samples/sec: 24.32 - lr: 0.100000\r\n2021-01-25 11:37:08,116 epoch 44 - iter 55/111 - loss 2.56804570 - samples/sec: 28.62 - lr: 0.100000\r\n2021-01-25 11:37:14,626 epoch 44 - iter 66/111 - loss 2.60264895 - samples/sec: 27.04 - lr: 0.100000\r\n2021-01-25 11:37:20,683 epoch 44 - iter 77/111 - loss 2.59730850 - samples/sec: 29.07 - lr: 0.100000\r\n2021-01-25 11:37:27,367 epoch 44 - iter 88/111 - loss 2.64072504 - samples/sec: 26.34 - lr: 0.100000\r\n2021-01-25 11:37:32,954 epoch 44 - iter 99/111 - loss 2.68413012 - samples/sec: 31.51 - lr: 0.100000\r\n2021-01-25 11:37:38,032 epoch 44 - iter 110/111 - loss 2.63417917 - samples/sec: 34.67 - lr: 0.100000\r\n2021-01-25 11:37:38,143 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:37:38,144 EPOCH 44 done: loss 2.6151 - lr 0.1000000\r\n2021-01-25 11:37:38,145 BAD EPOCHS (no improvement): 0\r\n2021-01-25 11:38:11,983 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:38:18,829 epoch 45 - iter 11/111 - loss 2.21903487 - samples/sec: 25.82 - lr: 0.100000\r\n2021-01-25 11:38:24,881 epoch 45 - iter 22/111 - loss 2.40982877 - samples/sec: 29.09 - lr: 0.100000\r\n2021-01-25 11:38:30,841 epoch 45 - iter 33/111 - loss 2.28160072 - samples/sec: 29.54 - lr: 0.100000\r\n2021-01-25 11:38:36,413 epoch 45 - iter 44/111 - loss 2.28662980 - samples/sec: 31.60 - lr: 0.100000\r\n2021-01-25 11:38:41,462 epoch 45 - iter 55/111 - loss 2.28525278 - samples/sec: 34.87 - lr: 0.100000\r\n2021-01-25 11:38:47,995 epoch 45 - iter 66/111 - loss 2.45093957 - samples/sec: 26.95 - lr: 0.100000\r\n2021-01-25 11:38:54,588 epoch 45 - iter 77/111 - loss 2.48274891 - samples/sec: 26.70 - lr: 0.100000\r\n2021-01-25 11:39:01,052 epoch 45 - iter 88/111 - loss 2.53001037 - samples/sec: 27.24 - lr: 0.100000\r\n2021-01-25 11:39:06,848 epoch 45 - iter 99/111 - loss 2.54270450 - samples/sec: 30.38 - lr: 0.100000\r\n2021-01-25 11:39:12,350 epoch 45 - iter 110/111 - loss 2.51931607 - samples/sec: 32.00 - lr: 0.100000\r\n2021-01-25 11:39:12,398 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:39:12,399 EPOCH 45 done: loss 2.4972 - lr 0.1000000\r\n2021-01-25 11:39:12,400 BAD EPOCHS (no improvement): 0\r\n2021-01-25 11:39:52,226 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:39:57,872 epoch 46 - iter 11/111 - loss 2.21434944 - samples/sec: 31.33 - lr: 0.100000\r\n2021-01-25 11:40:03,704 epoch 46 - iter 22/111 - loss 2.02364354 - samples/sec: 30.18 - lr: 0.100000\r\n2021-01-25 11:40:10,083 epoch 46 - iter 33/111 - loss 2.15216145 - samples/sec: 27.61 - lr: 0.100000\r\n2021-01-25 11:40:15,635 epoch 46 - iter 44/111 - loss 2.29634910 - samples/sec: 31.71 - lr: 0.100000\r\n2021-01-25 11:40:21,181 epoch 46 - iter 55/111 - loss 2.44234299 - samples/sec: 31.75 - lr: 0.100000\r\n2021-01-25 11:40:27,187 epoch 46 - iter 66/111 - loss 2.52661931 - samples/sec: 29.31 - lr: 0.100000\r\n2021-01-25 11:40:32,445 epoch 46 - iter 77/111 - loss 2.46825149 - samples/sec: 33.49 - lr: 0.100000\r\n2021-01-25 11:40:38,538 epoch 46 - iter 88/111 - loss 2.53915692 - samples/sec: 28.90 - lr: 0.100000\r\n2021-01-25 11:40:45,186 epoch 46 - iter 99/111 - loss 2.51694309 - samples/sec: 26.49 - lr: 0.100000\r\n2021-01-25 11:40:52,149 epoch 46 - iter 110/111 - loss 2.57741266 - samples/sec: 25.28 - lr: 0.100000\r\n2021-01-25 11:40:52,245 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:40:52,247 EPOCH 46 done: loss 2.5804 - lr 0.1000000\r\n2021-01-25 11:40:52,249 BAD EPOCHS (no improvement): 1\r\n2021-01-25 11:41:32,745 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:41:39,120 epoch 47 - iter 11/111 - loss 2.72100385 - samples/sec: 28.39 - lr: 0.100000\r\n2021-01-25 11:41:45,105 epoch 47 - iter 22/111 - loss 2.84815154 - samples/sec: 29.42 - lr: 0.100000\r\n2021-01-25 11:41:51,760 epoch 47 - iter 33/111 - loss 2.61069580 - samples/sec: 26.46 - lr: 0.100000\r\n2021-01-25 11:41:58,406 epoch 47 - iter 44/111 - loss 2.73920726 - samples/sec: 26.49 - lr: 0.100000\r\n2021-01-25 11:42:04,976 epoch 47 - iter 55/111 - loss 2.62572265 - samples/sec: 26.80 - lr: 0.100000\r\n2021-01-25 11:42:10,981 epoch 47 - iter 66/111 - loss 2.64314763 - samples/sec: 29.32 - lr: 0.100000\r\n2021-01-25 11:42:15,623 epoch 47 - iter 77/111 - loss 2.76011765 - samples/sec: 37.93 - lr: 0.100000\r\n2021-01-25 11:42:21,263 epoch 47 - iter 88/111 - loss 2.71644599 - samples/sec: 31.22 - lr: 0.100000\r\n2021-01-25 11:42:26,595 epoch 47 - iter 99/111 - loss 2.65025528 - samples/sec: 33.03 - lr: 0.100000\r\n2021-01-25 11:42:32,684 epoch 47 - iter 110/111 - loss 2.64420135 - samples/sec: 28.91 - lr: 0.100000\r\n2021-01-25 11:42:32,795 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:42:32,796 EPOCH 47 done: loss 2.6228 - lr 0.1000000\r\n2021-01-25 11:42:32,798 BAD EPOCHS (no improvement): 2\r\n2021-01-25 11:43:14,266 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:43:21,426 epoch 48 - iter 11/111 - loss 2.73667067 - samples/sec: 24.68 - lr: 0.100000\r\n2021-01-25 11:43:27,000 epoch 48 - iter 22/111 - loss 2.64127392 - samples/sec: 31.59 - lr: 0.100000\r\n2021-01-25 11:43:32,704 epoch 48 - iter 33/111 - loss 2.43381392 - samples/sec: 30.87 - lr: 0.100000\r\n2021-01-25 11:43:38,117 epoch 48 - iter 44/111 - loss 2.33068804 - samples/sec: 32.52 - lr: 0.100000\r\n2021-01-25 11:43:43,535 epoch 48 - iter 55/111 - loss 2.63984348 - samples/sec: 32.50 - lr: 0.100000\r\n2021-01-25 11:43:49,464 epoch 48 - iter 66/111 - loss 2.68483300 - samples/sec: 29.70 - lr: 0.100000\r\n2021-01-25 11:43:55,970 epoch 48 - iter 77/111 - loss 2.61571536 - samples/sec: 27.06 - lr: 0.100000\r\n2021-01-25 11:44:01,892 epoch 48 - iter 88/111 - loss 2.54865319 - samples/sec: 29.73 - lr: 0.100000\r\n2021-01-25 11:44:07,633 epoch 48 - iter 99/111 - loss 2.54997973 - samples/sec: 30.67 - lr: 0.100000\r\n2021-01-25 11:44:14,094 epoch 48 - iter 110/111 - loss 2.52854875 - samples/sec: 27.25 - lr: 0.100000\r\n2021-01-25 11:44:14,167 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:44:14,168 EPOCH 48 done: loss 2.5071 - lr 0.1000000\r\n2021-01-25 11:44:14,170 BAD EPOCHS (no improvement): 3\r\n2021-01-25 11:44:50,131 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:44:56,307 epoch 49 - iter 11/111 - loss 2.26444705 - samples/sec: 28.64 - lr: 0.100000\r\n2021-01-25 11:45:02,231 epoch 49 - iter 22/111 - loss 2.18552075 - samples/sec: 29.72 - lr: 0.100000\r\n2021-01-25 11:45:07,913 epoch 49 - iter 33/111 - loss 2.28902945 - samples/sec: 30.99 - lr: 0.100000\r\n2021-01-25 11:45:13,749 epoch 49 - iter 44/111 - loss 2.59935950 - samples/sec: 30.17 - lr: 0.100000\r\n2021-01-25 11:45:18,784 epoch 49 - iter 55/111 - loss 2.68127865 - samples/sec: 34.97 - lr: 0.100000\r\n2021-01-25 11:45:25,460 epoch 49 - iter 66/111 - loss 2.67531886 - samples/sec: 26.37 - lr: 0.100000\r\n2021-01-25 11:45:31,614 epoch 49 - iter 77/111 - loss 2.66535183 - samples/sec: 28.61 - lr: 0.100000\r\n2021-01-25 11:45:37,499 epoch 49 - iter 88/111 - loss 2.63391306 - samples/sec: 29.92 - lr: 0.100000\r\n2021-01-25 11:45:44,152 epoch 49 - iter 99/111 - loss 2.59099578 - samples/sec: 26.47 - lr: 0.100000\r\n2021-01-25 11:45:50,581 epoch 49 - iter 110/111 - loss 2.63866038 - samples/sec: 27.38 - lr: 0.100000\r\n2021-01-25 11:45:50,657 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:45:50,659 EPOCH 49 done: loss 2.6151 - lr 0.1000000\r\nEpoch    49: reducing learning rate of group 0 to 5.0000e-02.\r\n2021-01-25 11:45:50,667 BAD EPOCHS (no improvement): 4\r\n2021-01-25 11:46:28,847 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:46:35,034 epoch 50 - iter 11/111 - loss 2.35713735 - samples/sec: 28.58 - lr: 0.050000\r\n2021-01-25 11:46:42,218 epoch 50 - iter 22/111 - loss 2.45717296 - samples/sec: 24.51 - lr: 0.050000\r\n2021-01-25 11:46:47,706 epoch 50 - iter 33/111 - loss 2.63586355 - samples/sec: 32.08 - lr: 0.050000\r\n2021-01-25 11:46:53,127 epoch 50 - iter 44/111 - loss 2.54825116 - samples/sec: 32.48 - lr: 0.050000\r\n2021-01-25 11:46:58,617 epoch 50 - iter 55/111 - loss 2.43891905 - samples/sec: 32.07 - lr: 0.050000\r\n2021-01-25 11:47:05,514 epoch 50 - iter 66/111 - loss 2.33190236 - samples/sec: 25.53 - lr: 0.050000\r\n2021-01-25 11:47:11,049 epoch 50 - iter 77/111 - loss 2.31553948 - samples/sec: 31.81 - lr: 0.050000\r\n2021-01-25 11:47:16,575 epoch 50 - iter 88/111 - loss 2.25683910 - samples/sec: 31.86 - lr: 0.050000\r\n2021-01-25 11:47:22,507 epoch 50 - iter 99/111 - loss 2.23318195 - samples/sec: 29.68 - lr: 0.050000\r\n2021-01-25 11:47:28,443 epoch 50 - iter 110/111 - loss 2.23143409 - samples/sec: 29.66 - lr: 0.050000\r\n2021-01-25 11:47:28,762 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:47:28,763 EPOCH 50 done: loss 2.2292 - lr 0.0500000\r\n2021-01-25 11:47:28,765 BAD EPOCHS (no improvement): 0\r\n2021-01-25 11:48:06,867 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:48:13,783 epoch 51 - iter 11/111 - loss 2.18304784 - samples/sec: 25.55 - lr: 0.050000\r\n2021-01-25 11:48:20,225 epoch 51 - iter 22/111 - loss 2.43048250 - samples/sec: 27.33 - lr: 0.050000\r\n2021-01-25 11:48:25,460 epoch 51 - iter 33/111 - loss 2.37367669 - samples/sec: 33.63 - lr: 0.050000\r\n2021-01-25 11:48:31,618 epoch 51 - iter 44/111 - loss 2.31780951 - samples/sec: 28.59 - lr: 0.050000\r\n2021-01-25 11:48:36,946 epoch 51 - iter 55/111 - loss 2.23305076 - samples/sec: 33.05 - lr: 0.050000\r\n2021-01-25 11:48:42,359 epoch 51 - iter 66/111 - loss 2.17786572 - samples/sec: 32.52 - lr: 0.050000\r\n2021-01-25 11:48:49,045 epoch 51 - iter 77/111 - loss 2.13933476 - samples/sec: 26.34 - lr: 0.050000\r\n2021-01-25 11:48:54,750 epoch 51 - iter 88/111 - loss 2.09521602 - samples/sec: 30.86 - lr: 0.050000\r\n2021-01-25 11:49:00,726 epoch 51 - iter 99/111 - loss 2.12616370 - samples/sec: 29.46 - lr: 0.050000\r\n2021-01-25 11:49:06,797 epoch 51 - iter 110/111 - loss 2.18481968 - samples/sec: 29.00 - lr: 0.050000\r\n2021-01-25 11:49:07,374 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:49:07,376 EPOCH 51 done: loss 2.1909 - lr 0.0500000\r\n2021-01-25 11:49:07,378 BAD EPOCHS (no improvement): 0\r\n2021-01-25 11:49:39,592 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:49:45,456 epoch 52 - iter 11/111 - loss 1.73091649 - samples/sec: 30.16 - lr: 0.050000\r\n2021-01-25 11:49:51,422 epoch 52 - iter 22/111 - loss 1.99832044 - samples/sec: 29.51 - lr: 0.050000\r\n2021-01-25 11:49:57,467 epoch 52 - iter 33/111 - loss 2.19519986 - samples/sec: 29.13 - lr: 0.050000\r\n2021-01-25 11:50:03,072 epoch 52 - iter 44/111 - loss 2.15640568 - samples/sec: 31.42 - lr: 0.050000\r\n2021-01-25 11:50:08,757 epoch 52 - iter 55/111 - loss 2.10974158 - samples/sec: 30.97 - lr: 0.050000\r\n2021-01-25 11:50:14,934 epoch 52 - iter 66/111 - loss 2.09556403 - samples/sec: 28.50 - lr: 0.050000\r\n2021-01-25 11:50:21,124 epoch 52 - iter 77/111 - loss 2.08037419 - samples/sec: 28.44 - lr: 0.050000\r\n2021-01-25 11:50:27,898 epoch 52 - iter 88/111 - loss 2.10373959 - samples/sec: 25.99 - lr: 0.050000\r\n2021-01-25 11:50:33,706 epoch 52 - iter 99/111 - loss 2.10709381 - samples/sec: 30.31 - lr: 0.050000\r\n2021-01-25 11:50:38,604 epoch 52 - iter 110/111 - loss 2.08090206 - samples/sec: 35.95 - lr: 0.050000\r\n2021-01-25 11:50:38,735 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:50:38,736 EPOCH 52 done: loss 2.0625 - lr 0.0500000\r\n2021-01-25 11:50:38,738 BAD EPOCHS (no improvement): 0\r\n2021-01-25 11:51:18,504 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:51:25,288 epoch 53 - iter 11/111 - loss 2.01705449 - samples/sec: 26.04 - lr: 0.050000\r\n2021-01-25 11:51:31,730 epoch 53 - iter 22/111 - loss 1.90370986 - samples/sec: 27.33 - lr: 0.050000\r\n2021-01-25 11:51:38,513 epoch 53 - iter 33/111 - loss 2.09853537 - samples/sec: 25.96 - lr: 0.050000\r\n2021-01-25 11:51:44,080 epoch 53 - iter 44/111 - loss 1.96282133 - samples/sec: 31.63 - lr: 0.050000\r\n2021-01-25 11:51:50,174 epoch 53 - iter 55/111 - loss 2.00787822 - samples/sec: 28.89 - lr: 0.050000\r\n2021-01-25 11:51:55,978 epoch 53 - iter 66/111 - loss 2.12322649 - samples/sec: 30.34 - lr: 0.050000\r\n2021-01-25 11:52:02,389 epoch 53 - iter 77/111 - loss 2.10005822 - samples/sec: 27.47 - lr: 0.050000\r\n2021-01-25 11:52:07,104 epoch 53 - iter 88/111 - loss 2.04746139 - samples/sec: 37.35 - lr: 0.050000\r\n2021-01-25 11:52:13,366 epoch 53 - iter 99/111 - loss 2.01917097 - samples/sec: 28.12 - lr: 0.050000\r\n2021-01-25 11:52:18,845 epoch 53 - iter 110/111 - loss 2.00830920 - samples/sec: 32.13 - lr: 0.050000\r\n2021-01-25 11:52:18,901 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:52:18,902 EPOCH 53 done: loss 1.9910 - lr 0.0500000\r\n2021-01-25 11:52:18,904 BAD EPOCHS (no improvement): 0\r\n2021-01-25 11:52:59,196 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:53:05,183 epoch 54 - iter 11/111 - loss 2.14837797 - samples/sec: 29.54 - lr: 0.050000\r\n2021-01-25 11:53:11,485 epoch 54 - iter 22/111 - loss 2.19486931 - samples/sec: 27.94 - lr: 0.050000\r\n2021-01-25 11:53:17,407 epoch 54 - iter 33/111 - loss 1.91290445 - samples/sec: 29.73 - lr: 0.050000\r\n2021-01-25 11:53:23,905 epoch 54 - iter 44/111 - loss 1.91239043 - samples/sec: 27.10 - lr: 0.050000\r\n2021-01-25 11:53:30,214 epoch 54 - iter 55/111 - loss 1.88720394 - samples/sec: 27.90 - lr: 0.050000\r\n2021-01-25 11:53:35,415 epoch 54 - iter 66/111 - loss 1.93678142 - samples/sec: 33.86 - lr: 0.050000\r\n2021-01-25 11:53:40,723 epoch 54 - iter 77/111 - loss 1.92156433 - samples/sec: 33.17 - lr: 0.050000\r\n2021-01-25 11:53:47,687 epoch 54 - iter 88/111 - loss 1.92170125 - samples/sec: 25.28 - lr: 0.050000\r\n2021-01-25 11:53:53,592 epoch 54 - iter 99/111 - loss 1.87971373 - samples/sec: 29.82 - lr: 0.050000\r\n2021-01-25 11:53:59,032 epoch 54 - iter 110/111 - loss 1.86843346 - samples/sec: 32.37 - lr: 0.050000\r\n2021-01-25 11:53:59,103 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:53:59,105 EPOCH 54 done: loss 1.8519 - lr 0.0500000\r\n2021-01-25 11:53:59,106 BAD EPOCHS (no improvement): 0\r\n2021-01-25 11:54:36,300 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:54:42,957 epoch 55 - iter 11/111 - loss 1.82710967 - samples/sec: 26.55 - lr: 0.050000\r\n2021-01-25 11:54:48,517 epoch 55 - iter 22/111 - loss 1.88735848 - samples/sec: 31.67 - lr: 0.050000\r\n2021-01-25 11:54:54,262 epoch 55 - iter 33/111 - loss 1.85520092 - samples/sec: 30.65 - lr: 0.050000\r\n2021-01-25 11:54:59,177 epoch 55 - iter 44/111 - loss 1.80710835 - samples/sec: 35.82 - lr: 0.050000\r\n2021-01-25 11:55:04,885 epoch 55 - iter 55/111 - loss 1.93934924 - samples/sec: 30.85 - lr: 0.050000\r\n2021-01-25 11:55:10,584 epoch 55 - iter 66/111 - loss 1.92196495 - samples/sec: 30.90 - lr: 0.050000\r\n2021-01-25 11:55:17,184 epoch 55 - iter 77/111 - loss 1.90982055 - samples/sec: 26.67 - lr: 0.050000\r\n2021-01-25 11:55:23,540 epoch 55 - iter 88/111 - loss 1.89618112 - samples/sec: 27.70 - lr: 0.050000\r\n2021-01-25 11:55:29,347 epoch 55 - iter 99/111 - loss 1.89795932 - samples/sec: 30.32 - lr: 0.050000\r\n2021-01-25 11:55:35,140 epoch 55 - iter 110/111 - loss 1.89739936 - samples/sec: 30.39 - lr: 0.050000\r\n2021-01-25 11:55:35,211 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:55:35,212 EPOCH 55 done: loss 1.8805 - lr 0.0500000\r\n2021-01-25 11:55:35,214 BAD EPOCHS (no improvement): 1\r\n2021-01-25 11:56:08,747 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:56:14,068 epoch 56 - iter 11/111 - loss 2.28413005 - samples/sec: 33.26 - lr: 0.050000\r\n2021-01-25 11:56:19,678 epoch 56 - iter 22/111 - loss 2.30415965 - samples/sec: 31.38 - lr: 0.050000\r\n2021-01-25 11:56:24,717 epoch 56 - iter 33/111 - loss 2.04732648 - samples/sec: 34.94 - lr: 0.050000\r\n2021-01-25 11:56:30,054 epoch 56 - iter 44/111 - loss 2.00044952 - samples/sec: 32.99 - lr: 0.050000\r\n2021-01-25 11:56:36,168 epoch 56 - iter 55/111 - loss 1.90858837 - samples/sec: 28.80 - lr: 0.050000\r\n2021-01-25 11:56:43,120 epoch 56 - iter 66/111 - loss 1.88605417 - samples/sec: 25.33 - lr: 0.050000\r\n2021-01-25 11:56:48,158 epoch 56 - iter 77/111 - loss 1.83538555 - samples/sec: 34.95 - lr: 0.050000\r\n2021-01-25 11:56:55,341 epoch 56 - iter 88/111 - loss 1.88052460 - samples/sec: 24.51 - lr: 0.050000\r\n2021-01-25 11:57:01,438 epoch 56 - iter 99/111 - loss 1.87884715 - samples/sec: 28.88 - lr: 0.050000\r\n2021-01-25 11:57:07,653 epoch 56 - iter 110/111 - loss 1.86558872 - samples/sec: 28.33 - lr: 0.050000\r\n2021-01-25 11:57:07,770 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:57:07,771 EPOCH 56 done: loss 1.8633 - lr 0.0500000\r\n2021-01-25 11:57:07,772 BAD EPOCHS (no improvement): 2\r\n2021-01-25 11:57:39,474 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:57:53,492 epoch 57 - iter 11/111 - loss 1.77860214 - samples/sec: 32.45 - lr: 0.050000\r\n2021-01-25 11:57:59,516 epoch 57 - iter 22/111 - loss 1.83906370 - samples/sec: 29.23 - lr: 0.050000\r\n2021-01-25 11:58:06,147 epoch 57 - iter 33/111 - loss 1.94231358 - samples/sec: 26.55 - lr: 0.050000\r\n2021-01-25 11:58:12,925 epoch 57 - iter 44/111 - loss 1.94184118 - samples/sec: 25.98 - lr: 0.050000\r\n2021-01-25 11:58:18,339 epoch 57 - iter 55/111 - loss 1.91480884 - samples/sec: 32.52 - lr: 0.050000\r\n2021-01-25 11:58:24,086 epoch 57 - iter 66/111 - loss 1.92275561 - samples/sec: 30.64 - lr: 0.050000\r\n2021-01-25 11:58:30,082 epoch 57 - iter 77/111 - loss 1.90475914 - samples/sec: 29.36 - lr: 0.050000\r\n2021-01-25 11:58:35,788 epoch 57 - iter 88/111 - loss 1.85559301 - samples/sec: 30.86 - lr: 0.050000\r\n2021-01-25 11:58:42,359 epoch 57 - iter 99/111 - loss 1.85587502 - samples/sec: 26.79 - lr: 0.050000\r\n2021-01-25 11:58:47,262 epoch 57 - iter 110/111 - loss 1.92152234 - samples/sec: 35.92 - lr: 0.050000\r\n2021-01-25 11:58:47,447 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 11:58:47,448 EPOCH 57 done: loss 1.9050 - lr 0.0500000\r\n2021-01-25 11:58:47,449 BAD EPOCHS (no improvement): 3\r\n2021-01-25 11:59:22,452 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 11:59:28,190 epoch 58 - iter 11/111 - loss 1.79517363 - samples/sec: 30.83 - lr: 0.050000\r\n2021-01-25 11:59:34,551 epoch 58 - iter 22/111 - loss 2.03854591 - samples/sec: 27.68 - lr: 0.050000\r\n2021-01-25 11:59:40,414 epoch 58 - iter 33/111 - loss 1.89547655 - samples/sec: 30.03 - lr: 0.050000\r\n2021-01-25 11:59:47,036 epoch 58 - iter 44/111 - loss 1.85825240 - samples/sec: 26.59 - lr: 0.050000\r\n2021-01-25 11:59:53,117 epoch 58 - iter 55/111 - loss 1.79456089 - samples/sec: 28.95 - lr: 0.050000\r\n2021-01-25 12:00:00,126 epoch 58 - iter 66/111 - loss 1.77742711 - samples/sec: 25.12 - lr: 0.050000\r\n2021-01-25 12:00:05,420 epoch 58 - iter 77/111 - loss 1.72937530 - samples/sec: 33.26 - lr: 0.050000\r\n2021-01-25 12:00:11,634 epoch 58 - iter 88/111 - loss 1.82790911 - samples/sec: 28.33 - lr: 0.050000\r\n2021-01-25 12:00:17,666 epoch 58 - iter 99/111 - loss 1.82581005 - samples/sec: 29.19 - lr: 0.050000\r\n2021-01-25 12:00:22,809 epoch 58 - iter 110/111 - loss 1.78818853 - samples/sec: 34.24 - lr: 0.050000\r\n2021-01-25 12:00:22,867 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:00:22,868 EPOCH 58 done: loss 1.7723 - lr 0.0500000\r\n2021-01-25 12:00:22,870 BAD EPOCHS (no improvement): 0\r\n2021-01-25 12:01:03,210 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:01:09,614 epoch 59 - iter 11/111 - loss 1.78469042 - samples/sec: 27.61 - lr: 0.050000\r\n2021-01-25 12:01:15,034 epoch 59 - iter 22/111 - loss 1.59042391 - samples/sec: 32.49 - lr: 0.050000\r\n2021-01-25 12:01:21,084 epoch 59 - iter 33/111 - loss 1.69231301 - samples/sec: 29.10 - lr: 0.050000\r\n2021-01-25 12:01:27,045 epoch 59 - iter 44/111 - loss 1.61682651 - samples/sec: 29.54 - lr: 0.050000\r\n2021-01-25 12:01:34,204 epoch 59 - iter 55/111 - loss 1.61869046 - samples/sec: 24.59 - lr: 0.050000\r\n2021-01-25 12:01:40,826 epoch 59 - iter 66/111 - loss 1.68842452 - samples/sec: 26.59 - lr: 0.050000\r\n2021-01-25 12:01:45,881 epoch 59 - iter 77/111 - loss 1.71753615 - samples/sec: 34.84 - lr: 0.050000\r\n2021-01-25 12:01:51,219 epoch 59 - iter 88/111 - loss 1.69533439 - samples/sec: 32.99 - lr: 0.050000\r\n2021-01-25 12:01:56,906 epoch 59 - iter 99/111 - loss 1.71060796 - samples/sec: 30.96 - lr: 0.050000\r\n2021-01-25 12:02:03,719 epoch 59 - iter 110/111 - loss 1.73168795 - samples/sec: 25.84 - lr: 0.050000\r\n2021-01-25 12:02:03,903 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:02:03,904 EPOCH 59 done: loss 1.7166 - lr 0.0500000\r\n2021-01-25 12:02:03,905 BAD EPOCHS (no improvement): 0\r\n2021-01-25 12:02:36,087 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:02:42,328 epoch 60 - iter 11/111 - loss 1.95376955 - samples/sec: 28.33 - lr: 0.050000\r\n2021-01-25 12:02:48,526 epoch 60 - iter 22/111 - loss 1.92651694 - samples/sec: 28.40 - lr: 0.050000\r\n2021-01-25 12:02:53,946 epoch 60 - iter 33/111 - loss 1.79232361 - samples/sec: 32.49 - lr: 0.050000\r\n2021-01-25 12:02:59,579 epoch 60 - iter 44/111 - loss 1.65399889 - samples/sec: 31.26 - lr: 0.050000\r\n2021-01-25 12:03:04,989 epoch 60 - iter 55/111 - loss 1.61804408 - samples/sec: 32.55 - lr: 0.050000\r\n2021-01-25 12:03:11,066 epoch 60 - iter 66/111 - loss 1.62668523 - samples/sec: 28.97 - lr: 0.050000\r\n2021-01-25 12:03:16,375 epoch 60 - iter 77/111 - loss 1.60931349 - samples/sec: 33.17 - lr: 0.050000\r\n2021-01-25 12:03:22,805 epoch 60 - iter 88/111 - loss 1.58886976 - samples/sec: 27.38 - lr: 0.050000\r\n2021-01-25 12:03:29,315 epoch 60 - iter 99/111 - loss 1.62626700 - samples/sec: 27.05 - lr: 0.050000\r\n2021-01-25 12:03:35,411 epoch 60 - iter 110/111 - loss 1.68461498 - samples/sec: 28.88 - lr: 0.050000\r\n2021-01-25 12:03:35,482 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:03:35,483 EPOCH 60 done: loss 1.6695 - lr 0.0500000\r\n2021-01-25 12:03:35,485 BAD EPOCHS (no improvement): 0\r\n2021-01-25 12:04:15,089 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:04:22,464 epoch 61 - iter 11/111 - loss 1.90850128 - samples/sec: 23.96 - lr: 0.050000\r\n2021-01-25 12:04:28,645 epoch 61 - iter 22/111 - loss 1.72968649 - samples/sec: 28.48 - lr: 0.050000\r\n2021-01-25 12:04:34,772 epoch 61 - iter 33/111 - loss 1.75811358 - samples/sec: 28.74 - lr: 0.050000\r\n2021-01-25 12:04:39,643 epoch 61 - iter 44/111 - loss 1.69857002 - samples/sec: 36.15 - lr: 0.050000\r\n2021-01-25 12:04:45,914 epoch 61 - iter 55/111 - loss 1.67391535 - samples/sec: 28.07 - lr: 0.050000\r\n2021-01-25 12:04:52,660 epoch 61 - iter 66/111 - loss 1.75760016 - samples/sec: 26.10 - lr: 0.050000\r\n2021-01-25 12:04:58,253 epoch 61 - iter 77/111 - loss 1.75459774 - samples/sec: 31.48 - lr: 0.050000\r\n2021-01-25 12:05:04,462 epoch 61 - iter 88/111 - loss 1.73564435 - samples/sec: 28.36 - lr: 0.050000\r\n2021-01-25 12:05:09,581 epoch 61 - iter 99/111 - loss 1.72145211 - samples/sec: 34.40 - lr: 0.050000\r\n2021-01-25 12:05:15,532 epoch 61 - iter 110/111 - loss 1.70552521 - samples/sec: 29.58 - lr: 0.050000\r\n2021-01-25 12:05:15,585 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:05:15,587 EPOCH 61 done: loss 1.6931 - lr 0.0500000\r\n2021-01-25 12:05:15,588 BAD EPOCHS (no improvement): 1\r\n2021-01-25 12:05:49,501 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:05:55,127 epoch 62 - iter 11/111 - loss 1.47604708 - samples/sec: 31.44 - lr: 0.050000\r\n2021-01-25 12:06:01,665 epoch 62 - iter 22/111 - loss 1.68279212 - samples/sec: 26.93 - lr: 0.050000\r\n2021-01-25 12:06:08,163 epoch 62 - iter 33/111 - loss 1.59796740 - samples/sec: 27.10 - lr: 0.050000\r\n2021-01-25 12:06:13,994 epoch 62 - iter 44/111 - loss 1.60600110 - samples/sec: 30.20 - lr: 0.050000\r\n2021-01-25 12:06:18,996 epoch 62 - iter 55/111 - loss 1.54157640 - samples/sec: 35.20 - lr: 0.050000\r\n2021-01-25 12:06:24,611 epoch 62 - iter 66/111 - loss 1.53799889 - samples/sec: 31.36 - lr: 0.050000\r\n2021-01-25 12:06:30,406 epoch 62 - iter 77/111 - loss 1.60738051 - samples/sec: 30.38 - lr: 0.050000\r\n2021-01-25 12:06:36,796 epoch 62 - iter 88/111 - loss 1.59562062 - samples/sec: 27.55 - lr: 0.050000\r\n2021-01-25 12:06:42,410 epoch 62 - iter 99/111 - loss 1.62996258 - samples/sec: 31.36 - lr: 0.050000\r\n2021-01-25 12:06:48,487 epoch 62 - iter 110/111 - loss 1.60414507 - samples/sec: 28.97 - lr: 0.050000\r\n2021-01-25 12:06:48,551 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:06:48,553 EPOCH 62 done: loss 1.5897 - lr 0.0500000\r\n2021-01-25 12:06:48,553 BAD EPOCHS (no improvement): 0\r\n2021-01-25 12:07:25,633 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:07:30,821 epoch 63 - iter 11/111 - loss 1.41043627 - samples/sec: 34.11 - lr: 0.050000\r\n2021-01-25 12:07:37,602 epoch 63 - iter 22/111 - loss 1.61582136 - samples/sec: 25.96 - lr: 0.050000\r\n2021-01-25 12:07:43,844 epoch 63 - iter 33/111 - loss 1.61856750 - samples/sec: 28.21 - lr: 0.050000\r\n2021-01-25 12:07:49,849 epoch 63 - iter 44/111 - loss 1.65706825 - samples/sec: 29.32 - lr: 0.050000\r\n2021-01-25 12:07:55,849 epoch 63 - iter 55/111 - loss 1.62137602 - samples/sec: 29.34 - lr: 0.050000\r\n2021-01-25 12:08:02,089 epoch 63 - iter 66/111 - loss 1.61913779 - samples/sec: 28.22 - lr: 0.050000\r\n2021-01-25 12:08:08,142 epoch 63 - iter 77/111 - loss 1.64572622 - samples/sec: 29.09 - lr: 0.050000\r\n2021-01-25 12:08:12,926 epoch 63 - iter 88/111 - loss 1.61507814 - samples/sec: 36.80 - lr: 0.050000\r\n2021-01-25 12:08:18,906 epoch 63 - iter 99/111 - loss 1.56996080 - samples/sec: 29.44 - lr: 0.050000\r\n2021-01-25 12:08:24,616 epoch 63 - iter 110/111 - loss 1.56164694 - samples/sec: 30.84 - lr: 0.050000\r\n2021-01-25 12:08:24,676 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:08:24,678 EPOCH 63 done: loss 1.5517 - lr 0.0500000\r\n2021-01-25 12:08:24,679 BAD EPOCHS (no improvement): 0\r\n2021-01-25 12:09:05,938 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:09:11,978 epoch 64 - iter 11/111 - loss 1.24807806 - samples/sec: 29.27 - lr: 0.050000\r\n2021-01-25 12:09:18,190 epoch 64 - iter 22/111 - loss 1.44314513 - samples/sec: 28.34 - lr: 0.050000\r\n2021-01-25 12:09:24,071 epoch 64 - iter 33/111 - loss 1.44731416 - samples/sec: 29.94 - lr: 0.050000\r\n2021-01-25 12:09:29,935 epoch 64 - iter 44/111 - loss 1.46721514 - samples/sec: 30.03 - lr: 0.050000\r\n2021-01-25 12:09:35,783 epoch 64 - iter 55/111 - loss 1.50602719 - samples/sec: 30.11 - lr: 0.050000\r\n2021-01-25 12:09:42,125 epoch 64 - iter 66/111 - loss 1.54318994 - samples/sec: 27.76 - lr: 0.050000\r\n2021-01-25 12:09:48,256 epoch 64 - iter 77/111 - loss 1.53517920 - samples/sec: 28.72 - lr: 0.050000\r\n2021-01-25 12:09:53,515 epoch 64 - iter 88/111 - loss 1.51558204 - samples/sec: 33.48 - lr: 0.050000\r\n2021-01-25 12:09:59,810 epoch 64 - iter 99/111 - loss 1.49825442 - samples/sec: 27.97 - lr: 0.050000\r\n2021-01-25 12:10:06,023 epoch 64 - iter 110/111 - loss 1.50593701 - samples/sec: 28.34 - lr: 0.050000\r\n2021-01-25 12:10:06,124 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:10:06,127 EPOCH 64 done: loss 1.5262 - lr 0.0500000\r\n2021-01-25 12:10:06,129 BAD EPOCHS (no improvement): 0\r\n2021-01-25 12:10:44,644 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:10:50,695 epoch 65 - iter 11/111 - loss 1.73282667 - samples/sec: 29.22 - lr: 0.050000\r\n2021-01-25 12:10:55,916 epoch 65 - iter 22/111 - loss 1.44079784 - samples/sec: 33.73 - lr: 0.050000\r\n2021-01-25 12:11:01,300 epoch 65 - iter 33/111 - loss 1.40507281 - samples/sec: 32.70 - lr: 0.050000\r\n2021-01-25 12:11:06,907 epoch 65 - iter 44/111 - loss 1.49278208 - samples/sec: 31.40 - lr: 0.050000\r\n2021-01-25 12:11:13,041 epoch 65 - iter 55/111 - loss 1.52757028 - samples/sec: 28.70 - lr: 0.050000\r\n2021-01-25 12:11:18,389 epoch 65 - iter 66/111 - loss 1.54195133 - samples/sec: 32.92 - lr: 0.050000\r\n2021-01-25 12:11:24,374 epoch 65 - iter 77/111 - loss 1.58311635 - samples/sec: 29.42 - lr: 0.050000\r\n2021-01-25 12:11:30,985 epoch 65 - iter 88/111 - loss 1.59606863 - samples/sec: 26.64 - lr: 0.050000\r\n2021-01-25 12:11:36,844 epoch 65 - iter 99/111 - loss 1.61974826 - samples/sec: 30.05 - lr: 0.050000\r\n2021-01-25 12:11:42,969 epoch 65 - iter 110/111 - loss 1.59046479 - samples/sec: 28.75 - lr: 0.050000\r\n2021-01-25 12:11:43,042 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:11:43,044 EPOCH 65 done: loss 1.5793 - lr 0.0500000\r\n2021-01-25 12:11:43,045 BAD EPOCHS (no improvement): 1\r\n2021-01-25 12:12:15,978 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:12:22,464 epoch 66 - iter 11/111 - loss 1.79513772 - samples/sec: 27.26 - lr: 0.050000\r\n2021-01-25 12:12:28,543 epoch 66 - iter 22/111 - loss 1.90367814 - samples/sec: 28.96 - lr: 0.050000\r\n2021-01-25 12:12:34,907 epoch 66 - iter 33/111 - loss 1.72589379 - samples/sec: 27.67 - lr: 0.050000\r\n2021-01-25 12:12:40,988 epoch 66 - iter 44/111 - loss 1.69216063 - samples/sec: 28.96 - lr: 0.050000\r\n2021-01-25 12:12:46,911 epoch 66 - iter 55/111 - loss 1.65075056 - samples/sec: 29.73 - lr: 0.050000\r\n2021-01-25 12:12:53,221 epoch 66 - iter 66/111 - loss 1.61192947 - samples/sec: 27.90 - lr: 0.050000\r\n2021-01-25 12:12:59,781 epoch 66 - iter 77/111 - loss 1.55927261 - samples/sec: 26.84 - lr: 0.050000\r\n2021-01-25 12:13:04,976 epoch 66 - iter 88/111 - loss 1.50604288 - samples/sec: 33.89 - lr: 0.050000\r\n2021-01-25 12:13:11,319 epoch 66 - iter 99/111 - loss 1.52530791 - samples/sec: 27.76 - lr: 0.050000\r\n2021-01-25 12:13:17,317 epoch 66 - iter 110/111 - loss 1.55038137 - samples/sec: 29.36 - lr: 0.050000\r\n2021-01-25 12:13:17,366 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:13:17,367 EPOCH 66 done: loss 1.5365 - lr 0.0500000\r\n2021-01-25 12:13:17,369 BAD EPOCHS (no improvement): 2\r\n2021-01-25 12:13:57,777 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:14:04,088 epoch 67 - iter 11/111 - loss 1.51214162 - samples/sec: 28.01 - lr: 0.050000\r\n2021-01-25 12:14:10,544 epoch 67 - iter 22/111 - loss 1.52961288 - samples/sec: 27.27 - lr: 0.050000\r\n2021-01-25 12:14:16,437 epoch 67 - iter 33/111 - loss 1.55562648 - samples/sec: 29.88 - lr: 0.050000\r\n2021-01-25 12:14:21,526 epoch 67 - iter 44/111 - loss 1.51856806 - samples/sec: 34.60 - lr: 0.050000\r\n2021-01-25 12:14:27,248 epoch 67 - iter 55/111 - loss 1.54293376 - samples/sec: 30.77 - lr: 0.050000\r\n2021-01-25 12:14:33,281 epoch 67 - iter 66/111 - loss 1.50277544 - samples/sec: 29.18 - lr: 0.050000\r\n2021-01-25 12:14:39,342 epoch 67 - iter 77/111 - loss 1.50794357 - samples/sec: 29.05 - lr: 0.050000\r\n2021-01-25 12:14:44,751 epoch 67 - iter 88/111 - loss 1.49891747 - samples/sec: 32.55 - lr: 0.050000\r\n2021-01-25 12:14:50,269 epoch 67 - iter 99/111 - loss 1.47982434 - samples/sec: 31.91 - lr: 0.050000\r\n2021-01-25 12:14:56,320 epoch 67 - iter 110/111 - loss 1.51493590 - samples/sec: 29.10 - lr: 0.050000\r\n2021-01-25 12:14:56,449 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:14:56,451 EPOCH 67 done: loss 1.5194 - lr 0.0500000\r\n2021-01-25 12:14:56,452 BAD EPOCHS (no improvement): 0\r\n2021-01-25 12:15:36,459 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:15:43,678 epoch 68 - iter 11/111 - loss 1.43217570 - samples/sec: 24.47 - lr: 0.050000\r\n2021-01-25 12:15:50,337 epoch 68 - iter 22/111 - loss 1.49155569 - samples/sec: 26.44 - lr: 0.050000\r\n2021-01-25 12:15:54,938 epoch 68 - iter 33/111 - loss 1.42927919 - samples/sec: 38.27 - lr: 0.050000\r\n2021-01-25 12:16:00,816 epoch 68 - iter 44/111 - loss 1.45040369 - samples/sec: 29.96 - lr: 0.050000\r\n2021-01-25 12:16:06,456 epoch 68 - iter 55/111 - loss 1.49330547 - samples/sec: 31.22 - lr: 0.050000\r\n2021-01-25 12:16:12,306 epoch 68 - iter 66/111 - loss 1.51564600 - samples/sec: 30.10 - lr: 0.050000\r\n2021-01-25 12:16:17,722 epoch 68 - iter 77/111 - loss 1.50499360 - samples/sec: 32.51 - lr: 0.050000\r\n2021-01-25 12:16:23,306 epoch 68 - iter 88/111 - loss 1.52004683 - samples/sec: 31.53 - lr: 0.050000\r\n2021-01-25 12:16:30,038 epoch 68 - iter 99/111 - loss 1.51634471 - samples/sec: 26.15 - lr: 0.050000\r\n2021-01-25 12:16:35,717 epoch 68 - iter 110/111 - loss 1.51642235 - samples/sec: 31.00 - lr: 0.050000\r\n2021-01-25 12:16:35,807 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:16:35,809 EPOCH 68 done: loss 1.5038 - lr 0.0500000\r\n2021-01-25 12:16:35,810 BAD EPOCHS (no improvement): 0\r\n2021-01-25 12:17:08,298 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:17:23,819 epoch 69 - iter 11/111 - loss 1.46120588 - samples/sec: 25.60 - lr: 0.050000\r\n2021-01-25 12:17:29,891 epoch 69 - iter 22/111 - loss 1.44839512 - samples/sec: 28.99 - lr: 0.050000\r\n2021-01-25 12:17:34,765 epoch 69 - iter 33/111 - loss 1.38297283 - samples/sec: 36.12 - lr: 0.050000\r\n2021-01-25 12:17:40,116 epoch 69 - iter 44/111 - loss 1.41795017 - samples/sec: 32.91 - lr: 0.050000\r\n2021-01-25 12:17:45,776 epoch 69 - iter 55/111 - loss 1.37325392 - samples/sec: 31.11 - lr: 0.050000\r\n2021-01-25 12:17:51,485 epoch 69 - iter 66/111 - loss 1.38036001 - samples/sec: 30.84 - lr: 0.050000\r\n2021-01-25 12:17:57,869 epoch 69 - iter 77/111 - loss 1.38968347 - samples/sec: 27.58 - lr: 0.050000\r\n2021-01-25 12:19:52,411 epoch 69 - iter 88/111 - loss 1.38374551 - samples/sec: 26.41 - lr: 0.050000\r\n2021-01-25 12:19:58,278 epoch 69 - iter 99/111 - loss 1.41925592 - samples/sec: 30.02 - lr: 0.050000\r\n2021-01-25 12:20:04,925 epoch 69 - iter 110/111 - loss 1.43710668 - samples/sec: 26.49 - lr: 0.050000\r\n2021-01-25 12:20:05,007 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:20:05,008 EPOCH 69 done: loss 1.4243 - lr 0.0500000\r\n2021-01-25 12:20:05,010 BAD EPOCHS (no improvement): 0\r\n2021-01-25 12:20:45,483 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:20:52,255 epoch 70 - iter 11/111 - loss 1.44516954 - samples/sec: 26.16 - lr: 0.050000\r\n2021-01-25 12:20:57,079 epoch 70 - iter 22/111 - loss 1.38778281 - samples/sec: 36.50 - lr: 0.050000\r\n2021-01-25 12:21:03,712 epoch 70 - iter 33/111 - loss 1.52580733 - samples/sec: 26.55 - lr: 0.050000\r\n2021-01-25 12:21:08,702 epoch 70 - iter 44/111 - loss 1.40874570 - samples/sec: 35.28 - lr: 0.050000\r\n2021-01-25 12:21:14,550 epoch 70 - iter 55/111 - loss 1.37405204 - samples/sec: 30.11 - lr: 0.050000\r\n2021-01-25 12:21:20,932 epoch 70 - iter 66/111 - loss 1.40803984 - samples/sec: 27.59 - lr: 0.050000\r\n2021-01-25 12:21:26,944 epoch 70 - iter 77/111 - loss 1.42147764 - samples/sec: 29.28 - lr: 0.050000\r\n2021-01-25 12:21:32,824 epoch 70 - iter 88/111 - loss 1.42631083 - samples/sec: 29.94 - lr: 0.050000\r\n2021-01-25 12:21:39,197 epoch 70 - iter 99/111 - loss 1.43104338 - samples/sec: 27.63 - lr: 0.050000\r\n2021-01-25 12:21:44,725 epoch 70 - iter 110/111 - loss 1.43146756 - samples/sec: 31.85 - lr: 0.050000\r\n2021-01-25 12:21:44,914 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:21:44,915 EPOCH 70 done: loss 1.4211 - lr 0.0500000\r\n2021-01-25 12:21:44,916 BAD EPOCHS (no improvement): 0\r\n2021-01-25 12:22:17,445 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:22:22,976 epoch 71 - iter 11/111 - loss 2.00260350 - samples/sec: 31.98 - lr: 0.050000\r\n2021-01-25 12:22:29,761 epoch 71 - iter 22/111 - loss 1.70493918 - samples/sec: 25.95 - lr: 0.050000\r\n2021-01-25 12:22:35,731 epoch 71 - iter 33/111 - loss 1.59428979 - samples/sec: 29.49 - lr: 0.050000\r\n2021-01-25 12:22:42,001 epoch 71 - iter 44/111 - loss 1.59676667 - samples/sec: 28.08 - lr: 0.050000\r\n2021-01-25 12:22:47,396 epoch 71 - iter 55/111 - loss 1.49150653 - samples/sec: 32.64 - lr: 0.050000\r\n2021-01-25 12:22:53,190 epoch 71 - iter 66/111 - loss 1.47964654 - samples/sec: 30.38 - lr: 0.050000\r\n2021-01-25 12:22:59,851 epoch 71 - iter 77/111 - loss 1.48795519 - samples/sec: 26.43 - lr: 0.050000\r\n2021-01-25 12:23:05,477 epoch 71 - iter 88/111 - loss 1.47494126 - samples/sec: 31.30 - lr: 0.050000\r\n2021-01-25 12:23:12,100 epoch 71 - iter 99/111 - loss 1.45548201 - samples/sec: 26.58 - lr: 0.050000\r\n2021-01-25 12:23:18,307 epoch 71 - iter 110/111 - loss 1.42907549 - samples/sec: 28.36 - lr: 0.050000\r\n2021-01-25 12:23:18,550 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:23:18,551 EPOCH 71 done: loss 1.4177 - lr 0.0500000\r\n2021-01-25 12:23:18,552 BAD EPOCHS (no improvement): 0\r\n2021-01-25 12:23:59,318 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:24:04,480 epoch 72 - iter 11/111 - loss 1.22978234 - samples/sec: 34.29 - lr: 0.050000\r\n2021-01-25 12:24:11,145 epoch 72 - iter 22/111 - loss 1.39237714 - samples/sec: 26.41 - lr: 0.050000\r\n2021-01-25 12:24:16,552 epoch 72 - iter 33/111 - loss 1.43349531 - samples/sec: 32.56 - lr: 0.050000\r\n2021-01-25 12:24:23,077 epoch 72 - iter 44/111 - loss 1.41425940 - samples/sec: 26.98 - lr: 0.050000\r\n2021-01-25 12:24:28,777 epoch 72 - iter 55/111 - loss 1.44107326 - samples/sec: 30.89 - lr: 0.050000\r\n2021-01-25 12:24:34,775 epoch 72 - iter 66/111 - loss 1.42940595 - samples/sec: 29.35 - lr: 0.050000\r\n2021-01-25 12:24:40,329 epoch 72 - iter 77/111 - loss 1.43958457 - samples/sec: 31.70 - lr: 0.050000\r\n2021-01-25 12:24:46,854 epoch 72 - iter 88/111 - loss 1.45229586 - samples/sec: 26.98 - lr: 0.050000\r\n2021-01-25 12:24:52,907 epoch 72 - iter 99/111 - loss 1.44572394 - samples/sec: 29.09 - lr: 0.050000\r\n2021-01-25 12:24:58,648 epoch 72 - iter 110/111 - loss 1.44074938 - samples/sec: 30.67 - lr: 0.050000\r\n2021-01-25 12:24:58,690 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:24:58,692 EPOCH 72 done: loss 1.4387 - lr 0.0500000\r\n2021-01-25 12:24:58,693 BAD EPOCHS (no improvement): 1\r\n2021-01-25 12:25:39,614 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:25:45,237 epoch 73 - iter 11/111 - loss 1.29489860 - samples/sec: 31.47 - lr: 0.050000\r\n2021-01-25 12:25:51,043 epoch 73 - iter 22/111 - loss 1.38107881 - samples/sec: 30.32 - lr: 0.050000\r\n2021-01-25 12:25:57,015 epoch 73 - iter 33/111 - loss 1.45272314 - samples/sec: 29.48 - lr: 0.050000\r\n2021-01-25 12:26:03,598 epoch 73 - iter 44/111 - loss 1.45398960 - samples/sec: 26.75 - lr: 0.050000\r\n2021-01-25 12:26:08,903 epoch 73 - iter 55/111 - loss 1.37994436 - samples/sec: 33.19 - lr: 0.050000\r\n2021-01-25 12:26:14,550 epoch 73 - iter 66/111 - loss 1.45808953 - samples/sec: 31.18 - lr: 0.050000\r\n2021-01-25 12:26:21,631 epoch 73 - iter 77/111 - loss 1.53841408 - samples/sec: 24.86 - lr: 0.050000\r\n2021-01-25 12:26:27,564 epoch 73 - iter 88/111 - loss 1.52056252 - samples/sec: 29.68 - lr: 0.050000\r\n2021-01-25 12:26:33,935 epoch 73 - iter 99/111 - loss 1.49743945 - samples/sec: 27.63 - lr: 0.050000\r\n2021-01-25 12:26:39,597 epoch 73 - iter 110/111 - loss 1.49375933 - samples/sec: 31.10 - lr: 0.050000\r\n2021-01-25 12:26:39,644 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:26:39,645 EPOCH 73 done: loss 1.4804 - lr 0.0500000\r\n2021-01-25 12:26:39,647 BAD EPOCHS (no improvement): 2\r\n2021-01-25 12:27:19,117 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:27:24,603 epoch 74 - iter 11/111 - loss 1.18496536 - samples/sec: 32.24 - lr: 0.050000\r\n2021-01-25 12:27:30,495 epoch 74 - iter 22/111 - loss 1.30861269 - samples/sec: 29.88 - lr: 0.050000\r\n2021-01-25 12:27:36,357 epoch 74 - iter 33/111 - loss 1.35666224 - samples/sec: 30.03 - lr: 0.050000\r\n2021-01-25 12:27:41,963 epoch 74 - iter 44/111 - loss 1.43150187 - samples/sec: 31.41 - lr: 0.050000\r\n2021-01-25 12:27:48,820 epoch 74 - iter 55/111 - loss 1.41136729 - samples/sec: 25.67 - lr: 0.050000\r\n2021-01-25 12:27:55,538 epoch 74 - iter 66/111 - loss 1.40032356 - samples/sec: 26.21 - lr: 0.050000\r\n2021-01-25 12:28:01,951 epoch 74 - iter 77/111 - loss 1.37194948 - samples/sec: 27.45 - lr: 0.050000\r\n2021-01-25 12:28:07,992 epoch 74 - iter 88/111 - loss 1.39479629 - samples/sec: 29.14 - lr: 0.050000\r\n2021-01-25 12:28:13,299 epoch 74 - iter 99/111 - loss 1.46021123 - samples/sec: 33.18 - lr: 0.050000\r\n2021-01-25 12:28:20,201 epoch 74 - iter 110/111 - loss 1.49201296 - samples/sec: 25.51 - lr: 0.050000\r\n2021-01-25 12:28:20,368 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:28:20,369 EPOCH 74 done: loss 1.4923 - lr 0.0500000\r\n2021-01-25 12:28:20,371 BAD EPOCHS (no improvement): 3\r\n2021-01-25 12:28:59,402 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:29:05,235 epoch 75 - iter 11/111 - loss 1.30246717 - samples/sec: 30.33 - lr: 0.050000\r\n2021-01-25 12:29:11,617 epoch 75 - iter 22/111 - loss 1.54428654 - samples/sec: 27.59 - lr: 0.050000\r\n2021-01-25 12:29:17,551 epoch 75 - iter 33/111 - loss 1.36524455 - samples/sec: 29.67 - lr: 0.050000\r\n2021-01-25 12:29:23,373 epoch 75 - iter 44/111 - loss 1.37502711 - samples/sec: 30.24 - lr: 0.050000\r\n2021-01-25 12:29:28,999 epoch 75 - iter 55/111 - loss 1.29860503 - samples/sec: 31.30 - lr: 0.050000\r\n2021-01-25 12:29:35,953 epoch 75 - iter 66/111 - loss 1.30761962 - samples/sec: 25.32 - lr: 0.050000\r\n2021-01-25 12:29:41,391 epoch 75 - iter 77/111 - loss 1.33167293 - samples/sec: 32.38 - lr: 0.050000\r\n2021-01-25 12:29:46,665 epoch 75 - iter 88/111 - loss 1.33132098 - samples/sec: 33.38 - lr: 0.050000\r\n2021-01-25 12:29:52,907 epoch 75 - iter 99/111 - loss 1.32298015 - samples/sec: 28.20 - lr: 0.050000\r\n2021-01-25 12:29:59,054 epoch 75 - iter 110/111 - loss 1.31384700 - samples/sec: 28.64 - lr: 0.050000\r\n2021-01-25 12:29:59,260 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:29:59,261 EPOCH 75 done: loss 1.3076 - lr 0.0500000\r\n2021-01-25 12:29:59,263 BAD EPOCHS (no improvement): 0\r\n2021-01-25 12:30:36,810 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:30:42,805 epoch 76 - iter 11/111 - loss 1.33615736 - samples/sec: 29.50 - lr: 0.050000\r\n2021-01-25 12:30:48,327 epoch 76 - iter 22/111 - loss 1.26157622 - samples/sec: 31.89 - lr: 0.050000\r\n2021-01-25 12:30:53,809 epoch 76 - iter 33/111 - loss 1.28425501 - samples/sec: 32.11 - lr: 0.050000\r\n2021-01-25 12:31:00,729 epoch 76 - iter 44/111 - loss 1.25888383 - samples/sec: 25.44 - lr: 0.050000\r\n2021-01-25 12:31:06,217 epoch 76 - iter 55/111 - loss 1.26368131 - samples/sec: 32.08 - lr: 0.050000\r\n2021-01-25 12:31:12,685 epoch 76 - iter 66/111 - loss 1.28373529 - samples/sec: 27.22 - lr: 0.050000\r\n2021-01-25 12:31:18,270 epoch 76 - iter 77/111 - loss 1.28456146 - samples/sec: 31.52 - lr: 0.050000\r\n2021-01-25 12:31:24,420 epoch 76 - iter 88/111 - loss 1.28954828 - samples/sec: 28.63 - lr: 0.050000\r\n2021-01-25 12:31:31,033 epoch 76 - iter 99/111 - loss 1.29948332 - samples/sec: 26.62 - lr: 0.050000\r\n2021-01-25 12:31:37,305 epoch 76 - iter 110/111 - loss 1.33390515 - samples/sec: 28.07 - lr: 0.050000\r\n2021-01-25 12:31:37,399 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:31:37,401 EPOCH 76 done: loss 1.4266 - lr 0.0500000\r\n2021-01-25 12:31:37,403 BAD EPOCHS (no improvement): 1\r\n2021-01-25 12:32:12,559 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:32:17,704 epoch 77 - iter 11/111 - loss 0.98876150 - samples/sec: 34.41 - lr: 0.050000\r\n2021-01-25 12:32:24,636 epoch 77 - iter 22/111 - loss 1.17457396 - samples/sec: 25.40 - lr: 0.050000\r\n2021-01-25 12:32:30,628 epoch 77 - iter 33/111 - loss 1.16359689 - samples/sec: 29.38 - lr: 0.050000\r\n2021-01-25 12:32:36,169 epoch 77 - iter 44/111 - loss 1.29733602 - samples/sec: 31.77 - lr: 0.050000\r\n2021-01-25 12:32:42,034 epoch 77 - iter 55/111 - loss 1.29096426 - samples/sec: 30.02 - lr: 0.050000\r\n2021-01-25 12:32:48,172 epoch 77 - iter 66/111 - loss 1.31050428 - samples/sec: 28.69 - lr: 0.050000\r\n2021-01-25 12:32:54,089 epoch 77 - iter 77/111 - loss 1.30478336 - samples/sec: 29.75 - lr: 0.050000\r\n2021-01-25 12:32:59,821 epoch 77 - iter 88/111 - loss 1.30426656 - samples/sec: 30.72 - lr: 0.050000\r\n2021-01-25 12:33:06,093 epoch 77 - iter 99/111 - loss 1.30662050 - samples/sec: 28.07 - lr: 0.050000\r\n2021-01-25 12:33:12,647 epoch 77 - iter 110/111 - loss 1.32664387 - samples/sec: 26.86 - lr: 0.050000\r\n2021-01-25 12:33:12,709 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:33:12,710 EPOCH 77 done: loss 1.3474 - lr 0.0500000\r\n2021-01-25 12:33:12,711 BAD EPOCHS (no improvement): 2\r\n2021-01-25 12:33:50,722 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:33:57,284 epoch 78 - iter 11/111 - loss 1.29088527 - samples/sec: 26.94 - lr: 0.050000\r\n2021-01-25 12:34:02,952 epoch 78 - iter 22/111 - loss 1.31935661 - samples/sec: 31.07 - lr: 0.050000\r\n2021-01-25 12:34:09,106 epoch 78 - iter 33/111 - loss 1.41321889 - samples/sec: 28.61 - lr: 0.050000\r\n2021-01-25 12:34:14,008 epoch 78 - iter 44/111 - loss 1.39564167 - samples/sec: 35.92 - lr: 0.050000\r\n2021-01-25 12:34:19,420 epoch 78 - iter 55/111 - loss 1.34922395 - samples/sec: 32.53 - lr: 0.050000\r\n2021-01-25 12:34:25,401 epoch 78 - iter 66/111 - loss 1.32606339 - samples/sec: 29.44 - lr: 0.050000\r\n2021-01-25 12:34:30,962 epoch 78 - iter 77/111 - loss 1.28154114 - samples/sec: 31.66 - lr: 0.050000\r\n2021-01-25 12:34:37,444 epoch 78 - iter 88/111 - loss 1.34347282 - samples/sec: 27.16 - lr: 0.050000\r\n2021-01-25 12:34:44,194 epoch 78 - iter 99/111 - loss 1.38436094 - samples/sec: 26.08 - lr: 0.050000\r\n2021-01-25 12:34:49,965 epoch 78 - iter 110/111 - loss 1.37429725 - samples/sec: 30.51 - lr: 0.050000\r\n2021-01-25 12:34:50,108 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:34:50,109 EPOCH 78 done: loss 1.3837 - lr 0.0500000\r\n2021-01-25 12:34:50,111 BAD EPOCHS (no improvement): 3\r\n2021-01-25 12:35:23,788 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:35:29,899 epoch 79 - iter 11/111 - loss 1.10409809 - samples/sec: 28.94 - lr: 0.050000\r\n2021-01-25 12:35:36,740 epoch 79 - iter 22/111 - loss 1.17709787 - samples/sec: 25.74 - lr: 0.050000\r\n2021-01-25 12:35:42,238 epoch 79 - iter 33/111 - loss 1.19678932 - samples/sec: 32.03 - lr: 0.050000\r\n2021-01-25 12:35:47,630 epoch 79 - iter 44/111 - loss 1.22716568 - samples/sec: 32.66 - lr: 0.050000\r\n2021-01-25 12:35:54,193 epoch 79 - iter 55/111 - loss 1.27254297 - samples/sec: 26.83 - lr: 0.050000\r\n2021-01-25 12:35:59,749 epoch 79 - iter 66/111 - loss 1.28610185 - samples/sec: 31.69 - lr: 0.050000\r\n2021-01-25 12:36:05,686 epoch 79 - iter 77/111 - loss 1.32574023 - samples/sec: 29.66 - lr: 0.050000\r\n2021-01-25 12:36:11,627 epoch 79 - iter 88/111 - loss 1.34977880 - samples/sec: 29.64 - lr: 0.050000\r\n2021-01-25 12:36:17,715 epoch 79 - iter 99/111 - loss 1.35951786 - samples/sec: 28.92 - lr: 0.050000\r\n2021-01-25 12:36:24,854 epoch 79 - iter 110/111 - loss 1.36119310 - samples/sec: 24.66 - lr: 0.050000\r\n2021-01-25 12:36:24,992 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:36:24,993 EPOCH 79 done: loss 1.3646 - lr 0.0500000\r\nEpoch    79: reducing learning rate of group 0 to 2.5000e-02.\r\n2021-01-25 12:36:24,995 BAD EPOCHS (no improvement): 4\r\n2021-01-25 12:36:59,260 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:37:04,238 epoch 80 - iter 11/111 - loss 1.24194489 - samples/sec: 35.58 - lr: 0.025000\r\n2021-01-25 12:37:12,399 epoch 80 - iter 22/111 - loss 1.32671146 - samples/sec: 30.09 - lr: 0.025000\r\n2021-01-25 12:37:18,386 epoch 80 - iter 33/111 - loss 1.30666058 - samples/sec: 29.41 - lr: 0.025000\r\n2021-01-25 12:37:24,855 epoch 80 - iter 44/111 - loss 1.27289238 - samples/sec: 27.22 - lr: 0.025000\r\n2021-01-25 12:37:31,314 epoch 80 - iter 55/111 - loss 1.27664626 - samples/sec: 27.26 - lr: 0.025000\r\n2021-01-25 12:37:37,028 epoch 80 - iter 66/111 - loss 1.27360224 - samples/sec: 30.82 - lr: 0.025000\r\n2021-01-25 12:37:43,728 epoch 80 - iter 77/111 - loss 1.30810210 - samples/sec: 26.28 - lr: 0.025000\r\n2021-01-25 12:37:48,715 epoch 80 - iter 88/111 - loss 1.28021682 - samples/sec: 35.32 - lr: 0.025000\r\n2021-01-25 12:37:54,785 epoch 80 - iter 99/111 - loss 1.24763311 - samples/sec: 29.00 - lr: 0.025000\r\n2021-01-25 12:38:00,486 epoch 80 - iter 110/111 - loss 1.23794550 - samples/sec: 30.89 - lr: 0.025000\r\n2021-01-25 12:38:00,539 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:38:00,540 EPOCH 80 done: loss 1.2270 - lr 0.0250000\r\n2021-01-25 12:38:00,541 BAD EPOCHS (no improvement): 0\r\n2021-01-25 12:38:35,050 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:38:42,032 epoch 81 - iter 11/111 - loss 1.33562588 - samples/sec: 25.31 - lr: 0.025000\r\n2021-01-25 12:38:48,816 epoch 81 - iter 22/111 - loss 1.46655772 - samples/sec: 25.95 - lr: 0.025000\r\n2021-01-25 12:38:55,174 epoch 81 - iter 33/111 - loss 1.30066396 - samples/sec: 27.69 - lr: 0.025000\r\n2021-01-25 12:39:00,930 epoch 81 - iter 44/111 - loss 1.23842647 - samples/sec: 30.59 - lr: 0.025000\r\n2021-01-25 12:39:06,494 epoch 81 - iter 55/111 - loss 1.22651872 - samples/sec: 31.65 - lr: 0.025000\r\n2021-01-25 12:39:12,684 epoch 81 - iter 66/111 - loss 1.19976663 - samples/sec: 28.44 - lr: 0.025000\r\n2021-01-25 12:39:18,015 epoch 81 - iter 77/111 - loss 1.18203226 - samples/sec: 33.03 - lr: 0.025000\r\n2021-01-25 12:39:24,241 epoch 81 - iter 88/111 - loss 1.19300186 - samples/sec: 28.28 - lr: 0.025000\r\n2021-01-25 12:39:29,658 epoch 81 - iter 99/111 - loss 1.20260931 - samples/sec: 32.50 - lr: 0.025000\r\n2021-01-25 12:39:35,189 epoch 81 - iter 110/111 - loss 1.18722751 - samples/sec: 31.83 - lr: 0.025000\r\n2021-01-25 12:39:35,261 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:39:35,262 EPOCH 81 done: loss 1.1765 - lr 0.0250000\r\n2021-01-25 12:39:35,264 BAD EPOCHS (no improvement): 0\r\n2021-01-25 12:40:12,964 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:40:19,513 epoch 82 - iter 11/111 - loss 1.05421389 - samples/sec: 26.99 - lr: 0.025000\r\n2021-01-25 12:40:25,330 epoch 82 - iter 22/111 - loss 1.00502741 - samples/sec: 30.27 - lr: 0.025000\r\n2021-01-25 12:40:31,044 epoch 82 - iter 33/111 - loss 1.04035564 - samples/sec: 30.81 - lr: 0.025000\r\n2021-01-25 12:40:37,956 epoch 82 - iter 44/111 - loss 1.08949315 - samples/sec: 25.47 - lr: 0.025000\r\n2021-01-25 12:40:44,555 epoch 82 - iter 55/111 - loss 1.12894638 - samples/sec: 26.68 - lr: 0.025000\r\n2021-01-25 12:40:51,918 epoch 82 - iter 66/111 - loss 1.13150503 - samples/sec: 23.91 - lr: 0.025000\r\n2021-01-25 12:40:57,240 epoch 82 - iter 77/111 - loss 1.13121013 - samples/sec: 33.08 - lr: 0.025000\r\n2021-01-25 12:41:02,235 epoch 82 - iter 88/111 - loss 1.08271775 - samples/sec: 35.25 - lr: 0.025000\r\n2021-01-25 12:41:08,495 epoch 82 - iter 99/111 - loss 1.08136557 - samples/sec: 28.12 - lr: 0.025000\r\n2021-01-25 12:41:14,669 epoch 82 - iter 110/111 - loss 1.08425220 - samples/sec: 28.52 - lr: 0.025000\r\n2021-01-25 12:41:14,785 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:41:14,786 EPOCH 82 done: loss 1.0751 - lr 0.0250000\r\n2021-01-25 12:41:14,787 BAD EPOCHS (no improvement): 0\r\n2021-01-25 12:41:48,715 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:41:55,554 epoch 83 - iter 11/111 - loss 0.94434114 - samples/sec: 25.84 - lr: 0.025000\r\n2021-01-25 12:42:01,527 epoch 83 - iter 22/111 - loss 0.90104175 - samples/sec: 29.48 - lr: 0.025000\r\n2021-01-25 12:42:09,255 epoch 83 - iter 33/111 - loss 0.93821691 - samples/sec: 22.78 - lr: 0.025000\r\n2021-01-25 12:42:15,150 epoch 83 - iter 44/111 - loss 0.96491798 - samples/sec: 29.87 - lr: 0.025000\r\n2021-01-25 12:42:21,144 epoch 83 - iter 55/111 - loss 0.96957205 - samples/sec: 29.38 - lr: 0.025000\r\n2021-01-25 12:42:28,518 epoch 83 - iter 66/111 - loss 1.03643710 - samples/sec: 23.88 - lr: 0.025000\r\n2021-01-25 12:42:35,475 epoch 83 - iter 77/111 - loss 1.04713983 - samples/sec: 25.31 - lr: 0.025000\r\n2021-01-25 12:42:41,878 epoch 83 - iter 88/111 - loss 1.07007285 - samples/sec: 27.50 - lr: 0.025000\r\n2021-01-25 12:42:48,915 epoch 83 - iter 99/111 - loss 1.07134652 - samples/sec: 25.02 - lr: 0.025000\r\n2021-01-25 12:42:55,515 epoch 83 - iter 110/111 - loss 1.08769437 - samples/sec: 26.67 - lr: 0.025000\r\n2021-01-25 12:42:55,698 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:42:55,700 EPOCH 83 done: loss 1.0788 - lr 0.0250000\r\n2021-01-25 12:42:55,701 BAD EPOCHS (no improvement): 1\r\n2021-01-25 12:43:27,271 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:43:41,555 epoch 84 - iter 11/111 - loss 0.89515281 - samples/sec: 26.34 - lr: 0.025000\r\n2021-01-25 12:43:48,188 epoch 84 - iter 22/111 - loss 1.02019271 - samples/sec: 26.54 - lr: 0.025000\r\n2021-01-25 12:43:55,041 epoch 84 - iter 33/111 - loss 1.05338433 - samples/sec: 25.69 - lr: 0.025000\r\n2021-01-25 12:44:01,054 epoch 84 - iter 44/111 - loss 0.97330595 - samples/sec: 29.29 - lr: 0.025000\r\n2021-01-25 12:44:07,977 epoch 84 - iter 55/111 - loss 1.00204318 - samples/sec: 25.43 - lr: 0.025000\r\n2021-01-25 12:44:14,988 epoch 84 - iter 66/111 - loss 1.00526839 - samples/sec: 25.11 - lr: 0.025000\r\n2021-01-25 12:44:20,739 epoch 84 - iter 77/111 - loss 1.01961758 - samples/sec: 30.63 - lr: 0.025000\r\n2021-01-25 12:44:27,577 epoch 84 - iter 88/111 - loss 1.02706470 - samples/sec: 25.75 - lr: 0.025000\r\n2021-01-25 12:44:34,018 epoch 84 - iter 99/111 - loss 1.02225553 - samples/sec: 27.34 - lr: 0.025000\r\n2021-01-25 12:44:40,057 epoch 84 - iter 110/111 - loss 1.01489627 - samples/sec: 29.16 - lr: 0.025000\r\n2021-01-25 12:44:40,118 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:44:40,120 EPOCH 84 done: loss 1.0322 - lr 0.0250000\r\n2021-01-25 12:44:40,121 BAD EPOCHS (no improvement): 0\r\n2021-01-25 12:45:21,911 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:45:27,848 epoch 85 - iter 11/111 - loss 1.20281910 - samples/sec: 29.80 - lr: 0.025000\r\n2021-01-25 12:45:34,615 epoch 85 - iter 22/111 - loss 1.07895691 - samples/sec: 26.02 - lr: 0.025000\r\n2021-01-25 12:45:41,436 epoch 85 - iter 33/111 - loss 1.05872281 - samples/sec: 25.81 - lr: 0.025000\r\n2021-01-25 12:45:47,412 epoch 85 - iter 44/111 - loss 0.98374504 - samples/sec: 29.47 - lr: 0.025000\r\n2021-01-25 12:45:53,993 epoch 85 - iter 55/111 - loss 1.00330201 - samples/sec: 26.75 - lr: 0.025000\r\n2021-01-25 12:46:00,108 epoch 85 - iter 66/111 - loss 1.00110223 - samples/sec: 28.79 - lr: 0.025000\r\n2021-01-25 12:46:07,952 epoch 85 - iter 77/111 - loss 0.99436903 - samples/sec: 22.45 - lr: 0.025000\r\n2021-01-25 12:46:14,462 epoch 85 - iter 88/111 - loss 1.01154200 - samples/sec: 27.04 - lr: 0.025000\r\n2021-01-25 12:46:20,363 epoch 85 - iter 99/111 - loss 1.01468465 - samples/sec: 29.84 - lr: 0.025000\r\n2021-01-25 12:46:27,104 epoch 85 - iter 110/111 - loss 1.04007535 - samples/sec: 26.11 - lr: 0.025000\r\n2021-01-25 12:46:27,256 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:46:27,258 EPOCH 85 done: loss 1.0516 - lr 0.0250000\r\n2021-01-25 12:46:27,262 BAD EPOCHS (no improvement): 1\r\n2021-01-25 12:47:06,676 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:47:13,059 epoch 86 - iter 11/111 - loss 0.94930763 - samples/sec: 27.71 - lr: 0.025000\r\n2021-01-25 12:47:19,805 epoch 86 - iter 22/111 - loss 0.97583853 - samples/sec: 26.10 - lr: 0.025000\r\n2021-01-25 12:47:26,847 epoch 86 - iter 33/111 - loss 0.96932490 - samples/sec: 25.00 - lr: 0.025000\r\n2021-01-25 12:47:32,771 epoch 86 - iter 44/111 - loss 0.93531939 - samples/sec: 29.73 - lr: 0.025000\r\n2021-01-25 12:47:38,945 epoch 86 - iter 55/111 - loss 0.92774620 - samples/sec: 28.52 - lr: 0.025000\r\n2021-01-25 12:47:46,133 epoch 86 - iter 66/111 - loss 0.94981243 - samples/sec: 24.49 - lr: 0.025000\r\n2021-01-25 12:47:53,488 epoch 86 - iter 77/111 - loss 0.99393307 - samples/sec: 23.94 - lr: 0.025000\r\n2021-01-25 12:48:00,003 epoch 86 - iter 88/111 - loss 1.00942624 - samples/sec: 27.02 - lr: 0.025000\r\n2021-01-25 12:48:06,088 epoch 86 - iter 99/111 - loss 1.06013848 - samples/sec: 28.93 - lr: 0.025000\r\n2021-01-25 12:48:11,186 epoch 86 - iter 110/111 - loss 1.04540570 - samples/sec: 34.54 - lr: 0.025000\r\n2021-01-25 12:48:11,257 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:48:11,258 EPOCH 86 done: loss 1.0363 - lr 0.0250000\r\n2021-01-25 12:48:11,259 BAD EPOCHS (no improvement): 2\r\n2021-01-25 12:48:52,354 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:48:58,412 epoch 87 - iter 11/111 - loss 1.04858258 - samples/sec: 29.19 - lr: 0.025000\r\n2021-01-25 12:49:04,272 epoch 87 - iter 22/111 - loss 1.16057113 - samples/sec: 30.05 - lr: 0.025000\r\n2021-01-25 12:49:11,947 epoch 87 - iter 33/111 - loss 1.21746160 - samples/sec: 22.94 - lr: 0.025000\r\n2021-01-25 12:49:17,837 epoch 87 - iter 44/111 - loss 1.11503506 - samples/sec: 29.89 - lr: 0.025000\r\n2021-01-25 12:49:24,377 epoch 87 - iter 55/111 - loss 1.07564666 - samples/sec: 26.92 - lr: 0.025000\r\n2021-01-25 12:49:31,481 epoch 87 - iter 66/111 - loss 1.08644686 - samples/sec: 24.78 - lr: 0.025000\r\n2021-01-25 12:49:39,195 epoch 87 - iter 77/111 - loss 1.05397260 - samples/sec: 22.82 - lr: 0.025000\r\n2021-01-25 12:49:45,421 epoch 87 - iter 88/111 - loss 1.03656549 - samples/sec: 28.28 - lr: 0.025000\r\n2021-01-25 12:49:52,656 epoch 87 - iter 99/111 - loss 1.03412277 - samples/sec: 24.33 - lr: 0.025000\r\n2021-01-25 12:49:58,463 epoch 87 - iter 110/111 - loss 1.01925475 - samples/sec: 30.32 - lr: 0.025000\r\n2021-01-25 12:49:58,562 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:49:58,564 EPOCH 87 done: loss 1.0181 - lr 0.0250000\r\n2021-01-25 12:49:58,565 BAD EPOCHS (no improvement): 0\r\n2021-01-25 12:50:36,664 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:50:43,288 epoch 88 - iter 11/111 - loss 0.84496240 - samples/sec: 26.71 - lr: 0.025000\r\n2021-01-25 12:50:49,520 epoch 88 - iter 22/111 - loss 1.03849998 - samples/sec: 28.25 - lr: 0.025000\r\n2021-01-25 12:50:54,645 epoch 88 - iter 33/111 - loss 0.98924814 - samples/sec: 34.38 - lr: 0.025000\r\n2021-01-25 12:51:02,978 epoch 88 - iter 44/111 - loss 1.02678045 - samples/sec: 21.13 - lr: 0.025000\r\n2021-01-25 12:51:08,941 epoch 88 - iter 55/111 - loss 1.01480722 - samples/sec: 29.53 - lr: 0.025000\r\n2021-01-25 12:51:16,221 epoch 88 - iter 66/111 - loss 1.02007116 - samples/sec: 24.18 - lr: 0.025000\r\n2021-01-25 12:51:23,112 epoch 88 - iter 77/111 - loss 0.99199804 - samples/sec: 25.55 - lr: 0.025000\r\n2021-01-25 12:51:30,354 epoch 88 - iter 88/111 - loss 1.01447212 - samples/sec: 24.31 - lr: 0.025000\r\n2021-01-25 12:51:36,458 epoch 88 - iter 99/111 - loss 1.00881708 - samples/sec: 28.84 - lr: 0.025000\r\n2021-01-25 12:51:42,730 epoch 88 - iter 110/111 - loss 1.00967457 - samples/sec: 28.07 - lr: 0.025000\r\n2021-01-25 12:51:42,876 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:51:42,877 EPOCH 88 done: loss 1.0161 - lr 0.0250000\r\n2021-01-25 12:51:42,879 BAD EPOCHS (no improvement): 0\r\n2021-01-25 12:52:16,948 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:52:22,652 epoch 89 - iter 11/111 - loss 1.01192850 - samples/sec: 31.02 - lr: 0.025000\r\n2021-01-25 12:52:29,833 epoch 89 - iter 22/111 - loss 0.97130948 - samples/sec: 24.52 - lr: 0.025000\r\n2021-01-25 12:52:36,670 epoch 89 - iter 33/111 - loss 1.03705973 - samples/sec: 25.76 - lr: 0.025000\r\n2021-01-25 12:52:43,108 epoch 89 - iter 44/111 - loss 0.99423095 - samples/sec: 27.35 - lr: 0.025000\r\n2021-01-25 12:52:50,388 epoch 89 - iter 55/111 - loss 1.00434195 - samples/sec: 24.18 - lr: 0.025000\r\n2021-01-25 12:52:57,068 epoch 89 - iter 66/111 - loss 0.98344049 - samples/sec: 26.36 - lr: 0.025000\r\n2021-01-25 12:53:04,125 epoch 89 - iter 77/111 - loss 0.97784265 - samples/sec: 24.95 - lr: 0.025000\r\n2021-01-25 12:53:10,688 epoch 89 - iter 88/111 - loss 0.93191730 - samples/sec: 26.83 - lr: 0.025000\r\n2021-01-25 12:53:15,940 epoch 89 - iter 99/111 - loss 0.94655101 - samples/sec: 33.53 - lr: 0.025000\r\n2021-01-25 12:53:21,888 epoch 89 - iter 110/111 - loss 0.96525188 - samples/sec: 29.60 - lr: 0.025000\r\n2021-01-25 12:53:22,161 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:53:22,162 EPOCH 89 done: loss 0.9703 - lr 0.0250000\r\n2021-01-25 12:53:22,163 BAD EPOCHS (no improvement): 0\r\n2021-01-25 12:54:02,255 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:54:07,327 epoch 90 - iter 11/111 - loss 0.89396156 - samples/sec: 34.91 - lr: 0.025000\r\n2021-01-25 12:54:12,901 epoch 90 - iter 22/111 - loss 0.94856649 - samples/sec: 31.58 - lr: 0.025000\r\n2021-01-25 12:54:19,321 epoch 90 - iter 33/111 - loss 0.85900531 - samples/sec: 27.43 - lr: 0.025000\r\n2021-01-25 12:54:26,733 epoch 90 - iter 44/111 - loss 0.91310688 - samples/sec: 23.75 - lr: 0.025000\r\n2021-01-25 12:54:33,402 epoch 90 - iter 55/111 - loss 0.91476873 - samples/sec: 26.40 - lr: 0.025000\r\n2021-01-25 12:54:41,020 epoch 90 - iter 66/111 - loss 0.94598620 - samples/sec: 23.11 - lr: 0.025000\r\n2021-01-25 12:54:47,872 epoch 90 - iter 77/111 - loss 0.95036292 - samples/sec: 25.70 - lr: 0.025000\r\n2021-01-25 12:54:54,259 epoch 90 - iter 88/111 - loss 0.98239688 - samples/sec: 27.57 - lr: 0.025000\r\n2021-01-25 12:55:00,875 epoch 90 - iter 99/111 - loss 0.97952184 - samples/sec: 26.61 - lr: 0.025000\r\n2021-01-25 12:55:07,433 epoch 90 - iter 110/111 - loss 0.97337086 - samples/sec: 26.85 - lr: 0.025000\r\n2021-01-25 12:55:07,512 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:55:07,514 EPOCH 90 done: loss 0.9669 - lr 0.0250000\r\n2021-01-25 12:55:07,514 BAD EPOCHS (no improvement): 0\r\n2021-01-25 12:55:48,026 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:55:53,469 epoch 91 - iter 11/111 - loss 1.12259874 - samples/sec: 32.51 - lr: 0.025000\r\n2021-01-25 12:55:59,764 epoch 91 - iter 22/111 - loss 1.01117295 - samples/sec: 27.97 - lr: 0.025000\r\n2021-01-25 12:56:06,343 epoch 91 - iter 33/111 - loss 0.94316753 - samples/sec: 26.76 - lr: 0.025000\r\n2021-01-25 12:56:11,776 epoch 91 - iter 44/111 - loss 0.91113899 - samples/sec: 32.41 - lr: 0.025000\r\n2021-01-25 12:56:19,114 epoch 91 - iter 55/111 - loss 0.90855847 - samples/sec: 23.99 - lr: 0.025000\r\n2021-01-25 12:56:26,490 epoch 91 - iter 66/111 - loss 0.87885021 - samples/sec: 23.87 - lr: 0.025000\r\n2021-01-25 12:56:32,911 epoch 91 - iter 77/111 - loss 0.89054928 - samples/sec: 27.42 - lr: 0.025000\r\n2021-01-25 12:56:40,159 epoch 91 - iter 88/111 - loss 0.91477145 - samples/sec: 24.29 - lr: 0.025000\r\n2021-01-25 12:56:46,126 epoch 91 - iter 99/111 - loss 0.91054353 - samples/sec: 29.50 - lr: 0.025000\r\n2021-01-25 12:56:52,046 epoch 91 - iter 110/111 - loss 0.89999675 - samples/sec: 29.74 - lr: 0.025000\r\n2021-01-25 12:56:52,107 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:56:52,108 EPOCH 91 done: loss 0.8933 - lr 0.0250000\r\n2021-01-25 12:56:52,109 BAD EPOCHS (no improvement): 0\r\n2021-01-25 12:57:24,370 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:57:31,155 epoch 92 - iter 11/111 - loss 0.91195044 - samples/sec: 26.05 - lr: 0.025000\r\n2021-01-25 12:57:39,276 epoch 92 - iter 22/111 - loss 0.92761843 - samples/sec: 28.09 - lr: 0.025000\r\n2021-01-25 12:57:46,538 epoch 92 - iter 33/111 - loss 1.01224054 - samples/sec: 24.25 - lr: 0.025000\r\n2021-01-25 12:57:53,075 epoch 92 - iter 44/111 - loss 0.93886627 - samples/sec: 26.93 - lr: 0.025000\r\n2021-01-25 12:57:59,335 epoch 92 - iter 55/111 - loss 0.96555115 - samples/sec: 28.13 - lr: 0.025000\r\n2021-01-25 12:58:05,990 epoch 92 - iter 66/111 - loss 0.93257322 - samples/sec: 26.45 - lr: 0.025000\r\n2021-01-25 12:58:13,810 epoch 92 - iter 77/111 - loss 0.96046350 - samples/sec: 22.51 - lr: 0.025000\r\n2021-01-25 12:58:19,682 epoch 92 - iter 88/111 - loss 0.97479221 - samples/sec: 29.99 - lr: 0.025000\r\n2021-01-25 12:58:25,353 epoch 92 - iter 99/111 - loss 0.95190705 - samples/sec: 31.05 - lr: 0.025000\r\n2021-01-25 12:58:31,006 epoch 92 - iter 110/111 - loss 0.94280147 - samples/sec: 31.14 - lr: 0.025000\r\n2021-01-25 12:58:31,203 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 12:58:31,204 EPOCH 92 done: loss 0.9345 - lr 0.0250000\r\n2021-01-25 12:58:31,206 BAD EPOCHS (no improvement): 1\r\n2021-01-25 12:59:04,472 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 12:59:10,611 epoch 93 - iter 11/111 - loss 0.76319311 - samples/sec: 28.91 - lr: 0.025000\r\n2021-01-25 12:59:21,507 epoch 93 - iter 22/111 - loss 0.80824860 - samples/sec: 21.30 - lr: 0.025000\r\n2021-01-25 12:59:28,277 epoch 93 - iter 33/111 - loss 0.87222931 - samples/sec: 26.01 - lr: 0.025000\r\n2021-01-25 12:59:36,146 epoch 93 - iter 44/111 - loss 0.93845968 - samples/sec: 22.37 - lr: 0.025000\r\n2021-01-25 12:59:43,110 epoch 93 - iter 55/111 - loss 0.97216012 - samples/sec: 25.28 - lr: 0.025000\r\n2021-01-25 12:59:49,391 epoch 93 - iter 66/111 - loss 0.94475628 - samples/sec: 28.03 - lr: 0.025000\r\n2021-01-25 12:59:55,729 epoch 93 - iter 77/111 - loss 0.93116077 - samples/sec: 27.78 - lr: 0.025000\r\n2021-01-25 13:00:00,918 epoch 93 - iter 88/111 - loss 0.92936302 - samples/sec: 33.94 - lr: 0.025000\r\n2021-01-25 13:00:06,547 epoch 93 - iter 99/111 - loss 0.94155475 - samples/sec: 31.28 - lr: 0.025000\r\n2021-01-25 13:00:12,429 epoch 93 - iter 110/111 - loss 0.94386096 - samples/sec: 29.93 - lr: 0.025000\r\n2021-01-25 13:00:12,475 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:00:12,476 EPOCH 93 done: loss 0.9385 - lr 0.0250000\r\n2021-01-25 13:00:12,478 BAD EPOCHS (no improvement): 2\r\n2021-01-25 13:00:53,789 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:01:00,272 epoch 94 - iter 11/111 - loss 0.80060596 - samples/sec: 27.33 - lr: 0.025000\r\n2021-01-25 13:01:05,867 epoch 94 - iter 22/111 - loss 0.76706426 - samples/sec: 31.47 - lr: 0.025000\r\n2021-01-25 13:01:11,599 epoch 94 - iter 33/111 - loss 0.81543036 - samples/sec: 30.72 - lr: 0.025000\r\n2021-01-25 13:01:18,936 epoch 94 - iter 44/111 - loss 0.88398113 - samples/sec: 24.00 - lr: 0.025000\r\n2021-01-25 13:01:25,885 epoch 94 - iter 55/111 - loss 0.87736669 - samples/sec: 25.34 - lr: 0.025000\r\n2021-01-25 13:01:33,393 epoch 94 - iter 66/111 - loss 0.84505906 - samples/sec: 23.45 - lr: 0.025000\r\n2021-01-25 13:01:40,200 epoch 94 - iter 77/111 - loss 0.84360749 - samples/sec: 25.86 - lr: 0.025000\r\n2021-01-25 13:01:45,652 epoch 94 - iter 88/111 - loss 0.86948546 - samples/sec: 32.30 - lr: 0.025000\r\n2021-01-25 13:01:51,536 epoch 94 - iter 99/111 - loss 0.87685072 - samples/sec: 29.92 - lr: 0.025000\r\n2021-01-25 13:01:57,924 epoch 94 - iter 110/111 - loss 0.86960360 - samples/sec: 27.56 - lr: 0.025000\r\n2021-01-25 13:01:57,988 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:01:57,989 EPOCH 94 done: loss 0.8618 - lr 0.0250000\r\n2021-01-25 13:01:57,990 BAD EPOCHS (no improvement): 0\r\n2021-01-25 13:02:36,161 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:02:42,494 epoch 95 - iter 11/111 - loss 1.05845071 - samples/sec: 27.92 - lr: 0.025000\r\n2021-01-25 13:02:48,386 epoch 95 - iter 22/111 - loss 0.92435220 - samples/sec: 29.88 - lr: 0.025000\r\n2021-01-25 13:02:55,476 epoch 95 - iter 33/111 - loss 1.01854410 - samples/sec: 24.84 - lr: 0.025000\r\n2021-01-25 13:03:02,522 epoch 95 - iter 44/111 - loss 0.95836734 - samples/sec: 24.99 - lr: 0.025000\r\n2021-01-25 13:03:10,668 epoch 95 - iter 55/111 - loss 0.92500736 - samples/sec: 21.61 - lr: 0.025000\r\n2021-01-25 13:03:17,699 epoch 95 - iter 66/111 - loss 0.89741766 - samples/sec: 25.04 - lr: 0.025000\r\n2021-01-25 13:03:23,281 epoch 95 - iter 77/111 - loss 0.92225909 - samples/sec: 31.55 - lr: 0.025000\r\n2021-01-25 13:03:29,258 epoch 95 - iter 88/111 - loss 0.93587268 - samples/sec: 29.46 - lr: 0.025000\r\n2021-01-25 13:03:34,565 epoch 95 - iter 99/111 - loss 0.90957047 - samples/sec: 33.18 - lr: 0.025000\r\n2021-01-25 13:03:40,620 epoch 95 - iter 110/111 - loss 0.89800110 - samples/sec: 29.08 - lr: 0.025000\r\n2021-01-25 13:03:40,720 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:03:40,722 EPOCH 95 done: loss 0.9710 - lr 0.0250000\r\n2021-01-25 13:03:40,723 BAD EPOCHS (no improvement): 1\r\n2021-01-25 13:04:21,198 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:04:27,384 epoch 96 - iter 11/111 - loss 0.80467089 - samples/sec: 28.58 - lr: 0.025000\r\n2021-01-25 13:04:33,387 epoch 96 - iter 22/111 - loss 0.86729766 - samples/sec: 29.33 - lr: 0.025000\r\n2021-01-25 13:04:40,351 epoch 96 - iter 33/111 - loss 0.88488515 - samples/sec: 25.28 - lr: 0.025000\r\n2021-01-25 13:04:46,698 epoch 96 - iter 44/111 - loss 0.88125065 - samples/sec: 27.74 - lr: 0.025000\r\n2021-01-25 13:04:53,369 epoch 96 - iter 55/111 - loss 0.86685654 - samples/sec: 26.39 - lr: 0.025000\r\n2021-01-25 13:04:59,839 epoch 96 - iter 66/111 - loss 0.82779145 - samples/sec: 27.21 - lr: 0.025000\r\n2021-01-25 13:05:05,934 epoch 96 - iter 77/111 - loss 0.83271972 - samples/sec: 28.88 - lr: 0.025000\r\n2021-01-25 13:05:12,058 epoch 96 - iter 88/111 - loss 0.84438797 - samples/sec: 28.75 - lr: 0.025000\r\n2021-01-25 13:05:18,159 epoch 96 - iter 99/111 - loss 0.83008090 - samples/sec: 28.86 - lr: 0.025000\r\n2021-01-25 13:05:25,296 epoch 96 - iter 110/111 - loss 0.84527026 - samples/sec: 24.67 - lr: 0.025000\r\n2021-01-25 13:05:25,418 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:05:25,419 EPOCH 96 done: loss 0.8442 - lr 0.0250000\r\n2021-01-25 13:05:25,420 BAD EPOCHS (no improvement): 0\r\n2021-01-25 13:06:04,455 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:06:10,219 epoch 97 - iter 11/111 - loss 0.83351330 - samples/sec: 30.70 - lr: 0.025000\r\n2021-01-25 13:06:15,321 epoch 97 - iter 22/111 - loss 0.83220994 - samples/sec: 34.51 - lr: 0.025000\r\n2021-01-25 13:06:23,308 epoch 97 - iter 33/111 - loss 0.94219524 - samples/sec: 22.04 - lr: 0.025000\r\n2021-01-25 13:06:29,764 epoch 97 - iter 44/111 - loss 0.90053729 - samples/sec: 27.27 - lr: 0.025000\r\n2021-01-25 13:06:36,276 epoch 97 - iter 55/111 - loss 0.87480188 - samples/sec: 27.04 - lr: 0.025000\r\n2021-01-25 13:06:42,959 epoch 97 - iter 66/111 - loss 0.88492908 - samples/sec: 26.34 - lr: 0.025000\r\n2021-01-25 13:06:49,641 epoch 97 - iter 77/111 - loss 0.88339231 - samples/sec: 26.35 - lr: 0.025000\r\n2021-01-25 13:06:56,023 epoch 97 - iter 88/111 - loss 0.86654037 - samples/sec: 27.59 - lr: 0.025000\r\n2021-01-25 13:07:03,367 epoch 97 - iter 99/111 - loss 0.87654721 - samples/sec: 23.97 - lr: 0.025000\r\n2021-01-25 13:07:09,728 epoch 97 - iter 110/111 - loss 0.85163859 - samples/sec: 27.68 - lr: 0.025000\r\n2021-01-25 13:07:09,844 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:07:09,846 EPOCH 97 done: loss 0.8613 - lr 0.0250000\r\n2021-01-25 13:07:09,847 BAD EPOCHS (no improvement): 1\r\n2021-01-25 13:07:50,879 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:07:58,252 epoch 98 - iter 11/111 - loss 0.82806001 - samples/sec: 23.98 - lr: 0.025000\r\n2021-01-25 13:08:05,020 epoch 98 - iter 22/111 - loss 0.86607333 - samples/sec: 26.02 - lr: 0.025000\r\n2021-01-25 13:08:11,580 epoch 98 - iter 33/111 - loss 0.94919064 - samples/sec: 26.84 - lr: 0.025000\r\n2021-01-25 13:08:19,165 epoch 98 - iter 44/111 - loss 0.92271694 - samples/sec: 23.22 - lr: 0.025000\r\n2021-01-25 13:08:25,986 epoch 98 - iter 55/111 - loss 0.89980591 - samples/sec: 25.81 - lr: 0.025000\r\n2021-01-25 13:08:32,172 epoch 98 - iter 66/111 - loss 0.88184847 - samples/sec: 28.46 - lr: 0.025000\r\n2021-01-25 13:08:38,899 epoch 98 - iter 77/111 - loss 0.87890078 - samples/sec: 26.17 - lr: 0.025000\r\n2021-01-25 13:08:46,184 epoch 98 - iter 88/111 - loss 0.87076851 - samples/sec: 24.17 - lr: 0.025000\r\n2021-01-25 13:08:51,861 epoch 98 - iter 99/111 - loss 0.87326085 - samples/sec: 31.02 - lr: 0.025000\r\n2021-01-25 13:08:57,961 epoch 98 - iter 110/111 - loss 0.86002073 - samples/sec: 28.86 - lr: 0.025000\r\n2021-01-25 13:08:58,063 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:08:58,064 EPOCH 98 done: loss 0.8523 - lr 0.0250000\r\n2021-01-25 13:08:58,066 BAD EPOCHS (no improvement): 2\r\n2021-01-25 13:09:34,666 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:09:41,057 epoch 99 - iter 11/111 - loss 0.80923878 - samples/sec: 27.66 - lr: 0.025000\r\n2021-01-25 13:09:47,900 epoch 99 - iter 22/111 - loss 0.82019573 - samples/sec: 25.73 - lr: 0.025000\r\n2021-01-25 13:09:55,133 epoch 99 - iter 33/111 - loss 0.87697485 - samples/sec: 24.34 - lr: 0.025000\r\n2021-01-25 13:10:01,103 epoch 99 - iter 44/111 - loss 0.84858296 - samples/sec: 29.49 - lr: 0.025000\r\n2021-01-25 13:10:08,094 epoch 99 - iter 55/111 - loss 0.84927820 - samples/sec: 25.18 - lr: 0.025000\r\n2021-01-25 13:10:13,638 epoch 99 - iter 66/111 - loss 0.83019196 - samples/sec: 31.76 - lr: 0.025000\r\n2021-01-25 13:10:19,677 epoch 99 - iter 77/111 - loss 0.83874743 - samples/sec: 29.16 - lr: 0.025000\r\n2021-01-25 13:10:26,329 epoch 99 - iter 88/111 - loss 0.82511558 - samples/sec: 26.47 - lr: 0.025000\r\n2021-01-25 13:10:33,761 epoch 99 - iter 99/111 - loss 0.83035890 - samples/sec: 23.69 - lr: 0.025000\r\n2021-01-25 13:10:39,933 epoch 99 - iter 110/111 - loss 0.81092254 - samples/sec: 28.53 - lr: 0.025000\r\n2021-01-25 13:10:40,088 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:10:40,089 EPOCH 99 done: loss 0.8109 - lr 0.0250000\r\n2021-01-25 13:10:40,091 BAD EPOCHS (no improvement): 0\r\n2021-01-25 13:11:18,404 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:11:24,829 epoch 100 - iter 11/111 - loss 1.23233911 - samples/sec: 27.53 - lr: 0.025000\r\n2021-01-25 13:11:30,887 epoch 100 - iter 22/111 - loss 0.95968962 - samples/sec: 29.06 - lr: 0.025000\r\n2021-01-25 13:11:37,798 epoch 100 - iter 33/111 - loss 0.90293363 - samples/sec: 25.48 - lr: 0.025000\r\n2021-01-25 13:11:44,710 epoch 100 - iter 44/111 - loss 0.87274729 - samples/sec: 25.47 - lr: 0.025000\r\n2021-01-25 13:11:51,196 epoch 100 - iter 55/111 - loss 0.91466900 - samples/sec: 27.15 - lr: 0.025000\r\n2021-01-25 13:11:57,685 epoch 100 - iter 66/111 - loss 0.92499208 - samples/sec: 27.13 - lr: 0.025000\r\n2021-01-25 13:12:04,797 epoch 100 - iter 77/111 - loss 0.91667200 - samples/sec: 24.76 - lr: 0.025000\r\n2021-01-25 13:12:12,584 epoch 100 - iter 88/111 - loss 0.93384858 - samples/sec: 22.61 - lr: 0.025000\r\n2021-01-25 13:12:18,552 epoch 100 - iter 99/111 - loss 0.91917092 - samples/sec: 29.50 - lr: 0.025000\r\n2021-01-25 13:12:24,661 epoch 100 - iter 110/111 - loss 0.90454569 - samples/sec: 28.82 - lr: 0.025000\r\n2021-01-25 13:12:24,751 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:12:24,753 EPOCH 100 done: loss 0.8978 - lr 0.0250000\r\n2021-01-25 13:12:24,754 BAD EPOCHS (no improvement): 1\r\n2021-01-25 13:13:01,082 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:13:06,431 epoch 101 - iter 11/111 - loss 0.72068848 - samples/sec: 33.08 - lr: 0.025000\r\n2021-01-25 13:13:13,113 epoch 101 - iter 22/111 - loss 0.76602584 - samples/sec: 26.36 - lr: 0.025000\r\n2021-01-25 13:13:20,337 epoch 101 - iter 33/111 - loss 0.78204447 - samples/sec: 24.37 - lr: 0.025000\r\n2021-01-25 13:13:27,132 epoch 101 - iter 44/111 - loss 0.84667853 - samples/sec: 25.91 - lr: 0.025000\r\n2021-01-25 13:13:35,455 epoch 101 - iter 55/111 - loss 0.87525084 - samples/sec: 21.15 - lr: 0.025000\r\n2021-01-25 13:13:42,088 epoch 101 - iter 66/111 - loss 0.92288906 - samples/sec: 26.55 - lr: 0.025000\r\n2021-01-25 13:13:49,006 epoch 101 - iter 77/111 - loss 0.87778378 - samples/sec: 25.45 - lr: 0.025000\r\n2021-01-25 13:13:55,163 epoch 101 - iter 88/111 - loss 0.87100984 - samples/sec: 28.60 - lr: 0.025000\r\n2021-01-25 13:14:00,122 epoch 101 - iter 99/111 - loss 0.84793395 - samples/sec: 35.51 - lr: 0.025000\r\n2021-01-25 13:14:05,896 epoch 101 - iter 110/111 - loss 0.83776233 - samples/sec: 30.49 - lr: 0.025000\r\n2021-01-25 13:14:06,030 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:14:06,032 EPOCH 101 done: loss 0.8584 - lr 0.0250000\r\n2021-01-25 13:14:06,034 BAD EPOCHS (no improvement): 2\r\n2021-01-25 13:14:41,521 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:14:47,136 epoch 102 - iter 11/111 - loss 0.73878605 - samples/sec: 31.50 - lr: 0.025000\r\n2021-01-25 13:14:52,978 epoch 102 - iter 22/111 - loss 0.79044485 - samples/sec: 30.14 - lr: 0.025000\r\n2021-01-25 13:14:59,353 epoch 102 - iter 33/111 - loss 0.76262681 - samples/sec: 27.62 - lr: 0.025000\r\n2021-01-25 13:15:06,989 epoch 102 - iter 44/111 - loss 0.79057171 - samples/sec: 23.06 - lr: 0.025000\r\n2021-01-25 13:15:13,764 epoch 102 - iter 55/111 - loss 0.77894565 - samples/sec: 25.98 - lr: 0.025000\r\n2021-01-25 13:15:19,236 epoch 102 - iter 66/111 - loss 0.78738895 - samples/sec: 32.18 - lr: 0.025000\r\n2021-01-25 13:15:26,887 epoch 102 - iter 77/111 - loss 0.78415570 - samples/sec: 23.01 - lr: 0.025000\r\n2021-01-25 13:15:34,970 epoch 102 - iter 88/111 - loss 0.77433868 - samples/sec: 21.78 - lr: 0.025000\r\n2021-01-25 13:15:41,058 epoch 102 - iter 99/111 - loss 0.79454992 - samples/sec: 28.94 - lr: 0.025000\r\n2021-01-25 13:15:46,522 epoch 102 - iter 110/111 - loss 0.78881507 - samples/sec: 32.22 - lr: 0.025000\r\n2021-01-25 13:15:46,820 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:15:46,821 EPOCH 102 done: loss 0.8152 - lr 0.0250000\r\n2021-01-25 13:15:46,823 BAD EPOCHS (no improvement): 3\r\n2021-01-25 13:16:19,467 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:16:25,278 epoch 103 - iter 11/111 - loss 0.74123833 - samples/sec: 30.44 - lr: 0.025000\r\n2021-01-25 13:16:32,044 epoch 103 - iter 22/111 - loss 0.69190160 - samples/sec: 26.02 - lr: 0.025000\r\n2021-01-25 13:16:38,365 epoch 103 - iter 33/111 - loss 0.72119454 - samples/sec: 27.85 - lr: 0.025000\r\n2021-01-25 13:16:45,331 epoch 103 - iter 44/111 - loss 0.72245607 - samples/sec: 25.28 - lr: 0.025000\r\n2021-01-25 13:16:51,169 epoch 103 - iter 55/111 - loss 0.74065522 - samples/sec: 30.16 - lr: 0.025000\r\n2021-01-25 13:16:59,692 epoch 103 - iter 66/111 - loss 0.76567466 - samples/sec: 20.66 - lr: 0.025000\r\n2021-01-25 13:17:06,089 epoch 103 - iter 77/111 - loss 0.77390303 - samples/sec: 27.52 - lr: 0.025000\r\n2021-01-25 13:17:13,786 epoch 103 - iter 88/111 - loss 0.78259146 - samples/sec: 22.87 - lr: 0.025000\r\n2021-01-25 13:17:18,932 epoch 103 - iter 99/111 - loss 0.77794933 - samples/sec: 34.22 - lr: 0.025000\r\n2021-01-25 13:17:25,464 epoch 103 - iter 110/111 - loss 0.78266095 - samples/sec: 26.96 - lr: 0.025000\r\n2021-01-25 13:17:25,570 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:17:25,571 EPOCH 103 done: loss 0.7756 - lr 0.0250000\r\n2021-01-25 13:17:25,573 BAD EPOCHS (no improvement): 0\r\n2021-01-25 13:18:05,856 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:18:12,089 epoch 104 - iter 11/111 - loss 0.84889564 - samples/sec: 28.37 - lr: 0.025000\r\n2021-01-25 13:18:18,905 epoch 104 - iter 22/111 - loss 0.88635410 - samples/sec: 25.83 - lr: 0.025000\r\n2021-01-25 13:18:24,719 epoch 104 - iter 33/111 - loss 0.91701587 - samples/sec: 30.28 - lr: 0.025000\r\n2021-01-25 13:18:32,156 epoch 104 - iter 44/111 - loss 0.87236986 - samples/sec: 23.67 - lr: 0.025000\r\n2021-01-25 13:18:38,553 epoch 104 - iter 55/111 - loss 0.84002334 - samples/sec: 27.52 - lr: 0.025000\r\n2021-01-25 13:18:46,313 epoch 104 - iter 66/111 - loss 0.83812284 - samples/sec: 22.69 - lr: 0.025000\r\n2021-01-25 13:18:53,078 epoch 104 - iter 77/111 - loss 0.82564598 - samples/sec: 26.03 - lr: 0.025000\r\n2021-01-25 13:19:00,228 epoch 104 - iter 88/111 - loss 0.81723271 - samples/sec: 24.62 - lr: 0.025000\r\n2021-01-25 13:19:05,094 epoch 104 - iter 99/111 - loss 0.80680975 - samples/sec: 36.19 - lr: 0.025000\r\n2021-01-25 13:19:10,903 epoch 104 - iter 110/111 - loss 0.80274126 - samples/sec: 30.31 - lr: 0.025000\r\n2021-01-25 13:19:10,982 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:19:10,984 EPOCH 104 done: loss 0.8121 - lr 0.0250000\r\n2021-01-25 13:19:10,985 BAD EPOCHS (no improvement): 1\r\n2021-01-25 13:19:46,582 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:19:52,522 epoch 105 - iter 11/111 - loss 0.75238445 - samples/sec: 29.78 - lr: 0.025000\r\n2021-01-25 13:19:58,366 epoch 105 - iter 22/111 - loss 0.71207552 - samples/sec: 30.13 - lr: 0.025000\r\n2021-01-25 13:20:04,656 epoch 105 - iter 33/111 - loss 0.68897040 - samples/sec: 27.99 - lr: 0.025000\r\n2021-01-25 13:20:12,444 epoch 105 - iter 44/111 - loss 0.70233877 - samples/sec: 22.61 - lr: 0.025000\r\n2021-01-25 13:20:18,361 epoch 105 - iter 55/111 - loss 0.70961836 - samples/sec: 29.76 - lr: 0.025000\r\n2021-01-25 13:20:24,905 epoch 105 - iter 66/111 - loss 0.70972574 - samples/sec: 26.91 - lr: 0.025000\r\n2021-01-25 13:20:31,995 epoch 105 - iter 77/111 - loss 0.72542387 - samples/sec: 24.83 - lr: 0.025000\r\n2021-01-25 13:20:39,467 epoch 105 - iter 88/111 - loss 0.76028742 - samples/sec: 23.56 - lr: 0.025000\r\n2021-01-25 13:20:45,538 epoch 105 - iter 99/111 - loss 0.75797118 - samples/sec: 29.00 - lr: 0.025000\r\n2021-01-25 13:20:51,481 epoch 105 - iter 110/111 - loss 0.74994436 - samples/sec: 29.63 - lr: 0.025000\r\n2021-01-25 13:20:51,626 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:20:51,627 EPOCH 105 done: loss 0.7444 - lr 0.0250000\r\n2021-01-25 13:20:51,628 BAD EPOCHS (no improvement): 0\r\n2021-01-25 13:21:27,334 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:21:32,837 epoch 106 - iter 11/111 - loss 0.64356654 - samples/sec: 32.16 - lr: 0.025000\r\n2021-01-25 13:21:38,720 epoch 106 - iter 22/111 - loss 0.68415704 - samples/sec: 29.93 - lr: 0.025000\r\n2021-01-25 13:21:45,922 epoch 106 - iter 33/111 - loss 0.69880616 - samples/sec: 24.45 - lr: 0.025000\r\n2021-01-25 13:21:52,509 epoch 106 - iter 44/111 - loss 0.70173935 - samples/sec: 26.74 - lr: 0.025000\r\n2021-01-25 13:22:00,333 epoch 106 - iter 55/111 - loss 0.70095117 - samples/sec: 22.50 - lr: 0.025000\r\n2021-01-25 13:22:07,637 epoch 106 - iter 66/111 - loss 0.72124311 - samples/sec: 24.10 - lr: 0.025000\r\n2021-01-25 13:22:14,853 epoch 106 - iter 77/111 - loss 0.72070282 - samples/sec: 24.40 - lr: 0.025000\r\n2021-01-25 13:22:20,696 epoch 106 - iter 88/111 - loss 0.71518310 - samples/sec: 30.13 - lr: 0.025000\r\n2021-01-25 13:22:26,923 epoch 106 - iter 99/111 - loss 0.73347111 - samples/sec: 28.27 - lr: 0.025000\r\n2021-01-25 13:22:32,228 epoch 106 - iter 110/111 - loss 0.72210925 - samples/sec: 33.19 - lr: 0.025000\r\n2021-01-25 13:22:32,290 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:22:32,291 EPOCH 106 done: loss 0.7157 - lr 0.0250000\r\n2021-01-25 13:22:32,294 BAD EPOCHS (no improvement): 0\r\n2021-01-25 13:23:11,705 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:23:16,568 epoch 107 - iter 11/111 - loss 0.78385908 - samples/sec: 36.41 - lr: 0.025000\r\n2021-01-25 13:23:23,654 epoch 107 - iter 22/111 - loss 0.80658507 - samples/sec: 24.85 - lr: 0.025000\r\n2021-01-25 13:23:30,244 epoch 107 - iter 33/111 - loss 0.75227328 - samples/sec: 26.72 - lr: 0.025000\r\n2021-01-25 13:23:37,904 epoch 107 - iter 44/111 - loss 0.73590938 - samples/sec: 22.99 - lr: 0.025000\r\n2021-01-25 13:23:44,051 epoch 107 - iter 55/111 - loss 0.70672992 - samples/sec: 28.64 - lr: 0.025000\r\n2021-01-25 13:23:51,633 epoch 107 - iter 66/111 - loss 0.71791957 - samples/sec: 23.22 - lr: 0.025000\r\n2021-01-25 13:23:57,650 epoch 107 - iter 77/111 - loss 0.72108388 - samples/sec: 29.26 - lr: 0.025000\r\n2021-01-25 13:24:03,052 epoch 107 - iter 88/111 - loss 0.73094791 - samples/sec: 32.59 - lr: 0.025000\r\n2021-01-25 13:24:08,745 epoch 107 - iter 99/111 - loss 0.76851634 - samples/sec: 30.93 - lr: 0.025000\r\n2021-01-25 13:24:14,615 epoch 107 - iter 110/111 - loss 0.78710466 - samples/sec: 30.00 - lr: 0.025000\r\n2021-01-25 13:24:14,702 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:24:14,703 EPOCH 107 done: loss 0.7800 - lr 0.0250000\r\n2021-01-25 13:24:14,704 BAD EPOCHS (no improvement): 1\r\n2021-01-25 13:24:46,476 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:24:52,133 epoch 108 - iter 11/111 - loss 0.80362939 - samples/sec: 31.28 - lr: 0.025000\r\n2021-01-25 13:24:58,875 epoch 108 - iter 22/111 - loss 0.80106070 - samples/sec: 26.11 - lr: 0.025000\r\n2021-01-25 13:25:06,231 epoch 108 - iter 33/111 - loss 0.74569149 - samples/sec: 23.94 - lr: 0.025000\r\n2021-01-25 13:25:12,633 epoch 108 - iter 44/111 - loss 0.75380532 - samples/sec: 27.50 - lr: 0.025000\r\n2021-01-25 13:25:19,871 epoch 108 - iter 55/111 - loss 0.76033305 - samples/sec: 24.33 - lr: 0.025000\r\n2021-01-25 13:25:25,753 epoch 108 - iter 66/111 - loss 0.75026805 - samples/sec: 29.93 - lr: 0.025000\r\n2021-01-25 13:25:32,584 epoch 108 - iter 77/111 - loss 0.74224959 - samples/sec: 25.77 - lr: 0.025000\r\n2021-01-25 13:25:39,388 epoch 108 - iter 88/111 - loss 0.75863961 - samples/sec: 25.88 - lr: 0.025000\r\n2021-01-25 13:25:45,013 epoch 108 - iter 99/111 - loss 0.75311675 - samples/sec: 31.30 - lr: 0.025000\r\n2021-01-25 13:25:51,156 epoch 108 - iter 110/111 - loss 0.76198733 - samples/sec: 28.66 - lr: 0.025000\r\n2021-01-25 13:25:51,227 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:25:51,228 EPOCH 108 done: loss 0.7556 - lr 0.0250000\r\n2021-01-25 13:25:51,230 BAD EPOCHS (no improvement): 2\r\n2021-01-25 13:26:24,772 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:26:30,196 epoch 109 - iter 11/111 - loss 0.67946928 - samples/sec: 32.63 - lr: 0.025000\r\n2021-01-25 13:26:36,569 epoch 109 - iter 22/111 - loss 0.63537086 - samples/sec: 27.62 - lr: 0.025000\r\n2021-01-25 13:26:44,345 epoch 109 - iter 33/111 - loss 0.67198067 - samples/sec: 22.64 - lr: 0.025000\r\n2021-01-25 13:26:50,602 epoch 109 - iter 44/111 - loss 0.66798389 - samples/sec: 28.14 - lr: 0.025000\r\n2021-01-25 13:26:57,754 epoch 109 - iter 55/111 - loss 0.66822040 - samples/sec: 24.62 - lr: 0.025000\r\n2021-01-25 13:27:04,891 epoch 109 - iter 66/111 - loss 0.70470827 - samples/sec: 24.67 - lr: 0.025000\r\n2021-01-25 13:27:11,590 epoch 109 - iter 77/111 - loss 0.70594568 - samples/sec: 26.29 - lr: 0.025000\r\n2021-01-25 13:27:16,862 epoch 109 - iter 88/111 - loss 0.71501861 - samples/sec: 33.40 - lr: 0.025000\r\n2021-01-25 13:27:23,079 epoch 109 - iter 99/111 - loss 0.70206023 - samples/sec: 28.32 - lr: 0.025000\r\n2021-01-25 13:27:28,714 epoch 109 - iter 110/111 - loss 0.70352085 - samples/sec: 31.25 - lr: 0.025000\r\n2021-01-25 13:27:28,904 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:27:28,906 EPOCH 109 done: loss 0.7028 - lr 0.0250000\r\n2021-01-25 13:27:28,907 BAD EPOCHS (no improvement): 0\r\n2021-01-25 13:28:00,866 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:28:06,656 epoch 110 - iter 11/111 - loss 0.71369973 - samples/sec: 30.57 - lr: 0.025000\r\n2021-01-25 13:28:13,156 epoch 110 - iter 22/111 - loss 0.66351167 - samples/sec: 27.08 - lr: 0.025000\r\n2021-01-25 13:28:20,549 epoch 110 - iter 33/111 - loss 0.81643700 - samples/sec: 23.82 - lr: 0.025000\r\n2021-01-25 13:28:27,384 epoch 110 - iter 44/111 - loss 0.74415305 - samples/sec: 25.77 - lr: 0.025000\r\n2021-01-25 13:28:33,510 epoch 110 - iter 55/111 - loss 0.67818336 - samples/sec: 28.74 - lr: 0.025000\r\n2021-01-25 13:28:39,740 epoch 110 - iter 66/111 - loss 0.66982269 - samples/sec: 28.26 - lr: 0.025000\r\n2021-01-25 13:28:47,270 epoch 110 - iter 77/111 - loss 0.68938970 - samples/sec: 23.38 - lr: 0.025000\r\n2021-01-25 13:28:53,242 epoch 110 - iter 88/111 - loss 0.69433806 - samples/sec: 29.49 - lr: 0.025000\r\n2021-01-25 13:28:59,377 epoch 110 - iter 99/111 - loss 0.70094008 - samples/sec: 28.70 - lr: 0.025000\r\n2021-01-25 13:29:04,788 epoch 110 - iter 110/111 - loss 0.69715567 - samples/sec: 32.54 - lr: 0.025000\r\n2021-01-25 13:29:04,865 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:29:04,867 EPOCH 110 done: loss 0.6911 - lr 0.0250000\r\n2021-01-25 13:29:04,868 BAD EPOCHS (no improvement): 0\r\n2021-01-25 13:29:45,483 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:29:52,653 epoch 111 - iter 11/111 - loss 0.63257407 - samples/sec: 24.64 - lr: 0.025000\r\n2021-01-25 13:29:58,844 epoch 111 - iter 22/111 - loss 0.65866832 - samples/sec: 28.44 - lr: 0.025000\r\n2021-01-25 13:30:05,551 epoch 111 - iter 33/111 - loss 0.69570449 - samples/sec: 26.25 - lr: 0.025000\r\n2021-01-25 13:30:12,712 epoch 111 - iter 44/111 - loss 0.70284502 - samples/sec: 24.58 - lr: 0.025000\r\n2021-01-25 13:30:18,503 epoch 111 - iter 55/111 - loss 0.67599891 - samples/sec: 30.40 - lr: 0.025000\r\n2021-01-25 13:30:25,430 epoch 111 - iter 66/111 - loss 0.70085383 - samples/sec: 25.42 - lr: 0.025000\r\n2021-01-25 13:30:33,174 epoch 111 - iter 77/111 - loss 0.69126879 - samples/sec: 22.74 - lr: 0.025000\r\n2021-01-25 13:30:38,533 epoch 111 - iter 88/111 - loss 0.71777350 - samples/sec: 32.86 - lr: 0.025000\r\n2021-01-25 13:30:44,432 epoch 111 - iter 99/111 - loss 0.71716955 - samples/sec: 29.84 - lr: 0.025000\r\n2021-01-25 13:30:50,481 epoch 111 - iter 110/111 - loss 0.71869382 - samples/sec: 29.11 - lr: 0.025000\r\n2021-01-25 13:30:50,570 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:30:50,572 EPOCH 111 done: loss 0.7126 - lr 0.0250000\r\n2021-01-25 13:30:50,573 BAD EPOCHS (no improvement): 1\r\n2021-01-25 13:31:29,114 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:31:36,137 epoch 112 - iter 11/111 - loss 0.75990707 - samples/sec: 25.17 - lr: 0.025000\r\n2021-01-25 13:31:42,555 epoch 112 - iter 22/111 - loss 0.65124447 - samples/sec: 27.43 - lr: 0.025000\r\n2021-01-25 13:31:48,907 epoch 112 - iter 33/111 - loss 0.67350851 - samples/sec: 27.72 - lr: 0.025000\r\n2021-01-25 13:31:55,671 epoch 112 - iter 44/111 - loss 0.72417201 - samples/sec: 26.03 - lr: 0.025000\r\n2021-01-25 13:32:01,546 epoch 112 - iter 55/111 - loss 0.70097128 - samples/sec: 29.97 - lr: 0.025000\r\n2021-01-25 13:32:08,411 epoch 112 - iter 66/111 - loss 0.71806321 - samples/sec: 25.65 - lr: 0.025000\r\n2021-01-25 13:32:15,532 epoch 112 - iter 77/111 - loss 0.72194873 - samples/sec: 24.73 - lr: 0.025000\r\n2021-01-25 13:32:21,571 epoch 112 - iter 88/111 - loss 0.73156702 - samples/sec: 29.16 - lr: 0.025000\r\n2021-01-25 13:32:26,789 epoch 112 - iter 99/111 - loss 0.70580896 - samples/sec: 33.74 - lr: 0.025000\r\n2021-01-25 13:32:33,077 epoch 112 - iter 110/111 - loss 0.72110457 - samples/sec: 28.00 - lr: 0.025000\r\n2021-01-25 13:32:33,176 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:32:33,177 EPOCH 112 done: loss 0.7150 - lr 0.0250000\r\n2021-01-25 13:32:33,178 BAD EPOCHS (no improvement): 2\r\n2021-01-25 13:33:05,430 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:33:11,898 epoch 113 - iter 11/111 - loss 0.82508569 - samples/sec: 27.33 - lr: 0.025000\r\n2021-01-25 13:33:17,996 epoch 113 - iter 22/111 - loss 0.77450722 - samples/sec: 28.88 - lr: 0.025000\r\n2021-01-25 13:33:24,907 epoch 113 - iter 33/111 - loss 0.73547285 - samples/sec: 25.47 - lr: 0.025000\r\n2021-01-25 13:33:30,943 epoch 113 - iter 44/111 - loss 0.69540778 - samples/sec: 29.17 - lr: 0.025000\r\n2021-01-25 13:33:37,668 epoch 113 - iter 55/111 - loss 0.71267423 - samples/sec: 26.19 - lr: 0.025000\r\n2021-01-25 13:33:43,521 epoch 113 - iter 66/111 - loss 0.70831058 - samples/sec: 30.09 - lr: 0.025000\r\n2021-01-25 13:33:50,909 epoch 113 - iter 77/111 - loss 0.71425138 - samples/sec: 23.83 - lr: 0.025000\r\n2021-01-25 13:33:57,071 epoch 113 - iter 88/111 - loss 0.70778101 - samples/sec: 28.57 - lr: 0.025000\r\n2021-01-25 13:34:03,304 epoch 113 - iter 99/111 - loss 0.72269965 - samples/sec: 28.25 - lr: 0.025000\r\n2021-01-25 13:34:08,905 epoch 113 - iter 110/111 - loss 0.72732831 - samples/sec: 31.43 - lr: 0.025000\r\n2021-01-25 13:34:09,027 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:34:09,028 EPOCH 113 done: loss 0.7226 - lr 0.0250000\r\n2021-01-25 13:34:09,030 BAD EPOCHS (no improvement): 3\r\n2021-01-25 13:34:41,280 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:34:47,436 epoch 114 - iter 11/111 - loss 0.56088674 - samples/sec: 28.73 - lr: 0.025000\r\n2021-01-25 13:34:55,244 epoch 114 - iter 22/111 - loss 0.60757464 - samples/sec: 22.55 - lr: 0.025000\r\n2021-01-25 13:35:02,043 epoch 114 - iter 33/111 - loss 0.68038769 - samples/sec: 25.90 - lr: 0.025000\r\n2021-01-25 13:35:08,683 epoch 114 - iter 44/111 - loss 0.63854400 - samples/sec: 26.52 - lr: 0.025000\r\n2021-01-25 13:35:14,493 epoch 114 - iter 55/111 - loss 0.64930110 - samples/sec: 30.30 - lr: 0.025000\r\n2021-01-25 13:35:20,725 epoch 114 - iter 66/111 - loss 0.66459776 - samples/sec: 28.25 - lr: 0.025000\r\n2021-01-25 13:35:27,633 epoch 114 - iter 77/111 - loss 0.66347560 - samples/sec: 25.49 - lr: 0.025000\r\n2021-01-25 13:35:34,361 epoch 114 - iter 88/111 - loss 0.64584362 - samples/sec: 26.17 - lr: 0.025000\r\n2021-01-25 13:35:40,596 epoch 114 - iter 99/111 - loss 0.64234639 - samples/sec: 28.24 - lr: 0.025000\r\n2021-01-25 13:35:46,886 epoch 114 - iter 110/111 - loss 0.66038458 - samples/sec: 27.99 - lr: 0.025000\r\n2021-01-25 13:35:46,954 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:35:46,955 EPOCH 114 done: loss 0.6551 - lr 0.0250000\r\n2021-01-25 13:35:46,957 BAD EPOCHS (no improvement): 0\r\n2021-01-25 13:36:21,227 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:36:26,718 epoch 115 - iter 11/111 - loss 0.56298585 - samples/sec: 32.22 - lr: 0.025000\r\n2021-01-25 13:36:32,987 epoch 115 - iter 22/111 - loss 0.64012238 - samples/sec: 28.09 - lr: 0.025000\r\n2021-01-25 13:36:40,541 epoch 115 - iter 33/111 - loss 0.61518407 - samples/sec: 23.31 - lr: 0.025000\r\n2021-01-25 13:36:47,604 epoch 115 - iter 44/111 - loss 0.63969870 - samples/sec: 24.93 - lr: 0.025000\r\n2021-01-25 13:36:54,755 epoch 115 - iter 55/111 - loss 0.65050368 - samples/sec: 24.62 - lr: 0.025000\r\n2021-01-25 13:37:01,124 epoch 115 - iter 66/111 - loss 0.64726682 - samples/sec: 27.64 - lr: 0.025000\r\n2021-01-25 13:37:07,380 epoch 115 - iter 77/111 - loss 0.66146871 - samples/sec: 28.15 - lr: 0.025000\r\n2021-01-25 13:37:13,862 epoch 115 - iter 88/111 - loss 0.68050893 - samples/sec: 27.16 - lr: 0.025000\r\n2021-01-25 13:37:19,189 epoch 115 - iter 99/111 - loss 0.68166747 - samples/sec: 33.06 - lr: 0.025000\r\n2021-01-25 13:37:24,692 epoch 115 - iter 110/111 - loss 0.68001638 - samples/sec: 32.00 - lr: 0.025000\r\n2021-01-25 13:37:24,858 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:37:24,859 EPOCH 115 done: loss 0.6765 - lr 0.0250000\r\n2021-01-25 13:37:24,860 BAD EPOCHS (no improvement): 1\r\n2021-01-25 13:38:03,000 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:38:09,511 epoch 116 - iter 11/111 - loss 0.72998188 - samples/sec: 27.15 - lr: 0.025000\r\n2021-01-25 13:38:16,079 epoch 116 - iter 22/111 - loss 0.72190877 - samples/sec: 26.81 - lr: 0.025000\r\n2021-01-25 13:38:22,810 epoch 116 - iter 33/111 - loss 0.68275763 - samples/sec: 26.17 - lr: 0.025000\r\n2021-01-25 13:38:29,623 epoch 116 - iter 44/111 - loss 0.69687710 - samples/sec: 25.84 - lr: 0.025000\r\n2021-01-25 13:38:36,056 epoch 116 - iter 55/111 - loss 0.71078484 - samples/sec: 27.37 - lr: 0.025000\r\n2021-01-25 13:38:42,246 epoch 116 - iter 66/111 - loss 0.70068730 - samples/sec: 28.45 - lr: 0.025000\r\n2021-01-25 13:38:48,910 epoch 116 - iter 77/111 - loss 0.71536316 - samples/sec: 26.42 - lr: 0.025000\r\n2021-01-25 13:38:54,853 epoch 116 - iter 88/111 - loss 0.71234254 - samples/sec: 29.62 - lr: 0.025000\r\n2021-01-25 13:39:01,133 epoch 116 - iter 99/111 - loss 0.70125230 - samples/sec: 28.04 - lr: 0.025000\r\n2021-01-25 13:39:06,795 epoch 116 - iter 110/111 - loss 0.70607526 - samples/sec: 31.10 - lr: 0.025000\r\n2021-01-25 13:39:06,954 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:39:06,955 EPOCH 116 done: loss 0.7094 - lr 0.0250000\r\n2021-01-25 13:39:06,957 BAD EPOCHS (no improvement): 2\r\n2021-01-25 13:39:47,840 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:39:53,677 epoch 117 - iter 11/111 - loss 0.85482086 - samples/sec: 30.30 - lr: 0.025000\r\n2021-01-25 13:40:00,004 epoch 117 - iter 22/111 - loss 0.70978049 - samples/sec: 27.83 - lr: 0.025000\r\n2021-01-25 13:40:06,202 epoch 117 - iter 33/111 - loss 0.72454160 - samples/sec: 28.41 - lr: 0.025000\r\n2021-01-25 13:40:12,307 epoch 117 - iter 44/111 - loss 0.70538759 - samples/sec: 28.85 - lr: 0.025000\r\n2021-01-25 13:40:18,742 epoch 117 - iter 55/111 - loss 0.68637878 - samples/sec: 27.36 - lr: 0.025000\r\n2021-01-25 13:40:26,484 epoch 117 - iter 66/111 - loss 0.68752330 - samples/sec: 22.74 - lr: 0.025000\r\n2021-01-25 13:40:33,338 epoch 117 - iter 77/111 - loss 0.68788088 - samples/sec: 25.69 - lr: 0.025000\r\n2021-01-25 13:40:39,034 epoch 117 - iter 88/111 - loss 0.68027635 - samples/sec: 30.91 - lr: 0.025000\r\n2021-01-25 13:40:45,570 epoch 117 - iter 99/111 - loss 0.66959048 - samples/sec: 26.94 - lr: 0.025000\r\n2021-01-25 13:40:51,293 epoch 117 - iter 110/111 - loss 0.67828720 - samples/sec: 30.77 - lr: 0.025000\r\n2021-01-25 13:40:51,415 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:40:51,416 EPOCH 117 done: loss 0.6735 - lr 0.0250000\r\n2021-01-25 13:40:51,418 BAD EPOCHS (no improvement): 3\r\n2021-01-25 13:41:21,981 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:41:28,035 epoch 118 - iter 11/111 - loss 0.61396825 - samples/sec: 29.21 - lr: 0.025000\r\n2021-01-25 13:41:38,319 epoch 118 - iter 22/111 - loss 0.56253364 - samples/sec: 27.68 - lr: 0.025000\r\n2021-01-25 13:41:44,866 epoch 118 - iter 33/111 - loss 0.62176757 - samples/sec: 26.90 - lr: 0.025000\r\n2021-01-25 13:41:51,473 epoch 118 - iter 44/111 - loss 0.60675451 - samples/sec: 26.65 - lr: 0.025000\r\n2021-01-25 13:41:58,528 epoch 118 - iter 55/111 - loss 0.64548492 - samples/sec: 24.95 - lr: 0.025000\r\n2021-01-25 13:42:04,943 epoch 118 - iter 66/111 - loss 0.64572965 - samples/sec: 27.45 - lr: 0.025000\r\n2021-01-25 13:42:11,243 epoch 118 - iter 77/111 - loss 0.64876765 - samples/sec: 27.95 - lr: 0.025000\r\n2021-01-25 13:42:19,232 epoch 118 - iter 88/111 - loss 0.65159514 - samples/sec: 22.03 - lr: 0.025000\r\n2021-01-25 13:42:25,180 epoch 118 - iter 99/111 - loss 0.65371615 - samples/sec: 29.60 - lr: 0.025000\r\n2021-01-25 13:42:30,047 epoch 118 - iter 110/111 - loss 0.65268896 - samples/sec: 36.18 - lr: 0.025000\r\n2021-01-25 13:42:30,138 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:42:30,139 EPOCH 118 done: loss 0.6468 - lr 0.0250000\r\n2021-01-25 13:42:30,140 BAD EPOCHS (no improvement): 0\r\n2021-01-25 13:43:02,756 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:43:08,290 epoch 119 - iter 11/111 - loss 0.71942934 - samples/sec: 31.98 - lr: 0.025000\r\n2021-01-25 13:43:15,259 epoch 119 - iter 22/111 - loss 0.67490881 - samples/sec: 25.26 - lr: 0.025000\r\n2021-01-25 13:43:21,144 epoch 119 - iter 33/111 - loss 0.67634846 - samples/sec: 29.92 - lr: 0.025000\r\n2021-01-25 13:43:27,385 epoch 119 - iter 44/111 - loss 0.65903231 - samples/sec: 28.21 - lr: 0.025000\r\n2021-01-25 13:43:34,014 epoch 119 - iter 55/111 - loss 0.67427227 - samples/sec: 26.56 - lr: 0.025000\r\n2021-01-25 13:43:41,119 epoch 119 - iter 66/111 - loss 0.63346933 - samples/sec: 24.78 - lr: 0.025000\r\n2021-01-25 13:43:49,156 epoch 119 - iter 77/111 - loss 0.63288591 - samples/sec: 21.91 - lr: 0.025000\r\n2021-01-25 13:43:55,571 epoch 119 - iter 88/111 - loss 0.64751344 - samples/sec: 27.44 - lr: 0.025000\r\n2021-01-25 13:44:01,338 epoch 119 - iter 99/111 - loss 0.64728304 - samples/sec: 30.53 - lr: 0.025000\r\n2021-01-25 13:44:07,865 epoch 119 - iter 110/111 - loss 0.64798920 - samples/sec: 26.97 - lr: 0.025000\r\n2021-01-25 13:44:08,003 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:44:08,005 EPOCH 119 done: loss 0.6583 - lr 0.0250000\r\n2021-01-25 13:44:08,006 BAD EPOCHS (no improvement): 1\r\n2021-01-25 13:44:40,563 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:44:46,268 epoch 120 - iter 11/111 - loss 0.70810749 - samples/sec: 31.02 - lr: 0.025000\r\n2021-01-25 13:44:52,572 epoch 120 - iter 22/111 - loss 0.67887612 - samples/sec: 27.93 - lr: 0.025000\r\n2021-01-25 13:44:59,280 epoch 120 - iter 33/111 - loss 0.61781476 - samples/sec: 26.25 - lr: 0.025000\r\n2021-01-25 13:45:05,912 epoch 120 - iter 44/111 - loss 0.60051820 - samples/sec: 26.55 - lr: 0.025000\r\n2021-01-25 13:45:12,975 epoch 120 - iter 55/111 - loss 0.64317197 - samples/sec: 24.93 - lr: 0.025000\r\n2021-01-25 13:45:19,825 epoch 120 - iter 66/111 - loss 0.62872899 - samples/sec: 25.71 - lr: 0.025000\r\n2021-01-25 13:45:27,856 epoch 120 - iter 77/111 - loss 0.65401933 - samples/sec: 21.92 - lr: 0.025000\r\n2021-01-25 13:45:33,315 epoch 120 - iter 88/111 - loss 0.66591052 - samples/sec: 32.25 - lr: 0.025000\r\n2021-01-25 13:45:39,091 epoch 120 - iter 99/111 - loss 0.66697941 - samples/sec: 30.49 - lr: 0.025000\r\n2021-01-25 13:45:45,006 epoch 120 - iter 110/111 - loss 0.66261771 - samples/sec: 29.77 - lr: 0.025000\r\n2021-01-25 13:45:45,075 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:45:45,076 EPOCH 120 done: loss 0.6758 - lr 0.0250000\r\n2021-01-25 13:45:45,078 BAD EPOCHS (no improvement): 2\r\n2021-01-25 13:46:19,536 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:46:25,596 epoch 121 - iter 11/111 - loss 0.58798959 - samples/sec: 29.17 - lr: 0.025000\r\n2021-01-25 13:46:31,806 epoch 121 - iter 22/111 - loss 0.61343662 - samples/sec: 28.35 - lr: 0.025000\r\n2021-01-25 13:46:38,477 epoch 121 - iter 33/111 - loss 0.60312356 - samples/sec: 26.39 - lr: 0.025000\r\n2021-01-25 13:46:45,808 epoch 121 - iter 44/111 - loss 0.61619065 - samples/sec: 24.01 - lr: 0.025000\r\n2021-01-25 13:46:53,028 epoch 121 - iter 55/111 - loss 0.60864824 - samples/sec: 24.38 - lr: 0.025000\r\n2021-01-25 13:46:59,614 epoch 121 - iter 66/111 - loss 0.62845413 - samples/sec: 26.74 - lr: 0.025000\r\n2021-01-25 13:47:05,938 epoch 121 - iter 77/111 - loss 0.66102760 - samples/sec: 27.84 - lr: 0.025000\r\n2021-01-25 13:47:11,077 epoch 121 - iter 88/111 - loss 0.65753494 - samples/sec: 34.27 - lr: 0.025000\r\n2021-01-25 13:47:17,313 epoch 121 - iter 99/111 - loss 0.64182588 - samples/sec: 28.24 - lr: 0.025000\r\n2021-01-25 13:47:23,365 epoch 121 - iter 110/111 - loss 0.63073516 - samples/sec: 29.09 - lr: 0.025000\r\n2021-01-25 13:47:23,553 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:47:23,554 EPOCH 121 done: loss 0.6288 - lr 0.0250000\r\n2021-01-25 13:47:23,555 BAD EPOCHS (no improvement): 0\r\n2021-01-25 13:48:04,973 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:48:12,117 epoch 122 - iter 11/111 - loss 0.68116287 - samples/sec: 24.74 - lr: 0.025000\r\n2021-01-25 13:48:19,672 epoch 122 - iter 22/111 - loss 0.66497344 - samples/sec: 23.31 - lr: 0.025000\r\n2021-01-25 13:48:26,240 epoch 122 - iter 33/111 - loss 0.64456542 - samples/sec: 26.81 - lr: 0.025000\r\n2021-01-25 13:48:34,192 epoch 122 - iter 44/111 - loss 0.62877654 - samples/sec: 22.14 - lr: 0.025000\r\n2021-01-25 13:48:42,013 epoch 122 - iter 55/111 - loss 0.62691633 - samples/sec: 22.51 - lr: 0.025000\r\n2021-01-25 13:48:48,146 epoch 122 - iter 66/111 - loss 0.64545234 - samples/sec: 28.71 - lr: 0.025000\r\n2021-01-25 13:48:54,541 epoch 122 - iter 77/111 - loss 0.65103555 - samples/sec: 27.53 - lr: 0.025000\r\n2021-01-25 13:48:59,939 epoch 122 - iter 88/111 - loss 0.64988670 - samples/sec: 32.62 - lr: 0.025000\r\n2021-01-25 13:49:05,337 epoch 122 - iter 99/111 - loss 0.64898939 - samples/sec: 32.62 - lr: 0.025000\r\n2021-01-25 13:49:11,099 epoch 122 - iter 110/111 - loss 0.64195849 - samples/sec: 30.56 - lr: 0.025000\r\n2021-01-25 13:49:11,231 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:49:11,232 EPOCH 122 done: loss 0.6368 - lr 0.0250000\r\n2021-01-25 13:49:11,234 BAD EPOCHS (no improvement): 1\r\n2021-01-25 13:49:52,399 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:49:58,079 epoch 123 - iter 11/111 - loss 0.79830904 - samples/sec: 31.15 - lr: 0.025000\r\n2021-01-25 13:50:03,699 epoch 123 - iter 22/111 - loss 0.70631330 - samples/sec: 31.33 - lr: 0.025000\r\n2021-01-25 13:50:09,623 epoch 123 - iter 33/111 - loss 0.67264597 - samples/sec: 29.72 - lr: 0.025000\r\n2021-01-25 13:50:16,925 epoch 123 - iter 44/111 - loss 0.68767643 - samples/sec: 24.11 - lr: 0.025000\r\n2021-01-25 13:50:23,832 epoch 123 - iter 55/111 - loss 0.66567398 - samples/sec: 25.49 - lr: 0.025000\r\n2021-01-25 13:50:31,098 epoch 123 - iter 66/111 - loss 0.64204170 - samples/sec: 24.23 - lr: 0.025000\r\n2021-01-25 13:50:38,815 epoch 123 - iter 77/111 - loss 0.62967690 - samples/sec: 22.82 - lr: 0.025000\r\n2021-01-25 13:50:45,005 epoch 123 - iter 88/111 - loss 0.61772293 - samples/sec: 28.45 - lr: 0.025000\r\n2021-01-25 13:50:51,261 epoch 123 - iter 99/111 - loss 0.61946298 - samples/sec: 28.14 - lr: 0.025000\r\n2021-01-25 13:50:57,816 epoch 123 - iter 110/111 - loss 0.64053811 - samples/sec: 26.86 - lr: 0.025000\r\n2021-01-25 13:50:57,909 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:50:57,911 EPOCH 123 done: loss 0.6438 - lr 0.0250000\r\n2021-01-25 13:50:57,912 BAD EPOCHS (no improvement): 2\r\n2021-01-25 13:51:36,641 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:51:42,635 epoch 124 - iter 11/111 - loss 0.61700277 - samples/sec: 29.52 - lr: 0.025000\r\n2021-01-25 13:51:48,377 epoch 124 - iter 22/111 - loss 0.58532127 - samples/sec: 30.66 - lr: 0.025000\r\n2021-01-25 13:51:55,249 epoch 124 - iter 33/111 - loss 0.60009717 - samples/sec: 25.62 - lr: 0.025000\r\n2021-01-25 13:52:03,238 epoch 124 - iter 44/111 - loss 0.57114009 - samples/sec: 22.04 - lr: 0.025000\r\n2021-01-25 13:52:10,291 epoch 124 - iter 55/111 - loss 0.57621487 - samples/sec: 24.96 - lr: 0.025000\r\n2021-01-25 13:52:17,507 epoch 124 - iter 66/111 - loss 0.56355515 - samples/sec: 24.39 - lr: 0.025000\r\n2021-01-25 13:52:24,007 epoch 124 - iter 77/111 - loss 0.57433285 - samples/sec: 27.09 - lr: 0.025000\r\n2021-01-25 13:52:30,051 epoch 124 - iter 88/111 - loss 0.58146794 - samples/sec: 29.13 - lr: 0.025000\r\n2021-01-25 13:52:35,681 epoch 124 - iter 99/111 - loss 0.59278749 - samples/sec: 31.27 - lr: 0.025000\r\n2021-01-25 13:52:41,883 epoch 124 - iter 110/111 - loss 0.59244975 - samples/sec: 28.39 - lr: 0.025000\r\n2021-01-25 13:52:42,057 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:52:42,059 EPOCH 124 done: loss 0.5905 - lr 0.0250000\r\n2021-01-25 13:52:42,061 BAD EPOCHS (no improvement): 0\r\n2021-01-25 13:53:16,947 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:53:22,941 epoch 125 - iter 11/111 - loss 0.65947149 - samples/sec: 29.50 - lr: 0.025000\r\n2021-01-25 13:53:29,163 epoch 125 - iter 22/111 - loss 0.59695565 - samples/sec: 28.30 - lr: 0.025000\r\n2021-01-25 13:53:36,192 epoch 125 - iter 33/111 - loss 0.56540620 - samples/sec: 25.05 - lr: 0.025000\r\n2021-01-25 13:53:42,347 epoch 125 - iter 44/111 - loss 0.57762860 - samples/sec: 28.61 - lr: 0.025000\r\n2021-01-25 13:53:50,621 epoch 125 - iter 55/111 - loss 0.57077052 - samples/sec: 21.27 - lr: 0.025000\r\n2021-01-25 13:53:56,935 epoch 125 - iter 66/111 - loss 0.57226110 - samples/sec: 27.89 - lr: 0.025000\r\n2021-01-25 13:54:03,903 epoch 125 - iter 77/111 - loss 0.57960982 - samples/sec: 25.27 - lr: 0.025000\r\n2021-01-25 13:54:10,143 epoch 125 - iter 88/111 - loss 0.57841610 - samples/sec: 28.21 - lr: 0.025000\r\n2021-01-25 13:54:15,426 epoch 125 - iter 99/111 - loss 0.57296153 - samples/sec: 33.33 - lr: 0.025000\r\n2021-01-25 13:54:20,822 epoch 125 - iter 110/111 - loss 0.56136767 - samples/sec: 32.63 - lr: 0.025000\r\n2021-01-25 13:54:20,940 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:54:20,941 EPOCH 125 done: loss 0.5869 - lr 0.0250000\r\n2021-01-25 13:54:20,943 BAD EPOCHS (no improvement): 0\r\n2021-01-25 13:54:58,751 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:55:05,450 epoch 126 - iter 11/111 - loss 0.52473863 - samples/sec: 26.39 - lr: 0.025000\r\n2021-01-25 13:55:12,206 epoch 126 - iter 22/111 - loss 0.48462694 - samples/sec: 26.06 - lr: 0.025000\r\n2021-01-25 13:55:18,806 epoch 126 - iter 33/111 - loss 0.54067218 - samples/sec: 26.67 - lr: 0.025000\r\n2021-01-25 13:55:26,222 epoch 126 - iter 44/111 - loss 0.59235639 - samples/sec: 23.74 - lr: 0.025000\r\n2021-01-25 13:55:33,642 epoch 126 - iter 55/111 - loss 0.60935410 - samples/sec: 23.73 - lr: 0.025000\r\n2021-01-25 13:55:39,428 epoch 126 - iter 66/111 - loss 0.60552484 - samples/sec: 30.43 - lr: 0.025000\r\n2021-01-25 13:55:46,221 epoch 126 - iter 77/111 - loss 0.64459800 - samples/sec: 25.92 - lr: 0.025000\r\n2021-01-25 13:55:52,370 epoch 126 - iter 88/111 - loss 0.63451168 - samples/sec: 28.63 - lr: 0.025000\r\n2021-01-25 13:55:58,621 epoch 126 - iter 99/111 - loss 0.64048163 - samples/sec: 28.16 - lr: 0.025000\r\n2021-01-25 13:56:04,441 epoch 126 - iter 110/111 - loss 0.65040921 - samples/sec: 30.25 - lr: 0.025000\r\n2021-01-25 13:56:04,580 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:56:04,581 EPOCH 126 done: loss 0.6447 - lr 0.0250000\r\n2021-01-25 13:56:04,585 BAD EPOCHS (no improvement): 1\r\n2021-01-25 13:56:44,261 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:56:50,195 epoch 127 - iter 11/111 - loss 0.74406024 - samples/sec: 29.81 - lr: 0.025000\r\n2021-01-25 13:56:56,375 epoch 127 - iter 22/111 - loss 0.70273987 - samples/sec: 28.49 - lr: 0.025000\r\n2021-01-25 13:57:03,179 epoch 127 - iter 33/111 - loss 0.64999823 - samples/sec: 25.88 - lr: 0.025000\r\n2021-01-25 13:57:10,717 epoch 127 - iter 44/111 - loss 0.63081680 - samples/sec: 23.35 - lr: 0.025000\r\n2021-01-25 13:57:17,354 epoch 127 - iter 55/111 - loss 0.62215556 - samples/sec: 26.53 - lr: 0.025000\r\n2021-01-25 13:57:23,594 epoch 127 - iter 66/111 - loss 0.61392723 - samples/sec: 28.22 - lr: 0.025000\r\n2021-01-25 13:57:32,861 epoch 127 - iter 77/111 - loss 0.62140490 - samples/sec: 19.00 - lr: 0.025000\r\n2021-01-25 13:57:39,075 epoch 127 - iter 88/111 - loss 0.63513454 - samples/sec: 28.33 - lr: 0.025000\r\n2021-01-25 13:57:44,465 epoch 127 - iter 99/111 - loss 0.62767774 - samples/sec: 32.67 - lr: 0.025000\r\n2021-01-25 13:57:50,622 epoch 127 - iter 110/111 - loss 0.62037031 - samples/sec: 28.59 - lr: 0.025000\r\n2021-01-25 13:57:50,701 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:57:50,702 EPOCH 127 done: loss 0.6150 - lr 0.0250000\r\n2021-01-25 13:57:50,704 BAD EPOCHS (no improvement): 2\r\n2021-01-25 13:58:24,596 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 13:58:30,635 epoch 128 - iter 11/111 - loss 0.74410861 - samples/sec: 29.28 - lr: 0.025000\r\n2021-01-25 13:58:37,607 epoch 128 - iter 22/111 - loss 0.65902320 - samples/sec: 25.25 - lr: 0.025000\r\n2021-01-25 13:58:44,143 epoch 128 - iter 33/111 - loss 0.58010160 - samples/sec: 26.94 - lr: 0.025000\r\n2021-01-25 13:58:51,939 epoch 128 - iter 44/111 - loss 0.61621079 - samples/sec: 22.58 - lr: 0.025000\r\n2021-01-25 13:58:58,679 epoch 128 - iter 55/111 - loss 0.61133996 - samples/sec: 26.12 - lr: 0.025000\r\n2021-01-25 13:59:05,882 epoch 128 - iter 66/111 - loss 0.62836178 - samples/sec: 24.44 - lr: 0.025000\r\n2021-01-25 13:59:11,684 epoch 128 - iter 77/111 - loss 0.60741993 - samples/sec: 30.35 - lr: 0.025000\r\n2021-01-25 13:59:19,197 epoch 128 - iter 88/111 - loss 0.61006476 - samples/sec: 23.44 - lr: 0.025000\r\n2021-01-25 13:59:24,615 epoch 128 - iter 99/111 - loss 0.59143774 - samples/sec: 32.50 - lr: 0.025000\r\n2021-01-25 13:59:30,420 epoch 128 - iter 110/111 - loss 0.59331026 - samples/sec: 30.33 - lr: 0.025000\r\n2021-01-25 13:59:30,504 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 13:59:30,505 EPOCH 128 done: loss 0.5880 - lr 0.0250000\r\n2021-01-25 13:59:30,506 BAD EPOCHS (no improvement): 3\r\n2021-01-25 14:00:04,279 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 14:00:10,829 epoch 129 - iter 11/111 - loss 0.68741938 - samples/sec: 26.99 - lr: 0.025000\r\n2021-01-25 14:00:17,480 epoch 129 - iter 22/111 - loss 0.63012544 - samples/sec: 26.47 - lr: 0.025000\r\n2021-01-25 14:00:24,022 epoch 129 - iter 33/111 - loss 0.58932896 - samples/sec: 26.91 - lr: 0.025000\r\n2021-01-25 14:00:30,731 epoch 129 - iter 44/111 - loss 0.56153652 - samples/sec: 26.24 - lr: 0.025000\r\n2021-01-25 14:00:37,726 epoch 129 - iter 55/111 - loss 0.58815567 - samples/sec: 25.18 - lr: 0.025000\r\n2021-01-25 14:00:44,698 epoch 129 - iter 66/111 - loss 0.57535938 - samples/sec: 25.26 - lr: 0.025000\r\n2021-01-25 14:00:51,295 epoch 129 - iter 77/111 - loss 0.58570516 - samples/sec: 26.69 - lr: 0.025000\r\n2021-01-25 14:00:57,578 epoch 129 - iter 88/111 - loss 0.56886957 - samples/sec: 28.02 - lr: 0.025000\r\n2021-01-25 14:01:03,354 epoch 129 - iter 99/111 - loss 0.58495755 - samples/sec: 30.48 - lr: 0.025000\r\n2021-01-25 14:01:09,593 epoch 129 - iter 110/111 - loss 0.60014742 - samples/sec: 28.22 - lr: 0.025000\r\n2021-01-25 14:01:09,677 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 14:01:09,678 EPOCH 129 done: loss 0.5950 - lr 0.0250000\r\nEpoch   129: reducing learning rate of group 0 to 1.2500e-02.\r\n2021-01-25 14:01:09,680 BAD EPOCHS (no improvement): 4\r\n2021-01-25 14:01:47,313 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 14:01:54,386 epoch 130 - iter 11/111 - loss 0.61598990 - samples/sec: 25.00 - lr: 0.012500\r\n2021-01-25 14:02:01,784 epoch 130 - iter 22/111 - loss 0.60945936 - samples/sec: 23.80 - lr: 0.012500\r\n2021-01-25 14:02:09,131 epoch 130 - iter 33/111 - loss 0.66073855 - samples/sec: 23.96 - lr: 0.012500\r\n2021-01-25 14:02:15,756 epoch 130 - iter 44/111 - loss 0.60138401 - samples/sec: 26.58 - lr: 0.012500\r\n2021-01-25 14:02:21,795 epoch 130 - iter 55/111 - loss 0.58092661 - samples/sec: 29.16 - lr: 0.012500\r\n2021-01-25 14:02:28,127 epoch 130 - iter 66/111 - loss 0.57135477 - samples/sec: 27.81 - lr: 0.012500\r\n2021-01-25 14:02:33,990 epoch 130 - iter 77/111 - loss 0.55182214 - samples/sec: 30.03 - lr: 0.012500\r\n2021-01-25 14:02:40,759 epoch 130 - iter 88/111 - loss 0.56060971 - samples/sec: 26.01 - lr: 0.012500\r\n2021-01-25 14:02:46,636 epoch 130 - iter 99/111 - loss 0.55722380 - samples/sec: 29.96 - lr: 0.012500\r\n2021-01-25 14:02:52,345 epoch 130 - iter 110/111 - loss 0.54765077 - samples/sec: 30.85 - lr: 0.012500\r\n2021-01-25 14:02:52,438 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 14:02:52,439 EPOCH 130 done: loss 0.5436 - lr 0.0125000\r\n2021-01-25 14:02:52,440 BAD EPOCHS (no improvement): 0\r\n2021-01-25 14:03:32,025 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 14:03:38,321 epoch 131 - iter 11/111 - loss 0.58030411 - samples/sec: 28.09 - lr: 0.012500\r\n2021-01-25 14:03:43,970 epoch 131 - iter 22/111 - loss 0.51831507 - samples/sec: 31.17 - lr: 0.012500\r\n2021-01-25 14:03:50,744 epoch 131 - iter 33/111 - loss 0.54572397 - samples/sec: 25.99 - lr: 0.012500\r\n2021-01-25 14:03:57,517 epoch 131 - iter 44/111 - loss 0.53979178 - samples/sec: 26.00 - lr: 0.012500\r\n2021-01-25 14:04:03,978 epoch 131 - iter 55/111 - loss 0.55793165 - samples/sec: 27.25 - lr: 0.012500\r\n2021-01-25 14:04:10,621 epoch 131 - iter 66/111 - loss 0.54352260 - samples/sec: 26.51 - lr: 0.012500\r\n2021-01-25 14:04:17,454 epoch 131 - iter 77/111 - loss 0.56269143 - samples/sec: 25.77 - lr: 0.012500\r\n2021-01-25 14:04:24,515 epoch 131 - iter 88/111 - loss 0.57292043 - samples/sec: 24.93 - lr: 0.012500\r\n2021-01-25 14:04:30,847 epoch 131 - iter 99/111 - loss 0.57006812 - samples/sec: 27.80 - lr: 0.012500\r\n2021-01-25 14:04:35,734 epoch 131 - iter 110/111 - loss 0.57321482 - samples/sec: 36.03 - lr: 0.012500\r\n2021-01-25 14:04:35,773 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 14:04:35,775 EPOCH 131 done: loss 0.5681 - lr 0.0125000\r\n2021-01-25 14:04:35,776 BAD EPOCHS (no improvement): 1\r\n2021-01-25 14:05:07,147 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 14:05:13,620 epoch 132 - iter 11/111 - loss 0.52959698 - samples/sec: 27.31 - lr: 0.012500\r\n2021-01-25 14:05:23,530 epoch 132 - iter 22/111 - loss 0.52519627 - samples/sec: 27.80 - lr: 0.012500\r\n2021-01-25 14:05:29,950 epoch 132 - iter 33/111 - loss 0.56608403 - samples/sec: 27.42 - lr: 0.012500\r\n2021-01-25 14:05:37,127 epoch 132 - iter 44/111 - loss 0.55661541 - samples/sec: 24.53 - lr: 0.012500\r\n2021-01-25 14:05:43,521 epoch 132 - iter 55/111 - loss 0.55378752 - samples/sec: 27.54 - lr: 0.012500\r\n2021-01-25 14:05:50,414 epoch 132 - iter 66/111 - loss 0.56385819 - samples/sec: 25.54 - lr: 0.012500\r\n2021-01-25 14:05:56,963 epoch 132 - iter 77/111 - loss 0.54243020 - samples/sec: 26.88 - lr: 0.012500\r\n2021-01-25 14:06:03,652 epoch 132 - iter 88/111 - loss 0.54372444 - samples/sec: 26.32 - lr: 0.012500\r\n2021-01-25 14:06:09,441 epoch 132 - iter 99/111 - loss 0.53199278 - samples/sec: 30.42 - lr: 0.012500\r\n2021-01-25 14:06:14,701 epoch 132 - iter 110/111 - loss 0.54690942 - samples/sec: 33.47 - lr: 0.012500\r\n2021-01-25 14:06:14,871 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 14:06:14,872 EPOCH 132 done: loss 0.5420 - lr 0.0125000\r\n2021-01-25 14:06:14,874 BAD EPOCHS (no improvement): 0\r\n2021-01-25 14:06:52,420 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 14:06:58,524 epoch 133 - iter 11/111 - loss 0.41649119 - samples/sec: 28.98 - lr: 0.012500\r\n2021-01-25 14:07:03,658 epoch 133 - iter 22/111 - loss 0.36768959 - samples/sec: 34.29 - lr: 0.012500\r\n2021-01-25 14:07:10,207 epoch 133 - iter 33/111 - loss 0.41266027 - samples/sec: 26.89 - lr: 0.012500\r\n2021-01-25 14:07:17,234 epoch 133 - iter 44/111 - loss 0.46493986 - samples/sec: 25.06 - lr: 0.012500\r\n2021-01-25 14:07:23,290 epoch 133 - iter 55/111 - loss 0.45325970 - samples/sec: 29.07 - lr: 0.012500\r\n2021-01-25 14:07:30,116 epoch 133 - iter 66/111 - loss 0.44811419 - samples/sec: 25.80 - lr: 0.012500\r\n2021-01-25 14:07:37,658 epoch 133 - iter 77/111 - loss 0.46157333 - samples/sec: 23.34 - lr: 0.012500\r\n2021-01-25 14:07:44,375 epoch 133 - iter 88/111 - loss 0.48096643 - samples/sec: 26.21 - lr: 0.012500\r\n2021-01-25 14:07:50,176 epoch 133 - iter 99/111 - loss 0.50702132 - samples/sec: 30.36 - lr: 0.012500\r\n2021-01-25 14:07:56,225 epoch 133 - iter 110/111 - loss 0.51824152 - samples/sec: 29.11 - lr: 0.012500\r\n2021-01-25 14:07:56,593 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 14:07:56,594 EPOCH 133 done: loss 0.5196 - lr 0.0125000\r\n2021-01-25 14:07:56,596 BAD EPOCHS (no improvement): 0\r\n2021-01-25 14:08:29,342 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 14:08:43,869 epoch 134 - iter 11/111 - loss 0.65717183 - samples/sec: 25.65 - lr: 0.012500\r\n2021-01-25 14:08:51,248 epoch 134 - iter 22/111 - loss 0.60834041 - samples/sec: 23.86 - lr: 0.012500\r\n2021-01-25 14:08:58,468 epoch 134 - iter 33/111 - loss 0.58977554 - samples/sec: 24.38 - lr: 0.012500\r\n2021-01-25 14:09:05,137 epoch 134 - iter 44/111 - loss 0.57483234 - samples/sec: 26.40 - lr: 0.012500\r\n2021-01-25 14:09:11,076 epoch 134 - iter 55/111 - loss 0.56873697 - samples/sec: 29.65 - lr: 0.012500\r\n2021-01-25 14:09:17,105 epoch 134 - iter 66/111 - loss 0.56888056 - samples/sec: 29.20 - lr: 0.012500\r\n2021-01-25 14:09:24,095 epoch 134 - iter 77/111 - loss 0.56223808 - samples/sec: 25.19 - lr: 0.012500\r\n2021-01-25 14:09:29,513 epoch 134 - iter 88/111 - loss 0.56037086 - samples/sec: 32.50 - lr: 0.012500\r\n2021-01-25 14:09:35,191 epoch 134 - iter 99/111 - loss 0.54957375 - samples/sec: 31.00 - lr: 0.012500\r\n2021-01-25 14:09:40,748 epoch 134 - iter 110/111 - loss 0.53262838 - samples/sec: 31.69 - lr: 0.012500\r\n2021-01-25 14:09:40,818 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 14:09:40,819 EPOCH 134 done: loss 0.5278 - lr 0.0125000\r\n2021-01-25 14:09:40,821 BAD EPOCHS (no improvement): 1\r\n2021-01-25 14:10:13,027 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 14:10:18,960 epoch 135 - iter 11/111 - loss 0.52025008 - samples/sec: 29.80 - lr: 0.012500\r\n2021-01-25 14:10:25,200 epoch 135 - iter 22/111 - loss 0.51201549 - samples/sec: 28.22 - lr: 0.012500\r\n2021-01-25 14:10:33,758 epoch 135 - iter 33/111 - loss 0.59095611 - samples/sec: 20.57 - lr: 0.012500\r\n2021-01-25 14:10:39,941 epoch 135 - iter 44/111 - loss 0.58347231 - samples/sec: 28.47 - lr: 0.012500\r\n2021-01-25 14:10:46,349 epoch 135 - iter 55/111 - loss 0.56487238 - samples/sec: 27.48 - lr: 0.012500\r\n2021-01-25 14:10:53,963 epoch 135 - iter 66/111 - loss 0.56565157 - samples/sec: 23.12 - lr: 0.012500\r\n2021-01-25 14:10:59,436 epoch 135 - iter 77/111 - loss 0.53918576 - samples/sec: 32.19 - lr: 0.012500\r\n2021-01-25 14:11:05,605 epoch 135 - iter 88/111 - loss 0.52049351 - samples/sec: 28.54 - lr: 0.012500\r\n2021-01-25 14:11:11,015 epoch 135 - iter 99/111 - loss 0.52037110 - samples/sec: 32.55 - lr: 0.012500\r\n2021-01-25 14:11:17,537 epoch 135 - iter 110/111 - loss 0.52271956 - samples/sec: 26.99 - lr: 0.012500\r\n2021-01-25 14:11:17,598 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 14:11:17,599 EPOCH 135 done: loss 0.5181 - lr 0.0125000\r\n2021-01-25 14:11:17,600 BAD EPOCHS (no improvement): 0\r\n2021-01-25 14:11:50,172 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 14:12:04,076 epoch 136 - iter 11/111 - loss 0.66750966 - samples/sec: 32.77 - lr: 0.012500\r\n2021-01-25 14:12:10,989 epoch 136 - iter 22/111 - loss 0.54117237 - samples/sec: 25.47 - lr: 0.012500\r\n2021-01-25 14:12:18,161 epoch 136 - iter 33/111 - loss 0.54503648 - samples/sec: 24.55 - lr: 0.012500\r\n2021-01-25 14:12:25,343 epoch 136 - iter 44/111 - loss 0.57029280 - samples/sec: 24.51 - lr: 0.012500\r\n2021-01-25 14:12:32,349 epoch 136 - iter 55/111 - loss 0.56302477 - samples/sec: 25.13 - lr: 0.012500\r\n2021-01-25 14:12:38,208 epoch 136 - iter 66/111 - loss 0.54437011 - samples/sec: 30.05 - lr: 0.012500\r\n2021-01-25 14:12:43,622 epoch 136 - iter 77/111 - loss 0.54132690 - samples/sec: 32.52 - lr: 0.012500\r\n2021-01-25 14:12:49,534 epoch 136 - iter 88/111 - loss 0.52009410 - samples/sec: 29.78 - lr: 0.012500\r\n2021-01-25 14:12:55,743 epoch 136 - iter 99/111 - loss 0.53997797 - samples/sec: 28.35 - lr: 0.012500\r\n2021-01-25 14:13:02,156 epoch 136 - iter 110/111 - loss 0.53740052 - samples/sec: 27.46 - lr: 0.012500\r\n2021-01-25 14:13:02,241 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 14:13:02,242 EPOCH 136 done: loss 0.5460 - lr 0.0125000\r\n2021-01-25 14:13:02,245 BAD EPOCHS (no improvement): 1\r\n2021-01-25 14:13:34,693 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 14:13:40,827 epoch 137 - iter 11/111 - loss 0.37447661 - samples/sec: 28.85 - lr: 0.012500\r\n2021-01-25 14:13:46,540 epoch 137 - iter 22/111 - loss 0.42255757 - samples/sec: 30.82 - lr: 0.012500\r\n2021-01-25 14:13:54,109 epoch 137 - iter 33/111 - loss 0.45560228 - samples/sec: 23.26 - lr: 0.012500\r\n2021-01-25 14:14:00,586 epoch 137 - iter 44/111 - loss 0.48572128 - samples/sec: 27.19 - lr: 0.012500\r\n2021-01-25 14:14:07,013 epoch 137 - iter 55/111 - loss 0.47533147 - samples/sec: 27.39 - lr: 0.012500\r\n2021-01-25 14:14:14,350 epoch 137 - iter 66/111 - loss 0.47087201 - samples/sec: 24.00 - lr: 0.012500\r\n2021-01-25 14:14:20,235 epoch 137 - iter 77/111 - loss 0.45870045 - samples/sec: 29.92 - lr: 0.012500\r\n2021-01-25 14:14:25,672 epoch 137 - iter 88/111 - loss 0.46313509 - samples/sec: 32.38 - lr: 0.012500\r\n2021-01-25 14:14:30,981 epoch 137 - iter 99/111 - loss 0.46418444 - samples/sec: 33.17 - lr: 0.012500\r\n2021-01-25 14:14:37,905 epoch 137 - iter 110/111 - loss 0.47312191 - samples/sec: 25.43 - lr: 0.012500\r\n2021-01-25 14:14:37,978 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 14:14:37,979 EPOCH 137 done: loss 0.5212 - lr 0.0125000\r\n2021-01-25 14:14:37,983 BAD EPOCHS (no improvement): 2\r\n2021-01-25 14:15:13,919 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 14:15:20,401 epoch 138 - iter 11/111 - loss 0.43607438 - samples/sec: 27.27 - lr: 0.012500\r\n2021-01-25 14:15:27,386 epoch 138 - iter 22/111 - loss 0.46002454 - samples/sec: 25.20 - lr: 0.012500\r\n2021-01-25 14:15:33,899 epoch 138 - iter 33/111 - loss 0.47450392 - samples/sec: 27.04 - lr: 0.012500\r\n2021-01-25 14:15:39,476 epoch 138 - iter 44/111 - loss 0.47389216 - samples/sec: 31.57 - lr: 0.012500\r\n2021-01-25 14:15:46,603 epoch 138 - iter 55/111 - loss 0.48025244 - samples/sec: 24.70 - lr: 0.012500\r\n2021-01-25 14:15:53,126 epoch 138 - iter 66/111 - loss 0.49115474 - samples/sec: 26.99 - lr: 0.012500\r\n2021-01-25 14:15:59,341 epoch 138 - iter 77/111 - loss 0.48860549 - samples/sec: 28.33 - lr: 0.012500\r\n2021-01-25 14:16:06,048 epoch 138 - iter 88/111 - loss 0.47971093 - samples/sec: 26.25 - lr: 0.012500\r\n2021-01-25 14:16:12,109 epoch 138 - iter 99/111 - loss 0.48643696 - samples/sec: 29.05 - lr: 0.012500\r\n2021-01-25 14:16:17,743 epoch 138 - iter 110/111 - loss 0.47220482 - samples/sec: 31.25 - lr: 0.012500\r\n2021-01-25 14:16:17,863 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 14:16:17,864 EPOCH 138 done: loss 0.4876 - lr 0.0125000\r\n2021-01-25 14:16:17,866 BAD EPOCHS (no improvement): 0\r\n2021-01-25 14:16:52,414 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 14:16:59,025 epoch 139 - iter 11/111 - loss 0.61815261 - samples/sec: 26.74 - lr: 0.012500\r\n2021-01-25 14:17:05,476 epoch 139 - iter 22/111 - loss 0.52157193 - samples/sec: 27.29 - lr: 0.012500\r\n2021-01-25 14:17:13,097 epoch 139 - iter 33/111 - loss 0.49127991 - samples/sec: 23.10 - lr: 0.012500\r\n2021-01-25 14:17:19,534 epoch 139 - iter 44/111 - loss 0.46624925 - samples/sec: 27.35 - lr: 0.012500\r\n2021-01-25 14:17:26,998 epoch 139 - iter 55/111 - loss 0.49126850 - samples/sec: 23.59 - lr: 0.012500\r\n2021-01-25 14:17:33,481 epoch 139 - iter 66/111 - loss 0.48221333 - samples/sec: 27.16 - lr: 0.012500\r\n2021-01-25 14:17:39,027 epoch 139 - iter 77/111 - loss 0.47143079 - samples/sec: 31.75 - lr: 0.012500\r\n2021-01-25 14:17:44,787 epoch 139 - iter 88/111 - loss 0.47305081 - samples/sec: 30.57 - lr: 0.012500\r\n2021-01-25 14:17:50,873 epoch 139 - iter 99/111 - loss 0.47492835 - samples/sec: 28.93 - lr: 0.012500\r\n2021-01-25 14:17:57,450 epoch 139 - iter 110/111 - loss 0.47038335 - samples/sec: 26.77 - lr: 0.012500\r\n2021-01-25 14:17:57,494 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 14:17:57,495 EPOCH 139 done: loss 0.4661 - lr 0.0125000\r\n2021-01-25 14:17:57,496 BAD EPOCHS (no improvement): 0\r\n2021-01-25 14:18:36,547 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 14:18:42,183 epoch 140 - iter 11/111 - loss 0.49920697 - samples/sec: 31.39 - lr: 0.012500\r\n2021-01-25 14:18:48,213 epoch 140 - iter 22/111 - loss 0.48862989 - samples/sec: 29.21 - lr: 0.012500\r\n2021-01-25 14:18:54,178 epoch 140 - iter 33/111 - loss 0.47816874 - samples/sec: 29.52 - lr: 0.012500\r\n2021-01-25 14:19:00,450 epoch 140 - iter 44/111 - loss 0.48933345 - samples/sec: 28.07 - lr: 0.012500\r\n2021-01-25 14:19:07,439 epoch 140 - iter 55/111 - loss 0.46928300 - samples/sec: 25.19 - lr: 0.012500\r\n2021-01-25 14:19:14,968 epoch 140 - iter 66/111 - loss 0.46743580 - samples/sec: 23.38 - lr: 0.012500\r\n2021-01-25 14:19:21,703 epoch 140 - iter 77/111 - loss 0.45977263 - samples/sec: 26.14 - lr: 0.012500\r\n2021-01-25 14:19:28,542 epoch 140 - iter 88/111 - loss 0.48140774 - samples/sec: 25.74 - lr: 0.012500\r\n2021-01-25 14:19:34,363 epoch 140 - iter 99/111 - loss 0.48329782 - samples/sec: 30.25 - lr: 0.012500\r\n2021-01-25 14:19:40,471 epoch 140 - iter 110/111 - loss 0.48854832 - samples/sec: 28.82 - lr: 0.012500\r\n2021-01-25 14:19:40,782 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 14:19:40,785 EPOCH 140 done: loss 0.5155 - lr 0.0125000\r\n2021-01-25 14:19:40,787 BAD EPOCHS (no improvement): 1\r\n2021-01-25 14:20:21,281 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 14:20:27,334 epoch 141 - iter 11/111 - loss 0.32942802 - samples/sec: 29.22 - lr: 0.012500\r\n2021-01-25 14:20:33,841 epoch 141 - iter 22/111 - loss 0.47913609 - samples/sec: 27.06 - lr: 0.012500\r\n2021-01-25 14:20:39,626 epoch 141 - iter 33/111 - loss 0.45331875 - samples/sec: 30.44 - lr: 0.012500\r\n2021-01-25 14:20:47,392 epoch 141 - iter 44/111 - loss 0.45383054 - samples/sec: 22.67 - lr: 0.012500\r\n2021-01-25 14:20:55,220 epoch 141 - iter 55/111 - loss 0.45721795 - samples/sec: 22.49 - lr: 0.012500\r\n2021-01-25 14:21:01,595 epoch 141 - iter 66/111 - loss 0.45384956 - samples/sec: 27.62 - lr: 0.012500\r\n2021-01-25 14:21:07,235 epoch 141 - iter 77/111 - loss 0.45619697 - samples/sec: 31.23 - lr: 0.012500\r\n2021-01-25 14:21:13,916 epoch 141 - iter 88/111 - loss 0.44857190 - samples/sec: 26.35 - lr: 0.012500\r\n2021-01-25 14:21:19,498 epoch 141 - iter 99/111 - loss 0.44631384 - samples/sec: 31.55 - lr: 0.012500\r\n2021-01-25 14:21:25,719 epoch 141 - iter 110/111 - loss 0.45270197 - samples/sec: 28.30 - lr: 0.012500\r\n2021-01-25 14:21:25,793 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 14:21:25,793 EPOCH 141 done: loss 0.4489 - lr 0.0125000\r\n2021-01-25 14:21:25,797 BAD EPOCHS (no improvement): 0\r\n2021-01-25 14:22:06,509 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 14:22:13,231 epoch 142 - iter 11/111 - loss 0.48726898 - samples/sec: 26.29 - lr: 0.012500\r\n2021-01-25 14:22:20,153 epoch 142 - iter 22/111 - loss 0.45362488 - samples/sec: 25.44 - lr: 0.012500\r\n2021-01-25 14:22:26,263 epoch 142 - iter 33/111 - loss 0.43223831 - samples/sec: 28.82 - lr: 0.012500\r\n2021-01-25 14:22:32,394 epoch 142 - iter 44/111 - loss 0.43348582 - samples/sec: 28.72 - lr: 0.012500\r\n2021-01-25 14:22:39,635 epoch 142 - iter 55/111 - loss 0.44133732 - samples/sec: 24.32 - lr: 0.012500\r\n2021-01-25 14:22:45,553 epoch 142 - iter 66/111 - loss 0.43420036 - samples/sec: 29.75 - lr: 0.012500\r\n2021-01-25 14:22:51,459 epoch 142 - iter 77/111 - loss 0.44172321 - samples/sec: 29.82 - lr: 0.012500\r\n2021-01-25 14:22:57,839 epoch 142 - iter 88/111 - loss 0.45495511 - samples/sec: 27.59 - lr: 0.012500\r\n2021-01-25 14:23:03,819 epoch 142 - iter 99/111 - loss 0.45950819 - samples/sec: 29.45 - lr: 0.012500\r\n2021-01-25 14:23:09,719 epoch 142 - iter 110/111 - loss 0.46650118 - samples/sec: 29.84 - lr: 0.012500\r\n2021-01-25 14:23:09,772 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 14:23:09,773 EPOCH 142 done: loss 0.4623 - lr 0.0125000\r\n2021-01-25 14:23:09,775 BAD EPOCHS (no improvement): 1\r\n2021-01-25 14:23:42,605 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 14:23:49,031 epoch 143 - iter 11/111 - loss 0.67751005 - samples/sec: 27.51 - lr: 0.012500\r\n2021-01-25 14:23:56,376 epoch 143 - iter 22/111 - loss 0.57821348 - samples/sec: 23.97 - lr: 0.012500\r\n2021-01-25 14:24:03,123 epoch 143 - iter 33/111 - loss 0.54739928 - samples/sec: 26.10 - lr: 0.012500\r\n2021-01-25 14:24:11,522 epoch 143 - iter 44/111 - loss 0.54872937 - samples/sec: 20.96 - lr: 0.012500\r\n2021-01-25 14:24:18,275 epoch 143 - iter 55/111 - loss 0.53891355 - samples/sec: 26.07 - lr: 0.012500\r\n2021-01-25 14:24:24,157 epoch 143 - iter 66/111 - loss 0.53514081 - samples/sec: 29.93 - lr: 0.012500\r\n2021-01-25 14:24:30,660 epoch 143 - iter 77/111 - loss 0.52793349 - samples/sec: 27.07 - lr: 0.012500\r\n2021-01-25 14:24:36,312 epoch 143 - iter 88/111 - loss 0.52557640 - samples/sec: 31.15 - lr: 0.012500\r\n2021-01-25 14:24:41,967 epoch 143 - iter 99/111 - loss 0.51712182 - samples/sec: 31.14 - lr: 0.012500\r\n2021-01-25 14:24:47,226 epoch 143 - iter 110/111 - loss 0.51848814 - samples/sec: 33.48 - lr: 0.012500\r\n2021-01-25 14:24:47,367 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 14:24:47,369 EPOCH 143 done: loss 0.5345 - lr 0.0125000\r\n2021-01-25 14:24:47,371 BAD EPOCHS (no improvement): 2\r\n2021-01-25 14:25:22,340 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 14:25:29,490 epoch 144 - iter 11/111 - loss 0.47319051 - samples/sec: 24.71 - lr: 0.012500\r\n2021-01-25 14:25:36,148 epoch 144 - iter 22/111 - loss 0.45326246 - samples/sec: 26.44 - lr: 0.012500\r\n2021-01-25 14:25:42,148 epoch 144 - iter 33/111 - loss 0.43935597 - samples/sec: 29.35 - lr: 0.012500\r\n2021-01-25 14:25:48,678 epoch 144 - iter 44/111 - loss 0.43911252 - samples/sec: 26.96 - lr: 0.012500\r\n2021-01-25 14:25:55,785 epoch 144 - iter 55/111 - loss 0.44837216 - samples/sec: 24.77 - lr: 0.012500\r\n2021-01-25 14:26:01,543 epoch 144 - iter 66/111 - loss 0.43956897 - samples/sec: 30.58 - lr: 0.012500\r\n2021-01-25 14:26:09,242 epoch 144 - iter 77/111 - loss 0.43752335 - samples/sec: 22.87 - lr: 0.012500\r\n2021-01-25 14:26:15,273 epoch 144 - iter 88/111 - loss 0.43776414 - samples/sec: 29.19 - lr: 0.012500\r\n2021-01-25 14:26:20,794 epoch 144 - iter 99/111 - loss 0.43604807 - samples/sec: 31.89 - lr: 0.012500\r\n2021-01-25 14:26:26,684 epoch 144 - iter 110/111 - loss 0.43161893 - samples/sec: 29.90 - lr: 0.012500\r\n2021-01-25 14:26:26,740 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 14:26:26,741 EPOCH 144 done: loss 0.4277 - lr 0.0125000\r\n2021-01-25 14:26:26,742 BAD EPOCHS (no improvement): 0\r\n2021-01-25 14:27:01,129 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 14:27:06,899 epoch 145 - iter 11/111 - loss 0.56361101 - samples/sec: 30.66 - lr: 0.012500\r\n2021-01-25 14:27:13,056 epoch 145 - iter 22/111 - loss 0.44458997 - samples/sec: 28.60 - lr: 0.012500\r\n2021-01-25 14:27:20,346 epoch 145 - iter 33/111 - loss 0.43164483 - samples/sec: 24.15 - lr: 0.012500\r\n2021-01-25 14:27:25,946 epoch 145 - iter 44/111 - loss 0.43714195 - samples/sec: 31.44 - lr: 0.012500\r\n2021-01-25 14:27:34,254 epoch 145 - iter 55/111 - loss 0.47496543 - samples/sec: 21.20 - lr: 0.012500\r\n2021-01-25 14:27:40,520 epoch 145 - iter 66/111 - loss 0.47431087 - samples/sec: 28.10 - lr: 0.012500\r\n2021-01-25 14:27:46,534 epoch 145 - iter 77/111 - loss 0.48796104 - samples/sec: 29.28 - lr: 0.012500\r\n2021-01-25 14:27:52,801 epoch 145 - iter 88/111 - loss 0.49742483 - samples/sec: 28.10 - lr: 0.012500\r\n2021-01-25 14:27:59,150 epoch 145 - iter 99/111 - loss 0.50019007 - samples/sec: 27.73 - lr: 0.012500\r\n2021-01-25 14:28:04,370 epoch 145 - iter 110/111 - loss 0.49637410 - samples/sec: 33.73 - lr: 0.012500\r\n2021-01-25 14:28:04,460 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 14:28:04,461 EPOCH 145 done: loss 0.4920 - lr 0.0125000\r\n2021-01-25 14:28:04,463 BAD EPOCHS (no improvement): 1\r\n2021-01-25 14:28:37,119 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 14:28:51,531 epoch 146 - iter 11/111 - loss 0.42418791 - samples/sec: 30.98 - lr: 0.012500\r\n2021-01-25 14:29:00,308 epoch 146 - iter 22/111 - loss 0.44287015 - samples/sec: 20.06 - lr: 0.012500\r\n2021-01-25 14:29:07,156 epoch 146 - iter 33/111 - loss 0.50278946 - samples/sec: 25.71 - lr: 0.012500\r\n2021-01-25 14:29:13,724 epoch 146 - iter 44/111 - loss 0.49937403 - samples/sec: 26.81 - lr: 0.012500\r\n2021-01-25 14:29:20,000 epoch 146 - iter 55/111 - loss 0.48756165 - samples/sec: 28.06 - lr: 0.012500\r\n2021-01-25 14:29:26,176 epoch 146 - iter 66/111 - loss 0.47407933 - samples/sec: 28.51 - lr: 0.012500\r\n2021-01-25 14:29:33,043 epoch 146 - iter 77/111 - loss 0.46273601 - samples/sec: 25.64 - lr: 0.012500\r\n2021-01-25 14:29:38,855 epoch 146 - iter 88/111 - loss 0.47012461 - samples/sec: 30.30 - lr: 0.012500\r\n2021-01-25 14:29:44,808 epoch 146 - iter 99/111 - loss 0.48228383 - samples/sec: 29.58 - lr: 0.012500\r\n2021-01-25 14:29:50,187 epoch 146 - iter 110/111 - loss 0.47029969 - samples/sec: 32.73 - lr: 0.012500\r\n2021-01-25 14:29:50,225 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 14:29:50,226 EPOCH 146 done: loss 0.4669 - lr 0.0125000\r\n2021-01-25 14:29:50,227 BAD EPOCHS (no improvement): 2\r\n2021-01-25 14:30:31,156 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 14:30:36,366 epoch 147 - iter 11/111 - loss 0.29897853 - samples/sec: 33.97 - lr: 0.012500\r\n2021-01-25 14:30:41,882 epoch 147 - iter 22/111 - loss 0.37291605 - samples/sec: 31.92 - lr: 0.012500\r\n2021-01-25 14:30:47,949 epoch 147 - iter 33/111 - loss 0.35905749 - samples/sec: 29.02 - lr: 0.012500\r\n2021-01-25 14:30:54,526 epoch 147 - iter 44/111 - loss 0.37039853 - samples/sec: 26.77 - lr: 0.012500\r\n2021-01-25 14:31:02,453 epoch 147 - iter 55/111 - loss 0.37418085 - samples/sec: 22.21 - lr: 0.012500\r\n2021-01-25 14:31:09,132 epoch 147 - iter 66/111 - loss 0.39236568 - samples/sec: 26.36 - lr: 0.012500\r\n2021-01-25 14:31:15,738 epoch 147 - iter 77/111 - loss 0.40967605 - samples/sec: 26.65 - lr: 0.012500\r\n2021-01-25 14:31:21,562 epoch 147 - iter 88/111 - loss 0.41555977 - samples/sec: 30.24 - lr: 0.012500\r\n2021-01-25 14:31:28,806 epoch 147 - iter 99/111 - loss 0.42892227 - samples/sec: 24.30 - lr: 0.012500\r\n2021-01-25 14:31:34,250 epoch 147 - iter 110/111 - loss 0.42682377 - samples/sec: 32.34 - lr: 0.012500\r\n2021-01-25 14:31:34,333 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 14:31:34,334 EPOCH 147 done: loss 0.4269 - lr 0.0125000\r\n2021-01-25 14:31:34,335 BAD EPOCHS (no improvement): 0\r\n2021-01-25 14:32:07,364 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 14:32:13,605 epoch 148 - iter 11/111 - loss 0.42012477 - samples/sec: 28.33 - lr: 0.012500\r\n2021-01-25 14:32:19,685 epoch 148 - iter 22/111 - loss 0.44187371 - samples/sec: 28.96 - lr: 0.012500\r\n2021-01-25 14:32:26,969 epoch 148 - iter 33/111 - loss 0.48473765 - samples/sec: 24.17 - lr: 0.012500\r\n2021-01-25 14:32:33,967 epoch 148 - iter 44/111 - loss 0.47316840 - samples/sec: 25.16 - lr: 0.012500\r\n2021-01-25 14:32:40,122 epoch 148 - iter 55/111 - loss 0.46456896 - samples/sec: 28.61 - lr: 0.012500\r\n2021-01-25 14:32:46,083 epoch 148 - iter 66/111 - loss 0.47234904 - samples/sec: 29.54 - lr: 0.012500\r\n2021-01-25 14:32:52,715 epoch 148 - iter 77/111 - loss 0.45225264 - samples/sec: 26.55 - lr: 0.012500\r\n2021-01-25 14:32:58,221 epoch 148 - iter 88/111 - loss 0.48295151 - samples/sec: 31.98 - lr: 0.012500\r\n2021-01-25 14:33:04,084 epoch 148 - iter 99/111 - loss 0.47952042 - samples/sec: 30.03 - lr: 0.012500\r\n2021-01-25 14:33:10,748 epoch 148 - iter 110/111 - loss 0.47041383 - samples/sec: 26.42 - lr: 0.012500\r\n2021-01-25 14:33:10,901 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 14:33:10,903 EPOCH 148 done: loss 0.4663 - lr 0.0125000\r\n2021-01-25 14:33:10,904 BAD EPOCHS (no improvement): 1\r\n2021-01-25 14:33:44,573 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 14:33:50,574 epoch 149 - iter 11/111 - loss 0.51968422 - samples/sec: 29.46 - lr: 0.012500\r\n2021-01-25 14:33:56,376 epoch 149 - iter 22/111 - loss 0.43742885 - samples/sec: 30.34 - lr: 0.012500\r\n2021-01-25 14:34:03,080 epoch 149 - iter 33/111 - loss 0.43057959 - samples/sec: 26.26 - lr: 0.012500\r\n2021-01-25 14:34:10,752 epoch 149 - iter 44/111 - loss 0.45822329 - samples/sec: 22.95 - lr: 0.012500\r\n2021-01-25 14:34:17,588 epoch 149 - iter 55/111 - loss 0.48752644 - samples/sec: 25.76 - lr: 0.012500\r\n2021-01-25 14:34:24,161 epoch 149 - iter 66/111 - loss 0.47126709 - samples/sec: 26.78 - lr: 0.012500\r\n2021-01-25 14:34:30,687 epoch 149 - iter 77/111 - loss 0.46427167 - samples/sec: 26.98 - lr: 0.012500\r\n2021-01-25 14:34:36,284 epoch 149 - iter 88/111 - loss 0.45396782 - samples/sec: 31.46 - lr: 0.012500\r\n2021-01-25 14:34:41,459 epoch 149 - iter 99/111 - loss 0.47459639 - samples/sec: 34.03 - lr: 0.012500\r\n2021-01-25 14:34:47,399 epoch 149 - iter 110/111 - loss 0.47931223 - samples/sec: 29.64 - lr: 0.012500\r\n2021-01-25 14:34:47,512 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 14:34:47,513 EPOCH 149 done: loss 0.5217 - lr 0.0125000\r\n2021-01-25 14:34:47,514 BAD EPOCHS (no improvement): 2\r\n2021-01-25 14:35:18,217 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2021-01-25 14:35:33,221 epoch 150 - iter 11/111 - loss 0.39747888 - samples/sec: 27.58 - lr: 0.012500\r\n2021-01-25 14:35:40,131 epoch 150 - iter 22/111 - loss 0.45994203 - samples/sec: 25.48 - lr: 0.012500\r\n2021-01-25 14:35:47,471 epoch 150 - iter 33/111 - loss 0.46511313 - samples/sec: 23.99 - lr: 0.012500\r\n2021-01-25 14:35:54,065 epoch 150 - iter 44/111 - loss 0.45986518 - samples/sec: 26.70 - lr: 0.012500\r\n2021-01-25 14:36:00,407 epoch 150 - iter 55/111 - loss 0.46384560 - samples/sec: 27.76 - lr: 0.012500\r\n2021-01-25 14:36:07,167 epoch 150 - iter 66/111 - loss 0.45846419 - samples/sec: 26.05 - lr: 0.012500\r\n2021-01-25 14:36:12,460 epoch 150 - iter 77/111 - loss 0.45345524 - samples/sec: 33.27 - lr: 0.012500\r\n2021-01-25 14:36:19,618 epoch 150 - iter 88/111 - loss 0.45261149 - samples/sec: 24.59 - lr: 0.012500\r\n2021-01-25 14:36:25,185 epoch 150 - iter 99/111 - loss 0.43778608 - samples/sec: 31.63 - lr: 0.012500\r\n2021-01-25 14:36:30,687 epoch 150 - iter 110/111 - loss 0.43721506 - samples/sec: 32.00 - lr: 0.012500\r\n2021-01-25 14:36:30,870 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 14:36:30,871 EPOCH 150 done: loss 0.4436 - lr 0.0125000\r\n2021-01-25 14:36:30,873 BAD EPOCHS (no improvement): 3\r\n2021-01-25 14:39:04,799 ----------------------------------------------------------------------------------------------------\r\n2021-01-25 14:39:04,802 Testing using best model ...\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-5-67c87885734c> in <module>()\r\n     95               mini_batch_size=16,\r\n     96               max_epochs=150,\r\n---> 97               checkpoint=True)\r\n     98 \r\n\r\n12 frames\r\n/usr/local/lib/python3.6/dist-packages/transformers/modeling_bert.py in forward(self, input_ids, token_type_ids, position_ids, inputs_embeds)\r\n    199         token_type_embeddings = self.token_type_embeddings(token_type_ids)\r\n    200 \r\n--> 201         embeddings = inputs_embeds + position_embeddings + token_type_embeddings\r\n    202         embeddings = self.LayerNorm(embeddings)\r\n    203         embeddings = self.dropout(embeddings)\r\n\r\nRuntimeError: The size of tensor a (759) must match the size of tensor b (512) at non-singleton dimension 1\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2081/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2081/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2074", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2074/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2074/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2074/events", "html_url": "https://github.com/flairNLP/flair/issues/2074", "id": 786332498, "node_id": "MDU6SXNzdWU3ODYzMzI0OTg=", "number": 2074, "title": "Can i use flair to perform sentence pair regression with stack embedding ?", "user": {"login": "azizcu", "id": 63375421, "node_id": "MDQ6VXNlcjYzMzc1NDIx", "avatar_url": "https://avatars.githubusercontent.com/u/63375421?v=4", "gravatar_id": "", "url": "https://api.github.com/users/azizcu", "html_url": "https://github.com/azizcu", "followers_url": "https://api.github.com/users/azizcu/followers", "following_url": "https://api.github.com/users/azizcu/following{/other_user}", "gists_url": "https://api.github.com/users/azizcu/gists{/gist_id}", "starred_url": "https://api.github.com/users/azizcu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/azizcu/subscriptions", "organizations_url": "https://api.github.com/users/azizcu/orgs", "repos_url": "https://api.github.com/users/azizcu/repos", "events_url": "https://api.github.com/users/azizcu/events{/privacy}", "received_events_url": "https://api.github.com/users/azizcu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-01-14T20:51:37Z", "updated_at": "2021-05-23T17:33:58Z", "closed_at": "2021-05-23T17:33:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "when i want to do that i could not able to do that.\r\nIf it possible , please explain with a example.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2074/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2074/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2069", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2069/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2069/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2069/events", "html_url": "https://github.com/flairNLP/flair/issues/2069", "id": 784561611, "node_id": "MDU6SXNzdWU3ODQ1NjE2MTE=", "number": 2069, "title": "Keep newline in Sentence for sequence tagging prediction", "user": {"login": "geniki", "id": 13801078, "node_id": "MDQ6VXNlcjEzODAxMDc4", "avatar_url": "https://avatars.githubusercontent.com/u/13801078?v=4", "gravatar_id": "", "url": "https://api.github.com/users/geniki", "html_url": "https://github.com/geniki", "followers_url": "https://api.github.com/users/geniki/followers", "following_url": "https://api.github.com/users/geniki/following{/other_user}", "gists_url": "https://api.github.com/users/geniki/gists{/gist_id}", "starred_url": "https://api.github.com/users/geniki/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/geniki/subscriptions", "organizations_url": "https://api.github.com/users/geniki/orgs", "repos_url": "https://api.github.com/users/geniki/repos", "events_url": "https://api.github.com/users/geniki/events{/privacy}", "received_events_url": "https://api.github.com/users/geniki/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-01-12T20:15:56Z", "updated_at": "2021-01-17T18:28:11Z", "closed_at": "2021-01-13T09:56:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI'd like to keep the newline character `\\n` when doing sequence tagging prediction (keeping it during training seems easier because of the different code paths).\r\nhttps://github.com/flairNLP/flair/blob/master/flair/data.py#L605 This line removes the newline character after the text has been tokenised. Given that `flair` is very flexible in terms of tokenisation, I think this last-minute modification of tokens is unwelcome. If I wanted to have run `.strip()` on my tokens, I should have done it during tokenisation.\r\n\r\nI understand I can replace `\\n` with another unused character and then swap them back later but it'd be cleaner if we can avoid that.\r\n\r\n**To Reproduce**\r\n`Sentence([\"hello\", \"\\n\"])`, not using a tokeniser because the text is already tokenised. \r\n\r\n**Expected behavior**\r\nI expect two tokens but I get only one.\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Linux\r\n - Version: flair 0.7\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2069/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2069/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2066", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2066/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2066/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2066/events", "html_url": "https://github.com/flairNLP/flair/issues/2066", "id": 781821717, "node_id": "MDU6SXNzdWU3ODE4MjE3MTc=", "number": 2066, "title": "TransformerWordEmbeddings slower than legacy BertEmbeddings for Batches", "user": {"login": "tiagokv", "id": 1560621, "node_id": "MDQ6VXNlcjE1NjA2MjE=", "avatar_url": "https://avatars.githubusercontent.com/u/1560621?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tiagokv", "html_url": "https://github.com/tiagokv", "followers_url": "https://api.github.com/users/tiagokv/followers", "following_url": "https://api.github.com/users/tiagokv/following{/other_user}", "gists_url": "https://api.github.com/users/tiagokv/gists{/gist_id}", "starred_url": "https://api.github.com/users/tiagokv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tiagokv/subscriptions", "organizations_url": "https://api.github.com/users/tiagokv/orgs", "repos_url": "https://api.github.com/users/tiagokv/repos", "events_url": "https://api.github.com/users/tiagokv/events{/privacy}", "received_events_url": "https://api.github.com/users/tiagokv/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-01-08T03:52:04Z", "updated_at": "2021-05-15T22:42:15Z", "closed_at": "2021-05-15T22:42:14Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nTransformerWordEmbeddings slower than legacy BertEmbeddings for Batches. Comparing both implementations, the new class does not leverage batch processing and only process a sentence at a time, instead of doing by batches. \r\n\r\n**To Reproduce**\r\n\r\nA simple test comparing both like the one below does the trick:\r\n\r\n```python\r\nold_model = BertEmbeddings(\"bert-large-uncased-whole-word-masking\", \"-1,-2,-3,-4\")\r\nnew_model = TransformerWordEmbeddings(\"bert-large-uncased-whole-word-masking\", \"-1,-2,-3,-4\")\r\n\r\nsent_list = [Sentence(sent) for sent in dt[\"original sentence\"].to_list()[:32]]\r\nimport time\r\n\r\nstart = time.time()\r\nold_model.embed(sent_list)\r\nprint(time.time() - start)\r\n\r\nsent_list = [Sentence(sent) for sent in dt[\"original sentence\"].to_list()[:32]]\r\n\r\nstart = time.time()\r\nnew_model.embed(sent_list)\r\nprint(time.time() - start)\r\n```\r\n\r\n**Expected behavior**\r\nThe new class should provide at least the same performance.\r\n\r\n**Screenshots**\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Linux\r\n - Version [e.g. flair-0.3.2]: flair-0.7.0", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2066/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2066/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2064", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2064/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2064/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2064/events", "html_url": "https://github.com/flairNLP/flair/issues/2064", "id": 781227755, "node_id": "MDU6SXNzdWU3ODEyMjc3NTU=", "number": 2064, "title": "Serialization with a custom BPE Embedding model", "user": {"login": "elliotbart", "id": 26550846, "node_id": "MDQ6VXNlcjI2NTUwODQ2", "avatar_url": "https://avatars.githubusercontent.com/u/26550846?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elliotbart", "html_url": "https://github.com/elliotbart", "followers_url": "https://api.github.com/users/elliotbart/followers", "following_url": "https://api.github.com/users/elliotbart/following{/other_user}", "gists_url": "https://api.github.com/users/elliotbart/gists{/gist_id}", "starred_url": "https://api.github.com/users/elliotbart/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elliotbart/subscriptions", "organizations_url": "https://api.github.com/users/elliotbart/orgs", "repos_url": "https://api.github.com/users/elliotbart/repos", "events_url": "https://api.github.com/users/elliotbart/events{/privacy}", "received_events_url": "https://api.github.com/users/elliotbart/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2021-01-07T11:01:52Z", "updated_at": "2021-06-12T01:10:30Z", "closed_at": "2021-06-12T01:10:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n\r\nWhen loading `BytePairEmbeddings`, parameter `language` is set to `None`.\r\nThis raises errors in the serialization steps with `BPEmbSerializable`.\r\n\r\nhttps://github.com/flairNLP/flair/blob/master/flair/embeddings/token.py\r\n\r\n*[l. 1657](https://github.com/flairNLP/flair/blob/master/flair/embeddings/token.py#L1657)*\r\n\r\nAt `__setstate__`, `state[\"lang\"]` is `None` \r\n\r\n*[l. 1665 - l. 1671](https://github.com/flairNLP/flair/blob/master/flair/embeddings/token.py#L1665)*\r\n\r\nPaths cannot be built when writing the binary sentencepiece model.\r\n\r\nHere is the traceback when loading a sequence tagger with custom BPE Embeddings:\r\n\r\n```python\r\n>>> from flair.models.sequence_tagger_model import *\r\n>>> model = SequenceTagger.load('small_generic_v0_100000/best-model.pt')\r\n2021-01-04 14:30:06,386 loading file small_generic_v0_100000/best-model.pt\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"lib/python3.7/site-packages/flair/nn.py\", line 88, in load\r\n    state = torch.load(f, map_location='cpu')\r\n  File \"lib/python3.7/site-packages/torch/serialization.py\", line 594, in load\r\n    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)\r\n  File \"lib/python3.7/site-packages/torch/serialization.py\", line 853, in _load\r\n    result = unpickler.load()\r\n  File \"lib/python3.7/site-packages/flair/embeddings/token.py\", line 1523, in __setstate__\r\n    if not os.path.exists(self.cache_dir / state[\"lang\"]):\r\n  File \"lib/python3.7/pathlib.py\", line 925, in __truediv__\r\n    return self._make_child((key,))\r\n  File \"lib/python3.7/pathlib.py\", line 704, in _make_child\r\n    drv, root, parts = self._parse_args(args)\r\n  File \"lib/python3.7/pathlib.py\", line 658, in _parse_args\r\n    a = os.fspath(a)\r\nTypeError: expected str, bytes or os.PathLike object, not NoneType\r\n```\r\n\r\n**To Reproduce**\r\nLoad a SequenceTagger with a custom BytePairEmbeddings model.\r\n\r\n**Environment (please complete the following information):**\r\n - OS : CentOS Linux\r\n - Version : 0.7\r\n - Python version: 3.7.9\r\n - PyTorch version: 1.7.0 + Cuda 9.2\r\n - Using GPU in script?: True\r\n - Using distributed or parallel set-up in script?: No\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2064/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2064/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2049", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2049/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2049/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2049/events", "html_url": "https://github.com/flairNLP/flair/issues/2049", "id": 777240934, "node_id": "MDU6SXNzdWU3NzcyNDA5MzQ=", "number": 2049, "title": "Unpickling error: wrong torch version.", "user": {"login": "vedangj044", "id": 43697446, "node_id": "MDQ6VXNlcjQzNjk3NDQ2", "avatar_url": "https://avatars.githubusercontent.com/u/43697446?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vedangj044", "html_url": "https://github.com/vedangj044", "followers_url": "https://api.github.com/users/vedangj044/followers", "following_url": "https://api.github.com/users/vedangj044/following{/other_user}", "gists_url": "https://api.github.com/users/vedangj044/gists{/gist_id}", "starred_url": "https://api.github.com/users/vedangj044/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vedangj044/subscriptions", "organizations_url": "https://api.github.com/users/vedangj044/orgs", "repos_url": "https://api.github.com/users/vedangj044/repos", "events_url": "https://api.github.com/users/vedangj044/events{/privacy}", "received_events_url": "https://api.github.com/users/vedangj044/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-01-01T08:23:26Z", "updated_at": "2021-01-07T08:59:02Z", "closed_at": "2021-01-07T08:59:02Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nThe torch version described in requeirements.txt is 1.1.0, but I am facing the following error with torch version 1.3.0 while importing the `en-sentiment` model.\r\n\r\n`UnpicklingError: A load persistent id instruction was encountered,\r\nbut no persistent_load function was specified.`\r\n\r\n**To Reproduce**\r\n1. Force install torch==1.3.0\r\n2. Run `flair.models.TextClassifier.load(\"en-sentiment\")`\r\n\r\n**Expected behavior**\r\nThe model should be loaded.\r\n\r\n**Screenshots**\r\nPlease have a look at the following google colab notebook, which contains the traceback and also the fix for this issue.\r\n[Link](https://colab.research.google.com/drive/1LIxvkBnYAwP62f6kiNyErBTXJCm7PHEn?usp=sharing)\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Debian 9\r\n - Version [e.g. flair-0.3.2]: 0.7\r\n\r\n**Additional context**\r\nThis issue can be fixed using torch version 1.5.0 or above, Should I submit a PR for it?\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2049/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2049/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2048", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2048/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2048/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2048/events", "html_url": "https://github.com/flairNLP/flair/issues/2048", "id": 776582428, "node_id": "MDU6SXNzdWU3NzY1ODI0Mjg=", "number": 2048, "title": "OSError: HEAD request failed for url", "user": {"login": "bhardwaj1230", "id": 12934266, "node_id": "MDQ6VXNlcjEyOTM0MjY2", "avatar_url": "https://avatars.githubusercontent.com/u/12934266?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bhardwaj1230", "html_url": "https://github.com/bhardwaj1230", "followers_url": "https://api.github.com/users/bhardwaj1230/followers", "following_url": "https://api.github.com/users/bhardwaj1230/following{/other_user}", "gists_url": "https://api.github.com/users/bhardwaj1230/gists{/gist_id}", "starred_url": "https://api.github.com/users/bhardwaj1230/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bhardwaj1230/subscriptions", "organizations_url": "https://api.github.com/users/bhardwaj1230/orgs", "repos_url": "https://api.github.com/users/bhardwaj1230/repos", "events_url": "https://api.github.com/users/bhardwaj1230/events{/privacy}", "received_events_url": "https://api.github.com/users/bhardwaj1230/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-12-30T18:28:49Z", "updated_at": "2021-05-12T11:49:37Z", "closed_at": "2021-05-12T11:49:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nScript:\r\nfrom flair.data import Sentence\r\nfrom flair.models import SequenceTagger\r\n#make a sentence\r\nsentence = Sentence('I love Berlin .')\r\n#load the NER tagger\r\ntagger = SequenceTagger.load('ner')\r\n\r\nError:\r\nOSError: HEAD request failed for url https://s3.eu-central-1.amazonaws.com/alan-nlp/resources/models-v0.4/NER-conll03-english/en-ner-conll03-v0.4.pt with status code 301.\r\n\r\n**To Reproduce**\r\ntagger = SequenceTagger.load('ner')\r\n\r\n**Expected behavior**\r\nA clear and concise description of what you expected to happen.\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Linux (CUDA=10.1, Tesla V100 GPU)\r\n - Version [e.g. flair-0.3.2]: flair==0.7 \r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2048/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2048/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2021", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2021/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2021/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2021/events", "html_url": "https://github.com/flairNLP/flair/issues/2021", "id": 763926527, "node_id": "MDU6SXNzdWU3NjM5MjY1Mjc=", "number": 2021, "title": "Getting error in loading sequence tagger model which uses scratched trained roberta model", "user": {"login": "Michael95-m", "id": 64765786, "node_id": "MDQ6VXNlcjY0NzY1Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/64765786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Michael95-m", "html_url": "https://github.com/Michael95-m", "followers_url": "https://api.github.com/users/Michael95-m/followers", "following_url": "https://api.github.com/users/Michael95-m/following{/other_user}", "gists_url": "https://api.github.com/users/Michael95-m/gists{/gist_id}", "starred_url": "https://api.github.com/users/Michael95-m/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Michael95-m/subscriptions", "organizations_url": "https://api.github.com/users/Michael95-m/orgs", "repos_url": "https://api.github.com/users/Michael95-m/repos", "events_url": "https://api.github.com/users/Michael95-m/events{/privacy}", "received_events_url": "https://api.github.com/users/Michael95-m/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2020-12-12T14:59:41Z", "updated_at": "2021-05-30T13:38:45Z", "closed_at": "2021-05-30T13:38:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n\r\nI got the error when I **loaded** the  trained **sequence tagger** model which uses the **scratched trained roberta model** from hugging face \r\n\r\n**To Reproduce**\r\n\r\nI trained the model with this config..\r\n\r\n```\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import ColumnCorpus\r\nfrom flair.embeddings import FlairEmbeddings, TokenEmbeddings, StackedEmbeddings, BertEmbeddings, CharacterEmbeddings, BytePairEmbeddings, WordEmbeddings, TransformerWordEmbeddings\r\nfrom flair.visual.training_curves import Plotter\r\nfrom torch.optim.lr_scheduler import OneCycleLR\r\nfrom flair.models import SequenceTagger\r\nfrom flair.trainers import ModelTrainer\r\nfrom typing import List\r\nfrom torch.optim.adam import Adam\r\nfrom torch.optim.lr_scheduler import OneCycleLR\r\nimport sys\r\nimport flair, torch \r\nimport gensim\r\n\r\nflair.device = torch.device('cuda:0')\r\n\r\ncolumns = {0: 'text', 1: 'tag'}\r\ndata_folder =  './data/Model_Trainer_Data'\r\ncorpus: Corpus = ColumnCorpus(data_folder, columns,train_file= sys.argv[1] , dev_file=sys.argv[3], test_file= sys.argv[4], in_memory=False)\r\n\r\ntag_type = 'tag'\r\ntag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\n\r\nrobert_model = TransformerWordEmbeddings('/home/user/Documents/mk/flair/embedding_model/roberta/v2c', fine_tune=True,  pooling_operation='mean', layers='-1', allow_long_sentences=True)\r\n\r\nembedding_types: List[TokenEmbeddings] = [\r\n    robert_model\r\n    ]\r\n\r\nembeddings: StackedEmbeddings = StackedEmbeddings(embeddings=embedding_types)\r\n\r\ntagger: SequenceTagger = SequenceTagger(hidden_size=256,\r\n                                        embeddings=embeddings,\r\n                                        tag_dictionary=tag_dictionary,\r\n                                        tag_type=tag_type,\r\n                                        use_crf=False,\r\n                                        use_rnn=False)\r\n\r\ntrainer: ModelTrainer = ModelTrainer(tagger, corpus, optimizer=Adam)\r\n\r\ntrainer.train('./results/'+ sys.argv[2],\r\n                learning_rate=3e-5, # very low learning rate\r\n                mini_batch_size=64,\r\n            max_epochs=10, # very few epochs of fine-tuning\r\n            embeddings_storage_mode = 'gpu',\r\n            train_with_dev=False,\r\n            checkpoint=True\r\n    )\r\n\r\n``` \r\n\r\nI loaded and predicted like this on other machine..\r\n\r\n```\r\nfrom flair.models import SequenceTagger\r\nfrom typing import List\r\n\r\ntagger_model = SequenceTagger.load('../models/w3c_series/w3c_10/best-model.pt')\r\n```\r\n\r\nWhen loading the model, I **got the error message like this**\r\n```\r\n020-12-12 21:14:15,430 loading file ../models/w3c_series/w3c_10/best-model.pt\r\n404 Client Error: Not Found for url: https://huggingface.co//home/user/Documents/mk/flair/embedding_model/roberta/v2c/resolve/main/config.json\r\n```\r\n\r\n**Expected behavior**\r\nI think the link from hugging face is wrong and **concatenated** with the path from the **gpu server path which I trained** (not from my local machine).\r\nI just want to load like other models which uses different embedding models without errors.\r\n\r\n\r\n**Environment :**\r\n - OS : Linux Mint 19.03\r\n - Version : latest branch \r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2021/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2021/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2013", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2013/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2013/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2013/events", "html_url": "https://github.com/flairNLP/flair/issues/2013", "id": 758764767, "node_id": "MDU6SXNzdWU3NTg3NjQ3Njc=", "number": 2013, "title": "Memory leak when using WordEmbeddings Class", "user": {"login": "gebauerm", "id": 44670806, "node_id": "MDQ6VXNlcjQ0NjcwODA2", "avatar_url": "https://avatars.githubusercontent.com/u/44670806?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gebauerm", "html_url": "https://github.com/gebauerm", "followers_url": "https://api.github.com/users/gebauerm/followers", "following_url": "https://api.github.com/users/gebauerm/following{/other_user}", "gists_url": "https://api.github.com/users/gebauerm/gists{/gist_id}", "starred_url": "https://api.github.com/users/gebauerm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gebauerm/subscriptions", "organizations_url": "https://api.github.com/users/gebauerm/orgs", "repos_url": "https://api.github.com/users/gebauerm/repos", "events_url": "https://api.github.com/users/gebauerm/events{/privacy}", "received_events_url": "https://api.github.com/users/gebauerm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2020-12-07T18:59:37Z", "updated_at": "2021-01-04T12:54:40Z", "closed_at": "2021-01-04T12:54:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hey,\r\n\r\nI encountered a bug while using GloveEmbeddings in a featurizer class. \r\n\r\n**Describe the bug**\r\nMultiple initializations and usage of WordEmbeddings, DocumentEmbeddings and their related embedding methods for a sentence, cause memory to add up, without releasing it after a function call. This leads to an OOM error in my application.\r\nAn example for reproduction can be found below.\r\n\r\n**To Reproduce**\r\nAfter each function call memory adds up and is not released, despite things being deleted and embeddings being cleared.\r\nThe `clear_embeddings()` method deletes objects in `Sentence._embeddings` as expected, but nonetheless no memory is released.\r\n\r\n\r\n```\r\nfrom flair.embeddings import WordEmbeddings, DocumentPoolEmbeddings\r\nfrom flair.data import Sentence\r\nfrom memory_profiler import profile\r\n\r\n\r\n@profile\r\ndef featurizer_memory_test():\r\n    glove_embeddings = WordEmbeddings(\"de\")\r\n    doc_embeddings = DocumentPoolEmbeddings([glove_embeddings])\r\n    sentence = Sentence(\"Hello World!\")\r\n    glove_embeddings.embed(sentence)\r\n    sentence.clear_embeddings()\r\n\r\n    del glove_embeddings\r\n    del doc_embeddings\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    for i in range(2):\r\n        featurizer_memory_test()\r\n\r\n```\r\n\r\nThe bug is related to the initialization of `WordEmbeddings(\"de\")`. Once I initialize them in a class I don't run into issues.\r\n\r\n\r\n```\r\nfrom flair.embeddings import WordEmbeddings, DocumentPoolEmbeddings\r\nfrom flair.data import Sentence\r\nfrom memory_profiler import profile\r\n\r\nclass Embedder:\r\n\r\n    def __init__(self):\r\n        self.glove_embeddings = WordEmbeddings(\"de\")\r\n\r\n    @profile\r\n    def featurizer_memory_test(self):\r\n        doc_embeddings = DocumentPoolEmbeddings([self.glove_embeddings])\r\n        sentence = Sentence(\"Hello World!\")\r\n        doc_embeddings.embed(sentence)\r\n        sentence.clear_embeddings()\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    embedder = Embedder()\r\n    for i in range(2):\r\n        embedder.featurizer_memory_test()\r\n```\r\n\r\nHowever this is not a fix for me. I would have to write a singleton in my application, because despite it being a local variable in a function, whenever the function is done with execution the memory will not be released.\r\n\r\n\r\n**Expected behavior**\r\nI would assume that after each function call the memory gets released properly. Meaning when I run a memory profiler in this case, I would not have higher initial memory in the second run than in my first run.\r\n\r\n**Environment (please complete the following information):**\r\n - Ubuntu 18.04\r\n- python 3.7.8\r\n - flair 0.6.1.post1, flair 0.6.1, flair 0.7\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2013/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2013/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2011", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2011/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2011/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2011/events", "html_url": "https://github.com/flairNLP/flair/issues/2011", "id": 758632675, "node_id": "MDU6SXNzdWU3NTg2MzI2NzU=", "number": 2011, "title": "'NoneType' object has no attribute 'encode'", "user": {"login": "Rasmitha23", "id": 12725119, "node_id": "MDQ6VXNlcjEyNzI1MTE5", "avatar_url": "https://avatars.githubusercontent.com/u/12725119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Rasmitha23", "html_url": "https://github.com/Rasmitha23", "followers_url": "https://api.github.com/users/Rasmitha23/followers", "following_url": "https://api.github.com/users/Rasmitha23/following{/other_user}", "gists_url": "https://api.github.com/users/Rasmitha23/gists{/gist_id}", "starred_url": "https://api.github.com/users/Rasmitha23/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Rasmitha23/subscriptions", "organizations_url": "https://api.github.com/users/Rasmitha23/orgs", "repos_url": "https://api.github.com/users/Rasmitha23/repos", "events_url": "https://api.github.com/users/Rasmitha23/events{/privacy}", "received_events_url": "https://api.github.com/users/Rasmitha23/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2020-12-07T15:55:58Z", "updated_at": "2020-12-18T11:55:38Z", "closed_at": "2020-12-17T14:02:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am fine-tuning the available sentiment analysis model() on my data with 5 epochs, After completing 5 epochs, it tries to evaluate the performance on the test set and then I am getting the **'NoneType' object has no attribute 'encode'** error\r\n\r\nBelow is the code I used\r\nimport flair\r\nmodel = flair.models.TextClassifier.load('en-sentiment')\r\ncorpus: Corpus = CSVClassificationCorpus(data_folder,column_name_map,skip_header=True)\r\ntrainer: ModelTrainer = ModelTrainer(model, corpus)\r\ntrainer.train('./results',learning_rate=0.00001,\r\n              mini_batch_size=32,\r\n              max_epochs=5)\r\n\r\nscreenshot of the error.\r\n![image](https://user-images.githubusercontent.com/12725119/101372850-5416cc80-38d2-11eb-99eb-ad5b0fadf150.png)\r\n\r\n**Environment (please complete the following information):**\r\n - OS - Linux:\r\n - Versions\r\n 1)  flair-0.7\r\n2) torch - 1.6.0+cu101\r\n3) Python- 3.6\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2011/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2011/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2008", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2008/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2008/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2008/events", "html_url": "https://github.com/flairNLP/flair/issues/2008", "id": 758053987, "node_id": "MDU6SXNzdWU3NTgwNTM5ODc=", "number": 2008, "title": "TransformerWordEmbeddings does not support Transformer-XL model", "user": {"login": "tiagokv", "id": 1560621, "node_id": "MDQ6VXNlcjE1NjA2MjE=", "avatar_url": "https://avatars.githubusercontent.com/u/1560621?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tiagokv", "html_url": "https://github.com/tiagokv", "followers_url": "https://api.github.com/users/tiagokv/followers", "following_url": "https://api.github.com/users/tiagokv/following{/other_user}", "gists_url": "https://api.github.com/users/tiagokv/gists{/gist_id}", "starred_url": "https://api.github.com/users/tiagokv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tiagokv/subscriptions", "organizations_url": "https://api.github.com/users/tiagokv/orgs", "repos_url": "https://api.github.com/users/tiagokv/repos", "events_url": "https://api.github.com/users/tiagokv/events{/privacy}", "received_events_url": "https://api.github.com/users/tiagokv/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-12-06T23:42:07Z", "updated_at": "2020-12-07T19:31:31Z", "closed_at": "2020-12-07T19:31:31Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\n`TransformerWordEmbeddings` does not support Transformer-XL model.\r\n\r\n**To Reproduce**\r\n```python\r\nfrom flair.embeddings import TransformerWordEmbeddings\r\nfrom flair.data import Sentence\r\n\r\nmodel = TransformerWordEmbeddings(\"transfo-xl-wt103\", \"all\", \"mean\")\r\nmodel.embed(Sentence(\"tiago\"))\r\n```\r\n\r\nOutput is:\r\n```python\r\nTraceback (most recent call last):\r\n  File \"test.py\", line 8, in <module>\r\n    model.embed(Sentence(\"tiago\"))\r\n  File \"/home/tiago/.local/lib/python3.8/site-packages/flair/embeddings/base.py\", line 60, in embed\r\n    self._add_embeddings_internal(sentences)\r\n  File \"/home/tiago/.local/lib/python3.8/site-packages/flair/embeddings/token.py\", line 861, in _add_embeddings_internal\r\n    self._add_embeddings_to_sentences(batch)\r\n  File \"/home/tiago/.local/lib/python3.8/site-packages/flair/embeddings/token.py\", line 972, in _add_embeddings_to_sentences\r\n    hidden_states = self.model(input_ids, attention_mask=mask)[-1]\r\n  File \"/home/tiago/.local/lib/python3.8/site-packages/torch/nn/modules/module.py\", line 722, in _call_impl\r\n    result = self.forward(*input, **kwargs)\r\nTypeError: forward() got an unexpected keyword argument 'attention_mask'\r\n```\r\n\r\n**Expected behavior**\r\nExpected to support as it looks like it should be the class to concentrate all Transformer based models.\r\n\r\n**Screenshots**\r\nnot relevant.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Linux\r\n - Version [e.g. flair-0.3.2]: 0.6.1", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2008/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2008/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2007", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2007/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2007/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2007/events", "html_url": "https://github.com/flairNLP/flair/issues/2007", "id": 757655088, "node_id": "MDU6SXNzdWU3NTc2NTUwODg=", "number": 2007, "title": "Bug with local downloaded TransformerWordEmbeddings", "user": {"login": "albertovilla", "id": 1217687, "node_id": "MDQ6VXNlcjEyMTc2ODc=", "avatar_url": "https://avatars.githubusercontent.com/u/1217687?v=4", "gravatar_id": "", "url": "https://api.github.com/users/albertovilla", "html_url": "https://github.com/albertovilla", "followers_url": "https://api.github.com/users/albertovilla/followers", "following_url": "https://api.github.com/users/albertovilla/following{/other_user}", "gists_url": "https://api.github.com/users/albertovilla/gists{/gist_id}", "starred_url": "https://api.github.com/users/albertovilla/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/albertovilla/subscriptions", "organizations_url": "https://api.github.com/users/albertovilla/orgs", "repos_url": "https://api.github.com/users/albertovilla/repos", "events_url": "https://api.github.com/users/albertovilla/events{/privacy}", "received_events_url": "https://api.github.com/users/albertovilla/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-12-05T11:01:15Z", "updated_at": "2020-12-06T08:48:45Z", "closed_at": "2020-12-06T08:48:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n\r\nI've developed a NER tagger locally in my computer using Flair. Now, I need to deploy it to a VM where there is no internet connection so I have downloaded the required embeddings:\r\n- Flair embeddings: news-forward and news-backward\r\n- TransformerWordEmbedding: distilbert-base-uncased\r\n\r\nWhen I create the model with internet connection i.e. by defining the embeddings just with the name e.g. `TransformerWordEmbeddings('distilbert-base-uncased')` everything works as expected, however, when I download the model and try to train it I get an error `RuntimeError: CUDA error: device-side assert triggered`.\r\n\r\nI have managed to train a model locally using downloaded Flair embeddings, but whenever I add a `TransformerWordEmbedding` I get CUDA errors and the model breaks during training, always during the first epoch the not necessarily in the first iteration.\r\n\r\n**To Reproduce**\r\nAs I have isolated the problem to the `TransformerWordEmbedding` I have defined the following test to isolate the bug. \r\n\r\n#### 1) Define a model that works assuming there is internet connection\r\n\r\n```python\r\nmodel_2 = { 'embedding_types': [FlairEmbeddings('news-forward'),\r\n                                FlairEmbeddings('news-backward'),\r\n                                TransformerWordEmbeddings('distilbert-base-uncased')\r\n                               ],\r\n            'name': 'distilbert-ner',\r\n            # Model folder\r\n            'folder': 'resources/taggers/distilbert-ner',\r\n            # Hyperparameters\r\n            'hidden_size': 768,\r\n            'rnn_layers': 2,\r\n            'learning_rate': 0.1,\r\n            'mini_batch_size': 32,\r\n            'max_epochs': 50\r\n          }\r\n```\r\n\r\nThis model trains properly without any problem using the following code:\r\n\r\n```python\r\n# Load embeddings\r\nembedding_types : List[TokenEmbeddings] = model_2['embedding_types']\r\nembeddings : StackedEmbeddings = StackedEmbeddings(embeddings=embedding_types)\r\n    \r\n# Create model tagger\r\ntagger : SequenceTagger = SequenceTagger(hidden_size=model_2['hidden_size'],\r\n                                         rnn_layers=model_2['rnn_layers'],\r\n                                         embeddings=embeddings,\r\n                                         tag_dictionary=tag_dictionary,\r\n                                         tag_type=tag_type,\r\n                                         use_crf=True)\r\n    \r\n# Create model trainer\r\ntrainer : ModelTrainer = ModelTrainer(tagger, corpus)\r\n\r\ntrainer.train(model_2['folder'],\r\n              learning_rate=model_2['learning_rate'],\r\n              mini_batch_size=model_2['mini_batch_size'],\r\n              max_epochs=model_2['max_epochs'])\r\n```\r\n\r\n#### 2) Define a model that breaks loading a `TransformerWordEmbedding` locally\r\n\r\nI have downloaded the `distilbert-base-uncased` model from https://huggingface.co/distilbert-base-uncased/tree/main and placed the files in a local folder `resources/embeddings/token/distilbert`. Then I create the model using the same code than with the first model but enforcing local load.\r\n\r\n```python\r\nDISTILBERT = 'resources/embeddings/token/distilbert'\r\n\r\n# Testing with local model\r\nmodel_2 = { 'embedding_types': [FlairEmbeddings('news-forward'),\r\n                                FlairEmbeddings('news-backward'),\r\n                                TransformerWordEmbeddings(DISTILBERT)\r\n                               ],\r\n            'name': 'distilbert-ner',\r\n            # Model folder\r\n            'folder': 'resources/taggers/distilbert-ner',\r\n            # Hyperparameters\r\n            'hidden_size': 768,\r\n            'rnn_layers': 2,\r\n            'learning_rate': 0.1,\r\n            'mini_batch_size': 32,\r\n            'max_epochs': 50\r\n          }\r\n```\r\n\r\nThe above code executes without any error or warning but when I use the code for the training, exactly the same than for the first model. I get an error during epoch 1.\r\n\r\n```\r\n2020-12-05 11:32:49,298 ----------------------------------------------------------------------------------------------------\r\n2020-12-05 11:32:49,300 Corpus: \"Corpus: 5323 train + 592 dev + 1972 test sentences\"\r\n2020-12-05 11:32:49,300 ----------------------------------------------------------------------------------------------------\r\n2020-12-05 11:32:49,301 Parameters:\r\n2020-12-05 11:32:49,302  - learning_rate: \"0.1\"\r\n2020-12-05 11:32:49,302  - mini_batch_size: \"32\"\r\n2020-12-05 11:32:49,303  - patience: \"3\"\r\n2020-12-05 11:32:49,304  - anneal_factor: \"0.5\"\r\n2020-12-05 11:32:49,304  - max_epochs: \"50\"\r\n2020-12-05 11:32:49,305  - shuffle: \"True\"\r\n2020-12-05 11:32:49,306  - train_with_dev: \"False\"\r\n2020-12-05 11:32:49,306  - batch_growth_annealing: \"False\"\r\n2020-12-05 11:32:49,307 ----------------------------------------------------------------------------------------------------\r\n2020-12-05 11:32:49,308 Model training base path: \"resources\\taggers\\distilbert-ner\"\r\n2020-12-05 11:32:49,309 ----------------------------------------------------------------------------------------------------\r\n2020-12-05 11:32:49,309 Device: cuda:0\r\n2020-12-05 11:32:49,310 ----------------------------------------------------------------------------------------------------\r\n2020-12-05 11:32:49,311 Embeddings storage mode: cpu\r\n2020-12-05 11:32:49,314 ----------------------------------------------------------------------------------------------------\r\n2020-12-05 11:33:08,907 epoch 1 - iter 16/167 - loss 13.00996539 - samples/sec: 26.14 - lr: 0.100000\r\n2020-12-05 11:33:29,829 epoch 1 - iter 32/167 - loss 10.77191505 - samples/sec: 24.47 - lr: 0.100000\r\n2020-12-05 11:33:49,754 epoch 1 - iter 48/167 - loss 9.50294068 - samples/sec: 25.70 - lr: 0.100000\r\n2020-12-05 11:34:10,028 epoch 1 - iter 64/167 - loss 9.12441025 - samples/sec: 25.26 - lr: 0.100000\r\n2020-12-05 11:34:32,542 epoch 1 - iter 80/167 - loss 8.85962501 - samples/sec: 22.74 - lr: 0.100000\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-11-66efbade56b8> in <module>()\r\n     17               learning_rate=model_2['learning_rate'],\r\n     18               mini_batch_size=model_2['mini_batch_size'],\r\n---> 19               max_epochs=model_2['max_epochs'])\r\n\r\nZ:\\anaconda\\envs\\dc_ner\\lib\\site-packages\\flair\\trainers\\trainer.py in train(self, base_path, learning_rate, mini_batch_size, mini_batch_chunk_size, max_epochs, scheduler, cycle_momentum, anneal_factor, patience, initial_extra_patience, min_learning_rate, train_with_dev, monitor_train, monitor_test, embeddings_storage_mode, checkpoint, save_final_model, anneal_with_restarts, anneal_with_prestarts, batch_growth_annealing, shuffle, param_selection_mode, write_weights, num_workers, sampler, use_amp, amp_opt_level, eval_on_train_fraction, eval_on_train_shuffle, **kwargs)\r\n    369 \r\n    370                         # forward pass\r\n--> 371                         loss = self.model.forward_loss(batch_step)\r\n    372 \r\n    373                         # Backward\r\n\r\nZ:\\anaconda\\envs\\dc_ner\\lib\\site-packages\\flair\\models\\sequence_tagger_model.py in forward_loss(self, data_points, sort)\r\n    617             self, data_points: Union[List[Sentence], Sentence], sort=True\r\n    618     ) -> torch.tensor:\r\n--> 619         features = self.forward(data_points)\r\n    620         return self._calculate_loss(features, data_points)\r\n    621 \r\n\r\nZ:\\anaconda\\envs\\dc_ner\\lib\\site-packages\\flair\\models\\sequence_tagger_model.py in forward(self, sentences)\r\n    622     def forward(self, sentences: List[Sentence]):\r\n    623 \r\n--> 624         self.embeddings.embed(sentences)\r\n    625 \r\n    626         names = self.embeddings.get_names()\r\n\r\nZ:\\anaconda\\envs\\dc_ner\\lib\\site-packages\\flair\\embeddings\\token.py in embed(self, sentences, static_embeddings)\r\n     69 \r\n     70         for embedding in self.embeddings:\r\n---> 71             embedding.embed(sentences)\r\n     72 \r\n     73     @property\r\n\r\nZ:\\anaconda\\envs\\dc_ner\\lib\\site-packages\\flair\\embeddings\\base.py in embed(self, sentences)\r\n     58 \r\n     59         if not everything_embedded or not self.static_embeddings:\r\n---> 60             self._add_embeddings_internal(sentences)\r\n     61 \r\n     62         return sentences\r\n\r\nZ:\\anaconda\\envs\\dc_ner\\lib\\site-packages\\flair\\embeddings\\token.py in _add_embeddings_internal(self, sentences)\r\n    857         # embed each micro-batch\r\n    858         for batch in sentence_batches:\r\n--> 859             self._add_embeddings_to_sentences(batch)\r\n    860 \r\n    861         return sentences\r\n\r\nZ:\\anaconda\\envs\\dc_ner\\lib\\site-packages\\flair\\embeddings\\token.py in _add_embeddings_to_sentences(self, sentences)\r\n    965         for s_id, sentence in enumerate(subtokenized_sentences):\r\n    966             sequence_length = len(sentence)\r\n--> 967             input_ids[s_id][:sequence_length] = sentence\r\n    968             mask[s_id][:sequence_length] = torch.ones(sequence_length)\r\n    969 \r\n\r\nRuntimeError: CUDA error: device-side assert triggered\r\n```\r\n\r\nNote that this problem doesn't happen with local Flair embeddings, so I can create a model which uses local news-forward and news-backward Flair embeddings and the model trains without any issue so I guess there must be something different when the model is loaded locally compared when Flair automatically downloads the files and loads them from the cache in `.cache\\torch\\transformers`.\r\n\r\n**Expected behavior**\r\nI think both models should work exactly the same but for some reason this is not the case.\r\n\r\n**Environment (please complete the following information):**\r\n - Windows 10\r\n - Version flair 0.6.1.post1\r\n- GPU GIGABYTE GeForce GTX 1060 6GB GDDR5\r\n\r\nI have tested this also in a VM using Windows Server 2016 with a Tesla V100 but I rather try to find a solution in my computer before trying again in AWS.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2007/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2007/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/2005", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/2005/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/2005/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/2005/events", "html_url": "https://github.com/flairNLP/flair/issues/2005", "id": 757217100, "node_id": "MDU6SXNzdWU3NTcyMTcxMDA=", "number": 2005, "title": "AttributeError: module 'tensorflow_core.keras.activations' has no attribute 'swish'", "user": {"login": "ishan42d", "id": 41026850, "node_id": "MDQ6VXNlcjQxMDI2ODUw", "avatar_url": "https://avatars.githubusercontent.com/u/41026850?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ishan42d", "html_url": "https://github.com/ishan42d", "followers_url": "https://api.github.com/users/ishan42d/followers", "following_url": "https://api.github.com/users/ishan42d/following{/other_user}", "gists_url": "https://api.github.com/users/ishan42d/gists{/gist_id}", "starred_url": "https://api.github.com/users/ishan42d/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ishan42d/subscriptions", "organizations_url": "https://api.github.com/users/ishan42d/orgs", "repos_url": "https://api.github.com/users/ishan42d/repos", "events_url": "https://api.github.com/users/ishan42d/events{/privacy}", "received_events_url": "https://api.github.com/users/ishan42d/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-12-04T16:08:41Z", "updated_at": "2020-12-30T10:22:42Z", "closed_at": "2020-12-07T10:48:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am very new to this flair package but belive that it can help me resolve the current challenges I am facing right now. I am just trying to get some basics right and while using the following code:\r\n\r\nfrom flair.data import Sentence\r\nsentence = Sentence('The grass is green.')\r\nprint(sentence)\r\n\r\n**I got this error:**\r\nAttributeError: module 'tensorflow_core.keras.activations' has no attribute 'swish'\r\n\r\nCan someone explain this to me why is this happening? TF is already there on my system and I am not sure why I am getting this error", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/2005/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/2005/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1990", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1990/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1990/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1990/events", "html_url": "https://github.com/flairNLP/flair/issues/1990", "id": 751741361, "node_id": "MDU6SXNzdWU3NTE3NDEzNjE=", "number": 1990, "title": "model.predict returns error", "user": {"login": "igormis", "id": 6599037, "node_id": "MDQ6VXNlcjY1OTkwMzc=", "avatar_url": "https://avatars.githubusercontent.com/u/6599037?v=4", "gravatar_id": "", "url": "https://api.github.com/users/igormis", "html_url": "https://github.com/igormis", "followers_url": "https://api.github.com/users/igormis/followers", "following_url": "https://api.github.com/users/igormis/following{/other_user}", "gists_url": "https://api.github.com/users/igormis/gists{/gist_id}", "starred_url": "https://api.github.com/users/igormis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/igormis/subscriptions", "organizations_url": "https://api.github.com/users/igormis/orgs", "repos_url": "https://api.github.com/users/igormis/repos", "events_url": "https://api.github.com/users/igormis/events{/privacy}", "received_events_url": "https://api.github.com/users/igormis/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 16, "created_at": "2020-11-26T17:17:01Z", "updated_at": "2021-04-07T23:26:43Z", "closed_at": "2021-04-07T23:26:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI am using trained sequence_tagger_model trained with bert-multilingual embeddings and flair multilingual parameters, where I set fine_tune=True. However sometimes it throws an error:\r\n```\r\n File \"/app/nlu_ml_v2.py\", line 97, in tag_span\r\nweb_nlu_ml.1.ryu06t0cj1wl@ip-172-31-84-5    |     model.predict(sentence)\r\nweb_nlu_ml.1.ryu06t0cj1wl@ip-172-31-84-5    |   File \"/usr/local/lib/python3.6/dist-packages/flair/models/sequence_tagger_model.py\", line 369, in predict\r\nweb_nlu_ml.1.ryu06t0cj1wl@ip-172-31-84-5    |     feature = self.forward(batch)\r\nweb_nlu_ml.1.ryu06t0cj1wl@ip-172-31-84-5    |   File \"/usr/local/lib/python3.6/dist-packages/flair/models/sequence_tagger_model.py\", line 637, in forward\r\nweb_nlu_ml.1.ryu06t0cj1wl@ip-172-31-84-5    |     self.embeddings.embedding_length,\r\nweb_nlu_ml.1.ryu06t0cj1wl@ip-172-31-84-5    | RuntimeError: shape '[1, 4, 5632]' is invalid for input of size 20992\r\n```\r\n\r\n**To Reproduce**\r\nsequence_tagger_model trained with bert-multilingual embeddings and flair multilingual parameters, where I set fine_tune=True\r\n\r\n**Expected behavior**\r\nit should work all the time\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [Ubuntu]\r\n - Version [flair==0.6.0]\r\n - Torch = 1.6.0\r\n - Python=3.6\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1990/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1990/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1986", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1986/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1986/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1986/events", "html_url": "https://github.com/flairNLP/flair/issues/1986", "id": 750877232, "node_id": "MDU6SXNzdWU3NTA4NzcyMzI=", "number": 1986, "title": "Token attribute \"idx\" not equal to position in sentence.", "user": {"login": "daniellobrunello", "id": 4480835, "node_id": "MDQ6VXNlcjQ0ODA4MzU=", "avatar_url": "https://avatars.githubusercontent.com/u/4480835?v=4", "gravatar_id": "", "url": "https://api.github.com/users/daniellobrunello", "html_url": "https://github.com/daniellobrunello", "followers_url": "https://api.github.com/users/daniellobrunello/followers", "following_url": "https://api.github.com/users/daniellobrunello/following{/other_user}", "gists_url": "https://api.github.com/users/daniellobrunello/gists{/gist_id}", "starred_url": "https://api.github.com/users/daniellobrunello/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/daniellobrunello/subscriptions", "organizations_url": "https://api.github.com/users/daniellobrunello/orgs", "repos_url": "https://api.github.com/users/daniellobrunello/repos", "events_url": "https://api.github.com/users/daniellobrunello/events{/privacy}", "received_events_url": "https://api.github.com/users/daniellobrunello/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-11-25T14:42:38Z", "updated_at": "2020-11-27T16:08:19Z", "closed_at": "2020-11-27T16:08:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "Not sure if this is a bug or in some way a feature for later use of the token indices.\r\nThere was something going on with the `__get_item__` method in the Sentence class (see #107).  \r\n\r\nSlicing the sentence returns the correct token:\r\n```python\r\nSentence(\"He likes apples .\")[0] = Token: He\r\n```\r\nAnyway, the `idx` attribute of the token `Token: He` is `1`. \r\nTaking this index to retrieve the token from the sentence would yield `Token: likes`. \r\n\r\nI would expect the token index to be equal to its position in the sentence (whilst starting to count from 0). \r\n\r\nI'm running `flair 0.6.1.post1`.\r\n\r\n_If_ this behavior is not wanted, then probably the issue lies here: \r\n\r\n`Sentence.add_token(.)`:\r\n```python\r\n# set token idx if not set\r\ntoken.sentence = self\r\nif token.idx is None:\r\n    token.idx = len(self.tokens)\r\n```\r\nshould be something like\r\n```python\r\n# set token idx if not set\r\ntoken.sentence = self\r\nif token.idx is None:\r\n    token.idx = len(self.tokens) - 1\r\n```\r\nOr do this before adding the token to `self.tokens`\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1986/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1986/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1982", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1982/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1982/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1982/events", "html_url": "https://github.com/flairNLP/flair/issues/1982", "id": 749821374, "node_id": "MDU6SXNzdWU3NDk4MjEzNzQ=", "number": 1982, "title": "Tutorial 8 - Optimizers - not working with Flair 0.6.1", "user": {"login": "danmaxis", "id": 486996, "node_id": "MDQ6VXNlcjQ4Njk5Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/486996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/danmaxis", "html_url": "https://github.com/danmaxis", "followers_url": "https://api.github.com/users/danmaxis/followers", "following_url": "https://api.github.com/users/danmaxis/following{/other_user}", "gists_url": "https://api.github.com/users/danmaxis/gists{/gist_id}", "starred_url": "https://api.github.com/users/danmaxis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/danmaxis/subscriptions", "organizations_url": "https://api.github.com/users/danmaxis/orgs", "repos_url": "https://api.github.com/users/danmaxis/repos", "events_url": "https://api.github.com/users/danmaxis/events{/privacy}", "received_events_url": "https://api.github.com/users/danmaxis/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-11-24T15:41:30Z", "updated_at": "2021-07-13T18:14:03Z", "closed_at": "2021-07-13T18:14:03Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI'm trying to run the Optimizer Tutorial (number 8), but in the second training gives me an invalid input size error. \r\n`job exception: shape '[8, 14, 4096]' is invalid for input of size 794624`\r\n\r\n\r\n**To Reproduce**\r\nRun the script parts sequentially in the \"Selecting Hyper Parameters\" section. (I'm using in my jupyter notebook). Very much like described in issue #1340 but in local instance.\r\n\r\n**Expected behavior**\r\nI presume it would finish execution without any errors, while generating best model files.\r\n\r\n**Screenshots**\r\nIt is just like isse #1340 Although it happens in my local instance, \r\n\r\n**Environment (please complete the following information):**\r\n - OS: Windows 10 19042.630\r\n - Flair Version : 0.6.1.post1\r\n- cudatoolkit:11.0.221\r\n- pytorch: 1.7.0 - py3.8_cuda110_cudnn8_0\r\n- Python Version: 3.8.5\r\n\r\n**Additional context**\r\nIt is just like isse #1340 Although it happens in my local instance, ", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1982/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1982/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1976", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1976/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1976/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1976/events", "html_url": "https://github.com/flairNLP/flair/issues/1976", "id": 747675465, "node_id": "MDU6SXNzdWU3NDc2NzU0NjU=", "number": 1976, "title": "ModuleAttributeError for tagger with de-pos-tweets", "user": {"login": "ghost", "id": 10137, "node_id": "MDQ6VXNlcjEwMTM3", "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ghost", "html_url": "https://github.com/ghost", "followers_url": "https://api.github.com/users/ghost/followers", "following_url": "https://api.github.com/users/ghost/following{/other_user}", "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}", "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ghost/subscriptions", "organizations_url": "https://api.github.com/users/ghost/orgs", "repos_url": "https://api.github.com/users/ghost/repos", "events_url": "https://api.github.com/users/ghost/events{/privacy}", "received_events_url": "https://api.github.com/users/ghost/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-11-20T17:37:13Z", "updated_at": "2021-03-28T05:58:04Z", "closed_at": "2021-03-28T05:58:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi there,\r\n\r\nI face some issues because of different loaded datasets.\r\n\r\nThe SequenceTagger works with the model 'pos' as well as 'de-pos'. But when using 'de-pos-tweets' (what I'm actually interested in) I get the error\r\n\r\nModuleAttributeError: 'CharLMEmbeddings' object has no attribute 'chars_per_chunk'\r\n\r\nwhen making the prediction\r\n\r\n**Environment:\r\n - OS: Windows10\r\n - Version: flair==0.6.1\r\n\r\n**Additional context\r\nHad also a problem with the TextClassifier: using 'sentiment' worked right away; for 'de-offensive-language' I needed to use the workaround regarding the PosixPath described in issue 1052.\r\n\r\n\r\nBest, Elke\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1976/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1976/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1969", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1969/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1969/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1969/events", "html_url": "https://github.com/flairNLP/flair/issues/1969", "id": 741848970, "node_id": "MDU6SXNzdWU3NDE4NDg5NzA=", "number": 1969, "title": "Down loading embeddings returns redirect error for Alan NLP", "user": {"login": "LukasDauterman", "id": 3969402, "node_id": "MDQ6VXNlcjM5Njk0MDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3969402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LukasDauterman", "html_url": "https://github.com/LukasDauterman", "followers_url": "https://api.github.com/users/LukasDauterman/followers", "following_url": "https://api.github.com/users/LukasDauterman/following{/other_user}", "gists_url": "https://api.github.com/users/LukasDauterman/gists{/gist_id}", "starred_url": "https://api.github.com/users/LukasDauterman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LukasDauterman/subscriptions", "organizations_url": "https://api.github.com/users/LukasDauterman/orgs", "repos_url": "https://api.github.com/users/LukasDauterman/repos", "events_url": "https://api.github.com/users/LukasDauterman/events{/privacy}", "received_events_url": "https://api.github.com/users/LukasDauterman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-11-12T18:59:38Z", "updated_at": "2020-12-30T18:05:55Z", "closed_at": "2020-12-03T23:29:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am trying to load flair embeddings and I keep getting the following error:\r\n\r\n`OSError: HEAD request failed for url https://s3.eu-central-1.amazonaws.com/alan-nlp/resources/embeddings/glove.gensim.vectors.npy with status code 301.`\r\n\r\nThe status code indicates a permanent redirect.\r\n\r\nI SSH into the machine that is exhibiting this issue, so there is no network issues that I can think of.\r\n\r\nThe code that produces this issue for me :\r\n```\r\nembedding_types: List[TokenEmbeddings] = [\r\n    WordEmbeddings('glove'),\r\n    FlairEmbeddings('news-forward-fast'),\r\n    FlairEmbeddings('news-backward-fast')\r\n]\r\n```\r\n![image](https://user-images.githubusercontent.com/3969402/98983559-cb289300-24d5-11eb-8706-27732164b0aa.png)\r\n![image](https://user-images.githubusercontent.com/3969402/98983606-ded3f980-24d5-11eb-9256-830b6583ce59.png)\r\n\r\nBut this doesn't work and throws the error, and I get similar errors for all the different embeddings.\r\n\r\nEnvironment:\r\n - OS : linux\r\n - Python: 3.7\r\n- Flair: 0.4.5 (have to use this version)\r\n- Using visual studio code and remote ssh.\r\n\r\nThis is running in a VM in Azure resources, but can't give more details than that.\r\n\r\nI have tried looking for where I can download the models, but it has a similar issue, shows a redirect error:\r\n\r\n![image](https://user-images.githubusercontent.com/3969402/98983742-1478e280-24d6-11eb-8c6b-55694438fdea.png)\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1969/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1969/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1948", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1948/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1948/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1948/events", "html_url": "https://github.com/flairNLP/flair/issues/1948", "id": 738415460, "node_id": "MDU6SXNzdWU3Mzg0MTU0NjA=", "number": 1948, "title": "NER model of Flair will make GPU stuck in 100% usage under high concurrency requests.", "user": {"login": "xzlyu", "id": 17704663, "node_id": "MDQ6VXNlcjE3NzA0NjYz", "avatar_url": "https://avatars.githubusercontent.com/u/17704663?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xzlyu", "html_url": "https://github.com/xzlyu", "followers_url": "https://api.github.com/users/xzlyu/followers", "following_url": "https://api.github.com/users/xzlyu/following{/other_user}", "gists_url": "https://api.github.com/users/xzlyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/xzlyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xzlyu/subscriptions", "organizations_url": "https://api.github.com/users/xzlyu/orgs", "repos_url": "https://api.github.com/users/xzlyu/repos", "events_url": "https://api.github.com/users/xzlyu/events{/privacy}", "received_events_url": "https://api.github.com/users/xzlyu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-11-08T08:03:38Z", "updated_at": "2021-03-15T16:58:34Z", "closed_at": "2021-03-15T16:58:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "I make a demo of this bug and upload it to my Github repo, please check [here](https://github.com/xzlyu/Flair_BUG_REPORTER).\r\n\r\nThanks.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1948/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1948/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1941", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1941/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1941/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1941/events", "html_url": "https://github.com/flairNLP/flair/issues/1941", "id": 736815998, "node_id": "MDU6SXNzdWU3MzY4MTU5OTg=", "number": 1941, "title": "memory errors running on server", "user": {"login": "alejandrojcastaneira", "id": 42115387, "node_id": "MDQ6VXNlcjQyMTE1Mzg3", "avatar_url": "https://avatars.githubusercontent.com/u/42115387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alejandrojcastaneira", "html_url": "https://github.com/alejandrojcastaneira", "followers_url": "https://api.github.com/users/alejandrojcastaneira/followers", "following_url": "https://api.github.com/users/alejandrojcastaneira/following{/other_user}", "gists_url": "https://api.github.com/users/alejandrojcastaneira/gists{/gist_id}", "starred_url": "https://api.github.com/users/alejandrojcastaneira/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alejandrojcastaneira/subscriptions", "organizations_url": "https://api.github.com/users/alejandrojcastaneira/orgs", "repos_url": "https://api.github.com/users/alejandrojcastaneira/repos", "events_url": "https://api.github.com/users/alejandrojcastaneira/events{/privacy}", "received_events_url": "https://api.github.com/users/alejandrojcastaneira/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-11-05T10:38:06Z", "updated_at": "2022-09-07T08:05:04Z", "closed_at": "2021-04-04T09:02:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\n\r\nI have an API served with NER models trained with Flair embeddings, the original version not the pooled one. However, I have noticed that the memory on the gpu might not be released correctly, after making some inferences, the memory starts to grow and after several thousand inferences are made, CUDA memory errors start to show, after the first one occurs all subsequent inferences throw this.\r\n\r\nI have the setting embedding_storage_mode = \"none\" when making the predictions and have tried the other settings, but we observed the same behaviour.\r\n\r\nI am currently restarting the server daily or when the Cuda error occurs, so sorry to comment on this, for our use case the models are performing great! and the predictions are excellent! \r\n\r\nThank you very much for the great work!\r\n\r\nBest regards\r\n\r\n**Environment**\r\n - Linux 18.10:\r\n - flair-0.6.1:", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1941/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1941/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1925", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1925/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1925/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1925/events", "html_url": "https://github.com/flairNLP/flair/issues/1925", "id": 733170183, "node_id": "MDU6SXNzdWU3MzMxNzAxODM=", "number": 1925, "title": "Sampling strategy in TARS breaks when cosine distance between all the labels are exactly 0", "user": {"login": "kishaloyhalder", "id": 16892172, "node_id": "MDQ6VXNlcjE2ODkyMTcy", "avatar_url": "https://avatars.githubusercontent.com/u/16892172?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kishaloyhalder", "html_url": "https://github.com/kishaloyhalder", "followers_url": "https://api.github.com/users/kishaloyhalder/followers", "following_url": "https://api.github.com/users/kishaloyhalder/following{/other_user}", "gists_url": "https://api.github.com/users/kishaloyhalder/gists{/gist_id}", "starred_url": "https://api.github.com/users/kishaloyhalder/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kishaloyhalder/subscriptions", "organizations_url": "https://api.github.com/users/kishaloyhalder/orgs", "repos_url": "https://api.github.com/users/kishaloyhalder/repos", "events_url": "https://api.github.com/users/kishaloyhalder/events{/privacy}", "received_events_url": "https://api.github.com/users/kishaloyhalder/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-10-30T13:23:48Z", "updated_at": "2021-03-08T01:34:15Z", "closed_at": "2021-03-08T01:34:15Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "**Description**\r\nIf we try to train a TARS model on a corpus with labels such as \"positive sentiment\" and \"negative sentiment\", the sampling strategy breaks in TARSClassifier.\r\n\r\n**Steps to Reproduce:**\r\nConsider a dataset where the label set is \"positive sentiment\", \"negative sentiment\". If we try to train a `TARSClassifier` model, it breaks with the following error with the default constructor:\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/khalder/prod_stuff/latest_flair/flair/flair/trainers/trainer.py\", line 371, in train\r\n    loss = self.model.forward_loss(batch_step)\r\n  File \"/home/khalder/prod_stuff/latest_flair/flair/flair/models/text_classification_model.py\", line 793, in forward_loss\r\n    sentences = self._get_tars_formatted_sentences(data_points)\r\n  File \"/home/khalder/prod_stuff/latest_flair/flair/flair/models/text_classification_model.py\", line 735, in _get_tars_formatted_sentences\r\n    sampled_negative_labels = self._get_nearest_labels_for(positive_labels)\r\n  File \"/home/khalder/prod_stuff/latest_flair/flair/flair/models/text_classification_model.py\", line 708, in _get_nearest_labels_for\r\n    p=plausible_label_probabilities)\r\n  File \"mtrand.pyx\", line 924, in numpy.random.mtrand.RandomState.choice\r\nValueError: probabilities do not sum to 1\r\n```\r\n\r\n**Expected behavior**\r\nThe training should happen seamlessly.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1925/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1925/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1924", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1924/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1924/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1924/events", "html_url": "https://github.com/flairNLP/flair/issues/1924", "id": 732265134, "node_id": "MDU6SXNzdWU3MzIyNjUxMzQ=", "number": 1924, "title": "Error while executing tagger.predict() function.", "user": {"login": "Dhrupa-patel", "id": 23016214, "node_id": "MDQ6VXNlcjIzMDE2MjE0", "avatar_url": "https://avatars.githubusercontent.com/u/23016214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dhrupa-patel", "html_url": "https://github.com/Dhrupa-patel", "followers_url": "https://api.github.com/users/Dhrupa-patel/followers", "following_url": "https://api.github.com/users/Dhrupa-patel/following{/other_user}", "gists_url": "https://api.github.com/users/Dhrupa-patel/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dhrupa-patel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dhrupa-patel/subscriptions", "organizations_url": "https://api.github.com/users/Dhrupa-patel/orgs", "repos_url": "https://api.github.com/users/Dhrupa-patel/repos", "events_url": "https://api.github.com/users/Dhrupa-patel/events{/privacy}", "received_events_url": "https://api.github.com/users/Dhrupa-patel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2020-10-29T12:18:35Z", "updated_at": "2020-11-05T12:56:44Z", "closed_at": "2020-10-29T17:07:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "I was able to install flair successfully however when I tried to use tagger.predict() function it throw \"TypeError: Can't instantiate abstract class SentenceDataset with abstract methods is_in_memory\" error. When following the traceback call details I noticed that there is an issue with the execution of the typing.py file. Below I am pasting the executed run text.\r\n\r\n2020-10-29 17:09:20,015 loading file C:\\Users\\admin\\.flair\\models\\en-ner-conll03-v0.4.pt\r\nTraceback (most recent call last):\r\n  File \"C:/Users/admin/PycharmProjects/flairNLP/test.py\", line 6, in <module>\r\n    tagger.predict(sentence)\r\n  File \"C:\\Users\\admin\\PycharmProjects\\flairNLP\\venv\\lib\\site-packages\\flair\\models\\sequence_tagger_model.py\", line 343, in predict\r\n    dataset=SentenceDataset(reordered_sentences), batch_size=mini_batch_size\r\n  File \"C:\\Users\\admin\\AppData\\Local\\Programs\\Python\\Python36\\lib\\typing.py\", line 1249, in __new__\r\n    return _generic_new(cls.__next_in_mro__, cls, *args, **kwds)\r\n  File \"C:\\Users\\admin\\AppData\\Local\\Programs\\Python\\Python36\\lib\\typing.py\", line 1210, in _generic_new\r\n    return base_cls.__new__(cls)\r\nTypeError: Can't instantiate abstract class SentenceDataset with abstract methods is_in_memory\r\n\r\nFollowing was the code:\r\nfrom flair.models import SequenceTagger\r\nfrom flair.data import Sentence\r\n\r\ntagger = SequenceTagger.load('ner')\r\nsentence = Sentence('Giving a test run to the one of the latest NLP library- Flair')\r\ntagger.predict(sentence)\r\n\r\nprint(sentence.to_tagged_string())\r\n\r\nThe system on which this code is executed don't have GPU and I have installed pytorch libraries following command 'pip install torch==1.7.0+cpu torchvision==0.8.1+cpu torchaudio===0.7.0 -f https://download.pytorch.org/whl/torch_stable.html'\r\n\r\nKindly help me out and provide me a solution about how to get rid of this issue.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1924/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1924/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1920", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1920/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1920/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1920/events", "html_url": "https://github.com/flairNLP/flair/issues/1920", "id": 729014352, "node_id": "MDU6SXNzdWU3MjkwMTQzNTI=", "number": 1920, "title": "RuntimeError: CUDA out of memory. Tried to allocate. I have 4 GPUs.", "user": {"login": "jpainam", "id": 1701705, "node_id": "MDQ6VXNlcjE3MDE3MDU=", "avatar_url": "https://avatars.githubusercontent.com/u/1701705?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jpainam", "html_url": "https://github.com/jpainam", "followers_url": "https://api.github.com/users/jpainam/followers", "following_url": "https://api.github.com/users/jpainam/following{/other_user}", "gists_url": "https://api.github.com/users/jpainam/gists{/gist_id}", "starred_url": "https://api.github.com/users/jpainam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jpainam/subscriptions", "organizations_url": "https://api.github.com/users/jpainam/orgs", "repos_url": "https://api.github.com/users/jpainam/repos", "events_url": "https://api.github.com/users/jpainam/events{/privacy}", "received_events_url": "https://api.github.com/users/jpainam/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-10-25T12:51:20Z", "updated_at": "2021-03-28T05:58:10Z", "closed_at": "2021-03-28T05:58:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, I wrote this simple code\r\n```python\r\nembedding_types: List[TokenEmbeddings] = [\r\n    WordEmbeddings('glove'),\r\n    FlairEmbeddings('news-forward'),\r\n    FlairEmbeddings('news-backward'),\r\n]\r\ncolumns = {0: 'text', 2: 'pos'}\r\ndata_folder = 'data'\r\ncorpus: Corpus = ColumnCorpus(data_folder, columns,\r\n                              train_file='train.txt',\r\n                              test_file='test.txt',\r\n                              dev_file='dev.txt')\r\nprint(len(corpus.train))\r\nprint(len(corpus.test))\r\nprint(len(corpus.dev))\r\ntag_type = 'pos'\r\ntag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\nembeddings: StackedEmbeddings = StackedEmbeddings(embeddings=embedding_types)\r\nfrom flair.models import SequenceTagger\r\ntagger: SequenceTagger = SequenceTagger(hidden_size=2,\r\n                                        embeddings=embeddings,\r\n                                        tag_dictionary=tag_dictionary,\r\n                                        tag_type=tag_type)\r\nfrom flair.trainers import ModelTrainer\r\ntrainer: ModelTrainer = ModelTrainer(tagger, corpus)\r\ntrainer.train('resources/taggers',\r\n              mini_batch_size=8,\r\n              embeddings_storage_mode='gpu',\r\n              checkpoint=True,\r\n              monitor_train=False,\r\n              monitor_test=True,\r\n              train_with_dev=True,\r\n              max_epochs=50)\r\n```\r\nAnd I have almost 4 GPUs. So i don't understand why with all these, i still have this memory issue.\r\nAlso,i note that i have more than 400 trainig sample\r\n\r\n```python\r\n  File \"/home/fstu1/miniconda3/lib/python3.7/site-packages/flair/embeddings/base.py\", line 60, in embed\r\n    self._add_embeddings_internal(sentences)\r\n  File \"/home/fstu1/miniconda3/lib/python3.7/site-packages/flair/embeddings/token.py\", line 610, in _add_embeddings_internal\r\n    text_sentences, start_marker, end_marker, self.chars_per_chunk\r\n  File \"/home/fstu1/miniconda3/lib/python3.7/site-packages/flair/models/language_model.py\", line 157, in get_representation\r\n    _, rnn_output, hidden = self.forward(batch, hidden)\r\n  File \"/home/fstu1/miniconda3/lib/python3.7/site-packages/flair/models/language_model.py\", line 80, in forward\r\n    output, hidden = self.rnn(emb, hidden)\r\n  File \"/home/fstu1/miniconda3/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 550, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/fstu1/miniconda3/lib/python3.7/site-packages/torch/nn/modules/rnn.py\", line 570, in forward\r\n    self.dropout, self.training, self.bidirectional, self.batch_first)\r\nRuntimeError: CUDA out of memory. Tried to allocate 86.00 MiB (GPU 0; 11.92 GiB total capacity; 11.50 GiB already allocated; 81.25 MiB free; 11.53 GiB reserved in total by PyTorch)\r\n```", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1920/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1920/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1915", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1915/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1915/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1915/events", "html_url": "https://github.com/flairNLP/flair/issues/1915", "id": 725598097, "node_id": "MDU6SXNzdWU3MjU1OTgwOTc=", "number": 1915, "title": "DefaultCPUAllocator: can't allocate memory: Cannot allocate memory). Though I have GPUs", "user": {"login": "jpainam", "id": 1701705, "node_id": "MDQ6VXNlcjE3MDE3MDU=", "avatar_url": "https://avatars.githubusercontent.com/u/1701705?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jpainam", "html_url": "https://github.com/jpainam", "followers_url": "https://api.github.com/users/jpainam/followers", "following_url": "https://api.github.com/users/jpainam/following{/other_user}", "gists_url": "https://api.github.com/users/jpainam/gists{/gist_id}", "starred_url": "https://api.github.com/users/jpainam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jpainam/subscriptions", "organizations_url": "https://api.github.com/users/jpainam/orgs", "repos_url": "https://api.github.com/users/jpainam/repos", "events_url": "https://api.github.com/users/jpainam/events{/privacy}", "received_events_url": "https://api.github.com/users/jpainam/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-10-20T13:36:17Z", "updated_at": "2020-10-20T15:02:49Z", "closed_at": "2020-10-20T15:02:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, I'm using\r\n```\r\nflair: version 0.6.1\r\npytorch: version 1.5.1\r\n```\r\nAnd I have four GPUs. I could see one GPU being allocated but then, a few moment later, I get this error\r\n```python\r\n2020-10-20 20:55:51,765 Reading data from data\r\n2020-10-20 20:55:51,765 Train: data/train.txt\r\n2020-10-20 20:55:51,765 Dev: data/dev.txt\r\n2020-10-20 20:55:51,765 Test: data/test.txt\r\nDictionary with 248337 tags: <unk>, O, title=\"Alasiri\", id=\"1\">, sema, baada_ya, ona, umati, huo, ,, shtuka, na, hapo, mshtakiwa, wa_kwanza, amba, ndiye, fikishwa, mahakama, ambia, toa, pesa, la_sivyo, ua, ., , id=\"2\">, CUF, pitia, katibu_mkuu\r\nTraceback (most recent call last):\r\n  File \"train.py\", line 50, in <module>\r\n    tag_type=tag_type)\r\n  File \"/home/fstu1/miniconda3/lib/python3.7/site-packages/flair/models/sequence_tagger_model.py\", line 221, in __init__\r\n    torch.randn(self.tagset_size, self.tagset_size)\r\nRuntimeError: [enforce fail at CPUAllocator.cpp:64] . DefaultCPUAllocator: can't allocate memory: you tried to allocate 246685062276 bytes. Error code 12 (Cannot allocate memory)\r\n```\r\nI don't understand why it defaults to CPU again and tries to allocate 229GB :) that's too much allocation for a CPU\r\n\r\nAny helps will be appreciated. ", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1915/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1915/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1905", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1905/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1905/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1905/events", "html_url": "https://github.com/flairNLP/flair/issues/1905", "id": 718689560, "node_id": "MDU6SXNzdWU3MTg2ODk1NjA=", "number": 1905, "title": "AttributeError: 'NoneType' object has no attribute 'tokenize'", "user": {"login": "abhipn", "id": 47491248, "node_id": "MDQ6VXNlcjQ3NDkxMjQ4", "avatar_url": "https://avatars.githubusercontent.com/u/47491248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abhipn", "html_url": "https://github.com/abhipn", "followers_url": "https://api.github.com/users/abhipn/followers", "following_url": "https://api.github.com/users/abhipn/following{/other_user}", "gists_url": "https://api.github.com/users/abhipn/gists{/gist_id}", "starred_url": "https://api.github.com/users/abhipn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abhipn/subscriptions", "organizations_url": "https://api.github.com/users/abhipn/orgs", "repos_url": "https://api.github.com/users/abhipn/repos", "events_url": "https://api.github.com/users/abhipn/events{/privacy}", "received_events_url": "https://api.github.com/users/abhipn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2020-10-10T19:46:48Z", "updated_at": "2020-12-15T15:35:20Z", "closed_at": "2020-10-10T20:13:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have trained a model on another machine but when I try to load the trained model onto google colab I am getting, \r\n\r\nIt took almost 24 hours to train the model, is there any way I can fix this issue? I'm sure it is related to some dependency version mismatch but I just can't figure out which one?\r\n\r\n\r\nHere's my training  code,\r\n```\r\nembedding_types = [\r\n    TransformerWordEmbeddings('distilbert-base-cased', allow_long_sentences=True, fine_tune=True, batch_size=8),\r\n    FlairEmbeddings('news-forward-fast', fine_tune=True)\r\n]\r\n\r\nembeddings : StackedEmbeddings = StackedEmbeddings(\r\n                             embeddings=embedding_types)\r\n\r\ntrainer : ModelTrainer = ModelTrainer(tagger, corpus, torch.optim.Adam)\r\ntrainer.train('/taggers/flair-ner',\r\n              learning_rate=0.0001,\r\n              mini_batch_size=8,\r\n              max_epochs=100,\r\n              num_workers=4,\r\n              min_learning_rate=0.00001) \r\n```\r\n\r\nHere's the error,\r\n\r\n`\r\ntagger = SequenceTagger.load('models/flair/best-model.pt')`\r\n```\r\n---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-9-0fa565b989ff> in <module>\r\n----> 1 tagger.predict(Sentence(content))\r\n\r\n~/env/lib/python3.8/site-packages/flair/models/sequence_tagger_model.py in predict(self, sentences, mini_batch_size, all_tag_prob, verbose, label_name, return_loss, embedding_storage_mode)\r\n    367                     continue\r\n    368 \r\n--> 369                 feature = self.forward(batch)\r\n    370 \r\n    371                 if return_loss:\r\n\r\n~/env/lib/python3.8/site-packages/flair/models/sequence_tagger_model.py in forward(self, sentences)\r\n    606     def forward(self, sentences: List[Sentence]):\r\n    607 \r\n--> 608         self.embeddings.embed(sentences)\r\n    609 \r\n    610         names = self.embeddings.get_names()\r\n\r\n~/env/lib/python3.8/site-packages/flair/embeddings/token.py in embed(self, sentences, static_embeddings)\r\n     69 \r\n     70         for embedding in self.embeddings:\r\n---> 71             embedding.embed(sentences)\r\n     72 \r\n     73     @property\r\n\r\n~/env/lib/python3.8/site-packages/flair/embeddings/base.py in embed(self, sentences)\r\n     58 \r\n     59         if not everything_embedded or not self.static_embeddings:\r\n---> 60             self._add_embeddings_internal(sentences)\r\n     61 \r\n     62         return sentences\r\n\r\n~/env/lib/python3.8/site-packages/flair/embeddings/token.py in _add_embeddings_internal(self, sentences)\r\n    857         # embed each micro-batch\r\n    858         for batch in sentence_batches:\r\n--> 859             self._add_embeddings_to_sentences(batch)\r\n    860 \r\n    861         return sentences\r\n\r\n~/env/lib/python3.8/site-packages/flair/embeddings/token.py in _add_embeddings_to_sentences(self, sentences)\r\n    906             # method 2:\r\n    907             # transformer specific tokenization\r\n--> 908             subtokenized_sentence = self.tokenizer.tokenize(tokenized_string)\r\n    909             if len(subtokenized_sentence) == 0:\r\n    910                 empty_sentences.append(sentence)\r\n\r\nAttributeError: 'NoneType' object has no attribute 'tokenize'\r\n```", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1905/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1905/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1902", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1902/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1902/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1902/events", "html_url": "https://github.com/flairNLP/flair/issues/1902", "id": 717281517, "node_id": "MDU6SXNzdWU3MTcyODE1MTc=", "number": 1902, "title": "NER predictions on long texts incorrect for models trained using BERT and transformers version 3", "user": {"login": "schelv", "id": 13403863, "node_id": "MDQ6VXNlcjEzNDAzODYz", "avatar_url": "https://avatars.githubusercontent.com/u/13403863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/schelv", "html_url": "https://github.com/schelv", "followers_url": "https://api.github.com/users/schelv/followers", "following_url": "https://api.github.com/users/schelv/following{/other_user}", "gists_url": "https://api.github.com/users/schelv/gists{/gist_id}", "starred_url": "https://api.github.com/users/schelv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/schelv/subscriptions", "organizations_url": "https://api.github.com/users/schelv/orgs", "repos_url": "https://api.github.com/users/schelv/repos", "events_url": "https://api.github.com/users/schelv/events{/privacy}", "received_events_url": "https://api.github.com/users/schelv/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-10-08T12:01:23Z", "updated_at": "2021-03-09T15:16:58Z", "closed_at": "2021-03-09T15:16:58Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nFor long texts only the NER predictions on the first part of the text make sense. (maybe it is the 512 token boundary?? (I didn't count =P)). This happens when the model is trained using transformers version 3.  When using flair with transformers version 2 and loading a model trained with v. 2. the output is correct.\r\n\r\nedit: apparently it happens for transformers version > 3.0.0\r\n\r\n**To Reproduce**\r\nThis behavior happens for NER models I trained with transformers v3.  But it happens also when downloading a pretrained NER model (e.g. \"nl-ner\"). \r\n\r\n**Environment:**\r\n - flair version does not seem to matter 0.5.1, 0.6.1 output is the same\r\n- transformers 3.*\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1902/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1902/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1898", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1898/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1898/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1898/events", "html_url": "https://github.com/flairNLP/flair/issues/1898", "id": 716477946, "node_id": "MDU6SXNzdWU3MTY0Nzc5NDY=", "number": 1898, "title": "BPEmbeddings with sequence tagger", "user": {"login": "UrszulaCzerwinska", "id": 3660462, "node_id": "MDQ6VXNlcjM2NjA0NjI=", "avatar_url": "https://avatars.githubusercontent.com/u/3660462?v=4", "gravatar_id": "", "url": "https://api.github.com/users/UrszulaCzerwinska", "html_url": "https://github.com/UrszulaCzerwinska", "followers_url": "https://api.github.com/users/UrszulaCzerwinska/followers", "following_url": "https://api.github.com/users/UrszulaCzerwinska/following{/other_user}", "gists_url": "https://api.github.com/users/UrszulaCzerwinska/gists{/gist_id}", "starred_url": "https://api.github.com/users/UrszulaCzerwinska/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/UrszulaCzerwinska/subscriptions", "organizations_url": "https://api.github.com/users/UrszulaCzerwinska/orgs", "repos_url": "https://api.github.com/users/UrszulaCzerwinska/repos", "events_url": "https://api.github.com/users/UrszulaCzerwinska/events{/privacy}", "received_events_url": "https://api.github.com/users/UrszulaCzerwinska/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-10-07T12:18:38Z", "updated_at": "2021-05-15T22:42:13Z", "closed_at": "2021-05-15T22:42:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhile running sequence tagger with stacked embeddings: bytePairEmbeddings and Flair embeddings, an error occurs:\r\n\r\n```bash\r\n>>>CUDA_VISIBLE_DEVICES=1 python train_seq_tagger.py\r\n\r\nPyTorch version 1.3.1 available.\r\nTensorFlow version 2.0.0 available.\r\n2020-10-07 11:58:39,499 Reading data from data\r\n2020-10-07 11:58:39,499 Train: data/train.txt\r\n2020-10-07 11:58:39,499 Dev: data/dev.txt\r\n2020-10-07 11:58:39,500 Test: data/test.txt\r\n2020-10-07 12:00:20,735 ----------------------------------------------------------------------------------------------------\r\n2020-10-07 12:00:20,736 Model: \"SequenceTagger(\r\n  (embeddings): StackedEmbeddings(\r\n    (list_embedding_0): FlairEmbeddings(\r\n      (lm): LanguageModel(\r\n        (drop): Dropout(p=0.5, inplace=False)\r\n        (encoder): Embedding(275, 100)\r\n        (rnn): LSTM(100, 1024)\r\n        (decoder): Linear(in_features=1024, out_features=275, bias=True)\r\n      )\r\n    )\r\n    (list_embedding_1): FlairEmbeddings(\r\n      (lm): LanguageModel(\r\n        (drop): Dropout(p=0.5, inplace=False)\r\n        (encoder): Embedding(275, 100)\r\n        (rnn): LSTM(100, 1024)\r\n        (decoder): Linear(in_features=1024, out_features=275, bias=True)\r\n      )\r\n    )\r\n    (list_embedding_2): BytePairEmbeddings(model=2-bpe-custom-100000-200)\r\n  )\r\n  (word_dropout): WordDropout(p=0.05)\r\n  (locked_dropout): LockedDropout(p=0.5)\r\n  (embedding2nn): Linear(in_features=2448, out_features=2448, bias=True)\r\n  (rnn): LSTM(2448, 256, num_layers=2, batch_first=True, dropout=0.5, bidirectional=True)\r\n  (linear): Linear(in_features=512, out_features=47, bias=True)\r\n  (beta): 1.0\r\n  (weights): None\r\n  (weight_tensor) None\r\n)\"\r\n2020-10-07 12:00:20,736 ----------------------------------------------------------------------------------------------------\r\n2020-10-07 12:00:20,736 Corpus: \"Corpus: 183145 train + 24944 dev + 21721 test sentences\"\r\n2020-10-07 12:00:20,736 ----------------------------------------------------------------------------------------------------\r\n2020-10-07 12:00:20,737 Parameters:\r\n2020-10-07 12:00:20,737  - learning_rate: \"0.1\"\r\n2020-10-07 12:00:20,737  - mini_batch_size: \"32\"\r\n2020-10-07 12:00:20,737  - patience: \"2\"\r\n2020-10-07 12:00:20,737  - anneal_factor: \"0.5\"\r\n2020-10-07 12:00:20,737  - max_epochs: \"100\"\r\n2020-10-07 12:00:20,737  - shuffle: \"True\"\r\n2020-10-07 12:00:20,737  - train_with_dev: \"False\"\r\n2020-10-07 12:00:20,737  - batch_growth_annealing: \"False\"\r\n2020-10-07 12:00:20,737 ----------------------------------------------------------------------------------------------------\r\n2020-10-07 12:00:20,737 Model training base path: \"outputs/models/bpemb_flair\"\r\n2020-10-07 12:00:20,737 ----------------------------------------------------------------------------------------------------\r\n2020-10-07 12:00:20,738 Device: cuda:0\r\n2020-10-07 12:00:20,738 ----------------------------------------------------------------------------------------------------\r\n2020-10-07 12:00:20,738 Embeddings storage mode: gpu\r\nSelected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.\r\n\r\nDefaults for this optimization level are:\r\nenabled                : True\r\nopt_level              : O1\r\ncast_model_type        : None\r\npatch_torch_functions  : True\r\nkeep_batchnorm_fp32    : None\r\nmaster_weights         : None\r\nloss_scale             : dynamic\r\nProcessing user overrides (additional kwargs that are not None)...\r\nAfter processing overrides, optimization options are:\r\nenabled                : True\r\nopt_level              : O1\r\ncast_model_type        : None\r\npatch_torch_functions  : True\r\nkeep_batchnorm_fp32    : None\r\nmaster_weights         : None\r\nloss_scale             : dynamic\r\n2020-10-07 12:00:20,744 ----------------------------------------------------------------------------------------------------\r\nGradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0\r\nGradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0\r\nGradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0\r\nGradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0\r\nGradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 2048.0\r\n2020-10-07 12:05:33,604 epoch 1 - iter 572/5724 - loss 3.94088415 - samples/sec: 58.52 - lr: 0.100000\r\nTraceback (most recent call last):\r\n  File \"train_seq_tagger.py\", line 104, in <module>\r\n    trainer.train(**params[\"train\"])\r\n  File \"/home/ccass/anaconda3/lib/python3.7/site-packages/flair/trainers/trainer.py\", line 371, in train\r\n    loss = self.model.forward_loss(batch_step)\r\n  File \"/home/ccass/anaconda3/lib/python3.7/site-packages/flair/models/sequence_tagger_model.py\", line 603, in forward_loss\r\n    features = self.forward(data_points)\r\n  File \"/home/ccass/anaconda3/lib/python3.7/site-packages/flair/models/sequence_tagger_model.py\", line 608, in forward\r\n    self.embeddings.embed(sentences)\r\n  File \"/home/ccass/anaconda3/lib/python3.7/site-packages/flair/embeddings/token.py\", line 71, in embed\r\n    embedding.embed(sentences)\r\n  File \"/home/ccass/anaconda3/lib/python3.7/site-packages/flair/embeddings/base.py\", line 60, in embed\r\n    self._add_embeddings_internal(sentences)\r\n  File \"/home/ccass/anaconda3/lib/python3.7/site-packages/flair/embeddings/token.py\", line 1580, in _add_embeddings_internal\r\n    (embeddings[0], embeddings[len(embeddings) - 1])\r\nIndexError: index 0 is out of bounds for axis 0 with size 0\r\nERROR: CUDA_VISIBLE_DEVICES=1 python train_seq_tagger.py, exited with 1\r\n```\r\n\r\n**To Reproduce**\r\nRun the sequence tagger trainer with stacked flair embeddings and custom bpembeddings\r\n\r\n**Expected behavior**\r\nTraining sequence tagger\r\n\r\n\r\n\r\n**Environment (please complete the following information):**\r\n- Flair version:  @ git+https://github.com/flairNLP/flair.git@d75b82bc6a33f4655c46f0e19d09ee5f2c24c93d\r\n- Platform: Linux-5.3.0-28-generic-x86_64-with-debian-buster-sid\r\n- Python version: 3.7.3\r\n- PyTorch version (GPU?): 1.3.1 (True)\r\n- Tensorflow version (GPU?): 2.0.0 (False)\r\n- Using GPU in script?: True\r\n- Using distributed or parallel set-up in script?: No\r\n\r\n**Additional context**\r\n\r\n* Used vectors work correctly with \r\n```python\r\nfrom flair.embeddings import BytePairEmbeddings\r\nembedding = BytePairEmbeddings(model_file_path='./m.model', embedding_file_path='bpemb-vocab100k-dim200.w2v')\r\nfrom flair.data import Sentence\r\n# create a sentence\r\nsentence = Sentence('M. Tutu a \u00e9t\u00e9 pr\u00e9sent le 31 octobre 2020 \u00e0 la s\u00e9ance de yoga.')\r\n\r\n# embed words in sentence\r\nembedding.embed(sentence)\r\n```\r\n* The code for sequence tagger was previously tested with other embeddings (fasttext) and worked correctly.\r\n* Applying the same code with BytePairEmbeddings(language='fr') does not throws any error.\r\n\r\nWhat can be wrong with the tuned bpemdeddings?\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1898/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1898/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1894", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1894/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1894/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1894/events", "html_url": "https://github.com/flairNLP/flair/issues/1894", "id": 712206810, "node_id": "MDU6SXNzdWU3MTIyMDY4MTA=", "number": 1894, "title": "update requirements.txt to mpld3 0.5.1", "user": {"login": "itamarjp", "id": 762712, "node_id": "MDQ6VXNlcjc2MjcxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/762712?v=4", "gravatar_id": "", "url": "https://api.github.com/users/itamarjp", "html_url": "https://github.com/itamarjp", "followers_url": "https://api.github.com/users/itamarjp/followers", "following_url": "https://api.github.com/users/itamarjp/following{/other_user}", "gists_url": "https://api.github.com/users/itamarjp/gists{/gist_id}", "starred_url": "https://api.github.com/users/itamarjp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/itamarjp/subscriptions", "organizations_url": "https://api.github.com/users/itamarjp/orgs", "repos_url": "https://api.github.com/users/itamarjp/repos", "events_url": "https://api.github.com/users/itamarjp/events{/privacy}", "received_events_url": "https://api.github.com/users/itamarjp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-09-30T19:10:58Z", "updated_at": "2021-02-04T22:55:49Z", "closed_at": "2021-02-04T22:55:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "https://pypi.org/project/mpld3/\r\n\r\nupdate requirements.txt to mpld3 0.5.1\r\n\r\n\r\nmpld3==0.3\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1894/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1894/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1890", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1890/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1890/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1890/events", "html_url": "https://github.com/flairNLP/flair/issues/1890", "id": 710082340, "node_id": "MDU6SXNzdWU3MTAwODIzNDA=", "number": 1890, "title": " 'Semantic Frame Detection' on Windows: cannot instantiate 'PosixPath'", "user": {"login": "christophelebrun", "id": 50588617, "node_id": "MDQ6VXNlcjUwNTg4NjE3", "avatar_url": "https://avatars.githubusercontent.com/u/50588617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/christophelebrun", "html_url": "https://github.com/christophelebrun", "followers_url": "https://api.github.com/users/christophelebrun/followers", "following_url": "https://api.github.com/users/christophelebrun/following{/other_user}", "gists_url": "https://api.github.com/users/christophelebrun/gists{/gist_id}", "starred_url": "https://api.github.com/users/christophelebrun/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/christophelebrun/subscriptions", "organizations_url": "https://api.github.com/users/christophelebrun/orgs", "repos_url": "https://api.github.com/users/christophelebrun/repos", "events_url": "https://api.github.com/users/christophelebrun/events{/privacy}", "received_events_url": "https://api.github.com/users/christophelebrun/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-09-28T09:02:43Z", "updated_at": "2021-02-02T13:48:21Z", "closed_at": "2021-02-02T13:48:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "When trying to run the experimental 'Semantic Frame Detection' on Windows, I get the following error:\r\n\r\n`NotImplementedError: cannot instantiate 'PosixPath' on your system`\r\n\r\nI guess this experimental model is not compatible with Windows OS.\r\n\r\nHere is the full traceback:\r\n```\r\n---------------------------------------------------------------------------\r\nNotImplementedError                       Traceback (most recent call last)\r\n<ipython-input-40-bc009a1276fd> in <module>\r\n      1 # load model\r\n----> 2 tagger = SequenceTagger.load('frame')\r\n      3 \r\n      4 # make English sentence\r\n      5 sentence_1 = Sentence('George returned to Berlin to return his hat .')\r\n\r\n~\\Anaconda3\\envs\\GOES_AttributesExtraction\\lib\\site-packages\\flair\\nn.py in load(cls, model)\r\n     86             # see https://github.com/zalandoresearch/flair/issues/351\r\n     87             f = file_utils.load_big_file(str(model_file))\r\n---> 88             state = torch.load(f, map_location='cpu')\r\n     89 \r\n     90         model = cls._init_model_with_state_dict(state)\r\n\r\n~\\Anaconda3\\envs\\GOES_AttributesExtraction\\lib\\site-packages\\torch\\serialization.py in load(f, map_location, pickle_module, **pickle_load_args)\r\n    583                     return torch.jit.load(opened_file)\r\n    584                 return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)\r\n--> 585         return _legacy_load(opened_file, map_location, pickle_module, **pickle_load_args)\r\n    586 \r\n    587 \r\n\r\n~\\Anaconda3\\envs\\GOES_AttributesExtraction\\lib\\site-packages\\torch\\serialization.py in _legacy_load(f, map_location, pickle_module, **pickle_load_args)\r\n    763     unpickler = pickle_module.Unpickler(f, **pickle_load_args)\r\n    764     unpickler.persistent_load = persistent_load\r\n--> 765     result = unpickler.load()\r\n    766 \r\n    767     deserialized_storage_keys = pickle_module.load(f, **pickle_load_args)\r\n\r\n~\\Anaconda3\\envs\\GOES_AttributesExtraction\\lib\\pathlib.py in __new__(cls, *args, **kwargs)\r\n   1038         self = cls._from_parts(args, init=False)\r\n   1039         if not self._flavour.is_supported:\r\n-> 1040             raise NotImplementedError(\"cannot instantiate %r on your system\"\r\n   1041                                       % (cls.__name__,))\r\n   1042         self._init()\r\n\r\nNotImplementedError: cannot instantiate 'PosixPath' on your system\r\n```", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1890/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1890/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1889", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1889/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1889/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1889/events", "html_url": "https://github.com/flairNLP/flair/issues/1889", "id": 709867204, "node_id": "MDU6SXNzdWU3MDk4NjcyMDQ=", "number": 1889, "title": "Status code 301 when loading model", "user": {"login": "inyukwo1", "id": 18697844, "node_id": "MDQ6VXNlcjE4Njk3ODQ0", "avatar_url": "https://avatars.githubusercontent.com/u/18697844?v=4", "gravatar_id": "", "url": "https://api.github.com/users/inyukwo1", "html_url": "https://github.com/inyukwo1", "followers_url": "https://api.github.com/users/inyukwo1/followers", "following_url": "https://api.github.com/users/inyukwo1/following{/other_user}", "gists_url": "https://api.github.com/users/inyukwo1/gists{/gist_id}", "starred_url": "https://api.github.com/users/inyukwo1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/inyukwo1/subscriptions", "organizations_url": "https://api.github.com/users/inyukwo1/orgs", "repos_url": "https://api.github.com/users/inyukwo1/repos", "events_url": "https://api.github.com/users/inyukwo1/events{/privacy}", "received_events_url": "https://api.github.com/users/inyukwo1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-09-28T01:33:00Z", "updated_at": "2020-10-01T13:04:49Z", "closed_at": "2020-10-01T13:04:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI got status code 301 when I load ner model.\r\n\r\n**To Reproduce**\r\n```\r\nfrom flair.models import SequenceTagger\r\ntagger: SequenceTagger = SequenceTagger.load(\"ner\")\r\n```\r\n\r\n**Screenshots**\r\n![image](https://user-images.githubusercontent.com/18697844/94381912-d61da300-0175-11eb-9564-b2ba773c5fa9.png)\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Ubuntu 16.04\r\n - Version [e.g. flair-0.3.2]: flair-0.6.1\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1889/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1889/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1879", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1879/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1879/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1879/events", "html_url": "https://github.com/flairNLP/flair/issues/1879", "id": 706171885, "node_id": "MDU6SXNzdWU3MDYxNzE4ODU=", "number": 1879, "title": "Error loading Transformers embeddings after first iteration", "user": {"login": "alejandrojcastaneira", "id": 42115387, "node_id": "MDQ6VXNlcjQyMTE1Mzg3", "avatar_url": "https://avatars.githubusercontent.com/u/42115387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alejandrojcastaneira", "html_url": "https://github.com/alejandrojcastaneira", "followers_url": "https://api.github.com/users/alejandrojcastaneira/followers", "following_url": "https://api.github.com/users/alejandrojcastaneira/following{/other_user}", "gists_url": "https://api.github.com/users/alejandrojcastaneira/gists{/gist_id}", "starred_url": "https://api.github.com/users/alejandrojcastaneira/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alejandrojcastaneira/subscriptions", "organizations_url": "https://api.github.com/users/alejandrojcastaneira/orgs", "repos_url": "https://api.github.com/users/alejandrojcastaneira/repos", "events_url": "https://api.github.com/users/alejandrojcastaneira/events{/privacy}", "received_events_url": "https://api.github.com/users/alejandrojcastaneira/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2020-09-22T08:15:57Z", "updated_at": "2021-06-18T12:33:42Z", "closed_at": "2021-06-18T12:33:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello, \r\n\r\nI would like to train a model to do NER in a Chinese corpurs. \r\n\r\nCurrently, I am using these embeddings:\r\n\r\n```\r\n[    BytePairEmbeddings(language=\"zh\", dim=300, syllables=200000),\r\n\r\n    TransformerWordEmbeddings('bert-base-chinese',  allow_long_sentences=True, fine_tune=True)]\r\n```\r\n\r\nIt trains good during the first iteration, but I'm getting this before starting the second one.\r\n```\r\n\r\n    pickler.dump(obj)\r\n_pickle.PicklingError: Can't pickle <function gelu at 0x7f8fc5a223b0>: it's not the same object as torch.nn.functional.gelu\r\n```\r\nI updated torch to 1.6.0, transformers to 3.1.0 and flair to 0.6.\r\n\r\nThanks for the great work! in the library.\r\n\r\nBest regards\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1879/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1879/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1874", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1874/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1874/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1874/events", "html_url": "https://github.com/flairNLP/flair/issues/1874", "id": 705768619, "node_id": "MDU6SXNzdWU3MDU3Njg2MTk=", "number": 1874, "title": "BIOMEDICAL DATASETS: UnicodeDecodeError: Error loading several biomedical datasets", "user": {"login": "datasri", "id": 8376691, "node_id": "MDQ6VXNlcjgzNzY2OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/8376691?v=4", "gravatar_id": "", "url": "https://api.github.com/users/datasri", "html_url": "https://github.com/datasri", "followers_url": "https://api.github.com/users/datasri/followers", "following_url": "https://api.github.com/users/datasri/following{/other_user}", "gists_url": "https://api.github.com/users/datasri/gists{/gist_id}", "starred_url": "https://api.github.com/users/datasri/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/datasri/subscriptions", "organizations_url": "https://api.github.com/users/datasri/orgs", "repos_url": "https://api.github.com/users/datasri/repos", "events_url": "https://api.github.com/users/datasri/events{/privacy}", "received_events_url": "https://api.github.com/users/datasri/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "leonweber", "id": 6436442, "node_id": "MDQ6VXNlcjY0MzY0NDI=", "avatar_url": "https://avatars.githubusercontent.com/u/6436442?v=4", "gravatar_id": "", "url": "https://api.github.com/users/leonweber", "html_url": "https://github.com/leonweber", "followers_url": "https://api.github.com/users/leonweber/followers", "following_url": "https://api.github.com/users/leonweber/following{/other_user}", "gists_url": "https://api.github.com/users/leonweber/gists{/gist_id}", "starred_url": "https://api.github.com/users/leonweber/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/leonweber/subscriptions", "organizations_url": "https://api.github.com/users/leonweber/orgs", "repos_url": "https://api.github.com/users/leonweber/repos", "events_url": "https://api.github.com/users/leonweber/events{/privacy}", "received_events_url": "https://api.github.com/users/leonweber/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "leonweber", "id": 6436442, "node_id": "MDQ6VXNlcjY0MzY0NDI=", "avatar_url": "https://avatars.githubusercontent.com/u/6436442?v=4", "gravatar_id": "", "url": "https://api.github.com/users/leonweber", "html_url": "https://github.com/leonweber", "followers_url": "https://api.github.com/users/leonweber/followers", "following_url": "https://api.github.com/users/leonweber/following{/other_user}", "gists_url": "https://api.github.com/users/leonweber/gists{/gist_id}", "starred_url": "https://api.github.com/users/leonweber/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/leonweber/subscriptions", "organizations_url": "https://api.github.com/users/leonweber/orgs", "repos_url": "https://api.github.com/users/leonweber/repos", "events_url": "https://api.github.com/users/leonweber/events{/privacy}", "received_events_url": "https://api.github.com/users/leonweber/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-09-21T17:02:14Z", "updated_at": "2020-10-07T08:57:48Z", "closed_at": "2020-10-07T08:57:48Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n---------------------------------------------------------------------------\r\nUnicodeDecodeError: 'charmap' codec can't decode byte 0x9d in position 5851: character maps to <undefined>\r\n\r\nThis is a Unicode error that occurs when loading biomedical datasets. I have the following error when trying to load HUNER_CHEMICAL_CEMP(). \r\n\r\n**To Reproduce**\r\nfrom flair.datasets import HUNER_CHEMICAL_CEMP\r\ncorpus = HUNER_CHEMICAL_CEMP()\r\n\r\n**Expected behavior**\r\nCorpus should load properly.\r\n\r\n**Screenshots**\r\n--------------------------------------------------------------------------\r\nUnicodeDecodeError                        Traceback (most recent call last)\r\n<ipython-input-1-33d42c5cb73e> in <module>\r\n      2 # # # 1. get all corpora for a specific entity type\r\n      3 # # from flair.models import SequenceTagger\r\n----> 4 corpus = HUNER_CHEMICAL_CEMP()\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\envs\\fgpu\\lib\\site-packages\\flair\\datasets\\biomedical.py in __init__(self, *args, **kwargs)\r\n   3999 \r\n   4000     def __init__(self, *args, **kwargs):\r\n-> 4001         super().__init__(*args, **kwargs)\r\n   4002 \r\n   4003     @staticmethod\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\envs\\fgpu\\lib\\site-packages\\flair\\datasets\\biomedical.py in __init__(self, base_path, in_memory, sentence_splitter)\r\n    522 \r\n    523             writer = CoNLLWriter(sentence_splitter=self.sentence_splitter)\r\n--> 524             internal_dataset = self.to_internal(data_folder)\r\n    525 \r\n    526             train_data = self.get_subset(internal_dataset, \"train\", splits_dir)\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\envs\\fgpu\\lib\\site-packages\\flair\\datasets\\biomedical.py in to_internal(self, data_dir)\r\n   4009         train_text_file = train_folder / \"chemdner_patents_train_text.txt\"\r\n   4010         train_ann_file = train_folder / \"chemdner_cemp_gold_standard_train.tsv\"\r\n-> 4011         train_data = CEMP.parse_input_file(train_text_file, train_ann_file)\r\n   4012 \r\n   4013         dev_folder = CEMP.download_dev_corpus(data_dir)\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\envs\\fgpu\\lib\\site-packages\\flair\\datasets\\biomedical.py in parse_input_file(text_file, ann_file)\r\n   3956 \r\n   3957         with open(str(text_file), \"r\") as text_reader:\r\n-> 3958             for line in text_reader:\r\n   3959                 if not line:\r\n   3960                     continue\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\envs\\fgpu\\lib\\encodings\\cp1252.py in decode(self, input, final)\r\n     21 class IncrementalDecoder(codecs.IncrementalDecoder):\r\n     22     def decode(self, input, final=False):\r\n---> 23         return codecs.charmap_decode(input,self.errors,decoding_table)[0]\r\n     24 \r\n     25 class StreamWriter(Codec,codecs.StreamWriter):\r\n\r\nUnicodeDecodeError: 'charmap' codec can't decode byte 0x9d in position 5851: character maps to <undefined>\r\n\r\n**Environment (please complete the following information):**\r\n---------------------------------------------------------------------------\r\n - OS [Windows]:\r\n - Version [e.g. flair-0.6]:\r\n\r\n**Additional context**\r\n---------------------------------------------------------------------------\r\nInfact, except for HUNER_CHEMICAL_CDR(), HUNER_DISEASE_CDR(), HUNER_DISEASE_NCBI(), HUNER_DISEASE_SCAI(), \r\nI am getting similar Unicode Error when loading all other chemical (HUNER_CHEMICAL_CEMP(), HUNER_CHEMICAL_CHEBI(), HUNER_CHEMICAL_CHEMDNER(), HUNER_CHEMICAL_SCAI()) and disease (HUNER_DISEASE_MIRNA(), HUNER_DISEASE_VARIOME()) datasets.\r\n\r\n** Similar error occurs when loading datasets as shown below.\r\nfrom flair.datasets import CEMP\r\ncorpus = CEMP()\r\n### dataset name can be replaced with any other datasets mentioned above and similar Unicode error occurs.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1874/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1874/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1861", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1861/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1861/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1861/events", "html_url": "https://github.com/flairNLP/flair/issues/1861", "id": 700561580, "node_id": "MDU6SXNzdWU3MDA1NjE1ODA=", "number": 1861, "title": "NER column corpus with custom delimiter doesn't work properly", "user": {"login": "aragaer", "id": 53614, "node_id": "MDQ6VXNlcjUzNjE0", "avatar_url": "https://avatars.githubusercontent.com/u/53614?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aragaer", "html_url": "https://github.com/aragaer", "followers_url": "https://api.github.com/users/aragaer/followers", "following_url": "https://api.github.com/users/aragaer/following{/other_user}", "gists_url": "https://api.github.com/users/aragaer/gists{/gist_id}", "starred_url": "https://api.github.com/users/aragaer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aragaer/subscriptions", "organizations_url": "https://api.github.com/users/aragaer/orgs", "repos_url": "https://api.github.com/users/aragaer/repos", "events_url": "https://api.github.com/users/aragaer/events{/privacy}", "received_events_url": "https://api.github.com/users/aragaer/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-09-13T12:32:39Z", "updated_at": "2020-09-21T19:24:28Z", "closed_at": "2020-09-21T19:24:28Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhen using custom column delimiter for CoNLL format, the newline character is taken as a part of a tag.\r\n\r\n**To Reproduce**\r\nCreate a CoNLL file, load setting column_delimiter, check loaded tags. Tags are 'O\\n', 'B-something\\n' and 'I-something\\n'\r\n\r\n**Expected behavior**\r\nTags should be 'O', 'B-something' or 'I-something'.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1861/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1861/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1858", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1858/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1858/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1858/events", "html_url": "https://github.com/flairNLP/flair/issues/1858", "id": 697956247, "node_id": "MDU6SXNzdWU2OTc5NTYyNDc=", "number": 1858, "title": "Since New Version 0.6 \"ERROR! Session/line number was not unique in database. History logging moved to new session 2\" ", "user": {"login": "DanHo93", "id": 24986867, "node_id": "MDQ6VXNlcjI0OTg2ODY3", "avatar_url": "https://avatars.githubusercontent.com/u/24986867?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DanHo93", "html_url": "https://github.com/DanHo93", "followers_url": "https://api.github.com/users/DanHo93/followers", "following_url": "https://api.github.com/users/DanHo93/following{/other_user}", "gists_url": "https://api.github.com/users/DanHo93/gists{/gist_id}", "starred_url": "https://api.github.com/users/DanHo93/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DanHo93/subscriptions", "organizations_url": "https://api.github.com/users/DanHo93/orgs", "repos_url": "https://api.github.com/users/DanHo93/repos", "events_url": "https://api.github.com/users/DanHo93/events{/privacy}", "received_events_url": "https://api.github.com/users/DanHo93/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-09-10T13:23:26Z", "updated_at": "2021-01-15T14:53:24Z", "closed_at": "2021-01-15T14:53:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "Since the new Update 0.6 i have this Error:\r\n\"ERROR! Session/line number was not unique in database. History logging moved to new session 2\" \r\n\r\nI'm using flair on a Kaggle.com notebook\r\nThe confusing thing is that in the line where the Error appears first there is no functionality from Flair.\r\nBut what i can say, the code was running on the 0.5 version of flair.\r\nI would run it on the old version but in the old version i can't load the embeddings anymore.\r\n\r\n\r\nThanks for your help\r\n\r\n`filename = \"../input/train-data/train_data.json\"\r\n\r\nwith open(filename,'r', encoding='utf8') as infile:\r\n    example_data = json.load(infile)\r\n\r\n\r\nfor i,(k,v) in enumerate(example_data.items()):\r\n    tokens = v.get('tokens')\r\n    tokens = [token.lower() for token in tokens]\r\n    example_data[k]['tokens'] = tokens\r\n    \r\nall_tokens = [v['tokens'] for k,v in example_data.items()]\r\nall_labels = [v['labels'] for k,v in example_data.items()]`\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1858/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1858/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1853", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1853/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1853/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1853/events", "html_url": "https://github.com/flairNLP/flair/issues/1853", "id": 695129860, "node_id": "MDU6SXNzdWU2OTUxMjk4NjA=", "number": 1853, "title": "Error on loading pretrained model for prediction", "user": {"login": "airkangoo", "id": 7011082, "node_id": "MDQ6VXNlcjcwMTEwODI=", "avatar_url": "https://avatars.githubusercontent.com/u/7011082?v=4", "gravatar_id": "", "url": "https://api.github.com/users/airkangoo", "html_url": "https://github.com/airkangoo", "followers_url": "https://api.github.com/users/airkangoo/followers", "following_url": "https://api.github.com/users/airkangoo/following{/other_user}", "gists_url": "https://api.github.com/users/airkangoo/gists{/gist_id}", "starred_url": "https://api.github.com/users/airkangoo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/airkangoo/subscriptions", "organizations_url": "https://api.github.com/users/airkangoo/orgs", "repos_url": "https://api.github.com/users/airkangoo/repos", "events_url": "https://api.github.com/users/airkangoo/events{/privacy}", "received_events_url": "https://api.github.com/users/airkangoo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-09-07T13:58:11Z", "updated_at": "2020-09-09T06:30:49Z", "closed_at": "2020-09-09T06:30:48Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\ni finetuned a pretrained model and used it for a classification task (based on your tutorial). It works fine and in the end it saves the best-model.pt. \r\n\r\n```\r\ndata_folder = 'path-to-corpus'\r\ncorpus = ClassificationCorpus(data_folder,  test_file='test.csv', dev_file='dev.csv', train_file='train.csv')\r\ndocument_embeddings = DocumentLSTMEmbeddings( word_embeddings, hidden_size=512, \r\n      reproject_words=True, \r\n      reproject_words_dimension=256\r\n      )\r\nclassifier = TextClassifier(document_embeddings, label_dictionary=corpus.make_label_dictionary(), multi_label = False )\r\ntrainer = ModelTrainer(classifier, corpus)\r\ntrainer.train(data_folder, max_epochs=150)\r\n```\r\n\r\nWhen i try to load the model later for prediction using \r\n\r\n`classifier = TextClassifier.load('path-to/best-model.pt')`\r\n\r\ni get an error\r\n\r\n```\r\nKeyError                                  Traceback (most recent call last)\r\n<ipython-input-33-7a29299bcb06> in <module>()\r\n      1 _ = TransformerWordEmbeddings('path-to/DistilBERT-finetuned')\r\n----> 2 classifier = TextClassifier.load('path-to/best-model.pt')\r\n      3 classifier.parameters\r\n\r\n1 frames\r\n/usr/local/lib/python3.6/dist-packages/flair/models/text_classification_model.py in _init_model_with_state_dict(state)\r\n    129 \r\n    130         model = TextClassifier(\r\n--> 131             document_embeddings=state[\"document_embeddings\"],\r\n    132             label_dictionary=state[\"label_dictionary\"],\r\n    133             label_type=label_type,\r\n\r\nKeyError: 'document_embeddings'\r\n```\r\n\r\nDoes the best-model.pt not contain everything that is needed later on? How can i solve this problem?", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1853/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1853/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1846", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1846/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1846/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1846/events", "html_url": "https://github.com/flairNLP/flair/issues/1846", "id": 691947966, "node_id": "MDU6SXNzdWU2OTE5NDc5NjY=", "number": 1846, "title": "Strange observation for Sentiment Analysis", "user": {"login": "happypanda5", "id": 48689790, "node_id": "MDQ6VXNlcjQ4Njg5Nzkw", "avatar_url": "https://avatars.githubusercontent.com/u/48689790?v=4", "gravatar_id": "", "url": "https://api.github.com/users/happypanda5", "html_url": "https://github.com/happypanda5", "followers_url": "https://api.github.com/users/happypanda5/followers", "following_url": "https://api.github.com/users/happypanda5/following{/other_user}", "gists_url": "https://api.github.com/users/happypanda5/gists{/gist_id}", "starred_url": "https://api.github.com/users/happypanda5/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/happypanda5/subscriptions", "organizations_url": "https://api.github.com/users/happypanda5/orgs", "repos_url": "https://api.github.com/users/happypanda5/repos", "events_url": "https://api.github.com/users/happypanda5/events{/privacy}", "received_events_url": "https://api.github.com/users/happypanda5/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-09-03T12:57:02Z", "updated_at": "2020-09-03T17:16:24Z", "closed_at": "2020-09-03T17:16:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI have a strange observation for Sentiment Analysis task. I gave it text which include both positive & negative polarity sentences but the score is overwhelmingly positive.\r\n\r\n**To Reproduce**\r\nimport flair\r\nflair_sentiment = flair.models.TextClassifier.load('en-sentiment')\r\nsentence = \"I am very happy. I am also very sad\"\r\ns = flair.data.Sentence(sentence)\r\nflair_sentiment.predict(s)\r\nsentiment = s.labels\r\nprint( sentiment )\r\n\r\n_output is:_ \r\n_[POSITIVE (0.996)]_\r\n\r\n**Expected behavior**\r\nGiven that the text contains \"very happy\" and \"very sad\", I expect the score/confidence of sentiment to be much lower (maybe around 0.5)\r\n\r\n\r\n**Environment (please complete the following information):**\r\nGoogle colab\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1846/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1846/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1845", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1845/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1845/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1845/events", "html_url": "https://github.com/flairNLP/flair/issues/1845", "id": 691427897, "node_id": "MDU6SXNzdWU2OTE0Mjc4OTc=", "number": 1845, "title": "Shared memory error", "user": {"login": "dabasmoti", "id": 38852155, "node_id": "MDQ6VXNlcjM4ODUyMTU1", "avatar_url": "https://avatars.githubusercontent.com/u/38852155?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dabasmoti", "html_url": "https://github.com/dabasmoti", "followers_url": "https://api.github.com/users/dabasmoti/followers", "following_url": "https://api.github.com/users/dabasmoti/following{/other_user}", "gists_url": "https://api.github.com/users/dabasmoti/gists{/gist_id}", "starred_url": "https://api.github.com/users/dabasmoti/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dabasmoti/subscriptions", "organizations_url": "https://api.github.com/users/dabasmoti/orgs", "repos_url": "https://api.github.com/users/dabasmoti/repos", "events_url": "https://api.github.com/users/dabasmoti/events{/privacy}", "received_events_url": "https://api.github.com/users/dabasmoti/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-09-02T21:18:19Z", "updated_at": "2020-09-08T08:46:18Z", "closed_at": "2020-09-08T08:46:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\nI am trying to train Emsbeddings on my corpus(8GB),\r\nAfter few epochs i got this error:\r\n\r\n`ERROR: Unexpected bus error encountered in worker. This might be caused by insufficient shared memory (shm).`\r\n```\r\n------ Messages Limits --------\r\nmax queues system wide = 32000\r\nmax size of message (bytes) = 8192\r\ndefault max size of queue (bytes) = 16384\r\n\r\n------ Shared Memory Limits --------\r\nmax number of segments = 4096\r\nmax seg size (kbytes) = 18014398509465599\r\nmax total shared memory (kbytes) = 18014398442373116\r\nmin seg size (bytes) = 1\r\n\r\n------ Semaphore Limits --------\r\nmax number of arrays = 32000\r\nmax semaphores per array = 32000\r\nmax semaphores system wide = 1024000000\r\nmax ops per semop call = 500\r\nsemaphore max value = 32767\r\n```\r\n\r\nRunning on 16cpu 60gb Nvidia p100\r\npytorch 1.4\r\n\r\nI found this [https://github.com/flairNLP/flair/issues/1109]\r\nbut i am not running on docker, i am using conda as it come with the instance image.\r\nHow can i solve it?", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1845/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1845/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1843", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1843/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1843/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1843/events", "html_url": "https://github.com/flairNLP/flair/issues/1843", "id": 691232593, "node_id": "MDU6SXNzdWU2OTEyMzI1OTM=", "number": 1843, "title": "Sentiment analysis pipeline not working", "user": {"login": "happypanda5", "id": 48689790, "node_id": "MDQ6VXNlcjQ4Njg5Nzkw", "avatar_url": "https://avatars.githubusercontent.com/u/48689790?v=4", "gravatar_id": "", "url": "https://api.github.com/users/happypanda5", "html_url": "https://github.com/happypanda5", "followers_url": "https://api.github.com/users/happypanda5/followers", "following_url": "https://api.github.com/users/happypanda5/following{/other_user}", "gists_url": "https://api.github.com/users/happypanda5/gists{/gist_id}", "starred_url": "https://api.github.com/users/happypanda5/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/happypanda5/subscriptions", "organizations_url": "https://api.github.com/users/happypanda5/orgs", "repos_url": "https://api.github.com/users/happypanda5/repos", "events_url": "https://api.github.com/users/happypanda5/events{/privacy}", "received_events_url": "https://api.github.com/users/happypanda5/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-09-02T17:19:21Z", "updated_at": "2020-09-09T15:35:13Z", "closed_at": "2020-09-03T11:31:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "The sentiment analysis pipeline is not working and returns the following error. I saw that you have set different filename for the model (GH-1841: fix sentiment model for transformers 3.1 ) but it hasn't been pushed to pip install flair.\r\n\r\nUntil this is updated to pip, can you please guide me how to install flair using the git repository?\r\n\r\n/usr/local/lib/python3.6/dist-packages/transformers/configuration_utils.py in use_return_dict(self)\r\n    217         \"\"\"\r\n    218         # If torchscript is set, force `return_dict=False` to avoid jit errors\r\n--> 219         return self.return_dict and not self.torchscript\r\n    220 \r\n    221     @property\r\n\r\nAttributeError: 'DistilBertConfig' object has no attribute 'return_dict'\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1843/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1843/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1841", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1841/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1841/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1841/events", "html_url": "https://github.com/flairNLP/flair/issues/1841", "id": 690470318, "node_id": "MDU6SXNzdWU2OTA0NzAzMTg=", "number": 1841, "title": "AttributeError: 'DistilBertConfig' object has no attribute 'return_dict'", "user": {"login": "Y4rd13", "id": 13507900, "node_id": "MDQ6VXNlcjEzNTA3OTAw", "avatar_url": "https://avatars.githubusercontent.com/u/13507900?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Y4rd13", "html_url": "https://github.com/Y4rd13", "followers_url": "https://api.github.com/users/Y4rd13/followers", "following_url": "https://api.github.com/users/Y4rd13/following{/other_user}", "gists_url": "https://api.github.com/users/Y4rd13/gists{/gist_id}", "starred_url": "https://api.github.com/users/Y4rd13/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Y4rd13/subscriptions", "organizations_url": "https://api.github.com/users/Y4rd13/orgs", "repos_url": "https://api.github.com/users/Y4rd13/repos", "events_url": "https://api.github.com/users/Y4rd13/events{/privacy}", "received_events_url": "https://api.github.com/users/Y4rd13/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-09-01T21:43:04Z", "updated_at": "2020-09-03T21:41:48Z", "closed_at": "2020-09-02T14:56:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "## Environment info\r\n* Google Colab\r\n- `transformers` version: 3.1.0\r\n- Platform: Linux-4.19.112+-x86_64-with-Ubuntu-18.04-bionic\r\n- Python version: 3.6.9\r\n- PyTorch version (GPU?): 1.6.0+cu101 (False)\r\n- Tensorflow version (GPU?): 2.3.0 (False)\r\n- Using GPU in script?: <True>\r\n- Using distributed or parallel set-up in script?: <False>\r\n## Information\r\n\r\nModel I am using (Bert, XLNet ...):\r\n\r\nThe problem arises when using:\r\n* [ ] the official example scripts: (give details below)\r\n* [ ] my own modified scripts: (give details below)\r\n\r\n```python\r\nimport flair\r\nflair_sent = flair.models.TextClassifier.load('en-sentiment')\r\n\r\ndef flair_lstm(text):\r\n    sentence = flair.data.Sentence(text)\r\n    flair_sent.predict(sentences=sentence)\r\n    total_sent = sentence.labels\r\n    for label in total_sent:\r\n        value = label.value\r\n        score = label.score\r\n        return '1' if value == 'POSITIVE' else '-1'\r\n```\r\n\r\nThe tasks I am working on is:\r\n* I'm working with flair to get classification polarities, but the issue seems refer to transformers\r\n\r\n## To reproduce\r\n\r\nSteps to reproduce the behavior:\r\n\r\n1. write\r\n```python\r\ndef flair_lstm(text):\r\n    sentence = flair.data.Sentence(text)\r\n    flair_sent.predict(sentences=sentence)\r\n    total_sent = sentence.labels\r\n    for label in total_sent:\r\n        value = label.value\r\n        score = label.score\r\n        return '1' if value == 'POSITIVE' else '-1'\r\n\r\ndf_test = \"some test dataframe\"\r\ndf_test['flair'] = df_test['word'].apply(lambda x: flair_lstm(x))\r\n```\r\n2. See error:\r\n\r\n## Traceback:\r\n\r\n```python\r\n---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-26-1ee39d7138b3> in <module>()\r\n----> 1 df_test['flair'] = df_test['word'].apply(lambda x: flair_lstm(x))\r\n\r\n10 frames\r\npandas/_libs/lib.pyx in pandas._libs.lib.map_infer()\r\n\r\n/usr/local/lib/python3.6/dist-packages/transformers/configuration_utils.py in use_return_dict(self)\r\n    217         \"\"\"\r\n    218         # If torchscript is set, force `return_dict=False` to avoid jit errors\r\n--> 219         return self.return_dict and not self.torchscript\r\n    220 \r\n    221     @property\r\n\r\nAttributeError: 'DistilBertConfig' object has no attribute 'return_dict'\r\n```\r\n\r\n## Expected output:\r\n- prediction of each word of the dataframe using the flair_lstm function", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1841/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1841/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1840", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1840/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1840/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1840/events", "html_url": "https://github.com/flairNLP/flair/issues/1840", "id": 690051237, "node_id": "MDU6SXNzdWU2OTAwNTEyMzc=", "number": 1840, "title": "muse embedding download 301", "user": {"login": "robinderat", "id": 7957770, "node_id": "MDQ6VXNlcjc5NTc3NzA=", "avatar_url": "https://avatars.githubusercontent.com/u/7957770?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robinderat", "html_url": "https://github.com/robinderat", "followers_url": "https://api.github.com/users/robinderat/followers", "following_url": "https://api.github.com/users/robinderat/following{/other_user}", "gists_url": "https://api.github.com/users/robinderat/gists{/gist_id}", "starred_url": "https://api.github.com/users/robinderat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robinderat/subscriptions", "organizations_url": "https://api.github.com/users/robinderat/orgs", "repos_url": "https://api.github.com/users/robinderat/repos", "events_url": "https://api.github.com/users/robinderat/events{/privacy}", "received_events_url": "https://api.github.com/users/robinderat/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-09-01T11:09:27Z", "updated_at": "2020-09-02T14:56:04Z", "closed_at": "2020-09-02T14:56:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "MuseCrosslingualEmbeddings still refer to the old storage to download the embeddings, causing an error.\r\n\r\nTo solve:\r\n- Add the embedding files to the new storage\r\n- Update the download path in MuseCrosslingualEmbeddings._add_embeddings_internal", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1840/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1840/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1832", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1832/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1832/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1832/events", "html_url": "https://github.com/flairNLP/flair/issues/1832", "id": 687971347, "node_id": "MDU6SXNzdWU2ODc5NzEzNDc=", "number": 1832, "title": "Can't load french NER models", "user": {"login": "ghost", "id": 10137, "node_id": "MDQ6VXNlcjEwMTM3", "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ghost", "html_url": "https://github.com/ghost", "followers_url": "https://api.github.com/users/ghost/followers", "following_url": "https://api.github.com/users/ghost/following{/other_user}", "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}", "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ghost/subscriptions", "organizations_url": "https://api.github.com/users/ghost/orgs", "repos_url": "https://api.github.com/users/ghost/repos", "events_url": "https://api.github.com/users/ghost/events{/privacy}", "received_events_url": "https://api.github.com/users/ghost/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178842, "node_id": "MDU6TGFiZWw5NjExNzg4NDI=", "url": "https://api.github.com/repos/flairNLP/flair/labels/duplicate", "name": "duplicate", "color": "cfd3d7", "default": true, "description": "This issue or pull request already exists"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-08-28T10:19:20Z", "updated_at": "2020-08-28T10:40:49Z", "closed_at": "2020-08-28T10:40:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "Good morning ,\r\ni am having a strange error will loading flair french NER models. \r\nit seems that the download link is no longer valide.\r\n\r\ncan you help please me ?\r\n\r\n![image](https://user-images.githubusercontent.com/42295558/91549866-ebf63900-e927-11ea-8acd-968918bdbe81.png)\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1832/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1832/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1831", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1831/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1831/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1831/events", "html_url": "https://github.com/flairNLP/flair/issues/1831", "id": 687329809, "node_id": "MDU6SXNzdWU2ODczMjk4MDk=", "number": 1831, "title": "Error when creating embeddings - HEAD request to S3 bucket returns 404", "user": {"login": "cibeah", "id": 33727915, "node_id": "MDQ6VXNlcjMzNzI3OTE1", "avatar_url": "https://avatars.githubusercontent.com/u/33727915?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cibeah", "html_url": "https://github.com/cibeah", "followers_url": "https://api.github.com/users/cibeah/followers", "following_url": "https://api.github.com/users/cibeah/following{/other_user}", "gists_url": "https://api.github.com/users/cibeah/gists{/gist_id}", "starred_url": "https://api.github.com/users/cibeah/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cibeah/subscriptions", "organizations_url": "https://api.github.com/users/cibeah/orgs", "repos_url": "https://api.github.com/users/cibeah/repos", "events_url": "https://api.github.com/users/cibeah/events{/privacy}", "received_events_url": "https://api.github.com/users/cibeah/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 30, "created_at": "2020-08-27T15:20:17Z", "updated_at": "2020-10-16T08:03:35Z", "closed_at": "2020-09-03T19:27:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello, I have a problem loading Word/FlairEmbeddings for English and German languages located at the urls: \"https://s3.eu-central-1.amazonaws.com/alan-nlp/resources/embeddings/xxxxxxxxx.pt\". \r\n\r\nWhen following [Tutorial 3](https://github.com/flairNLP/flair/blob/master/resources/docs/TUTORIAL_3_WORD_EMBEDDING.md), trying to create these embeddings gives the following error:\r\n\r\n`OSError: HEAD request failed for url https://s3.eu-central-1.amazonaws.com/alan-nlp/resources/embeddings/glove.gensim.vectors.npy with status code 404`\r\n\r\nMaking a simple HEAD request to that url outside of flair returns 404, so it looks like the embeddings are not located there anymore ?\r\n\r\n**To Reproduce**\r\n\r\n`from flair.embeddings import WordEmbeddings`\r\n`glove_embedding = WordEmbeddings('glove')`\r\n\r\nI would  appreciate your help,\r\nThank you !", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1831/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1831/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1829", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1829/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1829/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1829/events", "html_url": "https://github.com/flairNLP/flair/issues/1829", "id": 685474886, "node_id": "MDU6SXNzdWU2ODU0NzQ4ODY=", "number": 1829, "title": "CUDA out of memory error when very long word is passed to NER model.", "user": {"login": "ugurcanozalp", "id": 56481832, "node_id": "MDQ6VXNlcjU2NDgxODMy", "avatar_url": "https://avatars.githubusercontent.com/u/56481832?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ugurcanozalp", "html_url": "https://github.com/ugurcanozalp", "followers_url": "https://api.github.com/users/ugurcanozalp/followers", "following_url": "https://api.github.com/users/ugurcanozalp/following{/other_user}", "gists_url": "https://api.github.com/users/ugurcanozalp/gists{/gist_id}", "starred_url": "https://api.github.com/users/ugurcanozalp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ugurcanozalp/subscriptions", "organizations_url": "https://api.github.com/users/ugurcanozalp/orgs", "repos_url": "https://api.github.com/users/ugurcanozalp/repos", "events_url": "https://api.github.com/users/ugurcanozalp/events{/privacy}", "received_events_url": "https://api.github.com/users/ugurcanozalp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-08-25T13:12:08Z", "updated_at": "2021-10-02T13:03:44Z", "closed_at": "2020-12-31T10:16:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello. I have a string consisting of just one repeated character 'a' (300.000 times). The problem is that when I try to find NER in this string model just hangs and never finishes the process. \r\n\r\n**Describe the bug**\r\nHello. I have a string consisting of just one repeated character 'a' (300.000 times). The problem is that when I try to find NER in this string ner model (en-ner-conll03-v0.4) stucks and throws cuda out of memory error after a long time. When I debugged the code, I realized that this model uses LanguageModel module (in flair/models/language_model) and divides sentences into chunks to get smaller sentences (in get_representation method of LanguageModel class, defaults to 512 chars). However, it seems that this is not able to resolve memory problem.\r\n\r\n**To Reproduce**\r\n```\r\nfrom flair.tokenization import SegtokSentenceSplitter\r\nfrom flair.models import SequenceTagger\r\nfile = 'aas.txt' # A file containing character a 300k times\r\nwith open(file,'r') as f:\r\n    text = f.read()\r\n\r\ntagger = SequenceTagger.load('ner')\r\nsplitter = SegtokSentenceSplitter()\r\ntextobjs = splitter.split(text)\r\ntagger.predict(textobjs)\r\n```\r\n\r\nRuntimeError: CUDA out of memory. Tried to allocate 2.29 GiB (GPU 0; 5.93 GiB total capacity; 2.56 GiB already allocated; 2.07 GiB free; 2.78 GiB reserved in total by PyTorch)\r\n\r\n**Expected behavior**\r\nI expect to get conventional result, finished process with no entities found.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [Ubuntu 18.04]:\r\n - Version [flair-0.6]:\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1829/reactions", "total_count": 4, "+1": 4, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1829/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1827", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1827/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1827/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1827/events", "html_url": "https://github.com/flairNLP/flair/issues/1827", "id": 683548624, "node_id": "MDU6SXNzdWU2ODM1NDg2MjQ=", "number": 1827, "title": "Error when loading trained model", "user": {"login": "lucaventurini", "id": 2151065, "node_id": "MDQ6VXNlcjIxNTEwNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/2151065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lucaventurini", "html_url": "https://github.com/lucaventurini", "followers_url": "https://api.github.com/users/lucaventurini/followers", "following_url": "https://api.github.com/users/lucaventurini/following{/other_user}", "gists_url": "https://api.github.com/users/lucaventurini/gists{/gist_id}", "starred_url": "https://api.github.com/users/lucaventurini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lucaventurini/subscriptions", "organizations_url": "https://api.github.com/users/lucaventurini/orgs", "repos_url": "https://api.github.com/users/lucaventurini/repos", "events_url": "https://api.github.com/users/lucaventurini/events{/privacy}", "received_events_url": "https://api.github.com/users/lucaventurini/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-08-21T13:07:34Z", "updated_at": "2021-01-02T11:17:17Z", "closed_at": "2021-01-02T11:17:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "When I load a model trained (on a different machine) with TransformerDocumentEmbeddings, the script fails with the following error:\r\n\r\n`Not found: \"/root/.cache/torch/transformers/0c370616ddfc06067c0634160f749c2cf9d8da2c50e03a2617ce5841c8df3b1d.309f0c29486cffc28e1e40a2ab0ac8f500c203fe080b95f820aa9cb58e5b84ed\": No such file or directory Error #2 `\r\n\r\nApparently, it's looking for some file in cache from transformers, even if I expected the model to contain everything needed for the prediction.\r\n\r\nThe workaround is to call again, before the loading,\r\n`_ = TransformerDocumentEmbeddings('xlm-roberta-base')`\r\nbut you need to know which pre-trained model was used in the training, in this case 'xlm-roberta-base'.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1827/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1827/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1823", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1823/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1823/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1823/events", "html_url": "https://github.com/flairNLP/flair/issues/1823", "id": 681674251, "node_id": "MDU6SXNzdWU2ODE2NzQyNTE=", "number": 1823, "title": "Change batch_size but the usage of GPU remains the same.", "user": {"login": "ForLittleBeauty", "id": 34436078, "node_id": "MDQ6VXNlcjM0NDM2MDc4", "avatar_url": "https://avatars.githubusercontent.com/u/34436078?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ForLittleBeauty", "html_url": "https://github.com/ForLittleBeauty", "followers_url": "https://api.github.com/users/ForLittleBeauty/followers", "following_url": "https://api.github.com/users/ForLittleBeauty/following{/other_user}", "gists_url": "https://api.github.com/users/ForLittleBeauty/gists{/gist_id}", "starred_url": "https://api.github.com/users/ForLittleBeauty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ForLittleBeauty/subscriptions", "organizations_url": "https://api.github.com/users/ForLittleBeauty/orgs", "repos_url": "https://api.github.com/users/ForLittleBeauty/repos", "events_url": "https://api.github.com/users/ForLittleBeauty/events{/privacy}", "received_events_url": "https://api.github.com/users/ForLittleBeauty/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-08-19T09:05:10Z", "updated_at": "2020-08-21T07:38:09Z", "closed_at": "2020-08-21T07:38:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhen I use GPU to fine-tuning my BERT model,  I use nvidia-smi to check the usage of my GPU,  however, when I double the mini_batch_size, it seems that the usage of GPU remains the same as before smaller mini_batch_size, I am confused, is this a bug or something wrong to me?\r\n\r\n**To Reproduce**\r\n\r\n    trainer.train('resources/taggers/trec',\r\n                learning_rate=3e-5, # use very small learning rate\r\n                mini_batch_size=512,\r\n                mini_batch_chunk_size=32, # optionally set this if transformer is too much for your machine\r\n                max_epochs=50, # terminate after 5 epochs\r\n\t\tembeddings_storage_mode='gpu'\r\n                )\r\n\r\n\r\n\r\n**Expected behavior**\r\nI change mini_batch_size from 16 to 512, the usages of GPU are nearly the same. And I use V100 with 32GB so I do not think the batch_sizes of 16,32,64 will be too large.\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - Centos :\r\n - flair 0.6:\r\n\r\n**Additional context**\r\nBesides, I do not quite understand the usefulness of mini_batch_chunk_size\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1823/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1823/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1817", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1817/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1817/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1817/events", "html_url": "https://github.com/flairNLP/flair/issues/1817", "id": 680295261, "node_id": "MDU6SXNzdWU2ODAyOTUyNjE=", "number": 1817, "title": "HUNFLAIR paper reference is a placeholder", "user": {"login": "khituras", "id": 4648560, "node_id": "MDQ6VXNlcjQ2NDg1NjA=", "avatar_url": "https://avatars.githubusercontent.com/u/4648560?v=4", "gravatar_id": "", "url": "https://api.github.com/users/khituras", "html_url": "https://github.com/khituras", "followers_url": "https://api.github.com/users/khituras/followers", "following_url": "https://api.github.com/users/khituras/following{/other_user}", "gists_url": "https://api.github.com/users/khituras/gists{/gist_id}", "starred_url": "https://api.github.com/users/khituras/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/khituras/subscriptions", "organizations_url": "https://api.github.com/users/khituras/orgs", "repos_url": "https://api.github.com/users/khituras/repos", "events_url": "https://api.github.com/users/khituras/events{/privacy}", "received_events_url": "https://api.github.com/users/khituras/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "mariosaenger", "id": 40803339, "node_id": "MDQ6VXNlcjQwODAzMzM5", "avatar_url": "https://avatars.githubusercontent.com/u/40803339?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mariosaenger", "html_url": "https://github.com/mariosaenger", "followers_url": "https://api.github.com/users/mariosaenger/followers", "following_url": "https://api.github.com/users/mariosaenger/following{/other_user}", "gists_url": "https://api.github.com/users/mariosaenger/gists{/gist_id}", "starred_url": "https://api.github.com/users/mariosaenger/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mariosaenger/subscriptions", "organizations_url": "https://api.github.com/users/mariosaenger/orgs", "repos_url": "https://api.github.com/users/mariosaenger/repos", "events_url": "https://api.github.com/users/mariosaenger/events{/privacy}", "received_events_url": "https://api.github.com/users/mariosaenger/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mariosaenger", "id": 40803339, "node_id": "MDQ6VXNlcjQwODAzMzM5", "avatar_url": "https://avatars.githubusercontent.com/u/40803339?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mariosaenger", "html_url": "https://github.com/mariosaenger", "followers_url": "https://api.github.com/users/mariosaenger/followers", "following_url": "https://api.github.com/users/mariosaenger/following{/other_user}", "gists_url": "https://api.github.com/users/mariosaenger/gists{/gist_id}", "starred_url": "https://api.github.com/users/mariosaenger/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mariosaenger/subscriptions", "organizations_url": "https://api.github.com/users/mariosaenger/orgs", "repos_url": "https://api.github.com/users/mariosaenger/repos", "events_url": "https://api.github.com/users/mariosaenger/events{/privacy}", "received_events_url": "https://api.github.com/users/mariosaenger/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-08-17T14:50:06Z", "updated_at": "2020-08-18T15:04:43Z", "closed_at": "2020-08-18T15:04:43Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "On the page https://github.com/flairNLP/flair/blob/master/resources/docs/HUNFLAIR.md the link to the paper is just a placeholder link at the moment.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1817/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1817/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1816", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1816/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1816/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1816/events", "html_url": "https://github.com/flairNLP/flair/issues/1816", "id": 680293261, "node_id": "MDU6SXNzdWU2ODAyOTMyNjE=", "number": 1816, "title": "Hunflair FSU Corpus update", "user": {"login": "khituras", "id": 4648560, "node_id": "MDQ6VXNlcjQ2NDg1NjA=", "avatar_url": "https://avatars.githubusercontent.com/u/4648560?v=4", "gravatar_id": "", "url": "https://api.github.com/users/khituras", "html_url": "https://github.com/khituras", "followers_url": "https://api.github.com/users/khituras/followers", "following_url": "https://api.github.com/users/khituras/following{/other_user}", "gists_url": "https://api.github.com/users/khituras/gists{/gist_id}", "starred_url": "https://api.github.com/users/khituras/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/khituras/subscriptions", "organizations_url": "https://api.github.com/users/khituras/orgs", "repos_url": "https://api.github.com/users/khituras/repos", "events_url": "https://api.github.com/users/khituras/events{/privacy}", "received_events_url": "https://api.github.com/users/khituras/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-08-17T14:47:18Z", "updated_at": "2020-12-22T19:27:37Z", "closed_at": "2020-12-22T19:27:37Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "@leonweber Great work regarding the BioNLP corpora and models in flair 0.6! I just have one remark. The https://github.com/flairNLP/flair/blob/master/resources/docs/HUNFLAIR_CORPORA.md references the FSU PrGe Corpus from the CalBc project which was not officially released in that form. There is now an updated publication and resource that exhibits more annotation levels and should be used in the future: http://www.lrec-conf.org/proceedings/lrec2020/pdf/2020.lrec-1.564.pdf\r\n\r\nThanks for the great work, I will probably use some of those models in my own!", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1816/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1816/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1808", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1808/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1808/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1808/events", "html_url": "https://github.com/flairNLP/flair/issues/1808", "id": 678638868, "node_id": "MDU6SXNzdWU2Nzg2Mzg4Njg=", "number": 1808, "title": "ModelTrainer Requiring Sampler", "user": {"login": "stephenhage", "id": 21012343, "node_id": "MDQ6VXNlcjIxMDEyMzQz", "avatar_url": "https://avatars.githubusercontent.com/u/21012343?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stephenhage", "html_url": "https://github.com/stephenhage", "followers_url": "https://api.github.com/users/stephenhage/followers", "following_url": "https://api.github.com/users/stephenhage/following{/other_user}", "gists_url": "https://api.github.com/users/stephenhage/gists{/gist_id}", "starred_url": "https://api.github.com/users/stephenhage/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stephenhage/subscriptions", "organizations_url": "https://api.github.com/users/stephenhage/orgs", "repos_url": "https://api.github.com/users/stephenhage/repos", "events_url": "https://api.github.com/users/stephenhage/events{/privacy}", "received_events_url": "https://api.github.com/users/stephenhage/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-08-13T18:10:04Z", "updated_at": "2020-12-19T14:05:27Z", "closed_at": "2020-12-19T14:05:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI have a pandas data frame of text and labels for a classification problem. This is legal text and I am trying to fine-tune a language model to the specific sections (each as a document) of the larger corpus. When I execute the trainer.train() function I get this error:\r\n`ValueError: num_samples should be a positive integer value, but got num_samples=0`\r\n\r\nOf note, I am following tutorial in section 3.2 [here](https://towardsdatascience.com/text-classification-with-state-of-the-art-nlp-library-flair-b541d7add21f).\r\n\r\n**To Reproduce**\r\nI split my data frame into train/dev/test sets saved as csv files (train.csv, dev.csv, and test.csv) with two columns: label and text. I've tried this both with tab and comma delimiters. They are all saved in the same folder as my Jupyter notebook.\r\n\r\nThis is the code block I am trying to execute:\r\n```from flair.data_fetcher import NLPTaskDataFetcher\r\nfrom flair.embeddings import WordEmbeddings, FlairEmbeddings, DocumentLSTMEmbeddings\r\nfrom flair.models import TextClassifier\r\nfrom flair.trainers import ModelTrainer\r\nfrom pathlib import Path\r\ncorpus = NLPTaskDataFetcher.load_classification_corpus(Path('./'), \r\n                                                       test_file='test.csv', \r\n                                                       dev_file='dev.csv', \r\n                                                       train_file='train.csv')\r\nword_embeddings = [WordEmbeddings('glove'), \r\n                   FlairEmbeddings('news-forward-fast'), \r\n                   FlairEmbeddings('news-backward-fast')]\r\ndocument_embeddings = DocumentLSTMEmbeddings(word_embeddings, \r\n                                             hidden_size=512, \r\n                                             reproject_words=True, \r\n                                             reproject_words_dimension=256)\r\nclassifier = TextClassifier(document_embeddings, \r\n                            label_dictionary=corpus.make_label_dictionary(), \r\n                            multi_label=False)\r\ntrainer = ModelTrainer(classifier, corpus)\r\ntrainer.train(Path('./'),\r\n              learning_rate=0.1,\r\n              mini_batch_size=8,\r\n              max_epochs = 5)\r\n```\r\n\r\nI can execute each line without failure up until `trainer.train(Path('./'),...`. That appears to be the troublesome section.\r\n\r\n**Expected behavior**\r\nBased on the tutorial I expected this code to create a language model that is tuned to the particular text in the train/test/dev sets.  \r\n\r\n**Environment (please complete the following information):**\r\n - OS: Mac OS 10.15.4\r\n - Python: 3.7.6\r\n - Version: flair-0.5.1\r\n\r\n**Additional context**\r\nThe full output from the code above is:\r\n```\r\n2020-08-13 13:02:23,708 Reading data from .\r\n2020-08-13 13:02:23,711 Train: train.csv\r\n2020-08-13 13:02:23,711 Dev: dev.csv\r\n2020-08-13 13:02:23,712 Test: test.csv\r\n/Users/stephenhage/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:9: DeprecationWarning: Call to deprecated function (or staticmethod) load_classification_corpus. (Use 'flair.datasets' instead.) -- Deprecated since version 0.4.1.\r\n  if __name__ == '__main__':\r\n2020-08-13 13:02:25,099 Computing label dictionary. Progress:\r\n/Users/stephenhage/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:16: DeprecationWarning: Call to deprecated method __init__. (The functionality of this class is moved to 'DocumentRNNEmbeddings') -- Deprecated since version 0.4.\r\n  app.launch_new_instance()\r\n0it [00:00, ?it/s]\r\n2020-08-13 13:02:25,102 []\r\n2020-08-13 13:02:25,107 ----------------------------------------------------------------------------------------------------\r\n2020-08-13 13:02:25,108 Model: \"TextClassifier(\r\n  (document_embeddings): DocumentLSTMEmbeddings(\r\n    (embeddings): StackedEmbeddings(\r\n      (list_embedding_0): WordEmbeddings('glove')\r\n      (list_embedding_1): FlairEmbeddings(\r\n        (lm): LanguageModel(\r\n          (drop): Dropout(p=0.25, inplace=False)\r\n          (encoder): Embedding(275, 100)\r\n          (rnn): LSTM(100, 1024)\r\n          (decoder): Linear(in_features=1024, out_features=275, bias=True)\r\n        )\r\n      )\r\n      (list_embedding_2): FlairEmbeddings(\r\n        (lm): LanguageModel(\r\n          (drop): Dropout(p=0.25, inplace=False)\r\n          (encoder): Embedding(275, 100)\r\n          (rnn): LSTM(100, 1024)\r\n          (decoder): Linear(in_features=1024, out_features=275, bias=True)\r\n        )\r\n      )\r\n    )\r\n    (word_reprojection_map): Linear(in_features=2148, out_features=256, bias=True)\r\n    (rnn): GRU(256, 512)\r\n    (dropout): Dropout(p=0.5, inplace=False)\r\n  )\r\n  (decoder): Linear(in_features=512, out_features=0, bias=True)\r\n  (loss_function): CrossEntropyLoss()\r\n  (beta): 1.0\r\n  (weights): None\r\n  (weight_tensor) None\r\n)\"\r\n2020-08-13 13:02:25,109 ----------------------------------------------------------------------------------------------------\r\n2020-08-13 13:02:25,121 Corpus: \"Corpus: 0 train + 0 dev + 0 test sentences\"\r\n2020-08-13 13:02:25,122 ----------------------------------------------------------------------------------------------------\r\n2020-08-13 13:02:25,123 Parameters:\r\n2020-08-13 13:02:25,124  - learning_rate: \"0.1\"\r\n2020-08-13 13:02:25,125  - mini_batch_size: \"8\"\r\n2020-08-13 13:02:25,126  - patience: \"3\"\r\n2020-08-13 13:02:25,127  - anneal_factor: \"0.5\"\r\n2020-08-13 13:02:25,128  - max_epochs: \"5\"\r\n2020-08-13 13:02:25,129  - shuffle: \"True\"\r\n2020-08-13 13:02:25,130  - train_with_dev: \"False\"\r\n2020-08-13 13:02:25,131  - batch_growth_annealing: \"False\"\r\n2020-08-13 13:02:25,132 ----------------------------------------------------------------------------------------------------\r\n2020-08-13 13:02:25,132 Model training base path: \".\"\r\n2020-08-13 13:02:25,133 ----------------------------------------------------------------------------------------------------\r\n2020-08-13 13:02:25,134 Device: cpu\r\n2020-08-13 13:02:25,135 ----------------------------------------------------------------------------------------------------\r\n2020-08-13 13:02:25,136 Embeddings storage mode: cpu\r\n2020-08-13 13:02:25,138 ----------------------------------------------------------------------------------------------------\r\n\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-7-15c181ba8be6> in <module>\r\n     22               learning_rate=0.1,\r\n     23               mini_batch_size=8,\r\n---> 24               max_epochs = 5)\r\n\r\n~/opt/anaconda3/lib/python3.7/site-packages/flair/trainers/trainer.py in train(self, base_path, learning_rate, mini_batch_size, mini_batch_chunk_size, max_epochs, scheduler, anneal_factor, patience, initial_extra_patience, min_learning_rate, train_with_dev, monitor_train, monitor_test, embeddings_storage_mode, checkpoint, save_final_model, anneal_with_restarts, anneal_with_prestarts, batch_growth_annealing, shuffle, param_selection_mode, num_workers, sampler, use_amp, amp_opt_level, eval_on_train_fraction, eval_on_train_shuffle, **kwargs)\r\n    314                     shuffle=shuffle,\r\n    315                     num_workers=num_workers,\r\n--> 316                     sampler=sampler,\r\n    317                 )\r\n    318 \r\n\r\n~/opt/anaconda3/lib/python3.7/site-packages/flair/datasets/base.py in __init__(self, dataset, batch_size, shuffle, sampler, batch_sampler, num_workers, drop_last, timeout, worker_init_fn)\r\n     59             drop_last=drop_last,\r\n     60             timeout=timeout,\r\n---> 61             worker_init_fn=worker_init_fn,\r\n     62         )\r\n     63 \r\n\r\n~/opt/anaconda3/lib/python3.7/site-packages/torch/utils/data/dataloader.py in __init__(self, dataset, batch_size, shuffle, sampler, batch_sampler, num_workers, collate_fn, pin_memory, drop_last, timeout, worker_init_fn, multiprocessing_context, generator)\r\n    222             else:  # map-style\r\n    223                 if shuffle:\r\n--> 224                     sampler = RandomSampler(dataset, generator=generator)\r\n    225                 else:\r\n    226                     sampler = SequentialSampler(dataset)\r\n\r\n~/opt/anaconda3/lib/python3.7/site-packages/torch/utils/data/sampler.py in __init__(self, data_source, replacement, num_samples, generator)\r\n     94         if not isinstance(self.num_samples, int) or self.num_samples <= 0:\r\n     95             raise ValueError(\"num_samples should be a positive integer \"\r\n---> 96                              \"value, but got num_samples={}\".format(self.num_samples))\r\n     97 \r\n     98     @property\r\n\r\nValueError: num_samples should be a positive integer value, but got num_samples=0\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1808/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1808/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1801", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1801/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1801/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1801/events", "html_url": "https://github.com/flairNLP/flair/issues/1801", "id": 676582407, "node_id": "MDU6SXNzdWU2NzY1ODI0MDc=", "number": 1801, "title": "Model trained on version<=0.5.0 is not compatible on 0.5.1", "user": {"login": "ciaochiaociao", "id": 13917478, "node_id": "MDQ6VXNlcjEzOTE3NDc4", "avatar_url": "https://avatars.githubusercontent.com/u/13917478?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ciaochiaociao", "html_url": "https://github.com/ciaochiaociao", "followers_url": "https://api.github.com/users/ciaochiaociao/followers", "following_url": "https://api.github.com/users/ciaochiaociao/following{/other_user}", "gists_url": "https://api.github.com/users/ciaochiaociao/gists{/gist_id}", "starred_url": "https://api.github.com/users/ciaochiaociao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ciaochiaociao/subscriptions", "organizations_url": "https://api.github.com/users/ciaochiaociao/orgs", "repos_url": "https://api.github.com/users/ciaochiaociao/repos", "events_url": "https://api.github.com/users/ciaochiaociao/events{/privacy}", "received_events_url": "https://api.github.com/users/ciaochiaociao/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-08-11T05:04:49Z", "updated_at": "2021-04-30T06:39:09Z", "closed_at": "2021-04-30T06:39:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "As mentioned in the title, I have trained some models on version <=0.5.0. When I upgrade to 0.5.1, the trained model is no longer available for doing inference.\r\n\r\nI think the problem is in your latest release, you refactored the StackedEmbedding, and it does not have the `get_names` method in the old version. So in the `tagger.predict()` method, the following erred. \r\n```\r\nclass SequenceTagger:\r\n    def predict(self):\r\n        ...\r\n        self.embeddings.get_names(...)  # AttributeError: StackedEmbedding has no get_names attribute in version<=0.5.0\r\n```\r\n\r\n I know I can downgrade to 0.5.0 or re-train my model on 0.5.1, but I have some codes relying on some good features you provide in 0.5.1 and training process is a bit expensive in my case. Maybe you can consider a minimal compatibility of models between different versions in the next release. \r\n\r\nRegards", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1801/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1801/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1796", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1796/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1796/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1796/events", "html_url": "https://github.com/flairNLP/flair/issues/1796", "id": 674666035, "node_id": "MDU6SXNzdWU2NzQ2NjYwMzU=", "number": 1796, "title": "AttributeError: 'BertTokenizer' object has no attribute 'unique_no_split_tokens'", "user": {"login": "achang97", "id": 17213698, "node_id": "MDQ6VXNlcjE3MjEzNjk4", "avatar_url": "https://avatars.githubusercontent.com/u/17213698?v=4", "gravatar_id": "", "url": "https://api.github.com/users/achang97", "html_url": "https://github.com/achang97", "followers_url": "https://api.github.com/users/achang97/followers", "following_url": "https://api.github.com/users/achang97/following{/other_user}", "gists_url": "https://api.github.com/users/achang97/gists{/gist_id}", "starred_url": "https://api.github.com/users/achang97/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/achang97/subscriptions", "organizations_url": "https://api.github.com/users/achang97/orgs", "repos_url": "https://api.github.com/users/achang97/repos", "events_url": "https://api.github.com/users/achang97/events{/privacy}", "received_events_url": "https://api.github.com/users/achang97/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": {"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2020-08-06T23:51:47Z", "updated_at": "2021-01-27T01:41:11Z", "closed_at": "2021-01-27T01:41:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhen attempting to use `Sequence Tagger` with `keyphrase` as the argument, I get the following error: \r\n\r\n```\r\nAttributeError: 'BertTokenizer' object has no attribute 'unique_no_split_tokens'\r\n```\r\n\r\n**To Reproduce**\r\n```\r\n  sentences = [Sentence(sent, use_tokenizer=True) for sent in split_single(text)]\r\n\r\n  # run KEYPHRASE over sentence\r\n  tagger.predict(sentences) # Errors out here\r\n```\r\n\r\n**Expected behavior**\r\nI expect no error and for the key phrases to be detected. I followed the example in the release notes: \r\n\r\n```\r\n# load keyphrase tagger\r\ntagger = SequenceTagger.load('keyphrase')\r\n\r\n# load communicative function tagger\r\nsentence = Sentence(\"Here, we describe the engineering of a new class of ECHs through the \"\r\n                    \"functionalization of non-conductive polymers with a conductive choline-based \"\r\n                    \"bio-ionic liquid (Bio-IL).\", use_tokenizer=True)\r\n\r\n# predict and print labels\r\ntagger.predict(sentence)\r\nprint(sentence)\r\n```\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: MacOS, Docker\r\n - Version [e.g. flair-0.3.2]: 0.5.1\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1796/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1796/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1793", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1793/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1793/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1793/events", "html_url": "https://github.com/flairNLP/flair/issues/1793", "id": 673312014, "node_id": "MDU6SXNzdWU2NzMzMTIwMTQ=", "number": 1793, "title": "Error while using BERT transforemer embeddings", "user": {"login": "himanshudce", "id": 25169555, "node_id": "MDQ6VXNlcjI1MTY5NTU1", "avatar_url": "https://avatars.githubusercontent.com/u/25169555?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himanshudce", "html_url": "https://github.com/himanshudce", "followers_url": "https://api.github.com/users/himanshudce/followers", "following_url": "https://api.github.com/users/himanshudce/following{/other_user}", "gists_url": "https://api.github.com/users/himanshudce/gists{/gist_id}", "starred_url": "https://api.github.com/users/himanshudce/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himanshudce/subscriptions", "organizations_url": "https://api.github.com/users/himanshudce/orgs", "repos_url": "https://api.github.com/users/himanshudce/repos", "events_url": "https://api.github.com/users/himanshudce/events{/privacy}", "received_events_url": "https://api.github.com/users/himanshudce/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-08-05T07:14:28Z", "updated_at": "2020-12-20T06:04:25Z", "closed_at": "2020-12-20T06:04:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI trained the RoBERTa language model from scratch(using hugging face), the trained language model is working properly I checked that on masked language task.\r\nI used this model for Embedding in flair Model\r\n```\r\nembedding_types: List[TokenEmbeddings] = [\r\n\r\n    TransformerWordEmbeddings(model ='BERT/sumerianBERTo/',  layers = '-1,-2,-3,-4', fine_tune = True, batch_size = 8,use_scalar_mix = False)\r\n    \r\n    # contextual string embeddings, forward\r\n    #FlairEmbeddings('FLAIR/resources/taggers/language_model/best-lm.pt'),\r\n    \r\n    # contextual string embeddings, backward\r\n    #FlairEmbeddings('FLAIR/resources/taggers/language_model/best-lm.pt'),\r\n]\r\nembeddings: StackedEmbeddings = StackedEmbeddings(embeddings=embedding_types)\r\n```\r\nand trained the model, but I am getting the warning -\r\n\r\n\"Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.\"\r\n\r\nand than the error  - \r\n\r\n\"\r\nTraceback (most recent call last):\r\n  File \"FLAIR/flair_POS_trainer.py\", line 64, in <module>\r\n    trainer.train('FLAIR/resources/taggers/flairposbert',\r\n  File \"/home/himanshu/.local/lib/python3.8/site-packages/flair/trainers/trainer.py\", line 349, in train\r\n    loss = self.model.forward_loss(batch_step)\r\n  File \"/home/himanshu/.local/lib/python3.8/site-packages/flair/models/sequence_tagger_model.py\", line 599, in forward_loss\r\n    features = self.forward(data_points)\r\n  File \"/home/himanshu/.local/lib/python3.8/site-packages/flair/models/sequence_tagger_model.py\", line 604, in forward\r\n    self.embeddings.embed(sentences)\r\n  File \"/home/himanshu/.local/lib/python3.8/site-packages/flair/embeddings/token.py\", line 71, in embed\r\n    embedding.embed(sentences)\r\n  File \"/home/himanshu/.local/lib/python3.8/site-packages/flair/embeddings/base.py\", line 61, in embed\r\n    self._add_embeddings_internal(sentences)\r\n  File \"/home/himanshu/.local/lib/python3.8/site-packages/flair/embeddings/token.py\", line 897, in _add_embeddings_internal\r\n    self._add_embeddings_to_sentences(batch)\r\n  File \"/home/himanshu/.local/lib/python3.8/site-packages/flair/embeddings/token.py\", line 1009, in _add_embeddings_to_sentences\r\n    hidden_states = self.model(input_ids, attention_mask=mask)[-1]\r\n  File \"/home/himanshu/.local/lib/python3.8/site-packages/torch/nn/modules/module.py\", line 550, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/himanshu/.local/lib/python3.8/site-packages/transformers/modeling_bert.py\", line 752, in forward\r\n    embedding_output = self.embeddings(\r\n  File \"/home/himanshu/.local/lib/python3.8/site-packages/torch/nn/modules/module.py\", line 550, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/himanshu/.local/lib/python3.8/site-packages/transformers/modeling_roberta.py\", line 67, in forward\r\n    return super().forward(\r\n  File \"/home/himanshu/.local/lib/python3.8/site-packages/transformers/modeling_bert.py\", line 179, in forward\r\n    position_embeddings = self.position_embeddings(position_ids)\r\n  File \"/home/himanshu/.local/lib/python3.8/site-packages/torch/nn/modules/module.py\", line 550, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/himanshu/.local/lib/python3.8/site-packages/torch/nn/modules/sparse.py\", line 112, in forward\r\n    return F.embedding(\r\n  File \"/home/himanshu/.local/lib/python3.8/site-packages/torch/nn/functional.py\", line 1724, in embedding\r\n    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)\r\nIndexError: index out of range in self\r\n\"\r\n    \r\n**To Reproduce**\r\n\r\nused the below code to train POS model - \r\n```\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import ColumnCorpus\r\nfrom flair.embeddings import TokenEmbeddings, WordEmbeddings, StackedEmbeddings, FlairEmbeddings, CharacterEmbeddings, TransformerWordEmbeddings\r\nfrom torch.optim.adam import Adam\r\nfrom typing import List\r\n\r\n\r\n# define columns\r\ncolumns = {0: 'text', 1: 'pos'}\r\n\r\n# this is the folder in which train, test and dev files reside\r\ndata_folder = 'FLAIR/POS_corpus'\r\n\r\n# init a corpus using column format, data folder and the names of the train, dev and test files\r\ncorpus: Corpus = ColumnCorpus(data_folder, columns,\r\n                              train_file='train.txt',\r\n                              test_file='test.txt',\r\n                              dev_file='dev.txt')\r\n                              \r\nprint(len(corpus.train))                              \r\nprint(corpus.train[0].to_tagged_string('pos'))\r\n\r\n# tag to predict\r\ntag_type = 'pos'\r\n# make tag dictionary from the corpus\r\ntag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\n\r\nprint(tag_dictionary)\r\n\r\n# initialize embeddings\r\nembedding_types: List[TokenEmbeddings] = [\r\n\r\n    # Word2vec embeddings\r\n    #WordEmbeddings('FLAIR/word2vec50'),\r\n    #CharacterEmbeddings(),\r\n    \r\n    TransformerWordEmbeddings(model ='BERT/sumerianBERTo/',  layers = '-1,-2,-3,-4', fine_tune = True, batch_size = 8,use_scalar_mix = False)\r\n    \r\n    # contextual string embeddings, forward\r\n    #FlairEmbeddings('FLAIR/resources/taggers/language_model/best-lm.pt'),\r\n    \r\n    # contextual string embeddings, backward\r\n    #FlairEmbeddings('FLAIR/resources/taggers/language_model/best-lm.pt'),\r\n]\r\n\r\nembeddings: StackedEmbeddings = StackedEmbeddings(embeddings=embedding_types)\r\n    \r\n\r\n# 5. initialize sequence tagger\r\nfrom flair.models import SequenceTagger\r\n\r\ntagger: SequenceTagger = SequenceTagger(hidden_size=256,\r\n                                        embeddings=embeddings,\r\n                                        tag_dictionary=tag_dictionary,\r\n                                        tag_type=tag_type,\r\n                                        use_crf=True)\r\n\r\n# 6. initialize trainer\r\nfrom flair.trainers import ModelTrainer\r\n\r\ntrainer: ModelTrainer = ModelTrainer(tagger, corpus, optimizer=Adam)\r\n\r\n# 7. start training\r\ntrainer.train('FLAIR/resources/taggers/flairposbert',\r\n              learning_rate=0.1,\r\n              mini_batch_size=32,\r\n              max_epochs=30)\r\n\r\n\r\n```\r\n\r\n\r\n**Expected behavior**\r\nTrained POS model\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - OS Linux:\r\n - Version [python-3.8, flair-latest ]:\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1793/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1793/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1782", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1782/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1782/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1782/events", "html_url": "https://github.com/flairNLP/flair/issues/1782", "id": 667716970, "node_id": "MDU6SXNzdWU2Njc3MTY5NzA=", "number": 1782, "title": "Fail to download DANE() dataset", "user": {"login": "maziyarpanahi", "id": 5762953, "node_id": "MDQ6VXNlcjU3NjI5NTM=", "avatar_url": "https://avatars.githubusercontent.com/u/5762953?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maziyarpanahi", "html_url": "https://github.com/maziyarpanahi", "followers_url": "https://api.github.com/users/maziyarpanahi/followers", "following_url": "https://api.github.com/users/maziyarpanahi/following{/other_user}", "gists_url": "https://api.github.com/users/maziyarpanahi/gists{/gist_id}", "starred_url": "https://api.github.com/users/maziyarpanahi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maziyarpanahi/subscriptions", "organizations_url": "https://api.github.com/users/maziyarpanahi/orgs", "repos_url": "https://api.github.com/users/maziyarpanahi/repos", "events_url": "https://api.github.com/users/maziyarpanahi/events{/privacy}", "received_events_url": "https://api.github.com/users/maziyarpanahi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-07-29T10:03:47Z", "updated_at": "2020-08-12T10:37:04Z", "closed_at": "2020-08-12T10:37:03Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nThe command `flair.datasets.DANE()` fails with 403 status code\r\n\r\n**To Reproduce**\r\n```python\r\nimport flair.datasets\r\n\r\nflair.datasets.DANE()\r\n```\r\n**Expected behavior**\r\nIt should download the Danish NER datasets in train, dev, and test.\r\n\r\n**Screenshots**\r\n![image](https://user-images.githubusercontent.com/5762953/88786970-774aa600-d193-11ea-8ba7-88b37b0347ff.png)\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: macOS Catalina\r\n - Version [e.g. flair-0.3.2]: 0.5.1\r\n\r\n**Additional context**\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1782/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1782/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1777", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1777/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1777/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1777/events", "html_url": "https://github.com/flairNLP/flair/issues/1777", "id": 665397493, "node_id": "MDU6SXNzdWU2NjUzOTc0OTM=", "number": 1777, "title": "Loading data with ColumnCorpus causes CUDA out of memory, but loading flair dataset BIOFID runs fine, all other parameters the same", "user": {"login": "tylerlekang", "id": 20463434, "node_id": "MDQ6VXNlcjIwNDYzNDM0", "avatar_url": "https://avatars.githubusercontent.com/u/20463434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tylerlekang", "html_url": "https://github.com/tylerlekang", "followers_url": "https://api.github.com/users/tylerlekang/followers", "following_url": "https://api.github.com/users/tylerlekang/following{/other_user}", "gists_url": "https://api.github.com/users/tylerlekang/gists{/gist_id}", "starred_url": "https://api.github.com/users/tylerlekang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tylerlekang/subscriptions", "organizations_url": "https://api.github.com/users/tylerlekang/orgs", "repos_url": "https://api.github.com/users/tylerlekang/repos", "events_url": "https://api.github.com/users/tylerlekang/events{/privacy}", "received_events_url": "https://api.github.com/users/tylerlekang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-07-24T20:22:28Z", "updated_at": "2020-12-19T00:25:17Z", "closed_at": "2020-12-19T00:25:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI manually created train/valid(dev)/test sets as plain text files with 2 columns (space separated): 1-token and 2-custom ner tags with IOBES prefixes. All lines end with '\\n' and one line with only '\\n' , between sentences. This format has worked fine for me so far, by loading them using a direct call to the ColumnCorpus class.\r\n\r\nHowever, my run last night failed because of \"CUDA out of memory\" error.\r\n\r\nAs far as I can tell, my dataset is equivalent to the BIOFID format, as far as PyTorch is concerned. It results in the same in:512, out:28 sized (linear) layer. All the other parts of the network are defined by the embeddings, which I kept the same. All the parameters of ColumnCorpus, SequenceTagger, and ModelTrainer.train are kept the same.\r\n\r\nBut with the BIOFID corpus, it runs just fine.\r\n\r\n**To Reproduce**\r\nHere is the code that runs the training:\r\n\r\n```\r\n# Create ColumnCorpus from data\r\nfrom flair.datasets import ColumnCorpus\r\n\r\ncolumns = {0: 'text', 1: 'ner'}\r\ndata_folder = '/main/experiments/experiment_3/combined_data'\r\ncorpus = ColumnCorpus(data_folder, columns,\r\n                      train_file='train_IOBES_6',\r\n                      test_file='test_IOBES',\r\n                      dev_file='valid_IOBES_6',\r\n                     )\r\n\r\n# # Import BIOFID dataset as an example\r\n# from flair.datasets import BIOFID\r\n\r\n# corpus = BIOFID()\r\n\r\n# Make the tag dictionary from the corpus\r\ntag_dict = corpus.make_tag_dictionary(tag_type='ner')\r\n\r\n# Embeddings\r\nfrom flair.embeddings import WordEmbeddings, FlairEmbeddings, StackedEmbeddings\r\n\r\n# set Pytorch version to '1.6.0' due to a bug in Flair 0.5 for FlairEmbeddings\r\n# that cannot handle non-digits in the PyTorch version string\r\nimport torch\r\ntorch.__version__ = '1.6.0'\r\n\r\n# Initialize embeddings\r\nembs = [WordEmbeddings('glove'),\r\n        FlairEmbeddings('language_model/dgx.pt'), # based on news-forward\r\n        FlairEmbeddings('news-backward'),\r\n       ]\r\n\r\nstacked_embeddings = StackedEmbeddings(embs)\r\n\r\n# Initialize sequence tagger\r\nfrom flair.models import SequenceTagger\r\n\r\ntagger = SequenceTagger(hidden_size=256,\r\n                        embeddings=stacked_embeddings,\r\n                        tag_dictionary=tag_dict,\r\n                        tag_type='ner')\r\n\r\n# initialize trainer\r\nfrom flair.trainers import ModelTrainer\r\n\r\ntrainer = ModelTrainer(tagger, corpus)\r\n\r\n# Start training\r\ntrainer.train('/main/tagger_model',\r\n              max_epochs=100,\r\n              embeddings_storage_mode='gpu', # for DGX\r\n             )\r\n```\r\nComment out the different corpus lines, to choose which to load.\r\n\r\nIf doing a raw import in python of my data set lines, they all look like this:\r\n```\r\nThis O/n\r\nis O/n\r\na S-tag1/n\r\nsentence O/n\r\nthat B-tag2/n\r\nsays I-tag2/n\r\nwords E-tag2/n\r\nand O/n\r\nstuff O/n\r\nand O/n\r\nother S-tag3/n\r\nthings O/n\r\n. O/n\r\n/n\r\nNew O/n\r\nsentence O/n\r\n. O/n\r\n/n\r\n```\r\nAs I said, this has worked fine for me up until now.\r\n\r\n**Expected behavior**\r\nIt doesn't make any sense why if I load corpus with BIOFID, it runs fine. But if I load using direct ColumnCorpus, with a smaller data set, it fails for CUDA out of memory?\r\n\r\n**Screenshots**\r\nRunning the BIOFID data (which is larger), this happens:\r\n```\r\n2020-07-24 19:36:56,384 Reading data from /root/.flair/datasets/biofid\r\n2020-07-24 19:36:56,384 Train: /root/.flair/datasets/biofid/train.conll\r\n2020-07-24 19:36:56,384 Dev: /root/.flair/datasets/biofid/dev.conll\r\n2020-07-24 19:36:56,384 Test: /root/.flair/datasets/biofid/test.conll\r\n2020-07-24 19:37:10,757 ----------------------------------------------------------------------------------------------------\r\n2020-07-24 19:37:10,758 Model: \"SequenceTagger(\r\n  (embeddings): StackedEmbeddings(\r\n    (list_embedding_0): WordEmbeddings('glove')\r\n    (list_embedding_1): FlairEmbeddings(\r\n      (lm): LanguageModel(\r\n        (drop): Dropout(p=0.05, inplace=False)\r\n        (encoder): Embedding(300, 100)\r\n        (rnn): LSTM(100, 2048)\r\n        (decoder): Linear(in_features=2048, out_features=300, bias=True)\r\n      )\r\n    )\r\n    (list_embedding_2): FlairEmbeddings(\r\n      (lm): LanguageModel(\r\n        (drop): Dropout(p=0.05, inplace=False)\r\n        (encoder): Embedding(300, 100)\r\n        (rnn): LSTM(100, 2048)\r\n        (decoder): Linear(in_features=2048, out_features=300, bias=True)\r\n      )\r\n    )\r\n  )\r\n  (word_dropout): WordDropout(p=0.05)\r\n  (locked_dropout): LockedDropout(p=0.5)\r\n  (embedding2nn): Linear(in_features=4196, out_features=4196, bias=True)\r\n  (rnn): LSTM(4196, 256, batch_first=True, bidirectional=True)\r\n  (linear): Linear(in_features=512, out_features=28, bias=True)\r\n  (beta): 1.0\r\n  (weights): None\r\n  (weight_tensor) None\r\n)\"\r\n2020-07-24 19:37:10,758 ----------------------------------------------------------------------------------------------------\r\n2020-07-24 19:37:10,758 Corpus: \"Corpus: 12668 train + 1584 dev + 1584 test sentences\"\r\n2020-07-24 19:37:10,758 ----------------------------------------------------------------------------------------------------\r\n2020-07-24 19:37:10,758 Parameters:\r\n2020-07-24 19:37:10,759  - learning_rate: \"0.1\"\r\n2020-07-24 19:37:10,759  - mini_batch_size: \"32\"\r\n2020-07-24 19:37:10,759  - patience: \"3\"\r\n2020-07-24 19:37:10,759  - anneal_factor: \"0.5\"\r\n2020-07-24 19:37:10,759  - max_epochs: \"100\"\r\n2020-07-24 19:37:10,759  - shuffle: \"True\"\r\n2020-07-24 19:37:10,759  - train_with_dev: \"False\"\r\n2020-07-24 19:37:10,759  - batch_growth_annealing: \"False\"\r\n2020-07-24 19:37:10,759 ----------------------------------------------------------------------------------------------------\r\n2020-07-24 19:37:10,759 Model training base path: \"/main/tagger_model\"\r\n2020-07-24 19:37:10,760 ----------------------------------------------------------------------------------------------------\r\n2020-07-24 19:37:10,760 Device: cuda:0\r\n2020-07-24 19:37:10,760 ----------------------------------------------------------------------------------------------------\r\n2020-07-24 19:37:10,760 Embeddings storage mode: gpu\r\n2020-07-24 19:37:10,768 ----------------------------------------------------------------------------------------------------\r\n2020-07-24 19:37:27,231 epoch 1 - iter 39/396 - loss 33.68186672 - samples/sec: 75.83\r\n2020-07-24 19:37:47,254 epoch 1 - iter 78/396 - loss 31.62588775 - samples/sec: 64.39\r\n2020-07-24 19:38:03,018 epoch 1 - iter 117/396 - loss 28.28389192 - samples/sec: 82.45\r\n2020-07-24 19:38:20,701 epoch 1 - iter 156/396 - loss 26.10188338 - samples/sec: 73.24\r\n2020-07-24 19:38:37,111 epoch 1 - iter 195/396 - loss 24.65146203 - samples/sec: 79.35\r\n2020-07-24 19:38:55,441 epoch 1 - iter 234/396 - loss 23.43243355 - samples/sec: 70.57\r\n2020-07-24 19:39:16,644 epoch 1 - iter 273/396 - loss 22.45316207 - samples/sec: 61.05\r\n2020-07-24 19:39:32,507 epoch 1 - iter 312/396 - loss 21.40785006 - samples/sec: 82.18\r\n2020-07-24 19:39:50,482 epoch 1 - iter 351/396 - loss 20.65745848 - samples/sec: 72.04\r\n2020-07-24 19:40:07,186 epoch 1 - iter 390/396 - loss 19.95446966 - samples/sec: 77.82\r\n2020-07-24 19:40:09,851 ----------------------------------------------------------------------------------------------------\r\n2020-07-24 19:40:09,851 EPOCH 1 done: loss 19.8492 - lr 0.1000000\r\n2020-07-24 19:40:18,529 DEV : loss 9.141180038452148 - score 0.3995\r\n2020-07-24 19:40:18,544 BAD EPOCHS (no improvement): 0\r\nsaving best model\r\n2020-07-24 19:40:22,735 ----------------------------------------------------------------------------------------------------\r\n2020-07-24 19:40:31,986 epoch 2 - iter 39/396 - loss 12.15399767 - samples/sec: 134.99\r\n2020-07-24 19:40:43,023 epoch 2 - iter 78/396 - loss 12.09782454 - samples/sec: 120.13\r\n^C2020-07-24 19:40:46,969 ----------------------------------------------------------------------------------------------------\r\n2020-07-24 19:40:46,970 Exiting from training early.\r\n2020-07-24 19:40:46,970 Saving model ...\r\n2020-07-24 19:40:51,071 Done.\r\n2020-07-24 19:40:51,072 ----------------------------------------------------------------------------------------------------\r\n2020-07-24 19:40:51,072 Testing using best model ...\r\n2020-07-24 19:40:51,073 loading file /main/tagger_model/best-model.pt\r\n2020-07-24 19:41:04,678 0.4290  0.3603  0.3917\r\n2020-07-24 19:41:04,679\r\nMICRO_AVG: acc 0.3920 - f1-score 0.3917\r\nMACRO_AVG: acc 0.3202 - f1-score 0.3197\r\nLOC        tp: 90 - fp: 192 - fn: 640 - tn: 94 - precision: 0.3191 - recall: 0.1233 - accuracy: 0.1811 - f1-score: 0.1779\r\nORG        tp: 0 - fp: 16 - fn: 72 - tn: 0 - precision: 0.0000 - recall: 0.0000 - accuracy: 0.0000 - f1-score: 0.0000\r\nOTHER      tp: 83 - fp: 259 - fn: 707 - tn: 83 - precision: 0.2427 - recall: 0.1051 - accuracy: 0.1466 - f1-score: 0.1466\r\nPER        tp: 179 - fp: 230 - fn: 217 - tn: 179 - precision: 0.4377 - recall: 0.4520 - accuracy: 0.4447 - f1-score: 0.4447\r\nTAX        tp: 703 - fp: 1024 - fn: 672 - tn: 705 - precision: 0.4071 - recall: 0.5113 - accuracy: 0.4536 - f1-score: 0.4533\r\nTME        tp: 337 - fp: 132 - fn: 163 - tn: 335 - precision: 0.7186 - recall: 0.6740 - accuracy: 0.6949 - f1-score: 0.6956\r\n2020-07-24 19:41:04,679 ----------------------------------------------------------------------------------------------------\r\n```\r\n(note: I only let it run for 1 epoch here, but assume that if it makes it through an epoch then CUDA out of memory won't happen, I have let it run for a few epochs as well and no error)\r\n\r\nRunning my data (which is smaller), this happens:\r\n```\r\n2020-07-24 19:44:31,034 Reading data from /main/experiments/experiment_3/combined_data\r\n2020-07-24 19:44:31,034 Train: /main/experiments/experiment_3/combined_data/train_IOBES_6\r\n2020-07-24 19:44:31,034 Dev: /main/experiments/experiment_3/combined_data/valid_IOBES_6\r\n2020-07-24 19:44:31,034 Test: /main/experiments/experiment_3/combined_data/test_IOBES\r\n2020-07-24 19:44:40,912 ----------------------------------------------------------------------------------------------------\r\n2020-07-24 19:44:40,913 Model: \"SequenceTagger(\r\n  (embeddings): StackedEmbeddings(\r\n    (list_embedding_0): WordEmbeddings('glove')\r\n    (list_embedding_1): FlairEmbeddings(\r\n      (lm): LanguageModel(\r\n        (drop): Dropout(p=0.05, inplace=False)\r\n        (encoder): Embedding(300, 100)\r\n        (rnn): LSTM(100, 2048)\r\n        (decoder): Linear(in_features=2048, out_features=300, bias=True)\r\n      )\r\n    )\r\n    (list_embedding_2): FlairEmbeddings(\r\n      (lm): LanguageModel(\r\n        (drop): Dropout(p=0.05, inplace=False)\r\n        (encoder): Embedding(300, 100)\r\n        (rnn): LSTM(100, 2048)\r\n        (decoder): Linear(in_features=2048, out_features=300, bias=True)\r\n      )\r\n    )\r\n  )\r\n  (word_dropout): WordDropout(p=0.05)\r\n  (locked_dropout): LockedDropout(p=0.5)\r\n  (embedding2nn): Linear(in_features=4196, out_features=4196, bias=True)\r\n  (rnn): LSTM(4196, 256, batch_first=True, bidirectional=True)\r\n  (linear): Linear(in_features=512, out_features=28, bias=True)\r\n  (beta): 1.0\r\n  (weights): None\r\n  (weight_tensor) None\r\n)\"\r\n2020-07-24 19:44:40,913 ----------------------------------------------------------------------------------------------------\r\n2020-07-24 19:44:40,913 Corpus: \"Corpus: 7614 train + 846 dev + 70 test sentences\"\r\n2020-07-24 19:44:40,913 ----------------------------------------------------------------------------------------------------\r\n2020-07-24 19:44:40,913 Parameters:\r\n2020-07-24 19:44:40,913  - learning_rate: \"0.1\"\r\n2020-07-24 19:44:40,913  - mini_batch_size: \"32\"\r\n2020-07-24 19:44:40,913  - patience: \"3\"\r\n2020-07-24 19:44:40,914  - anneal_factor: \"0.5\"\r\n2020-07-24 19:44:40,914  - max_epochs: \"100\"\r\n2020-07-24 19:44:40,914  - shuffle: \"True\"\r\n2020-07-24 19:44:40,914  - train_with_dev: \"False\"\r\n2020-07-24 19:44:40,914  - batch_growth_annealing: \"False\"\r\n2020-07-24 19:44:40,914 ----------------------------------------------------------------------------------------------------\r\n2020-07-24 19:44:40,914 Model training base path: \"/main/tagger_model\"\r\n2020-07-24 19:44:40,914 ----------------------------------------------------------------------------------------------------\r\n2020-07-24 19:44:40,914 Device: cuda:0\r\n2020-07-24 19:44:40,914 ----------------------------------------------------------------------------------------------------\r\n2020-07-24 19:44:40,914 Embeddings storage mode: gpu\r\n2020-07-24 19:44:40,920 ----------------------------------------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"train_taggerModel.py\", line 60, in <module>\r\n    embeddings_storage_mode='gpu', # for DGX\r\n  File \"/opt/conda/lib/python3.6/site-packages/flair/trainers/trainer.py\", line 349, in train\r\n    loss = self.model.forward_loss(batch_step)\r\n  File \"/opt/conda/lib/python3.6/site-packages/flair/models/sequence_tagger_model.py\", line 509, in forward_loss\r\n    return self._calculate_loss(features, data_points)\r\n  File \"/opt/conda/lib/python3.6/site-packages/flair/models/sequence_tagger_model.py\", line 643, in _calculate_loss\r\n    forward_score = self._forward_alg(features, lengths)\r\n  File \"/opt/conda/lib/python3.6/site-packages/flair/models/sequence_tagger_model.py\", line 840, in _forward_alg\r\n    cloned = forward_var.clone()\r\nRuntimeError: CUDA out of memory. Tried to allocate 12.00 MiB (GPU 0; 31.72 GiB total capacity; 30.56 GiB already allocated; 11.88 MiB free; 30.64 GiB reserved in total by PyTorch)\r\n```\r\n\r\n**Environment (please complete the following information):**\r\nAll code is running in Docker container maintained by Nvidia for PyTorch: https://docs.nvidia.com/deeplearning/frameworks/pytorch-release-notes/rel_20-06.html#rel_20-06\r\n- Ubuntu 18.04\r\n- Python 3.6.10\r\n- PyTorch 1.6.0a0+9907a3e\r\n\r\nAnd I built the image using Flair 0.5.0", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1777/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1777/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1768", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1768/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1768/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1768/events", "html_url": "https://github.com/flairNLP/flair/issues/1768", "id": 659995626, "node_id": "MDU6SXNzdWU2NTk5OTU2MjY=", "number": 1768, "title": "Inconsistent tokenizer use cause bad predictions ...", "user": {"login": "sankaran45", "id": 8388863, "node_id": "MDQ6VXNlcjgzODg4NjM=", "avatar_url": "https://avatars.githubusercontent.com/u/8388863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sankaran45", "html_url": "https://github.com/sankaran45", "followers_url": "https://api.github.com/users/sankaran45/followers", "following_url": "https://api.github.com/users/sankaran45/following{/other_user}", "gists_url": "https://api.github.com/users/sankaran45/gists{/gist_id}", "starred_url": "https://api.github.com/users/sankaran45/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sankaran45/subscriptions", "organizations_url": "https://api.github.com/users/sankaran45/orgs", "repos_url": "https://api.github.com/users/sankaran45/repos", "events_url": "https://api.github.com/users/sankaran45/events{/privacy}", "received_events_url": "https://api.github.com/users/sankaran45/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-07-18T08:08:43Z", "updated_at": "2020-08-13T13:45:32Z", "closed_at": "2020-08-13T13:10:43Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI have a CSV training/test files that i use CSVClassificationCorpus to load and then train etc. The evaluate that runs after training works fine. Then i manually load the CSV file and for each line, i call Sentence(...) and then pass it to predict function. This time the results are arbitrary and poor. \r\n\r\nI looked at it a bit, and it turned out that by default Sentence uses SpaceTokenizer (if no use_tokenizer parameter) is passed.\r\n\r\nOTOH, CSVClassificationCorpus uses SegtokTokenizer by default ...\r\n\r\nLeading to completely different results in the default case of not specifying these parameters.\r\n\r\nSo i fixed it by passing use_tokenize=SegtokTokenizer to my Sentence call before invoking predict\r\n\r\nQuite counter-intutitive .. not necessarily a bug but posting in case some one else runs into same issue\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1768/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1768/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1767", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1767/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1767/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1767/events", "html_url": "https://github.com/flairNLP/flair/issues/1767", "id": 659932971, "node_id": "MDU6SXNzdWU2NTk5MzI5NzE=", "number": 1767, "title": "Loading checkpoint created with Flair0.4.5 fails in new Flair 0.5.1", "user": {"login": "sankaran45", "id": 8388863, "node_id": "MDQ6VXNlcjgzODg4NjM=", "avatar_url": "https://avatars.githubusercontent.com/u/8388863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sankaran45", "html_url": "https://github.com/sankaran45", "followers_url": "https://api.github.com/users/sankaran45/followers", "following_url": "https://api.github.com/users/sankaran45/following{/other_user}", "gists_url": "https://api.github.com/users/sankaran45/gists{/gist_id}", "starred_url": "https://api.github.com/users/sankaran45/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sankaran45/subscriptions", "organizations_url": "https://api.github.com/users/sankaran45/orgs", "repos_url": "https://api.github.com/users/sankaran45/repos", "events_url": "https://api.github.com/users/sankaran45/events{/privacy}", "received_events_url": "https://api.github.com/users/sankaran45/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-07-18T05:57:56Z", "updated_at": "2020-07-31T14:40:23Z", "closed_at": "2020-07-31T14:40:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI have an old checkpoint file created with Flair 0.4.5 that i tried to load with Flair 0.5.1 and it fails\r\n\r\nMainly its due to the issue here in text_classification_model .. if i comment out the last two lines it works fine .. i suspect they probably don't exist in the old checkpoint ???\r\n\r\n    def __str__(self):\r\n        return super(flair.nn.Model, self).__str__().rstrip(')') + \\\r\n               f'  (beta): {self.beta}\\n' + \\\r\n               f'  (weights): {self.weight_dict}\\n' + \\\r\n               f'  (weight_tensor) {self.loss_weights}\\n)'\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1767/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1767/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1765", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1765/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1765/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1765/events", "html_url": "https://github.com/flairNLP/flair/issues/1765", "id": 659721776, "node_id": "MDU6SXNzdWU2NTk3MjE3NzY=", "number": 1765, "title": "Wassa - UnicodeDecodeError: 'charmap' codec can't decode byte 0x81 in position 2280: character maps to <undefined>", "user": {"login": "Greg-Tarr", "id": 43277605, "node_id": "MDQ6VXNlcjQzMjc3NjA1", "avatar_url": "https://avatars.githubusercontent.com/u/43277605?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Greg-Tarr", "html_url": "https://github.com/Greg-Tarr", "followers_url": "https://api.github.com/users/Greg-Tarr/followers", "following_url": "https://api.github.com/users/Greg-Tarr/following{/other_user}", "gists_url": "https://api.github.com/users/Greg-Tarr/gists{/gist_id}", "starred_url": "https://api.github.com/users/Greg-Tarr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Greg-Tarr/subscriptions", "organizations_url": "https://api.github.com/users/Greg-Tarr/orgs", "repos_url": "https://api.github.com/users/Greg-Tarr/repos", "events_url": "https://api.github.com/users/Greg-Tarr/events{/privacy}", "received_events_url": "https://api.github.com/users/Greg-Tarr/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-07-17T23:11:21Z", "updated_at": "2020-08-04T20:01:28Z", "closed_at": "2020-08-04T20:01:28Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nIt is a UnicodeDecodeError that occurs when using the flair.datasets.WASSA datasets.\r\n\r\nCan be seen here:\r\n\r\n> \u03bb python wassa-sad.py\r\n2020-07-17 23:49:59,174 http://saifmohammad.com/WebDocs/EmoInt%20Train%20Data/sadness-ratings-0to1.train.txt not found in cache, downloading to C:\\Users\\me\\AppData\\Local\\Temp\\tmpqf9ay00c\r\n92977B [00:00, 211589.48B/s]\r\n2020-07-17 23:49:59,950 copying C:\\Users\\me\\AppData\\Local\\Temp\\tmpqf9ay00c to cache at C:\\Users\\me\\.flair\\datasets\\wassa_sadness\\sadness-ratings-0to1.train.txt\r\n2020-07-17 23:49:59,960 removing temp file C:\\Users\\me\\AppData\\Local\\Temp\\tmpqf9ay00c\r\nTraceback (most recent call last):\r\n  File \"wassa-sadness2-pooled.py\", line 15, in <module>\r\n    corpus = WASSA_SADNESS()\r\n  File \"D:\\Programs\\Python\\Python37\\lib\\site-packages\\flair\\datasets\\document_classification.py\", line 1607, in __init__\r\n    _download_wassa_if_not_there(\"sadness\", data_folder, dataset_name)\r\n  File \"D:\\Programs\\Python\\Python37\\lib\\site-packages\\flair\\datasets\\document_classification.py\", line 1466, in _download_wassa_if_not_there\r\n    next(f)\r\n  File \"D:\\Programs\\Python\\Python37\\lib\\encodings\\cp1252.py\", line 23, in decode\r\n    return codecs.charmap_decode(input,self.errors,decoding_table)[0]\r\nUnicodeDecodeError: 'charmap' codec can't decode byte 0x81 in position 2280: character maps to <undefined>\r\n\r\n**To Reproduce**\r\n`from flair.datasets import WASSA_SADNESS`\r\n`corpus = WASSA_SADNESS()`\r\n\r\n**Expected behavior**\r\nThe above error will occur due to the encoding left unspecified on lines 1464, 1465 in flair.datasets.document_classification.py\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Windows 10 - Python 3.7.4\r\n - Version [e.g. flair-0.3.2]: 0.5.1 - but appears in non-master branches\r\n\r\n**Additional context**\r\nI changed the lines 1464, 1465 in flair.datasets.document_classification.py to include the encoding when opening files and it has solved the problem:\r\n\r\n```\r\n1464:   with open(path, \"r\", encoding=\"UTF-8\") as f:\r\n1465:       with open(data_file, \"w\", encoding=\"UTF-8\") as out:\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1765/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1765/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1763", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1763/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1763/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1763/events", "html_url": "https://github.com/flairNLP/flair/issues/1763", "id": 658571268, "node_id": "MDU6SXNzdWU2NTg1NzEyNjg=", "number": 1763, "title": "Cannot train custom SequenceTagger with gpt2 embeddings", "user": {"login": "nuradilK", "id": 26120466, "node_id": "MDQ6VXNlcjI2MTIwNDY2", "avatar_url": "https://avatars.githubusercontent.com/u/26120466?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nuradilK", "html_url": "https://github.com/nuradilK", "followers_url": "https://api.github.com/users/nuradilK/followers", "following_url": "https://api.github.com/users/nuradilK/following{/other_user}", "gists_url": "https://api.github.com/users/nuradilK/gists{/gist_id}", "starred_url": "https://api.github.com/users/nuradilK/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nuradilK/subscriptions", "organizations_url": "https://api.github.com/users/nuradilK/orgs", "repos_url": "https://api.github.com/users/nuradilK/repos", "events_url": "https://api.github.com/users/nuradilK/events{/privacy}", "received_events_url": "https://api.github.com/users/nuradilK/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-07-16T21:07:27Z", "updated_at": "2020-11-22T18:17:02Z", "closed_at": "2020-11-22T18:17:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nDuring training of custom POS tagger with OpenAIGPT2Embeddings, I faced an error TypeError: reduce() of empty sequence with no initial value. \r\n\r\nsetup:\r\n```\r\ndevice = torch.device('cuda')\r\ncorpus: Corpus = UD_ENGLISH().downsample(0.1)\r\ntag_type = 'pos'\r\ntag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\nembedding_types = [\r\n        OpenAIGPT2Embeddings('gpt2')\r\n    ]\r\nembeddings: StackedEmbeddings = StackedEmbeddings(embeddings=embedding_types)\r\n\r\ntagger = flair.models.SequenceTagger(tag_type=tag_type, embeddings=embeddings, hidden_size=256, tag_dictionary=tag_dictionary, use_crf=True)\r\n\r\ntrainer: ModelTrainer = ModelTrainer(tagger, corpus, optimizer=Adam)\r\n\r\ntrainer.train('/content/tagger',\r\n              learning_rate=0.1,\r\n              mini_batch_size=32,\r\n              max_epochs=150)\r\n```\r\n\r\n\r\n**Environment (please complete the following information):**\r\n  flair==(0.5.1)\r\n\r\n**Additional context**\r\n The interesting thing is that the error appears after the first iterations.\r\n```\r\n2020-07-16 21:01:46,343 epoch 1 - iter 4/40 - loss 111.77373695 - samples/sec: 49.46\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-52-c0841eba0f76> in <module>()\r\n      4               learning_rate=0.1,\r\n      5               mini_batch_size=32,\r\n----> 6               max_epochs=150)\r\n\r\n1 frames\r\n/usr/local/lib/python3.6/dist-packages/flair/training_utils.py in extract_weights(self, state_dict, iteration)\r\n    264             vec = state_dict[key]\r\n    265             weights_to_watch = min(\r\n--> 266                 self.number_of_weights, reduce(lambda x, y: x * y, list(vec.size()))\r\n    267             )\r\n    268 \r\n\r\nTypeError: reduce() of empty sequence with no initial value\r\n```", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1763/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1763/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1753", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1753/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1753/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1753/events", "html_url": "https://github.com/flairNLP/flair/issues/1753", "id": 654060707, "node_id": "MDU6SXNzdWU2NTQwNjA3MDc=", "number": 1753, "title": "classifier unable to make predictions when using elmo embeddings", "user": {"login": "ud2195", "id": 42403625, "node_id": "MDQ6VXNlcjQyNDAzNjI1", "avatar_url": "https://avatars.githubusercontent.com/u/42403625?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ud2195", "html_url": "https://github.com/ud2195", "followers_url": "https://api.github.com/users/ud2195/followers", "following_url": "https://api.github.com/users/ud2195/following{/other_user}", "gists_url": "https://api.github.com/users/ud2195/gists{/gist_id}", "starred_url": "https://api.github.com/users/ud2195/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ud2195/subscriptions", "organizations_url": "https://api.github.com/users/ud2195/orgs", "repos_url": "https://api.github.com/users/ud2195/repos", "events_url": "https://api.github.com/users/ud2195/events{/privacy}", "received_events_url": "https://api.github.com/users/ud2195/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-07-09T13:27:45Z", "updated_at": "2020-08-12T21:15:08Z", "closed_at": "2020-08-12T21:15:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, I trained my text classifier using `ELMO pubmed` embeddings after training the model i am unable to predict on a gpu instance. The error and the code are mentioned below:-\r\n\r\nVersions:-\r\n```\r\nallennlp== 0.9.0\r\nflair== 0.5.1\r\n\r\n```\r\ncode-\r\n\r\n```\r\nfrom flair.models import TextClassifier\r\nfrom flair.data import Sentence\r\nimport pandas as pd \r\nclassifier = TextClassifier.load('/content/drive/My Drive/best-model (2).pt')\r\ndata=pd.read_csv('/content/sample_prediction.csv')\r\ndata.head()\r\npred=[]\r\n\r\nfor index, sample in data.iterrows():\r\n    sentence=Sentence(sample['sent'])\r\n    classifier.predict(sentence)\r\n    print(sentence.labels[0].value) \r\n    pred.append(sentence.labels[0].value)    \r\n\r\n```\r\n\r\ntraceback:-\r\n```\r\n\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-21-83d7f894d041> in <module>()\r\n      \r\n---->  classifier.predict(sentence)\r\n\r\n12 frames\r\n/usr/local/lib/python3.6/dist-packages/flair/models/text_classification_model.py in predict(self, sentences, mini_batch_size, multi_class_prob, verbose, label_name, return_loss, embedding_storage_mode)\r\n    220                     continue\r\n    221 \r\n--> 222                 scores = self.forward(batch)\r\n    223 \r\n    224                 if return_loss:\r\n\r\n/usr/local/lib/python3.6/dist-packages/flair/models/text_classification_model.py in forward(self, sentences)\r\n     97     def forward(self, sentences):\r\n     98 \r\n---> 99         self.document_embeddings.embed(sentences)\r\n    100 \r\n    101         embedding_names = self.document_embeddings.get_names()\r\n\r\n/usr/local/lib/python3.6/dist-packages/flair/embeddings/legacy.py in embed(self, sentences)\r\n   1423         sentences.sort(key=lambda x: len(x), reverse=True)\r\n   1424 \r\n-> 1425         self.embeddings.embed(sentences)\r\n   1426 \r\n   1427         # first, sort sentences by number of tokens\r\n\r\n/usr/local/lib/python3.6/dist-packages/flair/embeddings/token.py in embed(self, sentences, static_embeddings)\r\n     69 \r\n     70         for embedding in self.embeddings:\r\n---> 71             embedding.embed(sentences)\r\n     72 \r\n     73     @property\r\n\r\n/usr/local/lib/python3.6/dist-packages/flair/embeddings/base.py in embed(self, sentences)\r\n     59 \r\n     60         if not everything_embedded or not self.static_embeddings:\r\n---> 61             self._add_embeddings_internal(sentences)\r\n     62 \r\n     63         return sentences\r\n\r\n/usr/local/lib/python3.6/dist-packages/flair/embeddings/token.py in _add_embeddings_internal(self, sentences)\r\n   1702             sentence_words.append([token.text for token in sentence])\r\n   1703 \r\n-> 1704         embeddings = self.ee.embed_batch(sentence_words)\r\n   1705 \r\n   1706         for i, sentence in enumerate(sentences):\r\n\r\n/usr/local/lib/python3.6/dist-packages/allennlp/commands/elmo.py in embed_batch(self, batch)\r\n    253         if batch == [[]]:\r\n    254             elmo_embeddings.append(empty_embedding())\r\n--> 255         else:\r\n    256             embeddings, mask = self.batch_to_embeddings(batch)\r\n    257             for i in range(len(batch)):\r\n\r\n/usr/local/lib/python3.6/dist-packages/allennlp/commands/elmo.py in batch_to_embeddings(self, batch)\r\n    195         if self.cuda_device >= 0:\r\n    196             character_ids = character_ids.cuda(device=self.cuda_device)\r\n--> 197 \r\n    198         bilm_output = self.elmo_bilm(character_ids)\r\n    199         layer_activations = bilm_output['activations']\r\n\r\n/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py in __call__(self, *input, **kwargs)\r\n    548             result = self._slow_forward(*input, **kwargs)\r\n    549         else:\r\n--> 550             result = self.forward(*input, **kwargs)\r\n    551         for hook in self._forward_hooks.values():\r\n    552             hook_result = hook(self, input, result)\r\n\r\n/usr/local/lib/python3.6/dist-packages/allennlp/modules/elmo.py in forward(self, inputs, word_inputs)\r\n    605                 type_representation = token_embedding['token_embedding']\r\n    606         else:\r\n--> 607             token_embedding = self._token_embedder(inputs)\r\n    608             mask = token_embedding['mask']\r\n    609             type_representation = token_embedding['token_embedding']\r\n\r\n/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py in __call__(self, *input, **kwargs)\r\n    548             result = self._slow_forward(*input, **kwargs)\r\n    549         else:\r\n--> 550             result = self.forward(*input, **kwargs)\r\n    551         for hook in self._forward_hooks.values():\r\n    552             hook_result = hook(self, input, result)\r\n\r\n/usr/local/lib/python3.6/dist-packages/allennlp/modules/elmo.py in forward(self, inputs)\r\n    357         character_embedding = torch.nn.functional.embedding(\r\n    358                 character_ids_with_bos_eos.view(-1, max_chars_per_token),\r\n--> 359                 self._char_embedding_weights\r\n    360         )\r\n    361 \r\n\r\n/usr/local/lib/python3.6/dist-packages/torch/nn/functional.py in embedding(input, weight, padding_idx, max_norm, norm_type, scale_grad_by_freq, sparse)\r\n   1722         # remove once script supports set_grad_enabled\r\n   1723         _no_grad_embedding_renorm_(weight, input, max_norm, norm_type)\r\n-> 1724     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)\r\n   1725 \r\n   1726 \r\n\r\nRuntimeError: Expected object of device type cuda but got device type cpu for argument #1 'self' in call to _th_index_select\r\n```\r\nwill really appreciate if someone can please help me out with this ? ", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1753/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1753/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1751", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1751/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1751/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1751/events", "html_url": "https://github.com/flairNLP/flair/issues/1751", "id": 654010700, "node_id": "MDU6SXNzdWU2NTQwMTA3MDA=", "number": 1751, "title": "Long sentences while training SequenceTagger with TransformerWordEmbeddings", "user": {"login": "djstrong", "id": 1849959, "node_id": "MDQ6VXNlcjE4NDk5NTk=", "avatar_url": "https://avatars.githubusercontent.com/u/1849959?v=4", "gravatar_id": "", "url": "https://api.github.com/users/djstrong", "html_url": "https://github.com/djstrong", "followers_url": "https://api.github.com/users/djstrong/followers", "following_url": "https://api.github.com/users/djstrong/following{/other_user}", "gists_url": "https://api.github.com/users/djstrong/gists{/gist_id}", "starred_url": "https://api.github.com/users/djstrong/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/djstrong/subscriptions", "organizations_url": "https://api.github.com/users/djstrong/orgs", "repos_url": "https://api.github.com/users/djstrong/repos", "events_url": "https://api.github.com/users/djstrong/events{/privacy}", "received_events_url": "https://api.github.com/users/djstrong/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-07-09T12:10:46Z", "updated_at": "2020-08-18T14:53:50Z", "closed_at": "2020-07-09T12:57:13Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Most of transformer models handle texts up to 512 subtokens. If we train SequenceTagger with a longer sentence then we get:\r\n```\r\nTraceback (most recent call last):\r\n  File \"train_tagger.py\", line 240, in <module>\r\n    anneal_with_restarts=args.anneal_with_restarts\r\n  File \"venv/lib/python3.7/site-packages/flair/trainers/trainer.py\", line 349, in train\r\n    loss = self.model.forward_loss(batch_step)\r\n  File \"venv/lib/python3.7/site-packages/flair/models/sequence_tagger_model.py\", line 599, in forward_loss\r\n    features = self.forward(data_points)\r\n  File \"venv/lib/python3.7/site-packages/flair/models/sequence_tagger_model.py\", line 604, in forward\r\n    self.embeddings.embed(sentences)\r\n  File \"venv/lib/python3.7/site-packages/flair/embeddings/token.py\", line 71, in embed\r\n    embedding.embed(sentences)\r\n  File \"venv/lib/python3.7/site-packages/flair/embeddings/base.py\", line 61, in embed\r\n    self._add_embeddings_internal(sentences)\r\n  File \"venv/lib/python3.7/site-packages/flair/embeddings/token.py\", line 897, in _add_embeddings_internal\r\n    self._add_embeddings_to_sentences(batch)\r\n  File \"venv/lib/python3.7/site-packages/flair/embeddings/token.py\", line 1053, in _add_embeddings_to_sentences\r\n    final_embedding: torch.FloatTensor = current_embeddings[0]\r\nIndexError: index 0 is out of bounds for dimension 0 with size 0\r\n```\r\nI am using flair master.\r\n\r\nIs there any automatic way of truncating such sentences?", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1751/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1751/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1748", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1748/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1748/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1748/events", "html_url": "https://github.com/flairNLP/flair/issues/1748", "id": 653853933, "node_id": "MDU6SXNzdWU2NTM4NTM5MzM=", "number": 1748, "title": "TextClassifier : reported metrics after training always report precision=1.0", "user": {"login": "GuillaumeDD", "id": 6253295, "node_id": "MDQ6VXNlcjYyNTMyOTU=", "avatar_url": "https://avatars.githubusercontent.com/u/6253295?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeDD", "html_url": "https://github.com/GuillaumeDD", "followers_url": "https://api.github.com/users/GuillaumeDD/followers", "following_url": "https://api.github.com/users/GuillaumeDD/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeDD/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeDD/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeDD/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeDD/orgs", "repos_url": "https://api.github.com/users/GuillaumeDD/repos", "events_url": "https://api.github.com/users/GuillaumeDD/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeDD/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2020-07-09T08:04:27Z", "updated_at": "2020-08-19T02:47:03Z", "closed_at": "2020-07-09T10:29:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nThe reported metrics after training always report precision=1.0.\r\n\r\n**To Reproduce**\r\n\r\nTraining code:\r\n```python\r\nfrom torch.optim.adam import Adam\r\n\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import TREC_6\r\nfrom flair.embeddings import TransformerDocumentEmbeddings\r\nfrom flair.models import TextClassifier\r\nfrom flair.trainers import ModelTrainer\r\n\r\n# 1. get the corpus\r\ncorpus: Corpus = TREC_6()\r\n\r\n# 2. create the label dictionary\r\nlabel_dict = corpus.make_label_dictionary()\r\n\r\n# 3. initialize transformer document embeddings (many models are available)\r\ndocument_embeddings = TransformerDocumentEmbeddings('distilbert-base-uncased', fine_tune=True)\r\n\r\n# 4. create the text classifier\r\nclassifier = TextClassifier(document_embeddings, label_dictionary=label_dict)\r\n\r\n# 5. initialize the text classifier trainer with Adam optimizer\r\ntrainer = ModelTrainer(classifier, corpus, optimizer=Adam)\r\n\r\n# 6. start the training\r\ntrainer.train('/tmp/taggers/trec',\r\n              learning_rate=3e-5, # use very small learning rate\r\n              mini_batch_size=16,\r\n              mini_batch_chunk_size=4, # optionally set this if transformer is too much for your machine\r\n              max_epochs=5, # terminate after 5 epochs\r\n              )\r\n ```\r\n\r\nExample of produced report:\r\n```text\r\n2020-07-09 09:50:21,395 Testing using best model ...\r\n2020-07-09 09:50:21,395 loading file /tmp/taggers/trec/best-model.pt\r\n2020-07-09 09:50:27,486         0.964\r\n2020-07-09 09:50:27,487 \r\nResults:\r\n- F-score (micro) 0.9823\r\n- F-score (macro) 0.9745\r\n- Accuracy 0.964\r\n\r\nBy class:\r\n              precision    recall  f1-score   support\r\n\r\n        DESC     1.0000    0.9931    0.9965       145\r\n        ENTY     1.0000    0.8750    0.9333        96\r\n        ABBR     1.0000    0.8889    0.9412         9\r\n         HUM     1.0000    0.9851    0.9925        67\r\n         NUM     1.0000    0.9915    0.9957       117\r\n         LOC     1.0000    0.9762    0.9880        84\r\n\r\n   micro avg     1.0000    0.9653    0.9823       518\r\n   macro avg     1.0000    0.9516    0.9745       518\r\nweighted avg     1.0000    0.9653    0.9818       518\r\n samples avg     1.0000    0.9820    0.9880       518\r\n\r\n2020-07-09 09:50:27,487 ----------------------------------------------------------------------------------------------------\r\n```\r\n\r\n\r\n**Expected behavior**\r\nReports correct metrics.\r\n\r\n**Screenshots**\r\nN/A\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: CentOS\r\n - Version: flair 0.5.1, scikit-learn==0.23.1\r\n\r\n**Additional context**\r\nSame problem with other datasets.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1748/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1748/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1747", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1747/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1747/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1747/events", "html_url": "https://github.com/flairNLP/flair/issues/1747", "id": 653369129, "node_id": "MDU6SXNzdWU2NTMzNjkxMjk=", "number": 1747, "title": "OSError when trying to load model trained on another commputer", "user": {"login": "Nighthyst", "id": 38282930, "node_id": "MDQ6VXNlcjM4MjgyOTMw", "avatar_url": "https://avatars.githubusercontent.com/u/38282930?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nighthyst", "html_url": "https://github.com/Nighthyst", "followers_url": "https://api.github.com/users/Nighthyst/followers", "following_url": "https://api.github.com/users/Nighthyst/following{/other_user}", "gists_url": "https://api.github.com/users/Nighthyst/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nighthyst/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nighthyst/subscriptions", "organizations_url": "https://api.github.com/users/Nighthyst/orgs", "repos_url": "https://api.github.com/users/Nighthyst/repos", "events_url": "https://api.github.com/users/Nighthyst/events{/privacy}", "received_events_url": "https://api.github.com/users/Nighthyst/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 18, "created_at": "2020-07-08T14:59:29Z", "updated_at": "2020-12-02T14:30:32Z", "closed_at": "2020-12-02T14:30:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI trained a sequence tagger model using CamemBERT with a AWS EC2 instance (Ubuntu). When I try to load the model from my computer I  have this error : \r\n\r\n```\r\n---------------------------------------------------------------------------\r\nOSError                                   Traceback (most recent call last)\r\n<ipython-input-5-2f413379aedd> in <module>\r\n      6 \r\n      7 # load the NER tagger\r\n----> 8 tagger = SequenceTagger.load('best-model.pt')\r\n      9 \r\n     10 \r\n\r\nc:\\users\\nicod\\miniconda3\\lib\\site-packages\\flair\\nn.py in load(cls, model)\r\n     86             # see https://github.com/zalandoresearch/flair/issues/351\r\n     87             f = file_utils.load_big_file(str(model_file))\r\n---> 88             state = torch.load(f, map_location='cpu')\r\n     89 \r\n     90         model = cls._init_model_with_state_dict(state)\r\n\r\nc:\\users\\nicod\\miniconda3\\lib\\site-packages\\torch\\serialization.py in load(f, map_location, pickle_module, **pickle_load_args)\r\n    527             with _open_zipfile_reader(f) as opened_zipfile:\r\n    528                 return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)\r\n--> 529         return _legacy_load(opened_file, map_location, pickle_module, **pickle_load_args)\r\n    530 \r\n    531 \r\n\r\nc:\\users\\nicod\\miniconda3\\lib\\site-packages\\torch\\serialization.py in _legacy_load(f, map_location, pickle_module, **pickle_load_args)\r\n    700     unpickler = pickle_module.Unpickler(f, **pickle_load_args)\r\n    701     unpickler.persistent_load = persistent_load\r\n--> 702     result = unpickler.load()\r\n    703 \r\n    704     deserialized_storage_keys = pickle_module.load(f, **pickle_load_args)\r\n\r\nc:\\users\\nicod\\miniconda3\\lib\\site-packages\\transformers\\tokenization_camembert.py in __setstate__(self, d)\r\n    259             raise\r\n    260         self.sp_model = spm.SentencePieceProcessor()\r\n--> 261         self.sp_model.Load(self.vocab_file)\r\n    262 \r\n    263     def convert_tokens_to_string(self, tokens):\r\n\r\nc:\\users\\nicod\\miniconda3\\lib\\site-packages\\sentencepiece.py in Load(self, model_file, model_proto)\r\n    365       if model_proto:\r\n    366         return self.LoadFromSerializedProto(model_proto)\r\n--> 367       return self.LoadFromFile(model_file)\r\n    368 \r\n    369 \r\n\r\nc:\\users\\nicod\\miniconda3\\lib\\site-packages\\sentencepiece.py in LoadFromFile(self, arg)\r\n    175 \r\n    176     def LoadFromFile(self, arg):\r\n--> 177         return _sentencepiece.SentencePieceProcessor_LoadFromFile(self, arg)\r\n    178 \r\n    179     def Init(self,\r\n\r\nOSError: Not found: \"/home/ubuntu/.cache/torch/transformers/3715e3a4a2de48834619b2a6f48979e13ddff5cabfb1f3409db689f9ce3bb98f.28d30f926f545047fc59da64289371eef0fbdc0764ce9ec56f808a646fcfec59\": No such file or directory Error #2\r\n```\r\n\r\nFlair is searching a file in my computer that was visibly in the Ubuntu instance so I can't load the model. If I try to load the model from the Ubuntu instance, everything works.\r\n\r\n**To Reproduce**\r\n\r\nHere is my code to train the model : \r\n\r\n```Python\r\nfrom flair.embeddings import TransformerWordEmbeddings\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import ColumnCorpus\r\nimport torch\r\n\r\ndef trainCamembert():\r\n    torch.multiprocessing.freeze_support()\r\n    # define columns\r\n    columns = {0: 'text', 1: 'pos', 2: 'ner'}\r\n\r\n    # this is the folder in which train, test and dev files reside\r\n    data_folder = 'wikiner'\r\n\r\n    # init a corpus using column format, data folder and the names of the train, dev and test files\r\n    corpus = ColumnCorpus(data_folder =data_folder,\r\n                          column_format=columns,\r\n                          train_file='train.txt',\r\n                          test_file='test.txt',\r\n                          in_memory=True)\r\n\r\n\r\n    # 1. get the corpus\r\n    print(corpus)\r\n\r\n    # 2. what tag do we want to predict?\r\n    tag_type = 'ner'\r\n\r\n    # 3. make the tag dictionary from the corpus\r\n    tag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\n    print(tag_dictionary)\r\n\r\n    # 4. initialize embeddings\r\n    embeddings = TransformerWordEmbeddings('camembert-base',\r\n                                           layers='all',\r\n                                           use_scalar_mix=True,\r\n                                           pooling_operation='mean')\r\n\r\n    # 5. initialize sequence tagger\r\n    from flair.models import SequenceTagger\r\n\r\n    tagger: SequenceTagger = SequenceTagger(hidden_size=256,\r\n                                            embeddings=embeddings,\r\n                                            tag_dictionary=tag_dictionary,\r\n                                            tag_type=tag_type,\r\n                                            use_crf=True)\r\n\r\n    # 6. initialize trainer\r\n    from flair.trainers import ModelTrainer\r\n\r\n    trainer: ModelTrainer = ModelTrainer(tagger, corpus)\r\n\r\n    # 7. start training\r\n    trainer.train('example-ner-camtest',\r\n                  learning_rate=0.1,\r\n                  mini_batch_size=32,\r\n                  max_epochs=150,\r\n                  embeddings_storage_mode=\"gpu\",\r\n                  monitor_test=True,\r\n                  checkpoint=True)\r\n\r\nif __name__==\"__main__\":\r\n    trainCamembert()\r\n```\r\n\r\nand to load the model (on Windows) : \r\n\r\n```Python\r\nfrom flair.models import SequenceTagger\r\n\r\n# load the NER tagger\r\ntagger = SequenceTagger.load('best-model.pt')\r\n```\r\n\r\n**Expected behavior**\r\nThe model is loaded and I can make prediction with it from another computer than the one used to train.\r\n\r\n\r\n**Environment (On my computer):**\r\n - OS [e.g. iOS, Linux]: Windows 10 Family\r\n - Version [e.g. flair-0.3.2]: flair 0.5.1 (updated with master branch)\r\n\r\n\r\n**Environment (On the AWS Instance):**\r\n - OS [e.g. iOS, Linux]: Ubuntu 16.04\r\n - Version [e.g. flair-0.3.2]: flair 0.5.1 (updated with master branch)\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1747/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1747/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1744", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1744/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1744/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1744/events", "html_url": "https://github.com/flairNLP/flair/issues/1744", "id": 651858296, "node_id": "MDU6SXNzdWU2NTE4NTgyOTY=", "number": 1744, "title": "FlairEmbeddings function gives ValueError in python 3.6 (latest Nvidia Pytorch Docker container)", "user": {"login": "tylerlekang", "id": 20463434, "node_id": "MDQ6VXNlcjIwNDYzNDM0", "avatar_url": "https://avatars.githubusercontent.com/u/20463434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tylerlekang", "html_url": "https://github.com/tylerlekang", "followers_url": "https://api.github.com/users/tylerlekang/followers", "following_url": "https://api.github.com/users/tylerlekang/following{/other_user}", "gists_url": "https://api.github.com/users/tylerlekang/gists{/gist_id}", "starred_url": "https://api.github.com/users/tylerlekang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tylerlekang/subscriptions", "organizations_url": "https://api.github.com/users/tylerlekang/orgs", "repos_url": "https://api.github.com/users/tylerlekang/repos", "events_url": "https://api.github.com/users/tylerlekang/events{/privacy}", "received_events_url": "https://api.github.com/users/tylerlekang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2020-07-06T22:33:16Z", "updated_at": "2020-07-09T08:34:57Z", "closed_at": "2020-07-09T08:34:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nSimply running the code ```FlairEmbeddings('news-forward')``` gives a ```ValueError```, in Python 3.6.10 (Conda), which is the python environment included in the most recent PyTorch Docker container from Nvidia. (https://docs.nvidia.com/deeplearning/frameworks/pytorch-release-notes/rel_20-06.html#rel_20-06)\r\n\r\nHere is the error message:\r\n```\r\nTraceback (most recent call last):\r\n  File \"fineTune_langModel.py\", line 10, in <module>\r\n    language_model = FlairEmbeddings('news-forward').lm\r\n  File \"/opt/conda/lib/python3.6/site-packages/flair/embeddings/token.py\", line 578, in __init__\r\n    self.lm: LanguageModel = LanguageModel.load_language_model(model)\r\n  File \"/opt/conda/lib/python3.6/site-packages/flair/models/language_model.py\", line 202, in load_language_model\r\n    dropout=state[\"dropout\"],\r\n  File \"/opt/conda/lib/python3.6/site-packages/flair/models/language_model.py\", line 63, in __init__\r\n    self.to(flair.device)\r\n  File \"/opt/conda/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 465, in to\r\n    return self._apply(convert)\r\n  File \"/opt/conda/lib/python3.6/site-packages/flair/models/language_model.py\", line 404, in _apply\r\n    for info in torch.__version__.replace(\"+\",\".\").split('.') if info.isdigit())\r\nValueError: not enough values to unpack (expected at least 3, got 2)\r\n```\r\n\r\n\r\n**To Reproduce**\r\nRun this code in the container (after pip installing flair):\r\n```from flair.embeddings import FlairEmbeddings```\r\n```FlairEmbeddings('news-forward')```\r\n\r\n**Expected behavior**\r\nThe function should work with no problems (in particular, the .lm is intended to be given to the LanguageModelTrainer function).\r\n\r\n**Environment (please complete the following information):**\r\n- Docker container running Linux (all details of Ubuntu, Python, PyTorch, etc. versions is in the Nvidia link above)\r\n- Flair version is 0.5\r\n\r\n**Additional context**\r\nRunning the code in Python 3.7.7 (Conda) gives no problems.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1744/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1744/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1743", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1743/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1743/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1743/events", "html_url": "https://github.com/flairNLP/flair/issues/1743", "id": 651371160, "node_id": "MDU6SXNzdWU2NTEzNzExNjA=", "number": 1743, "title": "AttributeError: 'BertTokenizer' object has no attribute 'unique_no_split_tokens'", "user": {"login": "plc-dev", "id": 33401663, "node_id": "MDQ6VXNlcjMzNDAxNjYz", "avatar_url": "https://avatars.githubusercontent.com/u/33401663?v=4", "gravatar_id": "", "url": "https://api.github.com/users/plc-dev", "html_url": "https://github.com/plc-dev", "followers_url": "https://api.github.com/users/plc-dev/followers", "following_url": "https://api.github.com/users/plc-dev/following{/other_user}", "gists_url": "https://api.github.com/users/plc-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/plc-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/plc-dev/subscriptions", "organizations_url": "https://api.github.com/users/plc-dev/orgs", "repos_url": "https://api.github.com/users/plc-dev/repos", "events_url": "https://api.github.com/users/plc-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/plc-dev/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-07-06T09:02:27Z", "updated_at": "2020-07-06T14:24:55Z", "closed_at": "2020-07-06T14:24:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n\r\nAfter successfully training a NER model on Colab, loading the model again for inference in the same environment results in the following error, when calling model.evaluate().\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-5-56e09b327a86> in <module>\r\n----> 1 result, main_score = model.evaluate(corpus.test, out_path = f\"output.txt\")\r\n      2 \r\n      3 print(main_score)\r\n      4 print(result.detailed_results)\r\n\r\n~/.local/lib/python3.6/site-packages/flair/models/sequence_tagger_model.py in evaluate(self, sentences, out_path, embedding_storage_mode, mini_batch_size, num_workers)\r\n    515         # if span F1 needs to be used, use separate eval method\r\n    516         if self._requires_span_F1_evaluation():\r\n--> 517             return self._evaluate_with_span_F1(data_loader, embedding_storage_mode, mini_batch_size, out_path)\r\n    518 \r\n    519         # else, use scikit-learn to evaluate\r\n\r\n~/.local/lib/python3.6/site-packages/flair/models/sequence_tagger_model.py in _evaluate_with_span_F1(self, data_loader, embedding_storage_mode, mini_batch_size, out_path)\r\n    417                                 mini_batch_size=mini_batch_size,\r\n    418                                 label_name='predicted',\r\n--> 419                                 return_loss=True)\r\n    420             eval_loss += loss\r\n    421             batch_no += 1\r\n\r\n~/.local/lib/python3.6/site-packages/flair/models/sequence_tagger_model.py in predict(self, sentences, mini_batch_size, all_tag_prob, verbose, label_name, return_loss, embedding_storage_mode)\r\n    364                     continue\r\n    365 \r\n--> 366                 feature = self.forward(batch)\r\n    367 \r\n    368                 if return_loss:\r\n\r\n~/.local/lib/python3.6/site-packages/flair/models/sequence_tagger_model.py in forward(self, sentences)\r\n    602     def forward(self, sentences: List[Sentence]):\r\n    603 \r\n--> 604         self.embeddings.embed(sentences)\r\n    605 \r\n    606         names = self.embeddings.get_names()\r\n\r\n~/.local/lib/python3.6/site-packages/flair/embeddings/token.py in embed(self, sentences, static_embeddings)\r\n     69 \r\n     70         for embedding in self.embeddings:\r\n---> 71             embedding.embed(sentences)\r\n     72 \r\n     73     @property\r\n\r\n~/.local/lib/python3.6/site-packages/flair/embeddings/base.py in embed(self, sentences)\r\n     59 \r\n     60         if not everything_embedded or not self.static_embeddings:\r\n---> 61             self._add_embeddings_internal(sentences)\r\n     62 \r\n     63         return sentences\r\n\r\n~/.local/lib/python3.6/site-packages/flair/embeddings/legacy.py in _add_embeddings_internal(self, sentences)\r\n   1195                 [\r\n   1196                     self.tokenizer.tokenize(sentence.to_tokenized_string())\r\n-> 1197                     for sentence in sentences\r\n   1198                 ],\r\n   1199                 key=len,\r\n\r\n~/.local/lib/python3.6/site-packages/flair/embeddings/legacy.py in <listcomp>(.0)\r\n   1195                 [\r\n   1196                     self.tokenizer.tokenize(sentence.to_tokenized_string())\r\n-> 1197                     for sentence in sentences\r\n   1198                 ],\r\n   1199                 key=len,\r\n\r\n~/.local/lib/python3.6/site-packages/transformers/tokenization_utils.py in tokenize(self, text, **kwargs)\r\n    361             )\r\n    362 \r\n--> 363         no_split_token = self.unique_no_split_tokens\r\n    364         tokenized_text = split_on_tokens(no_split_token, text)\r\n    365         return tokenized_text\r\n\r\nAttributeError: 'BertTokenizer' object has no attribute 'unique_no_split_tokens'\r\n\r\n```\r\n\r\n**To Reproduce**\r\nModell: \"bert-base-multilingual-cased\" finetuned on a NER-task\r\n\r\nDataset: Data is not publicly disclosable\r\n\r\nMinimal script to reproduce:\r\n\r\n```\r\nfrom flair.data import Sentence\r\nfrom flair.data import Corpus\r\nfrom flair.embeddings import BertEmbeddings, StackedEmbeddings, TokenEmbeddings\r\nfrom flair.models import SequenceTagger\r\nfrom flair.trainers import ModelTrainer\r\nfrom flair.datasets import ColumnCorpus\r\nfrom flair.datasets import DataLoader\r\n\r\nembedding_types: List[TokenEmbeddings] = [\r\n    BertEmbeddings('bert-base-multilingual-cased')\r\n]\r\ncolumns = {0: 'text', 1: 'ner'}\r\ntag_type = columns[1]\r\ncorpus: Corpus = ColumnCorpus('data',  columns, train_file='train.txt', in_memory=False)\r\ntag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\n\r\nembeddings: StackedEmbeddings = StackedEmbeddings(embeddings=embedding_types)\r\n\r\ntagger: SequenceTagger = SequenceTagger(hidden_size=512,\r\n                                        embeddings=embeddings,\r\n                                        tag_dictionary=tag_dictionary,\r\n                                        tag_type=tag_type,\r\n                                        use_crf=True)\r\ntrainer.train('model/',\r\n              learning_rate=0.001,\r\n              mini_batch_size=32,\r\n              patience=2,\r\n              anneal_factor=0.4,\r\n              max_epochs=30,\r\n              checkpoint=True,\r\n              embeddings_storage_mode='None')\r\n\r\nmodel = SequenceTagger.load('model/final-model.pt')\r\ncolumns = {0: 'text', 1: 'ner'}\r\ncorpus: Corpus = ColumnCorpus('data/', columns,\r\n                                train_file='train.txt',\r\n                                test_file='test.txt',\r\n                                dev_file='dev.txt')\r\n\r\nresult, main_score = model.evaluate(corpus.test, out_path = f\"output.txt\")\r\n```\r\n\r\n**Expected behavior**\r\nBeing able to use the trained model for inference.\r\n\r\n**Environment (please complete the following information):**\r\nEnvironment: Google Colab\r\nGPU: Tesla P100\r\nVersions:\r\n- Flair 0.5.1\r\n- torch 1.5.1+cu101\r\n- transformers 3.0.1\r\n\r\n**Additional context**\r\nA similar issue occured earlier, when resuming training from a checkpoint, which resulted in the same error when loading the model with the ModelTrainer.load() method. I was able to somewhat work around that error by resuming from an earlier checkpoint. \r\n\r\n**Edit**: Might correlate with #1741  \r\n**Edit 2**: Correct paths in example code to match", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1743/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1743/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1741", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1741/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1741/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1741/events", "html_url": "https://github.com/flairNLP/flair/issues/1741", "id": 651165246, "node_id": "MDU6SXNzdWU2NTExNjUyNDY=", "number": 1741, "title": "Prediction bug for NER models trained with TransformerWordEmbeddings", "user": {"login": "seyyaw", "id": 1056051, "node_id": "MDQ6VXNlcjEwNTYwNTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1056051?v=4", "gravatar_id": "", "url": "https://api.github.com/users/seyyaw", "html_url": "https://github.com/seyyaw", "followers_url": "https://api.github.com/users/seyyaw/followers", "following_url": "https://api.github.com/users/seyyaw/following{/other_user}", "gists_url": "https://api.github.com/users/seyyaw/gists{/gist_id}", "starred_url": "https://api.github.com/users/seyyaw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/seyyaw/subscriptions", "organizations_url": "https://api.github.com/users/seyyaw/orgs", "repos_url": "https://api.github.com/users/seyyaw/repos", "events_url": "https://api.github.com/users/seyyaw/events{/privacy}", "received_events_url": "https://api.github.com/users/seyyaw/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-07-05T23:18:14Z", "updated_at": "2020-08-05T06:20:19Z", "closed_at": "2020-07-10T08:00:17Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nI have trained a `TransformerWordEmbeddings` NER model using a custom `RoBERTa` model. Training completed successfully. But when loading the NER model for prediction,\r\n\r\n```\r\nmodel = SequenceTagger.load('resources/taggers/roberta/final-model.pt')\r\n....\r\n\r\nmodel.predict(sentence)\r\n```\r\nthe following error occured:\r\n\r\n````\r\n---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-1-a31cc734771e> in <module>\r\n      8 \r\n      9 # predict tags and print\r\n---> 10 model.predict(sentence)\r\n     11 \r\n     12 print(sentence.to_tagged_string())\r\n\r\n~/miniconda3/envs/pytorch_p37/lib/python3.7/site-packages/flair/models/sequence_tagger_model.py in predict(self, sentences, mini_batch_size, all_tag_prob, verbose, label_name, return_loss, embedding_storage_mode)\r\n    364                     continue\r\n    365 \r\n--> 366                 feature = self.forward(batch)\r\n    367 \r\n    368                 if return_loss:\r\n\r\n~/miniconda3/envs/pytorch_p37/lib/python3.7/site-packages/flair/models/sequence_tagger_model.py in forward(self, sentences)\r\n    602     def forward(self, sentences: List[Sentence]):\r\n    603 \r\n--> 604         self.embeddings.embed(sentences)\r\n    605 \r\n    606         names = self.embeddings.get_names()\r\n\r\n~/miniconda3/envs/pytorch_p37/lib/python3.7/site-packages/flair/embeddings/token.py in embed(self, sentences, static_embeddings)\r\n     69 \r\n     70         for embedding in self.embeddings:\r\n---> 71             embedding.embed(sentences)\r\n     72 \r\n     73     @property\r\n\r\n~/miniconda3/envs/pytorch_p37/lib/python3.7/site-packages/flair/embeddings/base.py in embed(self, sentences)\r\n     59 \r\n     60         if not everything_embedded or not self.static_embeddings:\r\n---> 61             self._add_embeddings_internal(sentences)\r\n     62 \r\n     63         return sentences\r\n\r\n~/miniconda3/envs/pytorch_p37/lib/python3.7/site-packages/flair/embeddings/token.py in _add_embeddings_internal(self, sentences)\r\n    895         # embed each micro-batch\r\n    896         for batch in sentence_batches:\r\n--> 897             self._add_embeddings_to_sentences(batch)\r\n    898 \r\n    899         return sentences\r\n\r\n~/miniconda3/envs/pytorch_p37/lib/python3.7/site-packages/flair/embeddings/token.py in _add_embeddings_to_sentences(self, sentences)\r\n   1007 \r\n   1008         # put encoded batch through transformer model to get all hidden states of all encoder layers\r\n-> 1009         hidden_states = self.model(input_ids, attention_mask=mask)[-1]\r\n   1010         # make the tuple a tensor; makes working with it easier.\r\n   1011         hidden_states = torch.stack(hidden_states)\r\n\r\n~/miniconda3/envs/pytorch_p37/lib/python3.7/site-packages/torch/nn/modules/module.py in __call__(self, *input, **kwargs)\r\n    545             result = self._slow_forward(*input, **kwargs)\r\n    546         else:\r\n--> 547             result = self.forward(*input, **kwargs)\r\n    548         for hook in self._forward_hooks.values():\r\n    549             hook_result = hook(self, input, result)\r\n\r\n~/miniconda3/envs/pytorch_p37/lib/python3.7/site-packages/transformers/modeling_bert.py in forward(self, input_ids, attention_mask, token_type_ids, position_ids, head_mask, inputs_embeds, encoder_hidden_states, encoder_attention_mask, output_attentions, output_hidden_states)\r\n    760             encoder_attention_mask=encoder_extended_attention_mask,\r\n    761             output_attentions=output_attentions,\r\n--> 762             output_hidden_states=output_hidden_states,\r\n    763         )\r\n    764         sequence_output = encoder_outputs[0]\r\n\r\n~/miniconda3/envs/pytorch_p37/lib/python3.7/site-packages/torch/nn/modules/module.py in __call__(self, *input, **kwargs)\r\n    545             result = self._slow_forward(*input, **kwargs)\r\n    546         else:\r\n--> 547             result = self.forward(*input, **kwargs)\r\n    548         for hook in self._forward_hooks.values():\r\n    549             hook_result = hook(self, input, result)\r\n\r\n~/miniconda3/envs/pytorch_p37/lib/python3.7/site-packages/transformers/modeling_bert.py in forward(self, hidden_states, attention_mask, head_mask, encoder_hidden_states, encoder_attention_mask, output_attentions, output_hidden_states)\r\n    414                 all_hidden_states = all_hidden_states + (hidden_states,)\r\n    415 \r\n--> 416             if getattr(self.config, \"gradient_checkpointing\", False):\r\n    417 \r\n    418                 def create_custom_forward(module):\r\n\r\n~/miniconda3/envs/pytorch_p37/lib/python3.7/site-packages/torch/nn/modules/module.py in __getattr__(self, name)\r\n    589                 return modules[name]\r\n    590         raise AttributeError(\"'{}' object has no attribute '{}'\".format(\r\n--> 591             type(self).__name__, name))\r\n    592 \r\n    593     def __setattr__(self, name, value):\r\n\r\nAttributeError: 'BertEncoder' object has no attribute 'config'\r\n````\r\n\r\n\r\n\r\n**Expected behavior**\r\nNER tagged sentence\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - OS Linux:\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1741/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1741/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1736", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1736/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1736/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1736/events", "html_url": "https://github.com/flairNLP/flair/issues/1736", "id": 651003686, "node_id": "MDU6SXNzdWU2NTEwMDM2ODY=", "number": 1736, "title": "Truncation", "user": {"login": "khttknoob", "id": 36195176, "node_id": "MDQ6VXNlcjM2MTk1MTc2", "avatar_url": "https://avatars.githubusercontent.com/u/36195176?v=4", "gravatar_id": "", "url": "https://api.github.com/users/khttknoob", "html_url": "https://github.com/khttknoob", "followers_url": "https://api.github.com/users/khttknoob/followers", "following_url": "https://api.github.com/users/khttknoob/following{/other_user}", "gists_url": "https://api.github.com/users/khttknoob/gists{/gist_id}", "starred_url": "https://api.github.com/users/khttknoob/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/khttknoob/subscriptions", "organizations_url": "https://api.github.com/users/khttknoob/orgs", "repos_url": "https://api.github.com/users/khttknoob/repos", "events_url": "https://api.github.com/users/khttknoob/events{/privacy}", "received_events_url": "https://api.github.com/users/khttknoob/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-07-05T05:17:30Z", "updated_at": "2020-07-07T10:52:56Z", "closed_at": "2020-07-05T21:35:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nGetting this warining\r\nTruncation was not explicitely activated but `max_length` is provided a specific value, please use `truncation=True` to explicitely truncate examples to max length. Defaulting to 'longest_first' truncation strategy. If you encode pairs of sequences (GLUE-style) with the tokenizer you can select this strategy more precisely by providing a specific strategy to `truncation`.\r\n\r\n**To Reproduce**\r\nI ran the transformers model a month ago didn't got anything but today getting this warning\r\n\r\n**Environment (please complete the following information):**\r\n - OS [Using Google Colab]\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1736/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1736/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1733", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1733/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1733/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1733/events", "html_url": "https://github.com/flairNLP/flair/issues/1733", "id": 650749228, "node_id": "MDU6SXNzdWU2NTA3NDkyMjg=", "number": 1733, "title": "Import Error", "user": {"login": "s3afroze", "id": 33985550, "node_id": "MDQ6VXNlcjMzOTg1NTUw", "avatar_url": "https://avatars.githubusercontent.com/u/33985550?v=4", "gravatar_id": "", "url": "https://api.github.com/users/s3afroze", "html_url": "https://github.com/s3afroze", "followers_url": "https://api.github.com/users/s3afroze/followers", "following_url": "https://api.github.com/users/s3afroze/following{/other_user}", "gists_url": "https://api.github.com/users/s3afroze/gists{/gist_id}", "starred_url": "https://api.github.com/users/s3afroze/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/s3afroze/subscriptions", "organizations_url": "https://api.github.com/users/s3afroze/orgs", "repos_url": "https://api.github.com/users/s3afroze/repos", "events_url": "https://api.github.com/users/s3afroze/events{/privacy}", "received_events_url": "https://api.github.com/users/s3afroze/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-07-03T20:01:32Z", "updated_at": "2020-07-03T20:48:37Z", "closed_at": "2020-07-03T20:33:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi guys,\r\nI recently upgrade flair to the newest version and I am getting the following error on both jupyter notebook and console. I tried virualenv aswell.\r\n\r\n```\r\nImportError: dlopen(/anaconda3/lib/python3.6/site-packages/tokenizers/tokenizers.cpython-36m-darwin.so, 2): Symbol not found: ____chkstk_darwin\r\n\r\nReferenced from: /anaconda3/lib/python3.6/site-packages/tokenizers/tokenizers.cpython-36m-darwin.so (which was built for Mac OS X 10.15)\r\n\r\nExpected in: /usr/lib/libSystem.B.dylib\r\n in /anaconda3/lib/python3.6/site-packages/tokenizers/tokenizers.cpython-36m-darwin.so\r\n```\r\n\r\nDo you guys know how I should resolve this? \r\n\r\nThanks,\r\n\r\nShahzeb", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1733/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1733/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1731", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1731/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1731/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1731/events", "html_url": "https://github.com/flairNLP/flair/issues/1731", "id": 650382167, "node_id": "MDU6SXNzdWU2NTAzODIxNjc=", "number": 1731, "title": "AttributeError: 'CharLMEmbeddings' object has no attribute 'chars_per_chunk'", "user": {"login": "qijunhui", "id": 27915875, "node_id": "MDQ6VXNlcjI3OTE1ODc1", "avatar_url": "https://avatars.githubusercontent.com/u/27915875?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qijunhui", "html_url": "https://github.com/qijunhui", "followers_url": "https://api.github.com/users/qijunhui/followers", "following_url": "https://api.github.com/users/qijunhui/following{/other_user}", "gists_url": "https://api.github.com/users/qijunhui/gists{/gist_id}", "starred_url": "https://api.github.com/users/qijunhui/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qijunhui/subscriptions", "organizations_url": "https://api.github.com/users/qijunhui/orgs", "repos_url": "https://api.github.com/users/qijunhui/repos", "events_url": "https://api.github.com/users/qijunhui/events{/privacy}", "received_events_url": "https://api.github.com/users/qijunhui/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-07-03T06:46:12Z", "updated_at": "2020-11-07T10:54:13Z", "closed_at": "2020-11-07T10:54:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "from flair.data import Sentence\r\nfrom flair.models import SequenceTagger\r\n\r\nsentence = Sentence(\"I love Berlin .\")\r\n\r\ntagger = SequenceTagger.load(\"/home/hadoop/.flair/models/en-ner-conll03-v0.2.pt\")\r\n\r\ntagger.predict(sentence)\r\n\r\n####\r\nAlso, can the model download link be provided?", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1731/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1731/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1728", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1728/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1728/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1728/events", "html_url": "https://github.com/flairNLP/flair/issues/1728", "id": 649739473, "node_id": "MDU6SXNzdWU2NDk3Mzk0NzM=", "number": 1728, "title": "type object 'TextClassifier' has no attribute 'load_from_file'", "user": {"login": "qijunhui", "id": 27915875, "node_id": "MDQ6VXNlcjI3OTE1ODc1", "avatar_url": "https://avatars.githubusercontent.com/u/27915875?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qijunhui", "html_url": "https://github.com/qijunhui", "followers_url": "https://api.github.com/users/qijunhui/followers", "following_url": "https://api.github.com/users/qijunhui/following{/other_user}", "gists_url": "https://api.github.com/users/qijunhui/gists{/gist_id}", "starred_url": "https://api.github.com/users/qijunhui/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qijunhui/subscriptions", "organizations_url": "https://api.github.com/users/qijunhui/orgs", "repos_url": "https://api.github.com/users/qijunhui/repos", "events_url": "https://api.github.com/users/qijunhui/events{/privacy}", "received_events_url": "https://api.github.com/users/qijunhui/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-07-02T08:26:29Z", "updated_at": "2020-11-06T15:28:34Z", "closed_at": "2020-11-06T15:28:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "from flair.models import TextClassifier\r\nfrom flair.data import Sentence\r\n\r\nclassifier = TextClassifier.load_from_file(\"./best-model.pt\")\r\nsentence = Sentence(\"Hi. Yes mum, I will...\")\r\nclassifier.predict(sentence)\r\nprint(sentence.labels)\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1728/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1728/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1726", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1726/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1726/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1726/events", "html_url": "https://github.com/flairNLP/flair/issues/1726", "id": 649362702, "node_id": "MDU6SXNzdWU2NDkzNjI3MDI=", "number": 1726, "title": "Transformers: AttributeError: 'BertTokenizer' object has no attribute 'prepare_for_model'", "user": {"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-07-01T22:24:16Z", "updated_at": "2020-07-03T11:58:07Z", "closed_at": "2020-07-03T11:58:06Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Hi,\r\n\r\nlatest version of \ud83e\udd17 Transformers no longer supports the `prepare_for_model` method, that we're using in our `TransformerWordEmbeddings` class:\r\n\r\nhttps://github.com/flairNLP/flair/blob/8c09e62d9a5a3c227b9ca0fb9f214de9620d4ca0/flair/embeddings/token.py#L957-L960\r\n\r\nThe following error message is thrown:\r\n\r\n```bash\r\nTraceback (most recent call last):\r\n  File \"train_conll_en.py\", line 58, in <module>\r\n    shuffle=True\r\n  File \"/mnt/flair-paper/flair/trainers/trainer.py\", line 349, in train\r\n    loss = self.model.forward_loss(batch_step)\r\n  File \"/mnt/flair-paper/flair/models/sequence_tagger_model.py\", line 599, in forward_loss\r\n    features = self.forward(data_points)\r\n  File \"/mnt/flair-paper/flair/models/sequence_tagger_model.py\", line 604, in forward\r\n    self.embeddings.embed(sentences)\r\n  File \"/mnt/flair-paper/flair/embeddings/token.py\", line 71, in embed\r\n    embedding.embed(sentences)\r\n  File \"/mnt/flair-paper/flair/embeddings/base.py\", line 61, in embed\r\n    self._add_embeddings_internal(sentences)\r\n  File \"/mnt/flair-paper/flair/embeddings/token.py\", line 892, in _add_embeddings_internal\r\n    self._add_embeddings_to_sentences(batch)\r\n  File \"/mnt/flair-paper/flair/embeddings/token.py\", line 957, in _add_embeddings_to_sentences\r\n    encoded_inputs = self.tokenizer.prepare_for_model(subtoken_ids_sentence,\r\nAttributeError: 'BertTokenizer' object has no attribute 'prepare_for_model'\r\n```\r\n\r\nIt should be replaced with `encode_plus` method, see https://github.com/huggingface/transformers/issues/5447.\r\n\r\nI'll prepare a PR for that!", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1726/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 1, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1726/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1725", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1725/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1725/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1725/events", "html_url": "https://github.com/flairNLP/flair/issues/1725", "id": 648057858, "node_id": "MDU6SXNzdWU2NDgwNTc4NTg=", "number": 1725, "title": "Error with TransformerWordEmbeddings", "user": {"login": "pascalhuszar", "id": 45284935, "node_id": "MDQ6VXNlcjQ1Mjg0OTM1", "avatar_url": "https://avatars.githubusercontent.com/u/45284935?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pascalhuszar", "html_url": "https://github.com/pascalhuszar", "followers_url": "https://api.github.com/users/pascalhuszar/followers", "following_url": "https://api.github.com/users/pascalhuszar/following{/other_user}", "gists_url": "https://api.github.com/users/pascalhuszar/gists{/gist_id}", "starred_url": "https://api.github.com/users/pascalhuszar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pascalhuszar/subscriptions", "organizations_url": "https://api.github.com/users/pascalhuszar/orgs", "repos_url": "https://api.github.com/users/pascalhuszar/repos", "events_url": "https://api.github.com/users/pascalhuszar/events{/privacy}", "received_events_url": "https://api.github.com/users/pascalhuszar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-06-30T10:23:43Z", "updated_at": "2021-05-06T15:40:41Z", "closed_at": "2020-07-03T18:27:38Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n```python\r\nImportErrorTraceback (most recent call last)\r\n<ipython-input-4-3bbdce17bb1a> in <module>\r\n      2 embedding_types: List[TokenEmbeddings] = [\r\n      3     WordEmbeddings('de'),\r\n----> 4     TransformerWordEmbeddings('bert-base-german-cased'),\r\n      5 ]\r\n      6 \r\n\r\n/opt/conda/envs/gpu/lib/python3.6/site-packages/flair/embeddings/token.py in __init__(self, model, layers, pooling_operation, batch_size, use_scalar_mix, fine_tune)\r\n    819 \r\n    820         # load tokenizer and transformer model\r\n--> 821         self.tokenizer = AutoTokenizer.from_pretrained(model)\r\n    822         config = AutoConfig.from_pretrained(model, output_hidden_states=True)\r\n    823         self.model = AutoModel.from_pretrained(model, config=config)\r\n\r\n/opt/conda/envs/gpu/lib/python3.6/site-packages/transformers/tokenization_auto.py in from_pretrained(cls, pretrained_model_name_or_path, *inputs, **kwargs)\r\n    204         config = kwargs.pop(\"config\", None)\r\n    205         if not isinstance(config, PretrainedConfig):\r\n--> 206             config = AutoConfig.from_pretrained(pretrained_model_name_or_path, **kwargs)\r\n    207 \r\n    208         if \"bert-base-japanese\" in str(pretrained_model_name_or_path):\r\n\r\n/opt/conda/envs/gpu/lib/python3.6/site-packages/transformers/configuration_auto.py in from_pretrained(cls, pretrained_model_name_or_path, **kwargs)\r\n    201 \r\n    202         \"\"\"\r\n--> 203         config_dict, _ = PretrainedConfig.get_config_dict(pretrained_model_name_or_path, **kwargs)\r\n    204 \r\n    205         if \"model_type\" in config_dict:\r\n\r\n/opt/conda/envs/gpu/lib/python3.6/site-packages/transformers/configuration_utils.py in get_config_dict(cls, pretrained_model_name_or_path, **kwargs)\r\n    236                 proxies=proxies,\r\n    237                 resume_download=resume_download,\r\n--> 238                 local_files_only=local_files_only,\r\n    239             )\r\n    240             # Load config dict\r\n\r\n/opt/conda/envs/gpu/lib/python3.6/site-packages/transformers/file_utils.py in cached_path(url_or_filename, cache_dir, force_download, proxies, resume_download, user_agent, extract_compressed_file, force_extract, local_files_only)\r\n    569             resume_download=resume_download,\r\n    570             user_agent=user_agent,\r\n--> 571             local_files_only=local_files_only,\r\n    572         )\r\n    573     elif os.path.exists(url_or_filename):\r\n\r\n/opt/conda/envs/gpu/lib/python3.6/site-packages/transformers/file_utils.py in get_from_cache(url, cache_dir, force_download, proxies, etag_timeout, resume_download, user_agent, local_files_only)\r\n    748             logger.info(\"%s not found in cache or force_download set to True, downloading to %s\", url, temp_file.name)\r\n    749 \r\n--> 750             http_get(url, temp_file, proxies=proxies, resume_size=resume_size, user_agent=user_agent)\r\n    751 \r\n    752         logger.info(\"storing %s in cache at %s\", url, cache_path)\r\n\r\n/opt/conda/envs/gpu/lib/python3.6/site-packages/transformers/file_utils.py in http_get(url, temp_file, proxies, resume_size, user_agent)\r\n    639         initial=resume_size,\r\n    640         desc=\"Downloading\",\r\n--> 641         disable=bool(logger.getEffectiveLevel() == logging.NOTSET),\r\n    642     )\r\n    643     for chunk in response.iter_content(chunk_size=1024):\r\n\r\n/opt/conda/envs/gpu/lib/python3.6/site-packages/tqdm/notebook.py in __init__(self, *args, **kwargs)\r\n    206         total = self.total * unit_scale if self.total else self.total\r\n    207         self.container = self.status_printer(\r\n--> 208             self.fp, total, self.desc, self.ncols)\r\n    209         self.sp = self.display\r\n    210 \r\n\r\n/opt/conda/envs/gpu/lib/python3.6/site-packages/tqdm/notebook.py in status_printer(_, total, desc, ncols)\r\n     95         if IProgress is None:  # #187 #451 #558 #872\r\n     96             raise ImportError(\r\n---> 97                 \"IProgress not found. Please update jupyter and ipywidgets.\"\r\n     98                 \" See https://ipywidgets.readthedocs.io/en/stable\"\r\n     99                 \"/user_install.html\")\r\n\r\nImportError: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html\r\n```\r\n\r\n**To Reproduce**\r\n```python\r\n# imports\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import CONLL_03_GERMAN, ColumnCorpus \r\nfrom flair.embeddings import TokenEmbeddings, WordEmbeddings, StackedEmbeddings, PooledFlairEmbeddings, FlairEmbeddings, TransformerWordEmbeddings\r\nfrom flair.visual.training_curves import Plotter\r\nfrom flair.trainers import ModelTrainer\r\nfrom flair.models import SequenceTagger\r\nfrom typing import List\r\n\r\ncolumns = {0: 'text', 1: 'ner'}\r\ndata_folder = '/workspace'\r\n\r\ncorpus: Corpus = ColumnCorpus(data_folder, columns,\r\n                              train_file='train.train',\r\n                              dev_file='dev.dev',\r\n                              test_file='test.test')\r\n    \r\n# define task + tag dict.\r\ntag_type = 'ner'\r\ntag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\nprint(tag_dictionary )\r\n\r\n# initialize embeddings\r\nembedding_types: List[TokenEmbeddings] = [\r\n    WordEmbeddings('de'),\r\n    TransformerWordEmbeddings('bert-base-german-cased'),\r\n]\r\n\r\nembeddings: StackedEmbeddings = StackedEmbeddings(embeddings=embedding_types)\r\n\r\n# initialize sequence tagger\r\nfrom flair.models import SequenceTagger\r\n\r\ntagger: SequenceTagger = SequenceTagger(hidden_size=256,\r\n                                        embeddings=embeddings,\r\n                                        tag_dictionary=tag_dictionary,\r\n                                        tag_type=tag_type)\r\n\r\n# initialize trainer\r\nfrom flair.trainers import ModelTrainer\r\n\r\ntrainer: ModelTrainer = ModelTrainer(tagger, corpus)\r\n\r\ntrainer.train('taggers/distil',\r\n            learning_rate=0.1,\r\n              mini_batch_size=32,\r\n              train_with_dev = True, \r\n              max_epochs=150)\r\n``` \r\n**Expected behavior**\r\nThe model gets trained\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Linux\r\n - Version [e.g. flair-0.3.2]: Tested both: 0.5 and 0.4.5\r\n\r\n**Additional context**\r\nThis problem only occur with TransformerEmbeddings not with Flair\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1725/reactions", "total_count": 3, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 1, "eyes": 1}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1725/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1724", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1724/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1724/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1724/events", "html_url": "https://github.com/flairNLP/flair/issues/1724", "id": 647002668, "node_id": "MDU6SXNzdWU2NDcwMDI2Njg=", "number": 1724, "title": "TransformerWordEmbeddings  Flair Release 0.5 cannot process special characters of Twitter data", "user": {"login": "marinapollo", "id": 37367530, "node_id": "MDQ6VXNlcjM3MzY3NTMw", "avatar_url": "https://avatars.githubusercontent.com/u/37367530?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marinapollo", "html_url": "https://github.com/marinapollo", "followers_url": "https://api.github.com/users/marinapollo/followers", "following_url": "https://api.github.com/users/marinapollo/following{/other_user}", "gists_url": "https://api.github.com/users/marinapollo/gists{/gist_id}", "starred_url": "https://api.github.com/users/marinapollo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marinapollo/subscriptions", "organizations_url": "https://api.github.com/users/marinapollo/orgs", "repos_url": "https://api.github.com/users/marinapollo/repos", "events_url": "https://api.github.com/users/marinapollo/events{/privacy}", "received_events_url": "https://api.github.com/users/marinapollo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2020-06-28T20:49:33Z", "updated_at": "2020-07-07T15:33:34Z", "closed_at": "2020-07-07T15:33:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nTraceback (most recent call last):\r\n  File \"flair-POS.py\", line 121, in <module>\r\n    max_epochs=150) \r\n  File \"/work/flair/flair/trainers/trainer.py\", line 357, in train\r\n    loss = self.model.forward_loss(batch_step)\r\n  File \"/work/flair/flair/models/sequence_tagger_model.py\", line 627, in forward_loss\r\n    features = self.forward(data_points)\r\n  File \"/work/flair/flair/models/sequence_tagger_model.py\", line 662, in forward\r\n    self.embeddings.embedding_length,\r\nRuntimeError: shape '[32, 33, 3072]' is invalid for input of size 3240960\r\n\r\n\r\n**To Reproduce**\r\n     \r\n    data_folder = '/work/Twitter_data/'\r\n    embedding_type = 'bert-base-uncased'\r\n    corpus: Corpus = ColumnCorpus(data_folder, columns,\r\n                                  train_file='train-flair'\r\n                                  test_file='test-flair',\r\n                                  dev_file='dev-flair')\r\n    tag_type = 'pos'\r\n\r\n\r\n  \r\n\r\n    tag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\n    embeddings = TransformerWordEmbeddings(embedding_type,fine_tune=True)#layers=\"-1\"\r\n\r\n    # 5. initialize sequence tagger\r\n    tagger: SequenceTagger = SequenceTagger(hidden_size=256,\r\n                                        embeddings=embeddings,\r\n                                        tag_dictionary=tag_dictionary,\r\n                                        tag_type=tag_type,\r\n                                        use_crf=False\r\n                                        )\r\n    \r\n    # 6. initialize trainer\r\n\r\n    trainer: ModelTrainer = ModelTrainer(tagger, corpus)#optimizer=Adam\r\n\r\n   \r\n    trainer.train(path,\r\n              learning_rate=0.1,\r\n              embeddings_storage_mode = 'gpu',\r\n              #mini_batch_chunk_size=2, \r\n              mini_batch_size=32,\r\n              max_epochs=150) \r\n    \r\n\r\n    \r\n   \r\n\r\n**Expected behavior**\r\nexpected training as usual with TransformerWordEmbeddings module but the error appears because TransformerWordEmbeddings module cannot process special characters of Twitter, not sure which exactly characters these are (kind of smilies and others). When used other data (not Twitter) without special characters, everything works fine.\r\n\r\n**Environment (please complete the following information):**\r\n - Version flair-0.5\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1724/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1724/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1723", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1723/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1723/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1723/events", "html_url": "https://github.com/flairNLP/flair/issues/1723", "id": 646836377, "node_id": "MDU6SXNzdWU2NDY4MzYzNzc=", "number": 1723, "title": "ELMoEmbeddings checkpoint pickling error with Flair0.4.5", "user": {"login": "sankaran45", "id": 8388863, "node_id": "MDQ6VXNlcjgzODg4NjM=", "avatar_url": "https://avatars.githubusercontent.com/u/8388863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sankaran45", "html_url": "https://github.com/sankaran45", "followers_url": "https://api.github.com/users/sankaran45/followers", "following_url": "https://api.github.com/users/sankaran45/following{/other_user}", "gists_url": "https://api.github.com/users/sankaran45/gists{/gist_id}", "starred_url": "https://api.github.com/users/sankaran45/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sankaran45/subscriptions", "organizations_url": "https://api.github.com/users/sankaran45/orgs", "repos_url": "https://api.github.com/users/sankaran45/repos", "events_url": "https://api.github.com/users/sankaran45/events{/privacy}", "received_events_url": "https://api.github.com/users/sankaran45/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-06-28T04:21:40Z", "updated_at": "2020-11-03T00:32:27Z", "closed_at": "2020-11-03T00:32:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "Google colab by default has torch 1.5.1 and when i install allennlp and try ELMoEmbedding after 1st epoch this error occurs. This occurs with Flair 0.5 and if i go back to Flair 0.4.5 this works just fine. \r\n\r\n/usr/local/lib/python3.6/dist-packages/torch/serialization.py in _legacy_save(obj, f, pickle_module, pickle_protocol)\r\n    441     pickler = pickle_module.Pickler(f, protocol=pickle_protocol)\r\n    442     pickler.persistent_id = persistent_id\r\n--> 443     pickler.dump(obj)\r\n    444 \r\n    445     serialized_storage_keys = sorted(serialized_storages.keys())\r\n\r\nAttributeError: Can't pickle local object 'ELMoEmbeddings.__init__.<locals>.<lambda>'", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1723/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1723/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1722", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1722/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1722/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1722/events", "html_url": "https://github.com/flairNLP/flair/issues/1722", "id": 646667008, "node_id": "MDU6SXNzdWU2NDY2NjcwMDg=", "number": 1722, "title": "TypeError: classification_report() got an unexpected keyword argument 'zero_division'", "user": {"login": "eh-93", "id": 10990339, "node_id": "MDQ6VXNlcjEwOTkwMzM5", "avatar_url": "https://avatars.githubusercontent.com/u/10990339?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eh-93", "html_url": "https://github.com/eh-93", "followers_url": "https://api.github.com/users/eh-93/followers", "following_url": "https://api.github.com/users/eh-93/following{/other_user}", "gists_url": "https://api.github.com/users/eh-93/gists{/gist_id}", "starred_url": "https://api.github.com/users/eh-93/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eh-93/subscriptions", "organizations_url": "https://api.github.com/users/eh-93/orgs", "repos_url": "https://api.github.com/users/eh-93/repos", "events_url": "https://api.github.com/users/eh-93/events{/privacy}", "received_events_url": "https://api.github.com/users/eh-93/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 14, "created_at": "2020-06-27T11:52:17Z", "updated_at": "2021-01-05T16:46:21Z", "closed_at": "2021-01-05T16:46:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nJust want to report a bug with master, upon the first epoch completing  the classification report fails with the following exception: TypeError: classification_report() got an unexpected keyword argument 'zero_division'\r\n\r\nFull stack trace and some context:\r\n```\r\n2020-06-27 12:27:53,241 ----------------------------------------------------------------------------------------------------\r\n2020-06-27 12:27:53,241 Device: cuda:0\r\n2020-06-27 12:27:53,241 ----------------------------------------------------------------------------------------------------\r\n2020-06-27 12:27:53,241 Embeddings storage mode: none\r\n2020-06-27 12:27:53,241 ----------------------------------------------------------------------------------------------------\r\n2020-06-27 12:29:29,176 epoch 1 - iter 76/760 - loss 0.93225607 - samples/sec: 12.69\r\n2020-06-27 12:31:06,572 epoch 1 - iter 152/760 - loss 0.87678470 - samples/sec: 12.49\r\n2020-06-27 12:32:47,559 epoch 1 - iter 228/760 - loss 0.83017487 - samples/sec: 12.05\r\n2020-06-27 12:34:24,617 epoch 1 - iter 304/760 - loss 0.80174087 - samples/sec: 12.54\r\n2020-06-27 12:36:02,725 epoch 1 - iter 380/760 - loss 0.78552397 - samples/sec: 12.40\r\n2020-06-27 12:37:40,569 epoch 1 - iter 456/760 - loss 0.76393380 - samples/sec: 12.46\r\n2020-06-27 12:39:22,314 epoch 1 - iter 532/760 - loss 0.74449620 - samples/sec: 11.97\r\n2020-06-27 12:41:06,882 epoch 1 - iter 608/760 - loss 0.73161619 - samples/sec: 11.71\r\n2020-06-27 12:42:55,085 epoch 1 - iter 684/760 - loss 0.71728993 - samples/sec: 11.35\r\n2020-06-27 12:44:40,769 epoch 1 - iter 760/760 - loss 0.70415614 - samples/sec: 11.68\r\n2020-06-27 12:44:41,984 ----------------------------------------------------------------------------------------------------\r\n2020-06-27 12:44:41,984 EPOCH 1 done: loss 0.7042 - lr 0.1000000\r\nTraceback (most recent call last):\r\n  File \"flairx/train_model.py\", line 95, in <module>\r\n    trainer.train(output_path,\r\n  File \"/home/lib/python3.8/site-packages/flair/trainers/trainer.py\", line 426, in train\r\n    dev_eval_result, dev_loss = self.model.evaluate(\r\n  File \"/home/lib/python3.8/site-packages/flair/models/text_classification_model.py\", line 325, in evaluate\r\n    classification_report = metrics.classification_report(y_true, y_pred, digits=4,\r\nTypeError: classification_report() got an unexpected keyword argument 'zero_division'\r\n```\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior (e.g. which model did you train? what parameters did you use? etc.).\r\n\r\n```\r\ncorpus: Corpus = ClassificationCorpus(data_folder)\r\nlabel_dict = corpus.make_label_dictionary()\r\nword_embeddings = [\r\n    WordEmbeddings('en'),\r\n    FlairEmbeddings('forward'),\r\n    FlairEmbeddings('backward'),\r\n]\r\n\r\nDrnnEmbeddings = DocumentRNNEmbeddings(word_embeddings,\r\n                                       hidden_size=hidden_size,\r\n                                       reproject_words=reproject_words,\r\n                                       reproject_words_dimension=reproject_words_dimension,\r\n                                       rnn_type=rnn_type)\r\n\r\ndocument_embeddings: DocumentRNNEmbeddings = DrnnEmbeddings\r\nclassifier = TextClassifier(document_embeddings, label_dictionary=label_dict)\r\ntrainer = ModelTrainer(classifier, corpus)\r\n\r\ntrainer.train(output_path,\r\n              learning_rate=learning_rate,\r\n              mini_batch_size=mini_batch_size,\r\n              anneal_factor=anneal_factor,\r\n              patience=patience,\r\n              max_epochs=max_epochs,\r\n              embeddings_storage_mode='none')\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Linux Manjaro\r\n - Version flair-0.5 - but installed from master as of today", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1722/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1722/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1719", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1719/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1719/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1719/events", "html_url": "https://github.com/flairNLP/flair/issues/1719", "id": 645585229, "node_id": "MDU6SXNzdWU2NDU1ODUyMjk=", "number": 1719, "title": "TransformerDocumentEmbeddings memory leak", "user": {"login": "olanag1", "id": 27998731, "node_id": "MDQ6VXNlcjI3OTk4NzMx", "avatar_url": "https://avatars.githubusercontent.com/u/27998731?v=4", "gravatar_id": "", "url": "https://api.github.com/users/olanag1", "html_url": "https://github.com/olanag1", "followers_url": "https://api.github.com/users/olanag1/followers", "following_url": "https://api.github.com/users/olanag1/following{/other_user}", "gists_url": "https://api.github.com/users/olanag1/gists{/gist_id}", "starred_url": "https://api.github.com/users/olanag1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/olanag1/subscriptions", "organizations_url": "https://api.github.com/users/olanag1/orgs", "repos_url": "https://api.github.com/users/olanag1/repos", "events_url": "https://api.github.com/users/olanag1/events{/privacy}", "received_events_url": "https://api.github.com/users/olanag1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": {"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2020-06-25T13:56:52Z", "updated_at": "2020-11-26T16:58:11Z", "closed_at": "2020-11-26T16:58:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello, \r\n\r\nI'm trying to pass a list of documents and obtain document embeddings from pre-trained model \"bert-base-uncased\". \r\nTo debug I measure memory consumption in for loop and I observe that on each new document the memory is leaked. \r\n\r\nubuntu 18.04\r\nflair 0.5\r\ntorch 1.5.0\r\n\r\n> \r\n\r\n    document_embeddings = TransformerDocumentEmbeddings('bert-base-uncased')\\n\r\n    res = []\r\n    i = 0\r\n    for sent in sentences.tolist() :\r\n        document_embeddings.embed(sent)\r\n        res.append(pd.DataFrame(sent.embedding.detach().numpy(), columns= ['vector']) )\r\n        print('embed doc : ', i, len(sent.tokens))\r\n        i=i+1\r\n        %memit  \r\n\r\n\r\nOn the 10th document the memory is off: \r\n\r\n> \r\n\r\n    embed doc :  0 5534\r\n    peak memory: 2872.60 MiB, increment: 0.00 MiB\r\n    embed doc :  1 5704\r\n    peak memory: 3546.12 MiB, increment: 0.00 MiB\r\n    embed doc :  2 13580\r\n    peak memory: 4219.87 MiB, increment: 0.00 MiB\r\n    embed doc :  3 17829\r\n    peak memory: 4893.87 MiB, increment: 0.00 MiB\r\n    embed doc :  4 10832\r\n    peak memory: 5567.14 MiB, increment: 0.00 MiB\r\n    embed doc :  5 15897\r\n    peak memory: 6240.81 MiB, increment: 0.00 MiB\r\n    embed doc :  6 3981\r\n    peak memory: 6914.24 MiB, increment: 0.00 MiB\r\n    embed doc :  7 11573\r\n    peak memory: 7587.70 MiB, increment: -0.25 MiB\r\n    embed doc :  8 6334\r\n    peak memory: 8261.38 MiB, increment: 0.00 MiB\r\n    embed doc :  9 5746\r\n    peak memory: 8934.84 MiB, increment: 0.00 MiB\r\n    embed doc :  10 7951`\r\n\r\nI didn't find any parameter that would allow to free the memory once the computation is finished for one document. Maybe I missed something? ", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1719/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1719/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1712", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1712/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1712/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1712/events", "html_url": "https://github.com/flairNLP/flair/issues/1712", "id": 643820469, "node_id": "MDU6SXNzdWU2NDM4MjA0Njk=", "number": 1712, "title": "albert-base-v2 tokenization broken", "user": {"login": "mittalsuraj18", "id": 5629517, "node_id": "MDQ6VXNlcjU2Mjk1MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5629517?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mittalsuraj18", "html_url": "https://github.com/mittalsuraj18", "followers_url": "https://api.github.com/users/mittalsuraj18/followers", "following_url": "https://api.github.com/users/mittalsuraj18/following{/other_user}", "gists_url": "https://api.github.com/users/mittalsuraj18/gists{/gist_id}", "starred_url": "https://api.github.com/users/mittalsuraj18/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mittalsuraj18/subscriptions", "organizations_url": "https://api.github.com/users/mittalsuraj18/orgs", "repos_url": "https://api.github.com/users/mittalsuraj18/repos", "events_url": "https://api.github.com/users/mittalsuraj18/events{/privacy}", "received_events_url": "https://api.github.com/users/mittalsuraj18/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-06-23T12:58:04Z", "updated_at": "2020-06-24T10:38:48Z", "closed_at": "2020-06-24T10:38:47Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nThe TextClassifier model loading crashes when model is trained on albert-base-v2\r\n\r\n**To Reproduce**\r\n- Train a text classifier using `albert-base-v2`. Save the model.\r\n- Now try to load this model in some other machine.\r\n- The loading crashes due to SentencePiece file not existing.\r\n\r\n**Expected behavior**\r\nModel should load successfully.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Ubuntu-20-LTS\r\n - Version [e.g. flair-0.3.2]: flair-github-master\r\n\r\n**Additional context**\r\nThere is workaround that involves monkey patching a bit of code like this\r\n```\r\nfrom types import MethodType\r\nimport transformers\r\nvocab_file  = transformers.tokenization_albert.AlbertTokenizer.from_pretrained(\"albert-base-v2\").vocab_file\r\ndef _setstate(self, d):  # Method to patch with\r\n    self.__dict__ = d\r\n    try:\r\n        import sentencepiece as spm\r\n    except ImportError:\r\n        logger.warning(\r\n            \"You need to install SentencePiece to use AlbertTokenizer: https://github.com/google/sentencepiece\"\r\n            \"pip install sentencepiece\"\r\n        )\r\n        raise\r\n    self.sp_model = spm.SentencePieceProcessor()\r\n    self.sp_model.Load(vocab_file)\r\n\r\n# Actual Patching being done here\r\ntransformers.tokenization_albert.AlbertTokenizer.__setstate__ = MethodType(\r\n            _setstate, transformers.tokenization_albert.AlbertTokenizer(vocab_file )\r\n)\r\n```\r\nHaving to do this everytime is crazy. Maybe we can implement some better way of handling this issue", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1712/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1712/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1709", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1709/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1709/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1709/events", "html_url": "https://github.com/flairNLP/flair/issues/1709", "id": 643408604, "node_id": "MDU6SXNzdWU2NDM0MDg2MDQ=", "number": 1709, "title": "predict(sentence, multi_class_prob=True) in TextClassification no longer works ", "user": {"login": "Amyylam", "id": 54615207, "node_id": "MDQ6VXNlcjU0NjE1MjA3", "avatar_url": "https://avatars.githubusercontent.com/u/54615207?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Amyylam", "html_url": "https://github.com/Amyylam", "followers_url": "https://api.github.com/users/Amyylam/followers", "following_url": "https://api.github.com/users/Amyylam/following{/other_user}", "gists_url": "https://api.github.com/users/Amyylam/gists{/gist_id}", "starred_url": "https://api.github.com/users/Amyylam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Amyylam/subscriptions", "organizations_url": "https://api.github.com/users/Amyylam/orgs", "repos_url": "https://api.github.com/users/Amyylam/repos", "events_url": "https://api.github.com/users/Amyylam/events{/privacy}", "received_events_url": "https://api.github.com/users/Amyylam/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-06-22T22:52:14Z", "updated_at": "2020-06-24T16:25:56Z", "closed_at": "2020-06-24T11:16:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\npredict(sentence, multi_class_prob=True) used to give probabilities for all labels, but now only give out one label and associated probability.  I have to revert to earlier commit to produce multiple class probabilities (pip install --upgrade git+https://github.com/flairNLP/flair.git@63aeabf9a18bdf53af3bcba5bd80f43ac717656e). \r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior (e.g. which model did you train? what parameters did you use? etc.).\r\n\r\nsentence = Sentence(\"Growth weakens as investment drops, consumers fade\")\r\n\r\nfinetuned_classifier.predict(sentence,multi_class_prob=True)\r\n\r\nprint(sentence.labels) \r\n\r\n**Expected behavior**\r\nit should return: [1 (0.0), -1 (1.0), 0 (0.0)] \r\ngiven the training data has 3 classes. \r\n\r\n**Screenshots**\r\nnow above steps returns only: [0 (0.0)]\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Mac, Linux virtualenv on Google Colab\r\n - Version [e.g. flair-0.3.2]: tried both flair-0.5 installed via \"pip install flair\" and also \"pip install --upgrade git+https://github.com/flairNLP/flair.git\"\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1709/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1709/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1703", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1703/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1703/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1703/events", "html_url": "https://github.com/flairNLP/flair/issues/1703", "id": 641995087, "node_id": "MDU6SXNzdWU2NDE5OTUwODc=", "number": 1703, "title": "Several errors with BERT embeddings in flair 0.5", "user": {"login": "lucaventurini", "id": 2151065, "node_id": "MDQ6VXNlcjIxNTEwNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/2151065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lucaventurini", "html_url": "https://github.com/lucaventurini", "followers_url": "https://api.github.com/users/lucaventurini/followers", "following_url": "https://api.github.com/users/lucaventurini/following{/other_user}", "gists_url": "https://api.github.com/users/lucaventurini/gists{/gist_id}", "starred_url": "https://api.github.com/users/lucaventurini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lucaventurini/subscriptions", "organizations_url": "https://api.github.com/users/lucaventurini/orgs", "repos_url": "https://api.github.com/users/lucaventurini/repos", "events_url": "https://api.github.com/users/lucaventurini/events{/privacy}", "received_events_url": "https://api.github.com/users/lucaventurini/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 22, "created_at": "2020-06-19T14:06:03Z", "updated_at": "2020-08-24T14:25:15Z", "closed_at": "2020-06-24T10:17:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\nI've been trying to replicate some experiments I did in the past with BERT embeddings on the new 0.5 release, without success.\r\nThe only update I did to the code was to replace BertEmbeddings with the new TransformerWordEmbeddings, as as I understood this is the recommended way to proceed. The embeddings I specify are 'bert-base-multilingual-cased', but I've been tried also with distilbert and gpt2.\r\nIn commit 63aeabf9a18bdf53af3bcba5bd80f43ac717656e, I met the error specified in #1672 , invalid shape. So I tried a more recent commit to see if this was solved.\r\nNow I'm in 3bf14fd13c3833394c7283132148261f937c0a83, which fails due to the following error:\r\n```python\r\nTraceback (most recent call last):\r\n  File \"train_flair.py\", line 187, in <module>\r\n    sys.exit(main(sys.argv[1:]))\r\n  File \"train_flair.py\", line 182, in main\r\n    trainer.train(args.outfolder, checkpoint=True, **hp)\r\n  File \"/opt/conda/lib/python3.6/site-packages/flair/trainers/trainer.py\", line 364, in train\r\n    loss = self.model.forward_loss(batch_step)\r\n  File \"/opt/conda/lib/python3.6/site-packages/flair/models/text_classification_model.py\", line 146, in forward_loss\r\n    scores = self.forward(data_points)\r\n  File \"/opt/conda/lib/python3.6/site-packages/flair/models/text_classification_model.py\", line 100, in forward\r\n    self.document_embeddings.embed(sentences)\r\n  File \"/opt/conda/lib/python3.6/site-packages/flair/embeddings/base.py\", line 61, in embed\r\n    self._add_embeddings_internal(sentences)\r\n  File \"/opt/conda/lib/python3.6/site-packages/flair/embeddings/document.py\", line 369, in _add_embeddings_internal\r\n    self.embeddings.embed(sentences)\r\n  File \"/opt/conda/lib/python3.6/site-packages/flair/embeddings/token.py\", line 71, in embed\r\n    embedding.embed(sentences)\r\n  File \"/opt/conda/lib/python3.6/site-packages/flair/embeddings/base.py\", line 61, in embed\r\n    self._add_embeddings_internal(sentences)\r\n  File \"/opt/conda/lib/python3.6/site-packages/flair/embeddings/token.py\", line 892, in _add_embeddings_internal\r\n    self._add_embeddings_to_sentences(batch)\r\n  File \"/opt/conda/lib/python3.6/site-packages/flair/embeddings/token.py\", line 965, in _add_embeddings_to_sentences\r\n    longest_sequence_in_batch: int = len(max(subtokenized_sentences, key=len))\r\nValueError: max() arg is an empty sequence\r\n```\r\nI thought it could be because of some empty sentence, but I always call `corpus.filter_empty_sentences()` before training, to be safe.\r\nIf I switch to turian embeddings, everything goes well. Is this a known issue?", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1703/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1703/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1699", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1699/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1699/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1699/events", "html_url": "https://github.com/flairNLP/flair/issues/1699", "id": 640392891, "node_id": "MDU6SXNzdWU2NDAzOTI4OTE=", "number": 1699, "title": "Tokenization MISMATCH and RuntimeError: shape '[...]' is invalid for input", "user": {"login": "AylaRT", "id": 20221378, "node_id": "MDQ6VXNlcjIwMjIxMzc4", "avatar_url": "https://avatars.githubusercontent.com/u/20221378?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AylaRT", "html_url": "https://github.com/AylaRT", "followers_url": "https://api.github.com/users/AylaRT/followers", "following_url": "https://api.github.com/users/AylaRT/following{/other_user}", "gists_url": "https://api.github.com/users/AylaRT/gists{/gist_id}", "starred_url": "https://api.github.com/users/AylaRT/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AylaRT/subscriptions", "organizations_url": "https://api.github.com/users/AylaRT/orgs", "repos_url": "https://api.github.com/users/AylaRT/repos", "events_url": "https://api.github.com/users/AylaRT/events{/privacy}", "received_events_url": "https://api.github.com/users/AylaRT/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 20, "created_at": "2020-06-17T12:13:11Z", "updated_at": "2021-05-12T11:49:39Z", "closed_at": "2021-05-12T11:49:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "HI, I am trying to use TransformerWordEmbeddings(\"bert-base-cased\") to train a sequential labeller with IOB labels (only \"I\", \"O\", \"B\" without subcategories). I started from the tutorial code (no optimisation yet) and my own train-test-dev data. My corpus seems to be created without any trouble and when I use flair embeddings I don't get any errors and good results. \r\n\r\nThis is a sample sentence from the corpus:\r\nTreatment of anemia \\<B> in patients \\<B> with heart \\<B> disease \\<I> : a clinical \\<B> practice \\<I> guideline \\<I> from the American \\<B> College \\<I> of \\<I> Physicians \\<I> .\r\n\r\nHowever, with \"bert-base-cased\" I get the following message:\r\nTokenization MISMATCH in sentence '2\u03bbr d \u03bbr = \uf8ee6(4a - 1)(1 - 2a ) 2 / ( 1 - 3a ) 2 \uf8f9 da \uf8f0 \uf8fb'\r\nLast matched: 'Token: 19 \uf8f9'\r\nLast sentence: 'Token: 22 \uf8fb'\r\nsubtokenized: '['[CLS]', '2', '##\u03bb', '##r', 'd', '\u03bb', '##r', '=', '6', '(', '4', '##a', '-', '1', ')', '(', '1', '-', '2', '##a', ')', '2', '/', '(', '1', '-', '3', '##a', ')', '2', 'da', '[SEP]']'\r\n\r\n(I see some of the special characters don't display correctly in this text, it concerns unicode symbols U+2308 up to U+230B)\r\n\r\nThe message is followed by this error:\r\nRuntimeError: shape '[32, 72, 3072]' is invalid for input of size 7065600\r\n\r\nIs there any way to solve this without changing the tokens in the corpus itself?\r\n\r\nPS: I run this code on a mac (Catalina), with PyCharm", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1699/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1699/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1690", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1690/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1690/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1690/events", "html_url": "https://github.com/flairNLP/flair/issues/1690", "id": 637946114, "node_id": "MDU6SXNzdWU2Mzc5NDYxMTQ=", "number": 1690, "title": "Problem with loading dialogpt", "user": {"login": "niedakh", "id": 291663, "node_id": "MDQ6VXNlcjI5MTY2Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/291663?v=4", "gravatar_id": "", "url": "https://api.github.com/users/niedakh", "html_url": "https://github.com/niedakh", "followers_url": "https://api.github.com/users/niedakh/followers", "following_url": "https://api.github.com/users/niedakh/following{/other_user}", "gists_url": "https://api.github.com/users/niedakh/gists{/gist_id}", "starred_url": "https://api.github.com/users/niedakh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/niedakh/subscriptions", "organizations_url": "https://api.github.com/users/niedakh/orgs", "repos_url": "https://api.github.com/users/niedakh/repos", "events_url": "https://api.github.com/users/niedakh/events{/privacy}", "received_events_url": "https://api.github.com/users/niedakh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-06-12T18:57:02Z", "updated_at": "2020-08-13T13:10:29Z", "closed_at": "2020-08-13T13:10:29Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n```\r\n----------------------------------------------------------------------------------------------------\r\n2020-06-12 18:44:49,152 Model training base path: \"dialogpt\"\r\n2020-06-12 18:44:49,152 ----------------------------------------------------------------------------------------------------\r\n\r\n2020-06-12 18:44:49,153 Device: cuda:0\r\n2020-06-12 18:44:49,154 ----------------------------------------------------------------------------------------------------\r\n2020-06-12 18:44:49,155 Embeddings storage mode: cpu\r\n2020-06-12 18:44:49,230 ----------------------------------------------------------------------------------------------------\r\n2020-06-12 18:49:00,669 epoch 1 - iter 76/766 - loss 1.11887558 - samples/sec: 9.67\r\n\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-7-e12f92b71d0b> in <module>\r\n      7         mini_batch_chunk_size=2, # set this if you get OOM errors\r\n      8         max_epochs=1, # very few epochs of fine-tuning\r\n----> 9         embeddings_storage_mode='cpu',\r\n     10         #checkpoint=True\r\n     11     )\r\n\r\n~/venv36/lib64/python3.6/site-packages/flair/trainers/trainer.py in train(self, base_path, learning_rate, mini_batch_size, mini_batch_chunk_size, max_epochs, scheduler, anneal_factor, patience, initial_extra_patience, min_learning_rate, train_with_dev, monitor_train, monitor_test, embeddings_storage_mode, checkpoint, save_final_model, anneal_with_restarts, anneal_with_prestarts, batch_growth_annealing, shuffle, param_selection_mode, num_workers, sampler, use_amp, amp_opt_level, eval_on_train_fraction, eval_on_train_shuffle, **kwargs)\r\n    376                         if not param_selection_mode:\r\n    377                             weight_extractor.extract_weights(\r\n--> 378                                 self.model.state_dict(), iteration\r\n    379                             )\r\n    380 \r\n\r\n~/venv36/lib64/python3.6/site-packages/flair/training_utils.py in extract_weights(self, state_dict, iteration)\r\n    262             vec = state_dict[key]\r\n    263             weights_to_watch = min(\r\n--> 264                 self.number_of_weights, reduce(lambda x, y: x * y, list(vec.size()))\r\n    265             )\r\n    266 \r\n\r\nTypeError: reduce() of empty sequence with no initial value\r\n\r\n```\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior (e.g. which model did you train? what parameters did you use? etc.).\r\n\r\nTake a tagging corpus of choice and run:\r\n\r\n```\r\nembeddings = TransformerWordEmbeddings(\r\n        'microsoft/DialoGPT-small',\r\n        layers=\"-1\",\r\n        pooling_operation='first_last',\r\n        fine_tune=True,\r\n    )\r\n\r\ntagger: SequenceTagger = SequenceTagger(\r\n        hidden_size=256,\r\n        embeddings=embeddings,\r\n        tag_dictionary=tag_dictionary,\r\n        tag_type=TAG_NAME,\r\n        use_crf=False,\r\n        use_rnn=False,\r\n    )\r\n\r\ntrainer = ModelTrainer(tagger, corpus, optimizer=torch.optim.Adam)\r\n\r\ntrainer.train('dialogpt',\r\n        learning_rate=3e-5,\r\n        mini_batch_chunk_size=2,\r\n        max_epochs=1,\r\n        embeddings_storage_mode='cpu'\r\n    )\r\n\r\n\r\n```\r\n\r\n**Expected behavior**\r\nThe models should train, instead I get the error.\r\n\r\n**Environment (please complete the following information):**\r\n - Centos7\r\n - Flair 0.5.0\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1690/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1690/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1685", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1685/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1685/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1685/events", "html_url": "https://github.com/flairNLP/flair/issues/1685", "id": 636880810, "node_id": "MDU6SXNzdWU2MzY4ODA4MTA=", "number": 1685, "title": "Deserialization of tokenizer gets loaded from huggingface", "user": {"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-06-11T09:52:43Z", "updated_at": "2020-06-11T15:29:19Z", "closed_at": "2020-06-11T15:29:19Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "**Describe the bug**\r\nAt the deserialization of a model, the tokenizer gets loaded from huggingface (we're using TransformerWordEmbeddings). This throws an error when for instance using SCIBERT, because it is not supported in huggingface.\r\n\r\n**To Reproduce**\r\nTrain a sequence tagger model using scibert. Then according to the docs: tagger = SequenceTagger(\"model_using_scibert\"), which throws an errors since it is looking the scibert tokenizer in the huggingface lib.\r\n\r\n**Expected behavior**\r\nThe tokenizer should not get loaded from huggingface if it is not available.\r\n\r\n**Environment (please complete the following information):**\r\n - macOS Catalina\r\n - Version flair 0.5\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1685/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1685/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1682", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1682/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1682/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1682/events", "html_url": "https://github.com/flairNLP/flair/issues/1682", "id": 636115632, "node_id": "MDU6SXNzdWU2MzYxMTU2MzI=", "number": 1682, "title": "Issue with wandb", "user": {"login": "zaowad", "id": 29595623, "node_id": "MDQ6VXNlcjI5NTk1NjIz", "avatar_url": "https://avatars.githubusercontent.com/u/29595623?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zaowad", "html_url": "https://github.com/zaowad", "followers_url": "https://api.github.com/users/zaowad/followers", "following_url": "https://api.github.com/users/zaowad/following{/other_user}", "gists_url": "https://api.github.com/users/zaowad/gists{/gist_id}", "starred_url": "https://api.github.com/users/zaowad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zaowad/subscriptions", "organizations_url": "https://api.github.com/users/zaowad/orgs", "repos_url": "https://api.github.com/users/zaowad/repos", "events_url": "https://api.github.com/users/zaowad/events{/privacy}", "received_events_url": "https://api.github.com/users/zaowad/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-06-10T10:02:52Z", "updated_at": "2020-10-15T13:27:34Z", "closed_at": "2020-10-15T13:27:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "I just installed flair with `pip install flair`. It was installed without any error message. But after I tried to load various embeddings with flair it shows \"module 'wandb' has no attribute 'ensure_configured''. After that, I found that no matter whatever module I try to load from flair it shows the same message. Please help!!!!\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1682/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1682/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1672", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1672/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1672/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1672/events", "html_url": "https://github.com/flairNLP/flair/issues/1672", "id": 633564395, "node_id": "MDU6SXNzdWU2MzM1NjQzOTU=", "number": 1672, "title": "Tokenization MISMATCH causes Runtime Error (keyphrase tagger model)", "user": {"login": "whoisjones", "id": 38491117, "node_id": "MDQ6VXNlcjM4NDkxMTE3", "avatar_url": "https://avatars.githubusercontent.com/u/38491117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whoisjones", "html_url": "https://github.com/whoisjones", "followers_url": "https://api.github.com/users/whoisjones/followers", "following_url": "https://api.github.com/users/whoisjones/following{/other_user}", "gists_url": "https://api.github.com/users/whoisjones/gists{/gist_id}", "starred_url": "https://api.github.com/users/whoisjones/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whoisjones/subscriptions", "organizations_url": "https://api.github.com/users/whoisjones/orgs", "repos_url": "https://api.github.com/users/whoisjones/repos", "events_url": "https://api.github.com/users/whoisjones/events{/privacy}", "received_events_url": "https://api.github.com/users/whoisjones/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2020-06-07T16:41:58Z", "updated_at": "2021-08-17T13:24:17Z", "closed_at": "2020-06-08T15:32:16Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "While training a tagging model using the provided Keyphrase dataset SEMEVAL2017, following error comes up:\r\n\r\nTokenization MISMATCH in sentence '...'\r\nLast matched: 'Token: 272 \u0304'\r\nLast sentence: 'Token: 325 .'\r\n\r\nwhich causes directly afterwards a Runtime Error during forward method in sequence_tagger_model.py:\r\nFile \"xxx/PycharmProjects/flair/flair/models/sequence_tagger_model.py\", line 541, in forward\r\n    self.embeddings.embedding_length,\r\nRuntimeError: shape '[16, 326, 3072]' is invalid for input of size 15857664\r\n\r\nTo reproduce, use a tagger tutorial code from flair. I use TransformerWordEmbeddings() with scibert or bert-base-uncased as embedding_types. Error does not comes up for example when training the tagger with flair embeddings.\r\n\r\nExpected is that the trainer can complete training without stopping due to special characters in the sentences.\r\n\r\nEnvironment:\r\n - MacOS Catalina 10.15.4\r\n - flair version 0.5\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1672/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1672/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1668", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1668/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1668/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1668/events", "html_url": "https://github.com/flairNLP/flair/issues/1668", "id": 631521695, "node_id": "MDU6SXNzdWU2MzE1MjE2OTU=", "number": 1668, "title": "Tensorflow warnings cannot be disabled", "user": {"login": "ghost", "id": 10137, "node_id": "MDQ6VXNlcjEwMTM3", "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ghost", "html_url": "https://github.com/ghost", "followers_url": "https://api.github.com/users/ghost/followers", "following_url": "https://api.github.com/users/ghost/following{/other_user}", "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}", "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ghost/subscriptions", "organizations_url": "https://api.github.com/users/ghost/orgs", "repos_url": "https://api.github.com/users/ghost/repos", "events_url": "https://api.github.com/users/ghost/events{/privacy}", "received_events_url": "https://api.github.com/users/ghost/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-06-05T11:30:08Z", "updated_at": "2020-10-10T14:03:02Z", "closed_at": "2020-10-10T14:03:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nTensorflow warnings are raised to the console when importing the flair data and models, even when os.environ['TF_CPP_MIN_LOG_LEVEL'] = '3' is set.\r\n\r\n`\r\n2020-06-05 13:24:23.260894: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'cudart64_101.dll'; dlerror: cudart64_101.dll not found\r\n2020-06-05 13:24:23.261217: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\r\n`\r\n\r\n**To Reproduce**\r\nImport flair\r\nRunning it in PyCharm on a Windows machine.\r\n\r\n**Expected behavior**\r\nAn option available to mute warnings to the console.\r\n\r\n**Environment (please complete the following information):**\r\n - Windows 10, no GPU\r\n - Flair version 0.4.5\r\n - Python version 3.7.7\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1668/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1668/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1666", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1666/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1666/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1666/events", "html_url": "https://github.com/flairNLP/flair/issues/1666", "id": 631261803, "node_id": "MDU6SXNzdWU2MzEyNjE4MDM=", "number": 1666, "title": "Warnings in Python 3.8", "user": {"login": "tirkarthi", "id": 3972343, "node_id": "MDQ6VXNlcjM5NzIzNDM=", "avatar_url": "https://avatars.githubusercontent.com/u/3972343?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tirkarthi", "html_url": "https://github.com/tirkarthi", "followers_url": "https://api.github.com/users/tirkarthi/followers", "following_url": "https://api.github.com/users/tirkarthi/following{/other_user}", "gists_url": "https://api.github.com/users/tirkarthi/gists{/gist_id}", "starred_url": "https://api.github.com/users/tirkarthi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tirkarthi/subscriptions", "organizations_url": "https://api.github.com/users/tirkarthi/orgs", "repos_url": "https://api.github.com/users/tirkarthi/repos", "events_url": "https://api.github.com/users/tirkarthi/events{/privacy}", "received_events_url": "https://api.github.com/users/tirkarthi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-06-05T02:20:06Z", "updated_at": "2020-06-08T16:21:12Z", "closed_at": "2020-06-08T16:21:12Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\n\r\n* Deprecation warnings are raised due to invalid escape sequences. This can be fixed by using raw strings or escaping the literals. pyupgrade also helps in automatic conversion : https://github.com/asottile/pyupgrade/\r\n* Syntax warning due to comparison of literals using is.\r\n\r\n**To Reproduce**\r\n\r\n```\r\nfind . -iname '*.py' | grep -v example | xargs -P4 -I{} python3.8 -Wall -m py_compile {}\r\n./flair/datasets/sequence_labeling.py:24: DeprecationWarning: invalid escape sequence \\s\r\n  column_delimiter: str = \"\\s+\",\r\n./flair/datasets/sequence_labeling.py:106: DeprecationWarning: invalid escape sequence \\s\r\n  column_delimiter: str = \"\\s+\",\r\n./flair/data_fetcher.py:573: DeprecationWarning: invalid escape sequence \\s\r\n  fields: List[str] = re.split(\"\\s+\", line)\r\n./flair/trainers/language_model_trainer.py:146: SyntaxWarning: \"is\" with a literal. Did you mean \"==\"?\r\n  if no is 0:\r\n./flair/trainers/language_model_trainer.py:148: SyntaxWarning: \"is\" with a literal. Did you mean \"==\"?\r\n  if no is 1:\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Linux\r\n - Version [e.g. flair-0.3.2]: master branch", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1666/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1666/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1665", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1665/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1665/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1665/events", "html_url": "https://github.com/flairNLP/flair/issues/1665", "id": 631202192, "node_id": "MDU6SXNzdWU2MzEyMDIxOTI=", "number": 1665, "title": "Anomaly when attempting to train Text Classifier (RuntimeError)", "user": {"login": "jar2333", "id": 38730172, "node_id": "MDQ6VXNlcjM4NzMwMTcy", "avatar_url": "https://avatars.githubusercontent.com/u/38730172?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jar2333", "html_url": "https://github.com/jar2333", "followers_url": "https://api.github.com/users/jar2333/followers", "following_url": "https://api.github.com/users/jar2333/following{/other_user}", "gists_url": "https://api.github.com/users/jar2333/gists{/gist_id}", "starred_url": "https://api.github.com/users/jar2333/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jar2333/subscriptions", "organizations_url": "https://api.github.com/users/jar2333/orgs", "repos_url": "https://api.github.com/users/jar2333/repos", "events_url": "https://api.github.com/users/jar2333/events{/privacy}", "received_events_url": "https://api.github.com/users/jar2333/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2020-06-04T23:12:02Z", "updated_at": "2020-10-22T02:56:30Z", "closed_at": "2020-10-22T02:56:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nCannot train Text Classifier models, as the script fails when computing label dictionary. Both own CSV dataset model and TREC_6 example dataset model given in tutorial 7 fail with the same error.\r\n\r\n**RAN SCRIPT:**\r\n`from flair.data import Corpus\r\nfrom flair.datasets import TREC_6\r\nfrom flair.embeddings import WordEmbeddings, FlairEmbeddings, DocumentRNNEmbeddings\r\nfrom flair.models import TextClassifier\r\nfrom flair.trainers import ModelTrainer\r\n\r\n\r\ncorpus: Corpus = TREC_6()\r\n\r\nlabel_dict = corpus.make_label_dictionary()\r\n\r\nword_embeddings = [WordEmbeddings('glove')]\r\n\r\ndocument_embeddings = DocumentRNNEmbeddings(word_embeddings, hidden_size=256)\r\n\r\nclassifier = TextClassifier(document_embeddings, label_dictionary=label_dict)\r\n\r\ntrainer = ModelTrainer(classifier, corpus)\r\n\r\ntrainer.train('resources/taggers/trec',\r\n              learning_rate=0.1,\r\n              mini_batch_size=32,\r\n              anneal_factor=0.5,\r\n              patience=5,\r\n              max_epochs=150)`\r\n\r\n**SCRIPT RUNNING AND ERROR:**\r\n`(env) C:\\Users\\Me\\Documents\\Blog\\AIKame\\deep>python tc_sample.py\r\n2020-06-04 18:56:14,309 Reading data from C:\\Users\\Me\\.flair\\datasets\\trec_6\r\n2020-06-04 18:56:14,309 Train: C:\\Users\\Me\\.flair\\datasets\\trec_6\\train.txt\r\n2020-06-04 18:56:14,309 Dev: None\r\n2020-06-04 18:56:14,309 Test: C:\\Users\\Me\\.flair\\datasets\\trec_6\\test.txt\r\n2020-06-04 18:56:14,394 Computing label dictionary. Progress:\r\n2020-06-04 18:56:16,935 Reading data from C:\\Users\\Me\\.flair\\datasets\\trec_6\r\n2020-06-04 18:56:16,935 Train: C:\\Users\\Me\\.flair\\datasets\\trec_6\\train.txt\r\n2020-06-04 18:56:16,935 Dev: None\r\n2020-06-04 18:56:16,935 Test: C:\\Users\\Me\\.flair\\datasets\\trec_6\\test.txt\r\n2020-06-04 18:56:17,019 Computing label dictionary. Progress:\r\nTraceback (most recent call last):\r\n  File \"<string>\", line 1, in <module>\r\n  File \"C:\\Users\\Me\\AppData\\Local\\Programs\\Python\\Python38\\lib\\multiprocessing\\spawn.py\", line 116, in spawn_main\r\n    exitcode = _main(fd, parent_sentinel)\r\n  File \"C:\\Users\\Me\\AppData\\Local\\Programs\\Python\\Python38\\lib\\multiprocessing\\spawn.py\", line 125, in _main\r\n    prepare(preparation_data)\r\n  File \"C:\\Users\\Me\\AppData\\Local\\Programs\\Python\\Python38\\lib\\multiprocessing\\spawn.py\", line 236, in prepare\r\n    _fixup_main_from_path(data['init_main_from_path'])\r\n  File \"C:\\Users\\Me\\AppData\\Local\\Programs\\Python\\Python38\\lib\\multiprocessing\\spawn.py\", line 287, in _fixup_main_from_path\r\n    main_content = runpy.run_path(main_path,\r\n  File \"C:\\Users\\Me\\AppData\\Local\\Programs\\Python\\Python38\\lib\\runpy.py\", line 265, in run_path\r\n    return _run_module_code(code, init_globals, run_name,\r\n  File \"C:\\Users\\Me\\AppData\\Local\\Programs\\Python\\Python38\\lib\\runpy.py\", line 97, in _run_module_code\r\n    _run_code(code, mod_globals, init_globals,\r\n  File \"C:\\Users\\Me\\AppData\\Local\\Programs\\Python\\Python38\\lib\\runpy.py\", line 87, in _run_code\r\n    exec(code, run_globals)\r\n  File \"C:\\Users\\Me\\Documents\\Blog\\AIKame\\deep\\tc_sample.py\", line 12, in <module>\r\n    label_dict = corpus.make_label_dictionary()\r\n  File \"C:\\Users\\Me\\Documents\\Blog\\AIKame\\deep\\env\\lib\\site-packages\\flair\\data.py\", line 1124, in make_label_dictionary\r\n    for batch in Tqdm.tqdm(iter(loader)):\r\n  File \"C:\\Users\\Me\\Documents\\Blog\\AIKame\\deep\\env\\lib\\site-packages\\torch\\utils\\data\\dataloader.py\", line 279, in __iter__\r\n    return _MultiProcessingDataLoaderIter(self)\r\n  File \"C:\\Users\\Me\\Documents\\Blog\\AIKame\\deep\\env\\lib\\site-packages\\torch\\utils\\data\\dataloader.py\", line 719, in __init__\r\n    w.start()\r\n  File \"C:\\Users\\Me\\AppData\\Local\\Programs\\Python\\Python38\\lib\\multiprocessing\\process.py\", line 121, in start\r\n    self._popen = self._Popen(self)\r\n  File \"C:\\Users\\Me\\AppData\\Local\\Programs\\Python\\Python38\\lib\\multiprocessing\\context.py\", line 224, in _Popen\r\n    return _default_context.get_context().Process._Popen(process_obj)\r\n  File \"C:\\Users\\Me\\AppData\\Local\\Programs\\Python\\Python38\\lib\\multiprocessing\\context.py\", line 326, in _Popen\r\n    return Popen(process_obj)\r\n  File \"C:\\Users\\Me\\AppData\\Local\\Programs\\Python\\Python38\\lib\\multiprocessing\\popen_spawn_win32.py\", line 45, in __init__\r\n    prep_data = spawn.get_preparation_data(process_obj._name)\r\n  File \"C:\\Users\\Me\\AppData\\Local\\Programs\\Python\\Python38\\lib\\multiprocessing\\spawn.py\", line 154, in get_preparation_data\r\n    _check_not_importing_main()\r\n  File \"C:\\Users\\Me\\AppData\\Local\\Programs\\Python\\Python38\\lib\\multiprocessing\\spawn.py\", line 134, in _check_not_importing_main\r\n    raise RuntimeError('''\r\nRuntimeError:\r\n        An attempt has been made to start a new process before the\r\n        current process has finished its bootstrapping phase.\r\n\r\n        This probably means that you are not using fork to start your\r\n        child processes and you have forgotten to use the proper idiom\r\n        in the main module:\r\n\r\n            if __name__ == '__main__':\r\n                freeze_support()\r\n                ...\r\n\r\n        The \"freeze_support()\" line can be omitted if the program\r\n        is not going to be frozen to produce an executable.\r\n\r\n`\r\n\r\n**To Reproduce**\r\nI ran the script as provided. I made a virtualenv and installed flair on it to test if it was some weird conflict, but the error persisted.\r\n\r\n**Expected behavior**\r\nI expected the model to train correctly. The fact that Text Classifier models wont train is odd, since Sequence Labeling models like the example UD_ENGLISH in Tutorial 7 did run successfully.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [Windows 10 64-bit]:\r\n - Version [flair-0.5]:\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1665/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1665/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1661", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1661/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1661/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1661/events", "html_url": "https://github.com/flairNLP/flair/issues/1661", "id": 629943023, "node_id": "MDU6SXNzdWU2Mjk5NDMwMjM=", "number": 1661, "title": "Fine-tuning t5-base model raises an error", "user": {"login": "krzysztoffiok", "id": 37101271, "node_id": "MDQ6VXNlcjM3MTAxMjcx", "avatar_url": "https://avatars.githubusercontent.com/u/37101271?v=4", "gravatar_id": "", "url": "https://api.github.com/users/krzysztoffiok", "html_url": "https://github.com/krzysztoffiok", "followers_url": "https://api.github.com/users/krzysztoffiok/followers", "following_url": "https://api.github.com/users/krzysztoffiok/following{/other_user}", "gists_url": "https://api.github.com/users/krzysztoffiok/gists{/gist_id}", "starred_url": "https://api.github.com/users/krzysztoffiok/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/krzysztoffiok/subscriptions", "organizations_url": "https://api.github.com/users/krzysztoffiok/orgs", "repos_url": "https://api.github.com/users/krzysztoffiok/repos", "events_url": "https://api.github.com/users/krzysztoffiok/events{/privacy}", "received_events_url": "https://api.github.com/users/krzysztoffiok/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": {"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2020-06-03T12:10:22Z", "updated_at": "2023-01-07T13:48:20Z", "closed_at": "2023-01-07T13:48:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nI tried to fine-tune T5-base model on google colab and get this error\r\n\r\nValueError(\"You have to specify either decoder_input_ids or decoder_inputs_embeds\")\r\n\r\nTo be more specific where the error happens, it happens at the very moment when the training should start:\r\n\r\n2020-06-03 12:07:25,877 ----------------------------------------------------------------------------------------------------\r\n2020-06-03 12:07:25,877 Corpus: \"Corpus: 4800 train + 1200 dev + 20630 test sentences\"\r\n2020-06-03 12:07:25,878 ----------------------------------------------------------------------------------------------------\r\n2020-06-03 12:07:25,878 Parameters:\r\n2020-06-03 12:07:25,878  - learning_rate: \"3e-06\"\r\n2020-06-03 12:07:25,879  - mini_batch_size: \"8\"\r\n2020-06-03 12:07:25,879  - patience: \"3\"\r\n2020-06-03 12:07:25,879  - anneal_factor: \"0.5\"\r\n2020-06-03 12:07:25,880  - max_epochs: \"4\"\r\n2020-06-03 12:07:25,880  - shuffle: \"True\"\r\n2020-06-03 12:07:25,880  - train_with_dev: \"False\"\r\n2020-06-03 12:07:25,880  - batch_growth_annealing: \"False\"\r\n2020-06-03 12:07:25,880 ----------------------------------------------------------------------------------------------------\r\n2020-06-03 12:07:25,880 Model training base path: \"semeval_data/model_sentiment_0\"\r\n2020-06-03 12:07:25,880 ----------------------------------------------------------------------------------------------------\r\n2020-06-03 12:07:25,880 Device: cuda:0\r\n2020-06-03 12:07:25,881 ----------------------------------------------------------------------------------------------------\r\n2020-06-03 12:07:25,881 Embeddings storage mode: cpu\r\n2020-06-03 12:07:25,883 ----------------------------------------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"./model_train.py\", line 138, in <module>\r\n    shuffle=True,\r\n  File \"/usr/local/lib/python3.6/dist-packages/flair/trainers/trainer.py\", line 349, in train\r\n    loss = self.model.forward_loss(batch_step)\r\n  File \"/usr/local/lib/python3.6/dist-packages/flair/models/text_classification_model.py\", line 142, in forward_loss\r\n    scores = self.forward(data_points)\r\n  File \"/usr/local/lib/python3.6/dist-packages/flair/models/text_classification_model.py\", line 98, in forward\r\n    self.document_embeddings.embed(sentences)\r\n  File \"/usr/local/lib/python3.6/dist-packages/flair/embeddings/base.py\", line 59, in embed\r\n    self._add_embeddings_internal(sentences)\r\n  File \"/usr/local/lib/python3.6/dist-packages/flair/embeddings/document.py\", line 91, in _add_embeddings_internal\r\n    self._add_embeddings_to_sentences(batch)\r\n  File \"/usr/local/lib/python3.6/dist-packages/flair/embeddings/document.py\", line 136, in _add_embeddings_to_sentences\r\n    else self.model(input_ids)[-1]\r\n  File \"/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py\", line 550, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/transformers/modeling_t5.py\", line 955, in forward\r\n    use_cache=use_cache,\r\n  File \"/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py\", line 550, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/transformers/modeling_t5.py\", line 674, in forward\r\n    raise ValueError(\"You have to specify either decoder_input_ids or decoder_inputs_embeds\")\r\nValueError: You have to specify either decoder_input_ids or decoder_inputs_embeds\r\n\r\n**To Reproduce**\r\nGo to google colab, create a new project with gpu and do the following:\r\n!git clone https://github.com/krzysztoffiok/twitter_sentiment\r\n!pip3 install flair\r\n!pip3 install datatable\r\n\r\ncd twitter_sentiment\r\n\r\n!python3 ./semeval_data_splitter.py\r\n!python3 ./model_train.py --dataset=semeval --k_folds=5 --test_run=t5-base --fine_tune\r\n\r\n**Expected behavior**\r\nthe script should start training (fine tuning) a list of models, the first given is t5-base\r\n\r\n**Environment (please complete the following information):**\r\ngoogle colab GPU runtime\r\n\r\n!nvidia-smi\r\nWed Jun  3 12:11:08 2020       \r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 440.82       Driver Version: 418.67       CUDA Version: 10.1     |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  Tesla K80           Off  | 00000000:00:04.0 Off |                    0 |\r\n| N/A   36C    P8    26W / 149W |      0MiB / 11441MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n                                                                               \r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID   Type   Process name                             Usage      |\r\n|=============================================================================|\r\n|  No running processes found                                                 |\r\n+-----------------------------------------------------------------------------+\r\n\r\n!pip3 freeze returns:\r\n\r\nabsl-py==0.9.0\r\nalabaster==0.7.12\r\nalbumentations==0.1.12\r\naltair==4.1.0\r\nasgiref==3.2.7\r\nastor==0.8.1\r\nastropy==4.0.1.post1\r\nastunparse==1.6.3\r\natari-py==0.2.6\r\natomicwrites==1.4.0\r\nattrs==19.3.0\r\naudioread==2.1.8\r\nautograd==1.3\r\nBabel==2.8.0\r\nbackcall==0.1.0\r\nbeautifulsoup4==4.6.3\r\nbleach==3.1.5\r\nblessed==1.17.6\r\nblis==0.4.1\r\nbokeh==1.4.0\r\nboto==2.49.0\r\nboto3==1.13.19\r\nbotocore==1.16.19\r\nBottleneck==1.3.2\r\nbpemb==0.3.0\r\nbranca==0.4.1\r\nbs4==0.0.1\r\nCacheControl==0.12.6\r\ncachetools==3.1.1\r\ncatalogue==1.0.0\r\ncertifi==2020.4.5.1\r\ncffi==1.14.0\r\nchainer==6.5.0\r\nchardet==3.0.4\r\nclick==7.1.2\r\ncloudpickle==1.3.0\r\ncmake==3.12.0\r\ncmdstanpy==0.4.0\r\ncolorama==0.4.3\r\ncolorlover==0.3.0\r\ncommunity==1.0.0b1\r\ncontextlib2==0.5.5\r\nconvertdate==2.2.1\r\ncoverage==3.7.1\r\ncoveralls==0.5\r\ncrcmod==1.7\r\ncufflinks==0.17.3\r\ncupy-cuda101==6.5.0\r\ncvxopt==1.2.5\r\ncvxpy==1.0.31\r\ncycler==0.10.0\r\ncymem==2.0.3\r\nCython==0.29.19\r\ndaft==0.0.4\r\ndask==2.12.0\r\ndataclasses==0.7\r\ndatascience==0.10.6\r\ndatatable==0.10.1\r\ndecorator==4.4.2\r\ndefusedxml==0.6.0\r\nDeprecated==1.2.10\r\ndescartes==1.1.0\r\ndill==0.3.1.1\r\ndistributed==1.25.3\r\nDjango==3.0.6\r\ndlib==19.18.0\r\ndocopt==0.6.2\r\ndocutils==0.15.2\r\ndopamine-rl==1.0.5\r\nearthengine-api==0.1.223\r\neasydict==1.9\r\necos==2.0.7.post1\r\neditdistance==0.5.3\r\nen-core-web-sm==2.2.5\r\nentrypoints==0.3\r\nephem==3.7.7.1\r\net-xmlfile==1.0.1\r\nfa2==0.3.5\r\nfancyimpute==0.4.3\r\nfastai==1.0.61\r\nfastdtw==0.3.4\r\nfastprogress==0.2.3\r\nfastrlock==0.4\r\nfbprophet==0.6\r\nfeather-format==0.4.1\r\nfeaturetools==0.4.1\r\nfilelock==3.0.12\r\nfirebase-admin==4.1.0\r\nfix-yahoo-finance==0.0.22\r\nflair==0.5\r\nFlask==1.1.2\r\nfolium==0.8.3\r\nfsspec==0.7.4\r\nfuture==0.16.0\r\ngast==0.3.3\r\nGDAL==2.2.2\r\ngdown==3.6.4\r\ngensim==3.6.0\r\ngeographiclib==1.50\r\ngeopy==1.17.0\r\ngin-config==0.3.0\r\nglob2==0.7\r\ngoogle==2.0.3\r\ngoogle-api-core==1.16.0\r\ngoogle-api-python-client==1.7.12\r\ngoogle-auth==1.7.2\r\ngoogle-auth-httplib2==0.0.3\r\ngoogle-auth-oauthlib==0.4.1\r\ngoogle-cloud-bigquery==1.21.0\r\ngoogle-cloud-core==1.0.3\r\ngoogle-cloud-datastore==1.8.0\r\ngoogle-cloud-firestore==1.7.0\r\ngoogle-cloud-language==1.2.0\r\ngoogle-cloud-storage==1.18.1\r\ngoogle-cloud-translate==1.5.0\r\ngoogle-colab==1.0.0\r\ngoogle-pasta==0.2.0\r\ngoogle-resumable-media==0.4.1\r\ngoogleapis-common-protos==1.51.0\r\ngoogledrivedownloader==0.4\r\ngraphviz==0.10.1\r\ngrpcio==1.29.0\r\ngspread==3.0.1\r\ngspread-dataframe==3.0.7\r\ngym==0.17.2\r\nh5py==2.10.0\r\nHeapDict==1.0.1\r\nholidays==0.9.12\r\nhtml5lib==1.0.1\r\nhttpimport==0.5.18\r\nhttplib2==0.17.4\r\nhttplib2shim==0.0.3\r\nhumanize==0.5.1\r\nhyperopt==0.1.2\r\nideep4py==2.0.0.post3\r\nidna==2.9\r\nimage==1.5.32\r\nimageio==2.4.1\r\nimagesize==1.2.0\r\nimbalanced-learn==0.4.3\r\nimblearn==0.0\r\nimgaug==0.2.9\r\nimportlib-metadata==1.6.0\r\nimutils==0.5.3\r\ninflect==2.1.0\r\nintel-openmp==2020.0.133\r\nintervaltree==2.1.0\r\nipykernel==4.10.1\r\nipython==5.5.0\r\nipython-genutils==0.2.0\r\nipython-sql==0.3.9\r\nipywidgets==7.5.1\r\nitsdangerous==1.1.0\r\njax==0.1.68\r\njaxlib==0.1.47\r\njdcal==1.4.1\r\njedi==0.17.0\r\njieba==0.42.1\r\nJinja2==2.11.2\r\njmespath==0.10.0\r\njoblib==0.15.1\r\njpeg4py==0.1.4\r\njsonschema==2.6.0\r\njupyter==1.0.0\r\njupyter-client==5.3.4\r\njupyter-console==5.2.0\r\njupyter-core==4.6.3\r\nkaggle==1.5.6\r\nkapre==0.1.3.1\r\nKeras==2.3.1\r\nKeras-Applications==1.0.8\r\nKeras-Preprocessing==1.1.2\r\nkeras-vis==0.4.1\r\nkiwisolver==1.2.0\r\nknnimpute==0.1.0\r\nlangdetect==1.0.8\r\nlibrosa==0.6.3\r\nlightgbm==2.2.3\r\nllvmlite==0.31.0\r\nlmdb==0.98\r\nlucid==0.3.8\r\nLunarCalendar==0.0.9\r\nlxml==4.2.6\r\nMarkdown==3.2.2\r\nMarkupSafe==1.1.1\r\nmatplotlib==3.2.1\r\nmatplotlib-venn==0.11.5\r\nmissingno==0.4.2\r\nmistune==0.8.4\r\nmizani==0.6.0\r\nmkl==2019.0\r\nmlxtend==0.14.0\r\nmore-itertools==8.3.0\r\nmoviepy==0.2.3.5\r\nmpld3==0.3\r\nmpmath==1.1.0\r\nmsgpack==1.0.0\r\nmultiprocess==0.70.9\r\nmultitasking==0.0.9\r\nmurmurhash==1.0.2\r\nmusic21==5.5.0\r\nnatsort==5.5.0\r\nnbconvert==5.6.1\r\nnbformat==5.0.6\r\nnetworkx==2.4\r\nnibabel==3.0.2\r\nnltk==3.2.5\r\nnotebook==5.2.2\r\nnp-utils==0.5.12.1\r\nnumba==0.48.0\r\nnumexpr==2.7.1\r\nnumpy==1.18.4\r\nnvidia-ml-py3==7.352.0\r\noauth2client==4.1.3\r\noauthlib==3.1.0\r\nokgrade==0.4.3\r\nopencv-contrib-python==4.1.2.30\r\nopencv-python==4.1.2.30\r\nopenpyxl==2.5.9\r\nopt-einsum==3.2.1\r\nosqp==0.6.1\r\npackaging==20.4\r\npalettable==3.3.0\r\npandas==1.0.4\r\npandas-datareader==0.8.1\r\npandas-gbq==0.11.0\r\npandas-profiling==1.4.1\r\npandocfilters==1.4.2\r\nparso==0.7.0\r\npathlib==1.0.1\r\npatsy==0.5.1\r\npexpect==4.8.0\r\npickleshare==0.7.5\r\nPillow==7.0.0\r\npip-tools==4.5.1\r\nplac==1.1.3\r\nplotly==4.4.1\r\nplotnine==0.6.0\r\npluggy==0.13.1\r\nportpicker==1.3.1\r\nprefetch-generator==1.0.1\r\npreshed==3.0.2\r\nprettytable==0.7.2\r\nprogressbar2==3.38.0\r\nprometheus-client==0.8.0\r\npromise==2.3\r\nprompt-toolkit==1.0.18\r\nprotobuf==3.10.0\r\npsutil==5.4.8\r\npsycopg2==2.7.6.1\r\nptvsd==5.0.0a12\r\nptyprocess==0.6.0\r\npy==1.8.1\r\npyarrow==0.14.1\r\npyasn1==0.4.8\r\npyasn1-modules==0.2.8\r\npycocotools==2.0.0\r\npycparser==2.20\r\npydata-google-auth==1.1.0\r\npydot==1.3.0\r\npydot-ng==2.0.0\r\npydotplus==2.0.2\r\nPyDrive==1.3.1\r\npyemd==0.5.1\r\npyglet==1.5.0\r\nPygments==2.1.3\r\npygobject==3.26.1\r\npymc3==3.7\r\nPyMeeus==0.3.7\r\npymongo==3.10.1\r\npymystem3==0.2.0\r\nPyOpenGL==3.1.5\r\npyparsing==2.4.7\r\npyrsistent==0.16.0\r\npysndfile==1.3.8\r\nPySocks==1.7.1\r\npystan==2.19.1.1\r\npytest==5.4.3\r\npython-apt==1.6.5+ubuntu0.2\r\npython-chess==0.23.11\r\npython-dateutil==2.8.1\r\npython-louvain==0.14\r\npython-slugify==4.0.0\r\npython-utils==2.4.0\r\npytz==2018.9\r\nPyWavelets==1.1.1\r\nPyYAML==3.13\r\npyzmq==19.0.1\r\nqtconsole==4.7.4\r\nQtPy==1.9.0\r\nregex==2019.12.20\r\nrequests==2.23.0\r\nrequests-oauthlib==1.3.0\r\nresampy==0.2.2\r\nretrying==1.3.3\r\nrpy2==3.2.7\r\nrsa==4.0\r\ns3fs==0.4.2\r\ns3transfer==0.3.3\r\nsacremoses==0.0.43\r\nscikit-image==0.16.2\r\nscikit-learn==0.22.2.post1\r\nscipy==1.4.1\r\nscreen-resolution-extra==0.0.0\r\nscs==2.1.2\r\nseaborn==0.10.1\r\nsegtok==1.5.10\r\nSend2Trash==1.5.0\r\nsentencepiece==0.1.91\r\nsetuptools-git==1.2\r\nShapely==1.7.0\r\nsimplegeneric==0.8.1\r\nsix==1.12.0\r\nsklearn==0.0\r\nsklearn-pandas==1.8.0\r\nsmart-open==2.0.0\r\nsnowballstemmer==2.0.0\r\nsortedcontainers==2.1.0\r\nspacy==2.2.4\r\nSphinx==1.8.5\r\nsphinxcontrib-websupport==1.2.2\r\nSQLAlchemy==1.3.17\r\nsqlitedict==1.6.0\r\nsqlparse==0.3.1\r\nsrsly==1.0.2\r\nstatsmodels==0.10.2\r\nsympy==1.1.1\r\ntables==3.4.4\r\ntabulate==0.8.7\r\ntbb==2020.0.133\r\ntblib==1.6.0\r\ntensorboard==2.2.2\r\ntensorboard-plugin-wit==1.6.0.post3\r\ntensorboardcolab==0.0.22\r\ntensorflow==2.2.0\r\ntensorflow-addons==0.8.3\r\ntensorflow-datasets==2.1.0\r\ntensorflow-estimator==2.2.0\r\ntensorflow-gcs-config==2.1.8\r\ntensorflow-hub==0.8.0\r\ntensorflow-metadata==0.22.1\r\ntensorflow-privacy==0.2.2\r\ntensorflow-probability==0.10.0\r\ntermcolor==1.1.0\r\nterminado==0.8.3\r\ntestpath==0.4.4\r\ntext-unidecode==1.3\r\ntextblob==0.15.3\r\ntextgenrnn==1.4.1\r\nTheano==1.0.4\r\nthinc==7.4.0\r\ntifffile==2020.5.30\r\ntokenizers==0.7.0\r\ntoolz==0.10.0\r\ntorch==1.5.0+cu101\r\ntorchsummary==1.5.1\r\ntorchtext==0.3.1\r\ntorchvision==0.6.0+cu101\r\ntornado==4.5.3\r\ntqdm==4.41.1\r\ntraitlets==4.3.3\r\ntransformers==2.11.0\r\ntweepy==3.6.0\r\ntypeguard==2.7.1\r\ntypesentry==0.2.7\r\ntyping==3.6.6\r\ntyping-extensions==3.6.6\r\ntzlocal==1.5.1\r\numap-learn==0.4.3\r\nuritemplate==3.0.1\r\nurllib3==1.24.3\r\nvega-datasets==0.8.0\r\nwasabi==0.6.0\r\nwcwidth==0.1.9\r\nwebencodings==0.5.1\r\nWerkzeug==1.0.1\r\nwidgetsnbextension==3.5.1\r\nwordcloud==1.5.0\r\nwrapt==1.12.1\r\nxarray==0.15.1\r\nxgboost==0.90\r\nxkit==0.0.0\r\nxlrd==1.1.0\r\nxlwt==1.3.0\r\nyellowbrick==0.9.1\r\nzict==2.0.0\r\nzipp==3.1.0\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1661/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1661/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1657", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1657/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1657/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1657/events", "html_url": "https://github.com/flairNLP/flair/issues/1657", "id": 629544188, "node_id": "MDU6SXNzdWU2Mjk1NDQxODg=", "number": 1657, "title": "Cannot download \"torch\" when installing flair through pip", "user": {"login": "jar2333", "id": 38730172, "node_id": "MDQ6VXNlcjM4NzMwMTcy", "avatar_url": "https://avatars.githubusercontent.com/u/38730172?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jar2333", "html_url": "https://github.com/jar2333", "followers_url": "https://api.github.com/users/jar2333/followers", "following_url": "https://api.github.com/users/jar2333/following{/other_user}", "gists_url": "https://api.github.com/users/jar2333/gists{/gist_id}", "starred_url": "https://api.github.com/users/jar2333/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jar2333/subscriptions", "organizations_url": "https://api.github.com/users/jar2333/orgs", "repos_url": "https://api.github.com/users/jar2333/repos", "events_url": "https://api.github.com/users/jar2333/events{/privacy}", "received_events_url": "https://api.github.com/users/jar2333/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-06-02T22:03:14Z", "updated_at": "2020-06-04T16:00:08Z", "closed_at": "2020-06-04T16:00:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nAs the title says, the installation halts when torch download it attempted. It gives the following error messages:\r\n\r\nERROR: Could not find a version that satisfies the requirement torch>=1.1.0 (from flair) (from versions: 0.1.2, 0.1.2.post1, 0.1.2.post2)\r\nERROR: No matching distribution found for torch>=1.1.0 (from flair)\r\n\r\n**To Reproduce**\r\nattempt to use pip to install flair by typing in command line:\r\npip install flair\r\n\r\n**Expected behavior**\r\nAll other files just download, except \"torch\" which fails every time it is attempted.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [Windows 10]:", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1657/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1657/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1651", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1651/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1651/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1651/events", "html_url": "https://github.com/flairNLP/flair/issues/1651", "id": 627653515, "node_id": "MDU6SXNzdWU2Mjc2NTM1MTU=", "number": 1651, "title": "UnboundLocalError: local variable 'token' referenced before assignment", "user": {"login": "nh111", "id": 18840257, "node_id": "MDQ6VXNlcjE4ODQwMjU3", "avatar_url": "https://avatars.githubusercontent.com/u/18840257?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nh111", "html_url": "https://github.com/nh111", "followers_url": "https://api.github.com/users/nh111/followers", "following_url": "https://api.github.com/users/nh111/following{/other_user}", "gists_url": "https://api.github.com/users/nh111/gists{/gist_id}", "starred_url": "https://api.github.com/users/nh111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nh111/subscriptions", "organizations_url": "https://api.github.com/users/nh111/orgs", "repos_url": "https://api.github.com/users/nh111/repos", "events_url": "https://api.github.com/users/nh111/events{/privacy}", "received_events_url": "https://api.github.com/users/nh111/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-05-30T05:00:54Z", "updated_at": "2020-06-10T06:57:25Z", "closed_at": "2020-06-03T06:25:52Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhen I am trying to run the NER for some text, I am getting this error\r\n\r\nBelow is the complete error:\r\n    sentences = [Sentence(sent, use_tokenizer=True) for sent in split_single(AText)]\r\n\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\flair\\data.py\", line 490, in __init__\r\n    [self.add_token(token) for token in tokenizer(text)]\r\n\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\flair\\data.py\", line 1367, in segtok_tokenizer\r\n    previous_token = token\r\n\r\nUnboundLocalError: local variable 'token' referenced before assignment\r\n\r\n\r\n**To Reproduce**\r\n```python\r\nAText = '''\r\nJPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n1\r\n \r\n \r\n \r\n \r\n \r\n \r\n \r\n \r\n \r\nJPMORGAN\r\n \r\n \r\nModerator\r\n:\r\n \r\nPaul Formanko\r\n \r\nMay 13\r\n, 2016\r\n \r\n14\r\n:\r\n00 GMT\r\n \r\n \r\n \r\nOperator\r\n:\r\n \r\nThis is conference # 958739.\r\n \r\n \r\nOperator\r\n:\r\n \r\nWelcome to the OTP Bank First Quarter 2016 Conference Call.  At this time, \r\nall participants are in a listen\r\n-\r\nonly\r\n-\r\nmode.  There will be a \r\npresentation \r\nfollowed by a question\r\n-\r\nand\r\n-\r\nanswer session.\r\n  \r\nAt which time, if you wish to ask \r\na question, you will need to press star and one on your telephone.  \r\n \r\n \r\n \r\nI must advise you that this conference is being recorded today, Friday, May \r\n13, 2016.\r\n \r\n \r\n \r\nI woul\r\nd now like to hand the conference over to your speaker today, Mr. Paul \r\nFormanko.  Please go ahead, sir.\r\n \r\n \r\nPaul Formanko\r\n:\r\n \r\nThank you, operator, and good afternoon all.  Thank you very much for \r\njoining us today.  This is Paul Formanko from JPMorgan and dialing\r\n \r\nin from \r\nBudapest\r\n \r\nw\r\ne have with us today Mr. Laszlo Bencsik, OTP Bank's Chief \r\nFinancial and Strategic Officer.  Laszlo, please, over to you.\r\n \r\n \r\nLaszlo Bencsik\r\n:\r\n \r\nThank you, Paul.  Thank you for the introduction.  Good morning and good \r\nafternoon, depending where\r\n \r\nyou are, and welcome on OTP Group's 2016 first \r\nquarter conference call.  As usual, we have a presentation available on the \r\nwebsite.  So, hopefully, you've been able to access it and download it, and you \r\ncan follow me when I go through at least the most im\r\nportant pages.\r\n \r\n \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n2\r\n \r\n \r\n \r\n \r\nSo, starting on page 2, you can see the quarterly results.  The accounting profit \r\nwas HUF34.3 billion and the adjusted profit, HUF47.6 million.  We booked \r\none item as adjustment, that's the bank tax for this year.  The total annual bank \r\ntax was booked acco\r\nrding to IFRS in the first quarter.  We expect one more \r\nadjustment coming, likely to be in the second half of this year, and that is the \r\none\r\n-\r\noff revenues from the Visa shares sales.  We already communicated that \r\nthe originally expected \r\namount\r\n \r\nwas EUR34.2 m\r\nillion, coming in as an inflow \r\nin the second quarter.  Now, this \r\nhas \r\nchanged slightly.  First of all, the \r\nexpected time of this income has shifted forward somewhere to the second \r\nhalf of this year, and also the cash amount we are expected to receive should\r\n \r\nbe higher.  We don't know exactly how much higher, but the deferred part will \r\nbe less which we did not quantify previously, and the upfront cash amount is \r\ngoing to be higher.  We don't know exactly how much higher.\r\n \r\n \r\n \r\nNext page, the P&L for the Group and b\r\nreaking down different lines.  First of \r\nall, you can see \r\nthe corporate tax\r\n \r\nwas relatively high compared to the pre\r\n-\r\ntax \r\nprofit.  So, we have a higher effective tax rate, mostly coming from Ukraine, \r\nbut also Hungary and Romania was higher.  You already saw l\r\nast year that on \r\na quarterly basis, the effective tax rate fluctuated somewhat, and this is going \r\nto be also this year.  There is no reason\r\n, however\r\n \r\nto expect, on an annual \r\nbasis, different effective rate than roughly 20 percent.  So, these are more or \r\nles\r\ns one\r\n-\r\noffs or kind of expected to reversing items related to deferred tax \r\nassets.\r\n \r\n \r\n \r\nThere were no one\r\n-\r\noff items only one \r\nwith \r\nHUF0.2 billion.  And in the lower \r\nsection of this slide, you see the major P&L lines.  I'm going to talk in detail \r\nabout the vario\r\nus income lines and also about the costs.  Some of those \r\nchange because of seasonality, some of those change because of underlying \r\nbusiness developments, which I'm going to explain later on.  The very kind of \r\nstriking out number is the risk costs.  As you \r\ncan see, the quarterly risk cost \r\nwas HUF20.8 billion.  I think we have not seen these levels of quarterly risk \r\ncosts since 2008.  So, this is a level which is, I believe, somewhat \r\nrepresentative of the current environment and the future environment which \r\nw\r\ne expect in the next couple of years, namely a reasonably relatively low risk \r\nenvironment, at least compared to the previous years.  The risk cost rate in the \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n3\r\n \r\n \r\n \r\nfirst quarter was 1.3 percent on the Group level, which is indeed quite a \r\nnormalized and moderate\r\n \r\nlevel.\r\n \r\n \r\n \r\nNow going forward, o\r\nn page 4, you see this split of\r\n \r\nthe CEE countries and the \r\nRussia and Ukraine.  \r\nD\r\nuring the previous two years, there was a hu\r\nge gap \r\nbetween these two groups:\r\n  \r\nCEE did very well, improved profits and was \r\nincreasing, whereas Russ\r\nia and Ukraine generated large losses, especially \r\nUkraine, and these numbers on the slide do not include \r\nthe \r\none\r\n-\r\noffs \r\nwhich we \r\nbooked in the eastern part of the \r\ncountry\r\n \r\nand Crimea \r\nfor expected \r\nlosses.  So, \r\neven if we add those, that was even bigger\r\n,\r\n \r\nthe loss in 2014 and 2015.  And \r\nthe good news is that the first quarter of this year was positive in Ukraine and \r\nRussia.  This is in line with what we previously expected and communicated \r\nto you and this is why we are going to expect for the remaining par\r\nt of this \r\nyear, both of these countries providing positive results.\r\n \r\n \r\n \r\nOn page 5, you can see further details on the individual performance of the \r\ngroup members, Hungary being up quarter\r\n-\r\non\r\n-\r\nquarter by 4 percent and down \r\nyear\r\n-\r\non\r\n-\r\nyear by 2 percent.  Bulgaria \r\nup quarter\r\n-\r\non\r\n-\r\nquarter almost 30 percent \r\nand down 22 percent, but the first quarter last year was really exceptional \r\nbecause the risk cost was actually positive.  So, there was a write\r\n-\r\nback\r\n. Thus\r\n, \r\nthis huge difference year\r\n-\r\non\r\n-\r\nyear is more explained by \r\nthat\r\n.\r\n  \r\nAnd then we \r\nhave this middle section, the smaller banks in the portfolio which contributed \r\npositively to the Group, each of them.\r\n \r\n \r\n \r\nAnd then in the bottom, you see Russia and Ukraine altogether being positive \r\nand Russia in itself being positive, despite \r\nthe fact that Touch Bank, which is \r\nthis virtual unit which we report as such the online bank which remains \r\nnegative, and actually the expectation related to Touch Bank itself is that it's \r\ngoing to continue to be negative for the remaining part of this year\r\n \r\nbecause we \r\nare still in this mode of building up this business and spending a lot on \r\ncustomer acquisition and having relatively large cost base, at least as long as \r\nwe don't have the sufficient level of business volumes and revenues.\r\n \r\n \r\n \r\nOn page 6, we see a\r\n \r\nfew miscellaneous items.  The first one is the bank tax.  \r\nYou already saw in the first quarter results as compared to last year, there was \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n4\r\n \r\n \r\n \r\na considerable reduction in the bank tax.  Now, this we expect to continue \r\nfrom this year to next year, and on this \r\npage, we try to highlight the main \r\nexpectations.  So, basically the ratio of the bank tax is going to go down from \r\n24 basis points to 21 basis points, and also the base of the calculation moves \r\nahead.  Therefore, the expected bank tax next year is going to\r\n \r\nbe lower by \r\nHUF1.5 billion after tax.  So, instead of the HUF13.3 billion which we \r\nbooked in the first quarter this year, we expect HUF11.8 billion after\r\n-\r\ntax to be \r\nbooked next year, that's a HUF1.5 billion decline.\r\n \r\n \r\n \r\nThere's also one more element which is\r\n \r\nrevealed in the budget for next year, \r\nn\r\namely the elimination or cessation of the previous contribution tax.  This is a \r\ntax which,\r\n \r\nif I remember right, started\r\n \r\nsomew\r\nhere in 2006 and was related to \r\nthe subsidized\r\n \r\nHUF mortgages and this was introduced by the\r\n \r\nsocial\r\nist\r\n \r\ngovernment at this time and we have been paying this extra tax.  But we have \r\nreport\r\ned this tax as part of exp\r\ne\r\nnses\r\n \r\nas general OPEX\r\n.  We have not shown it \r\nas a one\r\n-\r\noff item and has been with us for 10 years now and it's going to phase \r\nout next ye\r\nar.  So, this year, we paid HUF1.7 billion after\r\n-\r\ntax, HUF2.1 billion \r\npre\r\n-\r\ntax, and this is an amount which will not appear next year.  So the impact \r\nwill be HUF1.7 billion after\r\n-\r\ntax positive impact on the bottom line and it's not \r\ngoing to come out of the on\r\ne\r\n-\r\noffs or the adjustments.  It's going to come out \r\nfrom the operational expenses.\r\n \r\n \r\n \r\nNow, the rest \r\nis \r\njust updates on the ongoing \r\nSwiss Fr\r\nank mortgage conversion \r\nprogram in Croatia and in Romania.  We are progressing with these and \r\nexpect to \r\ncomplete\r\n \r\nthem s\r\noon.  There's this extra legislation in Romania \r\nrelated to the walkaway rights of mortgage customers.  We have not seen so \r\nfar any changes in customer \r\nbehavior \r\nrelated to this and therefore, we don't \r\nsee any immediate impact or expected impact on future re\r\nvenues or profits.  \r\nAnd finally, the Visa transaction which I've already talked about.\r\n \r\n \r\n \r\nOn page 7, you see the total income development on a quarterly basis.  \r\nOverall, we declined by HUF5 billion, 3 percent, and here you see the \r\ncomposition of this.  Ther\r\ne was \r\na bigger step\r\n \r\nin Hungary and Bulgaria, and \r\nI'm going to explain it in detail, basically regarding the NII and the fee income \r\nand the other income which components resulted in this.  \r\n \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n5\r\n \r\n \r\n \r\n \r\nNow, this is minus HUF3 billion in Russia, and this is only coming\r\n \r\nfrom the \r\nFX rate.  In ruble terms, revenues increased by 2 percent.  So, the only reason \r\nwe have 10 percent lower revenues in our reporting currency, which is the \r\nHungarian forint, is that the Ruble was very weak, especially the beginning of \r\nthe year.  By\r\n \r\nnow, it's corrected back.  So, we have seen ruble rate \r\nstrengthening and actually they are back to end of last year levels.  So, this is \r\ngoing to be a kind of oppos\r\nite direction\r\n \r\nin the second quarter, if things \r\ncontinue as they are.  So, in HUF terms, in \r\nforint terms, we're going to see \r\nsimilar increase due to the exchange rate dynamics in Russia.\r\n \r\n \r\n \r\nIn Ukraine, there was an intrinsic improvement, both in Hungarian\r\n \r\nforint and \r\nin local currency \r\n-\r\n \r\nlater you will see the details \r\n-\r\n \r\nand also Romania, but this is\r\n \r\ndue to a base effect.  You might remember that last year in the fourth quarter, \r\nthere were HUF1.7 billion equivalent of negative one\r\n-\r\noffs\r\n, which reduced \r\nthe \r\nrevenues of our Romanian bank, and these one\r\n-\r\noffs are out and therefore, we \r\nhave a sizable increas\r\ne of the total revenues in Romania.  But again, this is \r\nrelated to this base impact.\r\n \r\n \r\n \r\nGoing to page 8, where you see details of the net interest income decline on a \r\nquarterly basis, which was HU\r\nF4 billion altogether in HUF of which\r\n \r\nHUF3 \r\nbillion came from Hungary.  Now, out of this HUF3 billion, basically around \r\n40 percent, close to 50 percent, H\r\nUF1.3\r\n-\r\n1.\r\n4 billion is related to the \r\nrevaluation of derivative instruments related to the changes in the yield curve \r\nand basically the re\r\n-\r\npri\r\ncing of the IRS swaps.  So, this was a kind of one\r\n-\r\noff \r\nand there's some correction we have already seen in April and May.  \r\nConsequently\r\n, this is not going to recur in the further quarters.\r\n \r\n \r\n \r\nRussia, again as you can see, in ruble terms actually, we had 6 p\r\nercent growth \r\nin net interest income as opposed to the minus 7 percent decline in HUF.  So, \r\nthis is just related to the FX rate.  And in Ukraine, there was a reasonably \r\nstrong growth, which is partially due to the fact that the intra\r\n-\r\nGroup \r\nsubordinated deb\r\nt\r\n \r\nwas converted into equity.  T\r\nherefore, the cost of funding of \r\nthe Ukrainian entity went lower, whereas at the same time, the corporate \r\ncenter revenues declined in the Group.  So, it's just an intra\r\n-\r\nGroup allocation \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n6\r\n \r\n \r\n \r\neffect, but also there was another thir\r\nd\r\n-\r\nparty sub debt which was repaid.  So, \r\nthat's another element which reduced the cost of funding of the Ukrainian \r\nentity.\r\n \r\n \r\n \r\nNow page 9, last time we had the \r\nconference call\r\n, we had a lengthy discussion \r\nabout the expected net interest marg\r\nin of the Group an\r\nd especially at OTP \r\nBank,\r\n \r\nHungary.  \r\nBoth\r\n \r\non the Group level and in OTP Hungary, we had \r\nexperienced a decline in the first quarter.  Hungary was 343 basis points and \r\non the group level, the first quarter was 484 basis points, which compared to \r\nthe annual \r\n20\r\n15 \r\nNIM for the Group, which was 511 basis points, you already \r\nhad 27 basis points decline.  And \r\nI said that we expect\r\n \r\non an annual basis \r\naround 20 basis points\r\n \r\nNIM decline\r\n.  It's clear that due to the current rate \r\nenvironment expectations in Hungary, this \r\ndecline seems to be higher than 20 \r\nbasis points on an annual basis.\r\n \r\n \r\n \r\nSo, on the Group level, our current best estimate of the annual decline of the \r\nnet interest income is around 25 basis points.  And this might surprise you that \r\nwe don't expect kind of la\r\nrger further decline of the NIM on the Group level, \r\nand the reason is that we expect still a step down in the second quarter.  But \r\nin\r\n \r\nthe second half of this year, we expect improve\r\nment\r\n \r\nprimarily driven by \r\nvolume dynamics, especially in Hungary, and also d\r\nriven by stronger ruble \r\nrate in Russia, which will have some impact already in the second quarter.\r\n \r\n \r\n \r\nIn other markets, Bulgaria, we had a margin decline which will not be so \r\nsevere in the following quarters, but will probably continue.  Russia was \r\nstable \r\nin HUF terms, but again, if you look at the net interest margin in ruble \r\nterms, actually the NIM improved by 180 basis points, and due to the stronger \r\nruble in the second quarter, this is going to translate back to the Group NIM as \r\nwell and hopefully, when\r\n \r\nvolume dynamics turn around in the second half as \r\nusually do in Russia due to seasonality, this might even improve in terms of \r\nthe share of its contribution t\r\no the overall Group NIM.  So\r\n \r\nmuch about the \r\nmargins and the expectations related to the NIM for t\r\nhe whole year as a \r\nguidance.\r\n \r\n \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n7\r\n \r\n \r\n \r\n \r\nNow, talking a bit about the volumes, first of all, the loan to deposit ratio, \r\nthat's another very positive event.  In the first quarter this year, the previous \r\nlong decline of the loan to deposit ratio turned around and the \r\ndecline stopped \r\nand we actually have 1 percentage point growth in the Group level net loan to \r\ndeposit ratio.  And most importantly, Hungary started to grow as well, which \r\nwe are quite happy about.\r\n \r\n \r\n \r\nNow on page 11, you see the reasons for this turnaround o\r\nf the previous trend \r\nof the net loan to deposits ratio, namely the volume developments in Hungary.  \r\nAs you can see, during the first quarter, Hungarian performing volumes \r\nincreased by 2 percent.  There was \r\na \r\n4 percent increase in consumer loans and \r\nthere w\r\nas \r\na \r\n7 percent increase in corporates, including small, large and \r\nmedium\r\n \r\nsize ones\r\n.  And if you only\r\n \r\nlook at the loans to Hungarian companies\r\n, \r\nthen it was 6 percent.  So, the only part which remains to decline is the \r\nmortgage group, but I will later on try\r\n \r\nto explain the very positive \r\ndevelopments of new mortgage demand and new mortgage sales.  And in \r\ngeneral, we are quite positive about expectations related to consumer loan \r\nvolumes in Hungary and to corporate loan volumes, and the new mortgage \r\nproduction a\r\nlso looks very good.\r\n \r\n \r\n \r\nIn Russia, we saw consumer volumes going down in the first quarter.  This is \r\ndue to two factors.  One is the usual seasonality.  Usually, the POS volumes \r\nare seasonally weak in the first quarter in terms of new sales and therefore, w\r\ne \r\nshould see a decline in volumes, but also we have not restarted with large \r\nvolumes credit card sales.  So, this year, we are still conservative a\r\nnd the \r\ncross\r\n-\r\nsales machine has not started \r\nat \r\nfull speed\r\n \r\nyet\r\n.  We are doing it kind of \r\nlow level, being very \r\ncautious and still waiting, but this is a potential business, \r\nso we can restart soon.\r\n \r\n \r\n \r\nAnd then, in Romania and Croatia, you see this quite large decline, especially \r\nmortgages.  This is related to the conversion in both of these countries.  In \r\nRomania and\r\n \r\nin Croatia, we have ongoing programs to convert the Swiss\r\n \r\nFrank\r\n \r\nmortgages into local currencies or euro, and this conversion is coupled \r\nwith discount on principle, and this is the result of these declines on volumes.\r\n \r\n \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n8\r\n \r\n \r\n \r\n \r\nOn page 12, you see the deposit dyna\r\nmics in the first quarter, minus 1 percent.  \r\nThis is what we are quite comfortable with.  Certainly, we don't want to \r\nincrease deposit volumes on the Group level, given level of \r\nexc\r\ness liquidity.  \r\nSo, this is not a strategic priority at the moment.  \r\n \r\n \r\nNow,\r\n \r\ngoing back to the other items of the revenues, namely the net fee and \r\ncommission income, this declined on a quarter\r\n-\r\non\r\n-\r\nquarter basis by 11 percent, \r\nwhich is equivalent to HUF4.4 billion.  Now, this de\r\ncline is usually seasonal.  \r\nEach year\r\n \r\nwe see this diffe\r\nrence and seasonal decline in the first quarter \r\nwhich comes from two sources; one is that usually spending and card usage \r\nactivity is much lower in January than in December and the other one is the \r\ncalendar effect.  \r\n \r\n \r\nT\r\nhis year is a longer year, but Februa\r\nry is a shorter month, plus there is a \r\npeculiar item in Hungary which appears every year in the first quarter and this \r\nis the financial transaction tax related to card transactions, which you have to \r\npay \r\nin \r\na lump sum in the first quarter\r\n; it was around\r\n \r\nHU\r\nF1.6 billion, and so \r\nthis is something which always appears as a negative item in the first quarter.  \r\nIt did last year as well and this year, and therefore again creates the difference \r\nbetween the fourth quarter and the first quarter, and it should actuall\r\ny create a \r\npositive difference in the second quarter as increase should be expected there.  \r\n \r\n \r\nTherefore on this page, \r\nwe\r\n're actually comparing net fee and commission \r\nincome to the first quarter last year.  So instead of quarter\r\n-\r\non\r\n-\r\nquarter, we \r\ncompare year\r\n-\r\non\r\n-\r\nyear numbers, and here you see a quite healthy trend, 4 \r\npercent growth, mostly driven by the Hungarian business, 7 percent which is \r\nactually fundamental\r\n,\r\n \r\nmo\r\nstly related to POS transaction revenues to card \r\nusage, card\r\n-\r\nrelated transaction revenues, which \r\nhave gone up.\r\n \r\n \r\n \r\nAlso when the new loan origination picks up eventually in Hungary and starts \r\nto grow, this should contribute positively further to this number, and to some \r\nextent it's already there.  We have good growth in Bulgaria, 9 percent and then \r\nin \r\nRussia in ruble terms, the growth was 7 percent.  Again, we have this \r\ntranslation FX conversion impact to local currency, which makes this number \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n9\r\n \r\n \r\n \r\nnegative; otherwise it was actually 7 percent positive.  In Ukraine, we have \r\ngrowth.  So this is a revenue lin\r\ne where we see quite positive trends.\r\n \r\n \r\n \r\nOther net non\r\n-\r\ninterest income improved quarter\r\n-\r\non\r\n-\r\nquarter.  In Hungary, it \r\nwas supported by FX gains and gains on other securities.  In Bulgaria, the \r\nnegative is related to this intragroup swap deal, which kind of us\r\nually \r\nintroduces a quarterly fluctuation.  And then Romania, I already referred to \r\nthis line, this HUF1.7 billion improvement, which is entirely related to the \r\nbase effect which appear in the fourth quarter last year due to one\r\n-\r\noff items \r\nwhich we described\r\n \r\non this page.\r\n \r\n \r\n \r\nThe cost dynamics, again usually, there is a seasonality in the first quarter.  \r\nSo, on a quarter\r\n-\r\non\r\n-\r\nquarter comparison, we improved by 13 percent, which is \r\nnominally HUF12.7 billion.  Nevertheless, this is not a very meaningful \r\ncomparison \r\nthere on this slide.  You see the year\r\n-\r\non\r\n-\r\nyear numbers and year\r\n-\r\non\r\n-\r\nyear developments, both in nominal terms and FX adjusted.  So, \r\nnominally, there was 1 percent decline and FX adjusted, there was 1 percent \r\ngrowth, which was partially driven by the Hungaria\r\nn increase.  There was 2 \r\npercent increase in Hungary, which is related to this contribution to different \r\nfunds and authorities.  We've talked about this before and we expect the \r\ncontributions to the deposits and \r\nsecurities\r\n \r\nprotection funds and to the \r\nresol\r\nution fund to increase\r\n \r\nand we book it quarter\r\n-\r\nby\r\n-\r\nquarter gradually.  So, \r\nthis is an increase, which appeared and also other taxes increased and went up \r\nin Hungary.  There was an increase in amortization in Bulgaria and there is \r\nmore of it.\r\n \r\n \r\n \r\nIn Russia, by \r\nthe way even FX adjusted, we've had 15 percent decline year\r\n-\r\non\r\n-\r\nyear.  This is the result of the cost reduction program, the project which we \r\nconcluded last year, which reduced our cost base in Russia considerably, and \r\nthis actually contributes to a large e\r\nxtent to our improvement in the \r\nprofitability of the Russian bank.\r\n \r\n \r\n \r\nPage 16, we are starting to dig deeper into some selected group members' \r\nsituation starting with Hungary.  S\r\no, on page 16, you see the OTP \r\nC\r\nore P&L \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n10\r\n \r\n \r\n \r\nitems.  I've already talked about basic\r\nally each of these \r\nslides\r\n.  So, I'm not \r\ngoing to repeat it.  \r\n \r\n \r\nOn page 17, you see a macro slide, which potentially needs some elaboration.  \r\nThe GDP growth number came out this morning at 9 o'clock.  \r\nT\r\nhat was \r\nactually after we produce\r\nd\r\n \r\nthis slide, so, this\r\n \r\n2.1 percent GDP growth \r\nexpectation might look ambitious given the 0.9 percent year\r\n-\r\non\r\n-\r\nyear first \r\nquarter growth, and I would agree that this is indeed ambitious and it's only \r\nkind of a higher end of the potential spectrum of GDP growth, which we \r\nmight exp\r\nerience this year.  Nevertheless, we expect improvement in the \r\nsecond half of this year.\r\n \r\n \r\n \r\nLet me just elaborate a bit mor\r\ne.  We have two opposing trends \r\nmanifesting \r\nthis year.  One is the decline in the EU transfers and funds to Hungary, which \r\nis quite se\r\nvere compared to last year, which was really a peek and boo and \r\nwhich is much lower than what we expect in 2017 and 2018.  So this is a kind \r\nof cyclical effect of the EU transfers utilization, and this then slides to lower \r\nlevel of investments and CapEx.  \r\nTherefore, you see a lower level of expected \r\ninvestments to GDP.  This has an impact on the construction sector.  There \r\nwas a quite sizable decline actually in the construction sector quarter\r\n-\r\non\r\n-\r\nquarter in the first quarter, and this is due to the \r\ndecline\r\n \r\nof the EU funds.\r\n \r\n \r\n \r\nOn the other part, it's related to export growth.  And as you can see, we expect \r\na moderation in the growth rate of exports, and that's due to the fact that the \r\nEuroz\r\none demand is somewhat lukewarm\r\n \r\npotential\r\nly driven by Chinese \r\ndemand. S\r\no\r\n, with a\r\n \r\nGerman demand in terms of production goods and exports \r\nfrom Hungary\r\n \r\nwas weaker\r\n, and this is effective while the other weak sector in \r\nthe first quarter was the production sector.  So these are the kind of negatives \r\nwithin the positive side.\r\n \r\n \r\n \r\nWe \r\nexpect quite agile growth in household consumption.  It can even be \r\nhigher than this 3.6 percent what we highlighted here given the quite strong \r\nreal wage growth.  We expect 4.\r\n8\r\n \r\npercent real wage growth and all the other \r\npositive incentives, which are give\r\nn to the retail sectors and also the speeding \r\nu\r\np of retail lending.  We see \r\nfirst quarter consumer loans were quite strong \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n11\r\n \r\n \r\n \r\nand \r\nyou see\r\n \r\n4 percent growth in just one quarter.  This somewhat positively \r\nsurprises us as \r\nwell.  So we are just modifying and\r\n \r\nincre\r\nasing our own \r\nexpectations and plans internally regarding how much we should sell, for \r\ninstance, in the consumer loans, but also in mortgages.  So there are very clear \r\nsigns of increasing consumption, which actually translate by the way to higher \r\nconsumer \r\nloan growth than we originally expected.\r\n \r\n \r\n \r\nAnd the other thing is the housing construction and the housing market, which \r\nis really booming.  So actually year\r\n-\r\non\r\n-\r\nyear Budapest was the highest\r\n-\r\ngrowing real estate price city in Europe.  So this has been a qui\r\nte good \r\ninvestment if you \r\nbought\r\n \r\nsomething a year ago in Budapest.  \r\n \r\n \r\nAnd as you can see on this page, the number of new housing construction \r\npermits started to steeply increase and if you annualize the first quarter \r\nnumbers, then we get to 19,000,\r\n \r\nwhich i\r\ns compared to last year figures of\r\n \r\n12,500.  There's a considerable increase.  And actually, we expect an \r\naccelerating trend quarter\r\n-\r\non\r\n-\r\nquarter.  So the annual number is probably going \r\nto be definitely higher than this 19,000.  \r\n \r\n \r\nSo these are the two factor\r\ns; internal consumption growing more than \r\nexpected, household sector growing, new construction growing, whereas on \r\nthe other side, EU funds are less and therefore, construction industry \r\nsomewhat slower or declining plus the EU demand is somewhat less.\r\n \r\n \r\n \r\nThere's another element here, the fiscal spending is increasing and there have \r\nbeen different programs announced and there seem to be definitely sizable \r\nroom in the budget to increase spending, and we expect the government to do \r\nso and this will have impac\r\nt already in the second half of this year, but most \r\nimportantly next year.  So the expectations for next year certainly don't \r\nchange.  We do expect at or above 3 percent growth for 2017 and also for \r\n2018, and growth might be somewhat less than 2 percent th\r\nis year.  So that's \r\nthe overall kind of macro, which might be for you as an insight.\r\n \r\n \r\n \r\nPage 18, you see the activities in different segments in Hungary.  Mortgage \r\napplications continued to grow.  Number of new applications year\r\n-\r\non\r\n-\r\nyear \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n12\r\n \r\n \r\n \r\nincreased by \r\nalmost \r\n70 percent, \r\nactually by \r\n69 percent.\r\n  \r\nOur share is still \r\naround 25 percent.  We target 26.5 percent this year.  \r\nSo, this is a prescribed \r\nstretched \r\ntarget we try to achieve throughout this year as well.  At corporate, \r\nwe are quite strong.  You've seen the numbers, so we grew by 7 percent \r\nperforming and actually 8 percent gross loa\r\nns, which increased our market \r\nshare to 14.5 percent.  We've never seen these levels before, and we are quite \r\nhappy with that.  And this is a strategy to continue to try to g\r\nrow\r\n \r\nin corporate, \r\nwhich seems to be again more active than previously expected.\r\n \r\n \r\n \r\nAn\r\nd these are just few highlights probably during the next session, the next \r\ncon\r\nf\r\n \r\ncall, we will elaborate more on these developments.  We already told last \r\nyear that we started a new program to enhance our services to our customers \r\nin Hungary through digital\r\nization and new digital services and also improve \r\nour internal efficiency on working through digitalization, and these are some \r\nof the new services, which came out already to the market.  \r\n \r\nWe launched just one\r\n-\r\nand\r\n-\r\na\r\n-\r\nhalf months ago a discount program, \r\nfor \r\ncustomers who are OTP clients\r\n \r\nusing bank cards \r\nand \r\neligible to that and we \r\nare recruiting retailers who are quite keen to join us.  We already had Tesco \r\njoining us and MOL, which is the oil company; DM, that's kind of \r\ndrugstore \r\nand white goods chain, and t\r\nhis is about discounts and write\r\n-\r\nbacks.\r\n \r\nAnd \r\nalready, we almost have 1\r\n00\r\n,000 clients registered and using this after \r\none\r\n \r\nmonth.  \r\n \r\nWe have this S\r\nimple application, which again, I think, next time I will give \r\nyou more information on this.  This is very exciti\r\nng and this is growing very \r\nfast.  This is kind of a metro application, through which different services are \r\navailable; for instance, you can buy cinema tickets in almost 100 percent of \r\nthe cinemas, you can buy tickets online by selecting the seat yourself\r\n \r\nand you \r\nactually have the ticket.  You can do parking by just clicking three times, and \r\nit finds your location and you can order cabs and you can order food and buy \r\ntickets to various concerts and all the festivals which are organized in \r\nHungary.  \r\n \r\nThere \r\nis a new online account opening for SMEs, which immensely simplify \r\nand fasten the process.  We have a new payment engine for the utility bills.  \r\nWe have mobile POS application to make card acceptance cheaper for our \r\ncorporate clients, and so on and so on.\r\n \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n13\r\n \r\n \r\n \r\n \r\n \r\nSo, we're quite active in coming out to the market with new innovations in \r\nterms of services and we believe that the next couple of years in Hungary will \r\nbe about actually market development because volume growth started and we \r\nhave already launched a lo\r\nt of new type of services and applications for our \r\ncustomers.  And there's a lot in the pipeline, which will come out during the \r\nnext 1.5 years.  So, we believe that we can further improve our market \r\npositioning in the country.\r\n \r\n \r\n \r\nThe next slide is \r\nBulgaria\r\n, I think I mostly touched up this part.  There was \r\na \r\ndecline in the total income due to the lower\r\n-\r\nmargin environment and lower net \r\ninterest margin.  Risk cost was quite favorable, HUF1.5 billion; the risk cost \r\nrate 0.5 percent.  I think this is the level \r\nwhere we should be or this is a \r\npotential level where we could be in the future, I would rather say that, given \r\nthe risk environment in the country.  And as you can see, we have \r\nimprovement in corporate and SME loans especially both in mortgages and \r\nconsum\r\ner loans, new sales increased.\r\n \r\n \r\n \r\nAnd then a few words about Russia on page 21, Russia started to do well.  It \r\nmakes profits.  Again in HUF terms, it's not so spectacular\r\n, but\r\n \r\nthe ruble just \r\nweakened.  In ruble terms, the improvement is even stronger and a \r\nkey driver \r\nhere is obviously the risk cost.  On page 21 in the lower right corner, you see \r\nthe risk cost rates by the major products we have.  POS is down to 7 percent, \r\nthat's quite good.  This is hopefully the level, which we will see in the future.  \r\n \r\n \r\nCr\r\nedit cards, still high and we hope that this is going to continue to go down.  \r\nBut again in credit cards, we really do\r\nn't have new vintages.  So, we \r\ntechnically\r\n \r\nstopped credit card selling at the beginning of 2015, and we \r\nhaven't really restarted it in a l\r\narger scale.  So, this is all the problems of the \r\nold vintages and the old loans.  And once we restarted this business with the \r\nprevious magnitude, which given the seemingly improving environment in \r\nRussia especially starting from the second part of this y\r\near, it might come \r\nsooner than we originally expected.  Cash loans, I mean, below 10 percent risk \r\ncost rates.  So this is okay.  At this level, this is a reasonably profitable \r\nproduct.\r\n \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n14\r\n \r\n \r\n \r\n \r\n \r\nPage 22, so you see the market dynamics.  POS sales were RUB11 billio\r\nn in \r\nthe first quarter, which is quite a spectacular growth compared to last year, \r\nwhich was RUB8 billion in the first quarter and getting close to the 2014 \r\nnumbers, which were RUB12 billion.  So it seems clear that last year was the \r\nbottom of the cycle an\r\nd this year at least in POS, we can do better.  \r\n \r\n \r\nAlso in this slide, you can see that we haven't really restarted the credit cards.  \r\nThey continue to decline the volumes and the cash loan is somewhat more \r\nactive than last year and very important factor fo\r\nr performance here is on this \r\nslide as well.  That's the cost of deposits, which went up to quite a some extent \r\nlast year and now started to normalize back.  \r\n \r\n \r\nSo now the total cost of deposits is down to 7.9 percent, so below 8 percent, \r\nand this is due to\r\n \r\nthe phasing out of the very expensive term deposits, which \r\nwe had to make last year, and these were typically 12 months or six months\r\n \r\nterm deposits\r\n.  And as they phase out from our books, we expect further \r\nimprovement in the cost of deposits and therefore\r\n \r\nin the margins in Russia.\r\n \r\n \r\n \r\nNow Ukraine, nothing spectacular happened actually, except that there were \r\nno negative one\r\n-\r\noffs.  And if there are no negative one\r\n-\r\noffs in Ukraine, then \r\nUkraine\r\n \r\nis doing reasonably okay and produces positive results as it did last \r\nyear in the second quarter.  If you remember last year's second quarter, \r\nUkraine was positive because tha\r\nt was a quarter where there was\r\n \r\nno FX \r\nde\r\nvaluation, and we didn't provision extra\r\n \r\nfor the old volumes and as long as \r\nthere is no further stronger \r\nde\r\nvaluation of the currency and no major \r\ndisruption on the market or in the prevailing conditions around us.  This is \r\nwhat we expect in Ukraine, a moderate, but growing profit.  And in fact o\r\nur \r\nvulnerability to exchange rate changes has been reduced considerably.  There \r\nis hardly anything left from the previous dollar\r\n-\r\nbased\r\n \r\nmortgage book and our \r\ncorporate lending is mostly in local currency\r\n,\r\n \r\nas well.  So, we are reducing \r\nfast our exp\r\nosure to \r\nFX risk in the country\r\n \r\nstemming from FX assets we have.\r\n \r\n \r\n \r\nPage 25, the summary about the risk indicators.  So the risk cost rate \r\non \r\ngroup \r\nlevel \r\nwas \r\ndown to 131 basis points, very good level.  We're quite happy with \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n15\r\n \r\n \r\n \r\nit whereas the portfolio, the NPL ratios \r\nstayed flat.  Coverage slightly \r\ndeclined, but this is \r\nagain \r\nmostly due to the\r\n \r\nweaker ruble and hryvna rates \r\nin \r\nthe first quarter and therefore \r\nthere\r\n \r\nis smaller contribution of the very high \r\ncoverage level of Ukrainian and Russian non\r\n-\r\nperforming portfolios \r\nfor the \r\noverall coverage level and the group level.\r\n \r\n \r\n \r\nNow, Page 26, you see the portfolio worsening dynamics.  The good thing is \r\nthat Russia was only HUF17 billion.  Usually, the first quarter is worse than \r\nthe other quarters;\r\n \r\n \r\nthat's the usual seasonality\r\n \r\nif nothing else happens because \r\nwe have a high level of new origination in the last quarter and then the high \r\nlevel of defaults in the first quarter, but now it was quite \r\na \r\nmild increase.  We \r\nhad some corporate defaults in Hungary and in Romania.  These w\r\nere the \r\nother two countries where there was material deterioration of the portfolio.\r\n \r\n \r\n \r\nPage 27 shows the risk cost rates by countries.  So, Hungary was down to \r\npretty much zero; Bulgaria 0.5 percent; Russia came down to 10 percent \r\noverall; and Ukraine is d\r\nown to 4.4 percent.  And this is pretty much the entire \r\npresentation in terms of guidance and forward\r\n-\r\nlooking statements.  I've \r\nalready said that we are modifying our guidance related to net interest margin.  \r\nWe expect around 25 basis points decline over t\r\nhe whole year compared to \r\nlast year, as opposed to the original guidance, which was around 20 basis \r\npoints.  And the other guidance we said was related to this return on equity \r\nexpectation for 2017.  And we continue to believe that we are on the right \r\ntrac\r\nk to achieve that given that the without bank tax return on equity during \r\nthe first quarter was 15.5 percent, already this quarter, so this actually makes \r\nus feel confident that we can potentially deliver on this target.\r\n \r\n \r\n \r\nAnd basically that was a formal p\r\nresentation, and I'm more happy to try to \r\nanswer your questions.  So operator, please open the floor for questions.\r\n \r\n \r\nOperator\r\n:\r\n \r\nCertainly.  As a reminder, if you wish to ask a question, please press star and \r\none on your telephone and wait for your name to b\r\ne announced.  If you wish \r\nto cancel your request, please press the hash key. \r\n \r\n \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n16\r\n \r\n \r\n \r\nYour first question comes from Pawel Dziedzic from Goldman Sachs.  Please \r\ngo ahead.\r\n \r\n \r\n \r\nPawel Dziedzic\r\n:\r\n \r\nGood afternoon and thank you for the presentation.  Just few quick question\r\ns \r\nfrom my side.  The first one is on loan growth.  So you stated clearly that \r\nyou're expecting inflection point in mortgage lending in Hungary, but could \r\nyou perhaps comment what sort of growth rates you are thinking about in one, \r\ntwo\r\n-\r\nyear's time?  And als\r\no separately, do you think that the strong growth in \r\ncommercial lending, so both SMEs and corporates this quarter is sustainable?  \r\nWere there any large ticket transaction that can perhaps distort a little bit of \r\ngrowth rates for the last three months?\r\n \r\n \r\n \r\nTh\r\nen I have a question on your operating expenses.  You mentioned that the \r\nperformance in Hungary, Russia and Romania as well were very good.  \r\nShould we look at those as a sustainable run\r\n-\r\nrate going forward or whether \r\nany seasonal effect that could perhaps b\r\ne taken into account?  And also where \r\ndo you see any cost saving potential across the group at this stage?  And I \r\nleave it with that.  Thank you.\r\n \r\n \r\nLaszlo Bencsik\r\n:\r\n \r\nThank you fo\r\nr the questions.  So, mortgages:\r\n \r\nour original expectation for this \r\nyear was still\r\n \r\ndeclining mortgage volumes.  Given the higher\r\n-\r\nthan\r\n-\r\npreviously \r\nexpected demand what we see today in Hungary, it might happen that \r\nsomewhere potentially closer to the end of this year, we might be able to stop \r\nthe decline of the portfolio in mortgages, that\r\n \r\nwould be fantastic.\r\n \r\n \r\n \r\nConsumer\r\n \r\nbook:\r\n \r\nthis 4 percent\r\n \r\nq\r\n-\r\no\r\n-\r\nq\r\n \r\ngrowth\r\n, \r\nwell, \r\nI don't think that we are \r\ngoing to grow each quarter by 4 percent.  This is partially related to the base \r\neffect at the end of the year.  There was a drop in the consumer \r\nloan volumes\r\n \r\nd\r\nue to the fact that the bonuses were paid in December and that was kind of \r\none\r\n-\r\noff decline, but certainly what we see now is well above our expectations \r\nin terms of the potential new sales we can do and therefore, again we don't \r\nexpect quarterly 4 percent \r\ngrowth, but we expect quarterly growth in this \r\nportfolio.\r\n \r\n \r\n \r\nCorporate\r\n \r\nbook:\r\n \r\nyes, there were obviously bigger tickets and these bigger \r\ntickets are always kind of either they come or not, I mean you can't \r\ntake \r\nthem\r\n \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n17\r\n \r\n \r\n \r\ngranted\r\n, but the pipeline is strong\r\n. W\r\ne don\r\n't expect quarterly 7 percent or 8 \r\npercent growth in corporate loans, but we expect further growth in corporate \r\nvolumes in Hungary,\r\n \r\nthat's clear.\r\n \r\n \r\n \r\nN\r\now your question related to OPEX\r\n, each year, we have this s\r\neasonality, \r\nright.  I\r\nf you look back to the last\r\n \r\ncouple of years, you always s\r\nee this \r\nseasonality and the OPEX\r\n \r\nin the first quarter is lower and then\r\n,\r\n \r\nthe subsequent \r\nquarters increased\r\n, whereas\r\n \r\nthe last qua\r\nrter\r\n \r\nis a kind of spike and a higher \r\nnumber.  Therefore, I suggested to compare the first quarter \r\nthis year \r\nrather to \r\nlast\r\n \r\nyear first quarter and the growth was 1 percent\r\n \r\nFX adjusted\r\n. \r\n \r\n \r\nSo, I think this is a number, meaning \r\nthe FX adjusted one\r\n, we have 1 percent \r\noverall growth in \r\nOPEX.\r\n \r\nI \r\nwould \r\nstick\r\n \r\nto \r\nour\r\n \r\nprevious guidance on this when \r\nwe said that we expected similar F\r\nX adjusted growth this year what\r\n \r\nwe had \r\nlast year, so potentiall\r\ny around 2\r\n-\r\n3\r\n \r\npercent\r\n.\r\n \r\n \r\n \r\nCost saving potentials, this is not what we are foc\r\nusing on at the moment.  \r\nThere're\r\n \r\nalways opportunit\r\nies here and there, and \r\neven \r\nwe do have\r\n \r\ncost \r\nreduction initiatives,\r\n \r\ncurrently \r\nthis is not the main target.  We see in Hungary\r\n \r\na reviving environment coupled with\r\n \r\nincreasing demand.  We are very hopeful \r\nthat Russian demand for loans will increase as the Rus\r\nsi\r\nan environment \r\nimproves.  Let me\r\n \r\nremind you that last year we made a huge cost reduction \r\nprogram in Russia.  Certainly, we would be actually quite happy to increase \r\nthe cost base in Russia, if it \r\nis coupled\r\n \r\nwith sizable volume growth.\r\n \r\n \r\n \r\nLikewise, Ukraine\r\n, we did a very drastic cost reduction program in Ukraine.  \r\nThis is not very evident, if you look at the numbers we have here, but given \r\nthe level of inflation during the last three years, which was close to 100 \r\npercent, then actually keeping the levels is\r\n \r\na big achievement in Ukraine.  So \r\nthis is not our main focus.  We do still expect realizing all the cost synergies \r\nfrom the acquisition in Romania, so that's ongoing throughout this year, and \r\nthere will be some late impact from this in terms of improvemen\r\nt, but other \r\nthan that no major changes in terms of cost efficiency improvements expected.  \r\nWe a\r\nre actually kind of switching our mindset\r\n \r\ninto a growth mode, which \r\nmakes us actually much happier than just cutting costs.\r\n \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n18\r\n \r\n \r\n \r\n \r\nPawel Dziedzic\r\n:\r\n \r\nAnd that's very hel\r\npful.  So in other words, we should not look into 1 percent \r\ndecline\r\n, FX adjusted this quarter as a run rate, you would rather stick to 2 \r\npercent, 3\r\n \r\npercent\r\n \r\nincrease \r\ngoing forward as indicated previously?\r\n \r\n \r\nLaszlo Bencsik:\r\n \r\nYes.\r\n \r\n \r\nPawel Dziedzic\r\n:\r\n \r\nThank you.\r\n \r\n \r\nO\r\nperator\r\n:\r\n \r\nThank you.  Your next question comes from the line of \r\nSimon Nellis, \r\nDeutsche Bank.\r\n  \r\nPlease go ahead. \r\n \r\n \r\nSimon Nellis\r\n:\r\n \r\nHi, Mr. Bencsik.  It's actually Citibank, but that's okay.  Yes, my first question \r\nwould be just on the margin outlook in Hungary.\r\n  \r\nI think you did mention that \r\nyou're looking for a bit larger contraction, but could you give us some steer on \r\nwhere the margin in Hungary this year is expected to go and actually also in \r\nBulgaria, there was a pretty steep drop, so maybe a little more on \r\nthose two \r\nmarkets?  And then maybe I can ask my other questions afterwards?\r\n \r\n \r\nLaszlo Bencsik\r\n:\r\n \r\nIn Hungary\r\n \r\nthere was indeed a steep drop.  It went down to 3.43 percent.  And \r\nthe second quarter will be \r\neven \r\nlower, so there we expect further drop and \r\nthen start\r\ning from the second half of this year, we expect the volume growth \r\nto counterbalance the pressure on the margin.  By volume growth, I mean the \r\nasset base remaining the same, but kind of converting our liquid reserves into \r\nloans,\r\n \r\nso basically increasing the\r\n \r\nmargin on the asset side by doing more \r\nle\r\nnding.  T\r\nhe expectation for Hungary is that the second quarter will be \r\nfurther down and the second half of the year should actually show some \r\nimprovement, at least that's the current expectation what we have.  And \r\nif this \r\nhappens then on a yearly basis, we might expect something similar to the first \r\nquarter level.\r\n \r\n \r\nSimon Nellis\r\n:\r\n \r\nFor the full year?\r\n \r\n \r\nLaszlo Bencsik\r\n:\r\n \r\nYes.\r\n \r\n \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n19\r\n \r\n \r\n \r\nSimon Nellis\r\n:\r\n \r\nRight, in Hungary, okay.  And for the group, you're basically guiding for \r\naround 25\r\n \r\nbasis points?\r\n \r\n \r\nLaszlo Bencsik\r\n:\r\n \r\nYes.\r\n \r\n \r\nSimon Nellis:\r\n \r\nOkay.\r\n \r\n \r\nLaszlo Bencsik\r\n:\r\n \r\nOverall, year\r\n-\r\non\r\n-\r\nyear decline.  So, that's not compared to first quarter.  That's \r\ncompared to last year.\r\n \r\n \r\nSimon Nellis:\r\n \r\nRight.  And can you give us a little color on the yield on \r\nthe existing \r\nmortgages, kind of the back book and what the yield is on the new production \r\nthat you're doing?  And maybe also give us some color on the yields in \r\nHungary on corporate\r\n,\r\n \r\nconsumer and mortgages?  I'm trying to figure out as \r\nthe expected growth \r\nin mortgage, what's that actually going to do\r\n \r\nto your \r\nmargin and likewise, i\r\ns fast growth that you are seeing in corporate that really \r\nhelp or is that much lower margin business than what you have historically \r\ndone?\r\n \r\n \r\nLaszlo Bencsik\r\n:\r\n \r\nYou \r\ndon't seem to belie\r\nve me, right?\r\n  \r\nI just told you \r\n--\r\n \r\n \r\nSimon Nellis:\r\n \r\nKicking with higher, right, so to speak.\r\n \r\n \r\nLaszlo Bencsik\r\n:\r\n \r\nThe yield of the new production in mortgages is very similar to the yield on \r\nthe converted mortgages, right.\r\n \r\n \r\nSimon Nellis:\r\n \r\nOkay.  And what's that \r\nexactly?\r\n \r\n \r\n \r\nLaszlo Bencsik\r\n:\r\n \r\nAround 4.5 percent, and this is the spread actually.  So, this is not the yield.  \r\nThis is the spread.  And then it's certainly lower than the very old subsidized \r\nHUF mortgages, which have been declining for the last 10 years now.\r\n  \r\nSo, this \r\nis something which is not a new development.  \r\nAs for t\r\nhe corporate spreads, \r\nlarge corporate spreads are around 2 percent.  SME spreads, well, they \r\nac\r\ntually \r\nshould increase because for the last two years, we mostly sold loans \r\nunder this lending f\r\nor growth program where the spread was capped at 2.5 \r\npercent.  \r\n \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n20\r\n \r\n \r\n \r\n \r\nNow, this is phasing out.  It's existing, but the new volumes are quite small.  \r\nSo, the actual market rates are somewhat higher than 2.5 percent spread.  So, \r\nthe micro, small, medium spreads \r\nof new production actually increased \r\ncompared to what we saw during the last two years, and large corporates \r\nbetween 1 percent to 2 percent spread.\r\n \r\n \r\nSimon Nellis\r\n:\r\n \r\nRight.  And on the consumer side, just finish it off.\r\n \r\n \r\nLaszlo Bencsik\r\n:\r\n \r\nConsumer is really jui\r\ncy.  So, that's a very good business.\r\n \r\n \r\nSimon Nellis\r\n:\r\n \r\nOkay.  And then maybe one last question just on Touch Bank.  You \r\nmentioned in the past that you were thinking of rolling it out elsewhere.  Is \r\nthat happening or what's the \r\n\r\n \r\n \r\nLaszlo Bencsik\r\n:\r\n \r\nNo, not yet.\r\n  \r\nFirst, we want to see this to succeed, right.\r\n \r\n \r\nSimon Nellis\r\n:\r\n \r\nRight.\r\n \r\nThanks so much.\r\n \r\n \r\nLaszlo Bencsik\r\n:\r\n \r\nThank you.\r\n \r\n \r\nOperator\r\n:\r\n \r\nThank you.  Your next question comes from the line of \r\nGabor Kemeny, \r\nAutonomous Research\r\n.  Please go ahead. \r\n \r\n \r\nGabor Kemeny\r\n:\r\n \r\nThank yo\r\nu.  \r\nM\r\ny first question on Romania, I think you mentioned that 20 \r\npercent of your clients decided not to participate in this FX conversion \r\nscheme.  I recall you assumed more like 100 percent participation when you \r\nset aside the provisions for this scheme.  S\r\no, do you have some room for \r\nprovision write\r\n-\r\nbacks here.  And secondly, maybe if you can follow up on the \r\nprofitability of the overall Hungarian business, how would you expect the \r\noverall profitability of OTP Core to evolve from here?  I mean, your \r\nprovisi\r\noning was not too far from zero in the first quarter.  I guess, you \r\nmentioned that loan growth could accelerate somewhat in the second half.  \r\nYou are not really targeting \r\ncost\r\n \r\ngrowth.  If we put these together, it could be \r\nhelpful if you could give us a se\r\nnse how the overall profitability of this \r\nbusiness could develop.\r\n \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n21\r\n \r\n \r\n \r\n \r\nLaszlo Bencsik\r\n:\r\n \r\nSo, regarding Romania, yes, when you do these voluntary programs, there is \r\nalways a certain share of customers who don't want to do it.  Now, there can \r\nbe two reasons why th\r\ney don't \r\nparticipate\r\n.  One is that they don't want to do it \r\nbecause they go to court and they try to have a larger discount by going \r\nthrough at least a legal process.  And then, you have another type of \r\ncustomers, \r\nwho don't care\r\n \r\neither because they don't c\r\nare or because the \r\nvolume of the loan is so small that it's not worth \r\ngoing \r\nto the branch and do \r\nthe paperworks.  \r\n \r\n \r\nNow obviously for those clients who proceed with the legal \r\naction\r\n, we do \r\nh\r\nave to have the provision there. T\r\nhe very reason we did this progr\r\nam was \r\nthat \r\nthere had been a very considerable threat that a very large proportion of \r\nour clients actually go through the legal process and we might lose actually \r\nmuch more than the discount we gave to these customers, right.\r\n \r\n \r\n \r\nSo I believe it's quite reas\r\nonable to keep the provisions for those clients who \r\ndecide to pursue legal actions against the bank.  And for those customers who \r\njust don't do anything, yes, we will release provisions probably, but we don't \r\nknow it yet.  So this is not going to happen in\r\n \r\nthe second quarter.  Maybe b\r\ny \r\nthe end of the third quarter \r\nwe are going to have a clear picture\r\n. W\r\nhen the \r\nprogram is over we will see exactly which clients are going to proceed with \r\nlegal actions, right.  So not in the second quarter and not in the third \r\nquarter, \r\nbut probably at the end of the third quarter, we might be in a position to \r\nreassess the situation.\r\n \r\n \r\n \r\nCore profitability \r\nI already said \r\nwhat we expected for the margin.  Volume \r\ngrowth should happen this year.  It already happened during the first q\r\nuarter \r\nand seeing the market demand, it should continue during the course of this \r\nyear.  It's going to be still low\r\n-\r\nsingle\r\n-\r\ndigits, lower than 5 \r\npercent overall \r\ngrowth\r\n \r\nin the volumes in Hungary, but it might be actually higher, so the \r\nsecond half might be h\r\nigher.  I really don't know because we were positively \r\nsurprised actually by the first quarter, especially the consumer loan \r\ndevelopments and the current demand for consumer loans, that clearly \r\nexceeded our previous expectations.  So\r\n,\r\n \r\nI don't know actually\r\n.  I\r\nt might \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n22\r\n \r\n \r\n \r\ncontinue to surprise \r\nus \r\npositively, bec\r\nause there's a strong real wage\r\n \r\ngrowth \r\nand the mood is relatively good.  Real estate price is going up and so on and \r\nso on.  So this might increase spending.\r\n \r\n \r\n \r\nRisk cost, I've said it before, as I expect s\r\ntructurally lower level of risk costs \r\nnot just for this year, but for the next period in Hungary, which might be next \r\ntwo or three years, even more.  It may not be zero, but it should certainly be \r\nlow \r\nand\r\n \r\nI don't see any reason why it should be high number\r\n.  \r\nT\r\nhe cost \r\nbase, \r\nwe have already touched upon\r\n, so these are more or less the \r\nmoving \r\nparts.  \r\nAs \r\nI said \r\nwe\r\n \r\nexpect further decrease in the margin in the second quarter.  So \r\nrevenues might decrease in sec\r\nond quarter and then hopefully \r\nand hopefully \r\nthe revenue trend bottoms out \r\nin the \r\nsecond quarter this year; that would be\r\n \r\nour\r\n \r\nkind of optimistic expectation.  And then, we should see revenue growth \r\ndriven by volume growth, despite the lower interest rate environment.\r\n \r\n \r\nGabor Kemeny\r\n:\r\n \r\nThat\r\n's very clear and I guess\r\n \r\nthat the risk environment is very benign and you \r\nhave a high NPL coverage.  Can you give us any sense where maybe a range \r\nwhere this \r\n--\r\n \r\nwhere would you see your provisioning in the, let's say, two \r\nyears?  I mean, in the domestic b\r\nusiness?\r\n \r\n \r\nLaszlo Bencsik\r\n:\r\n \r\nSure.  I don't see why \r\nthe risk cost rate\r\n \r\nshould be higher than 50 basis points.  \r\nSo, it's somewhere between zero and 50 basis points.  We will see.  The other \r\nquestion is, how much we can recover?  Because seeing the strong \r\ndevel\r\nopment in the real estate market, we're certain \r\nabout positive \r\ndevelopments. F\r\nor many years, there was a moratorium on foreclosure, right?  \r\nSo, it was \r\nfairly\r\n \r\ndifficult to work out the non\r\n-\r\nperforming mortgage portfolio \r\nand the market was also quite sluggish\r\n.  Now, this has changed a lot, and now \r\nwe have a very dynamic real estate market where prices are going up and \r\nthere are no further restrictions on foreclosures \r\nor\r\n \r\ndoing proper work out in \r\nthis area.\r\n \r\n \r\n \r\nSo again, this can be a rather positive surprise if we manage to have higher \r\nrecoveries on the mortgage portfolio than the original provision.  And if that \r\nhappens, then we might be able to actually write back provisions and risk \r\ncosts can even be positive\r\n.  But what I can say officially about the level of \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n23\r\n \r\n \r\n \r\nprovisions is that it's adequate and proper and in line with our expectations to \r\neventual credit losses.  But \r\nthere \r\ncan be a positive surprise seeing the \r\ndevelopments in the environment.\r\n \r\n \r\nGabor Kemeny\r\n:\r\n \r\nAn\r\nd when you say up to 50 basis points, you don't assume any substantial \r\nwrite backs there?\r\n \r\n \r\nLaszlo Bencsik\r\n:\r\n \r\nCertainly, no.  If you look at the portfolio, it's not deteriorating, technically.  \r\nAnd then there are possible write\r\n-\r\nbacks.  On the other hand, we f\r\nind it prudent \r\nto have some levels of provisioning.  And there's IFRS 9 coming in 2018.  So, \r\nthere can be other factors.  But, I think, what I can say for certain, I expect a \r\nlower risk environment in Hungary and\r\n \r\nI don't see any reason why it sh\r\nould \r\nchange\r\n \r\nfor the next two years or three years.  Elections come in 2018.  So, \r\nnext year will be quite strong in terms of GDP \r\nas well as 2018\r\n.  So, we are \r\ngoing to see, I believe, two very dynamic and prosperous years in the country \r\nin which case, risk costs should\r\n \r\nbe quite low.\r\n \r\n \r\nGabor Kemeny\r\n:\r\n \r\nI have one final question.  I think you accrued about HUF13 billion for \r\ndividend payment in the first quarter.  Could this be any kind of indication of \r\nhow management thinks about the dividend payout next year?\r\n \r\n \r\nLaszlo Bencsik\r\n:\r\n \r\nYes.  If you multiply it by four, then you roughly get to the number which is \r\nour initial thinking about the potential levels of dividends.  But obviously, this \r\nis not final.  This is just an indication, but I think a good indication.\r\n \r\n \r\nGabor Kemeny\r\n:\r\n \r\nOkay\r\n.  Thanks very much.\r\n \r\n \r\nOperator\r\n:\r\n \r\nYour next question comes from the line of \r\nAlan Webborn, Societe Generale.\r\n  \r\nPlease go ahead. \r\n \r\n \r\nAlan Webborn\r\n:\r\n \r\nThanks for the call.  \r\nCould you put a little bit of color on where the sort of \r\ncorporate lending demand is coming fr\r\nom?  Is it more private, large \r\ncorporates?  Is it investment loans?  Is it states?  Just to give an idea as to \r\nwhere that's coming from.\r\n \r\n \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n24\r\n \r\n \r\n \r\n \r\nAnd you started the call by telling us that you're revising down your GDP \r\nbecause of this sort of maybe EU investment\r\n \r\nhiatus, and I just wondered, \r\nshould we be a little concerned that's being a sort of rush and there could be a \r\nlittle more caution as if \r\n--\r\n \r\nat least in the short term, the economy is weakening.  \r\nSo, that would be really helpful to understand what the corpo\r\nrate lending \r\ndynamics are looking like, in Hungary in particular.\r\n \r\n \r\n \r\nAnd secondly, perhaps a little bit of a view in terms of how the competitive \r\nenvironment is developing.  You paint a quite positive picture of the dynamics \r\nof the banking economy and you t\r\nalk about juicy consumer margins.  Then, \r\ncapital tends to move to where juicy margins are.  Do you feel there is more \r\ncompetition coming in in unsecured retail or anywhere else in your major \r\nmarkets, particularly again in Hungary?  That would be interestin\r\ng to hear \r\nyour view on that.\r\n \r\n \r\n \r\nAnd I guess finally, where are you sort of from an investment perspective in \r\nyour digitalization process?  The sort of back\r\n-\r\nend and front\r\n-\r\nend \r\n--\r\n \r\nyou put a \r\nlot of impressive applications on your slide, but I wonder where the G\r\nroup is \r\nin terms of where it want it to be and when it gets to a point where that \r\ninvestment can start paying dividends in terms of cost efficiencies?  Again, \r\nyour view on where you are in that process would be helpful.\r\n \r\n \r\nLaszlo Bencsik\r\n:\r\n \r\nRelated to corporat\r\ne:\r\n \r\nthe micro and small growth was 2 percent in the first \r\nquarter.  So, that's just the very plain vanilla lending to micro and small \r\ncorporates, and there is no one\r\n-\r\noff there.  And so this is what we expect to \r\ncontinue pretty much, and as a quarterly growt\r\nh, 2 percent, this is already very \r\nstrong.  There were some large corporate deals.  There was one big \r\ncommercial factoring deal, for instance.  This is one of the \r\nparticular \r\nbusiness \r\nlines\r\n \r\nwhich we are trying to develop\r\n \r\nstrategically\r\n, I mean the\r\n \r\ncommercial\r\n \r\nfactoring.  So, it was a mix.\r\n \r\n \r\n \r\nThe\r\n \r\nkind of underlying growth was roughly 2 percent, and then it went up to 7 \r\npercent by some bigger tickets, but these bigger tickets, they don't come every \r\nquarter.  Therefore, I said that it's obvious that we are not goi\r\nng to grow by 7 \r\npercent, 8 percent quarterly because then the annual growth rate would be,\r\n \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n25\r\n \r\n \r\n \r\nwell, I don't know\r\n.  So, this is not going to happen, clearly.  But a good 6 \r\npercent to 8 percent, overall 10 percent growth in corporate, that should be \r\npossible.  \r\n \r\n \r\nNow, the \r\ncorporate lending dynamics\r\n, around 6 percent to 8 percent growth in \r\nmicro, small, which is the kind of less volatile part, and then on top of that, it \r\ncan be pretty much around 10 percent, anything plus/minus, depending on the \r\nother corporate \r\nand kind of large corporate growth.  It can be actually double\r\n-\r\ndigit growth for the full year.\r\n \r\n \r\n \r\nA\r\ngain, the bigger tickets in the first quarter were partially commercial, \r\npartially related to kind of state enterprise funding.  This is as well\r\n, \r\na \r\ndeveloping\r\n \r\narea because quite a number of utilities, energy companies and so \r\non now belong to the state sector.  So, really big ticket investments and \r\ndevelopments are expected on that front.  By the way, a huge share of the \r\nfunding of the corporate sector is done c\r\nross\r\n-\r\nborder.  So, the structure of the \r\nlarge corporate lending in Hungary is such that a large share of corporate \r\nlending is not done through the Hungarian banking sector, but \r\nrather through\r\n \r\ngroup funding from the parent companies somewhere in Europe, typi\r\ncally.  \r\n \r\n \r\nAnd this is not going to be channeled through the Hungarian banking sector, \r\nthat's clear.  It will remain as cross\r\n-\r\nborder lines.  So, the kind of larger ticket \r\ngrowth potential is in the state\r\n-\r\nowned sector, which actually increased a lot \r\nduring t\r\nhe last couple of years.  I don't know how much you follow the \r\nprocess, but they basically re\r\n-\r\nprivatize\r\nd\r\n \r\nthe utility sector mostly, and there are \r\nlarge investment plans.\r\n \r\n \r\n \r\nBy the way, the fiscal room is huge for state development.  If you look at the \r\nbudget, it looks phenomenal, and certainly the next few years will provide \r\nopportunity to more spending and still \r\nkeeping fiscal deficit\r\n \r\nbelow 2.5 \r\npercent\r\n.\r\n \r\n \r\n \r\n \r\nNow, \r\non \r\ncompetitiv\r\ne dynamics, I would describe the environment as healthy \r\nin terms of competition.  Everyone is trying to grow and compete, but we \r\ndon't see crazy behavior, neither in pricing nor in risk taking.  How long it's \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n26\r\n \r\n \r\n \r\ngoing to last?  I do not know.  Certainly, we h\r\nave two type of players in \r\nHungary.  Some of them have already kind of doing okay returns or coming \r\nback to okay levels of profitability.  And then, we have some which are still \r\nnot doing very well.  Part of them are state\r\n-\r\nowned like MKB, part of them are \r\nnot state\r\n-\r\nowned, but there is clearly a big appetite for profits and returns as \r\nopposed to market share, I would say.  And given the losses during the last \r\ncouple of years, I think now certainly\r\n \r\nthere is\r\n \r\na \r\nstrong \r\ndesire to recover at \r\nleast part of those lo\r\nsses for our competitors.  This makes us somewhat \r\nhopeful that no one will start a crazy price competition or something like that, \r\nand I certainly don't expect new players, at least short\r\n-\r\nterm, to come to the \r\nmarket.  But this is obviously hard for us to j\r\nudge how the competitive \r\ndynamics is going to evolve in the future.\r\n \r\n \r\n \r\nDigitalization, again I think next time, I'll elaborate more on this topic because \r\nthis is something we are very excited about and devoting a lot of effort, \r\nenergy and money to develop v\r\narious digital services and to actually make an \r\ninternal digital transformation as well because we are working on two fronts.  \r\nObviously, one is the external part, the services we provide to our customers, \r\nand the other front is the internal processes, how\r\n \r\nwe manage and conduct \r\nbusiness internally.  And on both fronts, there are a number of initiatives.  We \r\nhave more than 100 different individual projects under this umbrella only in \r\nHungary, and some of the results are already out in the market, so you see \r\nthat.  \r\n \r\n \r\nAnd I think, I will try to be more specific on this and prepare a few slides \r\nabout this for the next presentation.  But clearly, this is something where we \r\nfocus, and we have a program which we laid down in the beginning of last \r\nyear and we are ex\r\necuting it.  So, we know where we're growing and we \r\nbelieve that this is going to elevate our service level to a different platform \r\nand our target is clearly to continue to stay ahead of the competition in \r\nHungary.\r\n \r\n \r\nAlan Webborn\r\n:\r\n \r\nOkay.  That was very inter\r\nesting.  Thank you very much. \r\n \r\n \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n27\r\n \r\n \r\n \r\nOperator\r\n:\r\n \r\nThank you.  Your next question comes from the line of \r\nStefan Maxian, RCB.\r\n  \r\nPlease go ahead. \r\n \r\n \r\nStefan Maxian\r\n:\r\n \r\nThank you.  Good afternoon.  \r\nJust a few questions from my side.  First, you \r\ntalked about this stronger co\r\nrporate loans in Hungary, and with regard to the \r\nlarger tickets as well.  Why has been the fee line actually \r\n--\r\n \r\nthe corporate fee \r\nline in Hungary a bit weaker, if you look at the year\r\n-\r\non\r\n-\r\nyear development?  \r\nHas there been a special reason for that?\r\n \r\n \r\n \r\nThe se\r\ncond on AXA actually, can you give us more clarity when you expect \r\nclosing of this?  And if there would be some \r\n--\r\n \r\nmaybe give a little bit of \r\nguidance, if there are some special costs related to that, or if we might even \r\nsee a positive consolidation effect\r\n \r\nas you brought that portfolio quite cheaply.\r\n \r\n \r\n \r\nAnd then just for clarification on the Visa Europe transaction, what is \r\n--\r\n \r\nagain, \r\nI don't know if I got it right, what's the amount that you will book in the P&L \r\nlater this year and how much of that has been \r\nalready accounted for in equity \r\nlast year via revaluation gains?\r\n \r\n \r\nLaszlo Bencsik\r\n:\r\n \r\nSo, corporate fee, I see this number on page 13 of the interim report.  I have to \r\ncheck.  I mean, there is no obvious answer I can give you at the moment.  I \r\nhave to check th\r\nis.  I think, there is some one\r\n-\r\noff or irregular item behind this \r\nbecause there is no obvious reason.  We are going to check it and come back \r\nto this, okay?\r\n \r\n \r\nStefan Maxian\r\n:\r\n \r\nOkay.\r\n \r\n \r\nLaszlo Bencsik\r\n:\r\n \r\nRegarding AXA, we are going to conclude the transaction by \r\nthe end of this \r\nyear.  And what we have said was that we expect the volumes will increased \r\nby 20 percent, the mortgage volumes.  Obviously, there are some repayments \r\nby that time\r\n, so\r\n \r\nthe performing volumes are a bit lower.  \r\nConsequently,\r\n \r\nit's \r\nsomewhat less\r\n \r\nthan 20 percent.  And what we expect is an increase from then \r\non in the revenues.  \r\nH\r\nonestly, we haven't communicated the structure, how \r\nthis is set up and how exactly the pricing is done.  So, if you excuse me, I'm \r\nnot going to elaborate on this.  But onc\r\ne we close the transaction, it's going to \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n28\r\n \r\n \r\n \r\nbe more or less obvious with what discount and what pricing parameters we \r\nacquired that portfolio.\r\n \r\n \r\n \r\nVisa Europe, the P&L \r\nimpact\r\n \r\nis going to come somewhere during the second \r\nhalf of \r\nthis\r\n \r\nyear.  It appeared in the c\r\nomprehensive income during the fourth \r\nquarter\r\n \r\nlast year\r\n, so it's part of the equity.  And the amount is this, what we \r\nsaid, \r\nEUR\r\n34.2 million.  This is wh\r\nat\r\n \r\nwe booked into the equity and it will \r\nappear in the P&L somewhere during the second half of this year\r\n.  This was \r\nthe initial amount which we were told we would get as an initial cash payment \r\nand this is the amount which is going to increase because it's structured in a \r\nway that there's an initial payment and then there is an earn\r\n-\r\nout component.  \r\nAnd the e\r\narn\r\n-\r\nout component is going to be less and the initial payments will \r\nbe more, but we don't know yet how much more and much less.  So, it should \r\nbe more than EUR34.2 million, but we don't know how much more.  It's \r\nalready in the equity\r\n \r\nsince\r\n \r\nthe fourth quart\r\ner last year and it's going to come \r\nthrough the P&L somewhere \r\nin the \r\nsecond half of this year.\r\n \r\n \r\nStefan Maxian\r\n:\r\n \r\nAnd maybe one final clarification, you talked about this sp\r\necial tax that is \r\nbooked in OPEX\r\n \r\nand that should disappear from next year on, right?\r\n \r\n \r\nLaszlo Bencsik\r\n:\r\n \r\nYes.\r\n \r\n \r\nStefan Maxian\r\n:\r\n \r\nSo, that w\r\nill be HUF1.7 billion lower OPEX\r\n \r\nfrom the special tax?\r\n \r\n \r\nLaszlo Bencsik\r\n:\r\n \r\nNo, that's actually the after\r\n-\r\ntax impact.  So, there w\r\nill be HUF2.1 billion lower \r\nOPEX\r\n, and the bottom line after\r\n-\r\ntax impact will be HUF1\r\n.7 billion.\r\n \r\n \r\nStefan Maxian\r\n:\r\n \r\nAll right.  Thank you.\r\n \r\n \r\nLaszlo Bencsik\r\n:\r\n \r\nThank you.\r\n \r\n \r\nOperator\r\n:\r\n \r\nThank you.  There are no further questions at this time, please continue.\r\n \r\n \r\nLaszlo Bencsik\r\n:\r\n \r\nOkay.  Well, thank you very much.  Thank you for joining us today.  Thank \r\ny\r\nou for your interest.  I wish you all the best, and I hope you'll join us during \r\nthe second quarter conference call, which will be on \r\n12 \r\nAugust.  I wish you all \r\n JPMORGAN\r\n \r\nModerator: \r\nPaul Formanko\r\n \r\n05\r\n-\r\n13\r\n-\r\n16/14:00 GMT\r\n \r\nConfirmation # \r\n958739\r\n \r\nPage \r\n29\r\n \r\n \r\n \r\nthe best and a good vacation if you go for the summer, and thank you again \r\nfor joining us.  Bye\r\n-\r\nbye.\r\n \r\n \r\nOperator\r\n:\r\n \r\nAnd that concludes our conference for today.  Thank you all for participating.  \r\nYou may all disconnect.\r\n \r\n \r\n \r\n \r\n \r\nEND\r\n'''\r\nsentences = [Sentence(sent, use_tokenizer=True) for sent in split_single(AText)]\r\n\r\n```\r\nat above line I am getting Error, let me know if you need complete Code\r\n\r\n**Expected behavior**\r\nIt should run and give Entities\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [Windows]:\r\n - Version [flair - 0.5]:\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1651/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1651/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1644", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1644/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1644/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1644/events", "html_url": "https://github.com/flairNLP/flair/issues/1644", "id": 626466332, "node_id": "MDU6SXNzdWU2MjY0NjYzMzI=", "number": 1644, "title": "ClassificationCorpus not using all data provided", "user": {"login": "NielsRogge", "id": 48327001, "node_id": "MDQ6VXNlcjQ4MzI3MDAx", "avatar_url": "https://avatars.githubusercontent.com/u/48327001?v=4", "gravatar_id": "", "url": "https://api.github.com/users/NielsRogge", "html_url": "https://github.com/NielsRogge", "followers_url": "https://api.github.com/users/NielsRogge/followers", "following_url": "https://api.github.com/users/NielsRogge/following{/other_user}", "gists_url": "https://api.github.com/users/NielsRogge/gists{/gist_id}", "starred_url": "https://api.github.com/users/NielsRogge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/NielsRogge/subscriptions", "organizations_url": "https://api.github.com/users/NielsRogge/orgs", "repos_url": "https://api.github.com/users/NielsRogge/repos", "events_url": "https://api.github.com/users/NielsRogge/events{/privacy}", "received_events_url": "https://api.github.com/users/NielsRogge/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-05-28T12:23:18Z", "updated_at": "2020-06-03T06:59:27Z", "closed_at": "2020-06-03T06:59:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nClassificationCorpus is not using all the data provided in 3 txt files (train.txt, dev.txt and test.txt). I suspect this to be an encoding issue, however Pandas is able to read in all the data with the same encoding type (utf-16) provided as parameter. \r\n\r\n**To Reproduce**\r\nThis [colab notebook](https://colab.research.google.com/drive/14tnyFZhnQHppb8fim8ZLgEwT5hLZx2TB).\r\n\r\n**Expected behavior**\r\nI expect the ClassificationCorpus object to use all data provided. The weird thing is, when I read the txt data as Pandas dataframes, all data is read. But when I read the txt data as ClassificationCorpus objects, some data is not used, as can be seen by the difference in total length (see notebook). \r\n\r\n**Environment (please complete the following information):**\r\n - Google Colab\r\n - Flair: installed from source", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1644/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1644/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1643", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1643/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1643/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1643/events", "html_url": "https://github.com/flairNLP/flair/issues/1643", "id": 626187455, "node_id": "MDU6SXNzdWU2MjYxODc0NTU=", "number": 1643, "title": "Getting file not found error while using bytepair embedding", "user": {"login": "Michael95-m", "id": 64765786, "node_id": "MDQ6VXNlcjY0NzY1Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/64765786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Michael95-m", "html_url": "https://github.com/Michael95-m", "followers_url": "https://api.github.com/users/Michael95-m/followers", "following_url": "https://api.github.com/users/Michael95-m/following{/other_user}", "gists_url": "https://api.github.com/users/Michael95-m/gists{/gist_id}", "starred_url": "https://api.github.com/users/Michael95-m/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Michael95-m/subscriptions", "organizations_url": "https://api.github.com/users/Michael95-m/orgs", "repos_url": "https://api.github.com/users/Michael95-m/repos", "events_url": "https://api.github.com/users/Michael95-m/events{/privacy}", "received_events_url": "https://api.github.com/users/Michael95-m/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-05-28T03:36:24Z", "updated_at": "2020-08-12T14:06:06Z", "closed_at": "2020-08-12T14:06:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n@alanakbik , I got FileNotFoundError when I predicted with the model with character and  bytepair embedding. What I did was that I trained on a gpu and predicted on local cpu. Then it is showing file not found error with the gpu path. \r\n\r\n**To Reproduce**\r\n```\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import ColumnCorpus\r\nfrom flair.embeddings import TokenEmbeddings, StackedEmbeddings, BertEmbeddings, CharacterEmbeddings, BytePairEmbeddings, WordEmbeddings\r\nfrom flair.visual.training_curves import Plotter\r\nfrom flair.models import SequenceTagger\r\nfrom flair.trainers import ModelTrainer\r\nfrom typing import List\r\nfrom torch.optim.adam import Adam\r\nimport sys\r\nimport flair, torch \r\n\r\nflair.device = torch.device('cuda:0')\r\n\r\ncolumns = {0: 'text', 1: 'ner'}\r\ndata_folder =  './data/Model_Trainer_Data'\r\ncorpus: Corpus = ColumnCorpus(data_folder, columns,train_file= sys.argv[1] , dev_file=sys.argv[3], test_file= sys.argv[4], in_memory=False)\r\n\r\ntag_type = 'ner'\r\ntag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\n# bert_embedding = BertEmbeddings('bert-base-multilingual-cased')\r\n\r\nembedding_types: List[TokenEmbeddings] = [\r\n    CharacterEmbeddings(),\r\n    BytePairEmbeddings('my', 300),\r\n    # bert_embedding\r\n    ]\r\n\r\nembeddings: StackedEmbeddings = StackedEmbeddings(embeddings=embedding_types)\r\n\r\ntagger: SequenceTagger = SequenceTagger(hidden_size=256,\r\n                                        embeddings=embeddings,\r\n                                        tag_dictionary=tag_dictionary,\r\n                                        tag_type=tag_type,\r\n                                        rnn_layers = 1,\r\n                                        use_crf=True)\r\n\r\n# trainer: ModelTrainer = ModelTrainer(tagger, corpus, optimizer=Adam)\r\ntrainer: ModelTrainer = ModelTrainer(tagger, corpus)\r\n\r\ntrainer.train('./results/'+ sys.argv[2],\r\n              learning_rate=0.1,\r\n              embeddings_storage_mode = 'gpu',\r\n              mini_batch_size=64,\r\n              patience=5,\r\n              max_epochs=150,\r\n              train_with_dev=False,\r\n              checkpoint=True)\r\n\r\n# from pathlib import Path \r\n\r\n# checkpoint = 'results/model_chunk_6/checkpoint.pt'\r\n# checkpoint = tagger.load_checkpoint(Path(checkpoint))\r\n# trainer = ModelTrainer.load_from_checkpoint(checkpoint, corpus)\r\n\r\n# trainer.train('./results/'+ sys.argv[2],\r\n#               learning_rate=0.15,\r\n#               embeddings_storage_mode = 'gpu',\r\n#               mini_batch_size=16,\r\n#               patience=3,\r\n#               max_epochs=150,\r\n#               train_with_dev=False,\r\n#               checkpoint=True)\r\n\r\n\r\nplotter = Plotter()\r\n# plotter.plot_training_curves('./results/'+ sys.argv[2]+'/loss.tsv')\r\nplotter.plot_weights('./results/'+ sys.argv[2]+'/weights.txt')\r\n\r\n\r\n```\r\n\r\n**Expected behavior**\r\n\r\nI'd like to predict on cpu machines.\r\n\r\n**Screenshots**\r\n\r\nThis is where I got error\r\n\r\n![ss_1](https://user-images.githubusercontent.com/64765786/83096039-b47ab500-a0ca-11ea-91b5-bbdea6e9549c.png)\r\n\r\nShowing to gpu path\r\n\r\n![ss_2](https://user-images.githubusercontent.com/64765786/83096069-c9574880-a0ca-11ea-8715-9bbaa756837c.png)\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - OS [Linux-mint:19.3]:\r\n - Version [flair: 0.5 ]:\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1643/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1643/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1640", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1640/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1640/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1640/events", "html_url": "https://github.com/flairNLP/flair/issues/1640", "id": 625457208, "node_id": "MDU6SXNzdWU2MjU0NTcyMDg=", "number": 1640, "title": "TypeError: __init__() got an unexpected keyword argument 'labels' in data_fetcher.py", "user": {"login": "hanktseng131415go", "id": 48938318, "node_id": "MDQ6VXNlcjQ4OTM4MzE4", "avatar_url": "https://avatars.githubusercontent.com/u/48938318?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hanktseng131415go", "html_url": "https://github.com/hanktseng131415go", "followers_url": "https://api.github.com/users/hanktseng131415go/followers", "following_url": "https://api.github.com/users/hanktseng131415go/following{/other_user}", "gists_url": "https://api.github.com/users/hanktseng131415go/gists{/gist_id}", "starred_url": "https://api.github.com/users/hanktseng131415go/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hanktseng131415go/subscriptions", "organizations_url": "https://api.github.com/users/hanktseng131415go/orgs", "repos_url": "https://api.github.com/users/hanktseng131415go/repos", "events_url": "https://api.github.com/users/hanktseng131415go/events{/privacy}", "received_events_url": "https://api.github.com/users/hanktseng131415go/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-05-27T07:40:45Z", "updated_at": "2020-09-22T07:35:34Z", "closed_at": "2020-09-22T07:35:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi!\r\nWhen I was following the New Fine-tuneable Transformers suggestion, the below issue arises. It seems like the data_fetcher.py doesn't follow the new format of Sentence(), right?\r\n```\r\nTraceback (most recent call last):\r\n  File \"block_classification.py\", line 51, in <module>\r\n    corpus = NLPTaskDataFetcher.load_classification_corpus(Path('./'), test_file='test.csv', dev_file='dev.csv', train_file='train.csv')\r\n  File \"/home/user/.conda/envs/keras/lib/python3.6/site-packages/deprecated/classic.py\", line 233, in wrapper_function\r\n    return wrapped_(*args_, **kwargs_)\r\n  File \"/home/user/.conda/envs/keras/lib/python3.6/site-packages/flair/data_fetcher.py\", line 452, in load_classification_corpus\r\n    train_file, tokenizer=tokenizer, max_tokens_per_doc=max_tokens_per_doc\r\n  File \"/home/user/.conda/envs/keras/lib/python3.6/site-packages/deprecated/classic.py\", line 233, in wrapper_function\r\n    return wrapped_(*args_, **kwargs_)\r\n  File \"/home/user/.conda/envs/keras/lib/python3.6/site-packages/flair/data_fetcher.py\", line 513, in read_text_classification_file\r\n    sentence = Sentence(text, labels=labels, use_tokenizer=tokenizer)\r\nTypeError: __init__() got an unexpected keyword argument 'labels'\r\n```\r\nOr is there anything I missed in my code? The full implementing code is as below:\r\n```\r\nfrom flair.embeddings import TransformerDocumentEmbeddings\r\nimport pandas as pd\r\nfrom flair.data_fetcher import NLPTaskDataFetcher\r\nfrom flair.embeddings import DocumentPoolEmbeddings\r\nfrom flair.models import TextClassifier\r\nfrom pathlib import Path\r\nfrom flair.trainers import ModelTrainer\r\nfrom torch.optim.adam import Adam\r\nimport flair, torch\r\n\r\nflair.device = torch.device('cuda:0')\r\ntraining_path = './train.csv'\r\ntesting_path = './test.csv'\r\ndeving_path = './dev.csv'\r\n\r\ncorpus = NLPTaskDataFetcher.load_classification_corpus(Path('./'), test_file='test.csv', dev_file='dev.csv', train_file='train.csv')\r\ncorpus.test\r\ndocument_embeddings = TransformerDocumentEmbeddings('xlnet-large-cased', fine_tune = True)\r\nclassifier = TextClassifier(document_embeddings, label_dictionary=corpus.make_label_dictionary(), multi_label=True)\r\ntrainer = ModelTrainer(classifier, corpus, optimizer=Adam)\r\ntrainer.train('./train_hist/', learning_rate=0.1, max_epochs=100, embeddings_storage_mode='gpu')\r\n```\r\nMany thanks", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1640/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1640/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1639", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1639/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1639/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1639/events", "html_url": "https://github.com/flairNLP/flair/issues/1639", "id": 625445995, "node_id": "MDU6SXNzdWU2MjU0NDU5OTU=", "number": 1639, "title": "Memory Leak when I am using tagger.predict() on batch sentences ", "user": {"login": "lucky050619", "id": 30066490, "node_id": "MDQ6VXNlcjMwMDY2NDkw", "avatar_url": "https://avatars.githubusercontent.com/u/30066490?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lucky050619", "html_url": "https://github.com/lucky050619", "followers_url": "https://api.github.com/users/lucky050619/followers", "following_url": "https://api.github.com/users/lucky050619/following{/other_user}", "gists_url": "https://api.github.com/users/lucky050619/gists{/gist_id}", "starred_url": "https://api.github.com/users/lucky050619/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lucky050619/subscriptions", "organizations_url": "https://api.github.com/users/lucky050619/orgs", "repos_url": "https://api.github.com/users/lucky050619/repos", "events_url": "https://api.github.com/users/lucky050619/events{/privacy}", "received_events_url": "https://api.github.com/users/lucky050619/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2020-05-27T07:21:54Z", "updated_at": "2021-02-16T20:28:37Z", "closed_at": "2021-02-16T20:28:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have trained a custom ner model and trying to predict the labels in a loop. \r\n\r\n trained the model with  stacked embedding model with flair-frwd ,flair-back, byte-pair and glove. \r\n\r\nit is adding memory to RAM for every predict method.\r\n\r\nversions:\r\ntorch==1.3.1\r\nflair==0.4.3\r\n\r\n           2408.3 MiB      0.0 MiB           \r\n           2408.3 MiB      0.0 MiB           \r\n           2449.3 MiB     41.1 MiB           self.model.predict(metadata_sentences, mini_batch_size=64)\r\n   \r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1639/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1639/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1634", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1634/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1634/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1634/events", "html_url": "https://github.com/flairNLP/flair/issues/1634", "id": 624476595, "node_id": "MDU6SXNzdWU2MjQ0NzY1OTU=", "number": 1634, "title": "AttributeError: 'ELMoEmbeddings' object has no attribute 'embedding_mode_fn'", "user": {"login": "yzhaoinuw", "id": 22312388, "node_id": "MDQ6VXNlcjIyMzEyMzg4", "avatar_url": "https://avatars.githubusercontent.com/u/22312388?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yzhaoinuw", "html_url": "https://github.com/yzhaoinuw", "followers_url": "https://api.github.com/users/yzhaoinuw/followers", "following_url": "https://api.github.com/users/yzhaoinuw/following{/other_user}", "gists_url": "https://api.github.com/users/yzhaoinuw/gists{/gist_id}", "starred_url": "https://api.github.com/users/yzhaoinuw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yzhaoinuw/subscriptions", "organizations_url": "https://api.github.com/users/yzhaoinuw/orgs", "repos_url": "https://api.github.com/users/yzhaoinuw/repos", "events_url": "https://api.github.com/users/yzhaoinuw/events{/privacy}", "received_events_url": "https://api.github.com/users/yzhaoinuw/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-05-25T20:39:14Z", "updated_at": "2020-06-13T10:25:41Z", "closed_at": "2020-06-13T10:25:41Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hi Flair developers, thank you for releasing version 0.5 of flair. I am very excited and wasted no time trying it. I upgraded it today to release 0.5 from release 0.45. Then I went ahead to run an NER module I made afew days ago to see if I need to make changes to my module because of the new flair release. My NER module uses the flair sequence tagger and the ELMo embeddings. But now I encounter the following error message:\r\n\r\n```\r\n  File \"/home/Desktop/name_parser.py\", line 44, in parse_name\r\n    self.model.predict(name,all_tag_prob=True)\r\n\r\n  File \"/home/anaconda3/envs/nlp/lib/python3.7/site-packages/flair/models/sequence_tagger_model.py\", line 372, in predict\r\n    feature: torch.Tensor = self.forward(batch)\r\n\r\n  File \"/home/anaconda3/envs/nlp/lib/python3.7/site-packages/flair/models/sequence_tagger_model.py\", line 513, in forward\r\n    self.embeddings.embed(sentences)\r\n\r\n  File \"/home/anaconda3/envs/nlp/lib/python3.7/site-packages/flair/embeddings/base.py\", line 59, in embed\r\n    self._add_embeddings_internal(sentences)\r\n\r\n  File \"/home/anaconda3/envs/nlp/lib/python3.7/site-packages/flair/embeddings/token.py\", line 1594, in _add_embeddings_internal\r\n    word_embedding = self.embedding_mode_fn(elmo_embedding_layers)\r\n\r\n  File \"/home/anaconda3/envs/nlp/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 585, in __getattr__\r\n    type(self).__name__, name))\r\n\r\nAttributeError: 'ELMoEmbeddings' object has no attribute 'embedding_mode_fn'\r\n```\r\n\r\nOne code in my module loads a NER model I trained, which used the ELMo emneddings. Then, I use the loaded model to predict NER tags. My module was working well with flair 0.45. All that changed was was that I upgraded flair to 0.5. I tried to look in to ELMoEmbeddings class in [token.py](https://github.com/flairNLP/flair/blob/083eb114505ede0ea3070317a5a08d13fc71891b/flair/embeddings/token.py) and found from line 1543 to 1548 where it is defined as follows\r\n\r\n```\r\n if embedding_mode == \"all\":\r\n        self.embedding_mode_fn = lambda x: torch.cat(x, 0)\r\nelif embedding_mode == \"top\":\r\n        self.embedding_mode_fn = lambda x: x[-1]\r\nelif embedding_mode == \"average\":\r\n        self.embedding_mode_fn = lambda x: torch.mean(torch.stack(x), 0)\r\n```\r\n\r\nI don't remember specifying the mode for ELMo when I trained the NER model. This is new feature in this release, right? Do I have need to retrain the model with ELMo and specify the mode? Is there a quicker fix?\r\n\r\nThank you!\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1634/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1634/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1628", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1628/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1628/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1628/events", "html_url": "https://github.com/flairNLP/flair/issues/1628", "id": 623852023, "node_id": "MDU6SXNzdWU2MjM4NTIwMjM=", "number": 1628, "title": "use_dropout not getting saved in checkpoint ???", "user": {"login": "sankaran45", "id": 8388863, "node_id": "MDQ6VXNlcjgzODg4NjM=", "avatar_url": "https://avatars.githubusercontent.com/u/8388863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sankaran45", "html_url": "https://github.com/sankaran45", "followers_url": "https://api.github.com/users/sankaran45/followers", "following_url": "https://api.github.com/users/sankaran45/following{/other_user}", "gists_url": "https://api.github.com/users/sankaran45/gists{/gist_id}", "starred_url": "https://api.github.com/users/sankaran45/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sankaran45/subscriptions", "organizations_url": "https://api.github.com/users/sankaran45/orgs", "repos_url": "https://api.github.com/users/sankaran45/repos", "events_url": "https://api.github.com/users/sankaran45/events{/privacy}", "received_events_url": "https://api.github.com/users/sankaran45/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-05-24T12:10:42Z", "updated_at": "2020-06-03T17:21:26Z", "closed_at": "2020-06-03T17:21:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "I think the use_dropout parameter does not saved as part of state_dict due to bug in\r\n def _get_state_dict(self) \r\n\r\nas a result of which if we set a dropout layer in sequence tagger, and resume checkpoint training, the behavior changes.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1628/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1628/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1622", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1622/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1622/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1622/events", "html_url": "https://github.com/flairNLP/flair/issues/1622", "id": 623296854, "node_id": "MDU6SXNzdWU2MjMyOTY4NTQ=", "number": 1622, "title": "plot_weights figsize referenced before assignment", "user": {"login": "cod3licious", "id": 1093567, "node_id": "MDQ6VXNlcjEwOTM1Njc=", "avatar_url": "https://avatars.githubusercontent.com/u/1093567?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cod3licious", "html_url": "https://github.com/cod3licious", "followers_url": "https://api.github.com/users/cod3licious/followers", "following_url": "https://api.github.com/users/cod3licious/following{/other_user}", "gists_url": "https://api.github.com/users/cod3licious/gists{/gist_id}", "starred_url": "https://api.github.com/users/cod3licious/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cod3licious/subscriptions", "organizations_url": "https://api.github.com/users/cod3licious/orgs", "repos_url": "https://api.github.com/users/cod3licious/repos", "events_url": "https://api.github.com/users/cod3licious/events{/privacy}", "received_events_url": "https://api.github.com/users/cod3licious/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-05-22T15:39:32Z", "updated_at": "2020-05-28T22:46:26Z", "closed_at": "2020-05-28T22:46:25Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "`# figsize = (16, 16)` in [line 125 of Plotter.plot_weights](https://github.com/flairNLP/flair/blob/master/flair/visual/training_curves.py#L125) should be uncommented or the if statement below should be changed, otherwise this can throw `UnboundLocalError: local variable 'figsize' referenced before assignment`.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1622/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1622/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1618", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1618/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1618/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1618/events", "html_url": "https://github.com/flairNLP/flair/issues/1618", "id": 621567586, "node_id": "MDU6SXNzdWU2MjE1Njc1ODY=", "number": 1618, "title": "Using ElmoEmbeddings crashes at the first save attempt. ", "user": {"login": "nstylia", "id": 3770033, "node_id": "MDQ6VXNlcjM3NzAwMzM=", "avatar_url": "https://avatars.githubusercontent.com/u/3770033?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nstylia", "html_url": "https://github.com/nstylia", "followers_url": "https://api.github.com/users/nstylia/followers", "following_url": "https://api.github.com/users/nstylia/following{/other_user}", "gists_url": "https://api.github.com/users/nstylia/gists{/gist_id}", "starred_url": "https://api.github.com/users/nstylia/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nstylia/subscriptions", "organizations_url": "https://api.github.com/users/nstylia/orgs", "repos_url": "https://api.github.com/users/nstylia/repos", "events_url": "https://api.github.com/users/nstylia/events{/privacy}", "received_events_url": "https://api.github.com/users/nstylia/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2020-05-20T08:30:59Z", "updated_at": "2020-06-13T10:25:18Z", "closed_at": "2020-06-13T10:25:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "Using stacked flair embeddings with elmo (or even standalone elmo I assume), results in an error while saving the model due to the lambda function in the elmo embeddings. As a result, the pickler in pytorch cannot save the model and crashes after the first epoch, while trying to save the model. The same code snippet works without the elmo embeddings (omitted parameters in SequenceTagger and train). \r\n\r\n`embedding_types: List[TokenEmbeddings] = [\r\n    PooledFlairEmbeddings('pubmed-forward'),\r\n    PooledFlairEmbeddings('pubmed-backward'),\r\n    ELMoEmbeddings('pubmed'),\r\n]`\r\n`embeddings: StackedEmbeddings = StackedEmbeddings(embeddings=embedding_types)`\r\n`tagger: SequenceTagger = SequenceTagger(...)`\r\n`trainer: ModelTrainer = ModelTrainer(tagger, corpus)`\r\n`trainer.train(...)` \r\n\r\nThe error message: \r\n\r\n> Traceback (most recent call last):\r\n  File \"flair_main.py\", line 43, in <module>\r\n    max_epochs=100)\r\n  File \"/home/ns/envs/mldev/lib/python3.6/site-packages/flair/trainers/trainer.py\", line 552, in train\r\n    self.model.save(base_path / \"best-model.pt\")\r\n  File \"/home/ns/envs/mldev/lib/python3.6/site-packages/flair/nn.py\", line 70, in save\r\n    torch.save(model_state, str(model_file), pickle_protocol=4)\r\n  File \"/home/ns/envs/mldev/lib/python3.6/site-packages/torch/serialization.py\", line 328, in save\r\n    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)\r\n  File \"/home/ns/envs/mldev/lib/python3.6/site-packages/torch/serialization.py\", line 401, in _legacy_save\r\n    pickler.dump(obj)\r\nAttributeError: Can't pickle local object 'ELMoEmbeddings.\\_\\_init\\_\\_.\\<locals\\>.\\<lambda\\> '\r\n\r\n\r\nEnvironment information: \r\nUbuntu 16.04\r\ntorch-1.4.0+cu101\r\nflair-0.4.5\r\n\r\nIs there any work around ? Am I doing something wrong? I don't think this is expected behavior. Also, I assume that pickle would be able to handle lambda functions.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1618/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1618/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1610", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1610/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1610/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1610/events", "html_url": "https://github.com/flairNLP/flair/issues/1610", "id": 617863198, "node_id": "MDU6SXNzdWU2MTc4NjMxOTg=", "number": 1610, "title": "AttributeError when finetuned bert model for downstream task is used", "user": {"login": "Michael95-m", "id": 64765786, "node_id": "MDQ6VXNlcjY0NzY1Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/64765786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Michael95-m", "html_url": "https://github.com/Michael95-m", "followers_url": "https://api.github.com/users/Michael95-m/followers", "following_url": "https://api.github.com/users/Michael95-m/following{/other_user}", "gists_url": "https://api.github.com/users/Michael95-m/gists{/gist_id}", "starred_url": "https://api.github.com/users/Michael95-m/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Michael95-m/subscriptions", "organizations_url": "https://api.github.com/users/Michael95-m/orgs", "repos_url": "https://api.github.com/users/Michael95-m/repos", "events_url": "https://api.github.com/users/Michael95-m/events{/privacy}", "received_events_url": "https://api.github.com/users/Michael95-m/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2020-05-14T01:48:33Z", "updated_at": "2020-07-28T20:28:55Z", "closed_at": "2020-05-14T14:37:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI got the error called AttributeError:'BertTokenizer' object has no attribute 'model_max_length' when i used model.predict(sentence)\r\n\r\n\r\n**To Reproduce**\r\nI didn't get any errors when I trained. The script for training model is \r\n\r\n``\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import ColumnCorpus\r\nfrom flair.embeddings import TransformerWordEmbeddings, TokenEmbeddings, StackedEmbeddings, BertEmbeddings, CharacterEmbeddings, BytePairEmbeddings, WordEmbeddings\r\nfrom flair.visual.training_curves import Plotter\r\nfrom flair.models import SequenceTagger\r\nfrom flair.trainers import ModelTrainer\r\nfrom typing import List\r\nfrom torch.optim.adam import Adam\r\nimport sys\r\nimport flair, torch\r\n\r\n\r\nflair.device = torch.device('cuda:0')\r\ncolumns = {0: 'text', 1: 'ner'}\r\ndata_folder =  './data/Model_Trainer_Data'\r\ncorpus: Corpus = ColumnCorpus(data_folder, columns,train_file= sys.argv[1] , dev_file=sys.argv[3], test_file= sys.argv[4], in_memory=False)\r\n\r\ntag_type = 'ner'\r\ntag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\n\r\nembeddings = TransformerWordEmbeddings(\r\n        'bert-base-multilingual-cased', # which transformer model\r\n        layers=\"-1\", # which layers (here: only last layer when fine-tuning)\r\n        pooling_operation='first_last', # how to pool over split tokens\r\n        fine_tune=True, # whether or not to fine-tune\r\n    )\r\n\r\ntagger: SequenceTagger = SequenceTagger(\r\n        hidden_size=256,\r\n        embeddings=embeddings,\r\n        tag_dictionary=tag_dictionary,\r\n        tag_type=tag_type,\r\n        use_crf=False,\r\n        use_rnn=False,\r\n    )\r\n\r\ntrainer = ModelTrainer(tagger, corpus, optimizer=torch.optim.Adam)\r\n\r\ntrainer.train('./results/'+ sys.argv[2],\r\n              learning_rate=3e-5,\r\n              embeddings_storage_mode = 'gpu',\r\n              mini_batch_chunk_size=2, \r\n              max_epochs=4, \r\n              train_with_dev=False,\r\n              checkpoint=True)\r\n\r\nplotter = Plotter()\r\nplotter.plot_weights('./results/'+ sys.argv[2]+'/weights.txt')\r\n``\r\n\r\nThe prediction script is below.\r\n\r\n![to_send](https://user-images.githubusercontent.com/64765786/81883416-30e5a200-95bb-11ea-98ae-9ba1b43fed1d.png)\r\n\r\n\r\n\r\n\r\n**Expected behavior**\r\nTo get no errors in predicting with model\r\n\r\n**Screenshots**\r\n\r\n![to_send](https://user-images.githubusercontent.com/64765786/81883528-73a77a00-95bb-11ea-83ef-f0f05ecd63e7.png)\r\n\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - OS [Linux mint 19.3]:\r\n - Version [flair current lastest branch]:\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1610/reactions", "total_count": 3, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 1, "eyes": 1}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1610/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1603", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1603/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1603/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1603/events", "html_url": "https://github.com/flairNLP/flair/issues/1603", "id": 616056939, "node_id": "MDU6SXNzdWU2MTYwNTY5Mzk=", "number": 1603, "title": "Strange behavior with PooledFlairEmbeddings ???", "user": {"login": "sankaran45", "id": 8388863, "node_id": "MDQ6VXNlcjgzODg4NjM=", "avatar_url": "https://avatars.githubusercontent.com/u/8388863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sankaran45", "html_url": "https://github.com/sankaran45", "followers_url": "https://api.github.com/users/sankaran45/followers", "following_url": "https://api.github.com/users/sankaran45/following{/other_user}", "gists_url": "https://api.github.com/users/sankaran45/gists{/gist_id}", "starred_url": "https://api.github.com/users/sankaran45/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sankaran45/subscriptions", "organizations_url": "https://api.github.com/users/sankaran45/orgs", "repos_url": "https://api.github.com/users/sankaran45/repos", "events_url": "https://api.github.com/users/sankaran45/events{/privacy}", "received_events_url": "https://api.github.com/users/sankaran45/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-05-11T17:35:24Z", "updated_at": "2020-05-11T17:59:25Z", "closed_at": "2020-05-11T17:59:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am running a simple NER experiment with two labels with the default settings except for train_with_dev=True, max_epochs=150. I want to analyze the F1 scores obtained at 50, 100, 150 epochs respectively. So instead of stopping the training at these intervals and resuming i decided to run it for 150 epochs but just save the checkpoints at 50 and 100 by modifying trainer.py as its little easier this way in colab. Later when test is over, i finalize these checkpoint files using trainer.train which gives the predictions. \r\n\r\nThis works fine for Bert, Elmo, Flair embeddings as given below. For PooledFlair (pooling='mean' / pooling='min') the results are quite erratic although by 150 epochs it seems to catch up. Why is it the case ? Or what am i doing wrong ?\r\n\r\nIn the below, 2nd column is embedding, 3rd is epoch, and 4th is F1 score reported by trainer upon testing the best model at that time:\r\n\r\n4\tbert\t50\t86.61\r\n5\tbert\t100\t87.09666667\r\n6\tbert\t150\t87.32666667\r\n11\telmo\t50\t87.205\r\n12\telmo\t100\t87.295\r\n13\telmo\t150\t87.08\r\n14\tflair\t50\t87.58\r\n15\tflair\t100\t88.14\r\n16\tflair\t150\t87.45\r\n21\tpf\t50\t74.7\r\n22\tpf\t100\t78.94333333\r\n23\tpf\t150\t87.62333333\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1603/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1603/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1593", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1593/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1593/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1593/events", "html_url": "https://github.com/flairNLP/flair/issues/1593", "id": 614745037, "node_id": "MDU6SXNzdWU2MTQ3NDUwMzc=", "number": 1593, "title": "MemoryError after few epochs using PooledFlairEmbeddings", "user": {"login": "schelv", "id": 13403863, "node_id": "MDQ6VXNlcjEzNDAzODYz", "avatar_url": "https://avatars.githubusercontent.com/u/13403863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/schelv", "html_url": "https://github.com/schelv", "followers_url": "https://api.github.com/users/schelv/followers", "following_url": "https://api.github.com/users/schelv/following{/other_user}", "gists_url": "https://api.github.com/users/schelv/gists{/gist_id}", "starred_url": "https://api.github.com/users/schelv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/schelv/subscriptions", "organizations_url": "https://api.github.com/users/schelv/orgs", "repos_url": "https://api.github.com/users/schelv/repos", "events_url": "https://api.github.com/users/schelv/events{/privacy}", "received_events_url": "https://api.github.com/users/schelv/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 13, "created_at": "2020-05-08T13:31:15Z", "updated_at": "2020-10-22T12:06:11Z", "closed_at": "2020-10-22T12:06:11Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhen training a SequenceTagger model the RAM usage keeps gradually increasing, untill it runs out of memory after a few epochs, and crashes when saving checkpoint.\r\n\r\n```\r\n2020-05-08 12:14:29,965 epoch 4 - iter 480/602 - loss 0.81027193 - samples/sec: 140.87\r\n2020-05-08 12:14:57,488 epoch 4 - iter 540/602 - loss 0.81292692 - samples/sec: 139.73\r\n2020-05-08 12:15:28,748 epoch 4 - iter 600/602 - loss 0.81350967 - samples/sec: 123.00\r\n2020-05-08 12:15:29,467 ----------------------------------------------------------------------------------------------------\r\n2020-05-08 12:15:29,467 EPOCH 4 done: loss 0.8129 - lr 0.1000\r\n2020-05-08 12:15:29,467 BAD EPOCHS (no improvement): 0\r\n\r\n Traceback (most recent call last):\r\n  File \"./config/flair_train_script.py\", line 104, in <module>\r\n    checkpoint=True)\r\n  File \"/home/ubuntu/miniconda/envs/aws_env/lib/python3.6/site-packages/flair/trainers/trainer.py\", line 525, in train\r\n    self.save_checkpoint(base_path / \"checkpoint.pt\")\r\n  File \"/home/ubuntu/miniconda/envs/aws_env/lib/python3.6/site-packages/flair/trainers/trainer.py\", line 573, in save_checkpoint\r\n    torch.save(self, str(model_file), pickle_protocol=4)\r\n  File \"/home/ubuntu/miniconda/envs/aws_env/lib/python3.6/site-packages/torch/serialization.py\", line 328, in save\r\n    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)\r\n  File \"/home/ubuntu/miniconda/envs/aws_env/lib/python3.6/site-packages/torch/serialization.py\", line 401, in _legacy_save\r\n    pickler.dump(obj)\r\nMemoryError\r\n```\r\n\r\n\r\n**To Reproduce**\r\nSequenceTagger with \r\n```\r\nembedding_types = [\r\n        WordEmbeddings('nl'),\r\n        PooledFlairEmbeddings('dutch-forward', pooling='mean'),\r\n        PooledFlairEmbeddings('dutch-backward', pooling='mean'),\r\n    ]\r\n```\r\n\r\n**Expected behavior**\r\nDon't use all the RAM, and don't crash.\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - V100 GPU\r\n - 61 GiB RAM\r\n - OS: Ubuntu 18.04\r\n - Version:\r\n   flair-0.4.5\r\n   pytorch-1.4.0-py3.6_cuda10.1.243_cudnn7.6.3_0\r\n\r\n\r\n\r\n**Additional context**\r\n\r\nI'm training using the CONLL_03_DUTCH dataset + another dataset that has overlap in the tags.\r\npytorch 1.4.0 is used because 1.5.0 currently has this issue (https://github.com/pytorch/pytorch/issues/37703).\r\n\r\nCould it have something to do with the pooled flair embeddings not being properly cleared after each epoch?\r\n\r\nThe problem does not occur when using \r\n```\r\n    embedding_types = [\r\n        WordEmbeddings('nl'),\r\n        FlairEmbeddings('nl-forward'),\r\n        FlairEmbeddings('nl-backward'),\r\n    ]\r\n```\r\n\r\nI think this might be the same issue as https://github.com/flairNLP/flair/issues/1270.\r\nCould it be possible that the \"fix\" of that issue just moved the problem from GPU RAM to normal RAM?\r\n\r\nCould it be related to this?: https://discuss.pytorch.org/t/memory-ram-usage-keep-going-up-every-step/12109/8\r\n\r\n\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1593/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1593/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1567", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1567/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1567/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1567/events", "html_url": "https://github.com/flairNLP/flair/issues/1567", "id": 611143475, "node_id": "MDU6SXNzdWU2MTExNDM0NzU=", "number": 1567, "title": "TransformerDocuementEmbedding does not take flair.device", "user": {"login": "junhua", "id": 3516360, "node_id": "MDQ6VXNlcjM1MTYzNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3516360?v=4", "gravatar_id": "", "url": "https://api.github.com/users/junhua", "html_url": "https://github.com/junhua", "followers_url": "https://api.github.com/users/junhua/followers", "following_url": "https://api.github.com/users/junhua/following{/other_user}", "gists_url": "https://api.github.com/users/junhua/gists{/gist_id}", "starred_url": "https://api.github.com/users/junhua/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/junhua/subscriptions", "organizations_url": "https://api.github.com/users/junhua/orgs", "repos_url": "https://api.github.com/users/junhua/repos", "events_url": "https://api.github.com/users/junhua/events{/privacy}", "received_events_url": "https://api.github.com/users/junhua/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-05-02T09:12:30Z", "updated_at": "2020-05-06T22:22:46Z", "closed_at": "2020-05-06T22:22:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "By setting `flair.device = torch.device('cuda:0;)`, it throws an error saying `expected device cpu  but got device cuda:0`. I have to explicitly set `TextClassifier(...).to(torch.device('cuda:0')` to make it happen", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1567/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1567/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1564", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1564/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1564/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1564/events", "html_url": "https://github.com/flairNLP/flair/issues/1564", "id": 610684673, "node_id": "MDU6SXNzdWU2MTA2ODQ2NzM=", "number": 1564, "title": "Error using flair embeddings: ValueError: invalid literal for int() with base 10: '0+cu101'", "user": {"login": "ChessMateK", "id": 48825535, "node_id": "MDQ6VXNlcjQ4ODI1NTM1", "avatar_url": "https://avatars.githubusercontent.com/u/48825535?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ChessMateK", "html_url": "https://github.com/ChessMateK", "followers_url": "https://api.github.com/users/ChessMateK/followers", "following_url": "https://api.github.com/users/ChessMateK/following{/other_user}", "gists_url": "https://api.github.com/users/ChessMateK/gists{/gist_id}", "starred_url": "https://api.github.com/users/ChessMateK/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ChessMateK/subscriptions", "organizations_url": "https://api.github.com/users/ChessMateK/orgs", "repos_url": "https://api.github.com/users/ChessMateK/repos", "events_url": "https://api.github.com/users/ChessMateK/events{/privacy}", "received_events_url": "https://api.github.com/users/ChessMateK/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-05-01T10:31:24Z", "updated_at": "2020-05-06T20:17:23Z", "closed_at": "2020-05-05T13:17:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhen I run this:\r\n\r\n```\r\nembedding_types: List[TokenEmbeddings] = [               \r\n    FlairEmbeddings('news-forward'),\r\n    FlairEmbeddings('news-backward')\r\n]\r\n```\r\n\r\nI obtain the following errors:\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-4-177704bfc5f6> in <module>()\r\n---> 51     FlairEmbeddings('news-forward'),\r\n     52     FlairEmbeddings('news-backward')\r\n\r\n5 frames\r\n/usr/local/lib/python3.6/dist-packages/flair/embeddings.py in __init__(self, model, fine_tune, chars_per_chunk)\r\n   1986             self.name = f\"Task-LSTM-{self.lm.hidden_size}-{self.lm.nlayers}-{self.lm.is_forward_lm}\"\r\n   1987         else:\r\n-> 1988             self.lm: LanguageModel = LanguageModel.load_language_model(model)\r\n   1989             self.name = str(model)\r\n   1990 \r\n\r\n/usr/local/lib/python3.6/dist-packages/flair/models/language_model.py in load_language_model(cls, model_file)\r\n    195             state[\"embedding_size\"],\r\n    196             state[\"nout\"],\r\n--> 197             state[\"dropout\"],\r\n    198         )\r\n    199         model.load_state_dict(state[\"state_dict\"])\r\n\r\n/usr/local/lib/python3.6/dist-packages/flair/models/language_model.py in __init__(self, dictionary, is_forward_lm, hidden_size, nlayers, embedding_size, nout, dropout)\r\n     59 \r\n     60         # auto-spawn on GPU if available\r\n---> 61         self.to(flair.device)\r\n     62 \r\n     63     def init_weights(self):\r\n\r\n/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py in to(self, *args, **kwargs)\r\n    441             return t.to(device, dtype if t.is_floating_point() else None, non_blocking)\r\n    442 \r\n--> 443         return self._apply(convert)\r\n    444 \r\n    445     def register_backward_hook(self, hook):\r\n\r\n/usr/local/lib/python3.6/dist-packages/flair/models/language_model.py in _apply(self, fn)\r\n    392     def _apply(self, fn):\r\n    393         major, minor, build, *_ = (int(info)\r\n--> 394                                 for info in torch.__version__.split('.'))\r\n    395 \r\n    396         # fixed RNN change format for torch 1.4.0\r\n\r\n/usr/local/lib/python3.6/dist-packages/flair/models/language_model.py in <genexpr>(.0)\r\n    392     def _apply(self, fn):\r\n    393         major, minor, build, *_ = (int(info)\r\n--> 394                                 for info in torch.__version__.split('.'))\r\n    395 \r\n    396         # fixed RNN change format for torch 1.4.0\r\n\r\nValueError: invalid literal for int() with base 10: '0+cu101'\r\n```\r\n\r\n**To Reproduce**\r\nFollow [this flair guide](https://github.com/flairNLP/flair/blob/cd7f04352229284d2802cf7b5c701dca3ee28d6c/resources/docs/TUTORIAL_7_TRAINING_A_MODEL.md) for NER and use flair embeddings\r\n\r\n**Expected behavior**\r\nEmbeddings are stacked without errors.\r\n\r\n**Screenshots**\r\nNone\r\n\r\n**Environment (please complete the following information):**\r\n - Google Colab\r\n\r\n**Additional context**\r\nNone\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1564/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1564/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1562", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1562/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1562/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1562/events", "html_url": "https://github.com/flairNLP/flair/issues/1562", "id": 610310610, "node_id": "MDU6SXNzdWU2MTAzMTA2MTA=", "number": 1562, "title": "ModelTrainer's training on SequenceTagger raises an `AssertionError: `", "user": {"login": "iam-kevin", "id": 54111777, "node_id": "MDQ6VXNlcjU0MTExNzc3", "avatar_url": "https://avatars.githubusercontent.com/u/54111777?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iam-kevin", "html_url": "https://github.com/iam-kevin", "followers_url": "https://api.github.com/users/iam-kevin/followers", "following_url": "https://api.github.com/users/iam-kevin/following{/other_user}", "gists_url": "https://api.github.com/users/iam-kevin/gists{/gist_id}", "starred_url": "https://api.github.com/users/iam-kevin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iam-kevin/subscriptions", "organizations_url": "https://api.github.com/users/iam-kevin/orgs", "repos_url": "https://api.github.com/users/iam-kevin/repos", "events_url": "https://api.github.com/users/iam-kevin/events{/privacy}", "received_events_url": "https://api.github.com/users/iam-kevin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-04-30T18:56:20Z", "updated_at": "2020-05-01T23:42:30Z", "closed_at": "2020-05-01T23:42:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI am unable to Train a `SequenceTagger` model using the `ModelTrainer` API. This was upon my attempt to train a NER Tagger. The `AssertionError` is raised after the completion of the first epoch.\r\n\r\n**To Reproduce**\r\nThe format of my NER data is:\r\n```\r\njina O\r\nlangu O\r\nni O\r\nKevin B-PERSON\r\n...\r\n```\r\n\r\nSo I set up the Training sequence this way\r\n```\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import ColumnCorpus\r\nfrom flair.embeddings import StackedEmbeddings, CharacterEmbeddings, FlairEmbeddings\r\n\r\nTAG_TYPE = 'ner'\r\ncorpus: Corpus = ColumnCorpus('./ner_data', {0: 'text', 1: 'ner'})\r\n\r\n# Setup the sequence tagger\r\nfrom flair.models import SequenceTagger\r\n\r\ntagger: SequenceTagger = SequenceTagger(hidden_size=256,\r\n                                        embeddings=embeddings,\r\n                                        tag_dictionary=corpus.make_label_dictionary(label_type=TAG_TYPE),# ... from corpus\r\n                                        tag_type=TAG_TYPE,\r\n                                        use_crf=True)\r\n\r\n\r\n# Setup the training process\r\nfrom flair.trainers import ModelTrainer\r\n\r\ntrainer: ModelTrainer = ModelTrainer(tagger, corpus)\r\n\r\ntrainer.train('./resource/taggers/swahili-ner',\r\n              learning_rate=0.1,\r\n              mini_batch_size=32)\r\n\r\n# intializing the embeddings\r\nembeddings: StackedEmbeddings = StackedEmbeddings([CharacterEmbeddings(),\r\n                                                   FlairEmbeddings('./best-lm.pt')])\r\n```\r\n\r\nThis was the output from my training:\r\n```\r\n...\r\n2020-04-30 14:36:40,370 epoch 1 - iter 96/120 - loss 209973.64290365 - samples/sec: 33.04\r\n2020-04-30 14:36:52,323 epoch 1 - iter 108/120 - loss 208670.76244213 - samples/sec: 32.17\r\n2020-04-30 14:37:03,579 epoch 1 - iter 120/120 - loss 206854.72747396 - samples/sec: 34.17\r\n2020-04-30 14:37:03,594 ----------------------------------------------------------------------------------------------------\r\n2020-04-30 14:37:03,594 EPOCH 1 done: loss 206854.7275 - lr 0.1000000\r\n---------------------------------------------------------------------------\r\nAssertionError                            Traceback (most recent call last)\r\n<ipython-input-18-67e2f7ae9c06> in <module>()\r\n     15 trainer.train('./resource/taggers/swahili-dumb-ner',\r\n     16               learning_rate=0.1,\r\n---> 17               mini_batch_size=32)\r\n     18 \r\n     19 # Plotting the performance graphs\r\n\r\n3 frames\r\n/usr/local/lib/python3.6/dist-packages/flair/models/sequence_tagger_model.py in _viterbi_decode(self, feats, transitions, all_scores)\r\n    754 \r\n    755         start = best_path.pop()\r\n--> 756         assert start == id_start\r\n    757         best_path.reverse()\r\n    758 \r\n\r\nAssertionError: \r\n```\r\n\r\n**Expected behavior**\r\nTraining of the model to the default `100` epochs\r\n\r\n**Environment (please complete the following information):**\r\nI used this in colab for this\r\n\r\nHow i installed the packages:\r\n```\r\n!pip install torch==1.4.0+cu100 -f https://download.pytorch.org/whl/torch_stable.html\r\n!pip install --upgrade git+https://github.com/flairNLP/flair.git\r\n```", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1562/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1562/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1559", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1559/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1559/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1559/events", "html_url": "https://github.com/flairNLP/flair/issues/1559", "id": 608962376, "node_id": "MDU6SXNzdWU2MDg5NjIzNzY=", "number": 1559, "title": "Embedding Dataloader's workers are out of shared memory", "user": {"login": "otahmasebi", "id": 13538735, "node_id": "MDQ6VXNlcjEzNTM4NzM1", "avatar_url": "https://avatars.githubusercontent.com/u/13538735?v=4", "gravatar_id": "", "url": "https://api.github.com/users/otahmasebi", "html_url": "https://github.com/otahmasebi", "followers_url": "https://api.github.com/users/otahmasebi/followers", "following_url": "https://api.github.com/users/otahmasebi/following{/other_user}", "gists_url": "https://api.github.com/users/otahmasebi/gists{/gist_id}", "starred_url": "https://api.github.com/users/otahmasebi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/otahmasebi/subscriptions", "organizations_url": "https://api.github.com/users/otahmasebi/orgs", "repos_url": "https://api.github.com/users/otahmasebi/repos", "events_url": "https://api.github.com/users/otahmasebi/events{/privacy}", "received_events_url": "https://api.github.com/users/otahmasebi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-04-29T10:58:05Z", "updated_at": "2020-09-05T17:11:25Z", "closed_at": "2020-09-05T17:11:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nAfter first epoch, training process killed by a kill signal and printed error msg was:\r\n\r\n> RuntimeError: DataLoader worker (pid 18801) is killed by signal: Bus error. \r\nIt is possible that dataloader's workers are out of shared memory. Please try to raise your shared memory limit. \r\n\r\nI set num_workers=2 and  I think 16G is enough space for shared memory. I started training again and this time I checked shared memory usage regularly. It seemed that there was a memory leak in /dev/shm directory.\r\n\r\n**Expected behavior**\r\nSomething that avoid memory leak.\r\n\r\n**Additional context**\r\nAfter a little research and googling, I realized that, this is a old and common bug in the Pytorch Dataloader and there is many issues about this bug. After some more research I found this solution https://discuss.pytorch.org/t/training-crashes-due-to-insufficient-shared-memory-shm-nn-dataparallel/26396/18 .\r\nI checked [`__getitem__`](https://github.com/flairNLP/flair/blob/818cb04767d9fc212932843ce23fa48978cc00ca/flair/trainers/language_model_trainer.py#L58)  method in [TextDataset](https://github.com/flairNLP/flair/blob/818cb04767d9fc212932843ce23fa48978cc00ca/flair/trainers/language_model_trainer.py#L25)  class and it returnes `torch.tensor`. So the explanations for the mentioned solution seem plausible. I haven't had time to implement this yet. But is there a simpler solution?!\r\n\r\n**Environment**\r\n- OS: Ubuntu 18.04\r\n- 32G RAM\r\n- GPU: Nvidia 2080 TI\r\n- Python 3.6\r\n- CUDA==10.2\r\n- torch==1.5.0\r\n- flair==0.4.5\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1559/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1559/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1539", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1539/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1539/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1539/events", "html_url": "https://github.com/flairNLP/flair/issues/1539", "id": 606034954, "node_id": "MDU6SXNzdWU2MDYwMzQ5NTQ=", "number": 1539, "title": "In param_selector.optimize, missing conjugate error when np.var is computed on GPU enabled machine", "user": {"login": "sankaran45", "id": 8388863, "node_id": "MDQ6VXNlcjgzODg4NjM=", "avatar_url": "https://avatars.githubusercontent.com/u/8388863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sankaran45", "html_url": "https://github.com/sankaran45", "followers_url": "https://api.github.com/users/sankaran45/followers", "following_url": "https://api.github.com/users/sankaran45/following{/other_user}", "gists_url": "https://api.github.com/users/sankaran45/gists{/gist_id}", "starred_url": "https://api.github.com/users/sankaran45/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sankaran45/subscriptions", "organizations_url": "https://api.github.com/users/sankaran45/orgs", "repos_url": "https://api.github.com/users/sankaran45/repos", "events_url": "https://api.github.com/users/sankaran45/events{/privacy}", "received_events_url": "https://api.github.com/users/sankaran45/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-04-24T04:40:49Z", "updated_at": "2020-09-04T16:51:40Z", "closed_at": "2020-09-04T16:51:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am running a simple SequenceTaggerParameterSelector with a few hyperparameter choices and after the very first run, it fails in \r\n\r\nIn flair/hyperparameter/param_selection.py, param_selector.optimize, with np.var call failing.\r\n\r\nWhen i examined the error, it is in:\r\nvar = np.var(curr_scores)\r\ncontains a list of Tensor objects bound to cuda:0 in my case and np.var is unable to handle such Tensor types not bound to CPU.\r\n\r\nSo, I changed it to\r\nvar = np.var(list(map(lambda a: a.cpu(), curr_scores)))\r\n\r\nand it started working.\r\n\r\nMay be its already fixed, but just wanted to let know in case its not addressed yet.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1539/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1539/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1535", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1535/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1535/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1535/events", "html_url": "https://github.com/flairNLP/flair/issues/1535", "id": 603996408, "node_id": "MDU6SXNzdWU2MDM5OTY0MDg=", "number": 1535, "title": "WordEmbeddingsStore: fix error when flair.cache_root is not the default .flair directory", "user": {"login": "oterrier", "id": 8970395, "node_id": "MDQ6VXNlcjg5NzAzOTU=", "avatar_url": "https://avatars.githubusercontent.com/u/8970395?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oterrier", "html_url": "https://github.com/oterrier", "followers_url": "https://api.github.com/users/oterrier/followers", "following_url": "https://api.github.com/users/oterrier/following{/other_user}", "gists_url": "https://api.github.com/users/oterrier/gists{/gist_id}", "starred_url": "https://api.github.com/users/oterrier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oterrier/subscriptions", "organizations_url": "https://api.github.com/users/oterrier/orgs", "repos_url": "https://api.github.com/users/oterrier/repos", "events_url": "https://api.github.com/users/oterrier/events{/privacy}", "received_events_url": "https://api.github.com/users/oterrier/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-04-21T13:25:38Z", "updated_at": "2020-08-26T15:27:05Z", "closed_at": "2020-08-26T15:27:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "Robustify the code of WordEmbeddingsStore, manage error cases:\r\n- when location of cache_root is not the default one\r\n- fallback to WordEmbedding when the database (sqlite or lmdb) is not found\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1535/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1535/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1529", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1529/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1529/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1529/events", "html_url": "https://github.com/flairNLP/flair/issues/1529", "id": 602822418, "node_id": "MDU6SXNzdWU2MDI4MjI0MTg=", "number": 1529, "title": "Trapped in an infinite loop in the to_original_text method", "user": {"login": "psorianom", "id": 1085210, "node_id": "MDQ6VXNlcjEwODUyMTA=", "avatar_url": "https://avatars.githubusercontent.com/u/1085210?v=4", "gravatar_id": "", "url": "https://api.github.com/users/psorianom", "html_url": "https://github.com/psorianom", "followers_url": "https://api.github.com/users/psorianom/followers", "following_url": "https://api.github.com/users/psorianom/following{/other_user}", "gists_url": "https://api.github.com/users/psorianom/gists{/gist_id}", "starred_url": "https://api.github.com/users/psorianom/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/psorianom/subscriptions", "organizations_url": "https://api.github.com/users/psorianom/orgs", "repos_url": "https://api.github.com/users/psorianom/repos", "events_url": "https://api.github.com/users/psorianom/events{/privacy}", "received_events_url": "https://api.github.com/users/psorianom/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-04-19T21:18:07Z", "updated_at": "2021-10-03T11:54:35Z", "closed_at": "2020-05-10T17:27:58Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhen using a faulty tokenizer, producing faulty span indices, the `Sentence` class method\r\n`to_original_text`  is bound to enter an infinite loop. While we should not have faulty tokenizers, \r\nit may happen, as it happened to me. This error is related to this closed [PR](https://github.com/flairNLP/flair/issues/226).\r\nhttps://github.com/flairNLP/flair/blob/dfa3fbfbc4d8ec237012a800415d1098abdb1aa4/flair/data.py#L406\r\n**To Reproduce**\r\nSteps to reproduce the behaviour (e.g. which model did you train? what parameters did you use? etc.).\r\n```python\r\n# Given a list of tokens\r\n# We simulate a faulty tokenizer by using wrong spans. (_execution_ `start_position` is wrong).\r\n# This faulty tokenizer may be used via a `build_faulty_tokenizer wrapper`,\r\n# such as the one for spacy.\r\nlist_tokens = [Token(\"de\", start_position=0), Token(\"pourvoir\", start_position=3), \r\nToken(\"\u00e0\", start_position=12), Token(\"l&apos;\", start_position=14), \r\nToken(\"execution\", start_position=16), Token(\"de\", start_position=32)]\r\ns = Sentence()\r\nfor token in list_tokens:\r\n    s.add_token(token)\r\n\r\n# We are now trapped in an infinite loop\r\nprint(s.to_original_text())\r\n```\r\n**Expected behaviour**\r\nPossibly an error/warning telling me that my tokenizer is faulty. Another solution would be to check if the `start_pos` is actually bigger, and not only different, than the `pos` counter, as below.\r\nThis may produce extra spaces not existent in the original phrase though.\r\n(`pytest tests/test_data.py::test_token_indices` still passes)\r\n```python\r\nfor t in self.tokens:\r\n            while t.start_pos > pos: \r\n                str += \" \"\r\n                pos += 1\r\n``` \r\n[Here](https://github.com/flairNLP/flair/compare/master...psorianom:original_text_infinite_loop) is a branch with this modif.\r\n\r\n**Environment (please complete the following information):**\r\n - OS Linux\r\n - Version flair-0.4.5\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1529/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1529/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1528", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1528/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1528/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1528/events", "html_url": "https://github.com/flairNLP/flair/issues/1528", "id": 602512351, "node_id": "MDU6SXNzdWU2MDI1MTIzNTE=", "number": 1528, "title": "Flair doesn't work correctly with CPU optimised torch for linux", "user": {"login": "kislerdm", "id": 13434797, "node_id": "MDQ6VXNlcjEzNDM0Nzk3", "avatar_url": "https://avatars.githubusercontent.com/u/13434797?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kislerdm", "html_url": "https://github.com/kislerdm", "followers_url": "https://api.github.com/users/kislerdm/followers", "following_url": "https://api.github.com/users/kislerdm/following{/other_user}", "gists_url": "https://api.github.com/users/kislerdm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kislerdm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kislerdm/subscriptions", "organizations_url": "https://api.github.com/users/kislerdm/orgs", "repos_url": "https://api.github.com/users/kislerdm/repos", "events_url": "https://api.github.com/users/kislerdm/events{/privacy}", "received_events_url": "https://api.github.com/users/kislerdm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-04-18T17:41:35Z", "updated_at": "2020-05-24T13:07:09Z", "closed_at": "2020-05-24T13:07:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Description**\r\n\r\nError when calling the method **_apply** of the class **flair.models.language_model.LanguageModel**:\r\n\r\n```bash\r\n/usr/local/lib/python3.8/site-packages/flair/models/language_model.py in <genexpr>(.0)\r\n    391 \r\n    392     def _apply(self, fn):\r\n--> 393         major, minor, build, *_ = (int(info)\r\n    394                                 for info in torch.__version__.split('.'))\r\n    395 \r\n\r\nValueError: invalid literal for int() with base 10: '0+cpu'\r\n```\r\n\r\nIt is blocking functionality of the library when it comes to *embeddings*, or *language_model* definition.\r\n\r\n**Error cause**\r\n\r\nError is caused by parsing torch version (see the line *394* of the module *flair.models.language_model.py*). It fails when a CPU specific torch version is being used. For example, the CPU optimised version of torch-1.4.0 for linux (available [here](https://download.pytorch.org/whl/cpu/torch-1.4.0%2Bcpu-cp38-cp38-linux_x86_64.whl)) has `__versions__ = '1.4.0+cpu'`.\r\n\r\n**Solution proposal**\r\n\r\n*Status quo*:\r\n```python\r\ndef _apply(self, fn):\r\n        major, minor, build, *_ = (int(info)\r\n                                for info in torch.__version__.split('.'))\r\n```\r\n\r\n*Fix*:\r\n```python\r\ndef _apply(self, fn):\r\n        major, minor, *_ = (int(info) for info in torch.__version__.split('.')[:-1])\r\n```\r\n\r\nThe object `build` unpacked from the `torch.__version__` parsing result's tuple is not being used, ergo its removal would be a reasonable solution.\r\n\r\n**Environment:**\r\n - OS: linux debian 10 (base of the docker image `python:3.8.1-slim-buster`)\r\n - torch==1.4.0+cpu\r\n - flair==0.4.5\r\n\r\n**Instruction to reproduce**\r\n\r\nBuild the image, it will fail due described error.\r\n\r\n```Dockerfile\r\nFROM python:3.8.1-slim-buster AS base\r\n\r\nWORKDIR /\r\n\r\nRUN apt-get update -y \\\r\n  && pip install --upgrade pip \\\r\n  && pip install --no-cache-dir \"https://download.pytorch.org/whl/cpu/torch-1.4.0%2Bcpu-cp38-cp38-linux_x86_64.whl\" flair==0.4.5\r\n\r\nRUN python -c \"import flair; from flair.embeddings import StackedEmbeddings, FlairEmbeddings;\\\r\nembeddings = StackedEmbeddings([FlairEmbeddings('mix-forward')]);\r\n```", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1528/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1528/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1519", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1519/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1519/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1519/events", "html_url": "https://github.com/flairNLP/flair/issues/1519", "id": 596932595, "node_id": "MDU6SXNzdWU1OTY5MzI1OTU=", "number": 1519, "title": "Problem with max_sequence_length in BertEmbeddings", "user": {"login": "ayushjaiswal", "id": 1702663, "node_id": "MDQ6VXNlcjE3MDI2NjM=", "avatar_url": "https://avatars.githubusercontent.com/u/1702663?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ayushjaiswal", "html_url": "https://github.com/ayushjaiswal", "followers_url": "https://api.github.com/users/ayushjaiswal/followers", "following_url": "https://api.github.com/users/ayushjaiswal/following{/other_user}", "gists_url": "https://api.github.com/users/ayushjaiswal/gists{/gist_id}", "starred_url": "https://api.github.com/users/ayushjaiswal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ayushjaiswal/subscriptions", "organizations_url": "https://api.github.com/users/ayushjaiswal/orgs", "repos_url": "https://api.github.com/users/ayushjaiswal/repos", "events_url": "https://api.github.com/users/ayushjaiswal/events{/privacy}", "received_events_url": "https://api.github.com/users/ayushjaiswal/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2020-04-09T00:01:05Z", "updated_at": "2020-06-10T09:50:27Z", "closed_at": "2020-06-10T09:50:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "Currently, `BertEmbeddings` does not account for the maximum sequence length supported by the underlying (`transformers`) `BertModel`. Since BERT creates subtokens, it becomes somewhat challenging to check sequence-length and trim sentence externally before feeding it to `BertEmbeddings` in `flair`.\r\n\r\nI see a problem in https://github.com/flairNLP/flair/blob/master/flair/embeddings.py#L2678--L2687\r\n\r\n```python\r\n        # first, find longest sentence in batch\r\n        longest_sentence_in_batch: int = len(\r\n            max(\r\n                [\r\n                    self.tokenizer.tokenize(sentence.to_tokenized_string())\r\n                    for sentence in sentences\r\n                ],\r\n                key=len,\r\n            )\r\n        )\r\n```\r\n\r\nThis is passed to \r\n```python\r\n        # prepare id maps for BERT model\r\n        features = self._convert_sentences_to_features(\r\n            sentences, longest_sentence_in_batch\r\n        )\r\n```\r\nwhich sets `max_sequence_length` in: \r\n\r\nhttps://github.com/flairNLP/flair/blob/master/flair/embeddings.py#L2620-L2622\r\n```python\r\n    _convert_sentences_to_features(\r\n        self, sentences, max_sequence_length: int\r\n    )\r\n````\r\n\r\nBut this does not account for or check the max-sequence-length supported by the BERT model, which is accessible in either of the above functions through ` self.model.config.max_position_embeddings`.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1519/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1519/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1498", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1498/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1498/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1498/events", "html_url": "https://github.com/flairNLP/flair/issues/1498", "id": 589702275, "node_id": "MDU6SXNzdWU1ODk3MDIyNzU=", "number": 1498, "title": "TypeError: add_label() missing 1 required positional argument: 'value' for make_label_dictionary() in CSVClassificationCorpus", "user": {"login": "mossadhelali", "id": 56701763, "node_id": "MDQ6VXNlcjU2NzAxNzYz", "avatar_url": "https://avatars.githubusercontent.com/u/56701763?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mossadhelali", "html_url": "https://github.com/mossadhelali", "followers_url": "https://api.github.com/users/mossadhelali/followers", "following_url": "https://api.github.com/users/mossadhelali/following{/other_user}", "gists_url": "https://api.github.com/users/mossadhelali/gists{/gist_id}", "starred_url": "https://api.github.com/users/mossadhelali/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mossadhelali/subscriptions", "organizations_url": "https://api.github.com/users/mossadhelali/orgs", "repos_url": "https://api.github.com/users/mossadhelali/repos", "events_url": "https://api.github.com/users/mossadhelali/events{/privacy}", "received_events_url": "https://api.github.com/users/mossadhelali/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-03-29T02:39:08Z", "updated_at": "2020-03-29T12:34:02Z", "closed_at": "2020-03-29T09:16:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n\r\nThe system throws an error at line 909 in datasets.py because sentence.add_label() is missing the label_type argument.\r\nThis happens when in_memory=False\r\n\r\n**To Reproduce**\r\n1. Make a CSVClassificationDataset corpus with in_memory=False\r\n2. run corpus.make_label_dictionary('label_type')\r\n\r\n\r\n**Environment (please complete the following information):**\r\n- latest flair version installed with `pip install --upgrade git+https://github.com/zalandoresearch/flair.git`\r\n-pytorch 1.4\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1498/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1498/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1496", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1496/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1496/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1496/events", "html_url": "https://github.com/flairNLP/flair/issues/1496", "id": 588560290, "node_id": "MDU6SXNzdWU1ODg1NjAyOTA=", "number": 1496, "title": "RuntimeError: Expected object of backend CUDA but got backend CPU", "user": {"login": "MarcelCode", "id": 42996815, "node_id": "MDQ6VXNlcjQyOTk2ODE1", "avatar_url": "https://avatars.githubusercontent.com/u/42996815?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarcelCode", "html_url": "https://github.com/MarcelCode", "followers_url": "https://api.github.com/users/MarcelCode/followers", "following_url": "https://api.github.com/users/MarcelCode/following{/other_user}", "gists_url": "https://api.github.com/users/MarcelCode/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarcelCode/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarcelCode/subscriptions", "organizations_url": "https://api.github.com/users/MarcelCode/orgs", "repos_url": "https://api.github.com/users/MarcelCode/repos", "events_url": "https://api.github.com/users/MarcelCode/events{/privacy}", "received_events_url": "https://api.github.com/users/MarcelCode/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-03-26T16:38:06Z", "updated_at": "2020-03-29T11:19:34Z", "closed_at": "2020-03-29T11:19:34Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n\r\n```\r\n/usr/local/lib/python3.6/dist-packages/flair/embeddings.py in embed(self, sentences)\r\n\r\n   3149                 )\r\n   3150 \r\n-> 3151             word_embeddings_tensor = torch.cat(word_embeddings, 0).to(flair.device)\r\n   3152 \r\n   3153             sentence_states = word_embeddings_tensor\r\n\r\nRuntimeError: Expected object of backend CUDA but got backend CPU for sequence element 61 in sequence argument at position #1 'tensors'\r\n```\r\n\r\n**To Reproduce**\r\nI used Google Colab and followed the tutorial you linked on your website:\r\n[How to build a text classifier with Flair](https://towardsdatascience.com/text-classification-with-state-of-the-art-nlp-library-flair-b541d7add21f)\r\n\r\nYou can use this Notebook for testing: \r\n[jupyter notebook](https://colab.research.google.com/drive/13n-nGSHdNDpNbX0Ndz5-83uWNmeGhOAD)\r\n\r\nFor the dataset:\r\nYou can download it [here](https://www.kaggle.com/uciml/sms-spam-collection-dataset) \r\n\r\n\r\n**Expected behavior**\r\nI expect it to run and it should create a file called \"best-model.pt\"\r\n\r\n**Environment (please complete the following information):**\r\n - Google Colab\r\n - Version: 'flair-0.4.5'\r\n\r\nIt would be really nice if someone could help me. I want to compare different frameworks and do not have a gpu at home.\r\nThanks in Advance!\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1496/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1496/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1483", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1483/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1483/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1483/events", "html_url": "https://github.com/flairNLP/flair/issues/1483", "id": 585325506, "node_id": "MDU6SXNzdWU1ODUzMjU1MDY=", "number": 1483, "title": "Exported model picking user path of machine it was trained on", "user": {"login": "abhisaarsharma", "id": 6952564, "node_id": "MDQ6VXNlcjY5NTI1NjQ=", "avatar_url": "https://avatars.githubusercontent.com/u/6952564?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abhisaarsharma", "html_url": "https://github.com/abhisaarsharma", "followers_url": "https://api.github.com/users/abhisaarsharma/followers", "following_url": "https://api.github.com/users/abhisaarsharma/following{/other_user}", "gists_url": "https://api.github.com/users/abhisaarsharma/gists{/gist_id}", "starred_url": "https://api.github.com/users/abhisaarsharma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abhisaarsharma/subscriptions", "organizations_url": "https://api.github.com/users/abhisaarsharma/orgs", "repos_url": "https://api.github.com/users/abhisaarsharma/repos", "events_url": "https://api.github.com/users/abhisaarsharma/events{/privacy}", "received_events_url": "https://api.github.com/users/abhisaarsharma/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-03-20T21:01:55Z", "updated_at": "2020-08-12T14:02:24Z", "closed_at": "2020-08-12T14:02:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am training a model on a machine and doing inference on another machine. It is a SequenceTagger model consisting of only BytepairEmbeddings in the stacked embedding. \r\n\r\nThe machine i trained the model on has my username 'abhissha-new' and the machine i am trying to do inference on has my username 'abhisaar'. When i export the model and try to do inference, somehow flair is trying to look for downloaded BPE at my other machine's username home folder. This issue is only happening for byte pair embeddings. \r\n\r\nTemporary workaround of course is just making my original username folder on my inference machine but that is inconvinient. Attached stack trace.\r\n\r\n**To Reproduce**\r\nTrain a model on one machine and infer it on another machine with a different username.\r\n\r\n```\r\n2020-03-20 13:32:20,184 loading file /home/abhisaar/Downloads/final-model8.pt\r\ndownloading https://nlp.h-its.org/bpemb/en/en.wiki.bpe.vs100000.model\r\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1987533/1987533 [00:01<00:00, 1082354.99B/s]\r\n---------------------------------------------------------------------------\r\nFileNotFoundError                         Traceback (most recent call last)\r\n/usr/lib/python3.6/pathlib.py in mkdir(self, mode, parents, exist_ok)\r\n   1247         try:\r\n-> 1248             self._accessor.mkdir(self, mode)\r\n   1249         except FileNotFoundError:\r\n\r\n/usr/lib/python3.6/pathlib.py in wrapped(pathobj, *args)\r\n    386         def wrapped(pathobj, *args):\r\n--> 387             return strfunc(str(pathobj), *args)\r\n    388         return staticmethod(wrapped)\r\n\r\nFileNotFoundError: [Errno 2] **No such file or directory: '/home/abhissha-new/.flair/embeddings/en'**\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nFileNotFoundError                         Traceback (most recent call last)\r\n/usr/lib/python3.6/pathlib.py in mkdir(self, mode, parents, exist_ok)\r\n   1247         try:\r\n-> 1248             self._accessor.mkdir(self, mode)\r\n   1249         except FileNotFoundError:\r\n\r\n/usr/lib/python3.6/pathlib.py in wrapped(pathobj, *args)\r\n    386         def wrapped(pathobj, *args):\r\n--> 387             return strfunc(str(pathobj), *args)\r\n    388         return staticmethod(wrapped)\r\n\r\nFileNotFoundError: [Errno 2] No such file or directory: '/home/abhissha-new/.flair/embeddings'\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nFileNotFoundError                         Traceback (most recent call last)\r\n/usr/lib/python3.6/pathlib.py in mkdir(self, mode, parents, exist_ok)\r\n   1247         try:\r\n-> 1248             self._accessor.mkdir(self, mode)\r\n   1249         except FileNotFoundError:\r\n\r\n/usr/lib/python3.6/pathlib.py in wrapped(pathobj, *args)\r\n    386         def wrapped(pathobj, *args):\r\n--> 387             return strfunc(str(pathobj), *args)\r\n    388         return staticmethod(wrapped)\r\n\r\nFileNotFoundError: [Errno 2] No such file or directory: '/home/abhissha-new/.flair'\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nPermissionError                           Traceback (most recent call last)\r\n<ipython-input-4-b077ce389efe> in <module>()\r\n      1 from flair.models import SequenceTagger\r\n----> 2 model = SequenceTagger.load('/home/abhisaar/Downloads/final-model8.pt')\r\n\r\n/home/abhisaar/.local/lib/python3.6/site-packages/flair/nn.py in load(cls, model)\r\n     84             # see https://github.com/zalandoresearch/flair/issues/351\r\n     85             f = file_utils.load_big_file(str(model_file))\r\n---> 86             state = torch.load(f, map_location=flair.device)\r\n     87 \r\n     88         model = cls._init_model_with_state_dict(state)\r\n\r\n/home/abhisaar/.local/lib/python3.6/site-packages/torch/serialization.py in load(f, map_location, pickle_module, **pickle_load_args)\r\n    527             with _open_zipfile_reader(f) as opened_zipfile:\r\n    528                 return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)\r\n--> 529         return _legacy_load(opened_file, map_location, pickle_module, **pickle_load_args)\r\n    530 \r\n    531 \r\n\r\n/home/abhisaar/.local/lib/python3.6/site-packages/torch/serialization.py in _legacy_load(f, map_location, pickle_module, **pickle_load_args)\r\n    700     unpickler = pickle_module.Unpickler(f, **pickle_load_args)\r\n    701     unpickler.persistent_load = persistent_load\r\n--> 702     result = unpickler.load()\r\n    703 \r\n    704     deserialized_storage_keys = pickle_module.load(f, **pickle_load_args)\r\n\r\n/home/abhisaar/.local/lib/python3.6/site-packages/bpemb/bpemb.py in __setstate__(self, state)\r\n    452             model_rel_path = Path(state[\"lang\"]) / model_file.name\r\n    453             model_file = self._load_file(\r\n--> 454                 str(model_rel_path), cache_dir=state[\"cache_dir\"])\r\n    455         state['spm'] = sentencepiece_load(model_file)\r\n    456         self.__dict__ = state\r\n\r\n/home/abhisaar/.local/lib/python3.6/site-packages/bpemb/bpemb.py in _load_file(self, file, archive, cache_dir)\r\n    194         file_url = self.base_url + file + suffix\r\n    195         print(\"downloading\", file_url)\r\n--> 196         return http_get(file_url, cached_file, ignore_tardir=True)\r\n    197 \r\n    198     def __repr__(self):\r\n\r\n/home/abhisaar/.local/lib/python3.6/site-packages/bpemb/util.py in http_get(url, outfile, ignore_tardir)\r\n     43         # shutil.copyfileobj() starts at current position, so go to the start\r\n     44         temp_file.seek(0)\r\n---> 45         outfile.parent.mkdir(exist_ok=True, parents=True)\r\n     46         if headers.get(\"Content-Type\") == \"application/x-gzip\":\r\n     47             import tarfile\r\n\r\n/usr/lib/python3.6/pathlib.py in mkdir(self, mode, parents, exist_ok)\r\n   1250             if not parents or self.parent == self:\r\n   1251                 raise\r\n-> 1252             self.parent.mkdir(parents=True, exist_ok=True)\r\n   1253             self.mkdir(mode, parents=False, exist_ok=exist_ok)\r\n   1254         except OSError:\r\n\r\n/usr/lib/python3.6/pathlib.py in mkdir(self, mode, parents, exist_ok)\r\n   1250             if not parents or self.parent == self:\r\n   1251                 raise\r\n-> 1252             self.parent.mkdir(parents=True, exist_ok=True)\r\n   1253             self.mkdir(mode, parents=False, exist_ok=exist_ok)\r\n   1254         except OSError:\r\n\r\n/usr/lib/python3.6/pathlib.py in mkdir(self, mode, parents, exist_ok)\r\n   1250             if not parents or self.parent == self:\r\n   1251                 raise\r\n-> 1252             self.parent.mkdir(parents=True, exist_ok=True)\r\n   1253             self.mkdir(mode, parents=False, exist_ok=exist_ok)\r\n   1254         except OSError:\r\n\r\n/usr/lib/python3.6/pathlib.py in mkdir(self, mode, parents, exist_ok)\r\n   1246             self._raise_closed()\r\n   1247         try:\r\n-> 1248             self._accessor.mkdir(self, mode)\r\n   1249         except FileNotFoundError:\r\n   1250             if not parents or self.parent == self:\r\n\r\n/usr/lib/python3.6/pathlib.py in wrapped(pathobj, *args)\r\n    385         @functools.wraps(strfunc)\r\n    386         def wrapped(pathobj, *args):\r\n--> 387             return strfunc(str(pathobj), *args)\r\n    388         return staticmethod(wrapped)\r\n    389 \r\n\r\nPermissionError: [Errno 13] Permission denied: '/home/abhissha-new'\r\n```\r\n\r\n\r\n\r\n\r\n**Expected behavior**\r\nModel loads correctly\r\n\r\n**Environment (please complete the following information):**\r\n - OS [Ubuntu]:\r\n - Version [flair-0.4.5, torch 1.4.0]\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1483/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1483/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1482", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1482/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1482/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1482/events", "html_url": "https://github.com/flairNLP/flair/issues/1482", "id": 584889032, "node_id": "MDU6SXNzdWU1ODQ4ODkwMzI=", "number": 1482, "title": "free gpu cache to do prediction for multiple time", "user": {"login": "prakashwarbler", "id": 60729178, "node_id": "MDQ6VXNlcjYwNzI5MTc4", "avatar_url": "https://avatars.githubusercontent.com/u/60729178?v=4", "gravatar_id": "", "url": "https://api.github.com/users/prakashwarbler", "html_url": "https://github.com/prakashwarbler", "followers_url": "https://api.github.com/users/prakashwarbler/followers", "following_url": "https://api.github.com/users/prakashwarbler/following{/other_user}", "gists_url": "https://api.github.com/users/prakashwarbler/gists{/gist_id}", "starred_url": "https://api.github.com/users/prakashwarbler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/prakashwarbler/subscriptions", "organizations_url": "https://api.github.com/users/prakashwarbler/orgs", "repos_url": "https://api.github.com/users/prakashwarbler/repos", "events_url": "https://api.github.com/users/prakashwarbler/events{/privacy}", "received_events_url": "https://api.github.com/users/prakashwarbler/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-03-20T07:27:55Z", "updated_at": "2020-07-25T08:22:57Z", "closed_at": "2020-07-25T08:22:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "**this is the code i have tried to run the prediction on text file.** \r\nfrom flair.data import Sentence\r\nfrom flair.models import SequenceTagger\r\ntagger: SequenceTagger = SequenceTagger.load('models_file_aws/best_model-elmo-flair-11-24-19-3-2020.pt')\r\nwith open(\"flairdata/cust_test.txt\",\"r\",encoding=\"utf-8\") as cust:\r\n    for line in cust:\r\n        sentence: Sentence = Sentence(line)\r\n        tagger.predict(sentence)\r\n        print(\"Analysing %s\" % sentence)\r\n        [print(entity) for entity in sentence.get_spans('ner')]\r\n\r\n\r\n**when try for more than once I get cuda out of memory: error given below**\r\n2020-03-20 12:32:45,903 loading file models_file_aws/best_model-elmo-flair-11-24-19-3-2020.pt\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-11-d1d521d3c925> in <module>\r\n      3 import torch\r\n      4 torch.cuda.empty_cache()\r\n----> 5 tagger: SequenceTagger = SequenceTagger.load('models_file_aws/best_model-elmo-flair-11-24-19-3-2020.pt')\r\n      6 with open(\"flairdata/cust_test.txt\",\"r\",encoding=\"utf-8\") as cust:\r\n      7     for line in cust:\r\n\r\n~\\Anaconda3\\envs\\flair\\lib\\site-packages\\flair\\nn.py in load(cls, model)\r\n     84             # see https://github.com/zalandoresearch/flair/issues/351\r\n     85             f = file_utils.load_big_file(str(model_file))\r\n---> 86             state = torch.load(f, map_location=flair.device)\r\n     87 \r\n     88         model = cls._init_model_with_state_dict(state)\r\n\r\n~\\Anaconda3\\envs\\flair\\lib\\site-packages\\torch\\serialization.py in load(f, map_location, pickle_module, **pickle_load_args)\r\n    527             with _open_zipfile_reader(f) as opened_zipfile:\r\n    528                 return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)\r\n--> 529         return _legacy_load(opened_file, map_location, pickle_module, **pickle_load_args)\r\n    530 \r\n    531 \r\n\r\n~\\Anaconda3\\envs\\flair\\lib\\site-packages\\torch\\serialization.py in _legacy_load(f, map_location, pickle_module, **pickle_load_args)\r\n    700     unpickler = pickle_module.Unpickler(f, **pickle_load_args)\r\n    701     unpickler.persistent_load = persistent_load\r\n--> 702     result = unpickler.load()\r\n    703 \r\n    704     deserialized_storage_keys = pickle_module.load(f, **pickle_load_args)\r\n\r\n~\\Anaconda3\\envs\\flair\\lib\\site-packages\\torch\\serialization.py in persistent_load(saved_id)\r\n    663                 obj = data_type(size)\r\n    664                 obj._torch_load_uninitialized = True\r\n--> 665                 deserialized_objects[root_key] = restore_location(obj, location)\r\n    666             storage = deserialized_objects[root_key]\r\n    667             if view_metadata is not None:\r\n\r\n~\\Anaconda3\\envs\\flair\\lib\\site-packages\\torch\\serialization.py in restore_location(storage, location)\r\n    738     elif isinstance(map_location, torch.device):\r\n    739         def restore_location(storage, location):\r\n--> 740             return default_restore_location(storage, str(map_location))\r\n    741     else:\r\n    742         def restore_location(storage, location):\r\n\r\n~\\Anaconda3\\envs\\flair\\lib\\site-packages\\torch\\serialization.py in default_restore_location(storage, location)\r\n    154 def default_restore_location(storage, location):\r\n    155     for _, _, fn in _package_registry:\r\n--> 156         result = fn(storage, location)\r\n    157         if result is not None:\r\n    158             return result\r\n\r\n~\\Anaconda3\\envs\\flair\\lib\\site-packages\\torch\\serialization.py in _cuda_deserialize(obj, location)\r\n    134             storage_type = getattr(torch.cuda, type(obj).__name__)\r\n    135             with torch.cuda.device(device):\r\n--> 136                 return storage_type(obj.size())\r\n    137         else:\r\n    138             return obj.cuda(device)\r\n\r\n~\\Anaconda3\\envs\\flair\\lib\\site-packages\\torch\\cuda\\__init__.py in _lazy_new(cls, *args, **kwargs)\r\n    478     # We may need to call lazy init again if we are a forked child\r\n    479     # del _CudaBase.__new__\r\n--> 480     return super(_CudaBase, cls).__new__(cls, *args, **kwargs)\r\n    481 \r\n    482 \r\n\r\nRuntimeError: CUDA out of memory. Tried to allocate 68.00 MiB (GPU 0; 4.00 GiB total capacity; 2.67 GiB already allocated; 10.20 MiB free; 2.68 GiB reserved in total by PyTorch)\r\n**I have tried torch.cuda.empty_cache() to clear the cache.**\r\nbut no use of it. only if i restart the kernal in jupyter notebook or jupyter notebook  cuda memory has been cleared and allowed to run one prediction. \r\n\r\nhow to solve this bug issue. model size is 900+ mb (ELMO+FLAIR embedding).\r\nand is there any way to reduce the size of the model. is pytorch has  post - training optimisation process like quantization process in tensorflow?? if so please let me know how to do it. or you can give us guide to approach this issue. \r\n\r\nif you could respond asap that will really grateful.  \r\nthanks for your support and guidance.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1482/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1482/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1470", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1470/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1470/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1470/events", "html_url": "https://github.com/flairNLP/flair/issues/1470", "id": 578197296, "node_id": "MDU6SXNzdWU1NzgxOTcyOTY=", "number": 1470, "title": "Can't run PooledFlairEmbeddings  - unexpected keyword argument 'pool'", "user": {"login": "abhisaarsharma", "id": 6952564, "node_id": "MDQ6VXNlcjY5NTI1NjQ=", "avatar_url": "https://avatars.githubusercontent.com/u/6952564?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abhisaarsharma", "html_url": "https://github.com/abhisaarsharma", "followers_url": "https://api.github.com/users/abhisaarsharma/followers", "following_url": "https://api.github.com/users/abhisaarsharma/following{/other_user}", "gists_url": "https://api.github.com/users/abhisaarsharma/gists{/gist_id}", "starred_url": "https://api.github.com/users/abhisaarsharma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abhisaarsharma/subscriptions", "organizations_url": "https://api.github.com/users/abhisaarsharma/orgs", "repos_url": "https://api.github.com/users/abhisaarsharma/repos", "events_url": "https://api.github.com/users/abhisaarsharma/events{/privacy}", "received_events_url": "https://api.github.com/users/abhisaarsharma/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-03-09T21:18:53Z", "updated_at": "2020-03-16T22:17:01Z", "closed_at": "2020-03-09T23:26:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI ran into the 'cpu+0' issue described [here](https://github.com/flairNLP/flair/issues/1388) and i did pip install --upgrade git+https://github.com/flairNLP/flair.git so i am on the latest flair version. I am trying to reproduce the state of the art NER results but the given examples are not running.\r\n\r\n**To Reproduce**\r\nRun the [CoNLL-03 Named Entity Recognition (Dutch)](https://github.com/flairNLP/flair/blob/master/resources/docs/EXPERIMENTS.md)  example\r\n\r\n\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-7-8f56cacc0e14> in <module>\r\n     16 embedding_types: List[TokenEmbeddings] = [\r\n     17     WordEmbeddings('nl'),\r\n---> 18     PooledFlairEmbeddings('dutch-forward', pool='mean'),\r\n     19     PooledFlairEmbeddings('dutch-backward', pool='mean'),\r\n     20 ]\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\lib\\site-packages\\flair\\embeddings.py in __init__(self, contextual_embeddings, pooling, only_capitalized, **kwargs)\r\n   2107         if type(contextual_embeddings) is str:\r\n   2108             self.context_embeddings: FlairEmbeddings = FlairEmbeddings(\r\n-> 2109                 contextual_embeddings, **kwargs\r\n   2110             )\r\n   2111         else:\r\n\r\nTypeError: __init__() got an unexpected keyword argument 'pool'\r\n\r\n\r\n**Expected behavior**\r\nExpected behavior is reproducing the SOTA results.\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [Windows]:\r\n - Version [flair-0.4.5, torch 1.4.0]\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1470/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1470/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1469", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1469/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1469/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1469/events", "html_url": "https://github.com/flairNLP/flair/issues/1469", "id": 577690480, "node_id": "MDU6SXNzdWU1Nzc2OTA0ODA=", "number": 1469, "title": "Error: \"SyntaxError: invalid syntax File \"/usr/local/lib/python3.5/dist-packages/flair/data.py\", line 25 \"", "user": {"login": "Ganeshpadmanaban", "id": 29490672, "node_id": "MDQ6VXNlcjI5NDkwNjcy", "avatar_url": "https://avatars.githubusercontent.com/u/29490672?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ganeshpadmanaban", "html_url": "https://github.com/Ganeshpadmanaban", "followers_url": "https://api.github.com/users/Ganeshpadmanaban/followers", "following_url": "https://api.github.com/users/Ganeshpadmanaban/following{/other_user}", "gists_url": "https://api.github.com/users/Ganeshpadmanaban/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ganeshpadmanaban/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ganeshpadmanaban/subscriptions", "organizations_url": "https://api.github.com/users/Ganeshpadmanaban/orgs", "repos_url": "https://api.github.com/users/Ganeshpadmanaban/repos", "events_url": "https://api.github.com/users/Ganeshpadmanaban/events{/privacy}", "received_events_url": "https://api.github.com/users/Ganeshpadmanaban/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-03-09T06:39:43Z", "updated_at": "2020-03-09T08:58:07Z", "closed_at": "2020-03-09T08:58:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nBelow error thrown\r\nFile \"/usr/local/lib/python3.5/dist-packages/flair/data.py\", line 25\r\n self.item2idx: Dict[str, int] = {}\r\nSyntaxError: invalid syntax\r\n\r\n**To Reproduce**\r\nAfter building a docker image, I was trying to import the saved best model. The error was thrown during, from flair.models import TextClassifier\r\n\r\n**Expected behavior**\r\nImport the library\r\n\r\n**Screenshots**\r\n![image](https://user-images.githubusercontent.com/29490672/76188609-da35a380-61d8-11ea-8a39-a84dd041d46f.png)\r\n\r\n**Environment (please complete the following information):**\r\n - OS [Linux]:\r\n - Version [flair-0.4.1]:\r\n\r\n**Additional context**\r\nIt works fine in normal environment. Error thrown only in docker container.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1469/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1469/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1468", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1468/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1468/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1468/events", "html_url": "https://github.com/flairNLP/flair/issues/1468", "id": 577557808, "node_id": "MDU6SXNzdWU1Nzc1NTc4MDg=", "number": 1468, "title": "Error \"Unable to load weights from pytorch checkpoint \" when using custom   BertEmbeddings", "user": {"login": "abeermohamed1", "id": 20182641, "node_id": "MDQ6VXNlcjIwMTgyNjQx", "avatar_url": "https://avatars.githubusercontent.com/u/20182641?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abeermohamed1", "html_url": "https://github.com/abeermohamed1", "followers_url": "https://api.github.com/users/abeermohamed1/followers", "following_url": "https://api.github.com/users/abeermohamed1/following{/other_user}", "gists_url": "https://api.github.com/users/abeermohamed1/gists{/gist_id}", "starred_url": "https://api.github.com/users/abeermohamed1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abeermohamed1/subscriptions", "organizations_url": "https://api.github.com/users/abeermohamed1/orgs", "repos_url": "https://api.github.com/users/abeermohamed1/repos", "events_url": "https://api.github.com/users/abeermohamed1/events{/privacy}", "received_events_url": "https://api.github.com/users/abeermohamed1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-03-08T20:09:09Z", "updated_at": "2020-03-10T11:37:32Z", "closed_at": "2020-03-10T11:36:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nBelow error thrown \r\nOSError: Unable to load weights from pytorch checkpoint file. If you tried to load a PyTorch model from a TF 2.0 checkpoint, please set from_tf=True. \r\n\r\n**To Reproduce**\r\nuse the below\r\n    BertEmbeddings(data_folder+'/config.json', data_folder+'/pytorch_model.bin' ,  data_folder+'/vocab.txt'),\r\n\r\n\r\n\r\n**Additional context**\r\nUnpicklingError                           Traceback (most recent call last)\r\n/usr/local/lib/python3.6/dist-packages/transformers/modeling_utils.py in from_pretrained(cls, pretrained_model_name_or_path, *model_args, **kwargs)\r\n    469             try:\r\n--> 470                 state_dict = torch.load(resolved_archive_file, map_location=\"cpu\")\r\n    471             except Exception:\r\n\r\n4 frames\r\nUnpicklingError: invalid load key, '{'.\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nOSError                                   Traceback (most recent call last)\r\n/usr/local/lib/python3.6/dist-packages/transformers/modeling_utils.py in from_pretrained(cls, pretrained_model_name_or_path, *model_args, **kwargs)\r\n    471             except Exception:\r\n    472                 raise OSError(\r\n--> 473                     \"Unable to load weights from pytorch checkpoint file. \"\r\n    474                     \"If you tried to load a PyTorch model from a TF 2.0 checkpoint, please set from_tf=True. \"\r\n    475                 )\r\n\r\nOSError: Unable to load weights from pytorch checkpoint file. If you tried to load a PyTorch model from a TF 2.0 checkpoint, please set from_tf=True. ", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1468/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1468/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1466", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1466/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1466/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1466/events", "html_url": "https://github.com/flairNLP/flair/issues/1466", "id": 577047554, "node_id": "MDU6SXNzdWU1NzcwNDc1NTQ=", "number": 1466, "title": "Bert/Roberta Errors", "user": {"login": "kjans123", "id": 35381053, "node_id": "MDQ6VXNlcjM1MzgxMDUz", "avatar_url": "https://avatars.githubusercontent.com/u/35381053?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kjans123", "html_url": "https://github.com/kjans123", "followers_url": "https://api.github.com/users/kjans123/followers", "following_url": "https://api.github.com/users/kjans123/following{/other_user}", "gists_url": "https://api.github.com/users/kjans123/gists{/gist_id}", "starred_url": "https://api.github.com/users/kjans123/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kjans123/subscriptions", "organizations_url": "https://api.github.com/users/kjans123/orgs", "repos_url": "https://api.github.com/users/kjans123/repos", "events_url": "https://api.github.com/users/kjans123/events{/privacy}", "received_events_url": "https://api.github.com/users/kjans123/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-03-06T16:40:49Z", "updated_at": "2020-03-06T17:16:25Z", "closed_at": "2020-03-06T17:07:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "Anytime I try to document embed any Bert or Roberta word embedding, I receive CUDA errors. This is very similar to issue #1432 \r\n\r\nRelevant code is below:\r\n\r\n```\r\nword_embeddings = [XLMRobertaEmbeddings('xlm-roberta-large')]\r\n\r\ndocument_embeddings: DocumentRNNEmbeddings = DocumentRNNEmbeddings(word_embeddings,\r\n                                                                     hidden_size=512,\r\n                                                                     reproject_words=False,\r\n                                                                     reproject_words_dimension=512,\r\n                                                                       bidirectional=True,\r\n                                                                   )\r\n\r\n\r\nimport torch\r\nembeds = []\r\nfor ii,i in enumerate(df_c['CMR_TEXT'].values):\r\n    sent = Sentence(i)\r\n    embed = document_embeddings.embed(sent)\r\n\r\n    embeds.append(sent.get_embedding().cpu().data.numpy())\r\n    del sent\r\n    del embed\r\n    torch.cuda.empty_cache()\r\n    print(ii)\r\nembeds = np.array(embeds)\r\nnp.save('xlm-rob.npy',embeds)\r\n```\r\n\r\n\r\nWith Flair embeddings, the loop performs normally and I can save out any array of document embedding for use in another TF/Keras neural net.\r\n\r\nHere are the last few lines of the error trace:\r\n![image](https://user-images.githubusercontent.com/35381053/76102693-5e501700-5f9e-11ea-9577-afbb88791b2a.png)\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Windows 10 (Anaconda)\r\n - Version: flair 0.4.5\r\n\r\nI have tried this on two separate GPU's (1080 Ti and RTX 2080). Both give CUDA errors.\r\n\r\nThe loop works 12 times and then errors out, regardless if Bert or Roberta embeddings are used.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1466/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1466/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1465", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1465/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1465/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1465/events", "html_url": "https://github.com/flairNLP/flair/issues/1465", "id": 576783955, "node_id": "MDU6SXNzdWU1NzY3ODM5NTU=", "number": 1465, "title": "GUI not sending the correct path in video analysis", "user": {"login": "ghost", "id": 10137, "node_id": "MDQ6VXNlcjEwMTM3", "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ghost", "html_url": "https://github.com/ghost", "followers_url": "https://api.github.com/users/ghost/followers", "following_url": "https://api.github.com/users/ghost/following{/other_user}", "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}", "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ghost/subscriptions", "organizations_url": "https://api.github.com/users/ghost/orgs", "repos_url": "https://api.github.com/users/ghost/repos", "events_url": "https://api.github.com/users/ghost/events{/privacy}", "received_events_url": "https://api.github.com/users/ghost/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-03-06T08:49:55Z", "updated_at": "2020-03-16T22:20:12Z", "closed_at": "2020-03-16T22:20:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nlaunch_DLC\r\n\r\nafter training and evaluating network, seting video path\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior (e.g. which model did you train? what parameters did you use? etc.).\r\n\r\n\r\njust load the video in analyse_video tab\r\n**Expected behavior**\r\nA clear and concise description of what you expected to happen.\r\n\r\n**Screenshots**\r\n    128     start_path=os.getcwd() #record cwd to return to this directory in th\r\ne end\r\n    129\r\n--> 130     cfg = auxiliaryfunctions.read_config(config)\r\n    131     trainFraction = cfg['TrainingFraction'][trainingsetindex]\r\n    132\r\n\r\n~\\Anaconda3\\envs\\DLC-GPU\\lib\\site-packages\\deeplabcut\\utils\\auxiliaryfunctions.p\r\ny in read_config(configname)\r\n    111     \"\"\"\r\n    112     ruamelFile = ruamel.yaml.YAML()\r\n--> 113     path = Path(configname)\r\n    114     if os.path.exists(path):\r\n    115         try:\r\n\r\n~\\Anaconda3\\envs\\DLC-GPU\\lib\\pathlib.py in __new__(cls, *args, **kwargs)\r\n   1020         if cls is Path:\r\n   1021             cls = WindowsPath if os.name == 'nt' else PosixPath\r\n-> 1022         self = cls._from_parts(args, init=False)\r\n   1023         if not self._flavour.is_supported:\r\n   1024             raise NotImplementedError(\"cannot instantiate %r on your sys\r\ntem\"\r\n\r\n~\\Anaconda3\\envs\\DLC-GPU\\lib\\pathlib.py in _from_parts(cls, args, init)\r\n    667         # right flavour.\r\n    668         self = object.__new__(cls)\r\n--> 669         drv, root, parts = self._parse_args(args)\r\n    670         self._drv = drv\r\n    671         self._root = root\r\n\r\n~\\Anaconda3\\envs\\DLC-GPU\\lib\\pathlib.py in _parse_args(cls, args)\r\n    651                 parts += a._parts\r\n    652             else:\r\n--> 653                 a = os.fspath(a)\r\n    654                 if isinstance(a, str):\r\n    655                     # Force-cast str subclasses to str (issue #21127)\r\n\r\nTypeError: expected str, bytes or os.PathLike object, not list\r\n\r\n**Environment (please complete the following information):**\r\nwindows 7\r\n\r\n**Additional context**\r\nit is just a string problem c:\\\\blabla instead c:\\blabla\r\n\r\nthe non gui command works just fine\r\n\r\nIn [11]: deeplabcut.analyze_videos(cf,[v1], save_as_csv=True)\r\nUsing snapshot-100000 for model C:\\Users\\sanja\\Documents\\DLC\\r1-a1-2020-03-03\\dl\r\nc-models\\iteration-0\\r1Mar3-trainset95shuffle1\r\nInitializing ResNet\r\nINFO:tensorflow:Restoring parameters from C:\\Users\\sanja\\Documents\\DLC\\r1-a1-202\r\n0-03-03\\dlc-models\\iteration-0\\r1Mar3-trainset95shuffle1\\train\\snapshot-100000\r\nINFO:tensorflow:Restoring parameters from C:\\Users\\sanja\\Documents\\DLC\\r1-a1-202\r\n0-03-03\\dlc-models\\iteration-0\\r1Mar3-trainset95shuffle1\\train\\snapshot-100000\r\nStarting to analyze %  C:\\Users\\sanja\\Documents\\DLC\\64286.mp4\r\nLoading  C:\\Users\\sanja\\Documents\\DLC\\64286.mp4\r\nDuration of video [s]:  612.0 , recorded with  50.0 fps!\r\nOverall # of frames:  30600  found with (before cropping) frame dimensions:  192\r\n0 1080\r\nStarting to extract posture\r\n 27%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588?                           | 8262/30600 [15:25<49:29,  7.52it/s]\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1465/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1465/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1451", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1451/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1451/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1451/events", "html_url": "https://github.com/flairNLP/flair/issues/1451", "id": 569970066, "node_id": "MDU6SXNzdWU1Njk5NzAwNjY=", "number": 1451, "title": "Problematic usage of mmap in file_utils.load_big_file", "user": {"login": "ngoldbaum", "id": 3126246, "node_id": "MDQ6VXNlcjMxMjYyNDY=", "avatar_url": "https://avatars.githubusercontent.com/u/3126246?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ngoldbaum", "html_url": "https://github.com/ngoldbaum", "followers_url": "https://api.github.com/users/ngoldbaum/followers", "following_url": "https://api.github.com/users/ngoldbaum/following{/other_user}", "gists_url": "https://api.github.com/users/ngoldbaum/gists{/gist_id}", "starred_url": "https://api.github.com/users/ngoldbaum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ngoldbaum/subscriptions", "organizations_url": "https://api.github.com/users/ngoldbaum/orgs", "repos_url": "https://api.github.com/users/ngoldbaum/repos", "events_url": "https://api.github.com/users/ngoldbaum/events{/privacy}", "received_events_url": "https://api.github.com/users/ngoldbaum/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-02-24T16:27:00Z", "updated_at": "2020-06-30T17:41:33Z", "closed_at": "2020-06-30T17:41:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "Currently `file_units.load_big_file` returns an `mmap.mmap`, which is ultimately passed to `torch.load`:\r\n\r\nhttps://github.com/flairNLP/flair/blob/0e1a1823db663eaff5edfa0d59458f1b3543ff61/flair/file_utils.py#L25-L36\r\n\r\nhttps://github.com/flairNLP/flair/blob/1d44abf35f1122d1e146c9a219b2cb5f98b41b40/flair/nn.py#L85-L86\r\n\r\nOn Python 3.8.0 and 3.8.1, this usage [raises an exception](https://github.com/pytorch/pytorch/issues/32289), which was reported upstream to CPython as https://bugs.python.org/issue39681.\r\n\r\nIn the CPython bug, @pitrou pointed out that it will likely be faster and more efficient to wrap the `mmap.mmap` in a `memoryview`. It's also possible that support for loading a pickle file wrapped in an `mmap.mmap` will be removed in a future version of Python.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1451/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1451/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1444", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1444/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1444/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1444/events", "html_url": "https://github.com/flairNLP/flair/issues/1444", "id": 569525922, "node_id": "MDU6SXNzdWU1Njk1MjU5MjI=", "number": 1444, "title": "RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 15.75 GiB total capacity; 11.00 GiB already allocated; 2.88 MiB free; 14.69 GiB reserved in total by PyTorch)", "user": {"login": "kdk2612", "id": 26419445, "node_id": "MDQ6VXNlcjI2NDE5NDQ1", "avatar_url": "https://avatars.githubusercontent.com/u/26419445?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kdk2612", "html_url": "https://github.com/kdk2612", "followers_url": "https://api.github.com/users/kdk2612/followers", "following_url": "https://api.github.com/users/kdk2612/following{/other_user}", "gists_url": "https://api.github.com/users/kdk2612/gists{/gist_id}", "starred_url": "https://api.github.com/users/kdk2612/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kdk2612/subscriptions", "organizations_url": "https://api.github.com/users/kdk2612/orgs", "repos_url": "https://api.github.com/users/kdk2612/repos", "events_url": "https://api.github.com/users/kdk2612/events{/privacy}", "received_events_url": "https://api.github.com/users/kdk2612/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 14, "created_at": "2020-02-23T17:05:20Z", "updated_at": "2020-09-28T09:22:45Z", "closed_at": "2020-09-28T09:22:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nThe CUDA runs out of memory. I have tried the mentioned solution in the other similar issue. \r\nThe version of library installed is - 0.4.5 - master branch\r\npip install --upgrade git+https://github.com/zalandoresearch/flair.git\r\n\r\n```\r\n----------------------------------------------------------------------------------------------------\r\nModel: \"SequenceTagger(\r\n  (embeddings): StackedEmbeddings(\r\n    (list_embedding_0): FlairEmbeddings(\r\n      (lm): LanguageModel(\r\n        (drop): Dropout(p=0.1, inplace=False)\r\n        (encoder): Embedding(275, 100)\r\n        (rnn): LSTM(100, 128)\r\n        (decoder): Linear(in_features=128, out_features=275, bias=True)\r\n      )\r\n    )\r\n    (list_embedding_1): FlairEmbeddings(\r\n      (lm): LanguageModel(\r\n        (drop): Dropout(p=0.1, inplace=False)\r\n        (encoder): Embedding(275, 100)\r\n        (rnn): LSTM(100, 128)\r\n        (decoder): Linear(in_features=128, out_features=275, bias=True)\r\n      )\r\n    )\r\n  )\r\n  (word_dropout): WordDropout(p=0.05)\r\n  (locked_dropout): LockedDropout(p=0.5)\r\n  (embedding2nn): Linear(in_features=256, out_features=256, bias=True)\r\n  (rnn): LSTM(256, 256, batch_first=True, bidirectional=True)\r\n  (linear): Linear(in_features=512, out_features=30, bias=True)\r\n  (beta): 1.0\r\n  (weights): None\r\n  (weight_tensor) None\r\n)\"\r\n----------------------------------------------------------------------------------------------------\r\nCorpus: \"Corpus: 14098 train + 3021 dev + 3022 test sentences\"\r\n----------------------------------------------------------------------------------------------------\r\nParameters:\r\n - learning_rate: \"0.001\"\r\n - mini_batch_size: \"16\"\r\n - patience: \"3\"\r\n - anneal_factor: \"0.5\"\r\n - max_epochs: \"10\"\r\n - shuffle: \"True\"\r\n - train_with_dev: \"True\"\r\n - batch_growth_annealing: \"False\"\r\n----------------------------------------------------------------------------------------------------\r\nModel training base path: \"Flair/ner_model\"\r\n----------------------------------------------------------------------------------------------------\r\nDevice: cuda:0\r\n----------------------------------------------------------------------------------------------------\r\nEmbeddings storage mode: cpu\r\n----------------------------------------------------------------------------------------------------\r\nepoch 1 - iter 107/1070 - loss 594.20078684 - samples/sec: 7.06\r\nepoch 1 - iter 214/1070 - loss 503.68683268 - samples/sec: 7.40\r\nepoch 1 - iter 321/1070 - loss 430.24771304 - samples/sec: 6.74\r\nepoch 1 - iter 428/1070 - loss 374.14354688 - samples/sec: 6.83\r\nepoch 1 - iter 535/1070 - loss 331.84327782 - samples/sec: 6.92\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-10-8ba508100c66> in <module>()\r\n      7              monitor_test=True,\r\n      8              checkpoint=True,\r\n----> 9               train_with_dev=True)\r\n\r\n~/anaconda3/envs/python3/lib/python3.6/site-packages/flair/trainers/trainer.py in train(self, base_path, learning_rate, mini_batch_size, mini_batch_chunk_size, max_epochs, anneal_factor, patience, min_learning_rate, train_with_dev, monitor_train, monitor_test, embeddings_storage_mode, checkpoint, save_final_model, anneal_with_restarts, batch_growth_annealing, shuffle, param_selection_mode, num_workers, sampler, use_amp, amp_opt_level, eval_on_train_fraction, eval_on_train_shuffle, **kwargs)\r\n    329 \r\n    330                         # forward pass\r\n--> 331                         loss = self.model.forward_loss(batch_step)\r\n    332 \r\n    333                         # Backward\r\n\r\n~/anaconda3/envs/python3/lib/python3.6/site-packages/flair/models/sequence_tagger_model.py in forward_loss(self, data_points, sort)\r\n    492     ) -> torch.tensor:\r\n    493         features = self.forward(data_points)\r\n--> 494         return self._calculate_loss(features, data_points)\r\n    495 \r\n    496     def forward(self, sentences: List[Sentence]):\r\n\r\n~/anaconda3/envs/python3/lib/python3.6/site-packages/flair/models/sequence_tagger_model.py in _calculate_loss(self, features, sentences)\r\n    626             tags, _ = pad_tensors(tag_list)\r\n    627 \r\n--> 628             forward_score = self._forward_alg(features, lengths)\r\n    629             gold_score = self._score_sentence(features, tags, lengths)\r\n    630 \r\n\r\n~/anaconda3/envs/python3/lib/python3.6/site-packages/flair/models/sequence_tagger_model.py in _forward_alg(self, feats, lens_)\r\n    823             agg_ = torch.log(torch.sum(torch.exp(tag_var), dim=2))\r\n    824 \r\n--> 825             cloned = forward_var.clone()\r\n    826             cloned[:, i + 1, :] = max_tag_var + agg_\r\n    827 \r\n\r\nRuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 15.75 GiB total capacity; 11.00 GiB already allocated; 2.88 MiB free; 14.69 GiB reserved in total by PyTorch)\r\n\r\n```\r\n\r\n\r\n**To Reproduce**\r\n```\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import ColumnCorpus\r\nfrom flair.embeddings import TokenEmbeddings, WordEmbeddings, StackedEmbeddings\r\nfrom typing import List\r\n\r\n\r\n# define columns\r\ncolumns = {0: 'text', 1: 'ner'}\r\n\r\n# this is the folder in which train, test and dev files reside\r\ndata_folder = \"Flair/ner_corpus_iob/\"\r\n\r\ncorpus using column format, data folder and the names of the train, dev and test files\r\ncorpus: Corpus = ColumnCorpus(data_folder, columns,\r\n                              train_file='train/train.txt',\r\n                              test_file='test.txt',\r\n                              dev_file='valid.txt',\r\n                             in_memory=False)\r\n#                              document_separator_token = \"\\n\")\r\n   \r\ntag_type = 'ner'\r\ntag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\nprint(tag_dictionary.idx2item)\r\nembedding_types: List[TokenEmbeddings] = [\r\n\r\n    FlairEmbeddings('Flair/language_model_forward/best-lm.pt'),\r\n    FlairEmbeddings('Flair/language_model_backward/best-lm.pt')\r\n]\r\nfrom flair.models import SequenceTagger\r\n\r\ntagger: SequenceTagger = SequenceTagger(hidden_size=256,\r\n                                        embeddings=embeddings,\r\n                                        tag_dictionary=tag_dictionary,\r\n                                        tag_type=tag_type,\r\n                                        use_crf=True)\r\n    \r\nfrom flair.trainers import ModelTrainer\r\n\r\ntrainer: ModelTrainer = ModelTrainer(tagger, corpus)\r\n\r\nembeddings: StackedEmbeddings = StackedEmbeddings(embeddings=embedding_types)\r\n\r\ntrainer.train('Flair/ner_model',\r\n              learning_rate=0.001,\r\n              mini_batch_size=16,\r\n              max_epochs=10,\r\n             monitor_train=True,\r\n             monitor_test=True,\r\n             checkpoint=True,\r\n              train_with_dev=True)\r\n```\r\n\r\n**Expected behavior**\r\nI was expecting the model to train with the required data. \r\n\r\n\r\n**Environment (please complete the following information):**\r\nI am training the model on AWS - Sagemaker - ml.p3.2xlarge machine\r\nThe version of library installed is - 0.4.5 - master branch\r\npip install --upgrade git+https://github.com/zalandoresearch/flair.git\r\n\r\n**Additional context**\r\nI reduced the mini_batch_size from 16 to 1 and the model seems to be working then. But the training is very slow and the results are not good. ", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1444/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1444/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1438", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1438/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1438/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1438/events", "html_url": "https://github.com/flairNLP/flair/issues/1438", "id": 568103614, "node_id": "MDU6SXNzdWU1NjgxMDM2MTQ=", "number": 1438, "title": "ModuleNotFoundError: No module named '_regex", "user": {"login": "ishahaad", "id": 18382764, "node_id": "MDQ6VXNlcjE4MzgyNzY0", "avatar_url": "https://avatars.githubusercontent.com/u/18382764?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ishahaad", "html_url": "https://github.com/ishahaad", "followers_url": "https://api.github.com/users/ishahaad/followers", "following_url": "https://api.github.com/users/ishahaad/following{/other_user}", "gists_url": "https://api.github.com/users/ishahaad/gists{/gist_id}", "starred_url": "https://api.github.com/users/ishahaad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ishahaad/subscriptions", "organizations_url": "https://api.github.com/users/ishahaad/orgs", "repos_url": "https://api.github.com/users/ishahaad/repos", "events_url": "https://api.github.com/users/ishahaad/events{/privacy}", "received_events_url": "https://api.github.com/users/ishahaad/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-02-20T07:27:03Z", "updated_at": "2020-06-26T07:49:50Z", "closed_at": "2020-06-26T07:49:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello Flair team, \r\n\r\nI used to use flair just fine on my old machine and created multiple models.\r\nNow when I moved to my new machine,e I installed flair, and I'm trying to load a previous model, but I encountered an error \"ModuleNotFoundError: No module named 'pytorch_transformers'\". So I pip install pytorch_transformers, then another error came up \"ModuleNotFoundError: No module named '_regex'\". I'm not sure how to solve it. \r\n\r\nPlease I need your help \r\nThank you", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1438/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1438/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1435", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1435/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1435/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1435/events", "html_url": "https://github.com/flairNLP/flair/issues/1435", "id": 567104371, "node_id": "MDU6SXNzdWU1NjcxMDQzNzE=", "number": 1435, "title": "Colab freezes with PooledFlairEmbeddings", "user": {"login": "igormis", "id": 6599037, "node_id": "MDQ6VXNlcjY1OTkwMzc=", "avatar_url": "https://avatars.githubusercontent.com/u/6599037?v=4", "gravatar_id": "", "url": "https://api.github.com/users/igormis", "html_url": "https://github.com/igormis", "followers_url": "https://api.github.com/users/igormis/followers", "following_url": "https://api.github.com/users/igormis/following{/other_user}", "gists_url": "https://api.github.com/users/igormis/gists{/gist_id}", "starred_url": "https://api.github.com/users/igormis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/igormis/subscriptions", "organizations_url": "https://api.github.com/users/igormis/orgs", "repos_url": "https://api.github.com/users/igormis/repos", "events_url": "https://api.github.com/users/igormis/events{/privacy}", "received_events_url": "https://api.github.com/users/igormis/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-02-18T19:20:10Z", "updated_at": "2020-07-21T23:48:58Z", "closed_at": "2020-07-21T23:48:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nThe colab stops on first iteration\r\n\r\n**To Reproduce**\r\n`embedding_types: List[TokenEmbeddings] = [\r\n                                          \r\n    #embedding = RoBERTaEmbeddings(pretrained_model_name_or_path=\"roberta-base\", layers=\"0,1,2,3,4,5,6,7,8,9,10,11,12\", pooling_operation=\"first\", use_scalar_mix=True)\r\n    WordEmbeddings('glove'),\r\n    #WordEmbeddings('flairembeddings'),\r\n    BertEmbeddings(\"distilbert-base-uncased\"),\r\n    #RoBERTaEmbeddings(pretrained_model_name_or_path=\"roberta-base\", layers=\"0,1,2,3,4,5,6,7,8,9,10,11,12\",\r\n    #                          pooling_operation=\"first\", use_scalar_mix=True),\r\n    # comment in this line to use character embeddings\r\n    #CharacterEmbeddings(),\r\n    PooledFlairEmbeddings('news-forward', pooling='min'),\r\n    PooledFlairEmbeddings('news-backward', pooling='min'),\r\n    # contextual string embeddings, forward\r\n    #FlairEmbeddings('news-forward'),\r\n\r\n    # contextual string embeddings, backward\r\n    #FlairEmbeddings('news-backward'),\r\n]`\r\n\r\n**Expected behavior**\r\nIt is expected to finish with 150 iteration\r\n\r\n**Screenshots**\r\n2020-02-18 19:05:50,886 epoch 1 - iter 33/335 - loss 50.98124013 - samples/sec: 38.50\r\n2020-02-18 19:06:14,781 epoch 1 - iter 66/335 - loss 44.30798718 - samples/sec: 44.34\r\n2020-02-18 19:06:41,271 epoch 1 - iter 99/335 - loss 40.18037058 - samples/sec: 40.00\r\n2020-02-18 19:07:06,270 epoch 1 - iter 132/335 - loss 37.21505756 - samples/sec: 42.38\r\n2020-02-18 19:07:30,189 epoch 1 - iter 165/335 - loss 34.58314475 - samples/sec: 44.28\r\n2020-02-18 19:07:57,314 epoch 1 - iter 198/335 - loss 32.73812305 - samples/sec: 39.04\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]:\r\n - Version [e.g. flair-0.3.2]:\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1435/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1435/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1424", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1424/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1424/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1424/events", "html_url": "https://github.com/flairNLP/flair/issues/1424", "id": 563161798, "node_id": "MDU6SXNzdWU1NjMxNjE3OTg=", "number": 1424, "title": "RuntimeError: CUDA out of memory. Tried to allocate 352.00 MiB (GPU 0; 15.90 GiB total capacity; 14.28 GiB already allocated; 259.88 MiB free; 14.94 GiB reserved in total by PyTorch) in bert-base-multilingual-cased", "user": {"login": "abeermohamed1", "id": 20182641, "node_id": "MDQ6VXNlcjIwMTgyNjQx", "avatar_url": "https://avatars.githubusercontent.com/u/20182641?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abeermohamed1", "html_url": "https://github.com/abeermohamed1", "followers_url": "https://api.github.com/users/abeermohamed1/followers", "following_url": "https://api.github.com/users/abeermohamed1/following{/other_user}", "gists_url": "https://api.github.com/users/abeermohamed1/gists{/gist_id}", "starred_url": "https://api.github.com/users/abeermohamed1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abeermohamed1/subscriptions", "organizations_url": "https://api.github.com/users/abeermohamed1/orgs", "repos_url": "https://api.github.com/users/abeermohamed1/repos", "events_url": "https://api.github.com/users/abeermohamed1/events{/privacy}", "received_events_url": "https://api.github.com/users/abeermohamed1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2020-02-11T12:03:25Z", "updated_at": "2020-06-30T10:59:20Z", "closed_at": "2020-06-30T10:59:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "**I appreciate your help. The below error generated only when I try to add the BERT 'bert-base-multilingual-cased' embedding however when I remove it my code working fine. Please assist.**\r\n\r\n\r\n**Code**\r\n\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import CONLL_03\r\nfrom flair.embeddings import TokenEmbeddings, WordEmbeddings, StackedEmbeddings, PooledFlairEmbeddings,FlairEmbeddings\r\nfrom typing import List\r\nfrom flair.data import Dictionary\r\nfrom flair.models import LanguageModel\r\nfrom flair.trainers.language_model_trainer import LanguageModelTrainer, TextCorpus\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import ColumnCorpus\r\nfrom flair.embeddings import BertEmbeddings\r\n\r\n\r\ncolumns = {0: 'text', 1: 'ner'}\r\n\r\n\r\ndata_folder = '/content/gdrive/My Drive/resources/tasks/conll_03'\r\n\r\ncorpus: Corpus = ColumnCorpus(data_folder, columns,\r\n                              train_file='train.txt',\r\n                              test_file='test.txt',\r\n                              dev_file='dev.txt')\r\n    \r\n\r\n\r\ntag_type = 'ner'\r\n\r\ntag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\n\r\n\r\nembedding_types: List[TokenEmbeddings] = [\r\n\r\n\r\n    WordEmbeddings('ar'),\r\n    **BertEmbeddings('bert-base-multilingual-cased'),**\r\n\r\n    PooledFlairEmbeddings('ar-forward', pooling='max'),\r\n\r\n\r\n    PooledFlairEmbeddings('ar-backward' , pooling='max'),\r\n]\r\n\r\nembeddings: StackedEmbeddings = StackedEmbeddings(embeddings=embedding_types)\r\n\r\n\r\nfrom flair.models import SequenceTagger\r\n\r\ntagger: SequenceTagger = SequenceTagger(hidden_size=256,\r\n                                        embeddings=embeddings,\r\n                                        tag_dictionary=tag_dictionary,\r\n                                        tag_type=tag_type)\r\n\r\nfrom flair.trainers import ModelTrainer\r\ntrainer: ModelTrainer = ModelTrainer(tagger, corpus)\r\n                                                             \r\nimport pickle\r\ntrainer.train('/content/gdrive/My Drive/resources/taggers/example-ner',\r\n              train_with_dev=True, \r\n              learning_rate=0.1,   \r\n              mini_batch_size=32,\r\n              max_epochs=150,\r\n              checkpoint=True)\r\n\r\n\r\n\r\n\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - colab GPU\r\n-pip install --upgrade flair\r\n\r\n**Error**\r\n2020-02-11 11:43:30,835 ----------------------------------------------------------------------------------------------------\r\n2020-02-11 11:43:30,837 Corpus: \"Corpus: 1328 train + 710 dev + 605 test sentences\"\r\n2020-02-11 11:43:30,839 ----------------------------------------------------------------------------------------------------\r\n2020-02-11 11:43:30,841 Parameters:\r\n2020-02-11 11:43:30,844  - learning_rate: \"0.1\"\r\n2020-02-11 11:43:30,845  - mini_batch_size: \"32\"\r\n2020-02-11 11:43:30,846  - patience: \"3\"\r\n2020-02-11 11:43:30,848  - anneal_factor: \"0.5\"\r\n2020-02-11 11:43:30,849  - max_epochs: \"150\"\r\n2020-02-11 11:43:30,851  - shuffle: \"True\"\r\n2020-02-11 11:43:30,852  - train_with_dev: \"True\"\r\n2020-02-11 11:43:30,853  - batch_growth_annealing: \"False\"\r\n2020-02-11 11:43:30,854 ----------------------------------------------------------------------------------------------------\r\n2020-02-11 11:43:30,855 Model training base path: \"/content/gdrive/My Drive/resources/taggers/example-ner\"\r\n2020-02-11 11:43:30,857 ----------------------------------------------------------------------------------------------------\r\n2020-02-11 11:43:30,858 Device: cuda:0\r\n2020-02-11 11:43:30,860 ----------------------------------------------------------------------------------------------------\r\n2020-02-11 11:43:30,861 Embeddings storage mode: cpu\r\n2020-02-11 11:43:31,008 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2020-02-11 11:43:39,175 epoch 1 - iter 6/64 - loss 28.77731991 - samples/sec: 23.53\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-3-7affb8eee154> in <module>()\r\n     68               mini_batch_size=32,\r\n     69               max_epochs=150,\r\n---> 70               checkpoint=True)\r\n     71 \r\n\r\n14 frames\r\n/usr/local/lib/python3.6/dist-packages/transformers/modeling_bert.py in gelu(x)\r\n    133         Also see https://arxiv.org/abs/1606.08415\r\n    134     \"\"\"\r\n--> 135     return x * 0.5 * (1.0 + torch.erf(x / math.sqrt(2.0)))\r\n    136 \r\n    137 \r\n\r\nRuntimeError: CUDA out of memory. Tried to allocate 168.00 MiB (GPU 0; 15.90 GiB total capacity; 14.52 GiB already allocated; 91.88 MiB free; 15.11 GiB reserved in total by PyTorch)\r\n\r\n\r\n**one change the setup using --upgrade, I got the same error in different line**\r\n\r\n-pip install --upgrade flair\r\n\r\n**error after --upgrade command **\r\n2020-02-11 11:59:12,305 Reading data from /content/gdrive/My Drive/resources/tasks/conll_03\r\n2020-02-11 11:59:12,307 Train: /content/gdrive/My Drive/resources/tasks/conll_03/train.txt\r\n2020-02-11 11:59:12,308 Dev: /content/gdrive/My Drive/resources/tasks/conll_03/dev.txt\r\n2020-02-11 11:59:12,310 Test: /content/gdrive/My Drive/resources/tasks/conll_03/test.txt\r\n/usr/local/lib/python3.6/dist-packages/smart_open/smart_open_lib.py:402: UserWarning: This function is deprecated, use smart_open.open instead. See the migration notes for details: https://github.com/RaRe-Technologies/smart_open/blob/master/README.rst#migrating-to-the-new-open-function\r\n  'See the migration notes for details: %s' % _MIGRATION_NOTES_URL\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-5-7affb8eee154> in <module>()\r\n     50                                         embeddings=embeddings,\r\n     51                                         tag_dictionary=tag_dictionary,\r\n---> 52                                         tag_type=tag_type)\r\n     53 # initialize trainer\r\n     54 from flair.trainers import ModelTrainer\r\n\r\n8 frames\r\n/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py in convert(t)\r\n    421 \r\n    422         def convert(t):\r\n--> 423             return t.to(device, dtype if t.is_floating_point() else None, non_blocking)\r\n    424 \r\n    425         return self._apply(convert)\r\n\r\nRuntimeError: CUDA out of memory. Tried to allocate 352.00 MiB (GPU 0; 15.90 GiB total capacity; 14.28 GiB already allocated; 259.88 MiB free; 14.94 GiB reserved in total by PyTorch)\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1424/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1424/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1422", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1422/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1422/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1422/events", "html_url": "https://github.com/flairNLP/flair/issues/1422", "id": 562057700, "node_id": "MDU6SXNzdWU1NjIwNTc3MDA=", "number": 1422, "title": "Using model trained with camembert gives error", "user": {"login": "CatarinaPC", "id": 16788365, "node_id": "MDQ6VXNlcjE2Nzg4MzY1", "avatar_url": "https://avatars.githubusercontent.com/u/16788365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CatarinaPC", "html_url": "https://github.com/CatarinaPC", "followers_url": "https://api.github.com/users/CatarinaPC/followers", "following_url": "https://api.github.com/users/CatarinaPC/following{/other_user}", "gists_url": "https://api.github.com/users/CatarinaPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/CatarinaPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CatarinaPC/subscriptions", "organizations_url": "https://api.github.com/users/CatarinaPC/orgs", "repos_url": "https://api.github.com/users/CatarinaPC/repos", "events_url": "https://api.github.com/users/CatarinaPC/events{/privacy}", "received_events_url": "https://api.github.com/users/CatarinaPC/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-02-08T18:17:58Z", "updated_at": "2021-10-03T15:01:30Z", "closed_at": "2020-05-24T13:14:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhen using a model trained with camembert embeddings to predict sentences, I get the following error: `UnboundLocalError: local variable 'tokenizer' referenced before assignment`\r\n\r\nThe error occurs during SequenceTagger.load().\r\n\r\n**To Reproduce**\r\nI trained  model with all default parameters and camembert embeddings. Then I try to give it sentences to predict, as in the following code excerpt:\r\n\r\n```\r\nfrom flair.models import SequenceTagger\r\n\r\n# load model\r\nmodel = SequenceTagger.load(\"../../models/trained/flair/camembert/best-model.pt\")\r\n\r\n# by default whitespace based tokenizer is used\r\nmodel.predict(\"testing sentence 1\")\r\n```\r\n\r\n**Error**\r\n\r\n```\r\n2020-02-08 18:11:54,184 loading file ../../models/trained/flair/camembert/best-model.pt\r\nTraceback (most recent call last):\r\n  File \"/home/catarinapc/cl-extraction-models_new/src/models/testing.py\", line 4, in <module>\r\n    model = SequenceTagger.load(\"../../models/trained/flair/camembert/best-model.pt\")\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/flair/nn.py\", line 86, in load\r\n    state = torch.load(f, map_location=flair.device)\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/torch/serialization.py\", line 426, in load\r\n    return _load(f, map_location, pickle_module, **pickle_load_args)\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/torch/serialization.py\", line 613, in _load\r\n    result = unpickler.load()\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/flair/embeddings.py\", line 1621, in __setstate__\r\n    \"-\".join(self.name.split(\"-\")[1:])\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/transformers/tokenization_utils.py\", line 302, in from_pretrained\r\n    return cls._from_pretrained(*inputs, **kwargs)\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/transformers/tokenization_utils.py\", line 444, in _from_pretrained\r\n    tokenizer.init_inputs = init_inputs\r\nUnboundLocalError: local variable 'tokenizer' referenced before assignment\r\n```\r\n\r\n**Environment:**\r\nOS: Ubuntu 18.04.3 LTS\r\nVersion: 0.4.4 (I think I'm using the version on the master branch)\r\nPython version: 3.6.8\r\n\r\nThanks for the help!\r\n\r\n### UPDATE\r\n\r\nJust uninstalled and installed both flair (was using master branch), transformers library, and torch (one version bellow current) and now I get the following error:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/catarinapc/cl-extraction-models_new/src/models/testing.py\", line 4, in <module>\r\n    model = SequenceTagger.load(\"../../models/trained/flair/camembert/best-model.pt\")\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/flair/nn.py\", line 86, in load\r\n    state = torch.load(f, map_location=flair.device)\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/torch/serialization.py\", line 529, in load\r\n    return _legacy_load(opened_file, map_location, pickle_module, **pickle_load_args)\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/torch/serialization.py\", line 702, in _legacy_load\r\n    result = unpickler.load()\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/flair/embeddings.py\", line 1621, in __setstate__\r\n    \"-\".join(self.name.split(\"-\")[1:])\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/transformers/tokenization_utils.py\", line 309, in from_pretrained\r\n    return cls._from_pretrained(*inputs, **kwargs)\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/transformers/tokenization_utils.py\", line 410, in _from_pretrained\r\n    list(cls.vocab_files_names.values()),\r\nOSError: Model name 'base' was not found in tokenizers model name list (camembert-base). We assumed 'base' was a path, a model identifier, or url to a directory containing vocabulary files named ['sentencepiece.bpe.model'] but couldn't find such vocabulary files at this path or url.\r\n\r\n```\r\n\r\nand when using xml roberta:\r\n\r\n```\r\n2020-02-08 18:52:33,804 loading file ../../models/trained/flair/xlm-roberta-base/best-model.pt\r\nTraceback (most recent call last):\r\n  File \"/home/catarinapc/cl-extraction-models_new/src/models/predict_model.py\", line 34, in <module>\r\n    run()\r\n  File \"/home/catarinapc/cl-extraction-models_new/src/models/predict_model.py\", line 30, in run\r\n    predict_flair_trained_models()\r\n  File \"/home/catarinapc/cl-extraction-models_new/src/models/predict_model.py\", line 22, in predict_flair_trained_models\r\n    df_copy[\"pred\"] = flair_model_handler.predict(model_dir_path+\"/best-model.pt\", sentences_text_flair)\r\n  File \"/home/catarinapc/cl-extraction-models_new/src/models/flair_model.py\", line 75, in predict\r\n    model = SequenceTagger.load(model_path)\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/flair/nn.py\", line 86, in load\r\n    state = torch.load(f, map_location=flair.device)\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/torch/serialization.py\", line 426, in load\r\n    return _load(f, map_location, pickle_module, **pickle_load_args)\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/torch/serialization.py\", line 613, in _load\r\n    result = unpickler.load()\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/flair/embeddings.py\", line 1693, in __setstate__\r\n    \"-\".join(self.name.split(\"-\")[1:])\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/transformers/tokenization_utils.py\", line 309, in from_pretrained\r\n    return cls._from_pretrained(*inputs, **kwargs)\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/transformers/tokenization_utils.py\", line 410, in _from_pretrained\r\n    list(cls.vocab_files_names.values()),\r\nOSError: Model name 'roberta-base' was not found in tokenizers model name list (xlm-roberta-base, xlm-roberta-large, xlm-roberta-large-finetuned-conll02-dutch, xlm-roberta-large-finetuned-conll02-spanish, xlm-roberta-large-finetuned-conll03-english, xlm-roberta-large-finetuned-conll03-german). We assumed 'roberta-base' was a path, a model identifier, or url to a directory containing vocabulary files named ['sentencepiece.bpe.model'] but couldn't find such vocabulary files at this path or url.\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1422/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1422/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1421", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1421/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1421/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1421/events", "html_url": "https://github.com/flairNLP/flair/issues/1421", "id": 562005097, "node_id": "MDU6SXNzdWU1NjIwMDUwOTc=", "number": 1421, "title": "AMP O2", "user": {"login": "djstrong", "id": 1849959, "node_id": "MDQ6VXNlcjE4NDk5NTk=", "avatar_url": "https://avatars.githubusercontent.com/u/1849959?v=4", "gravatar_id": "", "url": "https://api.github.com/users/djstrong", "html_url": "https://github.com/djstrong", "followers_url": "https://api.github.com/users/djstrong/followers", "following_url": "https://api.github.com/users/djstrong/following{/other_user}", "gists_url": "https://api.github.com/users/djstrong/gists{/gist_id}", "starred_url": "https://api.github.com/users/djstrong/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/djstrong/subscriptions", "organizations_url": "https://api.github.com/users/djstrong/orgs", "repos_url": "https://api.github.com/users/djstrong/repos", "events_url": "https://api.github.com/users/djstrong/events{/privacy}", "received_events_url": "https://api.github.com/users/djstrong/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-02-08T11:11:58Z", "updated_at": "2023-02-08T02:46:55Z", "closed_at": "2020-06-14T12:41:24Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\n\r\nBug while training sequence tagger with `amp_opt_level=O2`.\r\n\r\n**To Reproduce**\r\n\r\nVersion: 0.4.5\r\nGPU: V100\r\n\r\nRun https://github.com/flairNLP/flair/blob/master/train.py with added:\r\n```\r\n    use_amp=True,\r\n    amp_opt_level='O2'\r\n```\r\n\r\n```\r\n2020-02-08 12:14:02,758 ----------------------------------------------------------------------------------------------------\r\n2020-02-08 12:14:02,758 Corpus: \"Corpus: 12543 train + 2002 dev + 2077 test sentences\"\r\n2020-02-08 12:14:02,758 ----------------------------------------------------------------------------------------------------\r\n2020-02-08 12:14:02,759 Parameters:\r\n2020-02-08 12:14:02,759  - learning_rate: \"0.1\"\r\n2020-02-08 12:14:02,759  - mini_batch_size: \"32\"\r\n2020-02-08 12:14:02,759  - patience: \"3\"\r\n2020-02-08 12:14:02,759  - anneal_factor: \"0.5\"\r\n2020-02-08 12:14:02,759  - max_epochs: \"20\"\r\n2020-02-08 12:14:02,759  - shuffle: \"False\"\r\n2020-02-08 12:14:02,759  - train_with_dev: \"False\"\r\n2020-02-08 12:14:02,759  - batch_growth_annealing: \"False\"\r\n2020-02-08 12:14:02,759 ----------------------------------------------------------------------------------------------------\r\n2020-02-08 12:14:02,759 Model training base path: \"resources/taggers/example-ner\"\r\n2020-02-08 12:14:02,759 ----------------------------------------------------------------------------------------------------\r\n2020-02-08 12:14:02,760 Device: cuda:0\r\n2020-02-08 12:14:02,760 ----------------------------------------------------------------------------------------------------\r\n2020-02-08 12:14:02,760 Embeddings storage mode: cpu\r\nSelected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.\r\n\r\nDefaults for this optimization level are:\r\nenabled                : True\r\nopt_level              : O2\r\ncast_model_type        : torch.float16\r\npatch_torch_functions  : False\r\nkeep_batchnorm_fp32    : True\r\nmaster_weights         : True\r\nloss_scale             : dynamic\r\nProcessing user overrides (additional kwargs that are not None)...\r\nAfter processing overrides, optimization options are:\r\nenabled                : True\r\nopt_level              : O2\r\ncast_model_type        : torch.float16\r\npatch_torch_functions  : False\r\nkeep_batchnorm_fp32    : True\r\nmaster_weights         : True\r\nloss_scale             : dynamic\r\n2020-02-08 12:14:02,764 ----------------------------------------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 8, in <module>\r\n  File \"venv/lib/python3.7/site-packages/flair/trainers/trainer.py\", line 331, in train\r\n    loss = self.model.forward_loss(batch_step)\r\n  File \"venv/lib/python3.7/site-packages/flair/models/sequence_tagger_model.py\", line 493, in forward_loss\r\n    features = self.forward(data_points)\r\n  File \"venv/lib/python3.7/site-packages/apex/amp/_initialize.py\", line 197, in new_fwd\r\n    **applier(kwargs, input_caster))\r\n  File \"venv/lib/python3.7/site-packages/flair/models/sequence_tagger_model.py\", line 498, in forward\r\n    self.embeddings.embed(sentences)\r\n  File \"venv/lib/python3.7/site-packages/flair/embeddings.py\", line 177, in embed\r\n    embedding.embed(sentences)\r\n  File \"venv/lib/python3.7/site-packages/flair/embeddings.py\", line 87, in embed\r\n    for token in sentence.tokens:\r\nAttributeError: 'NoneType' object has no attribute 'tokens'\r\n```\r\n\r\n**Additional context**\r\nThe error is shown with embeddings storage mode cpu and gpu too.\r\nIt works with `O1` (however training is a little slower).\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1421/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1421/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1409", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1409/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1409/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1409/events", "html_url": "https://github.com/flairNLP/flair/issues/1409", "id": 560329701, "node_id": "MDU6SXNzdWU1NjAzMjk3MDE=", "number": 1409, "title": "High memory/swap when embedding with BERT", "user": {"login": "BeWe11", "id": 14355528, "node_id": "MDQ6VXNlcjE0MzU1NTI4", "avatar_url": "https://avatars.githubusercontent.com/u/14355528?v=4", "gravatar_id": "", "url": "https://api.github.com/users/BeWe11", "html_url": "https://github.com/BeWe11", "followers_url": "https://api.github.com/users/BeWe11/followers", "following_url": "https://api.github.com/users/BeWe11/following{/other_user}", "gists_url": "https://api.github.com/users/BeWe11/gists{/gist_id}", "starred_url": "https://api.github.com/users/BeWe11/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/BeWe11/subscriptions", "organizations_url": "https://api.github.com/users/BeWe11/orgs", "repos_url": "https://api.github.com/users/BeWe11/repos", "events_url": "https://api.github.com/users/BeWe11/events{/privacy}", "received_events_url": "https://api.github.com/users/BeWe11/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-02-05T12:07:40Z", "updated_at": "2020-04-30T10:13:14Z", "closed_at": "2020-04-30T10:13:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI'm embedding sentences using the `BertEmbeddings` class. I'm performing a single `.embed` call on a list of around 3000 `Sentence` objects. While the embeddings are being calculated, my swap increases by a huge amount, starting from almost nothing to around 50 GB. If I extract the embeddings afterwards as numpy arrays, the total size of the embeddings is around 15 MB.\r\n\r\n**To Reproduce**\r\n```python\r\nfrom flair.embeddings import BertEmbeddings, Sentence\r\n\r\nembedder = BertEmbeddings(\r\n    \"bert-base-german-dbmdz-uncased\",\r\n    layers=\"0,1,2,3,4,5,6,7,8,9,10,11,12\",\r\n    use_scalar_mix=True,\r\n    pooling_operation=\"first\",\r\n)\r\nsentences = [\"Ich suche drei Kisten Cola.\"] * 3000\r\nflair_sentences = [Sentence(sentence) for sentence in sentences]\r\nembedder.embed(flair_sentences)\r\n```\r\n\r\n**Expected behavior**\r\nI'm not sure if this is an expected byproduct of using the BERT embedder. Is there some place inside the embedding code that caches large intermediate objects during a `.embed` call? My current workaround is to split the sentences into chunks and perform multiple `.embed` calls in parallel.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: MacOS\r\n - Version [e.g. flair-0.3.2]: flair-0.4.5", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1409/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1409/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1408", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1408/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1408/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1408/events", "html_url": "https://github.com/flairNLP/flair/issues/1408", "id": 559749110, "node_id": "MDU6SXNzdWU1NTk3NDkxMTA=", "number": 1408, "title": "still issues when loading some models on Win 10", "user": {"login": "dcavar", "id": 1538684, "node_id": "MDQ6VXNlcjE1Mzg2ODQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1538684?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dcavar", "html_url": "https://github.com/dcavar", "followers_url": "https://api.github.com/users/dcavar/followers", "following_url": "https://api.github.com/users/dcavar/following{/other_user}", "gists_url": "https://api.github.com/users/dcavar/gists{/gist_id}", "starred_url": "https://api.github.com/users/dcavar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dcavar/subscriptions", "organizations_url": "https://api.github.com/users/dcavar/orgs", "repos_url": "https://api.github.com/users/dcavar/repos", "events_url": "https://api.github.com/users/dcavar/events{/privacy}", "received_events_url": "https://api.github.com/users/dcavar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2020-02-04T14:18:00Z", "updated_at": "2020-06-16T20:28:30Z", "closed_at": "2020-06-16T20:28:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "Using the newest Flair and torch on Win 10 I still get this error for (other models worked):\r\ntagger = SequenceTagger.load('frame-fast')\r\nor\r\ntagger = SequenceTagger.load('frame')\r\n\r\n---------------------------------------------------------------------------\r\nNotImplementedError                       Traceback (most recent call last)\r\n<ipython-input-20-02fe8d2768ba> in <module>\r\n----> 1 tagger = SequenceTagger.load('frame-fast')\r\n      2 \r\n      3 sentence_1 = Sentence('George returned to Berlin to return his hat .')\r\n      4 sentence_2 = Sentence('He had a look at different hats .')\r\n      5 \r\n\r\nc:\\program files\\python37\\lib\\site-packages\\flair\\nn.py in load(cls, model)\r\n     84             # see https://github.com/zalandoresearch/flair/issues/351\r\n     85             f = file_utils.load_big_file(str(model_file))\r\n---> 86             state = torch.load(f, map_location=flair.device)\r\n     87 \r\n     88         model = cls._init_model_with_state_dict(state)\r\n\r\nc:\\program files\\python37\\lib\\site-packages\\torch\\serialization.py in load(f, map_location, pickle_module, **pickle_load_args)\r\n    527             with _open_zipfile_reader(f) as opened_zipfile:\r\n    528                 return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)\r\n--> 529         return _legacy_load(opened_file, map_location, pickle_module, **pickle_load_args)\r\n    530 \r\n    531 \r\n\r\nc:\\program files\\python37\\lib\\site-packages\\torch\\serialization.py in _legacy_load(f, map_location, pickle_module, **pickle_load_args)\r\n    700     unpickler = pickle_module.Unpickler(f, **pickle_load_args)\r\n    701     unpickler.persistent_load = persistent_load\r\n--> 702     result = unpickler.load()\r\n    703 \r\n    704     deserialized_storage_keys = pickle_module.load(f, **pickle_load_args)\r\n\r\nc:\\program files\\python37\\lib\\pathlib.py in __new__(cls, *args, **kwargs)\r\n   1023         if not self._flavour.is_supported:\r\n   1024             raise NotImplementedError(\"cannot instantiate %r on your system\"\r\n-> 1025                                       % (cls.__name__,))\r\n   1026         self._init()\r\n   1027         return self\r\n\r\nNotImplementedError: cannot instantiate 'PosixPath' on your system", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1408/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1408/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1407", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1407/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1407/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1407/events", "html_url": "https://github.com/flairNLP/flair/issues/1407", "id": 559698861, "node_id": "MDU6SXNzdWU1NTk2OTg4NjE=", "number": 1407, "title": "wrong import in example in release notes 0.4.5", "user": {"login": "timnon", "id": 5597397, "node_id": "MDQ6VXNlcjU1OTczOTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5597397?v=4", "gravatar_id": "", "url": "https://api.github.com/users/timnon", "html_url": "https://github.com/timnon", "followers_url": "https://api.github.com/users/timnon/followers", "following_url": "https://api.github.com/users/timnon/following{/other_user}", "gists_url": "https://api.github.com/users/timnon/gists{/gist_id}", "starred_url": "https://api.github.com/users/timnon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/timnon/subscriptions", "organizations_url": "https://api.github.com/users/timnon/orgs", "repos_url": "https://api.github.com/users/timnon/repos", "events_url": "https://api.github.com/users/timnon/events{/privacy}", "received_events_url": "https://api.github.com/users/timnon/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-02-04T12:50:15Z", "updated_at": "2020-02-10T17:52:12Z", "closed_at": "2020-02-10T17:52:12Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The import \r\n```\r\nfrom WordEmbeddingsStore import WordEmbeddingsStore\r\n```\r\nin the release notes for release 0.4.5 and issue #1315 is wrong. As in the docstring, it should be:\r\n```\r\nfrom flair.inference_utils import WordEmbeddingsStore\r\n```\r\nJust to make sure that nobody gets frustrated when trying\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1407/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1407/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1406", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1406/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1406/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1406/events", "html_url": "https://github.com/flairNLP/flair/issues/1406", "id": 559213660, "node_id": "MDU6SXNzdWU1NTkyMTM2NjA=", "number": 1406, "title": "aggregated_embedding not working with CPU", "user": {"login": "abeermohamed1", "id": 20182641, "node_id": "MDQ6VXNlcjIwMTgyNjQx", "avatar_url": "https://avatars.githubusercontent.com/u/20182641?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abeermohamed1", "html_url": "https://github.com/abeermohamed1", "followers_url": "https://api.github.com/users/abeermohamed1/followers", "following_url": "https://api.github.com/users/abeermohamed1/following{/other_user}", "gists_url": "https://api.github.com/users/abeermohamed1/gists{/gist_id}", "starred_url": "https://api.github.com/users/abeermohamed1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abeermohamed1/subscriptions", "organizations_url": "https://api.github.com/users/abeermohamed1/orgs", "repos_url": "https://api.github.com/users/abeermohamed1/repos", "events_url": "https://api.github.com/users/abeermohamed1/events{/privacy}", "received_events_url": "https://api.github.com/users/abeermohamed1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2020-02-03T17:04:19Z", "updated_at": "2020-03-04T18:39:27Z", "closed_at": "2020-03-04T18:39:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nerror in the end of the learning for 90 epoch using the other language word embeddings\r\n\r\n**To Reproduce**\r\n```python\r\n    WordEmbeddings('ar'),\r\n\r\n    # contextual string embeddings, forward\r\n    PooledFlairEmbeddings('ar-forward', pooling='min'),\r\n\r\n    # contextual string embeddings, backward\r\n    PooledFlairEmbeddings('ar-backward', pooling='min'),\r\n```\r\n\r\n**Expected behavior**\r\nA clear and concise description of what you expected to happen.\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]:\r\n - Version [e.g. flair-0.3.2]:\r\n\r\n**Additional context**\r\n```console\r\n2020-02-03 16:59:38,777 Reading data from /content/gdrive/My Drive/resources/tasks/conll_03\r\n2020-02-03 16:59:38,780 Train: /content/gdrive/My Drive/resources/tasks/conll_03/train.txt\r\n2020-02-03 16:59:38,782 Dev: /content/gdrive/My Drive/resources/tasks/conll_03/dev.txt\r\n2020-02-03 16:59:38,785 Test: /content/gdrive/My Drive/resources/tasks/conll_03/test.txt\r\n2020-02-03 17:00:24,966 ----------------------------------------------------------------------------------------------------\r\n2020-02-03 17:00:24,970 Model: \"SequenceTagger(\r\n  (embeddings): StackedEmbeddings(\r\n    (list_embedding_0): WordEmbeddings('ar')\r\n    (list_embedding_1): PooledFlairEmbeddings(\r\n      (context_embeddings): FlairEmbeddings(\r\n        (lm): LanguageModel(\r\n          (drop): Dropout(p=0.1, inplace=False)\r\n          (encoder): Embedding(7125, 100)\r\n          (rnn): LSTM(100, 2048)\r\n          (decoder): Linear(in_features=2048, out_features=7125, bias=True)\r\n        )\r\n      )\r\n    )\r\n    (list_embedding_2): PooledFlairEmbeddings(\r\n      (context_embeddings): FlairEmbeddings(\r\n        (lm): LanguageModel(\r\n          (drop): Dropout(p=0.1, inplace=False)\r\n          (encoder): Embedding(7125, 100)\r\n          (rnn): LSTM(100, 2048)\r\n          (decoder): Linear(in_features=2048, out_features=7125, bias=True)\r\n        )\r\n      )\r\n    )\r\n  )\r\n  (word_dropout): WordDropout(p=0.05)\r\n  (locked_dropout): LockedDropout(p=0.5)\r\n  (embedding2nn): Linear(in_features=8492, out_features=8492, bias=True)\r\n  (rnn): LSTM(8492, 256, batch_first=True, bidirectional=True)\r\n  (linear): Linear(in_features=512, out_features=12, bias=True)\r\n  (beta): 1.0\r\n  (weights): None\r\n  (weight_tensor) None\r\n)\"\r\n2020-02-03 17:00:24,975 ----------------------------------------------------------------------------------------------------\r\n2020-02-03 17:00:24,978 Corpus: \"Corpus: 1328 train + 710 dev + 605 test sentences\"\r\n2020-02-03 17:00:24,981 ----------------------------------------------------------------------------------------------------\r\n2020-02-03 17:00:24,985 Parameters:\r\n2020-02-03 17:00:24,987  - learning_rate: \"0.1\"\r\n2020-02-03 17:00:24,990  - mini_batch_size: \"32\"\r\n2020-02-03 17:00:24,991  - patience: \"3\"\r\n2020-02-03 17:00:24,994  - anneal_factor: \"0.5\"\r\n2020-02-03 17:00:24,996  - max_epochs: \"90\"\r\n2020-02-03 17:00:24,999  - shuffle: \"True\"\r\n2020-02-03 17:00:25,001  - train_with_dev: \"True\"\r\n2020-02-03 17:00:25,002  - batch_growth_annealing: \"False\"\r\n2020-02-03 17:00:25,004 ----------------------------------------------------------------------------------------------------\r\n2020-02-03 17:00:25,007 Model training base path: \"/content/gdrive/My Drive/resources/taggers/example-ner\"\r\n2020-02-03 17:00:25,011 ----------------------------------------------------------------------------------------------------\r\n2020-02-03 17:00:25,014 Device: cuda:0\r\n2020-02-03 17:00:25,015 ----------------------------------------------------------------------------------------------------\r\n2020-02-03 17:00:25,020 Embeddings storage mode: cpu\r\n/usr/local/lib/python3.6/dist-packages/torch/serialization.py:292: UserWarning: Couldn't retrieve source code for container of type StackedEmbeddings. It won't be checked for correctness upon loading.\r\n  \"type \" + obj.__name__ + \". It won't be checked \"\r\n/usr/local/lib/python3.6/dist-packages/torch/serialization.py:292: UserWarning: Couldn't retrieve source code for container of type WordEmbeddings. It won't be checked for correctness upon loading.\r\n  \"type \" + obj.__name__ + \". It won't be checked \"\r\n/usr/local/lib/python3.6/dist-packages/torch/serialization.py:292: UserWarning: Couldn't retrieve source code for container of type PooledFlairEmbeddings. It won't be checked for correctness upon loading.\r\n  \"type \" + obj.__name__ + \". It won't be checked \"\r\n/usr/local/lib/python3.6/dist-packages/torch/serialization.py:292: UserWarning: Couldn't retrieve source code for container of type FlairEmbeddings. It won't be checked for correctness upon loading.\r\n  \"type \" + obj.__name__ + \". It won't be checked \"\r\n/usr/local/lib/python3.6/dist-packages/torch/serialization.py:292: UserWarning: Couldn't retrieve source code for container of type LanguageModel. It won't be checked for correctness upon loading.\r\n  \"type \" + obj.__name__ + \". It won't be checked \"\r\n/usr/local/lib/python3.6/dist-packages/torch/serialization.py:292: UserWarning: Couldn't retrieve source code for container of type Dropout. It won't be checked for correctness upon loading.\r\n  \"type \" + obj.__name__ + \". It won't be checked \"\r\n/usr/local/lib/python3.6/dist-packages/torch/serialization.py:292: UserWarning: Couldn't retrieve source code for container of type Embedding. It won't be checked for correctness upon loading.\r\n  \"type \" + obj.__name__ + \". It won't be checked \"\r\n/usr/local/lib/python3.6/dist-packages/torch/serialization.py:292: UserWarning: Couldn't retrieve source code for container of type LSTM. It won't be checked for correctness upon loading.\r\n  \"type \" + obj.__name__ + \". It won't be checked \"\r\n/usr/local/lib/python3.6/dist-packages/torch/serialization.py:292: UserWarning: Couldn't retrieve source code for container of type Linear. It won't be checked for correctness upon loading.\r\n  \"type \" + obj.__name__ + \". It won't be checked \"\r\n2020-02-03 17:00:45,361 ----------------------------------------------------------------------------------------------------\r\n2020-02-03 17:00:45,365 Testing using best model ...\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-10-4c66a380caa5> in <module>()\r\n     35               mini_batch_size=32,\r\n     36               max_epochs=90,\r\n---> 37               checkpoint=True)\r\n\r\n6 frames\r\n/usr/local/lib/python3.6/dist-packages/flair/embeddings.py in _add_embeddings_internal(self, sentences)\r\n   2155                         else:\r\n   2156                             aggregated_embedding = self.aggregate_op(\r\n-> 2157                                 self.word_embeddings[token.text], local_embedding\r\n   2158                             )\r\n   2159                             if self.pooling == \"fade\":\r\n\r\nRuntimeError: Expected object of device type cuda but got device type cpu for argument #2 'other' in call to _th_min\r\n```", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1406/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1406/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1398", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1398/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1398/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1398/events", "html_url": "https://github.com/flairNLP/flair/issues/1398", "id": 557624129, "node_id": "MDU6SXNzdWU1NTc2MjQxMjk=", "number": 1398, "title": "Out of memory on local machine and the same on kaggle and colab", "user": {"login": "abeermohamed1", "id": 20182641, "node_id": "MDQ6VXNlcjIwMTgyNjQx", "avatar_url": "https://avatars.githubusercontent.com/u/20182641?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abeermohamed1", "html_url": "https://github.com/abeermohamed1", "followers_url": "https://api.github.com/users/abeermohamed1/followers", "following_url": "https://api.github.com/users/abeermohamed1/following{/other_user}", "gists_url": "https://api.github.com/users/abeermohamed1/gists{/gist_id}", "starred_url": "https://api.github.com/users/abeermohamed1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abeermohamed1/subscriptions", "organizations_url": "https://api.github.com/users/abeermohamed1/orgs", "repos_url": "https://api.github.com/users/abeermohamed1/repos", "events_url": "https://api.github.com/users/abeermohamed1/events{/privacy}", "received_events_url": "https://api.github.com/users/abeermohamed1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-01-30T16:53:36Z", "updated_at": "2020-06-05T17:27:30Z", "closed_at": "2020-06-05T17:27:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nwhen i try to reproduce the below experiment of conll-03\r\n\r\nthe same problem in Kaggle and colab\r\n\r\nhttps://github.com/flairNLP/flair/blob/master/resources/docs/EXPERIMENTS.md\r\n\r\nCoNLL-03 Named Entity Recognition (English)\r\n\r\nI appreciate your help\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1398/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1398/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1388", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1388/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1388/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1388/events", "html_url": "https://github.com/flairNLP/flair/issues/1388", "id": 555434103, "node_id": "MDU6SXNzdWU1NTU0MzQxMDM=", "number": 1388, "title": "ValueError: invalid literal for int() with base 10: '0+cpu' | for info in torch.__version__.split('.'))", "user": {"login": "rahulvsharan", "id": 2417235, "node_id": "MDQ6VXNlcjI0MTcyMzU=", "avatar_url": "https://avatars.githubusercontent.com/u/2417235?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rahulvsharan", "html_url": "https://github.com/rahulvsharan", "followers_url": "https://api.github.com/users/rahulvsharan/followers", "following_url": "https://api.github.com/users/rahulvsharan/following{/other_user}", "gists_url": "https://api.github.com/users/rahulvsharan/gists{/gist_id}", "starred_url": "https://api.github.com/users/rahulvsharan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rahulvsharan/subscriptions", "organizations_url": "https://api.github.com/users/rahulvsharan/orgs", "repos_url": "https://api.github.com/users/rahulvsharan/repos", "events_url": "https://api.github.com/users/rahulvsharan/events{/privacy}", "received_events_url": "https://api.github.com/users/rahulvsharan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2020-01-27T08:51:12Z", "updated_at": "2020-02-14T15:16:10Z", "closed_at": "2020-02-10T17:09:46Z", "author_association": "NONE", "active_lock_reason": null, "body": "Issue.:\r\n2020-01-27 14:15:54,846 loading file C:\\Users\\1025289\\.flair\\models\\en-pos-ontonotes-fast-v0.4.pt\r\nTraceback (most recent call last):\r\n  File \".\\fmain.py\", line 16, in <module>\r\n    main()\r\n  File \".\\fmain.py\", line 4, in main\r\n    intent_obj = GET_INTENT(b_preprocess_query=True)\r\n  File \"C:\\work\\python\\proj_fai\\get_intent.py\", line 10, in __init__\r\n    super().__init__(b_preprocess_query=b_preprocess_query)\r\n  File \"C:\\work\\python\\proj_fai\\model_flair.py\", line 24, in __init__\r\n    self._load_flair_model(flair_model)\r\n  File \"C:\\work\\python\\proj_fai\\model_flair.py\", line 30, in _load_flair_model\r\n    self._seq_tag = SequenceTagger.load(flair_model)\r\n  File \"C:\\Users\\1025289\\AppData\\Local\\Programs\\Python\\Python37\\lib\\site-packages\\flair\\nn.py\", line 88, in load\r\n    model = cls._init_model_with_state_dict(state)\r\n  File \"C:\\Users\\1025289\\AppData\\Local\\Programs\\Python\\Python37\\lib\\site-packages\\flair\\models\\sequence_tagger_model.py\", line 273, in _init_model_with_state_dict\r\n    loss_weights=weights,\r\n  File \"C:\\Users\\1025289\\AppData\\Local\\Programs\\Python\\Python37\\lib\\site-packages\\flair\\models\\sequence_tagger_model.py\", line 217, in __init__\r\n    self.to(flair.device)\r\n  File \"C:\\Users\\1025289\\AppData\\Local\\Programs\\Python\\Python37\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 425, in to\r\n    return self._apply(convert)\r\n  File \"C:\\Users\\1025289\\AppData\\Local\\Programs\\Python\\Python37\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 201, in _apply\r\n    module._apply(fn)\r\n  File \"C:\\Users\\1025289\\AppData\\Local\\Programs\\Python\\Python37\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 201, in _apply\r\n    module._apply(fn)\r\n  File \"C:\\Users\\1025289\\AppData\\Local\\Programs\\Python\\Python37\\lib\\site-packages\\torch\\nn\\modules\\module.py\", line 201, in _apply\r\n    module._apply(fn)\r\n  File \"C:\\Users\\1025289\\AppData\\Local\\Programs\\Python\\Python37\\lib\\site-packages\\flair\\models\\language_model.py\", line 394, in _apply       \r\n    for info in torch.__version__.split('.'))\r\n  File \"C:\\Users\\1025289\\AppData\\Local\\Programs\\Python\\Python37\\lib\\site-packages\\flair\\models\\language_model.py\", line 394, in <genexpr>    \r\n    for info in torch.__version__.split('.'))\r\nValueError: invalid literal for int() with base 10: '0+cpu'\r\n\r\n\r\nEnvironment.:\r\npython : 3.76\r\ntorch 1.40\r\n\r\nBug as follows:\r\nfor info in torch.__version__.split('.'))\r\nValueError: invalid literal for int() with base 10: '0+cpu'\r\n\r\ntorch.__version__.split('.') returns below list but it is trying to convert 0+cpu to int which is raising error.\r\n['1', '4', '0+cpu']\r\n\r\nIssue in file.:\r\nflair\\models\\language_model.py\r\ndef _apply(self, fn):\r\n        **major, minor, build, *_ = (int(info)\r\n                                for info in torch.__version__.split('.'))**", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1388/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1388/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1385", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1385/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1385/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1385/events", "html_url": "https://github.com/flairNLP/flair/issues/1385", "id": 555091456, "node_id": "MDU6SXNzdWU1NTUwOTE0NTY=", "number": 1385, "title": "Continuing Comptibility Issues ", "user": {"login": "cap-jmk", "id": 60146151, "node_id": "MDQ6VXNlcjYwMTQ2MTUx", "avatar_url": "https://avatars.githubusercontent.com/u/60146151?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cap-jmk", "html_url": "https://github.com/cap-jmk", "followers_url": "https://api.github.com/users/cap-jmk/followers", "following_url": "https://api.github.com/users/cap-jmk/following{/other_user}", "gists_url": "https://api.github.com/users/cap-jmk/gists{/gist_id}", "starred_url": "https://api.github.com/users/cap-jmk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cap-jmk/subscriptions", "organizations_url": "https://api.github.com/users/cap-jmk/orgs", "repos_url": "https://api.github.com/users/cap-jmk/repos", "events_url": "https://api.github.com/users/cap-jmk/events{/privacy}", "received_events_url": "https://api.github.com/users/cap-jmk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-01-25T14:26:55Z", "updated_at": "2020-05-31T16:06:26Z", "closed_at": "2020-05-31T16:06:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "The bug seems similar to flairNLP/flair#1359\r\n\r\n```\r\n\r\nfrom flair.data import Sentence\r\nfrom flair.models import SequenceTagger\r\n\r\n# make a sentence\r\nsentence = Sentence('Es muss einen tieferen Grund geben.')\r\n\r\n# load the NER tagger\r\ntagger = SequenceTagger.load('de-pos-fine-grained')\r\n\r\n# run NER over sentence\r\ntagger.predict(sentence)```\r\n\r\n```---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-2-f69c06402a7b> in <module>\r\n      9 \r\n     10 # run NER over sentence\r\n---> 11 tagger.predict(sentence)\r\n     12 \r\n\r\n/usr/local/lib/python3.7/dist-packages/flair/models/sequence_tagger_model.py in predict(self, sentences, mini_batch_size, embedding_storage_mode, all_tag_prob, verbose, use_tokenizer)\r\n    356                     continue\r\n    357 \r\n--> 358                 feature: torch.Tensor = self.forward(batch)\r\n    359                 tags, all_tags = self._obtain_labels(\r\n    360                     feature=feature,\r\n\r\n/usr/local/lib/python3.7/dist-packages/flair/models/sequence_tagger_model.py in forward(self, sentences)\r\n    496     def forward(self, sentences: List[Sentence]):\r\n    497 \r\n--> 498         self.embeddings.embed(sentences)\r\n    499 \r\n    500         lengths: List[int] = [len(sentence.tokens) for sentence in sentences]\r\n\r\n/usr/local/lib/python3.7/dist-packages/flair/embeddings.py in embed(self, sentences, static_embeddings)\r\n    175 \r\n    176         for embedding in self.embeddings:\r\n--> 177             embedding.embed(sentences)\r\n    178 \r\n    179     @property\r\n\r\n/usr/local/lib/python3.7/dist-packages/flair/embeddings.py in embed(self, sentences)\r\n     94 \r\n     95         if not everything_embedded or not self.static_embeddings:\r\n---> 96             self._add_embeddings_internal(sentences)\r\n     97 \r\n     98         return sentences\r\n\r\n/usr/local/lib/python3.7/dist-packages/flair/embeddings.py in _add_embeddings_internal(self, sentences)\r\n   2636         # get hidden states from language model\r\n   2637         all_hidden_states_in_lm = self.lm.get_representation(\r\n-> 2638             text_sentences, start_marker, end_marker, self.chars_per_chunk\r\n   2639         )\r\n   2640 \r\n\r\n/usr/local/lib/python3.7/dist-packages/torch/nn/modules/module.py in __getattr__(self, name)\r\n    574                 return modules[name]\r\n    575         raise AttributeError(\"'{}' object has no attribute '{}'\".format(\r\n--> 576             type(self).__name__, name))\r\n    577 \r\n    578     def __setattr__(self, name, value):\r\n\r\nAttributeError: 'CharLMEmbeddings' object has no attribute 'chars_per_chunk'\r\n```\r\n\r\n\r\n- OS [e.g. iOS, Linux]: Ubuntu 19.10\r\n- flair version: commit a1ef91a691a9f882fb0d0bd48d04b570f6b0079b\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1385/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1385/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1377", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1377/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1377/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1377/events", "html_url": "https://github.com/flairNLP/flair/issues/1377", "id": 554576127, "node_id": "MDU6SXNzdWU1NTQ1NzYxMjc=", "number": 1377, "title": "AttributeError: 'GRU' object has no attribute '_flat_weights_names'", "user": {"login": "carlodavid012", "id": 29329735, "node_id": "MDQ6VXNlcjI5MzI5NzM1", "avatar_url": "https://avatars.githubusercontent.com/u/29329735?v=4", "gravatar_id": "", "url": "https://api.github.com/users/carlodavid012", "html_url": "https://github.com/carlodavid012", "followers_url": "https://api.github.com/users/carlodavid012/followers", "following_url": "https://api.github.com/users/carlodavid012/following{/other_user}", "gists_url": "https://api.github.com/users/carlodavid012/gists{/gist_id}", "starred_url": "https://api.github.com/users/carlodavid012/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/carlodavid012/subscriptions", "organizations_url": "https://api.github.com/users/carlodavid012/orgs", "repos_url": "https://api.github.com/users/carlodavid012/repos", "events_url": "https://api.github.com/users/carlodavid012/events{/privacy}", "received_events_url": "https://api.github.com/users/carlodavid012/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-01-24T07:01:50Z", "updated_at": "2020-01-27T11:21:49Z", "closed_at": "2020-01-24T13:46:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "There is error when loading a text classifier, \r\n\r\n\r\nCode:\r\n\r\n```\r\nfrom flair.models import TextClassifier\r\n\r\nclassifier = TextClassifier.load('en-sentiment')\r\n```\r\n\r\nError:\r\n\r\n```\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-4-f517a501f1cf> in <module>\r\n----> 1 classifier = TextClassifier.load('en-sentiment')\r\n\r\n~/Desktop/flair/flair/nn.py in load(cls, model)\r\n     86             state = torch.load(f, map_location=flair.device)\r\n     87 \r\n---> 88         model = cls._init_model_with_state_dict(state)\r\n     89 \r\n     90         model.eval()\r\n\r\n~/Desktop/flair/flair/models/text_classification_model.py in _init_model_with_state_dict(state)\r\n    129             multi_label=state[\"multi_label\"],\r\n    130             beta=beta,\r\n--> 131             loss_weights=weights,\r\n    132         )\r\n    133 \r\n\r\n~/Desktop/flair/flair/models/text_classification_model.py in __init__(self, document_embeddings, label_dictionary, multi_label, multi_label_threshold, beta, loss_weights)\r\n     90 \r\n     91         # auto-spawn on GPU if available\r\n---> 92         self.to(flair.device)\r\n     93 \r\n     94     def _init_weights(self):\r\n\r\n~/.local/lib/python3.6/site-packages/torch/nn/modules/module.py in to(self, *args, **kwargs)\r\n    423             return t.to(device, dtype if t.is_floating_point() else None, non_blocking)\r\n    424 \r\n--> 425         return self._apply(convert)\r\n    426 \r\n    427     def register_backward_hook(self, hook):\r\n\r\n~/.local/lib/python3.6/site-packages/torch/nn/modules/module.py in _apply(self, fn)\r\n    199     def _apply(self, fn):\r\n    200         for module in self.children():\r\n--> 201             module._apply(fn)\r\n    202 \r\n    203         def compute_should_use_set_data(tensor, tensor_applied):\r\n\r\n~/.local/lib/python3.6/site-packages/torch/nn/modules/module.py in _apply(self, fn)\r\n    199     def _apply(self, fn):\r\n    200         for module in self.children():\r\n--> 201             module._apply(fn)\r\n    202 \r\n    203         def compute_should_use_set_data(tensor, tensor_applied):\r\n\r\n~/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py in _apply(self, fn)\r\n    135         # Note: be v. careful before removing this, as 3rd party device types\r\n    136         # likely rely on this behavior to properly .to() modules like LSTM.\r\n--> 137         self._flat_weights = [getattr(self, weight) for weight in self._flat_weights_names]\r\n    138 \r\n    139         # Flattens params (on CUDA)\r\n\r\n~/.local/lib/python3.6/site-packages/torch/nn/modules/module.py in __getattr__(self, name)\r\n    574                 return modules[name]\r\n    575         raise AttributeError(\"'{}' object has no attribute '{}'\".format(\r\n--> 576             type(self).__name__, name))\r\n    577 \r\n    578     def __setattr__(self, name, value):\r\n\r\nAttributeError: 'GRU' object has no attribute '_flat_weights_names'\r\n\r\n```\r\n\r\n\r\n\r\n\r\n**Environment**\r\n - Ubuntu 18.04\r\n - Version: 0.4.4\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1377/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1377/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1371", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1371/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1371/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1371/events", "html_url": "https://github.com/flairNLP/flair/issues/1371", "id": 554064500, "node_id": "MDU6SXNzdWU1NTQwNjQ1MDA=", "number": 1371, "title": "Plotter throws error if test loss is not monitored", "user": {"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-01-23T10:20:42Z", "updated_at": "2020-01-23T11:23:12Z", "closed_at": "2020-01-23T11:23:12Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "The Plotter method to plot training curves currently throws an error (\r\n`ValueError: 'TEST_LOSS' is not in list`) if test loss is not monitored during training. \r\n\r\nTo reproduce:\r\n\r\n```python\r\ntrainer: ModelTrainer = ModelTrainer(tagger, corpus)\r\n\r\ntrainer.train(\r\n    \"resources/taggers/example-ner\",\r\n    max_epochs=1,\r\n)\r\n\r\nplotter = Plotter()\r\nplotter.plot_training_curves(\"resources/taggers/example-ner/loss.tsv\")\r\n```\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1371/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1371/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1366", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1366/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1366/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1366/events", "html_url": "https://github.com/flairNLP/flair/issues/1366", "id": 552344120, "node_id": "MDU6SXNzdWU1NTIzNDQxMjA=", "number": 1366, "title": "document_embeddings gives an unexpected error using RoBERTa model", "user": {"login": "trokhymovych", "id": 33522867, "node_id": "MDQ6VXNlcjMzNTIyODY3", "avatar_url": "https://avatars.githubusercontent.com/u/33522867?v=4", "gravatar_id": "", "url": "https://api.github.com/users/trokhymovych", "html_url": "https://github.com/trokhymovych", "followers_url": "https://api.github.com/users/trokhymovych/followers", "following_url": "https://api.github.com/users/trokhymovych/following{/other_user}", "gists_url": "https://api.github.com/users/trokhymovych/gists{/gist_id}", "starred_url": "https://api.github.com/users/trokhymovych/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/trokhymovych/subscriptions", "organizations_url": "https://api.github.com/users/trokhymovych/orgs", "repos_url": "https://api.github.com/users/trokhymovych/repos", "events_url": "https://api.github.com/users/trokhymovych/events{/privacy}", "received_events_url": "https://api.github.com/users/trokhymovych/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-01-20T14:46:00Z", "updated_at": "2020-05-24T12:38:16Z", "closed_at": "2020-05-24T12:38:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "document_embeddings gives an error \"IndexError: index 0 is out of bounds for dimension 0 with size 0\" for some sentences using RoBERTa model. \r\n\r\nIt appears using both DocumentRNNEmbeddings and DocumentPoolEmbeddings \r\n\r\n**To Reproduce**\r\n\r\n```\r\nfrom flair.embeddings import WordEmbeddings, FlairEmbeddings, DocumentPoolEmbeddings, Sentence, DocumentRNNEmbeddings\r\nfrom flair.embeddings import RoBERTaEmbeddings\r\nembedding = RoBERTaEmbeddings(pooling_operation=\"mean\")\r\ndocument_embeddings_roberta = DocumentRNNEmbeddings([embedding]) #, fine_tune_mode='nonlinear')\r\ns = 'negative reconnaissance it' \r\nsentence = Sentence(s)\r\ndocument_embeddings_roberta.embed(sentence)\r\nvector = sentence.get_embedding()\r\nvector\r\n```\r\n\r\n\r\n**Expected behavior**\r\nI expect to get a vector of embedding in the form of Tensor. \r\n\r\n**Screenshots**\r\n![image](https://user-images.githubusercontent.com/33522867/72734118-d22a9180-3ba1-11ea-8495-939103636637.png)\r\n![image](https://user-images.githubusercontent.com/33522867/72735254-1dde3a80-3ba4-11ea-9c55-905756d5d052.png)\r\n\r\n\r\n## However...\r\nIf I add a \".\" at the end of the sentence - it is starting to perform as expected.\r\n![image](https://user-images.githubusercontent.com/33522867/72734383-38171900-3ba2-11ea-96e5-89fd9411584d.png)\r\ncode:\r\n```\r\nfrom flair.embeddings import WordEmbeddings, FlairEmbeddings, DocumentPoolEmbeddings, Sentence,DocumentRNNEmbeddings\r\nfrom flair.embeddings import RoBERTaEmbeddings\r\nembedding = RoBERTaEmbeddings(pooling_operation=\"mean\")\r\ndocument_embeddings_roberta = DocumentRNNEmbeddings([embedding]) #, fine_tune_mode='nonlinear')\r\ns = 'negative reconnaissance it.' \r\nsentence = Sentence(s)\r\ndocument_embeddings_roberta.embed(sentence)\r\nvector = sentence.get_embedding()\r\nvector\r\n```\r\n\r\n**Environment (please complete the following information):**\r\nUbuntu\r\n![image](https://user-images.githubusercontent.com/33522867/72735009-a7413d00-3ba3-11ea-9320-c6befc904f1f.png)\r\n\r\n\r\n\r\n**Additional context**\r\nWhat is interesting that there is no such behavior using the BERT model.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1366/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1366/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1365", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1365/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1365/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1365/events", "html_url": "https://github.com/flairNLP/flair/issues/1365", "id": 552207176, "node_id": "MDU6SXNzdWU1NTIyMDcxNzY=", "number": 1365, "title": "nl-ner model gives AttributeError: 'CharLMEmbeddings' object has no attribute 'chars_per_chunk'", "user": {"login": "jvdzwaan", "id": 4788897, "node_id": "MDQ6VXNlcjQ3ODg4OTc=", "avatar_url": "https://avatars.githubusercontent.com/u/4788897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvdzwaan", "html_url": "https://github.com/jvdzwaan", "followers_url": "https://api.github.com/users/jvdzwaan/followers", "following_url": "https://api.github.com/users/jvdzwaan/following{/other_user}", "gists_url": "https://api.github.com/users/jvdzwaan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvdzwaan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvdzwaan/subscriptions", "organizations_url": "https://api.github.com/users/jvdzwaan/orgs", "repos_url": "https://api.github.com/users/jvdzwaan/repos", "events_url": "https://api.github.com/users/jvdzwaan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvdzwaan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2020-01-20T10:25:47Z", "updated_at": "2020-06-12T12:11:34Z", "closed_at": "2020-06-11T16:07:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n\r\nWhen I try to tag a sentence with the `nl-ner` model, I get the following error message: `AttributeError: 'CharLMEmbeddings' object has no attribute 'chars_per_chunk'`\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-8-38968e7669bc> in <module>\r\n      5 \r\n      6 # predict NER tags\r\n----> 7 tagger.predict(sentence)\r\n      8 \r\n      9 # print sentence with predicted tags\r\n\r\n~/code/flair/flair/models/sequence_tagger_model.py in predict(self, sentences, mini_batch_size, embedding_storage_mode, all_tag_prob, verbose, use_tokenizer)\r\n    331                     continue\r\n    332 \r\n--> 333                 feature: torch.Tensor = self.forward(batch)\r\n    334                 tags, all_tags = self._obtain_labels(\r\n    335                     feature=feature,\r\n\r\n~/code/flair/flair/models/sequence_tagger_model.py in forward(self, sentences)\r\n    471     def forward(self, sentences: List[Sentence]):\r\n    472 \r\n--> 473         self.embeddings.embed(sentences)\r\n    474 \r\n    475         lengths: List[int] = [len(sentence.tokens) for sentence in sentences]\r\n\r\n~/code/flair/flair/embeddings.py in embed(self, sentences, static_embeddings)\r\n    175 \r\n    176         for embedding in self.embeddings:\r\n--> 177             embedding.embed(sentences)\r\n    178 \r\n    179     @property\r\n\r\n~/code/flair/flair/embeddings.py in embed(self, sentences)\r\n     94 \r\n     95         if not everything_embedded or not self.static_embeddings:\r\n---> 96             self._add_embeddings_internal(sentences)\r\n     97 \r\n     98         return sentences\r\n\r\n~/code/flair/flair/embeddings.py in _add_embeddings_internal(self, sentences)\r\n   2638         # get hidden states from language model\r\n   2639         all_hidden_states_in_lm = self.lm.get_representation(\r\n-> 2640             text_sentences, start_marker, end_marker, self.chars_per_chunk\r\n   2641         )\r\n   2642 \r\n\r\n~/anaconda3/envs/flair/lib/python3.7/site-packages/torch/nn/modules/module.py in __getattr__(self, name)\r\n    574                 return modules[name]\r\n    575         raise AttributeError(\"'{}' object has no attribute '{}'\".format(\r\n--> 576             type(self).__name__, name))\r\n    577 \r\n    578     def __setattr__(self, name, value):\r\n\r\nAttributeError: 'CharLMEmbeddings' object has no attribute 'chars_per_chunk'\r\n```\r\n\r\n**To Reproduce**\r\n\r\n```\r\nfrom flair.models import SequenceTagger\r\nfrom flair.data import Sentence\r\n\r\n# load model\r\ntagger = SequenceTagger.load('nl-ner')\r\n\r\n# make Dutch sentence\r\nsentence = Sentence('George Washington ging naar Washington .')\r\n\r\n# predict NER tags\r\ntagger.predict(sentence)\r\n```\r\n\r\n**Expected behavior**\r\n\r\nNo error when tagging a sentence.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Mac 10.15.2\r\n - Version [e.g. flair-0.3.2]: 0.4.4\r\n\r\n**Additional context**\r\n\r\nI installed flair from #1360, because otherwise I couldn't load the model using torch 1.4.0 \r\n\r\nSearching the issues, I found #974, which might be related.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1365/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1365/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1364", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1364/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1364/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1364/events", "html_url": "https://github.com/flairNLP/flair/issues/1364", "id": 552090792, "node_id": "MDU6SXNzdWU1NTIwOTA3OTI=", "number": 1364, "title": "Error while installing flair", "user": {"login": "Umang9427", "id": 47608193, "node_id": "MDQ6VXNlcjQ3NjA4MTkz", "avatar_url": "https://avatars.githubusercontent.com/u/47608193?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Umang9427", "html_url": "https://github.com/Umang9427", "followers_url": "https://api.github.com/users/Umang9427/followers", "following_url": "https://api.github.com/users/Umang9427/following{/other_user}", "gists_url": "https://api.github.com/users/Umang9427/gists{/gist_id}", "starred_url": "https://api.github.com/users/Umang9427/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Umang9427/subscriptions", "organizations_url": "https://api.github.com/users/Umang9427/orgs", "repos_url": "https://api.github.com/users/Umang9427/repos", "events_url": "https://api.github.com/users/Umang9427/events{/privacy}", "received_events_url": "https://api.github.com/users/Umang9427/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-01-20T06:17:33Z", "updated_at": "2020-01-20T06:24:40Z", "closed_at": "2020-01-20T06:24:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "Error: Packages installed from PyPI cannot depend on packages which are not also hosted on PyPI. tiny-tokenizer depends on SudachiDict_core.\r\n\r\nHowever, SudachiDict_core is a chinese model that is also in PyPI. I keep getting this error while installing flair in any environment or version.\r\n\r\n![Screenshot from 2020-01-20 11-41-36](https://user-images.githubusercontent.com/47608193/72702968-5cf79600-3b7a-11ea-86bf-412aad87dfb1.png)\r\n ", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1364/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1364/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1358", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1358/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1358/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1358/events", "html_url": "https://github.com/flairNLP/flair/issues/1358", "id": 551664976, "node_id": "MDU6SXNzdWU1NTE2NjQ5NzY=", "number": 1358, "title": "Flair NER crashes with release of pytorch", "user": {"login": "mdrmuhaimin", "id": 418264, "node_id": "MDQ6VXNlcjQxODI2NA==", "avatar_url": "https://avatars.githubusercontent.com/u/418264?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mdrmuhaimin", "html_url": "https://github.com/mdrmuhaimin", "followers_url": "https://api.github.com/users/mdrmuhaimin/followers", "following_url": "https://api.github.com/users/mdrmuhaimin/following{/other_user}", "gists_url": "https://api.github.com/users/mdrmuhaimin/gists{/gist_id}", "starred_url": "https://api.github.com/users/mdrmuhaimin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mdrmuhaimin/subscriptions", "organizations_url": "https://api.github.com/users/mdrmuhaimin/orgs", "repos_url": "https://api.github.com/users/mdrmuhaimin/repos", "events_url": "https://api.github.com/users/mdrmuhaimin/events{/privacy}", "received_events_url": "https://api.github.com/users/mdrmuhaimin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-01-17T22:39:02Z", "updated_at": "2020-01-21T18:16:44Z", "closed_at": "2020-01-21T18:16:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nWith the new release of [Pytorch 1.4.0](https://pypi.org/project/torch/1.4.0/) flair NER crashes when we try to load the NER model\r\n\r\n**To Reproduce**\r\nRun the following code \r\n\r\n```\r\nfrom flair.data import Sentence\r\nfrom flair.models import SequenceTagger\r\n\r\ntagger = SequenceTagger.load(\"ner-fast\")\r\n```\r\n\r\n**Current Workaround**\r\ninstall a previous version of the torch before installing flair \r\n`pip install torch==1.2.0+cpu torchvision==0.4.0+cpu -f https://download.pytorch.org/whl/torch_stable.html`\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1358/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1358/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1352", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1352/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1352/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1352/events", "html_url": "https://github.com/flairNLP/flair/issues/1352", "id": 549732923, "node_id": "MDU6SXNzdWU1NDk3MzI5MjM=", "number": 1352, "title": "Questions and Bugs (training sequence tagger + hyperparameter selection)", "user": {"login": "CatarinaPC", "id": 16788365, "node_id": "MDQ6VXNlcjE2Nzg4MzY1", "avatar_url": "https://avatars.githubusercontent.com/u/16788365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CatarinaPC", "html_url": "https://github.com/CatarinaPC", "followers_url": "https://api.github.com/users/CatarinaPC/followers", "following_url": "https://api.github.com/users/CatarinaPC/following{/other_user}", "gists_url": "https://api.github.com/users/CatarinaPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/CatarinaPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CatarinaPC/subscriptions", "organizations_url": "https://api.github.com/users/CatarinaPC/orgs", "repos_url": "https://api.github.com/users/CatarinaPC/repos", "events_url": "https://api.github.com/users/CatarinaPC/events{/privacy}", "received_events_url": "https://api.github.com/users/CatarinaPC/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2020-01-14T18:10:28Z", "updated_at": "2020-05-23T04:32:01Z", "closed_at": "2020-05-23T04:32:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm going to use this issue (bug report) to not only present some bugs I found as well as some questions.\r\n\r\n1. After training a model (sequence tagger), testing is performed using the best model and the test set. What are those three values shown in the last line from this excerpt of the training output?\r\n\r\n```\r\n2020-01-12 09:41:12,567 Testing using best model ...\r\n2020-01-12 09:41:12,567 loading file ../models/flair/default/best-model.pt\r\n2020-01-12 09:41:38,126 0.7877\t0.7698\t0.7786\r\n...\r\n```\r\n\r\n2. Is it \"normal\" for the training of a model to take 7 hours? I used all default parameters and as for word embedding I used French FastText embeddings. My corpus is made up of:\r\n`Corpus: \"Corpus: 46133 train + 14417 dev + 11534 test sentences\"`\r\n(It also ran until 87 epochs)\r\n\r\nI also tried using as word embeddings Camembert (with all other parameters as default) and just one epoch took 30m. Is this expected?\r\n\r\n(Sorry if my questions are not very good, I'm still a newbie in ML)\r\n\r\n3. When performing hyperparameter selection, what is an acceptable number of max_epochs, training_runs and max_evals? \r\n\r\n4. I wanted do perform hyperparameter selection. I found all word embedding that could work with French from your docs and added them to the search space:\r\n\r\n```\r\nsearch_space.add(Parameter.EMBEDDINGS, hp.choice, options=[\r\n        WordEmbeddings('fr'),\r\n        StackedEmbeddings([FlairEmbeddings('fr-forward'), FlairEmbeddings('fr-backward')]),\r\n        StackedEmbeddings([\r\n            WordEmbeddings('fr'),\r\n            FlairEmbeddings('fr-forward'),\r\n            FlairEmbeddings('fr-backward'),\r\n        ]),\r\n        StackedEmbeddings([WordEmbeddings('fr'), CharacterEmbeddings()]),\r\n        BytePairEmbeddings('fr'),\r\n        BytePairEmbeddings('multi'),\r\n        CamembertEmbeddings(),\r\n        BertEmbeddings('bert-base-multilingual-cased'),\r\n        BertEmbeddings('distilbert-base-multilingual-cased'),\r\n        XLMEmbeddings('xlm-mlm-enfr-1024'),\r\n        XLMEmbeddings('xlm-clm-enfr-1024'),\r\n        XLMEmbeddings('xlm-mlm-xnli15-1024'),\r\n\r\n        XLMEmbeddings('xlm-mlm-tlm-xnli15-1024'),\r\n        XLMEmbeddings('xlm-mlm-17-1280'),\r\n        XLMEmbeddings('xlm-mlm-100-1280'),\r\n        XLMRobertaEmbeddings('xlm-roberta-base'),\r\n        XLMRobertaEmbeddings('xlm-roberta-large')\r\n    ])\r\n```\r\n\r\nBut when I run the code, and they are being added to the search space, a CUDA out of memory error occurs:\r\n\r\n`RuntimeError: CUDA out of memory. Tried to allocate 16.00 MiB (GPU 0; 3.95 GiB total capacity; 3.04 GiB already allocated; 11.50 MiB free; 32.36 MiB cached)`\r\n\r\nSpecifically while loading the `XLMEmbeddings('xlm-mlm-tlm-xnli15-1024')`. But I tried changing the order to see if it was caused by these word embeddings in particular and I found it is not.\r\n\r\nWhen I comment for example the last 5 embeddings the code is able to run.\r\n\r\n5. When trying to use XLMEmbeddings('xlm-mlm-enfr-1024'), I get the following error before the first epoch even begins:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/catarinapc/cl-extraction-models/eval/eval_flair.py\", line 192, in <module>\r\n    param_selection(\"../datasets/\", {'train': 'train/train_quaero.bio', 'test': 'test/test_quaero.bio', 'dev': 'dev/dev_quaero.bio'})\r\n  File \"/home/catarinapc/cl-extraction-models/eval/eval_flair.py\", line 164, in param_selection\r\n    param_selector.optimize(search_space, max_evals=2)\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/flair/hyperparameter/param_selection.py\", line 162, in optimize\r\n    self._objective, search_space, algo=tpe.suggest, max_evals=max_evals\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/hyperopt/fmin.py\", line 422, in fmin\r\n    rval.exhaust()\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/hyperopt/fmin.py\", line 276, in exhaust\r\n    self.run(self.max_evals - n_done, block_until_done=self.asynchronous)\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/hyperopt/fmin.py\", line 241, in run\r\n    self.serial_evaluate()\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/hyperopt/fmin.py\", line 141, in serial_evaluate\r\n    result = self.domain.evaluate(spec, ctrl)\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/hyperopt/base.py\", line 856, in evaluate\r\n    rval = self.fn(pyll_rval)\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/flair/hyperparameter/param_selection.py\", line 112, in _objective\r\n    **training_params,\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/flair/trainers/trainer.py\", line 329, in train\r\n    loss = self.model.forward_loss(batch_step)\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/flair/models/sequence_tagger_model.py\", line 471, in forward_loss\r\n    features = self.forward(data_points)\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/flair/models/sequence_tagger_model.py\", line 476, in forward\r\n    self.embeddings.embed(sentences)\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/flair/embeddings.py\", line 96, in embed\r\n    self._add_embeddings_internal(sentences)\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/flair/embeddings.py\", line 1386, in _add_embeddings_internal\r\n    eos_token=\"</s>\",\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/flair/embeddings.py\", line 1199, in _get_transformer_sentence_embeddings\r\n    use_scalar_mix=use_scalar_mix,\r\n  File \"/home/catarinapc/.local/lib/python3.6/site-packages/flair/embeddings.py\", line 1044, in _extract_embeddings\r\n    first_embedding: torch.FloatTensor = current_embeddings[0]\r\nIndexError: index 0 is out of bounds for dimension 0 with size 0\r\n```\r\n\r\nI'm no sure if it only happens on this particular XLMEmbedding.\r\n\r\n6. During hyperparameter selection, all dev scores come back as 0 as well as the test results. I tried using both dev loss and dev score for the optimization value, but still get **0 in all scores**.\r\n\r\n7. If I use max_epochs=2, training_runs=1 and max_evals=1 for hyperparameter selection with the search space below, it takes super long to run just one epoch. However if I keep the same max_epochs, training_runs and max_evals but only put one word embedding in the search space, it is much faster. I don't understand why, because the number of evaluation runs is the same, meaning only one configuration will tested.\r\n\r\n```\r\n    # define your search space\r\n    search_space = SearchSpace()\r\n\r\n    # sequence tagger parameter\r\n    search_space.add(Parameter.EMBEDDINGS, hp.choice, options=[\r\n        WordEmbeddings('fr'),\r\n        StackedEmbeddings([FlairEmbeddings('fr-forward'), FlairEmbeddings('fr-backward')]),\r\n        StackedEmbeddings([\r\n            WordEmbeddings('fr'),\r\n            FlairEmbeddings('fr-forward'),\r\n            FlairEmbeddings('fr-backward'),\r\n        ]),\r\n        StackedEmbeddings([WordEmbeddings('fr'), CharacterEmbeddings()]),\r\n        BytePairEmbeddings('fr'),\r\n        BytePairEmbeddings('multi'),\r\n        CamembertEmbeddings(),\r\n        BertEmbeddings('bert-base-multilingual-cased'),\r\n        BertEmbeddings('distilbert-base-multilingual-cased'),\r\n        XLMEmbeddings('xlm-mlm-enfr-1024'),\r\n        XLMEmbeddings('xlm-clm-enfr-1024'),\r\n        XLMEmbeddings('xlm-mlm-xnli15-1024')\r\n\r\n        #XLMEmbeddings('xlm-mlm-tlm-xnli15-1024'),\r\n        #XLMEmbeddings('xlm-mlm-17-1280'),\r\n        #XLMEmbeddings('xlm-mlm-100-1280'),\r\n        #XLMRobertaEmbeddings('xlm-roberta-base'),\r\n        #XLMRobertaEmbeddings('xlm-roberta-large')\r\n    ])\r\n    search_space.add(Parameter.USE_CRF, hp.choice, options=[True, False])\r\n    search_space.add(Parameter.DROPOUT, hp.uniform, low=0.0, high=0.75)\r\n    search_space.add(Parameter.WORD_DROPOUT, hp.uniform, low=0.0, high=0.25)\r\n    search_space.add(Parameter.LOCKED_DROPOUT, hp.uniform, low=0.0, high=0.5)\r\n    search_space.add(Parameter.HIDDEN_SIZE, hp.choice, options=[32, 64, 128])\r\n    search_space.add(Parameter.RNN_LAYERS, hp.choice, options=[1, 2])\r\n\r\n    # model trainer parameter\r\n    search_space.add(Parameter.OPTIMIZER, hp.choice, options=[SGD])\r\n\r\n    # training parameter\r\n    search_space.add(Parameter.MINI_BATCH_SIZE, hp.choice, options=[4, 8, 16, 32])\r\n    search_space.add(Parameter.LEARNING_RATE, hp.uniform, low=0.01, high=1)\r\n    search_space.add(Parameter.ANNEAL_FACTOR, hp.uniform, low=0.3, high=0.75)\r\n    search_space.add(Parameter.PATIENCE, hp.choice, options=[3, 5])\r\n    search_space.add(Parameter.WEIGHT_DECAY, hp.uniform, low=0.01, high=1)\r\n```\r\n\r\n**Environment:**\r\n - OS: Ubuntu 18.04.3 LTS\r\n - Version: 0.4.4 (I think I'm using the version on the master branch)\r\n - Python version: 3.6.8", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1352/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1352/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1348", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1348/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1348/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1348/events", "html_url": "https://github.com/flairNLP/flair/issues/1348", "id": 548923475, "node_id": "MDU6SXNzdWU1NDg5MjM0NzU=", "number": 1348, "title": "ModuleNotFoundError: No module named 'flair'", "user": {"login": "somumu", "id": 36024930, "node_id": "MDQ6VXNlcjM2MDI0OTMw", "avatar_url": "https://avatars.githubusercontent.com/u/36024930?v=4", "gravatar_id": "", "url": "https://api.github.com/users/somumu", "html_url": "https://github.com/somumu", "followers_url": "https://api.github.com/users/somumu/followers", "following_url": "https://api.github.com/users/somumu/following{/other_user}", "gists_url": "https://api.github.com/users/somumu/gists{/gist_id}", "starred_url": "https://api.github.com/users/somumu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/somumu/subscriptions", "organizations_url": "https://api.github.com/users/somumu/orgs", "repos_url": "https://api.github.com/users/somumu/repos", "events_url": "https://api.github.com/users/somumu/events{/privacy}", "received_events_url": "https://api.github.com/users/somumu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-01-13T13:17:47Z", "updated_at": "2020-08-24T01:25:50Z", "closed_at": "2020-01-24T17:22:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello,\r\nI am trying to work on flair. Under virtual environment I ran the following commands on jupyter notebook:\r\n\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import ClassificationCorpus\r\n\r\nBut non of the flair related commands are working it gives always one error:\r\nModuleNotFoundError: No module named 'flair'\r\n\r\nI have already installed flair and torch but still its not running on jupyter notebook.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Linux 64-bit\r\n - Version [e.g. flair-0.3.2]: flair ==0.4.3\r\ntorch==1.1.0\r\n\r\nKindly help, \r\nThank you.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1348/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1348/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1340", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1340/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1340/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1340/events", "html_url": "https://github.com/flairNLP/flair/issues/1340", "id": 547676618, "node_id": "MDU6SXNzdWU1NDc2NzY2MTg=", "number": 1340, "title": "Tutorial 8 not working with Flair 0.4.4 on Google Colab", "user": {"login": "Otavio-Parraga", "id": 33463800, "node_id": "MDQ6VXNlcjMzNDYzODAw", "avatar_url": "https://avatars.githubusercontent.com/u/33463800?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Otavio-Parraga", "html_url": "https://github.com/Otavio-Parraga", "followers_url": "https://api.github.com/users/Otavio-Parraga/followers", "following_url": "https://api.github.com/users/Otavio-Parraga/following{/other_user}", "gists_url": "https://api.github.com/users/Otavio-Parraga/gists{/gist_id}", "starred_url": "https://api.github.com/users/Otavio-Parraga/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Otavio-Parraga/subscriptions", "organizations_url": "https://api.github.com/users/Otavio-Parraga/orgs", "repos_url": "https://api.github.com/users/Otavio-Parraga/repos", "events_url": "https://api.github.com/users/Otavio-Parraga/events{/privacy}", "received_events_url": "https://api.github.com/users/Otavio-Parraga/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-01-09T19:32:54Z", "updated_at": "2020-10-06T19:45:13Z", "closed_at": "2020-09-28T13:43:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nSo, I was running Flair tutorials on a google colab notebook and in the 8th tutorial i discovered a bug. When i run the command `param_selector.optimize(search_space, max_evals=100)` the train stops after the first run with the error: `RuntimeError: shape '[x,y,z]' is invalid for input of size \"some_number\"` \r\n\r\n*The x,y,z are numbers, usually 8,21 and 300, but they change sometimes, and some_number is a big number like 240000\r\n\r\nI could only finish the tutorial on Google Colab after change Flair version to 0.4.3\r\n\r\n**To Reproduce**\r\nRun the following lines of code, from the 8 Tutorial on a Google Colab notebook with Flair in the 0.4.4 version.\r\n```\r\nfrom flair.datasets import TREC_6\r\nfrom flair.embeddings import FlairEmbeddings, WordEmbeddings\r\nfrom hyperopt import hp\r\nfrom flair.hyperparameter.param_selection import SearchSpace, Parameter, TextClassifierParamSelector, OptimizationValue\r\n\r\ncorpus = TREC_6()\r\n\r\nsearch_space = SearchSpace()\r\nsearch_space.add(Parameter.EMBEDDINGS, hp.choice, options=[\r\n    [ WordEmbeddings('en') ]\r\n])\r\n\r\nsearch_space.add(Parameter.HIDDEN_SIZE, hp.choice, options=[32, 64, 128])\r\nsearch_space.add(Parameter.RNN_LAYERS, hp.choice, options=[1, 2])\r\nsearch_space.add(Parameter.DROPOUT, hp.uniform, low=0.0, high=0.5)\r\nsearch_space.add(Parameter.LEARNING_RATE, hp.choice, options=[0.05, 0.1, 0.15, 0.2])\r\nsearch_space.add(Parameter.MINI_BATCH_SIZE, hp.choice, options=[8, 16, 32])\r\n\r\nparam_selector = TextClassifierParamSelector(\r\n    corpus, \r\n    False, \r\n    'resources/results', \r\n    'lstm',\r\n    max_epochs=10, \r\n    training_runs=3,\r\n    optimization_value=OptimizationValue.DEV_SCORE\r\n)\r\n\r\nparam_selector.optimize(search_space, max_evals=100)\r\n```\r\n\r\nThe only thing I've changed was the `search_space.add(Parameter.EMBEDDINGS, hp.choice, options=[\r\n    [ WordEmbeddings('en') ]\r\n])` that I only used `WordEmbeddings` instead `WordEmbeddings` and both `FlairEmbeddings` as well. But that doesn't change the bug, i've tested.\r\n\r\n**Expected behavior**\r\nAfter the first training run, something like this problem will appear: `RuntimeError: shape '[32, 14, 300]' is invalid for input of size 223500`\r\n\r\n```\r\n2020-01-09 19:18:11,548 Training run: 2\r\n2020-01-09 19:18:11,557 ----------------------------------------------------------------------------------------------------\r\n2020-01-09 19:18:11,558 Model: \"TextClassifier(\r\n  (document_embeddings): DocumentRNNEmbeddings(\r\n    (embeddings): StackedEmbeddings(\r\n      (list_embedding_0): WordEmbeddings('en')\r\n    )\r\n    (word_reprojection_map): Linear(in_features=300, out_features=300, bias=True)\r\n    (rnn): GRU(300, 128, num_layers=2, batch_first=True)\r\n    (dropout): Dropout(p=0.30408081538769743, inplace=False)\r\n  )\r\n  (decoder): Linear(in_features=128, out_features=6, bias=True)\r\n  (loss_function): CrossEntropyLoss()\r\n)\"\r\n2020-01-09 19:18:11,559 ----------------------------------------------------------------------------------------------------\r\n2020-01-09 19:18:11,561 Corpus: \"Corpus: 4907 train + 545 dev + 500 test sentences\"\r\n2020-01-09 19:18:11,562 ----------------------------------------------------------------------------------------------------\r\n2020-01-09 19:18:11,563 Parameters:\r\n2020-01-09 19:18:11,564  - learning_rate: \"0.1\"\r\n2020-01-09 19:18:11,566  - mini_batch_size: \"32\"\r\n2020-01-09 19:18:11,567  - patience: \"3\"\r\n2020-01-09 19:18:11,569  - anneal_factor: \"0.5\"\r\n2020-01-09 19:18:11,570  - max_epochs: \"10\"\r\n2020-01-09 19:18:11,571  - shuffle: \"True\"\r\n2020-01-09 19:18:11,572  - train_with_dev: \"False\"\r\n2020-01-09 19:18:11,573  - batch_growth_annealing: \"False\"\r\n2020-01-09 19:18:11,574 ----------------------------------------------------------------------------------------------------\r\n2020-01-09 19:18:11,575 Model training base path: \"resources/results\"\r\n2020-01-09 19:18:11,577 ----------------------------------------------------------------------------------------------------\r\n2020-01-09 19:18:11,578 Device: cpu\r\n2020-01-09 19:18:11,579 ----------------------------------------------------------------------------------------------------\r\n2020-01-09 19:18:11,580 Embeddings storage mode: cpu\r\n2020-01-09 19:18:11,582 ----------------------------------------------------------------------------------------------------\r\n\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-8-baa23c9082a4> in <module>()\r\n     25 )\r\n     26 \r\n---> 27 param_selector.optimize(search_space, max_evals=100)\r\n\r\n11 frames\r\n/usr/local/lib/python3.6/dist-packages/flair/hyperparameter/param_selection.py in optimize(self, space, max_evals)\r\n    160         search_space = space.search_space\r\n    161         best = fmin(\r\n--> 162             self._objective, search_space, algo=tpe.suggest, max_evals=max_evals\r\n    163         )\r\n    164 \r\n\r\n/usr/local/lib/python3.6/dist-packages/hyperopt/fmin.py in fmin(fn, space, algo, max_evals, trials, rstate, allow_trials_fmin, pass_expr_memo_ctrl, catch_eval_exceptions, verbose, return_argmin, points_to_evaluate, max_queue_len, show_progressbar)\r\n    405                     show_progressbar=show_progressbar)\r\n    406     rval.catch_eval_exceptions = catch_eval_exceptions\r\n--> 407     rval.exhaust()\r\n    408     if return_argmin:\r\n    409         return trials.argmin\r\n\r\n/usr/local/lib/python3.6/dist-packages/hyperopt/fmin.py in exhaust(self)\r\n    260     def exhaust(self):\r\n    261         n_done = len(self.trials)\r\n--> 262         self.run(self.max_evals - n_done, block_until_done=self.asynchronous)\r\n    263         self.trials.refresh()\r\n    264         return self\r\n\r\n/usr/local/lib/python3.6/dist-packages/hyperopt/fmin.py in run(self, N, block_until_done)\r\n    225                     else:\r\n    226                         # -- loop over trials and do the jobs directly\r\n--> 227                         self.serial_evaluate()\r\n    228 \r\n    229                     try:\r\n\r\n/usr/local/lib/python3.6/dist-packages/hyperopt/fmin.py in serial_evaluate(self, N)\r\n    139                 ctrl = base.Ctrl(self.trials, current_trial=trial)\r\n    140                 try:\r\n--> 141                     result = self.domain.evaluate(spec, ctrl)\r\n    142                 except Exception as e:\r\n    143                     logger.info('job exception: %s' % str(e))\r\n\r\n/usr/local/lib/python3.6/dist-packages/hyperopt/base.py in evaluate(self, config, ctrl, attach_attachments)\r\n    842                 memo=memo,\r\n    843                 print_node_on_error=self.rec_eval_print_node_on_error)\r\n--> 844             rval = self.fn(pyll_rval)\r\n    845 \r\n    846         if isinstance(rval, (float, int, np.number)):\r\n\r\n/usr/local/lib/python3.6/dist-packages/flair/hyperparameter/param_selection.py in _objective(self, params)\r\n    110                 max_epochs=self.max_epochs,\r\n    111                 param_selection_mode=True,\r\n--> 112                 **training_params,\r\n    113             )\r\n    114 \r\n\r\n/usr/local/lib/python3.6/dist-packages/flair/trainers/trainer.py in train(self, base_path, learning_rate, mini_batch_size, mini_batch_chunk_size, max_epochs, anneal_factor, patience, min_learning_rate, train_with_dev, monitor_train, monitor_test, embeddings_storage_mode, checkpoint, save_final_model, anneal_with_restarts, batch_growth_annealing, shuffle, param_selection_mode, num_workers, sampler, use_amp, amp_opt_level, eval_on_train_fraction, eval_on_train_shuffle, **kwargs)\r\n    316 \r\n    317                         # forward pass\r\n--> 318                         loss = self.model.forward_loss(batch_step)\r\n    319 \r\n    320                         # Backward\r\n\r\n/usr/local/lib/python3.6/dist-packages/flair/models/text_classification_model.py in forward_loss(self, data_points)\r\n    115     ) -> torch.tensor:\r\n    116 \r\n--> 117         scores = self.forward(data_points)\r\n    118         return self._calculate_loss(scores, data_points)\r\n    119 \r\n\r\n/usr/local/lib/python3.6/dist-packages/flair/models/text_classification_model.py in forward(self, sentences)\r\n     80     def forward(self, sentences) -> List[List[float]]:\r\n     81 \r\n---> 82         self.document_embeddings.embed(sentences)\r\n     83 \r\n     84         text_embedding_list = [\r\n\r\n/usr/local/lib/python3.6/dist-packages/flair/embeddings.py in embed(self, sentences)\r\n     88 \r\n     89         if not everything_embedded or not self.static_embeddings:\r\n---> 90             self._add_embeddings_internal(sentences)\r\n     91 \r\n     92         return sentences\r\n\r\n/usr/local/lib/python3.6/dist-packages/flair/embeddings.py in _add_embeddings_internal(self, sentences)\r\n   2753                 len(sentences),\r\n   2754                 longest_token_sequence_in_batch,\r\n-> 2755                 self.embeddings.embedding_length,\r\n   2756             ]\r\n   2757         )\r\n\r\nRuntimeError: shape '[32, 14, 300]' is invalid for input of size 223500\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: A normal runtime from Google Colab\r\n - Version [e.g. flair-0.3.2]: flair-0.4.4\r\n\r\n**Additional context**\r\nThis **only happens** on Google Colab, when i use my machine everything goes normally.\r\n\r\nThanks!", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1340/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1340/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1327", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1327/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1327/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1327/events", "html_url": "https://github.com/flairNLP/flair/issues/1327", "id": 541982840, "node_id": "MDU6SXNzdWU1NDE5ODI4NDA=", "number": 1327, "title": "PyPI flair install failing", "user": {"login": "mdrmuhaimin", "id": 418264, "node_id": "MDQ6VXNlcjQxODI2NA==", "avatar_url": "https://avatars.githubusercontent.com/u/418264?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mdrmuhaimin", "html_url": "https://github.com/mdrmuhaimin", "followers_url": "https://api.github.com/users/mdrmuhaimin/followers", "following_url": "https://api.github.com/users/mdrmuhaimin/following{/other_user}", "gists_url": "https://api.github.com/users/mdrmuhaimin/gists{/gist_id}", "starred_url": "https://api.github.com/users/mdrmuhaimin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mdrmuhaimin/subscriptions", "organizations_url": "https://api.github.com/users/mdrmuhaimin/orgs", "repos_url": "https://api.github.com/users/mdrmuhaimin/repos", "events_url": "https://api.github.com/users/mdrmuhaimin/events{/privacy}", "received_events_url": "https://api.github.com/users/mdrmuhaimin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2019-12-24T04:14:56Z", "updated_at": "2020-04-07T13:12:30Z", "closed_at": "2020-01-24T17:23:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Description**\r\nPyPI flair install is failing. When we try to install `pip install flair` it failed with an error message \r\n```\r\nERROR: Packages installed from PyPI cannot depend on packages which are not also hosted on PyPI.\r\ntiny-tokenizer depends on SudachiDict_core@ https://object-storage.tyo2.conoha.io/v1/nc_2520839e1f9641b08211a5c85243124a/sudachi/SudachiDict_core-20190927.tar.gz \r\n```\r\n\r\n**To Reproduce**\r\nTemporary workaround\r\nInstall tiny-tokenizer manually before installing flair\r\n`pip install tiny-tokenizer flair`", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1327/reactions", "total_count": 18, "+1": 17, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1327/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1306", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1306/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1306/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1306/events", "html_url": "https://github.com/flairNLP/flair/issues/1306", "id": 531028938, "node_id": "MDU6SXNzdWU1MzEwMjg5Mzg=", "number": 1306, "title": "Error with transformers 2.2.0", "user": {"login": "lucaventurini", "id": 2151065, "node_id": "MDQ6VXNlcjIxNTEwNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/2151065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lucaventurini", "html_url": "https://github.com/lucaventurini", "followers_url": "https://api.github.com/users/lucaventurini/followers", "following_url": "https://api.github.com/users/lucaventurini/following{/other_user}", "gists_url": "https://api.github.com/users/lucaventurini/gists{/gist_id}", "starred_url": "https://api.github.com/users/lucaventurini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lucaventurini/subscriptions", "organizations_url": "https://api.github.com/users/lucaventurini/orgs", "repos_url": "https://api.github.com/users/lucaventurini/repos", "events_url": "https://api.github.com/users/lucaventurini/events{/privacy}", "received_events_url": "https://api.github.com/users/lucaventurini/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": {"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-12-02T10:21:13Z", "updated_at": "2020-05-28T23:49:57Z", "closed_at": "2020-05-28T23:49:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nFunction predict raises the following exception with transformers 2.2.0, on a model with bert embeddings. With previous transformers version everything is fine.\r\n\r\n```python\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/flair/models/text_classification_model.py\", line 200, in predict\r\n    scores = self.forward(batch)\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/flair/models/text_classification_model.py\", line 82, in forward\r\n    self.document_embeddings.embed(sentences)\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/flair/embeddings.py\", line 90, in embed\r\n    self._add_embeddings_internal(sentences)\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/flair/embeddings.py\", line 2701, in _add_embeddings_internal\r\n    self.embeddings.embed(sentences)\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/flair/embeddings.py\", line 171, in embed\r\n    embedding.embed(sentences)\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/flair/embeddings.py\", line 90, in embed\r\n    self._add_embeddings_internal(sentences)\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/flair/embeddings.py\", line 2109, in _add_embeddings_internal\r\n    all_encoder_layers = self.model(all_input_ids, attention_mask=all_input_masks)[\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 547, in call\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/transformers/modeling_bert.py\", line 673, in forward\r\n    if self.config.is_decoder:\r\nAttributeError: 'BertConfig' object has no attribute 'is_decoder'\r\n```\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Linux\r\n - Version: flair 0.4.4\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1306/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1306/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1302", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1302/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1302/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1302/events", "html_url": "https://github.com/flairNLP/flair/issues/1302", "id": 530386172, "node_id": "MDU6SXNzdWU1MzAzODYxNzI=", "number": 1302, "title": "Are the embedding models trainable or not ?", "user": {"login": "PradyumnaGupta", "id": 39255758, "node_id": "MDQ6VXNlcjM5MjU1NzU4", "avatar_url": "https://avatars.githubusercontent.com/u/39255758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PradyumnaGupta", "html_url": "https://github.com/PradyumnaGupta", "followers_url": "https://api.github.com/users/PradyumnaGupta/followers", "following_url": "https://api.github.com/users/PradyumnaGupta/following{/other_user}", "gists_url": "https://api.github.com/users/PradyumnaGupta/gists{/gist_id}", "starred_url": "https://api.github.com/users/PradyumnaGupta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PradyumnaGupta/subscriptions", "organizations_url": "https://api.github.com/users/PradyumnaGupta/orgs", "repos_url": "https://api.github.com/users/PradyumnaGupta/repos", "events_url": "https://api.github.com/users/PradyumnaGupta/events{/privacy}", "received_events_url": "https://api.github.com/users/PradyumnaGupta/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2019-11-29T14:57:05Z", "updated_at": "2020-09-17T19:44:35Z", "closed_at": "2020-09-17T19:44:35Z", "author_association": "NONE", "active_lock_reason": null, "body": "According to other issues that I read regarding whether the transformer embedding models available are trainable or not, it has been informed that the transformer architectures like bert,xlnet etc. are not trainable. But if I print the number of parameters with requires_grad=True corresponding to the tagger model with BertEmbeddings then 125757484 parameters show up? Please explain this !!\r\n\r\n\r\n\r\n```\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import WNUT_17\r\nfrom flair.embeddings import TokenEmbeddings, WordEmbeddings, StackedEmbeddings,BertEmbeddings\r\nfrom typing import List\r\n\r\ncorpus: Corpus = WNUT_17().downsample(0.1)\r\ntag_type = 'ner'\r\ntag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\nembedding_types: List[TokenEmbeddings] = [\r\n    BertEmbeddings(),\r\n]\r\n\r\nembeddings: StackedEmbeddings = StackedEmbeddings(embeddings=embedding_types)\r\n\r\n\r\nfrom flair.models import SequenceTagger\r\n\r\ntagger: SequenceTagger = SequenceTagger(hidden_size=256,\r\n                                        embeddings=embeddings,\r\n                                        tag_dictionary=tag_dictionary,\r\n                                        tag_type=tag_type,\r\n                                        use_crf=True)\r\n\r\ndef count_parameters(model):\r\n    return sum(p.numel() for p in model.parameters() if p.requires_grad)\r\ncount_parameters(tagger)\r\n```\r\n\r\n\r\n\r\nOutput-\r\n\r\n`125757484`\r\n\r\n\r\n\r\n**Environment:**\r\nGoogle Colab \r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1302/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1302/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1278", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1278/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1278/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1278/events", "html_url": "https://github.com/flairNLP/flair/issues/1278", "id": 524543503, "node_id": "MDU6SXNzdWU1MjQ1NDM1MDM=", "number": 1278, "title": "AttributeError: 'dict' object has no attribute 'corpus' while loading checkpoint", "user": {"login": "anuragkumar95", "id": 44536398, "node_id": "MDQ6VXNlcjQ0NTM2Mzk4", "avatar_url": "https://avatars.githubusercontent.com/u/44536398?v=4", "gravatar_id": "", "url": "https://api.github.com/users/anuragkumar95", "html_url": "https://github.com/anuragkumar95", "followers_url": "https://api.github.com/users/anuragkumar95/followers", "following_url": "https://api.github.com/users/anuragkumar95/following{/other_user}", "gists_url": "https://api.github.com/users/anuragkumar95/gists{/gist_id}", "starred_url": "https://api.github.com/users/anuragkumar95/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/anuragkumar95/subscriptions", "organizations_url": "https://api.github.com/users/anuragkumar95/orgs", "repos_url": "https://api.github.com/users/anuragkumar95/repos", "events_url": "https://api.github.com/users/anuragkumar95/events{/privacy}", "received_events_url": "https://api.github.com/users/anuragkumar95/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2019-11-18T18:34:22Z", "updated_at": "2020-08-15T17:30:28Z", "closed_at": "2020-08-15T17:30:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "This bug comes up while loading an old checkpoint. Below is the whole trace\r\nI1118 13:18:59.126918 139740913571648 file_utils.py:39] PyTorch version 1.3.1 available.\r\nI1118 13:18:59.150430 139740913571648 modeling_xlnet.py:194] Better speed can be achieved with apex installed from https://www.github.com/nvidia/apex .\r\n2019-11-18 13:18:59,205 read text file with 80675 lines\r\n2019-11-18 13:19:46,619 read text file with 100000 lines\r\nTraceback (most recent call last):\r\n  File \"LanguageModel.py\", line 41, in <module>\r\n    trainer = ModelTrainer.load_checkpoint(checkpoint, corpus)\r\n  File \"/home/anurag/anaconda3/lib/python3.7/site-packages/flair/trainers/trainer.py\", line 562, in load_checkpoint\r\n    model.corpus = corpus\r\nAttributeError: 'dict' object has no attribute 'corpus'\r\n\r\nI trained a language model. This happens after I load an old saved checkpoint.\r\nI am using Ubuntu 18.04\r\nFlair version- 0.4.4\r\n\r\nI think this error is related to this: https://github.com/zalandoresearch/flair/issues/1087", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1278/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1278/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1275", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1275/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1275/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1275/events", "html_url": "https://github.com/flairNLP/flair/issues/1275", "id": 523974144, "node_id": "MDU6SXNzdWU1MjM5NzQxNDQ=", "number": 1275, "title": "0.4.4 is breaking flair.datasets", "user": {"login": "eh-93", "id": 10990339, "node_id": "MDQ6VXNlcjEwOTkwMzM5", "avatar_url": "https://avatars.githubusercontent.com/u/10990339?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eh-93", "html_url": "https://github.com/eh-93", "followers_url": "https://api.github.com/users/eh-93/followers", "following_url": "https://api.github.com/users/eh-93/following{/other_user}", "gists_url": "https://api.github.com/users/eh-93/gists{/gist_id}", "starred_url": "https://api.github.com/users/eh-93/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eh-93/subscriptions", "organizations_url": "https://api.github.com/users/eh-93/orgs", "repos_url": "https://api.github.com/users/eh-93/repos", "events_url": "https://api.github.com/users/eh-93/events{/privacy}", "received_events_url": "https://api.github.com/users/eh-93/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-11-17T11:49:39Z", "updated_at": "2019-11-17T12:49:36Z", "closed_at": "2019-11-17T12:49:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nA clear and concise description of what the bug is.\r\n\r\n```\r\nimport flair.datasets\r\n```\r\nResults in a Module not found error:\r\nModuleNotFoundError: No module named 'flair.datasets'\r\n\r\nLooked in the package itself and don't see datasets anymore:\r\n\r\n```\r\n$ ls\r\ndata_fetcher.py  embeddings.py  hyperparameter  models  optim.py     trainers           visual\r\ndata.py          file_utils.py  __init__.py     nn.py   __pycache__  training_utils.py\r\n```\r\n\r\nTried reinstalling using pip on a fresh conda environment, same issue.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [Manjaro]:\r\n-  Python [3.6.9]\r\n - Version [flair-0.4.4]\r\n\r\nOther packages seem to be working just fine", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1275/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1275/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1270", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1270/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1270/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1270/events", "html_url": "https://github.com/flairNLP/flair/issues/1270", "id": 521393253, "node_id": "MDU6SXNzdWU1MjEzOTMyNTM=", "number": 1270, "title": "CUDA out of memory since Flair 0.4.4", "user": {"login": "jantrienes", "id": 12009072, "node_id": "MDQ6VXNlcjEyMDA5MDcy", "avatar_url": "https://avatars.githubusercontent.com/u/12009072?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jantrienes", "html_url": "https://github.com/jantrienes", "followers_url": "https://api.github.com/users/jantrienes/followers", "following_url": "https://api.github.com/users/jantrienes/following{/other_user}", "gists_url": "https://api.github.com/users/jantrienes/gists{/gist_id}", "starred_url": "https://api.github.com/users/jantrienes/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jantrienes/subscriptions", "organizations_url": "https://api.github.com/users/jantrienes/orgs", "repos_url": "https://api.github.com/users/jantrienes/repos", "events_url": "https://api.github.com/users/jantrienes/events{/privacy}", "received_events_url": "https://api.github.com/users/jantrienes/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2019-11-12T08:13:14Z", "updated_at": "2020-01-16T12:20:26Z", "closed_at": "2020-01-16T12:20:26Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nCUDA memory fills up during the first training epoch of Dutch NER model. The bug started to occur since `flair-0.4.4`. Training works as intended in `flair-0.4.3`\r\n\r\n**To Reproduce**\r\n\r\n```py\r\nfrom typing import List\r\n\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import CONLL_03_DUTCH\r\nfrom flair.embeddings import (PooledFlairEmbeddings, StackedEmbeddings,\r\n                              TokenEmbeddings, WordEmbeddings)\r\nfrom flair.models import SequenceTagger\r\nfrom flair.trainers import ModelTrainer\r\n\r\ncorpus: Corpus = CONLL_03_DUTCH()\r\ntag_type = 'ner'\r\n\r\ntag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\n\r\nembedding_types: List[TokenEmbeddings] = [\r\n    WordEmbeddings('nl'),\r\n    PooledFlairEmbeddings('dutch-forward', pooling='mean'),\r\n    PooledFlairEmbeddings('dutch-backward', pooling='mean'),\r\n]\r\n\r\nembeddings: StackedEmbeddings = StackedEmbeddings(embeddings=embedding_types)\r\n\r\ntagger: SequenceTagger = SequenceTagger(hidden_size=256,\r\n                                        embeddings=embeddings,\r\n                                        tag_dictionary=tag_dictionary,\r\n                                        tag_type=tag_type)\r\n\r\ntrainer: ModelTrainer = ModelTrainer(tagger, corpus)\r\ntrainer.train('output/models/conll03-ner/',\r\n              train_with_dev=True,\r\n              max_epochs=150)\r\n```\r\n\r\n**Environment:**\r\n   - OS: Debian GNU/Linux 9.8 (stretch) x86_64, Kernel: 4.9.0-8-amd64\r\n   - GPU: NVIDIA GeForce RTX 2080 Ti\r\n   - CUDA Version: 10.1\r\n   - Python: 3.7.3\r\n\r\nOutput of `pip freeze`:\r\n\r\n```\r\natomicwrites==1.3.0\r\nattrs==19.3.0\r\nbackcall==0.1.0\r\nboto==2.49.0\r\nboto3==1.10.15\r\nbotocore==1.13.15\r\nbpemb==0.3.0\r\ncertifi==2019.9.11\r\ncffi==1.13.2\r\nchardet==3.0.4\r\nClick==7.0\r\ncloudpickle==1.2.2\r\ncycler==0.10.0\r\nCython==0.29.14\r\ndartsclone==0.6\r\ndecorator==4.4.1\r\nDeprecated==1.2.7\r\ndocutils==0.15.2\r\nflair==0.4.4\r\nfuture==0.18.2\r\ngensim==3.8.1\r\nhyperopt==0.2.2\r\nidna==2.8\r\nimportlib-metadata==0.23\r\nipython==7.6.1\r\nipython-genutils==0.2.0\r\njedi==0.15.1\r\njmespath==0.9.4\r\njoblib==0.14.0\r\nkiwisolver==1.1.0\r\nkytea==0.1.4\r\nlangdetect==1.0.7\r\nmatplotlib==3.1.1\r\nmore-itertools==7.2.0\r\nmpld3==0.3\r\nnatto-py==0.9.0\r\nnetworkx==2.2\r\nnumpy==1.17.4\r\npackaging==19.2\r\nparso==0.5.1\r\npexpect==4.7.0\r\npickleshare==0.7.5\r\nPillow==6.2.1\r\npluggy==0.13.0\r\nprompt-toolkit==2.0.10\r\nptyprocess==0.6.0\r\npy==1.8.0\r\npycparser==2.19\r\nPygments==2.4.2\r\npymongo==3.9.0\r\npyparsing==2.4.5\r\npytest==5.2.2\r\npython-dateutil==2.8.1\r\npytorch-transformers==1.2.0\r\nregex==2019.11.1\r\nrequests==2.22.0\r\ns3transfer==0.2.1\r\nsacremoses==0.0.35\r\nscikit-learn==0.21.3\r\nscipy==1.3.2\r\nsegtok==1.5.7\r\nsentencepiece==0.1.83\r\nsix==1.13.0\r\nsklearn==0.0\r\nsmart-open==1.9.0\r\nsortedcontainers==2.1.0\r\nsqlitedict==1.6.0\r\nSudachiPy==0.4.0\r\ntabulate==0.8.5\r\ntiny-tokenizer==3.0.1\r\ntorch==1.3.1\r\ntorchvision==0.4.2\r\ntqdm==4.38.0\r\ntraitlets==4.3.3\r\ntransformers==2.1.1\r\nurllib3==1.24.3\r\nwcwidth==0.1.7\r\nwrapt==1.11.2\r\nzipp==0.6.0\r\n```\r\n\r\n**Additional context**\r\n\r\nTraining log:\r\n\r\n```\r\n2019-11-12 09:10:16,480 Reading data from /home/username/.flair/datasets/conll_03_dutch\r\n2019-11-12 09:10:16,480 Train: /home/username/.flair/datasets/conll_03_dutch/ned.train\r\n2019-11-12 09:10:16,480 Dev: /home/username/.flair/datasets/conll_03_dutch/ned.testa\r\n2019-11-12 09:10:16,480 Test: /home/username/.flair/datasets/conll_03_dutch/ned.testb\r\n2019-11-12 09:10:28,986 ----------------------------------------------------------------------------------------------------\r\n2019-11-12 09:10:28,987 Model: \"SequenceTagger(\r\n  (embeddings): StackedEmbeddings(\r\n    (list_embedding_0): WordEmbeddings('nl')\r\n    (list_embedding_1): PooledFlairEmbeddings(\r\n      (context_embeddings): FlairEmbeddings(\r\n        (lm): LanguageModel(\r\n          (drop): Dropout(p=0.1, inplace=False)\r\n          (encoder): Embedding(7632, 100)\r\n          (rnn): LSTM(100, 2048)\r\n          (decoder): Linear(in_features=2048, out_features=7632, bias=True)\r\n        )\r\n      )\r\n    )\r\n    (list_embedding_2): PooledFlairEmbeddings(\r\n      (context_embeddings): FlairEmbeddings(\r\n        (lm): LanguageModel(\r\n          (drop): Dropout(p=0.1, inplace=False)\r\n          (encoder): Embedding(7632, 100)\r\n          (rnn): LSTM(100, 2048)\r\n          (decoder): Linear(in_features=2048, out_features=7632, bias=True)\r\n        )\r\n      )\r\n    )\r\n  )\r\n  (word_dropout): WordDropout(p=0.05)\r\n  (locked_dropout): LockedDropout(p=0.5)\r\n  (embedding2nn): Linear(in_features=8492, out_features=8492, bias=True)\r\n  (rnn): LSTM(8492, 256, batch_first=True, bidirectional=True)\r\n  (linear): Linear(in_features=512, out_features=20, bias=True)\r\n)\"\r\n2019-11-12 09:10:28,987 ----------------------------------------------------------------------------------------------------\r\n2019-11-12 09:10:28,987 Corpus: \"Corpus: 15806 train + 2895 dev + 5195 test sentences\"\r\n2019-11-12 09:10:28,987 ----------------------------------------------------------------------------------------------------\r\n2019-11-12 09:10:28,987 Parameters:\r\n2019-11-12 09:10:28,987  - learning_rate: \"0.1\"\r\n2019-11-12 09:10:28,987  - mini_batch_size: \"32\"\r\n2019-11-12 09:10:28,987  - patience: \"3\"\r\n2019-11-12 09:10:28,987  - anneal_factor: \"0.5\"\r\n2019-11-12 09:10:28,987  - max_epochs: \"150\"\r\n2019-11-12 09:10:28,987  - shuffle: \"True\"\r\n2019-11-12 09:10:28,987  - train_with_dev: \"True\"\r\n2019-11-12 09:10:28,987  - batch_growth_annealing: \"False\"\r\n2019-11-12 09:10:28,987 ----------------------------------------------------------------------------------------------------\r\n2019-11-12 09:10:28,987 Model training base path: \"output/models/conll03-ner-test\"\r\n2019-11-12 09:10:28,987 ----------------------------------------------------------------------------------------------------\r\n2019-11-12 09:10:28,987 Device: cuda:0\r\n2019-11-12 09:10:28,987 ----------------------------------------------------------------------------------------------------\r\n2019-11-12 09:10:28,987 Embeddings storage mode: cpu\r\n2019-11-12 09:10:28,988 ----------------------------------------------------------------------------------------------------\r\ntrain mode resetting embeddings\r\ntrain mode resetting embeddings\r\n2019-11-12 09:10:29,408 epoch 1 - iter 0/585 - loss 49.54404449 - samples/sec: 4426.54\r\nTraceback (most recent call last):\r\n  File \"embeddings/flair_evaluate_conll03-dutch.py\", line 44, in <module>\r\n    max_epochs=150)\r\n  File \"/home/username/.conda/envs/flair-test/lib/python3.7/site-packages/flair/trainers/trainer.py\", line 325, in train\r\n    loss.backward()\r\n  File \"/home/username/.conda/envs/flair-test/lib/python3.7/site-packages/torch/tensor.py\", line 166, in backward\r\n    torch.autograd.backward(self, gradient, retain_graph, create_graph)\r\n  File \"/home/username/.conda/envs/flair-test/lib/python3.7/site-packages/torch/autograd/__init__.py\", line 99, in backward\r\n    allow_unreachable=True)  # allow_unreachable flag\r\nRuntimeError: CUDA out of memory. Tried to allocate 276.00 MiB (GPU 0; 10.73 GiB total capacity; 8.33 GiB already allocated; 121.56 MiB free; 1.43 GiB cached)\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1270/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1270/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1266", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1266/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1266/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1266/events", "html_url": "https://github.com/flairNLP/flair/issues/1266", "id": 520179702, "node_id": "MDU6SXNzdWU1MjAxNzk3MDI=", "number": 1266, "title": "BertEmbeddings unnecessarily moves embeddings to CPU", "user": {"login": "shoarora", "id": 16643856, "node_id": "MDQ6VXNlcjE2NjQzODU2", "avatar_url": "https://avatars.githubusercontent.com/u/16643856?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shoarora", "html_url": "https://github.com/shoarora", "followers_url": "https://api.github.com/users/shoarora/followers", "following_url": "https://api.github.com/users/shoarora/following{/other_user}", "gists_url": "https://api.github.com/users/shoarora/gists{/gist_id}", "starred_url": "https://api.github.com/users/shoarora/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shoarora/subscriptions", "organizations_url": "https://api.github.com/users/shoarora/orgs", "repos_url": "https://api.github.com/users/shoarora/repos", "events_url": "https://api.github.com/users/shoarora/events{/privacy}", "received_events_url": "https://api.github.com/users/shoarora/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-11-08T18:55:53Z", "updated_at": "2020-02-05T19:09:22Z", "closed_at": "2020-02-05T19:09:22Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nin `_add_embeddings_internal`, we call `.detach()` and `.cpu()` unnecessarily inside the double for-loop [here](https://github.com/zalandoresearch/flair/blob/master/flair/embeddings.py#L2203).  \r\n\r\n1. this whole block is run inside `torch.no_grad()`, so `.detach()` is basically a no-op.\r\n2. `token.set_embedding()` should handle moving the tensor to the right device.  the only reason I can think of for moving off of GPU in the loop is that you need to make room to do something else immediately, but I can't see where that would be the case, since this entire block of code is dedicated to just aggregating the correct tensors.\r\n\r\nMoving each layer's token embedding onto CPU one at a time is an unnecessary slowdown, when it could be done after all the tensors are concatenated together.  \r\n\r\n**To Reproduce**\r\n```python\r\n# in embedding.py\r\nfor token_index, _ in enumerate(feature.tokens):\r\n                    all_layers = []\r\n                    for layer_index in self.layer_indexes:\r\n                        if self.use_scalar_mix:\r\n                            layer_output = all_encoder_layers[int(layer_index)][\r\n                                sentence_index\r\n                            ]\r\n                        else:\r\n                            layer_output = (\r\n                                all_encoder_layers[int(layer_index)]\r\n                                .detach()                               # <---- remove this line\r\n                                .cpu()[sentence_index]        # <---- and this cpu() call\r\n                            )\r\n                        all_layers.append(layer_output[token_index])\r\n```\r\nToggle those two lines of code, and do a timing comparison on `BertEmbeddings.embed()`\r\n\r\n**Expected behavior**\r\nA clear and concise description of what you expected to happen.\r\n\r\nI have limited devices/environments I can test on, but from what I've seen, this should give significant speed-up in runtime.  The exact improvement is highly dependent on both batch size and sentence length since it's inside this double for-loop.  \r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Ubuntu 16.04\r\n - Version: flair-0.4.4\r\n\r\nrun on an NVIDIA T4\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n\r\nI'll try to put together a gist with the exact profiling code and outputs that I observed, but in the meantime this should be enough to begin the discussion.  Moreover, I could totally just be missing some important part of the system that explains these lines.\r\n\r\nEDIT [gist is here](https://gist.github.com/shoarora/a8aa6ac39ee814b667907ced4bfda6c9)\r\nI compared the flair runtime against just the huggingface runtime for the same model.  flair should take longer, since it runs the underlying huggingface model and does additional processing, but the `flair_runtime/huggingface_runtime` ratio decreases after removing the two lines mentioned", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1266/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1266/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1264", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1264/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1264/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1264/events", "html_url": "https://github.com/flairNLP/flair/issues/1264", "id": 518834953, "node_id": "MDU6SXNzdWU1MTg4MzQ5NTM=", "number": 1264, "title": "make_label_dictionary gives RuntimeError:  DataLoader worker (pid(s) 13768, 9540, 15920, 16408) exited unexpectedly", "user": {"login": "teresachila", "id": 57463139, "node_id": "MDQ6VXNlcjU3NDYzMTM5", "avatar_url": "https://avatars.githubusercontent.com/u/57463139?v=4", "gravatar_id": "", "url": "https://api.github.com/users/teresachila", "html_url": "https://github.com/teresachila", "followers_url": "https://api.github.com/users/teresachila/followers", "following_url": "https://api.github.com/users/teresachila/following{/other_user}", "gists_url": "https://api.github.com/users/teresachila/gists{/gist_id}", "starred_url": "https://api.github.com/users/teresachila/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/teresachila/subscriptions", "organizations_url": "https://api.github.com/users/teresachila/orgs", "repos_url": "https://api.github.com/users/teresachila/repos", "events_url": "https://api.github.com/users/teresachila/events{/privacy}", "received_events_url": "https://api.github.com/users/teresachila/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-11-06T21:53:52Z", "updated_at": "2020-05-06T19:33:02Z", "closed_at": "2020-05-06T19:33:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI have an instance of ClassificationCorpus. When calling corpus.make_label_dictionary(), it takes a while and then dies. I'm using a very small corpus:\r\nCorpus: 87 train + 12 dev + 10 test sentences\r\n\r\n**To Reproduce**\r\n```\r\ncorpus: Corpus = ClassificationCorpus(dataPath)\r\nprint(corpus)\r\nlabel_dict = corpus.make_label_dictionary()\r\n```\r\n\r\n**Expected behavior**\r\nThe method make_label_dictionary should return quickly\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Windows 10\r\n - Version: flair-0.4.4 with pyTorch 1.2.0\r\n\r\n**Error message:**\r\n```\r\nCorpus: 87 train + 12 dev + 10 test sentences\r\n2019-11-06 11:05:12,241 Computing label dictionary. Progress:\r\n  0%|          | 0/87 [00:00<?, ?it/s]Traceback (most recent call last):\r\n\r\n  File \"<ipython-input-1-6bf351ce08f9>\", line 1, in <module>\r\n    runfile('C:/xxxx/test.py', wdir='C:/xxxx)\r\n\r\n  File \"C:\\xxxx\\python-3.7.4.amd64\\lib\\site-packages\\spyder_kernels\\customize\\spydercustomize.py\", line 827, in runfile\r\n    execfile(filename, namespace)\r\n\r\n  File \"C:\\xxxx\\python-3.7.4.amd64\\lib\\site-packages\\spyder_kernels\\customize\\spydercustomize.py\", line 110, in execfile\r\n    exec(compile(f.read(), filename, 'exec'), namespace)\r\n\r\n  File \"C:/xxxx/test.py\", line 42, in <module>\r\n    label_dict = corpus.make_label_dictionary()\r\n\r\n  File \"C:\\xxxx\\python-3.7.4.amd64\\lib\\site-packages\\flair-0.4.4-py3.7.egg\\flair\\data.py\", line 1204, in make_label_dictionary\r\n    for batch in Tqdm.tqdm(iter(loader)):\r\n\r\n  File \"C:\\xxxx\\python-3.7.4.amd64\\lib\\site-packages\\tqdm\\_tqdm.py\", line 1017, in __iter__\r\n    for obj in iterable:\r\n\r\n  File \"C:\\xxxx\\python-3.7.4.amd64\\lib\\site-packages\\torch\\utils\\data\\dataloader.py\", line 804, in __next__\r\n    idx, data = self._get_data()\r\n\r\n  File \"C:\\xxxx\\python-3.7.4.amd64\\lib\\site-packages\\torch\\utils\\data\\dataloader.py\", line 771, in _get_data\r\n    success, data = self._try_get_data()\r\n\r\n  File \"C:\\xxxx\\python-3.7.4.amd64\\lib\\site-packages\\torch\\utils\\data\\dataloader.py\", line 737, in _try_get_data\r\n    raise RuntimeError('DataLoader worker (pid(s) {}) exited unexpectedly'.format(pids_str))\r\n\r\nRuntimeError: DataLoader worker (pid(s) 13768, 9540, 15920, 16408) exited unexpectedly\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1264/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1264/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1261", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1261/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1261/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1261/events", "html_url": "https://github.com/flairNLP/flair/issues/1261", "id": 517375327, "node_id": "MDU6SXNzdWU1MTczNzUzMjc=", "number": 1261, "title": "XLNet and BERT embedding sizes are bigger than the values mentioned in the original papers", "user": {"login": "0x7A31C7", "id": 48036521, "node_id": "MDQ6VXNlcjQ4MDM2NTIx", "avatar_url": "https://avatars.githubusercontent.com/u/48036521?v=4", "gravatar_id": "", "url": "https://api.github.com/users/0x7A31C7", "html_url": "https://github.com/0x7A31C7", "followers_url": "https://api.github.com/users/0x7A31C7/followers", "following_url": "https://api.github.com/users/0x7A31C7/following{/other_user}", "gists_url": "https://api.github.com/users/0x7A31C7/gists{/gist_id}", "starred_url": "https://api.github.com/users/0x7A31C7/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/0x7A31C7/subscriptions", "organizations_url": "https://api.github.com/users/0x7A31C7/orgs", "repos_url": "https://api.github.com/users/0x7A31C7/repos", "events_url": "https://api.github.com/users/0x7A31C7/events{/privacy}", "received_events_url": "https://api.github.com/users/0x7A31C7/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": {"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-11-04T20:12:00Z", "updated_at": "2020-05-06T19:32:59Z", "closed_at": "2020-05-06T19:32:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Description\r\n\r\nIn Flair, the embedding sizes for XLNet and BERT models are 2 or 4 times bigger than the values mentioned in the original papers.\r\n\r\nThe [xlnet repo](https://github.com/zihangdai/xlnet#released-models) mentions the following sizes:\r\n`xlnet-large-cased`: **1024**-hidden\r\n`xlnet-base-cased`: **768**-hidden\r\n\r\nThe [bert repo](https://github.com/google-research/bert#bert) mentions a hidden vector size of **1024** for `bert-large-uncased`.\r\n\r\n### To Reproduce\r\n\r\n```python\r\nfrom flair.embeddings import XLNetEmbeddings, BertEmbeddings\r\n\r\nxlnet_large = XLNetEmbeddings('xlnet-large-cased')\r\nxlnet_base = XLNetEmbeddings('xlnet-base-cased')\r\nbert = BertEmbeddings('bert-large-uncased')\r\n\r\nprint(f'XLNet large: {xlnet_large.embedding_length}') # Output: 2048\r\nprint(f'XLNet base: {xlnet_base.embedding_length}') # Output: 1536\r\nprint(f'BERT: {bert.embedding_length}') # Output: 4096\r\n```\r\n\r\n### Environment Info\r\n\r\n- Ubuntu\r\n- Python 3.7\r\n- Flair 0.4.3\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1261/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1261/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1254", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1254/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1254/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1254/events", "html_url": "https://github.com/flairNLP/flair/issues/1254", "id": 515165761, "node_id": "MDU6SXNzdWU1MTUxNjU3NjE=", "number": 1254, "title": "DocumentpoolEmbedding works for both cpu and gpu but documentlstmembedding doesn't work for gpu but works for cpu", "user": {"login": "martian07", "id": 36294504, "node_id": "MDQ6VXNlcjM2Mjk0NTA0", "avatar_url": "https://avatars.githubusercontent.com/u/36294504?v=4", "gravatar_id": "", "url": "https://api.github.com/users/martian07", "html_url": "https://github.com/martian07", "followers_url": "https://api.github.com/users/martian07/followers", "following_url": "https://api.github.com/users/martian07/following{/other_user}", "gists_url": "https://api.github.com/users/martian07/gists{/gist_id}", "starred_url": "https://api.github.com/users/martian07/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/martian07/subscriptions", "organizations_url": "https://api.github.com/users/martian07/orgs", "repos_url": "https://api.github.com/users/martian07/repos", "events_url": "https://api.github.com/users/martian07/events{/privacy}", "received_events_url": "https://api.github.com/users/martian07/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-10-31T05:00:44Z", "updated_at": "2020-05-06T19:32:56Z", "closed_at": "2020-05-06T19:32:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nA clear and concise description of what the bug is.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior (e.g. which model did you train? what parameters did you use? etc.).\r\n\r\n**Expected behavior**\r\nA clear and concise description of what you expected to happen.\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]:\r\n - Version [e.g. flair-0.3.2]:\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1254/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1254/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1248", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1248/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1248/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1248/events", "html_url": "https://github.com/flairNLP/flair/issues/1248", "id": 512982699, "node_id": "MDU6SXNzdWU1MTI5ODI2OTk=", "number": 1248, "title": "ner-ontonotes and chunk tagging not working", "user": {"login": "regstuff", "id": 6016831, "node_id": "MDQ6VXNlcjYwMTY4MzE=", "avatar_url": "https://avatars.githubusercontent.com/u/6016831?v=4", "gravatar_id": "", "url": "https://api.github.com/users/regstuff", "html_url": "https://github.com/regstuff", "followers_url": "https://api.github.com/users/regstuff/followers", "following_url": "https://api.github.com/users/regstuff/following{/other_user}", "gists_url": "https://api.github.com/users/regstuff/gists{/gist_id}", "starred_url": "https://api.github.com/users/regstuff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/regstuff/subscriptions", "organizations_url": "https://api.github.com/users/regstuff/orgs", "repos_url": "https://api.github.com/users/regstuff/repos", "events_url": "https://api.github.com/users/regstuff/events{/privacy}", "received_events_url": "https://api.github.com/users/regstuff/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-10-27T15:41:09Z", "updated_at": "2020-05-06T19:32:51Z", "closed_at": "2020-05-06T19:32:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\nWhen I try tagging a sentence with either ner-ontonotes or pos, i get no output.\r\nMy code is:\r\n```\r\nsentence = Sentence('Either by you or somebody, he must be punished.')\r\ntagger = SequenceTagger.load('ner-ontonotes')\r\ntagger.predict(sentence)\r\n\r\nfor entity in sentence.get_spans('ner-ontonotes'):\r\n    print(entity)\r\n```\r\nThe output is:\r\n`2019-10-27 15:40:20,275 loading file /root/.flair/models/en-ner-ontonotes-v0.4.pt`\r\n\r\nner and pos however work as expected.\r\nAny idea what I'm doing wrong.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1248/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1248/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1246", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1246/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1246/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1246/events", "html_url": "https://github.com/flairNLP/flair/issues/1246", "id": 512875579, "node_id": "MDU6SXNzdWU1MTI4NzU1Nzk=", "number": 1246, "title": "trainer.train yields \u201cValueError: num_samples should be a positive integer value, but got num_samples=0\u201d", "user": {"login": "MutuLawyer", "id": 48943483, "node_id": "MDQ6VXNlcjQ4OTQzNDgz", "avatar_url": "https://avatars.githubusercontent.com/u/48943483?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MutuLawyer", "html_url": "https://github.com/MutuLawyer", "followers_url": "https://api.github.com/users/MutuLawyer/followers", "following_url": "https://api.github.com/users/MutuLawyer/following{/other_user}", "gists_url": "https://api.github.com/users/MutuLawyer/gists{/gist_id}", "starred_url": "https://api.github.com/users/MutuLawyer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MutuLawyer/subscriptions", "organizations_url": "https://api.github.com/users/MutuLawyer/orgs", "repos_url": "https://api.github.com/users/MutuLawyer/repos", "events_url": "https://api.github.com/users/MutuLawyer/events{/privacy}", "received_events_url": "https://api.github.com/users/MutuLawyer/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-10-26T19:30:45Z", "updated_at": "2020-05-06T19:32:53Z", "closed_at": "2020-05-06T19:32:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm making a simple text classifier with Flair using Google Colab (following this link https://towardsdatascience.com/text-classification-with-state-of-the-art-nlp-library-flair-b541d7add21f)  but I've faced a mistake that I don't understand. Here is my code:\r\n```\r\ndata = pd.read_csv(dataset, header = None, encoding = \"ISO-8859-1\")\r\ndata = data[[0, 1]].rename(columns={0:\"text\", 1:\"label\"})\r\ndata.columns\r\ndata.head\r\ndata['label'] = '__label__' + data['label'].astype(str)\r\ndata.iloc[0:int(len(data)*0.8)].to_csv('train.csv', sep='\\t', index = False, header = False)\r\ndata.iloc[int(len(data)*0.8):int(len(data)*0.9)].to_csv('test.csv', sep='\\t', index = False, header = False)\r\ndata.iloc[int(len(data)*0.9):].to_csv('dev.csv', sep='\\t', index = False, header = False);\r\n\r\n!ls\r\n!pwd\r\n```\r\nThat gives me:\r\n\r\n```\r\ncontent  drive     sample_data  train.csv     weights.txt dev.csv  loss.tsv  test.csv   training.log  zip\r\n/content\r\n```\r\nBut when I proceed:\r\n```\r\nfrom flair.data_fetcher import NLPTaskDataFetcher\r\nfrom flair.embeddings import WordEmbeddings, FlairEmbeddings, DocumentLSTMEmbeddings\r\nfrom flair.models import TextClassifier\r\nfrom flair.trainers import ModelTrainer\r\nfrom pathlib import Path\r\ncorpus = NLPTaskDataFetcher.load_classification_corpus(Path('/content'), test_file='test.csv', dev_file='dev.csv', train_file='train.csv')\r\nword_embeddings = [WordEmbeddings('glove'), FlairEmbeddings('news-forward-fast'), FlairEmbeddings('news-backward-fast')]\r\ndocument_embeddings = DocumentLSTMEmbeddings(word_embeddings, hidden_size=512, reproject_words=True, reproject_words_dimension=256)\r\nclassifier = TextClassifier(document_embeddings, label_dictionary=corpus.make_label_dictionary(), multi_label=False)\r\ntrainer = ModelTrainer(classifier, corpus)\r\ntrainer.train('/content', max_epochs=10)\r\n```\r\nI got this:\r\n\r\n```\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-30-dc73d615edca> in <module>\r\n      3 classifier = TextClassifier(document_embeddings, label_dictionary=corpus.make_label_dictionary(), multi_label=False)\r\n      4 trainer = ModelTrainer(classifier, corpus)\r\n----> 5 trainer.train('/content', max_epochs=10)\r\n\r\n3 frames\r\n/usr/local/lib/python3.6/dist-packages/torch/utils/data/sampler.py in __init__(self, data_source, replacement, num_samples)\r\n     92         if not isinstance(self.num_samples, int) or self.num_samples <= 0:\r\n     93             raise ValueError(\"num_samples should be a positive integer \"\r\n---> 94                              \"value, but got num_samples={}\".format(self.num_samples))\r\n     95 \r\n     96     @property\r\n\r\nValueError: num_samples should be a positive integer value, but got num_samples=0\r\n```\r\n\r\n[Here's the link to my Colab ](https://colab.research.google.com/drive/1Jw0t9vucDZobiCVKgj4QERQcmhwl8Cwj)", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1246/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1246/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1245", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1245/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1245/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1245/events", "html_url": "https://github.com/flairNLP/flair/issues/1245", "id": 512362700, "node_id": "MDU6SXNzdWU1MTIzNjI3MDA=", "number": 1245, "title": "Startup fails non-deterministically due to transient dependency on both bson and pymongo", "user": {"login": "holgerschmeisky", "id": 56025241, "node_id": "MDQ6VXNlcjU2MDI1MjQx", "avatar_url": "https://avatars.githubusercontent.com/u/56025241?v=4", "gravatar_id": "", "url": "https://api.github.com/users/holgerschmeisky", "html_url": "https://github.com/holgerschmeisky", "followers_url": "https://api.github.com/users/holgerschmeisky/followers", "following_url": "https://api.github.com/users/holgerschmeisky/following{/other_user}", "gists_url": "https://api.github.com/users/holgerschmeisky/gists{/gist_id}", "starred_url": "https://api.github.com/users/holgerschmeisky/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/holgerschmeisky/subscriptions", "organizations_url": "https://api.github.com/users/holgerschmeisky/orgs", "repos_url": "https://api.github.com/users/holgerschmeisky/repos", "events_url": "https://api.github.com/users/holgerschmeisky/events{/privacy}", "received_events_url": "https://api.github.com/users/holgerschmeisky/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-10-25T07:56:45Z", "updated_at": "2020-04-29T21:11:27Z", "closed_at": "2020-04-29T21:11:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "First of all, thank you very much for the great work! :)\r\n\r\n**Description**\r\nFlair fails to start up under certain conditions yielding this error\r\n```\r\n  File \"/home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages/flair/datasets.py\", line 9, in <module>\r\n    import pymongo\r\n  File \"/home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages/pymongo/__init__.py\", line 77, in <module>\r\n    from pymongo.collection import ReturnDocument\r\n  File \"/home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages/pymongo/collection.py\", line 20, in <module>\r\n    from bson.code import Code\r\n  File \"/home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages/bson/code.py\", line 18, in <module>\r\n    from bson.py3compat import abc, string_type, PY3, text_type\r\nImportError: cannot import name 'abc'\r\n```\r\n\r\nThe error is described here as well in the bson project: https://github.com/py-bson/bson/issues/82\r\n\r\n**To Reproduce**\r\nThe error happens non-deterministically if dependencies get installed in the wrong order, to fix it I just restarted my build twice and on third attempt it worked.\r\n\r\n**Environment**\r\nflair-0.4.4\r\n\r\n**Root Cause**\r\nThe root cause is that Flair depends on both pymongo and bson (via hyperopt, see output of pipdeptree below). pymongo brings its own version of a bson library, so if the order of installing the dependencies is wrong, the bson library gets overwritten leading to the above error.\r\n\r\n**Suggested Fix**\r\nPyMongo is only used by MongoDataset (https://github.com/zalandoresearch/flair/blob/master/flair/datasets.py#L1186), I'd suggest to move it to its own PyPI module or a Gist.\r\n\r\n\r\npipdeptree output for flair:\r\n```\r\nflair==0.4.4\r\n  - bpemb [required: >=0.2.9, installed: 0.3.0]\r\n    - gensim [required: Any, installed: 3.8.1]\r\n      - numpy [required: >=1.11.3, installed: 1.16.4]\r\n      - scipy [required: >=0.18.1, installed: 1.3.1]\r\n        - numpy [required: >=1.13.3, installed: 1.16.4]\r\n      - six [required: >=1.5.0, installed: 1.12.0]\r\n      - smart-open [required: >=1.8.1, installed: 1.8.4]\r\n        - boto [required: >=2.32, installed: 2.49.0]\r\n        - boto3 [required: Any, installed: 1.9.50]\r\n          - botocore [required: >=1.12.50,<1.13.0, installed: 1.12.253]\r\n            - docutils [required: >=0.10,<0.16, installed: 0.15.2]\r\n            - jmespath [required: >=0.7.1,<1.0.0, installed: 0.9.4]\r\n            - python-dateutil [required: >=2.1,<3.0.0, installed: 2.8.0]\r\n              - six [required: >=1.5, installed: 1.12.0]\r\n            - urllib3 [required: >=1.20,<1.26, installed: 1.25.6]\r\n          - jmespath [required: >=0.7.1,<1.0.0, installed: 0.9.4]\r\n          - s3transfer [required: >=0.1.10,<0.2.0, installed: 0.1.13]\r\n            - botocore [required: >=1.3.0,<2.0.0, installed: 1.12.253]\r\n              - docutils [required: >=0.10,<0.16, installed: 0.15.2]\r\n              - jmespath [required: >=0.7.1,<1.0.0, installed: 0.9.4]\r\n              - python-dateutil [required: >=2.1,<3.0.0, installed: 2.8.0]\r\n                - six [required: >=1.5, installed: 1.12.0]\r\n              - urllib3 [required: >=1.20,<1.26, installed: 1.25.6]\r\n        - requests [required: Any, installed: 2.22.0]\r\n          - certifi [required: >=2017.4.17, installed: 2019.9.11]\r\n          - chardet [required: >=3.0.2,<3.1.0, installed: 3.0.4]\r\n          - idna [required: >=2.5,<2.9, installed: 2.8]\r\n          - urllib3 [required: >=1.21.1,<1.26,!=1.25.1,!=1.25.0, installed: 1.25.6]\r\n    - numpy [required: Any, installed: 1.16.4]\r\n    - requests [required: Any, installed: 2.22.0]\r\n      - certifi [required: >=2017.4.17, installed: 2019.9.11]\r\n      - chardet [required: >=3.0.2,<3.1.0, installed: 3.0.4]\r\n      - idna [required: >=2.5,<2.9, installed: 2.8]\r\n      - urllib3 [required: >=1.21.1,<1.26,!=1.25.1,!=1.25.0, installed: 1.25.6]\r\n    - sentencepiece [required: Any, installed: 0.1.83]\r\n    - tqdm [required: Any, installed: 4.31.1]\r\n  - deprecated [required: >=1.2.4, installed: 1.2.6]\r\n    - wrapt [required: >=1.10,<2, installed: 1.11.2]\r\n  - gensim [required: >=3.4.0, installed: 3.8.1]\r\n    - numpy [required: >=1.11.3, installed: 1.16.4]\r\n    - scipy [required: >=0.18.1, installed: 1.3.1]\r\n      - numpy [required: >=1.13.3, installed: 1.16.4]\r\n    - six [required: >=1.5.0, installed: 1.12.0]\r\n    - smart-open [required: >=1.8.1, installed: 1.8.4]\r\n      - boto [required: >=2.32, installed: 2.49.0]\r\n      - boto3 [required: Any, installed: 1.9.50]\r\n        - botocore [required: >=1.12.50,<1.13.0, installed: 1.12.253]\r\n          - docutils [required: >=0.10,<0.16, installed: 0.15.2]\r\n          - jmespath [required: >=0.7.1,<1.0.0, installed: 0.9.4]\r\n          - python-dateutil [required: >=2.1,<3.0.0, installed: 2.8.0]\r\n            - six [required: >=1.5, installed: 1.12.0]\r\n          - urllib3 [required: >=1.20,<1.26, installed: 1.25.6]\r\n        - jmespath [required: >=0.7.1,<1.0.0, installed: 0.9.4]\r\n        - s3transfer [required: >=0.1.10,<0.2.0, installed: 0.1.13]\r\n          - botocore [required: >=1.3.0,<2.0.0, installed: 1.12.253]\r\n            - docutils [required: >=0.10,<0.16, installed: 0.15.2]\r\n            - jmespath [required: >=0.7.1,<1.0.0, installed: 0.9.4]\r\n            - python-dateutil [required: >=2.1,<3.0.0, installed: 2.8.0]\r\n              - six [required: >=1.5, installed: 1.12.0]\r\n            - urllib3 [required: >=1.20,<1.26, installed: 1.25.6]\r\n      - requests [required: Any, installed: 2.22.0]\r\n        - certifi [required: >=2017.4.17, installed: 2019.9.11]\r\n        - chardet [required: >=3.0.2,<3.1.0, installed: 3.0.4]\r\n        - idna [required: >=2.5,<2.9, installed: 2.8]\r\n        - urllib3 [required: >=1.21.1,<1.26,!=1.25.1,!=1.25.0, installed: 1.25.6]\r\n  - hyperopt [required: >=0.1.1, installed: 0.2.1]\r\n    - bson [required: Any, installed: 0.5.8]\r\n      - python-dateutil [required: >=2.4.0, installed: 2.8.0]\r\n        - six [required: >=1.5, installed: 1.12.0]\r\n      - six [required: >=1.9.0, installed: 1.12.0]\r\n    - cloudpickle [required: Any, installed: 1.2.2]\r\n    - future [required: Any, installed: 0.18.1]\r\n    - networkx [required: ==2.2, installed: 2.2]\r\n      - decorator [required: >=4.3.0, installed: 4.4.0]\r\n    - numpy [required: Any, installed: 1.16.4]\r\n    - scipy [required: Any, installed: 1.3.1]\r\n      - numpy [required: >=1.13.3, installed: 1.16.4]\r\n    - six [required: Any, installed: 1.12.0]\r\n    - tqdm [required: Any, installed: 4.31.1]\r\n  - ipython [required: ==7.6.1, installed: 7.6.1]\r\n    - appnope [required: Any, installed: 0.1.0]\r\n    - backcall [required: Any, installed: 0.1.0]\r\n    - decorator [required: Any, installed: 4.4.0]\r\n    - jedi [required: >=0.10, installed: 0.15.1]\r\n      - parso [required: >=0.5.0, installed: 0.5.1]\r\n    - pexpect [required: Any, installed: 4.7.0]\r\n      - ptyprocess [required: >=0.5, installed: 0.6.0]\r\n    - pickleshare [required: Any, installed: 0.7.5]\r\n    - prompt-toolkit [required: >=2.0.0,<2.1.0, installed: 2.0.10]\r\n      - six [required: >=1.9.0, installed: 1.12.0]\r\n      - wcwidth [required: Any, installed: 0.1.7]\r\n    - pygments [required: Any, installed: 2.4.2]\r\n    - setuptools [required: >=18.5, installed: 40.8.0]\r\n    - traitlets [required: >=4.2, installed: 4.3.3]\r\n      - decorator [required: Any, installed: 4.4.0]\r\n      - ipython-genutils [required: Any, installed: 0.2.0]\r\n      - six [required: Any, installed: 1.12.0]\r\n  - ipython-genutils [required: ==0.2.0, installed: 0.2.0]\r\n  - langdetect [required: Any, installed: 1.0.7]\r\n    - six [required: Any, installed: 1.12.0]\r\n  - matplotlib [required: >=2.2.3, installed: 3.1.1]\r\n    - cycler [required: >=0.10, installed: 0.10.0]\r\n      - six [required: Any, installed: 1.12.0]\r\n    - kiwisolver [required: >=1.0.1, installed: 1.1.0]\r\n      - setuptools [required: Any, installed: 40.8.0]\r\n    - numpy [required: >=1.11, installed: 1.16.4]\r\n    - pyparsing [required: >=2.0.1,!=2.1.6,!=2.1.2,!=2.0.4, installed: 2.4.2]\r\n    - python-dateutil [required: >=2.1, installed: 2.8.0]\r\n      - six [required: >=1.5, installed: 1.12.0]\r\n  - mpld3 [required: ==0.3, installed: 0.3]\r\n  - pymongo [required: Any, installed: 3.9.0]\r\n  - pytest [required: >=3.6.4, installed: 5.2.1]\r\n    - atomicwrites [required: >=1.0, installed: 1.3.0]\r\n    - attrs [required: >=17.4.0, installed: 19.3.0]\r\n    - importlib-metadata [required: >=0.12, installed: 0.23]\r\n      - zipp [required: >=0.5, installed: 0.6.0]\r\n        - more-itertools [required: Any, installed: 7.2.0]\r\n    - more-itertools [required: >=4.0.0, installed: 7.2.0]\r\n    - packaging [required: Any, installed: 19.2]\r\n      - pyparsing [required: >=2.0.2, installed: 2.4.2]\r\n      - six [required: Any, installed: 1.12.0]\r\n    - pluggy [required: >=0.12,<1.0, installed: 0.13.0]\r\n      - importlib-metadata [required: >=0.12, installed: 0.23]\r\n        - zipp [required: >=0.5, installed: 0.6.0]\r\n          - more-itertools [required: Any, installed: 7.2.0]\r\n    - py [required: >=1.5.0, installed: 1.8.0]\r\n    - wcwidth [required: Any, installed: 0.1.7]\r\n  - regex [required: Any, installed: 2019.8.19]\r\n  - segtok [required: >=1.5.7, installed: 1.5.7]\r\n    - regex [required: Any, installed: 2019.8.19]\r\n  - sklearn [required: Any, installed: 0.0]\r\n    - scikit-learn [required: Any, installed: 0.21.2]\r\n      - joblib [required: >=0.11, installed: 0.14.0]\r\n      - numpy [required: >=1.11.0, installed: 1.16.4]\r\n      - scipy [required: >=0.17.0, installed: 1.3.1]\r\n        - numpy [required: >=1.13.3, installed: 1.16.4]\r\n  - sqlitedict [required: >=1.6.0, installed: 1.6.0]\r\n  - tabulate [required: Any, installed: 0.8.5]\r\n  - tiny-tokenizer [required: Any, installed: 3.0.1]\r\n  - torch [required: >=1.1.0, installed: 1.3.0.post2]\r\n    - numpy [required: Any, installed: 1.16.4]\r\n  - torchvision [required: Any, installed: 0.4.1.post2]\r\n    - numpy [required: Any, installed: 1.16.4]\r\n    - pillow [required: >=4.1.1, installed: 6.2.1]\r\n    - six [required: Any, installed: 1.12.0]\r\n    - torch [required: ==1.3.0.*, installed: 1.3.0.post2]\r\n      - numpy [required: Any, installed: 1.16.4]\r\n  - tqdm [required: >=4.26.0, installed: 4.31.1]\r\n  - transformers [required: >=2.0.0, installed: 2.1.1]\r\n    - boto3 [required: Any, installed: 1.9.50]\r\n      - botocore [required: >=1.12.50,<1.13.0, installed: 1.12.253]\r\n        - docutils [required: >=0.10,<0.16, installed: 0.15.2]\r\n        - jmespath [required: >=0.7.1,<1.0.0, installed: 0.9.4]\r\n        - python-dateutil [required: >=2.1,<3.0.0, installed: 2.8.0]\r\n          - six [required: >=1.5, installed: 1.12.0]\r\n        - urllib3 [required: >=1.20,<1.26, installed: 1.25.6]\r\n      - jmespath [required: >=0.7.1,<1.0.0, installed: 0.9.4]\r\n      - s3transfer [required: >=0.1.10,<0.2.0, installed: 0.1.13]\r\n        - botocore [required: >=1.3.0,<2.0.0, installed: 1.12.253]\r\n          - docutils [required: >=0.10,<0.16, installed: 0.15.2]\r\n          - jmespath [required: >=0.7.1,<1.0.0, installed: 0.9.4]\r\n          - python-dateutil [required: >=2.1,<3.0.0, installed: 2.8.0]\r\n            - six [required: >=1.5, installed: 1.12.0]\r\n          - urllib3 [required: >=1.20,<1.26, installed: 1.25.6]\r\n    - numpy [required: Any, installed: 1.16.4]\r\n    - regex [required: Any, installed: 2019.8.19]\r\n    - requests [required: Any, installed: 2.22.0]\r\n      - certifi [required: >=2017.4.17, installed: 2019.9.11]\r\n      - chardet [required: >=3.0.2,<3.1.0, installed: 3.0.4]\r\n      - idna [required: >=2.5,<2.9, installed: 2.8]\r\n      - urllib3 [required: >=1.21.1,<1.26,!=1.25.1,!=1.25.0, installed: 1.25.6]\r\n    - sacremoses [required: Any, installed: 0.0.35]\r\n      - click [required: Any, installed: 7.0]\r\n      - joblib [required: Any, installed: 0.14.0]\r\n      - six [required: Any, installed: 1.12.0]\r\n      - tqdm [required: Any, installed: 4.31.1]\r\n    - sentencepiece [required: Any, installed: 0.1.83]\r\n    - tqdm [required: Any, installed: 4.31.1]\r\n  - urllib3 [required: >=1.20,<1.25, installed: 1.25.6]\r\n```", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1245/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1245/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1244", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1244/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1244/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1244/events", "html_url": "https://github.com/flairNLP/flair/issues/1244", "id": 512185556, "node_id": "MDU6SXNzdWU1MTIxODU1NTY=", "number": 1244, "title": "strange warning during training", "user": {"login": "krzysztoffiok", "id": 37101271, "node_id": "MDQ6VXNlcjM3MTAxMjcx", "avatar_url": "https://avatars.githubusercontent.com/u/37101271?v=4", "gravatar_id": "", "url": "https://api.github.com/users/krzysztoffiok", "html_url": "https://github.com/krzysztoffiok", "followers_url": "https://api.github.com/users/krzysztoffiok/followers", "following_url": "https://api.github.com/users/krzysztoffiok/following{/other_user}", "gists_url": "https://api.github.com/users/krzysztoffiok/gists{/gist_id}", "starred_url": "https://api.github.com/users/krzysztoffiok/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/krzysztoffiok/subscriptions", "organizations_url": "https://api.github.com/users/krzysztoffiok/orgs", "repos_url": "https://api.github.com/users/krzysztoffiok/repos", "events_url": "https://api.github.com/users/krzysztoffiok/events{/privacy}", "received_events_url": "https://api.github.com/users/krzysztoffiok/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-10-24T21:16:32Z", "updated_at": "2019-10-30T09:18:49Z", "closed_at": "2019-10-30T09:18:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "When i started training on a new machine today i got this warning between epochs, just before starting the next epoch after printing scores on dev. Also, it appears only after the first epoch, after the 2nd and later there is no warning.\r\n\r\n2019-10-24 17:14:30,646 epoch 1 - iter 540/546 - loss 3.11813573 - samples/sec: 44.61\r\n2019-10-24 17:14:31,606 \r\n2019-10-24 17:14:31,607 EPOCH 1 done: loss 3.1156 - lr 0.2000\r\n2019-10-24 17:14:55,697 DEV : loss 2.5082967281341553 - score 0.1624\r\n2019-10-24 17:14:55,833 BAD EPOCHS (no improvement): 0\r\n/home/____/env/nlp/lib/python3.7/site-packages/torch/serialization.py:292: UserWarning: Couldn't retrieve source cod\r\ne for container of type DocumentRNNEmbeddings. It won't be checked for correctness upon loading.\r\n  \"type \" + obj.__name__ + \". It won't be checked \"\r\n\r\nFlair 0.4.3 ubuntu 19.10, pytorch-transformers 1.2.0", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1244/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1244/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1243", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1243/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1243/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1243/events", "html_url": "https://github.com/flairNLP/flair/issues/1243", "id": 512081886, "node_id": "MDU6SXNzdWU1MTIwODE4ODY=", "number": 1243, "title": "Building wheel for dartsclone (setup.py) ... error during installation", "user": {"login": "avio11", "id": 38444874, "node_id": "MDQ6VXNlcjM4NDQ0ODc0", "avatar_url": "https://avatars.githubusercontent.com/u/38444874?v=4", "gravatar_id": "", "url": "https://api.github.com/users/avio11", "html_url": "https://github.com/avio11", "followers_url": "https://api.github.com/users/avio11/followers", "following_url": "https://api.github.com/users/avio11/following{/other_user}", "gists_url": "https://api.github.com/users/avio11/gists{/gist_id}", "starred_url": "https://api.github.com/users/avio11/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/avio11/subscriptions", "organizations_url": "https://api.github.com/users/avio11/orgs", "repos_url": "https://api.github.com/users/avio11/repos", "events_url": "https://api.github.com/users/avio11/events{/privacy}", "received_events_url": "https://api.github.com/users/avio11/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2019-10-24T17:32:39Z", "updated_at": "2020-05-06T20:33:13Z", "closed_at": "2020-05-06T20:33:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "During execution of command line \"pip instal flair\" installation was unsuccesfull and \"Building wheel for dartsclone (setup.py) ... error\" message appeared.\r\n\r\nI tried installing the flair in an anaconda environment with python3.6.9 and pytorch version 1.3.0.\r\n\r\nBelow is an image of the command prompt showing the error:\r\n![image](https://user-images.githubusercontent.com/38444874/67510015-95b2cc80-f66a-11e9-9f3b-14ab39c02f32.png)\r\n\r\n\r\nEnvironment:\r\n - Ubuntu 18.04.3\r\n - python 3.6.9\r\n - pytorch 1.3.0\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1243/reactions", "total_count": 6, "+1": 6, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1243/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1241", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1241/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1241/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1241/events", "html_url": "https://github.com/flairNLP/flair/issues/1241", "id": 511136228, "node_id": "MDU6SXNzdWU1MTExMzYyMjg=", "number": 1241, "title": "Crash with error \"tensorflow: failed to get device attribute 13 for device 0\" since upgrade to 0.4.4", "user": {"login": "nsaef", "id": 11783210, "node_id": "MDQ6VXNlcjExNzgzMjEw", "avatar_url": "https://avatars.githubusercontent.com/u/11783210?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nsaef", "html_url": "https://github.com/nsaef", "followers_url": "https://api.github.com/users/nsaef/followers", "following_url": "https://api.github.com/users/nsaef/following{/other_user}", "gists_url": "https://api.github.com/users/nsaef/gists{/gist_id}", "starred_url": "https://api.github.com/users/nsaef/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nsaef/subscriptions", "organizations_url": "https://api.github.com/users/nsaef/orgs", "repos_url": "https://api.github.com/users/nsaef/repos", "events_url": "https://api.github.com/users/nsaef/events{/privacy}", "received_events_url": "https://api.github.com/users/nsaef/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-10-23T07:38:55Z", "updated_at": "2020-06-26T04:49:51Z", "closed_at": "2020-06-26T04:49:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Problem description**\r\nSince upgrading to flair 0.4.4, on import of flair or any of its submodules, my application crashes with the following output:\r\n\r\n```\r\n2019-10-23 09:22:34.826579: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll\r\n2019-10-23 09:22:44.421302: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library nvcuda.dll\r\n2019-10-23 09:22:44.421558: F tensorflow/stream_executor/lib/statusor.cc:34] Attempting to fetch value instead of handling error Internal: failed to get device attribute 13 for device 0: CUDA_ERROR_UNKNOWN: unknown error\r\n```\r\n\r\nAs this is a tensorflow error and I did not think flair used tensorflow, I tried removing the portions from my code that import tensorflow. That did not change anything. \r\nDowngrading back to flair 0.4.3 or setting the CUDA device to -1 fixed the issue.\r\n\r\n**Environment:**\r\n - OS: Windows 10\r\n - Python: 3.7.4\r\n - flair Version: 0.4.4\r\n - CUDA 10.0\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1241/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1241/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1229", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1229/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1229/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1229/events", "html_url": "https://github.com/flairNLP/flair/issues/1229", "id": 509614892, "node_id": "MDU6SXNzdWU1MDk2MTQ4OTI=", "number": 1229, "title": "Runtime error when training text classifier. RuntimeError: Expected object of backend CUDA but got backend CPU for sequence element 11 in sequence argument at position #1 'tensors'", "user": {"login": "Solid7", "id": 16846157, "node_id": "MDQ6VXNlcjE2ODQ2MTU3", "avatar_url": "https://avatars.githubusercontent.com/u/16846157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Solid7", "html_url": "https://github.com/Solid7", "followers_url": "https://api.github.com/users/Solid7/followers", "following_url": "https://api.github.com/users/Solid7/following{/other_user}", "gists_url": "https://api.github.com/users/Solid7/gists{/gist_id}", "starred_url": "https://api.github.com/users/Solid7/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Solid7/subscriptions", "organizations_url": "https://api.github.com/users/Solid7/orgs", "repos_url": "https://api.github.com/users/Solid7/repos", "events_url": "https://api.github.com/users/Solid7/events{/privacy}", "received_events_url": "https://api.github.com/users/Solid7/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-10-20T16:03:44Z", "updated_at": "2020-04-29T21:41:51Z", "closed_at": "2020-04-29T21:41:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "First time using Flair but I think I might have stumbled up on a bug or I'm doing something wrong.\r\n\r\n**Describe the bug**\r\nWhen training a simple classifier you get the following runtime error:\r\n\r\n    Traceback (most recent call last):\r\n      File \"flair_test.py\", line 53, in <module>\r\n        train_flair()\r\n      File \"flair_test.py\", line 50, in train_flair\r\n        mini_batch_size=32, anneal_factor=0.5) #, embeddings_storage_mode='gpu')\r\n      File \"C:\\Users\\foo\\Anaconda3\\envs\\py37\\lib\\site-packages\\flair\\trainers\\trainer.py\", line 318, in train\r\n        loss = self.model.forward_loss(batch_step)\r\n      File \"C:\\Users\\foo\\Anaconda3\\envs\\py37\\lib\\site-packages\\flair\\models\\text_classification_model.py\", line 117, in forward_loss\r\n        scores = self.forward(data_points)\r\n      File \"C:\\Users\\foo\\Anaconda3\\envs\\py37\\lib\\site-packages\\flair\\models\\text_classification_model.py\", line 82, in forward\r\n        self.document_embeddings.embed(sentences)\r\n      File \"C:\\Users\\foo\\Anaconda3\\envs\\py37\\lib\\site-packages\\flair\\embeddings.py\", line 2913, in embed\r\n        word_embeddings_tensor = torch.cat(word_embeddings, 0).to(flair.device)\r\n    RuntimeError: Expected object of backend CUDA but got backend CPU for sequence element 11 in sequence argument at position #1 'tensors'\r\n\r\n\r\n\r\n\r\n**To Reproduce**\r\n\r\n    import pandas as pd\r\n    import numpy as np\r\n    from sklearn.datasets import fetch_20newsgroups\r\n    from flair.data_fetcher import NLPTaskDataFetcher\r\n    from flair.embeddings import (WordEmbeddings, \r\n    FlairEmbeddings, DocumentLSTMEmbeddings, RoBERTaEmbeddings, \r\n    BertEmbeddings, DocumentPoolEmbeddings)\r\n    from flair.models import TextClassifier\r\n    from flair.trainers import ModelTrainer\r\n\r\n    # Uncomment to avoid RuntimeError\r\n    # import flair, torch\r\n    # flair.device = torch.device('cpu') \r\n\r\n    def create_dataset():\r\n        newsgroups_train = fetch_20newsgroups(subset='train')\r\n        newsgroups_test = fetch_20newsgroups(subset='test')\r\n        labels = np.array(newsgroups_test.target_names)\r\n\r\n        df_train = pd.DataFrame(dict(label=labels[newsgroups_train.target], text=newsgroups_train.data))\r\n        df_train['label'] = '__label__' + df_train['label'].astype('str')\r\n\r\n        df_test = pd.DataFrame(dict(label=labels[newsgroups_test.target], text=newsgroups_test.data))\r\n        df_test['label'] = '__label__' + df_test['label'].astype('str')\r\n\r\n        df_test = df_test.iloc[0:int(len(df_test)*0.5)]\r\n        df_dev = df_test.iloc[int(len(df_test)*0.5):]\r\n        \r\n        for df, name in zip([df_train, df_test, df_dev], ['train', 'test', 'dev']):\r\n            df.to_csv(name + '.csv', sep=' ', index=False, header=False, quotechar=' ')\r\n\r\n        corpus = NLPTaskDataFetcher.load_classification_corpus('./', train_file='train.csv', \r\n        test_file='test.csv', dev_file='dev.csv')\r\n\r\n        return corpus\r\n\r\n    def train_flair():\r\n        corpus = create_dataset()\r\n\r\n        word_embeddings = [WordEmbeddings('glove'), FlairEmbeddings('news-forward-fast'), FlairEmbeddings('news-backward-fast')]\r\n        \r\n        document_embeddings = DocumentLSTMEmbeddings(word_embeddings, hidden_size=128, reproject_words=True)\r\n\r\n        dictionary = corpus.make_label_dictionary()\r\n        classifier = TextClassifier(document_embeddings, label_dictionary=dictionary, multi_label=False)\r\n\r\n        trainer = ModelTrainer(classifier, corpus, use_tensorboard=True)\r\n        trainer.train('resources/taggers/classy', \r\n            max_epochs=25, patience=1, learning_rate=0.2, \r\n            mini_batch_size=32, anneal_factor=0.5) #, embeddings_storage_mode='gpu')\r\n\r\n    create_dataset()\r\n    train_flair()\r\n\r\n**Expected behavior**\r\nExpected no runtime error.\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - Windows\r\n - Version: flair-0.4.3\r\n\r\n**Possible fix**\r\n     emeddings.py, line 2906, add -> .to(flair.device)\r\n\r\n     # PADDING: pad shorter sentences out\r\n            for add in range(longest_token_sequence_in_batch - len(sentence.tokens)):\r\n                word_embeddings.append(\r\n                    torch.zeros(\r\n                        self.length_of_all_token_embeddings, dtype=torch.float\r\n                    ).unsqueeze(0) #.to(flair.device)\r\n                )\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1229/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1229/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1224", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1224/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1224/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1224/events", "html_url": "https://github.com/flairNLP/flair/issues/1224", "id": 508989900, "node_id": "MDU6SXNzdWU1MDg5ODk5MDA=", "number": 1224, "title": "Remove leftover print", "user": {"login": "kskarakostas", "id": 15818157, "node_id": "MDQ6VXNlcjE1ODE4MTU3", "avatar_url": "https://avatars.githubusercontent.com/u/15818157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kskarakostas", "html_url": "https://github.com/kskarakostas", "followers_url": "https://api.github.com/users/kskarakostas/followers", "following_url": "https://api.github.com/users/kskarakostas/following{/other_user}", "gists_url": "https://api.github.com/users/kskarakostas/gists{/gist_id}", "starred_url": "https://api.github.com/users/kskarakostas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kskarakostas/subscriptions", "organizations_url": "https://api.github.com/users/kskarakostas/orgs", "repos_url": "https://api.github.com/users/kskarakostas/repos", "events_url": "https://api.github.com/users/kskarakostas/events{/privacy}", "received_events_url": "https://api.github.com/users/kskarakostas/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-10-18T10:19:46Z", "updated_at": "2019-10-22T13:29:27Z", "closed_at": "2019-10-22T13:29:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhen trying to use muse embeddings, for each sentence the language code is printed.\r\n\r\n**To Reproduce**\r\nPlease have a look at: https://github.com/zalandoresearch/flair/blob/31cc245f45b38dbbc4ddfc0214a2761a45b2b3a9/flair/embeddings.py#L581\r\n\r\n**Expected behavior**\r\nTrain without printing language code for each sentence\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Linux\r\n - Version [e.g. flair-0.3.2]: flair-0.4.3\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1224/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1224/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1223", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1223/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1223/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1223/events", "html_url": "https://github.com/flairNLP/flair/issues/1223", "id": 508988121, "node_id": "MDU6SXNzdWU1MDg5ODgxMjE=", "number": 1223, "title": "Training a Text Classification Model meet \"GRU\" key error", "user": {"login": "hazardwayne", "id": 45623193, "node_id": "MDQ6VXNlcjQ1NjIzMTkz", "avatar_url": "https://avatars.githubusercontent.com/u/45623193?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hazardwayne", "html_url": "https://github.com/hazardwayne", "followers_url": "https://api.github.com/users/hazardwayne/followers", "following_url": "https://api.github.com/users/hazardwayne/following{/other_user}", "gists_url": "https://api.github.com/users/hazardwayne/gists{/gist_id}", "starred_url": "https://api.github.com/users/hazardwayne/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hazardwayne/subscriptions", "organizations_url": "https://api.github.com/users/hazardwayne/orgs", "repos_url": "https://api.github.com/users/hazardwayne/repos", "events_url": "https://api.github.com/users/hazardwayne/events{/privacy}", "received_events_url": "https://api.github.com/users/hazardwayne/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-10-18T10:15:59Z", "updated_at": "2020-05-06T20:33:05Z", "closed_at": "2020-05-06T20:33:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nKeyError: 'GRU'\r\n\r\n**To Reproduce**\r\nFollowing the tutorial at https://github.com/zalandoresearch/flair/blob/master/resources/docs/TUTORIAL_5_DOCUMENT_EMBEDDINGS.md, i encountered KeyError: 'GRU' when predicting.\r\n\r\n**Expected behavior**\r\nI have updated flair version,  directly restoring model raises with this error, but about 2 months ago everything is ok.\r\n\r\n**Screenshots**\r\n![image](https://user-images.githubusercontent.com/45623193/67078424-d9698a00-f1c3-11e9-9bdb-6ca93de881f1.png)\r\n\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: centos\r\n - Version [e.g. flair-0.3.2]: flair-0.4.2 with error\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1223/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1223/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1222", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1222/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1222/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1222/events", "html_url": "https://github.com/flairNLP/flair/issues/1222", "id": 508980924, "node_id": "MDU6SXNzdWU1MDg5ODA5MjQ=", "number": 1222, "title": "Model name 'distilbert-base-uncased' was not found in model name list.", "user": {"login": "0x01h", "id": 32897657, "node_id": "MDQ6VXNlcjMyODk3NjU3", "avatar_url": "https://avatars.githubusercontent.com/u/32897657?v=4", "gravatar_id": "", "url": "https://api.github.com/users/0x01h", "html_url": "https://github.com/0x01h", "followers_url": "https://api.github.com/users/0x01h/followers", "following_url": "https://api.github.com/users/0x01h/following{/other_user}", "gists_url": "https://api.github.com/users/0x01h/gists{/gist_id}", "starred_url": "https://api.github.com/users/0x01h/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/0x01h/subscriptions", "organizations_url": "https://api.github.com/users/0x01h/orgs", "repos_url": "https://api.github.com/users/0x01h/repos", "events_url": "https://api.github.com/users/0x01h/events{/privacy}", "received_events_url": "https://api.github.com/users/0x01h/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-10-18T10:01:50Z", "updated_at": "2019-10-22T10:22:36Z", "closed_at": "2019-10-22T10:22:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nDistilBERT embedding throws error even though it can be used in *transformers* library successfully.\r\n\r\n**To Reproduce**\r\n```python\r\nfrom flair.embeddings import BertEmbeddings\r\n\r\nBertEmbeddings('distilbert-base-uncased')\r\n```\r\n\r\n**Expected behavior**\r\n```python\r\nModel name 'distilbert-base-uncased' was not found in model name list (bert-base-uncased, bert-large-uncased, bert-base-cased, bert-large-cased, bert-base-multilingual-uncased, bert-base-multilingual-cased, bert-base-chinese, bert-base-german-cased, bert-large-uncased-whole-word-masking, bert-large-cased-whole-word-masking, bert-large-uncased-whole-word-masking-finetuned-squad, bert-large-cased-whole-word-masking-finetuned-squad, bert-base-cased-finetuned-mrpc). We assumed 'distilbert-base-uncased' was a path or url but couldn't find tokenizer filesat this path or url.\r\n\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-6-b92101fc623e> in <module>\r\n      5 #bp_embedding = BytePairEmbeddings('multi')\r\n      6 #c_embedding = CharacterEmbeddings()\r\n----> 7 b_e = BertEmbeddings('distilbert-base-uncased')\r\n      8 #embedding = ELMoEmbeddings('small')\r\n      9 #flair_embedding_forward = FlairEmbeddings('news-forward')\r\n\r\n~/miniconda3/lib/python3.6/site-packages/flair/embeddings.py in __init__(self, bert_model_or_path, layers, pooling_operation, use_scalar_mix)\r\n   1979         self.tokenizer = BertTokenizer.from_pretrained(bert_model_or_path)\r\n   1980         self.model = BertModel.from_pretrained(\r\n-> 1981             pretrained_model_name_or_path=bert_model_or_path, output_hidden_states=True\r\n   1982         )\r\n   1983         self.layer_indexes = [int(x) for x in layers.split(\",\")]\r\n\r\n~/miniconda3/lib/python3.6/site-packages/pytorch_transformers/modeling_utils.py in from_pretrained(cls, pretrained_model_name_or_path, *model_args, **kwargs)\r\n    428                 pretrained_model_name_or_path, *model_args,\r\n    429                 cache_dir=cache_dir, return_unused_kwargs=True,\r\n--> 430                 **kwargs\r\n    431             )\r\n    432         else:\r\n\r\nTypeError: 'NoneType' object is not iterable\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Linux, Ubuntu 18.04\r\n - Version [e.g. flair-0.3.2]: flair latest version.\r\n\r\n**Additional context**\r\nI've already upgraded **flair** and **transformers**, also installed them from *git*.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1222/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1222/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1221", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1221/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1221/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1221/events", "html_url": "https://github.com/flairNLP/flair/issues/1221", "id": 508979199, "node_id": "MDU6SXNzdWU1MDg5NzkxOTk=", "number": 1221, "title": "Error while using XLNet and RoBERTa embeddings but work fine with BERT embeddings", "user": {"login": "sarthusarth", "id": 17705073, "node_id": "MDQ6VXNlcjE3NzA1MDcz", "avatar_url": "https://avatars.githubusercontent.com/u/17705073?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sarthusarth", "html_url": "https://github.com/sarthusarth", "followers_url": "https://api.github.com/users/sarthusarth/followers", "following_url": "https://api.github.com/users/sarthusarth/following{/other_user}", "gists_url": "https://api.github.com/users/sarthusarth/gists{/gist_id}", "starred_url": "https://api.github.com/users/sarthusarth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sarthusarth/subscriptions", "organizations_url": "https://api.github.com/users/sarthusarth/orgs", "repos_url": "https://api.github.com/users/sarthusarth/repos", "events_url": "https://api.github.com/users/sarthusarth/events{/privacy}", "received_events_url": "https://api.github.com/users/sarthusarth/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2019-10-18T09:58:38Z", "updated_at": "2019-12-03T09:57:07Z", "closed_at": "2019-12-03T09:57:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhile training custom NER model using LSTM with CRF. The model works fine with BERT and glove but gives an error with XLNet and Roberta embeddings. \r\n\r\n  File \"/home/rajivratn/miniconda3/envs/sarthak_new/lib/python3.6/site-packages/flair/embeddings.py\", line 1116, in _get_transformer_sentence_embeddings\r\n    use_scalar_mix=use_scalar_mix,\r\n  File \"/home/rajivratn/miniconda3/envs/sarthak_new/lib/python3.6/site-packages/flair/embeddings.py\", line 975, in _extract_embeddings\r\n    first_embedding: torch.FloatTensor = current_embeddings[0]\r\nIndexError: index 0 is out of bounds for dimension 0 with size 0\r\n\r\n\r\nEnvironment (please complete the following information):\r\n- Ubuntu \r\n - Version 0.4.3\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1221/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1221/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1215", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1215/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1215/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1215/events", "html_url": "https://github.com/flairNLP/flair/issues/1215", "id": 508347402, "node_id": "MDU6SXNzdWU1MDgzNDc0MDI=", "number": 1215, "title": "Models not backward compatible - AttributeError: 'DocumentRNNEmbeddings' object has no attribute 'use_word_dropout'", "user": {"login": "tombburnell", "id": 426754, "node_id": "MDQ6VXNlcjQyNjc1NA==", "avatar_url": "https://avatars.githubusercontent.com/u/426754?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tombburnell", "html_url": "https://github.com/tombburnell", "followers_url": "https://api.github.com/users/tombburnell/followers", "following_url": "https://api.github.com/users/tombburnell/following{/other_user}", "gists_url": "https://api.github.com/users/tombburnell/gists{/gist_id}", "starred_url": "https://api.github.com/users/tombburnell/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tombburnell/subscriptions", "organizations_url": "https://api.github.com/users/tombburnell/orgs", "repos_url": "https://api.github.com/users/tombburnell/repos", "events_url": "https://api.github.com/users/tombburnell/events{/privacy}", "received_events_url": "https://api.github.com/users/tombburnell/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-10-17T09:22:47Z", "updated_at": "2020-04-29T21:40:49Z", "closed_at": "2020-04-29T21:40:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI created a model using recent Flair from Github. Then I tried to deploy it using code that was running Flair 0.4.3 and it failed to load the model with the following exception.\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/Users/tomburnell/github/news-search-mltopics/venv/lib/python3.6/site-packages/flask/app.py\", line 2446, in wsgi_app\r\n    response = self.full_dispatch_request()\r\n  File \"/Users/tomburnell/github/news-search-mltopics/venv/lib/python3.6/site-packages/flask/app.py\", line 1951, in full_dispatch_request\r\n    rv = self.handle_user_exception(e)\r\n  File \"/Users/tomburnell/github/news-search-mltopics/venv/lib/python3.6/site-packages/flask/app.py\", line 1820, in handle_user_exception\r\n    reraise(exc_type, exc_value, tb)\r\n  File \"/Users/tomburnell/github/news-search-mltopics/venv/lib/python3.6/site-packages/flask/_compat.py\", line 39, in reraise\r\n    raise value\r\n  File \"/Users/tomburnell/github/news-search-mltopics/venv/lib/python3.6/site-packages/flask/app.py\", line 1949, in full_dispatch_request\r\n    rv = self.dispatch_request()\r\n  File \"/Users/tomburnell/github/news-search-mltopics/venv/lib/python3.6/site-packages/flask/app.py\", line 1935, in dispatch_request\r\n    return self.view_functions[rule.endpoint](**req.view_args)\r\n  File \"/Users/tomburnell/github/news-search-mltopics/api.py\", line 37, in topics_predict\r\n    tags = predict.getLabel(text);\r\n  File \"/Users/tomburnell/github/news-search-mltopics/predict.py\", line 47, in getLabel\r\n    classifier.predict(sentence)\r\n  File \"/Users/tomburnell/github/news-search-mltopics/venv/lib/python3.6/site-packages/flair/models/text_classification_model.py\", line 155, in predict\r\n    scores = self.forward(batch)\r\n  File \"/Users/tomburnell/github/news-search-mltopics/venv/lib/python3.6/site-packages/flair/models/text_classification_model.py\", line 80, in forward\r\n    self.document_embeddings.embed(sentences)\r\n  File \"/Users/tomburnell/github/news-search-mltopics/venv/lib/python3.6/site-packages/flair/embeddings.py\", line 2732, in embed\r\n    if self.use_word_dropout:\r\n  File \"/Users/tomburnell/github/news-search-mltopics/venv/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 585, in __getattr__\r\n    type(self).__name__, name))\r\nAttributeError: 'DocumentRNNEmbeddings' object has no attribute 'use_word_dropout'\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1215/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1215/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1209", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1209/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1209/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1209/events", "html_url": "https://github.com/flairNLP/flair/issues/1209", "id": 506466196, "node_id": "MDU6SXNzdWU1MDY0NjYxOTY=", "number": 1209, "title": "`load_checkpoint` is not implemented in SequenceTagger?", "user": {"login": "himkt", "id": 5164000, "node_id": "MDQ6VXNlcjUxNjQwMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/5164000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/himkt", "html_url": "https://github.com/himkt", "followers_url": "https://api.github.com/users/himkt/followers", "following_url": "https://api.github.com/users/himkt/following{/other_user}", "gists_url": "https://api.github.com/users/himkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/himkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/himkt/subscriptions", "organizations_url": "https://api.github.com/users/himkt/orgs", "repos_url": "https://api.github.com/users/himkt/repos", "events_url": "https://api.github.com/users/himkt/events{/privacy}", "received_events_url": "https://api.github.com/users/himkt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-10-14T06:16:03Z", "updated_at": "2019-10-20T14:33:06Z", "closed_at": "2019-10-20T14:33:06Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nA clear and concise description of what the bug is.\r\nWhen I tried to resume training by following [a documentation](https://github.com/zalandoresearch/flair/blob/64dabf719191a2a15c2ebacfb8d6965cd9289230/resources/docs/TUTORIAL_7_TRAINING_A_MODEL.md#resuming-training), I got an error like below.\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"demo.py\", line 49, in <module>\r\n    checkpoint = tagger.load_checkpoint(Path('resources/taggers/example-ner/checkpoint.pt'))\r\n  File \"/home/ubuntu/.local/share/virtualenvs/dlhacks1021-ZzrrVfN-/lib/python3.7/site-packages/torch/nn/modules/module.py\", line 585, in __getattr__\r\n    type(self).__name__, name))\r\nAttributeError: 'SequenceTagger' object has no attribute 'load_checkpoint'\r\n```\r\n\r\n**To Reproduce**\r\n\r\nExactly the same as documentation.\r\n\r\n<details>\r\n\r\n```python\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import WNUT_17\r\nfrom flair.embeddings import TokenEmbeddings, WordEmbeddings, StackedEmbeddings\r\nfrom typing import List\r\n\r\n# 1. get the corpus\r\ncorpus: Corpus = WNUT_17().downsample(0.1)\r\n\r\n# 2. what tag do we want to predict?\r\ntag_type = 'ner'\r\n\r\n# 3. make the tag dictionary from the corpus\r\ntag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\n\r\n# 4. initialize embeddings\r\nembedding_types: List[TokenEmbeddings] = [\r\n    WordEmbeddings('glove')\r\n]\r\n\r\nembeddings: StackedEmbeddings = StackedEmbeddings(embeddings=embedding_types)\r\n\r\n# 5. initialize sequence tagger\r\nfrom flair.models import SequenceTagger\r\n\r\ntagger: SequenceTagger = SequenceTagger(hidden_size=256,\r\n                                        embeddings=embeddings,\r\n                                        tag_dictionary=tag_dictionary,\r\n                                        tag_type=tag_type,\r\n                                        use_crf=True)\r\n\r\n# 6. initialize trainer\r\nfrom flair.trainers import ModelTrainer\r\nfrom flair.training_utils import EvaluationMetric\r\n\r\ntrainer: ModelTrainer = ModelTrainer(tagger, corpus)\r\n\r\n# 7. start training\r\ntrainer.train('resources/taggers/example-ner',\r\n              learning_rate=0.1,\r\n              mini_batch_size=32,\r\n              max_epochs=1,\r\n              checkpoint=True)\r\n\r\n# 8. stop training at any point\r\n\r\n# 9. continue trainer at later point\r\nfrom pathlib import Path\r\n\r\ncheckpoint = tagger.load_checkpoint(Path('resources/taggers/example-ner/checkpoint.pt'))\r\ntrainer = ModelTrainer.load_from_checkpoint(checkpoint, corpus)\r\ntrainer.train('resources/taggers/example-ner',\r\n              learning_rate=0.1,\r\n              mini_batch_size=32,\r\n              max_epochs=1,\r\n              checkpoint=True)\r\n```\r\n\r\n</details>\r\n\r\n\r\n**Expected behavior**\r\nIt loads snapshot and resumes training.\r\n\r\n**Screenshots**\r\n<img width=\"1787\" alt=\"Screen Shot 2019-10-14 at 15 13 28\" src=\"https://user-images.githubusercontent.com/5164000/66732024-32b87d00-ee95-11e9-97d9-6a7e1b4f12f4.png\">\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Ubuntu 18.04.3 LTS\r\n - Version [e.g. flair-0.3.2]: master branch e8c0afe\r\n\r\n**Additional context**\r\n\r\nI can see `load_checkpoint` in `LanguageModel` but can't in `SequenceTagger`. \ud83e\udd14 \r\nhttps://github.com/zalandoresearch/flair/blob/799c8dc93608280b11f358b7923eda989bcc72a7/flair/models/language_model.py#L204-L234", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1209/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1209/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1190", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1190/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1190/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1190/events", "html_url": "https://github.com/flairNLP/flair/issues/1190", "id": 503385068, "node_id": "MDU6SXNzdWU1MDMzODUwNjg=", "number": 1190, "title": "OneHotEmbeddings has error in implementation", "user": {"login": "apohllo", "id": 40543, "node_id": "MDQ6VXNlcjQwNTQz", "avatar_url": "https://avatars.githubusercontent.com/u/40543?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apohllo", "html_url": "https://github.com/apohllo", "followers_url": "https://api.github.com/users/apohllo/followers", "following_url": "https://api.github.com/users/apohllo/following{/other_user}", "gists_url": "https://api.github.com/users/apohllo/gists{/gist_id}", "starred_url": "https://api.github.com/users/apohllo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apohllo/subscriptions", "organizations_url": "https://api.github.com/users/apohllo/orgs", "repos_url": "https://api.github.com/users/apohllo/repos", "events_url": "https://api.github.com/users/apohllo/events{/privacy}", "received_events_url": "https://api.github.com/users/apohllo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-10-07T11:13:53Z", "updated_at": "2019-10-08T15:04:21Z", "closed_at": "2019-10-08T15:04:21Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nThe implementation of OneHotEmbeddings for fields other than text has two issues:\r\n* the value used in the counter is the instance of the class token, not the value of the token\r\n* during the computation of embedding in `_add_embeddings_internal` the type of the field is not taken into account\r\n\r\n**To Reproduce**\r\nUse OneHotEmbedding with field other than `text` and check the contents of the dictionary, which is printed out. Should include all values with count >= 3, but only includes the `<unk>`.\r\n\r\n**Expected behavior**\r\nThe dictionary should include all values with count >= 3. During computation, the value of the specific field, not the text field should be used.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [Linux]:\r\n - Version [flair-0.4.3]:\r\n\r\n**Additional context**\r\nI will send a PR with the fix shortly.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1190/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1190/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1188", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1188/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1188/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1188/events", "html_url": "https://github.com/flairNLP/flair/issues/1188", "id": 503267766, "node_id": "MDU6SXNzdWU1MDMyNjc3NjY=", "number": 1188, "title": "Error while loading BertEmbeddings with pooling_operation = \"mean\"", "user": {"login": "dhanachandran-ezdi", "id": 11294900, "node_id": "MDQ6VXNlcjExMjk0OTAw", "avatar_url": "https://avatars.githubusercontent.com/u/11294900?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dhanachandran-ezdi", "html_url": "https://github.com/dhanachandran-ezdi", "followers_url": "https://api.github.com/users/dhanachandran-ezdi/followers", "following_url": "https://api.github.com/users/dhanachandran-ezdi/following{/other_user}", "gists_url": "https://api.github.com/users/dhanachandran-ezdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/dhanachandran-ezdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dhanachandran-ezdi/subscriptions", "organizations_url": "https://api.github.com/users/dhanachandran-ezdi/orgs", "repos_url": "https://api.github.com/users/dhanachandran-ezdi/repos", "events_url": "https://api.github.com/users/dhanachandran-ezdi/events{/privacy}", "received_events_url": "https://api.github.com/users/dhanachandran-ezdi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-10-07T07:02:12Z", "updated_at": "2019-10-20T14:32:15Z", "closed_at": "2019-10-20T14:32:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "word_embeddings = [BertEmbeddings('bert-base-uncased', pooling_operation = 'mean')]\r\n\r\n[80         if not everything_embedded or not self.static_embeddings:\r\n---> 81             self._add_embeddings_internal(sentences)\r\n     82 \r\n     83         return sentences\r\n   2141                             embedding.unsqueeze(0) for embedding in embeddings\r\n   2142                         ]\r\n-> 2143                         mean = torch.mean(torch.cat(embeddings, dim=0), dim=0)\r\n   2144                         token.set_embedding(self.name, mean)\r\n   2145 \r\n\r\nRuntimeError: expected a non-empty list of Tensors]\r\n\r\n**BUT there is no error if pooling_operation = \"first\"**", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1188/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1188/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1173", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1173/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1173/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1173/events", "html_url": "https://github.com/flairNLP/flair/issues/1173", "id": 500473924, "node_id": "MDU6SXNzdWU1MDA0NzM5MjQ=", "number": 1173, "title": "Flair Embedding CUDA error: unspecified launch failure", "user": {"login": "gittb", "id": 8284364, "node_id": "MDQ6VXNlcjgyODQzNjQ=", "avatar_url": "https://avatars.githubusercontent.com/u/8284364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gittb", "html_url": "https://github.com/gittb", "followers_url": "https://api.github.com/users/gittb/followers", "following_url": "https://api.github.com/users/gittb/following{/other_user}", "gists_url": "https://api.github.com/users/gittb/gists{/gist_id}", "starred_url": "https://api.github.com/users/gittb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gittb/subscriptions", "organizations_url": "https://api.github.com/users/gittb/orgs", "repos_url": "https://api.github.com/users/gittb/repos", "events_url": "https://api.github.com/users/gittb/events{/privacy}", "received_events_url": "https://api.github.com/users/gittb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-09-30T19:25:49Z", "updated_at": "2020-05-06T23:41:25Z", "closed_at": "2020-05-06T23:41:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhen generating many embeddings for groups of text a Cuda unspecified launch failure occurs.\r\n\r\n**To Reproduce**\r\nThe following code as used with about 500 examples of Wikipedia pages containing between 5k to 100k chars.\r\n\r\nThese strings would be were passed into function and the embedding would break at an unpredictable sample.\r\n```\r\nflair_embedding_forward = FlairEmbeddings('mix-forward')\r\nflair_embedding_backward = FlairEmbeddings('mix-backward')\r\ndocument_embeddings = DocumentPoolEmbeddings([flair_embedding_forward, flair_embedding_backward])\r\n\r\ndef get_vec(text):\r\n    sentence = Sentence(text)\r\n\r\n    document_embeddings.embed(sentence)\r\n\r\n    payload = sentence.get_embedding().detach().cpu().numpy()\r\n    return payload\r\n```\r\n\r\n\r\nHere is the full trace:\r\n```\r\nFile \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\flair\\embeddings.py\", line 2560, in embed\r\n    self.embeddings.embed(sentences)\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\flair\\embeddings.py\", line 149, in embed\r\n    embedding.embed(sentences)\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\flair\\embeddings.py\", line 81, in embed\r\n    self._add_embeddings_internal(sentences)\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\flair\\embeddings.py\", line 1852, in _add_embeddings_internal\r\n    token.set_embedding(self.name, embedding.clone())\r\nRuntimeError: CUDA error: unspecified launch failure\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS Windows 10:\r\n- GPU 1080Ti\r\n- flair==0.4.3", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1173/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1173/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1165", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1165/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1165/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1165/events", "html_url": "https://github.com/flairNLP/flair/issues/1165", "id": 499869731, "node_id": "MDU6SXNzdWU0OTk4Njk3MzE=", "number": 1165, "title": "en-sentiment model contains labels that don't match IMDB dataset", "user": {"login": "pommedeterresautee", "id": 1029874, "node_id": "MDQ6VXNlcjEwMjk4NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1029874?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pommedeterresautee", "html_url": "https://github.com/pommedeterresautee", "followers_url": "https://api.github.com/users/pommedeterresautee/followers", "following_url": "https://api.github.com/users/pommedeterresautee/following{/other_user}", "gists_url": "https://api.github.com/users/pommedeterresautee/gists{/gist_id}", "starred_url": "https://api.github.com/users/pommedeterresautee/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pommedeterresautee/subscriptions", "organizations_url": "https://api.github.com/users/pommedeterresautee/orgs", "repos_url": "https://api.github.com/users/pommedeterresautee/repos", "events_url": "https://api.github.com/users/pommedeterresautee/events{/privacy}", "received_events_url": "https://api.github.com/users/pommedeterresautee/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-09-29T07:01:28Z", "updated_at": "2020-04-29T21:34:45Z", "closed_at": "2020-04-29T21:34:44Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\n\r\nAccording to TUTORIAL 2, classification model en-sentiment has been trained on IMDB dataset.\r\n\r\n`evaluate()` function on en-sentiment  model trained on IMDB produces 0 score when tested on test set of IMDB.\r\n\r\nReasons seem to be a change in label names.\r\n\r\nModel: ['POSITIVE'], ['NEGATIVE']\r\ndataset: ['pos'], ???\r\n\r\nI have not a single prediction with negative label. (which is another issue)\r\n\r\nIMDB is not marked as deprecated in source code.\r\n\r\n**To Reproduce**\r\n```python\r\nfrom flair.datasets import IMDB, DataLoader\r\n\r\nfrom flair.models import TextClassifier\r\n\r\nclassifier = TextClassifier.load('en-sentiment')\r\ncorpus = IMDB()\r\n\r\nsentences = list(corpus.test)\r\n\r\ntest_results, a = classifier.evaluate(data_loader=DataLoader(sentences[:100], batch_size=16))\r\nprint(test_results.detailed_results)\r\n```\r\n\r\nPrint:\r\n\r\n```python\r\n# print(test_results.detailed_results)\r\nMICRO_AVG: acc 0.0 - f1-score 0.0\r\nMACRO_AVG: acc 0.0 - f1-score 0.0\r\nNEGATIVE   tp: 0 - fp: 13 - fn: 0 - tn: 87 - precision: 0.0000 - recall: 0.0000 - accuracy: 0.0000 - f1-score: 0.0000\r\nPOSITIVE   tp: 0 - fp: 87 - fn: 0 - tn: 13 - precision: 0.0000 - recall: 0.0000 - accuracy: 0.0000 - f1-score: 0.0000\r\n```\r\n\r\n**Expected behavior**\r\nA score which is not zero\r\n\r\n**Solution**\r\n\r\nRetrain / reshare a new en-sentiment model? // redo IMDB dataset\r\n\r\n**Context**\r\nPiPy version of Flair / same bug on master branch\r\n\r\n**Note**\r\n\r\nBtw, the model seems to not work very well.\r\n\r\n\"I never saw something that bad.\" -> positive\r\n\"I do not like this film\" -> positive\r\n\"I hate this film\" -> negative (finally)\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1165/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1165/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1137", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1137/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1137/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1137/events", "html_url": "https://github.com/flairNLP/flair/issues/1137", "id": 496222095, "node_id": "MDU6SXNzdWU0OTYyMjIwOTU=", "number": 1137, "title": "\"BrokenPipeError: [Errno 32] Broken pipe\" during corpus.make_label_dictionary()", "user": {"login": "stelehm", "id": 5700597, "node_id": "MDQ6VXNlcjU3MDA1OTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5700597?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stelehm", "html_url": "https://github.com/stelehm", "followers_url": "https://api.github.com/users/stelehm/followers", "following_url": "https://api.github.com/users/stelehm/following{/other_user}", "gists_url": "https://api.github.com/users/stelehm/gists{/gist_id}", "starred_url": "https://api.github.com/users/stelehm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stelehm/subscriptions", "organizations_url": "https://api.github.com/users/stelehm/orgs", "repos_url": "https://api.github.com/users/stelehm/repos", "events_url": "https://api.github.com/users/stelehm/events{/privacy}", "received_events_url": "https://api.github.com/users/stelehm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-09-20T08:36:32Z", "updated_at": "2020-06-04T03:32:14Z", "closed_at": "2020-06-04T03:32:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "While trying to build a sentiment classifier using the sentiment140 corpus [link](http://help.sentiment140.com/for-students), I encountered an error.\r\nAfter (successfully?) loading the corpus, flair throws an 'BrokenPipeError' during the creation of the label dictionary.\r\nI am running Python3.6 and flair0.4.3 within windows10.\r\n\r\nThe code:\r\n```\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import CSVClassificationCorpus\r\n\r\ndata_folder = './twitterData'\r\n\r\ncolumn_name_map = {5: \"text\", 0: \"label_topic\"}\r\n\r\ncorpus: Corpus = CSVClassificationCorpus(data_folder,\r\n                                         column_name_map,\r\n                                         skip_header=False,\r\n                                         delimiter=',',   \r\n) \r\n\r\nlabel_dict = corpus.make_label_dictionary()\r\n```\r\n\r\nThe output:\r\n\r\n> 2019-09-20 10:14:09,107 Reading data from twitterData\r\n> 2019-09-20 10:14:09,107 Train: twitterData\\training.1600000.processed.noemoticon.csv\r\n> 2019-09-20 10:14:09,107 Dev: None\r\n> 2019-09-20 10:14:09,107 Test: twitterData\\testdata.manual.2009.06.14.csv\r\n> 2019-09-20 10:14:18,221 Computing label dictionary. Progress:\r\n> Traceback (most recent call last):\r\n> \r\n>   File \"<ipython-input-11-2ba9b24e7f47>\", line 14, in <module>\r\n>     label_dict = corpus.make_label_dictionary()\r\n> \r\n>   File \"C:\\Anaconda3\\lib\\site-packages\\flair\\data.py\", line 948, in make_label_dictionary\r\n>     for batch in Tqdm.tqdm(iter(loader)):\r\n> \r\n>   File \"C:\\Anaconda3\\lib\\site-packages\\torch\\utils\\data\\dataloader.py\", line 278, in __iter__\r\n>     return _MultiProcessingDataLoaderIter(self)\r\n> \r\n>   File \"C:\\Anaconda3\\lib\\site-packages\\torch\\utils\\data\\dataloader.py\", line 682, in __init__\r\n>     w.start()\r\n> \r\n>   File \"C:\\Anaconda3\\lib\\multiprocessing\\process.py\", line 112, in start\r\n>     self._popen = self._Popen(self)\r\n> \r\n>   File \"C:\\Anaconda3\\lib\\multiprocessing\\context.py\", line 223, in _Popen\r\n>     return _default_context.get_context().Process._Popen(process_obj)\r\n> \r\n>   File \"C:\\Anaconda3\\lib\\multiprocessing\\context.py\", line 322, in _Popen\r\n>     return Popen(process_obj)\r\n> \r\n>   File \"C:\\Anaconda3\\lib\\multiprocessing\\popen_spawn_win32.py\", line 65, in __init__\r\n>     reduction.dump(process_obj, to_child)\r\n> \r\n>   File \"C:\\Anaconda3\\lib\\multiprocessing\\reduction.py\", line 60, in dump\r\n>     ForkingPickler(file, protocol).dump(obj)\r\n> \r\n> BrokenPipeError: [Errno 32] Broken pipe\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1137/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1137/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1136", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1136/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1136/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1136/events", "html_url": "https://github.com/flairNLP/flair/issues/1136", "id": 496155944, "node_id": "MDU6SXNzdWU0OTYxNTU5NDQ=", "number": 1136, "title": "When training NER, best-model.pt doesn't give the highest f-scores that was found during training", "user": {"login": "dhanachandran-ezdi", "id": 11294900, "node_id": "MDQ6VXNlcjExMjk0OTAw", "avatar_url": "https://avatars.githubusercontent.com/u/11294900?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dhanachandran-ezdi", "html_url": "https://github.com/dhanachandran-ezdi", "followers_url": "https://api.github.com/users/dhanachandran-ezdi/followers", "following_url": "https://api.github.com/users/dhanachandran-ezdi/following{/other_user}", "gists_url": "https://api.github.com/users/dhanachandran-ezdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/dhanachandran-ezdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dhanachandran-ezdi/subscriptions", "organizations_url": "https://api.github.com/users/dhanachandran-ezdi/orgs", "repos_url": "https://api.github.com/users/dhanachandran-ezdi/repos", "events_url": "https://api.github.com/users/dhanachandran-ezdi/events{/privacy}", "received_events_url": "https://api.github.com/users/dhanachandran-ezdi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-09-20T05:40:39Z", "updated_at": "2020-05-06T20:32:57Z", "closed_at": "2020-05-06T20:32:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "During training, evaluation after epoch 63, gives f-score of 0.8902. But, evaluation after the training with best-model.pt gives 0.8893 which is not the best. This best-model f-score is same as the final-model (of the last epoch). \r\n\r\n2019-09-20 01:13:17,747 EPOCH 63 done: loss 0.8146 - lr 0.0500 - bad epochs 1\r\n2019-09-20 01:15:58,316 DEV  : loss 0.67872787 - f-score 0.8902 - acc 0.8022\r\n2019-09-20 01:18:38,957 TEST : loss 0.67872787 - f-score 0.8902 - acc 0.8022\r\n\r\n2019-09-20 01:34:15,548 loading file resources/ezBERT_SL128_fix_seed/best-model.pt\r\n2019-09-20 01:36:49,135 MICRO_AVG: acc 0.8006 - f1-score 0.8893\r\n2019-09-20 01:36:49,136 MACRO_AVG: acc 0.7743 - f1-score 0.8682909090909092", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1136/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1136/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1131", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1131/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1131/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1131/events", "html_url": "https://github.com/flairNLP/flair/issues/1131", "id": 495754171, "node_id": "MDU6SXNzdWU0OTU3NTQxNzE=", "number": 1131, "title": "IndexError while making NER using flair example with custom dataset ", "user": {"login": "MohamedLotfyElrefai", "id": 45141667, "node_id": "MDQ6VXNlcjQ1MTQxNjY3", "avatar_url": "https://avatars.githubusercontent.com/u/45141667?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MohamedLotfyElrefai", "html_url": "https://github.com/MohamedLotfyElrefai", "followers_url": "https://api.github.com/users/MohamedLotfyElrefai/followers", "following_url": "https://api.github.com/users/MohamedLotfyElrefai/following{/other_user}", "gists_url": "https://api.github.com/users/MohamedLotfyElrefai/gists{/gist_id}", "starred_url": "https://api.github.com/users/MohamedLotfyElrefai/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MohamedLotfyElrefai/subscriptions", "organizations_url": "https://api.github.com/users/MohamedLotfyElrefai/orgs", "repos_url": "https://api.github.com/users/MohamedLotfyElrefai/repos", "events_url": "https://api.github.com/users/MohamedLotfyElrefai/events{/privacy}", "received_events_url": "https://api.github.com/users/MohamedLotfyElrefai/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-09-19T11:59:50Z", "updated_at": "2019-10-04T09:11:10Z", "closed_at": "2019-10-04T09:11:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI have passed a train data file  and empty files for dev and the test data set I face the same problem on my custom data set.\r\nlink for data set \r\n\r\nhttps://drive.google.com/open?id=1ZiWTVuvcm5r0kRM50P8xV2trbKyjVU7-\r\n\r\n**To Reproduce**\r\n```\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import ColumnCorpus\r\n\r\n# define columns\r\ncolumns = {0: 'text', 1: 'ner'}\r\n\r\n# this is the folder in which train, test and dev files reside\r\n\r\n# init a corpus using column format, data folder and the names of the train, dev and test files\r\ncorpus: Corpus = ColumnCorpus('',columns,\r\n                              train_file='train.txt',\r\n                              dev_file='test.txt',\r\n                             test_file='test.txt')\r\n\r\n```\r\n\r\n```\r\nfrom flair.data import Corpus\r\nfrom flair.embeddings import TokenEmbeddings, WordEmbeddings, StackedEmbeddings, PooledFlairEmbeddings\r\nfrom typing import List\r\n\r\n# 1. get the corpus\r\n\r\n# 2. what tag do we want to predict?\r\ntag_type = 'ner'\r\n\r\n# 3. make the tag dictionary from the corpus\r\ntag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\n\r\n# initialize embeddings\r\nembedding_types: List[TokenEmbeddings] = [\r\n\r\n    # GloVe embeddings\r\n    WordEmbeddings('glove'),\r\n\r\n    # contextual string embeddings, forward\r\n    PooledFlairEmbeddings('news-forward', pooling='min'),\r\n\r\n    # contextual string embeddings, backward\r\n    PooledFlairEmbeddings('news-backward', pooling='min'),\r\n]\r\n\r\nembeddings: StackedEmbeddings = StackedEmbeddings(embeddings=embedding_types)\r\n\r\n# initialize sequence tagger\r\nfrom flair.models import SequenceTagger\r\n\r\ntagger: SequenceTagger = SequenceTagger(hidden_size=256,\r\n                                        embeddings=embeddings,\r\n                                        tag_dictionary=tag_dictionary,\r\n                                        tag_type=tag_type)\r\n\r\n# initialize trainer\r\nfrom flair.trainers import ModelTrainer\r\n\r\ntrainer: ModelTrainer = ModelTrainer(tagger,corpus)\r\n\r\ntrainer.train('resources/taggers/example-ner',train_with_dev=True,max_epochs=150)\r\n\r\n```\r\n**Expected behavior**\r\nIndexError: string index out of range\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - OS [Linux 18.04 ]:\r\n - Version [flair-0.4.3]:\r\n- cuda 10 and gpu version\r\n OS [windows10 ]:\r\n - Version [flair-0.4.3]:\r\n- cpu\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1131/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1131/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1128", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1128/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1128/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1128/events", "html_url": "https://github.com/flairNLP/flair/issues/1128", "id": 495329386, "node_id": "MDU6SXNzdWU0OTUzMjkzODY=", "number": 1128, "title": "make_label_dictionary takes too much to run and eventually dies", "user": {"login": "mrbungie", "id": 2586758, "node_id": "MDQ6VXNlcjI1ODY3NTg=", "avatar_url": "https://avatars.githubusercontent.com/u/2586758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrbungie", "html_url": "https://github.com/mrbungie", "followers_url": "https://api.github.com/users/mrbungie/followers", "following_url": "https://api.github.com/users/mrbungie/following{/other_user}", "gists_url": "https://api.github.com/users/mrbungie/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrbungie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrbungie/subscriptions", "organizations_url": "https://api.github.com/users/mrbungie/orgs", "repos_url": "https://api.github.com/users/mrbungie/repos", "events_url": "https://api.github.com/users/mrbungie/events{/privacy}", "received_events_url": "https://api.github.com/users/mrbungie/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2019-09-18T16:22:58Z", "updated_at": "2020-05-06T22:33:13Z", "closed_at": "2020-05-06T22:33:13Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nmake_label_dictionary takes too much to run and eventually dies from MemoryErrors for datasets of +15M samples.\r\n\r\n**To Reproduce**\r\n- Use a big (ymmv) CSV single-labeled corpus of about 13.500.000 samples in train set (90% from train.csv), 1.500.000 in dev set (10% from train.csv) and 5.000.000 in test set (test.csv).\r\n- Load using CSVClassificationCorpus\r\n- Then use Corpus.make_label_dictionary\r\n- Wait until it consumes all RAM and Swap.\r\n\r\n**Expected behavior**\r\n- It should work without needing to edit flair's code (setting num_workers = 0, see below)\r\n\r\n**Code**\r\n```\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import CSVClassificationCorpus\r\n\r\ndef main():\r\n    # Corpus y label dictionary\r\n    csv_path = './flair_training_data'\r\n    column_name_map = {0: \"text\", 3: \"label_topic\"}\r\n\r\n    print(\"Loading corpus\")\r\n    corpus: Corpus = CSVClassificationCorpus(csv_path,\r\n                                            column_name_map,\r\n                                            skip_header=True,\r\n                                            delimiter=',',\r\n                                            in_memory=False    # tab-separated files\r\n    ) \r\n\r\n    # Label Dict\r\n    print(\"Loading label_dict\")\r\n    label_dict = corpus.make_label_dictionary()\r\n\r\n    return corpus, label_dict\r\n\r\nif __name__ == '__main__':\r\n    data, label_dict = main()\r\n\r\n    import joblib\r\n    joblib.dump([data, label_dict], 'data.pkl')\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Both Windows 10 and Ubuntu Linux 18.04 exhibit this behaviour.\r\n - Version [e.g. flair-0.3.2]: flair==0.4.3 using pytorch==1.2.0\r\n- Specs: Intel i7 4790, 32GB of RAM, GTX1070.\r\n\r\n**Additional context**\r\nSome findings:\r\n- In Windows I can't even run make_label_dictionary (Tqdm's loading bar won't show up) without editing flair's code and forcing num_workers = 0. If I do that, it runs perfectly and relatively quickly, I've yet to test this in Linux.\r\n- In Linux TQDM reports a expected running time of about 30 mins, but it starts leaking memory up until ~4.9M samples and by then it's using swap and expecting to run for more than 30 hours. I've to skim through your code, but I thought that pytorch's DataLoader class role was to manage things like avoiding memory usage for big datasets and loading only what's necessary in the moment. Afaik, generating a idx2item and item2idx dictionary shouldn't use that much memory for a training+dev set of 15.000.000 samples.\r\n\r\nThank you for the great job you've doing.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1128/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1128/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1125", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1125/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1125/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1125/events", "html_url": "https://github.com/flairNLP/flair/issues/1125", "id": 495137902, "node_id": "MDU6SXNzdWU0OTUxMzc5MDI=", "number": 1125, "title": "Training time for Sequence Tagger model with flair 0.4.2 and 0.4.3 is far slower than flair 0.4.1 ", "user": {"login": "dhanachandran-ezdi", "id": 11294900, "node_id": "MDQ6VXNlcjExMjk0OTAw", "avatar_url": "https://avatars.githubusercontent.com/u/11294900?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dhanachandran-ezdi", "html_url": "https://github.com/dhanachandran-ezdi", "followers_url": "https://api.github.com/users/dhanachandran-ezdi/followers", "following_url": "https://api.github.com/users/dhanachandran-ezdi/following{/other_user}", "gists_url": "https://api.github.com/users/dhanachandran-ezdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/dhanachandran-ezdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dhanachandran-ezdi/subscriptions", "organizations_url": "https://api.github.com/users/dhanachandran-ezdi/orgs", "repos_url": "https://api.github.com/users/dhanachandran-ezdi/repos", "events_url": "https://api.github.com/users/dhanachandran-ezdi/events{/privacy}", "received_events_url": "https://api.github.com/users/dhanachandran-ezdi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 14, "created_at": "2019-09-18T10:31:27Z", "updated_at": "2020-04-29T21:25:08Z", "closed_at": "2020-04-29T21:25:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am training a Sequence Tagger model with BERT embedding.  With flair 0.4.2 and 0.4.3 the training time per epoch is more than an hour whereas with flair 0.4.1 the training time per epoch is reduced to around 10 minutes. In both cases I used same dataset as well as set of hyper-parameters. \r\n\r\nWith flair 0.4.1\r\n`2019-09-11 14:32:55,656 epoch 2 - iter 0/3970 - loss 0.97338068`\r\n`2019-09-11 14:33:49,827 epoch 2 - iter 397/3970 - loss 1.55385168`\r\n2019-09-11 14:34:44,221 epoch 2 - iter 794/3970 - loss 1.56232328\r\n2019-09-11 14:35:37,523 epoch 2 - iter 1191/3970 - loss 1.53419682\r\n2019-09-11 14:36:31,586 epoch 2 - iter 1588/3970 - loss 1.52745939\r\n2019-09-11 14:37:25,264 epoch 2 - iter 1985/3970 - loss 1.51710631\r\n2019-09-11 14:38:20,391 epoch 2 - iter 2382/3970 - loss 1.51415485\r\n2019-09-11 14:39:14,297 epoch 2 - iter 2779/3970 - loss 1.50332664\r\n2019-09-11 14:40:09,160 epoch 2 - iter 3176/3970 - loss 1.49171285\r\n2019-09-11 14:41:02,996 epoch 2 - iter 3573/3970 - loss 1.48215480`\r\n\r\nwith flair 0.4.3 and 0.4.4\r\n`2019-09-17 09:43:04,970 epoch 2 - iter 0/3970 - loss 3.04009271`\r\n`2019-09-17 09:50:32,591 epoch 2 - iter 397/3970 - loss 1.54281418`\r\n2019-09-17 09:58:32,604 epoch 2 - iter 794/3970 - loss 1.53454762\r\n2019-09-17 10:06:06,666 epoch 2 - iter 1191/3970 - loss 1.53360289\r\n2019-09-17 10:13:37,722 epoch 2 - iter 1588/3970 - loss 1.51916389\r\n2019-09-17 10:21:18,720 epoch 2 - iter 1985/3970 - loss 1.50955056\r\n2019-09-17 10:29:36,539 epoch 2 - iter 2382/3970 - loss 1.49568585\r\n2019-09-17 10:36:58,278 epoch 2 - iter 2779/3970 - loss 1.48138234\r\n2019-09-17 10:44:15,273 epoch 2 - iter 3176/3970 - loss 1.47001876\r\n2019-09-17 10:52:16,362 epoch 2 - iter 3573/3970 - loss 1.46437050`", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1125/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1125/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1122", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1122/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1122/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1122/events", "html_url": "https://github.com/flairNLP/flair/issues/1122", "id": 495031079, "node_id": "MDU6SXNzdWU0OTUwMzEwNzk=", "number": 1122, "title": "Flair Language Model not using multiple CPU cores", "user": {"login": "aashay96", "id": 8274603, "node_id": "MDQ6VXNlcjgyNzQ2MDM=", "avatar_url": "https://avatars.githubusercontent.com/u/8274603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aashay96", "html_url": "https://github.com/aashay96", "followers_url": "https://api.github.com/users/aashay96/followers", "following_url": "https://api.github.com/users/aashay96/following{/other_user}", "gists_url": "https://api.github.com/users/aashay96/gists{/gist_id}", "starred_url": "https://api.github.com/users/aashay96/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aashay96/subscriptions", "organizations_url": "https://api.github.com/users/aashay96/orgs", "repos_url": "https://api.github.com/users/aashay96/repos", "events_url": "https://api.github.com/users/aashay96/events{/privacy}", "received_events_url": "https://api.github.com/users/aashay96/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-09-18T07:07:57Z", "updated_at": "2020-05-06T22:33:10Z", "closed_at": "2020-05-06T22:33:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "While Finetuning the LM model, the Language Trainer module is not making use of all the underlying CPU cores even with num_workers parameter being present.\r\n\r\nTo Reproduce - \r\n from flair.data import Dictionary\r\nfrom flair.embeddings import FlairEmbeddings\r\nfrom flair.trainers.language_model_trainer import LanguageModelTrainer, TextCorpus\r\n\r\nlanguage_model = FlairEmbeddings('multi-forward').lm\r\nis_forward_lm = True\r\ndictionary: Dictionary = language_model.dictionary\r\n\r\ncorpus = TextCorpus('corpus/',\r\n                    dictionary,\r\n                    is_forward_lm,\r\n                    character_level=True)\r\n\r\n\r\ntrainer = LanguageModelTrainer(language_model, corpus)\r\n\r\ntrainer.train('resources/taggers/language_model',\r\n              sequence_length=50,\r\n              mini_batch_size=500,\r\n              learning_rate=20,\r\n              patience=10,\r\n              num_workers=4,\r\n              use_amp=True,\r\n              checkpoint=True)\r\n\r\n\r\n\r\n\r\n*Expected behavior*- \r\nThe library should be using all the underlying CPU cores\r\n\r\nScreenshots\r\n\r\n<img width=\"571\" alt=\"Screenshot 2019-09-18 at 12 36 55 PM\" src=\"https://user-images.githubusercontent.com/8274603/65123521-0eda5680-da11-11e9-8e3d-9aa70177a5f7.png\">\r\n\r\n\r\n\r\n\r\nEnvironment (please complete the following information):\r\n - OS : Linux:\r\n - Version: flair-0.4.3\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1122/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1122/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1115", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1115/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1115/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1115/events", "html_url": "https://github.com/flairNLP/flair/issues/1115", "id": 494389729, "node_id": "MDU6SXNzdWU0OTQzODk3Mjk=", "number": 1115, "title": "When fine-tuning language model, I got AttributeError: 'int' object has no attribute 'item'", "user": {"login": "khoaipx", "id": 7689094, "node_id": "MDQ6VXNlcjc2ODkwOTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/7689094?v=4", "gravatar_id": "", "url": "https://api.github.com/users/khoaipx", "html_url": "https://github.com/khoaipx", "followers_url": "https://api.github.com/users/khoaipx/followers", "following_url": "https://api.github.com/users/khoaipx/following{/other_user}", "gists_url": "https://api.github.com/users/khoaipx/gists{/gist_id}", "starred_url": "https://api.github.com/users/khoaipx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/khoaipx/subscriptions", "organizations_url": "https://api.github.com/users/khoaipx/orgs", "repos_url": "https://api.github.com/users/khoaipx/repos", "events_url": "https://api.github.com/users/khoaipx/events{/privacy}", "received_events_url": "https://api.github.com/users/khoaipx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-09-17T04:09:31Z", "updated_at": "2019-10-22T13:29:27Z", "closed_at": "2019-10-22T13:29:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n\r\nI fine-tuned an trained language model, but I got below error: `AttributeError: 'int' object has no attribute 'item'`\r\n\r\n**To Reproduce**\r\n\r\n```\r\ndef fine_tune(corpus_path, stored_path, model_name='mix-forward'):\r\n    if not isinstance(stored_path, Path):\r\n        stored_path = Path(stored_path)\r\n    stored_path.mkdir(parents=True, exist_ok=True)\r\n\r\n    if Path(model_name).exists():\r\n        language_model = LanguageModel.load_language_model(model_name)\r\n    else:\r\n        language_model = FlairEmbeddings(model_name, fine_tune=True).lm\r\n\r\n    # are you fine-tuning a forward or backward LM?\r\n    is_forward_lm = language_model.is_forward_lm\r\n\r\n    # get the dictionary from the existing language model\r\n    dictionary: Dictionary = language_model.dictionary\r\n\r\n    # get your corpus, process forward and at the character level\r\n    corpus = TextCorpus(corpus_path,\r\n                        dictionary,\r\n                        is_forward_lm,\r\n                        character_level=True)\r\n\r\n    # use the model trainer to fine-tune this model on your corpus\r\n    trainer = LanguageModelTrainer(language_model, corpus)\r\n\r\n    trainer.train(stored_path,\r\n                  sequence_length=100,\r\n                  mini_batch_size=100,\r\n                  learning_rate=20,\r\n                  patience=10,\r\n                  max_epochs=300,\r\n                  checkpoint=True)\r\n```\r\n\r\n**Screenshots**\r\n\r\n```\r\n2019-09-17 11:47:41,099 read text file with 4 lines\r\n2019-09-17 11:47:41,107 read text file with 4 lines\r\n2019-09-17 11:47:41,205 read text file with 78280 lines\r\n2019-09-17 11:47:41,265 shuffled\r\n2019-09-17 11:48:08,470 Sequence length is 100\r\n2019-09-17 11:48:08,502 Split 1  - (11:48:08)\r\n2019-09-17 11:48:13,678 | split   1 /  1 |   100/  359 batches | ms/batch 51.60 | loss  1.50 | ppl     4.48\r\n2019-09-17 11:48:18,817 | split   1 /  1 |   200/  359 batches | ms/batch 51.39 | loss  1.30 | ppl     3.67\r\n2019-09-17 11:48:23,978 | split   1 /  1 |   300/  359 batches | ms/batch 51.60 | loss  1.24 | ppl     3.44\r\n2019-09-17 11:48:27,022 18 seconds for train split 1\r\nTraceback (most recent call last):\r\n  File \"main.py\", line 192, in <module>\r\n    main()\r\n  File \"main.py\", line 188, in main\r\n    fine_tune()\r\n  File \"main.py\", line 180, in fine_tune\r\n    flair_stuff.fine_tune(corpus_dir, stored_dir, model_name=model_name)\r\n  File \"/home/nolan/code/lang_model_builder/flair_stuff.py\", line 314, in fine_tune\r\n    checkpoint=True)\r\n  File \"/home/nolan/anaconda2/envs/py37/lib/python3.7/site-packages/flair/trainers/language_model_trainer.py\", line 428, in train\r\n    val_loss = self.evaluate(val_data, mini_batch_size, sequence_length)\r\n  File \"/home/nolan/anaconda2/envs/py37/lib/python3.7/site-packages/flair/trainers/language_model_trainer.py\", line 511, in evaluate\r\n    return total_loss.item() / len(data_source)\r\nAttributeError: 'int' object has no attribute 'item'\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Ubuntu 16.04\r\n - Version: both flair 1.0 and 1.2\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1115/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1115/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1110", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1110/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1110/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1110/events", "html_url": "https://github.com/flairNLP/flair/issues/1110", "id": 494052404, "node_id": "MDU6SXNzdWU0OTQwNTI0MDQ=", "number": 1110, "title": " n", "user": {"login": "Dhanachandra", "id": 10828657, "node_id": "MDQ6VXNlcjEwODI4NjU3", "avatar_url": "https://avatars.githubusercontent.com/u/10828657?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dhanachandra", "html_url": "https://github.com/Dhanachandra", "followers_url": "https://api.github.com/users/Dhanachandra/followers", "following_url": "https://api.github.com/users/Dhanachandra/following{/other_user}", "gists_url": "https://api.github.com/users/Dhanachandra/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dhanachandra/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dhanachandra/subscriptions", "organizations_url": "https://api.github.com/users/Dhanachandra/orgs", "repos_url": "https://api.github.com/users/Dhanachandra/repos", "events_url": "https://api.github.com/users/Dhanachandra/events{/privacy}", "received_events_url": "https://api.github.com/users/Dhanachandra/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-09-16T13:33:00Z", "updated_at": "2019-09-18T10:44:15Z", "closed_at": "2019-09-18T10:44:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1110/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1110/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1108", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1108/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1108/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1108/events", "html_url": "https://github.com/flairNLP/flair/issues/1108", "id": 494025802, "node_id": "MDU6SXNzdWU0OTQwMjU4MDI=", "number": 1108, "title": "find_learning_rate does not work anymore", "user": {"login": "lucaventurini", "id": 2151065, "node_id": "MDQ6VXNlcjIxNTEwNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/2151065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lucaventurini", "html_url": "https://github.com/lucaventurini", "followers_url": "https://api.github.com/users/lucaventurini/followers", "following_url": "https://api.github.com/users/lucaventurini/following{/other_user}", "gists_url": "https://api.github.com/users/lucaventurini/gists{/gist_id}", "starred_url": "https://api.github.com/users/lucaventurini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lucaventurini/subscriptions", "organizations_url": "https://api.github.com/users/lucaventurini/orgs", "repos_url": "https://api.github.com/users/lucaventurini/repos", "events_url": "https://api.github.com/users/lucaventurini/events{/privacy}", "received_events_url": "https://api.github.com/users/lucaventurini/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-09-16T12:42:45Z", "updated_at": "2019-09-17T20:52:53Z", "closed_at": "2019-09-17T20:52:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nBefore, I've run several experiments with which I could plot the optimal learning rate as in the tutorial. Now, after an upgrade of the codebase, I cannot anymore reproduce the same experiments.\r\nWhat I find is similar to issue #986 , but in my case the learning rate is never updated (while in the above issue is updated at least at the first step).\r\n\r\n**To Reproduce**\r\nI've run the experiments with commit 24b72a6dfd1d0c2519794e1183cacc42c932c4f4  , and set a start lr of 1e-08 and an end lr of 1000, with 200 iterations. I get a tsv with 200 lines where the lr is always the same (slightly above the start lr).\r\n\r\n**Expected behavior**\r\nI previously run the same experiments with commit 6c27431ecc731446f12bc3205bf68d0a859b9a8d and they seemed to work as in the tutorial. The lr in the tsv spanned all the interval specified.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1108/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1108/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1106", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1106/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1106/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1106/events", "html_url": "https://github.com/flairNLP/flair/issues/1106", "id": 493989729, "node_id": "MDU6SXNzdWU0OTM5ODk3Mjk=", "number": 1106, "title": "CSVClassificationCorpus encoding problems", "user": {"login": "ghost", "id": 10137, "node_id": "MDQ6VXNlcjEwMTM3", "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ghost", "html_url": "https://github.com/ghost", "followers_url": "https://api.github.com/users/ghost/followers", "following_url": "https://api.github.com/users/ghost/following{/other_user}", "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}", "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ghost/subscriptions", "organizations_url": "https://api.github.com/users/ghost/orgs", "repos_url": "https://api.github.com/users/ghost/repos", "events_url": "https://api.github.com/users/ghost/events{/privacy}", "received_events_url": "https://api.github.com/users/ghost/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-09-16T11:22:25Z", "updated_at": "2019-09-20T06:57:50Z", "closed_at": "2019-09-20T06:57:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nHopefully this is not something already fixed!\r\n\r\nI tried to load my own corpus like explained in tutorial: https://github.com/zalandoresearch/flair/blob/master/resources/docs/TUTORIAL_6_CORPUS.md\r\n\r\nI created train.csv, test.csv and dev.csv containing Finnish text with \u00e4, \u00f6, \u00c4 and \u00d6. Seemed to be fine with encoding = 'utf-8'. Checking the file with code below, it contained this text: \"osittain s\u00e4hk\u00f6 / mittari puuttua\".\r\ndev_set = pd.read_csv(datafolder+'dev.csv', encoding = \"utf-8\", sep = ',')\r\nprint(dev_set['viesti'][0])\r\n\r\nThen I loaded corpus with this line:\r\ncorpus: Corpus = CSVClassificationCorpus(datakansio,column_name_map,skip_header=True,delimiter=',')\r\n\r\nAnd checking corpus with code below, the text was changed to this: \"osittain s\u00c3 \u00a4 hk\u00c3 \u00b6 / mittari puuttua\". Encoding had changed somehow, and all \u00e4, \u00f6, \u00c4 and \u00d6 did broke.\r\nprint(corpus.dev[0])\r\n\r\n - OS: Windows\r\n - Version: Python 3.7.1, flair 0.4.3, torch 1.2.0\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1106/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1106/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1097", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1097/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1097/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1097/events", "html_url": "https://github.com/flairNLP/flair/issues/1097", "id": 493441915, "node_id": "MDU6SXNzdWU0OTM0NDE5MTU=", "number": 1097, "title": "CoNLL: docstart \"sentences\" are not filtered", "user": {"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-09-13T17:39:27Z", "updated_at": "2019-09-14T17:45:39Z", "closed_at": "2019-09-14T17:45:39Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Hi,\r\n\r\nI just looked at the parsed sentences from a CoNLL corpus and it turns out, that the `-DOCSTART-` lines are not filtered:\r\n\r\n```python\r\nIn [1]: import flair.datasets                                                                                                                                                            \r\n\r\nIn [2]: corpus = flair.datasets.CONLL_03()                                                                                                                                               \r\n2019-09-13 19:26:18,811 Reading data from /home/stefan/.flair/datasets/conll_03\r\n2019-09-13 19:26:18,811 Train: /home/stefan/.flair/datasets/conll_03/eng.train\r\n2019-09-13 19:26:18,811 Dev: /home/stefan/.flair/datasets/conll_03/eng.testa\r\n2019-09-13 19:26:18,811 Test: /home/stefan/.flair/datasets/conll_03/eng.testb\r\n\r\nIn [3]: corpus.train[0]                                                                                                                                                                  \r\nOut[3]: Sentence: \"-DOCSTART-\" - 1 Tokens\r\n\r\nIn [4]: corpus.train[0].to_tagged_string()                                                                                                                                               \r\nOut[4]: '-DOCSTART- <-X->'\r\n```", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1097/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1097/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1094", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1094/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1094/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1094/events", "html_url": "https://github.com/flairNLP/flair/issues/1094", "id": 493265178, "node_id": "MDU6SXNzdWU0OTMyNjUxNzg=", "number": 1094, "title": "Trained model with 1.0 f1-scores score but strange/poor results", "user": {"login": "tombburnell", "id": 426754, "node_id": "MDQ6VXNlcjQyNjc1NA==", "avatar_url": "https://avatars.githubusercontent.com/u/426754?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tombburnell", "html_url": "https://github.com/tombburnell", "followers_url": "https://api.github.com/users/tombburnell/followers", "following_url": "https://api.github.com/users/tombburnell/following{/other_user}", "gists_url": "https://api.github.com/users/tombburnell/gists{/gist_id}", "starred_url": "https://api.github.com/users/tombburnell/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tombburnell/subscriptions", "organizations_url": "https://api.github.com/users/tombburnell/orgs", "repos_url": "https://api.github.com/users/tombburnell/repos", "events_url": "https://api.github.com/users/tombburnell/events{/privacy}", "received_events_url": "https://api.github.com/users/tombburnell/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2019-09-13T11:02:52Z", "updated_at": "2020-05-06T20:32:56Z", "closed_at": "2020-05-06T20:32:56Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nA clear and concise description of what the bug is.\r\n\r\nI've trained an LM  model using a bunch of news articles labelled with keywords, limited to only popular keywords. The training has scored very highly (almost suspiciously so).\r\n\r\nMICRO_AVG: acc 0.9993 - f1-score 0.9997\r\nMACRO_AVG: acc 0.9993 - f1-score 0.9996321428571429\r\namericas   tp: 279 - fp: 0 - fn: 0 - tn: 8351 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\nasia_pacific tp: 477 - fp: 0 - fn: 0 - tn: 8153 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\nboris_johnson tp: 579 - fp: 0 - fn: 0 - tn: 8051 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\nbrexit     tp: 389 - fp: 0 - fn: 0 - tn: 8241 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\nbusiness   tp: 1280 - fp: 0 - fn: 0 - tn: 7350 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\nchina      tp: 213 - fp: 0 - fn: 0 - tn: 8417 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\ncrime      tp: 1119 - fp: 0 - fn: 0 - tn: 7511 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\nculture    tp: 686 - fp: 0 - fn: 0 - tn: 7944 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\neducation  tp: 324 - fp: 0 - fn: 0 - tn: 8306 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\nenvironment tp: 266 - fp: 0 - fn: 0 - tn: 8364 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\neurope     tp: 699 - fp: 0 - fn: 0 - tn: 7931 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\neuropean_union tp: 352 - fp: 0 - fn: 0 - tn: 8278 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\nfinance    tp: 568 - fp: 0 - fn: 4 - tn: 8058 - precision: 1.0000 - recall: 0.9930 - accuracy: 0.9930 - f1-score: 0.9965\r\nlaw        tp: 322 - fp: 0 - fn: 0 - tn: 8308 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\nlove_island tp: 409 - fp: 0 - fn: 0 - tn: 8221 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\nmarkets    tp: 208 - fp: 0 - fn: 0 - tn: 8422 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\nmusic      tp: 281 - fp: 0 - fn: 0 - tn: 8349 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\nnews       tp: 3476 - fp: 0 - fn: 0 - tn: 5154 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\npolice     tp: 274 - fp: 0 - fn: 0 - tn: 8356 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\npolitics   tp: 1613 - fp: 0 - fn: 0 - tn: 7017 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\ntechnology tp: 341 - fp: 0 - fn: 0 - tn: 8289 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\ntravel     tp: 323 - fp: 0 - fn: 0 - tn: 8307 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\ntrump      tp: 852 - fp: 0 - fn: 0 - tn: 7778 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\nuk         tp: 861 - fp: 0 - fn: 4 - tn: 7765 - precision: 1.0000 - recall: 0.9954 - accuracy: 0.9954 - f1-score: 0.9977\r\nus         tp: 440 - fp: 4 - fn: 0 - tn: 8186 - precision: 0.9910 - recall: 1.0000 - accuracy: 0.9910 - f1-score: 0.9955\r\nwestern_europe tp: 428 - fp: 0 - fn: 0 - tn: 8202 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\nworld      tp: 363 - fp: 0 - fn: 0 - tn: 8267 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\nworld_news tp: 599 - fp: 0 - fn: 0 - tn: 8031 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\n\r\nSome articles are predicting quite well, eg\r\n\r\nA wallop for Boris Johnson... but Jacob Rees-Mogg takes it lying down: HENRY DEEDES sees the Leader of the House sprawl across the green benches like a 1970s lounge lizard as PM gulps down the briny taste of defeat\r\n==>  [news (0.9999940395355225), politics (0.9972768425941467), boris_johnson (0.8435016870498657), brexit (0.9373921751976013)]\r\n\r\nHowever an article about sports (which was excluded from the training set) resulted in lots of unexpected label matches.. \r\n\r\n\"After hitting four against Lithuania, Cristiano Ronaldo has scored against 40 different teams for Portugal\"\r\n ==> [world (0.7588407397270203), environment (0.9990266561508179), music (0.8719083070755005), culture (0.673468828201294), law (0.9973234534263611), boris_johnson (0.9677785634994507), police (0.9971749782562256), world_news (0.9998794794082642), travel (0.8145115971565247), trump (0.7244243621826172), americas (0.9826140999794006), asia_pacific (0.8884234428405762), china (0.9943141341209412), us (0.5811684727668762), education (0.8464401364326477), european_union (0.9843260645866394), love_island (0.9207460880279541), technology (0.926381528377533)]  \r\n\r\nI used the 'en' embedding for this.\r\n\r\nWhat is this likely to be a symptom of? \r\n\r\nA colleague suggested that the very high training score may be something to do with it learning how to predict the model very well but not very good at predicting new content and changing the neural network size may help.\r\n \r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1094/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1094/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1092", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1092/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1092/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1092/events", "html_url": "https://github.com/flairNLP/flair/issues/1092", "id": 493098857, "node_id": "MDU6SXNzdWU0OTMwOTg4NTc=", "number": 1092, "title": "token.get_embedding() with multiple embedding types returns in different order", "user": {"login": "shoarora", "id": 16643856, "node_id": "MDQ6VXNlcjE2NjQzODU2", "avatar_url": "https://avatars.githubusercontent.com/u/16643856?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shoarora", "html_url": "https://github.com/shoarora", "followers_url": "https://api.github.com/users/shoarora/followers", "following_url": "https://api.github.com/users/shoarora/following{/other_user}", "gists_url": "https://api.github.com/users/shoarora/gists{/gist_id}", "starred_url": "https://api.github.com/users/shoarora/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shoarora/subscriptions", "organizations_url": "https://api.github.com/users/shoarora/orgs", "repos_url": "https://api.github.com/users/shoarora/repos", "events_url": "https://api.github.com/users/shoarora/events{/privacy}", "received_events_url": "https://api.github.com/users/shoarora/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-09-13T01:34:26Z", "updated_at": "2019-09-16T17:56:14Z", "closed_at": "2019-09-16T17:52:46Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "`token.get_embedding()` does not necessarily return the embeddings in deterministic order across different environments.  \r\n\r\nThis is hugely problematic when trying to transfer a model to a different runtime environment (local vs remote) and/or when flair's embeddings are being fed into a different service.  Models are trained to expect certain sub-vectors in certain positions in the concatenated final vector.\r\n\r\n`token.get_embedding()` sorts the embeddings by key when concatenating them into a single vector to return.  \r\n\r\n```\r\nembeddings = [\r\n        self._embeddings[embed] for embed in sorted(self._embeddings.keys())\r\n]\r\n```\r\n\r\nThe keys come from `self.name` properties of the `Embedding` classes they came from.  However, these names are often just the paths to the model, which are hardly deterministic across environments, especially if we're loading our own weights.\r\n\r\n\r\nA concrete example:\r\n\r\nLocally:\r\n```\r\nstack = StackedEmbeddings [\r\n        WordEmbeddings('glove'),  # self.name is cached path.  '/root/.gensim' or something.\r\n        FlairEmbeddings('local/fine_tuned/embeddings.pt')\r\n]\r\n```\r\nOn `token.get_embedding()` this will put Flair first, since it comes first alphabetically when you sort their keys.\r\n\r\n\r\nDeployment environment:\r\n```\r\nstack = StackedEmbeddings [\r\n        WordEmbeddings('glove'),  # self.name is cached path.  '/root/.gensim' or something.\r\n        FlairEmbeddings('/z/extra/resources/go/somewhere/different/embeddings.pt')\r\n]\r\n```\r\nOn `token.get_embedding()` this will put Glove first, since it comes first alphabetically when you sort their keys.\r\n\r\n\r\nThis will break a model trained on these embeddings when you try to deploy.  Once we tracked this down, our workaround is to override `self.name` after init.  Documentation on this functionality, or eliminating the need for this would be great.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1092/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1092/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1087", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1087/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1087/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1087/events", "html_url": "https://github.com/flairNLP/flair/issues/1087", "id": 492235356, "node_id": "MDU6SXNzdWU0OTIyMzUzNTY=", "number": 1087, "title": "When restarting from checkpoint, the model is trained more than max_epochs", "user": {"login": "lucaventurini", "id": 2151065, "node_id": "MDQ6VXNlcjIxNTEwNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/2151065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lucaventurini", "html_url": "https://github.com/lucaventurini", "followers_url": "https://api.github.com/users/lucaventurini/followers", "following_url": "https://api.github.com/users/lucaventurini/following{/other_user}", "gists_url": "https://api.github.com/users/lucaventurini/gists{/gist_id}", "starred_url": "https://api.github.com/users/lucaventurini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lucaventurini/subscriptions", "organizations_url": "https://api.github.com/users/lucaventurini/orgs", "repos_url": "https://api.github.com/users/lucaventurini/repos", "events_url": "https://api.github.com/users/lucaventurini/events{/privacy}", "received_events_url": "https://api.github.com/users/lucaventurini/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-09-11T13:22:42Z", "updated_at": "2019-09-18T08:22:51Z", "closed_at": "2019-09-17T09:04:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nAs in the title, when loading a model that was already trained for some epochs, setting max_epochs parameter trains for *further* max_epochs.\r\n\r\n**To Reproduce**\r\nI saved a checkpoint after 3 epochs. When I load this checkpoint and run with max_epochs=3, I see epoch 4, 5, 6 get executed.\r\n\r\n**Expected behavior**\r\nThe above behavior could make sense, but I'd really like to set the **total** max epochs (or my jobs can potentially never end if they keep getting interrupted and restored).\r\n\r\nSo, in the example above, I would expect that no further epochs are trained.\r\n\r\nAlternatively, how can I read how many epochs were already trained when I load the checkpoint?\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1087/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1087/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1083", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1083/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1083/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1083/events", "html_url": "https://github.com/flairNLP/flair/issues/1083", "id": 491847706, "node_id": "MDU6SXNzdWU0OTE4NDc3MDY=", "number": 1083, "title": "embedding_length of CharacterEmbeddings", "user": {"login": "yahshibu", "id": 42306174, "node_id": "MDQ6VXNlcjQyMzA2MTc0", "avatar_url": "https://avatars.githubusercontent.com/u/42306174?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yahshibu", "html_url": "https://github.com/yahshibu", "followers_url": "https://api.github.com/users/yahshibu/followers", "following_url": "https://api.github.com/users/yahshibu/following{/other_user}", "gists_url": "https://api.github.com/users/yahshibu/gists{/gist_id}", "starred_url": "https://api.github.com/users/yahshibu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yahshibu/subscriptions", "organizations_url": "https://api.github.com/users/yahshibu/orgs", "repos_url": "https://api.github.com/users/yahshibu/repos", "events_url": "https://api.github.com/users/yahshibu/events{/privacy}", "received_events_url": "https://api.github.com/users/yahshibu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-09-10T19:10:45Z", "updated_at": "2019-09-11T20:30:23Z", "closed_at": "2019-09-11T20:30:23Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "https://github.com/zalandoresearch/flair/blob/3c93339ff69b5d827822228f17ee075e880db195/flair/embeddings.py#L1532\r\n\r\nI think the following is correct:\r\n```python\r\n        self.__embedding_length = self.hidden_size_char * 2\r\n```\r\n\r\nWhen the value of \"self.char_embedding_dim\" is not equal to that of \"self.hidden_size_char\" with the current implementation, it will not work properly.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1083/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1083/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1081", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1081/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1081/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1081/events", "html_url": "https://github.com/flairNLP/flair/issues/1081", "id": 491672782, "node_id": "MDU6SXNzdWU0OTE2NzI3ODI=", "number": 1081, "title": "Not all relevant labels are being predicted", "user": {"login": "tombburnell", "id": 426754, "node_id": "MDQ6VXNlcjQyNjc1NA==", "avatar_url": "https://avatars.githubusercontent.com/u/426754?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tombburnell", "html_url": "https://github.com/tombburnell", "followers_url": "https://api.github.com/users/tombburnell/followers", "following_url": "https://api.github.com/users/tombburnell/following{/other_user}", "gists_url": "https://api.github.com/users/tombburnell/gists{/gist_id}", "starred_url": "https://api.github.com/users/tombburnell/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tombburnell/subscriptions", "organizations_url": "https://api.github.com/users/tombburnell/orgs", "repos_url": "https://api.github.com/users/tombburnell/repos", "events_url": "https://api.github.com/users/tombburnell/events{/privacy}", "received_events_url": "https://api.github.com/users/tombburnell/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-09-10T13:28:26Z", "updated_at": "2020-05-06T22:33:07Z", "closed_at": "2020-05-06T22:33:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n\r\nI have a trained an LM model via a text corpus with multiple labels per document.\r\nWhen I ask it to predict labels for a new document, it often (but not always) only predicts the most relevant label. Why does it not always give all labels that have a relevance. How does it decide which labels to give?\r\n\r\nFor example:\r\n\r\n1) Harry Kane died in a plane crash  => [death 0.8319]      expected - only one relevant\r\n\r\n2) Harry Kane the Tottenham striker died in a plane crash => [sport 0.73]    not-expected. should give [death too]\r\n\r\n3) Harry Kane the footballer died in a plane crash => [sport 0.73] [ death 0.63] expected - gives sport and death.\r\n\r\nWhy would the 2nd one not give death and sport when the indicators for death label are strong and the 3rd one does?\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1081/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1081/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1080", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1080/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1080/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1080/events", "html_url": "https://github.com/flairNLP/flair/issues/1080", "id": 491215120, "node_id": "MDU6SXNzdWU0OTEyMTUxMjA=", "number": 1080, "title": "RTX2080 GPU is only being used at 30%  - whilst a single CPU core is maxed out", "user": {"login": "tombburnell", "id": 426754, "node_id": "MDQ6VXNlcjQyNjc1NA==", "avatar_url": "https://avatars.githubusercontent.com/u/426754?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tombburnell", "html_url": "https://github.com/tombburnell", "followers_url": "https://api.github.com/users/tombburnell/followers", "following_url": "https://api.github.com/users/tombburnell/following{/other_user}", "gists_url": "https://api.github.com/users/tombburnell/gists{/gist_id}", "starred_url": "https://api.github.com/users/tombburnell/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tombburnell/subscriptions", "organizations_url": "https://api.github.com/users/tombburnell/orgs", "repos_url": "https://api.github.com/users/tombburnell/repos", "events_url": "https://api.github.com/users/tombburnell/events{/privacy}", "received_events_url": "https://api.github.com/users/tombburnell/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2019-09-09T17:01:54Z", "updated_at": "2020-05-06T20:32:53Z", "closed_at": "2020-05-06T20:32:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "\r\nI am trying to train a model and I find that the GPU (RTX 2080) is only being used approx 30% whilst 1 of my CPU cores (9900k@5Ghz) appears to be maxed out. \r\n\r\nI'm trying to train a corpus of roughly 100k records tagged with approx 100 keywords. \r\n- ubuntu18\r\n- cuda10\r\n- python 3.7.3\r\n- 'en' embeddings \r\n- embeddings_storage_mode=gpu\r\n\r\nIs it expected that the GPU is not fully utilised?\r\n\r\nCan it not use more than 1 cpu core?\r\n\r\nWhat other info should I provide?\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1080/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1080/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1078", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1078/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1078/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1078/events", "html_url": "https://github.com/flairNLP/flair/issues/1078", "id": 490315147, "node_id": "MDU6SXNzdWU0OTAzMTUxNDc=", "number": 1078, "title": "`embeddings_storage_mode` not impacting GPU memory consumption", "user": {"login": "maciek16180", "id": 9105882, "node_id": "MDQ6VXNlcjkxMDU4ODI=", "avatar_url": "https://avatars.githubusercontent.com/u/9105882?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maciek16180", "html_url": "https://github.com/maciek16180", "followers_url": "https://api.github.com/users/maciek16180/followers", "following_url": "https://api.github.com/users/maciek16180/following{/other_user}", "gists_url": "https://api.github.com/users/maciek16180/gists{/gist_id}", "starred_url": "https://api.github.com/users/maciek16180/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maciek16180/subscriptions", "organizations_url": "https://api.github.com/users/maciek16180/orgs", "repos_url": "https://api.github.com/users/maciek16180/repos", "events_url": "https://api.github.com/users/maciek16180/events{/privacy}", "received_events_url": "https://api.github.com/users/maciek16180/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 25, "created_at": "2019-09-06T13:01:31Z", "updated_at": "2019-09-10T13:15:14Z", "closed_at": "2019-09-10T11:32:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n`embeddings_storage_mode` parameter has no effect on GPU memory usage or training speed during training of `SequenceTagger`.\r\n\r\n**To Reproduce**\r\nI train `SequenceTagger` using pretrained `FlairEmbeddings` (forward + backward) and finetuned `BertEmbeddings`.\r\n\r\nParameters other than `embeddings_storage_mode`: \r\n`FlairEmbeddings`\r\n- `hidden_size=1024`\r\n- `mini_batch_size=200`\r\n- `sequence_length=250`\r\n\r\n`BertEmbeddings`: default values from `bert-base-uncased`\r\n\r\n`SequenceTagger` training\r\n- `hidden_size=128`\r\n- `mini_batch_size=8`\r\n- I use `apex` for mixed-precision training\r\n\r\n**Expected behavior**\r\nI expected GPU memory consumption to depend on the `embeddings_storage_mode` parameter. Meanwhile, there is seemingly no difference, as shown in the charts below. Additionally, I expected the `none` setting to drastically slow down training after 1st epoch, but it doesn't happen. I attach the training logs from all three settings.\r\n\r\n**Screenshots**\r\n`embeddings_storage_mode='none'`\r\n![none](https://user-images.githubusercontent.com/53229577/64427472-9939c680-d0b1-11e9-8d21-51a4db5adf18.png)\r\n`embeddings_storage_mode='gpu'`\r\n![gpu](https://user-images.githubusercontent.com/53229577/64427475-9ccd4d80-d0b1-11e9-92a3-2666b3cd0361.png)\r\n`embeddings_storage_mode='cpu'`\r\n![cpu](https://user-images.githubusercontent.com/53229577/64427482-9fc83e00-d0b1-11e9-8016-af38984d757e.png)\r\n\r\n**Training logs**\r\n[none.txt](https://github.com/zalandoresearch/flair/files/3583976/none.txt)\r\n[gpu.txt](https://github.com/zalandoresearch/flair/files/3583978/gpu.txt)\r\n[cpu.txt](https://github.com/zalandoresearch/flair/files/3583977/cpu.txt)\r\n\r\n**Environment**\r\n - GPU: RTX 2080 Ti (11GB memory)\r\n - Ubuntu 16.04.5\r\n - Python 3.7\r\n - CUDA 10.0.130, `apex` 0.1\r\n - `flair` 0.4.3\r\n - `spacy` 2.1.8\r\n - `pytorch_transformers` 1.1.0\r\n\r\n**Additional info**\r\nThe training sessions are made with a downsampled dataset (`downsample=0.1`). When I try to train on the entire dataset (150k sentences), I get a CUDA out of memory error after about 1/10 of an epoch. This seems to be already mentioned here: https://github.com/zalandoresearch/flair/issues/563#issuecomment-515323911. ", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1078/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1078/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1060", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1060/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1060/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1060/events", "html_url": "https://github.com/flairNLP/flair/issues/1060", "id": 488564299, "node_id": "MDU6SXNzdWU0ODg1NjQyOTk=", "number": 1060, "title": "tags_proba_dist returns empty dict", "user": {"login": "m-michalek", "id": 20742170, "node_id": "MDQ6VXNlcjIwNzQyMTcw", "avatar_url": "https://avatars.githubusercontent.com/u/20742170?v=4", "gravatar_id": "", "url": "https://api.github.com/users/m-michalek", "html_url": "https://github.com/m-michalek", "followers_url": "https://api.github.com/users/m-michalek/followers", "following_url": "https://api.github.com/users/m-michalek/following{/other_user}", "gists_url": "https://api.github.com/users/m-michalek/gists{/gist_id}", "starred_url": "https://api.github.com/users/m-michalek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/m-michalek/subscriptions", "organizations_url": "https://api.github.com/users/m-michalek/orgs", "repos_url": "https://api.github.com/users/m-michalek/repos", "events_url": "https://api.github.com/users/m-michalek/events{/privacy}", "received_events_url": "https://api.github.com/users/m-michalek/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-09-03T12:04:17Z", "updated_at": "2019-09-04T14:06:15Z", "closed_at": "2019-09-04T14:06:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "Shouldn't the following code not return the probability distribution over all classes?\r\n\r\n`from flair.datasets import WIKINER_ENGLISH`\r\n`from flair.models import SequenceTagger`\r\n\r\n`corpus = WIKINER_ENGLISH().downsample(0.99)`\r\n`tagger = SequenceTagger.load('ner')`\r\n\r\n`tagger.predict(corpus.train[10])`\r\n`for token in corpus.train[10]:`\r\n`    print(token.tags_proba_dist)`\r\n\r\n![image](https://user-images.githubusercontent.com/20742170/64171731-a5284d00-ce53-11e9-879d-d23600b204af.png)\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - OS: macOS 10.14.06\r\n - Version: 0.4.3.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1060/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1060/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1059", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1059/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1059/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1059/events", "html_url": "https://github.com/flairNLP/flair/issues/1059", "id": 488406823, "node_id": "MDU6SXNzdWU0ODg0MDY4MjM=", "number": 1059, "title": "Flair overriding user logging config", "user": {"login": "Kotwic4", "id": 10147099, "node_id": "MDQ6VXNlcjEwMTQ3MDk5", "avatar_url": "https://avatars.githubusercontent.com/u/10147099?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Kotwic4", "html_url": "https://github.com/Kotwic4", "followers_url": "https://api.github.com/users/Kotwic4/followers", "following_url": "https://api.github.com/users/Kotwic4/following{/other_user}", "gists_url": "https://api.github.com/users/Kotwic4/gists{/gist_id}", "starred_url": "https://api.github.com/users/Kotwic4/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Kotwic4/subscriptions", "organizations_url": "https://api.github.com/users/Kotwic4/orgs", "repos_url": "https://api.github.com/users/Kotwic4/repos", "events_url": "https://api.github.com/users/Kotwic4/events{/privacy}", "received_events_url": "https://api.github.com/users/Kotwic4/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-09-03T05:59:12Z", "updated_at": "2019-09-08T12:22:48Z", "closed_at": "2019-09-08T12:22:48Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nDuring import Flair set the root logger to WARN overriding any user provided basicConfig(see [__init__.py#L40](https://github.com/zalandoresearch/flair/blob/master/flair/__init__.py#L40)).\r\n\r\nThis is problem for me, because I am creating python microservice with flair and I need to have logs from system.\r\n\r\n**To Reproduce**\r\n```\r\nimport logging\r\nlogging.basicConfig(\r\n    format=\"%(asctime)s : %(levelname)s : %(message)s\", level=logging.INFO\r\n)\r\nlogging.info(\"First info\")\r\n\r\nimport flair\r\nlogging.info(\"Second info\")\r\n\r\nlogging.basicConfig(\r\n    format=\"%(asctime)s : %(levelname)s : %(message)s\", level=logging.INFO\r\n)\r\nlogging.info(\"Third info\")\r\n```\r\nOnly the first log will be present.\r\n\r\n**Expected behavior**\r\nAll user log should be present\r\n\r\n**Screenshots**\r\n![image](https://user-images.githubusercontent.com/10147099/64147236-eb63b900-ce1f-11e9-842d-4bdbbf61c870.png)\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Ubuntu 18.04.3 LTS\r\n - Version [e.g. flair-0.3.2]: Flair-0.4.3\r\n\r\n**Additional context**\r\nRelated issuses:\r\nhttps://github.com/zalandoresearch/flair/issues/282\r\nhttps://github.com/zalandoresearch/flair/issues/415\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1059/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1059/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1054", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1054/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1054/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1054/events", "html_url": "https://github.com/flairNLP/flair/issues/1054", "id": 487985212, "node_id": "MDU6SXNzdWU0ODc5ODUyMTI=", "number": 1054, "title": "CSVClassificationCorpus loading file encoding error", "user": {"login": "eurekaqq", "id": 18001641, "node_id": "MDQ6VXNlcjE4MDAxNjQx", "avatar_url": "https://avatars.githubusercontent.com/u/18001641?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eurekaqq", "html_url": "https://github.com/eurekaqq", "followers_url": "https://api.github.com/users/eurekaqq/followers", "following_url": "https://api.github.com/users/eurekaqq/following{/other_user}", "gists_url": "https://api.github.com/users/eurekaqq/gists{/gist_id}", "starred_url": "https://api.github.com/users/eurekaqq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eurekaqq/subscriptions", "organizations_url": "https://api.github.com/users/eurekaqq/orgs", "repos_url": "https://api.github.com/users/eurekaqq/repos", "events_url": "https://api.github.com/users/eurekaqq/events{/privacy}", "received_events_url": "https://api.github.com/users/eurekaqq/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-09-02T04:11:32Z", "updated_at": "2019-09-02T07:42:26Z", "closed_at": "2019-09-02T07:42:26Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhen I try to load a utf-8 CSV format dataset, I will get error about encoding error.\r\n\r\n**To Reproduce**\r\n```\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import CSVClassificationCorpus\r\n\r\ndata_folder = 'data/training_data/'\r\ncolumn_name_map = {0: \"text\", 1: \"label\"}\r\n\r\ncorpus: Corpus = CSVClassificationCorpus(data_folder,\r\n                                         column_name_map,\r\n                                         skip_header=False,\r\n                                         delimiter='\\t') \r\n```\r\nYou should make sure that your terminal uses the \"ascii\" encoding and loads your utf-8 csv file. And then, you will get the same error.\r\n\r\n**Expected behavior**\r\nload my csv file and without any errors.\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]:  Ubuntu 16.04 \r\n - Version [e.g. flair-0.3.2]: latest flair with torch 1.1.0\r\n\r\n**Additional context**\r\nI fixed this problem, I will PR soon.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1054/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1054/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1052", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1052/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1052/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1052/events", "html_url": "https://github.com/flairNLP/flair/issues/1052", "id": 487811518, "node_id": "MDU6SXNzdWU0ODc4MTE1MTg=", "number": 1052, "title": "Semantic frame tagger throws NotImplementedError: cannot instantiate 'PosixPath' on your system", "user": {"login": "Code4SAFrankie", "id": 6196390, "node_id": "MDQ6VXNlcjYxOTYzOTA=", "avatar_url": "https://avatars.githubusercontent.com/u/6196390?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Code4SAFrankie", "html_url": "https://github.com/Code4SAFrankie", "followers_url": "https://api.github.com/users/Code4SAFrankie/followers", "following_url": "https://api.github.com/users/Code4SAFrankie/following{/other_user}", "gists_url": "https://api.github.com/users/Code4SAFrankie/gists{/gist_id}", "starred_url": "https://api.github.com/users/Code4SAFrankie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Code4SAFrankie/subscriptions", "organizations_url": "https://api.github.com/users/Code4SAFrankie/orgs", "repos_url": "https://api.github.com/users/Code4SAFrankie/repos", "events_url": "https://api.github.com/users/Code4SAFrankie/events{/privacy}", "received_events_url": "https://api.github.com/users/Code4SAFrankie/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 20, "created_at": "2019-08-31T21:07:51Z", "updated_at": "2020-05-29T06:54:54Z", "closed_at": "2020-05-24T15:27:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nThe semantic frame tagger throws a \"NotImplementedError: cannot instantiate 'PosixPath' on your system\" error on Windows 10 when downloading the model.\r\n\r\n**To Reproduce**\r\nfrom flair.models import SequenceTagger\r\nfrom flair.data import Sentence\r\nsentence = Sentence(\"Ek bly in Kaapstad .\")\r\nframe_tagger = SequenceTagger.load('frame')\r\n\r\n2019-08-31 22:58:33,716 loading file C:\\Users\\User\\.flair\\models\\en-frame-ontonotes-v0.4.pt\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"E:\\WPy-3710\\python-3.7.1.amd64\\lib\\site-packages\\flair\\nn.py\", line 101, in load\r\n    state = torch.load(f, map_location=flair.device)\r\n  File \"E:\\WPy-3710\\python-3.7.1.amd64\\lib\\site-packages\\torch\\serialization.py\", line 386, in load\r\n    return _load(f, map_location, pickle_module, **pickle_load_args)\r\n  File \"E:\\WPy-3710\\python-3.7.1.amd64\\lib\\site-packages\\torch\\serialization.py\", line 573, in _load\r\n    result = unpickler.load()\r\n  File \"E:\\WPy-3710\\python-3.7.1.amd64\\Lib\\pathlib.py\", line 997, in __new__\r\n    % (cls.__name__,))\r\nNotImplementedError: cannot instantiate 'PosixPath' on your system\r\n\r\n**Expected behavior**\r\nExpected the semantic frame tagger model to be successfully downloaded.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: WinPython 3.7.1 (v3.7.1:260ec2c36a, Oct 20 2018, 14:57:15) [MSC v.1915 64 bit (AMD64)] on win32\r\n - Version [e.g. flair-0.3.2]: flair-0.4.2, torch-1.0.1\r\n\r\n**Additional context**\r\nThe upos, ner and other models loaded fine. Tried DOS and Jupyter-lab notebook.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1052/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1052/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1051", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1051/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1051/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1051/events", "html_url": "https://github.com/flairNLP/flair/issues/1051", "id": 487733513, "node_id": "MDU6SXNzdWU0ODc3MzM1MTM=", "number": 1051, "title": "Runtime error -training a text classifier on Google Colab", "user": {"login": "Shivanandroy", "id": 25221992, "node_id": "MDQ6VXNlcjI1MjIxOTky", "avatar_url": "https://avatars.githubusercontent.com/u/25221992?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Shivanandroy", "html_url": "https://github.com/Shivanandroy", "followers_url": "https://api.github.com/users/Shivanandroy/followers", "following_url": "https://api.github.com/users/Shivanandroy/following{/other_user}", "gists_url": "https://api.github.com/users/Shivanandroy/gists{/gist_id}", "starred_url": "https://api.github.com/users/Shivanandroy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Shivanandroy/subscriptions", "organizations_url": "https://api.github.com/users/Shivanandroy/orgs", "repos_url": "https://api.github.com/users/Shivanandroy/repos", "events_url": "https://api.github.com/users/Shivanandroy/events{/privacy}", "received_events_url": "https://api.github.com/users/Shivanandroy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-08-31T05:40:52Z", "updated_at": "2019-09-27T21:08:17Z", "closed_at": "2019-09-27T21:08:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nRuntimeError: Expected object of backend CUDA but got backend CPU for sequence element 413 in sequence argument at position #1 'tensors'\r\n\r\n**To Reproduce**\r\nfrom flair.data_fetcher import NLPTaskDataFetcher\r\nfrom flair.embeddings import WordEmbeddings, FlairEmbeddings, DocumentLSTMEmbeddings\r\nfrom flair.models import TextClassifier\r\nfrom flair.trainers import ModelTrainer\r\nfrom pathlib import Path\r\ncorpus =  NLPTaskDataFetcher.load_classification_corpus(Path('.'))\r\nword_embeddings = [WordEmbeddings('glove'), FlairEmbeddings('news-forward-fast'), FlairEmbeddings('news-backward-fast')]\r\ndocument_embeddings = DocumentLSTMEmbeddings(word_embeddings, hidden_size=512, reproject_words=True, reproject_words_dimension=256)\r\nclassifier = TextClassifier(document_embeddings, label_dictionary=corpus.make_label_dictionary(), multi_label=False)\r\ntrainer = ModelTrainer(classifier, corpus)\r\ntrainer.train('./', max_epochs=10)\r\n\r\n**Environment (please complete the following information):**\r\n - Google Colab\r\n - Flair (0.4.3)\r\n![2019-08-31 05_38_33-Untitled2 ipynb - Colaboratory](https://user-images.githubusercontent.com/25221992/64059749-dda8fc00-cbb1-11e9-8c16-a21d230b721d.png)\r\n\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1051/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1051/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1050", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1050/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1050/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1050/events", "html_url": "https://github.com/flairNLP/flair/issues/1050", "id": 487602194, "node_id": "MDU6SXNzdWU0ODc2MDIxOTQ=", "number": 1050, "title": "ELMo Embeddings return empty tensor", "user": {"login": "lambdaofgod", "id": 3647577, "node_id": "MDQ6VXNlcjM2NDc1Nzc=", "avatar_url": "https://avatars.githubusercontent.com/u/3647577?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lambdaofgod", "html_url": "https://github.com/lambdaofgod", "followers_url": "https://api.github.com/users/lambdaofgod/followers", "following_url": "https://api.github.com/users/lambdaofgod/following{/other_user}", "gists_url": "https://api.github.com/users/lambdaofgod/gists{/gist_id}", "starred_url": "https://api.github.com/users/lambdaofgod/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lambdaofgod/subscriptions", "organizations_url": "https://api.github.com/users/lambdaofgod/orgs", "repos_url": "https://api.github.com/users/lambdaofgod/repos", "events_url": "https://api.github.com/users/lambdaofgod/events{/privacy}", "received_events_url": "https://api.github.com/users/lambdaofgod/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-08-30T17:51:13Z", "updated_at": "2019-08-31T11:42:47Z", "closed_at": "2019-08-31T11:42:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI get empty tensor when I try to run ELMo Embeddings.\r\n\r\n**To Reproduce**\r\n```\r\nfrom flair import embeddings as flair_embeddings\r\nfrom flair.data import Sentence\r\n\r\nelmo_model = flair_embeddings.ELMoEmbeddings()\r\n\r\nsentence = Sentence(\"I love to code\")\r\nelmo_model.embed(sentence)[0].embedding\r\n```\r\n\r\nGives\r\n\r\n> tensor([])\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - Ubuntu 18.04\r\n> >>> flair.__version__                                         \r\n> '0.4.3'                                                       \r\n> >>> allennlp.__version__                                       \r\n> '0.8.5'                       ", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1050/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1050/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1048", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1048/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1048/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1048/events", "html_url": "https://github.com/flairNLP/flair/issues/1048", "id": 487391734, "node_id": "MDU6SXNzdWU0ODczOTE3MzQ=", "number": 1048, "title": "Loading CoNLL-03 corpus throws TypeError: unsupported operand type(s) for /: 'str' and 'str'", "user": {"login": "m-michalek", "id": 20742170, "node_id": "MDQ6VXNlcjIwNzQyMTcw", "avatar_url": "https://avatars.githubusercontent.com/u/20742170?v=4", "gravatar_id": "", "url": "https://api.github.com/users/m-michalek", "html_url": "https://github.com/m-michalek", "followers_url": "https://api.github.com/users/m-michalek/followers", "following_url": "https://api.github.com/users/m-michalek/following{/other_user}", "gists_url": "https://api.github.com/users/m-michalek/gists{/gist_id}", "starred_url": "https://api.github.com/users/m-michalek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/m-michalek/subscriptions", "organizations_url": "https://api.github.com/users/m-michalek/orgs", "repos_url": "https://api.github.com/users/m-michalek/repos", "events_url": "https://api.github.com/users/m-michalek/events{/privacy}", "received_events_url": "https://api.github.com/users/m-michalek/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-08-30T09:44:42Z", "updated_at": "2019-08-30T11:44:58Z", "closed_at": "2019-08-30T11:44:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "I downloaded the CoNLL-03 dataset from [this repo](https://github.com/patverga/torch-ner-nlp-from-scratch/tree/master/data/conll2003) into the `/resources/tasks/conll_03/` directory and executed following code:\r\n\r\n`from flair.datasets import CONLL_03`\r\n`corpus: Corpus = CONLL_03(base_path='resources/tasks')`\r\n\r\nBut I get the following error:\r\n<img width=\"933\" alt=\"Bildschirmfoto 2019-08-30 um 11 40 44\" src=\"https://user-images.githubusercontent.com/20742170/64010995-13e76c80-cb1b-11e9-9b3a-e51226924c3e.png\">\r\n\r\nWhat am I missing here?\r\n\r\n**Environment (please complete the following information):**\r\n - OS: macOS 10.14.6.\r\n - Version: 0.4.2.\r\n\r\nThanks for any help!", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1048/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1048/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1043", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1043/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1043/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1043/events", "html_url": "https://github.com/flairNLP/flair/issues/1043", "id": 486899716, "node_id": "MDU6SXNzdWU0ODY4OTk3MTY=", "number": 1043, "title": "Evaluation Metric: improvements", "user": {"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178843, "node_id": "MDU6TGFiZWw5NjExNzg4NDM=", "url": "https://api.github.com/repos/flairNLP/flair/labels/enhancement", "name": "enhancement", "color": "f9f195", "default": true, "description": "Improving of an existing feature"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-08-29T11:24:45Z", "updated_at": "2020-05-06T22:32:57Z", "closed_at": "2020-05-06T22:32:57Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Hi,\r\n\r\ncurrently the evaluation output has some problems e.g. for accuracy-based experiments or NER F-Scores\r\n\r\n# PoS tagging\r\n\r\nHere's an example for PoS tagging (example can be run on normal CPU):\r\n \r\n```python\r\nfrom typing import List\r\n\r\nimport flair.datasets\r\nfrom flair.data import Corpus\r\nfrom flair.embeddings import (\r\n    TokenEmbeddings,\r\n    WordEmbeddings,\r\n    StackedEmbeddings,\r\n    FlairEmbeddings,\r\n    CharacterEmbeddings,\r\n)\r\nfrom flair.training_utils import EvaluationMetric\r\nfrom flair.visual.training_curves import Plotter\r\n\r\n# 1. get the corpus\r\ncorpus: Corpus = flair.datasets.UD_ENGLISH().downsample(0.1)\r\nprint(corpus)\r\n\r\n# 2. what tag do we want to predict?\r\ntag_type = \"upos\"\r\n\r\n# 3. make the tag dictionary from the corpus\r\ntag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\nprint(tag_dictionary.idx2item)\r\n\r\n# initialize embeddings\r\nembedding_types: List[TokenEmbeddings] = [\r\n    WordEmbeddings(\"glove\"),\r\n]\r\n\r\nembeddings: StackedEmbeddings = StackedEmbeddings(embeddings=embedding_types)\r\n\r\n# initialize sequence tagger\r\nfrom flair.models import SequenceTagger\r\n\r\ntagger: SequenceTagger = SequenceTagger(\r\n    hidden_size=256,\r\n    embeddings=embeddings,\r\n    tag_dictionary=tag_dictionary,\r\n    tag_type=tag_type,\r\n    use_crf=True,\r\n)\r\n\r\n# initialize trainer\r\nfrom flair.trainers import ModelTrainer\r\n\r\ntrainer: ModelTrainer = ModelTrainer(tagger, corpus)\r\n\r\ntrainer.train(\r\n    \"resources/taggers/example-pos\",\r\n    learning_rate=0.1,\r\n    mini_batch_size=32,\r\n    max_epochs=1,\r\n    shuffle=False,\r\n)\r\n\r\n# Evaluation\r\nfrom flair.data import Sentence\r\n\r\nloaded_tagger: SequenceTagger = SequenceTagger.load(\"resources/taggers/example-pos/best-model.pt\")\r\n\r\nnumber_tags = 0\r\nnumber_correct_tags = 0\r\n\r\nfor sentence in corpus.test:\r\n    tokens = sentence.tokens\r\n    gold_tags = [token.tags['upos'].value for token in sentence.tokens]\r\n\r\n    tagged_sentence = Sentence()\r\n    tagged_sentence.tokens = tokens\r\n\r\n    tagger.predict(tagged_sentence)\r\n\r\n    predicted_tags = [token.tags['upos'].value for token in tagged_sentence.tokens]\r\n    \r\n    assert len(tokens) == len(gold_tags)\r\n    assert len(gold_tags) == len(predicted_tags)\r\n    \r\n    number_tags += len(predicted_tags)\r\n    \r\n    for gold_tag, predicted_tag in zip(gold_tags, predicted_tags):\r\n        if gold_tag == predicted_tag:\r\n            number_correct_tags += 1\r\n\r\nprint(f'Accuracy: {number_correct_tags / number_tags}')\r\n```\r\n\r\nIt outputs:\r\n\r\n```bash\r\nMICRO_AVG: acc 0.2413 - f1-score 0.3887\r\nMACRO_AVG: acc 0.1386 - f1-score 0.20893529411764705\r\n```\r\n\r\nThis output comes from Flair. The accuracy calculation outputs:\r\n\r\n```bash\r\nAccuracy: 0.38861588861588864\r\n```\r\n\r\nThis values corresponds to the \"f1-score\" output of Flair. So this should be corrected :)\r\n\r\n# NER\r\n\r\nI've seen some little differences between the Flair output (F-Score) and the official CoNLL script (yes, I pass IOB tags to that script \ud83d\ude05).\r\n\r\nIt would be great to get back to the \"old\" evaluation logic that uses the CoNLL perl script. Maybe the `train()` method interface could be extended and get an `evaluation_metric` enum (`flair_native`, `conll` or even `scikit-learn`) \ud83e\udd14\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1043/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1043/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1039", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1039/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1039/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1039/events", "html_url": "https://github.com/flairNLP/flair/issues/1039", "id": 485699154, "node_id": "MDU6SXNzdWU0ODU2OTkxNTQ=", "number": 1039, "title": "TypeError: train() got multiple values for argument 'learning_rate'", "user": {"login": "ericlief", "id": 16747511, "node_id": "MDQ6VXNlcjE2NzQ3NTEx", "avatar_url": "https://avatars.githubusercontent.com/u/16747511?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ericlief", "html_url": "https://github.com/ericlief", "followers_url": "https://api.github.com/users/ericlief/followers", "following_url": "https://api.github.com/users/ericlief/following{/other_user}", "gists_url": "https://api.github.com/users/ericlief/gists{/gist_id}", "starred_url": "https://api.github.com/users/ericlief/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ericlief/subscriptions", "organizations_url": "https://api.github.com/users/ericlief/orgs", "repos_url": "https://api.github.com/users/ericlief/repos", "events_url": "https://api.github.com/users/ericlief/events{/privacy}", "received_events_url": "https://api.github.com/users/ericlief/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-08-27T09:37:18Z", "updated_at": "2020-04-30T00:35:20Z", "closed_at": "2020-04-30T00:35:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nTypeError: train() got multiple values for argument 'learning_rate'\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior (e.g. which model did you train? what parameters did you use? etc.).\r\n\r\n```python\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import ColumnCorpus\r\nfrom os.path import join, dirname\r\n\r\n# Define columns\r\ncolumns = {0: 'token', 1: 'label'}\r\n\r\n# this is the folder in which train, test and dev files reside\r\nbase_dir = \"/content/gdrive/My Drive/tagger/data\"\r\n\r\n# Instantiate corpus\r\ncorpus: Corpus = ColumnCorpus(base_dir, columns,\r\n                              train_file=join(base_dir, \"mixed.conll\"),\r\n                              dev_file=join(base_dir, \"mixed.conll\"),   # will be dev?\r\n                              test_file=join(base_dir, \"mixed.conll\"))  # will be test?   \r\ntag_type = \"label\"\r\ntag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\n\r\nembeddings  = StackedEmbeddings([BytePairEmbeddings('en'),\r\n                                 CharacterEmbeddings(),                                         \r\n                                 BertEmbeddings(\"bert-base-cased\"), \r\n                                 ]) \r\n\r\nfrom flair.models import SequenceTagger\r\n\r\n\r\n# Flair model                                 \r\ntagger: SequenceTagger = SequenceTagger(hidden_size=64,\r\n                                        embeddings=embeddings,\r\n                                        tag_dictionary=tag_dictionary,\r\n                                        tag_type=tag_type,\r\n                                        dropout = .158,\r\n                                        word_dropout=.059,\r\n                                        locked_dropout=.17,\r\n                                        use_crf=True)\r\n\r\n# Initialize trainer\r\nfrom flair.trainers import ModelTrainer\r\nfrom flair.training_utils import EvaluationMetric\r\n\r\ntrainer: ModelTrainer = ModelTrainer(tagger, corpus)\r\n\r\ndef train(epochs=5, checkpoint=False):\r\n    trainer.train(base_dir,\r\n              EvaluationMetric.MICRO_F1_SCORE,\r\n              learning_rate=0.15,\r\n              mini_batch_size=8,\r\n              max_epochs=epochs,\r\n              patience=5,\r\n              checkpoint=True)\r\n\r\n \r\nfrom flair.data import Sentence\r\n\r\ndef eval():\r\n  print(\"Evaluating\")\r\n  sentence = Sentence(\"This Work Agreement (\u201cAgreement\u201d) is effective on January 11, 2011, between Price Waterhouse Coopers, Inc. (the \u201cCompany\u201d), and Jan Macian (the \u201cExecutive\u201d).\", use_tokenizer=True)\r\n  trainer.model.predict(sentence)\r\n  print(sentence.to_tagged_string())\r\n  sentence = Sentence(\"This executive employment contract is entered as of April 20, 2019, between fabrisoft, LLC. and Eric A. Lief.\", use_tokenizer=True)\r\n  trainer.model.predict(sentence)\r\n  print(sentence.to_tagged_string())\r\n  sentence = Sentence(\"This employment contract between Duncan, LLC. and Joe Hawkes.\", use_tokenizer=True)\r\n  trainer.model.predict(sentence)\r\n  print(sentence.to_tagged_string())\r\n  sentence = Sentence(\"Microsoft, Inc. sued Jan Hajic\", use_tokenizer=True)\r\n  trainer.model.predict(sentence)\r\n  print(sentence.to_tagged_string()) \r\n  sentence = Sentence(\"THIS EMPLOYMENT AGREEMENT (this \u201cAgreement\u201d) is made and entered into as of this 28th day of December, 2010, but is effective as of January 28, 2011 (the \u201cEffective Date\u201d), by and between SUSQUEHANNA BANCSHARES, INC. , a Pennsylvania corporation (the \u201cCompany\u201d), and Gregory A. Duncan , an adult individual whose principal residence is at (the \u201cEmployee\u201d), on the other side.\")\r\n  trainer.model.predict(sentence)\r\n  print(sentence.to_tagged_string())  \r\n  sentence = Sentence(\"Joe Blow cannot solicit any customers to patronize any business directly or indirectly in competition with the businesses conducted by the Company or any subsidiary or affiliate of the Company at any time during the Executive's relationship with the Company\", use_tokenizer=True)\r\n  print(sentence.to_tagged_string())  \r\n  sentence = Sentence(\"Apple was founded by Steve Jobs, Steve Wozniak, and Ronald Wayne in April 1976 to develop and sell Wozniak's Apple I personal computer, though Wayne sold his share back within 12 days.\", use_tokenizer=True)\r\n  print(sentence.to_tagged_string())  \r\n  \r\ntrain(10)\r\neval()\r\ntrain(10)\r\neval()\r\ntrain(10)\r\neval()\r\n```\r\n\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-9-8293d2cc22b0> in <module>\r\n     40   print(sentence.to_tagged_string())\r\n     41 \r\n---> 42 train(10)\r\n     43 eval()\r\n     44 train(10)\r\n\r\n<ipython-input-9-8293d2cc22b0> in train(epochs, checkpoint)\r\n     12               max_epochs=epochs,\r\n     13               patience=5,\r\n---> 14               checkpoint=True)\r\n     15 \r\n     16 # 8. stop training at any point\r\n\r\nTypeError: train() got multiple values for argument 'learning_rate'\r\n\r\n**Expected behavior**\r\nSame code trains in 0.4.2\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]:\r\n - Version [e.g. flair-0.3.2]:\r\n\r\nUbuntu 19, but running in colab (GPU)\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1039/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1039/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1036", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1036/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1036/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1036/events", "html_url": "https://github.com/flairNLP/flair/issues/1036", "id": 485279603, "node_id": "MDU6SXNzdWU0ODUyNzk2MDM=", "number": 1036, "title": "[NER] use_amp crashes when used for NER training", "user": {"login": "pommedeterresautee", "id": 1029874, "node_id": "MDQ6VXNlcjEwMjk4NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1029874?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pommedeterresautee", "html_url": "https://github.com/pommedeterresautee", "followers_url": "https://api.github.com/users/pommedeterresautee/followers", "following_url": "https://api.github.com/users/pommedeterresautee/following{/other_user}", "gists_url": "https://api.github.com/users/pommedeterresautee/gists{/gist_id}", "starred_url": "https://api.github.com/users/pommedeterresautee/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pommedeterresautee/subscriptions", "organizations_url": "https://api.github.com/users/pommedeterresautee/orgs", "repos_url": "https://api.github.com/users/pommedeterresautee/repos", "events_url": "https://api.github.com/users/pommedeterresautee/events{/privacy}", "received_events_url": "https://api.github.com/users/pommedeterresautee/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2019-08-26T14:53:18Z", "updated_at": "2020-04-30T10:55:08Z", "closed_at": "2020-04-30T10:55:08Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nUsing master branch, simple NER training crashes when `use_amp=True`.  \r\nIt happens at the very beginning of the second epoch (I tried many times).\r\n\r\nThe exception looks like:\r\n\r\n```\r\n2019-08-26 16:38:22,851 Reading data from /tmp\r\n2019-08-26 16:38:22,851 Train: /tmp/tmpl7l954km\r\n2019-08-26 16:38:22,851 Dev: /tmp/tmpfhh1l1z3\r\n2019-08-26 16:38:22,851 Test: /tmp/tmpfhh1l1z3\r\n2019-08-26 16:38:32,482 ----------------------------------------------------------------------------------------------------\r\n2019-08-26 16:38:32,483 Model: \"SequenceTagger(\r\n  (embeddings): StackedEmbeddings(\r\n    (list_embedding_0): WordEmbeddings('fr')\r\n    (list_embedding_1): FlairEmbeddings(\r\n      (lm): LanguageModel(\r\n        (drop): Dropout(p=0.5, inplace=False)\r\n        (encoder): Embedding(275, 100)\r\n        (rnn): LSTM(100, 1024)\r\n        (decoder): Linear(in_features=1024, out_features=275, bias=True)\r\n      )\r\n    )\r\n    (list_embedding_2): FlairEmbeddings(\r\n      (lm): LanguageModel(\r\n        (drop): Dropout(p=0.5, inplace=False)\r\n        (encoder): Embedding(275, 100)\r\n        (rnn): LSTM(100, 1024)\r\n        (decoder): Linear(in_features=1024, out_features=275, bias=True)\r\n      )\r\n    )\r\n  )\r\n  (word_dropout): WordDropout(p=0.05)\r\n  (locked_dropout): LockedDropout(p=0.5)\r\n  (embedding2nn): Linear(in_features=2348, out_features=2348, bias=True)\r\n  (rnn): LSTM(2348, 256, bidirectional=True)\r\n  (linear): Linear(in_features=512, out_features=42, bias=True)\r\n)\"\r\n2019-08-26 16:38:32,483 ----------------------------------------------------------------------------------------------------\r\n2019-08-26 16:38:32,483 Corpus: \"Corpus: 6968 train + 2148 dev + 2148 test sentences\"\r\n2019-08-26 16:38:32,483 ----------------------------------------------------------------------------------------------------\r\n2019-08-26 16:38:32,483 Parameters:\r\n2019-08-26 16:38:32,483  - learning_rate: \"0.1\"\r\n2019-08-26 16:38:32,483  - mini_batch_size: \"32\"\r\n2019-08-26 16:38:32,483  - patience: \"3\"\r\n2019-08-26 16:38:32,483  - anneal_factor: \"0.5\"\r\n2019-08-26 16:38:32,483  - max_epochs: \"100\"\r\n2019-08-26 16:38:32,483  - shuffle: \"True\"\r\n2019-08-26 16:38:32,483  - train_with_dev: \"False\"\r\n2019-08-26 16:38:32,483 ----------------------------------------------------------------------------------------------------\r\n2019-08-26 16:38:32,483 Model training base path: \"resources/flair_ner/abc\"\r\n2019-08-26 16:38:32,483 ----------------------------------------------------------------------------------------------------\r\n2019-08-26 16:38:32,483 Device: cuda:0\r\n2019-08-26 16:38:32,483 ----------------------------------------------------------------------------------------------------\r\n2019-08-26 16:38:32,483 Embeddings storage mode: cpu\r\nSelected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.\r\n\r\nDefaults for this optimization level are:\r\nenabled                : True\r\nopt_level              : O1\r\ncast_model_type        : None\r\npatch_torch_functions  : True\r\nkeep_batchnorm_fp32    : None\r\nmaster_weights         : None\r\nloss_scale             : dynamic\r\nProcessing user overrides (additional kwargs that are not None)...\r\nAfter processing overrides, optimization options are:\r\nenabled                : True\r\nopt_level              : O1\r\ncast_model_type        : None\r\npatch_torch_functions  : True\r\nkeep_batchnorm_fp32    : None\r\nmaster_weights         : None\r\nloss_scale             : dynamic\r\n2019-08-26 16:38:32,487 ----------------------------------------------------------------------------------------------------\r\nGradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 32768.0\r\n2019-08-26 16:38:33,343 epoch 1 - iter 0/218 - loss 100.49298096 - samples/sec: 785.44\r\nGradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 16384.0\r\nGradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 8192.0\r\nGradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 4096.0\r\nGradient overflow.  Skipping step, loss scaler 0 reducing loss scale to 2048.0\r\n2019-08-26 16:38:43,584 epoch 1 - iter 21/218 - loss 40.48044270 - samples/sec: 65.72\r\n2019-08-26 16:38:53,553 epoch 1 - iter 42/218 - loss 27.45308078 - samples/sec: 67.51\r\n2019-08-26 16:39:04,410 epoch 1 - iter 63/218 - loss 21.81346110 - samples/sec: 61.98\r\n2019-08-26 16:39:16,687 epoch 1 - iter 84/218 - loss 18.24704664 - samples/sec: 54.81\r\n2019-08-26 16:39:27,822 epoch 1 - iter 105/218 - loss 15.73898192 - samples/sec: 60.43\r\n2019-08-26 16:39:40,383 epoch 1 - iter 126/218 - loss 14.07157230 - samples/sec: 53.56\r\n2019-08-26 16:39:51,389 epoch 1 - iter 147/218 - loss 12.75365825 - samples/sec: 61.14\r\n2019-08-26 16:40:03,459 epoch 1 - iter 168/218 - loss 11.72439751 - samples/sec: 55.75\r\n2019-08-26 16:40:14,550 epoch 1 - iter 189/218 - loss 10.80741645 - samples/sec: 60.71\r\n2019-08-26 16:40:26,553 epoch 1 - iter 210/218 - loss 10.04385874 - samples/sec: 56.05\r\n2019-08-26 16:40:29,826 ----------------------------------------------------------------------------------------------------\r\n2019-08-26 16:40:29,826 EPOCH 1 done: loss 9.8243 - lr 0.1000\r\n2019-08-26 16:41:17,493 DEV : loss 3.2933993339538574 - score 0.6285\r\n2019-08-26 16:41:17,704 BAD EPOCHS (no improvement): 0\r\n2019-08-26 16:41:23,738 ----------------------------------------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"flair_train.py\", line 72, in <module>\r\n    nb_epochs=int(args.epoch))\r\n  File \"flair_train.py\", line 64, in main\r\n    checkpoint=False)\r\n  File \"/home/geantvert/.local/share/virtualenvs/anonymisation/venv/lib/python3.7/site-packages/flair/trainers/trainer.py\", line 265, in train\r\n    loss = self.model.forward_loss(batch)\r\n  File \"/home/geantvert/.local/share/virtualenvs/anonymisation/venv/lib/python3.7/site-packages/flair/models/sequence_tagger_model.py\", line 330, in forward_loss\r\n    features = self.forward(data_points)\r\n  File \"/home/geantvert/.local/share/virtualenvs/anonymisation/venv/lib/python3.7/site-packages/flair/models/sequence_tagger_model.py\", line 410, in forward\r\n    [token.get_embedding().unsqueeze(0) for token in sentence], 0\r\n  File \"/home/geantvert/.local/share/virtualenvs/anonymisation/venv/lib/python3.7/site-packages/flair/models/sequence_tagger_model.py\", line 410, in <listcomp>\r\n    [token.get_embedding().unsqueeze(0) for token in sentence], 0\r\n  File \"/home/geantvert/.local/share/virtualenvs/anonymisation/venv/lib/python3.7/site-packages/flair/data.py\", line 240, in get_embedding\r\n    return torch.cat(embeddings, dim=0)\r\n  File \"/home/geantvert/.local/share/virtualenvs/anonymisation/venv/lib/python3.7/site-packages/apex/amp/wrap.py\", line 85, in wrapper\r\n    return orig_fn(cast_seq, *args, **kwargs)\r\nRuntimeError: Expected object of scalar type Float but got scalar type Half for sequence element 1 in sequence argument at position #1 'tensors'\r\nmake: *** [/home/geantvert/workspace/anonymisation/Makefile:98: flair_train_ca] Error 1\r\n\r\n```\r\n\r\n**To Reproduce**\r\n\r\nThe train code looks like this:\r\n\r\n```python\r\n    # ...\r\n    corpus: Corpus = ...  # this corpus works very well when use_amp=False\r\n    tag_dictionary = corpus.make_tag_dictionary(tag_type='ner')\r\n\r\n    embedding_types: List[TokenEmbeddings] = [\r\n        WordEmbeddings('fr'),\r\n        FlairEmbeddings('fr-forward'),\r\n        FlairEmbeddings('fr-backward'),\r\n    ]\r\n\r\n    embeddings: StackedEmbeddings = StackedEmbeddings(embeddings=embedding_types)\r\n\r\n    tagger: SequenceTagger = SequenceTagger(hidden_size=256,\r\n                                            embeddings=embeddings,\r\n                                            use_crf=True,\r\n                                            tag_dictionary=tag_dictionary,\r\n                                            tag_type='ner')\r\n\r\n    trainer: ModelTrainer = ModelTrainer(tagger, corpus)\r\n\r\n    trainer.train(model_folder,\r\n                  max_epochs=nb_epochs,\r\n                  use_amp=True,\r\n                  embeddings_storage_mode=\"cpu\",\r\n                  checkpoint=False)\r\n\r\n```\r\n**Expected behavior**\r\nI expect the training to work with `use_amp=True`.\r\n\r\n**Environment (please complete the following information):**\r\n\r\nFlair master branch\r\nUbuntu 19.04\r\n\r\n**Other Info**\r\n\r\nUsing `amp_opt_level=\"O0\"` or \"O2\", \"O3\" make it crash at the beginning of the first epoch, with another error message (embeddings are set to None).\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1036/reactions", "total_count": 2, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1036/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1027", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1027/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1027/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1027/events", "html_url": "https://github.com/flairNLP/flair/issues/1027", "id": 484570559, "node_id": "MDU6SXNzdWU0ODQ1NzA1NTk=", "number": 1027, "title": "type object 'TextClassifier' has no attribute 'load'", "user": {"login": "momomozhang", "id": 40863475, "node_id": "MDQ6VXNlcjQwODYzNDc1", "avatar_url": "https://avatars.githubusercontent.com/u/40863475?v=4", "gravatar_id": "", "url": "https://api.github.com/users/momomozhang", "html_url": "https://github.com/momomozhang", "followers_url": "https://api.github.com/users/momomozhang/followers", "following_url": "https://api.github.com/users/momomozhang/following{/other_user}", "gists_url": "https://api.github.com/users/momomozhang/gists{/gist_id}", "starred_url": "https://api.github.com/users/momomozhang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/momomozhang/subscriptions", "organizations_url": "https://api.github.com/users/momomozhang/orgs", "repos_url": "https://api.github.com/users/momomozhang/repos", "events_url": "https://api.github.com/users/momomozhang/events{/privacy}", "received_events_url": "https://api.github.com/users/momomozhang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-08-23T14:50:02Z", "updated_at": "2019-08-28T08:54:17Z", "closed_at": "2019-08-28T08:54:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "When calling TextClassifier.load('en-sentiment') gets the follwing error message\r\n\r\nAttributeError: type object 'TextClassifier' has no attribute 'load'\r\n\r\n\r\n**Environment (please complete the following information):**\r\nMac OS\r\nflair==0.4.2\r\npython 3.7.4", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1027/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1027/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1021", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1021/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1021/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1021/events", "html_url": "https://github.com/flairNLP/flair/issues/1021", "id": 483865734, "node_id": "MDU6SXNzdWU0ODM4NjU3MzQ=", "number": 1021, "title": "Flair embeddings are computed over tokenized string instead of original", "user": {"login": "djstrong", "id": 1849959, "node_id": "MDQ6VXNlcjE4NDk5NTk=", "avatar_url": "https://avatars.githubusercontent.com/u/1849959?v=4", "gravatar_id": "", "url": "https://api.github.com/users/djstrong", "html_url": "https://github.com/djstrong", "followers_url": "https://api.github.com/users/djstrong/followers", "following_url": "https://api.github.com/users/djstrong/following{/other_user}", "gists_url": "https://api.github.com/users/djstrong/gists{/gist_id}", "starred_url": "https://api.github.com/users/djstrong/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/djstrong/subscriptions", "organizations_url": "https://api.github.com/users/djstrong/orgs", "repos_url": "https://api.github.com/users/djstrong/repos", "events_url": "https://api.github.com/users/djstrong/events{/privacy}", "received_events_url": "https://api.github.com/users/djstrong/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-08-22T09:08:14Z", "updated_at": "2020-07-02T17:37:29Z", "closed_at": "2020-07-02T17:37:29Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nFlair embeddings in `Sentence` are computed over `to_tokenized_string` instead of `to_plain_string`. It is inconsistent with trained language model. Sometimes whitespaces are important.\r\n\r\n**Expected behavior**\r\nFlair embeddings in `Sentence` should be computed over `to_plain_string`.\r\n\r\n**Environment:**\r\n - Version: flair-0.4.2\r\n\r\n**Additional context**\r\nI have made the question here: https://github.com/zalandoresearch/flair/pull/72#issuecomment-523068227 but an issue is more appropriate place.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1021/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1021/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1015", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1015/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1015/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1015/events", "html_url": "https://github.com/flairNLP/flair/issues/1015", "id": 483506026, "node_id": "MDU6SXNzdWU0ODM1MDYwMjY=", "number": 1015, "title": "setting matplotlib backend not available", "user": {"login": "a-tsioh", "id": 4470376, "node_id": "MDQ6VXNlcjQ0NzAzNzY=", "avatar_url": "https://avatars.githubusercontent.com/u/4470376?v=4", "gravatar_id": "", "url": "https://api.github.com/users/a-tsioh", "html_url": "https://github.com/a-tsioh", "followers_url": "https://api.github.com/users/a-tsioh/followers", "following_url": "https://api.github.com/users/a-tsioh/following{/other_user}", "gists_url": "https://api.github.com/users/a-tsioh/gists{/gist_id}", "starred_url": "https://api.github.com/users/a-tsioh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/a-tsioh/subscriptions", "organizations_url": "https://api.github.com/users/a-tsioh/orgs", "repos_url": "https://api.github.com/users/a-tsioh/repos", "events_url": "https://api.github.com/users/a-tsioh/events{/privacy}", "received_events_url": "https://api.github.com/users/a-tsioh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-08-21T15:52:03Z", "updated_at": "2020-06-09T21:49:25Z", "closed_at": "2020-06-09T21:49:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "at https://github.com/zalandoresearch/flair/blob/24b72a6dfd1d0c2519794e1183cacc42c932c4f4/flair/visual/training_curves.py#L19\r\n\r\n**Describe the bug**\r\nhardcoding the backend for matplotlib prevents its use on a headless server.\r\n\r\n**To Reproduce**\r\ntry to run without tk installed\r\n\r\n**Expected behavior**\r\nbackend could be set  in the matplotlibrc file\r\n\r\n**Environment (please complete the following information):**\r\n - OS : Linux\r\n - Version : current master (0.4.2+ I think)\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1015/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1015/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1013", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1013/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1013/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1013/events", "html_url": "https://github.com/flairNLP/flair/issues/1013", "id": 483446455, "node_id": "MDU6SXNzdWU0ODM0NDY0NTU=", "number": 1013, "title": "Memory usage augmented since last release", "user": {"login": "lucaventurini", "id": 2151065, "node_id": "MDQ6VXNlcjIxNTEwNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/2151065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lucaventurini", "html_url": "https://github.com/lucaventurini", "followers_url": "https://api.github.com/users/lucaventurini/followers", "following_url": "https://api.github.com/users/lucaventurini/following{/other_user}", "gists_url": "https://api.github.com/users/lucaventurini/gists{/gist_id}", "starred_url": "https://api.github.com/users/lucaventurini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lucaventurini/subscriptions", "organizations_url": "https://api.github.com/users/lucaventurini/orgs", "repos_url": "https://api.github.com/users/lucaventurini/repos", "events_url": "https://api.github.com/users/lucaventurini/events{/privacy}", "received_events_url": "https://api.github.com/users/lucaventurini/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-08-21T14:11:35Z", "updated_at": "2019-08-22T10:26:52Z", "closed_at": "2019-08-22T10:26:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI was using v0.4.2 of flair and had some tests that I used while developing on a AWS instance with 4GB RAM. Before, running the tests on training did not consume all the RAM. I've upgraded to commit 24b72a6dfd1d0c2519794e1183cacc42c932c4f4 (to try out the new MUSE embeddings) and now the same code consumes all the memory, freezing the instance. Everything works fine on a 8GB instance.\r\n**To Reproduce**\r\nI can't share the data, but this is the part of the code that describes the network I'm using:\r\n\r\n```python\r\nword_embeddings = [WordEmbeddings('turian')]\r\n\r\ndocument_embeddings = DocumentRNNEmbeddings(word_embeddings, \r\n                                             hidden_size=512, \r\n                                             reproject_words=True, \r\n                                             reproject_words_dimension=256)\r\n    \r\nclassifier = TextClassifier(document_embeddings, \r\n                            label_dictionary=corpus.make_label_dictionary(), \r\n                            multi_label=True)\r\n\r\ntrainer = ModelTrainer(classifier, corpus)\r\n```\r\n\r\n**Expected behavior**\r\nThe memory usage should be the same.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Ubuntu\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1013/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1013/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/1012", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/1012/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/1012/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/1012/events", "html_url": "https://github.com/flairNLP/flair/issues/1012", "id": 483402238, "node_id": "MDU6SXNzdWU0ODM0MDIyMzg=", "number": 1012, "title": "NER - Slow predictions on master branch compared to version 0.4.2", "user": {"login": "pommedeterresautee", "id": 1029874, "node_id": "MDQ6VXNlcjEwMjk4NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1029874?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pommedeterresautee", "html_url": "https://github.com/pommedeterresautee", "followers_url": "https://api.github.com/users/pommedeterresautee/followers", "following_url": "https://api.github.com/users/pommedeterresautee/following{/other_user}", "gists_url": "https://api.github.com/users/pommedeterresautee/gists{/gist_id}", "starred_url": "https://api.github.com/users/pommedeterresautee/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pommedeterresautee/subscriptions", "organizations_url": "https://api.github.com/users/pommedeterresautee/orgs", "repos_url": "https://api.github.com/users/pommedeterresautee/repos", "events_url": "https://api.github.com/users/pommedeterresautee/events{/privacy}", "received_events_url": "https://api.github.com/users/pommedeterresautee/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-08-21T12:51:38Z", "updated_at": "2019-08-22T06:21:36Z", "closed_at": "2019-08-21T16:28:11Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nWith the very same code, and the very same data, Inference is much more slower on NER task when I use the version on master branch compared to the released version 0.4.2 (from 84 seconds to 234 seconds).\r\nI have tried storing method None, cpu and gpu (btw documentation is missing, in particular none option is not clear to me even when reading the code)\r\n\r\nFYI training the model doesn't take more time on master branch.\r\nnvidia-smi tells me that during inference the GPU is used at 10-12% when using master, and at 25 to 30% when using 0.4.2\r\n\r\n**To Reproduce**\r\n```python\r\n#  ...\r\n    corpus: Corpus = prepare_flair_train_test_corpus(spacy_model=nlp, data_folder=data_folder, dev_size=dev_size)\r\n\r\n    model_path = os.path.join(model_folder, 'best-model.pt')\r\n    tagger: SequenceTagger = SequenceTagger.load(model_path)\r\n\r\n    test_results, _ = tagger.evaluate(DataLoader(corpus.test, batch_size=50, num_workers=10))\r\n    print(test_results.detailed_results)\r\n\r\n    sentences_predict: List[Sentence] = corpus.train.sentences + corpus.test.sentences\r\n\r\n    start = time.time()\r\n    _ = tagger.predict(sentences_predict, mini_batch_size=50, verbose=True, embedding_storage_mode=\"gpu\")\r\n    print(time.time() - start)\r\n    # 234 seconds on when using master branch\r\n```\r\nThe training of the model looks like this:\r\n\r\n```python\r\n   # ...\r\n    embedding_types: List[TokenEmbeddings] = [\r\n        WordEmbeddings('fr'),\r\n        FlairEmbeddings('resources/flair_ner/lm/ca_forward/best-lm.pt'),\r\n        FlairEmbeddings('resources/flair_ner/lm/ca_backward/best-lm.pt'),\r\n    ]\r\n\r\n    embeddings: StackedEmbeddings = StackedEmbeddings(embeddings=embedding_types)\r\n\r\n    tagger: SequenceTagger = SequenceTagger(hidden_size=256,\r\n                                            embeddings=embeddings,\r\n                                            tag_dictionary=tag_dictionary,\r\n                                            tag_type='ner')\r\n   # ...\r\n```\r\nHere it is a custom LM, but `fr` model from Zalendo has the same behaviour.\r\n\r\n**Expected behavior**\r\nI expect the time to process the same data with the same NER model to be the same than with master and 0.4.2.\r\n\r\n**Environment (please complete the following information):**\r\nUbuntu 19.04\r\nFlair master VS Flair 0.4.2\r\nGPU 2080TI", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/1012/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/1012/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/992", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/992/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/992/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/992/events", "html_url": "https://github.com/flairNLP/flair/issues/992", "id": 479896002, "node_id": "MDU6SXNzdWU0Nzk4OTYwMDI=", "number": 992, "title": "Unable to import flair on OSX after latest pip install ", "user": {"login": "delip", "id": 347398, "node_id": "MDQ6VXNlcjM0NzM5OA==", "avatar_url": "https://avatars.githubusercontent.com/u/347398?v=4", "gravatar_id": "", "url": "https://api.github.com/users/delip", "html_url": "https://github.com/delip", "followers_url": "https://api.github.com/users/delip/followers", "following_url": "https://api.github.com/users/delip/following{/other_user}", "gists_url": "https://api.github.com/users/delip/gists{/gist_id}", "starred_url": "https://api.github.com/users/delip/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/delip/subscriptions", "organizations_url": "https://api.github.com/users/delip/orgs", "repos_url": "https://api.github.com/users/delip/repos", "events_url": "https://api.github.com/users/delip/events{/privacy}", "received_events_url": "https://api.github.com/users/delip/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-08-12T23:39:08Z", "updated_at": "2020-04-30T00:31:12Z", "closed_at": "2020-04-30T00:31:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n\r\nI get this error when I import `flair`:\r\n...\r\n~/anaconda3/envs/cvtorchpy37/lib/python3.7/site-packages/apex/amp/lists/torch_overrides.py in <module>\r\n     67          'baddbmm',\r\n     68          'bmm']\r\n---> 69 if utils.get_cuda_version() >= (9, 1, 0):\r\n     70     FP16_FUNCS.extend(_bmms)\r\n     71 else:\r\n\r\n~/anaconda3/envs/cvtorchpy37/lib/python3.7/site-packages/apex/amp/utils.py in get_cuda_version()\r\n      7\r\n      8 def get_cuda_version():\r\n----> 9     return tuple(int(x) for x in torch.version.cuda.split('.'))\r\n     10\r\n     11 def is_fp_tensor(x):\r\n\r\nAttributeError: 'NoneType' object has no attribute 'split'\r\n```\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior (e.g. which model did you train? what parameters did you use? etc.).\r\n\r\n```\r\npip install flair\r\npython -m flair\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n```\r\n - OS: Darwin aiflaptop.local 18.6.0 Darwin Kernel Version 18.6.0: Thu Apr 25 23:16:27 PDT 2019; root:xnu-4903.261.4~2/RELEASE_X86_64 x86_64\r\n - Version: latest available via pip\r\n```", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/992/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/992/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/986", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/986/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/986/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/986/events", "html_url": "https://github.com/flairNLP/flair/issues/986", "id": 479088336, "node_id": "MDU6SXNzdWU0NzkwODgzMzY=", "number": 986, "title": "find_learning_rate step problem", "user": {"login": "BernierCR", "id": 3662844, "node_id": "MDQ6VXNlcjM2NjI4NDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3662844?v=4", "gravatar_id": "", "url": "https://api.github.com/users/BernierCR", "html_url": "https://github.com/BernierCR", "followers_url": "https://api.github.com/users/BernierCR/followers", "following_url": "https://api.github.com/users/BernierCR/following{/other_user}", "gists_url": "https://api.github.com/users/BernierCR/gists{/gist_id}", "starred_url": "https://api.github.com/users/BernierCR/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/BernierCR/subscriptions", "organizations_url": "https://api.github.com/users/BernierCR/orgs", "repos_url": "https://api.github.com/users/BernierCR/repos", "events_url": "https://api.github.com/users/BernierCR/events{/privacy}", "received_events_url": "https://api.github.com/users/BernierCR/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-08-09T17:19:45Z", "updated_at": "2019-09-17T20:52:53Z", "closed_at": "2019-09-17T20:52:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n\r\nfind_learning_rate does not work. It will use the learning rate from iteration 2 for all iterations after 2. \r\n\r\n\r\n**To Reproduce**\r\n\r\nThis will happen with any application of find_learning_rate. You can reproduce with the tutorial code if you like or any code. \r\n\r\n\r\n**Expected behavior**\r\nI expect iteration 3 to use the learning rate for iteration 3, and 4 for 4, and so on. It should end at the maximum learning rate set. \r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Linux of course\r\n - Version MASTER\r\n\r\n**Additional context**\r\n\r\nscheduler = ExpAnnealLR(optimizer, end_learning_rate, iterations)\r\nscheduler.step(1)\r\nlearning_rate = scheduler.get_lr()[0]\r\n\r\ndef get_lr(self):\r\n        iteration = self.last_epoch + 1\r\n        pct = iteration / self.iterations\r\n        return [base_lr * (self.end_lr / base_lr) ** pct for base_lr in self.base_lrs]\r\n\r\nSo get_lr is iterating based on last_epoch. Though it's really supposed to be iterating based on mini-batches. Anyways, it gets worse. \r\n\r\nExpAnnealLR does not have it's own step method. So it uses the base class one. \r\n\r\ndef step(self, epoch=None):\r\n        if epoch is None:\r\n            epoch = self.last_epoch + 1\r\n        self.last_epoch = epoch\r\n        for param_group, lr in zip(self.optimizer.param_groups, self.get_lr()):\r\n            param_group['lr'] = lr\r\n\r\nThis function expects the correct epoch number to be passed to it.  Fine. \r\n\r\nBut it's used like this in this case. \r\n\r\nscheduler.step(1)\r\n\r\nThis makes the epoch always come out as two. \r\n\r\nso either \r\n1) find_learning_rate needs to pass the correct iteration number to step\r\nor,\r\n2) the ExpAnnealLR  class needs it's own step function to overide the default, that will correctly increment itself. \r\n\r\nConsidering nothing else uses ExpAnnealLR, I'm going with solution 2 in my copy. You do what you like in your package. ", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/986/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/986/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/981", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/981/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/981/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/981/events", "html_url": "https://github.com/flairNLP/flair/issues/981", "id": 478616316, "node_id": "MDU6SXNzdWU0Nzg2MTYzMTY=", "number": 981, "title": "Truncating sentences with max_tokens_per_doc when in_memory=False", "user": {"login": "juand-r", "id": 14251866, "node_id": "MDQ6VXNlcjE0MjUxODY2", "avatar_url": "https://avatars.githubusercontent.com/u/14251866?v=4", "gravatar_id": "", "url": "https://api.github.com/users/juand-r", "html_url": "https://github.com/juand-r", "followers_url": "https://api.github.com/users/juand-r/followers", "following_url": "https://api.github.com/users/juand-r/following{/other_user}", "gists_url": "https://api.github.com/users/juand-r/gists{/gist_id}", "starred_url": "https://api.github.com/users/juand-r/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/juand-r/subscriptions", "organizations_url": "https://api.github.com/users/juand-r/orgs", "repos_url": "https://api.github.com/users/juand-r/repos", "events_url": "https://api.github.com/users/juand-r/events{/privacy}", "received_events_url": "https://api.github.com/users/juand-r/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-08-08T18:10:41Z", "updated_at": "2019-08-12T12:16:29Z", "closed_at": "2019-08-12T12:16:29Z", "author_association": "NONE", "active_lock_reason": null, "body": "It appears that argument `max_tokens_per_doc` has no effect when creating a `ClassificationCorpus` if `in_memory=False` (which is the default for `ClassificationCorpus`).\r\n\r\nLooking at `ClassificationDataset` in `datasets.py`, I see that `max_tokens_per_doc` is not used when `self.in_memory` is False.\r\n\r\nI also get an error due to long lines with the following code:\r\n\r\n```python\r\nfrom pathlib import Path \r\nfrom flair.datasets import ClassificationCorpus\r\nfrom flair.embeddings import DocumentRNNEmbeddings, BertEmbeddings\r\nfrom flair.models import TextClassifier\r\nfrom flair.trainers import ModelTrainer\r\n\r\ndata_folder = Path('data_fasttext_format') # some of the sentences have long lines\r\ncorpus: ClassificationCorpus = ClassificationCorpus(data_folder,train_file='train.txt',dev_file='val.txt',test_file='val.txt', max_tokens_per_doc=20)\r\nlabel_dict = corpus.make_label_dictionary()                                     \r\nembs = [BertEmbeddings()]\r\ndocument_embeddings: DocumentRNNEmbeddings = DocumentRNNEmbeddings(embs, rnn_type='LSTM')\r\nclassifier = TextClassifier(document_embeddings, label_dictionary=label_dict, multi_label=False)\r\ntrainer = ModelTrainer(classifier, corpus) \r\ntrainer.train('data_fasttext_format')\r\n```\r\n\r\nThis results in error ``RuntimeError: index out of range at /pytorch/aten/src/TH/generic/THTensorEvenMoreMath.cpp:191``. However, when I use `in_memory=True` when creating the `ClassificationDataset`, the sentences are truncated as expected and there are no errors.\r\n\r\nEnviroment:\r\n- Linux\r\n- Python 3.6.2\r\n- flair-0.4.2\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/981/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/981/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/979", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/979/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/979/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/979/events", "html_url": "https://github.com/flairNLP/flair/issues/979", "id": 478514757, "node_id": "MDU6SXNzdWU0Nzg1MTQ3NTc=", "number": 979, "title": "UD_GERMAN_HDT corpus does not download", "user": {"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-08-08T14:41:40Z", "updated_at": "2019-08-08T16:25:58Z", "closed_at": "2019-08-08T16:25:58Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "**Describe the bug**\r\n\r\nWhen instantiating `UD_GERMAN_HDT()` corpus, the download of the train files fails because they have been renamed (and multiplied!).\r\n\r\nError is: \r\n\r\n```console\r\nOSError: HEAD request failed for url https://raw.githubusercontent.com/UniversalDependencies/UD_German-HDT/dev/de_hdt-ud-train-a.conllu with status code 404.\r\n```\r\n\r\n**To Reproduce**\r\n\r\n```python\r\nfrom flair.datasets import UD_GERMAN_HDT\r\n\r\ncorpus = UD_GERMAN_HDT()\r\n```", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/979/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/979/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/963", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/963/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/963/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/963/events", "html_url": "https://github.com/flairNLP/flair/issues/963", "id": 477008738, "node_id": "MDU6SXNzdWU0NzcwMDg3Mzg=", "number": 963, "title": "tkinter dependency required for new interactive matplotlib mode training_curves.py", "user": {"login": "aychang95", "id": 10554495, "node_id": "MDQ6VXNlcjEwNTU0NDk1", "avatar_url": "https://avatars.githubusercontent.com/u/10554495?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aychang95", "html_url": "https://github.com/aychang95", "followers_url": "https://api.github.com/users/aychang95/followers", "following_url": "https://api.github.com/users/aychang95/following{/other_user}", "gists_url": "https://api.github.com/users/aychang95/gists{/gist_id}", "starred_url": "https://api.github.com/users/aychang95/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aychang95/subscriptions", "organizations_url": "https://api.github.com/users/aychang95/orgs", "repos_url": "https://api.github.com/users/aychang95/repos", "events_url": "https://api.github.com/users/aychang95/events{/privacy}", "received_events_url": "https://api.github.com/users/aychang95/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-08-05T18:57:39Z", "updated_at": "2020-05-06T22:32:48Z", "closed_at": "2020-05-06T22:32:48Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Getting \"No module named 'tkinter'\" error due to new change in:\r\ncommit 7f2b568ce5d7c1240d2275a3710a89f86b73b201\r\n\r\nShould add a tkinter dependency if continuing with this change.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/963/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/963/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/951", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/951/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/951/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/951/events", "html_url": "https://github.com/flairNLP/flair/issues/951", "id": 476389797, "node_id": "MDU6SXNzdWU0NzYzODk3OTc=", "number": 951, "title": "Dev data loaded as test data", "user": {"login": "anjapago", "id": 23108751, "node_id": "MDQ6VXNlcjIzMTA4NzUx", "avatar_url": "https://avatars.githubusercontent.com/u/23108751?v=4", "gravatar_id": "", "url": "https://api.github.com/users/anjapago", "html_url": "https://github.com/anjapago", "followers_url": "https://api.github.com/users/anjapago/followers", "following_url": "https://api.github.com/users/anjapago/following{/other_user}", "gists_url": "https://api.github.com/users/anjapago/gists{/gist_id}", "starred_url": "https://api.github.com/users/anjapago/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/anjapago/subscriptions", "organizations_url": "https://api.github.com/users/anjapago/orgs", "repos_url": "https://api.github.com/users/anjapago/repos", "events_url": "https://api.github.com/users/anjapago/events{/privacy}", "received_events_url": "https://api.github.com/users/anjapago/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-08-02T23:37:40Z", "updated_at": "2019-08-05T12:18:35Z", "closed_at": "2019-08-05T12:18:34Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nThe dev data is being loaded into the test data.\r\nDue to this line in the code: https://github.com/zalandoresearch/flair/blob/b0e4cc1a92c4bd56536ed4e09c8ff6cb1a89f08c/flair/datasets.py#L319\r\n\r\n**To Reproduce**\r\nUse the CSVClassificationCorpus to load test, train and dev data from csv.\r\n\r\n**Expected behavior**\r\nThe test.csv should be loaded into corpus.test\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]:\r\n - Version [e.g. flair-0.3.2]:\r\n\r\n**Additional context**\r\nCould be related to this question: https://github.com/zalandoresearch/flair/issues/947\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/951/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/951/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/940", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/940/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/940/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/940/events", "html_url": "https://github.com/flairNLP/flair/issues/940", "id": 475260294, "node_id": "MDU6SXNzdWU0NzUyNjAyOTQ=", "number": 940, "title": "HashTag ignored for Column Corpus", "user": {"login": "ZihanWangKi", "id": 21319243, "node_id": "MDQ6VXNlcjIxMzE5MjQz", "avatar_url": "https://avatars.githubusercontent.com/u/21319243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ZihanWangKi", "html_url": "https://github.com/ZihanWangKi", "followers_url": "https://api.github.com/users/ZihanWangKi/followers", "following_url": "https://api.github.com/users/ZihanWangKi/following{/other_user}", "gists_url": "https://api.github.com/users/ZihanWangKi/gists{/gist_id}", "starred_url": "https://api.github.com/users/ZihanWangKi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ZihanWangKi/subscriptions", "organizations_url": "https://api.github.com/users/ZihanWangKi/orgs", "repos_url": "https://api.github.com/users/ZihanWangKi/repos", "events_url": "https://api.github.com/users/ZihanWangKi/events{/privacy}", "received_events_url": "https://api.github.com/users/ZihanWangKi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-07-31T17:10:04Z", "updated_at": "2019-08-05T08:16:02Z", "closed_at": "2019-08-05T08:16:02Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhen reading from a ColumnCorpus, lines with hash tags are ignored. This may bring problems to tasks such as Wnut17(there are hash tags at start of words.)\r\nSee https://github.com/zalandoresearch/flair/blob/b0e4cc1a92c4bd56536ed4e09c8ff6cb1a89f08c/flair/datasets.py#L424\r\n\r\n**To Reproduce**\r\nRun NER experiment with Wnut17.\r\n\r\n**Expected behavior**\r\nHash-tag-starting words should be kept.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: linux\r\n - Version [e.g. flair-0.3.2]: flair-0.4.2\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/940/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/940/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/926", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/926/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/926/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/926/events", "html_url": "https://github.com/flairNLP/flair/issues/926", "id": 472233043, "node_id": "MDU6SXNzdWU0NzIyMzMwNDM=", "number": 926, "title": "RuntimeError: cuDNN error: CUDNN_STATUS_EXECUTION_FAILED", "user": {"login": "songtaoshi", "id": 20240391, "node_id": "MDQ6VXNlcjIwMjQwMzkx", "avatar_url": "https://avatars.githubusercontent.com/u/20240391?v=4", "gravatar_id": "", "url": "https://api.github.com/users/songtaoshi", "html_url": "https://github.com/songtaoshi", "followers_url": "https://api.github.com/users/songtaoshi/followers", "following_url": "https://api.github.com/users/songtaoshi/following{/other_user}", "gists_url": "https://api.github.com/users/songtaoshi/gists{/gist_id}", "starred_url": "https://api.github.com/users/songtaoshi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/songtaoshi/subscriptions", "organizations_url": "https://api.github.com/users/songtaoshi/orgs", "repos_url": "https://api.github.com/users/songtaoshi/repos", "events_url": "https://api.github.com/users/songtaoshi/events{/privacy}", "received_events_url": "https://api.github.com/users/songtaoshi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-07-24T11:36:01Z", "updated_at": "2019-07-27T01:35:21Z", "closed_at": "2019-07-27T01:35:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhen I make model in gpu, the bug cuDNN error\r\n\r\n**To Reproduce**\r\nI first make a conda environment.by \r\n[conda create -n flair python=3.7](url)\r\nafter activate to the environment, then I install the flair\r\n[pip install flair](url)\r\nthen I run my code [python bilstm-crf.py](url)\r\nthe code is \r\n`\"\"\"\r\nthis is for tagging training\r\n\"\"\"\r\n\r\n#reading my own sequence labeling dataset\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import ColumnCorpus\r\n\r\n# define columns\r\ncolumns = {0: 'text', 1: 'ner'}\r\n\r\n# this is the folder in which train, test and dev files reside\r\ndata_folder = '../data/model_train'\r\nembedding_file = './pre_train_model/epoch_3.pt'\r\n# init a corpus using column format, data folder and the names of the train, dev and test files\r\ncorpus: Corpus = ColumnCorpus(data_folder, columns,\r\n                              train_file='train.txt',\r\n                              test_file='test.txt',\r\n                              dev_file='dev.txt')\r\n\r\nfrom flair.embeddings import OneHotEmbeddings,FlairEmbeddings\r\n\r\n\r\n# 2. what tag do we want to predict?\r\ntag_type = 'ner'\r\n\r\n# 3. make the tag dictionary from the corpus\r\ntag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\nprint(tag_dictionary.idx2item)\r\n\r\n\r\n# init embeddings from your trained LM\r\nembeddings = OneHotEmbeddings(corpus)\r\n# embeddings = FlairEmbeddings(embedding_file)\r\n\r\n# 5. initialize sequence tagger\r\nfrom flair.models import SequenceTagger\r\n\r\ntagger: SequenceTagger = SequenceTagger(hidden_size=256,\r\n                                        embeddings=embeddings,\r\n                                        tag_dictionary=tag_dictionary,\r\n                                        tag_type=tag_type,\r\n                                        use_crf=True)\r\n\r\n# 6. initialize trainer\r\nfrom flair.trainers import ModelTrainer\r\n\r\ntrainer: ModelTrainer = ModelTrainer(tagger, corpus)\r\n\r\n# 7. start training\r\ntrainer.train('resources/taggers/example-ner',\r\n              learning_rate=0.1,\r\n              mini_batch_size=32,\r\n              max_epochs=150,\r\n              embeddings_in_memory=True)\r\n\r\n# 8. plot training curves (optional)\r\nfrom flair.visual.training_curves import Plotter\r\nplotter = Plotter()\r\nplotter.plot_training_curves('resources/taggers/example-ner/loss.tsv')\r\nplotter.plot_weights('resources/taggers/example-ner/weights.txt')`\r\n**Expected behavior**\r\nI expect the program train correctly !\r\n\r\n**Screenshots**\r\n![image](https://user-images.githubusercontent.com/20240391/61790532-0834c600-ae4a-11e9-9d62-126c596eb6f5.png)\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - OS :ubuntu 18.04\r\n - Version : flair-0.4.2\r\n![image](https://user-images.githubusercontent.com/20240391/61790576-2bf80c00-ae4a-11e9-8b24-4eedbf976539.png)\r\n\r\n\r\n**Additional context**\r\nI am really confused how to get the version of cuda and cudnn version in my conda environment. \r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/926/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/926/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/916", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/916/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/916/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/916/events", "html_url": "https://github.com/flairNLP/flair/issues/916", "id": 470695468, "node_id": "MDU6SXNzdWU0NzA2OTU0Njg=", "number": 916, "title": "Language Model Training -- invalid  shape", "user": {"login": "joklaff", "id": 26256119, "node_id": "MDQ6VXNlcjI2MjU2MTE5", "avatar_url": "https://avatars.githubusercontent.com/u/26256119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joklaff", "html_url": "https://github.com/joklaff", "followers_url": "https://api.github.com/users/joklaff/followers", "following_url": "https://api.github.com/users/joklaff/following{/other_user}", "gists_url": "https://api.github.com/users/joklaff/gists{/gist_id}", "starred_url": "https://api.github.com/users/joklaff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joklaff/subscriptions", "organizations_url": "https://api.github.com/users/joklaff/orgs", "repos_url": "https://api.github.com/users/joklaff/repos", "events_url": "https://api.github.com/users/joklaff/events{/privacy}", "received_events_url": "https://api.github.com/users/joklaff/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-07-20T17:12:06Z", "updated_at": "2019-07-22T19:24:33Z", "closed_at": "2019-07-22T16:13:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI am trying to continue the training of the `news-forward` language model on domain specific data, which works in a jupyter notebook but fails when executing the code in a plain python script.   \r\nThe error message is the following:\r\n```\r\nTraceback (most recent call last):\r\n  File \"flair-fine-tuning.py\", line 35, in <module>\r\n    checkpoint=True)\r\n  File \"/home/jonas/.pyenv/versions/3.7.2/lib/python3.7/site-packages/flair/trainers/language_model_trainer.py\", line 358, in train\r\n    loss = self.loss_function(output.view(-1, ntokens), targets)\r\nRuntimeError: shape '[-1, 275]' is invalid for input of size 630000\r\n```\r\nI prepared the corpus as stated in [part 9 of the tutorial](https://github.com/zalandoresearch/flair/blob/master/resources/docs/TUTORIAL_9_TRAINING_LM_EMBEDDINGS.md).  \r\nThe notebook server runs from the main directory and both the notebook as well as the script are in the same level:\r\n```\r\ncorpus\r\n- test.txt\r\n- train\r\n-- train_split_*\r\n- valid.txt\r\njupyter_notebook_train.ipynb\r\nplain_python_train.py\r\n```\r\nWhen I run the following  code in the jupyter notebook the training runs as expected but if I try to run it in a plain python script I get the abovementioned error.\r\n**To Reproduce**\r\nTo reproduce the error try to run the following script with:\r\n`python 3.7.2` `flair==0.4.2` `torch==1.1.0`  \r\n\r\n Executed code:\r\n```\r\nfrom flair.data import Dictionary\r\nfrom flair.embeddings import FlairEmbeddings\r\nfrom flair.trainers.language_model_trainer import LanguageModelTrainer, TextCorpus\r\nfrom pathlib import Path\r\n\r\n\r\n# are you training a forward or backward LM?\r\nis_forward_lm = True\r\n\r\n# load the default character dictionary\r\ndictionary: Dictionary = Dictionary.load('chars')\r\n\r\n# get your corpus, process forward and at the character level\r\ncorpus = TextCorpus(Path('./corpus'),\r\n                    dictionary,\r\n                    is_forward_lm,\r\n                    character_level=True)\r\n\r\n# instantiate an existing LM, such as one from the FlairEmbeddings\r\nlanguage_model = FlairEmbeddings('news-forward').lm\r\n\r\n# use the model trainer to fine-tune this model on your corpus\r\ntrainer = LanguageModelTrainer(language_model, corpus)\r\n\r\ntrainer.train(Path('resources/taggers/language_model'),\r\n              sequence_length=100,\r\n              mini_batch_size=100,\r\n              max_epochs=50,\r\n              learning_rate=20,\r\n              anneal_factor=0.4,\r\n              patience=10,\r\n              checkpoint=True)\r\n\r\n```\r\n**Environment (please complete the following information):**\r\n\r\n_Local Machine_:\r\n - OS [e.g. iOS, Linux]:  Manjaro Linux 18.0.4 Illyria\r\n - Version [e.g. flair-0.3.2]: `python 3.7.2` `flair==0.4.2` `torch==1.1.0`  \r\n\r\n_Additional Machine_:\r\n- OS: `Ubuntu 18.04.1 LTS (GNU/Linux 4.15.0-43-generic x86_64)`\r\n- Versions: `python 3.7.2` `flair==0.4.2` `torch==1.1.0`  \r\n\r\n**Additional context**\r\nI hope I included all the necessary information and really much looking forward to any advice to solve this problem since I srsly have no clue what happened.\r\n\r\nI also tested the behavior on the above stated additional machine and the message is exactly the same. \r\n\r\nIf i missed any information please let me know....I think i probably just make a silly mistake but haven't spotted it  so far... \r\nThanks so many in advance!", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/916/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/916/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/912", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/912/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/912/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/912/events", "html_url": "https://github.com/flairNLP/flair/issues/912", "id": 469966207, "node_id": "MDU6SXNzdWU0Njk5NjYyMDc=", "number": 912, "title": "Could not install version 0.4.2 with pip", "user": {"login": "maironcastro", "id": 19804938, "node_id": "MDQ6VXNlcjE5ODA0OTM4", "avatar_url": "https://avatars.githubusercontent.com/u/19804938?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maironcastro", "html_url": "https://github.com/maironcastro", "followers_url": "https://api.github.com/users/maironcastro/followers", "following_url": "https://api.github.com/users/maironcastro/following{/other_user}", "gists_url": "https://api.github.com/users/maironcastro/gists{/gist_id}", "starred_url": "https://api.github.com/users/maironcastro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maironcastro/subscriptions", "organizations_url": "https://api.github.com/users/maironcastro/orgs", "repos_url": "https://api.github.com/users/maironcastro/repos", "events_url": "https://api.github.com/users/maironcastro/events{/privacy}", "received_events_url": "https://api.github.com/users/maironcastro/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-07-18T20:07:45Z", "updated_at": "2020-06-11T14:23:07Z", "closed_at": "2020-06-11T06:06:40Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI am trying to install the version `0.4.2` with pip, but I'm getting the following error.\r\n\r\n```\r\nCollecting flair==0.4.2 (from -r requirements-embeddings.txt (line 10))\r\n  Downloading https://files.pythonhosted.org/packages/0f/0e/1600bfbc2f5d95160532eb78edb2cd29840d005f9f8050bec62a98833d42/flair-0.4.2.tar.gz (94kB)\r\n/usr/local/lib/python3.6/site-packages/pip/_internal/commands/install.py:244: UserWarning: Disabling all use of wheels due to the use of --build-options / --global-options / --install-options.\r\n  cmdoptions.check_install_build_global(options)\r\n    ERROR: Complete output from command python setup.py egg_info:\r\n    ERROR: Traceback (most recent call last):\r\n      File \"<string>\", line 1, in <module>\r\n      File \"/tmp/pip-install-ow3yfdtu/flair/setup.py\", line 3, in <module>\r\n        with open(\"requirements.txt\") as f:\r\n    FileNotFoundError: [Errno 2] No such file or directory: 'requirements.txt'\r\n    ----------------------------------------\r\nERROR: Command \"python setup.py egg_info\" failed with error code 1 in /tmp/pip-install-ow3yfdtu/flair/\r\n```\r\n\r\nI downloaded the file `https://files.pythonhosted.org/packages/0f/0e/1600bfbc2f5d95160532eb78edb2cd29840d005f9f8050bec62a98833d42/flair-0.4.2.tar.gz` and the file `requirements.txt` actually doesn't exists. But there is a file with requirements inside `flair.egg-info/requires.txt`.\r\n\r\nThe problem is that inside `setup.py`, on line `3`, the setup is trying to get the `requirements.txt` file:\r\n\r\n`with open(\"requirements.txt\") as f:`\r\n\r\nIm running the install with `pip install --no-cache-dir --compile --global-option=build_ext flair==0.4.2`\r\n\r\nIs it really a bug with the deployed library? Or am I missing something?\r\n\r\n**Environment**\r\n - OS [python:3.6-slim docker image]:\r\n - Version [flair-0.4.2]:\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/912/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/912/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/911", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/911/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/911/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/911/events", "html_url": "https://github.com/flairNLP/flair/issues/911", "id": 469932992, "node_id": "MDU6SXNzdWU0Njk5MzI5OTI=", "number": 911, "title": "Text Cla", "user": {"login": "amithadiraju1694", "id": 23751321, "node_id": "MDQ6VXNlcjIzNzUxMzIx", "avatar_url": "https://avatars.githubusercontent.com/u/23751321?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amithadiraju1694", "html_url": "https://github.com/amithadiraju1694", "followers_url": "https://api.github.com/users/amithadiraju1694/followers", "following_url": "https://api.github.com/users/amithadiraju1694/following{/other_user}", "gists_url": "https://api.github.com/users/amithadiraju1694/gists{/gist_id}", "starred_url": "https://api.github.com/users/amithadiraju1694/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amithadiraju1694/subscriptions", "organizations_url": "https://api.github.com/users/amithadiraju1694/orgs", "repos_url": "https://api.github.com/users/amithadiraju1694/repos", "events_url": "https://api.github.com/users/amithadiraju1694/events{/privacy}", "received_events_url": "https://api.github.com/users/amithadiraju1694/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-07-18T18:50:57Z", "updated_at": "2019-07-18T18:52:08Z", "closed_at": "2019-07-18T18:52:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nA clear and concise description of what the bug is.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior (e.g. which model did you train? what parameters did you use? etc.).\r\n\r\n**Expected behavior**\r\nA clear and concise description of what you expected to happen.\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]:\r\n - Version [e.g. flair-0.3.2]:\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/911/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/911/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/906", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/906/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/906/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/906/events", "html_url": "https://github.com/flairNLP/flair/issues/906", "id": 469664868, "node_id": "MDU6SXNzdWU0Njk2NjQ4Njg=", "number": 906, "title": "Bug in Tutorial 7 : Sequence Labelling", "user": {"login": "amitbcp", "id": 13197403, "node_id": "MDQ6VXNlcjEzMTk3NDAz", "avatar_url": "https://avatars.githubusercontent.com/u/13197403?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amitbcp", "html_url": "https://github.com/amitbcp", "followers_url": "https://api.github.com/users/amitbcp/followers", "following_url": "https://api.github.com/users/amitbcp/following{/other_user}", "gists_url": "https://api.github.com/users/amitbcp/gists{/gist_id}", "starred_url": "https://api.github.com/users/amitbcp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amitbcp/subscriptions", "organizations_url": "https://api.github.com/users/amitbcp/orgs", "repos_url": "https://api.github.com/users/amitbcp/repos", "events_url": "https://api.github.com/users/amitbcp/events{/privacy}", "received_events_url": "https://api.github.com/users/amitbcp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-07-18T09:29:25Z", "updated_at": "2020-05-06T05:11:37Z", "closed_at": "2020-05-06T05:11:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "WIKINER English data-set gives and codec error for UTF_8\r\n\r\nFollow the steps of the Tutorial 7 for Sequence Labeling,\r\n\r\n```python\r\n\r\nUnicodeDecodeError                        Traceback (most recent call last)\r\n<ipython-input-47-49f350c5912a> in <module>()\r\n      3 \r\n      4 # 3. make the tag dictionary from the corpus\r\n----> 5 tag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\n      6 print(tag_dictionary.idx2item)\r\n\r\nc:\\users\\amit.agarwal\\appdata\\local\\programs\\python\\python36\\lib\\codecs.py in decode(self, input, final)\r\n    319         # decode input (taking the buffer into account)\r\n    320         data = self.buffer + input\r\n--> 321         (result, consumed) = self._buffer_decode(data, self.errors, final)\r\n    322         # keep undecoded input until the next call\r\n    323         self.buffer = data[consumed:]\r\n\r\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0xe1 in position 3447: invalid continuation byte\r\n```\r\n\r\n**Environment :**\r\n - OS : Windows\r\n - flair-0.4.2\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/906/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/906/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/898", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/898/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/898/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/898/events", "html_url": "https://github.com/flairNLP/flair/issues/898", "id": 468989712, "node_id": "MDU6SXNzdWU0Njg5ODk3MTI=", "number": 898, "title": "Quickstart does not work in bpython shell", "user": {"login": "hugoz1234", "id": 10606534, "node_id": "MDQ6VXNlcjEwNjA2NTM0", "avatar_url": "https://avatars.githubusercontent.com/u/10606534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hugoz1234", "html_url": "https://github.com/hugoz1234", "followers_url": "https://api.github.com/users/hugoz1234/followers", "following_url": "https://api.github.com/users/hugoz1234/following{/other_user}", "gists_url": "https://api.github.com/users/hugoz1234/gists{/gist_id}", "starred_url": "https://api.github.com/users/hugoz1234/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hugoz1234/subscriptions", "organizations_url": "https://api.github.com/users/hugoz1234/orgs", "repos_url": "https://api.github.com/users/hugoz1234/repos", "events_url": "https://api.github.com/users/hugoz1234/events{/privacy}", "received_events_url": "https://api.github.com/users/hugoz1234/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-07-17T05:14:32Z", "updated_at": "2020-06-17T22:31:42Z", "closed_at": "2020-06-17T22:31:42Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI'm following the quickstart commands in a bpython shell and there's a bug at import time\r\n\r\n**To Reproduce**\r\nIn a bpython shell running `from flair.data import Sentence` yields a `RuntimeError: dictionary changed size during iteration` at this location:\r\n```\r\n  File \"/Users/hugo/.pyenv/versions/3.6.8/lib/python3.6/site-packages/py/_vendored_packages/apipkg.py\",\r\n line 63, in initpkg\r\n    for module in sys.modules.values():\r\n```\r\n\r\n**Expected behavior**\r\nPackage imports without issue\r\n\r\n**Screenshots**\r\nFull stack trace:\r\n``` python\r\n>>> from flair.data import Sentence\r\nTraceback (most recent call last):\r\n  File \"<input>\", line 1, in <module>\r\n    from flair.data import Sentence\r\n  File \"/Users/hugo/.pyenv/versions/3.6.8/lib/python3.6/site-packages/flair/__init__.py\", line 15, in <\r\nmodule>\r\n    from . import models\r\n  File \"/Users/hugo/.pyenv/versions/3.6.8/lib/python3.6/site-packages/flair/models/__init__.py\", line 1\r\n, in <module>\r\n    from .sequence_tagger_model import SequenceTagger\r\n  File \"/Users/hugo/.pyenv/versions/3.6.8/lib/python3.6/site-packages/flair/models/sequence_tagger_mode\r\nl.py\", line 10, in <module>\r\n    import flair.nn\r\n  File \"/Users/hugo/.pyenv/versions/3.6.8/lib/python3.6/site-packages/flair/nn.py\", line 12, in <module\r\n>\r\n    from flair.training_utils import Result\r\n  File \"/Users/hugo/.pyenv/versions/3.6.8/lib/python3.6/site-packages/flair/training_utils.py\", line 10\r\n, in <module>\r\n    from sklearn.metrics import mean_squared_error, mean_absolute_error\r\n  File \"/Users/hugo/.pyenv/versions/3.6.8/lib/python3.6/site-packages/sklearn/metrics/__init__.py\", lin\r\ne 7, in <module>\r\n    from .ranking import auc\r\n  File \"/Users/hugo/.pyenv/versions/3.6.8/lib/python3.6/site-packages/sklearn/metrics/ranking.py\", line\r\n 35, in <module>\r\n    from ..preprocessing import label_binarize\r\n  File \"/Users/hugo/.pyenv/versions/3.6.8/lib/python3.6/site-packages/sklearn/preprocessing/__init__.py\r\n\", line 6, in <module>\r\n    from ._function_transformer import FunctionTransformer\r\n  File \"/Users/hugo/.pyenv/versions/3.6.8/lib/python3.6/site-packages/sklearn/preprocessing/_function_t\r\nransformer.py\", line 5, in <module>\r\n    from ..utils.testing import assert_allclose_dense_sparse\r\n  File \"/Users/hugo/.pyenv/versions/3.6.8/lib/python3.6/site-packages/sklearn/utils/testing.py\", line 7\r\n18, in <module>\r\n    import pytest\r\n  File \"/Users/hugo/.pyenv/versions/3.6.8/lib/python3.6/site-packages/pytest.py\", line 6, in <module>\r\n    from _pytest.assertion import register_assert_rewrite\r\n  File \"/Users/hugo/.pyenv/versions/3.6.8/lib/python3.6/site-packages/_pytest/assertion/__init__.py\", l\r\nine 6, in <module>\r\n    from _pytest.assertion import rewrite\r\n  File \"/Users/hugo/.pyenv/versions/3.6.8/lib/python3.6/site-packages/_pytest/assertion/rewrite.py\", li\r\nne 20, in <module>\r\n    from _pytest.assertion import util\r\n  File \"/Users/hugo/.pyenv/versions/3.6.8/lib/python3.6/site-packages/_pytest/assertion/util.py\", line\r\n5, in <module>\r\n    import _pytest._code\r\n  File \"/Users/hugo/.pyenv/versions/3.6.8/lib/python3.6/site-packages/_pytest/_code/__init__.py\", line\r\n2, in <module>\r\n    from .code import Code  # noqa\r\n  File \"/Users/hugo/.pyenv/versions/3.6.8/lib/python3.6/site-packages/_pytest/_code/code.py\", line 12,\r\nin <module>\r\n    import py\r\n  File \"/Users/hugo/.pyenv/versions/3.6.8/lib/python3.6/site-packages/py/__init__.py\", line 153, in <mo\r\ndule>\r\n    'Syslog'             : '._log.log:Syslog',\r\n  File \"/Users/hugo/.pyenv/versions/3.6.8/lib/python3.6/site-packages/py/_vendored_packages/apipkg.py\",\r\n line 63, in initpkg\r\n    for module in sys.modules.values():\r\nRuntimeError: dictionary changed size during iteration\r\n```\r\n**Environment (please complete the following information):**\r\n - OS [iOS]:\r\n - Version [flair-0.4.2]:\r\n - bpython [0.18]\r\n - python [3.6.8]\r\n\r\n**Additional context**\r\nI tried this in the native python shell and it works \ud83e\udd37\u200d\u2642 \r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/898/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/898/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/893", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/893/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/893/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/893/events", "html_url": "https://github.com/flairNLP/flair/issues/893", "id": 468751038, "node_id": "MDU6SXNzdWU0Njg3NTEwMzg=", "number": 893, "title": "OSError: HEAD request failed when using TREC_6", "user": {"login": "ReacherAppDev", "id": 34283551, "node_id": "MDQ6VXNlcjM0MjgzNTUx", "avatar_url": "https://avatars.githubusercontent.com/u/34283551?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ReacherAppDev", "html_url": "https://github.com/ReacherAppDev", "followers_url": "https://api.github.com/users/ReacherAppDev/followers", "following_url": "https://api.github.com/users/ReacherAppDev/following{/other_user}", "gists_url": "https://api.github.com/users/ReacherAppDev/gists{/gist_id}", "starred_url": "https://api.github.com/users/ReacherAppDev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ReacherAppDev/subscriptions", "organizations_url": "https://api.github.com/users/ReacherAppDev/orgs", "repos_url": "https://api.github.com/users/ReacherAppDev/repos", "events_url": "https://api.github.com/users/ReacherAppDev/events{/privacy}", "received_events_url": "https://api.github.com/users/ReacherAppDev/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-07-16T16:27:29Z", "updated_at": "2019-08-05T16:36:07Z", "closed_at": "2019-07-17T19:18:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "When I use the example code from tutorial 7 I get this error.\r\n\r\n> OSError: HEAD request failed for url http://cogcomp.org/Data/QA/QC/train_5500.label with status code 301.\r\n\r\nThis is the code:\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import TREC_6\r\nfrom flair.models import TextClassifier\r\nfrom flair.trainers import ModelTrainer\r\nfrom flair.embeddings import WordEmbeddings, FlairEmbeddings, DocumentRNNEmbeddings\r\n\r\ncorpus: Corpus = TREC_6()\r\nlabel_dict = corpus.make_label_dictionary()\r\nword_embeddings = [\r\n    WordEmbeddings('glove')\r\n]\r\ndocument_embeddings = DocumentRNNEmbeddings(\r\n    word_embeddings,\r\n    hidden_size=512,\r\n    reproject_words=True,\r\n    reproject_words_dimension=256,\r\n)\r\n\r\nclassifier = TextClassifier(document_embeddings, label_dictionary=label_dict)\r\n\r\ntrainer = ModelTrainer(classifier, corpus)\r\n\r\ntrainer.train(\r\n    'resources/taggers/ag_news',\r\n    learning_rate=0.1,\r\n    mini_batch_size=32,\r\n    anneal_factor=0.5,\r\n    patience=5,\r\n    max_epochs=150\r\n)", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/893/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/893/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/890", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/890/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/890/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/890/events", "html_url": "https://github.com/flairNLP/flair/issues/890", "id": 468662920, "node_id": "MDU6SXNzdWU0Njg2NjI5MjA=", "number": 890, "title": "IndexError: too many indices for tensor of dimension 0", "user": {"login": "fatimabs", "id": 24894969, "node_id": "MDQ6VXNlcjI0ODk0OTY5", "avatar_url": "https://avatars.githubusercontent.com/u/24894969?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fatimabs", "html_url": "https://github.com/fatimabs", "followers_url": "https://api.github.com/users/fatimabs/followers", "following_url": "https://api.github.com/users/fatimabs/following{/other_user}", "gists_url": "https://api.github.com/users/fatimabs/gists{/gist_id}", "starred_url": "https://api.github.com/users/fatimabs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fatimabs/subscriptions", "organizations_url": "https://api.github.com/users/fatimabs/orgs", "repos_url": "https://api.github.com/users/fatimabs/repos", "events_url": "https://api.github.com/users/fatimabs/events{/privacy}", "received_events_url": "https://api.github.com/users/fatimabs/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-07-16T13:43:15Z", "updated_at": "2020-05-06T23:41:04Z", "closed_at": "2020-05-06T23:41:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "i'm trying to train my own model but i have this error:\r\n\r\nIndexError: too many indices for tensor of dimension 0\r\n\r\ncan some one help me PLZ ?", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/890/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/890/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/880", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/880/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/880/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/880/events", "html_url": "https://github.com/flairNLP/flair/issues/880", "id": 467771566, "node_id": "MDU6SXNzdWU0Njc3NzE1NjY=", "number": 880, "title": "AttributeError: 'WordEmbeddings' object has no attribute 'embeddings'", "user": {"login": "jind11", "id": 16600322, "node_id": "MDQ6VXNlcjE2NjAwMzIy", "avatar_url": "https://avatars.githubusercontent.com/u/16600322?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jind11", "html_url": "https://github.com/jind11", "followers_url": "https://api.github.com/users/jind11/followers", "following_url": "https://api.github.com/users/jind11/following{/other_user}", "gists_url": "https://api.github.com/users/jind11/gists{/gist_id}", "starred_url": "https://api.github.com/users/jind11/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jind11/subscriptions", "organizations_url": "https://api.github.com/users/jind11/orgs", "repos_url": "https://api.github.com/users/jind11/repos", "events_url": "https://api.github.com/users/jind11/events{/privacy}", "received_events_url": "https://api.github.com/users/jind11/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-07-13T22:15:11Z", "updated_at": "2019-07-22T15:14:21Z", "closed_at": "2019-07-22T15:14:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "After executing the following codes:\r\n'''\r\nfrom flair.models import SequenceTagger\r\ntagger = SequenceTagger.load('multi-ner')\r\nprint(tagger)\r\n'''\r\nI got this error:\r\n'''\r\nAttributeError: 'WordEmbeddings' object has no attribute 'embeddings'\r\n'''\r\nSomething should be wrong in extracting the embeddings from the pretrained multi-ner model.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/880/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/880/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/874", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/874/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/874/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/874/events", "html_url": "https://github.com/flairNLP/flair/issues/874", "id": 467257991, "node_id": "MDU6SXNzdWU0NjcyNTc5OTE=", "number": 874, "title": "about model download", "user": {"login": "wen-fei", "id": 8847689, "node_id": "MDQ6VXNlcjg4NDc2ODk=", "avatar_url": "https://avatars.githubusercontent.com/u/8847689?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wen-fei", "html_url": "https://github.com/wen-fei", "followers_url": "https://api.github.com/users/wen-fei/followers", "following_url": "https://api.github.com/users/wen-fei/following{/other_user}", "gists_url": "https://api.github.com/users/wen-fei/gists{/gist_id}", "starred_url": "https://api.github.com/users/wen-fei/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wen-fei/subscriptions", "organizations_url": "https://api.github.com/users/wen-fei/orgs", "repos_url": "https://api.github.com/users/wen-fei/repos", "events_url": "https://api.github.com/users/wen-fei/events{/privacy}", "received_events_url": "https://api.github.com/users/wen-fei/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2019-07-12T07:11:51Z", "updated_at": "2020-12-03T12:30:05Z", "closed_at": "2019-07-12T14:38:57Z", "author_association": "NONE", "active_lock_reason": null, "body": "hi, thanks for your great job. when I run the sample code, I get this `requests.exceptions.ConnectionError: HTTPSConnectionPool(host='s3.eu-central-1.amazonaws.com', port=443): Max retries exceeded with url: /alan-nlp/resources/models-v0.4/NER-conll03-english/en-ner-conll03-v0.4.pt (Caused by NewConnectionError('<urllib3.connection.VerifiedHTTPSConnection object at 0x1a255b3358>: Failed to establish a new connection: [Errno 61] Connection refused',))`\r\n\r\nI searched issues and found that I am not the only one facing similar issues. I guess that you design requesting a url for a model download while calling the interface for saving install time.\r\nThis is a good idea, but ignores some special cases.  I suggest that provide a way to specify the local model configuration path, such as json files or function parameters to solve this problem.\r\nThank you very much.\r\nLooking forward to improvement!", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/874/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/874/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/872", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/872/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/872/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/872/events", "html_url": "https://github.com/flairNLP/flair/issues/872", "id": 466857608, "node_id": "MDU6SXNzdWU0NjY4NTc2MDg=", "number": 872, "title": "UnpicklingError: pickle data was truncated", "user": {"login": "gopalkalpande", "id": 27803744, "node_id": "MDQ6VXNlcjI3ODAzNzQ0", "avatar_url": "https://avatars.githubusercontent.com/u/27803744?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gopalkalpande", "html_url": "https://github.com/gopalkalpande", "followers_url": "https://api.github.com/users/gopalkalpande/followers", "following_url": "https://api.github.com/users/gopalkalpande/following{/other_user}", "gists_url": "https://api.github.com/users/gopalkalpande/gists{/gist_id}", "starred_url": "https://api.github.com/users/gopalkalpande/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gopalkalpande/subscriptions", "organizations_url": "https://api.github.com/users/gopalkalpande/orgs", "repos_url": "https://api.github.com/users/gopalkalpande/repos", "events_url": "https://api.github.com/users/gopalkalpande/events{/privacy}", "received_events_url": "https://api.github.com/users/gopalkalpande/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-07-11T12:18:33Z", "updated_at": "2020-05-06T22:33:12Z", "closed_at": "2020-05-06T22:33:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nUnpicklingError: pickle data was truncated\r\n\r\nI got the above error while executing this:\r\nsfd = SequenceTagger.load('frame-fast') # semantic frame detection\r\n\r\n---------------------------------------------------------------------------\r\nUnpicklingError                           Traceback (most recent call last)\r\n<ipython-input-134-fa6813c693f9> in <module>\r\n----> 1 sfd = SequenceTagger.load('frame-fast') # semantic frame detection\r\n\r\n~/anaconda3/envs/ws-1/lib/python3.7/site-packages/flair/nn.py in load(cls, model)\r\n     99             # see https://github.com/zalandoresearch/flair/issues/351\r\n    100             f = flair.file_utils.load_big_file(str(model_file))\r\n--> 101             state = torch.load(f, map_location=flair.device)\r\n    102 \r\n    103         model = cls._init_model_with_state_dict(state)\r\n\r\n~/anaconda3/envs/ws-1/lib/python3.7/site-packages/torch/serialization.py in load(f, map_location, pickle_module, **pickle_load_args)\r\n    385         f = f.open('rb')\r\n    386     try:\r\n--> 387         return _load(f, map_location, pickle_module, **pickle_load_args)\r\n    388     finally:\r\n    389         if new_fd:\r\n\r\n~/anaconda3/envs/ws-1/lib/python3.7/site-packages/torch/serialization.py in _load(f, map_location, pickle_module, **pickle_load_args)\r\n    572     unpickler = pickle_module.Unpickler(f, **pickle_load_args)\r\n    573     unpickler.persistent_load = persistent_load\r\n--> 574     result = unpickler.load()\r\n    575 \r\n    576     deserialized_storage_keys = pickle_module.load(f, **pickle_load_args)\r\n\r\nUnpicklingError: pickle data was truncated\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Ubuntu 16.04\r\n - Version [e.g. flair-0.3.2]: flair 0.4.2\r\n\r\n**Additional context**\r\nI have 16 gb of RAM. I tried emptying the RAM and then rerunning it but no luck.\r\n\r\nHelp needed.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/872/reactions", "total_count": 5, "+1": 5, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/872/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/869", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/869/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/869/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/869/events", "html_url": "https://github.com/flairNLP/flair/issues/869", "id": 465917607, "node_id": "MDU6SXNzdWU0NjU5MTc2MDc=", "number": 869, "title": "AttributeError when trying to fine-tune existing language model", "user": {"login": "MarcioPorto", "id": 6521281, "node_id": "MDQ6VXNlcjY1MjEyODE=", "avatar_url": "https://avatars.githubusercontent.com/u/6521281?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarcioPorto", "html_url": "https://github.com/MarcioPorto", "followers_url": "https://api.github.com/users/MarcioPorto/followers", "following_url": "https://api.github.com/users/MarcioPorto/following{/other_user}", "gists_url": "https://api.github.com/users/MarcioPorto/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarcioPorto/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarcioPorto/subscriptions", "organizations_url": "https://api.github.com/users/MarcioPorto/orgs", "repos_url": "https://api.github.com/users/MarcioPorto/repos", "events_url": "https://api.github.com/users/MarcioPorto/events{/privacy}", "received_events_url": "https://api.github.com/users/MarcioPorto/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-07-09T18:12:12Z", "updated_at": "2019-09-14T14:49:50Z", "closed_at": "2019-07-09T18:25:28Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nI am getting an AttributeError error when using the linear model fine-tuning approach mentioned in #121.\r\n\r\n**To Reproduce**\r\nHere is what my code looks like:\r\n\r\n```python\r\nlanguage_model = FlairEmbeddings('news-forward-fast').lm\r\ndictionary = language_model.dictionary\r\ncorpus = TextCorpus('path/to/your/corpus', dictionary, is_forward_lm, character_level=True)\r\ntrainer = LanguageModelTrainer(language_model, corpus)\r\ntrainer.train('resources/taggers/language_model', sequence_length=100, learning_rate=5)\r\n```\r\n\r\nAnd here's the error:\r\n\r\n```\r\n...\r\n2019-07-09 13:59:17,735 4713 seconds for train split 1\r\n-----------------------------------------------------------------\r\nAttributeError                  Traceback (most recent call last)\r\n<ipython-input-19-274bb0994985> in <module>\r\n----> 1 trainer.train('resources/taggers/language_model', sequence_length=100, learning_rate=5)\r\n\r\n~/Workspace/Deep-Search/deep-search-oec/venv/lib/python3.7/site-packages/flair/trainers/language_model_trainer.py in train(self, base_path, sequence_length, learning_rate, mini_batch_size, anneal_factor, patience, clip, max_epochs, checkpoint, grow_to_sequence_length, **kwargs)\r\n    399                     self.model.eval()\r\n    400 \r\n--> 401                     val_loss = self.evaluate(val_data, mini_batch_size, sequence_length)\r\n    402                     scheduler.step(val_loss)\r\n    403 \r\n\r\n~/Workspace/Deep-Search/deep-search-oec/venv/lib/python3.7/site-packages/flair/trainers/language_model_trainer.py in evaluate(self, data_source, eval_batch_size, sequence_length)\r\n    482                 total_loss += len(data) * self.loss_function(output_flat, targets).data\r\n    483                 hidden = self._repackage_hidden(hidden)\r\n--> 484             return total_loss.item() / len(data_source)\r\n    485 \r\n    486     @staticmethod\r\n\r\nAttributeError: 'int' object has no attribute 'item'\r\n```\r\n**Environment:**\r\n - OS: macOS\r\n - Version: flair-0.4.2", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/869/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/869/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/856", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/856/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/856/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/856/events", "html_url": "https://github.com/flairNLP/flair/issues/856", "id": 463431332, "node_id": "MDU6SXNzdWU0NjM0MzEzMzI=", "number": 856, "title": "Simple TaggedCorpus Deprecation Update", "user": {"login": "aychang95", "id": 10554495, "node_id": "MDQ6VXNlcjEwNTU0NDk1", "avatar_url": "https://avatars.githubusercontent.com/u/10554495?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aychang95", "html_url": "https://github.com/aychang95", "followers_url": "https://api.github.com/users/aychang95/followers", "following_url": "https://api.github.com/users/aychang95/following{/other_user}", "gists_url": "https://api.github.com/users/aychang95/gists{/gist_id}", "starred_url": "https://api.github.com/users/aychang95/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aychang95/subscriptions", "organizations_url": "https://api.github.com/users/aychang95/orgs", "repos_url": "https://api.github.com/users/aychang95/repos", "events_url": "https://api.github.com/users/aychang95/events{/privacy}", "received_events_url": "https://api.github.com/users/aychang95/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-07-02T20:54:50Z", "updated_at": "2019-07-17T21:07:28Z", "closed_at": "2019-07-17T21:07:28Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The experiments markdown file _resources/docs/EXPERIMENTS.md_ includes the deprecated \"TaggedCorpus\" objects, which should be replaced with the more robust \"Corpus\" object.\r\n\r\n _flair/data_fetcher_ also has most documentation referring to the deprecated \"TaggedCorpus\" object.\r\n\r\nRunning any of the experiments will fail with a \"cannot import...\" error obviously.\r\n\r\nWill initialize a pr if no objections\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/856/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/856/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/855", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/855/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/855/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/855/events", "html_url": "https://github.com/flairNLP/flair/issues/855", "id": 463266909, "node_id": "MDU6SXNzdWU0NjMyNjY5MDk=", "number": 855, "title": "DataLoader worker (pid 10252) is killed by signal: Killed", "user": {"login": "m-michalek", "id": 20742170, "node_id": "MDQ6VXNlcjIwNzQyMTcw", "avatar_url": "https://avatars.githubusercontent.com/u/20742170?v=4", "gravatar_id": "", "url": "https://api.github.com/users/m-michalek", "html_url": "https://github.com/m-michalek", "followers_url": "https://api.github.com/users/m-michalek/followers", "following_url": "https://api.github.com/users/m-michalek/following{/other_user}", "gists_url": "https://api.github.com/users/m-michalek/gists{/gist_id}", "starred_url": "https://api.github.com/users/m-michalek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/m-michalek/subscriptions", "organizations_url": "https://api.github.com/users/m-michalek/orgs", "repos_url": "https://api.github.com/users/m-michalek/repos", "events_url": "https://api.github.com/users/m-michalek/events{/privacy}", "received_events_url": "https://api.github.com/users/m-michalek/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-07-02T14:37:19Z", "updated_at": "2020-05-07T00:41:25Z", "closed_at": "2020-05-07T00:41:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello guys!\r\nI followed the instructions of the tutorials to construct my own training data for NER.\r\nAll I want to do is train a custom NER model with my own data.\r\n\r\nMy data looks like this:\r\n\r\n> George PER\r\n> Washington PER\r\n> went O\r\n> to O\r\n> Washington LOC\r\n\r\nWhen I start training using a jupyter notebook, I get the following error message: **DataLoader worker (pid 10252) is killed by signal: Killed**\r\nWhen I try it using a python script it just says **Killed**.\r\n\r\nThe pid changes every time I try to train a model. The training always stops at the **first epoch**, sometimes it is able to get to iteration 6 but sometimes it stops before iteration 1.\r\n\r\nI can not provide you with the original data and I was not able to produce some data which reproduces the problem. I created synthetic data which was able to train a model. \r\nThe original data was tokenized using the tokenizer of spacy and holds some Unicode characters like\\xc2 \\xb4 \\xc2. When I load the corpus I have access to all the annotations.\r\n\r\nThis is my code:\r\n\r\n```\r\nfrom flair.data import Corpus\r\nfrom flair.datasets import ColumnCorpus\r\nfrom flair.embeddings import TokenEmbeddings, WordEmbeddings, StackedEmbeddings\r\nfrom typing import List\r\n\r\ncolumns = {0: 'text', 1: 'ner'}\r\n\r\ndata_folder = './data/'\r\n\r\ncorpus: Corpus = ColumnCorpus(data_folder, columns,\r\n                              train_file='train.txt',\r\n                              test_file='test.txt',\r\n                              dev_file='dev.txt',\r\n                              )\r\n    \r\nprint(corpus)\r\n\r\ntag_type = 'ner'\r\n\r\ntag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\nprint(tag_dictionary.idx2item)\r\n\r\nembedding_types: List[TokenEmbeddings] = [WordEmbeddings('glove')]\r\n\r\nembeddings: StackedEmbeddings = StackedEmbeddings(embeddings=embedding_types)\r\n\r\nfrom flair.models import SequenceTagger\r\n\r\ntagger: SequenceTagger = SequenceTagger(hidden_size=256,\r\n                                        embeddings=embeddings,\r\n                                        tag_dictionary=tag_dictionary,\r\n                                        tag_type=tag_type,\r\n                                        use_crf=True)\r\n\r\nfrom flair.trainers import ModelTrainer\r\n\r\ntrainer: ModelTrainer = ModelTrainer(tagger, corpus)\r\n\r\ntrainer.train('resources/taggers/example-ner',\r\n              learning_rate=0.1,\r\n              mini_batch_size=32,\r\n              max_epochs=150)\r\n\r\nfrom flair.visual.training_curves import Plotter\r\nplotter = Plotter()\r\nplotter.plot_training_curves('resources/taggers/example-ner/loss.tsv')\r\nplotter.plot_weights('resources/taggers/example-ner/weights.txt')\r\n\r\n```\r\nFrom the image you can see, my dataset is not quite big and the data has been loaded successfully.\r\n\r\n![60503860-cee0be80-9cc0-11e9-903a-dc0669111e3a JPG](https://user-images.githubusercontent.com/20742170/60519323-9acac500-9ce3-11e9-94af-e617e26ac755.jpg)\r\n\r\nI am using MacOs with flair version 0.4.2.\r\n\r\nDoes anyone have experience with the problem or know a solution?\r\n\r\nI would be glad about your help", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/855/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/855/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/854", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/854/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/854/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/854/events", "html_url": "https://github.com/flairNLP/flair/issues/854", "id": 462905004, "node_id": "MDU6SXNzdWU0NjI5MDUwMDQ=", "number": 854, "title": "OpenAIGPTEmbeddings() initialization failure", "user": {"login": "yliu2018", "id": 38111399, "node_id": "MDQ6VXNlcjM4MTExMzk5", "avatar_url": "https://avatars.githubusercontent.com/u/38111399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yliu2018", "html_url": "https://github.com/yliu2018", "followers_url": "https://api.github.com/users/yliu2018/followers", "following_url": "https://api.github.com/users/yliu2018/following{/other_user}", "gists_url": "https://api.github.com/users/yliu2018/gists{/gist_id}", "starred_url": "https://api.github.com/users/yliu2018/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yliu2018/subscriptions", "organizations_url": "https://api.github.com/users/yliu2018/orgs", "repos_url": "https://api.github.com/users/yliu2018/repos", "events_url": "https://api.github.com/users/yliu2018/events{/privacy}", "received_events_url": "https://api.github.com/users/yliu2018/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-07-01T20:49:09Z", "updated_at": "2020-05-07T00:41:21Z", "closed_at": "2020-05-07T00:41:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhen initializing OpenAIGPTEmbeddings() through\r\nembeddings = OpenAIGPTEmbeddings()\r\n,it failed with the following error message:\r\nOSError: [E050] Can't find model 'en'. It doesn't seem to be a shortcut link, a Python package or a valid path to a data directory.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior (e.g. which model did you train? what parameters did you use? etc.).\r\nembeddings = OpenAIGPTEmbeddings()\r\n\r\n**Expected behavior**\r\nIt should return the embeddings.\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - Version : flair-0.4.2\r\n\r\n\r\nFull errors:\r\nOSError: [E050] Can't find model 'en'. It doesn't seem to be a shortcut link, a Python package or a valid path to a data directory.\r\n---------------------------------------------------------------------------\r\nOSError                                   Traceback (most recent call last)\r\n<command-56669> in <module>()\r\n----> 1 embeddings = get_embeddings(embedding_type)\r\n      2 if document_level_embedding_type == \"pooling\":\r\n      3   document_embeddings = DocumentPoolEmbeddings(embeddings)\r\n\r\n<command-56666> in get_embeddings(embedding_option)\r\n     17     'flair_glove': [FlairEmbeddings('news-forward-fast'), FlairEmbeddings('news-backward-fast'), WordEmbeddings('glove')],\r\n     18     'transformer_xl':[TransformerXLEmbeddings()],\r\n---> 19     'gpt':[OpenAIGPTEmbeddings()],\r\n     20     }.get(embedding_option, [FlairEmbeddings('news-forward-fast'), FlairEmbeddings('news-backward-fast')])\r\n\r\n/databricks/python/lib/python3.6/site-packages/flair/embeddings.py in __init__(self, model, pooling_operation)\r\n    762             raise ValueError(\"Provided OpenAI GPT model is not available.\")\r\n    763 \r\n--> 764         self.tokenizer = OpenAIGPTTokenizer.from_pretrained(model)\r\n    765         self.model = OpenAIGPTModel.from_pretrained(model)\r\n    766         self.name = model\r\n\r\n/databricks/python/lib/python3.6/site-packages/pytorch_pretrained_bert/tokenization_openai.py in from_pretrained(cls, pretrained_model_name_or_path, cache_dir, *inputs, **kwargs)", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/854/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/854/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/850", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/850/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/850/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/850/events", "html_url": "https://github.com/flairNLP/flair/issues/850", "id": 462590700, "node_id": "MDU6SXNzdWU0NjI1OTA3MDA=", "number": 850, "title": "cannot import name 'raise_from'", "user": {"login": "Dhanachandra", "id": 10828657, "node_id": "MDQ6VXNlcjEwODI4NjU3", "avatar_url": "https://avatars.githubusercontent.com/u/10828657?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dhanachandra", "html_url": "https://github.com/Dhanachandra", "followers_url": "https://api.github.com/users/Dhanachandra/followers", "following_url": "https://api.github.com/users/Dhanachandra/following{/other_user}", "gists_url": "https://api.github.com/users/Dhanachandra/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dhanachandra/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dhanachandra/subscriptions", "organizations_url": "https://api.github.com/users/Dhanachandra/orgs", "repos_url": "https://api.github.com/users/Dhanachandra/repos", "events_url": "https://api.github.com/users/Dhanachandra/events{/privacy}", "received_events_url": "https://api.github.com/users/Dhanachandra/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-07-01T08:48:45Z", "updated_at": "2019-07-01T10:10:42Z", "closed_at": "2019-07-01T10:05:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/850/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/850/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/842", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/842/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/842/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/842/events", "html_url": "https://github.com/flairNLP/flair/issues/842", "id": 461312330, "node_id": "MDU6SXNzdWU0NjEzMTIzMzA=", "number": 842, "title": "How to improve the speed classifier.predict(sentence) sentiment analysis ?", "user": {"login": "Rahulvks", "id": 14966169, "node_id": "MDQ6VXNlcjE0OTY2MTY5", "avatar_url": "https://avatars.githubusercontent.com/u/14966169?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Rahulvks", "html_url": "https://github.com/Rahulvks", "followers_url": "https://api.github.com/users/Rahulvks/followers", "following_url": "https://api.github.com/users/Rahulvks/following{/other_user}", "gists_url": "https://api.github.com/users/Rahulvks/gists{/gist_id}", "starred_url": "https://api.github.com/users/Rahulvks/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Rahulvks/subscriptions", "organizations_url": "https://api.github.com/users/Rahulvks/orgs", "repos_url": "https://api.github.com/users/Rahulvks/repos", "events_url": "https://api.github.com/users/Rahulvks/events{/privacy}", "received_events_url": "https://api.github.com/users/Rahulvks/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-06-27T04:47:07Z", "updated_at": "2020-05-07T00:41:22Z", "closed_at": "2020-05-07T00:41:22Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nclassifier.predict(sentence) is taking lot of time for predicting the sentiment.\r\n\r\n**To Reproduce**\r\n\r\n```\r\ndef getPolarity(sen):\r\n    try:\r\n        sentence = Sentence(sen)\r\n        classifier.predict(sentence)\r\n        if sentence.labels[0].value=='NEGATIVE':\r\n            score = -1*(sentence.labels[0].score)\r\n        else :\r\n            score = sentence.labels[0].score\r\n        return  score \r\n    except Exception as e:\r\n        return  \"Error\"\r\n\r\n```\r\n`data['review_sentiment'] = data.Clean_Review.apply(lambda x: getPolarity(x))\r\n`\r\n\r\n - IOS:\r\nKindly assist how can we make it faster ?", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/842/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/842/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/828", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/828/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/828/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/828/events", "html_url": "https://github.com/flairNLP/flair/issues/828", "id": 459412564, "node_id": "MDU6SXNzdWU0NTk0MTI1NjQ=", "number": 828, "title": "pip install flair fails", "user": {"login": "gustavo1977", "id": 31804926, "node_id": "MDQ6VXNlcjMxODA0OTI2", "avatar_url": "https://avatars.githubusercontent.com/u/31804926?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gustavo1977", "html_url": "https://github.com/gustavo1977", "followers_url": "https://api.github.com/users/gustavo1977/followers", "following_url": "https://api.github.com/users/gustavo1977/following{/other_user}", "gists_url": "https://api.github.com/users/gustavo1977/gists{/gist_id}", "starred_url": "https://api.github.com/users/gustavo1977/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gustavo1977/subscriptions", "organizations_url": "https://api.github.com/users/gustavo1977/orgs", "repos_url": "https://api.github.com/users/gustavo1977/repos", "events_url": "https://api.github.com/users/gustavo1977/events{/privacy}", "received_events_url": "https://api.github.com/users/gustavo1977/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-06-22T00:26:51Z", "updated_at": "2020-09-10T10:50:16Z", "closed_at": "2019-06-22T12:35:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI am trying to install flair using pip install flair command, but I can't\r\n\r\nThere are some error messages:\r\n\r\n    ERROR: Complete output from command python setup.py egg_info:\r\n    ERROR: Traceback (most recent call last):\r\n      File \"<string>\", line 1, in <module>\r\n      File \"/tmp/pip-install-neCYMF/flair/setup.py\", line 7, in <module>\r\n        long_description=open(\"README.md\", encoding='utf-8').read(),\r\n    TypeError: 'encoding' is an invalid keyword argument for this function\r\n    ----------------------------------------\r\nERROR: Command \"python setup.py egg_info\" failed with error code 1 in /tmp/pip-install-neCYMF/flair/\r\n\r\nAnyone knows how can I fix that problem?\r\n\r\nThanks", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/828/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/828/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/819", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/819/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/819/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/819/events", "html_url": "https://github.com/flairNLP/flair/issues/819", "id": 457963800, "node_id": "MDU6SXNzdWU0NTc5NjM4MDA=", "number": 819, "title": "Error when using DocumentPoolEmbedding: AttributeError: 'DocumentPoolEmbeddings' object has no attribute 'mode'", "user": {"login": "helmersl", "id": 5815703, "node_id": "MDQ6VXNlcjU4MTU3MDM=", "avatar_url": "https://avatars.githubusercontent.com/u/5815703?v=4", "gravatar_id": "", "url": "https://api.github.com/users/helmersl", "html_url": "https://github.com/helmersl", "followers_url": "https://api.github.com/users/helmersl/followers", "following_url": "https://api.github.com/users/helmersl/following{/other_user}", "gists_url": "https://api.github.com/users/helmersl/gists{/gist_id}", "starred_url": "https://api.github.com/users/helmersl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/helmersl/subscriptions", "organizations_url": "https://api.github.com/users/helmersl/orgs", "repos_url": "https://api.github.com/users/helmersl/repos", "events_url": "https://api.github.com/users/helmersl/events{/privacy}", "received_events_url": "https://api.github.com/users/helmersl/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-06-19T11:42:28Z", "updated_at": "2019-06-19T12:08:04Z", "closed_at": "2019-06-19T12:08:03Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Problem**\r\n\r\nI'm using the DocumentPoolEmbeddings class in order to embed abstracts. I'm using an approach to distribute the calculation with dask on several workers. On my local machine, I can embed the documents without error but on the workers, I get the following error when generating the embeddings:\r\n\r\n`AttributeError: 'DocumentPoolEmbeddings' object has no attribute 'mode'`\r\n\r\n**Screenshot of the end of the stack trace**\r\n<img width=\"622\" alt=\"Screenshot 2019-06-19 at 11 42 28\" src=\"https://user-images.githubusercontent.com/5815703/59755032-87514000-9287-11e9-8abc-31218a5004b6.png\">\r\n\r\n\r\n**Code**\r\n`# initialize the word embeddings`\r\n`glove_embedding = WordEmbeddings('glove')`\r\n`flair_embedding_forward = FlairEmbeddings('news-forward')`\r\n`flair_embedding_backward = FlairEmbeddings('news-backward')`\r\n\r\n`# initialize the document embeddings`\r\n`document_embeddings = DocumentPoolEmbeddings([glove_embedding, flair_embedding_backward, flair_embedding_forward])`\r\n\r\n`params_bag = dask.bag.from_sequence([Sentence(x) for x in abstract_list])`\r\n\r\n`embedded_abstracts = params_bag.map(lambda x: document_embeddings.embed(x)).compute()`\r\n\r\nI'm using flair version `` and python version `3.6\r\n\r\n**Environment:**\r\n - OS: Linux (jupyter hub environment)\r\n - Version: flair-0.4.2, python-3.6 in a conda environment\r\nVersions on the workers should be the same, but to be honest, I'm not 100% sure.\r\n\r\nThanks in advance for any help!", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/819/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/819/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/817", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/817/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/817/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/817/events", "html_url": "https://github.com/flairNLP/flair/issues/817", "id": 457891730, "node_id": "MDU6SXNzdWU0NTc4OTE3MzA=", "number": 817, "title": "Bad epochs logging counterintuitive", "user": {"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-06-19T09:02:50Z", "updated_at": "2019-06-19T10:07:03Z", "closed_at": "2019-06-19T10:07:03Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "The current logging of the `bad_epochs` parameter is potentially misleading since it always logs the state of bad epochs at the _start_ of each epoch. This is problematic since each line gives us the _results_ of each epoch (i.e. the state at the end of each epoch). \r\n\r\n**Goal**: log `bad_epochs` value as it is at the end of each epoch. \r\n\r\nSo then a log line might begin like this: \r\n\r\n```console\r\n33\t10:47:51\t1\t0.0250\t2.6336\r\n```\r\n\r\nand may be read as \"epoch 33 is bad epoch 1 with a loss of 2.6336\".\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/817/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/817/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/816", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/816/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/816/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/816/events", "html_url": "https://github.com/flairNLP/flair/issues/816", "id": 457838950, "node_id": "MDU6SXNzdWU0NTc4Mzg5NTA=", "number": 816, "title": "Non-deterministic behaviour for BERT embeddings", "user": {"login": "angeloziletti", "id": 18642241, "node_id": "MDQ6VXNlcjE4NjQyMjQx", "avatar_url": "https://avatars.githubusercontent.com/u/18642241?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angeloziletti", "html_url": "https://github.com/angeloziletti", "followers_url": "https://api.github.com/users/angeloziletti/followers", "following_url": "https://api.github.com/users/angeloziletti/following{/other_user}", "gists_url": "https://api.github.com/users/angeloziletti/gists{/gist_id}", "starred_url": "https://api.github.com/users/angeloziletti/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angeloziletti/subscriptions", "organizations_url": "https://api.github.com/users/angeloziletti/orgs", "repos_url": "https://api.github.com/users/angeloziletti/repos", "events_url": "https://api.github.com/users/angeloziletti/events{/privacy}", "received_events_url": "https://api.github.com/users/angeloziletti/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-06-19T06:56:36Z", "updated_at": "2019-06-20T08:59:32Z", "closed_at": "2019-06-20T08:59:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI am using FLAIR (great software, thanks a lot!) to get BERT embeddings. \r\n\r\nFor a given input, I get different BERT embeddings every time I run the code.\r\n\r\nThis might be a PyTorch related issue (https://github.com/huggingface/pytorch-pretrained-BERT/issues/695) \r\n\r\nIs there a way to get deterministic BERT embeddings using FLAIR?\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/816/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/816/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/811", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/811/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/811/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/811/events", "html_url": "https://github.com/flairNLP/flair/issues/811", "id": 457287040, "node_id": "MDU6SXNzdWU0NTcyODcwNDA=", "number": 811, "title": "I am trying to run flair on an aws instance, I am using it inside a 'Scrapy'(a python library for web crawling) project.", "user": {"login": "nodaddy", "id": 43935540, "node_id": "MDQ6VXNlcjQzOTM1NTQw", "avatar_url": "https://avatars.githubusercontent.com/u/43935540?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nodaddy", "html_url": "https://github.com/nodaddy", "followers_url": "https://api.github.com/users/nodaddy/followers", "following_url": "https://api.github.com/users/nodaddy/following{/other_user}", "gists_url": "https://api.github.com/users/nodaddy/gists{/gist_id}", "starred_url": "https://api.github.com/users/nodaddy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nodaddy/subscriptions", "organizations_url": "https://api.github.com/users/nodaddy/orgs", "repos_url": "https://api.github.com/users/nodaddy/repos", "events_url": "https://api.github.com/users/nodaddy/events{/privacy}", "received_events_url": "https://api.github.com/users/nodaddy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-06-18T06:34:58Z", "updated_at": "2019-06-18T06:36:45Z", "closed_at": "2019-06-18T06:36:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nA clear and concise description of what the bug is.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior (e.g. which model did you train? what parameters did you use? etc.).\r\n\r\n**Expected behavior**\r\nA clear and concise description of what you expected to happen.\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]:\r\n - Version [e.g. flair-0.3.2]:\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/811/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/811/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/804", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/804/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/804/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/804/events", "html_url": "https://github.com/flairNLP/flair/issues/804", "id": 456189308, "node_id": "MDU6SXNzdWU0NTYxODkzMDg=", "number": 804, "title": "CharacterEmbeddings: missing characters in vocab", "user": {"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-06-14T11:02:20Z", "updated_at": "2019-09-24T07:31:33Z", "closed_at": "2019-09-24T07:31:33Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Hi,\r\n\r\nthere's one major issue with the `CharacterEmbeddings` class: by default it uses a \"common chars\" dictionary (fetched from [here](https://s3.eu-central-1.amazonaws.com/alan-nlp/resources/models/common_characters)).\r\n\r\nI manually loaded these common characters with:\r\n\r\n```python\r\nfrom flair.data import Dictionary\r\nd = Dictionary.load(name=\"chars\")\r\n\r\nlen(d.get_items()) # Outputs 275\r\n```\r\n\r\nThen I used a Bulgarian word to check if all characters appear in the common characters dictionary:\r\n\r\n```python\r\nfor char in \"\u043e\u0433\u043b\u0443\u0448\u0430\":\r\n  if char not in d.get_items():\r\n    print(char)\r\n```\r\n\r\nUnfortunately, the `\u0448` character is not found.\r\n\r\nI think we should update these common characters dictionary :)", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/804/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/804/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/802", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/802/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/802/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/802/events", "html_url": "https://github.com/flairNLP/flair/issues/802", "id": 456130687, "node_id": "MDU6SXNzdWU0NTYxMzA2ODc=", "number": 802, "title": "I am getting different embeddings every time I initialize CharacterEmbeddings", "user": {"login": "n-ibrahimov01", "id": 50394344, "node_id": "MDQ6VXNlcjUwMzk0MzQ0", "avatar_url": "https://avatars.githubusercontent.com/u/50394344?v=4", "gravatar_id": "", "url": "https://api.github.com/users/n-ibrahimov01", "html_url": "https://github.com/n-ibrahimov01", "followers_url": "https://api.github.com/users/n-ibrahimov01/followers", "following_url": "https://api.github.com/users/n-ibrahimov01/following{/other_user}", "gists_url": "https://api.github.com/users/n-ibrahimov01/gists{/gist_id}", "starred_url": "https://api.github.com/users/n-ibrahimov01/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/n-ibrahimov01/subscriptions", "organizations_url": "https://api.github.com/users/n-ibrahimov01/orgs", "repos_url": "https://api.github.com/users/n-ibrahimov01/repos", "events_url": "https://api.github.com/users/n-ibrahimov01/events{/privacy}", "received_events_url": "https://api.github.com/users/n-ibrahimov01/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-06-14T08:43:47Z", "updated_at": "2019-06-25T12:26:25Z", "closed_at": "2019-06-25T12:26:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "This is a code that I am using:\r\n\r\n```\r\nfrom flair.embeddings import CharacterEmbeddings\r\nc_embeddings = CharacterEmbeddings ()\r\n\r\nword_string_1 = \"Example\"\r\nword_string_2 = \"Example\"\r\n\r\nc_embeddings_1 = CharacterEmbeddings ()\r\nc_embeddings_2 = CharacterEmbeddings ()\r\n\r\n\r\n\r\n\r\nsentence_embed_it_1 = Sentence (word_string_1)\r\nsentence_embed_it_2 = Sentence (word_string_2)\r\n\r\nc_embeddings_1.embed(sentence_embed_it_1)\r\nc_embeddings_1.embed (sentence_embed_it_2)\r\n\r\nfor token in sentence_embed_it_1:\r\n    emb_1 =  (token.embedding.data)\r\n\r\nfor token in sentence_embed_it_2:\r\n    emb_2 =  (token.embedding.data)\r\n```\r\n\r\nemb_1 and emb_2 return different values. ", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/802/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/802/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/797", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/797/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/797/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/797/events", "html_url": "https://github.com/flairNLP/flair/issues/797", "id": 455525380, "node_id": "MDU6SXNzdWU0NTU1MjUzODA=", "number": 797, "title": "``CharLMEmbeddings.train()'' has been overridden thus cannot disable dropout while evaluation.", "user": {"login": "LorrinWWW", "id": 20911161, "node_id": "MDQ6VXNlcjIwOTExMTYx", "avatar_url": "https://avatars.githubusercontent.com/u/20911161?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LorrinWWW", "html_url": "https://github.com/LorrinWWW", "followers_url": "https://api.github.com/users/LorrinWWW/followers", "following_url": "https://api.github.com/users/LorrinWWW/following{/other_user}", "gists_url": "https://api.github.com/users/LorrinWWW/gists{/gist_id}", "starred_url": "https://api.github.com/users/LorrinWWW/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LorrinWWW/subscriptions", "organizations_url": "https://api.github.com/users/LorrinWWW/orgs", "repos_url": "https://api.github.com/users/LorrinWWW/repos", "events_url": "https://api.github.com/users/LorrinWWW/events{/privacy}", "received_events_url": "https://api.github.com/users/LorrinWWW/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-06-13T04:06:51Z", "updated_at": "2019-06-16T04:29:24Z", "closed_at": "2019-06-16T04:29:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "Due to issue #184, CharLMEmbeddings.train() has been overridden:\r\n```python\r\n    def train(self, mode=True):\r\n        pass\r\n```\r\nBut this prevents it from switching to eval mode, causing that the dropout is still in effect during evaluation. Related issue #216, so calling `tagger.train()` won't disable dropout in CharLMEmbeddings. That explains why the evaluation score varies every time.\r\nIs it possible to fix it? Thanks a lot!", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/797/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/797/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/794", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/794/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/794/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/794/events", "html_url": "https://github.com/flairNLP/flair/issues/794", "id": 455188207, "node_id": "MDU6SXNzdWU0NTUxODgyMDc=", "number": 794, "title": "Tutorial 7: Training a model - Sample code needs correction (post release 0.4.2)", "user": {"login": "aayushsanghavi", "id": 19590302, "node_id": "MDQ6VXNlcjE5NTkwMzAy", "avatar_url": "https://avatars.githubusercontent.com/u/19590302?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aayushsanghavi", "html_url": "https://github.com/aayushsanghavi", "followers_url": "https://api.github.com/users/aayushsanghavi/followers", "following_url": "https://api.github.com/users/aayushsanghavi/following{/other_user}", "gists_url": "https://api.github.com/users/aayushsanghavi/gists{/gist_id}", "starred_url": "https://api.github.com/users/aayushsanghavi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aayushsanghavi/subscriptions", "organizations_url": "https://api.github.com/users/aayushsanghavi/orgs", "repos_url": "https://api.github.com/users/aayushsanghavi/repos", "events_url": "https://api.github.com/users/aayushsanghavi/events{/privacy}", "received_events_url": "https://api.github.com/users/aayushsanghavi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-06-12T12:36:08Z", "updated_at": "2019-06-12T12:39:22Z", "closed_at": "2019-06-12T12:39:21Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n\r\nRelease 0.4.2 changes the model loading mechanism. As per the docs\r\n\r\n> it removes the load_from_file() methods, which are now part of the load() method\r\n\r\nThe sample code in [Tutorial 7](https://github.com/zalandoresearch/flair/blob/master/resources/docs/TUTORIAL_7_TRAINING_A_MODEL.md) uses `SequenceTagger.load_from_file()` and `TextClassifier.load_from_file()` methods instead of the new `load()` method to load an already trained model for evaluation.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/794/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/794/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/788", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/788/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/788/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/788/events", "html_url": "https://github.com/flairNLP/flair/issues/788", "id": 454301543, "node_id": "MDU6SXNzdWU0NTQzMDE1NDM=", "number": 788, "title": "training.log not closed before next model", "user": {"login": "adodge", "id": 551173, "node_id": "MDQ6VXNlcjU1MTE3Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/551173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adodge", "html_url": "https://github.com/adodge", "followers_url": "https://api.github.com/users/adodge/followers", "following_url": "https://api.github.com/users/adodge/following{/other_user}", "gists_url": "https://api.github.com/users/adodge/gists{/gist_id}", "starred_url": "https://api.github.com/users/adodge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adodge/subscriptions", "organizations_url": "https://api.github.com/users/adodge/orgs", "repos_url": "https://api.github.com/users/adodge/repos", "events_url": "https://api.github.com/users/adodge/events{/privacy}", "received_events_url": "https://api.github.com/users/adodge/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-06-10T18:20:01Z", "updated_at": "2020-04-30T00:13:37Z", "closed_at": "2020-04-30T00:13:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nTraining multiple models in one script results in the `training.log` files of earlier models including the log output of all subsequent models.\r\n\r\n**To Reproduce**\r\nDo something like this (which might naturally happen during some sort of grid search):\r\n\r\n```\r\n# [create classifier and corpus somehow]\r\nfor outdir in ['a', 'b']:\r\n    ModelTrainer(classifier, corpus).train(outdir)\r\n```\r\n\r\nNote that the contents of `b/training.log` are also appended to the end of `a/training.log`.\r\n\r\n**Expected behavior**\r\nEach training.log file should contain only the log output involved in training that model.\r\n\r\n**Environment (please complete the following information):**\r\n - Ubuntu\r\n - Flair 0.4.1", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/788/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/788/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/780", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/780/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/780/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/780/events", "html_url": "https://github.com/flairNLP/flair/issues/780", "id": 452168690, "node_id": "MDU6SXNzdWU0NTIxNjg2OTA=", "number": 780, "title": "Text classification error when using character embeddings whilst employing an LSTM", "user": {"login": "neildhir", "id": 5817673, "node_id": "MDQ6VXNlcjU4MTc2NzM=", "avatar_url": "https://avatars.githubusercontent.com/u/5817673?v=4", "gravatar_id": "", "url": "https://api.github.com/users/neildhir", "html_url": "https://github.com/neildhir", "followers_url": "https://api.github.com/users/neildhir/followers", "following_url": "https://api.github.com/users/neildhir/following{/other_user}", "gists_url": "https://api.github.com/users/neildhir/gists{/gist_id}", "starred_url": "https://api.github.com/users/neildhir/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/neildhir/subscriptions", "organizations_url": "https://api.github.com/users/neildhir/orgs", "repos_url": "https://api.github.com/users/neildhir/repos", "events_url": "https://api.github.com/users/neildhir/events{/privacy}", "received_events_url": "https://api.github.com/users/neildhir/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-06-04T19:30:23Z", "updated_at": "2019-06-12T12:59:27Z", "closed_at": "2019-06-12T12:58:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am trying to do a simple binary text classification using `DocumentRNNEmbeddings` and `TextClassifier` where the embedding used is the `CharacterEmbeddings()`. \r\n\r\nThe model looks like so:\r\n\r\n```\r\ndef model(config, language='english'):\r\n    \"\"\"\r\n\r\n    assert torch.cuda.is_available(), \"Do not run this model with GPU support.\"\r\n    # Specfiy the directory where all our results and data will be stored.\r\n    lang_dir = Path('char_' + str(language) + \"/\")\r\n\r\n    if language == 'english':\r\n        # Note the name of the path (test,dev and train get identified automatically)\r\n        corpus = ClassificationCorpus(DATA_ROOT_FASTTEXT / lang_dir)\r\n        # Set word embeddings here\r\n        word_embeddings = [CharacterEmbeddings()]\r\n        # document_embeddings = [CharacterEmbeddings()]\r\n    else:\r\n        raise ValueError(\"Language {} is not supported.\".format(language))\r\n\r\n    # Combine embeddings to make a \"document\"\r\n    document_embeddings = DocumentRNNEmbeddings(word_embeddings,\r\n                                                hidden_size=config.hidden_size,\r\n                                                reproject_words=config.reproject_words,\r\n                                                bidirectional=config.bidirectional,\r\n                                                rnn_type=config.rnn_type,\r\n                                                rnn_layers=config.rnn_layers,\r\n                                                reproject_words_dimension=config.reproject_words_dimension)\r\n\r\n    # Classify said document using a TextClassifer\r\n    classifier = TextClassifier(document_embeddings,\r\n                                label_dictionary=corpus.make_label_dictionary(),\r\n                                multi_label=False)\r\n\r\n    # Specify a training instance\r\n    trainer = ModelTrainer(classifier, corpus)\r\n\r\n    # Train model\r\n    trainer.train(DATA_ROOT_FASTTEXT / lang_dir,\r\n                  learning_rate=config.learning_rate,\r\n                  mini_batch_size=config.mini_batch_size,\r\n                  anneal_factor=config.anneal_factor,\r\n                  patience=config.patience,\r\n                  max_epochs=config.max_epochs)\r\n```\r\n\r\nwhere `config` is simply a class which stores all the model parameters.\r\n\r\n```\r\n# Config parameters for the model training\r\nconfig = Config(\r\n    \r\n    # RNN model specification\r\n    hidden_size=8,\r\n    reproject_words=True,\r\n    bidirectional=True,\r\n    rnn_type=\"LSTM\", # LSTM does not work for some reason\r\n    rnn_layers=1,\r\n    reproject_words_dimension=None,\r\n    dropout=0.5,\r\n    \r\n    # Training\r\n    evaluation_metric=EvaluationMetric.MICRO_F1_SCORE,\r\n    learning_rate=0.001,\r\n    anneal_factor=0.5,\r\n    mini_batch_size=64,\r\n    patience=3,\r\n    max_epochs=10\r\n)\r\n```\r\n\r\n\r\n**Expected behavior**\r\n\r\nThe expected behaviour when I set `rnn_type=\"LSTM\"` is for `flair` to recognise `LSTM`.\r\n\r\nWhat I get is this error:\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nKeyError                                  Traceback (most recent call last)\r\n<ipython-input-19-e27894ad7da5> in <module>\r\n      1 assert torch.cuda.is_available(), \"Do not run this model with GPU support.\"\r\n      2 # Run model\r\n----> 3 model(config)\r\n\r\n~/cloud/model.py in model(config, language, optimise)\r\n     77                   anneal_factor=config.anneal_factor,\r\n     78                   patience=config.patience,\r\n---> 79                   max_epochs=config.max_epochs)\r\n     80 \r\n     81 \r\n\r\n~/anaconda3/envs/py36/lib/python3.6/site-packages/flair/trainers/trainer.py in train(self, base_path, evaluation_metric, learning_rate, mini_batch_size, eval_mini_batch_size, max_epochs, anneal_factor, patience, train_with_dev, monitor_train, embeddings_in_memory, checkpoint, save_final_model, anneal_with_restarts, shuffle, param_selection_mode, num_workers, **kwargs)\r\n     91                 [Sentence(\"d\", labels=[\"0.1\"])],\r\n     92                 eval_mini_batch_size,\r\n---> 93                 embeddings_in_memory,\r\n     94             )\r\n     95             if log_train:\r\n\r\n~/anaconda3/envs/py36/lib/python3.6/site-packages/flair/models/text_classification_model.py in evaluate(self, sentences, eval_mini_batch_size, embeddings_in_memory, out_path)\r\n    175                 batch_count += 1\r\n    176 \r\n--> 177                 labels, loss = self.forward_labels_and_loss(batch)\r\n    178 \r\n    179                 clear_embeddings(\r\n\r\n~/anaconda3/envs/py36/lib/python3.6/site-packages/flair/models/text_classification_model.py in forward_labels_and_loss(self, sentences)\r\n    106         self, sentences: Union[Sentence, List[Sentence]]\r\n    107     ) -> (List[List[Label]], torch.tensor):\r\n--> 108         scores = self.forward(sentences)\r\n    109         labels = self._obtain_labels(scores)\r\n    110         loss = self._calculate_loss(scores, sentences)\r\n\r\n~/anaconda3/envs/py36/lib/python3.6/site-packages/flair/models/text_classification_model.py in forward(self, sentences)\r\n     68 \r\n     69     def forward(self, sentences) -> List[List[float]]:\r\n---> 70         self.document_embeddings.embed(sentences)\r\n     71 \r\n     72         text_embedding_list = [\r\n\r\n~/anaconda3/envs/py36/lib/python3.6/site-packages/flair/embeddings.py in embed(self, sentences)\r\n   2079         self.rnn.flatten_parameters()\r\n   2080 \r\n-> 2081         rnn_out, hidden = self.rnn(packed)\r\n   2082 \r\n   2083         outputs, output_lengths = torch.nn.utils.rnn.pad_packed_sequence(rnn_out)\r\n\r\n~/anaconda3/envs/py36/lib/python3.6/site-packages/torch/nn/modules/module.py in __call__(self, *input, **kwargs)\r\n    491             result = self._slow_forward(*input, **kwargs)\r\n    492         else:\r\n--> 493             result = self.forward(*input, **kwargs)\r\n    494         for hook in self._forward_hooks.values():\r\n    495             hook_result = hook(self, input, result)\r\n\r\n~/anaconda3/envs/py36/lib/python3.6/site-packages/torch/nn/modules/rnn.py in forward(self, input, hx)\r\n    206 \r\n    207         self.check_forward_args(input, hx, batch_sizes)\r\n--> 208         _impl = _rnn_impls[self.mode]\r\n    209         if batch_sizes is None:\r\n    210             result = _impl(input, hx, self._get_flat_weights(), self.bias, self.num_layers,\r\n\r\nKeyError: 'LSTM'\r\n```\r\nWhich is a bit odd.\r\n\r\n**EDIT**\r\n\r\nI [just tried your example in tutorial 7](https://github.com/zalandoresearch/flair/blob/master/resources/docs/TUTORIAL_7_TRAINING_A_MODEL.md), and it does not work either when we select `rnn_type='LSTM'` for `DocumentRNNEmbeddings`.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/780/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/780/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/777", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/777/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/777/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/777/events", "html_url": "https://github.com/flairNLP/flair/issues/777", "id": 452003250, "node_id": "MDU6SXNzdWU0NTIwMDMyNTA=", "number": 777, "title": "windows 10 64 bit pytorch freeze_support() error", "user": {"login": "travischambers", "id": 2482630, "node_id": "MDQ6VXNlcjI0ODI2MzA=", "avatar_url": "https://avatars.githubusercontent.com/u/2482630?v=4", "gravatar_id": "", "url": "https://api.github.com/users/travischambers", "html_url": "https://github.com/travischambers", "followers_url": "https://api.github.com/users/travischambers/followers", "following_url": "https://api.github.com/users/travischambers/following{/other_user}", "gists_url": "https://api.github.com/users/travischambers/gists{/gist_id}", "starred_url": "https://api.github.com/users/travischambers/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/travischambers/subscriptions", "organizations_url": "https://api.github.com/users/travischambers/orgs", "repos_url": "https://api.github.com/users/travischambers/repos", "events_url": "https://api.github.com/users/travischambers/events{/privacy}", "received_events_url": "https://api.github.com/users/travischambers/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-06-04T13:39:30Z", "updated_at": "2020-05-07T01:41:17Z", "closed_at": "2020-05-07T01:41:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI am seeing this error - https://github.com/pytorch/pytorch/issues/7485\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior (e.g. which model did you train? what parameters did you use? etc.).\r\nI'm following the tutorial here - https://github.com/zalandoresearch/flair/blob/master/resources/docs/TUTORIAL_7_TRAINING_A_MODEL.md \r\nOnly difference is I created my own ColumnCorpus and I dropped the batch_size to 16 and epochs to 5 while I'm trying to get it working.\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Windows 10 64 bit\r\n - Version: flair 0.4.2\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/777/reactions", "total_count": 2, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 2}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/777/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/776", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/776/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/776/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/776/events", "html_url": "https://github.com/flairNLP/flair/issues/776", "id": 451928694, "node_id": "MDU6SXNzdWU0NTE5Mjg2OTQ=", "number": 776, "title": "Performance issue with \"make_label_dictionary\"", "user": {"login": "sheikmohdimran", "id": 26189183, "node_id": "MDQ6VXNlcjI2MTg5MTgz", "avatar_url": "https://avatars.githubusercontent.com/u/26189183?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sheikmohdimran", "html_url": "https://github.com/sheikmohdimran", "followers_url": "https://api.github.com/users/sheikmohdimran/followers", "following_url": "https://api.github.com/users/sheikmohdimran/following{/other_user}", "gists_url": "https://api.github.com/users/sheikmohdimran/gists{/gist_id}", "starred_url": "https://api.github.com/users/sheikmohdimran/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sheikmohdimran/subscriptions", "organizations_url": "https://api.github.com/users/sheikmohdimran/orgs", "repos_url": "https://api.github.com/users/sheikmohdimran/repos", "events_url": "https://api.github.com/users/sheikmohdimran/events{/privacy}", "received_events_url": "https://api.github.com/users/sheikmohdimran/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2019-06-04T10:53:43Z", "updated_at": "2020-08-12T15:17:57Z", "closed_at": "2019-06-12T12:30:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI have a corpus of following split, for a binary classification problem.\r\nCorpus: 1082924 train + 360975 dev + 360975 test sentences\r\nWhen I run \"corpus.make_label_dictionary()\", it takes for ever to complete\r\n\r\n**Expected behavior**\r\nLabels should be extracted rather quickly\r\n\r\n**Screenshots**\r\nAttached below is the profiler output on where the code is taking too long\r\nTimer unit: 1e-06 s\r\n\r\nTotal time: 489.987 s\r\nFile: /opt/conda/lib/python3.6/site-packages/flair/data.py\r\nFunction: make_label_dictionary at line 809\r\n\r\nLine #      Hits         Time  Per Hit   % Time  Line Contents\r\n==============================================================\r\n   809                                               def make_label_dictionary(self) -> Dictionary:\r\n   810                                                   \"\"\"\r\n   811                                                   Creates a dictionary of all labels assigned to the sentences in the corpus.\r\n   812                                                   :return: dictionary of labels\r\n   813                                                   \"\"\"\r\n   814         1  489987462.0 489987462.0    100.0          labels = set([label.value for sent in self.train for label in sent.labels])\r\n   815                                                   log.info(labels)\r\n   816                                                   label_dictionary: Dictionary = Dictionary(add_unk=False)\r\n   817                                                   for label in labels:\r\n   818                                                       label_dictionary.add_item(label)\r\n   819                                           \r\n   820                                                   max_labels = max([len(sent.labels) for sent in self.train])\r\n   821                                                   if max_labels > 1:\r\n   822                                                       label_dictionary.multi_label = True\r\n   823                                           \r\n   824                                                   return label_dictionary\r\n\r\nVersion [e.g. flair-0.4.2]:\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/776/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/776/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/769", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/769/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/769/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/769/events", "html_url": "https://github.com/flairNLP/flair/issues/769", "id": 450518016, "node_id": "MDU6SXNzdWU0NTA1MTgwMTY=", "number": 769, "title": "embed function on StackedEmbeddings returns nothing", "user": {"login": "teichert", "id": 2686038, "node_id": "MDQ6VXNlcjI2ODYwMzg=", "avatar_url": "https://avatars.githubusercontent.com/u/2686038?v=4", "gravatar_id": "", "url": "https://api.github.com/users/teichert", "html_url": "https://github.com/teichert", "followers_url": "https://api.github.com/users/teichert/followers", "following_url": "https://api.github.com/users/teichert/following{/other_user}", "gists_url": "https://api.github.com/users/teichert/gists{/gist_id}", "starred_url": "https://api.github.com/users/teichert/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/teichert/subscriptions", "organizations_url": "https://api.github.com/users/teichert/orgs", "repos_url": "https://api.github.com/users/teichert/repos", "events_url": "https://api.github.com/users/teichert/events{/privacy}", "received_events_url": "https://api.github.com/users/teichert/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-05-30T21:38:09Z", "updated_at": "2019-05-31T15:23:06Z", "closed_at": "2019-05-31T15:23:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "WordEmbeddings work for me as expected, but calling .embed on a StackedEmbedding doesn't return any result:\r\n```python\r\nimport flair, torch\r\nfrom flair.embeddings import CharacterEmbeddings, StackedEmbeddings \r\nfrom flair.data import Sentence \r\nflair.device = torch.device('cpu') \r\ns = Sentence('this is a test') \r\nembedding = CharacterEmbeddings() \r\nstacked_embedding = StackedEmbeddings([embedding]) \r\nprint(embedding.embed(s)) \r\nprint(stacked_embedding.embed(s))\r\n```\r\n\r\n... gives the following output:\r\n\r\n>     [Sentence: \"this is a test\" - 4 Tokens]\r\n>     None\r\n\r\nI expected to get:\r\n\r\n>     [Sentence: \"this is a test\" - 4 Tokens]\r\n>     [Sentence: \"this is a test\" - 4 Tokens]\r\n\r\nI'm using Python 3.7.3 and flair 0.4.1 on a Linux machine (with device=cpu).\r\n\r\nIt seems unlikely that this would go unnoticed until now, so I'm expecting someone will point out what I'm doing wrong.  I got the same behavior if I stacked a longer list of embeddings, and I got the same result with other types of embeddings.  I'm using CharacterEmbeddings to avoid needing to download a large model to run my example.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/769/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/769/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/763", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/763/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/763/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/763/events", "html_url": "https://github.com/flairNLP/flair/issues/763", "id": 449441399, "node_id": "MDU6SXNzdWU0NDk0NDEzOTk=", "number": 763, "title": "expected str, bytes or os.PathLike object, not NoneType", "user": {"login": "JBE777", "id": 49010974, "node_id": "MDQ6VXNlcjQ5MDEwOTc0", "avatar_url": "https://avatars.githubusercontent.com/u/49010974?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JBE777", "html_url": "https://github.com/JBE777", "followers_url": "https://api.github.com/users/JBE777/followers", "following_url": "https://api.github.com/users/JBE777/following{/other_user}", "gists_url": "https://api.github.com/users/JBE777/gists{/gist_id}", "starred_url": "https://api.github.com/users/JBE777/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JBE777/subscriptions", "organizations_url": "https://api.github.com/users/JBE777/orgs", "repos_url": "https://api.github.com/users/JBE777/repos", "events_url": "https://api.github.com/users/JBE777/events{/privacy}", "received_events_url": "https://api.github.com/users/JBE777/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-05-28T19:37:06Z", "updated_at": "2020-05-07T01:41:16Z", "closed_at": "2020-05-07T01:41:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nA clear and concise description of what the bug is.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior (e.g. which model did you train? what parameters did you use? etc.).\r\n\r\n**Expected behavior**\r\nA clear and concise description of what you expected to happen.\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]:\r\n - Version [e.g. flair-0.3.2]:\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/763/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/763/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/762", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/762/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/762/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/762/events", "html_url": "https://github.com/flairNLP/flair/issues/762", "id": 449415305, "node_id": "MDU6SXNzdWU0NDk0MTUzMDU=", "number": 762, "title": "Can't increase the num_workers?", "user": {"login": "AdityaSoni19031997", "id": 22738086, "node_id": "MDQ6VXNlcjIyNzM4MDg2", "avatar_url": "https://avatars.githubusercontent.com/u/22738086?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AdityaSoni19031997", "html_url": "https://github.com/AdityaSoni19031997", "followers_url": "https://api.github.com/users/AdityaSoni19031997/followers", "following_url": "https://api.github.com/users/AdityaSoni19031997/following{/other_user}", "gists_url": "https://api.github.com/users/AdityaSoni19031997/gists{/gist_id}", "starred_url": "https://api.github.com/users/AdityaSoni19031997/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AdityaSoni19031997/subscriptions", "organizations_url": "https://api.github.com/users/AdityaSoni19031997/orgs", "repos_url": "https://api.github.com/users/AdityaSoni19031997/repos", "events_url": "https://api.github.com/users/AdityaSoni19031997/events{/privacy}", "received_events_url": "https://api.github.com/users/AdityaSoni19031997/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-05-28T18:30:56Z", "updated_at": "2019-05-28T19:49:55Z", "closed_at": "2019-05-28T19:49:55Z", "author_association": "NONE", "active_lock_reason": null, "body": "PS Very New Flair User :)\r\n\r\nCan't increase the num_workers...\r\n\r\n**To Reproduce**\r\n```\r\ndocument_embeddings = DocumentRNNEmbeddings(word_embeddings,\r\n                                            hidden_size=512,\r\n                                            rnn_layers = 1,\r\n                                            bidirectional=True,\r\n                                            dropout = 0.23,\r\n                                            reproject_words=True,\r\n                                            reproject_words_dimension=256,\r\n                                           )\r\nclassifier = TextClassifier(document_embeddings, label_dictionary=corpus.make_label_dictionary(), multi_label=False)\r\ntrainer = ModelTrainer(classifier, corpus)\r\ntrainer.train('./stacked_embeddings/',num_workers=16, max_epochs=10, mini_batch_size= 32, \r\n              learning_rate=0.1, anneal_factor=0.5, train_with_dev=True)\r\n```\r\n\r\n**Expected behavior**\r\nI expected to allow the `Trainer.train()` to increase  the `num_workers` as such.. [reference](https://github.com/zalandoresearch/flair/blob/master/flair/trainers/trainer.py#L65)\n\r\n**Traceback**\r\n\r\n```'2019-05-28 18:15:22,482 ----------------------------------------------------------------------------------------------------\r\n2019-05-28 18:15:22,483 Evaluation method: MICRO_F1_SCORE\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-22-6d2706307a23> in <module>\r\n      1 trainer = ModelTrainer(classifier, corpus)\r\n      2 trainer.train('./stacked_embeddings/',num_workers=16, max_epochs=10, mini_batch_size= 32, \r\n----> 3               learning_rate=0.1, anneal_factor=0.5, train_with_dev=True)\r\n\r\n~/.local/lib/python3.7/site-packages/flair/trainers/trainer.py in train(self, base_path, evaluation_metric, learning_rate, mini_batch_size, eval_mini_batch_size, max_epochs, anneal_factor, patience, anneal_against_train_loss, train_with_dev, monitor_train, embeddings_in_memory, checkpoint, save_final_model, anneal_with_restarts, test_mode, param_selection_mode, **kwargs)\r\n     80             weight_extractor = WeightExtractor(base_path)\r\n     81 \r\n---> 82         optimizer = self.optimizer(self.model.parameters(), lr=learning_rate, **kwargs)\r\n     83         if self.optimizer_state is not None:\r\n     84             optimizer.load_state_dict(self.optimizer_state)\r\n\r\nTypeError: __init__() got an unexpected keyword argument 'num_workers'\r\n```\r\n\r\nBut it's defined [here](https://github.com/zalandoresearch/flair/blob/master/flair/trainers/trainer.py#L65),\r\n\r\nEnviornments\r\n - OS [Linux]:\r\n - Version [e.g. flair-0.4.1]:\r\n ", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/762/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/762/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/760", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/760/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/760/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/760/events", "html_url": "https://github.com/flairNLP/flair/issues/760", "id": 449274387, "node_id": "MDU6SXNzdWU0NDkyNzQzODc=", "number": 760, "title": "Bert embeddings producing empty vectors", "user": {"login": "elyase", "id": 1175888, "node_id": "MDQ6VXNlcjExNzU4ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1175888?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elyase", "html_url": "https://github.com/elyase", "followers_url": "https://api.github.com/users/elyase/followers", "following_url": "https://api.github.com/users/elyase/following{/other_user}", "gists_url": "https://api.github.com/users/elyase/gists{/gist_id}", "starred_url": "https://api.github.com/users/elyase/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elyase/subscriptions", "organizations_url": "https://api.github.com/users/elyase/orgs", "repos_url": "https://api.github.com/users/elyase/repos", "events_url": "https://api.github.com/users/elyase/events{/privacy}", "received_events_url": "https://api.github.com/users/elyase/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-05-28T13:37:17Z", "updated_at": "2019-05-28T15:44:37Z", "closed_at": "2019-05-28T15:44:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhen I try to get a sentence embedding using BERT the output is an empty tensor\r\n\r\n**To Reproduce**\r\n\r\n``` python\r\nimport flair\r\ndocument_embeddings = flair.embeddings.BertEmbeddings('bert-base-uncased')\r\nsentence = flair.embeddings.Sentence('The grass is green .')\r\ndocument_embeddings.embed(sentence)\r\nsentence.get_embedding()\r\n```\r\noutput:\r\n```\r\n# tensor([])\r\n```\r\n**Expected behavior**\r\nA non empty list of numbers\r\n\r\n**Environment (please complete the following information):**\r\n - OS [Linux]:\r\n - Version [flair-0.4.1]:\r\n\r\n**Additional context**\r\nTested with several BERT models and both on CPU and GPU.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/760/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/760/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/748", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/748/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/748/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/748/events", "html_url": "https://github.com/flairNLP/flair/issues/748", "id": 447998680, "node_id": "MDU6SXNzdWU0NDc5OTg2ODA=", "number": 748, "title": "Problem During Execution", "user": {"login": "nagrechachirag8", "id": 50979813, "node_id": "MDQ6VXNlcjUwOTc5ODEz", "avatar_url": "https://avatars.githubusercontent.com/u/50979813?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nagrechachirag8", "html_url": "https://github.com/nagrechachirag8", "followers_url": "https://api.github.com/users/nagrechachirag8/followers", "following_url": "https://api.github.com/users/nagrechachirag8/following{/other_user}", "gists_url": "https://api.github.com/users/nagrechachirag8/gists{/gist_id}", "starred_url": "https://api.github.com/users/nagrechachirag8/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nagrechachirag8/subscriptions", "organizations_url": "https://api.github.com/users/nagrechachirag8/orgs", "repos_url": "https://api.github.com/users/nagrechachirag8/repos", "events_url": "https://api.github.com/users/nagrechachirag8/events{/privacy}", "received_events_url": "https://api.github.com/users/nagrechachirag8/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-05-24T06:23:33Z", "updated_at": "2020-04-30T12:40:12Z", "closed_at": "2020-04-30T12:40:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "corpus: TaggedCorpus = NLPTaskDataFetcher.load_corpus(NLPTask.IMDB)\r\nAfter this there is no further execution.\r\n\r\n![Screenshot from 2019-05-24 04-01-18](https://user-images.githubusercontent.com/50979813/58306808-67f6fc80-7e1a-11e9-924c-dd5724a714e3.png)\r\n\r\nOS- Linux", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/748/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/748/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/743", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/743/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/743/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/743/events", "html_url": "https://github.com/flairNLP/flair/issues/743", "id": 447076633, "node_id": "MDU6SXNzdWU0NDcwNzY2MzM=", "number": 743, "title": "Loading from Checkpoint issue", "user": {"login": "mijo2", "id": 25644913, "node_id": "MDQ6VXNlcjI1NjQ0OTEz", "avatar_url": "https://avatars.githubusercontent.com/u/25644913?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mijo2", "html_url": "https://github.com/mijo2", "followers_url": "https://api.github.com/users/mijo2/followers", "following_url": "https://api.github.com/users/mijo2/following{/other_user}", "gists_url": "https://api.github.com/users/mijo2/gists{/gist_id}", "starred_url": "https://api.github.com/users/mijo2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mijo2/subscriptions", "organizations_url": "https://api.github.com/users/mijo2/orgs", "repos_url": "https://api.github.com/users/mijo2/repos", "events_url": "https://api.github.com/users/mijo2/events{/privacy}", "received_events_url": "https://api.github.com/users/mijo2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-05-22T11:16:19Z", "updated_at": "2019-05-23T09:54:59Z", "closed_at": "2019-05-23T09:54:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhen I am training a language model in aws server and loading it from checkpoint from time to time, its working properly, But when I am trying to load a checkpoint(made in an aws server) in google colab, it gives me a Path doesn't exist assertion error. Same is the case other way around.\r\n\r\n**To Reproduce**\r\n\r\n1. Train a model locally(or in an server)\r\n2. Upload the code and checkpoints in google drive \r\n3. Mount google drive in a colab notebook\r\n4. Load the model from checkpoint and try training the model\r\n\r\n**Expected behavior**\r\n\r\nSuccessful loading and training of the model\r\n\r\n**Screenshots**\r\n![issue](https://user-images.githubusercontent.com/25644913/58170453-1717c480-7cb1-11e9-8fc2-c38d6939ff86.png)\r\n\r\n\r\n**Environment:**\r\n - OS : Ubuntu 16.04.6(of aws server)\r\n - Version: 0.4.1(in both the cases)\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/743/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/743/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/736", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/736/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/736/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/736/events", "html_url": "https://github.com/flairNLP/flair/issues/736", "id": 445644018, "node_id": "MDU6SXNzdWU0NDU2NDQwMTg=", "number": 736, "title": "CUDA out of memory (again)", "user": {"login": "emrul", "id": 674888, "node_id": "MDQ6VXNlcjY3NDg4OA==", "avatar_url": "https://avatars.githubusercontent.com/u/674888?v=4", "gravatar_id": "", "url": "https://api.github.com/users/emrul", "html_url": "https://github.com/emrul", "followers_url": "https://api.github.com/users/emrul/followers", "following_url": "https://api.github.com/users/emrul/following{/other_user}", "gists_url": "https://api.github.com/users/emrul/gists{/gist_id}", "starred_url": "https://api.github.com/users/emrul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/emrul/subscriptions", "organizations_url": "https://api.github.com/users/emrul/orgs", "repos_url": "https://api.github.com/users/emrul/repos", "events_url": "https://api.github.com/users/emrul/events{/privacy}", "received_events_url": "https://api.github.com/users/emrul/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 21, "created_at": "2019-05-17T22:50:41Z", "updated_at": "2020-05-07T01:41:20Z", "closed_at": "2020-05-07T01:41:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "I previously got CUDA out of memory issues but resolved them by\r\n1. Ensuring no sentence is greater than 200 tokens\r\n2. Updating PyTorch\r\n\r\nThis worked well with my small dataset (12.5k training sentences) but now I am trying with a bigger dataset (160k sentences) and my CUDA issue is back.\r\n\r\nThis is my code currently:\r\n`\r\ncolumns = {0: 'text', 1: 'ner'}\r\ndata_folder = 'training/sequences'\r\ncorpus: TaggedCorpus = NLPTaskDataFetcher.load_column_corpus(data_folder, columns) print(corpus)\r\ntag_type = 'ner'\r\ntag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\nprint(tag_dictionary.idx2item)\r\nembeddings = StackedEmbeddings(embeddings=[\r\n    WordEmbeddings('glove'),\r\n    PooledFlairEmbeddings('news-forward', pooling='mean', only_capitalized=True, use_cache=True, chars_per_chunk=32),\r\n    PooledFlairEmbeddings('news-backward', pooling='mean', only_capitalized=True, use_cache=True, chars_per_chunk=32),\r\n    WordEmbeddings(embeddings=\"embeddings/markup2vec.wv\")\r\n])\r\n\r\ntagger: SequenceTagger = SequenceTagger(hidden_size=128,\r\n                                        embeddings=embeddings,\r\n                                        tag_dictionary=tag_dictionary,\r\n                                        tag_type=tag_type)\r\n\r\ntrainer: ModelTrainer = ModelTrainer(tagger, corpus)\r\n\r\ntrainer.train('resources/taggers/v003',\r\n              max_epochs=150,\r\n              mini_batch_size=192,\r\n              eval_mini_batch_size=16,\r\n              checkpoint=True)\r\n`\r\n\r\nand this is the error\r\n\r\n> RuntimeError: CUDA out of memory. Tried to allocate 156.00 MiB (GPU 0; 24.00 GiB total capacity; 15.79 GiB already allocated; 142.52 MiB free; 3.81 GiB cached)\r\n\r\nI've tried using the latest Flair (GitHub Master) and running on Windows 10 with Python 3.7 any PyTorch 1.1.0.  Any ideas on what else I can try to get training to work with a large number of samples?", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/736/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/736/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/734", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/734/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/734/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/734/events", "html_url": "https://github.com/flairNLP/flair/issues/734", "id": 445040837, "node_id": "MDU6SXNzdWU0NDUwNDA4Mzc=", "number": 734, "title": "Micro average accuracy for multiclass classification", "user": {"login": "isanvicente", "id": 4609181, "node_id": "MDQ6VXNlcjQ2MDkxODE=", "avatar_url": "https://avatars.githubusercontent.com/u/4609181?v=4", "gravatar_id": "", "url": "https://api.github.com/users/isanvicente", "html_url": "https://github.com/isanvicente", "followers_url": "https://api.github.com/users/isanvicente/followers", "following_url": "https://api.github.com/users/isanvicente/following{/other_user}", "gists_url": "https://api.github.com/users/isanvicente/gists{/gist_id}", "starred_url": "https://api.github.com/users/isanvicente/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/isanvicente/subscriptions", "organizations_url": "https://api.github.com/users/isanvicente/orgs", "repos_url": "https://api.github.com/users/isanvicente/repos", "events_url": "https://api.github.com/users/isanvicente/events{/privacy}", "received_events_url": "https://api.github.com/users/isanvicente/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-05-16T16:06:56Z", "updated_at": "2020-05-06T23:41:09Z", "closed_at": "2020-05-06T23:41:09Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n   I am aware that accuracy is computed without taking into account true negatives (tn) as per issue #483 . However, the following is the output produced for a 3 class sentiment classification task (N|P|NEU, all examples are predicted and assigned exactly one class):\r\n\r\n```\r\nTesting using best model ...\r\nloading file flair-exps/eu/models100/best-model.pt\r\nMICRO_AVG: acc 0.5221 - f1-score 0.6861\r\nMACRO_AVG: acc 0.5197 - f1-score 0.6837\r\nN          tp: 203 - fp: 108 - fn: 101 - tn: 757 - precision: 0.6527 - recall: 0.6678 - accuracy: 0.4927 - f1-score: 0.6602\r\nNEU        tp: 300 - fp: 129 - fn: 147 - tn: 593 - precision: 0.6993 - recall: 0.6711 - accuracy: 0.5208 - f1-score: 0.6849\r\nP          tp: 299 - fp: 130 - fn: 119 - tn: 621 - precision: 0.6970 - recall: 0.7153 - accuracy: 0.5456 - f1-score: 0.7060\r\n```\r\n\r\nIt seems to me that the micro-averaged accuracy is not  correctly computed in this case. I would expect that MICRO AVG acc to be equal to MICRO AVG f1-score. In fact, if we compute accuracy (correct predictions/total predictions) with the above numbers (203+300+299)/ 1169 =  0.6861.\r\n Shouldn't it be `MICRO_AVG: acc 0.6861 - f1-score 0.6861` instead of  `MICRO_AVG: acc 0.5221 - f1-score 0.6861` ?\r\n\r\nI think the problem is in [training_utils.py#L120](https://github.com/zalandoresearch/flair/blob/cf1823e2bef99e1ffcc3bb2af5b86e9d33178178/flair/training_utils.py#L120), because when calling self.accuracy(None), the total number predictions are computed as the sum of tps,fps and fns, which is not the actual number of samples in the test set. \r\n\r\nAgain I'm in a multiclass single-label text classification scenario. I haven't tested other tasks.\r\n\r\nIn any case, thanks for the great work!", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/734/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/734/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/721", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/721/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/721/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/721/events", "html_url": "https://github.com/flairNLP/flair/issues/721", "id": 443506485, "node_id": "MDU6SXNzdWU0NDM1MDY0ODU=", "number": 721, "title": "UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte", "user": {"login": "fatimabs", "id": 24894969, "node_id": "MDQ6VXNlcjI0ODk0OTY5", "avatar_url": "https://avatars.githubusercontent.com/u/24894969?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fatimabs", "html_url": "https://github.com/fatimabs", "followers_url": "https://api.github.com/users/fatimabs/followers", "following_url": "https://api.github.com/users/fatimabs/following{/other_user}", "gists_url": "https://api.github.com/users/fatimabs/gists{/gist_id}", "starred_url": "https://api.github.com/users/fatimabs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fatimabs/subscriptions", "organizations_url": "https://api.github.com/users/fatimabs/orgs", "repos_url": "https://api.github.com/users/fatimabs/repos", "events_url": "https://api.github.com/users/fatimabs/events{/privacy}", "received_events_url": "https://api.github.com/users/fatimabs/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-05-13T17:02:54Z", "updated_at": "2020-10-03T16:47:44Z", "closed_at": "2020-10-03T16:47:44Z", "author_association": "NONE", "active_lock_reason": null, "body": "i'm trying to train a LM with my arabic corpus but i have a problem with :\r\n\r\ncorpus = TextCorpus(Path('/content/drive/My Drive/arabic_corpus'),\r\n                    dictionary,\r\n                    is_forward_lm,\r\n                    random_case_flip=False,\r\n                    character_level=True)\r\n\r\nUnicodeDecodeError                        Traceback (most recent call last)\r\n\r\n<ipython-input-31-adf1fb23dd28> in <module>()\r\n      6                     is_forward_lm,\r\n      7                     random_case_flip=False,\r\n----> 8                     character_level=True)\r\n\r\n3 frames\r\n\r\n/usr/lib/python3.6/codecs.py in decode(self, input, final)\r\n    319         # decode input (taking the buffer into account)\r\n    320         data = self.buffer + input\r\n--> 321         (result, consumed) = self._buffer_decode(data, self.errors, final)\r\n    322         # keep undecoded input until the next call\r\n    323         self.buffer = data[consumed:]\r\n\r\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/721/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/721/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/718", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/718/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/718/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/718/events", "html_url": "https://github.com/flairNLP/flair/issues/718", "id": 443106038, "node_id": "MDU6SXNzdWU0NDMxMDYwMzg=", "number": 718, "title": "Language model training: Logging error for non-latin language", "user": {"login": "AlifCor", "id": 2136794, "node_id": "MDQ6VXNlcjIxMzY3OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/2136794?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AlifCor", "html_url": "https://github.com/AlifCor", "followers_url": "https://api.github.com/users/AlifCor/followers", "following_url": "https://api.github.com/users/AlifCor/following{/other_user}", "gists_url": "https://api.github.com/users/AlifCor/gists{/gist_id}", "starred_url": "https://api.github.com/users/AlifCor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AlifCor/subscriptions", "organizations_url": "https://api.github.com/users/AlifCor/orgs", "repos_url": "https://api.github.com/users/AlifCor/repos", "events_url": "https://api.github.com/users/AlifCor/events{/privacy}", "received_events_url": "https://api.github.com/users/AlifCor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-05-12T13:39:39Z", "updated_at": "2019-08-22T16:36:32Z", "closed_at": "2019-08-22T16:36:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nDuring the language model training, flair regularly logs sentences generated from the model. In my case, this raises the following error after every epoch:\r\n```\r\n--- Logging error ---\r\nTraceback (most recent call last):\r\n  File \"...\\torch\\lib\\logging\\__init__.py\", line 1037, in emit\r\n    stream.write(msg + self.terminator)\r\n  File \"...\\torch\\lib\\encodings\\cp1252.py\", line 19, in encode\r\n    return codecs.charmap_encode(input,self.errors,encoding_table)[0]\r\nUnicodeEncodeError: 'charmap' codec can't encode characters in position 28-31: character maps to <undefined>\r\nCall stack:\r\n  File \"...flair_lm.py\", line 33, in <module>\r\n  File \"...\\torch\\lib\\site-packages\\flair\\trainers\\language_model_trainer.py\", line 336, in train\r\n    log.info(self.model.generate_text())\r\nMessage: (...)\r\nArguments: ()\r\n```\r\n\r\nNote that this doesn't interrupt the training.\r\n\r\n**To Reproduce**\r\nRoughly, here's my code:\r\n```python\r\nif __name__ == '__main__':\r\n    # are you training a forward or backward LM?\r\n    is_forward_lm = True\r\n\r\n    # load the default character dictionary\r\n    dictionary: Dictionary = Dictionary.load_from_file('chars.pickle')\r\n\r\n    # get your corpus, process forward and at the character level\r\n    corpus = TextCorpus(Path('corpus'),\r\n                        dictionary,\r\n                        is_forward_lm,\r\n                        random_case_flip=False,\r\n                        character_level=True)\r\n\r\n    # instantiate your language model, set hidden size and number of layers\r\n    language_model = LanguageModel(dictionary,\r\n                                   is_forward_lm,\r\n                                   hidden_size=512,\r\n                                   nlayers=1)\r\n\r\n    # train your language model\r\n    trainer = LanguageModelTrainer(language_model, corpus)\r\n\r\n    trainer.train(Path('lm'),\r\n                  sequence_length=250,\r\n                  mini_batch_size=10,\r\n                  max_epochs=10)\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS : Windows 10\r\n - Version : 0.4.1\r\n - Python: 3.7\r\n\r\n**Additional context**\r\nMy corpus files are UTF-8 encoded Arabic text files,\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/718/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/718/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/716", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/716/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/716/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/716/events", "html_url": "https://github.com/flairNLP/flair/issues/716", "id": 442448434, "node_id": "MDU6SXNzdWU0NDI0NDg0MzQ=", "number": 716, "title": "Perplexity calculation error for single character words (\"a\", \"I\")", "user": {"login": "styfeng", "id": 33642452, "node_id": "MDQ6VXNlcjMzNjQyNDUy", "avatar_url": "https://avatars.githubusercontent.com/u/33642452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/styfeng", "html_url": "https://github.com/styfeng", "followers_url": "https://api.github.com/users/styfeng/followers", "following_url": "https://api.github.com/users/styfeng/following{/other_user}", "gists_url": "https://api.github.com/users/styfeng/gists{/gist_id}", "starred_url": "https://api.github.com/users/styfeng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/styfeng/subscriptions", "organizations_url": "https://api.github.com/users/styfeng/orgs", "repos_url": "https://api.github.com/users/styfeng/repos", "events_url": "https://api.github.com/users/styfeng/events{/privacy}", "received_events_url": "https://api.github.com/users/styfeng/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-05-09T21:41:38Z", "updated_at": "2020-05-07T01:41:06Z", "closed_at": "2020-05-07T01:41:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "For example, if I try to calculate the perplexity of a word like \"a\" or \"I\", I get the following error:\r\n\r\n\"Expected tensor for argument #1 'indices' to have scalar type Long; but got CUDAType instead\"\r\n\r\nHowever, this works for any words greater than one character in length. I am assuming this is because the perplexity requires at least 2 characters to be calculated? If somebody could confirm or give me a hint to fixing this, that would be awesome.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/716/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/716/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/712", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/712/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/712/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/712/events", "html_url": "https://github.com/flairNLP/flair/issues/712", "id": 440600904, "node_id": "MDU6SXNzdWU0NDA2MDA5MDQ=", "number": 712, "title": "Pooled embedding: RuntimeError: Expected object of backend CUDA but got backend CPU for argument #2 'other'", "user": {"login": "alipetiwala", "id": 41145154, "node_id": "MDQ6VXNlcjQxMTQ1MTU0", "avatar_url": "https://avatars.githubusercontent.com/u/41145154?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alipetiwala", "html_url": "https://github.com/alipetiwala", "followers_url": "https://api.github.com/users/alipetiwala/followers", "following_url": "https://api.github.com/users/alipetiwala/following{/other_user}", "gists_url": "https://api.github.com/users/alipetiwala/gists{/gist_id}", "starred_url": "https://api.github.com/users/alipetiwala/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alipetiwala/subscriptions", "organizations_url": "https://api.github.com/users/alipetiwala/orgs", "repos_url": "https://api.github.com/users/alipetiwala/repos", "events_url": "https://api.github.com/users/alipetiwala/events{/privacy}", "received_events_url": "https://api.github.com/users/alipetiwala/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-05-06T08:52:07Z", "updated_at": "2020-04-30T11:00:05Z", "closed_at": "2020-04-30T11:00:05Z", "author_association": "NONE", "active_lock_reason": null, "body": "I have the following issue while doing a tagger.predict using a pooled embedding trained NER model. Following is the error and code:\r\n```\r\n\r\n<ipython-input-12-4c8f8d981ffd> in getcor(sen)\r\n      3     sentence = Sentence(artrem_txt)\r\n      4     print\r\n----> 5     tagger.predict(sentence)\r\n      6     corr_sen=[]\r\n      7     for t in sentence.tokens:\r\n\r\n/opt/conda/lib/python3.6/site-packages/flair/models/sequence_tagger_model.py in predict(self, sentences, mini_batch_size, verbose)\r\n    298                     batches.set_description(f'Inferencing on batch {i}')\r\n    299 \r\n--> 300                 tags, _ = self.forward_labels_and_loss(batch, sort=False)\r\n    301 \r\n    302                 for (sentence, sent_tags) in zip(batch, tags):\r\n\r\n/opt/conda/lib/python3.6/site-packages/flair/models/sequence_tagger_model.py in forward_labels_and_loss(self, sentences, sort)\r\n    266                                 sort=True) -> (List[List[Label]], torch.tensor):\r\n    267         with torch.no_grad():\r\n--> 268             feature, lengths, tags = self.forward(sentences, sort=sort)\r\n    269             loss = self._calculate_loss(feature, lengths, tags)\r\n    270             tags = self._obtain_labels(feature, lengths)\r\n\r\n/opt/conda/lib/python3.6/site-packages/flair/models/sequence_tagger_model.py in forward(self, sentences, sort)\r\n    313         self.zero_grad()\r\n    314 \r\n--> 315         self.embeddings.embed(sentences)\r\n    316 \r\n    317         # if sorting is enabled, sort sentences by number of tokens\r\n\r\n/opt/conda/lib/python3.6/site-packages/flair/embeddings.py in embed(self, sentences, static_embeddings)\r\n    128 \r\n    129         for embedding in self.embeddings:\r\n--> 130             embedding.embed(sentences)\r\n    131 \r\n    132     @property\r\n\r\n/opt/conda/lib/python3.6/site-packages/flair/embeddings.py in embed(self, sentences)\r\n     61 \r\n     62         if not everything_embedded or not self.static_embeddings:\r\n---> 63             self._add_embeddings_internal(sentences)\r\n     64 \r\n     65         return sentences\r\n\r\n/opt/conda/lib/python3.6/site-packages/flair/embeddings.py in _add_embeddings_internal(self, sentences)\r\n   1029                         self.word_count[token.text] = 1\r\n   1030                     else:\r\n-> 1031                         aggregated_embedding = self.aggregate_op(self.word_embeddings[token.text], local_embedding)\r\n   1032                         if self.pooling == 'fade':\r\n   1033                             aggregated_embedding /= 2\r\n\r\nRuntimeError: Expected object of backend CUDA but got backend CPU for argument #2 'other'\r\n```", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/712/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/712/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/698", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/698/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/698/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/698/events", "html_url": "https://github.com/flairNLP/flair/issues/698", "id": 438082577, "node_id": "MDU6SXNzdWU0MzgwODI1Nzc=", "number": 698, "title": "FileNotFoundError: [WinError 2] The system cannot find the file specified when subprocess.Popen", "user": {"login": "sharathyadav1993", "id": 48545507, "node_id": "MDQ6VXNlcjQ4NTQ1NTA3", "avatar_url": "https://avatars.githubusercontent.com/u/48545507?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sharathyadav1993", "html_url": "https://github.com/sharathyadav1993", "followers_url": "https://api.github.com/users/sharathyadav1993/followers", "following_url": "https://api.github.com/users/sharathyadav1993/following{/other_user}", "gists_url": "https://api.github.com/users/sharathyadav1993/gists{/gist_id}", "starred_url": "https://api.github.com/users/sharathyadav1993/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sharathyadav1993/subscriptions", "organizations_url": "https://api.github.com/users/sharathyadav1993/orgs", "repos_url": "https://api.github.com/users/sharathyadav1993/repos", "events_url": "https://api.github.com/users/sharathyadav1993/events{/privacy}", "received_events_url": "https://api.github.com/users/sharathyadav1993/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-04-28T17:55:34Z", "updated_at": "2020-11-28T20:42:22Z", "closed_at": "2019-05-01T16:17:58Z", "author_association": "NONE", "active_lock_reason": null, "body": "When we run the below lines of code to extract the frames from a video, then it is showing file not found error. But the video file is present in the location given.\r\n\r\n**The function call is given below**\r\n\r\ndef extract_frames(video_file, num_frames):\r\n    \"\"\"Return a list of PIL image frames uniformly sampled from an mp4 video.\"\"\"\r\n    try:\r\n        os.makedirs(os.path.join(os.getcwd(), 'frames'))\r\n    except OSError:\r\n        pass\r\n    print(video_file)\r\n    output = subprocess.Popen(['ffmpeg', '-i', video_file],stderr=subprocess.PIPE).communicate()\r\n    # Search and parse 'Duration: 00:05:24.13,' from ffmpeg stderr.\r\n    re_duration = re.compile(r'Duration: (.*?)\\.')\r\n    duration = re_duration.search(str(output[1])).groups()[0]\r\n\r\n    seconds = functools.reduce(lambda x, y: x * 60 + y,\r\n                               map(int, duration.split(':')))\r\n    rate = num_frames / float(seconds)\r\n\r\n    output = subprocess.Popen(['ffmpeg', '-i', video_file,\r\n                               '-vf', 'fps={}'.format(rate),\r\n                               '-vframes', str(num_frames),\r\n                               '-loglevel', 'panic',\r\n                               'frames/%d.jpg']).communicate()\r\n    frame_paths = sorted([os.path.join('frames', frame)\r\n                          for frame in os.listdir('frames')])\r\n    frames = load_frames(frame_paths, num_frames=num_frames)\r\n    subprocess.call(['rm', '-rf', 'frames'])\r\n    return frames\r\n\r\n\r\n**Errors are shown below**\r\n\r\n\r\nC:/Users/SHemantharaj/Desktop/Cybersecurity/moments_models-master/video.mp4\r\n---------------------------------------------------------------------------\r\nFileNotFoundError                         Traceback (most recent call last)\r\n~\\Desktop\\Cybersecurity\\moments_models-master\\test_video.py in <module>()\r\n     59 else:\r\n     60     print('Extracting frames using ffmpeg...')\r\n---> 61     frames = extract_frames(args.video_file, args.num_segments)\r\n     62 \r\n     63 \r\n\r\n~\\Desktop\\Cybersecurity\\moments_models-master\\utils.py in extract_frames(video_file, num_frames)\r\n     17         pass\r\n     18     print(video_file)\r\n---> 19     output = subprocess.Popen(['ffmpeg', '-i', video_file],stderr=subprocess.PIPE,shell=True).communicate()\r\n     20     # Search and parse 'Duration: 00:05:24.13,' from ffmpeg stderr.\r\n     21     re_duration = re.compile(r'Duration: (.*?)\\.')\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3_old_version_Final\\lib\\subprocess.py in __init__(self, args, bufsize, executable, stdin, stdout, stderr, preexec_fn, close_fds, shell, cwd, env, universal_newlines, startupinfo, creationflags, restore_signals, start_new_session, pass_fds, encoding, errors)\r\n    707                                 c2pread, c2pwrite,\r\n    708                                 errread, errwrite,\r\n--> 709                                 restore_signals, start_new_session)\r\n    710         except:\r\n    711             # Cleanup if the child failed starting.\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3_old_version_Final\\lib\\subprocess.py in _execute_child(self, args, executable, preexec_fn, close_fds, pass_fds, cwd, env, startupinfo, creationflags, shell, p2cread, p2cwrite, c2pread, c2pwrite, errread, errwrite, unused_restore_signals, unused_start_new_session)\r\n    995                                          env,\r\n    996                                          os.fspath(cwd) if cwd is not None else None,\r\n--> 997                                          startupinfo)\r\n    998             finally:\r\n    999                 # Child is launched. Close the parent's copy of those pipe\r\n\r\nFileNotFoundError: [WinError 2] The system cannot find the file specified\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/698/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/698/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/697", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/697/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/697/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/697/events", "html_url": "https://github.com/flairNLP/flair/issues/697", "id": 438025261, "node_id": "MDU6SXNzdWU0MzgwMjUyNjE=", "number": 697, "title": "Can't load the Chinese BERT Embeddings from file", "user": {"login": "Green-li", "id": 11475982, "node_id": "MDQ6VXNlcjExNDc1OTgy", "avatar_url": "https://avatars.githubusercontent.com/u/11475982?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Green-li", "html_url": "https://github.com/Green-li", "followers_url": "https://api.github.com/users/Green-li/followers", "following_url": "https://api.github.com/users/Green-li/following{/other_user}", "gists_url": "https://api.github.com/users/Green-li/gists{/gist_id}", "starred_url": "https://api.github.com/users/Green-li/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Green-li/subscriptions", "organizations_url": "https://api.github.com/users/Green-li/orgs", "repos_url": "https://api.github.com/users/Green-li/repos", "events_url": "https://api.github.com/users/Green-li/events{/privacy}", "received_events_url": "https://api.github.com/users/Green-li/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-04-28T07:34:13Z", "updated_at": "2019-06-17T03:16:49Z", "closed_at": "2019-06-17T03:16:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nAs mentioned in the title, when I load the BERT embeddings from file, it reports an `UnicodeDecodeError`\u3002\r\n\r\n**To Reproduce**\r\nThe code is as follows:\r\n```\r\nfrom flair.embeddings import BertEmbeddings\r\nfrom flair.data import Sentence\r\n\r\n# init embedding\r\nembedding = BertEmbeddings(\"./pretrained_models/pytorch_model.bin\", layers='-1,-2,-3,-4', pooling_operation='mean')\r\n```\r\nThe errors are as follows:\r\n```\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 2, in <module>\r\n  File \"/home/myuser/venv/lib/python3.6/site-packages/flair/embeddings.py\", line 1070, in __init__\r\n    self.tokenizer = BertTokenizer.from_pretrained(bert_model_or_path)\r\n  File \"/home/myuser/venv/lib/python3.6/site-packages/pytorch_pretrained_bert/tokenization.py\", line 153, in from_pretrained\r\n    tokenizer = cls(resolved_vocab_file, *inputs, **kwargs)\r\n  File \"/home/myuser/venv/lib/python3.6/site-packages/pytorch_pretrained_bert/tokenization.py\", line 83, in __init__\r\n    self.vocab = load_vocab(vocab_file)\r\n  File \"/home/myuser/venv/lib/python3.6/site-packages/pytorch_pretrained_bert/tokenization.py\", line 56, in load_vocab\r\n    token = reader.readline()\r\n  File \"/home/myuser/venv/lib64/python3.6/codecs.py\", line 321, in decode\r\n    (result, consumed) = self._buffer_decode(data, self.errors, final)\r\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n- centos 7\r\n- python 3.6.6\r\n- flair 0.4.1\r\n- pytorch 1.0.0\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/697/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/697/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/685", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/685/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/685/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/685/events", "html_url": "https://github.com/flairNLP/flair/issues/685", "id": 437119505, "node_id": "MDU6SXNzdWU0MzcxMTk1MDU=", "number": 685, "title": "RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 15.90 GiB total capacity; 14.66 GiB already allocated; ....", "user": {"login": "alipetiwala", "id": 41145154, "node_id": "MDQ6VXNlcjQxMTQ1MTU0", "avatar_url": "https://avatars.githubusercontent.com/u/41145154?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alipetiwala", "html_url": "https://github.com/alipetiwala", "followers_url": "https://api.github.com/users/alipetiwala/followers", "following_url": "https://api.github.com/users/alipetiwala/following{/other_user}", "gists_url": "https://api.github.com/users/alipetiwala/gists{/gist_id}", "starred_url": "https://api.github.com/users/alipetiwala/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alipetiwala/subscriptions", "organizations_url": "https://api.github.com/users/alipetiwala/orgs", "repos_url": "https://api.github.com/users/alipetiwala/repos", "events_url": "https://api.github.com/users/alipetiwala/events{/privacy}", "received_events_url": "https://api.github.com/users/alipetiwala/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 17, "created_at": "2019-04-25T10:16:33Z", "updated_at": "2020-09-16T13:18:18Z", "closed_at": "2020-09-16T13:18:18Z", "author_association": "NONE", "active_lock_reason": null, "body": "Getting CUDA out of memory errors for following:\r\n```\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-5-75d7ff2333b9> in <module>\r\n     10               learning_rate=0.1,\r\n     11 #               mini_batch_size=16,\r\n---> 12               max_epochs=150,checkpoint=True,anneal_with_restarts=True,embeddings_in_memory=False)\r\n     13 \r\n     14 # 8. plot training curves (optional)\r\n\r\n/opt/conda/lib/python3.6/site-packages/flair/trainers/trainer.py in train(self, base_path, evaluation_metric, learning_rate, mini_batch_size, eval_mini_batch_size, max_epochs, anneal_factor, patience, anneal_against_train_loss, train_with_dev, monitor_train, embeddings_in_memory, checkpoint, save_final_model, anneal_with_restarts, test_mode, param_selection_mode, **kwargs)\r\n    148 \r\n    149                 for batch_no, batch in enumerate(batches):\r\n--> 150                     loss = self.model.forward_loss(batch)\r\n    151 \r\n    152                     optimizer.zero_grad()\r\n\r\n/opt/conda/lib/python3.6/site-packages/flair/models/sequence_tagger_model.py in forward_loss(self, sentences, sort)\r\n    261     def forward_loss(self, sentences: Union[List[Sentence], Sentence], sort=True) -> torch.tensor:\r\n    262         features, lengths, tags = self.forward(sentences, sort=sort)\r\n--> 263         return self._calculate_loss(features, lengths, tags)\r\n    264 \r\n    265     def forward_labels_and_loss(self, sentences: Union[List[Sentence], Sentence],\r\n\r\n/opt/conda/lib/python3.6/site-packages/flair/models/sequence_tagger_model.py in _calculate_loss(self, features, lengths, tags)\r\n    409             tags, _ = pad_tensors(tags)\r\n    410 \r\n--> 411             forward_score = self._forward_alg(features, lengths)\r\n    412             gold_score = self._score_sentence(features, tags, lengths)\r\n    413 \r\n\r\n/opt/conda/lib/python3.6/site-packages/flair/models/sequence_tagger_model.py in _forward_alg(self, feats, lens_)\r\n    520             agg_ = torch.log(torch.sum(torch.exp(tag_var), dim=2))\r\n    521 \r\n--> 522             cloned = forward_var.clone()\r\n    523             cloned[:, i + 1, :] = max_tag_var + agg_\r\n    524 \r\n\r\nRuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 15.90 GiB total capacity; 14.66 GiB already allocated; 7.88 MiB free; 559.48 MiB cached)\r\n```\r\n\r\nI am getting the above error for this GPU config:\r\n```\r\n\r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID   Type   Process name                             Usage      |\r\n|=============================================================================|\r\n|    0      6705      C   /opt/conda/bin/python                      16263MiB |\r\n+-----------------------------------------------------------------------------+\r\nThu Apr 25 10:14:11 2019       \r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 418.40.04    Driver Version: 418.40.04    CUDA Version: 10.1     |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  Tesla P100-PCIE...  On   | 00000000:00:04.0 Off |                    0 |\r\n| N/A   55C    P0    38W / 250W |  16273MiB / 16280MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n                                                                               \r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID   Type   Process name                             Usage      |\r\n|=============================================================================|\r\n|    0      6705      C   /opt/conda/bin/python                      16263MiB |\r\n+-----------------------------------------------------------------------------+\r\n\r\n```\r\n\r\nFor the following training configuration:\r\n```\r\n\r\nembedding_types: List[TokenEmbeddings] = [\r\n\r\n    \r\n    # GloVe embeddings\r\n    WordEmbeddings('glove'),\r\n\r\n    # contextual string embeddings, forward\r\n    PooledFlairEmbeddings('news-forward', pooling='min'),\r\n\r\n    # contextual string embeddings, backward\r\n    PooledFlairEmbeddings('news-backward', pooling='min'),\r\n]\r\n\r\nembeddings: StackedEmbeddings = StackedEmbeddings(embeddings=embedding_types)\r\n\r\n# 5. initialize sequence tagger\r\n\r\nprint(\"initialize sequence tagger\")\r\nfrom flair.models import SequenceTagger\r\n\r\ntagger: SequenceTagger = SequenceTagger(hidden_size=256,\r\n                                        embeddings=embeddings,\r\n                                        tag_dictionary=tag_dictionary,\r\n                                        tag_type=tag_type,\r\n                                        use_crf=True)\r\ntrainer.train('resources/taggers/prep/pooled',\r\n              learning_rate=0.1,\r\n              mini_batch_size=16,\r\n              max_epochs=150,checkpoint=True,anneal_with_restarts=True,embeddings_in_memory=False)\r\n\r\n```", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/685/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/685/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/678", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/678/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/678/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/678/events", "html_url": "https://github.com/flairNLP/flair/issues/678", "id": 435437930, "node_id": "MDU6SXNzdWU0MzU0Mzc5MzA=", "number": 678, "title": "Multi-label classification not working?", "user": {"login": "gwohlgen", "id": 25029262, "node_id": "MDQ6VXNlcjI1MDI5MjYy", "avatar_url": "https://avatars.githubusercontent.com/u/25029262?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gwohlgen", "html_url": "https://github.com/gwohlgen", "followers_url": "https://api.github.com/users/gwohlgen/followers", "following_url": "https://api.github.com/users/gwohlgen/following{/other_user}", "gists_url": "https://api.github.com/users/gwohlgen/gists{/gist_id}", "starred_url": "https://api.github.com/users/gwohlgen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gwohlgen/subscriptions", "organizations_url": "https://api.github.com/users/gwohlgen/orgs", "repos_url": "https://api.github.com/users/gwohlgen/repos", "events_url": "https://api.github.com/users/gwohlgen/events{/privacy}", "received_events_url": "https://api.github.com/users/gwohlgen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 22, "created_at": "2019-04-20T20:34:53Z", "updated_at": "2023-04-27T22:44:41Z", "closed_at": "2020-05-06T22:32:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/678/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/678/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/670", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/670/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/670/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/670/events", "html_url": "https://github.com/flairNLP/flair/issues/670", "id": 434115642, "node_id": "MDU6SXNzdWU0MzQxMTU2NDI=", "number": 670, "title": "Train & Test Loss scales", "user": {"login": "amitbcp", "id": 13197403, "node_id": "MDQ6VXNlcjEzMTk3NDAz", "avatar_url": "https://avatars.githubusercontent.com/u/13197403?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amitbcp", "html_url": "https://github.com/amitbcp", "followers_url": "https://api.github.com/users/amitbcp/followers", "following_url": "https://api.github.com/users/amitbcp/following{/other_user}", "gists_url": "https://api.github.com/users/amitbcp/gists{/gist_id}", "starred_url": "https://api.github.com/users/amitbcp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amitbcp/subscriptions", "organizations_url": "https://api.github.com/users/amitbcp/orgs", "repos_url": "https://api.github.com/users/amitbcp/repos", "events_url": "https://api.github.com/users/amitbcp/events{/privacy}", "received_events_url": "https://api.github.com/users/amitbcp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-04-17T06:37:06Z", "updated_at": "2019-07-08T17:43:07Z", "closed_at": "2019-05-24T08:18:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI am training a text classification model as described in the tutorial. On plotting the training process, I see the the accuracy & F1 score plots converge and stabilize over 50 epochs. Whereas  The training and test loss have a wide gap though the stabilize.\r\nOn going over the loss.tsv it seemed that the test loss was not scaled as the training loss was.\r\nOn manually scaling the test loss, the new graph made sense.\r\n\r\nOn inspecting the flair code, the script https://github.com/zalandoresearch/flair/blob/master/flair/trainers/trainer.py Line 198, the issues seems to make sense as the training loss has been scaled.\r\n![flair_code](https://user-images.githubusercontent.com/13197403/56266361-a0176b00-6109-11e9-849d-22d66a11ea14.png)\r\n\r\nCan you please validate or clarify the same ?\r\n\r\n\r\n**Expected behavior**\r\nThe graphs from Flair -\r\n![sample_imdb_training](https://user-images.githubusercontent.com/13197403/56264438-1d3fe180-6104-11e9-9112-826355cb3e5a.png)\r\n\r\nThe data used is a sample IMDB data set. \r\n\r\nThe code was used from the Tutorial of Text Classification-\r\nhttps://github.com/zalandoresearch/flair/blob/master/resources/docs/TUTORIAL_7_TRAINING_A_MODEL.md\r\n\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/670/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/670/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/665", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/665/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/665/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/665/events", "html_url": "https://github.com/flairNLP/flair/issues/665", "id": 433708473, "node_id": "MDU6SXNzdWU0MzM3MDg0NzM=", "number": 665, "title": "TypeError: function takes exactly 5 arguments (1 given) during CharLM training", "user": {"login": "amrayach", "id": 25460571, "node_id": "MDQ6VXNlcjI1NDYwNTcx", "avatar_url": "https://avatars.githubusercontent.com/u/25460571?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amrayach", "html_url": "https://github.com/amrayach", "followers_url": "https://api.github.com/users/amrayach/followers", "following_url": "https://api.github.com/users/amrayach/following{/other_user}", "gists_url": "https://api.github.com/users/amrayach/gists{/gist_id}", "starred_url": "https://api.github.com/users/amrayach/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amrayach/subscriptions", "organizations_url": "https://api.github.com/users/amrayach/orgs", "repos_url": "https://api.github.com/users/amrayach/repos", "events_url": "https://api.github.com/users/amrayach/events{/privacy}", "received_events_url": "https://api.github.com/users/amrayach/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2019-04-16T10:38:26Z", "updated_at": "2019-10-09T22:52:55Z", "closed_at": "2019-10-09T22:52:54Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nAs showen in the picture, I start the script to train my own CharLM forward embeddings and face this TypeError everytime at the same epoch(1) and same split (depends on the batch size) even with \r\nMinimal Arguments like:\r\n(hidden_size=128, nlayers=1, sequence_length=10, mini_batch_size=10, max_epochs=10, patience=25) \r\nor \r\nBig Arguments like:\r\n (hidden_size=1024, nlayers=1, sequence_length=250, mini_batch_size=100, max_epochs=10, patience=25)\r\n\r\n**To Reproduce**\r\nfrom pathlib import Path\r\n\r\nfrom flair.data import Dictionary\r\nfrom flair.models import LanguageModel\r\nfrom flair.trainers.language_model_trainer import LanguageModelTrainer, TextCorpus\r\nimport torch\r\n\r\nis_forward_lm = True\r\n\r\n\r\ndictionary: Dictionary = Dictionary.load('chars')\r\n\r\ncorpus = TextCorpus(Path(''),\r\n                    dictionary,\r\n                    is_forward_lm,\r\n                    character_level=True)\r\n\r\nlanguage_model = LanguageModel(dictionary,\r\n                               is_forward_lm,\r\n                               hidden_size=1024,\r\n                               nlayers=1)\r\n\r\ntorch.set_num_threads(6)\r\n\r\ntrainer = LanguageModelTrainer(language_model, corpus)\r\n\r\ntrainer.train(base_path='resources/taggers/language_model', sequence_length=250, mini_batch_size=100, checkpoint=True, patience=25)`\r\n\r\n**Screenshots**\r\n![error2](https://user-images.githubusercontent.com/25460571/56202953-7e07e500-6044-11e9-8994-45b417e28a71.png)\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Linux Ubuntu 18 server Version\r\n - Version: latest version 0.4.1\r\n\r\nSorry if something is not clear this is my first issue hope i'll get some answers.\r\nThanks in advance.\r\nBest Regards ", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/665/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/665/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/655", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/655/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/655/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/655/events", "html_url": "https://github.com/flairNLP/flair/issues/655", "id": 431901920, "node_id": "MDU6SXNzdWU0MzE5MDE5MjA=", "number": 655, "title": "empty list returned for the result of multi_label classifier case ", "user": {"login": "iamyihwa", "id": 12494156, "node_id": "MDQ6VXNlcjEyNDk0MTU2", "avatar_url": "https://avatars.githubusercontent.com/u/12494156?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iamyihwa", "html_url": "https://github.com/iamyihwa", "followers_url": "https://api.github.com/users/iamyihwa/followers", "following_url": "https://api.github.com/users/iamyihwa/following{/other_user}", "gists_url": "https://api.github.com/users/iamyihwa/gists{/gist_id}", "starred_url": "https://api.github.com/users/iamyihwa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iamyihwa/subscriptions", "organizations_url": "https://api.github.com/users/iamyihwa/orgs", "repos_url": "https://api.github.com/users/iamyihwa/repos", "events_url": "https://api.github.com/users/iamyihwa/events{/privacy}", "received_events_url": "https://api.github.com/users/iamyihwa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-04-11T08:45:48Z", "updated_at": "2020-05-07T04:15:45Z", "closed_at": "2020-05-07T04:15:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello\r\nI have noticed that sometimes for the multi_label classifier case (using TextClassifier(flair.nn.Model)) , there is no value returned. \r\n\r\nI saw in the implementation in [text_classification_model.py](https://github.com/zalandoresearch/flair/blob/master/flair/models/text_classification_model.py) that _get_multi_label() and _get_single_label() were implemented differently, and get_multi_label only returns values when confidence is above 0.5. \r\n\r\nSince it might be confusing if no value is returned, what about adding at the end of the _get_multi_label a check to see if the labels is empty, and if so, then add the same function as in _get_single_label? (I have attached a proposed change.) \r\n\r\nOriginal _get_multi_label and _get_single_label:\r\n\r\n```\r\n def _get_multi_label(self, label_scores) -> List[Label]:\r\n        labels = []\r\n\r\n        sigmoid = torch.nn.Sigmoid()\r\n\r\n        results = list(map(lambda x: sigmoid(x), label_scores))\r\n        for idx, conf in enumerate(results):\r\n            if conf > 0.5:\r\n                label = self.label_dictionary.get_item_for_index(idx)\r\n                labels.append(Label(label, conf.item()))\r\n\r\n        return labels\r\n\r\n    def _get_single_label(self, label_scores) -> List[Label]:\r\n        conf, idx = torch.max(label_scores, 0)\r\n        label = self.label_dictionary.get_item_for_index(idx.item())\r\n\r\n        return [Label(label, conf.item())]\r\n```\r\n\r\n\r\nProposed modification of get_multi_label to return at least one value in any case: \r\n\r\n```\r\n def _get_multi_label(self, label_scores) -> List[Label]:\r\n        labels = []\r\n\r\n        sigmoid = torch.nn.Sigmoid()\r\n\r\n        results = list(map(lambda x: sigmoid(x), label_scores))\r\n        for idx, conf in enumerate(results):\r\n            if conf > 0.5:\r\n                label = self.label_dictionary.get_item_for_index(idx)\r\n                labels.append(Label(label, conf.item()))\r\n       \r\n        if not labels:\r\n               conf, idx = torch.max(label_scores, 0)\r\n               label = self.label_dictionary.get_item_for_index(idx.item())\r\n               labels = [label]\r\n\r\n        return labels\r\n```\r\n\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/655/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/655/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/654", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/654/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/654/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/654/events", "html_url": "https://github.com/flairNLP/flair/issues/654", "id": 431668362, "node_id": "MDU6SXNzdWU0MzE2NjgzNjI=", "number": 654, "title": "Language modelling train set directory", "user": {"login": "sinaahmadi", "id": 12765529, "node_id": "MDQ6VXNlcjEyNzY1NTI5", "avatar_url": "https://avatars.githubusercontent.com/u/12765529?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sinaahmadi", "html_url": "https://github.com/sinaahmadi", "followers_url": "https://api.github.com/users/sinaahmadi/followers", "following_url": "https://api.github.com/users/sinaahmadi/following{/other_user}", "gists_url": "https://api.github.com/users/sinaahmadi/gists{/gist_id}", "starred_url": "https://api.github.com/users/sinaahmadi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sinaahmadi/subscriptions", "organizations_url": "https://api.github.com/users/sinaahmadi/orgs", "repos_url": "https://api.github.com/users/sinaahmadi/repos", "events_url": "https://api.github.com/users/sinaahmadi/events{/privacy}", "received_events_url": "https://api.github.com/users/sinaahmadi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-04-10T19:13:19Z", "updated_at": "2019-07-26T14:27:22Z", "closed_at": "2019-04-16T13:03:01Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Language modelling**\r\nWhen I want to create a language model using more than one split training sets, I get the following error: \r\n\r\n```\r\nSinas-MacBook-Pro:finnlp sina$ python3 train_LM_flair.py \r\nBetter speed can be achieved with apex installed from https://www.github.com/nvidia/apex.\r\n2019-04-10 19:27:29,037 read text file with 2 lines\r\n2019-04-10 19:27:29,176 read text file with 3 lines\r\nTraceback (most recent call last):\r\n  File \"train_LM_flair.py\", line 34, in <module>\r\n    trainer.train('language_model', mini_batch_size=10, sequence_length=10, max_epochs=10)\r\n  File \"/usr/local/lib/python3.7/site-packages/flair/trainers/language_model_trainer.py\", line 256, in train\r\n    for curr_split, train_slice in enumerate(training_generator, self.split):\r\n  File \"/usr/local/lib/python3.7/site-packages/torch/utils/data/dataloader.py\", line 637, in __next__\r\n    return self._process_next_batch(batch)\r\n  File \"/usr/local/lib/python3.7/site-packages/torch/utils/data/dataloader.py\", line 658, in _process_next_batch\r\n2019-04-10 19:27:29,308 read text file with 1 lines\r\n    raise batch.exc_type(batch.exc_msg)\r\nTypeError: function takes exactly 5 arguments (1 given)\r\n```\r\nFollowing the errors, I could find out that the error is due to [this part](https://github.com/zalandoresearch/flair/blob/abad7da384260f0b41bedb726af9785aebe196b6/flair/trainers/language_model_trainer.py#L167) of the `language_model_trainer.py` script:\r\n\r\n```\r\n self.train = TextDataset(path / 'train', dictionary, False, self.forward, self.split_on_char,\r\n                                 self.random_case_flip, shuffle_lines=self.shuffle_lines)\r\n```\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n\r\n```\r\nfrom pathlib import Path\r\n\r\nfrom flair.data import Dictionary\r\nfrom flair.models import LanguageModel\r\nfrom flair.trainers.language_model_trainer import LanguageModelTrainer, TextCorpus\r\n\r\n# are you training a forward or backward LM?\r\nis_forward_lm = True\r\n\r\n# load the default character dictionary\r\ndictionary: Dictionary = Dictionary.load('chars')\r\n\r\n# get your corpus, process forward and at the character level\r\ncorpus = TextCorpus(Path('corpus'),\r\n                    dictionary,\r\n                    is_forward_lm,\r\n                    character_level=True)\r\n\r\n# instantiate your language model, set hidden size and number of layers\r\nlanguage_model = LanguageModel(dictionary,\r\n                               is_forward_lm,\r\n                               hidden_size=128,\r\n                               nlayers=1)\r\n\r\n# train your language model\r\ntrainer = LanguageModelTrainer(language_model, corpus)\r\n\r\ntrainer.train('resources/taggers/language_model',\r\n              sequence_length=10,\r\n              mini_batch_size=10,\r\n              max_epochs=10)\r\n```\r\n\r\n**Directory structure**\r\nThis is how my training, validation and testing data sets are organized in my working directory:\r\n\r\n> Sinas-MacBook-Pro:corpus sina$ tree\r\n> .\r\n> \u251c\u2500\u2500 test.txt\r\n> \u251c\u2500\u2500 train\r\n> \u2502\u00a0\u00a0 \u251c\u2500\u2500 train_split_1.txt\r\n> \u2502\u00a0\u00a0 \u251c\u2500\u2500 train_split_2.txt\r\n> \u2502\u00a0\u00a0 \u251c\u2500\u2500 train_split_3.txt\r\n> \u2502\u00a0\u00a0 \u251c\u2500\u2500 train_split_4.txt\r\n> \u2502\u00a0\u00a0 \u2514\u2500\u2500 train_split_5.txt\r\n> \u2514\u2500\u2500 valid.txt\r\n\r\n**Environment (please complete the following information):**\r\n - OS Mojave\r\n - Latest version (as of April 10, 2019)\r\n\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/654/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/654/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/621", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/621/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/621/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/621/events", "html_url": "https://github.com/flairNLP/flair/issues/621", "id": 423934180, "node_id": "MDU6SXNzdWU0MjM5MzQxODA=", "number": 621, "title": "Error when using allennlp fasttext", "user": {"login": "Cerebrock", "id": 20531340, "node_id": "MDQ6VXNlcjIwNTMxMzQw", "avatar_url": "https://avatars.githubusercontent.com/u/20531340?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Cerebrock", "html_url": "https://github.com/Cerebrock", "followers_url": "https://api.github.com/users/Cerebrock/followers", "following_url": "https://api.github.com/users/Cerebrock/following{/other_user}", "gists_url": "https://api.github.com/users/Cerebrock/gists{/gist_id}", "starred_url": "https://api.github.com/users/Cerebrock/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Cerebrock/subscriptions", "organizations_url": "https://api.github.com/users/Cerebrock/orgs", "repos_url": "https://api.github.com/users/Cerebrock/repos", "events_url": "https://api.github.com/users/Cerebrock/events{/privacy}", "received_events_url": "https://api.github.com/users/Cerebrock/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-03-21T20:46:35Z", "updated_at": "2020-04-30T10:56:15Z", "closed_at": "2020-04-30T10:56:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "Error when downloading 'sp' fasttext spanish embeddings from google colab.\r\n\r\n`OSError: HEAD request failed for url https://s3.eu-central-1.amazonaws.com/alan-nlp/resources/embeddings-v0.4/sp-wiki-fasttext-300d-1M.vectors.npy `", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/621/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/621/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/620", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/620/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/620/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/620/events", "html_url": "https://github.com/flairNLP/flair/issues/620", "id": 423808628, "node_id": "MDU6SXNzdWU0MjM4MDg2Mjg=", "number": 620, "title": "PooledFlairEmbeddings:  expected type torch.cuda.FloatTensor but got torch.FloatTensor", "user": {"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-03-21T15:58:36Z", "updated_at": "2019-03-24T13:49:29Z", "closed_at": "2019-03-24T13:49:29Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Hi,\r\n\r\nwhen loading a trained model with PooledFlairEmbeddings (on GPU), the following error message\r\nis thrown:\r\n\r\n```bash\r\nraceback (most recent call last):\r\n  File \"predict.py\", line 31, in <module>\r\n    tagger.predict(tagged_sentence)\r\n  File \"/mnt/flair/flair/models/sequence_tagger_model.py\", line 300, in predict\r\n    tags, _ = self.forward_labels_and_loss(batch, sort=False)\r\n  File \"/mnt/flair/flair/models/sequence_tagger_model.py\", line 268, in forward_labels_and_loss\r\n    feature, lengths, tags = self.forward(sentences, sort=sort)\r\n  File \"/mnt/flair/flair/models/sequence_tagger_model.py\", line 315, in forward\r\n    self.embeddings.embed(sentences)\r\n  File \"/mnt/flair/flair/embeddings.py\", line 130, in embed\r\n    embedding.embed(sentences)\r\n  File \"/mnt/flair/flair/embeddings.py\", line 63, in embed\r\n    self._add_embeddings_internal(sentences)\r\n  File \"/mnt/flair/flair/embeddings.py\", line 1031, in _add_embeddings_internal\r\n    aggregated_embedding = self.aggregate_op(self.word_embeddings[token.text], local_embedding)\r\nRuntimeError: expected type torch.cuda.FloatTensor but got torch.FloatTensor\r\n```\r\n\r\nTested with latest `master` (cf56e8413cae79707545f5eddf3a88c05810d0d3)", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/620/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/620/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/617", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/617/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/617/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/617/events", "html_url": "https://github.com/flairNLP/flair/issues/617", "id": 422669706, "node_id": "MDU6SXNzdWU0MjI2Njk3MDY=", "number": 617, "title": "Best model not saved during training", "user": {"login": "fstorme", "id": 34447671, "node_id": "MDQ6VXNlcjM0NDQ3Njcx", "avatar_url": "https://avatars.githubusercontent.com/u/34447671?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fstorme", "html_url": "https://github.com/fstorme", "followers_url": "https://api.github.com/users/fstorme/followers", "following_url": "https://api.github.com/users/fstorme/following{/other_user}", "gists_url": "https://api.github.com/users/fstorme/gists{/gist_id}", "starred_url": "https://api.github.com/users/fstorme/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fstorme/subscriptions", "organizations_url": "https://api.github.com/users/fstorme/orgs", "repos_url": "https://api.github.com/users/fstorme/repos", "events_url": "https://api.github.com/users/fstorme/events{/privacy}", "received_events_url": "https://api.github.com/users/fstorme/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-03-19T11:04:15Z", "updated_at": "2021-09-01T17:12:57Z", "closed_at": "2020-05-07T03:15:50Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, \r\n\r\nI'm training a NER tagger with BERT embeddings that are not fine tuned, and I don't use a CRF as the final classification layer. \r\nHere is my code:\r\n```python\r\nimport datetime\r\n\r\nfrom flair.embeddings import StackedEmbeddings, BertEmbeddings\r\nfrom flair.trainers import ModelTrainer\r\nfrom flair.models import SequenceTagger\r\nfrom flair.data_fetcher import NLPTaskDataFetcher, NLPTask\r\nfrom flair.data import TaggedCorpus\r\n\r\ncorpus: TaggedCorpus = NLPTaskDataFetcher.load_corpus(NLPTask.WIKINER_FRENCH).downsample(0.01)\r\n\r\ntag_type = 'ner'\r\ntag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\nembedding_types = [\r\n    BertEmbeddings('bert-base-multilingual-cased'),\r\n]\r\nembeddings: StackedEmbeddings = StackedEmbeddings(embeddings=embedding_types)\r\n\r\ntagger: SequenceTagger = SequenceTagger(embeddings=embeddings,\r\n                                        hidden_size=1,\r\n                                        tag_dictionary=tag_dictionary,\r\n                                        tag_type='ner',\r\n                                        # use CRF as classifier for NER task if false, it should use a simple classifier\r\n                                        use_crf=False,\r\n                                        # no LSTM layers between the embeddings and the CRF\r\n                                        use_rnn=False,\r\n                                        )\r\ntagger.relearn_embeddings = False  # if False, Embeddings are not retrained (no fine tunning)\r\n\r\ntrainer: ModelTrainer = ModelTrainer(tagger, corpus)\r\n\r\ndate_str = datetime.datetime.now().strftime(\"%Y-%m-%d_%H-%M-%S\")\r\ntrainer.num_workers = 8\r\ntrainer.train('resources/taggers/bert-lin-classifier-norelearn_'+date_str,\r\n              learning_rate=0.17,\r\n              mini_batch_size=64,\r\n              max_epochs=40,\r\n              )\r\n```\r\nNote that the `learning_rate=0.17` has been chosen using the optimization process in `ModelTrainer`.\r\nDuring training I get good enough results according to the `training.log` file:\r\n```\r\n2019-03-07 15:13:17,615 DEV  : loss 0.27856252 - f-score 0.6502 - acc 0.4818\r\n2019-03-07 15:13:58,377 TEST : loss 0.28655991 - f-score 0.6596 - acc 0.4920\r\n```\r\nHowever, at the end of the training I get: \r\n\r\n```\r\n2019-03-07 15:31:48,522 Testing using best model ...\r\n2019-03-07 15:31:48,523 loading file resources/taggers/bert-lin-classifier-norelearn_2019-03-07_10-20-51/best-model.pt\r\n2019-03-07 15:32:39,379 MICRO_AVG: acc 0.0 - f1-score 0.0\r\n2019-03-07 15:32:39,379 MACRO_AVG: acc 0.0 - f1-score 0.0\r\n2019-03-07 15:32:39,379 LOC        tp: 0 - fp: 5 - fn: 11616 - tn: 0 - precision: 0.0000 - recall: 0.0000 - accuracy: 0.0000 - f1-score: 0.0000\r\n2019-03-07 15:32:39,379 MISC       tp: 0 - fp: 0 - fn: 3839 - tn: 0 - precision: 0.0000 - recall: 0.0000 - accuracy: 0.0000 - f1-score: 0.0000\r\n2019-03-07 15:32:39,379 ORG        tp: 0 - fp: 0 - fn: 2568 - tn: 0 - precision: 0.0000 - recall: 0.0000 - accuracy: 0.0000 - f1-score: 0.0000\r\n2019-03-07 15:32:39,379 PER        tp: 0 - fp: 0 - fn: 7409 - tn: 0 - precision: 0.0000 - recall: 0.0000 - accuracy: 0.0000 - f1-score: 0.0000\r\n```\r\n\r\nSimilarly if I try another homemade script for the task:\r\n```python\r\nimport copy\r\n\r\nfrom flair.embeddings import WordEmbeddings, FlairEmbeddings, StackedEmbeddings, BertEmbeddings\r\nfrom flair.data import Sentence, Token, Label\r\nfrom flair.trainers import ModelTrainer\r\nfrom flair.training_utils import Metric\r\nfrom flair.models import SequenceTagger\r\nfrom flair.data_fetcher import NLPTaskDataFetcher, NLPTask\r\nfrom flair.data import TaggedCorpus\r\n\r\ncorpus : TaggedCorpus = NLPTaskDataFetcher.load_corpus(NLPTask.WIKINER_FRENCH)\r\ntagger = SequenceTagger.load_from_file(\r\n    'bert-lin-classifier-norelearn_2019-03-07_10-20-51/best-model.pt')\r\ntest_metric, test_loss = ModelTrainer.evaluate(tagger, corpus.test)\r\nprint(f'MICRO_AVG: acc {test_metric.micro_avg_accuracy()} - f1-score {test_metric.micro_avg_f_score()}')\r\nprint(f'MACRO_AVG: acc {test_metric.macro_avg_accuracy()} - f1-score {test_metric.macro_avg_f_score()}')\r\nfor class_name in test_metric.get_classes():\r\n    print(f'{class_name:<10} tp: {test_metric.get_tp(class_name)} - fp: {test_metric.get_fp(class_name)} - '\r\n                     f'fn: {test_metric.get_fn(class_name)} - tn: {test_metric.get_tn(class_name)} - precision: '\r\n                     f'{test_metric.precision(class_name):.4f} - recall: {test_metric.recall(class_name):.4f} - '\r\n                     f'accuracy: {test_metric.accuracy(class_name):.4f} - f1-score: '\r\n                     f'{test_metric.f_score(class_name):.4f}')\r\n```\r\nThe result is:\r\n```\r\nMICRO_AVG: acc 0.0 - f1-score 0.0\r\nMACRO_AVG: acc 0.0 - f1-score 0.0\r\nLOC        tp: 0 - fp: 5 - fn: 11745 - tn: 0 - precision: 0.0000 - recall: 0.0000 - accuracy: 0.0000 - f1-score: 0.0000\r\nMISC       tp: 0 - fp: 0 - fn: 3854 - tn: 0 - precision: 0.0000 - recall: 0.0000 - accuracy: 0.0000 - f1-score: 0.0000\r\nORG        tp: 0 - fp: 0 - fn: 2412 - tn: 0 - precision: 0.0000 - recall: 0.0000 - accuracy: 0.0000 - f1-score: 0.0000\r\nPER        tp: 0 - fp: 4 - fn: 7509 - tn: 0 - precision: 0.0000 - recall: 0.0000 - accuracy: 0.0000 - f1-score: 0.0000\r\n```\r\nHence I assume the best model is not saved.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/617/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/617/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/610", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/610/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/610/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/610/events", "html_url": "https://github.com/flairNLP/flair/issues/610", "id": 421676017, "node_id": "MDU6SXNzdWU0MjE2NzYwMTc=", "number": 610, "title": "Running predict on CPU using ELMo Embeddings", "user": {"login": "pvcastro", "id": 12713359, "node_id": "MDQ6VXNlcjEyNzEzMzU5", "avatar_url": "https://avatars.githubusercontent.com/u/12713359?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pvcastro", "html_url": "https://github.com/pvcastro", "followers_url": "https://api.github.com/users/pvcastro/followers", "following_url": "https://api.github.com/users/pvcastro/following{/other_user}", "gists_url": "https://api.github.com/users/pvcastro/gists{/gist_id}", "starred_url": "https://api.github.com/users/pvcastro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pvcastro/subscriptions", "organizations_url": "https://api.github.com/users/pvcastro/orgs", "repos_url": "https://api.github.com/users/pvcastro/repos", "events_url": "https://api.github.com/users/pvcastro/events{/privacy}", "received_events_url": "https://api.github.com/users/pvcastro/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": {"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-03-15T19:40:19Z", "updated_at": "2020-06-17T17:31:42Z", "closed_at": "2020-06-17T17:31:42Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "I'm trying to run predict in a trained model using CPU device. I set flair.device to CPU as described [here](https://github.com/zalandoresearch/flair/issues/464):\r\n\r\nAnd then I tried to force the model's embeddings to use CPU, similar to what is suggested [here](https://github.com/zalandoresearch/flair/issues/421). Here is the error I got:\r\n\r\n> Traceback (most recent call last):\r\n  File \"/home/pedro/repositorios/flair/script.py\", line 29, in <module>\r\n    sentences = predict_all_sentences()\r\n  File \"/home/pedro/repositorios/flair/script.py\", line 25, in predict_all_sentences\r\n    return tagger.predict(corpus.get_all_sentences())\r\n  File \"/home/pedro/repositorios/flair/flair/models/sequence_tagger_model.py\", line 300, in predict\r\n    tags, _ = self.forward_labels_and_loss(batch, sort=False)\r\n  File \"/home/pedro/repositorios/flair/flair/models/sequence_tagger_model.py\", line 268, in forward_labels_and_loss\r\n    feature, lengths, tags = self.forward(sentences, sort=sort)\r\n  File \"/home/pedro/repositorios/flair/flair/models/sequence_tagger_model.py\", line 315, in forward\r\n    self.embeddings.embed(sentences)\r\n  File \"/home/pedro/repositorios/flair/flair/embeddings.py\", line 130, in embed\r\n    embedding.embed(sentences)\r\n  File \"/home/pedro/repositorios/flair/flair/embeddings.py\", line 63, in embed\r\n    self._add_embeddings_internal(sentences)\r\n  File \"/home/pedro/repositorios/flair/flair/embeddings.py\", line 399, in _add_embeddings_internal\r\n    embeddings = self.ee.embed_batch(sentence_words)\r\n  File \"/home/pedro/anaconda3/envs/flair/lib/python3.6/site-packages/allennlp/commands/elmo.py\", line 244, in embed_batch\r\n    embeddings, mask = self.batch_to_embeddings(batch)\r\n  File \"/home/pedro/anaconda3/envs/flair/lib/python3.6/site-packages/allennlp/commands/elmo.py\", line 186, in batch_to_embeddings\r\n    bilm_output = self.elmo_bilm(character_ids)\r\n  File \"/home/pedro/anaconda3/envs/flair/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 489, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/pedro/anaconda3/envs/flair/lib/python3.6/site-packages/allennlp/modules/elmo.py\", line 605, in forward\r\n    token_embedding = self._token_embedder(inputs)\r\n  File \"/home/pedro/anaconda3/envs/flair/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 489, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/home/pedro/anaconda3/envs/flair/lib/python3.6/site-packages/allennlp/modules/elmo.py\", line 357, in forward\r\n    self._char_embedding_weights\r\n  File \"/home/pedro/anaconda3/envs/flair/lib/python3.6/site-packages/torch/nn/functional.py\", line 1454, in embedding\r\n    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)\r\nRuntimeError: Expected object of backend CPU but got backend CUDA for argument #3 'index'\r\n\r\nHere is the code:\r\n\r\n```\r\nflair.device = torch.device('cpu')\r\n\r\ncorpus: TaggedCorpus = NLPTaskDataFetcher.load_column_corpus(...)\r\n\r\ntagger = SequenceTagger.load_from_file('/models/flair/ner-pt-flair-elmo/best-model.pt')\r\ntagger.embeddings.cpu()\r\n\r\ndef predict_all_sentences():\r\n    return tagger.predict(corpus.get_all_sentences())\r\n\r\nif __name__ == '__main__':\r\n    sentences = predict_all_sentences()\r\n    for sentence in sentences:\r\n        print(sentence)\r\n```\r\n\r\n - OS Linux\r\n - Version flair-0.4.1\r\n\r\nThe same code works for models trained using only FlairEmbeddings, even without the need of specifying `tagger.embeddings.cpu()`. My guess is that it's necessary to do something else to ELMo in order to force it using CPU, but I'm not sure what could it be.\r\n\r\nThanks!", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/610/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/610/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/605", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/605/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/605/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/605/events", "html_url": "https://github.com/flairNLP/flair/issues/605", "id": 419074107, "node_id": "MDU6SXNzdWU0MTkwNzQxMDc=", "number": 605, "title": "TextClassifier label predictions always have score 1.0", "user": {"login": "algomaks", "id": 1804640, "node_id": "MDQ6VXNlcjE4MDQ2NDA=", "avatar_url": "https://avatars.githubusercontent.com/u/1804640?v=4", "gravatar_id": "", "url": "https://api.github.com/users/algomaks", "html_url": "https://github.com/algomaks", "followers_url": "https://api.github.com/users/algomaks/followers", "following_url": "https://api.github.com/users/algomaks/following{/other_user}", "gists_url": "https://api.github.com/users/algomaks/gists{/gist_id}", "starred_url": "https://api.github.com/users/algomaks/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/algomaks/subscriptions", "organizations_url": "https://api.github.com/users/algomaks/orgs", "repos_url": "https://api.github.com/users/algomaks/repos", "events_url": "https://api.github.com/users/algomaks/events{/privacy}", "received_events_url": "https://api.github.com/users/algomaks/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2019-03-09T13:56:27Z", "updated_at": "2019-04-21T00:28:16Z", "closed_at": "2019-04-16T09:14:22Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Hi guys,\r\n\r\nI have trained my own TextClassifier following this tutorial: https://github.com/zalandoresearch/flair/blob/master/resources/docs/TUTORIAL_7_TRAINING_A_MODEL.md\r\n\r\nI am using the option multi_label=False, as each sentence should be assigned only one label. In terms of embeddings, I use FlairEmbeddings mix-forward and mix-backward. \r\n\r\nThe issue is that every time I predict the label of a new unseen sentence, I get a label score = 1.0. It seems that it never has any different value between 0.0 and 1.0. It is always 1.0. \r\n\r\nIs this the expected behavior? What am I doing wrong?\r\n\r\nThanks!", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/605/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/605/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/600", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/600/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/600/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/600/events", "html_url": "https://github.com/flairNLP/flair/issues/600", "id": 418722531, "node_id": "MDU6SXNzdWU0MTg3MjI1MzE=", "number": 600, "title": "Loading embeddings fails when using futures and process pool in 0.4.1", "user": {"login": "davechallis", "id": 208316, "node_id": "MDQ6VXNlcjIwODMxNg==", "avatar_url": "https://avatars.githubusercontent.com/u/208316?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davechallis", "html_url": "https://github.com/davechallis", "followers_url": "https://api.github.com/users/davechallis/followers", "following_url": "https://api.github.com/users/davechallis/following{/other_user}", "gists_url": "https://api.github.com/users/davechallis/gists{/gist_id}", "starred_url": "https://api.github.com/users/davechallis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davechallis/subscriptions", "organizations_url": "https://api.github.com/users/davechallis/orgs", "repos_url": "https://api.github.com/users/davechallis/repos", "events_url": "https://api.github.com/users/davechallis/events{/privacy}", "received_events_url": "https://api.github.com/users/davechallis/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-03-08T10:17:31Z", "updated_at": "2020-05-07T03:15:45Z", "closed_at": "2020-05-07T03:15:45Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\n\r\nWhen attempting to load Flair embeddings in multiple processes (using `concurrent.futures.ProcessPoolExecutor`), it worked fine in `0.4.0`, but fails with errors in `0.4.1`.\r\n\r\n**To Reproduce**\r\n\r\nSample script:\r\n\r\n    from concurrent import futures\r\n    import flair\r\n    from flair.embeddings import FlairEmbeddings\r\n\r\n    def load_embeddings():\r\n        return str(FlairEmbeddings('news-forward-fast'))\r\n\r\n    with futures.ProcessPoolExecutor(max_workers=1) as executor:\r\n        all_futures = [executor.submit(load_embeddings) for _ in range(2)]\r\n\r\n        for future in futures.as_completed(all_futures):\r\n            print(future.result())\r\n\r\n**Expected behavior**\r\n\r\nIn `0.4.0`, this prints the path to the loaded model twice, e.g.:\r\n\r\n    /home/dsc/.flair/embeddings/lm-news-english-forward-1024-v0.2rc.pt\r\n    /home/dsc/.flair/embeddings/lm-news-english-forward-1024-v0.2rc.pt\r\n  \r\nIn `0.4.1` this instead results in the following error:\r\n\r\n```\r\nTHCudaCheck FAIL file=/pytorch/torch/csrc/cuda/Module.cpp line=53 error=3 : initialization error\r\nconcurrent.futures.process._RemoteTraceback:\r\n\"\"\"\r\nTraceback (most recent call last):\r\n  File \"/home/dsc/miniconda3/envs/cc/lib/python3.7/concurrent/futures/process.py\", line 232, in _process_worker\r\n    r = call_item.fn(*call_item.args, **call_item.kwargs)\r\n  File \"/tmp/t.py\", line 8, in load_embeddings\r\n    emb = FlairEmbeddings('news-forward-fast')\r\n  File \"/home/dsc/miniconda3/envs/cc/lib/python3.7/site-packages/flair/embeddings.py\", line 835, in __init__\r\n    self.lm = LanguageModel.load_language_model(model)\r\n  File \"/home/dsc/miniconda3/envs/cc/lib/python3.7/site-packages/flair/models/language_model.py\", line 152, in load_language_model\r\n    state = torch.load(str(model_file), map_location=flair.device)\r\n  File \"/home/dsc/miniconda3/envs/cc/lib/python3.7/site-packages/torch/serialization.py\", line 367, in load\r\n    return _load(f, map_location, pickle_module)\r\n  File \"/home/dsc/miniconda3/envs/cc/lib/python3.7/site-packages/torch/serialization.py\", line 538, in _load\r\n    result = unpickler.load()\r\n  File \"/home/dsc/miniconda3/envs/cc/lib/python3.7/site-packages/torch/serialization.py\", line 504, in persistent_load\r\n    data_type(size), location)\r\n  File \"/home/dsc/miniconda3/envs/cc/lib/python3.7/site-packages/torch/serialization.py\", line 387, in restore_location\r\n    return default_restore_location(storage, str(map_location))\r\n  File \"/home/dsc/miniconda3/envs/cc/lib/python3.7/site-packages/torch/serialization.py\", line 113, in default_restore_location\r\n    result = fn(storage, location)\r\n  File \"/home/dsc/miniconda3/envs/cc/lib/python3.7/site-packages/torch/serialization.py\", line 95, in _cuda_deserialize\r\n    return obj.cuda(device)\r\n  File \"/home/dsc/miniconda3/envs/cc/lib/python3.7/site-packages/torch/_utils.py\", line 68, in _cuda\r\n    with torch.cuda.device(device):\r\n  File \"/home/dsc/miniconda3/envs/cc/lib/python3.7/site-packages/torch/cuda/__init__.py\", line 226, in __enter__\r\n    self.prev_idx = torch._C._cuda_getDevice()\r\nRuntimeError: cuda runtime error (3) : initialization error at /pytorch/torch/csrc/cuda/Module.cpp:53\r\n\"\"\"\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/tmp/t.py\", line 15, in <module>\r\n    print(future.result())\r\n  File \"/home/dsc/miniconda3/envs/cc/lib/python3.7/concurrent/futures/_base.py\", line 425, in result\r\n    return self.__get_result()\r\n  File \"/home/dsc/miniconda3/envs/cc/lib/python3.7/concurrent/futures/_base.py\", line 384, in __get_result\r\n    raise self._exception\r\nRuntimeError: cuda runtime error (3) : initialization error at /pytorch/torch/csrc/cuda/Module.cpp:53\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - Ubuntu linux 18.04\r\n - Flair 0.4.1\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/600/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/600/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/599", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/599/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/599/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/599/events", "html_url": "https://github.com/flairNLP/flair/issues/599", "id": 418713632, "node_id": "MDU6SXNzdWU0MTg3MTM2MzI=", "number": 599, "title": "Shape of document pool embedding changed between 0.4.0 and 0.4.1", "user": {"login": "davechallis", "id": 208316, "node_id": "MDQ6VXNlcjIwODMxNg==", "avatar_url": "https://avatars.githubusercontent.com/u/208316?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davechallis", "html_url": "https://github.com/davechallis", "followers_url": "https://api.github.com/users/davechallis/followers", "following_url": "https://api.github.com/users/davechallis/following{/other_user}", "gists_url": "https://api.github.com/users/davechallis/gists{/gist_id}", "starred_url": "https://api.github.com/users/davechallis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davechallis/subscriptions", "organizations_url": "https://api.github.com/users/davechallis/orgs", "repos_url": "https://api.github.com/users/davechallis/repos", "events_url": "https://api.github.com/users/davechallis/events{/privacy}", "received_events_url": "https://api.github.com/users/davechallis/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-03-08T09:54:39Z", "updated_at": "2019-04-16T06:44:22Z", "closed_at": "2019-04-16T06:44:22Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "The pooled embedding shape for a sentence changed between 0.4.0 and 0.4.1 of flair, though it's not clear if this was intentional or not.\r\n\r\nFor a document pool embedding with a single model, a 2D array was returned in 0.4.0, whereas a 1D array is returned in 0.4.1.\r\n\r\nSample code:\r\n\r\n    import flair\r\n    from flair.embeddings import FlairEmbeddings, DocumentPoolEmbeddings, Sentence\r\n    \r\n    flair_embedding_forward = FlairEmbeddings('news-forward-fast')\r\n    doc_pool_embeddings = DocumentPoolEmbeddings([flair_embedding_forward])\r\n    sent = Sentence('The quick brown fox.')\r\n    doc_pool_embeddings.embed(sent)\r\n    print(sent.get_embedding().shape)\r\n\r\nIn flair 0.4.0 this prints:\r\n\r\n    torch.Size([1, 1024])\r\n\r\nIn flair 0.4.1 this prints:\r\n\r\n    torch.Size([1024])\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/599/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/599/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/594", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/594/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/594/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/594/events", "html_url": "https://github.com/flairNLP/flair/issues/594", "id": 417578599, "node_id": "MDU6SXNzdWU0MTc1Nzg1OTk=", "number": 594, "title": " Model name 'bert-base-chinese' was not found in model name list.", "user": {"login": "Das-Boot", "id": 25773391, "node_id": "MDQ6VXNlcjI1NzczMzkx", "avatar_url": "https://avatars.githubusercontent.com/u/25773391?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Das-Boot", "html_url": "https://github.com/Das-Boot", "followers_url": "https://api.github.com/users/Das-Boot/followers", "following_url": "https://api.github.com/users/Das-Boot/following{/other_user}", "gists_url": "https://api.github.com/users/Das-Boot/gists{/gist_id}", "starred_url": "https://api.github.com/users/Das-Boot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Das-Boot/subscriptions", "organizations_url": "https://api.github.com/users/Das-Boot/orgs", "repos_url": "https://api.github.com/users/Das-Boot/repos", "events_url": "https://api.github.com/users/Das-Boot/events{/privacy}", "received_events_url": "https://api.github.com/users/Das-Boot/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-03-06T01:24:04Z", "updated_at": "2019-03-09T16:23:10Z", "closed_at": "2019-03-09T16:23:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Description**\r\nWhen I use BertEmbeddings:\r\n\r\n`from flair.embeddings import BertEmbeddings`\r\n`embedding = BertEmbeddings('bert-base-chinese')`\r\n\r\nI find that BertEmbeddings('bert-base-chinese') has an error:\r\n\r\n> Model name 'bert-base-chinese' was not found in model name list (bert-base-uncased, bert-large-uncased, bert-base-cased, bert-large-cased, bert-base-multilingual-uncased, bert-base-multilingual-cased, bert-base-chinese). We assumed 'https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-chinese.tar.gz' was a path or url but couldn't find any file associated to this path or url.\r\n\r\n\r\n**Environment**\r\n - OS [Ubuntu 18.04.2]\r\n - Version [flair-0.4.1 Python-3.6.7]:\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/594/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/594/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/592", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/592/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/592/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/592/events", "html_url": "https://github.com/flairNLP/flair/issues/592", "id": 417280125, "node_id": "MDU6SXNzdWU0MTcyODAxMjU=", "number": 592, "title": "Permission error after downloading models on Windows 10", "user": {"login": "kevin91nl", "id": 3481474, "node_id": "MDQ6VXNlcjM0ODE0NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3481474?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kevin91nl", "html_url": "https://github.com/kevin91nl", "followers_url": "https://api.github.com/users/kevin91nl/followers", "following_url": "https://api.github.com/users/kevin91nl/following{/other_user}", "gists_url": "https://api.github.com/users/kevin91nl/gists{/gist_id}", "starred_url": "https://api.github.com/users/kevin91nl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kevin91nl/subscriptions", "organizations_url": "https://api.github.com/users/kevin91nl/orgs", "repos_url": "https://api.github.com/users/kevin91nl/repos", "events_url": "https://api.github.com/users/kevin91nl/events{/privacy}", "received_events_url": "https://api.github.com/users/kevin91nl/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-03-05T12:43:32Z", "updated_at": "2020-05-07T03:15:51Z", "closed_at": "2020-05-07T03:15:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhen downloading models/embeddings to disk on Windows 10, a PermissionError is thrown.\r\n\r\n**To Reproduce**\r\nInstall FLAIR and Cython:\r\n```\r\npip install Cython\r\npip install flair\r\n```\r\n\r\nRunning the following code (in a Jupyter Lab environment):\r\n```\r\nfrom flair.embeddings import WordEmbeddings\r\nglove_embedding = WordEmbeddings('glove')\r\n```\r\n\r\n**Expected behavior**\r\nA successful download of the GloVe embeddings. However, it throws a PermissionError after downloading the file:\r\n\r\n```\r\nPermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\\\Users\\\\my-username\\\\AppData\\\\Local\\\\Temp\\\\tmpdd72vob1'\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Windows\r\n - Version [e.g. flair-0.3.2]: 10", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/592/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/592/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/586", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/586/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/586/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/586/events", "html_url": "https://github.com/flairNLP/flair/issues/586", "id": 416647863, "node_id": "MDU6SXNzdWU0MTY2NDc4NjM=", "number": 586, "title": "Character Embeddings <= 0 ", "user": {"login": "pertschuk", "id": 6379823, "node_id": "MDQ6VXNlcjYzNzk4MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/6379823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pertschuk", "html_url": "https://github.com/pertschuk", "followers_url": "https://api.github.com/users/pertschuk/followers", "following_url": "https://api.github.com/users/pertschuk/following{/other_user}", "gists_url": "https://api.github.com/users/pertschuk/gists{/gist_id}", "starred_url": "https://api.github.com/users/pertschuk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pertschuk/subscriptions", "organizations_url": "https://api.github.com/users/pertschuk/orgs", "repos_url": "https://api.github.com/users/pertschuk/repos", "events_url": "https://api.github.com/users/pertschuk/events{/privacy}", "received_events_url": "https://api.github.com/users/pertschuk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-03-04T06:16:30Z", "updated_at": "2019-05-27T15:15:53Z", "closed_at": "2019-05-27T15:15:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "Running into a Pytorch issue telling me that a PackedSequence has length <= 0 when training with custom Gensim 200-dim embeddings stacked with CharacterEmbeddings. Maybe related to this? https://github.com/pytorch/pytorch/issues/4582\r\n\r\n```\r\nFile \"/home/poloma/.local/lib/python3.6/site-packages/flair/trainers/trainer.p                                                                     p\r\ny\", line 150, in train\r\n    loss = self.model.forward_loss(batch)\r\n  File \"/home/poloma/.local/lib/python3.6/site-packages/flair/models/sequence_ta                                                                     a\r\ngger_model.py\", line 262, in forward_loss\r\n    features, lengths, tags = self.forward(sentences, sort=sort)\r\n  File \"/home/poloma/.local/lib/python3.6/site-packages/flair/models/sequence_ta                                                                     a\r\ngger_model.py\", line 315, in forward\r\n    self.embeddings.embed(sentences)\r\n  File \"/home/poloma/.local/lib/python3.6/site-packages/flair/embeddings.py\", li                                                                ne 130, in embed\r\n    embedding.embed(sentences)\r\n  File \"/home/poloma/.local/lib/python3.6/site-packages/flair/embeddings.py\", li                                                                     i\r\nne 63, in embed\r\n    self._add_embeddings_internal(sentences)\r\n  File \"/home/poloma/.local/lib/python3.6/site-packages/flair/embeddings.py\", li                                                                     i\r\nne 611, in _add_embeddings_internal\r\n    packed = torch.nn.utils.rnn.pack_padded_sequence(character_embeddings,chars                                                                     s\r\n2_length)\r\n  File \"/home/poloma/.local/lib/python3.6/site-packages/torch/nn/utils/rnn.py\",\r\nline 148, in pack_padded_sequence\r\n    return PackedSequence(torch._C._VariableFunctions._pack_padded_sequence(inpu                                                                     u\r\nt, lengths, batch_first))\r\nRuntimeError: Length of all samples has to be greater than 0, but found aneleme                                                                    e\r\nnt in 'lengths' that is <= 0\r\n```\r\n\r\n**To Reproduce**\r\n ```\r\ncolumns = {0: 'text', 1: 'pos', 2: 'ner'}\r\n\r\n    # this is the folder in which train, test and dev files reside\r\n    data_folder = '.'\r\n\r\n    # retrieve corpus using column format, data folder and the names of the train, dev and test files\r\n    corpus = NLPTaskDataFetcher.load_column_corpus(data_folder, columns,\r\n        train_file='train.txt',\r\n        test_file='test.txt',\r\n        dev_file='dev.txt')\r\n\r\n    corpus.train = [sentence for sentence in corpus.train if len(sentence) > 0]\r\n    corpus.test = [sentence for sentence in corpus.test if len(sentence) > 0]\r\n    corpus.dev = [sentence for sentence in corpus.dev if len(sentence) > 0]\r\n\r\n    custom_embedding = WordEmbeddings('pubmed.gensim')\r\n\r\n    character_embeddings = CharacterEmbeddings()\r\n    stacked_embeddings = StackedEmbeddings(\r\n        embeddings=[custom_embedding, character_embeddings])\r\n\r\n    # just embed a sentence using the StackedEmbedding as you would with any single embedding.\r\n    # stacked_embeddings.embed(sentence)\r\n    tag_dictionary = corpus.make_tag_dictionary(tag_type='ner')\r\n    \r\n    tagger = SequenceTagger(hidden_size=256,\r\n        embeddings=stacked_embeddings,\r\n        tag_dictionary=tag_dictionary,\r\n        tag_type='ner',\r\n        use_crf=True)\r\n\r\n    trainer = ModelTrainer(tagger, corpus)\r\n    trainer.train('ner-model/',\r\n              learning_rate=0.1,\r\n              mini_batch_size=32,\r\n              max_epochs=150)\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS Ubuntu\r\n - Version flair-0.4.1\r\n\r\n**Additional context**\r\nUsing a custom corpus. ", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/586/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/586/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/584", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/584/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/584/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/584/events", "html_url": "https://github.com/flairNLP/flair/issues/584", "id": 416489548, "node_id": "MDU6SXNzdWU0MTY0ODk1NDg=", "number": 584, "title": "one redundant code line", "user": {"login": "cy69855522", "id": 33852040, "node_id": "MDQ6VXNlcjMzODUyMDQw", "avatar_url": "https://avatars.githubusercontent.com/u/33852040?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cy69855522", "html_url": "https://github.com/cy69855522", "followers_url": "https://api.github.com/users/cy69855522/followers", "following_url": "https://api.github.com/users/cy69855522/following{/other_user}", "gists_url": "https://api.github.com/users/cy69855522/gists{/gist_id}", "starred_url": "https://api.github.com/users/cy69855522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cy69855522/subscriptions", "organizations_url": "https://api.github.com/users/cy69855522/orgs", "repos_url": "https://api.github.com/users/cy69855522/repos", "events_url": "https://api.github.com/users/cy69855522/events{/privacy}", "received_events_url": "https://api.github.com/users/cy69855522/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-03-03T08:24:08Z", "updated_at": "2019-03-04T15:18:30Z", "closed_at": "2019-03-04T15:18:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "in TextClassifier class\r\n`\r\n34 self.document_embeddings = document_embeddings\r\n`\r\n`\r\n38 self.document_embeddings: flair.embeddings.DocumentLSTMEmbeddings = document_embeddings\r\n`", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/584/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/584/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/581", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/581/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/581/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/581/events", "html_url": "https://github.com/flairNLP/flair/issues/581", "id": 416453202, "node_id": "MDU6SXNzdWU0MTY0NTMyMDI=", "number": 581, "title": "Custom word vectors get wrong mapping", "user": {"login": "cy69855522", "id": 33852040, "node_id": "MDQ6VXNlcjMzODUyMDQw", "avatar_url": "https://avatars.githubusercontent.com/u/33852040?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cy69855522", "html_url": "https://github.com/cy69855522", "followers_url": "https://api.github.com/users/cy69855522/followers", "following_url": "https://api.github.com/users/cy69855522/following{/other_user}", "gists_url": "https://api.github.com/users/cy69855522/gists{/gist_id}", "starred_url": "https://api.github.com/users/cy69855522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cy69855522/subscriptions", "organizations_url": "https://api.github.com/users/cy69855522/orgs", "repos_url": "https://api.github.com/users/cy69855522/repos", "events_url": "https://api.github.com/users/cy69855522/events{/privacy}", "received_events_url": "https://api.github.com/users/cy69855522/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-03-02T23:22:11Z", "updated_at": "2019-03-03T00:29:15Z", "closed_at": "2019-03-03T00:29:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "`model = gensim.models.KeyedVectors.load_word2vec_format('/home/chenyu/Documents/Tencent_AILab_ChineseEmbedding.txt', binary=False)\r\n`\r\nmodel['\u4f60\u597d']\r\n`\r\narray([-8.62390e-02, -1.45830e-01, -1.80164e-01,  2.42631e-01,\r\n        1.98309e-01,  6.81110e-02, \u2026\u2026])\r\n\r\n`model.save('/home/chenyu/Documents/Tencent_AILab_ChineseEmbedding')\r\n`\r\ntencent_embeddings = WordEmbeddings('/home/chenyu/Documents/Tencent_AILab_ChineseEmbedding')\r\n`\r\nsentence = Sentence('\u4f60\u597d \u554a \u54c8\u54c8\u54c8 hh \u54c8\u54c8')\r\n`\r\ntencent_embeddings.embed(sentence)\r\n`\r\nprint(sentence.get_embedding())\r\n`\r\n tensor([])\r\n\r\nhttps://ai.tencent.com/ailab/nlp/embedding.html", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/581/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/581/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/577", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/577/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/577/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/577/events", "html_url": "https://github.com/flairNLP/flair/issues/577", "id": 416298520, "node_id": "MDU6SXNzdWU0MTYyOTg1MjA=", "number": 577, "title": "Tutorial 8 code error", "user": {"login": "cy69855522", "id": 33852040, "node_id": "MDQ6VXNlcjMzODUyMDQw", "avatar_url": "https://avatars.githubusercontent.com/u/33852040?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cy69855522", "html_url": "https://github.com/cy69855522", "followers_url": "https://api.github.com/users/cy69855522/followers", "following_url": "https://api.github.com/users/cy69855522/following{/other_user}", "gists_url": "https://api.github.com/users/cy69855522/gists{/gist_id}", "starred_url": "https://api.github.com/users/cy69855522/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cy69855522/subscriptions", "organizations_url": "https://api.github.com/users/cy69855522/orgs", "repos_url": "https://api.github.com/users/cy69855522/repos", "events_url": "https://api.github.com/users/cy69855522/events{/privacy}", "received_events_url": "https://api.github.com/users/cy69855522/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-03-01T22:08:08Z", "updated_at": "2019-05-27T16:45:12Z", "closed_at": "2019-05-27T16:45:12Z", "author_association": "NONE", "active_lock_reason": null, "body": "tutorial 8\r\n\r\ntrainer: ModelTrainer = ModelTrainer(tagger, corpus,\r\n                                     optimizer=Adam, weight_decay=1e-4)\r\n\u2193 (Am I wrong? 0 0)\r\ntrainer: ModelTrainer = ModelTrainer(tagger, corpus,\r\n                                     optimizer=Adam)\r\ntrainer.train(\u2026\u2026, weight_decay=1e-4)", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/577/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/577/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/575", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/575/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/575/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/575/events", "html_url": "https://github.com/flairNLP/flair/issues/575", "id": 415899397, "node_id": "MDU6SXNzdWU0MTU4OTkzOTc=", "number": 575, "title": "About the ValueError: Token indices sequence length is longer than the specified maximum sequence length", "user": {"login": "aslicedbread", "id": 24585324, "node_id": "MDQ6VXNlcjI0NTg1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/24585324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aslicedbread", "html_url": "https://github.com/aslicedbread", "followers_url": "https://api.github.com/users/aslicedbread/followers", "following_url": "https://api.github.com/users/aslicedbread/following{/other_user}", "gists_url": "https://api.github.com/users/aslicedbread/gists{/gist_id}", "starred_url": "https://api.github.com/users/aslicedbread/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aslicedbread/subscriptions", "organizations_url": "https://api.github.com/users/aslicedbread/orgs", "repos_url": "https://api.github.com/users/aslicedbread/repos", "events_url": "https://api.github.com/users/aslicedbread/events{/privacy}", "received_events_url": "https://api.github.com/users/aslicedbread/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-03-01T01:28:14Z", "updated_at": "2020-06-10T09:50:27Z", "closed_at": "2020-06-10T09:50:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi~\r\nI recently used Flair to tag the electronic chinese medical records. And every record is a long text but less than 1000 characters. I found that Flair based on BERT has a limit on the length of the input sequence:\r\n\r\n> ValueError: Token indices sequence length is longer than the specified maximum  sequence length for this BERT model (613 > 512). Running this sequence through BERT will result in indexing errors.\r\n\r\nIs there a solution?\r\nHope to get your reply, Thanks.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/575/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/575/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/565", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/565/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/565/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/565/events", "html_url": "https://github.com/flairNLP/flair/issues/565", "id": 413950131, "node_id": "MDU6SXNzdWU0MTM5NTAxMzE=", "number": 565, "title": "[BUG] A clear Exception/Error message must be thrown while trying to create a Sentence object from an empty string", "user": {"login": "Bharat123rox", "id": 13381361, "node_id": "MDQ6VXNlcjEzMzgxMzYx", "avatar_url": "https://avatars.githubusercontent.com/u/13381361?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Bharat123rox", "html_url": "https://github.com/Bharat123rox", "followers_url": "https://api.github.com/users/Bharat123rox/followers", "following_url": "https://api.github.com/users/Bharat123rox/following{/other_user}", "gists_url": "https://api.github.com/users/Bharat123rox/gists{/gist_id}", "starred_url": "https://api.github.com/users/Bharat123rox/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Bharat123rox/subscriptions", "organizations_url": "https://api.github.com/users/Bharat123rox/orgs", "repos_url": "https://api.github.com/users/Bharat123rox/repos", "events_url": "https://api.github.com/users/Bharat123rox/events{/privacy}", "received_events_url": "https://api.github.com/users/Bharat123rox/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-02-25T06:17:53Z", "updated_at": "2019-03-04T10:26:16Z", "closed_at": "2019-03-04T10:26:16Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nIf one tries to create a `Sentence` object from an empty string, an `UnboundLocalError` of the `index` variable is thrown\r\n\r\n**To Reproduce**\r\n```python3\r\n>>> from flair.data import Sentence\r\n>>> s = ''\r\n>>> Sentence(s)\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"C:\\Users\\XYZ\\AppData\\Local\\Programs\\Python\\Python36\\lib\\site-packages\\flair\\data.py\", line 338, in __init__\r\n    index += 1\r\nUnboundLocalError: local variable 'index' referenced before assignment\r\n```\r\n\r\n**Expected behavior**\r\nSomething like `ValueError: Cannot create a Sentence object from an empty string` or some `Error` or `Exception` mentioning that the string is empty or a `Sentence object \"\" - 0 tokens`\r\n\r\n**Environment (please complete the following information):**\r\n   I feel this is applicable to any OS/version, but anyway:\r\n - Windows 10\r\n - flair-0.4.1\r\n - Python 3.6.8\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/565/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/565/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/558", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/558/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/558/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/558/events", "html_url": "https://github.com/flairNLP/flair/issues/558", "id": 413744181, "node_id": "MDU6SXNzdWU0MTM3NDQxODE=", "number": 558, "title": "Sqlitedict hangs forever when loading Flair Embeddings", "user": {"login": "pjtinker", "id": 9274728, "node_id": "MDQ6VXNlcjkyNzQ3Mjg=", "avatar_url": "https://avatars.githubusercontent.com/u/9274728?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pjtinker", "html_url": "https://github.com/pjtinker", "followers_url": "https://api.github.com/users/pjtinker/followers", "following_url": "https://api.github.com/users/pjtinker/following{/other_user}", "gists_url": "https://api.github.com/users/pjtinker/gists{/gist_id}", "starred_url": "https://api.github.com/users/pjtinker/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pjtinker/subscriptions", "organizations_url": "https://api.github.com/users/pjtinker/orgs", "repos_url": "https://api.github.com/users/pjtinker/repos", "events_url": "https://api.github.com/users/pjtinker/events{/privacy}", "received_events_url": "https://api.github.com/users/pjtinker/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-02-23T21:42:27Z", "updated_at": "2019-02-24T14:34:26Z", "closed_at": "2019-02-24T14:34:25Z", "author_association": "NONE", "active_lock_reason": null, "body": "When attempting to load any of the Flair Embeddings, the system hangs indefinitely.\r\n\r\n```Python 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34)\r\n[GCC 7.3.0] on linux\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> from flair.embeddings import FlairEmbeddings\r\n>>> fnf = FlairEmbeddings('news-forward')\r\n^CTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/home/miniconda3/envs/flair/lib/python3.6/site-packages/flair/embeddings.py\", line 576, in __init__\r\n    self.cache = SqliteDict(str(cache_path), autocommit=True)\r\n  File \"/home/miniconda3/envs/flair/lib/python3.6/site-packages/sqlitedict.py\", line 175, in __init__\r\n    self.conn.commit()\r\n  File \"/homeminiconda3/envs/flair/lib/python3.6/site-packages/sqlitedict.py\", line 525, in commit\r\n    self.select_one('--commit--')\r\n  File \"/home/miniconda3/envs/flair/lib/python3.6/site-packages/sqlitedict.py\", line 515, in select_one\r\n    return next(iter(self.select(req, arg)))\r\n  File \"/home/miniconda3/envs/flair/lib/python3.6/site-packages/sqlitedict.py\", line 506, in select\r\n    rec = res.get()\r\n  File \"/home/miniconda3/envs/flair/lib/python3.6/queue.py\", line 164, in get\r\n    self.not_empty.wait()\r\n  File \"/home/miniconda3/envs/flair/lib/python3.6/threading.py\", line 295, in wait\r\n    waiter.acquire()\r\nKeyboardInterrupt\r\n>>> exit()\r\n```\r\nOther embeddings such as Glove and BERT load with no issues.\r\n\r\n**To Reproduce**\r\n`from flair.embeddings import FlairEmbeddings\r\nembedding = FlairEmbeddings('news-forward')`\r\n\r\n\r\n\r\n**Environment:**\r\n - CentOS 7\r\n - Flair 0.4.0\r\n - Torch 1.0.0\r\n - Python 3.6.8\r\n - Sqlitedict 1.6.0\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/558/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/558/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/554", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/554/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/554/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/554/events", "html_url": "https://github.com/flairNLP/flair/issues/554", "id": 413277123, "node_id": "MDU6SXNzdWU0MTMyNzcxMjM=", "number": 554, "title": "Custom Bert model is not working", "user": {"login": "adich23", "id": 6168788, "node_id": "MDQ6VXNlcjYxNjg3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/6168788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adich23", "html_url": "https://github.com/adich23", "followers_url": "https://api.github.com/users/adich23/followers", "following_url": "https://api.github.com/users/adich23/following{/other_user}", "gists_url": "https://api.github.com/users/adich23/gists{/gist_id}", "starred_url": "https://api.github.com/users/adich23/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adich23/subscriptions", "organizations_url": "https://api.github.com/users/adich23/orgs", "repos_url": "https://api.github.com/users/adich23/repos", "events_url": "https://api.github.com/users/adich23/events{/privacy}", "received_events_url": "https://api.github.com/users/adich23/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-02-22T07:28:57Z", "updated_at": "2019-02-22T14:16:40Z", "closed_at": "2019-02-22T14:16:40Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nThe bert_model check introduced in #523 , #550 and #551 is preventing to use custom models.\r\n\r\n**To Reproduce**\r\n```\r\nembedding = BertEmbeddings('./bert_model/')\r\n```\r\n```\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-10-d8508b949793> in <module>()\r\n      1 # embedding = BertEmbeddings()\r\n----> 2 embedding = BertEmbeddings('./bert_model/')\r\n\r\n~/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/flair/embeddings.py in __init__(self, bert_model_or_path, layers, pooling_operation)\r\n   1069 \r\n   1070         if bert_model_or_path not in BERT_PRETRAINED_MODEL_ARCHIVE_MAP.keys():\r\n-> 1071             raise ValueError('Provided bert-model is not available.')\r\n   1072 \r\n   1073         self.tokenizer = BertTokenizer.from_pretrained(bert_model_or_path)\r\n\r\nValueError: Provided bert-model is not available.\r\n```\r\n\r\n**Expected behavior**\r\nThese 2 lines are not needed now, Since we are supporting more models than available in BERT_PRETRAINED_MODEL_ARCHIVE_MAP -\r\n   ```\r\n     if bert_model not in BERT_PRETRAINED_MODEL_ARCHIVE_MAP.keys():\r\n            raise ValueError('Provided bert-model is not available.')\r\n\r\n```\r\nI am raising a PR to fix this.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/554/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/554/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/550", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/550/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/550/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/550/events", "html_url": "https://github.com/flairNLP/flair/issues/550", "id": 412896595, "node_id": "MDU6SXNzdWU0MTI4OTY1OTU=", "number": 550, "title": "Release 0.4.1: NameError: name 'bert_model' is not defined", "user": {"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-02-21T12:18:53Z", "updated_at": "2019-02-21T18:10:50Z", "closed_at": "2019-02-21T18:10:50Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Hi,\r\n\r\nI made an error during resolving a merge conflict for PR #523.\r\n\r\n`BertEmbeddings` are currently not working, because of:\r\n\r\n```bash\r\nTraceback (most recent call last):\r\n  File \"ner_en_bert.py\", line 17, in <module>\r\n    BertEmbeddings()\r\n  File \"/mnt/flair/flair/embeddings.py\", line 1070, in __init__\r\n    if bert_model not in BERT_PRETRAINED_MODEL_ARCHIVE_MAP.keys():\r\nNameError: name 'bert_model' is not defined\r\n```\r\n\r\nI'm going to fix that!", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/550/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/550/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/535", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/535/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/535/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/535/events", "html_url": "https://github.com/flairNLP/flair/issues/535", "id": 412638588, "node_id": "MDU6SXNzdWU0MTI2Mzg1ODg=", "number": 535, "title": "Old 0.3.0 pytorch-pretrained-bert version in PyPI release for flair 0.4.0", "user": {"login": "knrd", "id": 3518849, "node_id": "MDQ6VXNlcjM1MTg4NDk=", "avatar_url": "https://avatars.githubusercontent.com/u/3518849?v=4", "gravatar_id": "", "url": "https://api.github.com/users/knrd", "html_url": "https://github.com/knrd", "followers_url": "https://api.github.com/users/knrd/followers", "following_url": "https://api.github.com/users/knrd/following{/other_user}", "gists_url": "https://api.github.com/users/knrd/gists{/gist_id}", "starred_url": "https://api.github.com/users/knrd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/knrd/subscriptions", "organizations_url": "https://api.github.com/users/knrd/orgs", "repos_url": "https://api.github.com/users/knrd/repos", "events_url": "https://api.github.com/users/knrd/events{/privacy}", "received_events_url": "https://api.github.com/users/knrd/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-02-20T21:32:57Z", "updated_at": "2019-02-22T14:41:46Z", "closed_at": "2019-02-22T14:41:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nOn 0.4.0 tag in `requirements.txt` https://github.com/zalandoresearch/flair/blob/v0.4.0/requirements.txt there is `pytorch-pretrained-bert==0.4.0`, but in PyPI release in https://files.pythonhosted.org/packages/cc/6a/fea4f9533feea65f8b2ff3d6a9934dba6227df81bbc180915cbd30c5db95/flair-0.4.0.tar.gz in `flair-0.4.0/flair.egg-info/requires.txt` you can find `pytorch-pretrained-bert==0.3.0`.\r\n\r\n**To reproduce**\r\n`pip install flair` and `pip list`\r\n\r\nAfter `pip install pytorch-pretrained-bert==0.4.0` pip will report:\r\n> flair 0.4.0 has requirement pytorch-pretrained-bert==0.3.0, but you'll have pytorch-pretrained-bert 0.4.0 which is incompatible.\r\n\r\nShould not be `pytorch-pretrained-bert==0.4.0` for PyPI release of flair 0.4.0?\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/535/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/535/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/525", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/525/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/525/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/525/events", "html_url": "https://github.com/flairNLP/flair/issues/525", "id": 412318578, "node_id": "MDU6SXNzdWU0MTIzMTg1Nzg=", "number": 525, "title": "use BERT embedding as instruction and have ModuleNotFoundError: No module named 'fused_layer_norm_cuda'", "user": {"login": "PaulZhangIsing", "id": 27721543, "node_id": "MDQ6VXNlcjI3NzIxNTQz", "avatar_url": "https://avatars.githubusercontent.com/u/27721543?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PaulZhangIsing", "html_url": "https://github.com/PaulZhangIsing", "followers_url": "https://api.github.com/users/PaulZhangIsing/followers", "following_url": "https://api.github.com/users/PaulZhangIsing/following{/other_user}", "gists_url": "https://api.github.com/users/PaulZhangIsing/gists{/gist_id}", "starred_url": "https://api.github.com/users/PaulZhangIsing/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PaulZhangIsing/subscriptions", "organizations_url": "https://api.github.com/users/PaulZhangIsing/orgs", "repos_url": "https://api.github.com/users/PaulZhangIsing/repos", "events_url": "https://api.github.com/users/PaulZhangIsing/events{/privacy}", "received_events_url": "https://api.github.com/users/PaulZhangIsing/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-02-20T09:11:46Z", "updated_at": "2019-03-01T12:13:44Z", "closed_at": "2019-02-25T06:59:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n  File \"run_classifier_torch.py\", line 686, in <module>\r\n    main()\r\n  File \"run_classifier_torch.py\", line 525, in main\r\n    num_labels = num_labels)\r\n  File \"/home/yuwei/anaconda2/envs/py36/lib/python3.6/site-packages/pytorch_pretrained_bert/modeling.py\", line 580, in from_pretrained\r\n    model = cls(config, *inputs, **kwargs)\r\n  File \"/home/yuwei/anaconda2/envs/py36/lib/python3.6/site-packages/pytorch_pretrained_bert/modeling.py\", line 963, in __init__\r\n    self.bert = BertModel(config)\r\n  File \"/home/yuwei/anaconda2/envs/py36/lib/python3.6/site-packages/pytorch_pretrained_bert/modeling.py\", line 684, in __init__\r\n    self.embeddings = BertEmbeddings(config)\r\n  File \"/home/yuwei/anaconda2/envs/py36/lib/python3.6/site-packages/pytorch_pretrained_bert/modeling.py\", line 246, in __init__\r\n    self.LayerNorm = BertLayerNorm(config.hidden_size, eps=1e-12)\r\n  File \"/home/yuwei/anaconda2/envs/py36/lib/python3.6/site-packages/apex-0.1-py3.6.egg/apex/normalization/fused_layer_norm.py\", line 126, in __init__\r\n  File \"/home/yuwei/anaconda2/envs/py36/lib/python3.6/importlib/__init__.py\", line 126, in import_module\r\n    return _bootstrap._gcd_import(name[level:], package, level)\r\n  File \"<frozen importlib._bootstrap>\", line 994, in _gcd_import\r\n  File \"<frozen importlib._bootstrap>\", line 971, in _find_and_load\r\n  File \"<frozen importlib._bootstrap>\", line 953, in _find_and_load_unlocked\r\nModuleNotFoundError: No module named 'fused_layer_norm_cuda'\r\n\r\n\r\n\r\n**To Reproduce**\r\nfrom flair.embeddings import BertEmbeddings\r\nfrom flair.data import Sentence\r\n\r\n# init embedding\r\nembedding = BertEmbeddings()\r\n\r\n# create a sentence\r\nsentence = Sentence('The grass is green .')\r\n\r\n# embed words in the sentence\r\nembedding.embed(sentence)\r\n\r\nfor token in sentence:\r\n    print(token)\r\n    print(token.embedding)\r\n**Expected behavior**\r\nseeing error\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS Linux ubuntu 18\r\n - Version [e.g. flair-0.3.2]:\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/525/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/525/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/511", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/511/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/511/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/511/events", "html_url": "https://github.com/flairNLP/flair/issues/511", "id": 411050687, "node_id": "MDU6SXNzdWU0MTEwNTA2ODc=", "number": 511, "title": "DocumentLSTMEmbeddings use GRU instead of LSTM", "user": {"login": "kubapok", "id": 10453985, "node_id": "MDQ6VXNlcjEwNDUzOTg1", "avatar_url": "https://avatars.githubusercontent.com/u/10453985?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kubapok", "html_url": "https://github.com/kubapok", "followers_url": "https://api.github.com/users/kubapok/followers", "following_url": "https://api.github.com/users/kubapok/following{/other_user}", "gists_url": "https://api.github.com/users/kubapok/gists{/gist_id}", "starred_url": "https://api.github.com/users/kubapok/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kubapok/subscriptions", "organizations_url": "https://api.github.com/users/kubapok/orgs", "repos_url": "https://api.github.com/users/kubapok/repos", "events_url": "https://api.github.com/users/kubapok/events{/privacy}", "received_events_url": "https://api.github.com/users/kubapok/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-02-16T09:06:52Z", "updated_at": "2019-02-19T21:25:33Z", "closed_at": "2019-02-19T21:25:33Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "In DocumentLSTMEmbeddings there is:\r\n\r\n`        self.rnn = torch.nn.GRU(self.embeddings_dimension, hidden_size, num_layers=rnn_layers,\r\n                                bidirectional=self.bidirectional)`\r\n\r\nwhich is inconsistent naming. Both GRU and LSTM are type of RNN networks, but GRU is not the same as LSTM.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/511/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/511/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/509", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/509/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/509/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/509/events", "html_url": "https://github.com/flairNLP/flair/issues/509", "id": 410947742, "node_id": "MDU6SXNzdWU0MTA5NDc3NDI=", "number": 509, "title": "GPU error on running Bert on Google Colab", "user": {"login": "mihirjoshi21", "id": 5195121, "node_id": "MDQ6VXNlcjUxOTUxMjE=", "avatar_url": "https://avatars.githubusercontent.com/u/5195121?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihirjoshi21", "html_url": "https://github.com/mihirjoshi21", "followers_url": "https://api.github.com/users/mihirjoshi21/followers", "following_url": "https://api.github.com/users/mihirjoshi21/following{/other_user}", "gists_url": "https://api.github.com/users/mihirjoshi21/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihirjoshi21/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihirjoshi21/subscriptions", "organizations_url": "https://api.github.com/users/mihirjoshi21/orgs", "repos_url": "https://api.github.com/users/mihirjoshi21/repos", "events_url": "https://api.github.com/users/mihirjoshi21/events{/privacy}", "received_events_url": "https://api.github.com/users/mihirjoshi21/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2019-02-15T21:17:04Z", "updated_at": "2019-02-19T13:30:32Z", "closed_at": "2019-02-19T13:30:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\n`Expected object of backend CPU but got backend CUDA for argument #3 'index'\r\n`\r\n\r\n**To Reproduce**\r\n\r\nRunning the code below on Google Colab notebook with GPU support\r\n\r\n```\r\nfrom flair.embeddings import BertEmbeddings\r\nfrom flair.data import Sentence\r\n\r\n# init embedding\r\nembedding = BertEmbeddings()\r\n\r\n# create a sentence\r\nsentence = Sentence('The grass is green .')\r\n\r\n# embed words in the sentence\r\nembedding.embed(sentence)\r\n\r\nfor token in sentence:\r\n    print(token)\r\n    print(token.embedding)\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/509/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/509/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/504", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/504/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/504/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/504/events", "html_url": "https://github.com/flairNLP/flair/issues/504", "id": 410632265, "node_id": "MDU6SXNzdWU0MTA2MzIyNjU=", "number": 504, "title": "BytePairEmbeddings serialization error", "user": {"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-02-15T07:01:22Z", "updated_at": "2019-02-15T11:14:01Z", "closed_at": "2019-02-15T11:14:01Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "In the current master branch, the `BytePairEmbeddings` serialization creates problems when serialized on another machine than where they get deserialized.  \r\n\r\nSpecifically, this line causes the problem: \r\n\r\nhttps://github.com/zalandoresearch/flair/blob/4b3562eed534e4e305a36d2f22d12961bc6c25d5/flair/embeddings.py#L261 \r\n\r\nSince this is only a path, this only works if the sentence piece model is already on your local machine under exactly the same path. If I train remotely and then deserialize locally, I get a `No such file or directory Error`.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/504/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/504/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/491", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/491/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/491/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/491/events", "html_url": "https://github.com/flairNLP/flair/issues/491", "id": 409395479, "node_id": "MDU6SXNzdWU0MDkzOTU0Nzk=", "number": 491, "title": "trainer.train yields ZeroDivisionError", "user": {"login": "timpal0l", "id": 6556710, "node_id": "MDQ6VXNlcjY1NTY3MTA=", "avatar_url": "https://avatars.githubusercontent.com/u/6556710?v=4", "gravatar_id": "", "url": "https://api.github.com/users/timpal0l", "html_url": "https://github.com/timpal0l", "followers_url": "https://api.github.com/users/timpal0l/followers", "following_url": "https://api.github.com/users/timpal0l/following{/other_user}", "gists_url": "https://api.github.com/users/timpal0l/gists{/gist_id}", "starred_url": "https://api.github.com/users/timpal0l/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/timpal0l/subscriptions", "organizations_url": "https://api.github.com/users/timpal0l/orgs", "repos_url": "https://api.github.com/users/timpal0l/repos", "events_url": "https://api.github.com/users/timpal0l/events{/privacy}", "received_events_url": "https://api.github.com/users/timpal0l/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2019-02-12T16:44:54Z", "updated_at": "2020-07-30T20:10:29Z", "closed_at": "2019-02-12T17:40:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nFollowing along the tutorial @ https://towardsdatascience.com/text-classification-with-state-of-the-art-nlp-library-flair-b541d7add21f works fine! But when changing dataset to another csv-file with same format I get `ZeroDivisionError` in `trainer.train('./', max_epochs=10)` seem to be something in the evaluation \r\n\r\n`--> 169                 train_loss /= len(train_data)`\r\n\r\n\r\n**To Reproduce**\r\nThe full code example:\r\n\r\n```\r\nimport pandas as pd\r\ndata = pd.read_csv(\"./genders.csv\", sep='\\t', encoding='latin-1').sample(frac=1)\r\ndata['label'] = '__label__' + data['label'].astype(str)\r\ndata.iloc[0:int(len(data)*0.8)].to_csv('train.csv', sep='\\t', index = False, header = False)\r\ndata.iloc[int(len(data)*0.8):int(len(data)*0.9)].to_csv('test.csv', sep='\\t', index = False, header = False)\r\ndata.iloc[int(len(data)*0.9):].to_csv('dev.csv', sep='\\t', index = False, header = False);\r\n```\r\n```\r\nfrom flair.data_fetcher import NLPTaskDataFetcher\r\nfrom flair.embeddings import WordEmbeddings, FlairEmbeddings, DocumentLSTMEmbeddings\r\nfrom flair.models import TextClassifier\r\nfrom flair.trainers import ModelTrainer\r\nfrom pathlib import Path\r\n```\r\n```\r\ncorpus = NLPTaskDataFetcher.load_classification_corpus(Path('./'), test_file='test.csv', dev_file='dev.csv', train_file='train.csv')\r\nword_embeddings = [WordEmbeddings('glove'), FlairEmbeddings('news-forward-fast'), FlairEmbeddings('news-backward-fast')]\r\ndocument_embeddings = DocumentLSTMEmbeddings(word_embeddings, hidden_size=512, reproject_words=True, reproject_words_dimension=256)\r\nclassifier = TextClassifier(document_embeddings, label_dictionary=corpus.make_label_dictionary(), multi_label=False)\r\n```\r\n```\r\ntrainer = ModelTrainer(classifier, corpus)\r\ntrainer.train('./', max_epochs=10) \"\"\"Crashes here!\"\"\"\r\n```\r\n**Expected behavior**\r\nSame behavior as the spam.csv dataset in the tutorial.\r\n\r\n**Screenshots**\r\nhttps://imgur.com/a/UcDeIFL\r\n\r\n**Environment (please complete the following information):**\r\n - Ubuntu 18.04\r\n - latest version of flair (2019/02/12):\r\n\r\n**Additional context**\r\n[dataset](https://github.com/timpal0l/simple_repo/blob/master/genders.csv)\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/491/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/491/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/486", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/486/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/486/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/486/events", "html_url": "https://github.com/flairNLP/flair/issues/486", "id": 409239122, "node_id": "MDU6SXNzdWU0MDkyMzkxMjI=", "number": 486, "title": "Error in macro F1", "user": {"login": "djstrong", "id": 1849959, "node_id": "MDQ6VXNlcjE4NDk5NTk=", "avatar_url": "https://avatars.githubusercontent.com/u/1849959?v=4", "gravatar_id": "", "url": "https://api.github.com/users/djstrong", "html_url": "https://github.com/djstrong", "followers_url": "https://api.github.com/users/djstrong/followers", "following_url": "https://api.github.com/users/djstrong/following{/other_user}", "gists_url": "https://api.github.com/users/djstrong/gists{/gist_id}", "starred_url": "https://api.github.com/users/djstrong/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/djstrong/subscriptions", "organizations_url": "https://api.github.com/users/djstrong/orgs", "repos_url": "https://api.github.com/users/djstrong/repos", "events_url": "https://api.github.com/users/djstrong/events{/privacy}", "received_events_url": "https://api.github.com/users/djstrong/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-02-12T10:58:04Z", "updated_at": "2019-02-19T21:25:01Z", "closed_at": "2019-02-19T21:25:01Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "Probably there is error in calculation of macro F1. Flair is taking averages of class precisions and recalls and then calculates F1. As far as I know, it should be F1 calculated over classes and then averaged - it would be consistent with `sklearn.metrics.f1_score(labels, predicitons, average='macro')`.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/486/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/486/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/483", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/483/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/483/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/483/events", "html_url": "https://github.com/flairNLP/flair/issues/483", "id": 409177126, "node_id": "MDU6SXNzdWU0MDkxNzcxMjY=", "number": 483, "title": "Confusion Matrix for Multi-class prediction", "user": {"login": "frtacoa", "id": 46212658, "node_id": "MDQ6VXNlcjQ2MjEyNjU4", "avatar_url": "https://avatars.githubusercontent.com/u/46212658?v=4", "gravatar_id": "", "url": "https://api.github.com/users/frtacoa", "html_url": "https://github.com/frtacoa", "followers_url": "https://api.github.com/users/frtacoa/followers", "following_url": "https://api.github.com/users/frtacoa/following{/other_user}", "gists_url": "https://api.github.com/users/frtacoa/gists{/gist_id}", "starred_url": "https://api.github.com/users/frtacoa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/frtacoa/subscriptions", "organizations_url": "https://api.github.com/users/frtacoa/orgs", "repos_url": "https://api.github.com/users/frtacoa/repos", "events_url": "https://api.github.com/users/frtacoa/events{/privacy}", "received_events_url": "https://api.github.com/users/frtacoa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-02-12T08:29:48Z", "updated_at": "2019-02-24T14:38:39Z", "closed_at": "2019-02-24T14:38:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi guys,\r\n\r\nI would like to share a concern regarding the prediction results output.\r\nCurrently, true negatives are being calculated for multi-class classification, which will produce duplicated counts and artificially increase the overall accuracy.\r\nPlease take a look at the following portion of log:\r\n\r\n```\r\n2019-02-07 22:45:48,581 Testing using best model ...\r\n2019-02-07 22:45:48,664 MICRO_AVG: acc 0.9963 - f1-score 0.9448\r\n2019-02-07 22:45:48,665 MACRO_AVG: acc 0.9963 - f1-score 0.9227\r\n2019-02-07 22:45:48,665 label_1 tp: 5 - fp: 1 - fn: 0 - tn: 139 - precision: 0.8333 - recall: 1.0000 - accuracy: 0.9931 - f1-score: 0.9091\r\n2019-02-07 22:45:48,665 label_2 tp: 5 - fp: 0 - fn: 0 - tn: 140 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\n2019-02-07 22:45:48,665 label_3 tp: 5 - fp: 1 - fn: 0 - tn: 139 - precision: 0.8333 - recall: 1.0000 - accuracy: 0.9931 - f1-score: 0.9091\r\n2019-02-07 22:45:48,665 label_4 tp: 5 - fp: 0 - fn: 0 - tn: 140 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\n2019-02-07 22:45:48,665 label_5 tp: 5 - fp: 1 - fn: 0 - tn: 139 - precision: 0.8333 - recall: 1.0000 - accuracy: 0.9931 - f1-score: 0.9091\r\n2019-02-07 22:45:48,665 label_6 tp: 5 - fp: 0 - fn: 0 - tn: 140 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\n2019-02-07 22:45:48,665 label_7 tp: 5 - fp: 0 - fn: 0 - tn: 140 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\n2019-02-07 22:45:48,666 label_8 tp: 5 - fp: 0 - fn: 0 - tn: 140 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\n2019-02-07 22:45:48,666 label_9 tp: 5 - fp: 0 - fn: 0 - tn: 140 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\n2019-02-07 22:45:48,666 label_10 tp: 5 - fp: 1 - fn: 0 - tn: 139 - precision: 0.8333 - recall: 1.0000 - accuracy: 0.9931 - f1-score: 0.9091\r\n2019-02-07 22:45:48,666 label_11 tp: 4 - fp: 0 - fn: 1 - tn: 140 - precision: 1.0000 - recall: 0.8000 - accuracy: 0.9931 - f1-score: 0.8889\r\n2019-02-07 22:45:48,666 label_12 tp: 4 - fp: 0 - fn: 1 - tn: 140 - precision: 1.0000 - recall: 0.8000 - accuracy: 0.9931 - f1-score: 0.8889\r\n2019-02-07 22:45:48,666 label_13 tp: 4 - fp: 1 - fn: 1 - tn: 139 - precision: 0.8000 - recall: 0.8000 - accuracy: 0.9862 - f1-score: 0.8000\r\n2019-02-07 22:45:48,666 label_14 tp: 5 - fp: 0 - fn: 0 - tn: 140 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\n2019-02-07 22:45:48,666 label_15 tp: 5 - fp: 1 - fn: 0 - tn: 139 - precision: 0.8333 - recall: 1.0000 - accuracy: 0.9931 - f1-score: 0.9091\r\n2019-02-07 22:45:48,666 label_16 tp: 5 - fp: 0 - fn: 0 - tn: 140 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\n2019-02-07 22:45:48,666 label_17 tp: 5 - fp: 0 - fn: 0 - tn: 140 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\n2019-02-07 22:45:48,666 label_18 tp: 5 - fp: 0 - fn: 0 - tn: 140 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\n2019-02-07 22:45:48,666 label_19 tp: 5 - fp: 0 - fn: 0 - tn: 140 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\n2019-02-07 22:45:48,667 label_20 tp: 5 - fp: 0 - fn: 0 - tn: 140 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\n2019-02-07 22:45:48,667 label_21 tp: 5 - fp: 0 - fn: 0 - tn: 140 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\n2019-02-07 22:45:48,667 label_22 tp: 5 - fp: 0 - fn: 0 - tn: 140 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\n2019-02-07 22:45:48,667 label_23 tp: 4 - fp: 0 - fn: 1 - tn: 140 - precision: 1.0000 - recall: 0.8000 - accuracy: 0.9931 - f1-score: 0.8889\r\n2019-02-07 22:45:48,667 label_24 tp: 5 - fp: 0 - fn: 0 - tn: 140 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\n2019-02-07 22:45:48,667 label_25 tp: 4 - fp: 0 - fn: 1 - tn: 140 - precision: 1.0000 - recall: 0.8000 - accuracy: 0.9931 - f1-score: 0.8889\r\n2019-02-07 22:45:48,667 label_26 tp: 3 - fp: 0 - fn: 2 - tn: 140 - precision: 1.0000 - recall: 0.6000 - accuracy: 0.9862 - f1-score: 0.7500\r\n2019-02-07 22:45:48,667 label_27 tp: 5 - fp: 0 - fn: 0 - tn: 140 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\n2019-02-07 22:45:48,667 label_28 tp: 5 - fp: 0 - fn: 0 - tn: 140 - precision: 1.0000 - recall: 1.0000 - accuracy: 1.0000 - f1-score: 1.0000\r\n2019-02-07 22:45:48,667 label_29 tp: 4 - fp: 0 - fn: 1 - tn: 140 - precision: 1.0000 - recall: 0.8000 - accuracy: 0.9931 - f1-score: 0.8889\r\n2019-02-07 22:45:48,667 label_30 tp: 0 - fp: 2 - fn: 0 - tn: 143 - precision: 0.0000 - recall: 0.0000 - accuracy: 0.9862 - f1-score: 0.0000\r\n```\r\nThe test set contains 145 samples (5 per each label), but if we sum up all [tp,fp,fn,tn] values we would have 4350 (145 x 30 labels) samples.\r\nSo, I think reporting these results in a confusion matrix format would be more appropriate since they avoid duplicating the sample counts. Something like this:\r\n\r\n|  | label_1 | label_2 | ... | label_30 |\r\n| --- | --- | --- | --- | --- |\r\n| **label_1** | 5 | 0 | ... | 0 |\r\n| **label_2** | 0 | 4 | ... | 2 |\r\n| **...** | ... | ... | ... | ... |\r\n| **label_30** | 0 | 0 | ... | 0 |\r\n\r\nHere, rows denote the true labels and columns denote the predicted labels. Moreover, from this table we can compute Precision, Recall, F1 score and Accuracy values.\r\nYou can refer to the [scikit-learn](https://scikit-learn.org/stable/modules/generated/sklearn.metrics.confusion_matrix.html) page about Confusion Matrix for more information.\r\n\r\nPlease let me know your thoughts on this.\r\nThank you!", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/483/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/483/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/482", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/482/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/482/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/482/events", "html_url": "https://github.com/flairNLP/flair/issues/482", "id": 409112111, "node_id": "MDU6SXNzdWU0MDkxMTIxMTE=", "number": 482, "title": "can't assign a list to a torch.cuda.LongTensor", "user": {"login": "gccome", "id": 44276950, "node_id": "MDQ6VXNlcjQ0Mjc2OTUw", "avatar_url": "https://avatars.githubusercontent.com/u/44276950?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gccome", "html_url": "https://github.com/gccome", "followers_url": "https://api.github.com/users/gccome/followers", "following_url": "https://api.github.com/users/gccome/following{/other_user}", "gists_url": "https://api.github.com/users/gccome/gists{/gist_id}", "starred_url": "https://api.github.com/users/gccome/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gccome/subscriptions", "organizations_url": "https://api.github.com/users/gccome/orgs", "repos_url": "https://api.github.com/users/gccome/repos", "events_url": "https://api.github.com/users/gccome/events{/privacy}", "received_events_url": "https://api.github.com/users/gccome/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2019-02-12T04:13:15Z", "updated_at": "2019-02-12T15:42:08Z", "closed_at": "2019-02-12T15:42:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "I recently ran into the following issue when I was training a sequence tagger. Does anyone know why this is happening? I use the code in tutorial.\r\n\r\n![image](https://user-images.githubusercontent.com/44276950/52611179-3e5d2b00-2e52-11e9-980e-df88ffba0746.png)\r\n\r\nThanks!", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/482/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/482/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/478", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/478/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/478/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/478/events", "html_url": "https://github.com/flairNLP/flair/issues/478", "id": 408488777, "node_id": "MDU6SXNzdWU0MDg0ODg3Nzc=", "number": 478, "title": " NLPTaskDataFetcher.load_corpus(NLPTask.CONLL_03), file not found", "user": {"login": "Santosh-Gupta", "id": 5524261, "node_id": "MDQ6VXNlcjU1MjQyNjE=", "avatar_url": "https://avatars.githubusercontent.com/u/5524261?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Santosh-Gupta", "html_url": "https://github.com/Santosh-Gupta", "followers_url": "https://api.github.com/users/Santosh-Gupta/followers", "following_url": "https://api.github.com/users/Santosh-Gupta/following{/other_user}", "gists_url": "https://api.github.com/users/Santosh-Gupta/gists{/gist_id}", "starred_url": "https://api.github.com/users/Santosh-Gupta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Santosh-Gupta/subscriptions", "organizations_url": "https://api.github.com/users/Santosh-Gupta/orgs", "repos_url": "https://api.github.com/users/Santosh-Gupta/repos", "events_url": "https://api.github.com/users/Santosh-Gupta/events{/privacy}", "received_events_url": "https://api.github.com/users/Santosh-Gupta/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-02-10T01:11:16Z", "updated_at": "2019-10-04T08:03:25Z", "closed_at": "2019-02-10T21:22:45Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nA clear and concise description of what the bug is.\r\n\r\nI am trying to follow this tutorial https://github.com/zalandoresearch/flair/blob/master/resources/docs/TUTORIAL_7_TRAINING_A_MODEL.md\r\n\r\nand I am getting a file File not found for ` NLPTaskDataFetcher.load_corpus(NLPTask.CONLL_03)`. Similar issue to\r\nhttps://github.com/zalandoresearch/flair/issues/371\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior (e.g. which model did you train? what parameters did you use? etc.).\r\n\r\n```\r\nfrom flair.data import TaggedCorpus\r\nfrom flair.data_fetcher import NLPTaskDataFetcher, NLPTask\r\nfrom flair.embeddings import TokenEmbeddings, WordEmbeddings, StackedEmbeddings\r\nfrom typing import List\r\n\r\ncorpus: TaggedCorpus = NLPTaskDataFetcher.load_corpus(NLPTask.CONLL_03).downsample(0.1)\r\n```\r\n\r\n**Expected behavior**\r\nA clear and concise description of what you expected to happen.\r\n\r\nNo error should appear, and files should be downloaded \r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]:\r\n - Version [e.g. flair-0.3.2]:\r\n\r\nGoogle colab \r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/478/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/478/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/469", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/469/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/469/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/469/events", "html_url": "https://github.com/flairNLP/flair/issues/469", "id": 407777781, "node_id": "MDU6SXNzdWU0MDc3Nzc3ODE=", "number": 469, "title": "Inconsistent number of examples and wrong orders for both text classification and sequence tagging", "user": {"login": "gccome", "id": 44276950, "node_id": "MDQ6VXNlcjQ0Mjc2OTUw", "avatar_url": "https://avatars.githubusercontent.com/u/44276950?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gccome", "html_url": "https://github.com/gccome", "followers_url": "https://api.github.com/users/gccome/followers", "following_url": "https://api.github.com/users/gccome/following{/other_user}", "gists_url": "https://api.github.com/users/gccome/gists{/gist_id}", "starred_url": "https://api.github.com/users/gccome/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gccome/subscriptions", "organizations_url": "https://api.github.com/users/gccome/orgs", "repos_url": "https://api.github.com/users/gccome/repos", "events_url": "https://api.github.com/users/gccome/events{/privacy}", "received_events_url": "https://api.github.com/users/gccome/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-02-07T16:11:33Z", "updated_at": "2019-02-11T19:55:14Z", "closed_at": "2019-02-11T19:55:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "I recently found a couple of issues for both sequence tagging and text classification.\r\n\r\nFirst of all, in the output test.tsv file, the number of examples are inconsistent with (slightly less than) original test file. Second, the order of examples in test.tsv is different from original test file. Any specific reason for causing this? \r\n\r\nFor 1st issue, I didn't see shuffling eval or test data in the code. \r\nFor 2nd issue, I cannot locate the code that might cause it either.\r\n\r\nFor text classification, I have 3,000 sentences in my test file, but only output 2,875.\r\nFor sequence tagging, I have 5,529 sentences in my test file, but only output 5,516.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/469/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/469/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/468", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/468/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/468/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/468/events", "html_url": "https://github.com/flairNLP/flair/issues/468", "id": 407452846, "node_id": "MDU6SXNzdWU0MDc0NTI4NDY=", "number": 468, "title": "NER entities change per run ", "user": {"login": "dhairyadalal", "id": 22040959, "node_id": "MDQ6VXNlcjIyMDQwOTU5", "avatar_url": "https://avatars.githubusercontent.com/u/22040959?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dhairyadalal", "html_url": "https://github.com/dhairyadalal", "followers_url": "https://api.github.com/users/dhairyadalal/followers", "following_url": "https://api.github.com/users/dhairyadalal/following{/other_user}", "gists_url": "https://api.github.com/users/dhairyadalal/gists{/gist_id}", "starred_url": "https://api.github.com/users/dhairyadalal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dhairyadalal/subscriptions", "organizations_url": "https://api.github.com/users/dhairyadalal/orgs", "repos_url": "https://api.github.com/users/dhairyadalal/repos", "events_url": "https://api.github.com/users/dhairyadalal/events{/privacy}", "received_events_url": "https://api.github.com/users/dhairyadalal/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-02-06T22:06:55Z", "updated_at": "2019-02-07T16:17:30Z", "closed_at": "2019-02-07T16:17:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "Is it possible to have an option to freeze the model at prediction (enable pytorch eval() mode) so that the predictions don't change every run? \r\n\r\nFor example:\r\n```\r\nfrom flair.data import Sentence\r\nfrom flair.models import SequenceTagger\r\n\r\ntagger = SequenceTagger.load(\"ner\")\r\n\r\nfor i in range(10):\r\n    print(\"iteration: \", i)\r\n    s = Sentence(\"Boston is the capital of MA.\")\r\n    tagger.predict(s)\r\n    for e in s.get_spans(\"ner\"):\r\n        print(e.text, e.score)\r\n    print(\"--------------------------\")\r\n```\r\n\r\n\r\nResults in: \r\n\r\n> iteration:  0\r\n> Boston 0.9999486207962036\r\n> --------------------------\r\n> iteration:  1\r\n> Boston 0.999962568283081\r\n> --------------------------\r\n> iteration:  2\r\n> Boston 0.9981124401092529\r\n> MA. 0.6125262379646301\r\n> --------------------------\r\n> iteration:  3\r\n> Boston 0.9999322891235352\r\n> MA. 0.5145224928855896\r\n> --------------------------\r\n> iteration:  4\r\n> Boston 0.9999871253967285\r\n> --------------------------\r\n> iteration:  5\r\n> Boston 0.999849796295166\r\n> --------------------------\r\n> iteration:  6\r\n> Boston 0.9999449253082275\r\n> --------------------------\r\n> iteration:  7\r\n> Boston 0.9998575448989868\r\n> --------------------------\r\n> iteration:  8\r\n> Boston 0.9999393224716187\r\n> --------------------------\r\n> iteration:  9\r\n> Boston 0.9999902248382568\r\n> --------------------------", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/468/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/468/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/462", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/462/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/462/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/462/events", "html_url": "https://github.com/flairNLP/flair/issues/462", "id": 407137828, "node_id": "MDU6SXNzdWU0MDcxMzc4Mjg=", "number": 462, "title": "Tests: Visualization test is failing on CUDA", "user": {"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-02-06T09:07:13Z", "updated_at": "2019-02-06T15:48:49Z", "closed_at": "2019-02-06T15:48:49Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Hi,\r\n\r\nwith the latest `master` version, one of the integration tests (`test_visual.py`) is failing when running on CUDA:\r\n\r\n```bash\r\ntest_visual.py:90: \r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\r\n../flair/visual/activations.py:74: in highlight_selection\r\n    rendered += self.highlight(activations[:, i], text)\r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\r\n\r\nself = <flair.visual.activations.Highlighter object at 0x7f207c682c88>\r\nactivation = tensor([ 1.2762e-02,  2.5522e-04,  7.5684e-03,  7.7306e-03, -1.5601e-02,\r\n         6.5539e-07,  1.8706e-02,  6.5539e-07...4,  7.5684e-03,  7.7306e-03,  8.0798e-02,\r\n        -1.1686e-03, -4.6697e-02,  7.7306e-03,  6.5539e-07], device='cuda:0')\r\ntext = 'The U.S. Centers for Disease Control and Prevention initially advised school systems to close if outbreaks occurred ,...f the virus meant most schools and day care centers should stay open , even if they had confirmed cases of swine flu .'\r\n\r\n    def highlight(self, activation, text):\r\n    \r\n>       activation = activation.detach().numpy()\r\nE       TypeError: can't convert CUDA tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.\r\n\r\n../flair/visual/activations.py:37: TypeError\r\n```", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/462/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/462/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/457", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/457/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/457/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/457/events", "html_url": "https://github.com/flairNLP/flair/issues/457", "id": 406874476, "node_id": "MDU6SXNzdWU0MDY4NzQ0NzY=", "number": 457, "title": "Unable to load corpus", "user": {"login": "romanovzky", "id": 7794475, "node_id": "MDQ6VXNlcjc3OTQ0NzU=", "avatar_url": "https://avatars.githubusercontent.com/u/7794475?v=4", "gravatar_id": "", "url": "https://api.github.com/users/romanovzky", "html_url": "https://github.com/romanovzky", "followers_url": "https://api.github.com/users/romanovzky/followers", "following_url": "https://api.github.com/users/romanovzky/following{/other_user}", "gists_url": "https://api.github.com/users/romanovzky/gists{/gist_id}", "starred_url": "https://api.github.com/users/romanovzky/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/romanovzky/subscriptions", "organizations_url": "https://api.github.com/users/romanovzky/orgs", "repos_url": "https://api.github.com/users/romanovzky/repos", "events_url": "https://api.github.com/users/romanovzky/events{/privacy}", "received_events_url": "https://api.github.com/users/romanovzky/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2019-02-05T16:46:08Z", "updated_at": "2020-05-07T03:15:52Z", "closed_at": "2020-04-30T10:56:47Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nFollowing [Tutorial 7](https://github.com/zalandoresearch/flair/blob/master/resources/docs/TUTORIAL_7_TRAINING_A_MODEL.md) I cannot load my own corpus using\r\n\r\n```python\r\ncorpus = NLPTaskDataFetcher.load_classification_corpus(Path('./'),\r\n                                                       test_file='test.txt',\r\n                                                       dev_file='val.txt',\r\n                                                       train_file='train.txt') \r\n```\r\n\r\nThe data in the `txt` follow the convention `__label__X\\ttext`. The total amount of classes is two, the total amount of entries is:\r\n- train: 20387\r\n- val: 20387\r\n- test: 10194\r\n\r\nThe used memory rises continuously, ending up having all memory used by the code above, leading to non-responsive system and then python crashes (running inside a jupyter notebook, so the kernel restarts).\r\n\r\nReducing the number of documents (say produce only 1000-1000-500 sets) seems to workaround this. However this is not intended behaviour for a Deep Learning solution.\r\n\r\n**To Reproduce**\r\nAs far as I know, data with the above specifications (I cannot divulge or share the data).\r\n\r\n**Expected behavior**\r\nTo load a corpus to be used in a `TextClassifier`.\r\n\r\n**Screenshots**\r\nN/A\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Linux\r\n - Version [e.g. flair-0.3.2]: 0.4.0\r\n - RAM: 16GB\r\n\r\n**Additional context**\r\nN/A\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/457/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/457/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/452", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/452/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/452/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/452/events", "html_url": "https://github.com/flairNLP/flair/issues/452", "id": 406662998, "node_id": "MDU6SXNzdWU0MDY2NjI5OTg=", "number": 452, "title": "TypeError: unsupported operand type(s) for +: 'int' and 'NoneType'`", "user": {"login": "alipetiwala", "id": 41145154, "node_id": "MDQ6VXNlcjQxMTQ1MTU0", "avatar_url": "https://avatars.githubusercontent.com/u/41145154?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alipetiwala", "html_url": "https://github.com/alipetiwala", "followers_url": "https://api.github.com/users/alipetiwala/followers", "following_url": "https://api.github.com/users/alipetiwala/following{/other_user}", "gists_url": "https://api.github.com/users/alipetiwala/gists{/gist_id}", "starred_url": "https://api.github.com/users/alipetiwala/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alipetiwala/subscriptions", "organizations_url": "https://api.github.com/users/alipetiwala/orgs", "repos_url": "https://api.github.com/users/alipetiwala/repos", "events_url": "https://api.github.com/users/alipetiwala/events{/privacy}", "received_events_url": "https://api.github.com/users/alipetiwala/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-02-05T07:42:40Z", "updated_at": "2019-02-06T16:01:04Z", "closed_at": "2019-02-06T16:01:04Z", "author_association": "NONE", "active_lock_reason": null, "body": "Getting following error while resuming a training model:\r\n\r\n**Describe the bug**\r\n\r\n<pre>\r\n`TypeError                                 Traceback (most recent call last)\r\n<ipython-input-3-c3b3f8d2e9fd> in <module>()\r\n      2 \r\n      3 trainer = ModelTrainer.load_from_checkpoint('resources/taggers/example-art/char/best-model.pt', 'SequenceTagger', corpus)\r\n----> 4 trainer.train('resources/taggers/example-art/resume-best-model.pt',checkpoint=True)\r\n\r\n~/anaconda3/lib/python3.6/site-packages/flair/trainers/trainer.py in train(self, base_path, evaluation_metric, learning_rate, mini_batch_size, eval_mini_batch_size, max_epochs, anneal_factor, patience, anneal_against_train_loss, train_with_dev, monitor_train, embeddings_in_memory, checkpoint, save_final_model, anneal_with_restarts, test_mode, param_selection_mode, **kwargs)\r\n    111             previous_learning_rate = learning_rate\r\n    112 \r\n--> 113             for epoch in range(0 + self.epoch, max_epochs + self.epoch):\r\n    114                 log_line(log)\r\n    115 \r\n\r\nTypeError: unsupported operand type(s) for +: 'int' and 'NoneType'`\r\n</pre>\r\n**To Reproduce**\r\n\r\nResume existing model with .pt extension\r\n\r\n\r\n**Environment (please complete the following information):**\r\nUbuntu 18.x\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/452/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/452/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/445", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/445/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/445/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/445/events", "html_url": "https://github.com/flairNLP/flair/issues/445", "id": 405826884, "node_id": "MDU6SXNzdWU0MDU4MjY4ODQ=", "number": 445, "title": "sequence tagger has evaluation issue", "user": {"login": "gccome", "id": 44276950, "node_id": "MDQ6VXNlcjQ0Mjc2OTUw", "avatar_url": "https://avatars.githubusercontent.com/u/44276950?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gccome", "html_url": "https://github.com/gccome", "followers_url": "https://api.github.com/users/gccome/followers", "following_url": "https://api.github.com/users/gccome/following{/other_user}", "gists_url": "https://api.github.com/users/gccome/gists{/gist_id}", "starred_url": "https://api.github.com/users/gccome/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gccome/subscriptions", "organizations_url": "https://api.github.com/users/gccome/orgs", "repos_url": "https://api.github.com/users/gccome/repos", "events_url": "https://api.github.com/users/gccome/events{/privacy}", "received_events_url": "https://api.github.com/users/gccome/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2019-02-01T18:46:59Z", "updated_at": "2019-02-06T16:18:56Z", "closed_at": "2019-02-06T16:02:36Z", "author_association": "NONE", "active_lock_reason": null, "body": "I think sequence tagger also has the same issue as #439 because of \r\n\r\n                 for tag, gold in gold_tags:\r\n                        if (tag, gold) not in predicted_tags:\r\n                            metric.add_fn(tag)\r\n                        else:\r\n                            metric.add_tn(tag)\r\n\r\nin `_evaluate_sequence_tagger()`\r\nI am having the incorrect results:\r\n`tp: 2834 - fp: 671 - fn: 1057 - tn: 2834 - precision: 0.8086 - recall: 0.7283 - accuracy: 0.7664 - f1-score: 0.7664`", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/445/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/445/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/425", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/425/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/425/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/425/events", "html_url": "https://github.com/flairNLP/flair/issues/425", "id": 403451206, "node_id": "MDU6SXNzdWU0MDM0NTEyMDY=", "number": 425, "title": "sqlite3.OperationalError: database or disk is full", "user": {"login": "shoegazerstella", "id": 22822597, "node_id": "MDQ6VXNlcjIyODIyNTk3", "avatar_url": "https://avatars.githubusercontent.com/u/22822597?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shoegazerstella", "html_url": "https://github.com/shoegazerstella", "followers_url": "https://api.github.com/users/shoegazerstella/followers", "following_url": "https://api.github.com/users/shoegazerstella/following{/other_user}", "gists_url": "https://api.github.com/users/shoegazerstella/gists{/gist_id}", "starred_url": "https://api.github.com/users/shoegazerstella/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shoegazerstella/subscriptions", "organizations_url": "https://api.github.com/users/shoegazerstella/orgs", "repos_url": "https://api.github.com/users/shoegazerstella/repos", "events_url": "https://api.github.com/users/shoegazerstella/events{/privacy}", "received_events_url": "https://api.github.com/users/shoegazerstella/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2019-01-26T15:19:48Z", "updated_at": "2019-03-26T10:08:14Z", "closed_at": "2019-01-31T16:56:10Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello and thanks for making this tool public.\r\nSo, I am using the example provided [here](https://github.com/zalandoresearch/flair/blob/master/resources/docs/TUTORIAL_5_DOCUMENT_EMBEDDINGS.md) to get document embeddings. \r\nI am running this on an Amazon Sagemaker ml.p2.8xlarge instance with a volume of 500 additional GB.\r\nI have 106779 documents and the error happens after 1892 have been computed. It is the following:\r\n\r\n```\r\nFile \"embeddings.py\", line 168, in <module>\r\nmain()\r\nFile \"embeddings.py\", line 140, in main\r\ndocument_embeddings.embed(sentence)\r\nFile \"/usr/local/lib/python3.6/dist-packages/flair/embeddings.py\", line 1374, in embed\r\nself.embeddings.embed(sentences)\r\nFile \"/usr/local/lib/python3.6/dist-packages/flair/embeddings.py\", line 123, in embed\r\nembedding.embed(sentences)\r\nFile \"/usr/local/lib/python3.6/dist-packages/flair/embeddings.py\", line 56, in embed\r\nself._add_embeddings_internal(sentences)\r\nFile \"/usr/local/lib/python3.6/dist-packages/flair/embeddings.py\", line 612, in _add_embeddings_internal\r\nembeddings = self.cache.get(key)\r\nFile \"/usr/lib/python3.6/_collections_abc.py\", line 660, in get\r\nreturn self[key]\r\nFile \"/usr/local/lib/python3.6/dist-packages/sqlitedict.py\", line 243, in __getitem__\r\nitem = self.conn.select_one(GET_ITEM, (key,))\r\nFile \"/usr/local/lib/python3.6/dist-packages/sqlitedict.py\", line 515, in select_one\r\nreturn next(iter(self.select(req, arg)))\r\nFile \"/usr/local/lib/python3.6/dist-packages/sqlitedict.py\", line 504, in select\r\nself.execute(req, arg, res)\r\nFile \"/usr/local/lib/python3.6/dist-packages/sqlitedict.py\", line 481, in execute\r\nself.check_raise_error()\r\nFile \"/usr/local/lib/python3.6/dist-packages/sqlitedict.py\", line 475, in check_raise_error\r\nreraise(e_type, e_value, e_tb)\r\nFile \"/usr/local/lib/python3.6/dist-packages/sqlitedict.py\", line 71, in reraise\r\nraise value\r\nFile \"/usr/local/lib/python3.6/dist-packages/sqlitedict.py\", line 409, in run\r\ncursor.execute(req, arg)\r\nsqlite3.OperationalError: database or disk is full\r\n```\r\n\r\n**The Code**\r\n```\r\nfastText_embedding = WordEmbeddings('news')\r\nflair_embedding_forward = FlairEmbeddings('news-forward') \r\nflair_embedding_backward = FlairEmbeddings('news-backward')\r\n\r\n# initialize the document embeddings\r\ndocument_embeddings = DocumentPoolEmbeddings([fastText_embedding,\r\n                                                    flair_embedding_backward,\r\n                                                    flair_embedding_forward])\r\n\r\nvecs = []\r\n\r\nfor em in progressbar.progressbar(df['documents'].values):\r\n            sentence = Sentence(em)\r\n            document_embeddings.embed(sentence)\r\n            vecs.append(sentence.get_embedding().squeeze().tolist())\r\n```\r\n\r\n**Environment:**\r\nThe script runs in a Docker container created with `tensorflow:latest-gpu`\r\n - OS: Ubuntu \r\n - Version: pip version of flair\r\n- Python version: Python 3.6\r\n\r\nMight this issue be related to [#387](https://github.com/zalandoresearch/flair/issues/387)?", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/425/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/425/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/421", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/421/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/421/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/421/events", "html_url": "https://github.com/flairNLP/flair/issues/421", "id": 402672879, "node_id": "MDU6SXNzdWU0MDI2NzI4Nzk=", "number": 421, "title": "CUDA Error during CharacterEmbeddings", "user": {"login": "lisette-garciamoya", "id": 18166309, "node_id": "MDQ6VXNlcjE4MTY2MzA5", "avatar_url": "https://avatars.githubusercontent.com/u/18166309?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lisette-garciamoya", "html_url": "https://github.com/lisette-garciamoya", "followers_url": "https://api.github.com/users/lisette-garciamoya/followers", "following_url": "https://api.github.com/users/lisette-garciamoya/following{/other_user}", "gists_url": "https://api.github.com/users/lisette-garciamoya/gists{/gist_id}", "starred_url": "https://api.github.com/users/lisette-garciamoya/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lisette-garciamoya/subscriptions", "organizations_url": "https://api.github.com/users/lisette-garciamoya/orgs", "repos_url": "https://api.github.com/users/lisette-garciamoya/repos", "events_url": "https://api.github.com/users/lisette-garciamoya/events{/privacy}", "received_events_url": "https://api.github.com/users/lisette-garciamoya/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2019-01-24T11:55:21Z", "updated_at": "2019-02-25T06:58:12Z", "closed_at": "2019-01-31T14:11:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "**My code**\r\n```python\r\nfrom flair.embeddings import CharacterEmbeddings\r\n\r\nsentence = Sentence('La casa es muy bonita.', use_tokenizer=True)\r\n\r\nembedding = CharacterEmbeddings()\r\nembedding.embed(sentence)\r\n\r\nfor token in sentence:\r\n    print(token)\r\n    print(token.embedding)\r\n```\r\n\r\n**Errors**\r\n![error](https://user-images.githubusercontent.com/18166309/51676189-296d4480-1fd6-11e9-885f-12ba930e925c.png)\r\n\r\n\r\n**Environment:**\r\n - OS: Ubuntu 18.04.1\r\n - Version: code from *master* branch\r\n - Nvidia:\r\n![nvidia](https://user-images.githubusercontent.com/18166309/51676559-38a0c200-1fd7-11e9-831a-380c3f3df58f.png)\r\n\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/421/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/421/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/417", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/417/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/417/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/417/events", "html_url": "https://github.com/flairNLP/flair/issues/417", "id": 402106103, "node_id": "MDU6SXNzdWU0MDIxMDYxMDM=", "number": 417, "title": "macro_avg_f_score bug", "user": {"login": "wakafengfan", "id": 44130753, "node_id": "MDQ6VXNlcjQ0MTMwNzUz", "avatar_url": "https://avatars.githubusercontent.com/u/44130753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wakafengfan", "html_url": "https://github.com/wakafengfan", "followers_url": "https://api.github.com/users/wakafengfan/followers", "following_url": "https://api.github.com/users/wakafengfan/following{/other_user}", "gists_url": "https://api.github.com/users/wakafengfan/gists{/gist_id}", "starred_url": "https://api.github.com/users/wakafengfan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wakafengfan/subscriptions", "organizations_url": "https://api.github.com/users/wakafengfan/orgs", "repos_url": "https://api.github.com/users/wakafengfan/repos", "events_url": "https://api.github.com/users/wakafengfan/events{/privacy}", "received_events_url": "https://api.github.com/users/wakafengfan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "tabergma", "id": 7203823, "node_id": "MDQ6VXNlcjcyMDM4MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7203823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tabergma", "html_url": "https://github.com/tabergma", "followers_url": "https://api.github.com/users/tabergma/followers", "following_url": "https://api.github.com/users/tabergma/following{/other_user}", "gists_url": "https://api.github.com/users/tabergma/gists{/gist_id}", "starred_url": "https://api.github.com/users/tabergma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tabergma/subscriptions", "organizations_url": "https://api.github.com/users/tabergma/orgs", "repos_url": "https://api.github.com/users/tabergma/repos", "events_url": "https://api.github.com/users/tabergma/events{/privacy}", "received_events_url": "https://api.github.com/users/tabergma/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tabergma", "id": 7203823, "node_id": "MDQ6VXNlcjcyMDM4MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7203823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tabergma", "html_url": "https://github.com/tabergma", "followers_url": "https://api.github.com/users/tabergma/followers", "following_url": "https://api.github.com/users/tabergma/following{/other_user}", "gists_url": "https://api.github.com/users/tabergma/gists{/gist_id}", "starred_url": "https://api.github.com/users/tabergma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tabergma/subscriptions", "organizations_url": "https://api.github.com/users/tabergma/orgs", "repos_url": "https://api.github.com/users/tabergma/repos", "events_url": "https://api.github.com/users/tabergma/events{/privacy}", "received_events_url": "https://api.github.com/users/tabergma/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-01-23T07:30:50Z", "updated_at": "2019-01-24T09:48:16Z", "closed_at": "2019-01-24T09:48:16Z", "author_association": "NONE", "active_lock_reason": null, "body": "In the file flair/training_utils.py, when calculating macro_avg_f_score, I think 'recall' method should be called but 'precision' is called.\r\n\r\n![image](https://user-images.githubusercontent.com/44130753/51589926-4b59bf00-1f23-11e9-964a-24ac0bc82589.png)\r\n\r\ni think it needs to write like this:\r\n`def macro_avg_f_score(self): \r\n         class_precisions = [self.precision(class_name) for class_name in self.get_classes()] \r\n         class_recalls = [self.recall(class_name) for class_name in self.get_classes()]`\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/417/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/417/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/411", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/411/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/411/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/411/events", "html_url": "https://github.com/flairNLP/flair/issues/411", "id": 401622963, "node_id": "MDU6SXNzdWU0MDE2MjI5NjM=", "number": 411, "title": "Execution stop while trying to generate BERT embeddings", "user": {"login": "Arjunsankarlal", "id": 28828445, "node_id": "MDQ6VXNlcjI4ODI4NDQ1", "avatar_url": "https://avatars.githubusercontent.com/u/28828445?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Arjunsankarlal", "html_url": "https://github.com/Arjunsankarlal", "followers_url": "https://api.github.com/users/Arjunsankarlal/followers", "following_url": "https://api.github.com/users/Arjunsankarlal/following{/other_user}", "gists_url": "https://api.github.com/users/Arjunsankarlal/gists{/gist_id}", "starred_url": "https://api.github.com/users/Arjunsankarlal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Arjunsankarlal/subscriptions", "organizations_url": "https://api.github.com/users/Arjunsankarlal/orgs", "repos_url": "https://api.github.com/users/Arjunsankarlal/repos", "events_url": "https://api.github.com/users/Arjunsankarlal/events{/privacy}", "received_events_url": "https://api.github.com/users/Arjunsankarlal/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-01-22T06:53:32Z", "updated_at": "2019-02-24T14:44:17Z", "closed_at": "2019-02-24T14:44:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "I followed the same code in the tutorials for BERT embeddings. I used bert-base-cased model. I downloaded initially. After that it throws this issue and stops. Also my mac throws that python stopped unexpectedly.\r\n\r\ndyld: lazy symbol binding failed: Symbol not found: _PySlice_Unpack\r\n  Referenced from: /Users/arjun/venv/lib/python3.6/site-packages/torch/lib/libtorch_python.dylib\r\n  Expected in: flat namespace", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/411/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/411/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/409", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/409/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/409/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/409/events", "html_url": "https://github.com/flairNLP/flair/issues/409", "id": 401423921, "node_id": "MDU6SXNzdWU0MDE0MjM5MjE=", "number": 409, "title": "ValueError: The given model \"spanish-forward\" is not available or is not a valid path.", "user": {"login": "iuria21", "id": 26438571, "node_id": "MDQ6VXNlcjI2NDM4NTcx", "avatar_url": "https://avatars.githubusercontent.com/u/26438571?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iuria21", "html_url": "https://github.com/iuria21", "followers_url": "https://api.github.com/users/iuria21/followers", "following_url": "https://api.github.com/users/iuria21/following{/other_user}", "gists_url": "https://api.github.com/users/iuria21/gists{/gist_id}", "starred_url": "https://api.github.com/users/iuria21/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iuria21/subscriptions", "organizations_url": "https://api.github.com/users/iuria21/orgs", "repos_url": "https://api.github.com/users/iuria21/repos", "events_url": "https://api.github.com/users/iuria21/events{/privacy}", "received_events_url": "https://api.github.com/users/iuria21/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2019-01-21T16:18:23Z", "updated_at": "2019-01-22T10:02:49Z", "closed_at": "2019-01-22T10:02:49Z", "author_association": "NONE", "active_lock_reason": null, "body": "I can't load basque nor spanish flair embeddings. Not problem with english or german for example, but if I do: \r\n\r\n`flair_backward = FlairEmbeddings('spanish-forward')` \r\n\r\ni get:\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-21-09051c9580a7> in <module>\r\n----> 1 flair_backward = FlairEmbeddings('spanish-forward')\r\n\r\n/tertiary/imanol/imanol/env_flair/lib/python3.6/site-packages/flair/embeddings.py in __init__(self, model, detach, use_cache, cache_directory)\r\n    557 \r\n    558         elif not Path(model).exists():\r\n--> 559             raise ValueError(f'The given model \"{model}\" is not available or is not a valid path.')\r\n    560 \r\n    561         self.name = str(model)\r\n\r\nValueError: The given model \"spanish-forward\" is not available or is not a valid path.\r\n\r\n```\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/409/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/409/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/407", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/407/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/407/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/407/events", "html_url": "https://github.com/flairNLP/flair/issues/407", "id": 401160157, "node_id": "MDU6SXNzdWU0MDExNjAxNTc=", "number": 407, "title": "Error when training a model on CUDA", "user": {"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-01-21T01:06:28Z", "updated_at": "2019-02-06T09:05:23Z", "closed_at": "2019-02-02T14:47:25Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Hi,\r\n\r\nI think this is a regression bug that was introduced after merging the CUDA semantics pull request #402.\r\n\r\nHere's an error message that comes from the `test_model_integration.py`  integration test:\r\n\r\n```bash\r\n>               tag_tensor = torch.LongTensor(sentence_tags)\r\nE               TypeError: expected torch.LongTensor (got torch.cuda.LongTensor)\r\n```\r\n\r\nI got a similar error message when I tried to test my recent ELMo transformer embeddings on GPU.\r\n\r\nTo replicate the error just run the integration tests (`pytest --runintegration`) on a machine with GPU/CUDA support :)\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/407/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/407/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/392", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/392/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/392/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/392/events", "html_url": "https://github.com/flairNLP/flair/issues/392", "id": 399201976, "node_id": "MDU6SXNzdWUzOTkyMDE5NzY=", "number": 392, "title": "CUDA error: device-side assert triggered", "user": {"login": "ghost", "id": 10137, "node_id": "MDQ6VXNlcjEwMTM3", "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ghost", "html_url": "https://github.com/ghost", "followers_url": "https://api.github.com/users/ghost/followers", "following_url": "https://api.github.com/users/ghost/following{/other_user}", "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}", "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ghost/subscriptions", "organizations_url": "https://api.github.com/users/ghost/orgs", "repos_url": "https://api.github.com/users/ghost/repos", "events_url": "https://api.github.com/users/ghost/events{/privacy}", "received_events_url": "https://api.github.com/users/ghost/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2019-01-15T06:11:53Z", "updated_at": "2020-04-09T00:00:45Z", "closed_at": "2019-01-20T04:58:28Z", "author_association": "NONE", "active_lock_reason": null, "body": "when I using 'bert-base-chinses'\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-11-04d52565d542> in <module>\r\n      1 document_embeddings: DocumentLSTMEmbeddings = DocumentLSTMEmbeddings(embeddings,hidden_size=1024,reproject_words=True,reproject_words_dimension=512)\r\n\r\n~/anaconda3/envs/flair/lib/python3.6/site-packages/flair/embeddings.py in __init__(self, embeddings, hidden_size, rnn_layers, reproject_words, reproject_words_dimension, bidirectional, dropout, word_dropout, locked_dropout)\r\n   1459 \r\n   1460         if torch.cuda.is_available():\r\n-> 1461             self.cuda()\r\n   1462 \r\n   1463     @property\r\n\r\n~/anaconda3/envs/flair/lib/python3.6/site-packages/torch/nn/modules/module.py in cuda(self, device)\r\n    258             Module: self\r\n    259         \"\"\"\r\n--> 260         return self._apply(lambda t: t.cuda(device))\r\n    261 \r\n    262     def cpu(self):\r\n\r\n~/anaconda3/envs/flair/lib/python3.6/site-packages/torch/nn/modules/module.py in _apply(self, fn)\r\n    185     def _apply(self, fn):\r\n    186         for module in self.children():\r\n--> 187             module._apply(fn)\r\n    188 \r\n    189         for param in self._parameters.values():\r\n\r\n~/anaconda3/envs/flair/lib/python3.6/site-packages/torch/nn/modules/module.py in _apply(self, fn)\r\n    185     def _apply(self, fn):\r\n    186         for module in self.children():\r\n--> 187             module._apply(fn)\r\n    188 \r\n    189         for param in self._parameters.values():\r\n\r\n~/anaconda3/envs/flair/lib/python3.6/site-packages/torch/nn/modules/module.py in _apply(self, fn)\r\n    185     def _apply(self, fn):\r\n    186         for module in self.children():\r\n--> 187             module._apply(fn)\r\n    188 \r\n    189         for param in self._parameters.values():\r\n\r\n~/anaconda3/envs/flair/lib/python3.6/site-packages/torch/nn/modules/module.py in _apply(self, fn)\r\n    185     def _apply(self, fn):\r\n    186         for module in self.children():\r\n--> 187             module._apply(fn)\r\n    188 \r\n    189         for param in self._parameters.values():\r\n\r\n~/anaconda3/envs/flair/lib/python3.6/site-packages/torch/nn/modules/module.py in _apply(self, fn)\r\n    185     def _apply(self, fn):\r\n    186         for module in self.children():\r\n--> 187             module._apply(fn)\r\n    188 \r\n    189         for param in self._parameters.values():\r\n\r\n~/anaconda3/envs/flair/lib/python3.6/site-packages/torch/nn/modules/module.py in _apply(self, fn)\r\n    191                 # Tensors stored in modules are graph leaves, and we don't\r\n    192                 # want to create copy nodes, so we have to unpack the data.\r\n--> 193                 param.data = fn(param.data)\r\n    194                 if param._grad is not None:\r\n    195                     param._grad.data = fn(param._grad.data)\r\n\r\n~/anaconda3/envs/flair/lib/python3.6/site-packages/torch/nn/modules/module.py in <lambda>(t)\r\n    258             Module: self\r\n    259         \"\"\"\r\n--> 260         return self._apply(lambda t: t.cuda(device))\r\n    261 \r\n    262     def cpu(self):\r\n\r\nRuntimeError: CUDA error: device-side assert triggered\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/392/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/392/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/376", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/376/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/376/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/376/events", "html_url": "https://github.com/flairNLP/flair/issues/376", "id": 397230032, "node_id": "MDU6SXNzdWUzOTcyMzAwMzI=", "number": 376, "title": "RuntimeError when training a NER model with flairembedding", "user": {"login": "xuxingya", "id": 13343428, "node_id": "MDQ6VXNlcjEzMzQzNDI4", "avatar_url": "https://avatars.githubusercontent.com/u/13343428?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xuxingya", "html_url": "https://github.com/xuxingya", "followers_url": "https://api.github.com/users/xuxingya/followers", "following_url": "https://api.github.com/users/xuxingya/following{/other_user}", "gists_url": "https://api.github.com/users/xuxingya/gists{/gist_id}", "starred_url": "https://api.github.com/users/xuxingya/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xuxingya/subscriptions", "organizations_url": "https://api.github.com/users/xuxingya/orgs", "repos_url": "https://api.github.com/users/xuxingya/repos", "events_url": "https://api.github.com/users/xuxingya/events{/privacy}", "received_events_url": "https://api.github.com/users/xuxingya/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2019-01-09T06:31:50Z", "updated_at": "2019-01-14T14:25:39Z", "closed_at": "2019-01-14T14:25:39Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI am trying to train a NER model using my own corpus with a pretrained flair embedding. But an runtime error occurred. \r\nIt looks like there is something wrong with the shape of embedding of tokens. \r\n`sentence_tensor[s_id][:len(sentence)] = torch.cat([token.get_embedding().unsqueeze(0) for token in sentence], 0)`\r\nTo use BERT embedding, I tokenized my sentence with the BertTokenizer, which produced word and non-alphabetical characters. But the flair embedding was trained based on characters. I wonder if this caused this problem.\r\nHere is my code:\r\n```\r\nchar_lm_embeddings = FlairEmbeddings('resources/tagngers/language_model/best-lm.pt',use_cache=True)\r\ncolumns = {0: 'ner', 1: 'text'}\r\ndata_folder = 'flair_data/'\r\n# retrieve corpus using column format, data folder and the names of the train, dev and test files\r\ncorpus: TaggedCorpus = NLPTaskDataFetcher.load_column_corpus(data_folder, columns,\r\n                                                              train_file='flair.tsv')\r\n# 3. make the tag dictionary from the corpus\r\ntag_type = 'ner'\r\ntag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\nprint(tag_dictionary.idx2item)\r\ntagger: SequenceTagger = SequenceTagger(hidden_size=128,\r\n                                        embeddings=char_lm_embeddings,\r\n                                        tag_dictionary=tag_dictionary,\r\n                                        tag_type=tag_type,\r\n                                        use_crf=False)\r\nfrom flair.trainers import ModelTrainer\r\nfrom flair.training_utils import EvaluationMetric\r\nfrom flair.optim import AdamW\r\ntrainer: ModelTrainer = ModelTrainer(tagger, corpus,\r\n                                     optimizer=AdamW)\r\n# 7. start training\r\ntrainer.train('resources/taggers/basic_info_ner',\r\n              learning_rate=0.001,\r\n              mini_batch_size=64,\r\n              max_epochs=3,\r\n              checkpoint=True,\r\n              embeddings_in_memory=False)\r\n```\r\n![image](https://user-images.githubusercontent.com/13343428/50880909-ee3a1580-141a-11e9-856f-d65c39acd2be.png)\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Ubuntu18\r\n - Version: flair 0.4.0", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/376/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/376/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/372", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/372/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/372/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/372/events", "html_url": "https://github.com/flairNLP/flair/issues/372", "id": 396893853, "node_id": "MDU6SXNzdWUzOTY4OTM4NTM=", "number": 372, "title": "The sqlite I/O problem on portuguese flair embeddings", "user": {"login": "nooralahzadeh", "id": 1093791, "node_id": "MDQ6VXNlcjEwOTM3OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1093791?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nooralahzadeh", "html_url": "https://github.com/nooralahzadeh", "followers_url": "https://api.github.com/users/nooralahzadeh/followers", "following_url": "https://api.github.com/users/nooralahzadeh/following{/other_user}", "gists_url": "https://api.github.com/users/nooralahzadeh/gists{/gist_id}", "starred_url": "https://api.github.com/users/nooralahzadeh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nooralahzadeh/subscriptions", "organizations_url": "https://api.github.com/users/nooralahzadeh/orgs", "repos_url": "https://api.github.com/users/nooralahzadeh/repos", "events_url": "https://api.github.com/users/nooralahzadeh/events{/privacy}", "received_events_url": "https://api.github.com/users/nooralahzadeh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-01-08T12:53:03Z", "updated_at": "2019-01-14T14:25:17Z", "closed_at": "2019-01-14T14:25:17Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI am creating embeddings for portuguese dataset.\r\nIt happen after processing 85% of dataset?\r\n\r\ncursor.execute(req, arg)\r\nsqlite3.OperationalError: disk I/O error\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: Linux\r\n - Version [e.g. flair-0.3.2]: 0.4.0\r\n  -Cuda : 9\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/372/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/372/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/371", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/371/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/371/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/371/events", "html_url": "https://github.com/flairNLP/flair/issues/371", "id": 396761236, "node_id": "MDU6SXNzdWUzOTY3NjEyMzY=", "number": 371, "title": "Problem loading corpus", "user": {"login": "frtacoa", "id": 46212658, "node_id": "MDQ6VXNlcjQ2MjEyNjU4", "avatar_url": "https://avatars.githubusercontent.com/u/46212658?v=4", "gravatar_id": "", "url": "https://api.github.com/users/frtacoa", "html_url": "https://github.com/frtacoa", "followers_url": "https://api.github.com/users/frtacoa/followers", "following_url": "https://api.github.com/users/frtacoa/following{/other_user}", "gists_url": "https://api.github.com/users/frtacoa/gists{/gist_id}", "starred_url": "https://api.github.com/users/frtacoa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/frtacoa/subscriptions", "organizations_url": "https://api.github.com/users/frtacoa/orgs", "repos_url": "https://api.github.com/users/frtacoa/repos", "events_url": "https://api.github.com/users/frtacoa/events{/privacy}", "received_events_url": "https://api.github.com/users/frtacoa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-01-08T05:57:44Z", "updated_at": "2019-02-10T00:27:02Z", "closed_at": "2019-01-11T07:55:31Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello guys,\r\n\r\nI am following your tutorial about [hyperparameters optimization](https://github.com/zalandoresearch/flair/blob/master/resources/docs/TUTORIAL_8_MODEL_OPTIMIZATION.md), but there seems to be a problem when loading the `NLPTask.AG_NEWS` corpus:\r\n\r\n```py\r\nfrom flair.data_fetcher import NLPTaskDataFetcher, NLPTask\r\ncorpus: TaggedCorpus = NLPTaskDataFetcher.load_corpus(NLPTask.AG_NEWS)\r\n```\r\n\r\nThe code from above returns the following error:\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nFileNotFoundError                         Traceback (most recent call last)\r\n<ipython-input-17-b457eea87ed8> in <module>\r\n----> 1 corpus: TaggedCorpus = NLPTaskDataFetcher.load_corpus(NLPTask.AG_NEWS)\r\n\r\n/usr/local/lib/python3.6/dist-packages/flair/data_fetcher.py in load_corpus(task, base_path)\r\n    190         # for text classifiers, we use our own special format\r\n    191         if task == NLPTask.IMDB.value or task == NLPTask.AG_NEWS.value:\r\n--> 192             return NLPTaskDataFetcher.load_classification_corpus(data_folder)\r\n    193\r\n    194     @staticmethod\r\n\r\n/usr/local/lib/python3.6/dist-packages/flair/data_fetcher.py in load_classification_corpus(data_folder, train_file, test_file, dev_file)\r\n    345         # automatically identify train / test / dev files\r\n    346         if train_file is None:\r\n--> 347             for file in data_folder.iterdir():\r\n    348                 file_name = file.name\r\n    349                 if 'train' in file_name:\r\n\r\n/usr/lib/python3.6/pathlib.py in iterdir(self)\r\n   1079         if self._closed:\r\n   1080             self._raise_closed()\r\n-> 1081         for name in self._accessor.listdir(self):\r\n   1082             if name in {'.', '..'}:\r\n   1083                 # Yielding a path object for these makes little sense\r\n\r\n/usr/lib/python3.6/pathlib.py in wrapped(pathobj, *args)\r\n    385         @functools.wraps(strfunc)\r\n    386         def wrapped(pathobj, *args):\r\n--> 387             return strfunc(str(pathobj), *args)\r\n    388         return staticmethod(wrapped)\r\n    389\r\n\r\nFileNotFoundError: [Errno 2] No such file or directory: '/home/<username>/.flair/datasets/ag_news'\r\n```\r\n\r\nCan I have some help to solve this? Or, if there is another way to try the hyperparameter optimization from the tutorial, please let me know.\r\nThanks!", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/371/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/371/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/370", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/370/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/370/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/370/events", "html_url": "https://github.com/flairNLP/flair/issues/370", "id": 396468298, "node_id": "MDU6SXNzdWUzOTY0NjgyOTg=", "number": 370, "title": "Exception in Model Optimization", "user": {"login": "adgsantos", "id": 17305792, "node_id": "MDQ6VXNlcjE3MzA1Nzky", "avatar_url": "https://avatars.githubusercontent.com/u/17305792?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adgsantos", "html_url": "https://github.com/adgsantos", "followers_url": "https://api.github.com/users/adgsantos/followers", "following_url": "https://api.github.com/users/adgsantos/following{/other_user}", "gists_url": "https://api.github.com/users/adgsantos/gists{/gist_id}", "starred_url": "https://api.github.com/users/adgsantos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adgsantos/subscriptions", "organizations_url": "https://api.github.com/users/adgsantos/orgs", "repos_url": "https://api.github.com/users/adgsantos/repos", "events_url": "https://api.github.com/users/adgsantos/events{/privacy}", "received_events_url": "https://api.github.com/users/adgsantos/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-01-07T12:27:40Z", "updated_at": "2019-03-20T16:00:54Z", "closed_at": "2019-01-07T14:17:11Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nI'm trying to optimize the hyper parameters for a sequence tagger. To get started I followed the instructions of the tutorial presented in [Model Optimization](https://github.com/zalandoresearch/flair/blob/master/resources/docs/TUTORIAL_8_MODEL_OPTIMIZATION.md) but to no avail. The error message is: `AttributeError: 'tuple' object has no attribute 'embedding_length'`. I have also tried with the example (apart from the dataset) in the tutorial, for which the error message is: `ValueError: Expected input batch_size (32) to match target batch_size (0).`\r\n \r\n**To Reproduce**\r\nDownload the `CONLL_03` dataset and put it in the default location: $HOME/.flair/datasets\r\n\r\nRun the following code:\r\n\r\n```\r\nfrom flair.data import TaggedCorpus\r\nfrom flair.data_fetcher import NLPTaskDataFetcher, NLPTask\r\n\r\n# load your corpus\r\ncorpus: TaggedCorpus = NLPTaskDataFetcher.load_corpus(NLPTask.CONLL_03)\r\n\r\n# Embeddings and training the classifier\r\nfrom hyperopt import hp\r\nfrom flair.hyperparameter.param_selection import SearchSpace, Parameter\r\nfrom flair.embeddings import FlairEmbeddings\r\n\r\nsearch_space = SearchSpace()\r\nsearch_space.add(Parameter.EMBEDDINGS, hp.choice, options=[\r\n    [ FlairEmbeddings('news-forward'), FlairEmbeddings('news-backward') ]\r\n])\r\nsearch_space.add(Parameter.HIDDEN_SIZE, hp.choice, options=[32, 64, 128])\r\nsearch_space.add(Parameter.RNN_LAYERS, hp.choice, options=[1, 2])\r\nsearch_space.add(Parameter.DROPOUT, hp.uniform, low=0.0, high=0.5)\r\nsearch_space.add(Parameter.LEARNING_RATE, hp.choice, options=[0.05, 0.1, 0.15, 0.2])\r\nsearch_space.add(Parameter.MINI_BATCH_SIZE, hp.choice, options=[8, 16, 32])\r\n\r\nfrom flair.hyperparameter.param_selection import SequenceTaggerParamSelector, OptimizationValue\r\n\r\n# create the parameter selector\r\nparam_selector = SequenceTaggerParamSelector(\r\n    corpus, \r\n    'ner', \r\n    'resources/taggers/optimization', \r\n    max_epochs=50, \r\n    training_runs=3,\r\n    optimization_value=OptimizationValue.DEV_SCORE\r\n)\r\n\r\n# start the optimization\r\nparam_selector.optimize(search_space, max_evals=100)\r\n```\r\n\r\nIt yields the following stack trace:\r\n```\r\n(py36) ags@ds-vm:~/notebooks/notebooks$ python a.py\r\n2019-01-07 12:19:52,246 Reading data from /home/ags/.flair/datasets/conll_03\r\n2019-01-07 12:19:52,247 Train: /home/ags/.flair/datasets/conll_03/eng.train.openNLP\r\n2019-01-07 12:19:52,247 Dev: /home/ags/.flair/datasets/conll_03/eng.testa\r\n2019-01-07 12:19:52,247 Test: /home/ags/.flair/datasets/conll_03/eng.testb.openNLP\r\n2019-01-07 12:19:59,671 ----------------------------------------------------------------------------------------------------\r\n2019-01-07 12:19:59,671 Evaluation run: 1\r\n2019-01-07 12:19:59,671 Evaluating parameter combination:\r\n2019-01-07 12:19:59,671         dropout: 0.009483228554103051\r\n2019-01-07 12:19:59,671         embeddings: /home/ags/.flair/embeddings/lm-news-english-forward-v0.2rc.pt,/home/ags/.flair/embeddings/lm-news-english-backward-v0.2rc.pt\r\n2019-01-07 12:19:59,671         hidden_size: 64\r\n2019-01-07 12:19:59,671         learning_rate: 0.2\r\n2019-01-07 12:19:59,671         mini_batch_size: 8\r\n2019-01-07 12:19:59,671         rnn_layers: 1\r\n2019-01-07 12:19:59,671 ----------------------------------------------------------------------------------------------------\r\n2019-01-07 12:19:59,809 ----------------------------------------------------------------------------------------------------\r\n2019-01-07 12:19:59,810 Training run: 1\r\nTraceback (most recent call last):\r\n  File \"a.py\", line 35, in <module>\r\n    param_selector.optimize(search_space, max_evals=100)\r\n  File \"/data/anaconda/envs/py36/lib/python3.6/site-packages/flair/hyperparameter/param_selection.py\", line 147, in optimize\r\n    best = fmin(self._objective, search_space, algo=tpe.suggest, max_evals=max_evals)\r\n  File \"/data/anaconda/envs/py36/lib/python3.6/site-packages/hyperopt/fmin.py\", line 385, in fmin\r\n    rval.exhaust()\r\n  File \"/data/anaconda/envs/py36/lib/python3.6/site-packages/hyperopt/fmin.py\", line 244, in exhaust\r\n    self.run(self.max_evals - n_done, block_until_done=self.asynchronous)\r\n  File \"/data/anaconda/envs/py36/lib/python3.6/site-packages/hyperopt/fmin.py\", line 218, in run\r\n    self.serial_evaluate()\r\n  File \"/data/anaconda/envs/py36/lib/python3.6/site-packages/hyperopt/fmin.py\", line 137, in serial_evaluate\r\n    result = self.domain.evaluate(spec, ctrl)\r\n  File \"/data/anaconda/envs/py36/lib/python3.6/site-packages/hyperopt/base.py\", line 840, in evaluate\r\n    rval = self.fn(pyll_rval)\r\n  File \"/data/anaconda/envs/py36/lib/python3.6/site-packages/flair/hyperparameter/param_selection.py\", line 87, in _objective\r\n    model = self._set_up_model(params)\r\n  File \"/data/anaconda/envs/py36/lib/python3.6/site-packages/flair/hyperparameter/param_selection.py\", line 193, in _set_up_model\r\n    **sequence_tagger_params)\r\n  File \"/data/anaconda/envs/py36/lib/python3.6/site-packages/flair/models/sequence_tagger_model.py\", line 115, in __init__\r\n    rnn_input_dim: int = self.embeddings.embedding_length\r\nAttributeError: 'tuple' object has no attribute 'embedding_length'\r\n```\r\n\r\nReplacing the parameter selector for the following example in the tutorial:\r\n```\r\nfrom flair.hyperparameter.param_selection import TextClassifierParamSelector, OptimizationValue\r\n\r\n# create the parameter selector\r\nparam_selector = TextClassifierParamSelector(\r\n    corpus, \r\n    False, \r\n    'resources/results', \r\n    'lstm',\r\n    max_epochs=50, \r\n    training_runs=3,\r\n    optimization_value=OptimizationValue.DEV_SCORE\r\n)\r\n\r\n# start the optimization\r\nparam_selector.optimize(search_space, max_evals=100)\r\n```\r\n\r\nIt yields the following stack trace:\r\n```\r\n(py36) ags@ds-vm:~/notebooks/notebooks$ python a.py\r\n2019-01-07 12:23:49,781 Reading data from /home/ags/.flair/datasets/conll_03\r\n2019-01-07 12:23:49,782 Train: /home/ags/.flair/datasets/conll_03/eng.train.openNLP\r\n2019-01-07 12:23:49,782 Dev: /home/ags/.flair/datasets/conll_03/eng.testa\r\n2019-01-07 12:23:49,782 Test: /home/ags/.flair/datasets/conll_03/eng.testb.openNLP\r\n2019-01-07 12:23:56,953 ----------------------------------------------------------------------------------------------------\r\n2019-01-07 12:23:56,953 Evaluation run: 1\r\n2019-01-07 12:23:56,953 Evaluating parameter combination:\r\n2019-01-07 12:23:56,953         dropout: 0.23348604057524586\r\n2019-01-07 12:23:56,953         embeddings: /home/ags/.flair/embeddings/lm-news-english-forward-v0.2rc.pt,/home/ags/.flair/embeddings/lm-news-english-backward-v0.2rc.pt\r\n2019-01-07 12:23:56,953         hidden_size: 32\r\n2019-01-07 12:23:56,953         learning_rate: 0.15\r\n2019-01-07 12:23:56,953         mini_batch_size: 8\r\n2019-01-07 12:23:56,953         rnn_layers: 1\r\n2019-01-07 12:23:56,953 ----------------------------------------------------------------------------------------------------\r\n2019-01-07 12:23:57,122 ----------------------------------------------------------------------------------------------------\r\n2019-01-07 12:23:57,122 Training run: 1\r\n2019-01-07 12:23:57,400 ----------------------------------------------------------------------------------------------------\r\n2019-01-07 12:23:57,400 Evaluation method: MICRO_F1_SCORE\r\n2019-01-07 12:23:57,401 ----------------------------------------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"a.py\", line 36, in <module>\r\n    param_selector.optimize(search_space, max_evals=100)\r\n  File \"/data/anaconda/envs/py36/lib/python3.6/site-packages/flair/hyperparameter/param_selection.py\", line 147, in optimize\r\n    best = fmin(self._objective, search_space, algo=tpe.suggest, max_evals=max_evals)\r\n  File \"/data/anaconda/envs/py36/lib/python3.6/site-packages/hyperopt/fmin.py\", line 385, in fmin\r\n    rval.exhaust()\r\n  File \"/data/anaconda/envs/py36/lib/python3.6/site-packages/hyperopt/fmin.py\", line 244, in exhaust\r\n    self.run(self.max_evals - n_done, block_until_done=self.asynchronous)\r\n  File \"/data/anaconda/envs/py36/lib/python3.6/site-packages/hyperopt/fmin.py\", line 218, in run\r\n    self.serial_evaluate()\r\n  File \"/data/anaconda/envs/py36/lib/python3.6/site-packages/hyperopt/fmin.py\", line 137, in serial_evaluate\r\n    result = self.domain.evaluate(spec, ctrl)\r\n  File \"/data/anaconda/envs/py36/lib/python3.6/site-packages/hyperopt/base.py\", line 840, in evaluate\r\n    rval = self.fn(pyll_rval)\r\n  File \"/data/anaconda/envs/py36/lib/python3.6/site-packages/flair/hyperparameter/param_selection.py\", line 98, in _objective\r\n    **training_params)\r\n  File \"/data/anaconda/envs/py36/lib/python3.6/site-packages/flair/trainers/trainer.py\", line 150, in train\r\n    loss = self.model.forward_loss(batch)\r\n  File \"/data/anaconda/envs/py36/lib/python3.6/site-packages/flair/models/text_classification_model.py\", line 151, in forward_loss\r\n    return self._calculate_loss(scores, sentences)\r\n  File \"/data/anaconda/envs/py36/lib/python3.6/site-packages/flair/models/text_classification_model.py\", line 202, in _calculate_loss\r\n    return self._calculate_single_label_loss(scores, sentences)\r\n  File \"/data/anaconda/envs/py36/lib/python3.6/site-packages/flair/models/text_classification_model.py\", line 240, in _calculate_single_label_loss\r\n    return self.loss_function(label_scores, self._labels_to_indices(sentences))\r\n  File \"/data/anaconda/envs/py36/lib/python3.6/site-packages/torch/nn/modules/module.py\", line 489, in __call__\r\n    result = self.forward(*input, **kwargs)\r\n  File \"/data/anaconda/envs/py36/lib/python3.6/site-packages/torch/nn/modules/loss.py\", line 904, in forward\r\n    ignore_index=self.ignore_index, reduction=self.reduction)\r\n  File \"/data/anaconda/envs/py36/lib/python3.6/site-packages/torch/nn/functional.py\", line 1970, in cross_entropy\r\n    return nll_loss(log_softmax(input, 1), target, weight, None, ignore_index, None, reduction)\r\n  File \"/data/anaconda/envs/py36/lib/python3.6/site-packages/torch/nn/functional.py\", line 1788, in nll_loss\r\n    .format(input.size(0), target.size(0)))\r\nValueError: Expected input batch_size (8) to match target batch_size (0).\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - GNU/Linux\r\n - flair-0.4.0\r\n\r\nEdit 1: grammar", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/370/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/370/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/363", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/363/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/363/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/363/events", "html_url": "https://github.com/flairNLP/flair/issues/363", "id": 396194742, "node_id": "MDU6SXNzdWUzOTYxOTQ3NDI=", "number": 363, "title": "Duplicate definition of ELMoEmbeddings", "user": {"login": "ceh", "id": 248952, "node_id": "MDQ6VXNlcjI0ODk1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/248952?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ceh", "html_url": "https://github.com/ceh", "followers_url": "https://api.github.com/users/ceh/followers", "following_url": "https://api.github.com/users/ceh/following{/other_user}", "gists_url": "https://api.github.com/users/ceh/gists{/gist_id}", "starred_url": "https://api.github.com/users/ceh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ceh/subscriptions", "organizations_url": "https://api.github.com/users/ceh/orgs", "repos_url": "https://api.github.com/users/ceh/repos", "events_url": "https://api.github.com/users/ceh/events{/privacy}", "received_events_url": "https://api.github.com/users/ceh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-01-05T19:49:45Z", "updated_at": "2019-01-06T09:25:04Z", "closed_at": "2019-01-06T09:25:03Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "There exists two class definitions of `ELMoEmbeddings`, see https://github.com/zalandoresearch/flair/blob/548b630477af8a96403e581d320adfe9464fa30f/flair/embeddings.py#L244 and https://github.com/zalandoresearch/flair/blob/548b630477af8a96403e581d320adfe9464fa30f/flair/embeddings.py#L788", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/363/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/363/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/351", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/351/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/351/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/351/events", "html_url": "https://github.com/flairNLP/flair/issues/351", "id": 395321024, "node_id": "MDU6SXNzdWUzOTUzMjEwMjQ=", "number": 351, "title": "RuntimeError: storage has wrong size when loading en-sentiment", "user": {"login": "rookie32", "id": 35496428, "node_id": "MDQ6VXNlcjM1NDk2NDI4", "avatar_url": "https://avatars.githubusercontent.com/u/35496428?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rookie32", "html_url": "https://github.com/rookie32", "followers_url": "https://api.github.com/users/rookie32/followers", "following_url": "https://api.github.com/users/rookie32/following{/other_user}", "gists_url": "https://api.github.com/users/rookie32/gists{/gist_id}", "starred_url": "https://api.github.com/users/rookie32/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rookie32/subscriptions", "organizations_url": "https://api.github.com/users/rookie32/orgs", "repos_url": "https://api.github.com/users/rookie32/repos", "events_url": "https://api.github.com/users/rookie32/events{/privacy}", "received_events_url": "https://api.github.com/users/rookie32/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2019-01-02T17:26:00Z", "updated_at": "2020-02-03T14:42:09Z", "closed_at": "2019-01-17T15:23:14Z", "author_association": "NONE", "active_lock_reason": null, "body": "When trying to load the **en-sentiment model**, I get the error:\r\n\r\nRuntimeError: storage has wrong size: expected -1862414276 got 22700\r\n\r\nI am able to load other models such as **de-offensive-language** and the **ner** SequenceTagger.\r\n\r\nCode:\r\n```\r\nfrom flair.models import TextClassifier\r\nfrom flair.data import Sentence\r\nclassifier = TextClassifier.load('en-sentiment')\r\n```\r\nPossibly related to issue https://github.com/zalandoresearch/flair/issues/172 ?\r\nBut the fix for that was merged back in November? https://github.com/zalandoresearch/flair/pull/194\r\n\r\nHave tried deleting and redownloading the model.\r\n\r\nPlatform: Windows 10, Torch 1.0 (cpu), Python 3.6.4 (Anaconda)", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/351/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/351/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/344", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/344/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/344/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/344/events", "html_url": "https://github.com/flairNLP/flair/issues/344", "id": 395067027, "node_id": "MDU6SXNzdWUzOTUwNjcwMjc=", "number": 344, "title": "Error when training my flair embedding", "user": {"login": "xuxingya", "id": 13343428, "node_id": "MDQ6VXNlcjEzMzQzNDI4", "avatar_url": "https://avatars.githubusercontent.com/u/13343428?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xuxingya", "html_url": "https://github.com/xuxingya", "followers_url": "https://api.github.com/users/xuxingya/followers", "following_url": "https://api.github.com/users/xuxingya/following{/other_user}", "gists_url": "https://api.github.com/users/xuxingya/gists{/gist_id}", "starred_url": "https://api.github.com/users/xuxingya/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xuxingya/subscriptions", "organizations_url": "https://api.github.com/users/xuxingya/orgs", "repos_url": "https://api.github.com/users/xuxingya/repos", "events_url": "https://api.github.com/users/xuxingya/events{/privacy}", "received_events_url": "https://api.github.com/users/xuxingya/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-01-01T08:57:45Z", "updated_at": "2019-02-02T12:57:30Z", "closed_at": "2019-02-02T12:57:30Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am training my flair character embedding following the Tutorial 9 using a Chinese corpus. Everything went well until an error occurred at the end of split 3 epoch 2. \r\n\r\n> RuntimeError: invalid argument 2: invalid multinomial distribution (encountering probability entry = infinity or NaN) at /pytorch/aten/src/TH/generic/THTensorRandom.cpp:302\r\n\r\nHere is the screen shot:\r\n![image](https://user-images.githubusercontent.com/13343428/50571321-7c424a80-0de2-11e9-9d23-c03aed95560e.png)\r\n\r\nIt looks like some rows of  'word_weights' happened to be NaN or infinity. But it takes too much time to reproduce the problem. I just used the code in Tutorial 9 to create my vocab.\r\n\r\nMy system is Ubuntu18, Python3, with torch 1.0.0.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/344/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/344/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/343", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/343/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/343/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/343/events", "html_url": "https://github.com/flairNLP/flair/issues/343", "id": 394924893, "node_id": "MDU6SXNzdWUzOTQ5MjQ4OTM=", "number": 343, "title": "Error when importing flair", "user": {"login": "cogmeta", "id": 10062479, "node_id": "MDQ6VXNlcjEwMDYyNDc5", "avatar_url": "https://avatars.githubusercontent.com/u/10062479?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cogmeta", "html_url": "https://github.com/cogmeta", "followers_url": "https://api.github.com/users/cogmeta/followers", "following_url": "https://api.github.com/users/cogmeta/following{/other_user}", "gists_url": "https://api.github.com/users/cogmeta/gists{/gist_id}", "starred_url": "https://api.github.com/users/cogmeta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cogmeta/subscriptions", "organizations_url": "https://api.github.com/users/cogmeta/orgs", "repos_url": "https://api.github.com/users/cogmeta/repos", "events_url": "https://api.github.com/users/cogmeta/events{/privacy}", "received_events_url": "https://api.github.com/users/cogmeta/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2018-12-31T03:48:55Z", "updated_at": "2018-12-31T06:19:06Z", "closed_at": "2018-12-31T06:19:06Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nImortError /usr/local/lib/python3.6/dist-packages/torch/lib/libcaffe2.so: undefined symbol: mkldnn_primitive_attr_destroy\r\n\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior (e.g. which model did you train? what parameters did you use? etc.).\r\npython3.6 -c \"import flair\"\r\n\r\n\r\n\r\n**Expected behavior**\r\nload the module\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\nLinux ubuntu 16.04\r\n\r\n**Additional context**\r\nTraceback (most recent call last):\r\n  File \"<string>\", line 1, in <module>\r\n  File \"/home/psasatte/exp/flair/flair/__init__.py\", line 1, in <module>\r\n    from . import data\r\n  File \"/home/psasatte/exp/flair/flair/data.py\", line 4, in <module>\r\n    import torch\r\n  File \"/usr/local/lib/python3.6/dist-packages/torch/__init__.py\", line 84, in <module>\r\n    from torch._C import *\r\nImportError: /usr/local/lib/python3.6/dist-packages/torch/lib/libcaffe2.so: undefined symbol: mkldnn_primitive_attr_destroy\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/343/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/343/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/340", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/340/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/340/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/340/events", "html_url": "https://github.com/flairNLP/flair/issues/340", "id": 394866382, "node_id": "MDU6SXNzdWUzOTQ4NjYzODI=", "number": 340, "title": "TypeError: unsupported operand type(s) for /: 'str' and 'str' in language_model_trainer.py", "user": {"login": "xuxingya", "id": 13343428, "node_id": "MDQ6VXNlcjEzMzQzNDI4", "avatar_url": "https://avatars.githubusercontent.com/u/13343428?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xuxingya", "html_url": "https://github.com/xuxingya", "followers_url": "https://api.github.com/users/xuxingya/followers", "following_url": "https://api.github.com/users/xuxingya/following{/other_user}", "gists_url": "https://api.github.com/users/xuxingya/gists{/gist_id}", "starred_url": "https://api.github.com/users/xuxingya/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xuxingya/subscriptions", "organizations_url": "https://api.github.com/users/xuxingya/orgs", "repos_url": "https://api.github.com/users/xuxingya/repos", "events_url": "https://api.github.com/users/xuxingya/events{/privacy}", "received_events_url": "https://api.github.com/users/xuxingya/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2018-12-30T11:57:28Z", "updated_at": "2018-12-30T15:57:51Z", "closed_at": "2018-12-30T15:57:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "An error occured when I try to train my own embedding following Tutorial 9. My system is Ubuntu 18 and python3.6.\r\n```\r\ncorpus = TextCorpus('/data/resume_extract_file/corpus',\r\n                    dictionary,\r\n                    is_forward_lm,\r\n                    character_level=True)\r\n```\r\n![image](https://user-images.githubusercontent.com/13343428/50547009-9fe38480-0c6c-11e9-8bab-ffcbca7a73d1.png)\r\nIt looks like the problem was occurred by the 24 line of flair/flair/trainers/language_model_trainer.py\r\nself.train_path = path / 'train'.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/340/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/340/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/339", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/339/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/339/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/339/events", "html_url": "https://github.com/flairNLP/flair/issues/339", "id": 394844097, "node_id": "MDU6SXNzdWUzOTQ4NDQwOTc=", "number": 339, "title": "EOFError: Ran out of input", "user": {"login": "Huijun-Cui", "id": 28998174, "node_id": "MDQ6VXNlcjI4OTk4MTc0", "avatar_url": "https://avatars.githubusercontent.com/u/28998174?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Huijun-Cui", "html_url": "https://github.com/Huijun-Cui", "followers_url": "https://api.github.com/users/Huijun-Cui/followers", "following_url": "https://api.github.com/users/Huijun-Cui/following{/other_user}", "gists_url": "https://api.github.com/users/Huijun-Cui/gists{/gist_id}", "starred_url": "https://api.github.com/users/Huijun-Cui/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Huijun-Cui/subscriptions", "organizations_url": "https://api.github.com/users/Huijun-Cui/orgs", "repos_url": "https://api.github.com/users/Huijun-Cui/repos", "events_url": "https://api.github.com/users/Huijun-Cui/events{/privacy}", "received_events_url": "https://api.github.com/users/Huijun-Cui/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-12-30T03:54:42Z", "updated_at": "2019-01-02T14:40:24Z", "closed_at": "2019-01-02T14:40:24Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nWhen I load the previous trained model from check point this bug happend\r\n\r\n**To Reproduce**\r\nfrom pathlib import Path\r\nfrom flair.trainers import ModelTrainer\r\nfrom flair.data import TaggedCorpus\r\npath = './checkpoint_log/glove'\r\ndata_path = './datasets'\r\ncolumns = {0: 'text', 1: 'ner'}\r\nfrom flair.data_fetcher import NLPTaskDataFetcher\r\ncorpus: TaggedCorpus = NLPTaskDataFetcher.load_column_corpus(data_path, columns,\r\n                                                                 train_file='train.txt',\r\n                                                                 test_file='test.txt',\r\n                                                                 dev_file='test.txt')\r\ntrainer = ModelTrainer.load_from_checkpoint(Path(path + '/final-model.pt'),'SequenceTagger', corpus)\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/339/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/339/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/337", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/337/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/337/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/337/events", "html_url": "https://github.com/flairNLP/flair/issues/337", "id": 394662897, "node_id": "MDU6SXNzdWUzOTQ2NjI4OTc=", "number": 337, "title": "torch 1.0.0 and the GLIBC_2.14 in flair installation", "user": {"login": "nooralahzadeh", "id": 1093791, "node_id": "MDQ6VXNlcjEwOTM3OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/1093791?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nooralahzadeh", "html_url": "https://github.com/nooralahzadeh", "followers_url": "https://api.github.com/users/nooralahzadeh/followers", "following_url": "https://api.github.com/users/nooralahzadeh/following{/other_user}", "gists_url": "https://api.github.com/users/nooralahzadeh/gists{/gist_id}", "starred_url": "https://api.github.com/users/nooralahzadeh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nooralahzadeh/subscriptions", "organizations_url": "https://api.github.com/users/nooralahzadeh/orgs", "repos_url": "https://api.github.com/users/nooralahzadeh/repos", "events_url": "https://api.github.com/users/nooralahzadeh/events{/privacy}", "received_events_url": "https://api.github.com/users/nooralahzadeh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178848, "node_id": "MDU6TGFiZWw5NjExNzg4NDg=", "url": "https://api.github.com/repos/flairNLP/flair/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": "This will not be worked on"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2018-12-28T15:39:48Z", "updated_at": "2020-05-07T04:15:41Z", "closed_at": "2020-05-07T04:15:41Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Describe the bug**\r\nA clear and concise description of what the bug is.\r\nSince torch 1.0.0 in the system which has GLIBC <2.14 should be installed from the source and in Flair 0.4.4 installation it try to reinstall torch 1.0.0. \r\nIt causes problem for the system which has GLIBC <2.14.\r\nwhat is your advice? install from the source ?\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - OS [e.g. iOS, Linux]: LINUX CUDA 9\r\n - Version [e.g. flair-0.3.2]: flair 0.4.0\r\n\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/337/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/337/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/336", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/336/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/336/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/336/events", "html_url": "https://github.com/flairNLP/flair/issues/336", "id": 394563609, "node_id": "MDU6SXNzdWUzOTQ1NjM2MDk=", "number": 336, "title": "Japanese word embeddings", "user": {"login": "frtacoa", "id": 46212658, "node_id": "MDQ6VXNlcjQ2MjEyNjU4", "avatar_url": "https://avatars.githubusercontent.com/u/46212658?v=4", "gravatar_id": "", "url": "https://api.github.com/users/frtacoa", "html_url": "https://github.com/frtacoa", "followers_url": "https://api.github.com/users/frtacoa/followers", "following_url": "https://api.github.com/users/frtacoa/following{/other_user}", "gists_url": "https://api.github.com/users/frtacoa/gists{/gist_id}", "starred_url": "https://api.github.com/users/frtacoa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/frtacoa/subscriptions", "organizations_url": "https://api.github.com/users/frtacoa/orgs", "repos_url": "https://api.github.com/users/frtacoa/repos", "events_url": "https://api.github.com/users/frtacoa/events{/privacy}", "received_events_url": "https://api.github.com/users/frtacoa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2018-12-28T06:57:52Z", "updated_at": "2019-02-04T07:51:57Z", "closed_at": "2019-02-02T12:56:07Z", "author_association": "NONE", "active_lock_reason": null, "body": "**Bug Description**\r\nThere seems to be a problem with the embeddings from `WordEmbeddings('ja')`. Cosine similarity values, even for non-related words, are quite high (over 0.99) for some words that I tried.\r\n\r\n**How To Reproduce**\r\nYou can use the following code to obtain the results as shown in the table. You can also try any other words in `Sentence`.\r\n\r\n```python\r\nimport pandas as pd\r\nimport scipy.spatial.distance as sp_sp_d\r\n\r\nfrom flair.embeddings import WordEmbeddings\r\nfrom flair.data import Sentence\r\n\r\ndef get_similarities(sentence_with_embeddings):\r\n    def sim_cos(m_dist):\r\n        \"\"\"\r\n        m_dist: NumPy matrix of cosine distances\r\n        \"\"\"\r\n        return 1. - m_dist\r\n\r\n    rows = []\r\n    indexes = []\r\n    for token in sentence_with_embeddings:\r\n        indexes.append(token.text)\r\n        rows.append(token.embedding.tolist())\r\n\r\n    df_var = pd.DataFrame(data=rows, index=indexes)\r\n\r\n    similarities = sim_cos(sp_sp_d.squareform(sp_sp_d.pdist(df_var, metric=\"cosine\")))\r\n    df_similarities = pd.DataFrame(similarities, columns=df_var.index, index=df_var.index)\r\n\r\n    return df_similarities\r\n\r\nemb_w = WordEmbeddings(\"ja\")\r\nsentence = Sentence('\u5973\u6027 \u7537\u6027 \u30c6\u30ec\u30d3 \u30ab\u30e1\u30e9 \u826f\u3044 \u60aa\u3044 \u81ea\u52d5\u8eca \u81ea\u8ee2\u8eca')\r\nemb_w.embed(sentence)\r\nprint(get_similarities(sentence))\r\n```\r\n\r\n| - | \u5973\u6027 | \u7537\u6027 | \u30c6\u30ec\u30d3 | \u30ab\u30e1\u30e9 | \u826f\u3044 | \u60aa\u3044 | \u81ea\u52d5\u8eca | \u81ea\u8ee2\u8eca |\r\n| --- | --- | --- | --- | --- | --- | --- | --- | --- |\r\n| **\u5973\u6027** | 1 | 0.999608 | 0.996616 | 0.996018 | 0.998129 | 0.998028 | 0.99521 | 0.995282 |\r\n| **\u7537\u6027** | 0.999608 | 1 | 0.996403 | 0.995786 | 0.997812 | 0.997738 | 0.99489 | 0.995252 |\r\n| **\u30c6\u30ec\u30d3** | 0.996616 | 0.996403 | 1 | 0.995157 | 0.996294 | 0.996275 | 0.994128 | 0.9936 |\r\n| **\u30ab\u30e1\u30e9** | 0.996018 | 0.995786 | 0.995157 | 1 | 0.995801 | 0.995882 | 0.993967 | 0.99405 |\r\n| **\u826f\u3044** | 0.998129 | 0.997812 | 0.996294 | 0.995801 | 1 | 0.999383 | 0.995239 | 0.995114 |\r\n| **\u60aa\u3044** | 0.998028 | 0.997738 | 0.996275 | 0.995882 | 0.999383 | 1 | 0.995312 | 0.995094 |\r\n| **\u81ea\u52d5\u8eca** | 0.99521 | 0.99489 | 0.994128 | 0.993967 | 0.995239 | 0.995312 | 1 | 0.995938 |\r\n| **\u81ea\u8ee2\u8eca** | 0.995282 | 0.995252 | 0.9936 | 0.99405 | 0.995114 | 0.995094 | 0.995938 | 1 |\r\n\r\n\r\n**Expected behavior**\r\nWe tried with the embeddings for the corresponding English words and we got the following cosine similarity values:\r\n\r\n```python\r\n...\r\nemb_w = WordEmbeddings(\"en\")\r\nsentence = Sentence('woman man TV camera good bad car bicycle')\r\n...\r\n```\r\n\r\n|  | woman | man | TV | camera | good | bad | car | bicycle |\r\n| --- | --- | --- | --- | --- | --- | --- | --- | --- |\r\n| **woman** | 1 | 0.816452 | 0.354311 | 0.453366 | 0.284441 | 0.2667 | 0.475489 | 0.403567 |\r\n| **man** | 0.816452 | 1 | 0.370918 | 0.468699 | 0.374932 | 0.336473 | 0.495137 | 0.447826 |\r\n| **TV** | 0.354311 | 0.370918 | 1 | 0.537882 | 0.284823 | 0.300671 | 0.493515 | 0.322759 |\r\n| **camera** | 0.453366 | 0.468699 | 0.537882 | 1 | 0.257566 | 0.26908 | 0.52313 | 0.423916 |\r\n| **good** | 0.284441 | 0.374932 | 0.284823 | 0.257566 | 1 | 0.833116 | 0.246164 | 0.269814 |\r\n| **bad** | 0.2667 | 0.336473 | 0.300671 | 0.26908 | 0.833116 | 1 | 0.283125 | 0.249673 |\r\n| **car** | 0.475489 | 0.495137 | 0.493515 | 0.52313 | 0.246164 | 0.283125 | 1 | 0.586903 |\r\n| **bicycle** | 0.403567 | 0.447826 | 0.322759 | 0.423916 | 0.269814 | 0.249673 | 0.586903 | 1 |\r\n\r\nWe were expecting that the cosine similarities for Japanese words look kind of similar to these.\r\n\r\n**Environment:**\r\n - OS: Linux (Ubuntu 14.04)\r\n - Version: flair-0.4.0\r\n\r\nThank you in advance for all your help!", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/336/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/336/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/327", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/327/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/327/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/327/events", "html_url": "https://github.com/flairNLP/flair/issues/327", "id": 393819676, "node_id": "MDU6SXNzdWUzOTM4MTk2NzY=", "number": 327, "title": "UnboundLocalError: local variable 'index' referenced before assignment", "user": {"login": "SatyaRamGV", "id": 42137696, "node_id": "MDQ6VXNlcjQyMTM3Njk2", "avatar_url": "https://avatars.githubusercontent.com/u/42137696?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SatyaRamGV", "html_url": "https://github.com/SatyaRamGV", "followers_url": "https://api.github.com/users/SatyaRamGV/followers", "following_url": "https://api.github.com/users/SatyaRamGV/following{/other_user}", "gists_url": "https://api.github.com/users/SatyaRamGV/gists{/gist_id}", "starred_url": "https://api.github.com/users/SatyaRamGV/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SatyaRamGV/subscriptions", "organizations_url": "https://api.github.com/users/SatyaRamGV/orgs", "repos_url": "https://api.github.com/users/SatyaRamGV/repos", "events_url": "https://api.github.com/users/SatyaRamGV/events{/privacy}", "received_events_url": "https://api.github.com/users/SatyaRamGV/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2018-12-24T06:32:41Z", "updated_at": "2019-05-28T20:36:57Z", "closed_at": "2019-01-02T14:39:37Z", "author_association": "NONE", "active_lock_reason": null, "body": "gets index not initialized error, while embedding the sentences\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - OS [ Linux]:\r\n - Version [flair-0.4]:\r\n\r\n\r\n```\r\n<ipython-input-88-53d61387c238> in get_similarities(qa)\r\n      3 \r\n      4 def get_similarities(qa):\r\n----> 5     sents = list(map(Sentence,qa))\r\n      6     embeddings.embed(sents)\r\n      7     return list(map(get_cosim,sents))\r\n\r\n~/.local/lib/python3.6/site-packages/flair/data.py in __init__(self, text, use_tokenizer, labels)\r\n    337                         word += char\r\n    338                 # increment for last token in sentence if not followed by whtespace\r\n--> 339                 index += 1\r\n    340                 if len(word) > 0:\r\n    341                     token = Token(word, start_position=index-len(word))\r\n\r\nUnboundLocalError: local variable 'index' referenced before assignment\r\n```", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/327/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/327/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/325", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/325/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/325/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/325/events", "html_url": "https://github.com/flairNLP/flair/issues/325", "id": 393604800, "node_id": "MDU6SXNzdWUzOTM2MDQ4MDA=", "number": 325, "title": "torch errors when I try Bert embeddings", "user": {"login": "mvss80", "id": 5709876, "node_id": "MDQ6VXNlcjU3MDk4NzY=", "avatar_url": "https://avatars.githubusercontent.com/u/5709876?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mvss80", "html_url": "https://github.com/mvss80", "followers_url": "https://api.github.com/users/mvss80/followers", "following_url": "https://api.github.com/users/mvss80/following{/other_user}", "gists_url": "https://api.github.com/users/mvss80/gists{/gist_id}", "starred_url": "https://api.github.com/users/mvss80/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mvss80/subscriptions", "organizations_url": "https://api.github.com/users/mvss80/orgs", "repos_url": "https://api.github.com/users/mvss80/repos", "events_url": "https://api.github.com/users/mvss80/events{/privacy}", "received_events_url": "https://api.github.com/users/mvss80/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 14, "created_at": "2018-12-21T22:13:24Z", "updated_at": "2019-02-15T19:24:29Z", "closed_at": "2019-01-15T07:45:00Z", "author_association": "NONE", "active_lock_reason": null, "body": "I'm on Ubuntu 18.04 with Intel\u00ae Core\u2122 i5-8400 CPU @ 2.80GHz \u00d7 6  and GeForce GTX 1080/PCIe/SSE2.\r\nI have pytorch 1.0 and installed flair. When I try the following code snippet\r\n```\r\nfrom flair.embeddings import BertEmbeddings, FlairEmbeddings\r\nfrom flair.data import Sentence\r\n\r\nBertEmbedding = BertEmbeddings()\r\nsent = Sentence('I love Austin')\r\nBertEmbedding.embed(sent)\r\n\r\n# fe = FlairEmbeddings('news-forward')\r\n# fe.embed(sent)\r\n```\r\nI get this error. My pytorch installation seems to be fine. Any ideas on how to fix this?\r\n```\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-1-47fbfcb3fd4f> in <module>\r\n      5 BertEmbedding = BertEmbeddings()\r\n      6 sent = Sentence('I love Austin')\r\n----> 7 BertEmbedding.embed(sent)\r\n      8 # fe.embed(sent)\r\n\r\n~/anaconda3/envs/gpu-dev/lib/python3.6/site-packages/flair/embeddings.py in embed(self, sentences)\r\n     54 \r\n     55         if not everything_embedded or not self.static_embeddings:\r\n---> 56             self._add_embeddings_internal(sentences)\r\n     57 \r\n     58         return sentences\r\n\r\n~/anaconda3/envs/gpu-dev/lib/python3.6/site-packages/flair/embeddings.py in _add_embeddings_internal(self, sentences)\r\n    957         # put encoded batch through BERT model to get all hidden states of all encoder layers\r\n    958         self.model.eval()\r\n--> 959         all_encoder_layers, _ = self.model(all_input_ids, token_type_ids=None, attention_mask=all_input_masks)\r\n    960 \r\n    961         with torch.no_grad():\r\n\r\n~/anaconda3/envs/gpu-dev/lib/python3.6/site-packages/torch/nn/modules/module.py in __call__(self, *input, **kwargs)\r\n    487             result = self._slow_forward(*input, **kwargs)\r\n    488         else:\r\n--> 489             result = self.forward(*input, **kwargs)\r\n    490         for hook in self._forward_hooks.values():\r\n    491             hook_result = hook(self, input, result)\r\n\r\n~/anaconda3/envs/gpu-dev/lib/python3.6/site-packages/pytorch_pretrained_bert/modeling.py in forward(self, input_ids, token_type_ids, attention_mask, output_all_encoded_layers)\r\n    607         extended_attention_mask = (1.0 - extended_attention_mask) * -10000.0\r\n    608 \r\n--> 609         embedding_output = self.embeddings(input_ids, token_type_ids)\r\n    610         encoded_layers = self.encoder(embedding_output,\r\n    611                                       extended_attention_mask,\r\n\r\n~/anaconda3/envs/gpu-dev/lib/python3.6/site-packages/torch/nn/modules/module.py in __call__(self, *input, **kwargs)\r\n    487             result = self._slow_forward(*input, **kwargs)\r\n    488         else:\r\n--> 489             result = self.forward(*input, **kwargs)\r\n    490         for hook in self._forward_hooks.values():\r\n    491             hook_result = hook(self, input, result)\r\n\r\n~/anaconda3/envs/gpu-dev/lib/python3.6/site-packages/pytorch_pretrained_bert/modeling.py in forward(self, input_ids, token_type_ids)\r\n    191             token_type_ids = torch.zeros_like(input_ids)\r\n    192 \r\n--> 193         words_embeddings = self.word_embeddings(input_ids)\r\n    194         position_embeddings = self.position_embeddings(position_ids)\r\n    195         token_type_embeddings = self.token_type_embeddings(token_type_ids)\r\n\r\n~/anaconda3/envs/gpu-dev/lib/python3.6/site-packages/torch/nn/modules/module.py in __call__(self, *input, **kwargs)\r\n    487             result = self._slow_forward(*input, **kwargs)\r\n    488         else:\r\n--> 489             result = self.forward(*input, **kwargs)\r\n    490         for hook in self._forward_hooks.values():\r\n    491             hook_result = hook(self, input, result)\r\n\r\n~/anaconda3/envs/gpu-dev/lib/python3.6/site-packages/torch/nn/modules/sparse.py in forward(self, input)\r\n    116         return F.embedding(\r\n    117             input, self.weight, self.padding_idx, self.max_norm,\r\n--> 118             self.norm_type, self.scale_grad_by_freq, self.sparse)\r\n    119 \r\n    120     def extra_repr(self):\r\n\r\n~/anaconda3/envs/gpu-dev/lib/python3.6/site-packages/torch/nn/functional.py in embedding(input, weight, padding_idx, max_norm, norm_type, scale_grad_by_freq, sparse)\r\n   1452         # remove once script supports set_grad_enabled\r\n   1453         _no_grad_embedding_renorm_(weight, input, max_norm, norm_type)\r\n-> 1454     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)\r\n   1455 \r\n   1456 \r\n\r\nRuntimeError: Expected object of backend CPU but got backend CUDA for argument #3 'index'\r\n```", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/325/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/325/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/322", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/322/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/322/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/322/events", "html_url": "https://github.com/flairNLP/flair/issues/322", "id": 393475715, "node_id": "MDU6SXNzdWUzOTM0NzU3MTU=", "number": 322, "title": "generate_text() throws error with small temperatures", "user": {"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2018-12-21T14:22:59Z", "updated_at": "2018-12-22T10:35:31Z", "closed_at": "2018-12-22T10:35:31Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "The 'generate_text()' method of the LanguageModel class throws an overflow error in certain cases, especially when the 'temperature' variable is set to be small. \r\n\r\n**To Reproduce**\r\n```python\r\nfrom flair.embeddings import FlairEmbeddings\r\n\r\nlanguage_model = FlairEmbeddings('news-forward').lm\r\n\r\nlanguage_model.generate_text(temperature=0.01, number_of_characters=100)\r\n```\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/322/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/322/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/310", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/310/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/310/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/310/events", "html_url": "https://github.com/flairNLP/flair/issues/310", "id": 391061310, "node_id": "MDU6SXNzdWUzOTEwNjEzMTA=", "number": 310, "title": "Fix failing travis build", "user": {"login": "tabergma", "id": 7203823, "node_id": "MDQ6VXNlcjcyMDM4MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7203823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tabergma", "html_url": "https://github.com/tabergma", "followers_url": "https://api.github.com/users/tabergma/followers", "following_url": "https://api.github.com/users/tabergma/following{/other_user}", "gists_url": "https://api.github.com/users/tabergma/gists{/gist_id}", "starred_url": "https://api.github.com/users/tabergma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tabergma/subscriptions", "organizations_url": "https://api.github.com/users/tabergma/orgs", "repos_url": "https://api.github.com/users/tabergma/repos", "events_url": "https://api.github.com/users/tabergma/events{/privacy}", "received_events_url": "https://api.github.com/users/tabergma/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "tabergma", "id": 7203823, "node_id": "MDQ6VXNlcjcyMDM4MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7203823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tabergma", "html_url": "https://github.com/tabergma", "followers_url": "https://api.github.com/users/tabergma/followers", "following_url": "https://api.github.com/users/tabergma/following{/other_user}", "gists_url": "https://api.github.com/users/tabergma/gists{/gist_id}", "starred_url": "https://api.github.com/users/tabergma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tabergma/subscriptions", "organizations_url": "https://api.github.com/users/tabergma/orgs", "repos_url": "https://api.github.com/users/tabergma/repos", "events_url": "https://api.github.com/users/tabergma/events{/privacy}", "received_events_url": "https://api.github.com/users/tabergma/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tabergma", "id": 7203823, "node_id": "MDQ6VXNlcjcyMDM4MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7203823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tabergma", "html_url": "https://github.com/tabergma", "followers_url": "https://api.github.com/users/tabergma/followers", "following_url": "https://api.github.com/users/tabergma/following{/other_user}", "gists_url": "https://api.github.com/users/tabergma/gists{/gist_id}", "starred_url": "https://api.github.com/users/tabergma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tabergma/subscriptions", "organizations_url": "https://api.github.com/users/tabergma/orgs", "repos_url": "https://api.github.com/users/tabergma/repos", "events_url": "https://api.github.com/users/tabergma/events{/privacy}", "received_events_url": "https://api.github.com/users/tabergma/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2018-12-14T10:51:23Z", "updated_at": "2018-12-14T11:12:32Z", "closed_at": "2018-12-14T11:12:32Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "**Describe the bug**\r\nThe Travis build on master is failing due to `ModuleNotFoundError: No module named 'google_compute_engine'` (see [console log](https://travis-ci.org/zalandoresearch/flair/builds/467919455?utm_source=github_status&utm_medium=notification)).\r\n\r\n**Solution**\r\nAdd \r\n```\r\nenv:\r\n  - BOTO_CONFIG=/dev/null\r\n```\r\nto `.travis.yml`as suggested in https://github.com/travis-ci/travis-ci/issues/7940", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/310/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/310/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/282", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/282/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/282/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/282/events", "html_url": "https://github.com/flairNLP/flair/issues/282", "id": 386741751, "node_id": "MDU6SXNzdWUzODY3NDE3NTE=", "number": 282, "title": "Disable logging from dependencies", "user": {"login": "tabergma", "id": 7203823, "node_id": "MDQ6VXNlcjcyMDM4MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7203823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tabergma", "html_url": "https://github.com/tabergma", "followers_url": "https://api.github.com/users/tabergma/followers", "following_url": "https://api.github.com/users/tabergma/following{/other_user}", "gists_url": "https://api.github.com/users/tabergma/gists{/gist_id}", "starred_url": "https://api.github.com/users/tabergma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tabergma/subscriptions", "organizations_url": "https://api.github.com/users/tabergma/orgs", "repos_url": "https://api.github.com/users/tabergma/repos", "events_url": "https://api.github.com/users/tabergma/events{/privacy}", "received_events_url": "https://api.github.com/users/tabergma/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "tabergma", "id": 7203823, "node_id": "MDQ6VXNlcjcyMDM4MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7203823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tabergma", "html_url": "https://github.com/tabergma", "followers_url": "https://api.github.com/users/tabergma/followers", "following_url": "https://api.github.com/users/tabergma/following{/other_user}", "gists_url": "https://api.github.com/users/tabergma/gists{/gist_id}", "starred_url": "https://api.github.com/users/tabergma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tabergma/subscriptions", "organizations_url": "https://api.github.com/users/tabergma/orgs", "repos_url": "https://api.github.com/users/tabergma/repos", "events_url": "https://api.github.com/users/tabergma/events{/privacy}", "received_events_url": "https://api.github.com/users/tabergma/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tabergma", "id": 7203823, "node_id": "MDQ6VXNlcjcyMDM4MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7203823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tabergma", "html_url": "https://github.com/tabergma", "followers_url": "https://api.github.com/users/tabergma/followers", "following_url": "https://api.github.com/users/tabergma/following{/other_user}", "gists_url": "https://api.github.com/users/tabergma/gists{/gist_id}", "starred_url": "https://api.github.com/users/tabergma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tabergma/subscriptions", "organizations_url": "https://api.github.com/users/tabergma/orgs", "repos_url": "https://api.github.com/users/tabergma/repos", "events_url": "https://api.github.com/users/tabergma/events{/privacy}", "received_events_url": "https://api.github.com/users/tabergma/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2018-12-03T10:05:06Z", "updated_at": "2018-12-03T13:44:14Z", "closed_at": "2018-12-03T13:44:14Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "Currently, the logging configuration is overwritten by the BERT logging set up. Everything is written to stderr, log level is set to DEBUG and no file handler is applied anymore.\r\n\r\nTo avoid this, we should read our logging configuration from a file and disable existing loggers as described here: https://docs.python.org/3.5/howto/logging.html#configuring-logging", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/282/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/282/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/280", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/280/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/280/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/280/events", "html_url": "https://github.com/flairNLP/flair/issues/280", "id": 386599924, "node_id": "MDU6SXNzdWUzODY1OTk5MjQ=", "number": 280, "title": "Language model training", "user": {"login": "stefan-it", "id": 20651387, "node_id": "MDQ6VXNlcjIwNjUxMzg3", "avatar_url": "https://avatars.githubusercontent.com/u/20651387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefan-it", "html_url": "https://github.com/stefan-it", "followers_url": "https://api.github.com/users/stefan-it/followers", "following_url": "https://api.github.com/users/stefan-it/following{/other_user}", "gists_url": "https://api.github.com/users/stefan-it/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefan-it/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefan-it/subscriptions", "organizations_url": "https://api.github.com/users/stefan-it/orgs", "repos_url": "https://api.github.com/users/stefan-it/repos", "events_url": "https://api.github.com/users/stefan-it/events{/privacy}", "received_events_url": "https://api.github.com/users/stefan-it/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "tabergma", "id": 7203823, "node_id": "MDQ6VXNlcjcyMDM4MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7203823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tabergma", "html_url": "https://github.com/tabergma", "followers_url": "https://api.github.com/users/tabergma/followers", "following_url": "https://api.github.com/users/tabergma/following{/other_user}", "gists_url": "https://api.github.com/users/tabergma/gists{/gist_id}", "starred_url": "https://api.github.com/users/tabergma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tabergma/subscriptions", "organizations_url": "https://api.github.com/users/tabergma/orgs", "repos_url": "https://api.github.com/users/tabergma/repos", "events_url": "https://api.github.com/users/tabergma/events{/privacy}", "received_events_url": "https://api.github.com/users/tabergma/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tabergma", "id": 7203823, "node_id": "MDQ6VXNlcjcyMDM4MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7203823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tabergma", "html_url": "https://github.com/tabergma", "followers_url": "https://api.github.com/users/tabergma/followers", "following_url": "https://api.github.com/users/tabergma/following{/other_user}", "gists_url": "https://api.github.com/users/tabergma/gists{/gist_id}", "starred_url": "https://api.github.com/users/tabergma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tabergma/subscriptions", "organizations_url": "https://api.github.com/users/tabergma/orgs", "repos_url": "https://api.github.com/users/tabergma/repos", "events_url": "https://api.github.com/users/tabergma/events{/privacy}", "received_events_url": "https://api.github.com/users/tabergma/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-12-02T21:06:21Z", "updated_at": "2018-12-03T10:02:09Z", "closed_at": "2018-12-03T10:02:09Z", "author_association": "MEMBER", "active_lock_reason": null, "body": "Hi,\r\n\r\nwith the latest `0.4` branch, training of a language model does not work. More precisely, the `TextCorpus` class expects a `Path`-like object as training path (see [here](https://github.com/zalandoresearch/flair/blob/release-0.4/flair/trainers/language_model_trainer.py#L19)). With a `Path`-like object the following comprehension won't work:\r\n\r\n```python\r\nself.train_files = sorted(\r\n    [f for f in self.train_path.iterdir() if (self.train_path / f).exists()])\r\n```\r\n\r\n-> `(self.train_path / f).exists()` will always be empty, so the list of training files will be empty. I could temporarily fix it with using only `f.exists()` but then another error appeared.\r\n\r\nIt just want to mention this issue before the official `0.4` version is released :)", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/280/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/280/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/249", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/249/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/249/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/249/events", "html_url": "https://github.com/flairNLP/flair/issues/249", "id": 384493742, "node_id": "MDU6SXNzdWUzODQ0OTM3NDI=", "number": 249, "title": "cache directory always resets to None", "user": {"login": "ericlief", "id": 16747511, "node_id": "MDQ6VXNlcjE2NzQ3NTEx", "avatar_url": "https://avatars.githubusercontent.com/u/16747511?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ericlief", "html_url": "https://github.com/ericlief", "followers_url": "https://api.github.com/users/ericlief/followers", "following_url": "https://api.github.com/users/ericlief/following{/other_user}", "gists_url": "https://api.github.com/users/ericlief/gists{/gist_id}", "starred_url": "https://api.github.com/users/ericlief/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ericlief/subscriptions", "organizations_url": "https://api.github.com/users/ericlief/orgs", "repos_url": "https://api.github.com/users/ericlief/repos", "events_url": "https://api.github.com/users/ericlief/events{/privacy}", "received_events_url": "https://api.github.com/users/ericlief/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-11-26T20:17:32Z", "updated_at": "2018-11-28T08:30:08Z", "closed_at": "2018-11-28T08:30:08Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am running out of memory during sequence tagging and found out no cache directory existed, despite my passing it as follows:\r\n\r\n clm_fw = CharLMEmbeddings(\"/home/liefe/lm/fw_p25/best-lm.pt\", use_cache=True, cache_directory=\"/home/liefe/tag/cache\")  \r\n clm_bw = CharLMEmbeddings(\"/home/liefe/lm/bw_p25/best-lm.pt\", use_cache=True, cache_directory=\"/home/liefe/tag/cache\")     \r\n\r\nWhat looks like is happening when I inspected the _add_embeddings_internal method, is that it will always be set to None because the path is to a file that has not yet been created. When I fixed this, it now saves to the path.\r\ndef _add_embeddings_internal(self, sentences: List[Sentence]) -> List[Sentence]:\r\n        \r\n        # this whole block is for compatibility with older serialized models  TODO: remove in version 0.4\r\n        if 'cache' not in self.__dict__ or 'cache_directory' not in self.__dict__:\r\n            self.use_cache = False\r\n            self.cache_directory = None\r\n        else:\r\n            cache_path = '{}-tmp-cache.sqllite'.format(self.name) if not self.cache_directory else os.path.join(\r\n                self.cache_directory, '{}-tmp-cache.sqllite'.format(os.path.basename(self.name)))\r\n           \r\n            if not os.path.exists(cache_path):\r\n                self.use_cache = False\r\n                self.cache_directory = None\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/249/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/249/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/237", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/237/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/237/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/237/events", "html_url": "https://github.com/flairNLP/flair/issues/237", "id": 383593955, "node_id": "MDU6SXNzdWUzODM1OTM5NTU=", "number": 237, "title": "Bug in tokenizer?", "user": {"login": "JoanEspasa", "id": 31652040, "node_id": "MDQ6VXNlcjMxNjUyMDQw", "avatar_url": "https://avatars.githubusercontent.com/u/31652040?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JoanEspasa", "html_url": "https://github.com/JoanEspasa", "followers_url": "https://api.github.com/users/JoanEspasa/followers", "following_url": "https://api.github.com/users/JoanEspasa/following{/other_user}", "gists_url": "https://api.github.com/users/JoanEspasa/gists{/gist_id}", "starred_url": "https://api.github.com/users/JoanEspasa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JoanEspasa/subscriptions", "organizations_url": "https://api.github.com/users/JoanEspasa/orgs", "repos_url": "https://api.github.com/users/JoanEspasa/repos", "events_url": "https://api.github.com/users/JoanEspasa/events{/privacy}", "received_events_url": "https://api.github.com/users/JoanEspasa/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2018-11-22T16:03:47Z", "updated_at": "2018-11-23T08:56:51Z", "closed_at": "2018-11-23T08:56:51Z", "author_association": "NONE", "active_lock_reason": null, "body": "Here's a minimum viable code to reproduce:\r\n\r\n```\r\nfrom flair.data import Sentence\r\nfrom flair.models import SequenceTagger\r\n\r\nmodel = SequenceTagger.load(\"ner-ontonotes-fast\")\r\nfull_text = \"\\\"In the 1960s and 1970s...\\\" Then came Thierry Mugler and Gianni Versace.\"\r\nsentence = Sentence(full_text, use_tokenizer=True)\r\nmodel.predict(sentence)\r\nprint(f\"full text  : {full_text}\")\r\nprint(f\"text length: {len(full_text)}\")\r\nprint(\"tag\\tstart\\tend\\tto_original_text()\")\r\nfor entity in sentence.get_spans('ner'):\r\n    print(f\"{entity.tag}\\t{entity.start_pos}\\t{entity.end_pos}\\t{entity.to_original_text()}\")\r\n```\r\n\r\nOutput:\r\n\r\n``` $  python predict.py \r\nfull text  : \"In the 1960s and 1970s...\" Then came Thierry Mugler and Gianni Versace.\r\ntext length: 72\r\ntag\tstart\tend\tto_original_text()\r\nDATE\t8\t13\t1960s\r\nDATE\t18\t23\t1970s\r\nPERSON\t81\t94\tThierryMugler\r\nPERSON\t97\t110\tGianniVersace\r\n```\r\nSeems the resulting tokens have start_pos and end_pos indexes larger than the real text length. Note also that the method to_original_text() is eating the spaces, so I suppose it is related.\r\n\r\nAny ideas about what is causing the trouble?", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/237/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/237/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/233", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/233/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/233/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/233/events", "html_url": "https://github.com/flairNLP/flair/issues/233", "id": 383125190, "node_id": "MDU6SXNzdWUzODMxMjUxOTA=", "number": 233, "title": "Getting IndexError: list index out of range error", "user": {"login": "Rishav09", "id": 11032253, "node_id": "MDQ6VXNlcjExMDMyMjUz", "avatar_url": "https://avatars.githubusercontent.com/u/11032253?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Rishav09", "html_url": "https://github.com/Rishav09", "followers_url": "https://api.github.com/users/Rishav09/followers", "following_url": "https://api.github.com/users/Rishav09/following{/other_user}", "gists_url": "https://api.github.com/users/Rishav09/gists{/gist_id}", "starred_url": "https://api.github.com/users/Rishav09/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Rishav09/subscriptions", "organizations_url": "https://api.github.com/users/Rishav09/orgs", "repos_url": "https://api.github.com/users/Rishav09/repos", "events_url": "https://api.github.com/users/Rishav09/events{/privacy}", "received_events_url": "https://api.github.com/users/Rishav09/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-11-21T13:46:19Z", "updated_at": "2021-03-09T16:37:46Z", "closed_at": "2018-11-26T15:51:00Z", "author_association": "NONE", "active_lock_reason": null, "body": "I am getting `Getting IndexError:list index out of range error` when I changed the `dev_file=None`\r\nin \r\n \r\n          \r\n    corpus: TaggedCorpus = NLPTaskDataFetcher.fetch_column_corpus(data_folder, columns,\r\n                                                                  train_file='train.txt',\r\n                                                                  test_file='test.txt',\r\n                                                                   dev_file=None)\r\n\r\nI am using custom dataset .\r\nAlso ,  What does __sample() method do in data_fetcher.py ?", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/233/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/233/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/226", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/226/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/226/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/226/events", "html_url": "https://github.com/flairNLP/flair/issues/226", "id": 382213922, "node_id": "MDU6SXNzdWUzODIyMTM5MjI=", "number": 226, "title": "Non-whitespaced tokenized text results into an infinite loop", "user": {"login": "jfilter", "id": 3450307, "node_id": "MDQ6VXNlcjM0NTAzMDc=", "avatar_url": "https://avatars.githubusercontent.com/u/3450307?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jfilter", "html_url": "https://github.com/jfilter", "followers_url": "https://api.github.com/users/jfilter/followers", "following_url": "https://api.github.com/users/jfilter/following{/other_user}", "gists_url": "https://api.github.com/users/jfilter/gists{/gist_id}", "starred_url": "https://api.github.com/users/jfilter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jfilter/subscriptions", "organizations_url": "https://api.github.com/users/jfilter/orgs", "repos_url": "https://api.github.com/users/jfilter/repos", "events_url": "https://api.github.com/users/jfilter/events{/privacy}", "received_events_url": "https://api.github.com/users/jfilter/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2018-11-19T13:26:20Z", "updated_at": "2018-11-26T15:51:48Z", "closed_at": "2018-11-26T15:51:48Z", "author_association": "NONE", "active_lock_reason": null, "body": "I though my text was whitespace-tokenized, but it actually wasn't. I run into an infinite loop here:\r\n\r\nhttps://github.com/zalandoresearch/flair/blob/86485ec920e30b787c43b6b3ff094fbc4fa0c253/flair/data.py#L539-L541\r\n\r\nA safeguard would have been helpful and I am about to send a PR to add one.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/226/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/226/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/210", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/210/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/210/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/210/events", "html_url": "https://github.com/flairNLP/flair/issues/210", "id": 380618058, "node_id": "MDU6SXNzdWUzODA2MTgwNTg=", "number": 210, "title": "Add torch.no_grad() to LanguageModel.generate_text()", "user": {"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178843, "node_id": "MDU6TGFiZWw5NjExNzg4NDM=", "url": "https://api.github.com/repos/flairNLP/flair/labels/enhancement", "name": "enhancement", "color": "f9f195", "default": true, "description": "Improving of an existing feature"}], "state": "closed", "locked": false, "assignee": {"login": "tabergma", "id": 7203823, "node_id": "MDQ6VXNlcjcyMDM4MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7203823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tabergma", "html_url": "https://github.com/tabergma", "followers_url": "https://api.github.com/users/tabergma/followers", "following_url": "https://api.github.com/users/tabergma/following{/other_user}", "gists_url": "https://api.github.com/users/tabergma/gists{/gist_id}", "starred_url": "https://api.github.com/users/tabergma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tabergma/subscriptions", "organizations_url": "https://api.github.com/users/tabergma/orgs", "repos_url": "https://api.github.com/users/tabergma/repos", "events_url": "https://api.github.com/users/tabergma/events{/privacy}", "received_events_url": "https://api.github.com/users/tabergma/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tabergma", "id": 7203823, "node_id": "MDQ6VXNlcjcyMDM4MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7203823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tabergma", "html_url": "https://github.com/tabergma", "followers_url": "https://api.github.com/users/tabergma/followers", "following_url": "https://api.github.com/users/tabergma/following{/other_user}", "gists_url": "https://api.github.com/users/tabergma/gists{/gist_id}", "starred_url": "https://api.github.com/users/tabergma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tabergma/subscriptions", "organizations_url": "https://api.github.com/users/tabergma/orgs", "repos_url": "https://api.github.com/users/tabergma/repos", "events_url": "https://api.github.com/users/tabergma/events{/privacy}", "received_events_url": "https://api.github.com/users/tabergma/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2018-11-14T09:54:48Z", "updated_at": "2018-11-15T09:29:04Z", "closed_at": "2018-11-15T09:29:04Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "The autograd engine is not required when using an LM to generate text.\r\n\r\nSo, as pointed out in #167, `torch.no_grad()` needs to be added to `LanguageModel.generate_text()` for better performance and to avoid out of memory issues.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/210/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/210/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/200", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/200/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/200/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/200/events", "html_url": "https://github.com/flairNLP/flair/issues/200", "id": 379042255, "node_id": "MDU6SXNzdWUzNzkwNDIyNTU=", "number": 200, "title": "Loading a saved LM model forgets previous best validation score", "user": {"login": "omerarshad", "id": 16164105, "node_id": "MDQ6VXNlcjE2MTY0MTA1", "avatar_url": "https://avatars.githubusercontent.com/u/16164105?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omerarshad", "html_url": "https://github.com/omerarshad", "followers_url": "https://api.github.com/users/omerarshad/followers", "following_url": "https://api.github.com/users/omerarshad/following{/other_user}", "gists_url": "https://api.github.com/users/omerarshad/gists{/gist_id}", "starred_url": "https://api.github.com/users/omerarshad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omerarshad/subscriptions", "organizations_url": "https://api.github.com/users/omerarshad/orgs", "repos_url": "https://api.github.com/users/omerarshad/repos", "events_url": "https://api.github.com/users/omerarshad/events{/privacy}", "received_events_url": "https://api.github.com/users/omerarshad/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "tabergma", "id": 7203823, "node_id": "MDQ6VXNlcjcyMDM4MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7203823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tabergma", "html_url": "https://github.com/tabergma", "followers_url": "https://api.github.com/users/tabergma/followers", "following_url": "https://api.github.com/users/tabergma/following{/other_user}", "gists_url": "https://api.github.com/users/tabergma/gists{/gist_id}", "starred_url": "https://api.github.com/users/tabergma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tabergma/subscriptions", "organizations_url": "https://api.github.com/users/tabergma/orgs", "repos_url": "https://api.github.com/users/tabergma/repos", "events_url": "https://api.github.com/users/tabergma/events{/privacy}", "received_events_url": "https://api.github.com/users/tabergma/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tabergma", "id": 7203823, "node_id": "MDQ6VXNlcjcyMDM4MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7203823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tabergma", "html_url": "https://github.com/tabergma", "followers_url": "https://api.github.com/users/tabergma/followers", "following_url": "https://api.github.com/users/tabergma/following{/other_user}", "gists_url": "https://api.github.com/users/tabergma/gists{/gist_id}", "starred_url": "https://api.github.com/users/tabergma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tabergma/subscriptions", "organizations_url": "https://api.github.com/users/tabergma/orgs", "repos_url": "https://api.github.com/users/tabergma/repos", "events_url": "https://api.github.com/users/tabergma/events{/privacy}", "received_events_url": "https://api.github.com/users/tabergma/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2018-11-09T06:42:32Z", "updated_at": "2018-11-16T11:26:18Z", "closed_at": "2018-11-15T13:10:53Z", "author_association": "NONE", "active_lock_reason": null, "body": "When i load a previous trained LM model, and run few more epochs even if my model gets worst score then before it will update best-lm.pt\r\n\r\nas code suggests, as trainig start  Best val score is set to 10000 by default even if my previous score was far less than that. ", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/200/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/200/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/174", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/174/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/174/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/174/events", "html_url": "https://github.com/flairNLP/flair/issues/174", "id": 374660474, "node_id": "MDU6SXNzdWUzNzQ2NjA0NzQ=", "number": 174, "title": "Sort out serialization of large models on MacOS and Windows", "user": {"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178844, "node_id": "MDU6TGFiZWw5NjExNzg4NDQ=", "url": "https://api.github.com/repos/flairNLP/flair/labels/help%20wanted", "name": "help wanted", "color": "008672", "default": true, "description": "Extra attention is needed"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2018-10-27T16:01:26Z", "updated_at": "2018-11-07T16:29:35Z", "closed_at": "2018-11-07T16:29:35Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "We have been getting a number of reports that serialization of very large models does not work on Mac OS (#171 #23) and Windows (#172) setups. It seems that this is a problem caused by the pickle module which we use for serialization. \r\n\r\nTo reproduce the error on Windows / Mac OS, do \r\n\r\n```python\r\nfrom flair.models import SequenceTagger\r\ntagger = SequenceTagger.load('ner-ontonotes-fast')\r\n```\r\n\r\nTo fix this we need to either: \r\n- Figure out what we must do so that pickling of very large objects (>1GB) works across platforms\r\n- Find an alternative to serialization with pickle \r\n\r\nFixing this issue is a priority for us - any help from the community with mac OS / Windows setups is appreciated!\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/174/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/174/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/172", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/172/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/172/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/172/events", "html_url": "https://github.com/flairNLP/flair/issues/172", "id": 373857147, "node_id": "MDU6SXNzdWUzNzM4NTcxNDc=", "number": 172, "title": "Wrong storage size error while loading ner-ontonotes-fast", "user": {"login": "rohitmujumdar", "id": 16243719, "node_id": "MDQ6VXNlcjE2MjQzNzE5", "avatar_url": "https://avatars.githubusercontent.com/u/16243719?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rohitmujumdar", "html_url": "https://github.com/rohitmujumdar", "followers_url": "https://api.github.com/users/rohitmujumdar/followers", "following_url": "https://api.github.com/users/rohitmujumdar/following{/other_user}", "gists_url": "https://api.github.com/users/rohitmujumdar/gists{/gist_id}", "starred_url": "https://api.github.com/users/rohitmujumdar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rohitmujumdar/subscriptions", "organizations_url": "https://api.github.com/users/rohitmujumdar/orgs", "repos_url": "https://api.github.com/users/rohitmujumdar/repos", "events_url": "https://api.github.com/users/rohitmujumdar/events{/privacy}", "received_events_url": "https://api.github.com/users/rohitmujumdar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178844, "node_id": "MDU6TGFiZWw5NjExNzg4NDQ=", "url": "https://api.github.com/repos/flairNLP/flair/labels/help%20wanted", "name": "help wanted", "color": "008672", "default": true, "description": "Extra attention is needed"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2018-10-25T09:34:36Z", "updated_at": "2018-10-27T16:02:33Z", "closed_at": "2018-10-27T16:02:33Z", "author_association": "NONE", "active_lock_reason": null, "body": "Stack trace : \r\n>>> tagger = SequenceTagger.load('ner-ontonotes-fast')\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\flair-0.3.1-py3.7.egg\\flair\\m\r\nodels\\sequence_tagger_model.py\", line 566, in load\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\flair-0.3.1-py3.7.egg\\flair\\m\r\nodels\\sequence_tagger_model.py\", line 157, in load_from_file\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\serialization.py\", line\r\n 358, in load\r\n    return _load(f, map_location, pickle_module)\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\torch\\serialization.py\", line\r\n 549, in _load\r\n    deserialized_objects[key]._set_from_file(f, offset, f_should_read_directly)\r\nRuntimeError: storage has wrong size: expected -1497503119 got 2348\r\n\r\nConfiguration Details :   \r\n\r\nPython = 3.7\r\nTorch = 0.4.1\r\nCPU = 8GB RAM, no GPU \r\n\r\nhas anyone else got this issue? ", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/172/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/172/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/171", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/171/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/171/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/171/events", "html_url": "https://github.com/flairNLP/flair/issues/171", "id": 373569711, "node_id": "MDU6SXNzdWUzNzM1Njk3MTE=", "number": 171, "title": "Pytorch Serialization error when training NER tagger with de-fasttext word embeddings", "user": {"login": "mhham", "id": 26010469, "node_id": "MDQ6VXNlcjI2MDEwNDY5", "avatar_url": "https://avatars.githubusercontent.com/u/26010469?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mhham", "html_url": "https://github.com/mhham", "followers_url": "https://api.github.com/users/mhham/followers", "following_url": "https://api.github.com/users/mhham/following{/other_user}", "gists_url": "https://api.github.com/users/mhham/gists{/gist_id}", "starred_url": "https://api.github.com/users/mhham/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mhham/subscriptions", "organizations_url": "https://api.github.com/users/mhham/orgs", "repos_url": "https://api.github.com/users/mhham/repos", "events_url": "https://api.github.com/users/mhham/events{/privacy}", "received_events_url": "https://api.github.com/users/mhham/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178844, "node_id": "MDU6TGFiZWw5NjExNzg4NDQ=", "url": "https://api.github.com/repos/flairNLP/flair/labels/help%20wanted", "name": "help wanted", "color": "008672", "default": true, "description": "Extra attention is needed"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2018-10-24T16:29:18Z", "updated_at": "2018-10-27T16:03:20Z", "closed_at": "2018-10-27T16:03:20Z", "author_association": "NONE", "active_lock_reason": null, "body": "When training an NER sequence tagger with `WordEmbeddings('de-fasttext')` I get a torch serialization error, right after the first epoch.\r\n\r\nCode:\r\n\r\n```\r\nfrom flair.data_fetcher import NLPTask\r\nfrom flair.embeddings import CharacterEmbeddings, CharLMEmbeddings, TokenEmbeddings, WordEmbeddings, StackedEmbeddings\r\nfrom typing import List\r\n\r\n# 1. get the corpus\r\ncorpus = downsampled_corpus \r\n\r\n# 2. what tag do we want to predict?\r\ntag_type = 'ner'\r\n\r\n# 3. make the tag dictionary from the corpus\r\ntag_dictionary = corpus.make_tag_dictionary(tag_type=tag_type)\r\nprint(tag_dictionary.idx2item)\r\n\r\n\r\n# 4. initialize embeddings\r\nembedding_types: List[TokenEmbeddings] = [\r\n\r\n    WordEmbeddings('de-fasttext') #Defined in the WordEmbeddings class\r\n\r\n    # comment in this line to use character embeddings\r\n    # CharacterEmbeddings(),\r\n\r\n    # comment in these lines to use contextual string embeddings\r\n    #CharLMEmbeddings('news-forward'),\r\n    #CharLMEmbeddings('news-backward'),\r\n]\r\n\r\nembeddings: StackedEmbeddings = StackedEmbeddings(embeddings=embedding_types)\r\n\r\n# 5. initialize sequence tagger\r\nfrom flair.models import SequenceTagger\r\n\r\ntagger: SequenceTagger = SequenceTagger(hidden_size=256,\r\n                                        embeddings=embeddings,\r\n                                        tag_dictionary=tag_dictionary,\r\n                                        tag_type=tag_type,\r\n                                        use_crf=True)\r\n\r\n# 6. initialize trainer\r\nfrom flair.trainers import SequenceTaggerTrainer\r\n\r\ntrainer: SequenceTaggerTrainer = SequenceTaggerTrainer(tagger, corpus)\r\n\r\n# 7. start training\r\ntrainer.train('resources/taggers/example-ner',\r\n              learning_rate=0.1,\r\n              mini_batch_size=32,\r\n              max_epochs=10)\r\n```\r\n\r\nGives the following error :\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nOSError                                   Traceback (most recent call last)\r\n<ipython-input-6-de6d08c3eb5d> in <module>()\r\n     47               learning_rate=0.1,\r\n     48               mini_batch_size=32,\r\n---> 49               max_epochs=10)\r\n\r\n.../lib/python3.7/site-packages/flair/trainers/sequence_tagger_trainer.py in train(self, base_path, learning_rate, mini_batch_size, max_epochs, anneal_factor, patience, train_with_dev, embeddings_in_memory, checkpoint, save_final_model, anneal_with_restarts)\r\n    161                 # if we use dev data, remember best model based on dev evaluation score\r\n    162                 if not train_with_dev and dev_score == scheduler.best:\r\n--> 163                     self.model.save(base_path + \"/best-model.pt\")\r\n    164 \r\n    165             # if we do not use dev data for model selection, save final model\r\n\r\n.../lib/python3.7/site-packages/flair/models/sequence_tagger_model.py in save(self, model_file)\r\n    149             'rnn_layers': self.rnn_layers,\r\n    150         }\r\n--> 151         torch.save(model_state, model_file, pickle_protocol=4)\r\n    152 \r\n    153     @classmethod\r\n\r\n.../lib/python3.7/site-packages/torch/serialization.py in save(obj, f, pickle_module, pickle_protocol)\r\n    207         >>> torch.save(x, buffer)\r\n    208     \"\"\"\r\n--> 209     return _with_file_like(f, \"wb\", lambda f: _save(obj, f, pickle_module, pickle_protocol))\r\n    210 \r\n    211 \r\n\r\n.../lib/python3.7/site-packages/torch/serialization.py in _with_file_like(f, mode, body)\r\n    132         f = open(f, mode)\r\n    133     try:\r\n--> 134         return body(f)\r\n    135     finally:\r\n    136         if new_fd:\r\n\r\n.../lib/python3.7/site-packages/torch/serialization.py in <lambda>(f)\r\n    207         >>> torch.save(x, buffer)\r\n    208     \"\"\"\r\n--> 209     return _with_file_like(f, \"wb\", lambda f: _save(obj, f, pickle_module, pickle_protocol))\r\n    210 \r\n    211 \r\n\r\n.../lib/python3.7/site-packages/torch/serialization.py in _save(obj, f, pickle_module, pickle_protocol)\r\n    280     pickler = pickle_module.Pickler(f, protocol=pickle_protocol)\r\n    281     pickler.persistent_id = persistent_id\r\n--> 282     pickler.dump(obj)\r\n    283 \r\n    284     serialized_storage_keys = sorted(serialized_storages.keys())\r\n\r\nOSError: [Errno 22] Invalid argument\r\n```", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/171/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/171/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/152", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/152/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/152/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/152/events", "html_url": "https://github.com/flairNLP/flair/issues/152", "id": 371453746, "node_id": "MDU6SXNzdWUzNzE0NTM3NDY=", "number": 152, "title": "SequenceTagger.predict() fails over empty sentences", "user": {"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 1079290828, "node_id": "MDU6TGFiZWwxMDc5MjkwODI4", "url": "https://api.github.com/repos/flairNLP/flair/labels/text%20classification", "name": "text classification", "color": "bfd4f2", "default": false, "description": "Related to text classifier"}, {"id": 1079291265, "node_id": "MDU6TGFiZWwxMDc5MjkxMjY1", "url": "https://api.github.com/repos/flairNLP/flair/labels/sequence%20tagger", "name": "sequence tagger", "color": "bfd4f2", "default": false, "description": "Related to sequence tagger"}], "state": "closed", "locked": false, "assignee": {"login": "tabergma", "id": 7203823, "node_id": "MDQ6VXNlcjcyMDM4MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7203823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tabergma", "html_url": "https://github.com/tabergma", "followers_url": "https://api.github.com/users/tabergma/followers", "following_url": "https://api.github.com/users/tabergma/following{/other_user}", "gists_url": "https://api.github.com/users/tabergma/gists{/gist_id}", "starred_url": "https://api.github.com/users/tabergma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tabergma/subscriptions", "organizations_url": "https://api.github.com/users/tabergma/orgs", "repos_url": "https://api.github.com/users/tabergma/repos", "events_url": "https://api.github.com/users/tabergma/events{/privacy}", "received_events_url": "https://api.github.com/users/tabergma/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tabergma", "id": 7203823, "node_id": "MDQ6VXNlcjcyMDM4MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7203823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tabergma", "html_url": "https://github.com/tabergma", "followers_url": "https://api.github.com/users/tabergma/followers", "following_url": "https://api.github.com/users/tabergma/following{/other_user}", "gists_url": "https://api.github.com/users/tabergma/gists{/gist_id}", "starred_url": "https://api.github.com/users/tabergma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tabergma/subscriptions", "organizations_url": "https://api.github.com/users/tabergma/orgs", "repos_url": "https://api.github.com/users/tabergma/repos", "events_url": "https://api.github.com/users/tabergma/events{/privacy}", "received_events_url": "https://api.github.com/users/tabergma/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-10-18T10:03:04Z", "updated_at": "2018-10-18T13:43:03Z", "closed_at": "2018-10-18T13:43:03Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "This code produces an error: \r\n\r\n```python\r\ntagger = SequenceTagger.load('ner')\r\n\r\n# empty sentence\r\nsentence: Sentence = Sentence('   ')\r\ntagger.predict(sentence)\r\n```\r\nNeed more robust handling of empty sentences.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/152/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/152/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/114", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/114/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/114/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/114/events", "html_url": "https://github.com/flairNLP/flair/issues/114", "id": 360815619, "node_id": "MDU6SXNzdWUzNjA4MTU2MTk=", "number": 114, "title": "pip install not working due to encoding error in README", "user": {"login": "NilsRethmeier", "id": 4290719, "node_id": "MDQ6VXNlcjQyOTA3MTk=", "avatar_url": "https://avatars.githubusercontent.com/u/4290719?v=4", "gravatar_id": "", "url": "https://api.github.com/users/NilsRethmeier", "html_url": "https://github.com/NilsRethmeier", "followers_url": "https://api.github.com/users/NilsRethmeier/followers", "following_url": "https://api.github.com/users/NilsRethmeier/following{/other_user}", "gists_url": "https://api.github.com/users/NilsRethmeier/gists{/gist_id}", "starred_url": "https://api.github.com/users/NilsRethmeier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/NilsRethmeier/subscriptions", "organizations_url": "https://api.github.com/users/NilsRethmeier/orgs", "repos_url": "https://api.github.com/users/NilsRethmeier/repos", "events_url": "https://api.github.com/users/NilsRethmeier/events{/privacy}", "received_events_url": "https://api.github.com/users/NilsRethmeier/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2018-09-17T10:56:42Z", "updated_at": "2018-10-04T09:52:32Z", "closed_at": "2018-10-04T09:52:32Z", "author_association": "NONE", "active_lock_reason": null, "body": "TLDR;\r\nThe README needs a (unicode) fix\r\n\r\nGot error,\r\n```\r\nTraceback (most recent call last):\r\n  File \"setup.py\", line 7, in <module>\r\n    long_description=open(\"README.md\").read(),\r\n  File \"/home/rethmeier/miniconda3/envs/PT0.4/lib/python3.6/encodings/ascii.py\", line 26, in decode\r\n    return codecs.ascii_decode(input, self.errors)[0]\r\nUnicodeDecodeError: 'ascii' codec can't decode byte 0xc3 in position 2539: ordinal not in range(128)\r\n```\r\nEmptied the README.md file.\r\n\r\nNow `python setup.py install` on a cloned flair repo worked.\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/114/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/114/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/109", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/109/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/109/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/109/events", "html_url": "https://github.com/flairNLP/flair/issues/109", "id": 359992106, "node_id": "MDU6SXNzdWUzNTk5OTIxMDY=", "number": 109, "title": "[Text Classification] Fix bug in single label training", "user": {"login": "tabergma", "id": 7203823, "node_id": "MDQ6VXNlcjcyMDM4MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7203823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tabergma", "html_url": "https://github.com/tabergma", "followers_url": "https://api.github.com/users/tabergma/followers", "following_url": "https://api.github.com/users/tabergma/following{/other_user}", "gists_url": "https://api.github.com/users/tabergma/gists{/gist_id}", "starred_url": "https://api.github.com/users/tabergma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tabergma/subscriptions", "organizations_url": "https://api.github.com/users/tabergma/orgs", "repos_url": "https://api.github.com/users/tabergma/repos", "events_url": "https://api.github.com/users/tabergma/events{/privacy}", "received_events_url": "https://api.github.com/users/tabergma/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "tabergma", "id": 7203823, "node_id": "MDQ6VXNlcjcyMDM4MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7203823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tabergma", "html_url": "https://github.com/tabergma", "followers_url": "https://api.github.com/users/tabergma/followers", "following_url": "https://api.github.com/users/tabergma/following{/other_user}", "gists_url": "https://api.github.com/users/tabergma/gists{/gist_id}", "starred_url": "https://api.github.com/users/tabergma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tabergma/subscriptions", "organizations_url": "https://api.github.com/users/tabergma/orgs", "repos_url": "https://api.github.com/users/tabergma/repos", "events_url": "https://api.github.com/users/tabergma/events{/privacy}", "received_events_url": "https://api.github.com/users/tabergma/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tabergma", "id": 7203823, "node_id": "MDQ6VXNlcjcyMDM4MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7203823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tabergma", "html_url": "https://github.com/tabergma", "followers_url": "https://api.github.com/users/tabergma/followers", "following_url": "https://api.github.com/users/tabergma/following{/other_user}", "gists_url": "https://api.github.com/users/tabergma/gists{/gist_id}", "starred_url": "https://api.github.com/users/tabergma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tabergma/subscriptions", "organizations_url": "https://api.github.com/users/tabergma/orgs", "repos_url": "https://api.github.com/users/tabergma/repos", "events_url": "https://api.github.com/users/tabergma/events{/privacy}", "received_events_url": "https://api.github.com/users/tabergma/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2018-09-13T17:29:16Z", "updated_at": "2018-09-13T18:19:19Z", "closed_at": "2018-09-13T18:19:19Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "When training a text classifier with a single label task, the classifier predicts just one class. ", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/109/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/109/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/108", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/108/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/108/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/108/events", "html_url": "https://github.com/flairNLP/flair/issues/108", "id": 359772050, "node_id": "MDU6SXNzdWUzNTk3NzIwNTA=", "number": 108, "title": "Fix cuda out of memory issue for text classification", "user": {"login": "tabergma", "id": 7203823, "node_id": "MDQ6VXNlcjcyMDM4MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7203823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tabergma", "html_url": "https://github.com/tabergma", "followers_url": "https://api.github.com/users/tabergma/followers", "following_url": "https://api.github.com/users/tabergma/following{/other_user}", "gists_url": "https://api.github.com/users/tabergma/gists{/gist_id}", "starred_url": "https://api.github.com/users/tabergma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tabergma/subscriptions", "organizations_url": "https://api.github.com/users/tabergma/orgs", "repos_url": "https://api.github.com/users/tabergma/repos", "events_url": "https://api.github.com/users/tabergma/events{/privacy}", "received_events_url": "https://api.github.com/users/tabergma/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "tabergma", "id": 7203823, "node_id": "MDQ6VXNlcjcyMDM4MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7203823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tabergma", "html_url": "https://github.com/tabergma", "followers_url": "https://api.github.com/users/tabergma/followers", "following_url": "https://api.github.com/users/tabergma/following{/other_user}", "gists_url": "https://api.github.com/users/tabergma/gists{/gist_id}", "starred_url": "https://api.github.com/users/tabergma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tabergma/subscriptions", "organizations_url": "https://api.github.com/users/tabergma/orgs", "repos_url": "https://api.github.com/users/tabergma/repos", "events_url": "https://api.github.com/users/tabergma/events{/privacy}", "received_events_url": "https://api.github.com/users/tabergma/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tabergma", "id": 7203823, "node_id": "MDQ6VXNlcjcyMDM4MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7203823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tabergma", "html_url": "https://github.com/tabergma", "followers_url": "https://api.github.com/users/tabergma/followers", "following_url": "https://api.github.com/users/tabergma/following{/other_user}", "gists_url": "https://api.github.com/users/tabergma/gists{/gist_id}", "starred_url": "https://api.github.com/users/tabergma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tabergma/subscriptions", "organizations_url": "https://api.github.com/users/tabergma/orgs", "repos_url": "https://api.github.com/users/tabergma/repos", "events_url": "https://api.github.com/users/tabergma/events{/privacy}", "received_events_url": "https://api.github.com/users/tabergma/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2018-09-13T07:19:49Z", "updated_at": "2018-09-20T12:57:45Z", "closed_at": "2018-09-20T12:57:45Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "body": "When training a text classifier on large datasets, the trainer runs into memory problems. \r\nInvestigate why we are running into out of memory issues and fix them.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/108/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/108/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/107", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/107/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/107/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/107/events", "html_url": "https://github.com/flairNLP/flair/issues/107", "id": 358871226, "node_id": "MDU6SXNzdWUzNTg4NzEyMjY=", "number": 107, "title": "Sentence() indexing behaves strangely when running on CPU", "user": {"login": "kyoungrok0517", "id": 1051900, "node_id": "MDQ6VXNlcjEwNTE5MDA=", "avatar_url": "https://avatars.githubusercontent.com/u/1051900?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyoungrok0517", "html_url": "https://github.com/kyoungrok0517", "followers_url": "https://api.github.com/users/kyoungrok0517/followers", "following_url": "https://api.github.com/users/kyoungrok0517/following{/other_user}", "gists_url": "https://api.github.com/users/kyoungrok0517/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyoungrok0517/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyoungrok0517/subscriptions", "organizations_url": "https://api.github.com/users/kyoungrok0517/orgs", "repos_url": "https://api.github.com/users/kyoungrok0517/repos", "events_url": "https://api.github.com/users/kyoungrok0517/events{/privacy}", "received_events_url": "https://api.github.com/users/kyoungrok0517/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-09-11T03:17:59Z", "updated_at": "2018-09-11T11:52:23Z", "closed_at": "2018-09-11T11:52:23Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi, I found out that on CPU, no matter what model I load (`news-forward`, `news-forward-fast`), the 0-th element of `Sentence()` is `None`, which should be the first Token in the textual sentence. I'm running on **macOS High Sierra 10.13.6**, and **PyTorch 0.4.1**. \r\n\r\nI see\r\n```python\r\nSentence(\"He like apple .\")[0] = None\r\n```\r\nWhich should be\r\n```python\r\nSentence(\"He like apple .\")[0] = Token: He\r\n```\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/107/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/107/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/83", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/83/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/83/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/83/events", "html_url": "https://github.com/flairNLP/flair/issues/83", "id": 352361668, "node_id": "MDU6SXNzdWUzNTIzNjE2Njg=", "number": 83, "title": "ValueError when input has double spaces and flair does not use tokenizer", "user": {"login": "ducalpha", "id": 3000864, "node_id": "MDQ6VXNlcjMwMDA4NjQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3000864?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ducalpha", "html_url": "https://github.com/ducalpha", "followers_url": "https://api.github.com/users/ducalpha/followers", "following_url": "https://api.github.com/users/ducalpha/following{/other_user}", "gists_url": "https://api.github.com/users/ducalpha/gists{/gist_id}", "starred_url": "https://api.github.com/users/ducalpha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ducalpha/subscriptions", "organizations_url": "https://api.github.com/users/ducalpha/orgs", "repos_url": "https://api.github.com/users/ducalpha/repos", "events_url": "https://api.github.com/users/ducalpha/events{/privacy}", "received_events_url": "https://api.github.com/users/ducalpha/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-08-21T02:26:17Z", "updated_at": "2018-08-21T14:41:27Z", "closed_at": "2018-08-21T14:41:27Z", "author_association": "NONE", "active_lock_reason": null, "body": "I found that flair will crash when using Sentence() with use_tokenizer=False (its default value) and the sentence string has a double-space, which causes an empty token and the following error on PyTorch:\r\n\r\n(To reproduce the following, I changed the input text in predict.py to have a double-space.)\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"predict.py\", line 8, in <module>\r\n    tagger.predict(sentence)\r\n  File \"/home/projects/ner/flair/flair/models/sequence_tagger_model.py\", line 371, in predict\r\n    score, tag_seq = self._predict_scores_batch(batch)\r\n  File \"/home/projects/ner/flair/flair/models/sequence_tagger_model.py\", line 386, in _predict_scores_batch\r\n    all_feats, tags = self.forward(sentences)\r\n  File \"/home/projects/ner/flair/flair/models/sequence_tagger_model.py\", line 157, in forward\r\n    self.embeddings.embed(sentences)\r\n  File \"/home/projects/ner/flair/flair/embeddings.py\", line 115, in embed\r\n    embedding.embed(sentences)\r\n  File \"/home/projects/ner/flair/flair/embeddings.py\", line 48, in embed\r\n    self._add_embeddings_internal(sentences)\r\n  File \"/home/projects/ner/flair/flair/embeddings.py\", line 268, in _add_embeddings_internal\r\n    tokens_sorted_by_length = sorted(tokens_char_indices, key=lambda p: len(p), reverse=True)\r\n  File \"/home/miniconda3/lib/python3.6/site-packages/torch/onnx/__init__.py\", line 68, in wrapper\r\n    return fn(*args, **kwargs)\r\n  File \"/home/miniconda3/lib/python3.6/site-packages/torch/nn/utils/rnn.py\", line 141, in pack_padded_sequence\r\n    data, batch_sizes = PackPadded.apply(input, lengths, batch_first)\r\n  File \"/home/miniconda3/lib/python3.6/site-packages/torch/nn/_functions/packing.py\", line 12, in forward\r\n    raise ValueError(\"Length of all samples has to be greater than 0, \"\r\nValueError: Length of all samples has to be greater than 0, but found an element in 'lengths' that is <= 0\r\n```\r\n", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/83/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/83/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/75", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/75/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/75/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/75/events", "html_url": "https://github.com/flairNLP/flair/issues/75", "id": 351510221, "node_id": "MDU6SXNzdWUzNTE1MTAyMjE=", "number": 75, "title": "implement pure Python \"span-F1\" evaluation routine applicable to BIO/BIOS", "user": {"login": "miracle24", "id": 10026242, "node_id": "MDQ6VXNlcjEwMDI2MjQy", "avatar_url": "https://avatars.githubusercontent.com/u/10026242?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miracle24", "html_url": "https://github.com/miracle24", "followers_url": "https://api.github.com/users/miracle24/followers", "following_url": "https://api.github.com/users/miracle24/following{/other_user}", "gists_url": "https://api.github.com/users/miracle24/gists{/gist_id}", "starred_url": "https://api.github.com/users/miracle24/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miracle24/subscriptions", "organizations_url": "https://api.github.com/users/miracle24/orgs", "repos_url": "https://api.github.com/users/miracle24/repos", "events_url": "https://api.github.com/users/miracle24/events{/privacy}", "received_events_url": "https://api.github.com/users/miracle24/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-08-17T08:50:02Z", "updated_at": "2018-10-11T07:43:59Z", "closed_at": "2018-10-11T07:43:59Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hello. Thanks for your wonderful code. I find you also calculate the F1 score using the perl script. I think there is a problem if this script is used to calculate the F1 score for the BIOS tag scheme, since this perl script cannot deal with those tag start with 'S-'. So I wonder if you guys correct the script code or you convert the tag scheme of tokens before using the script? If I am not right, please let me know. Thanks again. ", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/75/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/75/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/62", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/62/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/62/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/62/events", "html_url": "https://github.com/flairNLP/flair/issues/62", "id": 349957510, "node_id": "MDU6SXNzdWUzNDk5NTc1MTA=", "number": 62, "title": "getting items in sentence indices ", "user": {"login": "blythed", "id": 15139331, "node_id": "MDQ6VXNlcjE1MTM5MzMx", "avatar_url": "https://avatars.githubusercontent.com/u/15139331?v=4", "gravatar_id": "", "url": "https://api.github.com/users/blythed", "html_url": "https://github.com/blythed", "followers_url": "https://api.github.com/users/blythed/followers", "following_url": "https://api.github.com/users/blythed/following{/other_user}", "gists_url": "https://api.github.com/users/blythed/gists{/gist_id}", "starred_url": "https://api.github.com/users/blythed/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/blythed/subscriptions", "organizations_url": "https://api.github.com/users/blythed/orgs", "repos_url": "https://api.github.com/users/blythed/repos", "events_url": "https://api.github.com/users/blythed/events{/privacy}", "received_events_url": "https://api.github.com/users/blythed/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 961178843, "node_id": "MDU6TGFiZWw5NjExNzg4NDM=", "url": "https://api.github.com/repos/flairNLP/flair/labels/enhancement", "name": "enhancement", "color": "f9f195", "default": true, "description": "Improving of an existing feature"}], "state": "closed", "locked": false, "assignee": {"login": "tabergma", "id": 7203823, "node_id": "MDQ6VXNlcjcyMDM4MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7203823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tabergma", "html_url": "https://github.com/tabergma", "followers_url": "https://api.github.com/users/tabergma/followers", "following_url": "https://api.github.com/users/tabergma/following{/other_user}", "gists_url": "https://api.github.com/users/tabergma/gists{/gist_id}", "starred_url": "https://api.github.com/users/tabergma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tabergma/subscriptions", "organizations_url": "https://api.github.com/users/tabergma/orgs", "repos_url": "https://api.github.com/users/tabergma/repos", "events_url": "https://api.github.com/users/tabergma/events{/privacy}", "received_events_url": "https://api.github.com/users/tabergma/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tabergma", "id": 7203823, "node_id": "MDQ6VXNlcjcyMDM4MjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7203823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tabergma", "html_url": "https://github.com/tabergma", "followers_url": "https://api.github.com/users/tabergma/followers", "following_url": "https://api.github.com/users/tabergma/following{/other_user}", "gists_url": "https://api.github.com/users/tabergma/gists{/gist_id}", "starred_url": "https://api.github.com/users/tabergma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tabergma/subscriptions", "organizations_url": "https://api.github.com/users/tabergma/orgs", "repos_url": "https://api.github.com/users/tabergma/repos", "events_url": "https://api.github.com/users/tabergma/events{/privacy}", "received_events_url": "https://api.github.com/users/tabergma/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2018-08-13T09:41:15Z", "updated_at": "2018-08-14T09:23:20Z", "closed_at": "2018-08-14T09:23:20Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "2 issues here\r\n\r\n- the ```__getitem__``` should return something for sentence[0] (in python this is usually the first thing)\r\n- the ```flair.data.Token``` object should display the string in it's __repr__ method", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/62/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/62/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/57", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/57/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/57/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/57/events", "html_url": "https://github.com/flairNLP/flair/issues/57", "id": 349517980, "node_id": "MDU6SXNzdWUzNDk1MTc5ODA=", "number": 57, "title": "Best models (when validating on dev) are not being saved", "user": {"login": "Borchmann", "id": 12532185, "node_id": "MDQ6VXNlcjEyNTMyMTg1", "avatar_url": "https://avatars.githubusercontent.com/u/12532185?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Borchmann", "html_url": "https://github.com/Borchmann", "followers_url": "https://api.github.com/users/Borchmann/followers", "following_url": "https://api.github.com/users/Borchmann/following{/other_user}", "gists_url": "https://api.github.com/users/Borchmann/gists{/gist_id}", "starred_url": "https://api.github.com/users/Borchmann/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Borchmann/subscriptions", "organizations_url": "https://api.github.com/users/Borchmann/orgs", "repos_url": "https://api.github.com/users/Borchmann/repos", "events_url": "https://api.github.com/users/Borchmann/events{/privacy}", "received_events_url": "https://api.github.com/users/Borchmann/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-08-10T13:34:57Z", "updated_at": "2018-08-14T07:55:29Z", "closed_at": "2018-08-14T07:55:29Z", "author_association": "NONE", "active_lock_reason": null, "body": "When we are not in _train_with_dev_ mode, _scheduler.best_ stores the highest F1 (_dev_score_, not the _current_loss_).\r\nhttps://github.com/zalandoresearch/flair/blob/3635220bdc05c19e4fe47555071db6c39c009bae/flair/trainers/sequence_tagger_trainer.py#L138", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/57/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/57/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/33", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/33/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/33/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/33/events", "html_url": "https://github.com/flairNLP/flair/issues/33", "id": 346857145, "node_id": "MDU6SXNzdWUzNDY4NTcxNDU=", "number": 33, "title": "'Length of all samples has to be greater than 0' error on pytorch", "user": {"login": "ducalpha", "id": 3000864, "node_id": "MDQ6VXNlcjMwMDA4NjQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3000864?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ducalpha", "html_url": "https://github.com/ducalpha", "followers_url": "https://api.github.com/users/ducalpha/followers", "following_url": "https://api.github.com/users/ducalpha/following{/other_user}", "gists_url": "https://api.github.com/users/ducalpha/gists{/gist_id}", "starred_url": "https://api.github.com/users/ducalpha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ducalpha/subscriptions", "organizations_url": "https://api.github.com/users/ducalpha/orgs", "repos_url": "https://api.github.com/users/ducalpha/repos", "events_url": "https://api.github.com/users/ducalpha/events{/privacy}", "received_events_url": "https://api.github.com/users/ducalpha/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 16, "created_at": "2018-08-02T04:42:33Z", "updated_at": "2021-02-28T06:07:01Z", "closed_at": "2018-08-02T14:27:19Z", "author_association": "NONE", "active_lock_reason": null, "body": "Hi,\r\n\r\nWhen running an experiment with NER ([run_ner.py](https://gist.github.com/ducalpha/fff18d22ab1ebdd6bfcd7952de3ba4be)), I got the following error:\r\n  \r\n```\r\nFile \"./run_ner.py\", line 79, in <module>\r\n    main()\r\n  File \"./run_ner.py\", line 76, in main\r\n    train(train_file_path, dev_file_path, test_file_path)\r\n  File \"./run_ner.py\", line 63, in train\r\n    train_with_dev=True, anneal_mode=True)\r\n  File \"/home/user/projects/ner/flair/flair/trainer.py\", line 80, in train\r\n    loss = self.model.neg_log_likelihood(batch, self.model.tag_type)\r\n  File \"/home/user/projects/ner/flair/flair/tagging_model.py\", line 285, in neg_log_likelihood\r\n    feats, tags = self.forward(sentences)\r\n  File \"/home/user/projects/ner/flair/flair/tagging_model.py\", line 213, in forward\r\n    packed = torch.nn.utils.rnn.pack_padded_sequence(tagger_states, lengths)\r\n  File \"/home/user/miniconda3/lib/python3.6/site-packages/torch/onnx/__init__.py\", line 57, in wrapper\r\n    return fn(*args, **kwargs)\r\n  File \"/home/user/miniconda3/lib/python3.6/site-packages/torch/nn/utils/rnn.py\", line 124, in pack_padded_sequence\r\n    data, batch_sizes = PackPadded.apply(input, lengths, batch_first)\r\n  File \"/home/user/miniconda3/lib/python3.6/site-packages/torch/nn/_functions/packing.py\", line 12, in forward\r\n    raise ValueError(\"Length of all samples has to be greater than 0, \"\r\nValueError: Length of all samples has to be greater than 0, but found an element in 'lengths' that is <= 0\r\n\r\n```\r\n\r\nDo you have any suggestion why this error happens?\r\n\r\nThanks.", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/33/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/33/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/flairNLP/flair/issues/23", "repository_url": "https://api.github.com/repos/flairNLP/flair", "labels_url": "https://api.github.com/repos/flairNLP/flair/issues/23/labels{/name}", "comments_url": "https://api.github.com/repos/flairNLP/flair/issues/23/comments", "events_url": "https://api.github.com/repos/flairNLP/flair/issues/23/events", "html_url": "https://github.com/flairNLP/flair/issues/23", "id": 346008522, "node_id": "MDU6SXNzdWUzNDYwMDg1MjI=", "number": 23, "title": "tagger = SequenceTagger.load('ner-ontonotes') does not work", "user": {"login": "akshaykhatri639", "id": 10542839, "node_id": "MDQ6VXNlcjEwNTQyODM5", "avatar_url": "https://avatars.githubusercontent.com/u/10542839?v=4", "gravatar_id": "", "url": "https://api.github.com/users/akshaykhatri639", "html_url": "https://github.com/akshaykhatri639", "followers_url": "https://api.github.com/users/akshaykhatri639/followers", "following_url": "https://api.github.com/users/akshaykhatri639/following{/other_user}", "gists_url": "https://api.github.com/users/akshaykhatri639/gists{/gist_id}", "starred_url": "https://api.github.com/users/akshaykhatri639/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akshaykhatri639/subscriptions", "organizations_url": "https://api.github.com/users/akshaykhatri639/orgs", "repos_url": "https://api.github.com/users/akshaykhatri639/repos", "events_url": "https://api.github.com/users/akshaykhatri639/events{/privacy}", "received_events_url": "https://api.github.com/users/akshaykhatri639/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 961178841, "node_id": "MDU6TGFiZWw5NjExNzg4NDE=", "url": "https://api.github.com/repos/flairNLP/flair/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignee": {"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "alanakbik", "id": 18665324, "node_id": "MDQ6VXNlcjE4NjY1MzI0", "avatar_url": "https://avatars.githubusercontent.com/u/18665324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanakbik", "html_url": "https://github.com/alanakbik", "followers_url": "https://api.github.com/users/alanakbik/followers", "following_url": "https://api.github.com/users/alanakbik/following{/other_user}", "gists_url": "https://api.github.com/users/alanakbik/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanakbik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanakbik/subscriptions", "organizations_url": "https://api.github.com/users/alanakbik/orgs", "repos_url": "https://api.github.com/users/alanakbik/repos", "events_url": "https://api.github.com/users/alanakbik/events{/privacy}", "received_events_url": "https://api.github.com/users/alanakbik/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 19, "created_at": "2018-07-31T02:08:22Z", "updated_at": "2018-11-07T16:47:15Z", "closed_at": "2018-11-07T16:47:15Z", "author_association": "NONE", "active_lock_reason": null, "body": "Trying to use the ner-ontonotes model on a Mac. Installed flair via pip. \r\n```\r\nfrom flair.tagging_model import SequenceTagger\r\ntagger = SequenceTagger.load('ner-ontonotes')\r\n```\r\nHere's the traceback:\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nOSError                                   Traceback (most recent call last)\r\n<ipython-input-4-4d86fef1ef40> in <module>()\r\n----> 1 tagger = SequenceTagger.load('ner-ontonotes')\r\n\r\n~/.virtualenvs/py36/lib/python3.6/site-packages/flair/tagging_model.py in load(model)\r\n    459 \r\n    460         if model_file is not None:\r\n--> 461             tagger: SequenceTagger = SequenceTagger.load_from_file(model_file)\r\n    462             return tagger\r\n    463 \r\n\r\n~/.virtualenvs/py36/lib/python3.6/site-packages/flair/tagging_model.py in load_from_file(cls, model_file)\r\n    123         # serialization of torch objects\r\n    124         warnings.filterwarnings(\"ignore\")\r\n--> 125         state = torch.load(model_file, map_location={'cuda:0': 'cpu'})\r\n    126         warnings.filterwarnings(\"default\")\r\n    127 \r\n\r\n~/.virtualenvs/py36/lib/python3.6/site-packages/torch/serialization.py in load(f, map_location, pickle_module)\r\n    301         f = open(f, 'rb')\r\n    302     try:\r\n--> 303         return _load(f, map_location, pickle_module)\r\n    304     finally:\r\n    305         if new_fd:\r\n\r\n~/.virtualenvs/py36/lib/python3.6/site-packages/torch/serialization.py in _load(f, map_location, pickle_module)\r\n    467     unpickler = pickle_module.Unpickler(f)\r\n    468     unpickler.persistent_load = persistent_load\r\n--> 469     result = unpickler.load()\r\n    470 \r\n    471     deserialized_storage_keys = pickle_module.load(f)\r\n\r\nOSError: [Errno 22] Invalid argument\r\n```\r\nNote: `tagger = SequenceTagger.load('ner')` works fine", "reactions": {"url": "https://api.github.com/repos/flairNLP/flair/issues/23/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/flairNLP/flair/issues/23/timeline", "performed_via_github_app": null, "state_reason": "completed"}]